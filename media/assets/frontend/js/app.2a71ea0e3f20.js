webpackJsonp([3],{101:function(e,t){},1012:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(14),f=r(p),h=n(1013),m=r(h),g=n(735),y=r(g),v=n(274),b=n(3),w={repoPermission:d.default.bool,isNodeMenuShow:d.default.bool.isRequired,treeData:d.default.object.isRequired,currentPath:d.default.string.isRequired,onMenuItemClick:d.default.func,onNodeClick:d.default.func.isRequired,onNodeExpanded:d.default.func.isRequired,onNodeCollapse:d.default.func.isRequired,onItemMove:d.default.func,currentRepoInfo:d.default.object,selectedDirentList:d.default.array,onItemsMove:d.default.func},E=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onItemMove=function(e,t,r,a){n.props.onItemMove(e,t,r,a)},n.onNodeDragStart=function(e,t){if(b.Utils.isIEBrower())return!1;var n={nodeDirent:t.object,nodeParentPath:t.parentNode.path,nodeRootPath:t.path};n=JSON.stringify(n),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("applicaiton/drag-item-info",n)},n.onNodeDragEnter=function(e,t){if(b.Utils.isIEBrower())return!1;e.persist(),"tree-view tree "===e.target.className&&n.setState({isTreeViewDropTipShow:!0})},n.onNodeDragMove=function(e){if(b.Utils.isIEBrower())return!1;e.preventDefault(),e.dataTransfer.dropEffect="move"},n.onNodeDragLeave=function(e,t){if(b.Utils.isIEBrower())return!1;"tree-view tree tree-view-drop"===e.target.className&&n.setState({isTreeViewDropTipShow:!1})},n.onNodeDrop=function(e,t){if(b.Utils.isIEBrower())return!1;if(!e.dataTransfer.files.length){var r=e.dataTransfer.getData("applicaiton/drag-item-info");r=JSON.parse(r);var a=r,o=a.nodeDirent,i=a.nodeParentPath,s=a.nodeRootPath,l=t;if(Array.isArray(r))return l?void n.onMoveItems(r,l,n.props.currentRepoInfo,l.path):"/"===r[0].nodeParentPath?void n.setState({isTreeViewDropTipShow:!1}):(n.props.onItemsMove(n.props.currentRepoInfo,"/"),void n.setState({isTreeViewDropTipShow:!1}));if(!l)return"/"===i?void n.setState({isTreeViewDropTipShow:!1}):(n.onItemMove(n.props.currentRepoInfo,o,"/",i),void n.setState({isTreeViewDropTipShow:!1}));if("dir"===l.object.type&&i!==l.path&&(i!==l.parentNode.path||l.object.name!==o.name)){if("dir"===l.object.type&&"dir"===o.type&&l.parentNode.path!==i){if(b.Utils.getPaths(l.path).includes(s))return}n.onItemMove(n.props.currentRepoInfo,o,l.path,i)}}},n.onMoveItems=function(e,t,r,a){var o=[],i=b.Utils.getPaths(a);if(e.forEach(function(e){var t=e.nodeRootPath;o.push(t)}),"dir"===t.object.type&&!o.some(function(e){return e===a})&&(!e[0].nodeParentPath||e[0].nodeParentPath!==t.path)){o.some(function(e){return i.includes(e)})||n.props.onItemsMove(r,a)}},n.freezeItem=function(){n.setState({isItemFreezed:!0})},n.unfreezeItem=function(){n.setState({isItemFreezed:!1})},n.onMenuItemClick=function(e,t){n.props.onMenuItemClick(e,t),(0,v.hideMenu)()},n.onMouseDown=function(e){e.stopPropagation(),e.button},n.onContextMenu=function(e){e.preventDefault();var t=n.props.currentRepoInfo;if("admin"!==t.permission&&"rw"!==t.permission)return"";n.handleContextClick(e)},n.handleContextClick=function(e,t){if(e.preventDefault(),e.stopPropagation(),n.props.isNodeMenuShow){var r=e.clientX||e.touches&&e.touches[0].pageX,a=e.clientY||e.touches&&e.touches[0].pageY;n.props.posX&&(r-=n.props.posX),n.props.posY&&(a-=n.props.posY),(0,v.hideMenu)();var o=n.getMenuList(t),i={id:"tree-node-contextmenu",position:{x:r,y:a},target:e.target,currentObject:t,menuList:o};(0,v.showMenu)(i)}},n.getMenuList=function(e){var t=f.default.NEW_FOLDER,n=f.default.NEW_FILE,r=f.default.COPY,a=f.default.MOVE,o=f.default.RENAME,i=f.default.DELETE,s=f.default.OPEN_VIA_CLIENT;return e?"dir"===e.object.type?[t,n,r,a,o,i]:[o,i,r,a,s]:[t,n]},n.onShowMenu=function(){n.freezeItem()},n.onHideMenu=function(){n.unfreezeItem()},n.state={isItemFreezed:!1,isTreeViewDropTipShow:!1},n}return i(t,e),s(t,[{key:"render",value:function(){return u.default.createElement("div",{className:"tree-view tree "+(this.state.isTreeViewDropTipShow?"tree-view-drop":""),onDrop:this.onNodeDrop,onDragEnter:this.onNodeDragEnter,onDragLeave:this.onNodeDragLeave,onMouseDown:this.onMouseDown,onContextMenu:this.onContextMenu},u.default.createElement(m.default,{repoPermission:this.props.repoPermission,node:this.props.treeData.root,currentPath:this.props.currentPath,paddingLeft:20,isNodeMenuShow:this.props.isNodeMenuShow,isItemFreezed:this.state.isItemFreezed,onNodeClick:this.props.onNodeClick,onMenuItemClick:this.props.onMenuItemClick,onNodeExpanded:this.props.onNodeExpanded,onNodeCollapse:this.props.onNodeCollapse,onNodeDragStart:this.onNodeDragStart,freezeItem:this.freezeItem,unfreezeItem:this.unfreezeItem,onNodeDragMove:this.onNodeDragMove,onNodeDrop:this.onNodeDrop,onNodeDragEnter:this.onNodeDragEnter,onNodeDragLeave:this.onNodeDragLeave,handleContextClick:this.handleContextClick}),u.default.createElement(y.default,{id:"tree-node-contextmenu",onMenuItemClick:this.onMenuItemClick,onHideMenu:this.onHideMenu,onShowMenu:this.onShowMenu}))}}]),t}(u.default.Component);E.propTypes=w,t.default=E},1013:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(2),f=n(14),h=r(f),m=n(733),g=r(m),y={repoPermission:d.default.bool,node:d.default.object.isRequired,currentPath:d.default.string.isRequired,paddingLeft:d.default.number.isRequired,isNodeMenuShow:d.default.bool.isRequired,isItemFreezed:d.default.bool.isRequired,onNodeClick:d.default.func.isRequired,onNodeExpanded:d.default.func.isRequired,onNodeCollapse:d.default.func.isRequired,onNodeDragStart:d.default.func.isRequired,freezeItem:d.default.func.isRequired,unfreezeItem:d.default.func.isRequired,onMenuItemClick:d.default.func,onNodeDragMove:d.default.func,onNodeDrop:d.default.func,handleContextClick:d.default.func.isRequired,onNodeDragEnter:d.default.func.isRequired,onNodeDragLeave:d.default.func.isRequired},v=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseEnter=function(){n.props.isItemFreezed||n.setState({isShowOperationMenu:!0,isHighlight:!0})},n.onMouseOver=function(){n.props.isItemFreezed||n.setState({isShowOperationMenu:!0,isHighlight:!0})},n.onMouseLeave=function(){n.props.isItemFreezed||n.setState({isShowOperationMenu:!1,isHighlight:!1})},n.onNodeClick=function(){n.props.onNodeClick(n.props.node)},n.onLoadToggle=function(e){e.stopPropagation();var t=n.props.node;t.isExpanded?n.props.onNodeCollapse(t):n.props.onNodeExpanded(t)},n.onNodeDragStart=function(e){n.props.onNodeDragStart(e,n.props.node)},n.onNodeDragEnter=function(e){"dir"===n.props.node.object.type&&n.setState({isNodeDropShow:!0}),n.props.onNodeDragEnter(e,n.props.node)},n.onNodeDragMove=function(e){n.props.onNodeDragMove(e)},n.onNodeDragLeave=function(e){n.setState({isNodeDropShow:!1}),n.props.onNodeDragLeave(e,n.props.node)},n.onNodeDrop=function(e){e.stopPropagation(),n.setState({isNodeDropShow:!1}),n.props.onNodeDrop(e,n.props.node)},n.unfreezeItem=function(){n.setState({isShowOperationMenu:!1}),n.props.unfreezeItem()},n.onMenuItemClick=function(e,t,r){n.props.onMenuItemClick(e,r)},n.onItemMouseDown=function(e){e.stopPropagation(),e.button},n.onItemContextMenu=function(e){n.handleContextClick(e)},n.handleContextClick=function(e){n.props.handleContextClick(e,n.props.node),n.setState({isShowOperationMenu:!1})},n.getNodeTypeAndIcon=function(){var e=n.props.node,t="",r="";if("dir"===e.object.type)t=u.default.createElement("i",{className:"far fa-folder"}),r="dir";else{var a=e.object.name.lastIndexOf(".");if(-1===a)t=u.default.createElement("i",{className:"far fa-file"}),r="file";else{var o=e.object.name.slice(a).toLowerCase();".png"===o||".jpg"===o||".jpeg"===o||".gif"===o||".bmp"===o?(t=u.default.createElement("i",{className:"far fa-image"}),r="image"):".md"===o||".markdown"===o?(t=u.default.createElement("i",{className:"far fa-file-alt"}),r="file"):(t=u.default.createElement("i",{className:"far fa-file"}),r="file")}}return{icon:t,type:r}},n.renderChildren=function(){var e=n.props,r=e.node,a=e.paddingLeft;return r.hasChildren()?u.default.createElement("div",{className:"children",style:{paddingLeft:a}},r.children.map(function(e){return u.default.createElement(t,{key:e.path,node:e,paddingLeft:a,repoPermission:n.props.repoPermission,currentPath:n.props.currentPath,isNodeMenuShow:n.props.isNodeMenuShow,isItemFreezed:n.props.isItemFreezed,onNodeClick:n.props.onNodeClick,onNodeCollapse:n.props.onNodeCollapse,onNodeExpanded:n.props.onNodeExpanded,freezeItem:n.props.freezeItem,onMenuItemClick:n.props.onMenuItemClick,unfreezeItem:n.unfreezeItem,onNodeDragStart:n.props.onNodeDragStart,onNodeDragMove:n.props.onNodeDragMove,onNodeDrop:n.props.onNodeDrop,onNodeDragEnter:n.props.onNodeDragEnter,onNodeDragLeave:n.props.onNodeDragLeave,handleContextClick:n.props.handleContextClick})})):""},n.state={isHighlight:!1,isShowOperationMenu:!1,isNodeDropShow:!1},n}return i(t,e),s(t,[{key:"componentWillReceiveProps",value:function(e){e.isItemFreezed||this.setState({isShowOperationMenu:!1,isHighlight:!1})}},{key:"caculateMenuList",value:function(e){var t=h.default.NEW_FOLDER,n=h.default.NEW_FILE,r=h.default.COPY,a=h.default.MOVE,o=h.default.RENAME,i=h.default.DELETE,s=h.default.OPEN_VIA_CLIENT;return"dir"===e.object.type?[t,n,r,a,o,i]:[o,i,r,a,s]}},{key:"render",value:function(){var e=this.props,t=e.currentPath,n=e.node,r=e.isNodeMenuShow,a=this.getNodeTypeAndIcon(),o=a.type,i=a.icon,s=this.state.isHighlight?"tree-node-inner-hover ":"";return n.path===t&&(s="tree-node-hight-light"),u.default.createElement("div",{className:"tree-node"},u.default.createElement("div",{type:o,className:"tree-node-inner text-nowrap "+s+" "+("/"===n.path?"hide":"")+" "+(this.state.isNodeDropShow?"tree-node-drop":""),title:n.object.name,onMouseEnter:this.onMouseEnter,onMouseOver:this.onMouseOver,onMouseLeave:this.onMouseLeave,onMouseDown:this.onItemMouseDown,onContextMenu:this.onItemContextMenu,onClick:this.onNodeClick},u.default.createElement("div",{className:"tree-node-text",draggable:"true",onDragStart:this.onNodeDragStart,onDragEnter:this.onNodeDragEnter,onDragLeave:this.onNodeDragLeave,onDragOver:this.onNodeDragMove,onDrop:this.onNodeDrop},n.object.name),u.default.createElement("div",{className:"left-icon"},"dir"===o&&(!n.isLoaded||n.isLoaded&&n.hasChildren())&&u.default.createElement("i",{className:"folder-toggle-icon fa "+(n.isExpanded?"fa-caret-down":"fa-caret-right"),onMouseDown:function(e){return e.stopPropagation()},onClick:this.onLoadToggle}),u.default.createElement("i",{className:"tree-node-icon"},i)),r&&u.default.createElement("div",{className:"right-icon"},(this.props.repoPermission||p.permission)&&this.state.isShowOperationMenu&&u.default.createElement(g.default,{item:this.props.node,toggleClass:"fas fa-ellipsis-v",getMenuList:this.caculateMenuList,onMenuItemClick:this.onMenuItemClick,freezeItem:this.props.freezeItem,unfreezeItem:this.unfreezeItem}))),n.isExpanded&&this.renderChildren())}}]),t}(u.default.Component);v.propTypes=y,t.default=v},1014:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(355),f=r(p),h=n(2),m=n(6),g=n(8),y=r(g),v=n(4),b=n(3),w=n(5),E=r(w);n(1015);var S={children:d.default.object,isFileLoading:d.default.bool.isRequired,markdownContent:d.default.string.isRequired,latestContributor:d.default.string.isRequired,lastModified:d.default.string.isRequired,onLinkClick:d.default.func.isRequired,isWiki:d.default.bool,isTOCShow:d.default.bool,repoID:d.default.string,path:d.default.string},C=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onContentRendered=function(e){n.titlesInfo=e.titlesInfo},n.listRelatedFiles=function(){n.props.repoID&&n.props.path&&v.seafileAPI.listRelatedFiles(n.props.repoID,n.props.path).then(function(e){n.setState({relatedFiles:e.data.related_files})}).catch(function(e){var t=b.Utils.getErrorMsg(e);E.default.danger(t)})},n.onLinkClick=function(e){e.preventDefault(),e.stopPropagation();var t="";if("A"!==e.target.tagName){for(var r=e.target.parentNode;"A"!==r.tagName;)r=r.parentNode;t=r.href}else t=e.target.href;n.props.onLinkClick(t)},n.onScrollHandler=function(){var e=n.markdownContainer.current.scrollTop+180,t=n.titlesInfo.length,r=void 0;if(e<=n.titlesInfo[0])return r=0,void n.setState({activeTitleIndex:r});if(e>n.titlesInfo[t-1])return r=n.titlesInfo.length-1,void n.setState({activeTitleIndex:r});for(var a=0;a<t;a++)if(!(e>n.titlesInfo[a])){r=a-1;break}n.setState({activeTitleIndex:r})},n.changeInlineNode=function(e){if("inline"==e.object){var t=void 0,r=void 0;if("image"==e.type&&h.isPublicWiki){t=e.data.src;if(new RegExp(h.serviceURL+"/lib/"+h.repoID+"/file.*raw=1").test(t)){var a=t.indexOf("/file"),o=t.indexOf("?");r=t.substring(a+5,o)}else{if(!/^\.\.\/*/.test(t)&&!/^\.\/*/.test(t))return;var i=n.props.path,s=i.slice(0,i.lastIndexOf("/"))+"/"+t;r=b.Utils.pathNormalize(s)}e.data.src=h.serviceURL+"/view-image-via-public-wiki/?slug="+h.slug+"&path="+r}else if("link"==e.type)if(t=e.data.href,b.Utils.isInternalFileLink(t,h.repoID))if(b.Utils.isInternalMarkdownLink(t,h.repoID)){var l=b.Utils.getPathFromInternalMarkdownLink(t,h.repoID);e.data.href=h.serviceURL+"/published/"+h.slug+l}else e.data.href=t.replace(/(.*)lib\/([-0-9a-f]{36})\/file(.*)/g,function(e,t,n,r){return t+"d/"+h.sharedToken+"/files/?p="+r+"&dl=1"});else if(b.Utils.isInternalDirLink(t,h.repoID)){var u=b.Utils.getPathFromInternalDirLink(t,h.repoID);e.data.href=h.serviceURL+"/published/"+h.slug+u}}return e},n.modifyValueBeforeRender=function(e){var t=e.document.nodes,r=b.Utils.changeMarkdownNodes(t,n.changeInlineNode);return e.document.nodes=r,e},n.renderMarkdown=function(){var e=!0;return!1===n.props.isTOCShow&&(e=!1),n.props.isWiki?u.default.createElement(f.default,{showTOC:e,markdownContent:n.props.markdownContent,activeTitleIndex:n.state.activeTitleIndex,onContentRendered:n.onContentRendered,modifyValueBeforeRender:n.modifyValueBeforeRender}):u.default.createElement(f.default,{showTOC:e,markdownContent:n.props.markdownContent,activeTitleIndex:n.state.activeTitleIndex,onContentRendered:n.onContentRendered})},n.renderRelatedFiles=function(){var e=n.state.relatedFiles;return e.length>0?u.default.createElement("div",{className:"sf-releted-files",id:"sf-releted-files"},u.default.createElement("div",{className:"sf-releted-files-header"},u.default.createElement("h4",null,(0,h.gettext)("related files"))),e.map(function(e,t){var n=h.siteRoot+"lib/"+e.repo_id+"/file"+b.Utils.encodePath(e.path);return u.default.createElement("div",{className:"sf-releted-file",key:t},u.default.createElement("a",{href:n,target:"_blank"},u.default.createElement(m.Card,{body:!0,size:"sm"},u.default.createElement(m.CardTitle,null,e.name),u.default.createElement(m.CardText,null,e.repo_name),u.default.createElement("span",{className:"sf-releted-file-arrow"}))))})):null},n.state={activeTitleIndex:0,relatedFiles:[]},n.markdownContainer=u.default.createRef(),n.links=[],n.titlesInfo=[],n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;this.links=document.querySelectorAll(".wiki-page-content a"),this.links.forEach(function(t){t.addEventListener("click",e.onLinkClick)}),this.listRelatedFiles()}},{key:"componentWillReceiveProps",value:function(e){var t=this;this.props.markdownContent!==e.markdownContent&&(this.links.forEach(function(e){e.removeEventListener("click",t.onLinkClick)}),this.listRelatedFiles())}},{key:"componentDidUpdate",value:function(){var e=this;this.links=document.querySelectorAll(".wiki-page-content a"),this.links.forEach(function(t){t.addEventListener("click",e.onLinkClick)})}},{key:"componentWillUnmount",value:function(){var e=this;this.links.forEach(function(t){t.removeEventListener("click",e.onLinkClick)})}},{key:"render",value:function(){if(this.props.isFileLoading)return u.default.createElement(y.default,null);var e=this.props.repoID?"wiki-page-content w-100":"wiki-page-content";return u.default.createElement("div",{ref:this.markdownContainer,className:"wiki-page-container",onScroll:this.onScrollHandler.bind(this)},u.default.createElement("div",{className:e},this.props.children,this.renderMarkdown(),this.props.isWiki&&this.renderRelatedFiles(),u.default.createElement("p",{id:"wiki-page-last-modified"},(0,h.gettext)("Last modified by")," ",this.props.latestContributor,", ",u.default.createElement("span",null,this.props.lastModified))))}}]),t}(u.default.Component),D={isWiki:!1};C.propTypes=S,f.default.defaultProps=D,t.default=C},1015:function(e,t){},1022:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function e(t){r(this,e),this.id=t.id,this.name=t.name,this.owner=t.owner,this.admins=t.admins||[],this.avatar_url=t.avatar_url,this.created_at=t.created_at,this.parent_group_id=t.parent_group_id,this.wiki_enabled=t.wiki_enabled,this.repos=t.repos||[],this.group_quota=t.group_quota,this.group_quota_usage=t.group_quota_usage};t.default=a},1023:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(82),f=r(p),h=n(6),m=n(2),g={libraryType:d.default.string.isRequired,onCreateRepo:d.default.func.isRequired,onCreateToggle:d.default.func.isRequired},y=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleRepoNameChange=function(e){e.target.value.trim()?n.setState({isSubmitBtnActive:!0}):n.setState({isSubmitBtnActive:!1}),n.setState({repoName:e.target.value})},n.handlePassword1Change=function(e){n.setState({password1:e.target.value})},n.handlePassword2Change=function(e){n.setState({password2:e.target.value})},n.handleSubmit=function(){if(n.validateInputParams()){var e=n.prepareRepoData();if("department"===n.props.libraryType)return void n.props.onCreateRepo(e,"department");n.props.onCreateRepo(e)}},n.handleKeyPress=function(e){"Enter"===e.key&&(n.handleSubmit(),e.preventDefault())},n.toggle=function(){n.props.onCreateToggle()},n.onPermissionChange=function(e){var t=e.target.value;n.setState({permission:t})},n.handleStorageInputChange=function(e){n.setState({storage_id:e.value})},n.handlelibraryTemplatesInputChange=function(e){n.setState({library_template:e.value})},n.onEncrypted=function(e){var t=e.target.checked;n.setState({encrypt:t,disabled:!t})},n.prepareRepoData=function(){var e=n.props.libraryType,t=n.state.repoName.trim(),r=n.state.encrypt?n.state.password1:"",a=n.state.permission,o=null;"mine"!==e&&"public"!==e||(o={name:t,passwd:r}),"group"===e&&(o={repo_name:t,password:r,permission:a}),"department"===e&&(o={repo_name:t,passwd:r});var i=n.state.storage_id;i&&(o.storage_id=i);var s=n.state.library_template;return s&&(o.library_template=s),o},n.state={repoName:"",disabled:!0,encrypt:!1,password1:"",password2:"",errMessage:"",permission:"rw",storage_id:m.storages.length?m.storages[0].id:"",library_template:m.libraryTemplates.length?m.libraryTemplates[0]:"",isSubmitBtnActive:!1},n.newInput=u.default.createRef(),n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){this.newInput.focus()}},{key:"validateInputParams",value:function(){var e="",t=this.state.repoName.trim();if(!t.length)return e=(0,m.gettext)("Name is required"),this.setState({errMessage:e}),!1;if(t.indexOf("/")>-1)return e=(0,m.gettext)("Name should not include '/'."),this.setState({errMessage:e}),!1;if(this.state.encrypt){var n=this.state.password1.trim(),r=this.state.password2.trim();if(!n.length)return e=(0,m.gettext)("Please enter password"),this.setState({errMessage:e}),!1;if(!r.length)return e=(0,m.gettext)("Please enter the password again"),this.setState({errMessage:e}),!1;if(n.length<m.repoPasswordMinLength)return e=(0,m.gettext)("Password is too short"),this.setState({errMessage:e}),!1;if(n!==r)return e=(0,m.gettext)("Passwords don't match"),this.setState({errMessage:e}),!1}return!0}},{key:"render",value:function(){var e=this;return u.default.createElement(h.Modal,{isOpen:!0,toggle:this.toggle},u.default.createElement(h.ModalHeader,{toggle:this.toggle},(0,m.gettext)("New Library")),u.default.createElement(h.ModalBody,null,u.default.createElement(h.Form,null,u.default.createElement(h.FormGroup,null,u.default.createElement(h.Label,{for:"repoName"},(0,m.gettext)("Name")),u.default.createElement(h.Input,{id:"repoName",onKeyPress:this.handleKeyPress,innerRef:function(t){e.newInput=t},value:this.state.repoName,onChange:this.handleRepoNameChange})),m.storages.length>0&&u.default.createElement(h.FormGroup,null,u.default.createElement(h.Label,{for:"storage-backend"},(0,m.gettext)("Storage Backend")),u.default.createElement(f.default,{id:"storage-backend",defaultValue:{value:m.storages[0].id,label:m.storages[0].name},options:m.storages.map(function(e,t){return{value:e.id,label:e.name}}),onChange:this.handleStorageInputChange})),m.libraryTemplates.length>0&&u.default.createElement(h.FormGroup,null,u.default.createElement(h.Label,{for:"library-templates"},(0,m.gettext)("Library Templates")),u.default.createElement(f.default,{id:"library-templates",defaultValue:{value:m.libraryTemplates[0],label:m.libraryTemplates[0]},options:m.libraryTemplates.map(function(e,t){return{value:e,label:e}}),onChange:this.handlelibraryTemplatesInputChange})),"group"===this.props.libraryType&&u.default.createElement(h.FormGroup,null,u.default.createElement(h.Label,{for:"exampleSelect"},(0,m.gettext)("Permission")),u.default.createElement(h.Input,{type:"select",name:"select",id:"exampleSelect",onChange:this.onPermissionChange,value:this.state.permission},u.default.createElement("option",{value:"rw"},(0,m.gettext)("Read-Write")),u.default.createElement("option",{value:"r"},(0,m.gettext)("Read-Only")))),m.enableEncryptedLibrary&&u.default.createElement("div",null,u.default.createElement(h.FormGroup,{check:!0},u.default.createElement(h.Input,{type:"checkbox",id:"encrypt",onChange:this.onEncrypted}),u.default.createElement(h.Label,{for:"encrypt"},(0,m.gettext)("Encrypt"))),!this.state.disabled&&u.default.createElement(h.FormGroup,null,u.default.createElement(h.Label,{for:"passwd1"},(0,m.gettext)("Password")),u.default.createElement("span",{className:"tip"}," ",(0,m.gettext)("(at least {placeholder} characters)").replace("{placeholder}",m.repoPasswordMinLength)),u.default.createElement(h.Input,{id:"passwd1",type:"password",disabled:this.state.disabled,value:this.state.password1,onChange:this.handlePassword1Change,autoComplete:"new-password"})),!this.state.disabled&&u.default.createElement(h.FormGroup,null,u.default.createElement(h.Label,{for:"passwd2"},(0,m.gettext)("Password again")),u.default.createElement(h.Input,{id:"passwd2",type:"password",disabled:this.state.disabled,value:this.state.password2,onChange:this.handlePassword2Change,autoComplete:"new-password"})))),this.state.errMessage&&u.default.createElement(h.Alert,{color:"danger"},this.state.errMessage)),u.default.createElement(h.ModalFooter,null,u.default.createElement(h.Button,{color:"secondary",onClick:this.toggle},(0,m.gettext)("Cancel")),u.default.createElement(h.Button,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive},(0,m.gettext)("Submit"))))}}]),t}(u.default.Component);y.propTypes=g,t.default=y},1024:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(2),f=n(5),h=r(f),m={hasSuffix:d.default.bool,name:d.default.string.isRequired,onRenameConfirm:d.default.func.isRequired,onRenameCancel:d.default.func.isRequired},g=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onChange=function(e){n.setState({name:e.target.value})},n.onClick=function(e){e.nativeEvent.stopImmediatePropagation()},n.onKeyPress=function(e){"Enter"===e.key&&n.onRenameConfirm(e)},n.onRenameConfirm=function(e){e.nativeEvent.stopImmediatePropagation();var t=n.state.name.trim();if(t===n.props.name)return void n.props.onRenameCancel();var r=n.validateInput(),a=r.isValid,o=r.errMessage;a?n.props.onRenameConfirm(t):h.default.danger(o)},n.onRenameCancel=function(e){e.nativeEvent.stopImmediatePropagation(),n.props.onRenameCancel()},n.validateInput=function(){var e=n.state.name.trim(),t=!0,r="";return e?e.indexOf("/")>-1?(t=!1,r=(0,p.gettext)("Name should not include '/'."),{isValid:t,errMessage:r}):{isValid:t,errMessage:r}:(t=!1,r=(0,p.gettext)("Name is required."),{isValid:t,errMessage:r})},n.state={name:e.name},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){if(this.refs.renameInput.focus(),this.props.hasSuffix){var e=this.props.name.lastIndexOf(".");this.refs.renameInput.setSelectionRange(0,e,"forward")}else this.refs.renameInput.setSelectionRange(0,-1)}},{key:"render",value:function(){return u.default.createElement("div",{className:"rename-container"},u.default.createElement("input",{ref:"renameInput",value:this.state.name,onChange:this.onChange,onKeyPress:this.onKeyPress,onClick:this.onClick}),u.default.createElement("button",{className:"btn btn-secondary sf2-icon-confirm confirm",onClick:this.onRenameConfirm}),u.default.createElement("button",{className:"btn btn-secondary sf2-icon-cancel cancel",onClick:this.onRenameCancel}))}}]),t}(u.default.Component);g.propTypes=m,t.default=g},1025:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(2),f=n(3),h=n(2256),m=r(h),g=n(5),y=r(g),v=n(847),b=r(v),w=n(8),E=r(w),S={libraryType:d.default.string,currentGroup:d.default.object,isShowTableThread:d.default.bool,sortBy:d.default.string,sortOrder:d.default.string,sortItems:d.default.func,repoList:d.default.array.isRequired,onItemUnshare:d.default.func.isRequired,onItemDelete:d.default.func,onItemDetails:d.default.func,onItemRename:d.default.func,hasNextPage:d.default.bool},C=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.sortByName=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortItems("name",t)},n.sortByTime=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortItems("time",t)},n.sortBySize=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortItems("size",t)},n.getSortMetaData=function(){return{sortByName:"name"==n.props.sortBy,sortByTime:"time"==n.props.sortBy,sortBySize:"size"==n.props.sortBy,sortIcon:"asc"==n.props.sortOrder?u.default.createElement("span",{className:"fas fa-caret-up"}):u.default.createElement("span",{className:"fas fa-caret-down"})}},n.onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.onItemRename=function(e,t){if(n.props.repoList.some(function(e){return e.name===t})){var r=(0,p.gettext)('The name "{name}" is already taken. Please choose a different name.');return r=r.replace("{name}",f.Utils.HTMLescape(t)),y.default.danger(r),!1}n.props.onItemRename(e,t)},n.renderRepoListView=function(){return u.default.createElement(l.Fragment,null,n.props.repoList.map(function(e){return u.default.createElement(m.default,{key:e.repo_id,repo:e,libraryType:n.props.libraryType,currentGroup:n.props.currentGroup,isItemFreezed:n.state.isItemFreezed,onFreezedItem:n.onFreezedItem,onUnfreezedItem:n.onUnfreezedItem,onItemUnshare:n.props.onItemUnshare,onItemDelete:n.props.onItemDelete,onItemDetails:n.props.onItemDetails,onItemRename:n.props.onItemRename})}))},n.renderPCUI=function(){var e=void 0===n.props.isShowTableThread||n.props.isShowTableThread,t=n.getSortMetaData(),r=t.sortByName,a=t.sortByTime,o=t.sortBySize,i=t.sortIcon;return u.default.createElement("table",{className:e?"":"table-thead-hidden"},u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:"4%"}),u.default.createElement("th",{width:"4%"},u.default.createElement("span",{className:"sr-only"},(0,p.gettext)("Library Type"))),u.default.createElement("th",{width:"36%"},u.default.createElement("a",{className:"d-block table-sort-op",href:"#",onClick:n.sortByName},(0,p.gettext)("Name")," ",r&&i)),u.default.createElement("th",{width:"12%"},u.default.createElement("span",{className:"sr-only"},(0,p.gettext)("Actions"))),u.default.createElement("th",{width:"14%"},u.default.createElement("a",{className:"d-block table-sort-op",href:"#",onClick:n.sortBySize},(0,p.gettext)("Size")," ",o&&i)),u.default.createElement("th",{width:"14%"},u.default.createElement("a",{className:"d-block table-sort-op",href:"#",onClick:n.sortByTime},(0,p.gettext)("Last Update")," ",a&&i)),u.default.createElement("th",{width:"16%"},(0,p.gettext)("Owner")))),u.default.createElement("tbody",null,n.renderRepoListView()))},n.renderMobileUI=function(){return u.default.createElement("table",{className:"table-thead-hidden"},u.default.createElement(b.default,null),u.default.createElement("tbody",null,n.renderRepoListView()))},n.state={isItemFreezed:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=f.Utils.isDesktop()?this.renderPCUI():this.renderMobileUI();return this.props.hasNextPage?u.default.createElement(l.Fragment,null,e,u.default.createElement(E.default,null)):e}}]),t}(u.default.Component);C.propTypes=S,t.default=C},1026:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(2),f={currentMode:d.default.string.isRequired,switchViewMode:d.default.func.isRequired},h=function(e){function t(){var e,n,r,i;a(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=r=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),r.switchViewMode=function(e){e.preventDefault();var t=e.target.id;t!==r.props.currentMode&&r.props.switchViewMode(t)},i=n,o(r,i)}return i(t,e),s(t,[{key:"render",value:function(){var e="btn btn-secondary btn-icon sf-view-mode-btn ";return u.default.createElement(u.default.Fragment,null,u.default.createElement("div",{className:"view-mode btn-group"},u.default.createElement("button",{className:e+" sf2-icon-list-view "+("list"===this.props.currentMode?"current-mode":""),id:"list",title:(0,p.gettext)("List"),onClick:this.switchViewMode}),u.default.createElement("button",{className:e+" sf2-icon-grid-view "+("grid"===this.props.currentMode?"current-mode":""),id:"grid",title:(0,p.gettext)("Grid"),onClick:this.switchViewMode}),u.default.createElement("button",{className:e+" sf2-icon-two-columns "+("column"===this.props.currentMode?"current-mode":""),id:"column",title:(0,p.gettext)("Column"),onClick:this.switchViewMode})),u.default.createElement("div",{className:"detail-btn btn-group"},u.default.createElement("button",{className:"btn btn-secondary btn-icon ml-1 fas fa-info",id:"detail",title:(0,p.gettext)("Detail"),onClick:this.switchViewMode})))}}]),t}(u.default.Component);h.propTypes=f,t.default=h},1027:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(){return s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s.apply(this,arguments)}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach(function(t){i(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function c(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e,t){return!t||"object"!==typeof t&&"function"!==typeof t?f(e):t}function m(e,t){return v(e)||w(e,t)||S()}function g(e){return y(e)||b(e)||E()}function y(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function v(e){if(Array.isArray(e))return e}function b(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function w(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw o}}return n}}function E(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function S(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function C(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e)return"";var n=e;return t&&Object.keys(t).forEach(function(e){n=n.replace(e,t[e])}),n}function D(){return"undefined"!==typeof e.window?e.window.innerWidth:0}function _(){return"undefined"!==typeof e.window?e.window.innerHeight:0}function P(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.window.self,n=t.document.referrer;if(t===e.window.top||!n)return t;var r=function(e){return e.match(/(.*\/\/.*?)(\/|$)/)[1]};return r(t.location.href)===r(n)?P(t.parent):t}var k=n(0),M=n.n(k),O=n(1),L=n.n(O),I=n(1028),T=n.n(I),R=0,N={ESC:27,LEFT_ARROW:37,RIGHT_ARROW:39},x=function(t){function n(e){var t;return r(this,n),t=h(this,d(n).call(this,e)),i(f(t),"handleWheel",function(e){e.preventDefault()}),t.state={isClosing:!e.animationDisabled,shouldAnimate:!1,zoomLevel:R,offsetX:0,offsetY:0,loadErrorStatus:{}},t.outerEl=M.a.createRef(),t.zoomInBtn=M.a.createRef(),t.zoomOutBtn=M.a.createRef(),t.caption=M.a.createRef(),t.closeIfClickInner=t.closeIfClickInner.bind(f(t)),t.handleImageDoubleClick=t.handleImageDoubleClick.bind(f(t)),t.handleImageMouseWheel=t.handleImageMouseWheel.bind(f(t)),t.handleKeyInput=t.handleKeyInput.bind(f(t)),t.handleMouseUp=t.handleMouseUp.bind(f(t)),t.handleMouseDown=t.handleMouseDown.bind(f(t)),t.handleMouseMove=t.handleMouseMove.bind(f(t)),t.handleOuterMousewheel=t.handleOuterMousewheel.bind(f(t)),t.handleTouchStart=t.handleTouchStart.bind(f(t)),t.handleTouchMove=t.handleTouchMove.bind(f(t)),t.handleTouchEnd=t.handleTouchEnd.bind(f(t)),t.handlePointerEvent=t.handlePointerEvent.bind(f(t)),t.handleCaptionMousewheel=t.handleCaptionMousewheel.bind(f(t)),t.handleWindowResize=t.handleWindowResize.bind(f(t)),t.handleZoomInButtonClick=t.handleZoomInButtonClick.bind(f(t)),t.handleZoomOutButtonClick=t.handleZoomOutButtonClick.bind(f(t)),t.requestClose=t.requestClose.bind(f(t)),t.requestMoveNext=t.requestMoveNext.bind(f(t)),t.requestMovePrev=t.requestMovePrev.bind(f(t)),t}return c(n,t),o(n,null,[{key:"isTargetMatchImage",value:function(e){return e&&/ril-image-current/.test(e.className)}},{key:"parseMouseEvent",value:function(e){return{id:"mouse",source:1,x:parseInt(e.clientX,10),y:parseInt(e.clientY,10)}}},{key:"parseTouchPointer",value:function(e){return{id:e.identifier,source:2,x:parseInt(e.clientX,10),y:parseInt(e.clientY,10)}}},{key:"parsePointerEvent",value:function(e){return{id:e.pointerId,source:3,x:parseInt(e.clientX,10),y:parseInt(e.clientY,10)}}},{key:"getTransform",value:function(e){var t=e.x,n=void 0===t?0:t,r=e.y,a=void 0===r?0:r,o=e.zoom,i=void 0===o?1:o,s=e.width,l=e.targetWidth,u=n,c=D();s>c&&(u+=(c-s)/2);var d=i*(l/s);return{transform:"translate3d(".concat(u,"px,").concat(a,"px,0) scale3d(").concat(d,",").concat(d,",1)")}}}]),o(n,[{key:"UNSAFE_componentWillMount",value:function(){this.timeouts=[],this.currentAction=0,this.eventsSource=0,this.pointerList=[],this.preventInnerClose=!1,this.preventInnerCloseTimeout=null,this.keyPressed=!1,this.imageCache={},this.lastKeyDownTime=0,this.resizeTimeout=null,this.wheelActionTimeout=null,this.resetScrollTimeout=null,this.scrollX=0,this.scrollY=0,this.moveStartX=0,this.moveStartY=0,this.moveStartOffsetX=0,this.moveStartOffsetY=0,this.swipeStartX=0,this.swipeStartY=0,this.swipeEndX=0,this.swipeEndY=0,this.pinchTouchList=null,this.pinchDistance=0,this.keyCounter=0,this.moveRequested=!1,this.props.animationDisabled||this.setState({isClosing:!1})}},{key:"componentDidMount",value:function(){var e=this;this.windowContext=P(),this.listeners={resize:this.handleWindowResize,mouseup:this.handleMouseUp,touchend:this.handleTouchEnd,touchcancel:this.handleTouchEnd,pointerdown:this.handlePointerEvent,pointermove:this.handlePointerEvent,pointerup:this.handlePointerEvent,pointercancel:this.handlePointerEvent},Object.keys(this.listeners).forEach(function(t){e.windowContext.addEventListener(t,e.listeners[t])}),document.addEventListener("wheel",this.handleWheel,{passive:!1}),this.loadAllImages()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this,n=!1,r={},a={};this.getSrcTypes().forEach(function(o){t.props[o.name]!==e[o.name]&&(n=!0,r[t.props[o.name]]=!0,a[e[o.name]]=!0)}),(n||this.moveRequested)&&(Object.keys(r).forEach(function(e){!(e in a)&&e in t.imageCache&&(t.imageCache[e].loaded=!1)}),this.moveRequested=!1,this.loadAllImages(e))}},{key:"shouldComponentUpdate",value:function(){return!this.moveRequested}},{key:"componentWillUnmount",value:function(){var e=this;this.didUnmount=!0,Object.keys(this.listeners).forEach(function(t){e.windowContext.removeEventListener(t,e.listeners[t])}),document.removeEventListener("wheel",this.handleWheel,{passive:!1}),this.timeouts.forEach(function(e){return clearTimeout(e)})}},{key:"setTimeout",value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,t){var n=this,r=setTimeout(function(){n.timeouts=n.timeouts.filter(function(e){return e!==r}),e()},t);return this.timeouts.push(r),r})},{key:"setPreventInnerClose",value:function(){var e=this;this.preventInnerCloseTimeout&&this.clearTimeout(this.preventInnerCloseTimeout),this.preventInnerClose=!0,this.preventInnerCloseTimeout=this.setTimeout(function(){e.preventInnerClose=!1,e.preventInnerCloseTimeout=null},100)}},{key:"getBestImageForType",value:function(e){var t=this.props[e],n={};if(this.isImageLoaded(t))n=this.getFitSizes(this.imageCache[t].width,this.imageCache[t].height);else{if(!this.isImageLoaded(this.props["".concat(e,"Thumbnail")]))return null;t=this.props["".concat(e,"Thumbnail")],n=this.getFitSizes(this.imageCache[t].width,this.imageCache[t].height,!0)}return{src:t,height:this.imageCache[t].height,width:this.imageCache[t].width,targetHeight:n.height,targetWidth:n.width}}},{key:"getFitSizes",value:function(e,t,n){var r=this.getLightboxRect(),a=r.height-2*this.props.imagePadding,o=r.width-2*this.props.imagePadding;return n||(a=Math.min(a,t),o=Math.min(o,e)),o/a>e/t?{width:e*a/t,height:a}:{width:o,height:t*o/e}}},{key:"getMaxOffsets",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.zoomLevel,t=this.getBestImageForType("mainSrc");if(null===t)return{maxX:0,minX:0,maxY:0,minY:0};var n=this.getLightboxRect(),r=this.getZoomMultiplier(e),a=0;a=r*t.width-n.width<0?(n.width-r*t.width)/2:(r*t.width-n.width)/2;var o=0;return o=r*t.height-n.height<0?(n.height-r*t.height)/2:(r*t.height-n.height)/2,{maxX:a,maxY:o,minX:-1*a,minY:-1*o}}},{key:"getSrcTypes",value:function(){return[{name:"mainSrc",keyEnding:"i".concat(this.keyCounter)},{name:"mainSrcThumbnail",keyEnding:"t".concat(this.keyCounter)},{name:"nextSrc",keyEnding:"i".concat(this.keyCounter+1)},{name:"nextSrcThumbnail",keyEnding:"t".concat(this.keyCounter+1)},{name:"prevSrc",keyEnding:"i".concat(this.keyCounter-1)},{name:"prevSrcThumbnail",keyEnding:"t".concat(this.keyCounter-1)}]}},{key:"getZoomMultiplier",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.zoomLevel;return Math.pow(1.007,e)}},{key:"getLightboxRect",value:function(){return this.outerEl.current?this.outerEl.current.getBoundingClientRect():{width:D(),height:_(),top:0,right:0,bottom:0,left:0}}},{key:"clearTimeout",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){this.timeouts=this.timeouts.filter(function(t){return t!==e}),clearTimeout(e)})},{key:"changeZoom",value:function(e,t,n){if(this.props.enableZoom){var r=Math.max(R,Math.min(300,e));if(r!==this.state.zoomLevel){if(r===R)return void this.setState({zoomLevel:r,offsetX:0,offsetY:0});var a=this.getBestImageForType("mainSrc");if(null!==a){var o=this.getZoomMultiplier(),i=this.getZoomMultiplier(r),s=this.getLightboxRect(),l="undefined"!==typeof t?t-s.left:s.width/2,u="undefined"!==typeof n?n-s.top:s.height/2,c=(s.width-a.width*o)/2,d=(s.height-a.height*o)/2,p=c-this.state.offsetX,f=d-this.state.offsetY,h=(l-p)/o,m=(u-f)/o,g=l-h*i,y=u-m*i,v=(s.width-a.width*i)/2,b=(s.height-a.height*i)/2,w=v-g,E=b-y;if(3!==this.currentAction){var S=this.getMaxOffsets();this.state.zoomLevel>r&&(w=Math.max(S.minX,Math.min(S.maxX,w)),E=Math.max(S.minY,Math.min(S.maxY,E)))}this.setState({zoomLevel:r,offsetX:w,offsetY:E})}}}}},{key:"closeIfClickInner",value:function(e){!this.preventInnerClose&&e.target.className.search(/\bril-inner\b/)>-1&&this.requestClose(e)}},{key:"handleKeyInput",value:function(e){if(e.stopPropagation(),!this.isAnimating()){if("keyup"===e.type)return void(this.lastKeyDownTime-=this.props.keyRepeatKeyupBonus);var t=e.which||e.keyCode,n=new Date;if(!(n.getTime()-this.lastKeyDownTime<this.props.keyRepeatLimit&&t!==N.ESC))switch(this.lastKeyDownTime=n.getTime(),t){case N.ESC:e.preventDefault(),this.requestClose(e);break;case N.LEFT_ARROW:if(!this.props.prevSrc)return;e.preventDefault(),this.keyPressed=!0,this.requestMovePrev(e);break;case N.RIGHT_ARROW:if(!this.props.nextSrc)return;e.preventDefault(),this.keyPressed=!0,this.requestMoveNext(e)}}}},{key:"handleOuterMousewheel",value:function(e){var t=this;e.stopPropagation(),this.clearTimeout(this.resetScrollTimeout),this.resetScrollTimeout=this.setTimeout(function(){t.scrollX=0,t.scrollY=0},300)}},{key:"handleImageMouseWheel",value:function(e){if(parseInt(e.deltaY)!==parseFloat(e.deltaY)){if(Math.abs(e.deltaY)>=Math.abs(e.deltaX)){if(e.stopPropagation(),Math.abs(e.deltaY)<1)return;this.scrollX=0,this.scrollY+=e.deltaY,this.changeZoom(this.state.zoomLevel-e.deltaY,e.clientX,e.clientY)}}else if(Math.abs(e.deltaY)>Math.abs(e.deltaX)){var t=this.state.offsetY+e.deltaY;this.setState({offsetY:t})}else{var n=this.state.offsetX+e.deltaX;this.setState({offsetX:n})}}},{key:"handleImageDoubleClick",value:function(e){this.state.zoomLevel>R?this.changeZoom(R,e.clientX,e.clientY):this.changeZoom(this.state.zoomLevel+100,e.clientX,e.clientY)}},{key:"shouldHandleEvent",value:function(e){if(this.eventsSource===e)return!0;if(0===this.eventsSource)return this.eventsSource=e,!0;switch(e){case 1:return!1;case 2:return this.eventsSource=2,this.filterPointersBySource(),!0;case 3:return 1===this.eventsSource&&(this.eventsSource=3,this.filterPointersBySource(),!0);default:return!1}}},{key:"addPointer",value:function(e){this.pointerList.push(e)}},{key:"removePointer",value:function(e){this.pointerList=this.pointerList.filter(function(t){return t.id!==e.id})}},{key:"filterPointersBySource",value:function(){var e=this;this.pointerList=this.pointerList.filter(function(t){return t.source===e.eventsSource})}},{key:"handleMouseDown",value:function(e){this.shouldHandleEvent(1)&&n.isTargetMatchImage(e.target)&&(this.addPointer(n.parseMouseEvent(e)),this.multiPointerStart(e))}},{key:"handleMouseMove",value:function(e){this.shouldHandleEvent(1)&&this.multiPointerMove(e,[n.parseMouseEvent(e)])}},{key:"handleMouseUp",value:function(e){this.shouldHandleEvent(1)&&(this.removePointer(n.parseMouseEvent(e)),this.multiPointerEnd(e))}},{key:"handlePointerEvent",value:function(e){if(this.shouldHandleEvent(3))switch(e.type){case"pointerdown":n.isTargetMatchImage(e.target)&&(this.addPointer(n.parsePointerEvent(e)),this.multiPointerStart(e));break;case"pointermove":this.multiPointerMove(e,[n.parsePointerEvent(e)]);break;case"pointerup":case"pointercancel":this.removePointer(n.parsePointerEvent(e)),this.multiPointerEnd(e)}}},{key:"handleTouchStart",value:function(e){var t=this;this.shouldHandleEvent(2)&&n.isTargetMatchImage(e.target)&&([].forEach.call(e.changedTouches,function(e){return t.addPointer(n.parseTouchPointer(e))}),this.multiPointerStart(e))}},{key:"handleTouchMove",value:function(e){this.shouldHandleEvent(2)&&this.multiPointerMove(e,[].map.call(e.changedTouches,function(e){return n.parseTouchPointer(e)}))}},{key:"handleTouchEnd",value:function(e){var t=this;this.shouldHandleEvent(2)&&([].map.call(e.changedTouches,function(e){return t.removePointer(n.parseTouchPointer(e))}),this.multiPointerEnd(e))}},{key:"decideMoveOrSwipe",value:function(e){this.state.zoomLevel<=R?this.handleSwipeStart(e):this.handleMoveStart(e)}},{key:"multiPointerStart",value:function(e){switch(this.handleEnd(null),this.pointerList.length){case 1:e.preventDefault(),this.decideMoveOrSwipe(this.pointerList[0]);break;case 2:e.preventDefault(),this.handlePinchStart(this.pointerList)}}},{key:"multiPointerMove",value:function(e,t){switch(this.currentAction){case 1:e.preventDefault(),this.handleMove(t[0]);break;case 2:e.preventDefault(),this.handleSwipe(t[0]);break;case 3:e.preventDefault(),this.handlePinch(t)}}},{key:"multiPointerEnd",value:function(e){switch(0!==this.currentAction&&(this.setPreventInnerClose(),this.handleEnd(e)),this.pointerList.length){case 0:this.eventsSource=0;break;case 1:e.preventDefault(),this.decideMoveOrSwipe(this.pointerList[0]);break;case 2:e.preventDefault(),this.handlePinchStart(this.pointerList)}}},{key:"handleEnd",value:function(e){switch(this.currentAction){case 1:this.handleMoveEnd(e);break;case 2:this.handleSwipeEnd(e);break;case 3:this.handlePinchEnd(e)}}},{key:"handleMoveStart",value:function(e){var t=e.x,n=e.y;this.props.enableZoom&&(this.currentAction=1,this.moveStartX=t,this.moveStartY=n,this.moveStartOffsetX=this.state.offsetX,this.moveStartOffsetY=this.state.offsetY)}},{key:"handleMove",value:function(e){var t=e.x,n=e.y,r=this.moveStartX-t+this.moveStartOffsetX,a=this.moveStartY-n+this.moveStartOffsetY;this.state.offsetX===r&&this.state.offsetY===a||this.setState({offsetX:r,offsetY:a})}},{key:"handleMoveEnd",value:function(){var e=this;this.currentAction=0,this.moveStartX=0,this.moveStartY=0,this.moveStartOffsetX=0,this.moveStartOffsetY=0;var t=this.getMaxOffsets(),n=Math.max(t.minX,Math.min(t.maxX,this.state.offsetX)),r=Math.max(t.minY,Math.min(t.maxY,this.state.offsetY));n===this.state.offsetX&&r===this.state.offsetY||(this.setState({offsetX:n,offsetY:r,shouldAnimate:!0}),this.setTimeout(function(){e.setState({shouldAnimate:!1})},this.props.animationDuration))}},{key:"handleSwipeStart",value:function(e){var t=e.x,n=e.y;this.currentAction=2,this.swipeStartX=t,this.swipeStartY=n,this.swipeEndX=t,this.swipeEndY=n}},{key:"handleSwipe",value:function(e){var t=e.x,n=e.y;this.swipeEndX=t,this.swipeEndY=n}},{key:"handleSwipeEnd",value:function(e){var t=this.swipeEndX-this.swipeStartX,n=Math.abs(t),r=Math.abs(this.swipeEndY-this.swipeStartY);if(this.currentAction=0,this.swipeStartX=0,this.swipeStartY=0,this.swipeEndX=0,this.swipeEndY=0,!(!e||this.isAnimating()||n<1.5*r)){if(n<200){if(n<this.getLightboxRect().width/4)return}t>0&&this.props.prevSrc?(e.preventDefault(),this.requestMovePrev()):t<0&&this.props.nextSrc&&(e.preventDefault(),this.requestMoveNext())}}},{key:"calculatePinchDistance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pinchTouchList,t=m(e,2),n=t[0],r=t[1];return Math.sqrt(Math.pow(n.x-r.x,2)+Math.pow(n.y-r.y,2))}},{key:"calculatePinchCenter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pinchTouchList,t=m(e,2),n=t[0],r=t[1];return{x:n.x-(n.x-r.x)/2,y:n.y-(n.y-r.y)/2}}},{key:"handlePinchStart",value:function(e){this.props.enableZoom&&(this.currentAction=3,this.pinchTouchList=e.map(function(e){return{id:e.id,x:e.x,y:e.y}}),this.pinchDistance=this.calculatePinchDistance())}},{key:"handlePinch",value:function(e){this.pinchTouchList=this.pinchTouchList.map(function(t){for(var n=0;n<e.length;n+=1)if(e[n].id===t.id)return e[n];return t});var t=this.calculatePinchDistance(),n=this.state.zoomLevel+t-this.pinchDistance;this.pinchDistance=t;var r=this.calculatePinchCenter(this.pinchTouchList),a=r.x,o=r.y;this.changeZoom(n,a,o)}},{key:"handlePinchEnd",value:function(){this.currentAction=0,this.pinchTouchList=null,this.pinchDistance=0}},{key:"handleWindowResize",value:function(){this.clearTimeout(this.resizeTimeout),this.resizeTimeout=this.setTimeout(this.forceUpdate.bind(this),100)}},{key:"handleZoomInButtonClick",value:function(){var e=this.state.zoomLevel+100;this.changeZoom(e),300===e&&this.zoomOutBtn.current.focus()}},{key:"handleZoomOutButtonClick",value:function(){var e=this.state.zoomLevel-100;this.changeZoom(e),e===R&&this.zoomInBtn.current.focus()}},{key:"handleCaptionMousewheel",value:function(e){if(e.stopPropagation(),this.caption.current){var t=this.caption.current.getBoundingClientRect(),n=t.height,r=this.caption.current,a=r.scrollHeight,o=r.scrollTop;(e.deltaY>0&&n+o>=a||e.deltaY<0&&o<=0)&&e.preventDefault()}}},{key:"isAnimating",value:function(){return this.state.shouldAnimate||this.state.isClosing}},{key:"isImageLoaded",value:function(e){return e&&e in this.imageCache&&this.imageCache[e].loaded}},{key:"loadImage",value:function(t,n,r){var a=this;if(this.isImageLoaded(n))return void this.setTimeout(function(){r()},1);var o=new e.Image;this.props.imageCrossOrigin&&(o.crossOrigin=this.props.imageCrossOrigin),o.onerror=function(e){a.props.onImageLoadError(n,t,e),a.setState(function(e){return{loadErrorStatus:u({},e.loadErrorStatus,i({},t,!0))}}),r(e)},o.onload=function(){a.props.onImageLoad(n,t,o),a.imageCache[n]={loaded:!0,width:o.width,height:o.height},r()},o.src=n}},{key:"loadAllImages",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,n=function(t,n){return function(r){r||e.props[t]!==n||e.didUnmount||e.forceUpdate()}};this.getSrcTypes().forEach(function(r){var a=r.name;t[a]&&e.state.loadErrorStatus[a]&&e.setState(function(e){return{loadErrorStatus:u({},e.loadErrorStatus,i({},a,!1))}}),t[a]&&!e.isImageLoaded(t[a])&&e.loadImage(a,t[a],n(a,t[a]))})}},{key:"requestClose",value:function(e){var t=this,n=function(){return t.props.onCloseRequest(e)};if(this.props.animationDisabled||"keydown"===e.type&&!this.props.animationOnKeyInput)return void n();this.setState({isClosing:!0}),this.setTimeout(n,this.props.animationDuration)}},{key:"requestMove",value:function(e,t){var n=this,r={zoomLevel:R,offsetX:0,offsetY:0};this.props.animationDisabled||this.keyPressed&&!this.props.animationOnKeyInput||(r.shouldAnimate=!0,this.setTimeout(function(){return n.setState({shouldAnimate:!1})},this.props.animationDuration)),this.keyPressed=!1,this.moveRequested=!0,"prev"===e?(this.keyCounter-=1,this.setState(r),this.props.onMovePrevRequest(t)):(this.keyCounter+=1,this.setState(r),this.props.onMoveNextRequest(t))}},{key:"requestMoveNext",value:function(e){this.requestMove("next",e)}},{key:"requestMovePrev",value:function(e){this.requestMove("prev",e)}},{key:"render",value:function(){var t=this,r=this.props,a=r.animationDisabled,o=r.animationDuration,i=r.clickOutsideToClose,l=r.discourageDownloads,c=r.enableZoom,d=r.imageTitle,p=r.nextSrc,f=r.prevSrc,h=r.toolbarButtons,m=r.reactModalStyle,y=r.onAfterOpen,v=r.imageCrossOrigin,b=r.reactModalProps,w=this.state,E=w.zoomLevel,S=w.offsetX,D=w.offsetY,_=w.isClosing,P=w.loadErrorStatus,k=this.getLightboxRect(),O={};!a&&this.isAnimating()&&(O=u({},O,{transition:"transform ".concat(o,"ms")}));var L={};this.getSrcTypes().forEach(function(e){var t=e.name,n=e.keyEnding;L[t]=n});var I=[],N=function(e,r,a){if(t.props[e]){var o=t.getBestImageForType(e),i=u({},O,{},n.getTransform(u({},a,{},o)));E>R&&(i.cursor="move");if(null===o&&function(e){return Object.keys(e).some(function(t){return e[t]})}(P))return void I.push(M.a.createElement("div",{className:"".concat(r," ril__image ril-errored"),style:i,key:t.props[e]+L[e]},M.a.createElement("div",{className:"ril__errorContainer"},t.props.imageLoadErrorMessage)));if(null===o){var c=M.a.createElement("div",{className:"ril-loading-circle ril__loadingCircle ril__loadingContainer__icon"},g(new Array(12)).map(function(e,t){return M.a.createElement("div",{key:t,className:"ril-loading-circle-point ril__loadingCirclePoint"})}));return void I.push(M.a.createElement("div",{className:"".concat(r," ril__image ril-not-loaded"),style:i,key:t.props[e]+L[e]},M.a.createElement("div",{className:"ril__loadingContainer"},c)))}var p=o.src;l?(i.backgroundImage="url('".concat(p,"')"),I.push(M.a.createElement("div",{className:"".concat(r," ril__image ril__imageDiscourager"),onDoubleClick:t.handleImageDoubleClick,onWheel:t.handleImageMouseWheel,style:i,key:p+L[e]},M.a.createElement("div",{className:"ril-download-blocker ril__downloadBlocker"})))):I.push(M.a.createElement("img",s({},v?{crossOrigin:v}:{},{className:"".concat(r," ril__image"),onDoubleClick:t.handleImageDoubleClick,onWheel:t.handleImageMouseWheel,onDragStart:function(e){return e.preventDefault()},style:i,src:p,key:p+L[e],alt:"string"===typeof d?d:C("Image"),draggable:!1})))}},x=this.getZoomMultiplier();N("nextSrc","ril-image-next ril__imageNext",{x:k.width}),N("mainSrc","ril-image-current",{x:-1*S,y:-1*D,zoom:x}),N("prevSrc","ril-image-prev ril__imagePrev",{x:-1*k.width});var F={overlay:u({zIndex:1e3,backgroundColor:"transparent"},m.overlay),content:u({backgroundColor:"transparent",overflow:"hidden",border:"none",borderRadius:0,padding:0,top:0,left:0,right:0,bottom:0},m.content)};return M.a.createElement(T.a,s({isOpen:!0,onRequestClose:i?this.requestClose:void 0,onAfterOpen:function(){t.outerEl.current&&t.outerEl.current.focus(),y()},style:F,contentLabel:C("Lightbox"),appElement:"undefined"!==typeof e.window?e.window.document.body:void 0},b),M.a.createElement("div",{className:"ril-outer ril__outer ril__outerAnimating ".concat(this.props.wrapperClassName," ").concat(_?"ril-closing ril__outerClosing":""),style:{transition:"opacity ".concat(o,"ms"),animationDuration:"".concat(o,"ms"),animationDirection:_?"normal":"reverse"},ref:this.outerEl,onWheel:this.handleOuterMousewheel,onMouseMove:this.handleMouseMove,onMouseDown:this.handleMouseDown,onTouchStart:this.handleTouchStart,onTouchMove:this.handleTouchMove,tabIndex:"-1",onKeyDown:this.handleKeyInput,onKeyUp:this.handleKeyInput},M.a.createElement("div",{className:"ril-inner ril__inner",onClick:i?this.closeIfClickInner:void 0},I),f&&M.a.createElement("button",{type:"button",className:"ril-prev-button ril__navButtons ril__navButtonPrev",key:"prev","aria-label":this.props.prevLabel,onClick:this.isAnimating()?void 0:this.requestMovePrev}),p&&M.a.createElement("button",{type:"button",className:"ril-next-button ril__navButtons ril__navButtonNext",key:"next","aria-label":this.props.nextLabel,onClick:this.isAnimating()?void 0:this.requestMoveNext}),M.a.createElement("div",{className:"ril-toolbar ril__toolbar"},M.a.createElement("ul",{className:"ril-toolbar-left ril__toolbarSide ril__toolbarLeftSide"},M.a.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},M.a.createElement("span",{className:"ril-toolbar__item__child ril__toolbarItemChild"},d))),M.a.createElement("ul",{className:"ril-toolbar-right ril__toolbarSide ril__toolbarRightSide"},h&&h.map(function(e,t){return M.a.createElement("li",{key:"button_".concat(t+1),className:"ril-toolbar__item ril__toolbarItem"},e)}),c&&M.a.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},M.a.createElement("button",{type:"button",key:"zoom-in","aria-label":this.props.zoomInLabel,className:["ril-zoom-in","ril__toolbarItemChild","ril__builtinButton","ril__zoomInButton"].concat(g(300===E?["ril__builtinButtonDisabled"]:[])).join(" "),ref:this.zoomInBtn,disabled:this.isAnimating()||300===E,onClick:this.isAnimating()||300===E?void 0:this.handleZoomInButtonClick})),c&&M.a.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},M.a.createElement("button",{type:"button",key:"zoom-out","aria-label":this.props.zoomOutLabel,className:["ril-zoom-out","ril__toolbarItemChild","ril__builtinButton","ril__zoomOutButton"].concat(g(E===R?["ril__builtinButtonDisabled"]:[])).join(" "),ref:this.zoomOutBtn,disabled:this.isAnimating()||E===R,onClick:this.isAnimating()||E===R?void 0:this.handleZoomOutButtonClick})),M.a.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},M.a.createElement("button",{type:"button",key:"close","aria-label":this.props.closeLabel,className:"ril-close ril-toolbar__item__child ril__toolbarItemChild ril__builtinButton ril__closeButton",onClick:this.isAnimating()?void 0:this.requestClose})))),this.props.imageCaption&&M.a.createElement("div",{onWheel:this.handleCaptionMousewheel,onMouseDown:function(e){return e.stopPropagation()},className:"ril-caption ril__caption",ref:this.caption},M.a.createElement("div",{className:"ril-caption-content ril__captionContent"},this.props.imageCaption))))}}]),n}(k.Component);x.propTypes={mainSrc:L.a.string.isRequired,prevSrc:L.a.string,nextSrc:L.a.string,mainSrcThumbnail:L.a.string,prevSrcThumbnail:L.a.string,nextSrcThumbnail:L.a.string,onCloseRequest:L.a.func.isRequired,onMovePrevRequest:L.a.func,onMoveNextRequest:L.a.func,onImageLoadError:L.a.func,onImageLoad:L.a.func,onAfterOpen:L.a.func,discourageDownloads:L.a.bool,animationDisabled:L.a.bool,animationOnKeyInput:L.a.bool,animationDuration:L.a.number,keyRepeatLimit:L.a.number,keyRepeatKeyupBonus:L.a.number,imageTitle:L.a.node,imageCaption:L.a.node,imageCrossOrigin:L.a.string,reactModalStyle:L.a.object,imagePadding:L.a.number,wrapperClassName:L.a.string,toolbarButtons:L.a.arrayOf(L.a.node),clickOutsideToClose:L.a.bool,enableZoom:L.a.bool,reactModalProps:L.a.shape({}),nextLabel:L.a.string,prevLabel:L.a.string,zoomInLabel:L.a.string,zoomOutLabel:L.a.string,closeLabel:L.a.string,imageLoadErrorMessage:L.a.node},x.defaultProps={imageTitle:null,imageCaption:null,toolbarButtons:null,reactModalProps:{},animationDisabled:!1,animationDuration:300,animationOnKeyInput:!1,clickOutsideToClose:!0,closeLabel:"Close lightbox",discourageDownloads:!1,enableZoom:!0,imagePadding:10,imageCrossOrigin:null,keyRepeatKeyupBonus:40,keyRepeatLimit:180,mainSrcThumbnail:null,nextLabel:"Next image",nextSrc:null,nextSrcThumbnail:null,onAfterOpen:function(){},onImageLoadError:function(){},onImageLoad:function(){},onMoveNextRequest:function(){},onMovePrevRequest:function(){},prevLabel:"Previous image",prevSrc:null,prevSrcThumbnail:null,reactModalStyle:{},wrapperClassName:"",zoomInLabel:"Zoom in",zoomOutLabel:"Zoom out",imageLoadErrorMessage:"This image failed to load"},t.default=x}.call(t,n(30))},1028:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1029),a=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=a.default,e.exports=t.default},1029:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){return e()}Object.defineProperty(t,"__esModule",{value:!0}),t.bodyOpenClassName=t.portalClassName=void 0;var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),d=r(c),p=n(10),f=r(p),h=n(1),m=r(h),g=n(1030),y=r(g),v=n(749),b=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(v),w=n(390),E=r(w),S=n(87),C=t.portalClassName="ReactModalPortal",D=t.bodyOpenClassName="ReactModal__Body--open",_=void 0!==f.default.createPortal,P=function(){return _?f.default.createPortal:f.default.unstable_renderSubtreeIntoContainer},k=function(e){function t(){var e,n,r,i;a(this,t);for(var u=arguments.length,c=Array(u),p=0;p<u;p++)c[p]=arguments[p];return n=r=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),r.removePortal=function(){!_&&f.default.unmountComponentAtNode(r.node),s(r.props.parentSelector).removeChild(r.node)},r.portalRef=function(e){r.portal=e},r.renderPortal=function(e){var n=P(),a=n(r,d.default.createElement(y.default,l({defaultStyles:t.defaultStyles},e)),r.node);r.portalRef(a)},i=n,o(r,i)}return i(t,e),u(t,[{key:"componentDidMount",value:function(){if(w.canUseDOM){_||(this.node=document.createElement("div")),this.node.className=this.props.portalClassName;s(this.props.parentSelector).appendChild(this.node),!_&&this.renderPortal(this.props)}}},{key:"getSnapshotBeforeUpdate",value:function(e){return{prevParent:s(e.parentSelector),nextParent:s(this.props.parentSelector)}}},{key:"componentDidUpdate",value:function(e,t,n){if(w.canUseDOM){var r=this.props,a=r.isOpen,o=r.portalClassName;e.portalClassName!==o&&(this.node.className=o);var i=n.prevParent,s=n.nextParent;s!==i&&(i.removeChild(this.node),s.appendChild(this.node)),(e.isOpen||a)&&!_&&this.renderPortal(this.props)}}},{key:"componentWillUnmount",value:function(){if(w.canUseDOM&&this.node&&this.portal){var e=this.portal.state,t=Date.now(),n=e.isOpen&&this.props.closeTimeoutMS&&(e.closesAt||t+this.props.closeTimeoutMS);n?(e.beforeClose||this.portal.closeWithTimeout(),setTimeout(this.removePortal,n-t)):this.removePortal()}}},{key:"render",value:function(){return w.canUseDOM&&_?(!this.node&&_&&(this.node=document.createElement("div")),P()(d.default.createElement(y.default,l({ref:this.portalRef,defaultStyles:t.defaultStyles},this.props)),this.node)):null}}],[{key:"setAppElement",value:function(e){b.setElement(e)}}]),t}(c.Component);k.propTypes={isOpen:m.default.bool.isRequired,style:m.default.shape({content:m.default.object,overlay:m.default.object}),portalClassName:m.default.string,bodyOpenClassName:m.default.string,htmlOpenClassName:m.default.string,className:m.default.oneOfType([m.default.string,m.default.shape({base:m.default.string.isRequired,afterOpen:m.default.string.isRequired,beforeClose:m.default.string.isRequired})]),overlayClassName:m.default.oneOfType([m.default.string,m.default.shape({base:m.default.string.isRequired,afterOpen:m.default.string.isRequired,beforeClose:m.default.string.isRequired})]),appElement:m.default.instanceOf(E.default),onAfterOpen:m.default.func,onRequestClose:m.default.func,closeTimeoutMS:m.default.number,ariaHideApp:m.default.bool,shouldFocusAfterRender:m.default.bool,shouldCloseOnOverlayClick:m.default.bool,shouldReturnFocusAfterClose:m.default.bool,parentSelector:m.default.func,aria:m.default.object,data:m.default.object,role:m.default.string,contentLabel:m.default.string,shouldCloseOnEsc:m.default.bool,overlayRef:m.default.func,contentRef:m.default.func},k.defaultProps={isOpen:!1,portalClassName:C,bodyOpenClassName:D,role:"dialog",ariaHideApp:!0,closeTimeoutMS:0,shouldFocusAfterRender:!0,shouldCloseOnEsc:!0,shouldCloseOnOverlayClick:!0,shouldReturnFocusAfterClose:!0,parentSelector:function(){return document.body}},k.defaultStyles={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.75)"},content:{position:"absolute",top:"40px",left:"40px",right:"40px",bottom:"40px",border:"1px solid #ccc",background:"#fff",overflow:"auto",WebkitOverflowScrolling:"touch",borderRadius:"4px",outline:"none",padding:"20px"}},(0,S.polyfill)(k),t.default=k},1030:function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function s(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n(0),p=a(d),f=n(1),h=a(f),m=n(1031),g=r(m),y=n(1032),v=a(y),b=n(749),w=r(b),E=n(1035),S=r(E),C=n(390),D=a(C),_={overlay:"ReactModal__Overlay",content:"ReactModal__Content"},P=9,k=27,M=0,O=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.setOverlayRef=function(e){n.overlay=e,n.props.overlayRef&&n.props.overlayRef(e)},n.setContentRef=function(e){n.content=e,n.props.contentRef&&n.props.contentRef(e)},n.afterClose=function(){var e=n.props,t=e.appElement,r=e.ariaHideApp,a=e.htmlOpenClassName,o=e.bodyOpenClassName;o&&S.remove(document.body,o),a&&S.remove(document.getElementsByTagName("html")[0],a),r&&M>0&&0===(M-=1)&&w.show(t),n.props.shouldFocusAfterRender&&(n.props.shouldReturnFocusAfterClose?(g.returnFocus(),g.teardownScopedFocus()):g.popWithoutFocus()),n.props.onAfterClose&&n.props.onAfterClose()},n.open=function(){n.beforeOpen(),n.state.afterOpen&&n.state.beforeClose?(clearTimeout(n.closeTimer),n.setState({beforeClose:!1})):(n.props.shouldFocusAfterRender&&(g.setupScopedFocus(n.node),g.markForFocusLater()),n.setState({isOpen:!0},function(){n.setState({afterOpen:!0}),n.props.isOpen&&n.props.onAfterOpen&&n.props.onAfterOpen({overlayEl:n.overlay,contentEl:n.content})}))},n.close=function(){n.props.closeTimeoutMS>0?n.closeWithTimeout():n.closeWithoutTimeout()},n.focusContent=function(){return n.content&&!n.contentHasFocus()&&n.content.focus()},n.closeWithTimeout=function(){var e=Date.now()+n.props.closeTimeoutMS;n.setState({beforeClose:!0,closesAt:e},function(){n.closeTimer=setTimeout(n.closeWithoutTimeout,n.state.closesAt-Date.now())})},n.closeWithoutTimeout=function(){n.setState({beforeClose:!1,isOpen:!1,afterOpen:!1,closesAt:null},n.afterClose)},n.handleKeyDown=function(e){e.keyCode===P&&(0,v.default)(n.content,e),n.props.shouldCloseOnEsc&&e.keyCode===k&&(e.stopPropagation(),n.requestClose(e))},n.handleOverlayOnClick=function(e){null===n.shouldClose&&(n.shouldClose=!0),n.shouldClose&&n.props.shouldCloseOnOverlayClick&&(n.ownerHandlesClose()?n.requestClose(e):n.focusContent()),n.shouldClose=null},n.handleContentOnMouseUp=function(){n.shouldClose=!1},n.handleOverlayOnMouseDown=function(e){n.props.shouldCloseOnOverlayClick||e.target!=n.overlay||e.preventDefault()},n.handleContentOnClick=function(){n.shouldClose=!1},n.handleContentOnMouseDown=function(){n.shouldClose=!1},n.requestClose=function(e){return n.ownerHandlesClose()&&n.props.onRequestClose(e)},n.ownerHandlesClose=function(){return n.props.onRequestClose},n.shouldBeClosed=function(){return!n.state.isOpen&&!n.state.beforeClose},n.contentHasFocus=function(){return document.activeElement===n.content||n.content.contains(document.activeElement)},n.buildClassName=function(e,t){var r="object"===("undefined"===typeof t?"undefined":u(t))?t:{base:_[e],afterOpen:_[e]+"--after-open",beforeClose:_[e]+"--before-close"},a=r.base;return n.state.afterOpen&&(a=a+" "+r.afterOpen),n.state.beforeClose&&(a=a+" "+r.beforeClose),"string"===typeof t&&t?a+" "+t:a},n.attributesFromObject=function(e,t){return Object.keys(t).reduce(function(n,r){return n[e+"-"+r]=t[r],n},{})},n.state={afterOpen:!1,beforeClose:!1},n.shouldClose=null,n.moveFromContentToOverlay=null,n}return s(t,e),c(t,[{key:"componentDidMount",value:function(){this.props.isOpen&&this.open()}},{key:"componentDidUpdate",value:function(e,t){this.props.isOpen&&!e.isOpen?this.open():!this.props.isOpen&&e.isOpen&&this.close(),this.props.shouldFocusAfterRender&&this.state.isOpen&&!t.isOpen&&this.focusContent()}},{key:"componentWillUnmount",value:function(){this.state.isOpen&&this.afterClose(),clearTimeout(this.closeTimer)}},{key:"beforeOpen",value:function(){var e=this.props,t=e.appElement,n=e.ariaHideApp,r=e.htmlOpenClassName,a=e.bodyOpenClassName;a&&S.add(document.body,a),r&&S.add(document.getElementsByTagName("html")[0],r),n&&(M+=1,w.hide(t))}},{key:"render",value:function(){var e=this.props,t=e.id,n=e.className,r=e.overlayClassName,a=e.defaultStyles,o=n?{}:a.content,i=r?{}:a.overlay;return this.shouldBeClosed()?null:p.default.createElement("div",{ref:this.setOverlayRef,className:this.buildClassName("overlay",r),style:l({},i,this.props.style.overlay),onClick:this.handleOverlayOnClick,onMouseDown:this.handleOverlayOnMouseDown},p.default.createElement("div",l({id:t,ref:this.setContentRef,style:l({},o,this.props.style.content),className:this.buildClassName("content",n),tabIndex:"-1",onKeyDown:this.handleKeyDown,onMouseDown:this.handleContentOnMouseDown,onMouseUp:this.handleContentOnMouseUp,onClick:this.handleContentOnClick,role:this.props.role,"aria-label":this.props.contentLabel},this.attributesFromObject("aria",this.props.aria||{}),this.attributesFromObject("data",this.props.data||{}),{"data-testid":this.props.testId}),this.props.children))}}]),t}(d.Component);O.defaultProps={style:{overlay:{},content:{}},defaultStyles:{}},O.propTypes={isOpen:h.default.bool.isRequired,defaultStyles:h.default.shape({content:h.default.object,overlay:h.default.object}),style:h.default.shape({content:h.default.object,overlay:h.default.object}),className:h.default.oneOfType([h.default.string,h.default.object]),overlayClassName:h.default.oneOfType([h.default.string,h.default.object]),bodyOpenClassName:h.default.string,htmlOpenClassName:h.default.string,ariaHideApp:h.default.bool,appElement:h.default.instanceOf(D.default),onAfterOpen:h.default.func,onAfterClose:h.default.func,onRequestClose:h.default.func,closeTimeoutMS:h.default.number,shouldFocusAfterRender:h.default.bool,shouldCloseOnOverlayClick:h.default.bool,shouldReturnFocusAfterClose:h.default.bool,role:h.default.string,contentLabel:h.default.string,aria:h.default.object,data:h.default.object,children:h.default.node,shouldCloseOnEsc:h.default.bool,overlayRef:h.default.func,contentRef:h.default.func,id:h.default.string,testId:h.default.string},t.default=O,e.exports=t.default},1031:function(e,t,n){"use strict";function r(){h=!0}function a(){if(h){if(h=!1,!f)return;setTimeout(function(){if(!f.contains(document.activeElement)){((0,d.default)(f)[0]||f).focus()}},0)}}function o(){p.push(document.activeElement)}function i(){var e=null;try{return void(0!==p.length&&(e=p.pop(),e.focus()))}catch(t){console.warn(["You tried to return focus to",e,"but it is not in the DOM anymore"].join(" "))}}function s(){p.length>0&&p.pop()}function l(e){f=e,window.addEventListener?(window.addEventListener("blur",r,!1),document.addEventListener("focus",a,!0)):(window.attachEvent("onBlur",r),document.attachEvent("onFocus",a))}function u(){f=null,window.addEventListener?(window.removeEventListener("blur",r),document.removeEventListener("focus",a)):(window.detachEvent("onBlur",r),document.detachEvent("onFocus",a))}Object.defineProperty(t,"__esModule",{value:!0}),t.handleBlur=r,t.handleFocus=a,t.markForFocusLater=o,t.returnFocus=i,t.popWithoutFocus=s,t.setupScopedFocus=l,t.teardownScopedFocus=u;var c=n(748),d=function(e){return e&&e.__esModule?e:{default:e}}(c),p=[],f=null,h=!1},1032:function(e,t,n){"use strict";function r(e,t){var n=(0,o.default)(e);if(!n.length)return void t.preventDefault();var r=t.shiftKey,a=n[0],i=n[n.length-1];if(e===document.activeElement){if(!r)return;s=i}var s;if(i!==document.activeElement||r||(s=a),a===document.activeElement&&r&&(s=i),s)return t.preventDefault(),void s.focus();var l=/(\bChrome\b|\bSafari\b)\//.exec(navigator.userAgent);if(null!=l&&"Chrome"!=l[1]&&null==/\biPod\b|\biPad\b/g.exec(navigator.userAgent)){var u=n.indexOf(document.activeElement);if(u>-1&&(u+=r?-1:1),"undefined"===typeof n[u])return t.preventDefault(),s=r?i:a,void s.focus();t.preventDefault(),n[u].focus()}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var a=n(748),o=function(e){return e&&e.__esModule?e:{default:e}}(a);e.exports=t.default},1033:function(e,t,n){"use strict";var r=function(){};e.exports=r},1034:function(e,t,n){var r;!function(){"use strict";var a=!("undefined"===typeof window||!window.document||!window.document.createElement),o={canUseDOM:a,canUseWorkers:"undefined"!==typeof Worker,canUseEventListeners:a&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:a&&!!window.screen};void 0!==(r=function(){return o}.call(t,n,t,e))&&(e.exports=r)}()},1035:function(e,t,n){"use strict";function r(){}Object.defineProperty(t,"__esModule",{value:!0}),t.dumpClassLists=r;var a={},o={},i=function(e,t){return e[t]||(e[t]=0),e[t]+=1,t},s=function(e,t){return e[t]&&(e[t]-=1),t},l=function(e,t,n){n.forEach(function(n){i(t,n),e.add(n)})},u=function(e,t,n){n.forEach(function(n){s(t,n),0===t[n]&&e.remove(n)})};t.add=function(e,t){return l(e.classList,"html"==e.nodeName.toLowerCase()?a:o,t.split(" "))},t.remove=function(e,t){return u(e.classList,"html"==e.nodeName.toLowerCase()?a:o,t.split(" "))}},1036:function(e,t){},1037:function(e,t,n){(function(t){!function(){var r=n(2282),a=n(1320).utf8,o=n(1320).bin,i=function(e,n){e.constructor==String?e=n&&"binary"===n.encoding?o.stringToBytes(e):a.stringToBytes(e):"undefined"!=typeof t&&"function"==typeof t.isBuffer&&t.isBuffer(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||(e=e.toString());for(var s=r.bytesToWords(e),l=8*e.length,u=1732584193,c=-271733879,d=-1732584194,p=271733878,f=0;f<s.length;f++)s[f]=16711935&(s[f]<<8|s[f]>>>24)|4278255360&(s[f]<<24|s[f]>>>8);s[l>>>5]|=128<<l%32,s[14+(l+64>>>9<<4)]=l;for(var h=i._ff,m=i._gg,g=i._hh,y=i._ii,f=0;f<s.length;f+=16){var v=u,b=c,w=d,E=p;u=h(u,c,d,p,s[f+0],7,-680876936),p=h(p,u,c,d,s[f+1],12,-389564586),d=h(d,p,u,c,s[f+2],17,606105819),c=h(c,d,p,u,s[f+3],22,-1044525330),u=h(u,c,d,p,s[f+4],7,-176418897),p=h(p,u,c,d,s[f+5],12,1200080426),d=h(d,p,u,c,s[f+6],17,-1473231341),c=h(c,d,p,u,s[f+7],22,-45705983),u=h(u,c,d,p,s[f+8],7,1770035416),p=h(p,u,c,d,s[f+9],12,-1958414417),d=h(d,p,u,c,s[f+10],17,-42063),c=h(c,d,p,u,s[f+11],22,-1990404162),u=h(u,c,d,p,s[f+12],7,1804603682),p=h(p,u,c,d,s[f+13],12,-40341101),d=h(d,p,u,c,s[f+14],17,-1502002290),c=h(c,d,p,u,s[f+15],22,1236535329),u=m(u,c,d,p,s[f+1],5,-165796510),p=m(p,u,c,d,s[f+6],9,-1069501632),d=m(d,p,u,c,s[f+11],14,643717713),c=m(c,d,p,u,s[f+0],20,-373897302),u=m(u,c,d,p,s[f+5],5,-701558691),p=m(p,u,c,d,s[f+10],9,38016083),d=m(d,p,u,c,s[f+15],14,-660478335),c=m(c,d,p,u,s[f+4],20,-405537848),u=m(u,c,d,p,s[f+9],5,568446438),p=m(p,u,c,d,s[f+14],9,-1019803690),d=m(d,p,u,c,s[f+3],14,-187363961),c=m(c,d,p,u,s[f+8],20,1163531501),u=m(u,c,d,p,s[f+13],5,-1444681467),p=m(p,u,c,d,s[f+2],9,-51403784),d=m(d,p,u,c,s[f+7],14,1735328473),c=m(c,d,p,u,s[f+12],20,-1926607734),u=g(u,c,d,p,s[f+5],4,-378558),p=g(p,u,c,d,s[f+8],11,-2022574463),d=g(d,p,u,c,s[f+11],16,1839030562),c=g(c,d,p,u,s[f+14],23,-35309556),u=g(u,c,d,p,s[f+1],4,-1530992060),p=g(p,u,c,d,s[f+4],11,1272893353),d=g(d,p,u,c,s[f+7],16,-155497632),c=g(c,d,p,u,s[f+10],23,-1094730640),u=g(u,c,d,p,s[f+13],4,681279174),p=g(p,u,c,d,s[f+0],11,-358537222),d=g(d,p,u,c,s[f+3],16,-722521979),c=g(c,d,p,u,s[f+6],23,76029189),u=g(u,c,d,p,s[f+9],4,-640364487),p=g(p,u,c,d,s[f+12],11,-421815835),d=g(d,p,u,c,s[f+15],16,530742520),c=g(c,d,p,u,s[f+2],23,-995338651),u=y(u,c,d,p,s[f+0],6,-198630844),p=y(p,u,c,d,s[f+7],10,1126891415),d=y(d,p,u,c,s[f+14],15,-1416354905),c=y(c,d,p,u,s[f+5],21,-57434055),u=y(u,c,d,p,s[f+12],6,1700485571),p=y(p,u,c,d,s[f+3],10,-1894986606),d=y(d,p,u,c,s[f+10],15,-1051523),c=y(c,d,p,u,s[f+1],21,-2054922799),u=y(u,c,d,p,s[f+8],6,1873313359),p=y(p,u,c,d,s[f+15],10,-30611744),d=y(d,p,u,c,s[f+6],15,-1560198380),c=y(c,d,p,u,s[f+13],21,1309151649),u=y(u,c,d,p,s[f+4],6,-145523070),p=y(p,u,c,d,s[f+11],10,-1120210379),d=y(d,p,u,c,s[f+2],15,718787259),c=y(c,d,p,u,s[f+9],21,-343485551),u=u+v>>>0,c=c+b>>>0,d=d+w>>>0,p=p+E>>>0}return r.endian([u,c,d,p])};i._ff=function(e,t,n,r,a,o,i){var s=e+(t&n|~t&r)+(a>>>0)+i;return(s<<o|s>>>32-o)+t},i._gg=function(e,t,n,r,a,o,i){var s=e+(t&r|n&~r)+(a>>>0)+i;return(s<<o|s>>>32-o)+t},i._hh=function(e,t,n,r,a,o,i){var s=e+(t^n^r)+(a>>>0)+i;return(s<<o|s>>>32-o)+t},i._ii=function(e,t,n,r,a,o,i){var s=e+(n^(t|~r))+(a>>>0)+i;return(s<<o|s>>>32-o)+t},i._blocksize=16,i._digestsize=16,e.exports=function(e,t){if("undefined"!=typeof e){var n=r.wordsToBytes(i(e,t));return t&&t.asBytes?n:t&&t.asString?o.bytesToString(n):r.bytesToHex(n)}}}()}).call(t,n(29).Buffer)},1038:function(e,t){},106:function(e,t,n){function r(e){if(e)return a(e)}function a(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}e.exports=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var r,a=0;a<n.length;a++)if((r=n[a])===t||r.fn===t){n.splice(a,1);break}return this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n){n=n.slice(0);for(var r=0,a=n.length;r<a;++r)n[r].apply(this,t)}return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},107:function(e,t,n){function r(e,n){return n("b"+t.packets[e.type]+e.data.data)}function a(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var a=e.data,o=new Uint8Array(a),i=new Uint8Array(1+a.byteLength);i[0]=v[e.type];for(var s=0;s<o.length;s++)i[s+1]=o[s];return r(i.buffer)}function o(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var a=new FileReader;return a.onload=function(){t.encodePacket({type:e.type,data:a.result},n,!0,r)},a.readAsArrayBuffer(e.data)}function i(e,n,r){if(!n)return t.encodeBase64Packet(e,r);if(y)return o(e,n,r);var a=new Uint8Array(1);return a[0]=v[e.type],r(new E([a.buffer,e.data]))}function s(e){try{e=h.decode(e,{strict:!1})}catch(e){return!1}return e}function l(e,t,n){for(var r=new Array(e.length),a=f(e.length,n),o=0;o<e.length;o++)!function(e,n,a){t(n,function(t,n){r[e]=n,a(t,r)})}(o,e[o],a)}var u,c=n(712),d=n(350),p=n(714),f=n(715),h=n(716);"undefined"!==typeof ArrayBuffer&&(u=n(717));var m="undefined"!==typeof navigator&&/Android/i.test(navigator.userAgent),g="undefined"!==typeof navigator&&/PhantomJS/i.test(navigator.userAgent),y=m||g;t.protocol=3;var v=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},b=c(v),w={type:"error",data:"parser error"},E=n(718);t.encodePacket=function(e,t,n,o){"function"===typeof t&&(o=t,t=!1),"function"===typeof n&&(o=n,n=null);var s=void 0===e.data?void 0:e.data.buffer||e.data;if("undefined"!==typeof ArrayBuffer&&s instanceof ArrayBuffer)return a(e,t,o);if("undefined"!==typeof E&&s instanceof E)return i(e,t,o);if(s&&s.base64)return r(e,o);var l=v[e.type];return void 0!==e.data&&(l+=n?h.encode(String(e.data),{strict:!1}):String(e.data)),o(""+l)},t.encodeBase64Packet=function(e,n){var r="b"+t.packets[e.type];if("undefined"!==typeof E&&e.data instanceof E){var a=new FileReader;return a.onload=function(){var e=a.result.split(",")[1];n(r+e)},a.readAsDataURL(e.data)}var o;try{o=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(t){for(var i=new Uint8Array(e.data),s=new Array(i.length),l=0;l<i.length;l++)s[l]=i[l];o=String.fromCharCode.apply(null,s)}return r+=btoa(o),n(r)},t.decodePacket=function(e,n,r){if(void 0===e)return w;if("string"===typeof e){if("b"===e.charAt(0))return t.decodeBase64Packet(e.substr(1),n);if(r&&!1===(e=s(e)))return w;var a=e.charAt(0);return Number(a)==a&&b[a]?e.length>1?{type:b[a],data:e.substring(1)}:{type:b[a]}:w}var o=new Uint8Array(e),a=o[0],i=p(e,1);return E&&"blob"===n&&(i=new E([i])),{type:b[a],data:i}},t.decodeBase64Packet=function(e,t){var n=b[e.charAt(0)];if(!u)return{type:n,data:{base64:!0,data:e.substr(1)}};var r=u.decode(e.substr(1));return"blob"===t&&E&&(r=new E([r])),{type:n,data:r}},t.encodePayload=function(e,n,r){function a(e){return e.length+":"+e}function o(e,r){t.encodePacket(e,!!i&&n,!1,function(e){r(null,a(e))})}"function"===typeof n&&(r=n,n=null);var i=d(e);return n&&i?E&&!y?t.encodePayloadAsBlob(e,r):t.encodePayloadAsArrayBuffer(e,r):e.length?void l(e,o,function(e,t){return r(t.join(""))}):r("0:")},t.decodePayload=function(e,n,r){if("string"!==typeof e)return t.decodePayloadAsBinary(e,n,r);"function"===typeof n&&(r=n,n=null);var a;if(""===e)return r(w,0,1);for(var o,i,s="",l=0,u=e.length;l<u;l++){var c=e.charAt(l);if(":"===c){if(""===s||s!=(o=Number(s)))return r(w,0,1);if(i=e.substr(l+1,o),s!=i.length)return r(w,0,1);if(i.length){if(a=t.decodePacket(i,n,!1),w.type===a.type&&w.data===a.data)return r(w,0,1);if(!1===r(a,l+o,u))return}l+=o,s=""}else s+=c}return""!==s?r(w,0,1):void 0},t.encodePayloadAsArrayBuffer=function(e,n){function r(e,n){t.encodePacket(e,!0,!0,function(e){return n(null,e)})}if(!e.length)return n(new ArrayBuffer(0));l(e,r,function(e,t){var r=t.reduce(function(e,t){var n;return n="string"===typeof t?t.length:t.byteLength,e+n.toString().length+n+2},0),a=new Uint8Array(r),o=0;return t.forEach(function(e){var t="string"===typeof e,n=e;if(t){for(var r=new Uint8Array(e.length),i=0;i<e.length;i++)r[i]=e.charCodeAt(i);n=r.buffer}a[o++]=t?0:1;for(var s=n.byteLength.toString(),i=0;i<s.length;i++)a[o++]=parseInt(s[i]);a[o++]=255;for(var r=new Uint8Array(n),i=0;i<r.length;i++)a[o++]=r[i]}),n(a.buffer)})},t.encodePayloadAsBlob=function(e,n){function r(e,n){t.encodePacket(e,!0,!0,function(e){var t=new Uint8Array(1);if(t[0]=1,"string"===typeof e){for(var r=new Uint8Array(e.length),a=0;a<e.length;a++)r[a]=e.charCodeAt(a);e=r.buffer,t[0]=0}for(var o=e instanceof ArrayBuffer?e.byteLength:e.size,i=o.toString(),s=new Uint8Array(i.length+1),a=0;a<i.length;a++)s[a]=parseInt(i[a]);if(s[i.length]=255,E){var l=new E([t.buffer,s.buffer,e]);n(null,l)}})}l(e,r,function(e,t){return n(new E(t))})},t.decodePayloadAsBinary=function(e,n,r){"function"===typeof n&&(r=n,n=null);for(var a=e,o=[];a.byteLength>0;){for(var i=new Uint8Array(a),s=0===i[0],l="",u=1;255!==i[u];u++){if(l.length>310)return r(w,0,1);l+=i[u]}a=p(a,2+l.length),l=parseInt(l);var c=p(a,0,l);if(s)try{c=String.fromCharCode.apply(null,new Uint8Array(c))}catch(e){var d=new Uint8Array(c);c="";for(var u=0;u<d.length;u++)c+=String.fromCharCode(d[u])}o.push(c),a=p(a,l)}var f=o.length;o.forEach(function(e,a){r(t.decodePacket(e,n,!0),a,f)})}},108:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=r(u),d=n(1),p=r(d),f=n(6),h=n(2),m=n(187),g=r(m),y=n(189),v=r(y),b=n(190),w=r(b),E=n(191),S=r(E),C=n(192),D=r(C),_=n(193),P=r(_),k=n(4),M=n(8),O=r(M),L=n(3),I=n(5),T=r(I);n(147);var R={isGroupOwnedRepo:p.default.bool,itemType:p.default.string.isRequired,itemName:p.default.string.isRequired,itemPath:p.default.string.isRequired,toggleDialog:p.default.func.isRequired,repoID:p.default.string.isRequired,repoEncrypted:p.default.bool,userPerm:p.default.string,enableDirPrivateShare:p.default.bool},N=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getInitialActiveTab=function(){var e=n.props,t=e.repoEncrypted,r=e.userPerm,a=e.enableDirPrivateShare,o=e.itemType,i=!t&&h.canGenerateShareLink,s=!t&&h.canGenerateUploadLink&&"rw"==r;return t&&(a="library"==o),i?"shareLink":s?"uploadLink":"file"==o||"dir"==o?"internalLink":a?"shareToUser":void 0},n.toggle=function(e){n.state.activeTab!==e&&n.setState({activeTab:e})},n.renderDirContent=function(){if(!n.state.isRepoJudgemented)return c.default.createElement(O.default,null);var e=n.state.activeTab,t=n.props,r=t.repoEncrypted,a=t.userPerm,o=t.enableDirPrivateShare,i=t.itemType,s=!r&&h.canGenerateShareLink,l=!r&&h.canGenerateUploadLink&&"rw"==a;return r&&(o="library"==i),c.default.createElement(u.Fragment,null,c.default.createElement("div",{className:"share-dialog-side"},c.default.createElement(f.Nav,{pills:!0},s&&c.default.createElement(f.NavItem,null,c.default.createElement(f.NavLink,{className:"shareLink"===e?"active":"",onClick:n.toggle.bind(n,"shareLink")},(0,h.gettext)("Share Link"))),l&&c.default.createElement(f.NavItem,null,c.default.createElement(f.NavLink,{className:"uploadLink"===e?"active":"",onClick:n.toggle.bind(n,"uploadLink")},(0,h.gettext)("Upload Link"))),"dir"===i&&c.default.createElement(f.NavItem,null,c.default.createElement(f.NavLink,{className:"internalLink"===e?"active":"",onClick:n.toggle.bind(n,"internalLink")},(0,h.gettext)("Internal Link"))),o&&c.default.createElement(u.Fragment,null,c.default.createElement(f.NavItem,null,c.default.createElement(f.NavLink,{className:"shareToUser"===e?"active":"",onClick:n.toggle.bind(n,"shareToUser")},(0,h.gettext)("Share to user"))),c.default.createElement(f.NavItem,null,c.default.createElement(f.NavLink,{className:"shareToGroup"===e?"active":"",onClick:n.toggle.bind(n,"shareToGroup")},(0,h.gettext)("Share to group"))),h.canInvitePeople&&c.default.createElement(f.NavItem,null,c.default.createElement(f.NavLink,{className:"invitePeople"===e?"active":"",onClick:n.toggle.bind(n,"invitePeople")},(0,h.gettext)("Invite Guest")))))),c.default.createElement("div",{className:"share-dialog-main"},c.default.createElement(f.TabContent,{activeTab:n.state.activeTab},s&&"shareLink"===e&&c.default.createElement(f.TabPane,{tabId:"shareLink"},c.default.createElement(S.default,{itemPath:n.props.itemPath,repoID:n.props.repoID,closeShareDialog:n.props.toggleDialog,itemType:i})),l&&"uploadLink"===e&&c.default.createElement(f.TabPane,{tabId:"uploadLink"},c.default.createElement(D.default,{itemPath:n.props.itemPath,repoID:n.props.repoID,closeShareDialog:n.props.toggleDialog})),"dir"===i&&"internalLink"===e&&c.default.createElement(P.default,{path:n.props.itemPath,repoID:n.props.repoID,direntType:i}),o&&c.default.createElement(u.Fragment,null,"shareToUser"===e&&c.default.createElement(f.TabPane,{tabId:"shareToUser"},c.default.createElement(g.default,{itemType:n.props.itemType,isGroupOwnedRepo:n.props.isGroupOwnedRepo,itemPath:n.props.itemPath,repoID:n.props.repoID,isRepoOwner:n.state.isRepoOwner})),"shareToGroup"===e&&c.default.createElement(f.TabPane,{tabId:"shareToGroup"},c.default.createElement(v.default,{itemType:n.props.itemType,isGroupOwnedRepo:n.props.isGroupOwnedRepo,itemPath:n.props.itemPath,repoID:n.props.repoID,isRepoOwner:n.state.isRepoOwner})),h.canInvitePeople&&"invitePeople"===e&&c.default.createElement(f.TabPane,{tabId:"invitePeople"},c.default.createElement(w.default,{itemPath:n.props.itemPath,repoID:n.props.repoID}))))))},n.renderFileContent=function(){var e=n.state.activeTab,t=n.props,r=t.itemType,a=(t.itemName,t.repoEncrypted),o=!a&&h.canGenerateShareLink;return c.default.createElement(u.Fragment,null,c.default.createElement("div",{className:"share-dialog-side"},c.default.createElement(f.Nav,{pills:!0},o&&c.default.createElement(f.NavItem,null,c.default.createElement(f.NavLink,{className:"shareLink"===e?"active":"",onClick:n.toggle.bind(n,"shareLink")},(0,h.gettext)("Share Link"))),c.default.createElement(f.NavItem,null,c.default.createElement(f.NavLink,{className:"internalLink"===e?"active":"",onClick:n.toggle.bind(n,"internalLink")},(0,h.gettext)("Internal Link"))))),c.default.createElement("div",{className:"share-dialog-main"},c.default.createElement(f.TabContent,{activeTab:n.state.activeTab},o&&"shareLink"===e&&c.default.createElement(f.TabPane,{tabId:"shareLink"},c.default.createElement(S.default,{itemPath:n.props.itemPath,repoID:n.props.repoID,closeShareDialog:n.props.toggleDialog,itemType:r})),"internalLink"===e&&c.default.createElement(P.default,{path:n.props.itemPath,repoID:n.props.repoID}))))},n.renderExternalShareMessage=function(){return h.additionalShareDialogNote&&"object"===("undefined"===typeof h.additionalShareDialogNote?"undefined":s(h.additionalShareDialogNote))?c.default.createElement("div",{className:"external-share-message mt-2"},c.default.createElement("h6",null,h.additionalShareDialogNote.title),c.default.createElement("div",{style:{fontSize:"14px",color:"#666"}},h.additionalShareDialogNote.content)):null},n.state={activeTab:n.getInitialActiveTab(),isRepoJudgemented:!1,isRepoOwner:!1},n}return i(t,e),l(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.repoID;k.seafileAPI.getRepoInfo(t).then(function(t){var n=t.data.owner_email===h.username;e.setState({isRepoJudgemented:!0,isRepoOwner:n})}).catch(function(e){var t=L.Utils.getErrorMsg(e);T.default.danger(t)})}},{key:"render",value:function(){var e=this.props,t=e.itemType,n=e.itemName;return c.default.createElement("div",null,c.default.createElement(f.Modal,{isOpen:!0,style:{maxWidth:"760px"},className:"share-dialog",toggle:this.props.toggleDialog},c.default.createElement(f.ModalHeader,{toggle:this.props.toggleDialog},(0,h.gettext)("Share")," ",c.default.createElement("span",{className:"op-target",title:n},n),this.renderExternalShareMessage()),c.default.createElement(f.ModalBody,{className:"share-dialog-content"},("library"===t||"dir"===t)&&this.renderDirContent(),"file"===t&&this.renderFileContent())))}}]),t}(c.default.Component);N.propTypes=R,t.default=N},109:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(4),h=n(2),m=n(3),g=n(5),y=r(g),v={token:d.default.string.isRequired,linkType:d.default.string.isRequired,toggleSendLink:d.default.func.isRequired,closeShareDialog:d.default.func.isRequired},b=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleEmailsInputChange=function(e){n.setState({emails:e.target.value})},n.handleMsgInputChange=function(e){n.setState({msg:e.target.value})},n.sendLink=function(){var e=n.state,t=e.emails,r=e.msg;if(!t.trim())return void n.setState({errorMsg:(0,h.gettext)("Please input at least an email.")});n.setState({btnDisabled:!0,sending:!0});var a=n.props,o=a.token;("uploadLink"==a.linkType?f.seafileAPI.sendUploadLink(o,t.trim(),r.trim()):f.seafileAPI.sendShareLink(o,t.trim(),r.trim())).then(function(e){n.props.closeShareDialog();var t=e.data,r=t.success,a=t.failed;if(r.length){var o=(0,h.gettext)("Successfully sent to {placeholder}").replace("{placeholder}",r.join(", "));y.default.success(o)}a.length&&a.map(function(e){var t=(0,h.gettext)("Failed to send to {email_placeholder}: {errorMsg_placeholder}").replace("{email_placeholder}",e.email).replace("{errorMsg_placeholder}",e.error_msg);y.default.warning(t)})}).catch(function(e){var t=m.Utils.getErrorMsg(e);n.setState({btnDisabled:!1,sending:!1,errorMsg:t})})},n.state={emails:"",msg:"",errorMsg:"",btnDisabled:!1,sending:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.state,t=e.emails,n=e.msg,r=e.errorMsg,a=e.btnDisabled,o=e.sending;return u.default.createElement(p.Form,null,u.default.createElement(p.FormGroup,null,u.default.createElement(p.Label,{htmlFor:"emails",className:"text-secondary font-weight-normal"},(0,h.gettext)("Send to:")),u.default.createElement("input",{type:"text",id:"emails",className:"form-control w-75",value:t,onChange:this.handleEmailsInputChange,placeholder:(0,h.gettext)("Emails, separated by ','")})),u.default.createElement(p.FormGroup,null,u.default.createElement(p.Label,{htmlFor:"msg",className:"text-secondary font-weight-normal"},(0,h.gettext)("Message (optional):")),u.default.createElement("textarea",{className:"form-control w-75",id:"msg",value:n,onChange:this.handleMsgInputChange})),r&&u.default.createElement("p",{className:"error"},r),u.default.createElement(p.Button,{color:"primary",onClick:this.sendLink,disabled:a,className:"mr-2"},(0,h.gettext)("Send")),u.default.createElement(p.Button,{color:"secondary",onClick:this.props.toggleSendLink},(0,h.gettext)("Cancel")),o&&u.default.createElement("p",{className:"mt-2"},(0,h.gettext)("Sending...")))}}]),t}(u.default.Component);b.propTypes=v,t.default=b},110:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(7),f=r(p),h=n(2),m=n(3),g={noticeItem:d.default.object.isRequired,onNoticeItemClick:d.default.func},y=function(e){function t(){var e,n,r,i;a(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=r=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),r.onNoticeItemClick=function(){var e=r.props.noticeItem;!0!==e.seen&&r.props.onNoticeItemClick(e)},i=n,o(r,i)}return i(t,e),s(t,[{key:"generatorNoticeInfo",value:function(){var e=this.props.noticeItem,t=e.type,n=e.detail;if("add_user_to_group"===t){var r=n.group_staff_avatar_url,a=n.group_staff_name,o=h.siteRoot+"profile/"+n.group_staff_email+"/",i=h.siteRoot+"group/"+n.group_id+"/",s=n.group_name,l=(0,h.gettext)("User {user_link} has added you to {group_link}"),u="<a href="+o+">"+a+"</a>",c="<a href="+i+">"+s+"</a>";return l=l.replace("{user_link}",u),l=l.replace("{group_link}",c),{avatar_url:r,notice:l}}if("repo_share"===t){var d=n.share_from_user_avatar_url,p=n.share_from_user_name,f=n.repo_name,g=h.siteRoot+"library/"+n.repo_id+"/"+f+"/",y=n.path,v="";return v="/"===y?(0,h.gettext)("{share_from} has shared a library named {repo_link} to you."):(0,h.gettext)("{share_from} has shared a folder named {repo_link} to you."),v=v.replace("{share_from}",p),v=v.replace("{repo_link}","{tagA}"+f+"{/tagA}"),v=m.Utils.HTMLescape(v),v=v.replace("{tagA}","<a href='"+m.Utils.encodePath(g)+"'>"),v=v.replace("{/tagA}","</a>"),{avatar_url:d,notice:v}}if("repo_share_to_group"===t){var b=n.share_from_user_avatar_url,w=n.share_from_user_name,E=n.repo_name,S=h.siteRoot+"library/"+n.repo_id+"/"+E+"/",C=h.siteRoot+"group/"+n.group_id+"/",D=n.group_name,_=n.path,P="";return P="/"===_?(0,h.gettext)("{share_from} has shared a library named {repo_link} to group {group_link}."):(0,h.gettext)("{share_from} has shared a folder named {repo_link} to group {group_link}."),P=P.replace("{share_from}",w),P=P.replace("{repo_link}","{tagA}"+E+"{/tagA}"),P=P.replace("{group_link}","{tagB}"+D+"{/tagB}"),P=m.Utils.HTMLescape(P),P=P.replace("{tagA}","<a href='"+m.Utils.encodePath(S)+"'>"),P=P.replace("{/tagA}","</a>"),P=P.replace("{tagB}","<a href='"+m.Utils.encodePath(C)+"'>"),P=P.replace("{/tagB}","</a>"),{avatar_url:b,notice:P}}if("repo_transfer"===t){var k=n.transfer_from_user_avatar_url,M=n.transfer_from_user_name,O=n.repo_name,L=h.siteRoot+"library/"+n.repo_id+"/"+O+"/",I=(0,h.gettext)("{user} has transfered a library named {repo_link} to you.");return I=I.replace("{user}",M),I=I.replace("{repo_link}","{tagA}"+O+"{/tagA}"),I=m.Utils.HTMLescape(I),I=I.replace("{tagA}","<a href="+m.Utils.encodePath(L)+">"),I=I.replace("{/tagA}","</a>"),{avatar_url:k,notice:I}}if("file_uploaded"===t){var T=n.uploaded_user_avatar_url,R=n.file_name,N=h.siteRoot+"lib/"+n.repo_id+"/file"+n.file_path,x=n.folder_name,F=h.siteRoot+"library/"+n.repo_id+"/"+n.repo_name+n.folder_path,Y="";return n.repo_id?(Y=(0,h.gettext)("A file named {upload_file_link} is uploaded to {uploaded_link}."),Y=Y.replace("{upload_file_link}","{tagA}"+R+"{/tagA}"),Y=Y.replace("{uploaded_link}","{tagB}"+x+"{/tagB}"),Y=m.Utils.HTMLescape(Y),Y=Y.replace("{tagA}","<a href="+m.Utils.encodePath(N)+">"),Y=Y.replace("{/tagA}","</a>"),Y=Y.replace("{tagB}","<a href="+m.Utils.encodePath(F)+">"),Y=Y.replace("{/tagB}","</a>")):(Y=(0,h.gettext)("A file named {upload_file_link} is uploaded to {uploaded_link}."),Y=Y.replace("{upload_file_link}",""+R),Y=m.Utils.HTMLescape(Y),Y=Y.replace("{uploaded_link}","<strong>Deleted Library</strong>")),{avatar_url:T,notice:Y}}if("file_comment"===t){var Z=n.author_avatar_url,j=n.author_name,A=n.file_name,B=h.siteRoot+"lib/"+n.repo_id+"/file"+n.file_path,X=(0,h.gettext)("File {file_link} has a new comment form user {author}.");return X=X.replace("{file_link}","{tagA}"+A+"{/tagA}"),X=X.replace("{author}",j),X=m.Utils.HTMLescape(X),X=X.replace("{tagA}","<a href="+m.Utils.encodePath(B)+">"),X=X.replace("{/tagA}","</a>"),{avatar_url:Z,notice:X}}if("draft_comment"===t){var J=n.author_avatar_url,U=n.author_name,H=n.draft_id,G=h.siteRoot+"drafts/"+H+"/",q=(0,h.gettext)("{draft_link} has a new comment from user {author}."),Q="<a href="+G+">"+(0,h.gettext)("Draft")+"#"+H+"</a>";return q=q.replace("{draft_link}",Q),q=q.replace("{author}",U),{avatar_url:J,notice:q}}if("draft_reviewer"===t){var W=n.request_user_avatat_url,K=n.request_user_name,z=n.draft_id,V=h.siteRoot+"drafts/"+z+"/",$=(0,h.gettext)("{from_user} has sent you a request for {draft_link}."),ee="<a href="+V+">"+(0,h.gettext)("Draft")+"#"+z+"</a>";return $=$.replace("{from_user}",K),$=$.replace("{draft_link}",ee),{avatar_url:W,notice:$}}return{avatar_url:null,notice:null}}},{key:"render",value:function(){var e=this.props.noticeItem,t=this.generatorNoticeInfo(),n=t.avatar_url,r=t.notice;return n||r?this.props.tr?u.default.createElement("tr",{className:e.seen?"read":"unread font-weight-bold"},u.default.createElement("td",{className:"text-center"},u.default.createElement("img",{src:n,width:"32",height:"32",className:"avatar",alt:""})),u.default.createElement("td",{className:"pr-1 pr-md-8"},u.default.createElement("p",{className:"m-0",dangerouslySetInnerHTML:{__html:r}})),u.default.createElement("td",null,(0,f.default)(e.time).fromNow())):u.default.createElement("li",{onClick:this.onNoticeItemClick,className:e.seen?"read":"unread"},u.default.createElement("div",{className:"notice-item"},u.default.createElement("div",{className:"main-info"},u.default.createElement("img",{src:n,width:"32",height:"32",className:"avatar",alt:""}),u.default.createElement("p",{className:"brief",dangerouslySetInnerHTML:{__html:r}})),u.default.createElement("p",{className:"time"},(0,f.default)(e.time).fromNow()))):""}}]),t}(u.default.Component);y.propTypes=g,t.default=y},111:function(e,t){},114:function(e,t){},115:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(127),f=r(p),h=n(4),m=n(2),g=n(116),y=r(g),v=n(117),b=r(v),w=n(3),E=n(5),S=r(E),C={repoID:d.default.string,placeholder:d.default.string,onSearchedClick:d.default.func.isRequired},D=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onFocusHandler=function(){n.setState({width:"30rem",isMaskShow:!0,isCloseShow:!0})},n.onCloseHandler=function(){n.resetToDefault()},n.onItemClickHandler=function(e){n.resetToDefault(),n.props.onSearchedClick(e)},n.onChangeHandler=function(e){var t=n;n.setState({value:e.target.value});var r=e.target.value;if(n.inputValue===r.trim())return!1;if(n.inputValue=r.trim(),""===n.inputValue||t.getValueLength(n.inputValue)<3)return n.setState({isResultShow:!1,isResultGetted:!1}),!1;var a=n.props.repoID,o={q:r,search_repo:a||"all",search_ftypes:"all"};n.timer&&clearTimeout(n.timer),n.timer=setTimeout(t.getSearchResult(o),500)},n.onShowMore=function(){var e=n.props.repoID,t=n.state.value,r={q:t,search_repo:e||"all",search_ftypes:"all"},a="";for(var o in r)a+=o+"="+r[o]+"&";window.location=m.siteRoot+"search/?"+a.slice(0,a.length-1)},n.onSearchToggle=function(){n.setState({isSearchInputShow:!n.state.isSearchInputShow,isMaskShow:!n.state.isMaskShow})},n.onSearchPage=function(){window.location.href=m.siteRoot+"search/"},n.state={width:"default",value:"",resultItems:[],total:0,isMaskShow:!1,isResultShow:!1,isResultGetted:!1,isCloseShow:!1,isSearchInputShow:!1},n.inputValue="",n.source=null,n}return i(t,e),s(t,[{key:"getSearchResult",value:function(e){this.source&&this.cancelRequest(),this.setState({isResultShow:!0,isResultGetted:!1}),this.source=h.seafileAPI.getSource(),this.sendRequest(e,this.source.token)}},{key:"sendRequest",value:function(e,t){var n=this;this.props.isPublic?h.seafileAPI.searchFilesInPublishedRepo(e.search_repo,e.q).then(function(e){if(!e.data.total)return n.setState({resultItems:[],isResultGetted:!0}),void(n.source=null);var t=n.formatResultItems(e.data.results);n.setState({resultItems:t,isResultGetted:!0}),n.source=null}).catch(function(e){var t=w.Utils.getErrorMsg(e);S.default.danger(t)}):h.seafileAPI.searchFiles(e,t).then(function(e){if(!e.data.total)return n.setState({resultItems:[],isResultGetted:!0}),void(n.source=null);var t=n.formatResultItems(e.data.results);n.setState({resultItems:t,isResultGetted:!0}),n.source=null}).catch(function(e){console.log(e)})}},{key:"cancelRequest",value:function(){this.source.cancel("prev request is cancelled")}},{key:"getValueLength",value:function(e){for(var t,n=0,r=0;n<e.length;n++)t=e.charCodeAt(n),10==t?r+=2:t<127?r+=1:t>=128&&t<=2047?r+=2:t>=2048&&t<=65535&&(r+=3);return r}},{key:"formatResultItems",value:function(e){for(var t=[],n=e.length>5?5:e.length,r=0;r<n;r++)t[r]={},t[r].index=[r],t[r].name=e[r].name,t[r].path=e[r].fullpath,t[r].repo_id=e[r].repo_id,t[r].repo_name=e[r].repo_name,t[r].is_dir=e[r].is_dir,t[r].link_content=decodeURI(e[r].fullpath).substring(1),t[r].content=e[r].content_highlight,t[r].thumbnail_url=e[r].thumbnail_url;return t}},{key:"resetToDefault",value:function(){this.inputValue=null,this.setState({width:"",value:"",isMaskShow:!1,isCloseShow:!1,isResultShow:!1,isResultGetted:!1,resultItems:[],isSearchInputShow:!1})}},{key:"renderSearchResult",value:function(){var e=this;if(this.state.isResultShow){if(!this.state.isResultGetted||this.getValueLength(this.inputValue)<3)return u.default.createElement("span",{className:"loading-icon loading-tip"});if(!this.state.resultItems.length)return u.default.createElement("div",{className:"search-result-none"},(0,m.gettext)("No results matching."));var t=this.state,n=t.resultItems,r=t.total,a=r>n.length;return u.default.createElement("ul",{className:"search-result-list"},this.state.resultItems.map(function(t,n){return u.default.createElement(y.default,{key:n,item:t,onItemClickHandler:e.onItemClickHandler})}),a&&u.default.createElement(b.default,{onShowMore:this.onShowMore}))}}},{key:"render",value:function(){var e="default"!==this.state.width?this.state.width:"",t={width:e};return u.default.createElement(l.Fragment,null,u.default.createElement(f.default,{query:"(min-width: 768px)"},u.default.createElement("div",{className:"search"},u.default.createElement("div",{className:"search-mask "+(this.state.isMaskShow?"":"hide"),onClick:this.onCloseHandler}),u.default.createElement("div",{className:"search-container"},u.default.createElement("div",{className:"input-icon"},u.default.createElement("i",{className:"search-icon-left input-icon-addon fas fa-search"}),u.default.createElement("input",{type:"text",className:"form-control search-input",name:"query",placeholder:this.props.placeholder,style:t,value:this.state.value,onFocus:this.onFocusHandler,onChange:this.onChangeHandler,autoComplete:"off"}),this.state.isCloseShow&&m.username&&u.default.createElement("i",{className:"search-icon-right input-icon-addon fas fa-external-link-alt search-icon-arrow",onClick:this.onSearchPage}),this.state.isCloseShow&&u.default.createElement("i",{className:"search-icon-right input-icon-addon fas fa-times",onClick:this.onCloseHandler})),u.default.createElement("div",{className:"search-result-container dropdown-search-result-container"},this.renderSearchResult())))),u.default.createElement(f.default,{query:"(max-width: 767.8px)"},u.default.createElement("div",{className:"search-icon-container"},u.default.createElement("i",{className:"search-icon fas fa-search",onClick:this.onSearchToggle})),this.state.isSearchInputShow&&u.default.createElement("div",{className:"search"},u.default.createElement("div",{className:"search-mask "+(this.state.isMaskShow?"":"hide"),onClick:this.onCloseHandler}),u.default.createElement("div",{className:"search-container"},u.default.createElement("div",{className:"input-icon"},u.default.createElement("i",{className:"search-icon-left input-icon-addon fas fa-search"}),u.default.createElement("input",{type:"text",className:"form-control search-input",name:"query",placeholder:this.props.placeholder,style:t,value:this.state.value,onFocus:this.onFocusHandler,onChange:this.onChangeHandler,autoComplete:"off"}),this.state.isCloseShow&&m.username&&u.default.createElement("i",{className:"search-icon-right input-icon-addon fas fa-external-link-alt search-icon-arrow",onClick:this.onSearchPage}),this.state.isCloseShow&&u.default.createElement("i",{className:"search-icon-right input-icon-addon fas fa-times",onClick:this.onCloseHandler})),u.default.createElement("div",{className:"search-result-container dropdown-search-result-container"},this.renderSearchResult())))))}}]),t}(l.Component);D.propTypes=C,t.default=D},116:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(3),f={item:d.default.object.isRequired,onItemClickHandler:d.default.func.isRequired},h=function(e){function t(){var e,n,r,i;a(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=r=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),r.onClickHandler=function(){var e=r.props.item;r.props.onItemClickHandler(e)},i=n,o(r,i)}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.item,t=e.link_content?"item-img":"lib-item-img",n=e.link_content?p.Utils.getFolderIconUrl(!1,192):p.Utils.getDefaultLibIconUrl(!0),r=e.is_dir?n:p.Utils.getFileIconUrl(e.name,192);return""!==e.thumbnail_url&&(r=e.thumbnail_url),u.default.createElement("li",{className:"search-result-item",onClick:this.onClickHandler},u.default.createElement("img",{className:t,src:r,alt:""}),u.default.createElement("div",{className:"item-content"},u.default.createElement("div",{className:"item-name ellipsis"},e.name),u.default.createElement("div",{className:"item-link ellipsis"},e.repo_name,"/",e.link_content),u.default.createElement("div",{className:"item-text ellipsis",dangerouslySetInnerHTML:{__html:e.content}})))}}]),t}(u.default.Component);h.propTypes=f,t.default=h},117:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(2),f={onShowMore:d.default.func.isRequired},h=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){return u.default.createElement("li",{className:"list-show-more",onClick:this.props.onShowMore},u.default.createElement("span",{className:"more-message"},(0,p.gettext)("show more")))}}]),t}(u.default.Component);h.propTypes=f,t.default=h},118:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(4),d=n(2),p=n(110),f=r(p),h=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onClick=function(e){e.preventDefault(),n.state.showNotice?(c.seafileAPI.updateNotifications(),n.setState({showNotice:!1,unseenCount:0})):(n.loadNotices(),n.setState({showNotice:!0}))},n.loadNotices=function(){c.seafileAPI.listNotifications(1,5).then(function(e){var t=e.data.notification_list;n.setState({noticeList:t})})},n.onNoticeItemClick=function(e){var t=n.state.noticeList.map(function(t){return t.id===e.id&&(t.seen=!0),t});c.seafileAPI.markNoticeAsRead(e.id);var r=0===n.state.unseenCount?0:n.state.unseenCount-1;n.setState({noticeList:t,unseenCount:r})},n.state={showNotice:!1,unseenCount:0,noticeList:[]},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;c.seafileAPI.getUnseenNotificationCount().then(function(t){e.setState({unseenCount:t.data.unseen_count})})}},{key:"render",value:function(){var e=this;return u.default.createElement("div",{id:"notifications"},u.default.createElement("a",{href:"#",onClick:this.onClick,className:"no-deco",id:"notice-icon",title:(0,d.gettext)("Notifications"),"aria-label":(0,d.gettext)("Notifications")},u.default.createElement("span",{className:"sf2-icon-bell"}),u.default.createElement("span",{className:"num "+(this.state.unseenCount?"":"hide")},this.state.unseenCount)),u.default.createElement("div",{id:"notice-popover",className:"sf-popover "+(this.state.showNotice?"":"hide")},u.default.createElement("div",{className:"outer-caret up-outer-caret"},u.default.createElement("div",{className:"inner-caret"})),u.default.createElement("div",{className:"sf-popover-hd ovhd"},u.default.createElement("h3",{className:"sf-popover-title title"},(0,d.gettext)("Notifications")),u.default.createElement("a",{href:"#",onClick:this.onClick,title:(0,d.gettext)("Close"),"aria-label":(0,d.gettext)("Close"),className:"sf-popover-close js-close sf2-icon-x1 action-icon float-right"})),u.default.createElement("div",{className:"sf-popover-con"},u.default.createElement("ul",{className:"notice-list"},this.state.noticeList.map(function(t){return u.default.createElement(f.default,{key:t.id,noticeItem:t,onNoticeItemClick:e.onNoticeItemClick})})),u.default.createElement("a",{href:d.siteRoot+"notification/list/",className:"view-all"},(0,d.gettext)("See All Notifications")))))}}]),t}(u.default.Component);t.default=h},13:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(10),d=r(c),p=n(1),f=r(p),h={children:f.default.object.isRequired},m=document.getElementById("modal-wrapper"),g=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.el=document.createElement("div"),n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){m.appendChild(this.el)}},{key:"componentWillUnmount",value:function(){m.removeChild(this.el)}},{key:"render",value:function(){return d.default.createPortal(this.props.children,this.el)}}]),t}(u.default.Component);g.propTypes=h,t.default=g},1309:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(3),h={currentPerm:d.default.string.isRequired,permissions:d.default.array.isRequired,changePerm:d.default.func.isRequired,toggleDialog:d.default.func.isRequired},m=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.switchOption=function(e){if(e.target.checked){var t=e.target.value;n.setState({currentOption:t}),n.props.changePerm(t),n.props.toggleDialog()}},n.state={currentOption:n.props.currentPerm},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this,t=this.props.permissions,n=this.state.currentOption;return u.default.createElement(p.Modal,{isOpen:!0,toggle:this.props.toggleDialog},u.default.createElement(p.ModalBody,null,t.map(function(t,r){return u.default.createElement("div",{className:"d-flex",key:r},u.default.createElement("input",{id:"option-"+r,className:"mt-1",type:"radio",name:"permission",value:t,checked:n==t,onChange:e.switchOption}),u.default.createElement("label",{htmlFor:"option-"+r,className:"ml-2"},f.Utils.sharePerms(t),u.default.createElement("p",{className:"text-secondary small m-0"},f.Utils.sharePermsExplanation(t))))})))}}]),t}(u.default.Component);m.propTypes=h,t.default=m},1310:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(2),h=n(4),m=n(3),g=n(5),y=r(g),v={itemName:d.default.string.isRequired,toggleDialog:d.default.func.isRequired,repoID:d.default.string.isRequired},b=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.submit=function(){var e=n.state.keepDays;n.state.autoHistory&&(e=n.state.expireDays);var t=n.props.repoID;if(/^-?\d+$/.test(e)){var r=(0,f.gettext)("Successfully set library history.");h.seafileAPI.setRepoHistoryLimit(t,e).then(function(e){y.default.success(r),n.setState({keepDays:e.data.keep_days}),n.props.toggleDialog()}).catch(function(e){var t=m.Utils.getErrorMsg(e);y.default.danger(t)})}else n.setState({errorInfo:(0,f.gettext)("Please enter a non-negative integer")})},n.handleKeyPress=function(e){"Enter"===e.key&&(n.submit(),e.preventDefault())},n.onChange=function(e){var t=e.target.value;n.setState({keepDays:t,expireDays:t})},n.setLimitDays=function(e){"allHistory"===e?n.setState({keepDays:-1}):"noHistory"===e?n.setState({keepDays:0}):n.setState({disabled:!1}),n.setState({allHistory:"allHistory"===e,noHistory:"noHistory"===e,autoHistory:"autoHistory"===e})},n.state={keepDays:-1,expireDays:30,disabled:!0,allHistory:!0,noHistory:!1,autoHistory:!1,errorInfo:""},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;h.seafileAPI.getRepoHistoryLimit(this.props.repoID).then(function(t){e.setState({keepDays:t.data.keep_days,allHistory:t.data.keep_days<0,noHistory:0===t.data.keep_days,autoHistory:t.data.keep_days>0,disabled:!(t.data.keep_days>0),expireDays:t.data.keep_days>0?t.data.keep_days:30})}).catch(function(e){var t=m.Utils.getErrorMsg(e);y.default.danger(t)})}},{key:"render",value:function(){var e=this,t=this.props.itemName;return u.default.createElement(p.Modal,{isOpen:!0},u.default.createElement(p.ModalHeader,{toggle:this.props.toggleDialog},u.default.createElement("span",{className:"op-target",title:t},t)," ",(0,f.gettext)("History Setting")),u.default.createElement(p.ModalBody,null,u.default.createElement(p.Form,null,!f.enableRepoHistorySetting&&u.default.createElement(p.FormGroup,null,u.default.createElement(p.Label,{className:"error"},(0,f.gettext)("Setting library history is disabled by Admin."))),u.default.createElement(p.FormGroup,{check:!0},u.default.createElement(p.Input,{type:"radio",name:"radio1",checked:this.state.allHistory,disabled:!f.enableRepoHistorySetting,onChange:function(){e.setLimitDays("allHistory")}})," ",u.default.createElement(p.Label,null,(0,f.gettext)("Keep full history"))),u.default.createElement(p.FormGroup,{check:!0},u.default.createElement(p.Input,{type:"radio",name:"radio1",checked:this.state.noHistory,disabled:!f.enableRepoHistorySetting,onChange:function(){e.setLimitDays("noHistory")}})," ",u.default.createElement(p.Label,null,(0,f.gettext)("Don't keep history"))),u.default.createElement(p.FormGroup,{check:!0},u.default.createElement(p.Input,{type:"radio",name:"radio1",checked:this.state.autoHistory,disabled:!f.enableRepoHistorySetting,onChange:function(){e.setLimitDays("autoHistory")}})," ",u.default.createElement(p.Label,null,(0,f.gettext)("Only keep a period of history:")),u.default.createElement(p.Input,{type:"text",className:"expire-input",value:this.state.expireDays,onChange:this.onChange,disabled:this.state.disabled,onKeyDown:this.handleKeyPress})," ",u.default.createElement(p.Label,null,u.default.createElement("span",null,(0,f.gettext)("days")))),this.state.errorInfo&&u.default.createElement(p.Alert,{color:"danger"},this.state.errorInfo))),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{color:"secondary",onClick:this.props.toggleDialog},(0,f.gettext)("Cancel")),u.default.createElement(p.Button,{color:"primary",onClick:this.submit},(0,f.gettext)("Submit"))))}}]),t}(u.default.Component);b.propTypes=v,t.default=b},1311:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(2),h=n(3),m=n(4),g=n(5),y=r(g),v={repoID:d.default.string.isRequired,repoName:d.default.string.isRequired,toggleDialog:d.default.func.isRequired},b=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleOldPasswordInputChange=function(e){n.setState({oldPassword:e.target.value})},n.handleNewPasswordInputChange=function(e){n.setState({newPassword:e.target.value})},n.handleNewPasswordAgainInputChange=function(e){n.setState({newPasswordAgain:e.target.value})},n.formSubmit=function(e){var t=n.state,r=t.oldPassword,a=t.newPassword,o=t.newPasswordAgain;return r?a?a.length<f.repoPasswordMinLength?(n.setState({errorMsg:(0,f.gettext)("New password is too short")}),!1):o?a!=o?(n.setState({errorMsg:(0,f.gettext)("New passwords don't match")}),!1):(n.setState({submitBtnDisabled:!0}),void m.seafileAPI.changeEncryptedRepoPassword(n.props.repoID,r,a).then(function(){n.props.toggleDialog(),y.default.success((0,f.gettext)("Successfully changed library password."))}).catch(function(e){var t=h.Utils.getErrorMsg(e);n.setState({errorMsg:t,submitBtnDisabled:!1})})):(n.setState({errorMsg:(0,f.gettext)("Please enter the new password again")}),!1):(n.setState({errorMsg:(0,f.gettext)("Please enter a new password")}),!1):(n.setState({errorMsg:(0,f.gettext)("Please enter the old password")}),!1)},n.state={oldPassword:"",newPassword:"",newPasswordAgain:"",submitBtnDisabled:!1,errorMsg:""},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=e.repoName,n=e.toggleDialog;return u.default.createElement(p.Modal,{isOpen:!0,centered:!0,style:{height:"auto"}},u.default.createElement(p.ModalHeader,{toggle:n},u.default.createElement("span",{dangerouslySetInnerHTML:{__html:h.Utils.generateDialogTitle((0,f.gettext)("Change Password of Library {placeholder}"),t)}})),u.default.createElement(p.ModalBody,null,u.default.createElement("form",{id:"repo-change-passwd-form",action:"",method:"post"},u.default.createElement("label",{htmlFor:"passwd"},(0,f.gettext)("Old Password")),u.default.createElement("br",null),u.default.createElement("input",{type:"password",name:"old_passwd",className:"form-control",id:"passwd",value:this.state.oldPassword,onChange:this.handleOldPasswordInputChange}),u.default.createElement("br",null),u.default.createElement("label",{htmlFor:"new-passwd"},(0,f.gettext)("New Password")),u.default.createElement("span",{className:"tip"},(0,f.gettext)("(at least {placeholder} characters)").replace("{placeholder}",f.repoPasswordMinLength)),u.default.createElement("br",null),u.default.createElement("input",{type:"password",name:"new_passwd",className:"form-control",id:"new-passwd",value:this.state.newPassword,onChange:this.handleNewPasswordInputChange}),u.default.createElement("br",null),u.default.createElement("label",{htmlFor:"new-passwd-again"},(0,f.gettext)("New Password Again")),u.default.createElement("br",null),u.default.createElement("input",{type:"password",name:"new_passwd_again",className:"form-control",id:"new-passwd-again",value:this.state.newPasswordAgain,onChange:this.handleNewPasswordAgainInputChange}),u.default.createElement("br",null),this.state.errorMsg&&u.default.createElement(p.Alert,{color:"danger"},this.state.errorMsg))),u.default.createElement(p.ModalFooter,null,u.default.createElement("button",{className:"btn btn-primary",disabled:this.state.submitBtnDisabled,onClick:this.formSubmit},(0,f.gettext)("Submit"))))}}]),t}(u.default.Component);b.propTypes=v,t.default=b},1312:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(5),f=(r(p),n(6)),h=n(2),m=(n(3),n(4)),g={repoID:d.default.string.isRequired,toggleDialog:d.default.func.isRequired},y=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={errMessage:"",showLoading:!0,showSuccess:!1,showError:!1},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;m.seafileAPI.resetAndSendEncryptedRepoPassword(this.props.repoID).then(function(t){e.setState({showLoading:!1}),e.setState({showSuccess:!0})}).catch(function(t){t.response&&(e.setState({errMessage:t.response.data.error_msg}),e.setState({showLoading:!1}),e.setState({showError:!0}))})}},{key:"render",value:function(){var e="<strong>"+h.contactEmail+"</strong>",t=(0,h.gettext)("New password has been sent to your email {mail}. Please check your mailbox. If you don\u2019t receive the password, please check if your email address is properly configured.").replace("{mail}",e);return u.default.createElement(f.Modal,{isOpen:!0,centered:!0},u.default.createElement(f.ModalHeader,{toggle:this.props.toggleDialog},(0,h.gettext)("Reset library password")),u.default.createElement(f.ModalBody,null,this.state.showLoading&&u.default.createElement("span",null,(0,h.gettext)("Sending new password...")),this.state.showSuccess&&u.default.createElement("div",{dangerouslySetInnerHTML:{__html:t}}),this.state.showError&&u.default.createElement("span",{className:"err-message"},this.state.errMessage)))}}]),t}(u.default.Component);y.propTypes=g,t.default=y},1313:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(2),f=n(6),h=n(2251),m=r(h),g=n(4),y=n(3),v=n(5),b=r(v),w=n(152),E=r(w),S=n(8),C=r(S),D={item:d.default.object.isRequired,deleteAPIToken:d.default.func.isRequired,updateAPIToken:d.default.func.isRequired},_=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseEnter=function(){n.setState({isOperationShow:!0})},n.onMouseLeave=function(){n.setState({isOperationShow:!1})},n.onDeleteAPIToken=function(){n.props.deleteAPIToken(n.props.item.app_name)},n.onUpdateAPIToken=function(e){n.props.updateAPIToken(n.props.item.app_name,e)},n.onCopyAPIToken=function(){var e=n.props.item.api_token;(0,E.default)(e),b.default.success((0,p.gettext)("API token is copied to the clipboard."))},n.state={isOperationShow:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.item;return u.default.createElement("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},u.default.createElement("td",{className:"name"},e.app_name),u.default.createElement("td",null,u.default.createElement(m.default,{isTextMode:!0,isEditIconShow:this.state.isOperationShow,currentPermission:e.permission,onPermissionChanged:this.onUpdateAPIToken})),u.default.createElement("td",null,u.default.createElement("span",null,e.api_token),this.state.isOperationShow&&u.default.createElement("span",{className:"far fa-copy action-icon",onClick:this.onCopyAPIToken})),u.default.createElement("td",null,u.default.createElement("span",{className:"sf2-icon-x3 action-icon "+(this.state.isOperationShow?"":"hide"),onClick:this.onDeleteAPIToken,title:(0,p.gettext)("Delete")})))}}]),t}(u.default.Component);_.propTypes=D;var P={repo:d.default.object.isRequired,onRepoAPITokenToggle:d.default.func.isRequired},k=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.listAPITokens=function(){g.seafileAPI.listRepoAPITokens(n.repo.repo_id).then(function(e){n.setState({apiTokenList:e.data.repo_api_tokens,loading:!1})}).catch(function(e){403===e.response.status?n.setState({errorMsg:(0,p.gettext)("Permission denied")}):n.handleError(e)})},n.onInputChange=function(e){var t=e.target.value;n.setState({appName:t})},n.onKeyDown=function(e){13===e.keyCode&&(e.preventDefault(),n.addAPIToken())},n.setPermission=function(e){n.setState({permission:e})},n.addAPIToken=function(){if(n.state.appName){n.setState({isSubmitBtnActive:!1});var e=n.state,t=e.appName,r=e.permission,a=e.apiTokenList;g.seafileAPI.addRepoAPIToken(n.repo.repo_id,t,r).then(function(e){a.push(e.data),n.setState({apiTokenList:a,isSubmitBtnActive:!0})}).catch(function(e){n.handleError(e),n.setState({isSubmitBtnActive:!0})})}},n.deleteAPIToken=function(e){g.seafileAPI.deleteRepoAPIToken(n.repo.repo_id,e).then(function(t){var r=n.state.apiTokenList.filter(function(t){return t.app_name!==e});n.setState({apiTokenList:r})}).catch(function(e){n.handleError(e)})},n.updateAPIToken=function(e,t){g.seafileAPI.updateRepoAPIToken(n.repo.repo_id,e,t).then(function(r){var a=n.state.apiTokenList.filter(function(n){return n.app_name===e&&(n.permission=t),n});n.setState({apiTokenList:a})}).catch(function(e){n.handleError(e)})},n.handleError=function(e){e.response?b.default.danger(e.response.data.error_msg||e.response.data.detail||(0,p.gettext)("Error"),{duration:3}):b.default.danger((0,p.gettext)("Please check the network."),{duration:3})},n.renderContent=function(){var e=n.state.apiTokenList.map(function(e,t){return u.default.createElement(_,{key:t,item:e,deleteAPIToken:n.deleteAPIToken,updateAPIToken:n.updateAPIToken})}),t=u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:"20%"},(0,p.gettext)("App Name")),u.default.createElement("th",{width:"20%"},(0,p.gettext)("Permission")),u.default.createElement("th",{width:"48%"},"API Token"),u.default.createElement("th",{width:"12%"})));return u.default.createElement(l.Fragment,null,n.state.errorMsg&&u.default.createElement("p",{className:"error text-center"},n.state.errorMsg),!n.state.errorMsg&&u.default.createElement(l.Fragment,null,u.default.createElement("table",{className:"w-xs-250"},t,u.default.createElement("tbody",null,u.default.createElement("tr",null,u.default.createElement("td",null,u.default.createElement(f.Input,{type:"text",id:"appName",value:n.state.appName,onChange:n.onInputChange,onKeyDown:n.onKeyDown})),u.default.createElement("td",null,u.default.createElement(m.default,{isTextMode:!1,isEditIconShow:!1,currentPermission:n.state.permission,onPermissionChanged:n.setPermission})),u.default.createElement("td",null,u.default.createElement("span",{className:"text-secondary"},"--")),u.default.createElement("td",null,u.default.createElement(f.Button,{onClick:n.addAPIToken,disabled:!n.state.isSubmitBtnActive},(0,p.gettext)("Submit")))))),u.default.createElement("div",{style:{minHeight:"10rem",maxHeight:"18rem"}},0!==n.state.apiTokenList.length&&u.default.createElement("table",{className:"table-thead-hidden w-xs-250"},t,u.default.createElement("tbody",null,e))),n.state.loading&&u.default.createElement(C.default,null)))},n.state={apiTokenList:[],permission:"rw",appName:"",errorMsg:"",loading:!0,isSubmitBtnActive:!0},n.repo=n.props.repo,n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){this.listAPITokens()}},{key:"render",value:function(){var e=this.repo,t='<span class="op-target">'+y.Utils.HTMLescape(e.repo_name)+"</span>",n=(0,p.gettext)("{placeholder} API Token").replace("{placeholder}",t);return u.default.createElement(f.Modal,{isOpen:!0,style:{maxWidth:"800px"},toggle:this.props.onRepoAPITokenToggle},u.default.createElement(f.ModalHeader,{toggle:this.props.onRepoAPITokenToggle},u.default.createElement("p",{dangerouslySetInnerHTML:{__html:n},className:"m-0"})),u.default.createElement(f.ModalBody,null,u.default.createElement("div",{className:"o-auto"},this.renderContent())))}}]),t}(u.default.Component);k.propTypes=P,t.default=k},1314:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(4),h=n(2),m=n(3),g=n(5),y=r(g),v=n(8),b=r(v),w=n(39),E=r(w),S={item:d.default.object.isRequired,activeTab:d.default.string.isRequired,deleteItem:d.default.func.isRequired},C=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseEnter=function(){n.setState({isOperationShow:!0})},n.onMouseLeave=function(){n.setState({isOperationShow:!1})},n.onDeleteLink=function(e){e.preventDefault(),n.props.deleteItem(n.props.item.token)},n.state={isOperationShow:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=void 0,t=this.props.item,n="/"===t.path?"/":t.path.slice(0,t.path.length-1);return"shareLinks"===this.props.activeTab&&(e=t.is_dir?h.siteRoot+"library/"+t.repo_id+"/"+encodeURIComponent(t.repo_name)+m.Utils.encodePath(n):h.siteRoot+"lib/"+t.repo_id+"/file"+m.Utils.encodePath(t.path)),"uploadLinks"===this.props.activeTab&&(e=h.siteRoot+"library/"+t.repo_id+"/"+encodeURIComponent(t.repo_name)+m.Utils.encodePath(n)),u.default.createElement("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},u.default.createElement("td",{className:"name"},t.creator_name),u.default.createElement("td",null,u.default.createElement("a",{href:e,target:"_blank",className:"text-inherit"},t.obj_name)),u.default.createElement("td",null,u.default.createElement("a",{href:t.link,target:"_blank",className:"text-inherit"},t.link)),u.default.createElement("td",null,u.default.createElement("span",{className:"sf2-icon-x3 action-icon "+(this.state.isOperationShow?"":"invisible"),onClick:this.onDeleteLink,title:(0,h.gettext)("Delete")})))}}]),t}(u.default.Component);C.propTypes=S;var D={repo:d.default.object.isRequired,toggleDialog:d.default.func.isRequired},_=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getItems=function(e){var t=n.props.repo.repo_id;("share-link"==e?f.seafileAPI.listRepoShareLinks(t):f.seafileAPI.listRepoUploadLinks(t)).then(function(e){n.setState({loading:!1,repoShareUploadLinkList:e.data})}).catch(function(e){n.setState({isLoading:!1,errorMsg:m.Utils.getErrorMsg(e,!0)})})},n.deleteItem=function(e){var t=n.props.repo.repo_id;("shareLinks"==n.state.activeTab?f.seafileAPI.deleteRepoShareLink(t,e):f.seafileAPI.deleteRepoUploadLink(t,e)).then(function(t){var r=n.state.repoShareUploadLinkList.filter(function(t){return t.token!==e});n.setState({repoShareUploadLinkList:r})}).catch(function(e){y.default.danger(m.Utils.getErrorMsg(e))})},n.toggle=function(e){n.state.activeTab!==e&&n.setState({activeTab:e}),"shareLinks"==e&&n.getItems("share-link"),"uploadLinks"==e&&n.getItems("upload-link")},n.state={loading:!0,activeTab:"shareLinks",repoShareUploadLinkList:[],errorMsg:""},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){this.getItems("share-link")}},{key:"render",value:function(){var e=this,t=this.state,n=t.loading,r=t.errorMsg,a=t.activeTab,o=t.repoShareUploadLinkList,i='<span class="op-target">'+m.Utils.HTMLescape(this.props.repo.repo_name)+"</span>",s=(0,h.gettext)("{placeholder} Share/Upload Links").replace("{placeholder}",i);return u.default.createElement(p.Modal,{isOpen:!0,style:{maxWidth:"800px"}},u.default.createElement(p.ModalHeader,{toggle:this.props.toggleDialog},u.default.createElement("span",{dangerouslySetInnerHTML:{__html:s}})),u.default.createElement(p.ModalBody,{className:"p-0 pb-4"},u.default.createElement("div",{className:"main-panel-center"},u.default.createElement("div",{className:"cur-view-container"},u.default.createElement("div",{className:"cur-view-path share-upload-nav"},u.default.createElement("ul",{className:"nav"},u.default.createElement("li",{className:"nav-item"},u.default.createElement(p.NavLink,{className:"shareLinks"===a?"active":"",onClick:this.toggle.bind(this,"shareLinks")},(0,h.gettext)("Share Links"))),u.default.createElement("li",{className:"nav-item"},u.default.createElement(p.NavLink,{className:"uploadLinks"===a?"active":"",onClick:this.toggle.bind(this,"uploadLinks")},(0,h.gettext)("Upload Links"))))),u.default.createElement("div",{className:"cur-view-content",style:{minHeight:"20rem",maxHeight:"20rem"}},n&&u.default.createElement(b.default,null),!n&&r&&u.default.createElement("p",{className:"error text-center mt-8"},r),!n&&!r&&!o.length&&u.default.createElement(E.default,{forDialog:!0},u.default.createElement("p",{className:"text-secondary"},"shareLinks"==a?(0,h.gettext)("No share links"):(0,h.gettext)("No upload links"))),!n&&!r&&o.length>0&&u.default.createElement("table",null,u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:"22%"},(0,h.gettext)("Creator")),u.default.createElement("th",{width:"20%"},(0,h.gettext)("Name")),u.default.createElement("th",{width:"48%"},(0,h.gettext)("Link")),u.default.createElement("th",{width:"10%"}))),u.default.createElement("tbody",null,this.state.repoShareUploadLinkList.map(function(t,n){return u.default.createElement(C,{key:n,item:t,activeTab:e.state.activeTab,deleteItem:e.deleteItem})}))))))))}}]),t}(u.default.Component);_.propTypes=D,t.default=_},1315:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(2),f=n(3),h=n(6),m={onRename:d.default.func.isRequired,toggleCancel:d.default.func.isRequired,checkDuplicatedName:d.default.func.isRequired,dirent:d.default.object},g=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleChange=function(e){e.target.value.trim()?n.setState({isSubmitBtnActive:!0}):n.setState({isSubmitBtnActive:!1}),n.setState({newName:e.target.value})},n.handleSubmit=function(){var e=n.validateInput(),t=e.isValid,r=e.errMessage;if(t){if(n.checkDuplicatedName()){var a=(0,p.gettext)('The name "{name}" is already taken. Please choose a different name.');a=a.replace("{name}",f.Utils.HTMLescape(n.state.newName)),n.setState({errMessage:a})}else n.props.onRename(n.state.newName),n.props.toggleCancel()}else n.setState({errMessage:r})},n.handleKeyPress=function(e){"Enter"===e.key&&n.handleSubmit()},n.toggle=function(){n.props.toggleCancel()},n.changeState=function(e){var t=e.name;n.setState({newName:t})},n.validateInput=function(){var e=n.state.newName.trim(),t=!0,r="";return e?e.indexOf("/")>-1?(t=!1,r=(0,p.gettext)("Name should not include '/'."),{isValid:t,errMessage:r}):{isValid:t,errMessage:r}:(t=!1,r=(0,p.gettext)("Name is required."),{isValid:t,errMessage:r})},n.checkDuplicatedName=function(){return n.props.checkDuplicatedName(n.state.newName)},n.state={newName:"",errMessage:"",isSubmitBtnActive:!1},n.newInput=u.default.createRef(),n}return i(t,e),s(t,[{key:"componentWillMount",value:function(){this.setState({newName:this.props.dirent.name})}},{key:"componentDidMount",value:function(){var e=this.props.dirent;if(this.changeState(e),this.newInput.focus(),"file"===e.type){var t=e.name.lastIndexOf(".md");this.newInput.setSelectionRange(0,t,"forward")}else this.newInput.setSelectionRange(0,-1)}},{key:"componentWillReceiveProps",value:function(e){this.changeState(e.dirent)}},{key:"render",value:function(){var e=this,t=this.props.dirent.type;return u.default.createElement(h.Modal,{isOpen:!0,toggle:this.toggle},u.default.createElement(h.ModalHeader,{toggle:this.toggle},"file"===t?(0,p.gettext)("Rename File"):(0,p.gettext)("Rename Folder")),u.default.createElement(h.ModalBody,null,u.default.createElement("p",null,"file"===t?(0,p.gettext)("New file name"):(0,p.gettext)("New folder name")),u.default.createElement(h.Input,{onKeyPress:this.handleKeyPress,innerRef:function(t){e.newInput=t},value:this.state.newName,onChange:this.handleChange}),this.state.errMessage&&u.default.createElement(h.Alert,{color:"danger",className:"mt-2"},this.state.errMessage)),u.default.createElement(h.ModalFooter,null,u.default.createElement(h.Button,{color:"secondary",onClick:this.toggle},(0,p.gettext)("Cancel")),u.default.createElement(h.Button,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive},(0,p.gettext)("Submit"))))}}]),t}(u.default.Component);g.propTypes=m,t.default=g},1316:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(7),h=r(f),m=n(2),g=n(4),y=n(3),v=n(5),b=r(v),w={repoID:d.default.string.isRequired,currentTag:d.default.object.isRequired,toggleCancel:d.default.func.isRequired,onClose:d.default.func.isRequired,updateUsedRepoTags:d.default.func.isRequired,onFileTagChanged:d.default.func},E=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onFileTagChanged=function(e){var t=e.parent_path,r={name:e.filename},a="/"===t?t+e.filename:t+"/"+e.filename;n.props.onFileTagChanged(r,a)},n.onDeleteTaggedFile=function(e){var t=n.props.repoID,r=e.file_tag_id;g.seafileAPI.deleteFileTag(t,r).then(function(t){n.getTaggedFiles(),n.props.updateUsedRepoTags(),n.props.onFileTagChanged&&!e.file_deleted&&n.onFileTagChanged(e)}).catch(function(e){var t=y.Utils.getErrorMsg(e);b.default.danger(t)})},n.getTaggedFiles=function(){var e=n.props,t=e.repoID,r=e.currentTag;g.seafileAPI.listTaggedFiles(t,r.id).then(function(e){var t=[];void 0!==e.data.tagged_files&&e.data.tagged_files.forEach(function(e){var n=e;t.push(n)}),n.setState({taggedFileList:t})}).catch(function(e){var t=y.Utils.getErrorMsg(e);b.default.danger(t)})},n.state={taggedFileList:[]},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){this.getTaggedFiles()}},{key:"render",value:function(){var e=this,t=this.state.taggedFileList;return u.default.createElement(p.Modal,{isOpen:!0},u.default.createElement(p.ModalHeader,{toggle:this.props.onClose},(0,m.gettext)("Tagged Files")),u.default.createElement(p.ModalBody,{className:"dialog-list-container"},u.default.createElement("table",null,u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:"45%",className:"ellipsis"},(0,m.gettext)("Name")),u.default.createElement("th",{width:"27%"},(0,m.gettext)("Size")),u.default.createElement("th",{width:"18%"},(0,m.gettext)("Last Update")),u.default.createElement("th",{width:"10%"}))),u.default.createElement("tbody",null,t.map(function(t,n){return u.default.createElement(C,{key:n,repoID:e.props.repoID,taggedFile:t,onDeleteTaggedFile:e.onDeleteTaggedFile})})))),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{color:"secondary",onClick:this.props.toggleCancel},(0,m.gettext)("Close"))))}}]),t}(u.default.Component);E.propTypes=w,t.default=E;var S={repoID:d.default.string.isRequired,taggedFile:d.default.object,onDeleteTaggedFile:d.default.func.isRequired},C=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseEnter=function(){n.setState({active:!0})},n.onMouseLeave=function(){n.setState({active:!1})},n.state={active:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.taggedFile,t=this.state.active?"action-icon sf2-icon-x3":"action-icon vh sf2-icon-x3",n=e.parent_path?y.Utils.joinPath(e.parent_path,e.filename):"",r=m.siteRoot+"lib/"+this.props.repoID+"/file"+y.Utils.encodePath(n);return e.file_deleted?u.default.createElement("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},u.default.createElement("td",{colSpan:"3",className:"name"},e.filename," ",u.default.createElement("span",{style:{color:"red"}},(0,m.gettext)("deleted"))),u.default.createElement("td",null,u.default.createElement("i",{className:t,onClick:this.props.onDeleteTaggedFile.bind(this,e)}))):u.default.createElement("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},u.default.createElement("td",{className:"name"},u.default.createElement("a",{href:r,target:"_blank"},e.filename)),u.default.createElement("td",null,y.Utils.bytesToSize(e.size)),u.default.createElement("td",null,h.default.unix(e.mtime).fromNow()),u.default.createElement("td",null,u.default.createElement("i",{className:t,onClick:this.props.onDeleteTaggedFile.bind(this,e)})))}}]),t}(u.default.Component);C.propTypes=S},1317:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(1318),f=r(p),h=n(1319),m=r(h),g=n(2280),y=r(g),v={path:d.default.string.isRequired,repoID:d.default.string.isRequired,currentRepoInfo:d.default.object.isRequired,isGroupOwnedRepo:d.default.bool.isRequired,userPerm:d.default.string,enableDirPrivateShare:d.default.bool.isRequired,isRepoInfoBarShow:d.default.bool.isRequired,usedRepoTags:d.default.array.isRequired,readmeMarkdown:d.default.object,draftCounts:d.default.number,updateUsedRepoTags:d.default.func.isRequired,isDirentListLoading:d.default.bool.isRequired,direntList:d.default.array.isRequired,sortBy:d.default.string.isRequired,sortOrder:d.default.string.isRequired,sortItems:d.default.func.isRequired,onAddFolder:d.default.func.isRequired,onAddFile:d.default.func.isRequired,onItemClick:d.default.func.isRequired,onItemSelected:d.default.func.isRequired,onItemDelete:d.default.func.isRequired,onItemRename:d.default.func.isRequired,onItemMove:d.default.func.isRequired,onItemCopy:d.default.func.isRequired,onDirentClick:d.default.func.isRequired,updateDirent:d.default.func.isRequired,isAllItemSelected:d.default.bool.isRequired,onAllItemSelected:d.default.func.isRequired,selectedDirentList:d.default.array.isRequired,onItemsMove:d.default.func.isRequired,onItemsCopy:d.default.func.isRequired,onItemsDelete:d.default.func.isRequired,onFileTagChanged:d.default.func,showDirentDetail:d.default.func.isRequired},b=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){return"/"===this.props.path&&0===this.props.direntList.length?u.default.createElement(f.default,{path:this.props.path,isDirentListLoading:this.props.isDirentListLoading,onAddFile:this.props.onAddFile}):u.default.createElement(l.Fragment,null,this.props.isRepoInfoBarShow&&u.default.createElement(m.default,{repoID:this.props.repoID,currentPath:this.props.path,readmeMarkdown:this.props.readmeMarkdown,draftCounts:this.props.draftCounts,usedRepoTags:this.props.usedRepoTags,updateUsedRepoTags:this.props.updateUsedRepoTags,onFileTagChanged:this.props.onFileTagChanged}),u.default.createElement(y.default,{path:this.props.path,currentRepoInfo:this.props.currentRepoInfo,repoID:this.props.repoID,isGroupOwnedRepo:this.props.isGroupOwnedRepo,userPerm:this.props.userPerm,enableDirPrivateShare:this.props.enableDirPrivateShare,direntList:this.props.direntList,sortBy:this.props.sortBy,sortOrder:this.props.sortOrder,sortItems:this.props.sortItems,onItemClick:this.props.onItemClick,onItemSelected:this.props.onItemSelected,onItemDelete:this.props.onItemDelete,onItemRename:this.props.onItemRename,onItemMove:this.props.onItemMove,onItemCopy:this.props.onItemCopy,onDirentClick:this.props.onDirentClick,isDirentListLoading:this.props.isDirentListLoading,updateDirent:this.props.updateDirent,isAllItemSelected:this.props.isAllItemSelected,onAllItemSelected:this.props.onAllItemSelected,selectedDirentList:this.props.selectedDirentList,onItemsMove:this.props.onItemsMove,onItemsCopy:this.props.onItemsCopy,onItemsDelete:this.props.onItemsDelete,onAddFile:this.props.onAddFile,onAddFolder:this.props.onAddFolder,onFileTagChanged:this.props.onFileTagChanged,showDirentDetail:this.props.showDirentDetail}))}}]),t}(u.default.Component);b.propTypes=v,t.default=b},1318:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(2),f=n(8),h=r(f),m=n(13),g=r(m),y=n(744),v=r(y);n(2275);var b={path:d.default.string.isRequired,isDirentListLoading:d.default.bool.isRequired,onAddFile:d.default.func.isRequired},w=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onCreateNewFile=function(e){n.setState({fileType:e,isCreateFileDialogShow:!n.state.isCreateFileDialogShow})},n.onCreateFileToggle=function(){n.setState({fileType:"",isCreateFileDialogShow:!n.state.isCreateFileDialogShow})},n.checkDuplicatedName=function(){return!1},n.onAddFile=function(e,t){n.setState({isCreateFileDialogShow:!1}),n.props.onAddFile(e,t)},n.state={fileType:"",isCreateFileDialogShow:!1},n}return i(t,e),s(t,[{key:"render",value:function(){return this.props.isDirentListLoading?u.default.createElement(h.default,null):u.default.createElement(l.Fragment,null,u.default.createElement("div",{className:"tip-for-new-file text-center"},u.default.createElement("p",{className:"text-secondary"},(0,p.gettext)("This folder has no content at this time.")),u.default.createElement("p",{className:"text-secondary"},(0,p.gettext)("You can create files quickly")," +"),u.default.createElement("button",{className:"big-new-file-button",onClick:this.onCreateNewFile.bind(this,".md")},"+ Markdown"),u.default.createElement("button",{className:"big-new-file-button",onClick:this.onCreateNewFile.bind(this,".pptx")},"+ PPT"),u.default.createElement("br",null),u.default.createElement("button",{className:"big-new-file-button",onClick:this.onCreateNewFile.bind(this,".docx")},"+ Word"),u.default.createElement("button",{className:"big-new-file-button",onClick:this.onCreateNewFile.bind(this,".xlsx")},"+ Excel")),this.state.isCreateFileDialogShow&&u.default.createElement(g.default,null,u.default.createElement(v.default,{parentPath:this.props.path,fileType:this.state.fileType,onAddFile:this.onAddFile,addFileCancel:this.onCreateFileToggle,checkDuplicatedName:this.checkDuplicatedName})))}}]),t}(u.default.Component);w.propTypes=b,t.default=w},1319:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(13),f=r(p),h=n(1316),m=r(h),g=n(2276),y=r(g),v=n(2278),b=r(v),w=n(2),E=n(3);n(2279);var S={repoID:d.default.string.isRequired,currentPath:d.default.string.isRequired,usedRepoTags:d.default.array.isRequired,readmeMarkdown:d.default.object,draftCounts:d.default.number,updateUsedRepoTags:d.default.func.isRequired,onFileTagChanged:d.default.func.isRequired},C=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onListTaggedFiles=function(e){n.setState({currentTag:e,isListTaggedFileShow:!n.state.isListTaggedFileShow})},n.onCloseDialog=function(){n.setState({isListTaggedFileShow:!1})},n.toggleDrafts=function(){n.setState({showRepoDrafts:!n.state.showRepoDrafts})},n.toggleReadme=function(){n.setState({showReadmeDialog:!n.state.showReadmeDialog})},n.state={currentTag:null,isListTaggedFileShow:!1,showRepoDrafts:!1,showReadmeDialog:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.repoID,r=t.currentPath,a=t.usedRepoTags,o=t.readmeMarkdown,i=null!==o?w.siteRoot+"lib/"+n+"/file"+E.Utils.joinPath(r,o.name)+"?mode=edit":"",s=null!==o?r+o.name:"";return u.default.createElement("div",{className:"repo-info-bar"},a.length>0&&u.default.createElement("ul",{className:"used-tag-list"},a.map(function(t){return u.default.createElement("li",{key:t.id,className:"used-tag-item"},u.default.createElement("span",{className:"used-tag",style:{backgroundColor:t.color}}),u.default.createElement("span",{className:"used-tag-name",title:t.name},t.name),u.default.createElement("span",{className:"used-tag-files",onClick:e.onListTaggedFiles.bind(e,t)},t.fileCount>1?t.fileCount+" files":t.fileCount+" file"))})),u.default.createElement("div",{className:a.length>0&&o?"file-info-list mt-1":"file-info-list"},null!==o&&parseInt(o.size)>1&&u.default.createElement("span",{className:"file-info",onClick:this.toggleReadme},u.default.createElement("span",{className:"info-icon sf2-icon-readme"}),u.default.createElement("span",{className:"used-tag-name"},o.name)),null!==o&&parseInt(o.size)<2&&u.default.createElement("span",{className:"file-info"},u.default.createElement("span",{className:"info-icon sf2-icon-readme"}),u.default.createElement("a",{className:"used-tag-name",href:i,target:"_blank"},o.name)),this.props.draftCounts>0&&u.default.createElement("span",{className:"file-info"},u.default.createElement("span",{className:"info-icon sf2-icon-drafts"}),u.default.createElement("span",{className:"used-tag-name"},(0,w.gettext)("draft")),u.default.createElement("span",{className:"used-tag-files",onClick:this.toggleDrafts},this.props.draftCounts>1?this.props.draftCounts+" files":this.props.draftCounts+" file"))),this.state.isListTaggedFileShow&&u.default.createElement(f.default,null,u.default.createElement(m.default,{repoID:n,currentTag:this.state.currentTag,onClose:this.onCloseDialog,toggleCancel:this.onListTaggedFiles,updateUsedRepoTags:this.props.updateUsedRepoTags,onFileTagChanged:this.props.onFileTagChanged})),this.state.showRepoDrafts&&u.default.createElement(f.default,null,u.default.createElement(y.default,{toggle:this.toggleDrafts,repoID:this.props.repoID})),this.state.showReadmeDialog&&u.default.createElement(f.default,null,u.default.createElement(b.default,{toggleCancel:this.toggleReadme,repoID:n,filePath:s,href:i,fileName:o.name})))}}]),t}(u.default.Component);C.propTypes=S,t.default=C},1320:function(e,t){var n={utf8:{stringToBytes:function(e){return n.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(n.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t},bytesToString:function(e){for(var t=[],n=0;n<e.length;n++)t.push(String.fromCharCode(e[n]));return t.join("")}}};e.exports=n},137:function(e,t){},138:function(e,t,n){"use strict";function r(){var e=window.app.config?window.app.config.lang:"zh-CH",t=void 0;switch(e){case"zh-CH":t=a;break;case"zh-tw":t=o;break;case"en":t=i;break;case"fr":t=s;break;case"de":t=l;break;case"es":case"es-ar":case"es-mx":t=u;break;case"pl":t=c;break;case"cs":t=d;break;default:t=a}return t}Object.defineProperty(t,"__esModule",{value:!0});var a=n(265),o=n(266),i=n(267),s=n(268),l=n(269),u=n(270),c=n(271),d=n(272);t.translateCalendar=r},139:function(e,t){},14:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),a={NEW_FOLDER:{key:"New Folder",value:(0,r.gettext)("New Folder")},NEW_FILE:{key:"New File",value:(0,r.gettext)("New File")},SHARE:{key:"Share",value:(0,r.gettext)("Share")},DOWNLOAD:{key:"Download",value:(0,r.gettext)("Download")},DELETE:{key:"Delete",value:(0,r.gettext)("Delete")},RENAME:{key:"Rename",value:(0,r.gettext)("Rename")},MOVE:{key:"Move",value:(0,r.gettext)("Move")},COPY:{key:"Copy",value:(0,r.gettext)("Copy")},PERMISSION:{key:"Permission",value:(0,r.gettext)("Permission")},DETAILS:{key:"Details",value:(0,r.gettext)("Details")},OPEN_VIA_CLIENT:{key:"Open via Client",value:(0,r.gettext)("Open via Client")},LOCK:{key:"Lock",value:(0,r.gettext)("Lock")},UNLOCK:{key:"Unlock",value:(0,r.gettext)("Unlock")},COMMENT:{key:"Comment",value:(0,r.gettext)("Comment")},HISTORY:{key:"History",value:(0,r.gettext)("History")},ACCESS_LOG:{key:"Access Log",value:(0,r.gettext)("Access Log")},TAGS:{key:"Tags",value:(0,r.gettext)("Tags")},RELATED_FILES:{key:"Related Files",value:(0,r.gettext)("Related Files")}};t.default=a},140:function(e,t,n){"use strict";function r(){return o.default.createElement("a",{className:"logout-icon",href:i.logoutUrl,title:(0,i.gettext)("Log out")},o.default.createElement("i",{className:"sf3-font sf3-font-logout",style:{fontSize:"24px"}}))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var a=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(a),i=n(2)},147:function(e,t){},148:function(e,t){},153:function(e,t){},158:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(2),f={onCloseSidePanel:d.default.func,showCloseSidePanelIcon:d.default.bool},h=function(e){function t(){var e,n,r,i;a(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=r=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),r.closeSide=function(){r.props.onCloseSidePanel()},i=n,o(r,i)}return i(t,e),s(t,[{key:"render",value:function(){return u.default.createElement("div",{className:"top-logo"},u.default.createElement("a",{href:p.siteRoot,id:"logo"},u.default.createElement("img",{src:p.mediaUrl+p.logoPath,height:p.logoHeight,width:p.logoWidth,title:p.siteTitle,alt:"logo"})),this.props.showCloseSidePanelIcon&&u.default.createElement("a",{className:"sf2-icon-x1 sf-popover-close side-panel-close action-icon d-md-none",onClick:this.closeSide,title:"Close","aria-label":"Close"}))}}]),t}(u.default.Component);h.propTypes=f,t.default=h},159:function(e,t){},172:function(e,t,n){(function(r){function a(){return!("undefined"===typeof window||!window.process||"renderer"!==window.process.type)||("undefined"===typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))}function o(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),n){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var a=0,o=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(a++,"%c"===e&&(o=a))}),e.splice(o,0,r)}}function i(){return"object"===typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function s(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}}function l(){var e;try{e=t.storage.debug}catch(e){}return!e&&"undefined"!==typeof r&&"env"in r&&(e=Object({NODE_ENV:"production",PUBLIC_URL:"/media/seafile-editor"}).DEBUG),e}t=e.exports=n(702),t.log=i,t.formatArgs=o,t.save=s,t.load=l,t.useColors=a,t.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(l())}).call(t,n(48))},173:function(e,t){t.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},t.decode=function(e){for(var t={},n=e.split("&"),r=0,a=n.length;r<a;r++){var o=n[r].split("=");t[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return t}},174:function(e,t){e.exports=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},175:function(e,t,n){(function(r){function a(){return!("undefined"===typeof window||!window.process||"renderer"!==window.process.type)||("undefined"===typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))}function o(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),n){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var a=0,o=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(a++,"%c"===e&&(o=a))}),e.splice(o,0,r)}}function i(){return"object"===typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function s(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}}function l(){var e;try{e=t.storage.debug}catch(e){}return!e&&"undefined"!==typeof r&&"env"in r&&(e=Object({NODE_ENV:"production",PUBLIC_URL:"/media/seafile-editor"}).DEBUG),e}t=e.exports=n(719),t.log=i,t.formatArgs=o,t.save=s,t.load=l,t.useColors=a,t.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(l())}).call(t,n(48))},176:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(3),f=n(62),h=r(f),m={isTextMode:d.default.bool.isRequired,isEditIconShow:d.default.bool.isRequired,permissionOptions:d.default.array.isRequired,currentPermission:d.default.string.isRequired,onPermissionChanged:d.default.func.isRequired},g=function(e){function t(){var e,n,r,i;a(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=r=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),r.translatePermission=function(e){return p.Utils.getShareLinkPermissionObject(e).text},i=n,o(r,i)}return i(t,e),s(t,[{key:"render",value:function(){return u.default.createElement(h.default,{isTextMode:this.props.isTextMode,isEditIconShow:this.props.isEditIconShow,options:this.props.permissionOptions,currentOption:this.props.currentPermission,onOptionChanged:this.props.onPermissionChanged,translateOption:this.translatePermission})}}]),t}(u.default.Component);g.propTypes=m,t.default=g},177:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function e(t){r(this,e),this.repo_id=t.repo_id,this.repo_name=t.repo_name,this.path=t.path,this.obj_name=t.obj_name,this.is_dir=t.is_dir,this.can_edit=t.can_edit,this.repo_folder_permission=t.repo_folder_permission,this.permissions=t.permissions,this.username=t.username,this.is_expired=t.is_expired,this.expire_date=t.expire_date,this.token=t.token,this.link=t.link,this.view_cnt=t.view_cnt,this.ctime=t.ctime};t.default=a},178:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function e(t){r(this,e),this.repo_id=t.repo_id,this.repo_name=t.repo_name,this.path=t.path,this.link=t.link,this.obj_name=t.obj_name,this.username=t.username,this.ctime=t.ctime,this.token=t.token,this.view_cnt=t.view_cnt,this.expire_date=t.expire_date,this.is_expired=t.is_expired};t.default=a},187:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(2),f=n(6),h=n(4),m=n(3),g=n(5),y=r(g),v=n(45),b=r(v),w=n(53),E=r(w);n(101),n(188);var S=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseEnter=function(){n.setState({isOperationShow:!0})},n.onMouseLeave=function(){n.setState({isOperationShow:!1})},n.userAvatarOnMouseEnter=function(){n.setState({isUserDetailsPopoverOpen:!0})},n.userAvatarOnMouseLeave=function(){n.setState({isUserDetailsPopoverOpen:!1})},n.deleteShareItem=function(){var e=n.props.item;n.props.deleteShareItem(e.user_info.name)},n.onChangeUserPermission=function(e){var t=n.props.item;n.props.onChangeUserPermission(t,e)},n.state={isOperationShow:!1,isUserDetailsPopoverOpen:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.item,t=e.is_admin?"admin":e.permission,n=this.state.isUserDetailsPopoverOpen;return u.default.createElement("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},u.default.createElement("td",{className:"name"},u.default.createElement("div",{className:"position-relative"},u.default.createElement("img",{src:e.user_info.avatar_url,width:"24",alt:e.user_info.nickname,className:"rounded-circle mr-2 cursor-pointer",onMouseEnter:this.userAvatarOnMouseEnter,onMouseLeave:this.userAvatarOnMouseLeave}),u.default.createElement("span",null,e.user_info.nickname),n&&u.default.createElement("div",{className:"user-details-popover p-4 position-absolute w-100 mt-1"},u.default.createElement("div",{className:"user-details-main pb-3"},u.default.createElement("img",{src:e.user_info.avatar_url,width:"40",alt:e.user_info.nickname,className:"rounded-circle mr-2"}),u.default.createElement("span",{className:"user-details-name"},e.user_info.nickname)),u.default.createElement("dl",{className:"m-0 mt-3 d-flex"},u.default.createElement("dt",{className:"m-0 mr-3"},(0,p.gettext)("Email")),u.default.createElement("dd",{className:"m-0"},e.user_info.contact_email))))),u.default.createElement("td",null,u.default.createElement(E.default,{isTextMode:!0,isEditIconShow:this.state.isOperationShow,currentPermission:t,permissions:this.props.permissions,onPermissionChanged:this.onChangeUserPermission})),u.default.createElement("td",null,u.default.createElement("span",{className:"sf2-icon-x3 action-icon "+(this.state.isOperationShow?"":"hide"),onClick:this.deleteShareItem,title:(0,p.gettext)("Delete")})))}}]),t}(u.default.Component),C=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){var e=this,t=this.props.items;return u.default.createElement("tbody",null,t.map(function(t,n){return u.default.createElement(S,{key:n,item:t,permissions:e.props.permissions,deleteShareItem:e.props.deleteShareItem,onChangeUserPermission:e.props.onChangeUserPermission})}))}}]),t}(u.default.Component),D={isGroupOwnedRepo:d.default.bool,itemPath:d.default.string.isRequired,itemType:d.default.string.isRequired,repoID:d.default.string.isRequired,isRepoOwner:d.default.bool.isRequired},_=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.handleSelectChange=function(e){n.setState({selectedOption:e}),n.options=[]},n.setPermission=function(e){n.setState({permission:e})},n.shareToUser=function(){var e=[],t=n.props.itemPath,r=n.props.repoID;if(n.state.selectedOption&&n.state.selectedOption.length>0)for(var a=0;a<n.state.selectedOption.length;a++)e[a]=n.state.selectedOption[a].email;n.props.isGroupOwnedRepo?h.seafileAPI.shareGroupOwnedRepoToUser(r,n.state.permission,e,t).then(function(e){var t=[];if(e.data.failed.length>0)for(var r=0;r<e.data.failed.length;r++)t[r]=e.data.failed[r];var a=e.data.success.map(function(e){return{user_info:{nickname:e.user_name,name:e.user_email},permission:e.permission,share_type:"user"}});n.setState({errorMsg:t,sharedItems:n.state.sharedItems.concat(a),selectedOption:null,permission:"rw"}),n.refs.userSelect.clearSelect()}).catch(function(e){if(e.response){var t=(0,p.gettext)("Library can not be shared to owner."),r=[];r.push(t),n.setState({errorMsg:r,selectedOption:null})}}):h.seafileAPI.shareFolder(r,t,"user",n.state.permission,e).then(function(e){var t=[];if(e.data.failed.length>0)for(var r=0;r<e.data.failed.length;r++)t[r]=e.data.failed[r];n.setState({errorMsg:t,sharedItems:n.state.sharedItems.concat(e.data.success),selectedOption:null,permission:"rw"}),n.refs.userSelect.clearSelect()}).catch(function(e){if(e.response){var t=(0,p.gettext)("Library can not be shared to owner."),r=[];r.push(t),n.setState({errorMsg:r,selectedOption:null})}})},n.deleteShareItem=function(e){var t=n.props.itemPath,r=n.props.repoID;n.props.isGroupOwnedRepo?h.seafileAPI.deleteGroupOwnedRepoSharedUserItem(r,e,t).then(function(t){n.setState({sharedItems:n.state.sharedItems.filter(function(t){return t.user_info.name!==e})})}).catch(function(e){var t=m.Utils.getErrorMsg(e);y.default.danger(t)}):h.seafileAPI.deleteShareToUserItem(r,t,"user",e).then(function(t){n.setState({sharedItems:n.state.sharedItems.filter(function(t){return t.user_info.name!==e})})}).catch(function(e){var t=m.Utils.getErrorMsg(e);y.default.danger(t)})},n.onChangeUserPermission=function(e,t){var r=n.props.itemPath,a=n.props.repoID,o=e.user_info.name;n.props.isGroupOwnedRepo?h.seafileAPI.modifyGroupOwnedRepoUserSharedPermission(a,t,o,r).then(function(){n.updateSharedItems(e,t)}).catch(function(e){var t=m.Utils.getErrorMsg(e);y.default.danger(t)}):h.seafileAPI.updateShareToUserItemPermission(a,r,"user",o,t).then(function(){n.updateSharedItems(e,t)}).catch(function(e){var t=m.Utils.getErrorMsg(e);y.default.danger(t)})},n.updateSharedItems=function(e,t){var r=e.user_info.name,a=n.state.sharedItems.map(function(e){var n=e.user_info.name;return r===n&&(e.permission=t,e.is_admin="admin"===t),e});n.setState({sharedItems:a})},n.state={selectedOption:null,errorMsg:[],permission:"rw",sharedItems:[]},n.options=[],n.permissions=[];var r=e.itemType,i=e.isRepoOwner;return"library"===r?n.permissions=i?["rw","r","admin","cloud-edit","preview"]:["rw","r","cloud-edit","preview"]:"dir"===n.props.itemType&&(n.permissions=["rw","r","cloud-edit","preview"]),!n.props.isGroupOwnedRepo&&p.isPro||(n.permissions=["rw","r"]),n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.itemPath,n=this.props.repoID;h.seafileAPI.listSharedItems(n,t,"user").then(function(t){0!==t.data.length&&e.setState({sharedItems:t.data})}).catch(function(e){var t=m.Utils.getErrorMsg(e);y.default.danger(t)})}},{key:"render",value:function(){var e=this.state.sharedItems,t=u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:"47%"},(0,p.gettext)("User")),u.default.createElement("th",{width:"35%"},(0,p.gettext)("Permission")),u.default.createElement("th",{width:"18%"})));return u.default.createElement(l.Fragment,null,u.default.createElement("table",{className:"w-xs-200"},t,u.default.createElement("tbody",null,u.default.createElement("tr",null,u.default.createElement("td",null,u.default.createElement(b.default,{ref:"userSelect",isMulti:!0,className:"reviewer-select",placeholder:(0,p.gettext)("Select users..."),onSelectChange:this.handleSelectChange})),u.default.createElement("td",null,u.default.createElement(E.default,{isTextMode:!1,isEditIconShow:!1,currentPermission:this.state.permission,permissions:this.permissions,onPermissionChanged:this.setPermission})),u.default.createElement("td",null,u.default.createElement(f.Button,{onClick:this.shareToUser},(0,p.gettext)("Submit")))),this.state.errorMsg.length>0&&this.state.errorMsg.map(function(e,t){var n="";return n=e.email?e.email+": "+e.error_msg:e,u.default.createElement("tr",{key:t},u.default.createElement("td",{colSpan:3},u.default.createElement("p",{className:"error"},n)))}))),u.default.createElement("div",{className:"share-list-container"},u.default.createElement("table",{className:"table-thead-hidden w-xs-200"},t,u.default.createElement(C,{items:e,permissions:this.permissions,deleteShareItem:this.deleteShareItem,onChangeUserPermission:this.onChangeUserPermission}))))}}]),t}(u.default.Component);_.propTypes=D,t.default=_},188:function(e,t){},189:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=r(u),d=n(1),p=r(d),f=n(6),h=n(82),m=r(h),g=n(2),y=n(4),v=n(3),b=n(5),w=r(b),E=n(53),S=r(E),C=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseEnter=function(){n.setState({isOperationShow:!0})},n.onMouseLeave=function(){n.setState({isOperationShow:!1})},n.deleteShareItem=function(){var e=n.props.item;n.props.deleteShareItem(e.group_info.id)},n.onChangeUserPermission=function(e){var t=n.props.item;n.props.onChangeUserPermission(t,e)},n.state={isOperationShow:!1},n}return i(t,e),l(t,[{key:"render",value:function(){var e=this.props.item,t=e.is_admin?"admin":e.permission;return c.default.createElement("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},c.default.createElement("td",{className:"name"},e.group_info.name),c.default.createElement("td",null,c.default.createElement(S.default,{isTextMode:!0,isEditIconShow:this.state.isOperationShow,currentPermission:t,permissions:this.props.permissions,onPermissionChanged:this.onChangeUserPermission})),c.default.createElement("td",null,c.default.createElement("span",{className:"sf2-icon-x3 action-icon "+(this.state.isOperationShow?"":"hide"),onClick:this.deleteShareItem,title:(0,g.gettext)("Delete")})))}}]),t}(c.default.Component),D=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),l(t,[{key:"render",value:function(){var e=this,t=this.props.items;return c.default.createElement("tbody",null,t.map(function(t,n){return c.default.createElement(C,{key:n,item:t,permissions:e.props.permissions,deleteShareItem:e.props.deleteShareItem,onChangeUserPermission:e.props.onChangeUserPermission})}))}}]),t}(c.default.Component),_={isGroupOwnedRepo:p.default.bool,itemPath:p.default.string.isRequired,itemType:p.default.string.isRequired,repoID:p.default.string.isRequired,isRepoOwner:p.default.bool.isRequired},P=function(e){return c.default.createElement("div",s({},e.innerProps,{style:{margin:"6px 10px",textAlign:"center",color:"hsl(0,0%,50%)"}}),(0,g.gettext)("Group not found"))},k=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.handleSelectChange=function(e){n.setState({selectedOption:e})},n.loadOptions=function(){y.seafileAPI.shareableGroups().then(function(e){for(var t=[],r=0;r<e.data.length;r++){var a={};a.value=e.data[r].name,a.id=e.data[r].id,a.label=e.data[r].name,t.push(a)}n.setState({options:t})}).catch(function(e){var t=v.Utils.getErrorMsg(e);w.default.danger(t)})},n.listSharedGroups=function(){var e=n.props.itemPath,t=n.props.repoID;y.seafileAPI.listSharedItems(t,e,"group").then(function(e){0!==e.data.length&&n.setState({sharedItems:e.data})}).catch(function(e){var t=v.Utils.getErrorMsg(e);w.default.danger(t)})},n.setPermission=function(e){n.setState({permission:e})},n.shareToGroup=function(){var e=[],t=n.props.itemPath,r=n.props.repoID,a=n.props.isGroupOwnedRepo;if(n.state.selectedOption&&n.state.selectedOption.length>0)for(var o=0;o<n.state.selectedOption.length;o++)e[o]=n.state.selectedOption[o].id;a?y.seafileAPI.shareGroupOwnedRepoToGroup(r,n.state.permission,e,t).then(function(e){var t=[];if(e.data.failed.length>0)for(var r=0;r<e.data.failed.length;r++)t[r]=e.data.failed[r];var a=e.data.success.map(function(e){return{group_info:{id:e.group_id,name:e.group_name},permission:e.permission,share_type:"group"}});n.setState({errorMsg:t,sharedItems:n.state.sharedItems.concat(a),selectedOption:null,permission:"rw"})}).catch(function(e){var t=v.Utils.getErrorMsg(e);w.default.danger(t)}):y.seafileAPI.shareFolder(r,t,"group",n.state.permission,e).then(function(e){var t=[];if(e.data.failed.length>0)for(var r=0;r<e.data.failed.length;r++)t[r]=e.data.failed[r];n.setState({errorMsg:t,sharedItems:n.state.sharedItems.concat(e.data.success),selectedOption:null,permission:"rw"})}).catch(function(e){var t=v.Utils.getErrorMsg(e);w.default.danger(t)})},n.deleteShareItem=function(e){var t=n.props.itemPath,r=n.props.repoID;n.props.isGroupOwnedRepo?y.seafileAPI.deleteGroupOwnedRepoSharedGroupItem(r,e,t).then(function(){n.setState({sharedItems:n.state.sharedItems.filter(function(t){return t.group_info.id!==e})})}).catch(function(e){var t=v.Utils.getErrorMsg(e);w.default.danger(t)}):y.seafileAPI.deleteShareToGroupItem(r,t,"group",e).then(function(){n.setState({sharedItems:n.state.sharedItems.filter(function(t){return t.group_info.id!==e})})}).catch(function(e){var t=v.Utils.getErrorMsg(e);w.default.danger(t)})},n.onChangeUserPermission=function(e,t){var r=n.props.itemPath,a=n.props.repoID,o=e.group_info.id;n.props.isGroupOwnedRepo?y.seafileAPI.modifyGroupOwnedRepoGroupSharedPermission(a,t,o,r).then(function(){n.updateSharedItems(e,t)}).catch(function(e){var t=v.Utils.getErrorMsg(e);w.default.danger(t)}):y.seafileAPI.updateShareToGroupItemPermission(a,r,"group",o,t).then(function(){n.updateSharedItems(e,t)}).catch(function(e){var t=v.Utils.getErrorMsg(e);w.default.danger(t)})},n.updateSharedItems=function(e,t){var r=e.group_info.id,a=n.state.sharedItems.map(function(e){var n=e.group_info.id;return r===n&&(e.permission=t,e.is_admin="admin"===t),e});n.setState({sharedItems:a})},n.state={options:[],selectedOption:null,errorMsg:[],permission:"rw",sharedItems:[]},n.permissions=[];var r=e.itemType,i=e.isRepoOwner;return"library"===r?n.permissions=i?["rw","r","admin","cloud-edit","preview"]:["rw","r","cloud-edit","preview"]:"dir"===r&&(n.permissions=["rw","r","cloud-edit","preview"]),!n.props.isGroupOwnedRepo&&g.isPro||(n.permissions=["rw","r"]),n}return i(t,e),l(t,[{key:"componentDidMount",value:function(){this.loadOptions(),this.listSharedGroups()}},{key:"render",value:function(){var e=c.default.createElement("thead",null,c.default.createElement("tr",null,c.default.createElement("th",{width:"47%"},(0,g.gettext)("Group")),c.default.createElement("th",{width:"35%"},(0,g.gettext)("Permission")),c.default.createElement("th",{width:"18%"})));return c.default.createElement(u.Fragment,null,c.default.createElement("table",{className:"w-xs-200"},e,c.default.createElement("tbody",null,c.default.createElement("tr",null,c.default.createElement("td",null,c.default.createElement(m.default,{isMulti:!0,onChange:this.handleSelectChange,options:this.state.options,placeholder:(0,g.gettext)("Select groups..."),maxMenuHeight:200,inputId:"react-select-2-input",value:this.state.selectedOption,components:{NoOptionsMessage:P}})),c.default.createElement("td",null,c.default.createElement(S.default,{isTextMode:!1,isEditIconShow:!1,currentPermission:this.state.permission,permissions:this.permissions,onPermissionChanged:this.setPermission})),c.default.createElement("td",null,c.default.createElement(f.Button,{onClick:this.shareToGroup},(0,g.gettext)("Submit")))),this.state.errorMsg.length>0&&this.state.errorMsg.map(function(e,t){var n=e.group_name+": "+e.error_msg;return c.default.createElement("tr",{key:t},c.default.createElement("td",{colSpan:3},c.default.createElement("p",{className:"error"},n)))}))),c.default.createElement("div",{className:"share-list-container"},c.default.createElement("table",{className:"table-thead-hidden w-xs-200"},e,c.default.createElement(D,{items:this.state.sharedItems,permissions:this.permissions,deleteShareItem:this.deleteShareItem,onChangeUserPermission:this.onChangeUserPermission}))))}}]),t}(c.default.Component);k.propTypes=_,t.default=k},190:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(2),f=n(7),h=r(f),m=n(6),g=n(4),y=n(3),v=n(5),b=r(v),w=n(8),E=r(w),S=n(53),C=r(S);n(101);var D=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseEnter=function(){n.setState({isOperationShow:!0})},n.onMouseLeave=function(){n.setState({isOperationShow:!1})},n.deleteShareItem=function(){var e=n.props.item;n.props.deleteShareItem(e.token)},n.onChangeUserPermission=function(e){var t=n.props.item;n.props.onChangeUserPermission(t.token,e)},n.state={isOperationShow:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.item,t=e.is_admin?"admin":e.permission;return u.default.createElement("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},u.default.createElement("td",{className:"name"},e.accepter),u.default.createElement("td",null,u.default.createElement(C.default,{isTextMode:!0,isEditIconShow:this.state.isOperationShow,currentPermission:t,permissions:this.props.permissions,onPermissionChanged:this.onChangeUserPermission})),u.default.createElement("td",null,(0,h.default)(e.expire_time).format("YYYY-MM-DD")),u.default.createElement("td",{className:"name"},e.inviter_name),u.default.createElement("td",null,u.default.createElement("span",{className:"sf2-icon-x3 action-icon "+(this.state.isOperationShow?"":"hide"),onClick:this.deleteShareItem,title:(0,p.gettext)("Delete")})))}}]),t}(u.default.Component),_=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){var e=this,t=this.props.items;return u.default.createElement("tbody",null,t.map(function(t,n){return u.default.createElement(D,{key:n,item:t,permissions:e.props.permissions,deleteShareItem:e.props.deleteShareItem,onChangeUserPermission:e.props.onChangeUserPermission})}))}}]),t}(u.default.Component),P={itemPath:d.default.string.isRequired,repoID:d.default.string.isRequired},k=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleInputChange=function(e){var t=e.target.value;n.setState({emails:t}),n.state.errorMsg&&n.setState({errorMsg:""})},n.handleKeyDown=function(e){13===e.keyCode&&(e.preventDefault(),n.shareAndInvite())},n.setPermission=function(e){n.setState({permission:e})},n.onInvitePeople=function(e){e.push.apply(e,n.state.sharedItems),n.setState({sharedItems:e})},n.shareAndInvite=function(){var e=n.state.emails.trim();if(!e)return n.setState({errorMsg:(0,p.gettext)("It is required.")}),!1;var t=[];e=e.split(",");for(var r=0,a=e.length;r<a;r++){var o=e[r].trim();o&&t.push(o)}if(!t.length)return n.setState({errorMsg:(0,p.gettext)("Email is invalid.")}),!1;n.setState({isSubmitting:!0});var i=n.props.itemPath,s=n.props.repoID,l=n.state.permission;g.seafileAPI.addRepoShareInvitations(s,i,t,l).then(function(e){var t=e.data.success;if(t.length){var r="";r=1==t.length?(0,p.gettext)("Successfully invited %(email).").replace("%(email)",t[0].accepter):(0,p.gettext)("Successfully invited %(email) and %(num) other people.").replace("%(email)",t[0].accepter).replace("%(num)",t.length-1),b.default.success(r),n.onInvitePeople(t)}var a=e.data.failed;if(a.length)for(var o=0,i=a.length;o<i;o++){var s=a[o].email+": "+a[o].error_msg;b.default.danger(s)}n.setState({isSubmitting:!1})}).catch(function(e){var t=y.Utils.getErrorMsg(e);b.default.danger(t),n.setState({isSubmitting:!1})})},n.deleteShareItem=function(e){var t=n.props.itemPath,r=n.props.repoID;g.seafileAPI.deleteRepoShareInvitation(r,t,e).then(function(t){n.setState({sharedItems:n.state.sharedItems.filter(function(t){return t.token!==e})})}).catch(function(e){var t=y.Utils.getErrorMsg(e);b.default.danger(t)})},n.onChangeUserPermission=function(e,t){var r=n.props.itemPath,a=n.props.repoID;g.seafileAPI.updateRepoShareInvitation(a,r,e,t).then(function(){n.updateSharedItems(e,t)}).catch(function(e){var t=y.Utils.getErrorMsg(e);b.default.danger(t)})},n.updateSharedItems=function(e,t){var r=n.state.sharedItems.map(function(n){return n.token===e&&(n.permission=t),n});n.setState({sharedItems:r})},n.state={errorMsg:"",permission:"r",sharedItems:[],emails:"",isSubmitting:!1},n.permissions=["rw","r"],n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.itemPath,n=this.props.repoID;g.seafileAPI.listRepoShareInvitations(n,t).then(function(t){0!==t.data.length&&e.setState({sharedItems:t.data.repo_share_invitation_list})}).catch(function(e){var t=y.Utils.getErrorMsg(e);b.default.danger(t)})}},{key:"render",value:function(){var e=this.state,t=e.sharedItems,n=e.isSubmitting;return u.default.createElement(l.Fragment,null,u.default.createElement("table",{className:"table-thead-hidden w-xs-200"},u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:"50%"},(0,p.gettext)("Invite Guest")),u.default.createElement("th",{width:"35%"},(0,p.gettext)("Permission")),u.default.createElement("th",{width:"15%"},""))),u.default.createElement("tbody",null,u.default.createElement("tr",null,u.default.createElement("td",null,u.default.createElement(m.Input,{type:"text",id:"emails",placeholder:(0,p.gettext)("Emails, separated by ','"),value:this.state.emails,onChange:this.handleInputChange,onKeyDown:this.handleKeyDown})),u.default.createElement("td",null,u.default.createElement(C.default,{isTextMode:!1,isEditIconShow:!1,currentPermission:this.state.permission,permissions:this.permissions,onPermissionChanged:this.setPermission})),u.default.createElement("td",null,u.default.createElement(m.Button,{onClick:this.shareAndInvite,disabled:n},n?u.default.createElement(E.default,null):(0,p.gettext)("Submit")))),this.state.errorMsg.length>0&&u.default.createElement("tr",{key:"error"},u.default.createElement("td",{colSpan:3},u.default.createElement("p",{className:"error"},this.state.errorMsg))))),u.default.createElement("div",{className:"share-list-container"},u.default.createElement("table",{className:"w-xs-200"},u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:"25%"},(0,p.gettext)("Email")),u.default.createElement("th",{width:"20%"},(0,p.gettext)("Permission")),u.default.createElement("th",{width:"20%"},(0,p.gettext)("Expiration")),u.default.createElement("th",{width:"20%"},(0,p.gettext)("Inviter")),u.default.createElement("th",{width:"15%"},""))),u.default.createElement(_,{items:t,permissions:this.permissions,deleteShareItem:this.deleteShareItem,onChangeUserPermission:this.onChangeUserPermission}))))}}]),t}(u.default.Component);k.propTypes=P,t.default=k},191:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(7),f=r(p),h=n(152),m=r(h),g=n(6),y=n(2),v=n(176),b=r(v),w=n(4),E=n(3),S=n(177),C=r(S),D=n(5),_=r(D),P=n(8),k=r(P),M=n(109),O=r(M),L=n(98),I=r(L),T={itemPath:d.default.string.isRequired,repoID:d.default.string.isRequired,closeShareDialog:d.default.func.isRequired},R=E.Utils.isDesktop()?250:210,N=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.setExp=function(e){n.setState({setExp:e.target.value})},n.disabledDate=function(e){if(!e)return!1;if(n.isExpireDaysNoLimit)return e.isBefore((0,f.default)(),"day");var t=(0,f.default)().add(y.shareLinkExpireDaysMin,"days"),r=(0,f.default)().add(y.shareLinkExpireDaysMax,"days");return 0!==y.shareLinkExpireDaysMin&&0!==y.shareLinkExpireDaysMax?e.isBefore(t,"day")||e.isAfter(r,"day"):0!==y.shareLinkExpireDaysMin&&0===y.shareLinkExpireDaysMax?e.isBefore(t,"day"):0===y.shareLinkExpireDaysMin&&0!==y.shareLinkExpireDaysMax?e.isBefore((0,f.default)(),"day")||e.isAfter(r,"day"):void 0},n.onExpDateChanged=function(e){n.setState({expDate:e})},n.onPasswordInputChecked=function(){n.setState({isShowPasswordInput:!n.state.isShowPasswordInput,password:"",passwdnew:"",errorInfo:""})},n.togglePasswordVisible=function(){n.setState({isPasswordVisible:!n.state.isPasswordVisible})},n.generatePassword=function(){var e=E.Utils.generatePassword(y.shareLinkPasswordMinLength);n.setState({password:e,passwdnew:e})},n.inputPassword=function(e){var t=e.target.value.trim();n.setState({password:t})},n.inputPasswordNew=function(e){var t=e.target.value.trim();n.setState({passwdnew:t})},n.setPermission=function(e){n.setState({currentPermission:e.target.value})},n.generateShareLink=function(){if(n.validateParamsInput()){n.setState({errorInfo:""});var e=n.props,t=e.itemPath,r=e.repoID,a=n.state,o=a.password,i=a.isExpireChecked,s=a.setExp,l=a.expireDays,u=a.expDate,c=void 0;if(y.isPro){var d=E.Utils.getShareLinkPermissionObject(n.state.currentPermission).permissionDetails;c=JSON.stringify(d)}var p="";i&&(p="by-days"==s?(0,f.default)().add(parseInt(l),"days").format():u.format()),w.seafileAPI.createShareLink(r,t,o,p,c).then(function(e){var t=new C.default(e.data);n.setState({sharedLinkInfo:t})}).catch(function(e){var t=E.Utils.getErrorMsg(e);_.default.danger(t)})}},n.onCopySharedLink=function(){var e=n.state.sharedLinkInfo.link;(0,m.default)(e),_.default.success((0,y.gettext)("Share link is copied to the clipboard.")),n.props.closeShareDialog()},n.onCopyDownloadLink=function(){var e=n.state.sharedLinkInfo.link+"?dl=1";(0,m.default)(e),_.default.success((0,y.gettext)("Direct download link is copied to the clipboard.")),n.props.closeShareDialog()},n.deleteShareLink=function(){var e=n.state.sharedLinkInfo;w.seafileAPI.deleteShareLink(e.token).then(function(){n.setState({password:"",passwordnew:"",isShowPasswordInput:!1,expireDays:n.defaultExpireDays,isExpireChecked:!n.isExpireDaysNoLimit,errorInfo:"",sharedLinkInfo:null,isNoticeMessageShow:!1})}).catch(function(e){var t=E.Utils.getErrorMsg(e);_.default.danger(t)})},n.onExpireChecked=function(e){n.setState({isExpireChecked:e.target.checked})},n.onExpireDaysChanged=function(e){var t=e.target.value.trim();n.setState({expireDays:t})},n.validateParamsInput=function(){var e=n.state,t=e.isShowPasswordInput,r=e.password,a=e.passwdnew,o=e.isExpireChecked,i=e.setExp,s=e.expireDays,l=e.expDate;if(t){if(0===r.length)return n.setState({errorInfo:"Please enter password"}),!1;if(r.length<y.shareLinkPasswordMinLength)return n.setState({errorInfo:"Password is too short"}),!1;if(r!==a)return n.setState({errorInfo:"Passwords don't match"}),!1}if(o){if("by-date"==i)return!!l||(n.setState({errorInfo:"Please select an expiration time"}),!1);var u=/^\d+$/;if(!s)return n.setState({errorInfo:"Please enter days"}),!1;if(!u.test(s))return n.setState({errorInfo:"Please enter a non-negative integer"}),!1;s=parseInt(s);var c=y.shareLinkExpireDaysMin,d=y.shareLinkExpireDaysMax;if(0!==c&&0==d&&s<c)return n.setState({errorInfo:"Please enter valid days"}),!1;if(0===c&&0!==d&&s>d)return n.setState({errorInfo:"Please enter valid days"}),!1;if(0!==c&&0!==d&&(s<c||s>d))return n.setState({errorInfo:"Please enter valid days"}),!1;n.setState({expireDays:s})}return!0},n.onNoticeMessageToggle=function(){n.setState({isNoticeMessageShow:!n.state.isNoticeMessageShow})},n.toggleSendLink=function(){n.setState({isSendLinkShown:!n.state.isSendLinkShown})},n.handleMouseOver=function(){n.setState({isOpIconShown:!0})},n.handleMouseOut=function(){n.setState({isOpIconShown:!1})},n.changePerm=function(e){var t=E.Utils.getShareLinkPermissionObject(e).permissionDetails;w.seafileAPI.updateShareLink(n.state.sharedLinkInfo.token,JSON.stringify(t)).then(function(e){var t=new C.default(e.data);n.setState({sharedLinkInfo:t});var r=(0,y.gettext)("Successfully modified permission.");_.default.success(r)}).catch(function(e){var t=E.Utils.getErrorMsg(e);_.default.danger(t)})},n.isExpireDaysNoLimit=0===y.shareLinkExpireDaysMin&&0===y.shareLinkExpireDaysMax&&0==y.shareLinkExpireDaysDefault,n.defaultExpireDays=n.isExpireDaysNoLimit?"":y.shareLinkExpireDaysDefault;var r="";return 0!==y.shareLinkExpireDaysMin&&0!==y.shareLinkExpireDaysMax?r=(0,y.gettext)("{minDays_placeholder} - {maxDays_placeholder} days").replace("{minDays_placeholder}",y.shareLinkExpireDaysMin).replace("{maxDays_placeholder}",y.shareLinkExpireDaysMax):0!==y.shareLinkExpireDaysMin&&0===y.shareLinkExpireDaysMax?r=(0,y.gettext)("Greater than or equal to {minDays_placeholder} days").replace("{minDays_placeholder}",y.shareLinkExpireDaysMin):0===y.shareLinkExpireDaysMin&&0!==y.shareLinkExpireDaysMax&&(r=(0,y.gettext)("Less than or equal to {maxDays_placeholder} days").replace("{maxDays_placeholder}",y.shareLinkExpireDaysMax)),n.expirationLimitTip=r,n.state={isOpIconShown:!1,isValidate:!1,isShowPasswordInput:!1,isPasswordVisible:!1,isExpireChecked:!n.isExpireDaysNoLimit,setExp:"by-days",expireDays:n.defaultExpireDays,expDate:null,password:"",passwdnew:"",errorInfo:"",sharedLinkInfo:null,isNoticeMessageShow:!1,isLoading:!0,permissionOptions:[],currentPermission:"",isSendLinkShown:!1},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.itemPath,n=this.props.repoID;if(w.seafileAPI.getShareLink(n,t).then(function(t){if(0!==t.data.length){var n=new C.default(t.data[0]);e.setState({isLoading:!1,sharedLinkInfo:n})}else e.setState({isLoading:!1})}).catch(function(e){var t=E.Utils.getErrorMsg(e);_.default.danger(t)}),y.isPro)if("library"===this.props.itemType){var r=E.Utils.getShareLinkPermissionList(this.props.itemType,"",t);this.setState({permissionOptions:r,currentPermission:r[0]})}else{var a=void 0;"file"===this.props.itemType?a=w.seafileAPI.getFileInfo(n,t):"dir"===this.props.itemType&&(a=w.seafileAPI.getDirInfo(n,t)),a.then(function(n){var r=n.data.can_edit,a=n.data.permission,o=E.Utils.getShareLinkPermissionList(e.props.itemType,a,t,r);e.setState({permissionOptions:o,currentPermission:o[0]})}).catch(function(e){var t=E.Utils.getErrorMsg(e);_.default.danger(t)})}}},{key:"render",value:function(){var e=this;if(this.state.isLoading)return u.default.createElement(k.default,null);var t=(0,y.gettext)("(at least {passwordLength} characters)");if(t=t.replace("{passwordLength}",y.shareLinkPasswordMinLength),this.state.sharedLinkInfo){var n=this.state.sharedLinkInfo,r=E.Utils.getShareLinkPermissionStr(n.permissions),a=this.state,o=a.permissionOptions,i=a.isOpIconShown;return u.default.createElement("div",null,u.default.createElement(g.Form,{className:"mb-4"},u.default.createElement(g.FormGroup,{className:"mb-0"},u.default.createElement("dt",{className:"text-secondary font-weight-normal"},(0,y.gettext)("Link:")),u.default.createElement("dd",{className:"d-flex"},u.default.createElement("span",null,n.link)," ",n.is_expired?u.default.createElement("span",{className:"err-message"},"(",(0,y.gettext)("Expired"),")"):u.default.createElement("span",{className:"far fa-copy action-icon",onClick:this.onCopySharedLink}))),!n.is_dir&&n.permissions.can_download&&u.default.createElement(g.FormGroup,{className:"mb-0"},u.default.createElement("dt",{className:"text-secondary font-weight-normal"},(0,y.gettext)("Direct Download Link:")),u.default.createElement("dd",{className:"d-flex"},u.default.createElement("span",null,n.link,"?dl=1")," ",n.is_expired?u.default.createElement("span",{className:"err-message"},"(",(0,y.gettext)("Expired"),")"):u.default.createElement("span",{className:"far fa-copy action-icon",onClick:this.onCopyDownloadLink}))),n.expire_date&&u.default.createElement(g.FormGroup,{className:"mb-0"},u.default.createElement("dt",{className:"text-secondary font-weight-normal"},(0,y.gettext)("Expiration Date:")),u.default.createElement("dd",null,(0,f.default)(n.expire_date).format("YYYY-MM-DD HH:mm:ss"))),y.isPro&&n.permissions&&u.default.createElement(g.FormGroup,{className:"mb-0"},u.default.createElement("dt",{className:"text-secondary font-weight-normal"},(0,y.gettext)("Permission:")),u.default.createElement("dd",{style:{width:"250px"},onMouseEnter:this.handleMouseOver,onMouseLeave:this.handleMouseOut},u.default.createElement(b.default,{isTextMode:!0,isEditIconShow:i&&!n.is_expired,currentPermission:r,permissionOptions:o,onPermissionChanged:this.changePerm})))),y.canSendShareLinkEmail&&!this.state.isSendLinkShown&&!this.state.isNoticeMessageShow&&u.default.createElement(g.Button,{onClick:this.toggleSendLink,className:"mr-2"},(0,y.gettext)("Send")),this.state.isSendLinkShown&&u.default.createElement(O.default,{linkType:"shareLink",token:n.token,toggleSendLink:this.toggleSendLink,closeShareDialog:this.props.closeShareDialog}),!this.state.isSendLinkShown&&!this.state.isNoticeMessageShow&&u.default.createElement(g.Button,{onClick:this.onNoticeMessageToggle},(0,y.gettext)("Delete")),this.state.isNoticeMessageShow&&u.default.createElement("div",{className:"alert alert-warning"},u.default.createElement("h4",{className:"alert-heading"},(0,y.gettext)("Are you sure you want to delete the share link?")),u.default.createElement("p",{className:"mb-4"},(0,y.gettext)("If the share link is deleted, no one will be able to access it any more.")),u.default.createElement("button",{className:"btn btn-primary",onClick:this.deleteShareLink},(0,y.gettext)("Delete"))," ",u.default.createElement("button",{className:"btn btn-secondary",onClick:this.onNoticeMessageToggle},(0,y.gettext)("Cancel"))))}return u.default.createElement(g.Form,{className:"generate-share-link"},u.default.createElement(g.FormGroup,{check:!0},u.default.createElement(g.Label,{check:!0},u.default.createElement(g.Input,{type:"checkbox",onChange:this.onPasswordInputChecked}),u.default.createElement("span",null,(0,y.gettext)("Add password protection"))),this.state.isShowPasswordInput&&u.default.createElement("div",{className:"ml-4"},u.default.createElement(g.FormGroup,null,u.default.createElement(g.Label,{for:"passwd"},(0,y.gettext)("Password")),u.default.createElement("span",{className:"tip"},t),u.default.createElement(g.InputGroup,{style:{width:R}},u.default.createElement(g.Input,{id:"passwd",type:this.state.isPasswordVisible?"text":"password",value:this.state.password||"",onChange:this.inputPassword}),u.default.createElement(g.InputGroupAddon,{addonType:"append"},u.default.createElement(g.Button,{onClick:this.togglePasswordVisible},u.default.createElement("i",{className:"link-operation-icon fas "+(this.state.isPasswordVisible?"fa-eye":"fa-eye-slash")})),u.default.createElement(g.Button,{onClick:this.generatePassword},u.default.createElement("i",{className:"link-operation-icon fas fa-magic"}))))),u.default.createElement(g.FormGroup,null,u.default.createElement(g.Label,{for:"passwd-again"},(0,y.gettext)("Password again")),u.default.createElement(g.Input,{id:"passwd-again",style:{width:R},type:this.state.isPasswordVisible?"text":"password",value:this.state.passwdnew||"",onChange:this.inputPasswordNew})))),u.default.createElement(g.FormGroup,{check:!0},u.default.createElement(g.Label,{check:!0},this.isExpireDaysNoLimit?u.default.createElement(g.Input,{type:"checkbox",onChange:this.onExpireChecked}):u.default.createElement(g.Input,{type:"checkbox",checked:!0,readOnly:!0,disabled:!0}),u.default.createElement("span",null,(0,y.gettext)("Add auto expiration"))),this.state.isExpireChecked&&u.default.createElement("div",{className:"ml-4"},u.default.createElement(g.FormGroup,{check:!0},u.default.createElement(g.Label,{check:!0},u.default.createElement(g.Input,{type:"radio",name:"set-exp",value:"by-days",checked:"by-days"==this.state.setExp,onChange:this.setExp,className:"mr-1"}),u.default.createElement("span",null,(0,y.gettext)("Expiration days"))),"by-days"==this.state.setExp&&u.default.createElement(l.Fragment,null,u.default.createElement(g.InputGroup,{style:{width:R}},u.default.createElement(g.Input,{type:"text",value:this.state.expireDays,onChange:this.onExpireDaysChanged}),u.default.createElement(g.InputGroupAddon,{addonType:"append"},u.default.createElement(g.InputGroupText,null,(0,y.gettext)("days")))),!this.state.isExpireDaysNoLimit&&u.default.createElement(g.FormText,{color:"muted"},this.expirationLimitTip))),u.default.createElement(g.FormGroup,{check:!0},u.default.createElement(g.Label,{check:!0},u.default.createElement(g.Input,{type:"radio",name:"set-exp",value:"by-date",checked:"by-date"==this.state.setExp,onChange:this.setExp,className:"mr-1"}),u.default.createElement("span",null,(0,y.gettext)("Expiration time"))),"by-date"==this.state.setExp&&u.default.createElement(I.default,{inputWidth:R,disabledDate:this.disabledDate,value:this.state.expDate,onChange:this.onExpDateChanged})))),y.isPro&&u.default.createElement(g.FormGroup,{check:!0},u.default.createElement(g.Label,{check:!0},u.default.createElement("span",null,(0,y.gettext)("Set permission"))),this.state.permissionOptions.map(function(t,n){return u.default.createElement(g.FormGroup,{check:!0,className:"ml-4",key:n},u.default.createElement(g.Label,{check:!0},u.default.createElement(g.Input,{type:"radio",name:"permission",value:t,checked:e.state.currentPermission==t,onChange:e.setPermission,className:"mr-1"}),E.Utils.getShareLinkPermissionObject(t).text))})),this.state.errorInfo&&u.default.createElement(g.Alert,{color:"danger",className:"mt-2"},(0,y.gettext)(this.state.errorInfo)),u.default.createElement(g.Button,{onClick:this.generateShareLink,className:"mt-2"},(0,y.gettext)("Generate")))}}]),t}(u.default.Component);N.propTypes=T,t.default=N},192:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(152),f=r(p),h=n(7),m=r(h),g=n(6),y=n(2),v=n(4),b=n(3),w=n(178),E=r(w),S=n(5),C=r(S),D=n(109),_=r(D),P=n(98),k=r(P),M={itemPath:d.default.string.isRequired,repoID:d.default.string.isRequired,closeShareDialog:d.default.func.isRequired},O=b.Utils.isDesktop()?250:210,L=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.getUploadLink=function(){var e=n.props.itemPath,t=n.props.repoID;v.seafileAPI.getUploadLink(t,e).then(function(e){if(0!==e.data.length){var t=new E.default(e.data[0]);n.setState({sharedUploadInfo:t})}}).catch(function(e){var t=b.Utils.getErrorMsg(e,!0);e.response&&403===e.response.status||C.default.danger(t),n.props.closeShareDialog()})},n.addPassword=function(){n.setState({showPasswordInput:!n.state.showPasswordInput,password:"",passwdnew:"",errorInfo:""})},n.togglePasswordVisible=function(){n.setState({passwordVisible:!n.state.passwordVisible})},n.generatePassword=function(){var e=b.Utils.generatePassword(y.shareLinkPasswordMinLength);n.setState({password:e,passwordnew:e})},n.inputPassword=function(e){n.setState({password:e.target.value})},n.inputPasswordNew=function(e){n.setState({passwordnew:e.target.value})},n.generateUploadLink=function(){if(n.validateParamsInput()){n.setState({errorInfo:""});var e=n.props,t=e.itemPath,r=e.repoID,a=n.state,o=a.password,i=a.isExpireChecked,s=a.setExp,l=a.expireDays,u=a.expDate,c="";i&&(c="by-days"==s?(0,m.default)().add(parseInt(l),"days").format():u.format()),v.seafileAPI.createUploadLink(r,t,o,c).then(function(e){var t=new E.default(e.data);n.setState({sharedUploadInfo:t})}).catch(function(e){var t=b.Utils.getErrorMsg(e);C.default.danger(t)})}},n.validateParamsInput=function(){var e=n.state,t=e.showPasswordInput,r=e.password,a=e.passwordnew,o=e.isExpireChecked,i=e.setExp,s=e.expireDays,l=e.expDate;if(t){if(0===r.length)return n.setState({errorInfo:(0,y.gettext)("Please enter password")}),!1;if(r.length<y.shareLinkPasswordMinLength)return n.setState({errorInfo:(0,y.gettext)("Password is too short")}),!1;if(r!==a)return n.setState({errorInfo:(0,y.gettext)("Passwords don't match")}),!1}if(o){if("by-date"==i)return!!l||(n.setState({errorInfo:"Please select an expiration time"}),!1);var u=/^\d+$/;if(!s)return n.setState({errorInfo:(0,y.gettext)("Please enter days")}),!1;if(!u.test(s))return n.setState({errorInfo:(0,y.gettext)("Please enter a non-negative integer")}),!1;n.setState({expireDays:parseInt(s)})}return!0},n.onExpireChecked=function(e){n.setState({isExpireChecked:e.target.checked})},n.setExp=function(e){n.setState({setExp:e.target.value})},n.disabledDate=function(e){if(!e)return!1;if(n.isExpireDaysNoLimit)return e.isBefore((0,m.default)(),"day");var t=(0,m.default)().add(y.uploadLinkExpireDaysMin,"days"),r=(0,m.default)().add(y.uploadLinkExpireDaysMax,"days");return 0!==y.uploadLinkExpireDaysMin&&0!==y.uploadLinkExpireDaysMax?e.isBefore(t,"day")||e.isAfter(r,"day"):0!==y.uploadLinkExpireDaysMin&&0===y.uploadLinkExpireDaysMax?e.isBefore(t,"day"):0===y.uploadLinkExpireDaysMin&&0!==y.uploadLinkExpireDaysMax?e.isBefore((0,m.default)(),"day")||e.isAfter(r,"day"):void 0},n.onExpDateChanged=function(e){n.setState({expDate:e})},n.onExpireDaysChanged=function(e){var t=e.target.value.trim();n.setState({expireDays:t})},n.onCopyUploadLink=function(){var e=n.state.sharedUploadInfo.link;(0,f.default)(e),C.default.success((0,y.gettext)("Upload link is copied to the clipboard.")),n.props.closeShareDialog()},n.deleteUploadLink=function(){var e=n.state.sharedUploadInfo;v.seafileAPI.deleteUploadLink(e.token).then(function(){n.setState({showPasswordInput:!1,expireDays:n.defaultExpireDays,isExpireChecked:!n.isExpireDaysNoLimit,password:"",passwordnew:"",sharedUploadInfo:null})}).catch(function(e){var t=b.Utils.getErrorMsg(e);C.default.danger(t)})},n.toggleSendLink=function(){n.setState({isSendLinkShown:!n.state.isSendLinkShown})},n.isExpireDaysNoLimit=0===y.uploadLinkExpireDaysMin&&0===y.uploadLinkExpireDaysMax&&0==y.uploadLinkExpireDaysDefault,n.defaultExpireDays=n.isExpireDaysNoLimit?"":y.uploadLinkExpireDaysDefault;var r="";return 0!==y.uploadLinkExpireDaysMin&&0!==y.uploadLinkExpireDaysMax?r=(0,y.gettext)("{minDays_placeholder} - {maxDays_placeholder} days").replace("{minDays_placeholder}",y.uploadLinkExpireDaysMin).replace("{maxDays_placeholder}",y.uploadLinkExpireDaysMax):0!==y.uploadLinkExpireDaysMin&&0===y.uploadLinkExpireDaysMax?r=(0,y.gettext)("Greater than or equal to {minDays_placeholder} days").replace("{minDays_placeholder}",y.uploadLinkExpireDaysMin):0===y.uploadLinkExpireDaysMin&&0!==y.uploadLinkExpireDaysMax&&(r=(0,y.gettext)("Less than or equal to {maxDays_placeholder} days").replace("{maxDays_placeholder}",y.uploadLinkExpireDaysMax)),n.expirationLimitTip=r,n.state={showPasswordInput:!1,passwordVisible:!1,password:"",passwdnew:"",sharedUploadInfo:null,isSendLinkShown:!1,isExpireChecked:!n.isExpireDaysNoLimit,setExp:"by-days",expireDays:n.defaultExpireDays,expDate:null},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){this.getUploadLink()}},{key:"render",value:function(){var e=this.state.isSendLinkShown,t=(0,y.gettext)("(at least {passwordLength} characters)");if(t=t.replace("{passwordLength}",y.shareLinkPasswordMinLength),this.state.sharedUploadInfo){var n=this.state.sharedUploadInfo;return u.default.createElement("div",null,u.default.createElement(g.Form,{className:"mb-4"},u.default.createElement(g.FormGroup,null,u.default.createElement("dt",{className:"text-secondary font-weight-normal"},(0,y.gettext)("Upload Link:")),u.default.createElement("dd",{className:"d-flex"},u.default.createElement("span",null,n.link),u.default.createElement("span",{className:"far fa-copy action-icon",onClick:this.onCopyUploadLink}))),n.expire_date&&u.default.createElement(g.FormGroup,{className:"mb-0"},u.default.createElement("dt",{className:"text-secondary font-weight-normal"},(0,y.gettext)("Expiration Date:")),u.default.createElement("dd",null,(0,m.default)(n.expire_date).format("YYYY-MM-DD HH:mm:ss")))),y.canSendShareLinkEmail&&!e&&u.default.createElement(g.Button,{onClick:this.toggleSendLink,className:"mr-2"},(0,y.gettext)("Send")),!e&&u.default.createElement(g.Button,{onClick:this.deleteUploadLink},(0,y.gettext)("Delete")),e&&u.default.createElement(_.default,{linkType:"uploadLink",token:n.token,toggleSendLink:this.toggleSendLink,closeShareDialog:this.props.closeShareDialog}))}return u.default.createElement(g.Form,{className:"generate-upload-link"},u.default.createElement(g.FormGroup,{check:!0},u.default.createElement(g.Label,{check:!0},u.default.createElement(g.Input,{type:"checkbox",onChange:this.addPassword}),u.default.createElement("span",null,(0,y.gettext)("Add password protection"))),this.state.showPasswordInput&&u.default.createElement("div",{className:"ml-4"},u.default.createElement(g.FormGroup,null,u.default.createElement(g.Label,{for:"passwd"},(0,y.gettext)("Password")),u.default.createElement("span",{className:"tip"},t),u.default.createElement(g.InputGroup,{style:{width:O}},u.default.createElement(g.Input,{id:"passwd",type:this.state.passwordVisible?"text":"password",value:this.state.password||"",onChange:this.inputPassword}),u.default.createElement(g.InputGroupAddon,{addonType:"append"},u.default.createElement(g.Button,{onClick:this.togglePasswordVisible},u.default.createElement("i",{className:"link-operation-icon fas "+(this.state.passwordVisible?"fa-eye":"fa-eye-slash")})),u.default.createElement(g.Button,{onClick:this.generatePassword},u.default.createElement("i",{className:"link-operation-icon fas fa-magic"}))))),u.default.createElement(g.FormGroup,null,u.default.createElement(g.Label,{for:"passwd-again"},(0,y.gettext)("Password again")),u.default.createElement(g.Input,{id:"passwd-again",style:{width:O},type:this.state.passwordVisible?"text":"password",value:this.state.passwordnew||"",onChange:this.inputPasswordNew})))),u.default.createElement(g.FormGroup,{check:!0},u.default.createElement(g.Label,{check:!0},this.isExpireDaysNoLimit?u.default.createElement(g.Input,{type:"checkbox",onChange:this.onExpireChecked}):u.default.createElement(g.Input,{type:"checkbox",checked:!0,readOnly:!0,disabled:!0}),u.default.createElement("span",null,(0,y.gettext)("Add auto expiration"))),this.state.isExpireChecked&&u.default.createElement("div",{className:"ml-4"},u.default.createElement(g.FormGroup,{check:!0},u.default.createElement(g.Label,{check:!0},u.default.createElement(g.Input,{type:"radio",name:"set-exp",value:"by-days",checked:"by-days"==this.state.setExp,onChange:this.setExp,className:"mr-1"}),u.default.createElement("span",null,(0,y.gettext)("Expiration days"))),"by-days"==this.state.setExp&&u.default.createElement(l.Fragment,null,u.default.createElement(g.InputGroup,{style:{width:O}},u.default.createElement(g.Input,{type:"text",value:this.state.expireDays,onChange:this.onExpireDaysChanged}),u.default.createElement(g.InputGroupAddon,{addonType:"append"},u.default.createElement(g.InputGroupText,null,(0,y.gettext)("days")))),!this.state.isExpireDaysNoLimit&&u.default.createElement(g.FormText,{color:"muted"},this.expirationLimitTip))),u.default.createElement(g.FormGroup,{check:!0},u.default.createElement(g.Label,{check:!0},u.default.createElement(g.Input,{type:"radio",name:"set-exp",value:"by-date",checked:"by-date"==this.state.setExp,onChange:this.setExp,className:"mr-1"}),u.default.createElement("span",null,(0,y.gettext)("Expiration time"))),"by-date"==this.state.setExp&&u.default.createElement(k.default,{inputWidth:O,disabledDate:this.disabledDate,value:this.state.expDate,onChange:this.onExpDateChanged})))),this.state.errorInfo&&u.default.createElement(g.Alert,{color:"danger",className:"mt-2"},this.state.errorInfo),u.default.createElement(g.Button,{className:"generate-link-btn",onClick:this.generateUploadLink},(0,y.gettext)("Generate")))}}]),t}(u.default.Component);L.propTypes=M,t.default=L},193:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(5),h=r(f),m=n(83),g=r(m),y=n(2),v=n(4),b=n(3),w=n(8),E=r(w),S={path:d.default.string.isRequired,repoID:d.default.string.isRequired,direntType:d.default.string},C=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.copyToClipBoard=function(){(0,g.default)(n.state.smartLink);var e=(0,y.gettext)("Internal link has been copied to clipboard");h.default.success(e)},n.state={smartLink:"",isInternalLoding:!0},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.repoID,r=t.path,a=t.direntType;v.seafileAPI.getInternalLink(n,r,a).then(function(t){e.setState({smartLink:t.data.smart_link,isInternalLoding:!1})}).catch(function(e){var t=b.Utils.getErrorMsg(e);h.default.danger(t)})}},{key:"render",value:function(){return this.state.isInternalLoding?u.default.createElement(E.default,null):u.default.createElement("div",null,u.default.createElement("p",{className:"tip mb-1"},(0,y.gettext)("An internal link is a link to a file or folder that can be accessed by users with read permission to the file or folder.")),u.default.createElement("p",null,u.default.createElement("a",{target:"_blank",href:this.state.smartLink},this.state.smartLink)),u.default.createElement(p.Button,{onClick:this.copyToClipBoard,color:"primary",className:"mt-2"},(0,y.gettext)("Copy")))}}]),t}(u.default.Component);C.propTypes=S,t.default=C},2:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.dirPath="/",t.gettext=window.gettext,t.siteRoot=window.app.config.siteRoot,t.loginUrl=window.app.config.loginUrl,t.logoutUrl=window.app.config.logoutUrl,t.avatarInfo=window.app.config.avatarInfo,t.logoPath=window.app.config.logoPath,t.mediaUrl=window.app.config.mediaUrl,t.siteTitle=window.app.config.siteTitle,t.siteName=window.app.config.siteName,t.logoWidth=window.app.config.logoWidth,t.logoHeight=window.app.config.logoHeight,t.isPro="True"===window.app.config.isPro,t.isDocs="True"===window.app.config.isDocs,t.lang=window.app.config.lang,t.fileServerRoot=window.app.config.fileServerRoot,t.seafileVersion=window.app.config.seafileVersion,t.serviceURL=window.app.config.serviceURL,t.appAvatarURL=window.app.config.avatarURL,t.faviconPath=window.app.config.faviconPath,t.loginBGPath=window.app.config.loginBGPath,t.trashReposExpireDays=window.app.pageOptions.trashReposExpireDays,t.dtableWebServer=window.app.pageOptions.dtableWebServer,t.seafileCollabServer=window.app.pageOptions.seafileCollabServer,t.name=window.app.pageOptions.name,t.contactEmail=window.app.pageOptions.contactEmail,t.username=window.app.pageOptions.username,t.canAddRepo=window.app.pageOptions.canAddRepo,t.canAddGroup=window.app.pageOptions.canAddGroup,t.canGenerateShareLink=window.app.pageOptions.canGenerateShareLink,t.canGenerateUploadLink=window.app.pageOptions.canGenerateUploadLink,t.canSendShareLinkEmail=window.app.pageOptions.canSendShareLinkEmail,t.canViewOrg="True"===window.app.pageOptions.canViewOrg,t.fileAuditEnabled=window.app.pageOptions.fileAuditEnabled,t.enableFileComment=!!window.app.pageOptions.enableFileComment,t.folderPermEnabled=window.app.pageOptions.folderPermEnabled,t.enableResetEncryptedRepoPassword="True"===window.app.pageOptions.enableResetEncryptedRepoPassword,t.isEmailConfigured="True"===window.app.pageOptions.isEmailConfigured,t.enableUploadFolder="True"===window.app.pageOptions.enableUploadFolder,t.enableResumableFileUpload="True"===window.app.pageOptions.enableResumableFileUpload,t.resumableUploadFileBlockSize=window.app.pageOptions.resumableUploadFileBlockSize,t.storages=window.app.pageOptions.storages,t.libraryTemplates=window.app.pageOptions.libraryTemplates,t.enableRepoSnapshotLabel=window.app.pageOptions.enableRepoSnapshotLabel,t.shareLinkPasswordMinLength=window.app.pageOptions.shareLinkPasswordMinLength,t.shareLinkExpireDaysMin=window.app.pageOptions.shareLinkExpireDaysMin,t.shareLinkExpireDaysMax=window.app.pageOptions.shareLinkExpireDaysMax,t.sideNavFooterCustomHtml=window.app.pageOptions.sideNavFooterCustomHtml,t.aboutDialogCustomHtml=window.app.pageOptions.aboutDialogCustomHtml,t.shareLinkExpireDaysDefault=window.app.pageOptions.shareLinkExpireDaysDefault,t.uploadLinkExpireDaysMin=window.app.pageOptions.uploadLinkExpireDaysMin,t.uploadLinkExpireDaysMax=window.app.pageOptions.uploadLinkExpireDaysMax,t.uploadLinkExpireDaysDefault=window.app.pageOptions.uploadLinkExpireDaysDefault,t.maxFileName=window.app.pageOptions.maxFileName,t.canPublishRepo=window.app.pageOptions.canPublishRepo,t.enableEncryptedLibrary=window.app.pageOptions.enableEncryptedLibrary,t.enableRepoHistorySetting=window.app.pageOptions.enableRepoHistorySetting,t.isSystemStaff=window.app.pageOptions.isSystemStaff,t.thumbnailSizeForOriginal=window.app.pageOptions.thumbnailSizeForOriginal,t.repoPasswordMinLength=window.app.pageOptions.repoPasswordMinLength,t.canAddPublicRepo=window.app.pageOptions.canAddPublicRepo,t.canInvitePeople=window.app.pageOptions.canInvitePeople,t.canLockUnlockFile=window.app.pageOptions.canLockUnlockFile,t.customNavItems=window.app.pageOptions.customNavItems,t.enableShowContactEmailWhenSearchUser=window.app.pageOptions.enableShowContactEmailWhenSearchUser,t.maxUploadFileSize=window.app.pageOptions.maxUploadFileSize,t.maxNumberOfFilesForFileupload=window.app.pageOptions.maxNumberOfFilesForFileupload,t.curNoteMsg=window.app.pageOptions.curNoteMsg,t.curNoteID=window.app.pageOptions.curNoteID,t.enableTC=window.app.pageOptions.enableTC,t.workspaceID=window.app.pageOptions.workspaceID,t.showLogoutIcon=window.app.pageOptions.showLogoutIcon,t.additionalShareDialogNote=window.app.pageOptions.additionalShareDialogNote,t.additionalAppBottomLinks=window.app.pageOptions.additionalAppBottomLinks,t.additionalAboutDialogLinks=window.app.pageOptions.additionalAboutDialogLinks,t.slug=window.wiki?window.wiki.config.slug:"",t.repoID=window.wiki?window.wiki.config.repoId:"",t.initialPath=window.wiki?window.wiki.config.initial_path:"",t.permission=window.wiki?"True"===window.wiki.config.permission:"",t.isDir=window.wiki?window.wiki.config.isDir:"",t.serviceUrl=window.wiki?window.wiki.config.serviceUrl:"",t.isPublicWiki=window.wiki?"True"===window.wiki.config.isPublicWiki:"",t.sharedToken=window.wiki?window.wiki.config.sharedToken:"",t.sharedType=window.wiki?window.wiki.config.sharedType:"",t.hasIndex=window.wiki?window.wiki.config.hasIndex:"",t.PER_PAGE=25,t.historyRepoID=window.fileHistory?window.fileHistory.pageOptions.repoID:"",t.repoName=window.fileHistory?window.fileHistory.pageOptions.repoName:"",t.filePath=window.fileHistory?window.fileHistory.pageOptions.filePath:"",t.fileName=window.fileHistory?window.fileHistory.pageOptions.fileName:"",t.useNewAPI=window.fileHistory?window.fileHistory.pageOptions.use_new_api:"",t.canDownload=window.fileHistory?window.fileHistory.pageOptions.can_download_file:"",t.canCompare=window.fileHistory?window.fileHistory.pageOptions.can_compare:"",t.draftFilePath=window.draft?window.draft.config.draftFilePath:"",t.draftOriginFilePath=window.draft?window.draft.config.draftOriginFilePath:"",t.draftFileName=window.draft?window.draft.config.draftFileName:"",t.draftID=window.draft?window.draft.config.draftID:"",t.draftRepoID=window.draft?window.draft.config.draftRepoID:"",t.author=window.draft?window.draft.config.author:"",t.authorAvatar=window.draft?window.draft.config.authorAvatar:"",t.originFileExists=window.draft?window.draft.config.originFileExists:"",t.draftFileExists=window.draft?window.draft.config.draftFileExists:"",t.draftStatus=window.draft?window.draft.config.draftStatus:"",t.draftPublishVersion=window.draft?window.draft.config.draftPublishVersion:"",t.originFileVersion=window.draft?window.draft.config.originFileVersion:"",t.filePermission=window.draft?window.draft.config.perm:"",t.orgID=window.org?window.org.pageOptions.orgID:"",t.invitationLink=window.org?window.org.pageOptions.invitationLink:"",t.orgMemberQuotaEnabled=window.org?window.org.pageOptions.orgMemberQuotaEnabled:"",t.constanceEnabled=window.sysadmin?window.sysadmin.pageOptions.constance_enabled:"",t.multiTenancy=window.sysadmin?window.sysadmin.pageOptions.multi_tenancy:"",t.multiInstitution=window.sysadmin?window.sysadmin.pageOptions.multi_institution:"",t.sysadminExtraEnabled=window.sysadmin?window.sysadmin.pageOptions.sysadmin_extra_enabled:"",t.enableGuestInvitation=window.sysadmin?window.sysadmin.pageOptions.enable_guest_invitation:"",t.enableTermsAndConditions=window.sysadmin?window.sysadmin.pageOptions.enable_terms_and_conditions:"",t.isDefaultAdmin=window.sysadmin?window.sysadmin.pageOptions.is_default_admin:"",t.enableFileScan=window.sysadmin?window.sysadmin.pageOptions.enable_file_scan:"",t.canViewSystemInfo=window.sysadmin?window.sysadmin.pageOptions.admin_permissions.can_view_system_info:"",t.canViewStatistic=window.sysadmin?window.sysadmin.pageOptions.admin_permissions.can_view_statistic:"",t.canConfigSystem=window.sysadmin?window.sysadmin.pageOptions.admin_permissions.can_config_system:"",t.canManageLibrary=window.sysadmin?window.sysadmin.pageOptions.admin_permissions.can_manage_library:"",t.canManageUser=window.sysadmin?window.sysadmin.pageOptions.admin_permissions.can_manage_user:"",t.canManageGroup=window.sysadmin?window.sysadmin.pageOptions.admin_permissions.can_manage_group:"",t.canViewUserLog=window.sysadmin?window.sysadmin.pageOptions.admin_permissions.can_view_user_log:"",t.canViewAdminLog=window.sysadmin?window.sysadmin.pageOptions.admin_permissions.can_view_admin_log:"",t.otherPermission=window.sysadmin?window.sysadmin.pageOptions.admin_permissions.other_permission:"",t.enableWorkWeixin=window.sysadmin?window.sysadmin.pageOptions.enable_work_weixin:"",t.enableDingtalk=window.sysadmin?window.sysadmin.pageOptions.enable_dingtalk:"",t.enableSysAdminViewRepo=window.sysadmin?window.sysadmin.pageOptions.enableSysAdminViewRepo:"",t.haveLDAP=window.sysadmin?window.sysadmin.pageOptions.haveLDAP:"",t.enableShareLinkReportAbuse=window.sysadmin?window.sysadmin.pageOptions.enable_share_link_report_abuse:""},20:function(e,t,n){"use strict";n(54),n(57),"undefined"===typeof Promise&&(n(58).enable(),window.Promise=n(49)),n(52),Object.assign=n(35)},21:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.strChineseFirstPY="YDYQSXMWZSSXJBYMGCCZQPSSQBYCDSCDQLDYLYBSSJGYZZJJFKCCLZDHWDWZJLJPFYYNWJJTMYHZWZHFLZPPQHGSCYYYNJQYXXGJHHSDSJNKKTMOMLCRXYPSNQSECCQZGGLLYJLMYZZSECYKYYHQWJSSGGYXYZYJWWKDJHYCHMYXJTLXJYQBYXZLDWRDJRWYSRLDZJPCBZJJBRCFTLECZSTZFXXZHTRQHYBDLYCZSSYMMRFMYQZPWWJJYFCRWFDFZQPYDDWYXKYJAWJFFXYPSFTZYHHYZYSWCJYXSCLCXXWZZXNBGNNXBXLZSZSBSGPYSYZDHMDZBQBZCWDZZYYTZHBTSYYBZGNTNXQYWQSKBPHHLXGYBFMJEBJHHGQTJCYSXSTKZHLYCKGLYSMZXYALMELDCCXGZYRJXSDLTYZCQKCNNJWHJTZZCQLJSTSTBNXBTYXCEQXGKWJYFLZQLYHYXSPSFXLMPBYSXXXYDJCZYLLLSJXFHJXPJBTFFYABYXBHZZBJYZLWLCZGGBTSSMDTJZXPTHYQTGLJSCQFZKJZJQNLZWLSLHDZBWJNCJZYZSQQYCQYRZCJJWYBRTWPYFTWEXCSKDZCTBZHYZZYYJXZCFFZZMJYXXSDZZOTTBZLQWFCKSZSXFYRLNYJMBDTHJXSQQCCSBXYYTSYFBXDZTGBCNSLCYZZPSAZYZZSCJCSHZQYDXLBPJLLMQXTYDZXSQJTZPXLCGLQTZWJBHCTSYJSFXYEJJTLBGXSXJMYJQQPFZASYJNTYDJXKJCDJSZCBARTDCLYJQMWNQNCLLLKBYBZZSYHQQLTWLCCXTXLLZNTYLNEWYZYXCZXXGRKRMTCNDNJTSYYSSDQDGHSDBJGHRWRQLYBGLXHLGTGXBQJDZPYJSJYJCTMRNYMGRZJCZGJMZMGXMPRYXKJNYMSGMZJYMKMFXMLDTGFBHCJHKYLPFMDXLQJJSMTQGZSJLQDLDGJYCALCMZCSDJLLNXDJFFFFJCZFMZFFPFKHKGDPSXKTACJDHHZDDCRRCFQYJKQCCWJDXHWJLYLLZGCFCQDSMLZPBJJPLSBCJGGDCKKDEZSQCCKJGCGKDJTJDLZYCXKLQSCGJCLTFPCQCZGWPJDQYZJJBYJHSJDZWGFSJGZKQCCZLLPSPKJGQJHZZLJPLGJGJJTHJJYJZCZMLZLYQBGJWMLJKXZDZNJQSYZMLJLLJKYWXMKJLHSKJGBMCLYYMKXJQLBMLLKMDXXKWYXYSLMLPSJQQJQXYXFJTJDXMXXLLCXQBSYJBGWYMBGGBCYXPJYGPEPFGDJGBHBNSQJYZJKJKHXQFGQZKFHYGKHDKLLSDJQXPQYKYBNQSXQNSZSWHBSXWHXWBZZXDMNSJBSBKBBZKLYLXGWXDRWYQZMYWSJQLCJXXJXKJEQXSCYETLZHLYYYSDZPAQYZCMTLSHTZCFYZYXYLJSDCJQAGYSLCQLYYYSHMRQQKLDXZSCSSSYDYCJYSFSJBFRSSZQSBXXPXJYSDRCKGJLGDKZJZBDKTCSYQPYHSTCLDJDHMXMCGXYZHJDDTMHLTXZXYLYMOHYJCLTYFBQQXPFBDFHHTKSQHZYYWCNXXCRWHOWGYJLEGWDQCWGFJYCSNTMYTOLBYGWQWESJPWNMLRYDZSZTXYQPZGCWXHNGPYXSHMYQJXZTDPPBFYHZHTJYFDZWKGKZBLDNTSXHQEEGZZYLZMMZYJZGXZXKHKSTXNXXWYLYAPSTHXDWHZYMPXAGKYDXBHNHXKDPJNMYHYLPMGOCSLNZHKXXLPZZLBMLSFBHHGYGYYGGBHSCYAQTYWLXTZQCEZYDQDQMMHTKLLSZHLSJZWFYHQSWSCWLQAZYNYTLSXTHAZNKZZSZZLAXXZWWCTGQQTDDYZTCCHYQZFLXPSLZYGPZSZNGLNDQTBDLXGTCTAJDKYWNSYZLJHHZZCWNYYZYWMHYCHHYXHJKZWSXHZYXLYSKQYSPSLYZWMYPPKBYGLKZHTYXAXQSYSHXASMCHKDSCRSWJPWXSGZJLWWSCHSJHSQNHCSEGNDAQTBAALZZMSSTDQJCJKTSCJAXPLGGXHHGXXZCXPDMMHLDGTYBYSJMXHMRCPXXJZCKZXSHMLQXXTTHXWZFKHCCZDYTCJYXQHLXDHYPJQXYLSYYDZOZJNYXQEZYSQYAYXWYPDGXDDXSPPYZNDLTWRHXYDXZZJHTCXMCZLHPYYYYMHZLLHNXMYLLLMDCPPXHMXDKYCYRDLTXJCHHZZXZLCCLYLNZSHZJZZLNNRLWHYQSNJHXYNTTTKYJPYCHHYEGKCTTWLGQRLGGTGTYGYHPYHYLQYQGCWYQKPYYYTTTTLHYHLLTYTTSPLKYZXGZWGPYDSSZZDQXSKCQNMJJZZBXYQMJRTFFBTKHZKBXLJJKDXJTLBWFZPPTKQTZTGPDGNTPJYFALQMKGXBDCLZFHZCLLLLADPMXDJHLCCLGYHDZFGYDDGCYYFGYDXKSSEBDHYKDKDKHNAXXYBPBYYHXZQGAFFQYJXDMLJCSQZLLPCHBSXGJYNDYBYQSPZWJLZKSDDTACTBXZDYZYPJZQSJNKKTKNJDJGYYPGTLFYQKASDNTCYHBLWDZHBBYDWJRYGKZYHEYYFJMSDTYFZJJHGCXPLXHLDWXXJKYTCYKSSSMTWCTTQZLPBSZDZWZXGZAGYKTYWXLHLSPBCLLOQMMZSSLCMBJCSZZKYDCZJGQQDSMCYTZQQLWZQZXSSFPTTFQMDDZDSHDTDWFHTDYZJYQJQKYPBDJYYXTLJHDRQXXXHAYDHRJLKLYTWHLLRLLRCXYLBWSRSZZSYMKZZHHKYHXKSMDSYDYCJPBZBSQLFCXXXNXKXWYWSDZYQOGGQMMYHCDZTTFJYYBGSTTTYBYKJDHKYXBELHTYPJQNFXFDYKZHQKZBYJTZBXHFDXKDASWTAWAJLDYJSFHBLDNNTNQJTJNCHXFJSRFWHZFMDRYJYJWZPDJKZYJYMPCYZNYNXFBYTFYFWYGDBNZZZDNYTXZEMMQBSQEHXFZMBMFLZZSRXYMJGSXWZJSPRYDJSJGXHJJGLJJYNZZJXHGXKYMLPYYYCXYTWQZSWHWLYRJLPXSLSXMFSWWKLCTNXNYNPSJSZHDZEPTXMYYWXYYSYWLXJQZQXZDCLEEELMCPJPCLWBXSQHFWWTFFJTNQJHJQDXHWLBYZNFJLALKYYJLDXHHYCSTYYWNRJYXYWTRMDRQHWQCMFJDYZMHMYYXJWMYZQZXTLMRSPWWCHAQBXYGZYPXYYRRCLMPYMGKSJSZYSRMYJSNXTPLNBAPPYPYLXYYZKYNLDZYJZCZNNLMZHHARQMPGWQTZMXXMLLHGDZXYHXKYXYCJMFFYYHJFSBSSQLXXNDYCANNMTCJCYPRRNYTYQNYYMBMSXNDLYLYSLJRLXYSXQMLLYZLZJJJKYZZCSFBZXXMSTBJGNXYZHLXNMCWSCYZYFZLXBRNNNYLBNRTGZQYSATSWRYHYJZMZDHZGZDWYBSSCSKXSYHYTXXGCQGXZZSHYXJSCRHMKKBXCZJYJYMKQHZJFNBHMQHYSNJNZYBKNQMCLGQHWLZNZSWXKHLJHYYBQLBFCDSXDLDSPFZPSKJYZWZXZDDXJSMMEGJSCSSMGCLXXKYYYLNYPWWWGYDKZJGGGZGGSYCKNJWNJPCXBJJTQTJWDSSPJXZXNZXUMELPXFSXTLLXCLJXJJLJZXCTPSWXLYDHLYQRWHSYCSQYYBYAYWJJJQFWQCQQCJQGXALDBZZYJGKGXPLTZYFXJLTPADKYQHPMATLCPDCKBMTXYBHKLENXDLEEGQDYMSAWHZMLJTWYGXLYQZLJEEYYBQQFFNLYXRDSCTGJGXYYNKLLYQKCCTLHJLQMKKZGCYYGLLLJDZGYDHZWXPYSJBZKDZGYZZHYWYFQYTYZSZYEZZLYMHJJHTSMQWYZLKYYWZCSRKQYTLTDXWCTYJKLWSQZWBDCQYNCJSRSZJLKCDCDTLZZZACQQZZDDXYPLXZBQJYLZLLLQDDZQJYJYJZYXNYYYNYJXKXDAZWYRDLJYYYRJLXLLDYXJCYWYWNQCCLDDNYYYNYCKCZHXXCCLGZQJGKWPPCQQJYSBZZXYJSQPXJPZBSBDSFNSFPZXHDWZTDWPPTFLZZBZDMYYPQJRSDZSQZSQXBDGCPZSWDWCSQZGMDHZXMWWFYBPDGPHTMJTHZSMMBGZMBZJCFZWFZBBZMQCFMBDMCJXLGPNJBBXGYHYYJGPTZGZMQBQTCGYXJXLWZKYDPDYMGCFTPFXYZTZXDZXTGKMTYBBCLBJASKYTSSQYYMSZXFJEWLXLLSZBQJJJAKLYLXLYCCTSXMCWFKKKBSXLLLLJYXTYLTJYYTDPJHNHNNKBYQNFQYYZBYYESSESSGDYHFHWTCJBSDZZTFDMXHCNJZYMQWSRYJDZJQPDQBBSTJGGFBKJBXTGQHNGWJXJGDLLTHZHHYYYYYYSXWTYYYCCBDBPYPZYCCZYJPZYWCBDLFWZCWJDXXHYHLHWZZXJTCZLCDPXUJCZZZLYXJJTXPHFXWPYWXZPTDZZBDZCYHJHMLXBQXSBYLRDTGJRRCTTTHYTCZWMXFYTWWZCWJWXJYWCSKYBZSCCTZQNHXNWXXKHKFHTSWOCCJYBCMPZZYKBNNZPBZHHZDLSYDDYTYFJPXYNGFXBYQXCBHXCPSXTYZDMKYSNXSXLHKMZXLYHDHKWHXXSSKQYHHCJYXGLHZXCSNHEKDTGZXQYPKDHEXTYKCNYMYYYPKQYYYKXZLTHJQTBYQHXBMYHSQCKWWYLLHCYYLNNEQXQWMCFBDCCMLJGGXDQKTLXKGNQCDGZJWYJJLYHHQTTTNWCHMXCXWHWSZJYDJCCDBQCDGDNYXZTHCQRXCBHZTQCBXWGQWYYBXHMBYMYQTYEXMQKYAQYRGYZSLFYKKQHYSSQYSHJGJCNXKZYCXSBXYXHYYLSTYCXQTHYSMGSCPMMGCCCCCMTZTASMGQZJHKLOSQYLSWTMXSYQKDZLJQQYPLSYCZTCQQPBBQJZCLPKHQZYYXXDTDDTSJCXFFLLCHQXMJLWCJCXTSPYCXNDTJSHJWXDQQJSKXYAMYLSJHMLALYKXCYYDMNMDQMXMCZNNCYBZKKYFLMCHCMLHXRCJJHSYLNMTJZGZGYWJXSRXCWJGJQHQZDQJDCJJZKJKGDZQGJJYJYLXZXXCDQHHHEYTMHLFSBDJSYYSHFYSTCZQLPBDRFRZTZYKYWHSZYQKWDQZRKMSYNBCRXQBJYFAZPZZEDZCJYWBCJWHYJBQSZYWRYSZPTDKZPFPBNZTKLQYHBBZPNPPTYZZYBQNYDCPJMMCYCQMCYFZZDCMNLFPBPLNGQJTBTTNJZPZBBZNJKLJQYLNBZQHKSJZNGGQSZZKYXSHPZSNBCGZKDDZQANZHJKDRTLZLSWJLJZLYWTJNDJZJHXYAYNCBGTZCSSQMNJPJYTYSWXZFKWJQTKHTZPLBHSNJZSYZBWZZZZLSYLSBJHDWWQPSLMMFBJDWAQYZTCJTBNNWZXQXCDSLQGDSDPDZHJTQQPSWLYYJZLGYXYZLCTCBJTKTYCZJTQKBSJLGMGZDMCSGPYNJZYQYYKNXRPWSZXMTNCSZZYXYBYHYZAXYWQCJTLLCKJJTJHGDXDXYQYZZBYWDLWQCGLZGJGQRQZCZSSBCRPCSKYDZNXJSQGXSSJMYDNSTZTPBDLTKZWXQWQTZEXNQCZGWEZKSSBYBRTSSSLCCGBPSZQSZLCCGLLLZXHZQTHCZMQGYZQZNMCOCSZJMMZSQPJYGQLJYJPPLDXRGZYXCCSXHSHGTZNLZWZKJCXTCFCJXLBMQBCZZWPQDNHXLJCTHYZLGYLNLSZZPCXDSCQQHJQKSXZPBAJYEMSMJTZDXLCJYRYYNWJBNGZZTMJXLTBSLYRZPYLSSCNXPHLLHYLLQQZQLXYMRSYCXZLMMCZLTZSDWTJJLLNZGGQXPFSKYGYGHBFZPDKMWGHCXMSGDXJMCJZDYCABXJDLNBCDQYGSKYDQTXDJJYXMSZQAZDZFSLQXYJSJZYLBTXXWXQQZBJZUFBBLYLWDSLJHXJYZJWTDJCZFQZQZZDZSXZZQLZCDZFJHYSPYMPQZMLPPLFFXJJNZZYLSJEYQZFPFZKSYWJJJHRDJZZXTXXGLGHYDXCSKYSWMMZCWYBAZBJKSHFHJCXMHFQHYXXYZFTSJYZFXYXPZLCHMZMBXHZZSXYFYMNCWDABAZLXKTCSHHXKXJJZJSTHYGXSXYYHHHJWXKZXSSBZZWHHHCWTZZZPJXSNXQQJGZYZYWLLCWXZFXXYXYHXMKYYSWSQMNLNAYCYSPMJKHWCQHYLAJJMZXHMMCNZHBHXCLXTJPLTXYJHDYYLTTXFSZHYXXSJBJYAYRSMXYPLCKDUYHLXRLNLLSTYZYYQYGYHHSCCSMZCTZQXKYQFPYYRPFFLKQUNTSZLLZMWWTCQQYZWTLLMLMPWMBZSSTZRBPDDTLQJJBXZCSRZQQYGWCSXFWZLXCCRSZDZMCYGGDZQSGTJSWLJMYMMZYHFBJDGYXCCPSHXNZCSBSJYJGJMPPWAFFYFNXHYZXZYLREMZGZCYZSSZDLLJCSQFNXZKPTXZGXJJGFMYYYSNBTYLBNLHPFZDCYFBMGQRRSSSZXYSGTZRNYDZZCDGPJAFJFZKNZBLCZSZPSGCYCJSZLMLRSZBZZLDLSLLYSXSQZQLYXZLSKKBRXBRBZCYCXZZZEEYFGKLZLYYHGZSGZLFJHGTGWKRAAJYZKZQTSSHJJXDCYZUYJLZYRZDQQHGJZXSSZBYKJPBFRTJXLLFQWJHYLQTYMBLPZDXTZYGBDHZZRBGXHWNJTJXLKSCFSMWLSDQYSJTXKZSCFWJLBXFTZLLJZLLQBLSQMQQCGCZFPBPHZCZJLPYYGGDTGWDCFCZQYYYQYSSCLXZSKLZZZGFFCQNWGLHQYZJJCZLQZZYJPJZZBPDCCMHJGXDQDGDLZQMFGPSYTSDYFWWDJZJYSXYYCZCYHZWPBYKXRYLYBHKJKSFXTZJMMCKHLLTNYYMSYXYZPYJQYCSYCWMTJJKQYRHLLQXPSGTLYYCLJSCPXJYZFNMLRGJJTYZBXYZMSJYJHHFZQMSYXRSZCWTLRTQZSSTKXGQKGSPTGCZNJSJCQCXHMXGGZTQYDJKZDLBZSXJLHYQGGGTHQSZPYHJHHGYYGKGGCWJZZYLCZLXQSFTGZSLLLMLJSKCTBLLZZSZMMNYTPZSXQHJCJYQXYZXZQZCPSHKZZYSXCDFGMWQRLLQXRFZTLYSTCTMJCXJJXHJNXTNRZTZFQYHQGLLGCXSZSJDJLJCYDSJTLNYXHSZXCGJZYQPYLFHDJSBPCCZHJJJQZJQDYBSSLLCMYTTMQTBHJQNNYGKYRQYQMZGCJKPDCGMYZHQLLSLLCLMHOLZGDYYFZSLJCQZLYLZQJESHNYLLJXGJXLYSYYYXNBZLJSSZCQQCJYLLZLTJYLLZLLBNYLGQCHXYYXOXCXQKYJXXXYKLXSXXYQXCYKQXQCSGYXXYQXYGYTQOHXHXPYXXXULCYEYCHZZCBWQBBWJQZSCSZSSLZYLKDESJZWMYMCYTSDSXXSCJPQQSQYLYYZYCMDJDZYWCBTJSYDJKCYDDJLBDJJSODZYSYXQQYXDHHGQQYQHDYXWGMMMAJDYBBBPPBCMUUPLJZSMTXERXJMHQNUTPJDCBSSMSSSTKJTSSMMTRCPLZSZMLQDSDMJMQPNQDXCFYNBFSDQXYXHYAYKQYDDLQYYYSSZBYDSLNTFQTZQPZMCHDHCZCWFDXTMYQSPHQYYXSRGJCWTJTZZQMGWJJTJHTQJBBHWZPXXHYQFXXQYWYYHYSCDYDHHQMNMTMWCPBSZPPZZGLMZFOLLCFWHMMSJZTTDHZZYFFYTZZGZYSKYJXQYJZQBHMBZZLYGHGFMSHPZFZSNCLPBQSNJXZSLXXFPMTYJYGBXLLDLXPZJYZJYHHZCYWHJYLSJEXFSZZYWXKZJLUYDTMLYMQJPWXYHXSKTQJEZRPXXZHHMHWQPWQLYJJQJJZSZCPHJLCHHNXJLQWZJHBMZYXBDHHYPZLHLHLGFWLCHYYTLHJXCJMSCPXSTKPNHQXSRTYXXTESYJCTLSSLSTDLLLWWYHDHRJZSFGXTSYCZYNYHTDHWJSLHTZDQDJZXXQHGYLTZPHCSQFCLNJTCLZPFSTPDYNYLGMJLLYCQHYSSHCHYLHQYQTMZYPBYWRFQYKQSYSLZDQJMPXYYSSRHZJNYWTQDFZBWWTWWRXCWHGYHXMKMYYYQMSMZHNGCEPMLQQMTCWCTMMPXJPJJHFXYYZSXZHTYBMSTSYJTTQQQYYLHYNPYQZLCYZHZWSMYLKFJXLWGXYPJYTYSYXYMZCKTTWLKSMZSYLMPWLZWXWQZSSAQSYXYRHSSNTSRAPXCPWCMGDXHXZDZYFJHGZTTSBJHGYZSZYSMYCLLLXBTYXHBBZJKSSDMALXHYCFYGMQYPJYCQXJLLLJGSLZGQLYCJCCZOTYXMTMTTLLWTGPXYMZMKLPSZZZXHKQYSXCTYJZYHXSHYXZKXLZWPSQPYHJWPJPWXQQYLXSDHMRSLZZYZWTTCYXYSZZSHBSCCSTPLWSSCJCHNLCGCHSSPHYLHFHHXJSXYLLNYLSZDHZXYLSXLWZYKCLDYAXZCMDDYSPJTQJZLNWQPSSSWCTSTSZLBLNXSMNYYMJQBQHRZWTYYDCHQLXKPZWBGQYBKFCMZWPZLLYYLSZYDWHXPSBCMLJBSCGBHXLQHYRLJXYSWXWXZSLDFHLSLYNJLZYFLYJYCDRJLFSYZFSLLCQYQFGJYHYXZLYLMSTDJCYHBZLLNWLXXYGYYHSMGDHXXHHLZZJZXCZZZCYQZFNGWPYLCPKPYYPMCLQKDGXZGGWQBDXZZKZFBXXLZXJTPJPTTBYTSZZDWSLCHZHSLTYXHQLHYXXXYYZYSWTXZKHLXZXZPYHGCHKCFSYHUTJRLXFJXPTZTWHPLYXFCRHXSHXKYXXYHZQDXQWULHYHMJTBFLKHTXCWHJFWJCFPQRYQXCYYYQYGRPYWSGSUNGWCHKZDXYFLXXHJJBYZWTSXXNCYJJYMSWZJQRMHXZWFQSYLZJZGBHYNSLBGTTCSYBYXXWXYHXYYXNSQYXMQYWRGYQLXBBZLJSYLPSYTJZYHYZAWLRORJMKSCZJXXXYXCHDYXRYXXJDTSQFXLYLTSFFYXLMTYJMJUYYYXLTZCSXQZQHZXLYYXZHDNBRXXXJCTYHLBRLMBRLLAXKYLLLJLYXXLYCRYLCJTGJCMTLZLLCYZZPZPCYAWHJJFYBDYYZSMPCKZDQYQPBPCJPDCYZMDPBCYYDYCNNPLMTMLRMFMMGWYZBSJGYGSMZQQQZTXMKQWGXLLPJGZBQCDJJJFPKJKCXBLJMSWMDTQJXLDLPPBXCWRCQFBFQJCZAHZGMYKPHYYHZYKNDKZMBPJYXPXYHLFPNYYGXJDBKXNXHJMZJXSTRSTLDXSKZYSYBZXJLXYSLBZYSLHXJPFXPQNBYLLJQKYGZMCYZZYMCCSLCLHZFWFWYXZMWSXTYNXJHPYYMCYSPMHYSMYDYSHQYZCHMJJMZCAAGCFJBBHPLYZYLXXSDJGXDHKXXTXXNBHRMLYJSLTXMRHNLXQJXYZLLYSWQGDLBJHDCGJYQYCMHWFMJYBMBYJYJWYMDPWHXQLDYGPDFXXBCGJSPCKRSSYZJMSLBZZJFLJJJLGXZGYXYXLSZQYXBEXYXHGCXBPLDYHWETTWWCJMBTXCHXYQXLLXFLYXLLJLSSFWDPZSMYJCLMWYTCZPCHQEKCQBWLCQYDPLQPPQZQFJQDJHYMMCXTXDRMJWRHXCJZYLQXDYYNHYYHRSLSRSYWWZJYMTLTLLGTQCJZYABTCKZCJYCCQLJZQXALMZYHYWLWDXZXQDLLQSHGPJFJLJHJABCQZDJGTKHSSTCYJLPSWZLXZXRWGLDLZRLZXTGSLLLLZLYXXWGDZYGBDPHZPBRLWSXQBPFDWOFMWHLYPCBJCCLDMBZPBZZLCYQXLDOMZBLZWPDWYYGDSTTHCSQSCCRSSSYSLFYBFNTYJSZDFNDPDHDZZMBBLSLCMYFFGTJJQWFTMTPJWFNLBZCMMJTGBDZLQLPYFHYYMJYLSDCHDZJWJCCTLJCLDTLJJCPDDSQDSSZYBNDBJLGGJZXSXNLYCYBJXQYCBYLZCFZPPGKCXZDZFZTJJFJSJXZBNZYJQTTYJYHTYCZHYMDJXTTMPXSPLZCDWSLSHXYPZGTFMLCJTYCBPMGDKWYCYZCDSZZYHFLYCTYGWHKJYYLSJCXGYWJCBLLCSNDDBTZBSCLYZCZZSSQDLLMQYYHFSLQLLXFTYHABXGWNYWYYPLLSDLDLLBJCYXJZMLHLJDXYYQYTDLLLBUGBFDFBBQJZZMDPJHGCLGMJJPGAEHHBWCQXAXHHHZCHXYPHJAXHLPHJPGPZJQCQZGJJZZUZDMQYYBZZPHYHYBWHAZYJHYKFGDPFQSDLZMLJXKXGALXZDAGLMDGXMWZQYXXDXXPFDMMSSYMPFMDMMKXKSYZYSHDZKXSYSMMZZZMSYDNZZCZXFPLSTMZDNMXCKJMZTYYMZMZZMSXHHDCZJEMXXKLJSTLWLSQLYJZLLZJSSDPPMHNLZJCZYHMXXHGZCJMDHXTKGRMXFWMCGMWKDTKSXQMMMFZZYDKMSCLCMPCGMHSPXQPZDSSLCXKYXTWLWJYAHZJGZQMCSNXYYMMPMLKJXMHLMLQMXCTKZMJQYSZJSYSZHSYJZJCDAJZYBSDQJZGWZQQXFKDMSDJLFWEHKZQKJPEYPZYSZCDWYJFFMZZYLTTDZZEFMZLBNPPLPLPEPSZALLTYLKCKQZKGENQLWAGYXYDPXLHSXQQWQCQXQCLHYXXMLYCCWLYMQYSKGCHLCJNSZKPYZKCQZQLJPDMDZHLASXLBYDWQLWDNBQCRYDDZTJYBKBWSZDXDTNPJDTCTQDFXQQMGNXECLTTBKPWSLCTYQLPWYZZKLPYGZCQQPLLKCCYLPQMZCZQCLJSLQZDJXLDDHPZQDLJJXZQDXYZQKZLJCYQDYJPPYPQYKJYRMPCBYMCXKLLZLLFQPYLLLMBSGLCYSSLRSYSQTMXYXZQZFDZUYSYZTFFMZZSMZQHZSSCCMLYXWTPZGXZJGZGSJSGKDDHTQGGZLLBJDZLCBCHYXYZHZFYWXYZYMSDBZZYJGTSMTFXQYXQSTDGSLNXDLRYZZLRYYLXQHTXSRTZNGZXBNQQZFMYKMZJBZYMKBPNLYZPBLMCNQYZZZSJZHJCTZKHYZZJRDYZHNPXGLFZTLKGJTCTSSYLLGZRZBBQZZKLPKLCZYSSUYXBJFPNJZZXCDWXZYJXZZDJJKGGRSRJKMSMZJLSJYWQSKYHQJSXPJZZZLSNSHRNYPZTWCHKLPSRZLZXYJQXQKYSJYCZTLQZYBBYBWZPQDWWYZCYTJCJXCKCWDKKZXSGKDZXWWYYJQYYTCYTDLLXWKCZKKLCCLZCQQDZLQLCSFQCHQHSFSMQZZLNBJJZBSJHTSZDYSJQJPDLZCDCWJKJZZLPYCGMZWDJJBSJQZSYZYHHXJPBJYDSSXDZNCGLQMBTSFSBPDZDLZNFGFJGFSMPXJQLMBLGQCYYXBQKDJJQYRFKZTJDHCZKLBSDZCFJTPLLJGXHYXZCSSZZXSTJYGKGCKGYOQXJPLZPBPGTGYJZGHZQZZLBJLSQFZGKQQJZGYCZBZQTLDXRJXBSXXPZXHYZYCLWDXJJHXMFDZPFZHQHQMQGKSLYHTYCGFRZGNQXCLPDLBZCSCZQLLJBLHBZCYPZZPPDYMZZSGYHCKCPZJGSLJLNSCDSLDLXBMSTLDDFJMKDJDHZLZXLSZQPQPGJLLYBDSZGQLBZLSLKYYHZTTNTJYQTZZPSZQZTLLJTYYLLQLLQYZQLBDZLSLYYZYMDFSZSNHLXZNCZQZPBWSKRFBSYZMTHBLGJPMCZZLSTLXSHTCSYZLZBLFEQHLXFLCJLYLJQCBZLZJHHSSTBRMHXZHJZCLXFNBGXGTQJCZTMSFZKJMSSNXLJKBHSJXNTNLZDNTLMSJXGZJYJCZXYJYJWRWWQNZTNFJSZPZSHZJFYRDJSFSZJZBJFZQZZHZLXFYSBZQLZSGYFTZDCSZXZJBQMSZKJRHYJZCKMJKHCHGTXKXQGLXPXFXTRTYLXJXHDTSJXHJZJXZWZLCQSBTXWXGXTXXHXFTSDKFJHZYJFJXRZSDLLLTQSQQZQWZXSYQTWGWBZCGZLLYZBCLMQQTZHZXZXLJFRMYZFLXYSQXXJKXRMQDZDMMYYBSQBHGZMWFWXGMXLZPYYTGZYCCDXYZXYWGSYJYZNBHPZJSQSYXSXRTFYZGRHZTXSZZTHCBFCLSYXZLZQMZLMPLMXZJXSFLBYZMYQHXJSXRXSQZZZSSLYFRCZJRCRXHHZXQYDYHXSJJHZCXZBTYNSYSXJBQLPXZQPYMLXZKYXLXCJLCYSXXZZLXDLLLJJYHZXGYJWKJRWYHCPSGNRZLFZWFZZNSXGXFLZSXZZZBFCSYJDBRJKRDHHGXJLJJTGXJXXSTJTJXLYXQFCSGSWMSBCTLQZZWLZZKXJMLTMJYHSDDBXGZHDLBMYJFRZFSGCLYJBPMLYSMSXLSZJQQHJZFXGFQFQBPXZGYYQXGZTCQWYLTLGWSGWHRLFSFGZJMGMGBGTJFSYZZGZYZAFLSSPMLPFLCWBJZCLJJMZLPJJLYMQDMYYYFBGYGYZMLYZDXQYXRQQQHSYYYQXYLJTYXFSFSLLGNQCYHYCWFHCCCFXPYLYPLLZYXXXXXKQHHXSHJZCFZSCZJXCPZWHHHHHAPYLQALPQAFYHXDYLUKMZQGGGDDESRNNZLTZGCHYPPYSQJJHCLLJTOLNJPZLJLHYMHEYDYDSQYCDDHGZUNDZCLZYZLLZNTNYZGSLHSLPJJBDGWXPCDUTJCKLKCLWKLLCASSTKZZDNQNTTLYYZSSYSSZZRYLJQKCQDHHCRXRZYDGRGCWCGZQFFFPPJFZYNAKRGYWYQPQXXFKJTSZZXSWZDDFBBXTBGTZKZNPZZPZXZPJSZBMQHKCYXYLDKLJNYPKYGHGDZJXXEAHPNZKZTZCMXCXMMJXNKSZQNMNLWBWWXJKYHCPSTMCSQTZJYXTPCTPDTNNPGLLLZSJLSPBLPLQHDTNJNLYYRSZFFJFQWDPHZDWMRZCCLODAXNSSNYZRESTYJWJYJDBCFXNMWTTBYLWSTSZGYBLJPXGLBOCLHPCBJLTMXZLJYLZXCLTPNCLCKXTPZJSWCYXSFYSZDKNTLBYJCYJLLSTGQCBXRYZXBXKLYLHZLQZLNZCXWJZLJZJNCJHXMNZZGJZZXTZJXYCYYCXXJYYXJJXSSSJSTSSTTPPGQTCSXWZDCSYFPTFBFHFBBLZJCLZZDBXGCXLQPXKFZFLSYLTUWBMQJHSZBMDDBCYSCCLDXYCDDQLYJJWMQLLCSGLJJSYFPYYCCYLTJANTJJPWYCMMGQYYSXDXQMZHSZXPFTWWZQSWQRFKJLZJQQYFBRXJHHFWJJZYQAZMYFRHCYYBYQWLPEXCCZSTYRLTTDMQLYKMBBGMYYJPRKZNPBSXYXBHYZDJDNGHPMFSGMWFZMFQMMBCMZZCJJLCNUXYQLMLRYGQZCYXZLWJGCJCGGMCJNFYZZJHYCPRRCMTZQZXHFQGTJXCCJEAQCRJYHPLQLSZDJRBCQHQDYRHYLYXJSYMHZYDWLDFRYHBPYDTSSCNWBXGLPZMLZZTQSSCPJMXXYCSJYTYCGHYCJWYRXXLFEMWJNMKLLSWTXHYYYNCMMCWJDQDJZGLLJWJRKHPZGGFLCCSCZMCBLTBHBQJXQDSPDJZZGKGLFQYWBZYZJLTSTDHQHCTCBCHFLQMPWDSHYYTQWCNZZJTLBYMBPDYYYXSQKXWYYFLXXNCWCXYPMAELYKKJMZZZBRXYYQJFLJPFHHHYTZZXSGQQMHSPGDZQWBWPJHZJDYSCQWZKTXXSQLZYYMYSDZGRXCKKUJLWPYSYSCSYZLRMLQSYLJXBCXTLWDQZPCYCYKPPPNSXFYZJJRCEMHSZMSXLXGLRWGCSTLRSXBZGBZGZTCPLUJLSLYLYMTXMTZPALZXPXJTJWTCYYZLBLXBZLQMYLXPGHDSLSSDMXMBDZZSXWHAMLCZCPJMCNHJYSNSYGCHSKQMZZQDLLKABLWJXSFMOCDXJRRLYQZKJMYBYQLYHETFJZFRFKSRYXFJTWDSXXSYSQJYSLYXWJHSNLXYYXHBHAWHHJZXWMYLJCSSLKYDZTXBZSYFDXGXZJKHSXXYBSSXDPYNZWRPTQZCZENYGCXQFJYKJBZMLJCMQQXUOXSLYXXLYLLJDZBTYMHPFSTTQQWLHOKYBLZZALZXQLHZWRRQHLSTMYPYXJJXMQSJFNBXYXYJXXYQYLTHYLQYFMLKLJTMLLHSZWKZHLJMLHLJKLJSTLQXYLMBHHLNLZXQJHXCFXXLHYHJJGBYZZKBXSCQDJQDSUJZYYHZHHMGSXCSYMXFEBCQWWRBPYYJQTYZCYQYQQZYHMWFFHGZFRJFCDPXNTQYZPDYKHJLFRZXPPXZDBBGZQSTLGDGYLCQMLCHHMFYWLZYXKJLYPQHSYWMQQGQZMLZJNSQXJQSYJYCBEHSXFSZPXZWFLLBCYYJDYTDTHWZSFJMQQYJLMQXXLLDTTKHHYBFPWTYYSQQWNQWLGWDEBZWCMYGCULKJXTMXMYJSXHYBRWFYMWFRXYQMXYSZTZZTFYKMLDHQDXWYYNLCRYJBLPSXCXYWLSPRRJWXHQYPHTYDNXHHMMYWYTZCSQMTSSCCDALWZTCPQPYJLLQZYJSWXMZZMMYLMXCLMXCZMXMZSQTZPPQQBLPGXQZHFLJJHYTJSRXWZXSCCDLXTYJDCQJXSLQYCLZXLZZXMXQRJMHRHZJBHMFLJLMLCLQNLDXZLLLPYPSYJYSXCQQDCMQJZZXHNPNXZMEKMXHYKYQLXSXTXJYYHWDCWDZHQYYBGYBCYSCFGPSJNZDYZZJZXRZRQJJYMCANYRJTLDPPYZBSTJKXXZYPFDWFGZZRPYMTNGXZQBYXNBUFNQKRJQZMJEGRZGYCLKXZDSKKNSXKCLJSPJYYZLQQJYBZSSQLLLKJXTBKTYLCCDDBLSPPFYLGYDTZJYQGGKQTTFZXBDKTYYHYBBFYTYYBCLPDYTGDHRYRNJSPTCSNYJQHKLLLZSLYDXXWBCJQSPXBPJZJCJDZFFXXBRMLAZHCSNDLBJDSZBLPRZTSWSBXBCLLXXLZDJZSJPYLYXXYFTFFFBHJJXGBYXJPMMMPSSJZJMTLYZJXSWXTYLEDQPJMYGQZJGDJLQJWJQLLSJGJGYGMSCLJJXDTYGJQJQJCJZCJGDZZSXQGSJGGCXHQXSNQLZZBXHSGZXCXYLJXYXYYDFQQJHJFXDHCTXJYRXYSQTJXYEFYYSSYYJXNCYZXFXMSYSZXYYSCHSHXZZZGZZZGFJDLTYLNPZGYJYZYYQZPBXQBDZTZCZYXXYHHSQXSHDHGQHJHGYWSZTMZMLHYXGEBTYLZKQWYTJZRCLEKYSTDBCYKQQSAYXCJXWWGSBHJYZYDHCSJKQCXSWXFLTYNYZPZCCZJQTZWJQDZZZQZLJJXLSBHPYXXPSXSHHEZTXFPTLQYZZXHYTXNCFZYYHXGNXMYWXTZSJPTHHGYMXMXQZXTSBCZYJYXXTYYZYPCQLMMSZMJZZLLZXGXZAAJZYXJMZXWDXZSXZDZXLEYJJZQBHZWZZZQTZPSXZTDSXJJJZNYAZPHXYYSRNQDTHZHYYKYJHDZXZLSWCLYBZYECWCYCRYLCXNHZYDZYDYJDFRJJHTRSQTXYXJRJHOJYNXELXSFSFJZGHPZSXZSZDZCQZBYYKLSGSJHCZSHDGQGXYZGXCHXZJWYQWGYHKSSEQZZNDZFKWYSSTCLZSTSYMCDHJXXYWEYXCZAYDMPXMDSXYBSQMJMZJMTZQLPJYQZCGQHXJHHLXXHLHDLDJQCLDWBSXFZZYYSCHTYTYYBHECXHYKGJPXHHYZJFXHWHBDZFYZBCAPNPGNYDMSXHMMMMAMYNBYJTMPXYYMCTHJBZYFCGTYHWPHFTWZZEZSBZEGPFMTSKFTYCMHFLLHGPZJXZJGZJYXZSBBQSCZZLZCCSTPGXMJSFTCCZJZDJXCYBZLFCJSYZFGSZLYBCWZZBYZDZYPSWYJZXZBDSYUXLZZBZFYGCZXBZHZFTPBGZGEJBSTGKDMFHYZZJHZLLZZGJQZLSFDJSSCBZGPDLFZFZSZYZYZSYGCXSNXXCHCZXTZZLJFZGQSQYXZJQDCCZTQCDXZJYQJQCHXZTDLGSCXZSYQJQTZWLQDQZTQCHQQJZYEZZZPBWKDJFCJPZTYPQYQTTYNLMBDKTJZPQZQZZFPZSBNJLGYJDXJDZZKZGQKXDLPZJTCJDQBXDJQJSTCKNXBXZMSLYJCQMTJQWWCJQNJNLLLHJCWQTBZQYDZCZPZZDZYDDCYZZZCCJTTJFZDPRRTZTJDCQTQZDTJNPLZBCLLCTZSXKJZQZPZLBZRBTJDCXFCZDBCCJJLTQQPLDCGZDBBZJCQDCJWYNLLZYZCCDWLLXWZLXRXNTQQCZXKQLSGDFQTDDGLRLAJJTKUYMKQLLTZYTDYYCZGJWYXDXFRSKSTQTENQMRKQZHHQKDLDAZFKYPBGGPZREBZZYKZZSPEGJXGYKQZZZSLYSYYYZWFQZYLZZLZHWCHKYPQGNPGBLPLRRJYXCCSYYHSFZFYBZYYTGZXYLXCZWXXZJZBLFFLGSKHYJZEYJHLPLLLLCZGXDRZELRHGKLZZYHZLYQSZZJZQLJZFLNBHGWLCZCFJYSPYXZLZLXGCCPZBLLCYBBBBUBBCBPCRNNZCZYRBFSRLDCGQYYQXYGMQZWTZYTYJXYFWTEHZZJYWLCCNTZYJJZDEDPZDZTSYQJHDYMBJNYJZLXTSSTPHNDJXXBYXQTZQDDTJTDYYTGWSCSZQFLSHLGLBCZPHDLYZJYCKWTYTYLBNYTSDSYCCTYSZYYEBHEXHQDTWNYGYCLXTSZYSTQMYGZAZCCSZZDSLZCLZRQXYYELJSBYMXSXZTEMBBLLYYLLYTDQYSHYMRQWKFKBFXNXSBYCHXBWJYHTQBPBSBWDZYLKGZSKYHXQZJXHXJXGNLJKZLYYCDXLFYFGHLJGJYBXQLYBXQPQGZTZPLNCYPXDJYQYDYMRBESJYYHKXXSTMXRCZZYWXYQYBMCLLYZHQYZWQXDBXBZWZMSLPDMYSKFMZKLZCYQYCZLQXFZZYDQZPZYGYJYZMZXDZFYFYTTQTZHGSPCZMLCCYTZXJCYTJMKSLPZHYSNZLLYTPZCTZZCKTXDHXXTQCYFKSMQCCYYAZHTJPCYLZLYJBJXTPNYLJYYNRXSYLMMNXJSMYBCSYSYLZYLXJJQYLDZLPQBFZZBLFNDXQKCZFYWHGQMRDSXYCYTXNQQJZYYPFZXDYZFPRXEJDGYQBXRCNFYYQPGHYJDYZXGRHTKYLNWDZNTSMPKLBTHBPYSZBZTJZSZZJTYYXZPHSSZZBZCZPTQFZMYFLYPYBBJQXZMXXDJMTSYSKKBJZXHJCKLPSMKYJZCXTMLJYXRZZQSLXXQPYZXMKYXXXJCLJPRMYYGADYSKQLSNDHYZKQXZYZTCGHZTLMLWZYBWSYCTBHJHJFCWZTXWYTKZLXQSHLYJZJXTMPLPYCGLTBZZTLZJCYJGDTCLKLPLLQPJMZPAPXYZLKKTKDZCZZBNZDYDYQZJYJGMCTXLTGXSZLMLHBGLKFWNWZHDXUHLFMKYSLGXDTWWFRJEJZTZHYDXYKSHWFZCQSHKTMQQHTZHYMJDJSKHXZJZBZZXYMPAGQMSTPXLSKLZYNWRTSQLSZBPSPSGZWYHTLKSSSWHZZLYYTNXJGMJSZSUFWNLSOZTXGXLSAMMLBWLDSZYLAKQCQCTMYCFJBSLXCLZZCLXXKSBZQCLHJPSQPLSXXCKSLNHPSFQQYTXYJZLQLDXZQJZDYYDJNZPTUZDSKJFSLJHYLZSQZLBTXYDGTQFDBYAZXDZHZJNHHQBYKNXJJQCZMLLJZKSPLDYCLBBLXKLELXJLBQYCXJXGCNLCQPLZLZYJTZLJGYZDZPLTQCSXFDMNYCXGBTJDCZNBGBQYQJWGKFHTNPYQZQGBKPBBYZMTJDYTBLSQMPSXTBNPDXKLEMYYCJYNZCTLDYKZZXDDXHQSHDGMZSJYCCTAYRZLPYLTLKXSLZCGGEXCLFXLKJRTLQJAQZNCMBYDKKCXGLCZJZXJHPTDJJMZQYKQSECQZDSHHADMLZFMMZBGNTJNNLGBYJBRBTMLBYJDZXLCJLPLDLPCQDHLXZLYCBLCXZZJADJLNZMMSSSMYBHBSQKBHRSXXJMXSDZNZPXLGBRHWGGFCXGMSKLLTSJYYCQLTSKYWYYHYWXBXQYWPYWYKQLSQPTNTKHQCWDQKTWPXXHCPTHTWUMSSYHBWCRWXHJMKMZNGWTMLKFGHKJYLSYYCXWHYECLQHKQHTTQKHFZLDXQWYZYYDESBPKYRZPJFYYZJCEQDZZDLATZBBFJLLCXDLMJSSXEGYGSJQXCWBXSSZPDYZCXDNYXPPZYDLYJCZPLTXLSXYZYRXCYYYDYLWWNZSAHJSYQYHGYWWAXTJZDAXYSRLTDPSSYYFNEJDXYZHLXLLLZQZSJNYQYQQXYJGHZGZCYJCHZLYCDSHWSHJZYJXCLLNXZJJYYXNFXMWFPYLCYLLABWDDHWDXJMCXZTZPMLQZHSFHZYNZTLLDYWLSLXHYMMYLMBWWKYXYADTXYLLDJPYBPWUXJMWMLLSAFDLLYFLBHHHBQQLTZJCQJLDJTFFKMMMBYTHYGDCQRDDWRQJXNBYSNWZDBYYTBJHPYBYTTJXAAHGQDQTMYSTQXKBTZPKJLZRBEQQSSMJJBDJOTGTBXPGBKTLHQXJJJCTHXQDWJLWRFWQGWSHCKRYSWGFTGYGBXSDWDWRFHWYTJJXXXJYZYSLPYYYPAYXHYDQKXSHXYXGSKQHYWFDDDPPLCJLQQEEWXKSYYKDYPLTJTHKJLTCYYHHJTTPLTZZCDLTHQKZXQYSTEEYWYYZYXXYYSTTJKLLPZMCYHQGXYHSRMBXPLLNQYDQHXSXXWGDQBSHYLLPJJJTHYJKYPPTHYYKTYEZYENMDSHLCRPQFDGFXZPSFTLJXXJBSWYYSKSFLXLPPLBBBLBSFXFYZBSJSSYLPBBFFFFSSCJDSTZSXZRYYSYFFSYZYZBJTBCTSBSDHRTJJBYTCXYJEYLXCBNEBJDSYXYKGSJZBXBYTFZWGENYHHTHZHHXFWGCSTBGXKLSXYWMTMBYXJSTZSCDYQRCYTWXZFHMYMCXLZNSDJTTTXRYCFYJSBSDYERXJLJXBBDEYNJGHXGCKGSCYMBLXJMSZNSKGXFBNBPTHFJAAFXYXFPXMYPQDTZCXZZPXRSYWZDLYBBKTYQPQJPZYPZJZNJPZJLZZFYSBTTSLMPTZRTDXQSJEHBZYLZDHLJSQMLHTXTJECXSLZZSPKTLZKQQYFSYGYWPCPQFHQHYTQXZKRSGTTSQCZLPTXCDYYZXSQZSLXLZMYCPCQBZYXHBSXLZDLTCDXTYLZJYYZPZYZLTXJSJXHLPMYTXCQRBLZSSFJZZTNJYTXMYJHLHPPLCYXQJQQKZZSCPZKSWALQSBLCCZJSXGWWWYGYKTJBBZTDKHXHKGTGPBKQYSLPXPJCKBMLLXDZSTBKLGGQKQLSBKKTFXRMDKBFTPZFRTBBRFERQGXYJPZSSTLBZTPSZQZSJDHLJQLZBPMSMMSXLQQNHKNBLRDDNXXDHDDJCYYGYLXGZLXSYGMQQGKHBPMXYXLYTQWLWGCPBMQXCYZYDRJBHTDJYHQSHTMJSBYPLWHLZFFNYPMHXXHPLTBQPFBJWQDBYGPNZTPFZJGSDDTQSHZEAWZZYLLTYYBWJKXXGHLFKXDJTMSZSQYNZGGSWQSPHTLSSKMCLZXYSZQZXNCJDQGZDLFNYKLJCJLLZLMZZNHYDSSHTHZZLZZBBHQZWWYCRZHLYQQJBEYFXXXWHSRXWQHWPSLMSSKZTTYGYQQWRSLALHMJTQJSMXQBJJZJXZYZKXBYQXBJXSHZTSFJLXMXZXFGHKZSZGGYLCLSARJYHSLLLMZXELGLXYDJYTLFBHBPNLYZFBBHPTGJKWETZHKJJXZXXGLLJLSTGSHJJYQLQZFKCGNNDJSSZFDBCTWWSEQFHQJBSAQTGYPQLBXBMMYWXGSLZHGLZGQYFLZBYFZJFRYSFMBYZHQGFWZSYFYJJPHZBYYZFFWODGRLMFTWLBZGYCQXCDJYGZYYYYTYTYDWEGAZYHXJLZYYHLRMGRXXZCLHNELJJTJTPWJYBJJBXJJTJTEEKHWSLJPLPSFYZPQQBDLQJJTYYQLYZKDKSQJYYQZLDQTGJQYZJSUCMRYQTHTEJMFCTYHYPKMHYZWJDQFHYYXWSHCTXRLJHQXHCCYYYJLTKTTYTMXGTCJTZAYYOCZLYLBSZYWJYTSJYHBYSHFJLYGJXXTMZYYLTXXYPZLXYJZYZYYPNHMYMDYYLBLHLSYYQQLLNJJYMSOYQBZGDLYXYLCQYXTSZEGXHZGLHWBLJHEYXTWQMAKBPQCGYSHHEGQCMWYYWLJYJHYYZLLJJYLHZYHMGSLJLJXCJJYCLYCJPCPZJZJMMYLCQLNQLJQJSXYJMLSZLJQLYCMMHCFMMFPQQMFYLQMCFFQMMMMHMZNFHHJGTTHHKHSLNCHHYQDXTMMQDCYZYXYQMYQYLTDCYYYZAZZCYMZYDLZFFFMMYCQZWZZMABTBYZTDMNZZGGDFTYPCGQYTTSSFFWFDTZQSSYSTWXJHXYTSXXYLBYQHWWKXHZXWZNNZZJZJJQJCCCHYYXBZXZCYZTLLCQXYNJYCYYCYNZZQYYYEWYCZDCJYCCHYJLBTZYYCQWMPWPYMLGKDLDLGKQQBGYCHJXY"},22:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(0),s=r(i),l=n(10),u=r(l),c=n(23),d=r(c),p="undefined"!==typeof window&&"undefined"!==typeof window.document,f=function e(){var t=this;if(a(this,e),this._bindNotify=function(e){t.notifyHandler=e},this._bindGetToasts=function(e){t.getToastsHandler=e},this._bindCloseAll=function(e){t.closeAllHandler=e},this.getToasts=function(){return t.getToastsHandler()},this.closeAll=function(){return t.closeAllHandler()},this.notify=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.notifyHandler(e,o({},n,{intent:"none"}))},this.success=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.notifyHandler(e,o({},n,{intent:"success"}))},this.warning=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.notifyHandler(e,o({},n,{intent:"warning"}))},this.danger=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.notifyHandler(e,o({},n,{intent:"danger"}))},p){var n=document.createElement("div");n.setAttribute("data-evergreen-toaster-container",""),document.body.appendChild(n),u.default.render(s.default.createElement(d.default,{bindNotify:this._bindNotify,bindGetToasts:this._bindGetToasts,bindCloseAll:this._bindCloseAll}),n)}};t.default=f},2214:function(e,t,n){n(20),e.exports=n(2215)},2215:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(10),d=r(c),p=n(15),f=n(127),h=r(f),m=n(6),g=n(2),y=n(3),v=n(2216),b=r(v),w=n(2218),E=r(w),S=n(2222),C=r(S),D=n(2223),_=r(D),P=n(2224),k=r(P),M=n(2227),O=r(M),L=n(2231),I=r(L),T=n(2232),R=r(T),N=n(386),x=r(N),F=n(2234),Y=r(F),Z=n(2236),j=r(Z),A=n(2238),B=r(A),X=n(2240),J=r(X),U=n(2241),H=r(U),G=n(2242),q=r(G),Q=n(2253),W=r(Q),K=n(2254),z=r(K),V=n(2257),$=r(V),ee=n(2301),te=r(ee),ne=n(2312),re=r(ne),ae=n(2316),oe=r(ae),ie=n(2320),se=r(ie),le=n(2326),ue=r(le);n(159),n(79),n(111);var ce=(0,ue.default)(O.default),de=(0,ue.default)(_.default),pe=(0,ue.default)(I.default),fe=(0,ue.default)(R.default),he=(0,ue.default)(H.default),me=(0,ue.default)(Y.default),ge=(0,ue.default)(j.default),ye=(0,ue.default)(B.default),ve=(0,ue.default)(J.default),be=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onpopstate=function(e){if(e.state&&e.state.currentTab&&e.state.pathPrefix){var t=e.state,r=t.currentTab,a=t.pathPrefix;n.setState({currentTab:r,pathPrefix:a})}},n.navigateClientUrlToLib=function(){if(window.location.hash&&-1!=window.location.hash.indexOf("common/lib")){var e=window.location.hash.split("/"),t=e[e.length-2],n=g.siteRoot+"library/"+t+"/";(0,p.navigate)(n,{repalce:!0})}},n.getDrafts=function(){x.default.listDrafts().then(function(e){n.setState({draftCounts:e.data.draft_counts,draftList:e.data.data,isLoadingDraft:!1})})},n.updateDraftsList=function(e){n.setState({draftCounts:n.state.draftCounts-1,draftList:n.state.draftList.filter(function(t){return t.id!=e})})},n.onCloseSidePanel=function(){n.setState({isSidePanelClosed:!n.state.isSidePanelClosed})},n.onShowSidePanel=function(){n.setState({isSidePanelClosed:!n.state.isSidePanelClosed})},n.onSearchedClick=function(e){if(!0===e.is_dir){n.setState({currentTab:"",pathPrefix:[]});var t=g.siteRoot+"library/"+e.repo_id+"/"+e.repo_name+e.path;(0,p.navigate)(t,{repalce:!0})}else{var r=g.siteRoot+"lib/"+e.repo_id+"/file"+y.Utils.encodePath(e.path);if(y.Utils.isWeChat())location.href=r;else{window.open("about:blank").location.href=r}}},n.onGroupChanged=function(e){setTimeout(function(){var t=void 0;t=e?g.siteRoot+"group/"+e+"/":g.siteRoot+"groups/",window.location=t.toString()},1)},n.tabItemClick=function(e,t){var r=[];(t||n.dirViewPanels.indexOf(e)>-1)&&(r=n.generatorPrefix(e,t)),n.setState({currentTab:e,pathPrefix:r},function(){var e=n.state,t=e.currentTab,r=e.pathPrefix;window.history.replaceState({currentTab:t,pathPrefix:r},null)}),y.Utils.isDesktop()||n.state.isSidePanelClosed||n.setState({isSidePanelClosed:!0})},n.generatorPrefix=function(e,t){var r=[];if(t){var a={url:g.siteRoot+"groups/",showName:"Groups",name:"groups",id:null},o={url:g.siteRoot+"group/"+t+"/",showName:e,name:e,id:t};r.push(a),r.push(o)}else{var i={url:g.siteRoot+e+"/",showName:n.getTabShowName(e),name:e,id:null};r.push(i)}return r},n.getTabShowName=function(e){return"my-libs"===e?"Libraries":"shared-libs"===e?"Shared with me":"org"===e?"Shared with all":void 0},n.toggleSidePanel=function(){n.setState({isSidePanelClosed:!n.state.isSidePanelClosed})},n.state={isOpen:!1,isSidePanelClosed:!1,draftCounts:0,draftList:[],isLoadingDraft:!0,currentTab:"/",pathPrefix:[]},n.dirViewPanels=["my-libs","shared-libs","org"],window.onpopstate=n.onpopstate,n}return i(t,e),s(t,[{key:"componentWillMount",value:function(){y.Utils.isDesktop()||this.setState({isSidePanelClosed:!0})}},{key:"componentDidMount",value:function(){this.navigateClientUrlToLib();var e=window.location.href.split("/");g.isDocs&&this.getDrafts(),this.setState({currentTab:e[e.length-2]})}},{key:"render",value:function(){var e=this.state,t=e.currentTab,n=e.isSidePanelClosed,r=g.canAddRepo?u.default.createElement(q.default,{path:g.siteRoot,onShowSidePanel:this.onShowSidePanel,onSearchedClick:this.onSearchedClick}):u.default.createElement(he,{path:g.siteRoot,onShowSidePanel:this.onShowSidePanel,onSearchedClick:this.onSearchedClick});return u.default.createElement(u.default.Fragment,null,u.default.createElement(b.default,null),u.default.createElement("div",{id:"main"},u.default.createElement(E.default,{isSidePanelClosed:this.state.isSidePanelClosed,onCloseSidePanel:this.onCloseSidePanel,currentTab:t,tabItemClick:this.tabItemClick,draftCounts:this.state.draftCounts}),u.default.createElement(C.default,null,u.default.createElement(p.Router,{className:"reach-router"},r,u.default.createElement(ce,{path:g.siteRoot+"dashboard",onShowSidePanel:this.onShowSidePanel,onSearchedClick:this.onSearchedClick}),u.default.createElement(de,{path:g.siteRoot+"drafts",onShowSidePanel:this.onShowSidePanel,onSearchedClick:this.onSearchedClick},u.default.createElement(k.default,{path:"/",getDrafts:this.getDrafts,isLoadingDraft:this.state.isLoadingDraft,draftList:this.state.draftList,updateDraftsList:this.updateDraftsList})),u.default.createElement(pe,{path:g.siteRoot+"starred",onShowSidePanel:this.onShowSidePanel,onSearchedClick:this.onSearchedClick}),u.default.createElement(fe,{path:g.siteRoot+"linked-devices",onShowSidePanel:this.onShowSidePanel,onSearchedClick:this.onSearchedClick}),u.default.createElement(me,{path:g.siteRoot+"share-admin-libs",onShowSidePanel:this.onShowSidePanel,onSearchedClick:this.onSearchedClick}),u.default.createElement(ge,{path:g.siteRoot+"share-admin-folders",onShowSidePanel:this.onShowSidePanel,onSearchedClick:this.onSearchedClick}),u.default.createElement(ye,{path:g.siteRoot+"share-admin-share-links",onShowSidePanel:this.onShowSidePanel,onSearchedClick:this.onSearchedClick}),u.default.createElement(ve,{path:g.siteRoot+"share-admin-upload-links",onShowSidePanel:this.onShowSidePanel,onSearchedClick:this.onSearchedClick}),u.default.createElement(he,{path:g.siteRoot+"shared-libs",onShowSidePanel:this.onShowSidePanel,onSearchedClick:this.onSearchedClick}),u.default.createElement(q.default,{path:g.siteRoot+"my-libs",onShowSidePanel:this.onShowSidePanel,onSearchedClick:this.onSearchedClick}),u.default.createElement(W.default,{path:g.siteRoot+"my-libs/deleted/",onSearchedClick:this.onSearchedClick}),u.default.createElement($.default,{path:g.siteRoot+"library/:repoID/*",pathPrefix:this.state.pathPrefix,onMenuClick:this.onShowSidePanel,onTabNavClick:this.tabItemClick}),u.default.createElement(re.default,{path:g.siteRoot+"groups",onShowSidePanel:this.onShowSidePanel,onSearchedClick:this.onSearchedClick}),u.default.createElement(te.default,{path:g.siteRoot+"group/:groupID",onShowSidePanel:this.onShowSidePanel,onSearchedClick:this.onSearchedClick,onTabNavClick:this.tabItemClick,onGroupChanged:this.onGroupChanged}),u.default.createElement(se.default,{path:g.siteRoot+"published",onShowSidePanel:this.onShowSidePanel,onSearchedClick:this.onSearchedClick}),u.default.createElement(z.default,{path:g.siteRoot+"org/",onShowSidePanel:this.onShowSidePanel,onSearchedClick:this.onSearchedClick,onTabNavClick:this.tabItemClick}),u.default.createElement(oe.default,{path:g.siteRoot+"invitations/",onShowSidePanel:this.onShowSidePanel,onSearchedClick:this.onSearchedClick}))),u.default.createElement(h.default,{query:"(max-width: 767.8px)"},u.default.createElement(m.Modal,{zIndex:"1030",isOpen:!n,toggle:this.toggleSidePanel,contentClassName:"d-none"}))))}}]),t}(l.Component);d.default.render(u.default.createElement(be,null),document.getElementById("wrapper"))},2216:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function o(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(0),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=n(2);n(2217);var c=function(e){function t(e){r(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.close=function(){if(n.setState({isClosed:!0}),navigator.cookieEnabled){var e=new Date,t=document.cookie.split("; "),r=!1,a=u.curNoteID+"_";e.setTime(e.getTime()+12096e5),a+="; expires="+e.toGMTString()+"; path="+u.siteRoot;for(var o=0,i=t.length;o<i;o++)if("info_id"==t[o].split("=")[0]){r=!0,document.cookie="info_id="+t[o].split("=")[1]+a;break}r||(document.cookie="info_id="+a)}},n.state={isClosed:!1},n}return o(t,e),i(t,[{key:"render",value:function(){return!u.curNoteMsg||this.state.isClosed?null:l.default.createElement("div",{id:"info-bar"},l.default.createElement("p",{id:"info-bar-info"},u.curNoteMsg),l.default.createElement("span",{className:"close sf2-icon-x1",title:(0,u.gettext)("Close"),onClick:this.close}))}}]),t}(l.default.Component);t.default=c},2217:function(e,t){},2218:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(158),f=r(p),h=n(2219),m=r(h),g=n(2220),y=r(g),v={isSidePanelClosed:d.default.bool.isRequired,currentTab:d.default.oneOfType([d.default.string,d.default.number]).isRequired,onCloseSidePanel:d.default.func.isRequired,tabItemClick:d.default.func.isRequired,draftCounts:d.default.number},b=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){return u.default.createElement("div",{className:"side-panel "+(this.props.isSidePanelClosed?"":"left-zero")},u.default.createElement("div",{className:"side-panel-north"},u.default.createElement(f.default,{onCloseSidePanel:this.props.onCloseSidePanel})),u.default.createElement("div",{className:"side-panel-center"},u.default.createElement(m.default,{tabItemClick:this.props.tabItemClick,currentTab:this.props.currentTab,draftCounts:this.props.draftCounts})),u.default.createElement("div",{className:"side-panel-footer"},u.default.createElement(y.default,null)))}}]),t}(u.default.Component);b.propTypes=v,t.default=b},2219:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(15),f=n(6),h=n(2),m=n(4),g=n(3),y=n(5),v=r(y),b=n(1022),w=r(b),E={currentTab:d.default.oneOfType([d.default.string,d.default.number]).isRequired,tabItemClick:d.default.func.isRequired,draftCounts:d.default.number},S=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.grpsExtend=function(){n.setState({groupsExtended:!n.state.groupsExtended}),n.loadGroups()},n.shExtend=function(){n.setState({sharedExtended:!n.state.sharedExtended})},n.loadGroups=function(){var e=n;m.seafileAPI.listGroups().then(function(t){var r=t.data.map(function(e){return new w.default(e)});n.groupsHeight=(r.length+1)*e.listHeight,e.setState({groupItems:r.sort(function(e,t){return e.name.toLowerCase()<t.name.toLowerCase()?-1:1})})}).catch(function(e){var t=g.Utils.getErrorMsg(e);v.default.danger(t)})},n.tabItemClick=function(e,t,r){if(window.uploader&&window.uploader.isUploadProgressDialogShow&&100!==window.uploader.totalProgress){if(!window.confirm((0,h.gettext)("A file is being uploaded. Are you sure you want to leave this page?")))return e.preventDefault(),!1;window.uploader.isUploadProgressDialogShow=!1}n.props.tabItemClick(t,r)},n.onDTableClick=function(){var e=h.dtableWebServer;window.open(e)},n.getActiveClass=function(e){return n.props.currentTab===e?"active":""},n.state={groupsExtended:!1,sharedExtended:!1,closeSideBar:!1,groupItems:[]},n.listHeight=24,n.groupsHeight=0,n.adminHeight=0,n}return i(t,e),s(t,[{key:"renderSharedGroups",value:function(){var e=this,t={height:0};return this.state.groupsExtended&&(t={height:this.groupsHeight}),u.default.createElement("ul",{className:"nav sub-nav nav-pills flex-column grp-list "+(this.state.groupsExtended?"side-panel-slide":"side-panel-slide-up"),style:t},u.default.createElement("li",{className:"nav-item"},u.default.createElement(p.Link,{to:h.siteRoot+"groups/",className:"nav-link ellipsis "+this.getActiveClass("groups"),onClick:function(t){return e.tabItemClick(t,"groups")}},u.default.createElement("span",{className:"sharp","aria-hidden":"true"},"#"),u.default.createElement("span",{className:"nav-text"},(0,h.gettext)("All Groups")))),this.state.groupItems.map(function(t){return u.default.createElement("li",{key:t.id,className:"nav-item"},u.default.createElement(p.Link,{to:h.siteRoot+"group/"+t.id+"/",className:"nav-link ellipsis "+e.getActiveClass(t.name),onClick:function(n){return e.tabItemClick(n,t.name,t.id)}},u.default.createElement("span",{className:"sharp","aria-hidden":"true"},"#"),u.default.createElement("span",{className:"nav-text"},t.name)))}))}},{key:"renderSharedAdmin",value:function(){var e=this,t=0;this.state.sharedExtended&&(this.adminHeight||(this.adminHeight=3*this.listHeight),t=this.adminHeight);var n={height:t},r=null;return h.canGenerateShareLink?r=u.default.createElement("li",{className:"nav-item"},u.default.createElement(p.Link,{to:h.siteRoot+"share-admin-share-links/",className:"nav-link ellipsis "+this.getActiveClass("share-admin-share-links"),title:(0,h.gettext)("Links"),onClick:function(t){return e.tabItemClick(t,"share-admin-share-links")}},u.default.createElement("span",{"aria-hidden":"true",className:"sharp"},"#"),u.default.createElement("span",{className:"nav-text"},(0,h.gettext)("Links")))):h.canGenerateUploadLink&&(r=u.default.createElement("li",{className:"nav-item"},u.default.createElement(p.Link,{to:h.siteRoot+"share-admin-upload-links/",className:"nav-link ellipsis "+this.getActiveClass("share-admin-upload-links"),title:(0,h.gettext)("Links"),onClick:function(t){return e.tabItemClick(t,"share-admin-upload-links")}},u.default.createElement("span",{"aria-hidden":"true",className:"sharp"},"#"),u.default.createElement("span",{className:"nav-text"},(0,h.gettext)("Links"))))),u.default.createElement("ul",{className:"nav sub-nav nav-pills flex-column "+(this.state.sharedExtended?"side-panel-slide":"side-panel-slide-up"),style:n},h.canAddRepo&&u.default.createElement("li",{className:"nav-item"},u.default.createElement(p.Link,{to:h.siteRoot+"share-admin-libs/",className:"nav-link ellipsis "+this.getActiveClass("share-admin-libs"),title:(0,h.gettext)("Libraries"),onClick:function(t){return e.tabItemClick(t,"share-admin-libs")}},u.default.createElement("span",{"aria-hidden":"true",className:"sharp"},"#"),u.default.createElement("span",{className:"nav-text"},(0,h.gettext)("Libraries")))),u.default.createElement("li",{className:"nav-item"},u.default.createElement(p.Link,{to:h.siteRoot+"share-admin-folders/",className:"nav-link ellipsis "+this.getActiveClass("share-admin-folders"),title:(0,h.gettext)("Folders"),onClick:function(t){return e.tabItemClick(t,"share-admin-folders")}},u.default.createElement("span",{"aria-hidden":"true",className:"sharp"},"#"),u.default.createElement("span",{className:"nav-text"},(0,h.gettext)("Folders")))),r)}},{key:"renderCustomNavItems",value:function(){return h.customNavItems.map(function(e,t){return u.default.createElement("li",{key:t,className:"nav-item"},u.default.createElement("a",{href:e.link,className:"nav-link ellipsis",title:e.desc},u.default.createElement("span",{className:e.icon,"aria-hidden":"true"}),u.default.createElement("span",{className:"nav-text"},e.desc)))})}},{key:"render",value:function(){var e=this,t=h.isDocs||h.isPro;return u.default.createElement("div",{className:"side-nav"},u.default.createElement("div",{className:"side-nav-con"},u.default.createElement("h3",{className:"sf-heading"},(0,h.gettext)("Files")),u.default.createElement("ul",{className:"nav nav-pills flex-column nav-container"},h.canAddRepo&&u.default.createElement("li",{className:"nav-item"},u.default.createElement(p.Link,{to:h.siteRoot+"my-libs/",className:"nav-link ellipsis "+(this.getActiveClass("my-libs")||this.getActiveClass("deleted")),title:(0,h.gettext)("My Libraries"),onClick:function(t){return e.tabItemClick(t,"my-libs")}},u.default.createElement("span",{className:"sf2-icon-user","aria-hidden":"true"}),u.default.createElement("span",{className:"nav-text"},(0,h.gettext)("My Libraries")))),u.default.createElement("li",{className:"nav-item"},u.default.createElement(p.Link,{to:h.siteRoot+"shared-libs/",className:"nav-link ellipsis "+this.getActiveClass("shared-libs"),title:(0,h.gettext)("Shared with me"),onClick:function(t){return e.tabItemClick(t,"shared-libs")}},u.default.createElement("span",{className:"sf2-icon-share","aria-hidden":"true"}),u.default.createElement("span",{className:"nav-text"},(0,h.gettext)("Shared with me")))),h.canViewOrg&&u.default.createElement("li",{className:"nav-item",onClick:function(t){return e.tabItemClick(t,"org")}},u.default.createElement(p.Link,{to:h.siteRoot+"org/",className:"nav-link ellipsis "+this.getActiveClass("org"),title:(0,h.gettext)("Shared with all")},u.default.createElement("span",{className:"sf2-icon-organization","aria-hidden":"true"}),u.default.createElement("span",{className:"nav-text"},(0,h.gettext)("Shared with all")))),u.default.createElement("li",{className:"nav-item flex-column",id:"group-nav"},u.default.createElement("a",{className:"nav-link ellipsis",title:(0,h.gettext)("Shared with groups"),onClick:this.grpsExtend},u.default.createElement("span",{className:"toggle-icon float-right fas "+(this.state.groupsExtended?"fa-caret-down":"fa-caret-left"),"aria-hidden":"true"}),u.default.createElement("span",{className:"sf2-icon-group","aria-hidden":"true"}),u.default.createElement("span",{className:"nav-text"},(0,h.gettext)("Shared with groups"))),this.renderSharedGroups())),u.default.createElement("h3",{className:"sf-heading"},(0,h.gettext)("Tools")),u.default.createElement("ul",{className:"nav nav-pills flex-column nav-container"},u.default.createElement("li",{className:"nav-item"},u.default.createElement(p.Link,{className:"nav-link ellipsis "+this.getActiveClass("starred"),to:h.siteRoot+"starred/",title:(0,h.gettext)("Favorites"),onClick:function(t){return e.tabItemClick(t,"starred")}},u.default.createElement("span",{className:"sf2-icon-star","aria-hidden":"true"}),u.default.createElement("span",{className:"nav-text"},(0,h.gettext)("Favorites")))),t&&u.default.createElement("li",{className:"nav-item"},u.default.createElement(p.Link,{className:"nav-link ellipsis "+this.getActiveClass("dashboard"),to:h.siteRoot+"dashboard/",title:(0,h.gettext)("Activities"),onClick:function(t){return e.tabItemClick(t,"dashboard")}},u.default.createElement("span",{className:"sf2-icon-clock","aria-hidden":"true"}),u.default.createElement("span",{className:"nav-text"},(0,h.gettext)("Activities")))),h.canPublishRepo&&u.default.createElement("li",{className:"nav-item"},u.default.createElement(p.Link,{className:"nav-link ellipsis "+this.getActiveClass("published"),to:h.siteRoot+"published/",title:(0,h.gettext)("Published Libraries"),onClick:function(t){return e.tabItemClick(t,"published")}},u.default.createElement("span",{className:"sf2-icon-wiki-view","aria-hidden":"true"}),u.default.createElement("span",{className:"nav-text"},(0,h.gettext)("Published Libraries")))),h.isDocs&&u.default.createElement("li",{className:"nav-item",onClick:function(t){return e.tabItemClick(t,"drafts")}},u.default.createElement(p.Link,{className:"nav-link ellipsis "+this.getActiveClass("drafts"),to:h.siteRoot+"drafts/",title:(0,h.gettext)("Drafts")},u.default.createElement("span",{className:"sf2-icon-edit","aria-hidden":"true"}),u.default.createElement("span",{className:"draft-info nav-text"},(0,h.gettext)("Drafts"),0===this.props.draftCounts?"":u.default.createElement(f.Badge,{color:"info",pill:!0},this.props.draftCounts)))),u.default.createElement("li",{className:"nav-item"},u.default.createElement(p.Link,{className:"nav-link ellipsis "+this.getActiveClass("linked-devices"),to:h.siteRoot+"linked-devices/",title:(0,h.gettext)("Linked Devices"),onClick:function(t){return e.tabItemClick(t,"linked-devices")}},u.default.createElement("span",{className:"sf2-icon-monitor","aria-hidden":"true"}),u.default.createElement("span",{className:"nav-text"},(0,h.gettext)("Linked Devices")))),h.canInvitePeople&&u.default.createElement("li",{className:"nav-item"},u.default.createElement(p.Link,{className:"nav-link ellipsis "+this.getActiveClass("invitations"),to:h.siteRoot+"invitations/",title:(0,h.gettext)("Invite Guest"),onClick:function(t){return e.tabItemClick(t,"invitations")}},u.default.createElement("span",{className:"sf2-icon-invite","aria-hidden":"true"}),u.default.createElement("span",{className:"nav-text"},(0,h.gettext)("Invite Guest")))),u.default.createElement("li",{className:"nav-item flex-column",id:"share-admin-nav"},u.default.createElement("a",{className:"nav-link ellipsis",title:(0,h.gettext)("Share Admin"),onClick:this.shExtend},u.default.createElement("span",{className:"toggle-icon float-right fas "+(this.state.sharedExtended?"fa-caret-down":"fa-caret-left"),"aria-hidden":"true"}),u.default.createElement("span",{className:"sf2-icon-wrench","aria-hidden":"true"}),u.default.createElement("span",{className:"nav-text"},(0,h.gettext)("Share Admin"))),this.renderSharedAdmin()),h.customNavItems&&this.renderCustomNavItems())),h.dtableWebServer&&u.default.createElement("div",{className:"side-nav-link",onClick:this.onDTableClick},u.default.createElement("span",{className:"link-icon icon-left sf3-font sf3-font-dtable-logo","aria-hidden":"true"}),u.default.createElement("span",{className:"link-text"},"SeaTable"),u.default.createElement("span",{className:"link-icon icon-right sf3-font sf3-font-arrow"})))}}]),t}(u.default.Component);S.propTypes=E,t.default=S},2220:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=r(u),d=n(2),p=n(13),f=r(p),h=n(2221),m=r(h),g=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onAboutDialogToggle=function(){n.setState({isAboutDialogShow:!n.state.isAboutDialogShow})},n.renderExternalAppLinks=function(){if(d.additionalAppBottomLinks&&"object"===("undefined"===typeof d.additionalAppBottomLinks?"undefined":s(d.additionalAppBottomLinks))){return Object.keys(d.additionalAppBottomLinks).map(function(e,t){return c.default.createElement("a",{key:t,className:"item",href:d.additionalAppBottomLinks[e]},e)})}return null},n.state={isAboutDialogShow:!1},n}return i(t,e),l(t,[{key:"render",value:function(){return d.sideNavFooterCustomHtml?c.default.createElement("div",{className:"side-nav-footer",dangerouslySetInnerHTML:{__html:d.sideNavFooterCustomHtml}}):c.default.createElement(u.Fragment,null,c.default.createElement("div",{className:"side-nav-footer flex-wrap"},c.default.createElement("a",{href:d.siteRoot+"help/",target:"_blank",rel:"noopener noreferrer",className:"item"},(0,d.gettext)("Help")),c.default.createElement("a",{className:"item cursor-pointer",onClick:this.onAboutDialogToggle},(0,d.gettext)("About")),d.enableTC&&c.default.createElement("a",{href:d.siteRoot+"terms/",className:"item"},(0,d.gettext)("Terms")),this.renderExternalAppLinks(),c.default.createElement("a",{href:d.siteRoot+"download_client_program/",className:"item "+(d.additionalAppBottomLinks?"":"last-item")},c.default.createElement("span",{"aria-hidden":"true",className:"sf2-icon-monitor vam"})," ",c.default.createElement("span",{className:"vam"},(0,d.gettext)("Clients")))),this.state.isAboutDialogShow&&c.default.createElement(f.default,null,c.default.createElement(m.default,{onCloseAboutDialog:this.onAboutDialogToggle})))}}]),t}(c.default.Component);t.default=g},2221:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=r(u),d=n(1),p=r(d),f=n(6),h=n(2),m={onCloseAboutDialog:p.default.func.isRequired},g=function(e){function t(){var e,n,r,i;a(this,t);for(var l=arguments.length,u=Array(l),d=0;d<l;d++)u[d]=arguments[d];return n=r=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),r.toggle=function(){r.props.onCloseAboutDialog()},r.renderExternalAboutLinks=function(){if(h.additionalAboutDialogLinks&&"object"===("undefined"===typeof h.additionalAboutDialogLinks?"undefined":s(h.additionalAboutDialogLinks))){return Object.keys(h.additionalAboutDialogLinks).map(function(e,t){return c.default.createElement("a",{key:t,className:"d-block",href:h.additionalAboutDialogLinks[e]},e)})}return null},i=n,o(r,i)}return i(t,e),l(t,[{key:"render",value:function(){var e=h.lang===h.lang=="zh-cn"?"http://seafile.com/about/":"http://seafile.com/en/about/";return h.aboutDialogCustomHtml?c.default.createElement(f.Modal,{isOpen:!0,toggle:this.toggle},c.default.createElement(f.ModalBody,null,c.default.createElement("button",{type:"button",className:"close",onClick:this.toggle},c.default.createElement("span",{"aria-hidden":"true"},"\xd7")),c.default.createElement("div",{className:"about-content",dangerouslySetInnerHTML:{__html:h.aboutDialogCustomHtml}}))):c.default.createElement(f.Modal,{isOpen:!0,toggle:this.toggle},c.default.createElement(f.ModalBody,null,c.default.createElement("button",{type:"button",className:"close",onClick:this.toggle},c.default.createElement("span",{"aria-hidden":"true"},"\xd7")),c.default.createElement("div",{className:"about-content"},c.default.createElement("p",null,c.default.createElement("img",{src:h.mediaUrl+h.logoPath,height:h.logoHeight,width:h.logoWidth,title:h.siteTitle,alt:"logo"})),c.default.createElement("p",null,(0,h.gettext)("Server Version: "),h.seafileVersion,c.default.createElement("br",null),"\xa9 ",(new Date).getFullYear()," ",(0,h.gettext)("Seafile")),c.default.createElement("p",null,this.renderExternalAboutLinks()),c.default.createElement("p",null,c.default.createElement("a",{href:e,target:"_blank"},(0,h.gettext)("About Us"))))))}}]),t}(c.default.Component);g.propTypes=m,t.default=g},2222:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p={children:d.default.object.isRequired},f=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){return u.default.createElement("div",{className:"main-panel o-hidden"},this.props.children)}}]),t}(l.Component);f.propTypes=p,t.default=f},2223:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(2),f={children:d.default.oneOfType([d.default.array,d.default.object]).isRequired},h=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){return u.default.createElement("div",{className:"main-panel-center"},u.default.createElement("div",{className:"cur-view-container"},u.default.createElement("div",{className:"cur-view-path"},u.default.createElement("div",{className:"path-container"},u.default.createElement("h3",{className:"sf-heading"},(0,p.gettext)("Drafts")))),this.props.children))}}]),t}(u.default.Component);h.propTypes=f,t.default=h},2224:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(2),d=n(386),p=r(d),f=n(3),h=n(1),m=r(h),g=n(5),y=r(g),v=n(39),b=r(v),w=n(8),E=r(w),S=n(2225),C=r(S),D={isLoadingDraft:m.default.bool.isRequired,updateDraftsList:m.default.func.isRequired,draftList:m.default.array.isRequired,getDrafts:m.default.func.isRequired},_=function(e){function t(){var e,n,r,i;a(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=r=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),r.onDeleteHandler=function(e){var t=f.Utils.getFileName(e.draft_file_path);p.default.deleteDraft(e.id).then(function(n){r.props.updateDraftsList(e.id);var a=(0,c.gettext)("Successfully deleted draft %(draft)s.");a=a.replace("%(draft)s",t),y.default.success(a)}).catch(function(){var e=(0,c.gettext)("Failed to delete draft %(draft)s.");e=e.replace("%(draft)s",t),y.default.danger(e)})},r.onPublishHandler=function(e){var t=f.Utils.getFileName(e.draft_file_path);p.default.publishDraft(e.id).then(function(n){r.props.updateDraftsList(e.id);var a=(0,c.gettext)("Successfully published draft %(draft)s.");a=a.replace("%(draft)s",t),y.default.success(a)}).catch(function(){var e=(0,c.gettext)("Failed to publish draft %(draft)s.");e=e.replace("%(draft)s",t),y.default.danger(e)})},i=n,o(r,i)}return i(t,e),s(t,[{key:"componentDidMount",value:function(){this.props.getDrafts()}},{key:"render",value:function(){return u.default.createElement("div",{className:"cur-view-content"},this.props.isLoadingDraft&&u.default.createElement(E.default,null),!this.props.isLoadingDraft&&u.default.createElement(l.Fragment,null,0===this.props.draftList.length&&u.default.createElement(b.default,null,u.default.createElement("h2",null,(0,c.gettext)("No draft yet")),u.default.createElement("p",null,(0,c.gettext)("Draft is a way to let you collaborate with others on files. You can create a draft from a file, edit the draft and then ask for a review. The original file will be updated only after the draft has been reviewed."))),0!==this.props.draftList.length&&u.default.createElement(C.default,{draftList:this.props.draftList,onDeleteHandler:this.onDeleteHandler,onPublishHandler:this.onPublishHandler})))}}]),t}(u.default.Component);_.propTypes=D,t.default=_},2225:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(2),f=n(2226),h=r(f),m={draftList:d.default.array.isRequired,onDeleteHandler:d.default.func.isRequired,onPublishHandler:d.default.func.isRequired},g=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.state={isItemFreezed:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this,t=this.props.draftList;return u.default.createElement("table",null,u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{style:{width:"4%"}}),u.default.createElement("th",{style:{width:"46%"}},(0,p.gettext)("Name")),u.default.createElement("th",{style:{width:"30%"}},(0,p.gettext)("Library")),u.default.createElement("th",{style:{width:"10%"}},(0,p.gettext)("Last Update")),u.default.createElement("th",{style:{width:"10%"}}))),u.default.createElement("tbody",null,t&&t.map(function(t){return u.default.createElement(h.default,{key:t.id,draft:t,isItemFreezed:e.state.isItemFreezed,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem,onDeleteHandler:e.props.onDeleteHandler,onPublishHandler:e.props.onPublishHandler})})))}}]),t}(u.default.Component);g.propTypes=m,t.default=g},2226:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(7),d=r(c),p=n(1),f=r(p),h=n(6),m=n(2),g=n(3);d.default.locale(m.lang);var y={draft:f.default.object.isRequired,isItemFreezed:f.default.bool.isRequired,onFreezedItem:f.default.func.isRequired,onUnfreezedItem:f.default.func.isRequired,onDeleteHandler:f.default.func.isRequired,onPublishHandler:f.default.func.isRequired},v=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseEnter=function(){n.props.isItemFreezed||n.setState({isMenuIconShow:!0,highlight:!0})},n.onMouseLeave=function(){n.props.isItemFreezed||n.setState({isMenuIconShow:!1,highlight:!1})},n.onDropdownToggleClick=function(e){e.preventDefault(),n.toggleOperationMenu(e)},n.toggleOperationMenu=function(e){e.stopPropagation(),n.setState({isItemMenuShow:!n.state.isItemMenuShow},function(){n.state.isItemMenuShow?n.props.onFreezedItem():(n.setState({highlight:!1,isMenuIconShow:!1}),n.props.onUnfreezedItem())})},n.onDeleteHandler=function(){n.props.onDeleteHandler(n.props.draft)},n.onPublishHandler=function(){n.props.onPublishHandler(n.props.draft)},n.state={isMenuIconShow:!1,isItemMenuShow:!1,highlight:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.draft,t=e.origin_repo_id,n=e.draft_file_path,r=g.Utils.getFileName(n),a=m.siteRoot+"drafts/"+e.id+"/",o=m.siteRoot+"library/"+t+"/"+encodeURIComponent(e.repo_name)+"/",i=d.default.utc(e.updated_at).toDate();i=(0,d.default)(i).fromNow();var s=g.Utils.getFileIconUrl(r);return u.default.createElement("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},u.default.createElement("td",{className:"text-center"},u.default.createElement("img",{src:s,width:"24",alt:""})),u.default.createElement("td",{className:"name"},u.default.createElement("a",{href:a,target:"_blank"},r)),u.default.createElement("td",{className:"library"},u.default.createElement("a",{href:o,target:"_blank"},e.repo_name)),u.default.createElement("td",{className:"update"},i),u.default.createElement("td",{className:"text-center"},this.state.isMenuIconShow&&u.default.createElement(h.Dropdown,{isOpen:this.state.isItemMenuShow,toggle:this.toggleOperationMenu},u.default.createElement(h.DropdownToggle,{tag:"i",className:"fas fa-ellipsis-v attr-action-icon",title:(0,m.gettext)("More Operations"),onClick:this.onDropdownToggleClick,"data-toggle":"dropdown","aria-expanded":this.state.isItemMenuShow}),u.default.createElement(h.DropdownMenu,null,u.default.createElement(h.DropdownItem,{onClick:this.onDeleteHandler},(0,m.gettext)("Delete")),"open"==e.status&&u.default.createElement(h.DropdownItem,{onClick:this.onPublishHandler},(0,m.gettext)("Publish"))))))}}]),t}(u.default.Component);v.propTypes=y,t.default=v},2227:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function s(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=r(u),d=n(1),p=r(d),f=n(7),h=r(f),m=n(4),g=n(2),y=n(3),v=n(8),b=r(v),w=n(2228),E=r(w),S=n(2229),C=r(S),D=n(13),_=r(D);n(2230),h.default.locale(window.app.config.lang);var P={isLoadingMore:p.default.bool.isRequired,items:p.default.array.isRequired},k=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),l(t,[{key:"render",value:function(){var e=y.Utils.isDesktop(),t=this.props,n=t.items,r=t.isLoadingMore,a=c.default.createElement("thead",null,c.default.createElement("tr",null,c.default.createElement("th",{width:"8%"}),c.default.createElement("th",{width:"15%"},(0,g.gettext)("User")),c.default.createElement("th",{width:"20%"},(0,g.gettext)("Operation")),c.default.createElement("th",{width:"37%"},(0,g.gettext)("File")," / ",(0,g.gettext)("Library")),c.default.createElement("th",{width:"20%"},(0,g.gettext)("Time")))),o=c.default.createElement("thead",null,c.default.createElement("tr",null,c.default.createElement("th",{width:"15%"}),c.default.createElement("th",{width:"53%"}),c.default.createElement("th",{width:"32%"})));return c.default.createElement(u.Fragment,null,c.default.createElement("table",{className:"table-hover table-thead-hidden"},e?a:o,c.default.createElement("tbody",null,n.map(function(t,r){return c.default.createElement(O,{key:r,isDesktop:e,item:t,index:r,items:n})}))),r?c.default.createElement("span",{className:"loading-icon loading-tip"}):"")}}]),t}(u.Component);k.propTypes=P;var M={item:p.default.object.isRequired,index:p.default.number.isRequired,items:p.default.array.isRequired},O=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onListCreatedFilesToggle=function(){n.setState({isListCreatedFiles:!n.state.isListCreatedFiles})},n.state={isListCreatedFiles:!1},n}return s(t,e),l(t,[{key:"render",value:function(){var e=this.props.isDesktop,t=this.props,n=t.item,r=t.index,a=t.items,o=void 0,i=void 0,s=!1,l=g.siteRoot+"profile/"+encodeURIComponent(n.author_email)+"/",d=g.siteRoot+"library/"+n.repo_id+"/"+encodeURIComponent(n.repo_name)+"/",p=c.default.createElement("a",{href:d},n.repo_name),f=c.default.createElement("a",{className:"small text-secondary",href:d},n.repo_name);if("repo"==n.obj_type)switch(n.op_type){case"create":o=(0,g.gettext)("Created library"),i=p;break;case"rename":o=(0,g.gettext)("Renamed library"),i=c.default.createElement("span",null,n.old_repo_name," => ",p);break;case"delete":o=(0,g.gettext)("Deleted library"),i=n.repo_name;break;case"recover":o=(0,g.gettext)("Restored library"),i=p;break;case"clean-up-trash":o=(0,g.gettext)("Cleaned trash"),i=0==n.days?(0,g.gettext)("Removed all items from trash."):(0,g.gettext)("Removed items older than {n} days from trash.").replace("{n}",n.days),s=!0}else if("draft"==n.obj_type){var m=g.siteRoot+"lib/"+n.repo_id+"/file"+y.Utils.encodePath(n.path),v=c.default.createElement("a",{href:m,target:"_blank"},n.name);o=(0,g.gettext)("Publish draft"),i=v,s=!0}else if("files"==n.obj_type){var b=g.siteRoot+"lib/"+n.repo_id+"/file"+y.Utils.encodePath(n.path);n.name.endsWith("(draft).md")&&(b=g.serviceURL+"/drafts/"+n.draft_id+"/");var w="<a href="+b+' target="_blank">'+n.name+"</a>";n.name.endsWith("(draft).md")&&!n.draft_id&&(w=n.name);var E=n.createdFilesCount-1,S=(0,g.gettext)("{file} and {n} other files").replace("{file}",w).replace("{n}",E);o=(0,g.gettext)("Created {n} files").replace("{n}",n.createdFilesCount),i=c.default.createElement(u.Fragment,null,c.default.createElement("p",{className:"m-0 d-inline",dangerouslySetInnerHTML:{__html:S}}),e&&c.default.createElement("span",{onClick:this.onListCreatedFilesToggle,className:"activity-details text-secondary ml-2"},(0,g.gettext)("details"))),s=!0}else if("file"==n.obj_type){var D=n.name.endsWith("(draft).md"),P=D?g.serviceURL+"/drafts/"+n.draft_id+"/":g.siteRoot+"lib/"+n.repo_id+"/file"+y.Utils.encodePath(n.path),k=c.default.createElement("a",{href:P,target:"_blank"},n.name);switch(D&&!n.draft_id&&(k=n.name),n.op_type){case"create":o=D?(0,g.gettext)("Created draft"):(0,g.gettext)("Created file"),i=k,s=!0;break;case"delete":o=D?(0,g.gettext)("Deleted draft"):(0,g.gettext)("Deleted file"),i=n.name,s=!0;break;case"recover":o=(0,g.gettext)("Restored file"),i=k,s=!0;break;case"rename":o=(0,g.gettext)("Renamed file"),i=c.default.createElement("span",null,n.old_name," => ",k),s=!0;break;case"move":var M=c.default.createElement("a",{href:P},n.path);o=(0,g.gettext)("Moved file"),i=c.default.createElement("span",null,n.old_path," => ",M),s=!0;break;case"edit":o=D?(0,g.gettext)("Updated draft"):(0,g.gettext)("Updated file"),i=k,s=!0}}else{var O=g.siteRoot+"library/"+n.repo_id+"/"+encodeURIComponent(n.repo_name)+y.Utils.encodePath(n.path),L=c.default.createElement("a",{href:O,target:"_blank"},n.name);switch(n.op_type){case"create":o=(0,g.gettext)("Created folder"),i=L,s=!0;break;case"delete":o=(0,g.gettext)("Deleted folder"),i=n.name,s=!0;break;case"recover":o=(0,g.gettext)("Restored folder"),i=L,s=!0;break;case"rename":o=(0,g.gettext)("Renamed folder"),i=c.default.createElement("span",null,n.old_name," => ",L),s=!0;break;case"move":var I=c.default.createElement("a",{href:O},n.path);o=(0,g.gettext)("Moved folder"),i=c.default.createElement("span",null,n.old_path," => ",I),s=!0}}var T=!0;if(r>0){var R=a[r-1].time;T=!(0,h.default)(n.time).isSame(R,"day")}return c.default.createElement(u.Fragment,null,T&&c.default.createElement("tr",null,c.default.createElement("td",{colSpan:e?5:3,className:"border-top-0"},(0,h.default)(n.time).format("YYYY-MM-DD"))),e?c.default.createElement("tr",null,c.default.createElement("td",{className:"text-center"},c.default.createElement("img",{src:n.avatar_url,alt:"",width:"32",height:"32",className:"avatar"})),c.default.createElement("td",null,c.default.createElement("a",{href:l},n.author_name)),c.default.createElement("td",null,o),c.default.createElement("td",null,i,s&&c.default.createElement("br",null),s&&f),c.default.createElement("td",{className:"text-secondary"},c.default.createElement("time",{datetime:n.time,is:"relative-time",title:(0,h.default)(n.time).format("llll")},(0,h.default)(n.time).fromNow()))):c.default.createElement("tr",null,c.default.createElement("td",{className:"text-center align-top"},c.default.createElement("img",{src:n.avatar_url,alt:"",width:"32",height:"32",className:"avatar"})),c.default.createElement("td",null,c.default.createElement("a",{href:l},n.author_name),c.default.createElement("p",{className:"m-0 text-secondary"},o),i),c.default.createElement("td",{className:"text-right align-top"},c.default.createElement("span",{className:"text-secondary mobile-activity-time"},c.default.createElement("time",{datetime:n.time,is:"relative-time",title:(0,h.default)(n.time).format("llll")},(0,h.default)(n.time).fromNow())),s&&c.default.createElement("br",null),s&&p)),this.state.isListCreatedFiles&&c.default.createElement(_.default,null,c.default.createElement(C.default,{activity:n,toggleCancel:this.onListCreatedFilesToggle})))}}]),t}(u.Component);O.propTypes=M;var L=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.mergePublishEvents=function(e){e.map(function(e){"publish"===e.op_type&&(n.curPathList.push(e.path),n.oldPathList.push(e.old_path))});for(var t=[],r=0;r<e.length;r++)"file"===e[r].obj_type?"delete"===e[r].op_type&&n.oldPathList.includes(e[r].path)?n.oldPathList.splice(n.oldPathList.indexOf(e[r].path),1):"edit"===e[r].op_type&&n.curPathList.includes(e[r].path)?n.curPathList.splice(n.curPathList.indexOf(e[r].path),1):"rename"===e[r].op_type&&n.oldPathList.includes(e[r].old_path)?n.oldPathList.splice(n.oldPathList.indexOf(e[r].old_path),1):t.push(e[r]):t.push(e[r]);return t},n.mergeFileCreateEvents=function(e){for(var t=[],n=null,r=0;r<e.length;r++){var a="file"===e[r].obj_type&&"create"===e[r].op_type&&e[r+1]&&"file"===e[r+1].obj_type&&"create"===e[r+1].op_type&&e[r+1].repo_name===e[r].repo_name&&e[r+1].author_email===e[r].author_email;if(null!=n){if(n.createdFilesCount++,n.createdFilesList.push(e[r]),a)continue;t.push(n),n=null}else a?(n=new E.default(e[r]),n.obj_type="files",n.createdFilesCount++,n.createdFilesList.push(e[r])):t.push(e[r])}return t},n.handleScroll=function(e){if(!n.state.isLoadingMore&&n.state.hasMore){var t=e.target.clientHeight,r=e.target.scrollHeight;t+e.target.scrollTop+1>=r&&n.setState({isLoadingMore:!0},function(){n.getMore()})}},n.state={errorMsg:"",isFirstLoading:!0,isLoadingMore:!1,currentPage:1,hasMore:!0,items:[]},n.avatarSize=72,n.curPathList=[],n.oldPathList=[],n}return s(t,e),l(t,[{key:"componentDidMount",value:function(){var e=this,t=this.state.currentPage;m.seafileAPI.listActivities(t,this.avatarSize).then(function(n){var r=e.mergePublishEvents(n.data.events);r=e.mergeFileCreateEvents(r),e.setState({items:r,currentPage:t+1,isFirstLoading:!1,hasMore:!0}),e.state.items.length<25&&e.getMore()}).catch(function(t){e.setState({isFirstLoading:!1,errorMsg:y.Utils.getErrorMsg(t,!0)})})}},{key:"getMore",value:function(){var e=this,t=this.state.currentPage;m.seafileAPI.listActivities(t,this.avatarSize).then(function(n){var r=e.mergePublishEvents(n.data.events);r=e.mergeFileCreateEvents(r),e.setState({isLoadingMore:!1,items:[].concat(a(e.state.items),a(r)),currentPage:t+1,hasMore:0!==n.data.events.length}),e.state.items.length<25&&e.state.hasMore&&e.getMore()}).catch(function(t){e.setState({isLoadingMore:!1,errorMsg:y.Utils.getErrorMsg(t,!0)})})}},{key:"render",value:function(){return c.default.createElement("div",{className:"main-panel-center"},c.default.createElement("div",{className:"cur-view-container",id:"activities"},c.default.createElement("div",{className:"cur-view-path"},c.default.createElement("h3",{className:"sf-heading"},(0,g.gettext)("Activities"))),c.default.createElement("div",{className:"cur-view-content d-block",onScroll:this.handleScroll},this.state.isFirstLoading&&c.default.createElement(b.default,null),!this.state.isFirstLoading&&this.state.errorMsg&&c.default.createElement("p",{className:"error text-center"},this.state.errorMsg),!this.state.isFirstLoading&&c.default.createElement(k,{items:this.state.items,isLoadingMore:this.state.isLoadingMore}))))}}]),t}(u.Component);t.default=L},2228:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function e(t){r(this,e),this.repo_id=t.repo_id,this.repo_name=t.repo_name,this.obj_type=t.obj_type,this.commit_id=t.commit_id,this.path=t.path,this.name=t.name,this.author_email=t.author_email,this.author_name=t.author_name,this.author_contact_email=t.author_contact_email,this.avatar_url=t.avatar_url,this.time=t.time,this.op_type=t.op_type,this.createdFilesCount=0,this.createdFilesList=[],"clean-up-trash"===t.op_type?this.days=t.days:"rename"===t.op_type&&"repo"===t.obj_type?this.old_repo_name=t.old_repo_name:"move"===t.op_type&&["dir","file"].includes(t.obj_type)?this.old_path=t.old_path:"rename"===t.op_type&&["dir","file"].includes(t.obj_type)?(this.old_path=t.old_path,this.old_name=t.old_name):"publish"===t.op_type?this.old_path=t.old_path:t.name.endsWith("(draft).md")&&(this.draft_id=t.draft_id)};t.default=a},2229:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(7),f=r(p),h=n(6),m=n(2),g=n(3),y={activity:d.default.object.isRequired,toggleCancel:d.default.func.isRequired},v=function(e){function t(){var e,n,r,i;a(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=r=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),r.toggle=function(e){r.props.toggleCancel(e)},i=n,o(r,i)}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.activity;return u.default.createElement(h.Modal,{isOpen:!0},u.default.createElement(h.ModalHeader,{toggle:this.toggle},(0,m.gettext)("Created Files")),u.default.createElement(h.ModalBody,null,u.default.createElement(h.Table,null,u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:"75%"},(0,m.gettext)("Name")),u.default.createElement("th",{width:"25%"},(0,m.gettext)("Time")))),u.default.createElement("tbody",null,e.createdFilesList.map(function(e,t){var n=m.siteRoot+"lib/"+e.repo_id+"/file"+g.Utils.encodePath(e.path);e.name.endsWith("(draft).md")&&(n=m.serviceURL+"/drafts/"+e.draft_id+"/");var r=u.default.createElement("a",{href:n,target:"_blank"},e.name);return e.name.endsWith("(draft).md")&&!e.draft_id&&(r=e.name),u.default.createElement("tr",{key:t},u.default.createElement("td",null,r),u.default.createElement("td",null,(0,f.default)(e.time).fromNow()))})))),u.default.createElement(h.ModalFooter,null,u.default.createElement(h.Button,{color:"secondary",onClick:this.toggle.bind(this,e)},(0,m.gettext)("Close"))))}}]),t}(u.default.Component);v.propTypes=y,t.default=v},2230:function(e,t){},2231:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(6),d=n(15),p=n(7),f=r(p),h=n(4),m=n(3),g=n(2),y=n(39),v=r(y),b=n(8),w=r(b),E=n(5),S=r(E),C=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.data,t=e.loading,n=e.errorMsg,r=e.items;if(t)return u.default.createElement(w.default,null);if(n)return u.default.createElement("p",{className:"error text-center"},n);var a=u.default.createElement(v.default,null,u.default.createElement("h2",null,(0,g.gettext)("No favorites")),u.default.createElement("p",null,(0,g.gettext)("You have not added any libraries, folders or files to your favorites yet. A favorite gives you quick access to your most frequently used objects. You can add a library, folder or file to your favorites by clicking the star to the left of its name."))),o=u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:"4%"}),u.default.createElement("th",{width:"40%"},(0,g.gettext)("Name")),u.default.createElement("th",{width:"32%"},(0,g.gettext)("Library")),u.default.createElement("th",{width:"18%"},(0,g.gettext)("Last Update")),u.default.createElement("th",{width:"6%"}))),i=u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:"12%"}),u.default.createElement("th",{width:"80%"}),u.default.createElement("th",{width:"8%"}))),s=m.Utils.isDesktop();return r.length?u.default.createElement("table",{className:"table-hover "+(s?"":"table-thead-hidden")},s?o:i,u.default.createElement(D,{items:r})):a}}]),t}(l.Component),D=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={items:n.props.items},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){this.getThumbnails()}},{key:"getThumbnails",value:function(){var e=this.state.items.filter(function(e){return m.Utils.imageCheck(e.obj_name)&&!e.repo_encrypted});if(0!=e.length){var t=e.length,n=this;!function r(a){var o=e[a];h.seafileAPI.createThumbnail(o.repo_id,o.path,48).then(function(e){o.encoded_thumbnail_src=e.data.encoded_thumbnail_src}).catch(function(e){}).then(function(){a<t-1?r(++a):n.setState({items:n.state.items})})}(0)}}},{key:"render",value:function(){var e=this.state.items.map(function(e,t){return"/"===e.path?e.item_icon_url=m.Utils.getDefaultLibIconUrl(!1):e.item_icon_url=e.is_dir?m.Utils.getFolderIconUrl(!1):m.Utils.getFileIconUrl(e.obj_name),e.encoded_path=m.Utils.encodePath(e.path),e.thumbnail_url=e.encoded_thumbnail_src?""+g.siteRoot+e.encoded_thumbnail_src:"",e.dirent_view_url=e.is_dir?g.siteRoot+"library/"+e.repo_id+"/"+e.repo_name+e.encoded_path:g.siteRoot+"lib/"+e.repo_id+"/file"+e.encoded_path,e.mtime_relative=(0,f.default)(e.mtime).fromNow(),u.default.createElement(_,{key:t,data:e})},this);return u.default.createElement("tbody",null,e)}}]),t}(l.Component),_=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleOpMenu=function(){n.setState({isOpMenuOpen:!n.state.isOpMenuOpen})},n.handleMouseOver=function(){n.setState({showOpIcon:!0})},n.handleMouseOut=function(){n.setState({showOpIcon:!1})},n.unstar=function(e){e.preventDefault();var t=n.props.data;h.seafileAPI.unstarItem(t.repo_id,t.path).then(function(e){n.setState({unstarred:!0})}).catch(function(e){var t=m.Utils.getErrorMsg(e);S.default.danger(t)})},n.visitItem=function(){var e=n.props.data;e.is_dir?(0,d.navigate)(e.dirent_view_url):window.open(e.dirent_view_url)},n.state={showOpIcon:!1,unstarred:!1,isOpMenuOpen:!1},n}return i(t,e),s(t,[{key:"render",value:function(){if(this.state.unstarred)return null;var e=this.props.data,t="sf2-icon-x3 unstar action-icon";t+=this.state.showOpIcon?"":" invisible";var n=u.default.createElement("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut},u.default.createElement("td",{className:"text-center"},e.thumbnail_url?u.default.createElement("img",{className:"thumbnail",src:e.thumbnail_url,alt:""}):u.default.createElement("img",{src:e.item_icon_url,alt:(0,g.gettext)("icon"),width:"24"})),u.default.createElement("td",null,e.is_dir?u.default.createElement(d.Link,{to:e.dirent_view_url},e.obj_name):u.default.createElement("a",{className:"normal",href:e.dirent_view_url,target:"_blank"},e.obj_name)),u.default.createElement("td",null,e.repo_name),u.default.createElement("td",{dangerouslySetInnerHTML:{__html:e.mtime_relative}}),u.default.createElement("td",null,u.default.createElement("a",{href:"#",className:t,title:(0,g.gettext)("Unstar"),"aria-label":(0,g.gettext)("Unstar"),onClick:this.unstar}))),r=u.default.createElement("tr",null,u.default.createElement("td",{className:"text-center",onClick:this.visitItem},e.thumbnail_url?u.default.createElement("img",{className:"thumbnail",src:e.thumbnail_url,alt:""}):u.default.createElement("img",{src:e.item_icon_url,alt:(0,g.gettext)("icon"),width:"24"})),u.default.createElement("td",{onClick:this.visitItem},e.is_dir?u.default.createElement(d.Link,{to:e.dirent_view_url},e.obj_name):u.default.createElement("a",{className:"normal",href:e.dirent_view_url,target:"_blank"},e.obj_name),u.default.createElement("br",null),u.default.createElement("span",{className:"item-meta-info"},e.repo_name),u.default.createElement("span",{className:"item-meta-info",dangerouslySetInnerHTML:{__html:e.mtime_relative}})),u.default.createElement("td",null,u.default.createElement(c.Dropdown,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu},u.default.createElement(c.DropdownToggle,{tag:"i",className:"sf-dropdown-toggle fa fa-ellipsis-v ml-0",title:(0,g.gettext)("More Operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),u.default.createElement("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu},u.default.createElement("div",{className:"mobile-operation-menu-bg-layer"}),u.default.createElement("div",{className:"mobile-operation-menu"},u.default.createElement(c.DropdownItem,{className:"mobile-menu-item",onClick:this.unstar},(0,g.gettext)("Unstar")))))));return m.Utils.isDesktop()?n:r}}]),t}(l.Component),P=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={loading:!0,errorMsg:"",items:[]},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;h.seafileAPI.listStarredItems().then(function(t){e.setState({loading:!1,items:t.data.starred_item_list})}).catch(function(t){e.setState({loading:!1,errorMsg:m.Utils.getErrorMsg(t,!0)})})}},{key:"render",value:function(){return u.default.createElement("div",{className:"main-panel-center"},u.default.createElement("div",{className:"cur-view-container",id:"starred"},u.default.createElement("div",{className:"cur-view-path"},u.default.createElement("h3",{className:"sf-heading"},(0,g.gettext)("Favorites"))),u.default.createElement("div",{className:"cur-view-content"},u.default.createElement(C,{data:this.state}))))}}]),t}(l.Component);t.default=P},2232:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(6),d=n(7),p=r(d),f=n(4),h=n(2),m=n(5),g=r(m),y=n(39),v=r(y),b=n(2233),w=r(b),E=n(3),S=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.data,t=e.loading,n=e.errorMsg,r=e.items;if(t)return u.default.createElement("span",{className:"loading-icon loading-tip"});if(n)return u.default.createElement("p",{className:"error text-center"},n);var a=u.default.createElement(v.default,null,u.default.createElement("h2",null,(0,h.gettext)("No linked devices")),u.default.createElement("p",null,(0,h.gettext)("You have not accessed your files with any client (desktop or mobile) yet. Configure clients on your devices to access your data more comfortably."))),o=u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:"13%"},(0,h.gettext)("Platform")),u.default.createElement("th",{width:"30%"},(0,h.gettext)("Device Name")),u.default.createElement("th",{width:"30%"},(0,h.gettext)("IP")),u.default.createElement("th",{width:"17%"},(0,h.gettext)("Last Access")),u.default.createElement("th",{width:"10%"}))),i=u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:"92%"}),u.default.createElement("th",{width:"8%"}))),s=E.Utils.isDesktop();return r.length?u.default.createElement("table",{className:"table-hover "+(s?"":"table-thead-hidden")},s?o:i,u.default.createElement("tbody",null,r.map(function(e,t){return u.default.createElement(C,{key:t,data:e,isDesktop:s})}))):a}}]),t}(l.Component),C=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleOpMenu=function(){n.setState({isOpMenuOpen:!n.state.isOpMenuOpen})},n.handleMouseOver=function(){n.setState({isOpIconShown:!0})},n.handleMouseOut=function(){n.setState({isOpIconShown:!1})},n.toggleDialog=function(){n.setState({isConfirmUnlinkDialogOpen:!n.state.isConfirmUnlinkDialogOpen})},n.handleClick=function(e){(e.preventDefault(),n.props.data.is_desktop_client)?n.toggleDialog():n.unlinkDevice(!0)},n.unlinkDevice=function(e){var t=n.props.data;f.seafileAPI.unlinkDevice(t.platform,t.device_id,e).then(function(e){n.setState({unlinked:!0});var r=(0,h.gettext)("Successfully unlinked %(name)s.");r=r.replace("%(name)s",t.device_name),g.default.success(r)}).catch(function(e){var t=E.Utils.getErrorMsg(e);g.default.danger(t)})},n.state={isOpMenuOpen:!1,isOpIconShown:!1,unlinked:!1,isConfirmUnlinkDialogOpen:!1},n}return i(t,e),s(t,[{key:"render",value:function(){if(this.state.unlinked)return null;var e=this.props.data,t="sf2-icon-delete unlink-device action-icon";t+=this.state.isOpIconShown?"":" invisible";var n=u.default.createElement("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut},u.default.createElement("td",null,e.platform),u.default.createElement("td",null,e.device_name),u.default.createElement("td",null,e.last_login_ip),u.default.createElement("td",null,(0,p.default)(e.last_accessed).fromNow()),u.default.createElement("td",null,u.default.createElement("a",{href:"#",className:t,title:(0,h.gettext)("Unlink"),"aria-label":(0,h.gettext)("Unlink"),onClick:this.handleClick}))),r=u.default.createElement("tr",null,u.default.createElement("td",null,e.device_name,u.default.createElement("br",null),u.default.createElement("span",{className:"item-meta-info"},e.last_login_ip),u.default.createElement("span",{className:"item-meta-info"},(0,p.default)(e.last_accessed).fromNow()),u.default.createElement("span",{className:"item-meta-info"},e.platform)),u.default.createElement("td",null,u.default.createElement(c.Dropdown,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu},u.default.createElement(c.DropdownToggle,{tag:"i",className:"sf-dropdown-toggle fa fa-ellipsis-v ml-0",title:(0,h.gettext)("More Operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),u.default.createElement("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu},u.default.createElement("div",{className:"mobile-operation-menu-bg-layer"}),u.default.createElement("div",{className:"mobile-operation-menu"},u.default.createElement(c.DropdownItem,{className:"mobile-menu-item",onClick:this.handleClick},(0,h.gettext)("Unlink")))))));return u.default.createElement(u.default.Fragment,null,this.props.isDesktop?n:r,this.state.isConfirmUnlinkDialogOpen&&u.default.createElement(w.default,{executeOperation:this.unlinkDevice,toggleDialog:this.toggleDialog}))}}]),t}(l.Component),D=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={loading:!0,errorMsg:"",items:[]},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;f.seafileAPI.listLinkedDevices().then(function(t){e.setState({loading:!1,items:t.data})}).catch(function(t){e.setState({loading:!1,errorMsg:E.Utils.getErrorMsg(t,!0)})})}},{key:"render",value:function(){return u.default.createElement("div",{className:"main-panel-center"},u.default.createElement("div",{className:"cur-view-container",id:"linked-devices"},u.default.createElement("div",{className:"cur-view-path"},u.default.createElement("h3",{className:"sf-heading"},(0,h.gettext)("Linked Devices"))),u.default.createElement("div",{className:"cur-view-content"},u.default.createElement(S,{data:this.state}))))}}]),t}(l.Component);t.default=D},2233:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(2),h={executeOperation:d.default.func.isRequired,toggleDialog:d.default.func.isRequired},m=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggle=function(){n.props.toggleDialog()},n.executeOperation=function(){n.toggle(),n.props.executeOperation(n.state.isChecked)},n.onInputChange=function(e){n.setState({isChecked:e.target.checked})},n.state={isChecked:!1},n}return i(t,e),s(t,[{key:"render",value:function(){return u.default.createElement(p.Modal,{isOpen:!0,toggle:this.toggle},u.default.createElement(p.ModalHeader,{toggle:this.toggle},(0,f.gettext)("Unlink device")),u.default.createElement(p.ModalBody,null,u.default.createElement("p",null,(0,f.gettext)("Are you sure you want to unlink this device?")),u.default.createElement(p.FormGroup,{check:!0},u.default.createElement(p.Label,{check:!0},u.default.createElement(p.Input,{type:"checkbox",checked:this.state.isChecked,onChange:this.onInputChange}),u.default.createElement("span",null,(0,f.gettext)("Delete files from this device the next time it comes online."))))),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{color:"secondary",onClick:this.toggle},(0,f.gettext)("Cancel")),u.default.createElement(p.Button,{color:"primary",onClick:this.executeOperation},(0,f.gettext)("Unlink"))))}}]),t}(l.Component);m.propTypes=h,t.default=m},2234:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(15),d=n(6),p=n(4),f=n(2),h=n(3),m=n(5),g=r(m),y=n(39),v=r(y),b=n(53),w=r(b),E=n(2235),S=r(E),C=n(1309),D=r(C),_=function(e){function t(){var e,n,r,i;a(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=r=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),r.sortByName=function(e){e.preventDefault();var t="asc"==r.props.sortOrder?"desc":"asc";r.props.sortItems("name",t)},i=n,o(r,i)}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg,r=e.items,a=e.sortBy,o=e.sortOrder;if(t)return u.default.createElement("span",{className:"loading-icon loading-tip"});if(n)return u.default.createElement("p",{className:"error text-center"},n);var i=u.default.createElement(v.default,null,u.default.createElement("h2",null,(0,f.gettext)("No libraries shared")),u.default.createElement("p",null,(0,f.gettext)('You have not shared any libraries with other users yet. You can share a library with other users by clicking the share icon to the right of a library\'s name in "My Libraries".'))),s="name"==a,l="asc"==o?u.default.createElement("span",{className:"fas fa-caret-up"}):u.default.createElement("span",{className:"fas fa-caret-down"}),c=h.Utils.isDesktop(),d=u.default.createElement("table",{className:"table-hover "+(c?"":"table-thead-hidden")},u.default.createElement("thead",null,c?u.default.createElement("tr",null,u.default.createElement("th",{width:"4%"}),u.default.createElement("th",{width:"34%"},u.default.createElement("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByName},(0,f.gettext)("Name")," ",s&&l)),u.default.createElement("th",{width:"30%"},(0,f.gettext)("Share To")),u.default.createElement("th",{width:"24%"},(0,f.gettext)("Permission")),u.default.createElement("th",{width:"8%"})):u.default.createElement("tr",null,u.default.createElement("th",{width:"12%"}),u.default.createElement("th",{width:"80%"}),u.default.createElement("th",{width:"8%"}))),u.default.createElement("tbody",null,r.map(function(e,t){return u.default.createElement(P,{key:t,isDesktop:c,item:e})})));return r.length?d:i}}]),t}(l.Component),P=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));k.call(n);var r=n.props.item;n.state={share_permission:r.share_permission,is_admin:r.is_admin,isOpIconShown:!1,isOpMenuOpen:!1,isPermSelectDialogOpen:!1,unshared:!1};var i=["rw","r"];return n.permissions=i,n.showAdmin=f.isPro&&"public"!==r.share_type,n.showAdmin&&i.push("admin"),f.isPro&&i.push("cloud-edit","preview"),n}return i(t,e),s(t,[{key:"render",value:function(){if(this.state.unshared)return null;var e=this.state,t=e.share_permission,n=e.is_admin,r=e.isOpIconShown,a=e.isPermSelectDialogOpen,o=this.props.item;Object.assign(o,{share_permission:t,is_admin:n});var i=h.Utils.getLibIconUrl(o),s=h.Utils.getLibIconTitle(o),p=f.siteRoot+"library/"+o.repo_id+"/"+encodeURIComponent(o.repo_name)+"/",m=void 0,g=o.share_type;"personal"==g?m=o.user_name:"group"==g?m=o.group_name:"public"==g&&(m=(0,f.gettext)("all members")),this.showAdmin&&n&&(t="admin");var y=u.default.createElement("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},u.default.createElement("td",null,u.default.createElement("img",{src:i,title:s,alt:s,width:"24"})),u.default.createElement("td",null,u.default.createElement(c.Link,{to:p},o.repo_name)),u.default.createElement("td",null,"personal"==o.share_type?u.default.createElement("span",{title:o.contact_email},m):m),u.default.createElement("td",null,u.default.createElement(w.default,{isTextMode:!0,isEditIconShow:this.state.isOpIconShown,currentPermission:t,permissions:this.permissions,onPermissionChanged:this.changePerm})),u.default.createElement("td",null,u.default.createElement("a",{href:"#",className:"action-icon sf2-icon-x3 "+(r?"":"invisible"),title:(0,f.gettext)("Unshare"),onClick:this.unshare}))),v=u.default.createElement(l.Fragment,null,u.default.createElement("tr",null,u.default.createElement("td",null,u.default.createElement("img",{src:i,title:s,alt:s,width:"24"})),u.default.createElement("td",null,u.default.createElement(c.Link,{to:p},o.repo_name),u.default.createElement("span",{className:"item-meta-info-highlighted"},h.Utils.sharePerms(t)),u.default.createElement("br",null),u.default.createElement("span",{className:"item-meta-info"},(0,f.gettext)("Share To:")+" "+m)),u.default.createElement("td",null,u.default.createElement(d.Dropdown,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu},u.default.createElement(d.DropdownToggle,{tag:"i",className:"sf-dropdown-toggle fa fa-ellipsis-v ml-0",title:(0,f.gettext)("More Operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),u.default.createElement("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu},u.default.createElement("div",{className:"mobile-operation-menu-bg-layer"}),u.default.createElement("div",{className:"mobile-operation-menu"},u.default.createElement(d.DropdownItem,{className:"mobile-menu-item",onClick:this.togglePermSelectDialog},(0,f.gettext)("Permission")),u.default.createElement(d.DropdownItem,{className:"mobile-menu-item",onClick:this.unshare},(0,f.gettext)("Unshare"))))))),a&&u.default.createElement(D.default,{currentPerm:t,permissions:this.permissions,changePerm:this.changePerm,toggleDialog:this.togglePermSelectDialog}));return this.props.isDesktop?y:v}}]),t}(l.Component),k=function(){var e=this;this.toggleOpMenu=function(){e.setState({isOpMenuOpen:!e.state.isOpMenuOpen})},this.togglePermSelectDialog=function(){e.setState({isPermSelectDialogOpen:!e.state.isPermSelectDialogOpen})},this.onMouseEnter=function(){e.setState({isOpIconShown:!0})},this.onMouseLeave=function(){e.setState({isOpIconShown:!1})},this.changePerm=function(t){var n=e.props.item,r=n.share_type,a={share_type:r,permission:t};"personal"==r?a.user=n.user_email:"group"==r&&(a.group_id=n.group_id),p.seafileAPI.updateRepoSharePerm(n.repo_id,a).then(function(){e.setState({share_permission:"admin"==t?"rw":t,is_admin:"admin"==t}),g.default.success((0,f.gettext)("Successfully modified permission."))}).catch(function(e){var t=h.Utils.getErrorMsg(e);g.default.danger(t)})},this.unshare=function(t){t.preventDefault();var n=e.props.item,r=n.share_type,a={share_type:r};"personal"==r?a.user=n.user_email:"group"==r&&(a.group_id=n.group_id),p.seafileAPI.unshareRepo(n.repo_id,a).then(function(t){e.setState({unshared:!0});var r=(0,f.gettext)("Successfully unshared {name}").replace("{name}",n.repo_name);g.default.success(r)}).catch(function(e){var t=h.Utils.getErrorMsg(e);(0,g.default)(t)})}},M=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.sortItems=function(e,t){n.setState({sortBy:e,sortOrder:t,items:h.Utils.sortRepos(n.state.items,e,t)})},n.state={loading:!0,errorMsg:"",items:[],sortBy:"name",sortOrder:"asc"},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;p.seafileAPI.listSharedRepos().then(function(t){var n=t.data.map(function(e){return new S.default(e)});e.setState({loading:!1,items:h.Utils.sortRepos(n,e.state.sortBy,e.state.sortOrder)})}).catch(function(t){e.setState({loading:!1,errorMsg:h.Utils.getErrorMsg(t,!0)})})}},{key:"render",value:function(){return u.default.createElement("div",{className:"main-panel-center"},u.default.createElement("div",{className:"cur-view-container",id:"share-admin-libs"},u.default.createElement("div",{className:"cur-view-path"},u.default.createElement("h3",{className:"sf-heading"},(0,f.gettext)("Libraries"))),u.default.createElement("div",{className:"cur-view-content"},u.default.createElement(_,{errorMsg:this.state.errorMsg,loading:this.state.loading,items:this.state.items,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems}))))}}]),t}(l.Component);t.default=M},2235:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function e(t){r(this,e),this.repo_id=t.repo_id,this.repo_name=t.repo_name,this.share_type=t.share_type,this.share_permission=t.share_permission,this.modifier_name=t.modifier_name,this.modifier_email=t.modifier_email,this.modifier_contact_email=t.modifier_contact_email,this.encrypted=t.encrypted,"personal"===this.share_type?(this.is_admin=t.is_admin,this.user_name=t.user_name,this.user_email=t.user_email,this.contact_email=t.contact_email):"group"===this.share_type&&(this.is_admin=t.is_admin,this.group_id=t.group_id,this.group_name=t.group_name)};t.default=a},2236:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(15),d=n(6),p=n(4),f=n(3),h=n(2),m=n(8),g=r(m),y=n(39),v=r(y),b=n(5),w=r(b),E=n(53),S=r(E),C=n(2237),D=r(C),_=n(1309),P=r(_),k=function(e){function t(){var e,n,r,i;a(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=r=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),r.sortByName=function(e){e.preventDefault();var t="asc"==r.props.sortOrder?"desc":"asc";r.props.sortItems("name",t)},i=n,o(r,i)}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg,r=e.items,a=e.sortBy,o=e.sortOrder;if(t)return u.default.createElement(g.default,null);if(n)return u.default.createElement("p",{className:"error text-center"},n);var i=u.default.createElement(v.default,null,u.default.createElement("h2",null,(0,h.gettext)("No folders shared")),u.default.createElement("p",null,(0,h.gettext)("You have not shared any folders with other users yet. You can share a folder with other users by clicking the share icon to the right of a folder's name."))),s="name"==a,l="asc"==o?u.default.createElement("span",{className:"fas fa-caret-up"}):u.default.createElement("span",{className:"fas fa-caret-down"}),c=f.Utils.isDesktop(),d=u.default.createElement("table",{className:"table-hover "+(c?"":"table-thead-hidden")},u.default.createElement("thead",null,c?u.default.createElement("tr",null,u.default.createElement("th",{width:"4%"}),u.default.createElement("th",{width:"34%"},u.default.createElement("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByName},(0,h.gettext)("Name")," ",s&&l)),u.default.createElement("th",{width:"30%"},(0,h.gettext)("Share To")),u.default.createElement("th",{width:"24%"},(0,h.gettext)("Permission")),u.default.createElement("th",{width:"8%"})):u.default.createElement("tr",null,u.default.createElement("th",{width:"12%"}),u.default.createElement("th",{width:"80%"}),u.default.createElement("th",{width:"8%"}))),u.default.createElement("tbody",null,r.map(function(e,t){return u.default.createElement(M,{key:t,isDesktop:c,item:e})})));return r.length?d:i}}]),t}(l.Component),M=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleOpMenu=function(){n.setState({isOpMenuOpen:!n.state.isOpMenuOpen})},n.togglePermSelectDialog=function(){n.setState({isPermSelectDialogOpen:!n.state.isPermSelectDialogOpen})},n.onMouseEnter=function(){n.setState({isOpIconShown:!0})},n.onMouseLeave=function(){n.setState({isOpIconShown:!1})},n.unshare=function(e){e.preventDefault();var t=n.props.item,r={p:t.path};"personal"==t.share_type?Object.assign(r,{share_type:"user",username:t.user_email}):Object.assign(r,{share_type:t.share_type,group_id:t.group_id}),p.seafileAPI.unshareFolder(t.repo_id,r).then(function(e){n.setState({unshared:!0});var r=(0,h.gettext)("Successfully unshared {name}").replace("{name}",t.folder_name);w.default.success(r)}).catch(function(e){var t=f.Utils.getErrorMsg(e);(0,w.default)(t)})},n.changePerm=function(e){var t=n.props.item,r={permission:e},a={p:t.path};"personal"==t.share_type?Object.assign(a,{share_type:"user",username:t.user_email}):Object.assign(a,{share_type:t.share_type,group_id:t.group_id}),p.seafileAPI.updateFolderSharePerm(t.repo_id,r,a).then(function(t){n.setState({share_permission:e}),w.default.success((0,h.gettext)("Successfully modified permission."))}).catch(function(e){var t=f.Utils.getErrorMsg(e);w.default.danger(t)})},n.state={share_permission:n.props.item.share_permission,isOpIconShown:!1,isOpMenuOpen:!1,isPermSelectDialogOpen:!1,unshared:!1},n.permissions=["rw","r"],h.isPro&&n.permissions.push("cloud-edit","preview"),n}return i(t,e),s(t,[{key:"render",value:function(){if(this.state.unshared)return null;var e=this.props.item,t=this.state,n=t.share_permission,r=t.isOpIconShown,a=t.isPermSelectDialogOpen,o=!1;"r"!=n&&"preview"!=n||(o=!0);var i=f.Utils.getFolderIconUrl(o),s=f.Utils.getFolderIconTitle({permission:n}),p=h.siteRoot+"library/"+e.repo_id+"/"+encodeURIComponent(e.repo_name)+f.Utils.encodePath(e.path),m=u.default.createElement("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},u.default.createElement("td",null,u.default.createElement("img",{src:i,title:s,alt:s,width:"24"})),u.default.createElement("td",null,u.default.createElement(c.Link,{to:p},e.folder_name)),u.default.createElement("td",null,"personal"==e.share_type?u.default.createElement("span",{title:e.contact_email},e.user_name):e.group_name),u.default.createElement("td",null,u.default.createElement(S.default,{isTextMode:!0,isEditIconShow:r,currentPermission:n,permissions:this.permissions,onPermissionChanged:this.changePerm})),u.default.createElement("td",null,u.default.createElement("a",{href:"#",className:"action-icon sf2-icon-x3 "+(r?"":"invisible"),title:(0,h.gettext)("Unshare"),onClick:this.unshare}))),g=u.default.createElement(l.Fragment,null,u.default.createElement("tr",null,u.default.createElement("td",null,u.default.createElement("img",{src:i,title:s,alt:s,width:"24"})),u.default.createElement("td",null,u.default.createElement(c.Link,{to:p},e.folder_name),u.default.createElement("span",{className:"item-meta-info-highlighted"},f.Utils.sharePerms(n)),u.default.createElement("br",null),u.default.createElement("span",{className:"item-meta-info"},(0,h.gettext)("Share To:")+" "+("personal"==e.share_type?e.user_name:e.group_name))),u.default.createElement("td",null,u.default.createElement(d.Dropdown,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu},u.default.createElement(d.DropdownToggle,{tag:"i",className:"sf-dropdown-toggle fa fa-ellipsis-v ml-0",title:(0,h.gettext)("More Operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),u.default.createElement("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu},u.default.createElement("div",{className:"mobile-operation-menu-bg-layer"}),u.default.createElement("div",{className:"mobile-operation-menu"},u.default.createElement(d.DropdownItem,{className:"mobile-menu-item",onClick:this.togglePermSelectDialog},(0,h.gettext)("Permission")),u.default.createElement(d.DropdownItem,{className:"mobile-menu-item",onClick:this.unshare},(0,h.gettext)("Unshare"))))))),a&&u.default.createElement(P.default,{currentPerm:n,permissions:this.permissions,changePerm:this.changePerm,toggleDialog:this.togglePermSelectDialog}));return this.props.isDesktop?m:g}}]),t}(l.Component),O=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._sortItems=function(e,t,n){var r=void 0;switch(t+"-"+n){case"name-asc":r=function(e,t){return f.Utils.compareTwoWord(e.folder_name,t.folder_name)};break;case"name-desc":r=function(e,t){return-f.Utils.compareTwoWord(e.folder_name,t.folder_name)}}return e.sort(r),e},n.sortItems=function(e,t){n.setState({sortBy:e,sortOrder:t,items:n._sortItems(n.state.items,e,t)})},n.state={loading:!0,errorMsg:"",items:[],sortBy:"name",sortOrder:"asc"},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;p.seafileAPI.listSharedFolders().then(function(t){var n=t.data.map(function(e){return new D.default(e)});e.setState({loading:!1,items:e._sortItems(n,e.state.sortBy,e.state.sortOrder)})}).catch(function(t){e.setState({loading:!1,errorMsg:f.Utils.getErrorMsg(t,!0)})})}},{key:"render",value:function(){return u.default.createElement("div",{className:"main-panel-center"},u.default.createElement("div",{className:"cur-view-container",id:"share-admin-libs"},u.default.createElement("div",{className:"cur-view-path"},u.default.createElement("h3",{className:"sf-heading"},(0,h.gettext)("Folders"))),u.default.createElement("div",{className:"cur-view-content"},u.default.createElement(k,{errorMsg:this.state.errorMsg,loading:this.state.loading,items:this.state.items,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems}))))}}]),t}(l.Component);t.default=O},2237:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function e(t){r(this,e),this.path=t.path,this.folder_name=t.folder_name,this.repo_id=t.repo_id,this.repo_name=t.repo_name,this.share_type=t.share_type,this.share_permission=t.share_permission,"group"===t.share_type?(this.group_id=t.group_id,this.group_name=t.group_name):(this.user_name=t.user_name,this.user_email=t.user_email,this.contact_email=t.contact_email)};t.default=a},2238:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(15),d=n(7),p=r(d),f=n(6),h=n(4),m=n(3),g=n(2),y=n(177),v=r(y),b=n(176),w=r(b),E=n(8),S=r(E),C=n(5),D=r(C),_=n(39),P=r(_),k=n(2239),M=r(k),O=n(846),L=r(O),I=function(e){function t(){var e,n,r,i;a(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=r=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),r.sortByName=function(e){e.preventDefault();var t="asc"==r.props.sortOrder?"desc":"asc";r.props.sortItems("name",t)},r.sortByTime=function(e){e.preventDefault();var t="asc"==r.props.sortOrder?"desc":"asc";r.props.sortItems("time",t)},i=n,o(r,i)}return i(t,e),s(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,a=t.items,o=t.sortBy,i=t.sortOrder;if(n)return u.default.createElement(S.default,null);if(r)return u.default.createElement("p",{className:"error text-center"},r);var s=u.default.createElement(P.default,null,u.default.createElement("h2",null,(0,g.gettext)("No share links")),u.default.createElement("p",null,(0,g.gettext)("You have not created any share links yet. A share link can be used to share files and folders with anyone. You can create a share link for a file or folder by clicking the share icon to the right of its name."))),l="name"==o,c="time"==o,d="asc"==i?u.default.createElement("span",{className:"fas fa-caret-up"}):u.default.createElement("span",{className:"fas fa-caret-down"}),p=m.Utils.isDesktop(),f=g.isPro?["14%","7%","14%"]:["21%","14%","20%"],h=u.default.createElement("table",{className:"table-hover "+(p?"":"table-thead-hidden")},u.default.createElement("thead",null,p?u.default.createElement("tr",null,u.default.createElement("th",{width:"4%"}),u.default.createElement("th",{width:"31%"},u.default.createElement("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByName},(0,g.gettext)("Name")," ",l&&d)),u.default.createElement("th",{width:f[0]},(0,g.gettext)("Library")),g.isPro&&u.default.createElement("th",{width:"20%"},(0,g.gettext)("Permission")),u.default.createElement("th",{width:f[1]},(0,g.gettext)("Visits")),u.default.createElement("th",{width:f[2]},u.default.createElement("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByTime},(0,g.gettext)("Expiration")," ",c&&d)),u.default.createElement("th",{width:"10%"})):u.default.createElement("tr",null,u.default.createElement("th",{width:"12%"}),u.default.createElement("th",{width:"80%"}),u.default.createElement("th",{width:"8%"}))),u.default.createElement("tbody",null,a.map(function(t,n){return u.default.createElement(T,{key:n,isDesktop:p,item:t,onRemoveLink:e.props.onRemoveLink})})));return a.length?h:s}}]),t}(l.Component),T=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.updatePermissionOptions=function(){var e=n.props.item,t=e.is_dir?"/"===e.path?"library":"dir":"file",r=e.repo_folder_permission,a=m.Utils.getShareLinkPermissionList(t,r,e.path,e.can_edit),o=m.Utils.getShareLinkPermissionStr(n.props.item.permissions);n.setState({permissionOptions:a,currentPermission:o})},n.toggleOpMenu=function(){n.setState({isOpMenuOpen:!n.state.isOpMenuOpen})},n.togglePermSelectDialog=function(){n.setState({isPermSelectDialogOpen:!n.state.isPermSelectDialogOpen})},n.toggleLinkDialog=function(){n.setState({isLinkDialogOpen:!n.state.isLinkDialogOpen})},n.handleMouseOver=function(){n.setState({isOpIconShown:!0})},n.handleMouseOut=function(){n.setState({isOpIconShown:!1})},n.viewLink=function(e){e.preventDefault(),n.toggleLinkDialog()},n.removeLink=function(e){e.preventDefault(),n.props.onRemoveLink(n.props.item)},n.renderExpiration=function(){var e=n.props.item;if(!e.expire_date)return"--";var t=(0,p.default)(e.expire_date).format("YYYY-MM-DD"),r=(0,p.default)(e.expire_date).format("YYYY-MM-DD HH:mm:ss");return u.default.createElement("span",{className:e.is_expired?"error":"",title:r},t)},n.changePerm=function(e){var t=n.props.item,r=m.Utils.getShareLinkPermissionObject(e).permissionDetails;h.seafileAPI.updateShareLink(t.token,JSON.stringify(r)).then(function(){n.setState({currentPermission:e});var t=(0,g.gettext)("Successfully modified permission.");D.default.success(t)}).catch(function(e){var t=m.Utils.getErrorMsg(e);D.default.danger(t)})},n.state={isOpIconShown:!1,isOpMenuOpen:!1,isPermSelectDialogOpen:!1,isLinkDialogOpen:!1,permissionOptions:[],currentPermission:""},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){g.isPro&&this.updatePermissionOptions()}},{key:"render",value:function(){var e=this.props.item,t=this.state,n=t.currentPermission,r=t.permissionOptions,a=t.isOpIconShown,o=t.isPermSelectDialogOpen,i=t.isLinkDialogOpen,s=void 0,d=void 0;if(e.is_dir){var p="/"===e.path?"/":e.path.slice(0,e.path.length-1);s=m.Utils.getFolderIconUrl(!1),d=g.siteRoot+"library/"+e.repo_id+"/"+encodeURIComponent(e.repo_name)+m.Utils.encodePath(p)}else s=m.Utils.getFileIconUrl(e.obj_name),d=g.siteRoot+"lib/"+e.repo_id+"/file"+m.Utils.encodePath(e.path);var h=u.default.createElement("tr",{onMouseEnter:this.handleMouseOver,onMouseLeave:this.handleMouseOut},u.default.createElement("td",null,u.default.createElement("img",{src:s,width:"24",alt:""})),u.default.createElement("td",null,e.is_dir?u.default.createElement(c.Link,{to:d},e.obj_name):u.default.createElement("a",{href:d,target:"_blank"},e.obj_name)),u.default.createElement("td",null,u.default.createElement(c.Link,{to:g.siteRoot+"library/"+e.repo_id+"/"+encodeURIComponent(e.repo_name)+"/"},e.repo_name)),g.isPro&&u.default.createElement("td",null,u.default.createElement(w.default,{isTextMode:!0,isEditIconShow:a&&!e.is_expired,currentPermission:n,permissionOptions:r,onPermissionChanged:this.changePerm})),u.default.createElement("td",null,e.view_cnt),u.default.createElement("td",null,this.renderExpiration()),u.default.createElement("td",null,!e.is_expired&&u.default.createElement("a",{href:"#",className:"sf2-icon-link action-icon "+(a?"":"invisible"),title:(0,g.gettext)("View"),onClick:this.viewLink}),u.default.createElement("a",{href:"#",className:"sf2-icon-delete action-icon "+(a?"":"invisible"),title:(0,g.gettext)("Remove"),onClick:this.removeLink}))),y=u.default.createElement(l.Fragment,null,u.default.createElement("tr",null,u.default.createElement("td",null,u.default.createElement("img",{src:s,alt:"",width:"24"})),u.default.createElement("td",null,e.is_dir?u.default.createElement(c.Link,{to:d},e.obj_name):u.default.createElement("a",{href:d,target:"_blank"},e.obj_name),g.isPro&&u.default.createElement("span",{className:"item-meta-info-highlighted"},m.Utils.getShareLinkPermissionObject(n).text),u.default.createElement("br",null),u.default.createElement("span",null,e.repo_name),u.default.createElement("br",null),u.default.createElement("span",{className:"item-meta-info"},e.view_cnt,u.default.createElement("span",{className:"small text-secondary"},"(",(0,g.gettext)("Visits"),")")),u.default.createElement("span",{className:"item-meta-info"},this.renderExpiration(),u.default.createElement("span",{className:"small text-secondary"},"(",(0,g.gettext)("Expiration"),")"))),u.default.createElement("td",null,u.default.createElement(f.Dropdown,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu},u.default.createElement(f.DropdownToggle,{tag:"i",className:"sf-dropdown-toggle fa fa-ellipsis-v ml-0",title:(0,g.gettext)("More Operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),u.default.createElement("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu},u.default.createElement("div",{className:"mobile-operation-menu-bg-layer"}),u.default.createElement("div",{className:"mobile-operation-menu"},g.isPro&&!e.is_expired&&u.default.createElement(f.DropdownItem,{className:"mobile-menu-item",onClick:this.togglePermSelectDialog},(0,g.gettext)("Permission")),!e.is_expired&&u.default.createElement(f.DropdownItem,{className:"mobile-menu-item",onClick:this.viewLink},(0,g.gettext)("View")),u.default.createElement(f.DropdownItem,{className:"mobile-menu-item",onClick:this.removeLink},(0,g.gettext)("Remove"))))))),o&&u.default.createElement(M.default,{currentPerm:n,permissions:r,changePerm:this.changePerm,toggleDialog:this.togglePermSelectDialog}));return u.default.createElement(l.Fragment,null,this.props.isDesktop?h:y,i&&u.default.createElement(L.default,{link:e.link,toggleDialog:this.toggleLinkDialog}))}}]),t}(l.Component),R=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._sortItems=function(e,t,n){var r=void 0;switch(t+"-"+n){case"name-asc":r=function(e,t){return m.Utils.compareTwoWord(e.obj_name,t.obj_name)};break;case"name-desc":r=function(e,t){return-m.Utils.compareTwoWord(e.obj_name,t.obj_name)};break;case"time-asc":r=function(e,t){return e.expire_date<t.expire_date?-1:1};break;case"time-desc":r=function(e,t){return e.expire_date<t.expire_date?1:-1}}return e.sort(function(e,t){return e.is_dir&&!t.is_dir?-1:!e.is_dir&&t.is_dir?1:r(e,t)}),e},n.sortItems=function(e,t){n.setState({sortBy:e,sortOrder:t,items:n._sortItems(n.state.items,e,t)})},n.onRemoveLink=function(e){h.seafileAPI.deleteShareLink(e.token).then(function(){var t=n.state.items.filter(function(t){return t.token!==e.token});n.setState({items:t});var r=(0,g.gettext)("Successfully deleted 1 item.");D.default.success(r)}).catch(function(e){var t=m.Utils.getErrorMsg(e);D.default.danger(t)})},n.state={loading:!0,errorMsg:"",items:[],sortBy:"name",sortOrder:"asc"},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;h.seafileAPI.listUserShareLinks().then(function(t){var n=t.data.map(function(e){return new v.default(e)});e.setState({loading:!1,items:e._sortItems(n,e.state.sortBy,e.state.sortOrder)})}).catch(function(t){e.setState({loading:!1,errorMsg:m.Utils.getErrorMsg(t,!0)})})}},{key:"render",value:function(){return u.default.createElement("div",{className:"main-panel-center"},u.default.createElement("div",{className:"cur-view-container"},u.default.createElement("div",{className:"cur-view-path share-upload-nav"},u.default.createElement("ul",{className:"nav"},u.default.createElement("li",{className:"nav-item"},u.default.createElement(c.Link,{to:g.siteRoot+"share-admin-share-links/",className:"nav-link active"},(0,g.gettext)("Share Links"))),g.canGenerateUploadLink&&u.default.createElement("li",{className:"nav-item"},u.default.createElement(c.Link,{to:g.siteRoot+"share-admin-upload-links/",className:"nav-link"},(0,g.gettext)("Upload Links"))))),u.default.createElement("div",{className:"cur-view-content"},u.default.createElement(I,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.items,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems,onRemoveLink:this.onRemoveLink}))))}}]),t}(l.Component);t.default=R},2239:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(3),h={currentPerm:d.default.string.isRequired,permissions:d.default.array.isRequired,changePerm:d.default.func.isRequired,toggleDialog:d.default.func.isRequired},m=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.switchOption=function(e){if(e.target.checked){var t=e.target.value;n.setState({currentOption:t}),n.props.changePerm(t),n.props.toggleDialog()}},n.state={currentOption:n.props.currentPerm},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this,t=this.props.permissions,n=this.state.currentOption;return u.default.createElement(p.Modal,{isOpen:!0,toggle:this.props.toggleDialog},u.default.createElement(p.ModalBody,null,t.map(function(t,r){return u.default.createElement("div",{className:"d-flex",key:r},u.default.createElement("input",{id:"option-"+r,className:"mt-1",type:"radio",name:"permission",value:t,checked:n==t,onChange:e.switchOption}),u.default.createElement("label",{htmlFor:"option-"+r,className:"ml-2"},f.Utils.getShareLinkPermissionObject(t).text))})))}}]),t}(u.default.Component);m.propTypes=h,t.default=m},2240:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(15),d=n(7),p=r(d),f=n(6),h=n(2),m=n(4),g=n(3),y=n(5),v=r(y),b=n(8),w=r(b),E=n(39),S=r(E),C=n(178),D=r(C),_=n(846),P=r(_),k=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,a=t.items;if(n)return u.default.createElement(w.default,null);if(r)return u.default.createElement("p",{className:"error text-center"},r);var o=u.default.createElement(S.default,null,u.default.createElement("h2",null,(0,h.gettext)("No upload links")),u.default.createElement("p",null,(0,h.gettext)("You have not created any upload links yet. An upload link allows anyone to upload files to a folder or library. You can create an upload link for a folder or library by clicking the share icon to the right of its name."))),i=g.Utils.isDesktop(),s=u.default.createElement("table",{className:"table-hover "+(i?"":"table-thead-hidden")},u.default.createElement("thead",null,i?u.default.createElement("tr",null,u.default.createElement("th",{width:"4%"}),u.default.createElement("th",{width:"30%"},(0,h.gettext)("Name")),u.default.createElement("th",{width:"24%"},(0,h.gettext)("Library")),u.default.createElement("th",{width:"16%"},(0,h.gettext)("Visits")),u.default.createElement("th",{width:"16%"},(0,h.gettext)("Expiration")),u.default.createElement("th",{width:"10%"})):u.default.createElement("tr",null,u.default.createElement("th",{width:"12%"}),u.default.createElement("th",{width:"80%"}),u.default.createElement("th",{width:"8%"}))),u.default.createElement("tbody",null,a.map(function(t,n){return u.default.createElement(M,{key:n,isDesktop:i,item:t,onRemoveLink:e.props.onRemoveLink})})));return a.length?s:o}}]),t}(l.Component),M=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleOpMenu=function(){n.setState({isOpMenuOpen:!n.state.isOpMenuOpen})},n.toggleLinkDialog=function(){n.setState({isLinkDialogOpen:!n.state.isLinkDialogOpen})},n.handleMouseOver=function(){n.setState({isOpIconShown:!0})},n.handleMouseOut=function(){n.setState({isOpIconShown:!1})},n.viewLink=function(e){e.preventDefault(),n.toggleLinkDialog()},n.removeLink=function(e){e.preventDefault(),n.props.onRemoveLink(n.props.item)},n.renderExpiration=function(){var e=n.props.item;if(!e.expire_date)return"--";var t=(0,p.default)(e.expire_date).format("YYYY-MM-DD"),r=(0,p.default)(e.expire_date).format("YYYY-MM-DD HH:mm:ss");return u.default.createElement("span",{className:e.is_expired?"error":"",title:r},t)},n.state={isOpIconShown:!1,isOpMenuOpen:!1,isLinkDialogOpen:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.item,t=this.state,n=t.isOpIconShown,r=t.isLinkDialogOpen,a=g.Utils.getFolderIconUrl(!1),o=h.siteRoot+"library/"+e.repo_id+"/"+encodeURIComponent(e.repo_name),i=""+o+g.Utils.encodePath(e.path),s=u.default.createElement("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut},u.default.createElement("td",null,u.default.createElement("img",{src:a,alt:"",width:"24"})),u.default.createElement("td",null,u.default.createElement(c.Link,{to:i},e.obj_name)),u.default.createElement("td",null,u.default.createElement(c.Link,{to:o},e.repo_name)),u.default.createElement("td",null,e.view_cnt),u.default.createElement("td",null,this.renderExpiration()),u.default.createElement("td",null,!e.is_expired&&u.default.createElement("a",{href:"#",className:"sf2-icon-link action-icon "+(n?"":"invisible"),title:(0,h.gettext)("View"),onClick:this.viewLink}),u.default.createElement("a",{href:"#",className:"sf2-icon-delete action-icon "+(n?"":"invisible"),title:(0,h.gettext)("Remove"),onClick:this.removeLink}))),d=u.default.createElement("tr",null,u.default.createElement("td",null,u.default.createElement("img",{src:a,alt:"",width:"24"})),u.default.createElement("td",null,u.default.createElement(c.Link,{to:i},e.obj_name),u.default.createElement("br",null),u.default.createElement("span",null,e.repo_name),u.default.createElement("br",null),u.default.createElement("span",{className:"item-meta-info"},e.view_cnt,u.default.createElement("span",{className:"small text-secondary"},"(",(0,h.gettext)("Visits"),")")),u.default.createElement("span",{className:"item-meta-info"},this.renderExpiration(),u.default.createElement("span",{className:"small text-secondary"},"(",(0,h.gettext)("Expiration"),")"))),u.default.createElement("td",null,u.default.createElement(f.Dropdown,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu},u.default.createElement(f.DropdownToggle,{tag:"i",className:"sf-dropdown-toggle fa fa-ellipsis-v ml-0",title:(0,h.gettext)("More Operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),u.default.createElement("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu},u.default.createElement("div",{className:"mobile-operation-menu-bg-layer"}),u.default.createElement("div",{className:"mobile-operation-menu"},!e.is_expired&&u.default.createElement(f.DropdownItem,{className:"mobile-menu-item",onClick:this.viewLink},(0,h.gettext)("View")),u.default.createElement(f.DropdownItem,{className:"mobile-menu-item",onClick:this.removeLink},(0,h.gettext)("Remove")))))));return u.default.createElement(l.Fragment,null,this.props.isDesktop?s:d,r&&u.default.createElement(P.default,{link:e.link,toggleDialog:this.toggleLinkDialog}))}}]),t}(l.Component),O=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onRemoveLink=function(e){m.seafileAPI.deleteUploadLink(e.token).then(function(){var t=n.state.items.filter(function(t){return t.token!==e.token});n.setState({items:t});var r=(0,h.gettext)("Successfully deleted 1 item.");v.default.success(r)}).catch(function(e){var t=g.Utils.getErrorMsg(e);v.default.danger(t)})},n.state={loading:!0,errorMsg:"",items:[]},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;m.seafileAPI.listUserUploadLinks().then(function(t){var n=t.data.map(function(e){return new D.default(e)});e.setState({loading:!1,items:n})}).catch(function(t){e.setState({loading:!1,errorMsg:g.Utils.getErrorMsg(t,!0)})})}},{key:"render",value:function(){return u.default.createElement("div",{className:"main-panel-center"},u.default.createElement("div",{className:"cur-view-container"},u.default.createElement("div",{className:"cur-view-path share-upload-nav"},u.default.createElement("ul",{className:"nav"},h.canGenerateShareLink&&u.default.createElement("li",{className:"nav-item"},u.default.createElement(c.Link,{to:h.siteRoot+"share-admin-share-links/",className:"nav-link"},(0,h.gettext)("Share Links"))),u.default.createElement("li",{className:"nav-item"},u.default.createElement(c.Link,{to:h.siteRoot+"share-admin-upload-links/",className:"nav-link active"},(0,h.gettext)("Upload Links"))))),u.default.createElement("div",{className:"cur-view-content"},u.default.createElement(k,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.items,onRemoveLink:this.onRemoveLink}))))}}]),t}(l.Component);t.default=O},2241:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(6),d=n(1),p=r(d),f=n(7),h=r(f),m=n(47),g=r(m),y=n(15),v=n(2),b=n(4),w=n(3),E=n(5),S=r(E),C=n(387),D=r(C),_=n(8),P=r(_),k=n(39),M=r(k),O=n(847),L=r(O),I=n(13),T=r(I),R=n(108),N=r(R),x=n(736),F=r(x),Y=function(e){function t(){var e,n,r,i;a(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=r=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),r.sortByName=function(e){e.preventDefault();var t="asc"==r.props.sortOrder?"desc":"asc";r.props.sortItems("name",t)},r.sortByTime=function(e){e.preventDefault();var t="asc"==r.props.sortOrder?"desc":"asc";r.props.sortItems("time",t)},r.sortBySize=function(e){e.preventDefault();var t="asc"==r.props.sortOrder?"desc":"asc";r.props.sortItems("size",t)},i=n,o(r,i)}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg,r=e.items,a=e.sortBy,o=e.sortOrder,i=u.default.createElement(M.default,null,u.default.createElement("h2",null,(0,v.gettext)("No shared libraries")),u.default.createElement("p",null,(0,v.gettext)("No libraries have been shared directly with you. A shared library can be shared with full or restricted permission. If you need access to a library owned by another user, ask the user to share the library with you.")));if(t)return u.default.createElement(P.default,null);if(n)return u.default.createElement("p",{className:"error text-center"},n);var s="name"==a,l="time"==a,c="size"==a,d="asc"==o?u.default.createElement("span",{className:"fas fa-caret-up"}):u.default.createElement("span",{className:"fas fa-caret-down"}),p=u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:"4%"}),u.default.createElement("th",{width:"4%"},u.default.createElement("span",{className:"sr-only"},(0,v.gettext)("Library Type"))),u.default.createElement("th",{width:"34%"},u.default.createElement("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByName},(0,v.gettext)("Name")," ",s&&d)),u.default.createElement("th",{width:"10%"},u.default.createElement("span",{className:"sr-only"},(0,v.gettext)("Actions"))),u.default.createElement("th",{width:"14%"},u.default.createElement("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortBySize},(0,v.gettext)("Size")," ",c&&d)),u.default.createElement("th",{width:"18%"},u.default.createElement("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByTime},(0,v.gettext)("Last Update")," ",l&&d)),u.default.createElement("th",{width:"16%"},(0,v.gettext)("Owner")))),f=w.Utils.isDesktop(),h=u.default.createElement("table",{className:f?"":"table-thead-hidden"},f?p:u.default.createElement(L.default,null),u.default.createElement("tbody",null,r.map(function(e,t){return u.default.createElement(Z,{key:t,data:e,isDesktop:f})})));return r.length?h:i}}]),t}(l.Component);Y.propTypes={loading:p.default.bool.isRequired,errorMsg:p.default.string.isRequired,items:p.default.array.isRequired,sortBy:p.default.string.isRequired,sortOrder:p.default.string.isRequired,sortItems:p.default.func.isRequired};var Z=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleOpMenu=function(){n.setState({isOpMenuOpen:!n.state.isOpMenuOpen})},n.handleMouseOver=function(){n.setState({showOpIcon:!0})},n.handleMouseOut=function(){n.setState({showOpIcon:!1})},n.share=function(e){e.preventDefault(),n.setState({isShowSharedDialog:!0})},n.leaveShare=function(e){e.preventDefault();var t=n.props.data,r=void 0;if(-1==t.owner_email.indexOf("@seafile_group")){var a={share_type:"personal",from:t.owner_email};r=b.seafileAPI.leaveShareRepo(t.repo_id,a)}else r=b.seafileAPI.leaveShareGroupOwnedRepo(t.repo_id);r.then(function(e){n.setState({unshared:!0});var r=(0,v.gettext)("Successfully unshared {name}").replace("{name}",t.repo_name);S.default.success(r)}).catch(function(e){var n=w.Utils.getErrorMsg(e);n===(0,v.gettext)("Error")&&(n=(0,v.gettext)("Failed to unshare {name}").replace("{name}",t.repo_name)),(0,S.default)(n)})},n.toggleShareDialog=function(){n.setState({isShowSharedDialog:!1})},n.onStarRepo=function(){var e=n.props.data.repo_name;n.state.isStarred?b.seafileAPI.unstarItem(n.props.data.repo_id,"/").then(function(){n.setState({isStarred:!n.state.isStarred});var t=(0,v.gettext)("Successfully unstarred {library_name_placeholder}.").replace("{library_name_placeholder}",e);S.default.success(t)}).catch(function(e){var t=w.Utils.getErrorMsg(e);S.default.danger(t)}):b.seafileAPI.starItem(n.props.data.repo_id,"/").then(function(){n.setState({isStarred:!n.state.isStarred});var t=(0,v.gettext)("Successfully starred {library_name_placeholder}.").replace("{library_name_placeholder}",e);S.default.success(t)}).catch(function(e){var t=w.Utils.getErrorMsg(e);S.default.danger(t)})},n.visitRepo=function(){(0,y.navigate)(n.repoURL)},n.state={showOpIcon:!1,unshared:!1,isShowSharedDialog:!1,isStarred:n.props.data.starred,isOpMenuOpen:!1},n}return i(t,e),s(t,[{key:"render",value:function(){if(this.state.unshared)return null;var e=this.props.data;e.icon_url=w.Utils.getLibIconUrl(e),e.icon_title=w.Utils.getLibIconTitle(e),e.url=v.siteRoot+"#shared-libs/lib/"+e.repo_id+"/";var t=this.state.showOpIcon?"":" invisible",n="op-icon sf2-icon-share repo-share-btn"+t,r="op-icon sf2-icon-x3"+t,a=this.repoURL=v.siteRoot+"library/"+e.repo_id+"/"+w.Utils.encodePath(e.repo_name)+"/",o=u.default.createElement(l.Fragment,null,u.default.createElement("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut},u.default.createElement("td",{className:"text-center"},!this.state.isStarred&&u.default.createElement("i",{className:"far fa-star star-empty cursor-pointer",onClick:this.onStarRepo}),this.state.isStarred&&u.default.createElement("i",{className:"fas fa-star cursor-pointer",onClick:this.onStarRepo})),u.default.createElement("td",null,u.default.createElement("img",{src:e.icon_url,title:e.icon_title,alt:e.icon_title,width:"24"})),u.default.createElement("td",null,u.default.createElement(y.Link,{to:a},e.repo_name)),u.default.createElement("td",null,v.isPro&&e.is_admin&&u.default.createElement("a",{href:"#",className:n,title:(0,v.gettext)("Share"),onClick:this.share}),u.default.createElement("a",{href:"#",className:r,title:(0,v.gettext)("Leave Share"),onClick:this.leaveShare})),u.default.createElement("td",null,e.size),u.default.createElement("td",{title:(0,h.default)(e.last_modified).format("llll")},(0,h.default)(e.last_modified).fromNow()),u.default.createElement("td",{title:e.owner_contact_email},e.owner_name)),this.state.isShowSharedDialog&&u.default.createElement(T.default,null,u.default.createElement(N.default,{itemType:"library",itemName:e.repo_name,itemPath:"/",repoID:e.repo_id,repoEncrypted:e.encrypted,enableDirPrivateShare:!0,userPerm:e.permission,isAdmin:!0,toggleDialog:this.toggleShareDialog}))),i=u.default.createElement(l.Fragment,null,u.default.createElement("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut},u.default.createElement("td",{onClick:this.visitRepo},u.default.createElement("img",{src:e.icon_url,title:e.icon_title,alt:e.icon_title,width:"24"})),u.default.createElement("td",{onClick:this.visitRepo},u.default.createElement(y.Link,{to:a},e.repo_name),u.default.createElement("br",null),u.default.createElement("span",{className:"item-meta-info",title:e.owner_contact_email},e.owner_name),u.default.createElement("span",{className:"item-meta-info"},e.size),u.default.createElement("span",{className:"item-meta-info",title:(0,h.default)(e.last_modified).format("llll")},(0,h.default)(e.last_modified).fromNow())),u.default.createElement("td",null,u.default.createElement(c.Dropdown,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu},u.default.createElement(c.DropdownToggle,{tag:"i",className:"sf-dropdown-toggle fa fa-ellipsis-v ml-0",title:(0,v.gettext)("More Operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),u.default.createElement("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu},u.default.createElement("div",{className:"mobile-operation-menu-bg-layer"}),u.default.createElement("div",{className:"mobile-operation-menu"},u.default.createElement(c.DropdownItem,{className:"mobile-menu-item",onClick:this.onStarRepo},this.state.isStarred?(0,v.gettext)("Unstar"):(0,v.gettext)("Star")),v.isPro&&e.is_admin&&u.default.createElement(c.DropdownItem,{className:"mobile-menu-item",onClick:this.share},(0,v.gettext)("Share")),u.default.createElement(c.DropdownItem,{className:"mobile-menu-item",onClick:this.leaveShare},(0,v.gettext)("Leave Share"))))))),this.state.isShowSharedDialog&&u.default.createElement(T.default,null,u.default.createElement(N.default,{itemType:"library",itemName:e.repo_name,itemPath:"/",repoID:e.repo_id,repoEncrypted:e.encrypted,enableDirPrivateShare:!0,userPerm:e.permission,isAdmin:!0,toggleDialog:this.toggleShareDialog})));return this.props.isDesktop?o:i}}]),t}(l.Component);Z.propTypes={isDesktop:p.default.bool.isRequired,data:p.default.object.isRequired};var j=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.sortItems=function(e,t){g.default.save("seafile-repo-dir-sort-by",e),g.default.save("seafile-repo-dir-sort-order",t),n.setState({sortBy:e,sortOrder:t,items:w.Utils.sortRepos(n.state.items,e,t)})},n.toggleSortOptionsDialog=function(){n.setState({isSortOptionsDialogOpen:!n.state.isSortOptionsDialogOpen})},n.state={loading:!0,errorMsg:"",items:[],sortBy:g.default.load("seafile-repo-dir-sort-by")||"name",sortOrder:g.default.load("seafile-repo-dir-sort-order")||"asc",isSortOptionsDialogOpen:!1},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;b.seafileAPI.listRepos({type:"shared"}).then(function(t){var n=t.data.repos.map(function(e){return new D.default(e)});e.setState({loading:!1,items:w.Utils.sortRepos(n,e.state.sortBy,e.state.sortOrder)})}).catch(function(t){e.setState({loading:!1,errorMsg:w.Utils.getErrorMsg(t,!0)})})}},{key:"render",value:function(){return u.default.createElement(l.Fragment,null,u.default.createElement("div",{className:"main-panel-center"},u.default.createElement("div",{className:"cur-view-container"},u.default.createElement("div",{className:"cur-view-path"},u.default.createElement("h3",{className:"sf-heading m-0"},(0,v.gettext)("Shared with me")),!w.Utils.isDesktop()&&this.state.items.length>0&&u.default.createElement("span",{className:"sf3-font sf3-font-sort action-icon",onClick:this.toggleSortOptionsDialog})),u.default.createElement("div",{className:"cur-view-content"},u.default.createElement(Y,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.items,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems})))),this.state.isSortOptionsDialogOpen&&u.default.createElement(F.default,{toggleDialog:this.toggleSortOptionsDialog,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems}))}}]),t}(l.Component);t.default=j},2242:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(47),f=r(p),h=n(4),m=n(2),g=n(3),y=n(5),v=r(y),b=n(387),w=r(b),E=n(8),S=r(E),C=n(39),D=r(C),_=n(78),P=r(_),k=n(2243),M=r(k),O=n(848),L=r(O),I=n(2244),T=r(I),R=n(736),N=r(R),x=n(2252),F=r(x),Y={onShowSidePanel:d.default.func.isRequired,onSearchedClick:d.default.func.isRequired},Z=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleSortOptionsDialog=function(){n.setState({isSortOptionsDialogOpen:!n.state.isSortOptionsDialogOpen})},n.onCreateRepo=function(e){h.seafileAPI.createMineRepo(e).then(function(e){var t=new w.default({repo_id:e.data.repo_id,repo_name:e.data.repo_name,size:e.data.repo_size,mtime:e.data.mtime,owner_email:e.data.email,encrypted:e.data.encrypted,permission:e.data.permission,storage_name:e.data.storage_name});n.state.repoList.unshift(t),n.setState({repoList:n.state.repoList})}).catch(function(e){var t=g.Utils.getErrorMsg(e);v.default.danger(t)})},n.sortRepoList=function(e,t){f.default.save("seafile-repo-dir-sort-by",e),f.default.save("seafile-repo-dir-sort-order",t),n.setState({sortBy:e,sortOrder:t,repoList:g.Utils.sortRepos(n.state.repoList,e,t)})},n.onTransferRepo=function(e){var t=n.state.repoList.filter(function(t){return t.repo_id!==e});n.setState({repoList:t})},n.onRenameRepo=function(e,t){var r=n.state.repoList.map(function(n){return n.repo_id===e.repo_id&&(n.repo_name=t),n});n.setState({repoList:r})},n.onDeleteRepo=function(e){var t=n.state.repoList.filter(function(t){return t.repo_id!==e.repo_id});n.setState({repoList:t})},n.onRepoClick=function(e){n.state.isShowDetails&&n.onRepoDetails(e)},n.onRepoDetails=function(e){n.setState({currentRepo:e,isShowDetails:!0})},n.closeDetails=function(){n.setState({isShowDetails:!n.state.isShowDetails})},n.toggleGuideForNewDialog=function(){window.app.pageOptions.guideEnabled=!1,n.setState({isGuideForNewDialogOpen:!1})},n.state={errorMsg:"",isLoading:!0,repoList:[],isShowDetails:!1,isSortOptionsDialogOpen:!1,isGuideForNewDialogOpen:window.app.pageOptions.guideEnabled,sortBy:f.default.load("seafile-repo-dir-sort-by")||"name",sortOrder:f.default.load("seafile-repo-dir-sort-order")||"asc"},n.emptyTip=u.default.createElement(D.default,null,u.default.createElement("h2",null,(0,m.gettext)("No libraries")),u.default.createElement("p",null,(0,m.gettext)('You have not created any libraries yet. A library is a container to organize your files and folders. A library can also be shared with others and synced to your connected devices. You can create a library by clicking the "New Library" button in the menu bar.'))),n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;h.seafileAPI.listRepos({type:"mine"}).then(function(t){var n=t.data.repos.map(function(e){return new w.default(e)});e.setState({isLoading:!1,repoList:g.Utils.sortRepos(n,e.state.sortBy,e.state.sortOrder)})}).catch(function(t){e.setState({isLoading:!1,errorMsg:g.Utils.getErrorMsg(t,!0)})})}},{key:"render",value:function(){return u.default.createElement(l.Fragment,null,u.default.createElement("div",{className:"main-panel-north border-left-show"},u.default.createElement(M.default,{onShowSidePanel:this.props.onShowSidePanel,onCreateRepo:this.onCreateRepo,libraryType:"mine"}),u.default.createElement(P.default,{onSearchedClick:this.props.onSearchedClick})),u.default.createElement("div",{className:"main-panel-center flex-row"},u.default.createElement("div",{className:"cur-view-container"},u.default.createElement("div",{className:"cur-view-path"},u.default.createElement("h3",{className:"sf-heading m-0"},(0,m.gettext)("My Libraries")),!g.Utils.isDesktop()&&this.state.repoList.length>0&&u.default.createElement("span",{className:"sf3-font sf3-font-sort action-icon",onClick:this.toggleSortOptionsDialog})),u.default.createElement("div",{className:"cur-view-content"},this.state.isLoading&&u.default.createElement(S.default,null),!this.state.isLoading&&this.state.errorMsg&&u.default.createElement("p",{className:"error text-center mt-8"},this.state.errorMsg),!this.state.isLoading&&!this.state.errorMsg&&0===this.state.repoList.length&&this.emptyTip,!this.state.isLoading&&!this.state.errorMsg&&this.state.repoList.length>0&&u.default.createElement(T.default,{sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,repoList:this.state.repoList,onRenameRepo:this.onRenameRepo,onDeleteRepo:this.onDeleteRepo,onTransferRepo:this.onTransferRepo,onRepoClick:this.onRepoClick,sortRepoList:this.sortRepoList}))),!this.state.isLoading&&!this.state.errorMsg&&this.state.isGuideForNewDialogOpen&&u.default.createElement(F.default,{toggleDialog:this.toggleGuideForNewDialog}),this.state.isSortOptionsDialogOpen&&u.default.createElement(N.default,{toggleDialog:this.toggleSortOptionsDialog,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortRepoList}),this.state.isShowDetails&&u.default.createElement("div",{className:"cur-view-detail"},u.default.createElement(L.default,{currentRepo:this.state.currentRepo,closeDetails:this.closeDetails}))))}}]),t}(l.Component);Z.propTypes=Y,t.default=Z},2243:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(3),f=n(15),h=n(2),m=n(13),g=r(m),y=n(1023),v=r(y),b=n(6),w={libraryType:d.default.string.isRequired,onCreateRepo:d.default.func.isRequired,onShowSidePanel:d.default.func.isRequired},E=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onCreateRepo=function(e){n.props.onCreateRepo(e),n.onCreateToggle()},n.onCreateToggle=function(){n.setState({isCreateRepoDialogShow:!n.state.isCreateRepoDialogShow})},n.toggleMore=function(){n.setState({isOpen:!n.state.isOpen})},n.state={isCreateRepoDialogShow:!1,isOpen:!1},n}return i(t,e),s(t,[{key:"render",value:function(){return u.default.createElement(l.Fragment,null,u.default.createElement("div",{className:"cur-view-toolbar"},u.default.createElement("span",{className:"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none",title:"Side Nav Menu",onClick:this.props.onShowSidePanel}),p.Utils.isDesktop()?u.default.createElement("div",{className:"operation"},u.default.createElement("button",{className:"btn btn-secondary operation-item",title:(0,h.gettext)("New Library"),onClick:this.onCreateToggle},u.default.createElement("i",{className:"fas fa-plus-square text-secondary mr-1"}),(0,h.gettext)("New Library")),u.default.createElement(b.Dropdown,{isOpen:this.state.isOpen,toggle:this.toggleMore},u.default.createElement(b.DropdownToggle,{className:"btn btn-secondary operation-item"},(0,h.gettext)("More")),u.default.createElement(b.DropdownMenu,null,u.default.createElement(b.DropdownItem,{className:"link-dropdown-container"},u.default.createElement(f.Link,{className:"link-dropdown-item",to:h.siteRoot+"my-libs/deleted/"},(0,h.gettext)("Deleted Libraries")))))):u.default.createElement("span",{className:"sf2-icon-plus mobile-toolbar-icon",title:(0,h.gettext)("New Library"),onClick:this.onCreateToggle})),this.state.isCreateRepoDialogShow&&u.default.createElement(g.default,null,u.default.createElement(v.default,{libraryType:this.props.libraryType,onCreateRepo:this.onCreateRepo,onCreateToggle:this.onCreateToggle})))}}]),t}(u.default.Component);E.propTypes=w,t.default=E},2244:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(127),f=r(p),h=n(2),m=n(2245),g=r(m),y=n(847),v=r(y),b={sortBy:d.default.string.isRequired,sortOrder:d.default.string.isRequired,repoList:d.default.array.isRequired,sortRepoList:d.default.func.isRequired,onRenameRepo:d.default.func.isRequired,onDeleteRepo:d.default.func.isRequired,onTransferRepo:d.default.func.isRequired,onRepoClick:d.default.func.isRequired},w=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.sortByName=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortRepoList("name",t)},n.sortByTime=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortRepoList("time",t)},n.sortBySize=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortRepoList("size",t)},n.renderRepoListView=function(){return u.default.createElement(l.Fragment,null,n.props.repoList.map(function(e){return u.default.createElement(g.default,{key:e.repo_id,repo:e,isItemFreezed:n.state.isItemFreezed,onFreezedItem:n.onFreezedItem,onUnfreezedItem:n.onUnfreezedItem,onRenameRepo:n.props.onRenameRepo,onDeleteRepo:n.props.onDeleteRepo,onTransferRepo:n.props.onTransferRepo,onRepoClick:n.props.onRepoClick})}))},n.renderPCUI=function(){var e=h.storages.length>0,t="asc"===n.props.sortOrder?u.default.createElement("span",{className:"fas fa-caret-up"}):u.default.createElement("span",{className:"fas fa-caret-down"});return u.default.createElement("table",null,u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:"4%"}),u.default.createElement("th",{width:"4%"},u.default.createElement("span",{className:"sr-only"},(0,h.gettext)("Library Type"))),u.default.createElement("th",{width:e?"33%":"38%"},u.default.createElement("a",{className:"d-block table-sort-op",href:"#",onClick:n.sortByName},(0,h.gettext)("Name")," ","name"===n.props.sortBy&&t)),u.default.createElement("th",{width:"14%"},u.default.createElement("span",{className:"sr-only"},(0,h.gettext)("Actions"))),u.default.createElement("th",{width:e?"15%":"20%"},u.default.createElement("a",{className:"d-block table-sort-op",href:"#",onClick:n.sortBySize},(0,h.gettext)("Size")," ","size"===n.props.sortBy&&t)),e?u.default.createElement("th",{width:"15%"},(0,h.gettext)("Storage Backend")):null,u.default.createElement("th",{width:e?"15%":"20%"},u.default.createElement("a",{className:"d-block table-sort-op",href:"#",onClick:n.sortByTime},(0,h.gettext)("Last Update")," ","time"===n.props.sortBy&&t)))),u.default.createElement("tbody",null,n.renderRepoListView()))},n.renderMobileUI=function(){return u.default.createElement("table",{className:"table-thead-hidden"},u.default.createElement(v.default,null),u.default.createElement("tbody",null,n.renderRepoListView()))},n.state={isItemFreezed:!1},n}return i(t,e),s(t,[{key:"render",value:function(){return u.default.createElement(l.Fragment,null,u.default.createElement(f.default,{query:"(min-width: 768px)"},this.renderPCUI()),u.default.createElement(f.default,{query:"(max-width: 767.8px)"},this.renderMobileUI()))}}]),t}(u.default.Component);w.propTypes=b,t.default=w},2245:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(127),f=r(p),h=n(7),m=r(h),g=n(15),y=n(3),v=n(4),b=n(2),w=n(13),E=r(w),S=n(108),C=r(S),D=n(5),_=r(D),P=n(388),k=r(P),M=n(472),O=r(M),L=n(1310),I=r(L),T=n(1311),R=r(T),N=n(1312),x=r(N),F=n(2246),Y=r(F),Z=n(743),j=r(Z),A=n(1024),B=r(A),X=n(2250),J=r(X),U=n(1313),H=r(U),G=n(1314),q=r(G),Q={repo:d.default.object.isRequired,isItemFreezed:d.default.bool.isRequired,onFreezedItem:d.default.func.isRequired,onUnfreezedItem:d.default.func.isRequired,onRenameRepo:d.default.func.isRequired,onDeleteRepo:d.default.func.isRequired,onTransferRepo:d.default.func.isRequired,onRepoClick:d.default.func.isRequired},W=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseEnter=function(){n.props.isItemFreezed||n.setState({isOpIconShow:!0,highlight:!0})},n.onMouseLeave=function(){n.props.isItemFreezed||n.setState({isOpIconShow:!1,highlight:!1})},n.onMenuItemClick=function(e){switch(e){case"Star":case"Unstar":n.onStarRepo();break;case"Share":n.onShareToggle();break;case"Delete":n.onDeleteToggle();break;case"Rename":n.onRenameToggle();break;case"Transfer":n.onTransferToggle();break;case"History Setting":n.onHistorySettingToggle();break;case"Change Password":n.onChangePasswordToggle();break;case"Reset Password":n.onResetPasswordToggle();break;case"Folder Permission":n.onFolderPermissionToggle();break;case"Label Current State":n.onLabelToggle();break;case"API Token":n.onAPITokenToggle();break;case"Share Links Admin":n.toggleRepoShareUploadLinksDialog()}},n.visitRepo=function(){!n.state.isRenaming&&n.props.repo.repo_name&&(0,g.navigate)(n.repoURL)},n.onRepoClick=function(){n.props.onRepoClick(n.props.repo)},n.onStarRepo=function(){var e=n.props.repo.repo_name;n.state.isStarred?v.seafileAPI.unstarItem(n.props.repo.repo_id,"/").then(function(){n.setState({isStarred:!n.state.isStarred});var t=(0,b.gettext)("Successfully unstarred {library_name_placeholder}.").replace("{library_name_placeholder}",e);_.default.success(t)}).catch(function(e){var t=y.Utils.getErrorMsg(e);_.default.danger(t)}):v.seafileAPI.starItem(n.props.repo.repo_id,"/").then(function(){n.setState({isStarred:!n.state.isStarred});var t=(0,b.gettext)("Successfully starred {library_name_placeholder}.").replace("{library_name_placeholder}",e);_.default.success(t)}).catch(function(e){var t=y.Utils.getErrorMsg(e);_.default.danger(t)})},n.onShareToggle=function(){n.setState({isShareDialogShow:!n.state.isShareDialogShow})},n.onDeleteToggle=function(){n.setState({isDeleteDialogShow:!n.state.isDeleteDialogShow})},n.onRenameToggle=function(){n.props.onFreezedItem(),n.setState({isRenaming:!n.state.isRenaming})},n.onTransferToggle=function(){n.setState({isTransferDialogShow:!n.state.isTransferDialogShow})},n.onHistorySettingToggle=function(){n.setState({isHistorySettingDialogShow:!n.state.isHistorySettingDialogShow})},n.onChangePasswordToggle=function(){n.setState({isChangePasswordDialogShow:!n.state.isChangePasswordDialogShow})},n.onResetPasswordToggle=function(){n.setState({isResetPasswordDialogShow:!n.state.isResetPasswordDialogShow})},n.onLabelToggle=function(){n.setState({isLabelRepoStateDialogOpen:!n.state.isLabelRepoStateDialogOpen})},n.onFolderPermissionToggle=function(){n.setState({isFolderPermissionDialogShow:!n.state.isFolderPermissionDialogShow})},n.onAPITokenToggle=function(){n.setState({isAPITokenDialogShow:!n.state.isAPITokenDialogShow})},n.toggleRepoShareUploadLinksDialog=function(){n.setState({isRepoShareUploadLinksDialogOpen:!n.state.isRepoShareUploadLinksDialogOpen})},n.onUnfreezedItem=function(){n.setState({highlight:!1,isOpIconShow:!1}),n.props.onUnfreezedItem()},n.onRenameConfirm=function(e){var t=n.props.repo,r=t.repo_id;v.seafileAPI.renameRepo(r,e).then(function(){n.props.onRenameRepo(t,e),n.onRenameCancel()}).catch(function(e){var t=y.Utils.getErrorMsg(e);_.default.danger(t)})},n.onRenameCancel=function(){n.props.onUnfreezedItem(),n.setState({isRenaming:!n.state.isRenaming})},n.onTransferRepo=function(e){var t=n.props.repo.repo_id;v.seafileAPI.transferRepo(t,e.email).then(function(e){n.props.onTransferRepo(t);var r=(0,b.gettext)("Successfully transferred the library.");_.default.success(r)}).catch(function(e){e.response?_.default.danger(e.response.data.error_msg||(0,b.gettext)("Error"),{duration:3}):_.default.danger((0,b.gettext)("Failed. Please check the network."),{duration:3})}),n.onTransferToggle()},n.onDeleteRepo=function(e){v.seafileAPI.deleteRepo(e.repo_id).then(function(t){n.setState({isRepoDeleted:!0,isDeleteDialogShow:!1}),n.props.onDeleteRepo(e);var r=e.repo_name,a=(0,b.gettext)("Successfully deleted {name}.").replace("{name}",r);_.default.success(a)}).catch(function(t){var r=y.Utils.getErrorMsg(t);if(r===(0,b.gettext)("Error")){var a=e.repo_name;r=(0,b.gettext)("Failed to delete {name}.").replace("{name}",a)}_.default.danger(r),n.setState({isRepoDeleted:!1})})},n.renderPCUI=function(){var e=n.props.repo,t=y.Utils.getLibIconUrl(e),r=y.Utils.getLibIconTitle(e),a=b.siteRoot+"library/"+e.repo_id+"/"+y.Utils.encodePath(e.repo_name)+"/";return u.default.createElement("tr",{className:n.state.highlight?"tr-highlight":"",onMouseEnter:n.onMouseEnter,onMouseLeave:n.onMouseLeave,onClick:n.onRepoClick},u.default.createElement("td",{className:"text-center"},!n.state.isStarred&&u.default.createElement("i",{className:"far fa-star star-empty cursor-pointer",onClick:n.onStarRepo}),n.state.isStarred&&u.default.createElement("i",{className:"fas fa-star cursor-pointer",onClick:n.onStarRepo})),u.default.createElement("td",null,u.default.createElement("img",{src:t,title:r,alt:r,width:"24"})),u.default.createElement("td",null,n.state.isRenaming&&u.default.createElement(B.default,{name:e.repo_name,onRenameConfirm:n.onRenameConfirm,onRenameCancel:n.onRenameCancel}),!n.state.isRenaming&&e.repo_name&&u.default.createElement(g.Link,{to:a},e.repo_name),!n.state.isRenaming&&!e.repo_name&&(0,b.gettext)("Broken (please contact your administrator to fix this library)")),u.default.createElement("td",null,e.repo_name&&n.state.isOpIconShow&&u.default.createElement("div",null,u.default.createElement("a",{href:"#",className:"op-icon sf2-icon-share",title:(0,b.gettext)("Share"),onClick:n.onShareToggle}),u.default.createElement("a",{href:"#",className:"op-icon sf2-icon-delete",title:(0,b.gettext)("Delete"),onClick:n.onDeleteToggle}),u.default.createElement(J.default,{isPC:!0,repo:n.props.repo,onMenuItemClick:n.onMenuItemClick,onFreezedItem:n.props.onFreezedItem,onUnfreezedItem:n.onUnfreezedItem}))),u.default.createElement("td",null,e.size),b.storages.length>0&&u.default.createElement("td",null,e.storage_name),u.default.createElement("td",{title:(0,m.default)(e.last_modified).format("llll")},(0,m.default)(e.last_modified).fromNow()))},n.renderMobileUI=function(){var e=n.props.repo,t=y.Utils.getLibIconUrl(e),r=y.Utils.getLibIconTitle(e),a=n.repoURL=b.siteRoot+"library/"+e.repo_id+"/"+y.Utils.encodePath(e.repo_name)+"/";return u.default.createElement("tr",{className:n.state.highlight?"tr-highlight":"",onMouseEnter:n.onMouseEnter,onMouseLeave:n.onMouseLeave,onClick:n.onRepoClick},u.default.createElement("td",{onClick:n.visitRepo},u.default.createElement("img",{src:t,title:r,alt:r,width:"24"})),u.default.createElement("td",{onClick:n.visitRepo},n.state.isRenaming&&u.default.createElement(B.default,{name:e.repo_name,onRenameConfirm:n.onRenameConfirm,onRenameCancel:n.onRenameCancel}),!n.state.isRenaming&&e.repo_name&&u.default.createElement("div",null,u.default.createElement(g.Link,{to:a},e.repo_name)),!n.state.isRenaming&&!e.repo_name&&u.default.createElement("div",null,"(gettext('Broken (please contact your administrator to fix this library)'))"),u.default.createElement("span",{className:"item-meta-info"},e.size),u.default.createElement("span",{className:"item-meta-info",title:(0,m.default)(e.last_modified).format("llll")},(0,m.default)(e.last_modified).fromNow())),u.default.createElement("td",null,e.repo_name&&u.default.createElement(J.default,{repo:n.props.repo,isStarred:n.state.isStarred,onMenuItemClick:n.onMenuItemClick,onFreezedItem:n.props.onFreezedItem,onUnfreezedItem:n.onUnfreezedItem})))},n.state={isOpIconShow:!1,isStarred:n.props.repo.starred,isRenaming:!1,isShareDialogShow:!1,isDeleteDialogShow:!1,isTransferDialogShow:!1,isHistorySettingDialogShow:!1,isChangePasswordDialogShow:!1,isResetPasswordDialogShow:!1,isLabelRepoStateDialogOpen:!1,isFolderPermissionDialogShow:!1,isAPITokenDialogShow:!1,isRepoShareUploadLinksDialogOpen:!1,isRepoDeleted:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.repo;return u.default.createElement(l.Fragment,null,u.default.createElement(f.default,{query:"(min-width: 768px)"},this.renderPCUI()),u.default.createElement(f.default,{query:"(max-width: 767.8px)"},this.renderMobileUI()),this.state.isShareDialogShow&&u.default.createElement(E.default,null,u.default.createElement(C.default,{itemType:"library",itemName:e.repo_name,itemPath:"/",repoID:e.repo_id,repoEncrypted:e.encrypted,enableDirPrivateShare:!0,userPerm:e.permission,toggleDialog:this.onShareToggle})),this.state.isDeleteDialogShow&&u.default.createElement(E.default,null,u.default.createElement(k.default,{repo:e,isRepoDeleted:this.state.isRepoDeleted,onDeleteRepo:this.onDeleteRepo,toggle:this.onDeleteToggle})),this.state.isTransferDialogShow&&u.default.createElement(E.default,null,u.default.createElement(O.default,{itemName:e.repo_name,submit:this.onTransferRepo,toggleDialog:this.onTransferToggle})),this.state.isHistorySettingDialogShow&&u.default.createElement(E.default,null,u.default.createElement(I.default,{repoID:e.repo_id,itemName:e.repo_name,toggleDialog:this.onHistorySettingToggle})),this.state.isChangePasswordDialogShow&&u.default.createElement(E.default,null,u.default.createElement(R.default,{repoID:e.repo_id,repoName:e.repo_name,toggleDialog:this.onChangePasswordToggle})),this.state.isResetPasswordDialogShow&&u.default.createElement(E.default,null,u.default.createElement(x.default,{repoID:e.repo_id,toggleDialog:this.onResetPasswordToggle})),this.state.isLabelRepoStateDialogOpen&&u.default.createElement(E.default,null,u.default.createElement(Y.default,{repoID:e.repo_id,repoName:e.repo_name,toggleDialog:this.onLabelToggle})),this.state.isFolderPermissionDialogShow&&u.default.createElement(E.default,null,u.default.createElement(j.default,{toggleDialog:this.onFolderPermissionToggle,repoID:e.repo_id,repoName:e.repo_name})),this.state.isAPITokenDialogShow&&u.default.createElement(E.default,null,u.default.createElement(H.default,{repo:e,onRepoAPITokenToggle:this.onAPITokenToggle})),this.state.isRepoShareUploadLinksDialogOpen&&u.default.createElement(E.default,null,u.default.createElement(q.default,{repo:e,toggleDialog:this.toggleRepoShareUploadLinksDialog})))}}]),t}(u.default.Component);W.propTypes=Q,t.default=W},2246:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(742),h=r(f),m=n(2),g=n(4),y=n(3),v=n(8),b=r(v),w=n(5),E=r(w),S={repoID:d.default.string.isRequired,repoName:d.default.string.isRequired,toggleDialog:d.default.func.isRequired},C=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleInputChange=function(e){n.setState({inputValue:e})},n.formSubmit=function(){var e=n.state.inputValue;if(!e||!e.length)return void n.setState({formErrorMsg:(0,m.gettext)("It is required.")});n.setState({submitBtnDisabled:!0});var t=n.props,r=t.repoID,a=t.repoName,o=e.map(function(e,t){return e.value}).join(",");g.seafileAPI.addNewRepoLabels(r,o).then(function(e){var t=(0,m.gettext)("Successfully added label(s) for library {placeholder}").replace("{placeholder}",a);E.default.success(t),n.props.toggleDialog()}).catch(function(e){var t=y.Utils.getErrorMsg(e);n.setState({formErrorMsg:t,submitBtnDisabled:!1})})},n.state={isLoading:!0,existingLabels:null,errorMsg:"",submitBtnDisabled:!1},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;g.seafileAPI.getAllRepoSnapshotLabels().then(function(t){e.setState({isLoading:!1,existingLabels:t.data,errorMsg:""})}).catch(function(t){var n=y.Utils.getErrorMsg(t);e.setState({isLoading:!1,errorMsg:n})})}},{key:"render",value:function(){return u.default.createElement(p.Modal,{isOpen:!0,toggle:this.props.toggleDialog},u.default.createElement(p.ModalHeader,{toggle:this.props.toggleDialog},(0,m.gettext)("Label Current State")),u.default.createElement(p.ModalBody,null,u.default.createElement(D,{data:this.state,handleChange:this.handleInputChange})),this.state.existingLabels&&u.default.createElement(p.ModalFooter,null,u.default.createElement("button",{className:"btn btn-secondary",onClick:this.props.toggleDialog},(0,m.gettext)("Cancel")),u.default.createElement("button",{className:"btn btn-primary",disabled:this.state.submitBtnDisabled,onClick:this.formSubmit},(0,m.gettext)("Submit"))))}}]),t}(u.default.Component),D=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.data,t=e.isLoading,n=e.errorMsg,r=e.existingLabels,a=e.formErrorMsg;return t?u.default.createElement(b.default,null):n?u.default.createElement("p",{className:"error mt-4 text-center"},n):u.default.createElement(u.default.Fragment,null,u.default.createElement(h.default,{isMulti:!0,onChange:this.props.handleChange,placeholder:"",options:r.map(function(e,t){return{label:e,value:e}})}),a&&u.default.createElement("p",{className:"error m-0 mt-2"},a))}}]),t}(u.default.Component);C.propTypes=S,t.default=C},2247:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(2),f=n(6),h=n(4),m=n(3),g=n(45),y=r(g),v=n(53),b=r(v),w=n(68),E=r(w),S=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseEnter=function(){n.setState({isOperationShow:!0})},n.onMouseLeave=function(){n.setState({isOperationShow:!1})},n.deleteUserFolderPermission=function(){var e=n.props.item;n.props.deleteUserFolderPermission(e)},n.onChangeUserFolderPerm=function(e){var t=n.props.item;n.props.onChangeUserFolderPerm(t.repo_id,e,t.folder_path,t.user_email)},n.state={isOperationShow:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.item,t=e.permission;return u.default.createElement("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},u.default.createElement("td",null,u.default.createElement("a",{href:p.siteRoot+"profile/"+encodeURIComponent(e.user_email)+"/",target:"_blank"},e.user_name)),this.props.showPath&&u.default.createElement("td",null,u.default.createElement("a",{href:p.siteRoot+"library/"+e.repo_id+"/"+m.Utils.encodePath(this.props.repoName+e.folder_path)},e.folder_name)),u.default.createElement("td",null,u.default.createElement(b.default,{isTextMode:!0,isEditIconShow:this.state.isOperationShow,currentPermission:t,permissions:this.props.permissions,onPermissionChanged:this.onChangeUserFolderPerm})),u.default.createElement("td",null,u.default.createElement("span",{className:"sf2-icon-x3 action-icon "+(this.state.isOperationShow?"":"hide"),onClick:this.deleteUserFolderPermission,title:(0,p.gettext)("Delete")})))}}]),t}(u.default.Component),C={repoID:d.default.string.isRequired,isDepartmentRepo:d.default.bool},D=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleUserSelectChange=function(e){n.setState({selectedUsers:e})},n.setPermission=function(e){n.setState({permission:e})},n.addUserFolderPerm=function(){var e=n.state.selectedUsers,t=n.props.folderPath||n.state.folderPath;if(!e||!e.length||!t)return!1;var r=e.map(function(e,t){return e.email});(n.props.isDepartmentRepo?h.seafileAPI.addDepartmentRepoUserFolderPerm(n.props.repoID,n.state.permission,t,r):h.seafileAPI.addUserFolderPerm(n.props.repoID,n.state.permission,t,r)).then(function(e){var t=[];if(e.data.failed.length>0)for(var r=0;r<e.data.failed.length;r++)t[r]=e.data.failed[r];n.setState({errorMsg:t,userFolderPermItems:n.state.userFolderPermItems.concat(e.data.success),selectedUsers:null,permission:"rw",folderPath:""}),n.refs.userSelect.clearSelect()}).catch(function(e){var t="";t=e.response?e.response.data&&e.response.data.error_msg?e.response.data.error_msg:(0,p.gettext)("Error"):(0,p.gettext)("Please check the network."),n.setState({errorMsg:[t]})})},n.deleteUserFolderPermItem=function(e){(n.props.isDepartmentRepo?h.seafileAPI.deleteDepartmentRepoUserFolderPerm(e.repo_id,e.permission,e.folder_path,e.user_email):h.seafileAPI.deleteUserFolderPerm(e.repo_id,e.permission,e.folder_path,e.user_email)).then(function(t){n.setState({userFolderPermItems:n.state.userFolderPermItems.filter(function(t){return t!=e})})})},n.onChangeUserFolderPerm=function(e,t,r,a){(n.props.isDepartmentRepo?h.seafileAPI.updateDepartmentRepoUserFolderPerm(e,t,r,a):h.seafileAPI.updateUserFolderPerm(e,t,r,a)).then(function(e){var o=n.state.userFolderPermItems.map(function(e){return e.user_email===a&&e.folder_path===r&&(e.permission=t),e});n.setState({userFolderPermItems:o})})},n.onSetSubFolder=function(e){n.setState({folderPath:e.target.value})},n.toggleFileChooser=function(){n.setState({showFileChooser:!n.state.showFileChooser,folderPath:""})},n.toggleSubFolder=function(e,t,r){n.setState({folderPath:t})},n.handleFileChooserSubmit=function(){n.setState({showFileChooser:!n.state.showFileChooser})},n.onRepoItemClick=function(){n.setState({folderPath:"/"})},n.state={selectedUsers:null,errorMsg:[],permission:"rw",userFolderPermItems:[],folderPath:"",showFileChooser:!1},p.isPro?n.permissions=["r","rw","cloud-edit","preview"]:n.permissions=["r","rw"],n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.repoID,r=t.folderPath;(t.isDepartmentRepo?h.seafileAPI.listDepartmentRepoUserFolderPerm(n,r):h.seafileAPI.listUserFolderPerm(n,r)).then(function(t){0!==t.data.length&&e.setState({userFolderPermItems:t.data})})}},{key:"render",value:function(){var e=this,t=!this.props.folderPath,n=this.state.userFolderPermItems;if(this.state.showFileChooser)return u.default.createElement("div",null,u.default.createElement(E.default,{repoID:this.props.repoID,mode:"only_current_library",onDirentItemClick:this.toggleSubFolder,onRepoItemClick:this.onRepoItemClick}),u.default.createElement("div",{className:"modal-footer"},u.default.createElement(f.Button,{color:"secondary",onClick:this.toggleFileChooser},(0,p.gettext)("Cancel")),u.default.createElement(f.Button,{color:"primary",onClick:this.handleFileChooserSubmit},(0,p.gettext)("Submit"))));var r=u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:t?"32%":"55%"},(0,p.gettext)("User")),t&&u.default.createElement("th",{width:"32%"},(0,p.gettext)("Folder")),u.default.createElement("th",{width:t?"24%":"30%"},(0,p.gettext)("Permission")),u.default.createElement("th",{width:t?"12%":"15%"})));return u.default.createElement(l.Fragment,null,u.default.createElement("table",{className:"w-xs-250"},r,u.default.createElement("tbody",null,u.default.createElement("tr",null,u.default.createElement("td",null,u.default.createElement(y.default,{ref:"userSelect",isMulti:!0,className:"reviewer-select",placeholder:(0,p.gettext)("Select users..."),onSelectChange:this.handleUserSelectChange,value:this.state.selectedUsers})),t&&u.default.createElement("td",null,u.default.createElement(f.InputGroup,null,u.default.createElement(f.Input,{value:this.state.folderPath,onChange:this.onSetSubFolder}),u.default.createElement(f.InputGroupAddon,{addonType:"append"},u.default.createElement(f.Button,{className:"sf2-icon-plus",onClick:this.toggleFileChooser})))),u.default.createElement("td",null,u.default.createElement(b.default,{isTextMode:!1,isEditIconShow:!1,currentPermission:this.state.permission,permissions:this.permissions,onPermissionChanged:this.setPermission})),u.default.createElement("td",null,u.default.createElement(f.Button,{onClick:this.addUserFolderPerm},(0,p.gettext)("Submit")))),this.state.errorMsg.length>0&&this.state.errorMsg.map(function(e,t){var n="";return n=e.user_email?e.user_email+": "+e.error_msg:e,u.default.createElement("tr",{key:t},u.default.createElement("td",{colSpan:3},u.default.createElement("p",{className:"error"},n)))}))),u.default.createElement("div",{className:"share-list-container"},u.default.createElement("table",{className:"table-thead-hidden w-xs-250"},r,u.default.createElement("tbody",null,n.map(function(n,r){return u.default.createElement(S,{key:r,item:n,permissions:e.permissions,deleteUserFolderPermission:e.deleteUserFolderPermItem,onChangeUserFolderPerm:e.onChangeUserFolderPerm,showPath:t,repoName:e.props.repoName})})))))}}]),t}(u.default.Component);D.propTypes=C,t.default=D},2248:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=r(u),d=n(1),p=r(d),f=n(6),h=n(82),m=r(h),g=n(389),y=(r(g),n(2)),v=n(4),b=n(3),w=n(53),E=r(w),S=n(68),C=r(S),D=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseEnter=function(){n.setState({isOperationShow:!0})},n.onMouseLeave=function(){n.setState({isOperationShow:!1})},n.deleteGroupPermissionItem=function(){var e=n.props.item;n.props.deleteGroupPermissionItem(e)},n.onChangeGroupPermission=function(e){var t=n.props.item;n.props.onChangeGroupPermission(t,e)},n.state={isOperationShow:!1},n}return i(t,e),l(t,[{key:"render",value:function(){var e=this.props.item;return c.default.createElement("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},c.default.createElement("td",null,c.default.createElement("a",{href:y.siteRoot+"group/"+e.group_id+"/",target:"_blank"},e.group_name)),this.props.showPath&&c.default.createElement("td",null,c.default.createElement("a",{href:y.siteRoot+"library/"+e.repo_id+"/"+b.Utils.encodePath(this.props.repoName+e.folder_path)},e.folder_name)),c.default.createElement("td",null,c.default.createElement(E.default,{isTextMode:!0,isEditIconShow:this.state.isOperationShow,currentPermission:e.permission,permissions:this.props.permissions,onPermissionChanged:this.onChangeGroupPermission})),c.default.createElement("td",null,c.default.createElement("span",{className:"sf2-icon-x3 action-icon "+(this.state.isOperationShow?"":"hide"),onClick:this.deleteGroupPermissionItem,title:(0,y.gettext)("Delete")})))}}]),t}(c.default.Component),_={repoID:p.default.string.isRequired,isDepartmentRepo:p.default.bool},P=function(e){return c.default.createElement("div",s({},e.innerProps,{style:{margin:"6px 10px",textAlign:"center",color:"hsl(0,0%,50%)"}}),(0,y.gettext)("Group not found"))},k=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleSelectChange=function(e){n.setState({selectedOption:e})},n.loadOptions=function(){v.seafileAPI.shareableGroups().then(function(e){n.options=e.data.map(function(e,t){return{id:e.id,label:e.name,value:e.name}})})},n.listGroupPermissionItems=function(){var e=n.props,t=e.isDepartmentRepo,r=e.repoID,a=e.folderPath;(t?v.seafileAPI.listDepartmentRepoGroupFolderPerm(r,a):v.seafileAPI.listGroupFolderPerm(r,a)).then(function(e){0!==e.data.length&&n.setState({groupPermissionItems:e.data})})},n.setPermission=function(e){n.setState({permission:e})},n.addGroupFolderPerm=function(){var e=n.state.selectedOption,t=n.props.folderPath||n.state.folderPath;if(!e||!t)return!1;(n.props.isDepartmentRepo?v.seafileAPI.addDepartmentRepoGroupFolderPerm(n.props.repoID,n.state.permission,t,e.id):v.seafileAPI.addGroupFolderPerm(n.props.repoID,n.state.permission,t,e.id)).then(function(e){var t=[];if(e.data.failed.length>0)for(var r=0;r<e.data.failed.length;r++)t[r]=e.data.failed[r];n.setState({errorMsg:t,groupPermissionItems:n.state.groupPermissionItems.concat(e.data.success),selectedOption:null,permission:"rw",folderPath:""})}).catch(function(e){var t="";t=e.response?e.response.data&&e.response.data.error_msg?e.response.data.error_msg:(0,y.gettext)("Error"):(0,y.gettext)("Please check the network."),n.setState({errorMsg:[t]})})},n.deleteGroupPermissionItem=function(e){(n.props.isDepartmentRepo?v.seafileAPI.deleteDepartmentRepoGroupFolderPerm(e.repo_id,e.permission,e.folder_path,e.group_id):v.seafileAPI.deleteGroupFolderPerm(e.repo_id,e.permission,e.folder_path,e.group_id)).then(function(){n.setState({groupPermissionItems:n.state.groupPermissionItems.filter(function(t){return t!=e})})})},n.onChangeGroupPermission=function(e,t){(n.props.isDepartmentRepo?v.seafileAPI.updateDepartmentRepoGroupFolderPerm(e.repo_id,t,e.folder_path,e.group_id):v.seafileAPI.updateGroupFolderPerm(e.repo_id,t,e.folder_path,e.group_id)).then(function(){n.updateGroupPermission(e,t)})},n.updateGroupPermission=function(e,t){var r=e.group_id,a=n.state.groupPermissionItems.map(function(n){var a=n.group_id;return r===a&&e.folder_path===n.folder_path&&(n.permission=t),n});n.setState({groupPermissionItems:a})},n.onSetSubFolder=function(e){n.setState({folderPath:e.target.value})},n.toggleFileChooser=function(){n.setState({showFileChooser:!n.state.showFileChooser,folderPath:""})},n.toggleSubFolder=function(e,t,r){n.setState({folderPath:t})},n.handleSubmit=function(){n.setState({showFileChooser:!n.state.showFileChooser})},n.onRepoItemClick=function(){n.setState({folderPath:"/"})},n.state={selectedOption:null,errorMsg:[],permission:"rw",groupPermissionItems:[],folderPath:"",showFileChooser:!1},n.options=[],y.isPro?n.permissions=["r","rw","cloud-edit","preview"]:n.permissions=["r","rw"],n}return i(t,e),l(t,[{key:"componentDidMount",value:function(){this.loadOptions(),this.listGroupPermissionItems()}},{key:"render",value:function(){var e=this,t=!this.props.folderPath;if(this.state.showFileChooser)return c.default.createElement("div",null,c.default.createElement(C.default,{repoID:this.props.repoID,mode:"only_current_library",onDirentItemClick:this.toggleSubFolder,onRepoItemClick:this.onRepoItemClick}),c.default.createElement("div",{className:"modal-footer"},c.default.createElement(f.Button,{color:"secondary",onClick:this.toggleFileChooser},(0,y.gettext)("Cancel")),c.default.createElement(f.Button,{color:"primary",onClick:this.handleSubmit},(0,y.gettext)("Submit"))));var n=c.default.createElement("thead",null,c.default.createElement("tr",null,c.default.createElement("th",{width:t?"32%":"55%"},(0,y.gettext)("Group")),t&&c.default.createElement("th",{width:"32%"},(0,y.gettext)("Folder")),c.default.createElement("th",{width:t?"24%":"30%"},(0,y.gettext)("Permission")),c.default.createElement("th",{width:t?"12%":"15%"})));return c.default.createElement(u.Fragment,null,c.default.createElement("table",{className:"w-xs-250"},n,c.default.createElement("tbody",null,c.default.createElement("tr",null,c.default.createElement("td",null,c.default.createElement(m.default,{onChange:this.handleSelectChange,options:this.options,placeholder:(0,y.gettext)("Select a group"),maxMenuHeight:200,inputId:"react-select-2-input",value:this.state.selectedOption,components:{NoOptionsMessage:P}})),t&&c.default.createElement("td",null,c.default.createElement(f.InputGroup,null,c.default.createElement(f.Input,{value:this.state.folderPath,onChange:this.onSetSubFolder}),c.default.createElement(f.InputGroupAddon,{addonType:"append"},c.default.createElement(f.Button,{className:"sf2-icon-plus",onClick:this.toggleFileChooser})))),c.default.createElement("td",null,c.default.createElement(E.default,{isTextMode:!1,isEditIconShow:!1,currentPermission:this.state.permission,permissions:this.permissions,onPermissionChanged:this.setPermission})),c.default.createElement("td",null,c.default.createElement(f.Button,{onClick:this.addGroupFolderPerm},(0,y.gettext)("Submit")))),this.state.errorMsg.length>0&&this.state.errorMsg.map(function(e,t){var n=e.group_id+": "+e.error_msg;return c.default.createElement("tr",{key:t},c.default.createElement("td",{colSpan:3},c.default.createElement("p",{className:"error"},n)))}))),c.default.createElement("div",{className:"share-list-container"},c.default.createElement("table",{className:"table-thead-hidden w-xs-250"},n,c.default.createElement("tbody",null,this.state.groupPermissionItems.map(function(n,r){return c.default.createElement(D,{key:r,item:n,permissions:e.permissions,deleteGroupPermissionItem:e.deleteGroupPermissionItem,onChangeGroupPermission:e.onChangeGroupPermission,showPath:t,repoName:e.props.repoName})})))))}}]),t}(c.default.Component);k.propTypes=_,t.default=k},2249:function(e,t){},2250:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(2),h=n(3),m={isPC:d.default.bool,repo:d.default.object.isRequired,isStarred:d.default.bool,onFreezedItem:d.default.func.isRequired,onUnfreezedItem:d.default.func.isRequired,onMenuItemClick:d.default.func.isRequired},g=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMenuItemClick=function(e){var t=h.Utils.getEventData(e,"toggle");n.props.onMenuItemClick(t)},n.onDropdownToggleClick=function(e){n.toggleOperationMenu(e)},n.toggleOperationMenu=function(e){var t=e.target?e.target.dataset:null;if(t&&t.toggle&&"Rename"===t.toggle)return void n.setState({isItemMenuShow:!n.state.isItemMenuShow});n.setState({isItemMenuShow:!n.state.isItemMenuShow},function(){n.state.isItemMenuShow?n.props.onFreezedItem():n.props.onUnfreezedItem()})},n.generatorOperations=function(){var e=n.props.repo,t=f.isPro&&e.encrypted&&f.enableResetEncryptedRepoPassword&&f.isEmailConfigured,r=["Rename","Transfer"];return f.folderPermEnabled&&r.push("Folder Permission"),r.push("Share Links Admin","Divider"),e.encrypted&&r.push("Change Password"),t&&r.push("Reset Password"),r.push("History Setting","API Token"),n.props.isPC&&f.enableRepoSnapshotLabel&&r.push("Label Current State"),r},n.translateOperations=function(e){var t="";switch(e){case"Star":t=(0,f.gettext)("Star");break;case"Unstar":t=(0,f.gettext)("Unstar");break;case"Share":t=(0,f.gettext)("Share");break;case"Delete":t=(0,f.gettext)("Delete");break;case"Rename":t=(0,f.gettext)("Rename");break;case"Transfer":t=(0,f.gettext)("Transfer");break;case"History Setting":t=(0,f.gettext)("History Setting");break;case"Change Password":t=(0,f.gettext)("Change Password");break;case"Reset Password":t=(0,f.gettext)("Reset Password");break;case"Folder Permission":t=(0,f.gettext)("Folder Permission");break;case"Label Current State":t=(0,f.gettext)("Label Current State");break;case"API Token":t="API Token";break;case"Share Links Admin":t=(0,f.gettext)("Share Links Admin")}return t},n.state={isItemMenuShow:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this,t=this.generatorOperations();return this.props.isPC?u.default.createElement(p.Dropdown,{isOpen:this.state.isItemMenuShow,toggle:this.toggleOperationMenu},u.default.createElement(p.DropdownToggle,{tag:"i",className:"sf-dropdown-toggle sf2-icon-caret-down",title:(0,f.gettext)("More Operations"),"data-toggle":"dropdown","aria-expanded":this.state.isItemMenuShow}),u.default.createElement(p.DropdownMenu,null,t.map(function(t,n){return"Divider"==t?u.default.createElement(p.DropdownItem,{key:n,divider:!0}):u.default.createElement(p.DropdownItem,{key:n,"data-toggle":t,onClick:e.onMenuItemClick},e.translateOperations(t))}))):(t.unshift("Delete"),t.unshift("Share"),this.props.isStarred?t.unshift("Unstar"):t.unshift("Star"),u.default.createElement(p.Dropdown,{isOpen:this.state.isItemMenuShow,toggle:this.toggleOperationMenu},u.default.createElement(p.DropdownToggle,{tag:"i",className:"sf-dropdown-toggle fa fa-ellipsis-v ml-0",title:(0,f.gettext)("More Operations"),"data-toggle":"dropdown","aria-expanded":this.state.isItemMenuShow}),u.default.createElement("div",{className:this.state.isItemMenuShow?"":"d-none",onClick:this.toggleOperationMenu},u.default.createElement("div",{className:"mobile-operation-menu-bg-layer"}),u.default.createElement("div",{className:"mobile-operation-menu"},t.map(function(t,n){if("Divider"!=t)return u.default.createElement(p.DropdownItem,{key:n,className:"mobile-menu-item","data-toggle":t,onClick:e.onMenuItemClick},e.translateOperations(t))})))))}}]),t}(u.default.Component);g.propTypes=m,t.default=g},2251:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(82),f=r(p),h=n(2),m={isTextMode:d.default.bool.isRequired,isEditIconShow:d.default.bool.isRequired,currentPermission:d.default.string.isRequired,onPermissionChanged:d.default.func.isRequired},g=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onHideSelect=function(){n.setState({isEditing:!1})},n.onEditPermission=function(e){e.nativeEvent.stopImmediatePropagation(),n.setState({isEditing:!0})},n.onPermissionChanged=function(e){e.value!==n.props.currentPermission&&n.props.onPermissionChanged(e.value),n.setState({isEditing:!1})},n.onSelectHandler=function(e){e.nativeEvent.stopImmediatePropagation()},n.state={isEditing:!1},n.options=[{value:"rw",label:u.default.createElement("div",null,(0,h.gettext)("Read-Write"))},{value:"r",label:u.default.createElement("div",null,(0,h.gettext)("Read-Only"))}],n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.onHideSelect)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.onHideSelect)}},{key:"render",value:function(){var e=this.props,t=e.currentPermission,n=e.isTextMode,r="rw"===t?(0,h.gettext)("Read-Write"):(0,h.gettext)("Read-Only");return u.default.createElement("div",{onClick:this.onSelectHandler},n&&!this.state.isEditing?u.default.createElement(l.Fragment,null,u.default.createElement("span",null,r),this.props.isEditIconShow&&u.default.createElement("span",{title:(0,h.gettext)("Edit"),className:"fa fa-pencil-alt attr-action-icon",onClick:this.onEditPermission})):u.default.createElement(f.default,{options:this.options,placeholder:r,onChange:this.onPermissionChanged,captureMenuScroll:!1}))}}]),t}(u.default.Component);g.propTypes=m,t.default=g},2252:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(2),h={toggleDialog:d.default.func.isRequired},m=function(e){function t(){var e,n,r,i;a(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=r=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),r.toggle=function(){r.props.toggleDialog()},i=n,o(r,i)}return i(t,e),s(t,[{key:"render",value:function(){return u.default.createElement(p.Modal,{isOpen:!0,toggle:this.toggle},u.default.createElement(p.ModalBody,null,u.default.createElement("button",{type:"button",className:"close text-gray",onClick:this.toggle},u.default.createElement("span",{"aria-hidden":"true"},"\xd7")),u.default.createElement("div",{className:"p-2 text-center"},u.default.createElement("img",{src:f.mediaUrl+"img/welcome.png",width:"180",alt:""}),u.default.createElement("h3",{id:"dialogTitle"},(0,f.gettext)("Welcome to {site_name_placeholder}").replace("{site_name_placeholder}",f.siteName)),f.canAddRepo?u.default.createElement("p",null,(0,f.gettext)("{site_name_placeholder} organizes files into libraries. Each library can be synced and shared separately. We have created a personal library for you. You can create more libraries later.").replace("{site_name_placeholder}",f.siteName)):u.default.createElement("p",null,(0,f.gettext)("{site_name_placeholder} organizes files into libraries. Each library can be synced and shared separately. However, since you are a guest user now, you can not create libraries.").replace("{site_name_placeholder}",f.siteName)))))}}]),t}(u.default.Component);m.propTypes=h,t.default=m},2253:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(15),d=n(7),p=r(d),f=n(2),h=n(4),m=n(3),g=n(5),y=r(g),v=n(8),b=r(v),w=n(39),E=r(w),S=n(78),C=r(S);p.default.locale(f.lang);var D=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.refreshDeletedRepoList=function(e){var t=n.state.deletedRepoList.filter(function(t){return t.repo_id!==e});n.setState({deletedRepoList:t})},n.state={deletedRepoList:[],isLoading:!0},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;h.seafileAPI.listDeletedRepo().then(function(t){e.setState({deletedRepoList:t.data,isLoading:!1})}).catch(function(e){var t=m.Utils.getErrorMsg(e);y.default.danger(t)})}},{key:"render",value:function(){return u.default.createElement(l.Fragment,null,u.default.createElement("div",{className:"main-panel-north"},u.default.createElement(C.default,{onSearchedClick:this.props.onSearchedClick})),u.default.createElement("div",{className:"main-panel-center"},u.default.createElement("div",{className:"cur-view-container"},u.default.createElement("div",{className:"cur-view-path"},u.default.createElement("div",{className:"path-container"},u.default.createElement(c.Link,{to:f.siteRoot+"my-libs/"},(0,f.gettext)("My Libraries")),u.default.createElement("span",{className:"path-split"},"/"),u.default.createElement("span",null,(0,f.gettext)("Deleted Libraries")))),u.default.createElement("div",{className:"cur-view-content"},this.state.isLoading&&u.default.createElement(b.default,null),!this.state.isLoading&&0===this.state.deletedRepoList.length&&u.default.createElement(E.default,null,u.default.createElement("h2",null,(0,f.gettext)("No deleted libraries")),u.default.createElement("p",null,(0,f.gettext)("You have not deleted any libraries in the last {placeholder} days. A deleted library will be cleaned automatically after this period.").replace("{placeholder}",f.trashReposExpireDays))),0!==this.state.deletedRepoList.length&&u.default.createElement("div",null,u.default.createElement("p",{className:"tip mt-2"},(0,f.gettext)("Tip: libraries deleted {placeholder} days ago will be cleaned automatically.").replace("{placeholder}",f.trashReposExpireDays)),u.default.createElement(_,{deletedRepoList:this.state.deletedRepoList,refreshDeletedRepoList:this.refreshDeletedRepoList}))))))}}]),t}(l.Component),_=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){var e=this,t=this.props.deletedRepoList;return u.default.createElement("table",null,u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{style:{width:"4%"}}),u.default.createElement("th",{style:{width:"52%"}},(0,f.gettext)("Name")),u.default.createElement("th",{style:{width:"30%"}},(0,f.gettext)("Deleted Time")),u.default.createElement("th",{style:{width:"14%"}}))),u.default.createElement("tbody",null,t&&t.map(function(t){return u.default.createElement(P,{key:t.repo_id,repo:t,refreshDeletedRepoList:e.props.refreshDeletedRepoList})})))}}]),t}(l.Component),P=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseEnter=function(){n.props.isItemFreezed||n.setState({hideRestoreMenu:!1,highlight:!0})},n.onMouseLeave=function(){n.props.isItemFreezed||n.setState({hideRestoreMenu:!0,highlight:!1})},n.restoreDeletedRepo=function(){var e=n.props.repo.repo_id,t=n.props.repo.repo_name;h.seafileAPI.restoreDeletedRepo(e).then(function(r){var a=(0,f.gettext)("Successfully restored the library.")+"  "+t;y.default.success(a),n.props.refreshDeletedRepoList(e)}).catch(function(e){var t=m.Utils.getErrorMsg(e);t===(0,f.gettext)("Error")&&(t=(0,f.gettext)("Failed. Please check the network.")),y.default.danger(t)})},n.state={hideRestoreMenu:!0,highlight:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=p.default.utc(this.props.repo.del_time).toDate();e=(0,p.default)(e).fromNow();var t=m.Utils.getLibIconUrl(this.props.repo);return u.default.createElement("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},u.default.createElement("td",{className:"text-center"},u.default.createElement("img",{src:t,alt:"",width:"24"})),u.default.createElement("td",{className:"name"},this.props.repo.repo_name),u.default.createElement("td",{className:"update"},e),u.default.createElement("td",null,u.default.createElement("span",{onClick:this.restoreDeletedRepo,title:(0,f.gettext)("Restore"),className:"sf2-icon-reply action-icon "+(this.state.highlight?"":"vh")})))}}]),t}(l.Component);t.default=D},2254:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(47),f=r(p),h=n(127),m=r(h),g=n(6),y=n(4),v=n(2),b=n(3),w=n(387),E=r(w),S=n(5),C=r(S),D=n(8),_=r(D),P=n(39),k=r(P),M=n(13),O=r(M),L=n(78),I=r(L),T=n(1023),R=r(T),N=n(2255),x=r(N),F=n(1025),Y=r(F),Z=n(736),j=r(Z),A={onShowSidePanel:d.default.func.isRequired,onSearchedClick:d.default.func.isRequired},B=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onCreateRepo=function(e){y.seafileAPI.createPublicRepo(e).then(function(e){var t={repo_id:e.data.id,repo_name:e.data.name,permission:e.data.permission,size:e.data.size,owner_name:e.data.owner_name,owner_email:e.data.owner,mtime:e.data.mtime,encrypted:e.data.encrypted},r=new E.default(t),a=n.addRepoItem(r);n.setState({repoList:a}),n.onCreateRepoToggle()}).catch(function(e){var t=b.Utils.getErrorMsg(e);C.default.danger(t)})},n.onRepoSelectedHandler=function(e){e.forEach(function(e){y.seafileAPI.selectOwnedRepoToPublic(e.repo_id,{share_type:"public",permission:e.sharePermission}).then(function(){var t=n.addRepoItem(e);n.setState({repoList:t})}).catch(function(e){var t=b.Utils.getErrorMsg(e);C.default.danger(t)})})},n.onItemUnshare=function(e){y.seafileAPI.unshareRepo(e.repo_id,{share_type:"public"}).then(function(){var t=n.state.repoList.filter(function(t){return t.repo_id!==e.repo_id});n.setState({repoList:t});var r=(0,v.gettext)("Successfully unshared {name}").replace("{name}",e.repo_name);C.default.success(r)}).catch(function(t){var n=b.Utils.getErrorMsg(t);n===(0,v.gettext)("Error")&&(n=(0,v.gettext)("Failed to unshare {name}").replace("{name}",e.repo_name)),(0,C.default)(n)})},n.onItemDelete=function(){},n.addRepoItem=function(e){for(var t=!1,r=0,a=n.state.repoList,o=0;o<a.length;o++)if(e.repo_id===a[o].repo_id){t=!0,r=o;break}t&&n.state.repoList.splice(r,1);var i=n.state.repoList.map(function(e){return e});return i.unshift(e),i},n.onAddRepoToggle=function(){n.setState({isCreateMenuShow:!n.state.isCreateMenuShow})},n.onCreateRepoToggle=function(){n.setState({isCreateRepoDialogShow:!n.state.isCreateRepoDialogShow})},n.onSelectRepoToggle=function(){n.setState({isSelectRepoDialpgShow:!n.state.isSelectRepoDialpgShow})},n.sortItems=function(e,t){f.default.save("seafile-repo-dir-sort-by",e),f.default.save("seafile-repo-dir-sort-order",t),n.setState({sortBy:e,sortOrder:t,repoList:b.Utils.sortRepos(n.state.repoList,e,t)})},n.toggleSortOptionsDialog=function(){n.setState({isSortOptionsDialogOpen:!n.state.isSortOptionsDialogOpen})},n.state={isLoading:!0,errMessage:"",emptyTip:"",repoList:[],sortBy:f.default.load("seafile-repo-dir-sort-by")||"name",sortOrder:f.default.load("seafile-repo-dir-sort-order")||"asc",isSortOptionsDialogOpen:!1,libraryType:"public",isCreateMenuShow:!1,isCreateRepoDialogShow:!1,isSelectRepoDialpgShow:!1},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;y.seafileAPI.listRepos({type:"public"}).then(function(t){var n=t.data.repos.map(function(e){return new E.default(e)});e.setState({isLoading:!1,repoList:b.Utils.sortRepos(n,e.state.sortBy,e.state.sortOrder)})}).catch(function(t){e.setState({isLoading:!1,errorMsg:b.Utils.getErrorMsg(t,!0)})})}},{key:"render",value:function(){var e=this.state.errMessage,t=u.default.createElement(k.default,null,u.default.createElement("h2",null,(0,v.gettext)("No public libraries")),u.default.createElement("p",null,(0,v.gettext)('No public libraries have been created yet. A public library is accessible by all users. You can create a public library by clicking the "Add Library" button in the menu bar.')));return u.default.createElement(l.Fragment,null,u.default.createElement("div",{className:"main-panel-north border-left-show"},v.canAddPublicRepo&&u.default.createElement("div",{className:"cur-view-toolbar"},u.default.createElement("span",{className:"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none",title:"Side Nav Menu",onClick:this.props.onShowSidePanel}),u.default.createElement("div",{className:"operation"},u.default.createElement(g.Dropdown,{isOpen:this.state.isCreateMenuShow,toggle:this.onAddRepoToggle},u.default.createElement(m.default,{query:"(min-width: 768px)"},u.default.createElement(g.DropdownToggle,{className:"btn btn-secondary operation-item"},u.default.createElement("i",{className:"fas fa-plus-square text-secondary mr-1"}),(0,v.gettext)("Add Library"))),u.default.createElement(m.default,{query:"(max-width: 767.8px)"},u.default.createElement(g.DropdownToggle,{tag:"span",className:"sf2-icon-plus mobile-toolbar-icon",title:(0,v.gettext)("Add Library")})),u.default.createElement(g.DropdownMenu,null,u.default.createElement(g.DropdownItem,{onClick:this.onSelectRepoToggle},(0,v.gettext)("Share existing libraries")),u.default.createElement(g.DropdownItem,{onClick:this.onCreateRepoToggle},(0,v.gettext)("New Library")))))),u.default.createElement(I.default,{onSearchedClick:this.props.onSearchedClick})),u.default.createElement("div",{className:"main-panel-center"},u.default.createElement("div",{className:"cur-view-container"},u.default.createElement("div",{className:"cur-view-path"},u.default.createElement("h3",{className:"sf-heading m-0"},(0,v.gettext)("Shared with all")),!b.Utils.isDesktop()&&this.state.repoList.length>0&&u.default.createElement("span",{className:"sf3-font sf3-font-sort action-icon",onClick:this.toggleSortOptionsDialog})),u.default.createElement("div",{className:"cur-view-content"},this.state.isLoading&&u.default.createElement(_.default,null),!this.state.isLoading&&e&&e,!this.state.isLoading&&0===this.state.repoList.length&&t,!this.state.isLoading&&this.state.repoList.length>0&&u.default.createElement(Y.default,{libraryType:this.state.libraryType,repoList:this.state.repoList,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems,onItemUnshare:this.onItemUnshare,onItemDelete:this.onItemDelete})))),this.state.isSortOptionsDialogOpen&&u.default.createElement(j.default,{toggleDialog:this.toggleSortOptionsDialog,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems}),this.state.isCreateRepoDialogShow&&u.default.createElement(O.default,null,u.default.createElement(R.default,{libraryType:this.state.libraryType,onCreateToggle:this.onCreateRepoToggle,onCreateRepo:this.onCreateRepo})),this.state.isSelectRepoDialpgShow&&u.default.createElement(O.default,null,u.default.createElement(x.default,{onRepoSelectedHandler:this.onRepoSelectedHandler,onShareRepoDialogClose:this.onSelectRepoToggle})))}}]),t}(u.default.Component);B.propTypes=A,t.default=B},2255:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(7),f=r(p),h=n(6),m=n(4),g=n(2),y=n(3),v=n(387),b=r(v),w={repo:d.default.object.isRequired,onRepoSelect:d.default.func.isRequired,onPermissionChange:d.default.func.isRequired},E=function(e){function t(){var e,n,r,i;a(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=r=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),r.onRepoSelect=function(e){var t=e.target.checked;r.props.onRepoSelect(r.props.repo,t)},r.onPermissionChange=function(e){var t=e.target.value,n=r.props.repo;r.props.onPermissionChange(n,t)},i=n,o(r,i)}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.repo,t=y.Utils.getLibIconUrl(e);return u.default.createElement("tr",null,u.default.createElement("td",{className:"text-center"},u.default.createElement("input",{type:"checkbox",className:"vam",name:"repo",onChange:this.onRepoSelect})),u.default.createElement("td",{className:"text-center"},u.default.createElement("img",{src:t,width:"24",alt:(0,g.gettext)("icon")})),u.default.createElement("td",{className:"name"},e.repo_name),u.default.createElement("td",null,(0,f.default)(e.last_modified).fromNow()),u.default.createElement("td",null,u.default.createElement(h.Input,{style:{height:"1.5rem",padding:0},type:"select",name:"select",onChange:this.onPermissionChange,value:e.sharePermission},u.default.createElement("option",{value:"rw"},(0,g.gettext)("Read-Write")),u.default.createElement("option",{value:"r"},(0,g.gettext)("Read-Only")))))}}]),t}(u.default.Component);E.propTypes=w;var S={onRepoSelectedHandler:d.default.func.isRequired,onShareRepoDialogClose:d.default.func.isRequired},C=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onRepoSelect=function(e,t){var r=[];t?(n.state.selectedRepoList.push(e),r=n.state.selectedRepoList):r=n.state.selectedRepoList.filter(function(t){return t.repo_id!==e.repo_id}),n.setState({selectedRepoList:r})},n.onPermissionChange=function(e,t){var r=n.state.repoList.map(function(n){return n.repo_id===e.repo_id&&(n.sharePermission=t),n});n.setState({repoList:r})},n.handleSubmit=function(){if(0===n.state.selectedRepoList.length){var e=(0,g.gettext)("Please select a library to share.");return void n.setState({errMessage:e})}n.props.onRepoSelectedHandler(n.state.selectedRepoList),n.onCloseDialog()},n.onCloseDialog=function(){n.props.onShareRepoDialogClose()},n.state={repoList:[],currentRepo:null,permission:"rw",selectedRepoList:[],errMessage:""},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;m.seafileAPI.listRepos({type:"mine"}).then(function(t){var n=t.data.repos.map(function(e){var t=new b.default(e);return t.sharePermission="rw",t});e.setState({repoList:n})})}},{key:"render",value:function(){var e=this;return u.default.createElement(h.Modal,{isOpen:!0},u.default.createElement(h.ModalHeader,{toggle:this.toggle},(0,g.gettext)("Select libraries to share")),u.default.createElement(h.ModalBody,{className:"dialog-list-container"},u.default.createElement("table",null,u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:"4%"}),u.default.createElement("th",{width:"6%"}),u.default.createElement("th",{width:"35%"},(0,g.gettext)("Name")),u.default.createElement("th",{width:"25%"},(0,g.gettext)("Last Update")),u.default.createElement("th",{width:"30%"},(0,g.gettext)("Permission")))),u.default.createElement("tbody",null,this.state.repoList.map(function(t,n){return u.default.createElement(E,{key:n,repo:t,onRepoSelect:e.onRepoSelect,onPermissionChange:e.onPermissionChange})})))),this.state.errMessage&&u.default.createElement(h.Alert,{color:"danger",className:"mt-2"},this.state.errMessage),u.default.createElement(h.ModalFooter,null,u.default.createElement(h.Button,{color:"secondary",onClick:this.onCloseDialog},(0,g.gettext)("Close")),u.default.createElement(h.Button,{color:"primary",onClick:this.handleSubmit},(0,g.gettext)("Submit"))))}}]),t}(u.default.Component);C.propTypes=S,t.default=C},2256:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(7),f=r(p),h=n(6),m=n(15),g=n(3),y=n(2),v=n(13),b=r(v),w=n(108),E=r(w),S=n(743),C=r(S),D=n(388),_=r(D),P=n(1311),k=r(P),M=n(1312),O=r(M),L=n(1024),I=r(L),T=n(4),R=n(1310),N=r(R),x=n(5),F=r(x),Y=n(1313),Z=r(Y),j=n(1314),A=r(j),B={currentGroup:d.default.object,libraryType:d.default.string,repo:d.default.object.isRequired,isItemFreezed:d.default.bool.isRequired,onFreezedItem:d.default.func.isRequired,onUnfreezedItem:d.default.func.isRequired,onItemUnshare:d.default.func.isRequired,onItemDetails:d.default.func,onItemRename:d.default.func,onItemDelete:d.default.func},X=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseEnter=function(){n.props.isItemFreezed||n.setState({highlight:!0,isOperationShow:!0})},n.onMouseOver=function(){n.props.isItemFreezed||n.setState({highlight:!0,isOperationShow:!0})},n.onMouseLeave=function(){n.props.isItemFreezed||n.setState({highlight:!1,isOperationShow:!1})},n.clickOperationMenuToggle=function(e){n.toggleOperationMenu(e)},n.toggleOperationMenu=function(e){var t=e.target?e.target.dataset:null;if(t&&t.toggle&&"Rename"===t.toggle)return void n.setState({isItemMenuShow:!n.state.isItemMenuShow});n.setState({isItemMenuShow:!n.state.isItemMenuShow},function(){n.state.isItemMenuShow?n.props.onFreezedItem():(n.props.onUnfreezedItem(),n.setState({highlight:!1,isOperationShow:!1}))})},n.getRepoComputeParams=function(){var e=n.props.repo;return{iconUrl:g.Utils.getLibIconUrl(e),iconTitle:g.Utils.getLibIconTitle(e),libPath:y.siteRoot+"library/"+e.repo_id+"/"+g.Utils.encodePath(e.repo_name)+"/"}},n.onMenuItemClick=function(e){switch(e.target.dataset.toggle){case"Rename":n.onItemRenameToggle();break;case"Folder Permission":n.onItemFolderPermissionToggle();break;case"Details":n.onItemDetails();break;case"Share":n.onItemShare();break;case"Unshare":n.onItemUnshare();break;case"History Setting":n.onHistorySettingToggle();break;case"API Token":n.onAPITokenToggle();break;case"Share Links Admin":n.toggleRepoShareUploadLinksDialog();break;case"Change Password":n.onChangePasswordToggle();break;case"Reset Password":n.onResetPasswordToggle()}},n.onItemRenameToggle=function(){n.props.onFreezedItem(),n.setState({isRenaming:!n.state.isRenaming,isOperationShow:!n.state.isOperationShow})},n.onRenameConfirm=function(e){n.props.onItemRename(n.props.repo,e),n.onRenameCancel()},n.onRenameCancel=function(){n.props.onUnfreezedItem(),n.setState({isRenaming:!n.state.isRenaming})},n.onItemFolderPermissionToggle=function(){n.setState({isFolderPermissionDialogOpen:!n.state.isFolderPermissionDialogOpen})},n.onHistorySettingToggle=function(){n.setState({isHistorySettingDialogShow:!n.state.isHistorySettingDialogShow})},n.onItemDetails=function(){n.props.onItemDetails(n.props.repo)},n.onItemShare=function(){n.setState({isShowSharedDialog:!0})},n.onItemUnshare=function(){n.props.onItemUnshare(n.props.repo)},n.onItemDeleteToggle=function(){n.setState({isDeleteDialogShow:!n.state.isDeleteDialogShow})},n.onItemDelete=function(){var e=n.props,t=e.currentGroup,r=e.repo;if(t){var a=t.id;T.seafileAPI.deleteGroupOwnedLibrary(a,r.repo_id).then(function(){n.setState({isRepoDeleted:!0,isDeleteDialogShow:!1}),n.props.onItemDelete(r);var e=r.repo_name,t=(0,y.gettext)("Successfully deleted {name}.").replace("{name}",e);F.default.success(t)}).catch(function(e){var t=g.Utils.getErrorMsg(e);if(t===(0,y.gettext)("Error")){var a=r.repo_name;t=(0,y.gettext)("Failed to delete {name}.").replace("{name}",a)}F.default.danger(t),n.setState({isRepoDeleted:!1})})}},n.toggleShareDialog=function(){n.setState({isShowSharedDialog:!1})},n.toggleRepoShareUploadLinksDialog=function(){n.setState({isRepoShareUploadLinksDialogOpen:!n.state.isRepoShareUploadLinksDialogOpen})},n.onAPITokenToggle=function(){n.setState({isAPITokenDialogShow:!n.state.isAPITokenDialogShow})},n.onChangePasswordToggle=function(){n.setState({isChangePasswordDialogShow:!n.state.isChangePasswordDialogShow})},n.onResetPasswordToggle=function(){n.setState({isResetPasswordDialogShow:!n.state.isResetPasswordDialogShow})},n.translateMenuItem=function(e){var t="";switch(e){case"Rename":t=(0,y.gettext)("Rename");break;case"Folder Permission":t=(0,y.gettext)("Folder Permission");break;case"Details":t=(0,y.gettext)("Details");break;case"Unshare":t=(0,y.gettext)("Unshare");break;case"Share":t=(0,y.gettext)("Share");break;case"History Setting":t=(0,y.gettext)("History Setting");break;case"Share Links Admin":t=(0,y.gettext)("Share Links Admin");break;case"Change Password":t=(0,y.gettext)("Change Password");break;case"Reset Password":t=(0,y.gettext)("Reset Password");break;case"API Token":t="API Token"}return t},n.generatorOperations=function(){var e=n.props,t=e.repo,r=e.currentGroup,a=r&&r.admins&&r.admins.indexOf(y.username)>-1,o=t.owner_email===y.username,i=t.is_admin,s=[];return y.isPro?-1!=t.owner_email.indexOf("@seafile_group")?a&&(t.owner_email==r.id+"@seafile_group"?(n.isDeparementOnwerGroupMember=!0,s=["Rename"],y.folderPermEnabled&&s.push("Folder Permission"),s.push("Share Links Admin"),t.encrypted&&s.push("Change Password"),t.encrypted&&y.enableResetEncryptedRepoPassword&&y.isEmailConfigured&&s.push("Reset Password"),s.push("History Setting","API Token","Details")):s.push("Unshare")):((o||i)&&s.push("Share"),(a||o||i)&&s.push("Unshare")):(o&&s.push("Share"),(a||o)&&s.push("Unshare")),s},n.generatorMobileMenu=function(){var e=[];if(n.props.libraryType&&"public"===n.props.libraryType){var t=n.props.repo.owner_email===y.username;(y.isSystemStaff||t)&&e.push("Unshare")}else e=n.generatorOperations(),n.isDeparementOnwerGroupMember&&(e.unshift("Unshare"),e.unshift("Share"));return e.length?u.default.createElement(h.Dropdown,{isOpen:n.state.isItemMenuShow,toggle:n.toggleOperationMenu},u.default.createElement(h.DropdownToggle,{tag:"i",className:"sf-dropdown-toggle fa fa-ellipsis-v ml-0",title:(0,y.gettext)("More Operations"),"data-toggle":"dropdown","aria-expanded":n.state.isItemMenuShow,onClick:n.clickOperationMenuToggle}),u.default.createElement("div",{className:n.state.isItemMenuShow?"":"d-none",onClick:n.toggleOperationMenu},u.default.createElement("div",{className:"mobile-operation-menu-bg-layer"}),u.default.createElement("div",{className:"mobile-operation-menu"},e.map(function(e,t){return u.default.createElement(h.DropdownItem,{key:t,"data-toggle":e,onClick:n.onMenuItemClick},n.translateMenuItem(e))})))):null},n.generatorPCMenu=function(){var e=[];if(n.props.libraryType&&"public"===n.props.libraryType){var t=n.props.repo.owner_email===y.username;(y.isSystemStaff||t)&&e.push("Unshare")}else e=n.generatorOperations();var r=u.default.createElement("a",{href:"#",className:"op-icon sf2-icon-share",title:(0,y.gettext)("Share"),onClick:n.onItemShare}),a=u.default.createElement("a",{href:"#",className:"op-icon sf2-icon-x3",title:(0,y.gettext)("Unshare"),onClick:n.onItemUnshare}),o=u.default.createElement("a",{href:"#",className:"op-icon sf2-icon-delete",title:(0,y.gettext)("Delete"),onClick:n.onItemDeleteToggle});return n.isDeparementOnwerGroupMember?u.default.createElement(l.Fragment,null,r,o,u.default.createElement(h.Dropdown,{isOpen:n.state.isItemMenuShow,toggle:n.toggleOperationMenu},u.default.createElement(h.DropdownToggle,{tag:"i",className:"sf-dropdown-toggle sf2-icon-caret-down",title:(0,y.gettext)("More Operations"),"data-toggle":"dropdown","aria-expanded":n.state.isItemMenuShow,onClick:n.clickOperationMenuToggle}),u.default.createElement(h.DropdownMenu,null,e.map(function(e,t){return u.default.createElement(h.DropdownItem,{key:t,"data-toggle":e,onClick:n.onMenuItemClick},n.translateMenuItem(e))})))):2==e.length?u.default.createElement(l.Fragment,null,r,a):1==e.length&&"Share"===e[0]?r:1==e.length&&"Unshare"===e[0]?a:null},n.onStarRepo=function(){n.state.isStarred?T.seafileAPI.unstarItem(n.props.repo.repo_id,"/").then(function(){n.setState({isStarred:!n.state.isStarred})}).catch(function(e){var t=g.Utils.getErrorMsg(e);F.default.danger(t)}):T.seafileAPI.starItem(n.props.repo.repo_id,"/").then(function(){n.setState({isStarred:!n.state.isStarred})}).catch(function(e){var t=g.Utils.getErrorMsg(e);F.default.danger(t)})},n.renderPCUI=function(){var e=n.getRepoComputeParams(),t=e.iconUrl,r=e.iconTitle,a=e.libPath,o=n.props.repo;return u.default.createElement(l.Fragment,null,u.default.createElement("tr",{className:n.state.highlight?"tr-highlight":"",onMouseEnter:n.onMouseEnter,onMouseOver:n.onMouseOver,onMouseLeave:n.onMouseLeave},u.default.createElement("td",{className:"text-center"},!n.state.isStarred&&u.default.createElement("i",{className:"far fa-star star-empty cursor-pointer",onClick:n.onStarRepo}),n.state.isStarred&&u.default.createElement("i",{className:"fas fa-star cursor-pointer",onClick:n.onStarRepo})),u.default.createElement("td",null,u.default.createElement("img",{src:t,title:r,alt:r,width:"24"})),u.default.createElement("td",null,n.state.isRenaming?u.default.createElement(I.default,{name:o.repo_name,onRenameConfirm:n.onRenameConfirm,onRenameCancel:n.onRenameCancel}):u.default.createElement(m.Link,{to:a},o.repo_name)),u.default.createElement("td",null,n.state.isOperationShow&&n.generatorPCMenu()),u.default.createElement("td",null,o.size),u.default.createElement("td",{title:(0,f.default)(o.last_modified).format("llll")},(0,f.default)(o.last_modified).fromNow()),u.default.createElement("td",{title:o.owner_contact_email},o.owner_name)))},n.visitRepo=function(){n.state.isRenaming||(0,m.navigate)(n.repoURL)},n.renderMobileUI=function(){var e=n.getRepoComputeParams(),t=e.iconUrl,r=e.iconTitle,a=e.libPath,o=n.props.repo;return n.repoURL=a,u.default.createElement(l.Fragment,null,u.default.createElement("tr",{className:n.state.highlight?"tr-highlight":"",onMouseEnter:n.onMouseEnter,onMouseOver:n.onMouseOver,onMouseLeave:n.onMouseLeave},u.default.createElement("td",{onClick:n.visitRepo},u.default.createElement("img",{src:t,title:r,width:"24",alt:r})),u.default.createElement("td",{onClick:n.visitRepo},n.state.isRenaming?u.default.createElement(I.default,{name:o.repo_name,onRenameConfirm:n.onRenameConfirm,onRenameCancel:n.onRenameCancel}):u.default.createElement(m.Link,{to:a},o.repo_name),u.default.createElement("br",null),u.default.createElement("span",{className:"item-meta-info",title:o.owner_contact_email},o.owner_name),u.default.createElement("span",{className:"item-meta-info"},o.size),u.default.createElement("span",{className:"item-meta-info",title:(0,f.default)(o.last_modified).format("llll")},(0,f.default)(o.last_modified).fromNow())),u.default.createElement("td",null,n.generatorMobileMenu())))},n.state={highlight:!1,isOperationShow:!1,isItemMenuShow:!1,isShowSharedDialog:!1,isRenaming:!1,isStarred:n.props.repo.starred,isFolderPermissionDialogOpen:!1,isHistorySettingDialogShow:!1,isDeleteDialogShow:!1,isAPITokenDialogShow:!1,isRepoShareUploadLinksDialogOpen:!1,isRepoDeleted:!1,isChangePasswordDialogShow:!1,isResetPasswordDialogShow:!1},n.isDeparementOnwerGroupMember=!1,n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.repo,t=e.owner_email.indexOf("@seafile_group")>-1;return u.default.createElement(l.Fragment,null,g.Utils.isDesktop()?this.renderPCUI():this.renderMobileUI(),this.state.isShowSharedDialog&&u.default.createElement(b.default,null,u.default.createElement(E.default,{itemType:"library",itemName:e.repo_name,itemPath:"/",repoID:e.repo_id,repoEncrypted:e.encrypted,enableDirPrivateShare:!0,userPerm:e.permission,isAdmin:e.is_admin,isGroupOwnedRepo:t,toggleDialog:this.toggleShareDialog})),this.state.isFolderPermissionDialogOpen&&u.default.createElement(b.default,null,u.default.createElement(C.default,{toggleDialog:this.onItemFolderPermissionToggle,repoID:e.repo_id,repoName:e.repo_name,isDepartmentRepo:!0})),this.state.isDeleteDialogShow&&u.default.createElement(b.default,null,u.default.createElement(_.default,{repo:this.props.repo,isRepoDeleted:this.state.isRepoDeleted,onDeleteRepo:this.onItemDelete,toggle:this.onItemDeleteToggle})),this.state.isHistorySettingDialogShow&&u.default.createElement(b.default,null,u.default.createElement(N.default,{repoID:e.repo_id,itemName:e.repo_name,toggleDialog:this.onHistorySettingToggle})),this.state.isAPITokenDialogShow&&u.default.createElement(b.default,null,u.default.createElement(Z.default,{repo:e,onRepoAPITokenToggle:this.onAPITokenToggle})),this.state.isRepoShareUploadLinksDialogOpen&&u.default.createElement(b.default,null,u.default.createElement(A.default,{repo:e,toggleDialog:this.toggleRepoShareUploadLinksDialog})),this.state.isChangePasswordDialogShow&&u.default.createElement(b.default,null,u.default.createElement(k.default,{repoID:e.repo_id,repoName:e.repo_name,toggleDialog:this.onChangePasswordToggle})),this.state.isResetPasswordDialogShow&&u.default.createElement(b.default,null,u.default.createElement(O.default,{repoID:e.repo_id,toggleDialog:this.onResetPasswordToggle})))}}]),t}(u.default.Component);X.propTypes=B,t.default=X},2257:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(a,o){try{var i=t[a](o),s=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});e(s)}return r("next")})}}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function l(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),d=r(c),p=n(1),f=r(p),h=n(47),m=r(h),g=n(7),y=r(g),v=n(2),b=n(4),w=n(3),E=n(2258),S=r(E),C=n(43),D=r(C),_=n(72),P=r(_),k=n(726),M=r(k),O=n(84),L=r(O),I=n(34),T=r(I),R=n(75),N=r(R),x=n(5),F=r(x),Y=n(13),Z=r(Y),j=n(2259),A=r(j),B=n(2261),X=r(B),J=n(2266),U=r(J),H=n(2293),G=r(H),q=n(2300),Q=r(q),W={pathPrefix:f.default.array.isRequired,onTabNavClick:f.default.func.isRequired,onMenuClick:f.default.func.isRequired,repoID:f.default.string},K=function(e){function t(e){i(this,t);var n=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.showDirentDetail=function(e){e?n.setState({direntDetailPanelTab:e},function(){n.setState({isDirentDetailShow:!0})}):n.setState({direntDetailPanelTab:"",isDirentDetailShow:!0})},n.toggleDirentDetail=function(){n.setState({direntDetailPanelTab:"",isDirentDetailShow:!n.state.isDirentDetailShow})},n.closeDirentDetail=function(){n.setState({isDirentDetailShow:!1,direntDetailPanelTab:""})},n.onpopstate=function(e){if(e.state&&e.state.key){if("/"===n.state.path)return;n.loadDirentList("/"),n.setState({path:"/",isViewFile:!1})}else if(e.state&&e.state.path){var t=e.state.path;if("column"===n.state.currentMode&&w.Utils.isMarkdownFile(t))return void n.showFile(t);n.loadDirentList(t),n.setState({path:t,isViewFile:!1})}},n.onRepoUpdateEvent=function(){var e=new Date;if(!(parseFloat(e-n.lastModifyTime)/1e3<=5)){var t=n.props.repoID,r=n.state,a=r.path,o=r.dirID;"column"===n.state.currentMode&&n.state.isViewFile?n.updataColumnMarkdownData(a):b.seafileAPI.dirMetaData(t,a).then(function(e){e.data.id!==o&&n.loadDirentList(a)}).catch(function(e){var t=w.Utils.getErrorMsg(e);F.default.danger(t)})}},n.updateUsedRepoTags=function(){var e=n.props.repoID;b.seafileAPI.listRepoTags(e).then(function(e){var t=[];e.data.repo_tags.forEach(function(e){var n=new M.default(e);n.fileCount>0&&t.push(n)}),n.setState({usedRepoTags:t})}).catch(function(e){var t=w.Utils.getErrorMsg(e);F.default.danger(t)})},n.updateReadmeMarkdown=function(e){n.setState({readmeMarkdown:null}),e.some(function(e){var t=e.name.toLowerCase();if("readme.md"===t||"readme.markdown"===t)return n.setState({readmeMarkdown:e}),!0})},n.updataColumnMarkdownData=function(e){var t=n.props.repoID;n.setState({path:e,isViewFile:!0}),b.seafileAPI.getFileInfo(t,e).then(function(r){var a=r.data,o=a.mtime,i=a.permission,s=a.last_modifier_name,l=a.is_draft,u=a.has_draft,c=a.draft_id;b.seafileAPI.getFileDownloadLink(t,e).then(function(e){b.seafileAPI.getFileContent(e.data).then(function(e){n.state.content!==e.data&&n.setState({isFileLoading:!0}),n.setState({content:e.data,filePermission:i,latestContributor:s,lastModified:y.default.unix(o).fromNow(),isFileLoading:!1,isFileLoadedErr:!1,isDraft:l,hasDraft:u,draftID:c})})})}).catch(function(){n.setState({isFileLoading:!1,isFileLoadedErr:!0})})},n.loadDirData=function(e){var t=n.props.repoID;S.default.watchRepo(t,n.onRepoUpdateEvent),n.updateUsedRepoTags(),v.isDocs&&b.seafileAPI.getRepoDraftCounts(t).then(function(e){n.setState({draftCounts:e.data.draft_counts})}).catch(function(e){var t=w.Utils.getErrorMsg(e);F.default.danger(t)}),w.Utils.isMarkdownFile(e)?b.seafileAPI.getFileInfo(n.props.repoID,e).then(function(){"column"!==n.state.currentMode&&(m.default.save("seafile_view_mode","column"),n.setState({currentMode:"column"})),n.loadSidePanel(e),n.showFile(e)}).catch(function(){"column"===n.state.currentMode?(n.loadSidePanel(e),n.showDir(e)):n.showDir(e)}):"column"===n.state.currentMode?(n.loadSidePanel(e),n.showDir(e)):n.showDir(e)},n.loadSidePanel=function(e){var t=n.props.repoID;"/"===e?b.seafileAPI.listDir(t,"/").then(function(e){var t=n.state.treeData;n.addResponseListToNode(e.data.dirent_list,t.root),n.setState({isTreeDataLoading:!1,treeData:t})}).catch(function(){n.setState({isTreeDataLoading:!1})}):n.loadNodeAndParentsByPath(e)},n.showDir=function(e){var t=n.props.repoID;if(n.state.isSessionExpired||n.setState({isDirentListLoading:!0,isViewFile:!1,selectedDirentList:[]}),n.loadDirentList(e),n.resetShowLength(),!n.isNeedUpdateHistoryState)return void(n.isNeedUpdateHistoryState=!0);var r=n.state.currentRepoInfo,a=v.siteRoot+"library/"+t+"/"+encodeURIComponent(r.repo_name)+w.Utils.encodePath(e);window.history.pushState({url:a,path:e},e,a)},n.showFile=function(e){var t=n.props.repoID;"column"===n.state.currentMode&&(b.seafileAPI.listFileTags(t,e).then(function(e){var t=e.data.file_tags.map(function(e){return new P.default(e)});n.setState({fileTags:t})}).catch(function(e){var t=w.Utils.getErrorMsg(e);F.default.danger(t)}),b.seafileAPI.listRelatedFiles(t,e).then(function(e){var t=e.data.related_files.map(function(e){return e});n.setState({relatedFiles:t})}).catch(function(e){500===e.response.status&&n.setState({relatedFiles:[]})})),n.setState({isFileLoading:!0,path:e,isViewFile:!0}),b.seafileAPI.getFileInfo(t,e).then(function(r){var a=r.data,o=a.mtime,i=a.permission,s=a.last_modifier_name,l=a.is_draft,u=a.has_draft,c=a.draft_id;b.seafileAPI.getFileDownloadLink(t,e).then(function(e){b.seafileAPI.getFileContent(e.data).then(function(e){n.setState({content:e.data,filePermission:i,latestContributor:s,lastModified:y.default.unix(o).fromNow(),isFileLoading:!1,isFileLoadedErr:!1,isDraft:l,hasDraft:u,draftID:c})})})}).catch(function(e){var t=w.Utils.getErrorMsg(e,!0);e.response&&403===e.response.status||F.default.danger(t),n.setState({isFileLoading:!1,isFileLoadedErr:!0})});var r=n.state.currentRepoInfo,a=v.siteRoot+"library/"+t+"/"+encodeURIComponent(r.repo_name)+w.Utils.encodePath(e);window.history.pushState({url:a,path:e},e,a)},n.loadDirentList=function(e){var t=n.props.repoID;b.seafileAPI.listDir(t,e,{with_thumbnail:!0}).then(function(r){var a=[],o=null;r.data.dirent_list.forEach(function(e){var t=e.name.toLowerCase();"readme.md"!==t&&"readme.markdown"!==t||(o=e);var n=new D.default(e);a.push(n)}),n.setState({pathExist:!0,userPerm:r.data.user_perm,isDirentListLoading:!1,direntList:w.Utils.sortDirents(a,n.state.sortBy,n.state.sortOrder),dirID:r.data.dir_id,readmeMarkdown:o,path:e,isSessionExpired:!1}),!n.state.repoEncrypted&&a.length&&n.getThumbnails(t,e,n.state.direntList)}).catch(function(e){if(w.Utils.getErrorMsg(e,!0),e.response&&403===e.response.status)return void n.setState({isDirentListLoading:!1});n.setState({isDirentListLoading:!1,pathExist:!1})})},n.onListContainerScroll=function(){var e=n.state.itemsShowLength+100;n.setState({itemsShowLength:e})},n.resetShowLength=function(){n.setState({itemsShowLength:100})},n.getThumbnails=function(e,t,r){var a=r.filter(function(e){return w.Utils.imageCheck(e.name)&&!e.encoded_thumbnail_src});if(0!=a.length){var o=n,i=a.length;!function n(s){var l=a[s],u=[t,l.name].join("/");b.seafileAPI.createThumbnail(e,u,48).then(function(e){l.encoded_thumbnail_src=e.data.encoded_thumbnail_src}).catch(function(e){}).then(function(){s<i-1?n(++s):o.setState({direntList:r})})}(0)}},n.updateMoveCopyTreeNode=function(e){var t=n.props.repoID,r=n.state.treeData.clone(),a=r.getNodeByPath(e),o=a.children.map(function(e){return e.object}),i=o.map(function(e){return e.name});b.seafileAPI.listDir(t,e).then(function(t){t.data.dirent_list.filter(function(e){return!i.includes(e.name)}).map(function(t){n.addNodeToTree(t.name,e,t.type)})}).catch(function(e){var t=w.Utils.getErrorMsg(e);F.default.danger(t)})},n.cancelCopyMoveDirent=function(){var e=n.state.asyncCopyMoveTaskId;b.seafileAPI.cancelCopyMoveOperation(e),n.currentMoveItemName="",n.currentMoveItemPath="";var t=n.state.direntList;n.setState({direntList:t.slice(0)})},n.onMoveProgressDialogToggle=function(){100!==n.state.asyncOperationProgress&&n.cancelCopyMoveDirent(),n.setState({asyncOperationProgress:0,isCopyMoveProgressDialogShow:!1})},n.onMoveItems=function(e,t){var r=n.props.repoID,a=n.state.selectedDirentList;r!==e.repo_id&&n.setState(function(){return{asyncOperatedFilesLength:a.length,asyncOperationProgress:0,asyncOperationType:"move",isCopyMoveProgressDialogShow:!0}});var o=n.getSelectedDirentNames(),i=n.getSelectedDirentPaths();b.seafileAPI.moveDir(r,e.repo_id,t,n.state.path,o).then(function(a){if(r!==e.repo_id&&n.setState({asyncCopyMoveTaskId:a.data.task_id},function(){n.getAsyncCopyMoveProgress()}),r===e.repo_id){"column"===n.state.currentMode&&n.deleteTreeNodes(i),n.moveDirents(o),"column"===n.state.currentMode&&n.updateMoveCopyTreeNode(t);var s=w.Utils.getMoveSuccessMessage(o);F.default.success(s)}}).catch(function(e){var t=w.Utils.getErrorMsg(e);t===(0,v.gettext)("Error")&&(t=w.Utils.getMoveFailedMessage(o)),n.setState({asyncOperationProgress:0,isCopyMoveProgressDialogShow:!1}),F.default.danger(t)})},n.onCopyItems=function(e,t){var r=n.props.repoID,a=n.state.selectedDirentList;r!==e.repo_id&&n.setState({asyncOperatedFilesLength:a.length,asyncOperationProgress:0,asyncOperationType:"copy",isCopyMoveProgressDialogShow:!0});var o=n.getSelectedDirentNames();b.seafileAPI.copyDir(r,e.repo_id,t,n.state.path,o).then(function(a){if(r!==e.repo_id&&n.setState({asyncCopyMoveTaskId:a.data.task_id},function(){n.getAsyncCopyMoveProgress()}),r===e.repo_id){"column"===n.state.currentMode&&n.updateMoveCopyTreeNode(t),t===n.state.path&&n.loadDirentList(n.state.path);var i=w.Utils.getCopySuccessfulMessage(o);F.default.success(i)}}).catch(function(e){var t=w.Utils.getErrorMsg(e);t===(0,v.gettext)("Error")&&(t=w.Utils.getCopyFailedMessage(o)),F.default.danger(t)})},n.onDeleteItems=function(){var e=n.props.repoID,t=n.getSelectedDirentPaths(),r=n.getSelectedDirentNames();n.setState({updateDetail:!n.state.updateDetail}),b.seafileAPI.deleteMutipleDirents(e,n.state.path,r).then(function(e){"column"===n.state.currentMode&&n.deleteTreeNodes(t),n.deleteDirents(r);var a="";t.length>1?(a=(0,v.gettext)("Successfully deleted {name} and other {n} items."),a=a.replace("{name}",r[0]),a=a.replace("{n}",r.length-1)):(a=(0,v.gettext)("Successfully deleted {name}."),a=a.replace("{name}",r[0])),F.default.success(a)}).catch(function(e){var t=w.Utils.getErrorMsg(e);t===(0,v.gettext)("Error")&&(t=(0,v.gettext)("Failed to delete {name} and other {n} items."),t=t.replace("{name}",r[0]),t=t.replace("{n}",r.length-1)),F.default.danger(t)})},n.onAddFolder=function(e){var t=n.props.repoID;b.seafileAPI.createDir(t,e).then(function(){var t=w.Utils.getFileName(e),r=w.Utils.getDirName(e);"column"===n.state.currentMode&&n.addNodeToTree(t,r,"dir"),r!==n.state.path||n.state.isViewFile||n.addDirent(t,"dir")}).catch(function(e){var t=w.Utils.getErrorMsg(e);F.default.danger(t)})},n.onAddFile=function(e,t){var r=n.props.repoID;b.seafileAPI.createFile(r,e,t).then(function(t){var r=w.Utils.getFileName(e),a=w.Utils.getDirName(e);"column"===n.state.currentMode&&n.addNodeToTree(r,a,"file"),a!==n.state.path||n.state.isViewFile||n.addDirent(r,"file",t.data.size)}).catch(function(e){var t=w.Utils.getErrorMsg(e);F.default.danger(t)})},n.switchViewMode=function(e){if(e!==n.state.currentMode){if("detail"===e)return void n.toggleDirentDetail();m.default.save("seafile_view_mode",e);var t=n.state.path;if("column"===n.state.currentMode&&n.state.isViewFile){t=w.Utils.getDirName(t),n.setState({path:t,isViewFile:!1});var r=n.state.currentRepoInfo,a=v.siteRoot+"library/"+r.repo_id+"/"+encodeURIComponent(r.repo_name)+w.Utils.encodePath(t);window.history.pushState({url:a,path:t},t,a)}"column"===e&&n.loadSidePanel(n.state.path),n.isNeedUpdateHistoryState=!1,n.setState({currentMode:e}),n.showDir(t)}},n.onSearchedClick=function(e){var t=e.is_dir?e.path.slice(0,e.path.length-1):e.path;if(n.state.currentPath!==t)if("column"===n.state.currentMode){for(var r=-1,a=w.Utils.getPaths(t),o=0;o<a.length;o++){var i=n.state.treeData.getNodeByPath(i);if(!i){r=o;break}}if(-1===r){var s=n.state.treeData.getNodeByPath(t);n.setState({currentNode:s})}else n.loadNodeAndParentsByPath(t);if(e.is_dir)n.showDir(t);else if(w.Utils.isMarkdownFile(t))n.showFile(t);else{var l=v.siteRoot+"lib/"+e.repo_id+"/file"+w.Utils.encodePath(t),u=w.Utils.isWeChat();if(u)location.href=l;else{var c=window.open("about:blank");c.location.href=l}}}else if(e.is_dir)n.showDir(t);else{var d=v.siteRoot+"lib/"+e.repo_id+"/file"+w.Utils.encodePath(t),p=w.Utils.isWeChat();if(p)location.href=d;else{var f=window.open("about:blank");f.location.href=d}}},n.onMainNavBarClick=function(e){if(n.resetSelected(),"column"===n.state.currentMode){var t=n.state.treeData.clone(),r=t.getNodeByPath(e);t.expandNode(r),n.setState({treeData:t,currentNode:r})}n.showDir(e)},n.onLinkClick=function(e){var t=e,r=n.props.repoID;if(w.Utils.isInternalMarkdownLink(t,r)){var a=w.Utils.getPathFromInternalMarkdownLink(t,r);n.showFile(a)}else if(w.Utils.isInternalDirLink(t,r)){var o=w.Utils.getPathFromInternalDirLink(t,r);n.showDir(o)}else window.open(t)},n.onMainPanelItemRename=function(e,t){var r=w.Utils.joinPath(n.state.path,e.name);n.renameItem(r,e.isDir(),t)},n.onMainPanelItemDelete=function(e){var t=w.Utils.joinPath(n.state.path,e.name);n.deleteItem(t,e.isDir())},n.onRenameTreeNode=function(e,t){n.renameItem(e.path,e.object.isDir(),t)},n.onDeleteTreeNode=function(e){n.deleteItem(e.path,e.object.isDir())},n.renameItem=function(e,t,r){var a=n.props.repoID;t?b.seafileAPI.renameDir(a,e,r).then(function(){n.renameItemAjaxCallback(e,r)}).catch(function(t){var n=w.Utils.getErrorMsg(t);if(n===(0,v.gettext)("Error")){var r=w.Utils.getFileName(e);n=(0,v.gettext)("Renaming {name} failed").replace("{name}",r)}F.default.danger(n)}):b.seafileAPI.renameFile(a,e,r).then(function(){n.renameItemAjaxCallback(e,r)}).catch(function(t){var n=w.Utils.getErrorMsg(t);if(n===(0,v.gettext)("Error")){var r=w.Utils.getFileName(e);n=(0,v.gettext)("Renaming {name} failed").replace("{name}",r)}F.default.danger(n)})},n.onMoveItem=function(e,t,r,a){var o=n.props.repoID,i=t.name;a||(a=n.state.path);var s=w.Utils.joinPath(a,i);o!==e.repo_id&&n.setState({asyncOperatedFilesLength:1,asyncOperationProgress:0,asyncOperationType:"move",isCopyMoveProgressDialogShow:!0}),b.seafileAPI.moveDir(o,e.repo_id,r,a,i).then(function(t){if(o!==e.repo_id&&n.setState({asyncCopyMoveTaskId:t.data.task_id},function(){n.currentMoveItemName=i,n.currentMoveItemPath=s,n.getAsyncCopyMoveProgress(i,s)}),"column"===n.state.currentMode&&n.deleteTreeNode(s),o===e.repo_id&&"column"===n.state.currentMode&&n.updateMoveCopyTreeNode(r),n.moveDirent(s,r),o===e.repo_id){var a=(0,v.gettext)("Successfully moved {name}.");a=a.replace("{name}",i),F.default.success(a)}}).catch(function(e){var t=w.Utils.getErrorMsg(e);t===(0,v.gettext)("Error")&&(t=(0,v.gettext)("Failed to move {name}."),t=t.replace("{name}",i)),F.default.danger(t)})},n.onCopyItem=function(e,t,r,a){var o=n.props.repoID,i=t.name;a||(a=n.state.path),o!==e.repo_id&&n.setState({asyncOperatedFilesLength:1,asyncOperationProgress:0,asyncOperationType:"copy",isCopyMoveProgressDialogShow:!0}),b.seafileAPI.copyDir(o,e.repo_id,r,a,i).then(function(t){if(o!==e.repo_id&&n.setState({asyncCopyMoveTaskId:t.data.task_id},function(){n.getAsyncCopyMoveProgress()}),o===e.repo_id){"column"===n.state.currentMode&&n.updateMoveCopyTreeNode(r),r===a&&n.loadDirentList(n.state.path);var s=(0,v.gettext)("Successfully copied %(name)s.");s=s.replace("%(name)s",i),F.default.success(s)}}).catch(function(e){var t=w.Utils.getErrorMsg(e);t===(0,v.gettext)("Error")&&(t=(0,v.gettext)("Failed to copy %(name)s"),t=t.replace("%(name)s",i)),F.default.danger(t)})},n.onDirentClick=function(e){var t=n.state.direntList.map(function(e){return e.isSelected=!1,e});e?n.setState({direntList:t,isDirentSelected:!0,selectedDirentList:[e]}):n.setState({direntList:t,isDirentSelected:!1,selectedDirentList:[]})},n.onItemClick=function(e){n.resetSelected();var t=n.props.repoID,r=w.Utils.joinPath(n.state.path,e.name);if(e.isDir())"column"===n.state.currentMode&&n.loadTreeNodeByPath(r),n.showDir(r);else if("column"===n.state.currentMode&&w.Utils.isMarkdownFile(r))n.showColumnMarkdownFile(r);else{var a=v.siteRoot+"lib/"+t+"/file"+w.Utils.encodePath(r),o=w.Utils.isWeChat();o?location.href=a:window.open(a)}},n.onDirentSelected=function(e){var t=n.state.direntList.map(function(t){return t.name===e.name&&(t.isSelected=!t.isSelected),t}),r=t.filter(function(e){return e.isSelected});r.length?(n.setState({isDirentSelected:!0}),r.length===t.length?n.setState({isAllDirentSelected:!0,direntList:t,selectedDirentList:r}):n.setState({isAllDirentSelected:!1,direntList:t,selectedDirentList:r})):n.setState({isDirentSelected:!1,isAllDirentSelected:!1,direntList:t,selectedDirentList:[]})},n.onAllDirentSelected=function(){if(n.state.isAllDirentSelected){var e=n.state.direntList.map(function(e){return e.isSelected=!1,e});n.setState({isDirentSelected:!1,isAllDirentSelected:!1,direntList:e,selectedDirentList:[]})}else{var t=n.state.direntList.map(function(e){return e.isSelected=!0,e});n.setState({isDirentSelected:!0,isAllDirentSelected:!0,direntList:t,selectedDirentList:t})}},n.onFileTagChanged=function(e,t){var r=n.props.repoID;b.seafileAPI.listFileTags(r,t).then(function(t){var r=t.data.file_tags.map(function(e){return new P.default(e)});n.updateDirent(e,"file_tags",r)}).catch(function(e){var t=w.Utils.getErrorMsg(e);F.default.danger(t)}),n.updateUsedRepoTags()},n.onFileUploadSuccess=function(e){if(n.state.direntList.some(function(t){return t.name===e.name&&t.type===e.type}))for(var t=n.state.direntList,r=0;r<t.length;r++){var a=t[r];if(a.name===e.name&&a.type===e.type){var i=y.default.unix(e.mtime).fromNow();n.updateDirent(a,"mtime",i);break}}else{e.permission="rw";var s=new D.default(e);"column"===n.state.currentMode&&n.addNodeToTree(s.name,n.state.path,s.type),"dir"===e.type?n.setState({direntList:[s].concat(o(n.state.direntList))}):(n.setState({direntList:[].concat(o(n.state.direntList),[s])}),n.updateReadmeMarkdown(n.state.direntList))}},n.addDirent=function(e,t,r){var a=n.createDirent(e,t,r),o=n.state.direntList;if("dir"===t)o.unshift(a);else{var i=o.length;if(0===i||"dir"===o[i-1].type)o.push(a);else{for(var s=0,l=0;l<=i;l++)if("file"===o[l].type){s=l;break}o.splice(s,0,a)}}n.setState({direntList:o}),n.updateReadmeMarkdown(o)},n.renameDirent=function(e,t){var r=n.props.repoID,a=w.Utils.getDirName(e),o=w.Utils.joinPath(a,t);if(e===n.state.path){n.setState({path:o});var i=n.state.currentRepoInfo,s=v.siteRoot+"library/"+r+"/"+encodeURIComponent(i.repo_name)+o;window.history.replaceState({url:s,path:o},o,s)}else if(w.Utils.isChildPath(e,n.state.path)){var l=w.Utils.getFileName(e),u=n.state.direntList.map(function(e){return e.name===l&&(e.name=t),e});n.setState({direntList:u}),n.updateReadmeMarkdown(u)}else if(w.Utils.isAncestorPath(e,n.state.path)){var c=w.Utils.renameAncestorPath(n.state.path,e,o);n.setState({path:c});var d=n.state.currentRepoInfo,p=v.siteRoot+"library/"+r+"/"+encodeURIComponent(d.repo_name)+c;window.history.replaceState({url:p,path:c},c,p)}},n.deleteDirents=function(e){var t=n.state.direntList.filter(function(t){return-1===e.indexOf(t.name)});n.recaculateSelectedStateAfterDirentDeleted(name,t),n.setState({direntList:t}),n.updateReadmeMarkdown(t)},n.moveDirent=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=w.Utils.getFileName(e);if(t===n.state.path)return void n.loadDirentList(n.state.path);var a=n.state.direntList.filter(function(e){return e.name!==r});n.recaculateSelectedStateAfterDirentDeleted(r,a),n.setState({direntList:a}),n.updateReadmeMarkdown(a)},n.moveDirents=function(e){var t=n.state.direntList.filter(function(t){return-1===e.indexOf(t.name)});n.recaculateSelectedStateAfterDirentDeleted(name,t),n.setState({direntList:t}),n.updateReadmeMarkdown(t)},n.updateDirent=function(e,t,r){var a=n.state.direntList.map(function(n){return n.name===e.name&&(n[t]=r),n});n.setState({direntList:a})},n.loadTreeNodeByPath=function(e){var t=n.props.repoID,r=n.state.treeData.clone(),a=r.getNodeByPath(e);if(a.isLoaded){r.getNodeByPath(a.parentNode.path).isExpanded=!0,n.setState({treeData:r,currentNode:a})}else b.seafileAPI.listDir(t,a.path).then(function(e){n.addResponseListToNode(e.data.dirent_list,a),r.getNodeByPath(a.parentNode.path).isExpanded=!0,n.setState({treeData:r,currentNode:a})}).catch(function(e){var t=w.Utils.getErrorMsg(e);F.default.danger(t)})},n.loadNodeAndParentsByPath=function(e){var t=n.props.repoID,r=n.state.treeData.clone();w.Utils.isMarkdownFile(e)&&(e=w.Utils.getDirName(e)),b.seafileAPI.listDir(t,e,{with_parents:!0}).then(function(e){for(var t=e.data.dirent_list,a={},o=0;o<t.length;o++){var i=t[o],s=i.parent_dir,l="/"===s?"/":s.slice(0,s.length-1);a[l]||(a[l]=[]),a[l].push(i)}for(var u in a){var c=r.getNodeByPath(u);c.isLoaded||n.addResponseListToNode(a[u],c)}n.setState({isTreeDataLoading:!1,treeData:r})}).catch(function(){n.setState({isLoadFailed:!0})})},n.onTreeNodeClick=function(e){n.resetSelected();var t=n.props.repoID;if(n.state.pathExist||n.setState({pathExist:!0}),e.object.isDir()){var r=e.isLoaded;if(!e.isLoaded){var a=n.state.treeData.clone();e=a.getNodeByPath(e.path),b.seafileAPI.listDir(t,e.path).then(function(t){n.addResponseListToNode(t.data.dirent_list,e),a.collapseNode(e),n.setState({treeData:a})}).catch(function(e){var t=w.Utils.getErrorMsg(e);F.default.danger(t)})}if(r&&e.path===n.state.path)if(e.isExpanded){var o=N.default.collapseNode(n.state.treeData,e);n.setState({treeData:o})}else{var i=n.state.treeData.clone();e=i.getNodeByPath(e.path),i.expandNode(e),n.setState({treeData:i})}}if(e.path!==n.state.path)if(e.object.isDir())n.showDir(e.path);else if(w.Utils.isMarkdownFile(e.path))e.path!==n.state.path&&n.showColumnMarkdownFile(e.path);else{var s=v.siteRoot+"lib/"+t+"/file"+w.Utils.encodePath(e.path);window.open(s)}},n.showColumnMarkdownFile=function(e){var t=n.props.repoID;b.seafileAPI.getFileInfo(t,e).then(function(r){if(0===r.data.size){var a=window.open("about:blank"),o=v.siteRoot+"lib/"+t+"/file"+w.Utils.encodePath(e);a.location.href=o}else n.showFile(e)}).catch(function(e){var t=w.Utils.getErrorMsg(e);F.default.danger(t)})},n.onTreeNodeCollapse=function(e){var t=N.default.collapseNode(n.state.treeData,e);n.setState({treeData:t})},n.onTreeNodeExpanded=function(e){var t=n.props.repoID,r=n.state.treeData.clone();e=r.getNodeByPath(e.path),e.isLoaded?(r.expandNode(e),n.setState({treeData:r})):b.seafileAPI.listDir(t,e.path).then(function(t){n.addResponseListToNode(t.data.dirent_list,e),n.setState({treeData:r})}).catch(function(e){var t=w.Utils.getErrorMsg(e);F.default.danger(t)})},n.addNodeToTree=function(e,t,r){var a=n.createTreeNode(e,r),o=N.default.addNodeToParentByPath(n.state.treeData,a,t);n.setState({treeData:o})},n.renameTreeNode=function(e,t){var r=N.default.renameNodeByPath(n.state.treeData,e,t);n.setState({treeData:r})},n.deleteTreeNode=function(e){var t=N.default.deleteNodeByPath(n.state.treeData,e);n.setState({treeData:t})},n.deleteTreeNodes=function(e){var t=N.default.deleteNodeListByPaths(n.state.treeData,e);n.setState({treeData:t})},n.moveTreeNode=function(e,t,r,a){if(n.props.repoID!==r.repo_id){var o=N.default.deleteNodeByPath(n.state.treeData,e);return void n.setState({treeData:o})}var i=N.default.moveNodeByPath(n.state.treeData,e,t,a);n.setState({treeData:i})},n.copyTreeNode=function(e,t,r,a){if(n.props.repoID===r.repo_id){var o=N.default.copyNodeByPath(n.state.treeData,e,t,a);n.setState({treeData:o})}},n.addResponseListToNode=function(e,t){t.isLoaded=!0,t.isExpanded=!0;var n=e.map(function(e){return new D.default(e)});n=w.Utils.sortDirents(n,"name","asc");var r=n.map(function(e){return new T.default({object:e})});t.addChildren(r)},n.getSelectedDirentPaths=function(){var e=[];return n.state.selectedDirentList.forEach(function(t){e.push(w.Utils.joinPath(n.state.path,t.name))}),e},n.getSelectedDirentNames=function(){var e=[];return n.state.selectedDirentList.forEach(function(t){e.push(t.name)}),e},n.resetSelected=function(){n.setState({isDirentSelected:!1,isAllDirentSelected:!1})},n.recaculateSelectedStateAfterDirentDeleted=function(e,t){var r=n.state.selectedDirentList.slice(0);r.length>0&&(r=r.filter(function(t){return t.name!==e})),n.setState({selectedDirentList:r,isDirentSelected:r.length>0,isAllDirentSelected:r.length===t.length})},n.onLibDecryptDialog=function(){n.setState({libNeedDecrypt:!1}),n.loadDirData(n.state.path)},n.goDraftPage=function(){window.open(v.siteRoot+"drafts/"+n.state.draftID+"/")},n.sortItems=function(e,t){m.default.save("seafile-repo-dir-sort-by",e),m.default.save("seafile-repo-dir-sort-order",t),n.setState({sortBy:e,sortOrder:t,items:w.Utils.sortDirents(n.state.direntList,e,t)})},n.onUploadFile=function(e){e.nativeEvent.stopImmediatePropagation(),n.uploader.onFileUpload()},n.onUploadFolder=function(e){e.nativeEvent.stopImmediatePropagation(),n.uploader.onFolderUpload()},n.onToolbarFileTagChanged=function(){var e=n.props.repoID,t=n.state.path;b.seafileAPI.listFileTags(e,t).then(function(e){var t=e.data.file_tags.map(function(e){return new P.default(e)});n.setState({fileTags:t})}).catch(function(e){var t=w.Utils.getErrorMsg(e);F.default.danger(t)})},n.onToolbarRelatedFileChange=function(){var e=n.props.repoID,t=n.state.path;b.seafileAPI.listRelatedFiles(e,t).then(function(e){var t=e.data.related_files.map(function(e){return e});n.setState({relatedFiles:t})}).catch(function(e){500===e.response.status&&n.setState({relatedFiles:[]})})},n.unSelectDirent=function(){n.setState({isDirentSelected:!1,selectedDirentList:[]});var e={};n.onDirentSelected(e)},n.onDeleteRepoTag=function(e){var t=n.state.direntList.map(function(t){if(t.file_tags){var n=t.file_tags.filter(function(t){return t.repo_tag_id!==e});t.file_tags=n}return t});n.setState({direntList:t}),n.updateUsedRepoTags()},n.state={currentMode:m.default.load("seafile_view_mode")||"list",path:"",pathExist:!0,isViewFile:!1,hash:"",currentRepoInfo:null,repoName:"",repoPermission:!0,repoEncrypted:!1,libNeedDecrypt:!1,isGroupOwnedRepo:!1,userPerm:"",selectedDirentList:[],isDraft:!1,hasDraft:!1,fileTags:[],relatedFiles:[],draftID:"",draftCounts:0,usedRepoTags:[],readmeMarkdown:null,isTreeDataLoading:!0,treeData:N.default.buildTree(),currentNode:null,isFileLoading:!0,isFileLoadedErr:!1,filePermission:"",content:"",lastModified:"",latestContributor:"",isDirentListLoading:!0,direntList:[],isDirentSelected:!1,sortBy:m.default.load("seafile-repo-dir-sort-by")||"name",sortOrder:m.default.load("seafile-repo-dir-sort-order")||"asc",isAllDirentSelected:!1,dirID:"",errorMsg:"",isDirentDetailShow:!1,direntDetailPanelTab:"",updateDetail:!1,itemsShowLength:100,isSessionExpired:!1,isCopyMoveProgressDialogShow:!1,asyncCopyMoveTaskId:"",asyncOperationType:"move",asyncOperationProgress:0,asyncOperatedFilesLength:0},n.oldonpopstate=window.onpopstate,window.onpopstate=n.onpopstate,n.lastModifyTime=new Date,n.isNeedUpdateHistoryState=!0,n.currentMoveItemName="",n.currentMoveItemPath="",n}return l(t,e),u(t,[{key:"componentWillMount",value:function(){var e=window.location.hash;"#"===e.slice(0,1)&&this.setState({hash:e})}},{key:"componentDidMount",value:function(){var e=this,t=this.props.repoID,n=window.location.href.split("#")[0];n=decodeURIComponent(n),b.seafileAPI.getRepoInfo(t).then(function(t){var r=new L.default(t.data),a=r.owner_email.indexOf("@seafile_group")>-1;e.setState({currentRepoInfo:r,repoName:r.repo_name,libNeedDecrypt:r.lib_need_decrypt,repoEncrypted:r.encrypted,repoPermission:"rw"===r.permission,isGroupOwnedRepo:a});var o=r.repo_id,i=n.slice(n.indexOf(o)+o.length+1);i=i.slice(i.indexOf("/")),e.isNeedUpdateHistoryState=!1,e.setState({path:i}),r.lib_need_decrypt||e.loadDirData(i)}).catch(function(t){if(t.response)if(403==t.response.status){e.setState({isDirentListLoading:!1,errorMsg:(0,v.gettext)("Permission denied")});var n=(0,v.gettext)("Permission denied");F.default.danger(n)}else e.setState({isDirentListLoading:!1,errorMsg:(0,v.gettext)("Error")});else e.setState({isDirentListLoading:!1,errorMsg:(0,v.gettext)("Please check the network.")})})}},{key:"componentWillUnmount",value:function(){window.onpopstate=this.oldonpopstate,S.default.unwatchRepo(this.props.repoID,this.onRepoUpdateEvent)}},{key:"componentDidUpdate",value:function(){this.lastModifyTime=new Date}},{key:"getAsyncCopyMoveProgress",value:function(){function e(){return t.apply(this,arguments)}var t=a(regeneratorRuntime.mark(function e(){var t,n,r,a,o,i,s,l,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state,n=t.asyncOperationType,r=t.asyncCopyMoveTaskId,e.prev=1,e.next=4,b.seafileAPI.queryAsyncOperationProgress(r);case 4:if(a=e.sent,o=a.data,!o.failed){e.next=12;break}return i=(0,v.gettext)("Failed to move files to another library."),"copy"===n&&(i=(0,v.gettext)("Failed to copy files to another library.")),F.default.danger(i),this.setState({asyncOperationProgress:0,isCopyMoveProgressDialogShow:!1}),e.abrupt("return");case 12:if(!o.successful){e.next=19;break}return"move"===n&&(this.currentMoveItemName&&this.currentMoveItemPath?("column"===this.state.currentMode&&this.deleteTreeNode(this.currentMoveItemPath),this.moveDirent(this.currentMoveItemName),this.currentMoveItemName="",this.currentMoveItemPath=""):("column"===this.state.currentMode&&(s=this.getSelectedDirentPaths(),this.deleteTreeNodes(s)),l=this.getSelectedDirentNames(),this.moveDirents(l))),this.setState({isCopyMoveProgressDialogShow:!1}),u=(0,v.gettext)("Successfully moved files to another library."),"copy"===n&&(u=(0,v.gettext)("Successfully copied files to another library.")),F.default.success(u),e.abrupt("return");case 19:c=o.total?parseInt((o.done/o.total*100).toFixed(2)):0,this.getAsyncCopyMoveProgress(),this.setState({asyncOperationProgress:c}),e.next=27;break;case 24:e.prev=24,e.t0=e.catch(1),this.setState({asyncOperationProgress:0,isCopyMoveProgressDialogShow:!1});case 27:case"end":return e.stop()}},e,this,[[1,24]])}));return e}()},{key:"renameItemAjaxCallback",value:function(e,t){"column"===this.state.currentMode&&this.renameTreeNode(e,t),this.renameDirent(e,t)}},{key:"deleteItem",value:function(e,t){var n=this,r=this.props.repoID;t?b.seafileAPI.deleteDir(r,e).then(function(){n.deleteItemAjaxCallback(e,t);var r=w.Utils.getFileName(e),a=(0,v.gettext)("Successfully deleted {name}").replace("{name}",r);F.default.success(a)}).catch(function(t){var n=w.Utils.getErrorMsg(t);if(n===(0,v.gettext)("Error")){var r=w.Utils.getFileName(e);n=(0,v.gettext)("Failed to delete {name}").replace("{name}",r)}F.default.danger(n)}):b.seafileAPI.deleteFile(r,e).then(function(){n.deleteItemAjaxCallback(e,t);var r=w.Utils.getFileName(e),a=(0,v.gettext)("Successfully deleted {name}").replace("{name}",r);F.default.success(a)}).catch(function(t){var n=w.Utils.getErrorMsg(t);if(n===(0,v.gettext)("Error")){var r=w.Utils.getFileName(e);n=(0,v.gettext)("Failed to delete {name}").replace("{name}",r)}F.default.danger(n)})}},{key:"deleteItemAjaxCallback",value:function(e){"column"===this.state.currentMode&&this.deleteTreeNode(e),this.deleteDirent(e)}},{key:"deleteDirent",value:function(e){if(e===this.state.path){var t=w.Utils.getDirName(e);this.showDir(t)}else if(w.Utils.isChildPath(e,this.state.path)){var n=w.Utils.getFileName(e),r=this.state.direntList.filter(function(e){return e.name!==n});this.recaculateSelectedStateAfterDirentDeleted(n,r),this.setState({direntList:r}),this.updateReadmeMarkdown(r)}else if(w.Utils.isAncestorPath(e,this.state.path)){var a=w.Utils.getDirName(e);this.showDir(a)}}},{key:"createTreeNode",value:function(e,t){var n=this.createDirent(e,t);return new T.default({object:n})}},{key:"createDirent",value:function(e,t,n){var r=(new Date).getTime()/1e3;return new D.default({name:e,type:t,mtime:r,size:n})}},{key:"render",value:function(){var e=this;if(this.state.libNeedDecrypt)return d.default.createElement(Z.default,null,d.default.createElement(A.default,{repoID:this.props.repoID,onLibDecryptDialog:this.onLibDecryptDialog}));if(!this.state.currentRepoInfo)return"";var t=!1,n=this.state,r=n.currentRepoInfo,a=n.userPerm,o=n.isCopyMoveProgressDialogShow,i=w.Utils.isHasPermissionToShare(r,a),s=r.owner_email===v.username,l=r.is_virtual,u=r.is_admin;l||!s&&!u||(t=!0);var p=this.state.direntList.filter(function(t,n){return n<e.state.itemsShowLength});return d.default.createElement(c.Fragment,null,d.default.createElement("div",{className:"main-panel o-hidden"},d.default.createElement("div",{className:"main-panel-north border-left-show"},d.default.createElement(X.default,{isViewFile:this.state.isViewFile,filePermission:this.state.filePermission,isDraft:this.state.isDraft,hasDraft:this.state.hasDraft,fileTags:this.state.fileTags,relatedFiles:this.state.relatedFiles,onFileTagChanged:this.onToolbarFileTagChanged,onRelatedFileChange:this.onToolbarRelatedFileChange,onSideNavMenuClick:this.props.onMenuClick,repoID:this.props.repoID,path:this.state.path,isDirentSelected:this.state.isDirentSelected,selectedDirentList:this.state.selectedDirentList,onItemsMove:this.onMoveItems,onItemsCopy:this.onCopyItems,onItemsDelete:this.onDeleteItems,onItemRename:this.onMainPanelItemRename,direntList:this.state.direntList,repoName:this.state.repoName,repoEncrypted:this.state.repoEncrypted,isGroupOwnedRepo:this.state.isGroupOwnedRepo,userPerm:this.state.userPerm,showShareBtn:i,enableDirPrivateShare:t,onAddFile:this.onAddFile,onAddFolder:this.onAddFolder,onUploadFile:this.onUploadFile,onUploadFolder:this.onUploadFolder,currentMode:this.state.currentMode,switchViewMode:this.switchViewMode,onSearchedClick:this.onSearchedClick,isRepoOwner:s,currentRepoInfo:this.state.currentRepoInfo,updateDirent:this.updateDirent,onDirentSelected:this.onDirentSelected,showDirentDetail:this.showDirentDetail,listRelatedFiles:this.listRelatedFiles,unSelectDirent:this.unSelectDirent,onFilesTagChanged:this.onFileTagChanged})),d.default.createElement("div",{className:"main-panel-center flex-row"},d.default.createElement(U.default,{pathPrefix:this.props.pathPrefix,currentMode:this.state.currentMode,path:this.state.path,pathExist:this.state.pathExist,currentRepoInfo:this.state.currentRepoInfo,repoID:this.props.repoID,repoPermission:this.state.repoPermission,enableDirPrivateShare:t,userPerm:a,isGroupOwnedRepo:this.state.isGroupOwnedRepo,onTabNavClick:this.props.onTabNavClick,onMainNavBarClick:this.onMainNavBarClick,isViewFile:this.state.isViewFile,hash:this.state.hash,isDraft:this.state.isDraft,hasDraft:this.state.hasDraft,fileTags:this.state.fileTags,relatedFiles:this.state.relatedFiles,goDraftPage:this.goDraftPage,isFileLoading:this.state.isFileLoading,isFileLoadedErr:this.state.isFileLoadedErr,filePermission:this.state.filePermission,content:this.state.content,lastModified:this.state.lastModified,latestContributor:this.state.latestContributor,onLinkClick:this.onLinkClick,isTreeDataLoading:this.state.isTreeDataLoading,treeData:this.state.treeData,currentNode:this.state.currentNode,onNodeClick:this.onTreeNodeClick,onNodeCollapse:this.onTreeNodeCollapse,onNodeExpanded:this.onTreeNodeExpanded,onAddFolderNode:this.onAddFolder,onAddFileNode:this.onAddFile,onRenameNode:this.onRenameTreeNode,onDeleteNode:this.onDeleteTreeNode,draftCounts:this.state.draftCounts,usedRepoTags:this.state.usedRepoTags,readmeMarkdown:this.state.readmeMarkdown,updateUsedRepoTags:this.updateUsedRepoTags,isDirentListLoading:this.state.isDirentListLoading,direntList:p,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems,updateDirent:this.updateDirent,onDirentClick:this.onDirentClick,onItemClick:this.onItemClick,onItemSelected:this.onDirentSelected,onItemDelete:this.onMainPanelItemDelete,onItemRename:this.onMainPanelItemRename,onItemMove:this.onMoveItem,onItemCopy:this.onCopyItem,onAddFolder:this.onAddFolder,onAddFile:this.onAddFile,onFileTagChanged:this.onFileTagChanged,isDirentSelected:this.state.isDirentSelected,isAllDirentSelected:this.state.isAllDirentSelected,onAllDirentSelected:this.onAllDirentSelected,isDirentDetailShow:this.state.isDirentDetailShow,selectedDirent:this.state.selectedDirentList&&this.state.selectedDirentList[0],selectedDirentList:this.state.selectedDirentList,onItemsMove:this.onMoveItems,onItemsCopy:this.onCopyItems,onItemsDelete:this.onDeleteItems,closeDirentDetail:this.closeDirentDetail,showDirentDetail:this.showDirentDetail,direntDetailPanelTab:this.state.direntDetailPanelTab,onDeleteRepoTag:this.onDeleteRepoTag,onToolbarFileTagChanged:this.onToolbarFileTagChanged,updateDetail:this.state.updateDetail,onListContainerScroll:this.onListContainerScroll}),this.state.pathExist&&!this.state.isViewFile&&d.default.createElement(G.default,{ref:function(t){return e.uploader=t},dragAndDrop:!0,path:this.state.path,repoID:this.props.repoID,direntList:this.state.direntList,onFileUploadSuccess:this.onFileUploadSuccess}))),o&&d.default.createElement(Q.default,{type:this.state.asyncOperationType,asyncOperatedFilesLength:this.state.asyncOperatedFilesLength,asyncOperationProgress:this.state.asyncOperationProgress,toggleDialog:this.onMoveProgressDialogToggle}))}}]),t}(d.default.Component);K.propTypes=W,t.default=K},2258:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(700),i=function(e){return e&&e.__esModule?e:{default:e}}(o),s=n(2),l=""!==s.seafileCollabServer?(0,i.default)(s.seafileCollabServer):void 0,u=function(){function e(){r(this,e)}return a(e,[{key:"watchRepo",value:function(e,t){l&&(l.emit("repo_update",{request:"watch_update",repo_id:e,user:{name:s.name,username:s.username,contact_email:s.contactEmail}}),l.on("repo_update",t))}},{key:"unwatchRepo",value:function(e,t){l&&(l.emit("repo_update",{request:"unwatch_update",repo_id:e,user:{name:s.name,username:s.username,contact_email:s.contactEmail}}),l.off("repo_update",t))}}]),e}(),c=new u;t.default=c},2259:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(2),h=n(4);n(2260);var m={repoID:d.default.string.isRequired,onLibDecryptDialog:d.default.func.isRequired},g=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleSubmit=function(e){var t=n.props.repoID,r=n.state.password;h.seafileAPI.setRepoDecryptPassword(t,r).then(function(e){n.props.onLibDecryptDialog()}).catch(function(e){n.setState({showError:!0})}),e.preventDefault()},n.handleKeyPress=function(e){"Enter"==e.key&&n.handleSubmit(e)},n.handleChange=function(e){n.setState({password:e.target.value,showError:!1})},n.toggle=function(){window.location.href=f.siteRoot},n.state={password:"",showError:!1},n}return i(t,e),s(t,[{key:"render",value:function(){return u.default.createElement(p.Modal,{isOpen:!0},u.default.createElement(p.ModalBody,null,u.default.createElement("button",{type:"button",className:"close",onClick:this.toggle},u.default.createElement("span",{"aria-hidden":"true"},"\xd7")),u.default.createElement(p.Form,{className:"lib-decrypt-form text-center"},u.default.createElement("img",{src:f.mediaUrl+"img/lock.png",alt:"","aria-hidden":"true"}),u.default.createElement("p",{className:"intro"},(0,f.gettext)("This library is password protected")),this.state.showError&&u.default.createElement("p",{className:"error"},(0,f.gettext)("Wrong password")),u.default.createElement("input",{type:"password",name:"password",className:"form-control password-input",autoComplete:"off",onKeyPress:this.handleKeyPress,placeholder:(0,f.gettext)("Password"),onChange:this.handleChange}),u.default.createElement("button",{type:"submit",className:"btn btn-primary submit",onClick:this.handleSubmit},(0,f.gettext)("Submit")),u.default.createElement("p",{className:"tip"},"* ",(0,f.gettext)("The password will be kept in the server for only 1 hour.")))))}}]),t}(u.default.Component);g.propTypes=m,t.default=g},2260:function(e,t){},2261:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(2),f=n(78),h=r(f),m=n(1026),g=r(m),y=n(2262),v=r(y),b=n(2263),w=r(b),E=n(2265),S=r(E),C={isViewFile:d.default.bool.isRequired,filePermission:d.default.string,isDraft:d.default.bool.isRequired,hasDraft:d.default.bool.isRequired,fileTags:d.default.array.isRequired,relatedFiles:d.default.array.isRequired,onFileTagChanged:d.default.func.isRequired,onRelatedFileChange:d.default.func.isRequired,onSideNavMenuClick:d.default.func.isRequired,isDirentSelected:d.default.bool.isRequired,repoID:d.default.string.isRequired,path:d.default.string.isRequired,selectedDirentList:d.default.array.isRequired,onItemsMove:d.default.func.isRequired,onItemsCopy:d.default.func.isRequired,onItemsDelete:d.default.func.isRequired,direntList:d.default.array.isRequired,repoName:d.default.string.isRequired,repoEncrypted:d.default.bool.isRequired,isGroupOwnedRepo:d.default.bool.isRequired,userPerm:d.default.string.isRequired,showShareBtn:d.default.bool.isRequired,enableDirPrivateShare:d.default.bool.isRequired,onAddFile:d.default.func.isRequired,onAddFolder:d.default.func.isRequired,onUploadFile:d.default.func.isRequired,onUploadFolder:d.default.func.isRequired,currentMode:d.default.string.isRequired,switchViewMode:d.default.func.isRequired,onSearchedClick:d.default.func.isRequired,isRepoOwner:d.default.bool.isRequired,onFilesTagChanged:d.default.func.isRequired,updateDirent:d.default.func.isRequired,unSelectDirent:d.default.func,currentRepoInfo:d.default.object},D=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){return this.props.isViewFile?u.default.createElement(l.Fragment,null,u.default.createElement("div",{className:"cur-view-toolbar"},u.default.createElement("span",{className:"sf2-icon-menu hidden-md-up d-md-none side-nav-toggle",title:(0,p.gettext)("Side Nav Menu"),onClick:this.props.onSideNavMenuClick}),u.default.createElement(S.default,{path:this.props.path,repoID:this.props.repoID,userPerm:this.props.userPerm,repoEncrypted:this.props.repoEncrypted,enableDirPrivateShare:this.props.enableDirPrivateShare,isGroupOwnedRepo:this.props.isGroupOwnedRepo,filePermission:this.props.filePermission,isDraft:this.props.isDraft,hasDraft:this.props.hasDraft,fileTags:this.props.fileTags,relatedFiles:this.props.relatedFiles,onFileTagChanged:this.props.onFileTagChanged,onRelatedFileChange:this.props.onRelatedFileChange,showShareBtn:this.props.showShareBtn}),u.default.createElement(g.default,{currentMode:this.props.currentMode,switchViewMode:this.props.switchViewMode})),u.default.createElement(h.default,{repoID:this.props.repoID,onSearchedClick:this.props.onSearchedClick,searchPlaceholder:(0,p.gettext)("Search files in this library")})):u.default.createElement(l.Fragment,null,u.default.createElement("div",{className:"cur-view-toolbar"},u.default.createElement("span",{className:"sf2-icon-menu hidden-md-up d-md-none side-nav-toggle",title:(0,p.gettext)("Side Nav Menu"),onClick:this.props.onSideNavMenuClick}),this.props.isDirentSelected?u.default.createElement(w.default,{repoID:this.props.repoID,path:this.props.path,userPerm:this.props.userPerm,repoEncrypted:this.props.repoEncrypted,selectedDirentList:this.props.selectedDirentList,direntList:this.props.direntList,onItemsMove:this.props.onItemsMove,onItemsCopy:this.props.onItemsCopy,onItemsDelete:this.props.onItemsDelete,onItemRename:this.props.onItemRename,isRepoOwner:this.props.isRepoOwner,currentRepoInfo:this.props.currentRepoInfo,enableDirPrivateShare:this.props.enableDirPrivateShare,updateDirent:this.props.updateDirent,relatedFiles:this.props.relatedFiles,unSelectDirent:this.props.unSelectDirent,onFilesTagChanged:this.props.onFilesTagChanged,showShareBtn:this.props.showShareBtn,isGroupOwnedRepo:this.props.isGroupOwnedRepo,showDirentDetail:this.props.showDirentDetail,currentMode:this.props.currentMode,switchViewMode:this.props.switchViewMode}):u.default.createElement(v.default,{path:this.props.path,repoID:this.props.repoID,repoName:this.props.repoName,repoEncrypted:this.props.repoEncrypted,direntList:this.props.direntList,showShareBtn:this.props.showShareBtn,enableDirPrivateShare:this.props.enableDirPrivateShare,userPerm:this.props.userPerm,isGroupOwnedRepo:this.props.isGroupOwnedRepo,onAddFile:this.props.onAddFile,onAddFolder:this.props.onAddFolder,onUploadFile:this.props.onUploadFile,onUploadFolder:this.props.onUploadFolder,currentMode:this.props.currentMode,switchViewMode:this.props.switchViewMode})),u.default.createElement(h.default,{repoID:this.props.repoID,onSearchedClick:this.props.onSearchedClick,searchPlaceholder:(0,p.gettext)("Search files in this library")}))}}]),t}(u.default.Component);D.propTypes=C,t.default=D},2262:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(3),h=n(2),m=n(13),g=r(m),y=n(473),v=r(y),b=n(744),w=r(b),E=n(108),S=r(E),C=n(1026),D=r(C),_={path:d.default.string.isRequired,repoID:d.default.string.isRequired,repoName:d.default.string.isRequired,repoEncrypted:d.default.bool.isRequired,enableDirPrivateShare:d.default.bool.isRequired,userPerm:d.default.string.isRequired,isGroupOwnedRepo:d.default.bool.isRequired,showShareBtn:d.default.bool.isRequired,onAddFile:d.default.func.isRequired,onAddFolder:d.default.func.isRequired,onUploadFile:d.default.func.isRequired,onUploadFolder:d.default.func.isRequired,direntList:d.default.array.isRequired,currentMode:d.default.string.isRequired,switchViewMode:d.default.func.isRequired},P=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleMobileOpMenu=function(){n.setState({isMobileOpMenuOpen:!n.state.isMobileOpMenuOpen})},n.hideOperationMenu=function(){n.setState({isUploadMenuShow:!1,isCreateMenuShow:!1})},n.toggleOperationMenu=function(e){e.nativeEvent.stopImmediatePropagation();var t=e.target.getBoundingClientRect(),r=t.left,a=t.bottom,o={position:"fixed",display:"block",left:r,top:a};n.setState({operationMenuStyle:o})},n.onUploadClick=function(e){n.toggleOperationMenu(e),n.setState({isUploadMenuShow:!0,isCreateMenuShow:!1})},n.onUploadFile=function(e){n.setState({isUploadMenuShow:!1}),n.props.onUploadFile(e)},n.onUploadFolder=function(e){n.setState({isUploadMenuShow:!1}),n.props.onUploadFolder(e)},n.onCreateClick=function(e){n.toggleOperationMenu(e),n.setState({isCreateMenuShow:!0,isUploadMenuShow:!1})},n.onShareClick=function(){n.setState({isShareDialogShow:!n.state.isShareDialogShow})},n.onCreateFolderToggle=function(){n.setState({isCreateFolderDialogShow:!n.state.isCreateFolderDialogShow})},n.onCreateFileToggle=function(){n.setState({isCreateFileDialogShow:!n.state.isCreateFileDialogShow,fileType:""})},n.onCreateMarkdownToggle=function(){n.setState({isCreateFileDialogShow:!n.state.isCreateFileDialogShow,fileType:".md"})},n.onCreateExcelToggle=function(){n.setState({isCreateFileDialogShow:!n.state.isCreateFileDialogShow,fileType:".xlsx"})},n.onCreatePPTToggle=function(){n.setState({isCreateFileDialogShow:!n.state.isCreateFileDialogShow,fileType:".pptx"})},n.onCreateWordToggle=function(){n.setState({isCreateFileDialogShow:!n.state.isCreateFileDialogShow,fileType:".docx"})},n.onAddFile=function(e,t){n.setState({isCreateFileDialogShow:!1}),n.props.onAddFile(e,t)},n.onAddFolder=function(e){n.setState({isCreateFolderDialogShow:!1}),n.props.onAddFolder(e)},n.checkDuplicatedName=function(e){return n.props.direntList.some(function(t){return t.name===e})},n.state={fileType:".md",isCreateFileDialogShow:!1,isCreateFolderDialogShow:!1,isUploadMenuShow:!1,isCreateMenuShow:!1,isShareDialogShow:!1,operationMenuStyle:"",isMobileOpMenuOpen:!1},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.hideOperationMenu)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.hideOperationMenu)}},{key:"render",value:function(){var e=this.props,t=e.path,n=e.repoName,r=e.userPerm,a="/"===t?"library":"dir",o="/"==t?n:f.Utils.getFolderName(t),i=null;if(f.Utils.isDesktop()){var s=this.props.showShareBtn;i=u.default.createElement(l.Fragment,null,f.Utils.isSupportUploadFolder()?u.default.createElement("button",{className:"btn btn-secondary operation-item",title:(0,h.gettext)("Upload"),onClick:this.onUploadClick},(0,h.gettext)("Upload")):u.default.createElement("button",{className:"btn btn-secondary operation-item",title:(0,h.gettext)("Upload"),onClick:this.onUploadFile},(0,h.gettext)("Upload")),u.default.createElement("button",{className:"btn btn-secondary operation-item",title:(0,h.gettext)("New"),onClick:this.onCreateClick},(0,h.gettext)("New")),s&&u.default.createElement("button",{className:"btn btn-secondary operation-item",title:(0,h.gettext)("Share"),onClick:this.onShareClick},(0,h.gettext)("Share")))}else i=u.default.createElement(p.Dropdown,{isOpen:this.state.isMobileOpMenuOpen,toggle:this.toggleMobileOpMenu},u.default.createElement(p.DropdownToggle,{tag:"span",className:"sf2-icon-plus mobile-toolbar-icon"}),u.default.createElement(p.DropdownMenu,null,u.default.createElement(p.DropdownItem,{onClick:this.onUploadFile},(0,h.gettext)("Upload")),u.default.createElement(p.DropdownItem,{onClick:this.onCreateFolderToggle},(0,h.gettext)("New Folder")),u.default.createElement(p.DropdownItem,{onClick:this.onCreateFileToggle},(0,h.gettext)("New File"))));return u.default.createElement(l.Fragment,null,("rw"===r||"admin"===r)&&u.default.createElement("div",{className:"dir-operation"},u.default.createElement("div",{className:"operation"},i),this.state.isUploadMenuShow&&u.default.createElement("ul",{className:"menu dropdown-menu",style:this.state.operationMenuStyle},u.default.createElement("li",{className:"dropdown-item",onClick:this.onUploadFile},(0,h.gettext)("Upload Files")),u.default.createElement("li",{className:"dropdown-item",onClick:this.onUploadFolder},(0,h.gettext)("Upload Folder"))),this.state.isCreateMenuShow&&u.default.createElement("ul",{className:"menu dropdown-menu",style:this.state.operationMenuStyle},u.default.createElement("li",{className:"dropdown-item",onClick:this.onCreateFolderToggle},(0,h.gettext)("New Folder")),u.default.createElement("li",{className:"dropdown-item",onClick:this.onCreateFileToggle},(0,h.gettext)("New File")),u.default.createElement("li",{className:"dropdown-divider"}),u.default.createElement("li",{className:"dropdown-item",onClick:this.onCreateMarkdownToggle},(0,h.gettext)("New Markdown File")),u.default.createElement("li",{className:"dropdown-item",onClick:this.onCreateExcelToggle},(0,h.gettext)("New Excel File")),u.default.createElement("li",{className:"dropdown-item",onClick:this.onCreatePPTToggle},(0,h.gettext)("New PowerPoint File")),u.default.createElement("li",{className:"dropdown-item",onClick:this.onCreateWordToggle},(0,h.gettext)("New Word File")))),f.Utils.isDesktop()&&u.default.createElement(D.default,{currentMode:this.props.currentMode,switchViewMode:this.props.switchViewMode}),this.state.isCreateFileDialogShow&&u.default.createElement(g.default,null,u.default.createElement(w.default,{parentPath:this.props.path,fileType:this.state.fileType,onAddFile:this.onAddFile,checkDuplicatedName:this.checkDuplicatedName,addFileCancel:this.onCreateFileToggle})),this.state.isCreateFolderDialogShow&&u.default.createElement(g.default,null,u.default.createElement(v.default,{parentPath:this.props.path,onAddFolder:this.onAddFolder,checkDuplicatedName:this.checkDuplicatedName,addFolderCancel:this.onCreateFolderToggle})),this.state.isShareDialogShow&&u.default.createElement(g.default,null,u.default.createElement(S.default,{itemType:a,itemName:o,itemPath:this.props.path,repoID:this.props.repoID,repoEncrypted:this.props.repoEncrypted,enableDirPrivateShare:this.props.enableDirPrivateShare,userPerm:this.props.userPerm,isGroupOwnedRepo:this.props.isGroupOwnedRepo,toggleDialog:this.onShareClick})))}}]),t}(u.default.Component);P.propTypes=_,t.default=P},2263:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(2),h=n(3),m=n(4),g=n(356),y=r(g),v=n(14),b=(r(v),n(745)),w=r(b),E=n(746),S=r(E),C=n(108),D=r(C),_=n(727),P=r(_),k=n(380),M=r(k),O=n(474),L=r(O),I=n(1315),T=r(I),R=n(743),N=r(R),x=n(1026),F=r(x),Y=n(13),Z=r(Y),j=n(733),A=r(j),B=n(5),X=r(B);n(2264);var J={path:d.default.string.isRequired,userPerm:d.default.string.isRequired,repoID:d.default.string.isRequired,repoEncrypted:d.default.bool.isRequired,selectedDirentList:d.default.array.isRequired,onItemsMove:d.default.func.isRequired,onItemsCopy:d.default.func.isRequired,onItemsDelete:d.default.func.isRequired,isRepoOwner:d.default.bool.isRequired,enableDirPrivateShare:d.default.bool.isRequired,currentRepoInfo:d.default.object.isRequired,onFilesTagChanged:d.default.func.isRequired,unSelectDirent:d.default.func.isRequired,updateDirent:d.default.func.isRequired,currentMode:d.default.string.isRequired,switchViewMode:d.default.func.isRequired},U=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMoveToggle=function(){n.setState({isMoveDialogShow:!n.state.isMoveDialogShow})},n.onCopyToggle=function(){n.setState({isCopyDialogShow:!n.state.isCopyDialogShow})},n.onItemsDelete=function(){n.props.onItemsDelete()},n.onItemsDownload=function(){var e=n.props,t=e.path,r=e.repoID,a=e.selectedDirentList;if(a.length){if(1===a.length&&!a[0].isDir()){var o=h.Utils.joinPath(t,a[0].name),i=y.default.getUrl({type:"download_file_url",repoID:r,filePath:o});return void(location.href=i)}n.setState({isZipDialogOpen:!0})}},n.closeZipDialog=function(){n.setState({isZipDialogOpen:!1})},n.checkDuplicatedName=function(e){return h.Utils.checkDuplicatedNameInList(n.props.direntList,e)},n.onItemRename=function(e){var t=n.props.selectedDirentList[0];n.props.onItemRename(t,e)},n.onPermissionItem=function(){n.setState({showLibContentViewDialogs:!n.state.showLibContentViewDialogs,isPermissionDialogOpen:!n.state.isPermissionDialogOpen})},n.onCommentItem=function(){n.props.showDirentDetail("comments")},n.getDirentMenuList=function(e){var t=n.props.isRepoOwner,r=n.props.currentRepoInfo,a=h.Utils.getDirentOperationList(t,r,e,!0),o=["Move","Copy","Delete","Download"];return a="dir"==e.type?a.filter(function(e,t){return-1==o.indexOf(e.key)&&"Divider"!=e}):a.filter(function(e,t){return-1==o.indexOf(e.key)})},n.onMenuItemClick=function(e){var t=n.props.selectedDirentList,r=t[0];switch(e){case"Share":n.setState({showLibContentViewDialogs:!0,showShareDialog:!0});break;case"Rename":n.setState({showLibContentViewDialogs:!0,isRenameDialogOpen:!0});break;case"Permission":n.onPermissionItem();break;case"Tags":n.listFileTags(r);break;case"Lock":n.lockFile(r);break;case"Unlock":n.unlockFile(r);break;case"Comment":n.onCommentItem();break;case"Related Files":n.openRelatedFilesDialog(r);break;case"History":n.onHistory(r);break;case"Access Log":n.onAccessLog(r);break;case"Open via Client":n.onOpenViaClient(r)}},n.lockFile=function(e){var t=n.getDirentPath(e);m.seafileAPI.lockfile(n.props.repoID,t).then(function(t){t.data.is_locked&&(n.props.updateDirent(e,"is_locked",!0),n.props.updateDirent(e,"locked_by_me",!0),n.props.updateDirent(e,"lock_owner_name",f.name),n.props.unSelectDirent())}).catch(function(e){var t=h.Utils.getErrorMsg(e);X.default.danger(t)})},n.unlockFile=function(e){var t=n.getDirentPath(e);m.seafileAPI.unlockfile(n.props.repoID,t).then(function(t){t.data.is_locked||(n.props.updateDirent(e,"is_locked",!1),n.props.updateDirent(e,"locked_by_me",!1),n.props.updateDirent(e,"lock_owner_name",""),n.props.unSelectDirent())}).catch(function(e){var t=h.Utils.getErrorMsg(e);X.default.danger(t)})},n.onOpenViaClient=function(e){var t=n.getDirentPath(e),r=y.default.getUrl({type:"open_via_client",repoID:n.props.repoID,filePath:t});location.href=r},n.onHistory=function(e){var t=n.getDirentPath(e),r=y.default.getUrl({type:"file_revisions",repoID:n.props.repoID,filePath:t});location.href=r},n.onAccessLog=function(e){var t=n.getDirentPath(e),r=f.siteRoot+"repo/file-access/"+n.props.repoID+"/?p="+encodeURIComponent(t);window.open(r)},n.openRelatedFilesDialog=function(e){var t=n.getDirentPath(e);m.seafileAPI.listRelatedFiles(n.props.repoID,t).then(function(e){var t=e.data.related_files;t.length>0?n.setState({relatedFiles:t,showLibContentViewDialogs:!0,showRelatedFileDialog:!0,viewMode:"list_related_file"}):n.setState({relatedFiles:t,showLibContentViewDialogs:!0,showRelatedFileDialog:!0,viewMode:"add_related_file"})}).catch(function(e){var t=h.Utils.getErrorMsg(e);X.default.danger(t)})},n.toggleCancel=function(){n.setState({showLibContentViewDialogs:!1,showShareDialog:!1,showEditFileTagDialog:!1,showRelatedFileDialog:!1,isRenameDialogOpen:!1,isPermissionDialogOpen:!1})},n.listFileTags=function(e){var t=n.getDirentPath(e);m.seafileAPI.listFileTags(n.props.repoID,t).then(function(e){for(var t=e.data.file_tags,r=0,a=t.length;r<a;r++)t[r].id=t[r].file_tag_id;n.setState({fileTagList:t,showLibContentViewDialogs:!0,showEditFileTagDialog:!0})}).catch(function(e){var t=h.Utils.getErrorMsg(e);X.default.danger(t)})},n.onMenuFileTagChanged=function(){n.listFileTags(n.props.selectedDirentList[0]);for(var e=n.props.selectedDirentList.length,t=0;t<e;t++){var r=n.props.selectedDirentList[t],a=n.getDirentPath(r);n.props.onFilesTagChanged(r,a)}},n.listRelatedFiles=function(e){var t=n.getDirentPath(e);m.seafileAPI.listRelatedFiles(n.props.repoID,t).then(function(e){n.setState({relatedFiles:e.data.related_files})}).catch(function(e){var t=h.Utils.getErrorMsg(e);X.default.danger(t)})},n.onRelatedFileChange=function(){n.listRelatedFiles(n.props.selectedDirentList[0])},n.getDirentPath=function(e){if(e)return h.Utils.joinPath(n.props.path,e.name)},n.state={isZipDialogOpen:!1,isMoveDialogShow:!1,isCopyDialogShow:!1,isMutipleOperation:!0,showLibContentViewDialogs:!1,showShareDialog:!1,showEditFileTagDialog:!1,fileTagList:[],multiFileTagList:[],showRelatedFileDialog:!1,viewMode:"list_related_file",isRenameDialogOpen:!1,isPermissionDialogOpen:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=e.repoID,n=e.userPerm,r=this.props.selectedDirentList[0],a=this.getDirentPath(r);return u.default.createElement(l.Fragment,null,u.default.createElement("div",{className:"dir-operation"},u.default.createElement("div",{className:"d-flex"},u.default.createElement(p.ButtonGroup,{className:"flex-row group-operations"},("rw"===n||"admin"===n)&&u.default.createElement(l.Fragment,null,u.default.createElement(p.Button,{className:"secondary group-op-item action-icon sf2-icon-move",title:(0,f.gettext)("Move"),onClick:this.onMoveToggle}),u.default.createElement(p.Button,{className:"secondary group-op-item action-icon sf2-icon-copy",title:(0,f.gettext)("Copy"),onClick:this.onCopyToggle}),u.default.createElement(p.Button,{className:"secondary group-op-item action-icon sf2-icon-delete",title:(0,f.gettext)("Delete"),onClick:this.onItemsDelete})),"r"===n&&u.default.createElement(p.Button,{className:"secondary group-op-item action-icon sf2-icon-copy",title:(0,f.gettext)("Copy"),onClick:this.onCopyToggle}),("rw"===n||"admin"===n||"r"===n)&&u.default.createElement(p.Button,{className:"secondary group-op-item action-icon sf2-icon-download",title:(0,f.gettext)("Download"),onClick:this.onItemsDownload}),1===this.props.selectedDirentList.length&&u.default.createElement(A.default,{tagName:"button",item:this.props.selectedDirentList[0],toggleClass:"fas fa-ellipsis-v dirents-more-menu",onMenuItemClick:this.onMenuItemClick,getMenuList:this.getDirentMenuList})))),h.Utils.isDesktop()&&u.default.createElement(F.default,{currentMode:this.props.currentMode,switchViewMode:this.props.switchViewMode}),this.state.isMoveDialogShow&&u.default.createElement(w.default,{path:this.props.path,repoID:this.props.repoID,repoEncrypted:this.props.repoEncrypted,isMutipleOperation:this.state.isMutipleOperation,selectedDirentList:this.props.selectedDirentList,onItemsMove:this.props.onItemsMove,onCancelMove:this.onMoveToggle}),this.state.isCopyDialogShow&&u.default.createElement(S.default,{path:this.props.path,repoID:this.props.repoID,repoEncrypted:this.props.repoEncrypted,selectedDirentList:this.props.selectedDirentList,isMutipleOperation:this.state.isMutipleOperation,onItemsCopy:this.props.onItemsCopy,onCancelCopy:this.onCopyToggle}),this.state.isZipDialogOpen&&u.default.createElement(Z.default,null,u.default.createElement(L.default,{repoID:this.props.repoID,path:this.props.path,target:this.props.selectedDirentList.map(function(e){return e.name}),toggleDialog:this.closeZipDialog})),this.state.showLibContentViewDialogs&&u.default.createElement(l.Fragment,null,this.state.showShareDialog&&u.default.createElement(Z.default,null,u.default.createElement(D.default,{itemType:r.type,itemName:r.name,itemPath:a,userPerm:r.permission,repoID:t,repoEncrypted:this.props.repoEncrypted,enableDirPrivateShare:this.props.enableDirPrivateShare,isGroupOwnedRepo:this.props.isGroupOwnedRepo,toggleDialog:this.toggleCancel})),this.state.isRenameDialogOpen&&u.default.createElement(Z.default,null,u.default.createElement(T.default,{dirent:r,onRename:this.onItemRename,checkDuplicatedName:this.checkDuplicatedName,toggleCancel:this.toggleCancel})),this.state.isPermissionDialogOpen&&u.default.createElement(Z.default,null,u.default.createElement(N.default,{toggleDialog:this.toggleCancel,repoID:t,folderPath:a,folderName:r.name,isDepartmentRepo:this.props.isGroupOwnedRepo})),this.state.showEditFileTagDialog&&u.default.createElement(Z.default,null,u.default.createElement(M.default,{repoID:t,filePath:a,fileTagList:this.state.fileTagList,toggleCancel:this.toggleCancel,onFileTagChanged:this.onMenuFileTagChanged})),this.state.showRelatedFileDialog&&u.default.createElement(Z.default,null,u.default.createElement(P.default,{repoID:t,filePath:a,relatedFiles:this.state.relatedFiles,toggleCancel:this.toggleCancel,onRelatedFileChange:this.onRelatedFileChange,dirent:this.props.selectedDirentList[0],viewMode:this.state.viewMode}))))}}]),t}(u.default.Component);U.propTypes=J,t.default=U},2264:function(e,t){},2265:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(2),h=n(4),m=n(3),g=n(5),y=r(g),v=n(13),b=r(v),w=n(108),E=r(w),S=n(380),C=r(S),D=n(727),_=r(D),P={path:d.default.string.isRequired,repoID:d.default.string.isRequired,userPerm:d.default.string.isRequired,repoEncrypted:d.default.bool.isRequired,enableDirPrivateShare:d.default.bool.isRequired,isGroupOwnedRepo:d.default.bool.isRequired,filePermission:d.default.string,isDraft:d.default.bool.isRequired,hasDraft:d.default.bool.isRequired,fileTags:d.default.array.isRequired,relatedFiles:d.default.array.isRequired,onFileTagChanged:d.default.func.isRequired,onRelatedFileChange:d.default.func.isRequired,showShareBtn:d.default.bool.isRequired},k=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onEditClick=function(e){e.preventDefault();var t=n.props,r=t.path,a=t.repoID,o=f.siteRoot+"lib/"+a+"/file"+m.Utils.encodePath(r)+"?mode=edit";window.open(o)},n.onNewDraft=function(e){e.preventDefault();var t=n.props,r=t.path,a=t.repoID;h.seafileAPI.createDraft(a,r).then(function(e){window.location.href=f.siteRoot+"lib/"+e.data.origin_repo_id+"/file"+e.data.draft_file_path+"?mode=edit"}).catch(function(e){var t=m.Utils.getErrorMsg(e);y.default.danger(t)})},n.onDraftHover=function(){n.setState({isDraftMessageShow:!n.state.isDraftMessageShow})},n.toggleMore=function(){n.setState({isMoreMenuShow:!n.state.isMoreMenuShow})},n.onShareToggle=function(){n.setState({isShareDialogShow:!n.state.isShareDialogShow})},n.onEditFileTagToggle=function(){n.setState({isEditTagDialogShow:!n.state.isEditTagDialogShow})},n.onListRelatedFileToggle=function(){n.setState({isRelatedFileDialogShow:!0,showRelatedFileDialog:!0})},n.toggleCancel=function(){n.setState({isRelatedFileDialogShow:!1,showRelatedFileDialog:!1})},n.onHistoryClick=function(){var e=f.siteRoot+"repo/file_revisions/"+n.props.repoID+"/?p="+m.Utils.encodePath(n.props.path);location.href=e},n.state={isDraftMessageShow:!1,isMoreMenuShow:!1,isShareDialogShow:!1,isEditTagDialogShow:!1,isRelatedFileDialogShow:!1,showRelatedFileDialog:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.filePermission,t=m.Utils.getFileName(this.props.path),n={name:t};return u.default.createElement(l.Fragment,null,u.default.createElement("div",{className:"dir-operation"},("rw"===e||"cloud-edit"===e)&&!this.props.hasDraft&&u.default.createElement(l.Fragment,null,u.default.createElement("button",{className:"btn btn-secondary operation-item",title:(0,f.gettext)("Edit File"),onClick:this.onEditClick},(0,f.gettext)("Edit"))),"rw"===e&&!this.props.isDraft&&!this.props.hasDraft&&f.isDocs&&u.default.createElement(l.Fragment,null,u.default.createElement("button",{id:"new-draft",className:"btn btn-secondary operation-item",onClick:this.onNewDraft},(0,f.gettext)("New Draft")),u.default.createElement(p.Tooltip,{target:"new-draft",placement:"bottom",isOpen:this.state.isDraftMessageShow,toggle:this.onDraftHover},(0,f.gettext)("Create a draft from this file, instead of editing it directly."))),"rw"===e&&u.default.createElement(p.Dropdown,{isOpen:this.state.isMoreMenuShow,toggle:this.toggleMore},u.default.createElement(p.DropdownToggle,{className:"btn btn-secondary operation-item"},(0,f.gettext)("More")),u.default.createElement(p.DropdownMenu,null,this.props.showShareBtn&&u.default.createElement(p.DropdownItem,{onClick:this.onShareToggle},(0,f.gettext)("Share")),u.default.createElement(p.DropdownItem,{onClick:this.onEditFileTagToggle},(0,f.gettext)("Tags")),u.default.createElement(p.DropdownItem,{onClick:this.onListRelatedFileToggle},(0,f.gettext)("Related Files")),u.default.createElement(p.DropdownItem,{onClick:this.onHistoryClick},(0,f.gettext)("History"))))),this.state.isShareDialogShow&&u.default.createElement(b.default,null,u.default.createElement(E.default,{itemType:"file",itemName:m.Utils.getFileName(this.props.path),itemPath:this.props.path,repoID:this.props.repoID,repoEncrypted:this.props.repoEncrypted,enableDirPrivateShare:this.props.enableDirPrivateShare,userPerm:this.props.userPerm,isGroupOwnedRepo:this.props.isGroupOwnedRepo,toggleDialog:this.onShareToggle})),this.state.isEditTagDialogShow&&u.default.createElement(b.default,null,u.default.createElement(C.default,{filePath:this.props.path,repoID:this.props.repoID,fileTagList:this.props.fileTags,toggleCancel:this.onEditFileTagToggle,onFileTagChanged:this.props.onFileTagChanged})),this.state.showRelatedFileDialog&&u.default.createElement(b.default,null,u.default.createElement(_.default,{repoID:this.props.repoID,filePath:this.props.path,relatedFiles:this.props.relatedFiles,toggleCancel:this.toggleCancel,onRelatedFileChange:this.props.onRelatedFileChange,dirent:n,viewMode:"list_related_file"})))}}]),t}(u.default.Component);k.propTypes=P,t.default=k},2266:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(2),f=n(2267),h=r(f),m=n(2272),g=r(m),y=n(848),v=r(y),b=n(1317),w=r(b),E=n(2285),S=r(E),C=n(2288),D=r(C);n(2292);var _={pathPrefix:d.default.array.isRequired,currentMode:d.default.string.isRequired,path:d.default.string.isRequired,pathExist:d.default.bool.isRequired,currentRepoInfo:d.default.object.isRequired,repoID:d.default.string.isRequired,repoPermission:d.default.bool.isRequired,enableDirPrivateShare:d.default.bool.isRequired,isGroupOwnedRepo:d.default.bool.isRequired,userPerm:d.default.string,onTabNavClick:d.default.func.isRequired,onMainNavBarClick:d.default.func.isRequired,isViewFile:d.default.bool.isRequired,isFileLoadedErr:d.default.bool.isRequired,hash:d.default.string,isDraft:d.default.bool.isRequired,hasDraft:d.default.bool.isRequired,fileTags:d.default.array.isRequired,goDraftPage:d.default.func.isRequired,isFileLoading:d.default.bool.isRequired,filePermission:d.default.string,content:d.default.string,lastModified:d.default.string,latestContributor:d.default.string,onLinkClick:d.default.func.isRequired,isTreeDataLoading:d.default.bool.isRequired,treeData:d.default.object.isRequired,currentNode:d.default.object,onNodeClick:d.default.func.isRequired,onNodeCollapse:d.default.func.isRequired,onNodeExpanded:d.default.func.isRequired,onRenameNode:d.default.func.isRequired,onDeleteNode:d.default.func.isRequired,onAddFileNode:d.default.func.isRequired,onAddFolderNode:d.default.func.isRequired,draftCounts:d.default.number,usedRepoTags:d.default.array.isRequired,readmeMarkdown:d.default.object,updateUsedRepoTags:d.default.func.isRequired,isDirentListLoading:d.default.bool.isRequired,direntList:d.default.array.isRequired,sortBy:d.default.string.isRequired,sortOrder:d.default.string.isRequired,sortItems:d.default.func.isRequired,updateDirent:d.default.func.isRequired,onItemClick:d.default.func.isRequired,onItemSelected:d.default.func.isRequired,onItemDelete:d.default.func.isRequired,onItemRename:d.default.func.isRequired,onItemMove:d.default.func.isRequired,onItemCopy:d.default.func.isRequired,onAddFolder:d.default.func.isRequired,onAddFile:d.default.func.isRequired,onFileTagChanged:d.default.func.isRequired,isDirentSelected:d.default.bool.isRequired,isAllDirentSelected:d.default.bool.isRequired,onAllDirentSelected:d.default.func.isRequired,isDirentDetailShow:d.default.bool.isRequired,selectedDirent:d.default.object,selectedDirentList:d.default.array.isRequired,onItemsMove:d.default.func.isRequired,onItemsCopy:d.default.func.isRequired,onItemsDelete:d.default.func.isRequired,closeDirentDetail:d.default.func.isRequired,showDirentDetail:d.default.func.isRequired,onDeleteRepoTag:d.default.func.isRequired,updateDetail:d.default.bool.isRequired,onListContainerScroll:d.default.func.isRequired,onDirentClick:d.default.func.isRequired,direntDetailPanelTab:d.default.string},P=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onPathClick=function(e){n.props.onMainNavBarClick(e),n.props.closeDirentDetail()},n.onItemClick=function(e){n.props.onItemClick(e),n.props.closeDirentDetail()},n.onGridItemClick=function(e){n.setState({currentDirent:e}),n.props.onDirentClick(e)},n.onDirentClick=function(e){n.setState({currentDirent:e}),n.props.onDirentClick(e)},n.onItemSelected=function(e){n.setState({currentDirent:e}),n.props.onItemSelected(e)},n.onItemDelete=function(e){n.checkCurrentDirent(e),n.props.onItemDelete(e)},n.onItemMove=function(e,t,r,a){n.checkCurrentDirent(t),n.props.onItemMove(e,t,r,a)},n.checkCurrentDirent=function(e){var t=n.state.currentDirent;t&&e.name===t.name&&n.setState({currentDirent:null})},n.onItemsScroll=function(e){var t=e.target;0!==t.scrollTop&&t.scrollTop+t.clientHeight+1>=t.scrollHeight&&n.props.onListContainerScroll()},n.state={currentDirent:null},n.errMessage=u.default.createElement("div",{className:"message err-tip"},(0,p.gettext)("Folder does not exist.")),n}return i(t,e),s(t,[{key:"componentWillReceiveProps",value:function(e){e.path===this.props.path&&e.updateDetail===this.props.updateDetail||this.setState({currentDirent:null})}},{key:"render",value:function(){var e=this.props,t=e.path,n=e.repoID,r=e.usedRepoTags,a=e.readmeMarkdown,o=e.draftCounts,i=!1;return"/"===t&&(0===r.length&&null===a&&0===o||(i=!0)),u.default.createElement(l.Fragment,null,u.default.createElement("div",{className:"cur-view-container"},"read-only"===this.props.currentRepoInfo.status&&u.default.createElement("div",{className:"readonly-tip-message"},(0,p.gettext)("This library has been set to read-only by admin and cannot be updated.")),u.default.createElement("div",{className:"cur-view-path"},u.default.createElement(h.default,{repoID:n,repoName:this.props.currentRepoInfo.repo_name,pathPrefix:this.props.pathPrefix,currentPath:this.props.path,permission:this.props.repoPermission,isViewFile:this.props.isViewFile,onTabNavClick:this.props.onTabNavClick,onPathClick:this.onPathClick,updateUsedRepoTags:this.props.updateUsedRepoTags,fileTags:this.props.fileTags,onDeleteRepoTag:this.props.onDeleteRepoTag,direntList:this.props.direntList,sortBy:this.props.sortBy,sortOrder:this.props.sortOrder,sortItems:this.props.sortItems})),u.default.createElement("div",{className:"cur-view-content lib-content-container "+("column"===this.props.currentMode?"view-mode-container":""),onScroll:this.onItemsScroll},!this.props.pathExist&&this.errMessage,this.props.pathExist&&u.default.createElement(l.Fragment,null,"list"===this.props.currentMode&&u.default.createElement(w.default,{path:this.props.path,repoID:n,currentRepoInfo:this.props.currentRepoInfo,isGroupOwnedRepo:this.props.isGroupOwnedRepo,userPerm:this.props.userPerm,enableDirPrivateShare:this.props.enableDirPrivateShare,isRepoInfoBarShow:i,usedRepoTags:this.props.usedRepoTags,readmeMarkdown:this.props.readmeMarkdown,draftCounts:this.props.draftCounts,updateUsedRepoTags:this.props.updateUsedRepoTags,isDirentListLoading:this.props.isDirentListLoading,direntList:this.props.direntList,sortBy:this.props.sortBy,sortOrder:this.props.sortOrder,sortItems:this.props.sortItems,onAddFolder:this.props.onAddFolder,onAddFile:this.props.onAddFile,onItemClick:this.onItemClick,onItemSelected:this.onItemSelected,onItemDelete:this.onItemDelete,onItemRename:this.props.onItemRename,onItemMove:this.onItemMove,onItemCopy:this.props.onItemCopy,onDirentClick:this.onDirentClick,updateDirent:this.props.updateDirent,isAllItemSelected:this.props.isAllDirentSelected,onAllItemSelected:this.props.onAllDirentSelected,selectedDirentList:this.props.selectedDirentList,onItemsMove:this.props.onItemsMove,onItemsCopy:this.props.onItemsCopy,onItemsDelete:this.props.onItemsDelete,onFileTagChanged:this.props.onFileTagChanged,showDirentDetail:this.props.showDirentDetail}),"grid"===this.props.currentMode&&u.default.createElement(S.default,{path:this.props.path,repoID:n,currentRepoInfo:this.props.currentRepoInfo,repoPermission:this.props.repoPermission,isGroupOwnedRepo:this.props.isGroupOwnedRepo,userPerm:this.props.userPerm,enableDirPrivateShare:this.props.enableDirPrivateShare,onRenameNode:this.props.onRenameNode,isRepoInfoBarShow:i,usedRepoTags:this.props.usedRepoTags,readmeMarkdown:this.props.readmeMarkdown,draftCounts:this.props.draftCounts,updateUsedRepoTags:this.props.updateUsedRepoTags,isDirentListLoading:this.props.isDirentListLoading,direntList:this.props.direntList,onAddFile:this.props.onAddFile,onItemClick:this.onItemClick,onItemDelete:this.props.onItemDelete,onItemMove:this.onItemMove,onItemCopy:this.props.onItemCopy,updateDirent:this.props.updateDirent,onAddFolder:this.props.onAddFolder,showDirentDetail:this.props.showDirentDetail,onGridItemClick:this.onGridItemClick,isDirentDetailShow:this.props.isDirentDetailShow,onItemRename:this.props.onItemRename,onFileTagChanged:this.props.onFileTagChanged}),"column"===this.props.currentMode&&u.default.createElement(D.default,{path:this.props.path,repoID:n,currentRepoInfo:this.props.currentRepoInfo,repoPermission:this.props.repoPermission,isGroupOwnedRepo:this.props.isGroupOwnedRepo,userPerm:this.props.userPerm,enableDirPrivateShare:this.props.enableDirPrivateShare,isTreeDataLoading:this.props.isTreeDataLoading,treeData:this.props.treeData,currentNode:this.props.currentNode,onNodeClick:this.props.onNodeClick,onNodeCollapse:this.props.onNodeCollapse,onNodeExpanded:this.props.onNodeExpanded,onAddFolderNode:this.props.onAddFolder,onAddFileNode:this.props.onAddFile,onRenameNode:this.props.onRenameNode,onDeleteNode:this.props.onDeleteNode,isViewFile:this.props.isViewFile,isFileLoading:this.props.isFileLoading,isFileLoadedErr:this.props.isFileLoadedErr,hash:this.props.hash,isDraft:this.props.isDraft,hasDraft:this.props.hasDraft,goDraftPage:this.props.goDraftPage,filePermission:this.props.filePermission,content:this.props.content,lastModified:this.props.lastModified,latestContributor:this.props.latestContributor,onLinkClick:this.props.onLinkClick,isRepoInfoBarShow:i,usedRepoTags:this.props.usedRepoTags,readmeMarkdown:this.props.readmeMarkdown,draftCounts:this.props.draftCounts,updateUsedRepoTags:this.props.updateUsedRepoTags,isDirentListLoading:this.props.isDirentListLoading,direntList:this.props.direntList,sortBy:this.props.sortBy,sortOrder:this.props.sortOrder,sortItems:this.props.sortItems,onAddFolder:this.props.onAddFolder,onAddFile:this.props.onAddFile,onItemClick:this.onItemClick,onItemSelected:this.onItemSelected,onItemDelete:this.onItemDelete,onItemRename:this.props.onItemRename,onItemMove:this.onItemMove,onItemCopy:this.props.onItemCopy,onDirentClick:this.onDirentClick,updateDirent:this.props.updateDirent,isAllItemSelected:this.props.isAllDirentSelected,onAllItemSelected:this.props.onAllDirentSelected,selectedDirentList:this.props.selectedDirentList,onItemsMove:this.props.onItemsMove,onItemsCopy:this.props.onItemsCopy,onItemsDelete:this.props.onItemsDelete,onFileTagChanged:this.props.onFileTagChanged,showDirentDetail:this.props.showDirentDetail})))),this.props.isDirentDetailShow&&u.default.createElement(l.Fragment,null,u.default.createElement("div",{className:"cur-view-detail"},"/"!==this.props.path||this.state.currentDirent?u.default.createElement(g.default,{repoID:n,path:this.props.path,dirent:this.state.currentDirent,currentRepoInfo:this.props.currentRepoInfo,onFileTagChanged:this.props.onFileTagChanged,onItemDetailsClose:this.props.closeDirentDetail,direntDetailPanelTab:this.props.direntDetailPanelTab}):u.default.createElement(v.default,{currentRepo:this.props.currentRepoInfo,closeDetails:this.props.closeDirentDetail}))))}}]),t}(u.default.Component);P.propTypes=_,t.default=P},2267:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(3),f=n(736),h=r(f),m=n(2268),g=r(m),y=n(2269),v=r(y),b={repoID:d.default.string.isRequired,repoName:d.default.string.isRequired,permission:d.default.bool.isRequired,currentPath:d.default.string.isRequired,onPathClick:d.default.func.isRequired,onTabNavClick:d.default.func,pathPrefix:d.default.array,isViewFile:d.default.bool,updateUsedRepoTags:d.default.func.isRequired,fileTags:d.default.array.isRequired,onDeleteRepoTag:d.default.func.isRequired},w=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleSortOptionsDialog=function(){n.setState({isSortOptionsDialogOpen:!n.state.isSortOptionsDialogOpen})},n.state={isSortOptionsDialogOpen:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=p.Utils.isDesktop();return u.default.createElement(l.Fragment,null,u.default.createElement(g.default,{repoName:this.props.repoName,pathPrefix:this.props.pathPrefix,currentPath:this.props.currentPath,onPathClick:this.props.onPathClick,onTabNavClick:this.props.onTabNavClick,repoID:this.props.repoID,isViewFile:this.props.isViewFile,fileTags:this.props.fileTags}),e&&u.default.createElement(v.default,{repoID:this.props.repoID,repoName:this.props.repoName,permission:this.props.permission,currentPath:this.props.currentPath,updateUsedRepoTags:this.props.updateUsedRepoTags,onDeleteRepoTag:this.props.onDeleteRepoTag}),!e&&this.props.direntList.length>0&&u.default.createElement("span",{className:"sf3-font sf3-font-sort action-icon",onClick:this.toggleSortOptionsDialog}),this.state.isSortOptionsDialogOpen&&u.default.createElement(h.default,{toggleDialog:this.toggleSortOptionsDialog,sortBy:this.props.sortBy,sortOrder:this.props.sortOrder,sortItems:this.props.sortItems}))}}]),t}(u.default.Component);w.propTypes=b,t.default=w},2268:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(15),f=n(6),h=n(2),m=n(275),g=r(m),y=n(3),v={repoName:d.default.string.isRequired,currentPath:d.default.string.isRequired,onPathClick:d.default.func.isRequired,onTabNavClick:d.default.func,pathPrefix:d.default.array,repoID:d.default.string.isRequired,isViewFile:d.default.bool,fileTags:d.default.array.isRequired},b=function(e){function t(){var e,n,r,i;a(this,t);for(var s=arguments.length,c=Array(s),d=0;d<s;d++)c[d]=arguments[d];return n=r=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),r.onPathClick=function(e){var t=y.Utils.getEventData(e,"path");r.props.onPathClick(t)},r.onTabNavClick=function(e,t,n){if(window.uploader&&window.uploader.isUploadProgressDialogShow&&100!==window.uploader.totalProgress){if(!window.confirm((0,h.gettext)("A file is being uploaded. Are you sure you want to leave this page?")))return e.preventDefault(),!1;window.uploader.isUploadProgressDialogShow=!1}r.props.onTabNavClick(t,n)},r.turnPathToLink=function(e){e="/"===e[e.length-1]?e.slice(0,e.length-1):e;var t=e.split("/"),n="";return t.map(function(e,a){if(""!==e)return a===t.length-1?u.default.createElement(l.Fragment,{key:a},u.default.createElement("span",{className:"path-split"},"/"),u.default.createElement("span",{className:"path-file-name"},e)):(n+="/"+e,u.default.createElement(l.Fragment,{key:a},u.default.createElement("span",{className:"path-split"},"/"),u.default.createElement("a",{className:"path-link","data-path":n,onClick:r.onPathClick},e)))})},i=n,o(r,i)}return i(t,e),s(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.currentPath,r=t.repoName,a=t.fileTags,o=this.turnPathToLink(n),i="";return a.length>0&&a.forEach(function(e){i+=e.name+" "}),u.default.createElement("div",{className:"path-container"},this.props.pathPrefix&&this.props.pathPrefix.map(function(t,n){return u.default.createElement(l.Fragment,{key:n},u.default.createElement(p.Link,{to:t.url,className:"normal",onClick:function(n){return e.onTabNavClick(n,t.name,t.id)}},(0,h.gettext)(t.showName)),u.default.createElement("span",{className:"path-split"},"/"))}),this.props.pathPrefix&&0===this.props.pathPrefix.length&&u.default.createElement(l.Fragment,null,u.default.createElement(p.Link,{to:h.siteRoot+"my-libs/",className:"normal",onClick:function(t){return e.onTabNavClick(t,"my-libs")}},(0,h.gettext)("Libraries")),u.default.createElement("span",{className:"path-split"},"/")),!this.props.pathPrefix&&u.default.createElement(l.Fragment,null,u.default.createElement(p.Link,{href:h.siteRoot+"my-libs/",className:"normal",onClick:function(t){return e.onTabNavClick(t,"my-libs")}},(0,h.gettext)("Libraries")),u.default.createElement("span",{className:"path-split"},"/")),"/"===n||""===n?u.default.createElement("span",{className:"path-repo-name"},r):u.default.createElement("a",{className:"path-link","data-path":"/",onClick:this.onPathClick},r),o,this.props.isViewFile&&u.default.createElement(g.default,{repoID:this.props.repoID,path:this.props.currentPath}),this.props.isViewFile&&0!==a.length&&u.default.createElement("span",{id:"column-mode-file-tags",className:"tag-list tag-list-stacked align-middle ml-1"},a.map(function(e,t){return u.default.createElement("span",{className:"file-tag",key:e.id,style:{zIndex:t,backgroundColor:e.color}})}),u.default.createElement(f.UncontrolledTooltip,{target:"column-mode-file-tags",placement:"bottom"},i)))}}]),t}(u.default.Component);b.propTypes=v,t.default=b},2269:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(2),d=n(3),p=n(1),f=r(p),h=n(13),m=r(h),g=n(6),y=n(2270),v=r(y),b=n(844),w=r(b),E=n(2271),S=r(E),C=n(1316),D=r(C),_={repoID:f.default.string.isRequired,repoName:f.default.string.isRequired,permission:f.default.bool.isRequired,currentPath:f.default.string.isRequired,updateUsedRepoTags:f.default.func.isRequired,onDeleteRepoTag:f.default.func.isRequired},P=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onShowListRepoTag=function(){n.setState({isRepoTagDialogShow:!0,isListRepoTagShow:!0,isUpdateRepoTagShow:!1,isCreateRepoTagShow:!1,isListTaggedFileShow:!1})},n.onCloseRepoTagDialog=function(){n.setState({isRepoTagDialogShow:!1,isListRepoTagShow:!1,isUpdateRepoTagShow:!1,isCreateRepoTagShow:!1,isListTaggedFileShow:!1})},n.onCreateRepoTagToggle=function(){n.setState({isCreateRepoTagShow:!n.state.isCreateRepoTagShow,isListRepoTagShow:!n.state.isListRepoTagShow})},n.onUpdateRepoTagToggle=function(e){n.setState({currentTag:e,isListRepoTagShow:!n.state.isListRepoTagShow,isUpdateRepoTagShow:!n.state.isUpdateRepoTagShow})},n.onListTaggedFileToggle=function(e){n.setState({currentTag:e,isListRepoTagShow:!n.state.isListRepoTagShow,isListTaggedFileShow:!n.state.isListTaggedFileShow})},n.state={isRepoTagDialogShow:!1,currentTag:null,isListRepoTagShow:!1,isUpdateRepoTagShow:!1,isCreateRepoTagShow:!1,isListTaggedFileShow:!1},n}return i(t,e),s(t,[{key:"isMarkdownFile",value:function(e){return d.Utils.getFileName(e).indexOf(".md")>-1}},{key:"render",value:function(){var e=this.props,t=e.repoID,n=(e.repoName,e.permission),r=e.currentPath,a=this.isMarkdownFile(r),o=d.Utils.getFileName(r),i=c.siteRoot+"repo/"+t+"/trash/",s=c.siteRoot+"repo/history/"+t+"/";return n&&!a?o?(i=c.siteRoot+"repo/"+t+"/trash/?path="+encodeURIComponent(r),u.default.createElement("ul",{className:"path-toolbar"},u.default.createElement("li",{className:"toolbar-item"},u.default.createElement("a",{className:"op-link sf2-icon-recycle",href:i,title:(0,c.gettext)("Trash"),"aria-label":(0,c.gettext)("Trash")})))):u.default.createElement(l.Fragment,null,u.default.createElement("ul",{className:"path-toolbar"},u.default.createElement("li",{className:"toolbar-item"},u.default.createElement("a",{className:"op-link sf2-icon-tag",onClick:this.onShowListRepoTag,title:(0,c.gettext)("Tags"),"aria-label":(0,c.gettext)("Tags")})),u.default.createElement("li",{className:"toolbar-item"},u.default.createElement("a",{className:"op-link sf2-icon-recycle",href:i,title:(0,c.gettext)("Trash"),"aria-label":(0,c.gettext)("Trash")})),u.default.createElement("li",{className:"toolbar-item"},u.default.createElement("a",{className:"op-link sf2-icon-history",href:s,title:(0,c.gettext)("History"),"aria-label":(0,c.gettext)("History")}))),this.state.isRepoTagDialogShow&&u.default.createElement(m.default,null,u.default.createElement(g.Modal,{isOpen:!0},this.state.isListRepoTagShow&&u.default.createElement(v.default,{repoID:t,onListTagCancel:this.onCloseRepoTagDialog,onCreateRepoTag:this.onCreateRepoTagToggle,onUpdateRepoTag:this.onUpdateRepoTagToggle,onListTaggedFiles:this.onListTaggedFileToggle}),this.state.isCreateRepoTagShow&&u.default.createElement(w.default,{repoID:t,onClose:this.onCloseRepoTagDialog,toggleCancel:this.onCreateRepoTagToggle}),this.state.isUpdateRepoTagShow&&u.default.createElement(S.default,{repoID:t,currentTag:this.state.currentTag,onClose:this.onCloseRepoTagDialog,toggleCancel:this.onUpdateRepoTagToggle,onDeleteRepoTag:this.props.onDeleteRepoTag,updateUsedRepoTags:this.props.updateUsedRepoTags}),this.state.isListTaggedFileShow&&u.default.createElement(D.default,{repoID:this.props.repoID,currentTag:this.state.currentTag,onClose:this.onCloseRepoTagDialog,toggleCancel:this.onListTaggedFileToggle,updateUsedRepoTags:this.props.updateUsedRepoTags})))):""}}]),t}(u.default.Component);P.propTypes=_,t.default=P},2270:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(2),h=n(4),m=n(3),g=n(5),y=r(g),v=n(726),b=r(v);n(845);var w={item:d.default.object.isRequired,onTagUpdate:d.default.func.isRequired,onListTaggedFiles:d.default.func.isRequired},E=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseOver=function(){n.setState({showSelectedTag:!0})},n.onMouseOut=function(){n.setState({showSelectedTag:!1})},n.onTagUpdate=function(){n.props.onTagUpdate(n.props.item)},n.onListTaggedFiles=function(){n.props.onListTaggedFiles(n.props.item)},n.state={showSelectedTag:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.item.color,t=m.Utils.getDarkColor(e),n=this.props.item.fileCount,r=1===n||0===n?(0,f.gettext)("file"):(0,f.gettext)("files");return u.default.createElement("li",{className:"tag-list-item"},u.default.createElement("div",{className:"tag-demo",style:{backgroundColor:e},onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut},u.default.createElement("span",{className:this.state.showSelectedTag?"show-tag-selected":"",style:{backgroundColor:t}}),u.default.createElement("span",{className:"tag-name"},this.props.item.name),u.default.createElement("span",{className:"tag-files",onClick:this.onListTaggedFiles},n," ",r)),u.default.createElement("i",{className:"tag-edit fa fa-pencil-alt",onClick:this.onTagUpdate}))}}]),t}(u.default.Component);E.propTypes=w;var S={repoID:d.default.string.isRequired,onListTagCancel:d.default.func.isRequired,onCreateRepoTag:d.default.func.isRequired,onUpdateRepoTag:d.default.func.isRequired,onListTaggedFiles:d.default.func.isRequired},C=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggle=function(){n.props.onListTagCancel()},n.createNewTag=function(e){e.preventDefault(),n.props.onCreateRepoTag()},n.state={repotagList:[]},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.repoID;h.seafileAPI.listRepoTags(t).then(function(t){var n=[];t.data.repo_tags.forEach(function(e){var t=new b.default(e);n.push(t)}),e.setState({repotagList:n})}).catch(function(e){var t=m.Utils.getErrorMsg(e);y.default.danger(t)})}},{key:"render",value:function(){var e=this;return u.default.createElement(l.Fragment,null,u.default.createElement(p.ModalHeader,{toggle:this.toggle},(0,f.gettext)("Tags")),u.default.createElement(p.ModalBody,null,u.default.createElement("ul",{className:"tag-list tag-list-container"},this.state.repotagList.map(function(t,n){return u.default.createElement(E,{key:n,item:t,onTagUpdate:e.props.onUpdateRepoTag,onListTaggedFiles:e.props.onListTaggedFiles})})),u.default.createElement("a",{href:"#",className:"add-tag-link",onClick:this.createNewTag},(0,f.gettext)("Create a new tag"))),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{color:"secondary",onClick:this.toggle},(0,f.gettext)("Close"))))}}]),t}(u.default.Component);C.propTypes=S,t.default=C},2271:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(2),h=n(4),m=n(3),g=n(5),y=r(g),v={currentTag:d.default.object,repoID:d.default.string.isRequired,toggleCancel:d.default.func.isRequired,onDeleteRepoTag:d.default.func.isRequired,updateUsedRepoTags:d.default.func.isRequired,onClose:d.default.func.isRequired},b=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.inputNewName=function(e){n.setState({newName:e.target.value})},n.selectNewcolor=function(e){n.setState({newColor:e.target.value})},n.updateTag=function(){var e=n.props.currentTag.id,t=n.state.newName,r=n.state.newColor,a=n.props.repoID;h.seafileAPI.updateRepoTag(a,e,t,r).then(function(){n.props.toggleCancel(),n.props.updateUsedRepoTags()}).catch(function(e){var t=m.Utils.getErrorMsg(e);y.default.danger(t)})},n.handleKeyPress=function(e){"Enter"===e.key&&n.updateTag()},n.deleteTagClick=function(e){n.setState({deleteRepoTag:!n.state.deleteRepoTag})},n.onDeleteTag=function(){var e=n.props.currentTag,t=n.props.repoID;h.seafileAPI.deleteRepoTag(t,e.id).then(function(t){n.props.toggleCancel(),"true"===t.data.success&&n.props.onDeleteRepoTag(e.id)}).catch(function(e){var t=m.Utils.getErrorMsg(e);y.default.danger(t)})},n.state={deleteRepoTag:!1,newName:n.props.currentTag.name,newColor:n.props.currentTag.color,colorList:["#FFA8A8","#FFA94D","#FFD43B","#A0EC50","#A9E34B","#63E6BE","#4FD2C9","#72C3FC","#91A7FF","#E599F7","#B197FC","#F783AC","#CED4DA"]},n.newInput=u.default.createRef(),n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){this.newInput.focus(),this.newInput.setSelectionRange(0,-1)}},{key:"render",value:function(){var e=this,t=this.state.colorList;return-1===t.indexOf(this.props.currentTag.color)&&t.push(this.props.currentTag.color),u.default.createElement(l.Fragment,null,u.default.createElement(p.ModalHeader,{toggle:this.props.onClose},u.default.createElement("span",{className:"tag-dialog-back fas fa-sm fa-arrow-left",onClick:this.props.toggleCancel,"aria-label":(0,f.gettext)("Back")}),(0,f.gettext)("Edit Tag")),u.default.createElement(p.ModalBody,null,u.default.createElement("div",{className:"tag-edit"},u.default.createElement("div",{className:"form-group"},u.default.createElement("label",{className:"form-label"},(0,f.gettext)("Name")),u.default.createElement(p.Input,{onKeyPress:this.handleKeyPress,innerRef:function(t){e.newInput=t},value:this.state.newName,onChange:this.inputNewName})),u.default.createElement("div",{className:"form-group"},u.default.createElement("label",{className:"form-label"},(0,f.gettext)("Select a color")),u.default.createElement("div",{className:"row gutters-xs"},t.map(function(t,n){return u.default.createElement("div",{key:n,className:"col-auto",onChange:e.selectNewcolor},u.default.createElement("label",{className:"colorinput"},t===e.props.currentTag.color?u.default.createElement("input",{name:"color",type:"radio",value:t,className:"colorinput-input",defaultChecked:!0,onChange:e.selectNewcolor}):u.default.createElement("input",{name:"color",type:"radio",value:t,className:"colorinput-input",onChange:e.selectNewcolor}),u.default.createElement("span",{className:"colorinput-color",style:{backgroundColor:t}})))}))))),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{color:"danger",onClick:this.onDeleteTag},(0,f.gettext)("Delete")),u.default.createElement(p.Button,{color:"primary",onClick:this.updateTag},(0,f.gettext)("Save"))))}}]),t}(u.default.Component);b.propTypes=v,t.default=b},2272:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(41),f=r(p),h=n(6),m=n(2273),g=r(m),y=n(2),v=n(4),b=n(3),w=n(5),E=r(w),S=n(43),C=r(S),D=n(2274),_=r(D),P=n(72),k=r(P);n(381);var M={repoID:d.default.string.isRequired,dirent:d.default.object,path:d.default.string.isRequired,currentRepoInfo:d.default.object.isRequired,onItemDetailsClose:d.default.func.isRequired,onFileTagChanged:d.default.func.isRequired,direntDetailPanelTab:d.default.string},O=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.loadDirentInfo=function(e,t,r){if(e){var a=b.Utils.joinPath(t,e.name);n.updateDetailView(e,a)}else{var o=b.Utils.getDirName(t);v.seafileAPI.listDir(r,o).then(function(e){for(var r=e.data.dirent_list,a=null,o=0;o<r.length;o++){var i=r[o];if(i.parent_dir+i.name===t){a=new C.default(i);break}}n.setState({folderDirent:a}),n.updateDetailView(a,t)}).catch(function(e){var t=b.Utils.getErrorMsg(e);E.default.danger(t)})}},n.updateDetailView=function(e,t){var r=n.props.repoID;"file"===e.type?(v.seafileAPI.getFileInfo(r,t).then(function(e){n.setState({direntType:"file",direntDetail:e.data})}).catch(function(e){var t=b.Utils.getErrorMsg(e);E.default.danger(t)}),v.seafileAPI.listFileTags(r,t).then(function(e){var t=[];e.data.file_tags.forEach(function(e){var n=new k.default(e);t.push(n)}),n.setState({fileTagList:t})}).catch(function(e){var t=b.Utils.getErrorMsg(e);E.default.danger(t)}),v.seafileAPI.listRelatedFiles(r,t).then(function(e){var t=[];e.data.related_files.map(function(e){t.push(e)}),n.setState({relatedFiles:t})}).catch(function(e){500===e.response.status&&n.setState({relatedFiles:[]})}),n.listParticipants(r,t)):v.seafileAPI.getDirInfo(r,t).then(function(e){n.setState({direntType:"dir",direntDetail:e.data})}).catch(function(e){var t=b.Utils.getErrorMsg(e);E.default.danger(t)})},n.listParticipants=function(e,t){v.seafileAPI.listFileParticipants(e,t).then(function(e){n.setState({fileParticipantList:e.data.participant_list})})},n.onParticipantsChange=function(e,t){n.listParticipants(e,t)},n.onRelatedFileChange=function(e,t){n.updateDetailView(e,t)},n.tabItemClick=function(e){n.state.activeTab!==e&&n.setState({activeTab:e})},n.renderNavItem=function(e){switch(e){case"info":return u.default.createElement(h.NavItem,{className:"nav-item w-50"},u.default.createElement(h.NavLink,{className:(0,f.default)({active:"info"===n.state.activeTab}),onClick:function(){n.tabItemClick("info")}},u.default.createElement("i",{className:"fas fa-info-circle"})));case"comments":return u.default.createElement(h.NavItem,{className:"nav-item w-50"},u.default.createElement(h.NavLink,{className:(0,f.default)({active:"comments"===n.state.activeTab}),onClick:function(){n.tabItemClick("comments")}},u.default.createElement("i",{className:"fa fa-comments"})))}},n.renderHeader=function(e,t){return u.default.createElement("div",{className:"detail-header"},u.default.createElement("div",{className:"detail-control sf2-icon-x1",onClick:n.props.onItemDetailsClose}),u.default.createElement("div",{className:"detail-title dirent-title"},u.default.createElement("img",{src:e,width:"24",height:"24",alt:""})," ",u.default.createElement("span",{className:"name ellipsis",title:t},t)))},n.renderDetailBody=function(e,t){return u.default.createElement(l.Fragment,null,u.default.createElement("div",{className:"detail-body dirent-info"},u.default.createElement("div",{className:"img"},u.default.createElement("img",{src:e,className:"thumbnail",alt:""})),n.state.direntDetail&&u.default.createElement("div",{className:"dirent-table-container"},u.default.createElement(_.default,{repoInfo:n.props.currentRepoInfo,path:n.props.path,repoID:n.props.repoID,dirent:n.props.dirent||t,direntType:n.state.direntType,direntDetail:n.state.direntDetail,fileTagList:n.state.fileTagList,relatedFiles:n.state.relatedFiles,onFileTagChanged:n.props.onFileTagChanged,onRelatedFileChange:n.onRelatedFileChange,fileParticipantList:n.state.fileParticipantList,onParticipantsChange:n.onParticipantsChange}))))},n.state={direntType:"",direntDetail:"",fileTagList:[],relatedFiles:[],folderDirent:null,activeTab:"info",fileParticipantList:[]},n}return i(t,e),s(t,[{key:"componentWillMount",value:function(){this.props.direntDetailPanelTab&&this.tabItemClick(this.props.direntDetailPanelTab)}},{key:"componentDidMount",value:function(){var e=this.props,t=e.dirent,n=e.path,r=e.repoID;this.loadDirentInfo(t,n,r)}},{key:"componentWillReceiveProps",value:function(e){var t=e.dirent,n=e.path,r=e.repoID;this.props.dirent!==e.dirent&&this.loadDirentInfo(t,n,r),this.props.direntDetailPanelTab&&this.tabItemClick(this.props.direntDetailPanelTab)}},{key:"render",value:function(){var e=this.props,t=e.dirent,n=e.repoID,r=e.path,a=this.state.folderDirent;if(!t&&!a)return"";var o=t?b.Utils.getDirentIcon(t):b.Utils.getDirentIcon(a),i=t?b.Utils.getDirentIcon(t,!0):b.Utils.getDirentIcon(a,!0);(t?b.Utils.imageCheck(t.name):b.Utils.imageCheck(a.name))&&(i=y.siteRoot+"thumbnail/"+n+"/1024"+b.Utils.encodePath(("/"===r?"":r)+"/"+t.name));var s=t?t.name:a.name;return t&&"file"===t.type||r.lastIndexOf(".")>-1?u.default.createElement("div",{className:"detail-container"},this.renderHeader(o,s),u.default.createElement(h.Nav,{tabs:!0,className:"mx-0"},this.renderNavItem("info"),this.renderNavItem("comments")),u.default.createElement(h.TabContent,{activeTab:this.state.activeTab},u.default.createElement(h.TabPane,{tabId:"info"},this.renderDetailBody(i,a)),u.default.createElement(h.TabPane,{tabId:"comments",className:"comments h-100"},u.default.createElement(g.default,{repoID:this.props.repoID,filePath:t&&"file"===t.type?b.Utils.joinPath(r,t.name):r,fileParticipantList:this.state.fileParticipantList,onParticipantsChange:this.onParticipantsChange})))):u.default.createElement("div",{className:"detail-container"},this.renderHeader(o,s),this.renderDetailBody(i,a))}}]),t}(u.default.Component);O.propTypes=M,t.default=O},2273:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(7),f=r(p),h=n(126),m=n(6),g=n(2),y=n(4),v=n(3),b=n(5),w=r(b),E=n(256),S=r(E),C=n(340),D=n(277);n(278);var _={repoID:d.default.string.isRequired,filePath:d.default.string.isRequired,onParticipantsChange:d.default.func.isRequired,fileParticipantList:d.default.array.isRequired},P=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleCommentChange=function(e){n.setState({comment:e.target.value})},n.listComments=function(e){y.seafileAPI.listComments(n.props.repoID,e||n.props.filePath).then(function(e){n.setState({commentsList:e.data.comments})}).catch(function(e){var t=v.Utils.getErrorMsg(e);w.default.danger(t)})},n.addComment=function(){var e=n.props,t=e.repoID,r=e.filePath;n.state.comment.trim()&&(y.seafileAPI.postComment(t,r,n.state.comment.trim()).then(function(){n.listComments()}).catch(function(e){w.default.danger(v.Utils.getErrorMsg(e))}),n.setState({comment:""}))},n.onSubmit=function(){if(n.addParticipant(g.username),0===n.toBeAddedParticipant.length)n.addComment();else{var e=n.props,t=e.repoID,r=e.filePath;y.seafileAPI.addFileParticipants(t,r,n.toBeAddedParticipant).then(function(e){n.props.onParticipantsChange(t,r),n.toBeAddedParticipant=[],n.addComment()}).catch(function(e){w.default.danger(v.Utils.getErrorMsg(e))})}},n.resolveComment=function(e){var t=n.props.repoID;y.seafileAPI.updateComment(t,e.target.id,"true").then(function(){n.listComments()}).catch(function(e){var t=v.Utils.getErrorMsg(e);w.default.danger(t)})},n.deleteComment=function(e){var t=n.props.repoID;y.seafileAPI.deleteComment(t,e.target.id).then(function(){n.listComments()}).catch(function(e){var t=v.Utils.getErrorMsg(e);w.default.danger(t)})},n.editComment=function(e,t){var r=n.props.repoID;y.seafileAPI.updateComment(r,e,null,null,t).then(function(){n.listComments()}).catch(function(e){var t=v.Utils.getErrorMsg(e);w.default.danger(t)})},n.listRepoRelatedUsers=function(){var e=n.props.repoID;y.seafileAPI.listRepoRelatedUsers(e).then(function(e){var t=e.data.user_list.map(function(e){return{id:e.email,display:e.name}});n.setState({relatedUsers:t})})},n.checkParticipant=function(e){return n.props.fileParticipantList.map(function(e){return e.email}).includes(e)},n.addParticipant=function(e){n.checkParticipant(e)||n.toBeAddedParticipant.push(e)},n.renderUserSuggestion=function(e,t,n,r,a){return u.default.createElement("div",{className:"user "+(a?"focused":"")},n)},n.state={commentsList:[],relatedUsers:null,comment:""},n.toBeAddedParticipant=[],n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){this.listComments(),this.checkParticipant(),this.listRepoRelatedUsers()}},{key:"componentWillReceiveProps",value:function(e){e.filePath!==this.props.filePath&&this.listComments(e.filePath)}},{key:"render",value:function(){var e=this,t=this.props,n=t.repoID,r=t.filePath,a=t.fileParticipantList;return u.default.createElement("div",{className:"seafile-comment detail-comments h-100 w-100"},u.default.createElement("ul",{className:"seafile-comment-list"},this.state.commentsList.length>0&&this.state.commentsList.map(function(t){var n=(arguments.length>1&&void 0!==arguments[1]&&arguments[1],arguments[2],new Date(t.created_at).getTime()),r=(0,f.default)(n).format("YYYY-MM-DD HH:mm");return u.default.createElement(u.default.Fragment,{key:t.id},u.default.createElement(M,{item:t,time:r,deleteComment:e.deleteComment,resolveComment:e.resolveComment,editComment:e.editComment}))}),0==this.state.commentsList.length&&u.default.createElement("li",{className:"comment-vacant"},(0,g.gettext)("No comment yet."))),u.default.createElement("div",{className:"seafile-comment-footer"},a&&u.default.createElement(S.default,{onParticipantsChange:this.props.onParticipantsChange,participants:a,repoID:n,filePath:r,showIconTip:!0}),u.default.createElement(C.MentionsInput,{value:this.state.comment,onChange:this.handleCommentChange,placeholder:(0,g.gettext)("Add a comment."),style:D.defaultStyle},u.default.createElement(C.Mention,{trigger:"@",displayTransform:function(e,t){return"@"+t},data:this.state.relatedUsers,renderSuggestion:this.renderUserSuggestion,style:D.defaultMentionStyle,onAdd:function(t,n){e.addParticipant(t)},appendSpaceOnAdd:!0})),u.default.createElement(m.Button,{className:"submit-comment",color:"primary",size:"sm",onClick:this.onSubmit},(0,g.gettext)("Submit"))))}}]),t}(u.default.Component);P.propTypes=_;var k={time:d.default.string.isRequired,item:d.default.object.isRequired,deleteComment:d.default.func.isRequired,resolveComment:d.default.func.isRequired,editComment:d.default.func.isRequired},M=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.convertComment=function(e){h.processor.process(e).then(function(e){var t=String(e);n.setState({html:t})})},n.toggleDropDownMenu=function(){n.setState({dropdownOpen:!n.state.dropdownOpen})},n.toggleEditComment=function(){n.setState({editable:!n.state.editable})},n.updateComment=function(e){var t=n.state.newComment;n.props.item.comment!==t&&n.props.editComment(e.target.id,t),n.toggleEditComment()},n.handleCommentChange=function(e){n.setState({newComment:e.target.value})},n.onCommentClick=function(e){if("A"===e.target.nodeName){var t=e.target.previousSibling;t&&3===t.nodeType&&"@"===t.nodeValue.slice(-1)&&e.preventDefault()}},n.renderInfo=function(e){return u.default.createElement(l.Fragment,null,u.default.createElement("img",{className:"avatar",src:e.avatar_url,alt:""}),u.default.createElement("div",{className:"reviewer-info"},u.default.createElement("div",{className:"reviewer-name ellipsis"},e.user_name),u.default.createElement("div",{className:"review-time"},n.props.time)))},n.state={dropdownOpen:!1,html:"",newComment:n.props.item.comment,editable:!1},n}return i(t,e),s(t,[{key:"componentWillMount",value:function(){this.convertComment(this.props.item.comment)}},{key:"componentWillReceiveProps",value:function(e){this.convertComment(e.item.comment)}},{key:"render",value:function(){var e=this,t=this.props.item;return this.state.editable?u.default.createElement("li",{className:"seafile-comment-item",id:t.id},u.default.createElement("div",{className:"seafile-comment-info"},this.renderInfo(t)),u.default.createElement("div",{className:"seafile-edit-comment"},u.default.createElement("textarea",{className:"edit-comment-input",value:this.state.newComment,onChange:this.handleCommentChange,clos:"100",rows:"3",warp:"virtual"}),u.default.createElement(m.Button,{className:"comment-btn",color:"primary",size:"sm",onClick:this.updateComment,id:t.id},(0,g.gettext)("Update"))," ",u.default.createElement(m.Button,{className:"comment-btn",color:"secondary",size:"sm",onClick:this.toggleEditComment}," ",(0,g.gettext)("Cancel")))):u.default.createElement("li",{className:t.resolved?"seafile-comment-item seafile-comment-item-resolved":"seafile-comment-item",id:t.id},u.default.createElement("div",{className:"seafile-comment-info"},this.renderInfo(t),u.default.createElement(m.Dropdown,{isOpen:this.state.dropdownOpen,size:"sm",className:"seafile-comment-dropdown",toggle:this.toggleDropDownMenu},u.default.createElement(m.DropdownToggle,{className:"seafile-comment-dropdown-btn"},u.default.createElement("i",{className:"fas fa-ellipsis-v"})),u.default.createElement(m.DropdownMenu,null,t.user_email===g.username&&u.default.createElement(m.DropdownItem,{onClick:this.props.deleteComment,className:"delete-comment",id:t.id},(0,g.gettext)("Delete")),t.user_email===g.username&&u.default.createElement(m.DropdownItem,{onClick:this.toggleEditComment,className:"edit-comment",id:t.id},(0,g.gettext)("Edit")),!t.resolved&&u.default.createElement(m.DropdownItem,{onClick:this.props.resolveComment,className:"seafile-comment-resolved",id:t.id},(0,g.gettext)("Mark as resolved"))))),u.default.createElement("div",{className:"seafile-comment-content",dangerouslySetInnerHTML:{__html:this.state.html},onClick:function(t){return e.onCommentClick(t)}}))}}]),t}(u.default.Component);M.propTypes=k,t.default=P},2274:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(7),f=r(p),h=n(2),m=n(3),g=n(380),y=r(g),v=n(13),b=r(v),w=n(727),E=r(w),S=n(256),C=r(S),D={repoInfo:d.default.object.isRequired,repoID:d.default.string.isRequired,dirent:d.default.object.isRequired,direntType:d.default.string.isRequired,direntDetail:d.default.object.isRequired,path:d.default.string.isRequired,fileTagList:d.default.array.isRequired,relatedFiles:d.default.array.isRequired,onFileTagChanged:d.default.func.isRequired,onRelatedFileChange:d.default.func.isRequired,onParticipantsChange:d.default.func.isRequired,fileParticipantList:d.default.array.isRequired},_=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getDirentPostion=function(){var e=n.props.repoInfo,t=n.getDirentPath(),r=e.repo_name;if("/"!==t){var a=t.lastIndexOf("/");r+=t.slice(0,a)}return r},n.onEditFileTagToggle=function(){n.setState({isEditFileTagShow:!n.state.isEditFileTagShow})},n.onFileTagChanged=function(){var e=n.getDirentPath();n.props.onFileTagChanged(n.props.dirent,e)},n.getDirentPath=function(){if(m.Utils.isMarkdownFile(n.props.path))return n.props.path;var e=n.props,t=e.dirent,r=e.path;return m.Utils.joinPath(r,t.name)},n.onRelatedFileChange=function(){var e=n.getDirentPath();n.props.onRelatedFileChange(n.props.dirent,e)},n.onListRelatedFileToggle=function(){n.setState({showRelatedFileDialog:!0})},n.toggleCancel=function(){n.setState({showRelatedFileDialog:!1})},n.state={isEditFileTagShow:!1,showRelatedFileDialog:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=e.direntType,n=e.direntDetail,r=e.fileTagList,a=e.relatedFiles,o=e.fileParticipantList,i=this.getDirentPostion(),s=this.getDirentPath();return"dir"===t?u.default.createElement("table",{className:"table-thead-hidden"},u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:"35%"}),u.default.createElement("th",{width:"65%"}))),u.default.createElement("tbody",null,u.default.createElement("tr",null,u.default.createElement("th",null,(0,h.gettext)("Location")),u.default.createElement("td",null,i)),u.default.createElement("tr",null,u.default.createElement("th",null,(0,h.gettext)("Last Update")),u.default.createElement("td",null,(0,f.default)(n.mtime).format("YYYY-MM-DD"))))):u.default.createElement(l.Fragment,null,u.default.createElement("table",{className:"table-thead-hidden"},u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:"35%"}),u.default.createElement("th",{width:"65%"}))),u.default.createElement("tbody",null,u.default.createElement("tr",null,u.default.createElement("th",null,(0,h.gettext)("Size")),u.default.createElement("td",null,m.Utils.bytesToSize(n.size))),u.default.createElement("tr",null,u.default.createElement("th",null,(0,h.gettext)("Location")),u.default.createElement("td",null,i)),u.default.createElement("tr",null,u.default.createElement("th",null,(0,h.gettext)("Last Update")),u.default.createElement("td",null,(0,f.default)(n.last_modified).fromNow())),u.default.createElement("tr",{className:"file-tag-container"},u.default.createElement("th",null,(0,h.gettext)("Tags")),u.default.createElement("td",null,u.default.createElement("ul",{className:"file-tag-list"},r.map(function(e){return u.default.createElement("li",{key:e.id,className:"file-tag-item"},u.default.createElement("span",{className:"file-tag",style:{backgroundColor:e.color}}),u.default.createElement("span",{className:"tag-name",title:e.name},e.name))})),u.default.createElement("i",{className:"fa fa-pencil-alt attr-action-icon",onClick:this.onEditFileTagToggle}))),u.default.createElement("tr",{className:"file-related-files"},u.default.createElement("th",null,(0,h.gettext)("Related Files")),u.default.createElement("td",null,u.default.createElement("ul",null,a.map(function(e,t){var n=h.siteRoot+"lib/"+e.repo_id+"/file"+m.Utils.encodePath(e.path);return u.default.createElement("li",{key:t},u.default.createElement("a",{href:n,target:"_blank"},e.name))})),u.default.createElement("i",{className:"fa fa-pencil-alt attr-action-icon",onClick:this.onListRelatedFileToggle}))),u.default.createElement("tr",{className:"file-participants"},u.default.createElement("th",null,(0,h.gettext)("Participants")),u.default.createElement("td",null,o&&u.default.createElement(C.default,{onParticipantsChange:this.props.onParticipantsChange,participants:o,repoID:this.props.repoID,filePath:s,showIconTip:!1}))))),this.state.showRelatedFileDialog&&u.default.createElement(b.default,null,u.default.createElement(E.default,{repoID:this.props.repoID,filePath:s,relatedFiles:a,toggleCancel:this.toggleCancel,onRelatedFileChange:this.onRelatedFileChange,dirent:this.props.dirent,viewMode:"list_related_file"})),this.state.isEditFileTagShow&&u.default.createElement(b.default,null,u.default.createElement(y.default,{repoID:this.props.repoID,fileTagList:r,filePath:s,toggleCancel:this.onEditFileTagToggle,onFileTagChanged:this.onFileTagChanged})))}}]),t}(u.default.Component);_.propTypes=D,t.default=_},2275:function(e,t){},2276:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(2),h=n(4),m=n(7),g=r(m),y=n(386),v=r(y),b=n(5),w=r(b),E=n(3),S=n(2277),C=r(S),D={repoID:d.default.string.isRequired,toggle:d.default.func.isRequired},_=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onDeleteDraftItem=function(e){v.default.deleteDraft(e.id).then(function(){var t=n.state.drafts.filter(function(t){return t.id!==e.id});n.setState({drafts:t});var r=(0,f.gettext)("Successfully deleted draft %(draft)s.");r=r.replace("%(draft)s",e.draftFilePath),w.default.success(r)}).catch(function(){var t=(0,f.gettext)("Failed to delete draft %(draft)s.");t=t.replace("%(draft)s",e.draftFilePath),w.default.danger(t)})},n.toggle=function(){n.props.toggle()},n.state={drafts:[]},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;h.seafileAPI.listRepoDrafts(this.props.repoID).then(function(t){var n=t.data.drafts.map(function(e){return new C.default(e)});e.setState({drafts:n})})}},{key:"render",value:function(){var e=this;return u.default.createElement(p.Modal,{isOpen:!0},u.default.createElement(p.ModalHeader,{toggle:this.toggle},(0,f.gettext)("Drafts")),u.default.createElement(p.ModalBody,{className:"dialog-list-container"},u.default.createElement("table",null,u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:"50%",className:"ellipsis"},(0,f.gettext)("Name")),u.default.createElement("th",{width:"20%"},(0,f.gettext)("Owner")),u.default.createElement("th",{width:"20%"},(0,f.gettext)("Last Update")),u.default.createElement("th",{width:"10%"}))),u.default.createElement("tbody",null,this.state.drafts.map(function(t,n){return u.default.createElement(k,{key:n,draftItem:t,onDeleteDraftItem:e.onDeleteDraftItem})})))),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{color:"secondary",onClick:this.toggle},(0,f.gettext)("Close"))))}}]),t}(u.default.Component);_.propTypes=D,t.default=_;var P={draftItem:d.default.object,onDeleteDraftItem:d.default.func.isRequired},k=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseEnter=function(){n.setState({active:!0})},n.onMouseLeave=function(){n.setState({active:!1})},n.state={active:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.draftItem,t=f.siteRoot+"drafts/"+e.id+"/",n=this.state.active?"action-icon sf2-icon-x3":"action-icon vh sf2-icon-x3";return u.default.createElement("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},u.default.createElement("td",{className:"name"},u.default.createElement("a",{href:t,target:"_blank"},E.Utils.getFileName(e.draftFilePath))),u.default.createElement("td",null,e.ownerNickname),u.default.createElement("td",null,(0,g.default)(e.createdStr).fromNow()),u.default.createElement("td",null,u.default.createElement("i",{className:n,onClick:this.props.onDeleteDraftItem.bind(this,e)})))}}]),t}(u.default.Component);k.propTypes=P},2277:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=n(7),o=function(e){return e&&e.__esModule?e:{default:e}}(a),i=function e(t){r(this,e),this.created=t.created_at,this.createdStr=(0,o.default)(new Date(t.created_at).getTime()).format("YYYY-MM-DD HH:mm"),this.id=t.id,this.ownerNickname=t.owner_nickname,this.originRepoID=t.origin_repo_id,this.draftFilePath=t.draft_file_path};t.default=i},2278:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(355),h=r(f),m=n(8),g=r(m),y=n(4),v=n(2),b=n(3),w=n(5),E=r(w),S={repoID:d.default.string.isRequired,filePath:d.default.string.isRequired,fileName:d.default.string.isRequired,href:d.default.string,toggleCancel:d.default.func.isRequired},C=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={readmeContent:null,isLoading:!0},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;y.seafileAPI.getFileDownloadLink(this.props.repoID,this.props.filePath).then(function(t){y.seafileAPI.getFileContent(t.data).then(function(t){e.setState({readmeContent:t.data,isLoading:!1})})}).catch(function(e){var t=b.Utils.getErrorMsg(e);E.default.danger(t)})}},{key:"render",value:function(){return u.default.createElement(p.Modal,{isOpen:!0,toggle:this.props.toggleCancel,className:"readme-dialog",size:"lg"},u.default.createElement(p.ModalHeader,null,this.props.fileName,u.default.createElement("a",{className:"readme-dialog-edit",href:this.props.href,target:"_blank"},u.default.createElement("i",{className:"fa fa-pencil-alt"}))),u.default.createElement(p.ModalBody,null,this.state.isLoading?u.default.createElement(g.default,null):u.default.createElement(h.default,{markdownContent:this.state.readmeContent,showTOC:!1})),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{color:"secondary",onClick:this.props.toggleCancel},(0,v.gettext)("Close"))))}}]),t}(u.default.Component);C.propTypes=S,t.default=C},2279:function(e,t){},2280:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(2),f=n(3),h=n(14),m=r(h),g=(n(4),n(356)),y=r(g),v=n(8),b=r(v),w=n(5),E=r(w),S=n(13),C=r(S),D=n(744),_=r(D),P=n(473),k=r(P),M=n(747),O=r(M),L=n(474),I=r(L),T=n(745),R=r(T),N=n(746),x=r(N),F=n(2281),Y=r(F),Z=n(735),j=r(Z),A=n(274),B=n(2284),X=r(B),J={path:d.default.string.isRequired,repoID:d.default.string.isRequired,currentRepoInfo:d.default.object,isAllItemSelected:d.default.bool.isRequired,isDirentListLoading:d.default.bool.isRequired,direntList:d.default.array.isRequired,sortBy:d.default.string.isRequired,sortOrder:d.default.string.isRequired,sortItems:d.default.func.isRequired,onAddFile:d.default.func.isRequired,onAddFolder:d.default.func.isRequired,onItemDelete:d.default.func.isRequired,onAllItemSelected:d.default.func.isRequired,onItemSelected:d.default.func.isRequired,onItemRename:d.default.func.isRequired,onItemClick:d.default.func.isRequired,onItemMove:d.default.func.isRequired,onItemCopy:d.default.func.isRequired,onDirentClick:d.default.func.isRequired,updateDirent:d.default.func.isRequired,selectedDirentList:d.default.array.isRequired,onItemsMove:d.default.func.isRequired,onItemsCopy:d.default.func.isRequired,onItemsDelete:d.default.func.isRequired,onFileTagChanged:d.default.func,enableDirPrivateShare:d.default.bool.isRequired,isGroupOwnedRepo:d.default.bool.isRequired,userPerm:d.default.string,showDirentDetail:d.default.func.isRequired},U=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.freezeItem=function(){n.setState({isItemFreezed:!0})},n.unfreezeItem=function(){n.setState({isItemFreezed:!1})},n.onItemRename=function(e,t){if(n.props.direntList.some(function(e){return e.name===t})){var r=(0,p.gettext)('The name "{name}" is already taken. Please choose a different name.');return r=r.replace("{name}",f.Utils.HTMLescape(t)),E.default.danger(r),!1}n.props.onItemRename(e,t)},n.onItemRenameToggle=function(){n.freezeItem()},n.onItemSelected=function(e){n.setState({activeDirent:null}),n.props.onItemSelected(e)},n.onDirentClick=function(e){n.props.selectedDirentList.length>0&&!n.state.activeDirent||(n.setState({activeDirent:e}),n.props.onDirentClick(e))},n.sortByName=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortItems("name",t)},n.sortByTime=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortItems("time",t)},n.sortBySize=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortItems("size",t)},n.prepareImageItem=function(e){var t=!n.repoEncrypted,r=e.name,a=r.substr(r.lastIndexOf(".")+1).toLowerCase(),o="gif"==a,i=f.Utils.encodePath(f.Utils.joinPath(n.props.path,r)),s=n.props.repoID,l=void 0;return l=t&&!o?p.siteRoot+"thumbnail/"+s+"/"+p.thumbnailSizeForOriginal+i:p.siteRoot+"repo/"+s+"/raw"+i,{name:r,url:p.siteRoot+"lib/"+s+"/file"+i,src:l}},n.showImagePopup=function(e){var t=n.props.direntList.filter(function(e){return f.Utils.imageCheck(e.name)}),r=t.map(function(e){return n.prepareImageItem(e)});n.setState({isImagePopupOpen:!0,imageItems:r,imageIndex:t.indexOf(e)})},n.moveToPrevImage=function(){var e=n.state.imageItems.length;n.setState(function(t){return{imageIndex:(t.imageIndex+e-1)%e}})},n.moveToNextImage=function(){var e=n.state.imageItems.length;n.setState(function(t){return{imageIndex:(t.imageIndex+1)%e}})},n.closeImagePopup=function(){n.setState({isImagePopupOpen:!1})},n.onCreateFileToggle=function(){n.setState({isCreateFileDialogShow:!n.state.isCreateFileDialogShow})},n.onCreateFolderToggle=function(){n.setState({isCreateFolderDialogShow:!n.state.isCreateFolderDialogShow})},n.onAddFile=function(e,t){n.setState({isCreateFileDialogShow:!1}),n.props.onAddFile(e,t)},n.onAddFolder=function(e){n.setState({isCreateFolderDialogShow:!1}),n.props.onAddFolder(e)},n.checkDuplicatedName=function(e){return n.props.direntList.some(function(t){return t.name===e})},n.onMoveToggle=function(){n.setState({isMoveDialogShow:!n.state.isMoveDialogShow})},n.onCopyToggle=function(){n.setState({isCopyDialogShow:!n.state.isCopyDialogShow})},n.onItemsDownload=function(){var e=n.props,t=e.path,r=e.repoID,a=e.selectedDirentList;if(a.length){if(1===a.length&&!a[0].isDir()){var o=f.Utils.joinPath(t,a[0].name),i=y.default.getUrl({type:"download_file_url",repoID:r,filePath:o});return void(location.href=i)}var s=a.map(function(e){return e.name});n.setState({isProgressDialogShow:!0,downloadItems:s})}},n.onCloseZipDownloadDialog=function(){n.setState({isProgressDialogShow:!1})},n.onMouseDown=function(e){e.stopPropagation(),e.button},n.handleContextClick=function(e,t,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e.preventDefault(),e.stopPropagation();var o=e.clientX||e.touches&&e.touches[0].pageX,i=e.clientY||e.touches&&e.touches[0].pageY;n.props.posX&&(o-=n.props.posX),n.props.posY&&(i-=n.props.posY),(0,A.hideMenu)();var s={id:t,position:{x:o,y:i},target:e.target,currentObject:a,menuList:r};0!==r.length&&(0,A.showMenu)(s)},n.onContainerClick=function(){n.state.activeDirent&&n.onDirentClick(null)},n.onContainerMouseDown=function(e){n.onMouseDown(e)},n.onContainerContextMenu=function(e){e.preventDefault();var t=n.props.userPerm;if("admin"===t||"rw"===t)if(0===n.props.selectedDirentList.length){var r=[m.default.NEW_FOLDER,m.default.NEW_FILE];n.handleContextClick(e,"dirent-container-menu",r)}else if(1===n.props.selectedDirentList.length)if(n.state.activeDirent)n.onDirentClick(null),e.preventDefault(),e.persist(),setTimeout(function(){var t=[m.default.NEW_FOLDER,m.default.NEW_FILE];n.handleContextClick(e,"dirent-container-menu",t)},0);else{var a=n.props.selectedDirentList[0],o=n.getDirentItemMenuList(a,!0);n.handleContextClick(e,"dirent-item-menu",o,a)}else{var i=[m.default.MOVE,m.default.COPY,m.default.DOWNLOAD,m.default.DELETE];n.handleContextClick(e,"dirents-menu",i)}},n.onContainerMenuItemClick=function(e){switch(e){case"New Folder":n.onCreateFolderToggle();break;case"New File":n.onCreateFileToggle()}(0,A.hideMenu)()},n.onDirentsMenuItemClick=function(e){switch(e){case"Move":n.onMoveToggle();break;case"Copy":n.onCopyToggle();break;case"Download":n.onItemsDownload();break;case"Delete":n.props.onItemsDelete()}(0,A.hideMenu)()},n.onThreadMouseDown=function(e){n.onMouseDown(e)},n.onThreadContextMenu=function(e){e.stopPropagation()},n.onItemMouseDown=function(e){n.onMouseDown(e)},n.onItemContextMenu=function(e,t){if(!(n.props.selectedDirentList.length>1)){n.onDirentClick(t);var r=n.getDirentItemMenuList(t,!0);n.handleContextClick(e,"dirent-item-menu",r,t)}},n.setDirentItemRef=function(e){return function(t){n.direntItems[e]=t}},n.onMenuItemClick=function(e,t,r){var a=n.getDirentIndex(t);n.direntItems[a].onMenuItemClick(e,r),(0,A.hideMenu)()},n.onShowMenu=function(e){n.freezeItem()},n.onHideMenu=function(e){n.unfreezeItem()},n.getDirentIndex=function(e){for(var t=n.props.direntList,r=0,a=0;a<t.length;a++)if(t[a].name===e.name){r=a;break}return r},n.getDirentItemMenuList=function(e,t){var r=n.isRepoOwner,a=n.props.currentRepoInfo;return f.Utils.getDirentOperationList(r,a,e,t)},n.onTableDragEnter=function(e){if(f.Utils.isIEBrower())return!1;if(0!==++n.enteredCounter){if(n.state.isListDropTipShow)return;n.setState({isListDropTipShow:!0})}},n.onTableDragOver=function(e){if(f.Utils.isIEBrower())return!1;"copy"!==e.dataTransfer.dropEffect&&(e.preventDefault(),e.dataTransfer.dropEffect="move")},n.onTableDragLeave=function(e){if(f.Utils.isIEBrower())return!1;0===--n.enteredCounter&&n.setState({isListDropTipShow:!1})},n.tableDrop=function(e){if(f.Utils.isIEBrower())return!1;if(e.persist(),n.enteredCounter=0,n.setState({isListDropTipShow:!1}),!e.dataTransfer.files.length){var t=e.dataTransfer.getData("applicaiton/drag-item-info");t=JSON.parse(t);var r=t,a=r.nodeDirent,o=r.nodeParentPath,i=r.nodeRootPath;Array.isArray(t)||i!==n.props.path&&o!==n.props.path&&-1===n.props.path.indexOf(i)&&n.props.onItemMove(n.props.currentRepoInfo,a,n.props.path,o)}},n.onShowDirentsDraggablePreview=function(){n.setState({isShowDirentsDraggablePreview:!0})},n.onHideDirentsDraggablePreview=function(){n.setState({isShowDirentsDraggablePreview:!1})},n.state={isItemFreezed:!1,isImagePopupOpen:!1,imageItems:[],imageIndex:0,fileType:"",isCreateFileDialogShow:!1,isCreateFolderDialogShow:!1,isMoveDialogShow:!1,isCopyDialogShow:!1,isProgressDialogShow:!1,downloadItems:[],isMutipleOperation:!0,activeDirent:null,isListDropTipShow:!1,isShowDirentsDraggablePreview:!1},n.enteredCounter=0,n.isRepoOwner=e.currentRepoInfo.owner_email===p.username,n.isAdmin=e.currentRepoInfo.is_admin,n.repoEncrypted=e.currentRepoInfo.encrypted,n.clickedDirent=null,n.direntItems=[],n.currentItemRef=null,n.zipToken=null,n}return i(t,e),s(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.direntList,r=t.sortBy,a=t.sortOrder;if(this.props.isDirentListLoading)return u.default.createElement(b.default,null);var o="name"==r,i="time"==r,s="size"==r,c="asc"==a?u.default.createElement("span",{className:"fas fa-caret-up"}):u.default.createElement("span",{className:"fas fa-caret-down"}),d=f.Utils.isDesktop();return u.default.createElement("div",{className:"table-container "+(this.state.isListDropTipShow?"table-drop-active":""),onMouseDown:this.onContainerMouseDown,onContextMenu:this.onContainerContextMenu,onClick:this.onContainerClick,onDragEnter:this.onTableDragEnter,onDragOver:this.onTableDragOver,onDragLeave:this.onTableDragLeave,onDrop:this.tableDrop},u.default.createElement("table",{className:"table-hover "+(d?"":"table-thead-hidden")},d?u.default.createElement("thead",{onMouseDown:this.onThreadMouseDown,onContextMenu:this.onThreadContextMenu},u.default.createElement("tr",null,u.default.createElement("th",{width:"3%",className:"pl10"},u.default.createElement("input",{type:"checkbox",className:"vam",onChange:this.props.onAllItemSelected,checked:this.props.isAllItemSelected})),u.default.createElement("th",{width:"3%",className:"pl10"}),u.default.createElement("th",{width:"5%",className:"pl10"}),u.default.createElement("th",{width:"39%"},u.default.createElement("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByName},(0,p.gettext)("Name")," ",o&&c)),u.default.createElement("th",{width:"6%"}),u.default.createElement("th",{width:"18%"}),u.default.createElement("th",{width:"11%"},u.default.createElement("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortBySize},(0,p.gettext)("Size")," ",s&&c)),u.default.createElement("th",{width:"15%"},u.default.createElement("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByTime},(0,p.gettext)("Last Update")," ",i&&c)))):u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:"12%"}),u.default.createElement("th",{width:"80%"}),u.default.createElement("th",{width:"8%"}))),u.default.createElement("tbody",null,n.map(function(t,n){return u.default.createElement(Y.default,{ref:e.setDirentItemRef(n),key:n,dirent:t,path:e.props.path,repoID:e.props.repoID,currentRepoInfo:e.props.currentRepoInfo,isAdmin:e.isAdmin,isRepoOwner:e.isRepoOwner,repoEncrypted:e.repoEncrypted,enableDirPrivateShare:e.props.enableDirPrivateShare,isGroupOwnedRepo:e.props.isGroupOwnedRepo,onItemClick:e.props.onItemClick,onItemRenameToggle:e.onItemRenameToggle,onItemSelected:e.onItemSelected,onItemDelete:e.props.onItemDelete,onItemRename:e.onItemRename,onItemMove:e.props.onItemMove,onItemCopy:e.props.onItemCopy,updateDirent:e.props.updateDirent,isItemFreezed:e.state.isItemFreezed,freezeItem:e.freezeItem,unfreezeItem:e.unfreezeItem,onDirentClick:e.onDirentClick,showImagePopup:e.showImagePopup,onItemMouseDown:e.onItemMouseDown,onItemContextMenu:e.onItemContextMenu,selectedDirentList:e.props.selectedDirentList,activeDirent:e.state.activeDirent,onFileTagChanged:e.props.onFileTagChanged,getDirentItemMenuList:e.getDirentItemMenuList,showDirentDetail:e.props.showDirentDetail,onItemsMove:e.props.onItemsMove,onShowDirentsDraggablePreview:e.onShowDirentsDraggablePreview})}))),u.default.createElement(l.Fragment,null,u.default.createElement(j.default,{id:"dirent-container-menu",onMenuItemClick:this.onContainerMenuItemClick}),u.default.createElement(j.default,{id:"dirent-item-menu",onMenuItemClick:this.onMenuItemClick,onShowMenu:this.onShowMenu,onHideMenu:this.onHideMenu}),u.default.createElement(j.default,{id:"dirents-menu",onMenuItemClick:this.onDirentsMenuItemClick}),this.state.isShowDirentsDraggablePreview&&u.default.createElement(C.default,null,u.default.createElement(X.default,{selectedDirentList:this.props.selectedDirentList,onHideDirentsDraggablePreview:this.onHideDirentsDraggablePreview,dragStartPosition:this.state.dragStartPosition})),this.state.isImagePopupOpen&&u.default.createElement(C.default,null,u.default.createElement(O.default,{imageItems:this.state.imageItems,imageIndex:this.state.imageIndex,closeImagePopup:this.closeImagePopup,moveToPrevImage:this.moveToPrevImage,moveToNextImage:this.moveToNextImage})),this.state.isCreateFolderDialogShow&&u.default.createElement(C.default,null,u.default.createElement(k.default,{parentPath:this.props.path,onAddFolder:this.onAddFolder,checkDuplicatedName:this.checkDuplicatedName,addFolderCancel:this.onCreateFolderToggle})),this.state.isCreateFileDialogShow&&u.default.createElement(C.default,null,u.default.createElement(_.default,{parentPath:this.props.path,fileType:this.state.fileType,onAddFile:this.onAddFile,checkDuplicatedName:this.checkDuplicatedName,addFileCancel:this.onCreateFileToggle})),this.state.isMoveDialogShow&&u.default.createElement(R.default,{path:this.props.path,repoID:this.props.repoID,repoEncrypted:this.props.currentRepoInfo.encrypted,isMutipleOperation:this.state.isMutipleOperation,selectedDirentList:this.props.selectedDirentList,onItemsMove:this.props.onItemsMove,onCancelMove:this.onMoveToggle}),this.state.isCopyDialogShow&&u.default.createElement(x.default,{path:this.props.path,repoID:this.props.repoID,repoEncrypted:this.props.currentRepoInfo.encrypted,selectedDirentList:this.props.selectedDirentList,isMutipleOperation:this.state.isMutipleOperation,onItemsCopy:this.props.onItemsCopy,onCancelCopy:this.onCopyToggle}),this.state.isProgressDialogShow&&u.default.createElement(I.default,{repoID:this.props.repoID,path:this.props.path,target:this.state.downloadItems,toggleDialog:this.onCloseZipDownloadDialog})))}}]),t}(u.default.Component);U.propTypes=J,t.default=U},2281:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(1037),f=r(p),h=n(6),m=n(2),g=n(3),y=n(4),v=n(356),b=r(v),w=n(733),E=r(w),S=n(1024),C=r(S),D=n(13),_=r(D),P=n(745),k=r(P),M=n(746),O=r(M),L=n(108),I=r(L),T=n(474),R=r(T),N=n(380),x=r(N),F=n(743),Y=r(F);n(2283);var Z=n(5),j=r(Z),A={path:d.default.string.isRequired,repoID:d.default.string.isRequired,isItemFreezed:d.default.bool.isRequired,dirent:d.default.object.isRequired,onItemClick:d.default.func.isRequired,freezeItem:d.default.func.isRequired,unfreezeItem:d.default.func.isRequired,onItemRenameToggle:d.default.func.isRequired,onItemSelected:d.default.func.isRequired,onItemDelete:d.default.func.isRequired,onItemRename:d.default.func.isRequired,onItemMove:d.default.func.isRequired,onItemCopy:d.default.func.isRequired,onDirentClick:d.default.func.isRequired,updateDirent:d.default.func.isRequired,showImagePopup:d.default.func.isRequired,currentRepoInfo:d.default.object,isRepoOwner:d.default.bool,isAdmin:d.default.bool.isRequired,repoEncrypted:d.default.bool.isRequired,isGroupOwnedRepo:d.default.bool.isRequired,onItemMouseDown:d.default.func.isRequired,onItemContextMenu:d.default.func.isRequired,selectedDirentList:d.default.array.isRequired,activeDirent:d.default.object,getDirentItemMenuList:d.default.func.isRequired,onFileTagChanged:d.default.func,enableDirPrivateShare:d.default.bool.isRequired,showDirentDetail:d.default.func.isRequired,onItemsMove:d.default.func.isRequired,onShowDirentsDraggablePreview:d.default.func},B=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleOpMenu=function(){n.setState({isOpMenuOpen:!n.state.isOpMenuOpen})},n.onMouseEnter=function(){n.props.isItemFreezed||n.setState({highlight:!0,isOperationShow:!0}),n.setState({isDragTipShow:!0})},n.onMouseOver=function(){n.props.isItemFreezed||n.setState({highlight:!0,isOperationShow:!0}),n.setState({isDragTipShow:!0})},n.onMouseLeave=function(){n.props.isItemFreezed||n.setState({highlight:!1,isOperationShow:!1}),n.setState({isDragTipShow:!1})},n.unfreezeItem=function(){n.setState({highlight:!1,isOperationShow:!1}),n.props.unfreezeItem()},n.onItemSelected=function(){n.props.onItemSelected(n.props.dirent)},n.onItemStarred=function(){var e=n.props.dirent,t=n.props.repoID,r=n.getDirentPath(e);e.starred?y.seafileAPI.unstarItem(t,r).then(function(){n.props.updateDirent(n.props.dirent,"starred",!1)}).catch(function(e){var t=g.Utils.getErrorMsg(e);j.default.danger(t)}):y.seafileAPI.starItem(t,r).then(function(){n.props.updateDirent(n.props.dirent,"starred",!0)}).catch(function(e){var t=g.Utils.getErrorMsg(e);j.default.danger(t)})},n.onDirentClick=function(e){e.stopPropagation(),"TD"==e.target.tagName&&n.props.onDirentClick(n.props.dirent)},n.onItemClick=function(e){e.preventDefault();var t=n.props.dirent;n.state.isRenameing||(g.Utils.imageCheck(t.name)?n.props.showImagePopup(t):n.props.onItemClick(t))},n.onItemDelete=function(e){e.nativeEvent.stopImmediatePropagation(),n.props.onItemDelete(n.props.dirent)},n.onItemShare=function(e){e.nativeEvent.stopImmediatePropagation(),n.setState({isShareDialogShow:!n.state.isShareDialogShow})},n.closeSharedDialog=function(){n.setState({isShareDialogShow:!n.state.isShareDialogShow})},n.onMobileMenuItemClick=function(e){var t=e.target.getAttribute("data-op");n.onMenuItemClick(t,e)},n.onMenuItemClick=function(e,t){switch(e){case"Download":n.onItemDownload(t);break;case"Share":n.onItemShare(t);break;case"Delete":n.onItemDelete(t);break;case"Rename":n.onItemRenameToggle();break;case"Move":n.onItemMoveToggle();break;case"Copy":n.onItemCopyToggle();break;case"Tags":n.onEditFileTagToggle();break;case"Permission":n.onPermissionItem();break;case"Unlock":n.onUnlockItem();break;case"Lock":n.onLockItem();break;case"Comment":n.props.onDirentClick(n.props.dirent),n.props.showDirentDetail("comments");break;case"History":n.onHistory();break;case"Access Log":n.onAccessLog();break;case"Open via Client":n.onOpenViaClient()}},n.onEditFileTagToggle=function(){n.setState({isEditFileTagShow:!n.state.isEditFileTagShow})},n.onFileTagChanged=function(){var e=n.getDirentPath(n.props.dirent);n.props.onFileTagChanged(n.props.dirent,e)},n.onItemRenameToggle=function(){n.props.onItemRenameToggle(n.props.dirent),n.setState({isOperationShow:!1,isRenameing:!0})},n.onRenameConfirm=function(e){n.props.onItemRename(n.props.dirent,e),n.onRenameCancel()},n.onRenameCancel=function(){n.setState({isRenameing:!1}),n.unfreezeItem()},n.onItemMoveToggle=function(){n.setState({isMoveDialogShow:!n.state.isMoveDialogShow})},n.onItemCopyToggle=function(){n.setState({isCopyDialogShow:!n.state.isCopyDialogShow})},n.onPermissionItem=function(){n.setState({isPermissionDialogOpen:!n.state.isPermissionDialogOpen})},n.onLockItem=function(){var e=n.props.repoID,t=n.getDirentPath(n.props.dirent);y.seafileAPI.lockfile(e,t).then(function(){n.props.updateDirent(n.props.dirent,"is_locked",!0),n.props.updateDirent(n.props.dirent,"locked_by_me",!0);var e=m.username.split("@");n.props.updateDirent(n.props.dirent,"lock_owner_name",e[0])}).catch(function(e){var t=g.Utils.getErrorMsg(e);j.default.danger(t)})},n.onUnlockItem=function(){var e=n.props.repoID,t=n.getDirentPath(n.props.dirent);y.seafileAPI.unlockfile(e,t).then(function(){n.props.updateDirent(n.props.dirent,"is_locked",!1),n.props.updateDirent(n.props.dirent,"locked_by_me",!1),n.props.updateDirent(n.props.dirent,"lock_owner_name","")}).catch(function(e){var t=g.Utils.getErrorMsg(e);j.default.danger(t)})},n.onHistory=function(){var e=n.props.repoID,t=n.getDirentPath(n.props.dirent),r=b.default.getUrl({type:"file_revisions",repoID:e,filePath:t});location.href=r},n.onAccessLog=function(){var e=n.getDirentPath(n.props.dirent),t=m.siteRoot+"repo/file-access/"+n.props.repoID+"/?p="+encodeURIComponent(e);window.open(t)},n.onOpenViaClient=function(){var e=n.props.repoID,t=n.getDirentPath(n.props.dirent),r=b.default.getUrl({type:"open_via_client",repoID:e,filePath:t});location.href=r},n.onItemDownload=function(e){e.nativeEvent.stopImmediatePropagation();var t=n.props.dirent,r=n.props.repoID,a=n.getDirentPath(t);if("dir"===t.type)n.setState({isZipDialogOpen:!0});else{var o=b.default.getUrl({type:"download_file_url",repoID:r,filePath:a});location.href=o}},n.closeZipDialog=function(){n.setState({isZipDialogOpen:!1})},n.getDirentPath=function(e){var t=n.props.path;return"/"===t?t+e.name:t+"/"+e.name},n.onTagTooltipToggle=function(e){e.stopPropagation(),n.setState({isShowTagTooltip:!n.state.isShowTagTooltip})},n.onItemMove=function(e,t,r,a){n.props.onItemMove(e,t,r,a)},n.onItemDragStart=function(e){if(g.Utils.isIEBrower())return!1;e.dataTransfer.effectAllowed="move";var t=n.props.selectedDirentList;if(t.length>0&&t.includes(n.props.dirent)){n.props.onShowDirentsDraggablePreview(),e.dataTransfer.setDragImage(n.refs.empty_content,0,0);var r=t.map(function(e){var t=n.getDirentPath(e);return{nodeDirent:e,nodeParentPath:n.props.path,nodeRootPath:t}});return r=JSON.stringify(r),void e.dataTransfer.setData("applicaiton/drag-item-info",r)}e.dataTransfer&&e.dataTransfer.setDragImage&&e.dataTransfer.setDragImage(n.refs.drag_icon,15,15);var a=n.getDirentPath(n.props.dirent),o={nodeDirent:n.props.dirent,nodeParentPath:n.props.path,nodeRootPath:a};o=JSON.stringify(o),e.dataTransfer.setData("applicaiton/drag-item-info",o)},n.onItemDragEnter=function(e){if(g.Utils.isIEBrower())return!1;"dir"===n.props.dirent.type&&(e.stopPropagation(),n.setState({isDropTipshow:!0}))},n.onItemDragOver=function(e){if(g.Utils.isIEBrower())return!1;"copy"!==e.dataTransfer.dropEffect&&(e.preventDefault(),e.dataTransfer.dropEffect="move")},n.onItemDragLeave=function(e){if(g.Utils.isIEBrower())return!1;"dir"===n.props.dirent.type&&e.stopPropagation(),n.setState({isDropTipshow:!1})},n.onItemDragDrop=function(e){if(g.Utils.isIEBrower())return!1;if(n.setState({isDropTipshow:!1}),!e.dataTransfer.files.length&&"dir"===n.props.dirent.type){e.stopPropagation();var t=e.dataTransfer.getData("applicaiton/drag-item-info");if(t=JSON.parse(t),Array.isArray(t)){var r=t.map(function(e){return e.nodeRootPath}),a=g.Utils.joinPath(n.props.path,n.props.dirent.name);if(r.some(function(e){return e===a}))return;return void n.props.onItemsMove(n.props.currentRepoInfo,a)}var o=t,i=o.nodeDirent,s=o.nodeParentPath,l=o.nodeRootPath,u=n.props.dirent;if(i.name!==u.name&&("dir"!==u.type||"dir"!==i.type||s===n.props.path||-1===n.props.path.indexOf(l))){var c=g.Utils.joinPath(n.props.path,n.props.dirent.name);n.onItemMove(n.props.currentRepoInfo,i,c,s)}}},n.onItemMouseDown=function(e){n.props.onItemMouseDown(e)},n.onItemContextMenu=function(e){var t=n.props.dirent;n.props.onItemContextMenu(e,t)},n.renderItemOperation=function(){var e=n.props,t=e.dirent,r=e.currentRepoInfo,a=e.selectedDirentList,o=g.Utils.isHasPermissionToShare(r,t.permission,t);return u.default.createElement(l.Fragment,null,a.length>1?u.default.createElement(l.Fragment,null,n.state.isOperationShow&&!t.isSelected&&u.default.createElement("div",{className:"operations"},u.default.createElement("ul",{className:"operation-group"},("rw"===t.permission||"r"===t.permission)&&u.default.createElement("li",{className:"operation-group-item"},u.default.createElement("i",{className:"op-icon sf2-icon-download",title:(0,m.gettext)("Download"),onClick:n.onItemDownload})),o&&u.default.createElement("li",{className:"operation-group-item"},u.default.createElement("i",{className:"op-icon sf2-icon-share",title:(0,m.gettext)("Share"),onClick:n.onItemShare})),"rw"===t.permission&&u.default.createElement("li",{className:"operation-group-item"},u.default.createElement("i",{className:"op-icon sf2-icon-delete",title:(0,m.gettext)("Delete"),onClick:n.onItemDelete})),u.default.createElement("li",{className:"operation-group-item"},u.default.createElement(E.default,{item:n.props.dirent,toggleClass:"sf2-icon-caret-down",isHandleContextMenuEvent:!0,getMenuList:n.props.getDirentItemMenuList,onMenuItemClick:n.onMenuItemClick,unfreezeItem:n.unfreezeItem,freezeItem:n.props.freezeItem}))))):u.default.createElement(l.Fragment,null,n.state.isOperationShow&&u.default.createElement("div",{className:"operations"},u.default.createElement("ul",{className:"operation-group"},("rw"===t.permission||"r"===t.permission)&&u.default.createElement("li",{className:"operation-group-item"},u.default.createElement("i",{className:"op-icon sf2-icon-download",title:(0,m.gettext)("Download"),onClick:n.onItemDownload})),o&&u.default.createElement("li",{className:"operation-group-item"},u.default.createElement("i",{className:"op-icon sf2-icon-share",title:(0,m.gettext)("Share"),onClick:n.onItemShare})),"rw"===t.permission&&u.default.createElement("li",{className:"operation-group-item"},u.default.createElement("i",{className:"op-icon sf2-icon-delete",title:(0,m.gettext)("Delete"),onClick:n.onItemDelete})),u.default.createElement("li",{className:"operation-group-item"},u.default.createElement(E.default,{item:n.props.dirent,toggleClass:"sf2-icon-caret-down",isHandleContextMenuEvent:!0,getMenuList:n.props.getDirentItemMenuList,onMenuItemClick:n.onMenuItemClick,unfreezeItem:n.unfreezeItem,freezeItem:n.props.freezeItem}))))))},n.state={isOperationShow:!1,highlight:!1,isZipDialogOpen:!1,isMoveDialogShow:!1,isCopyDialogShow:!1,isShareDialogShow:!1,isMutipleOperation:!1,isShowTagTooltip:!1,isDragTipShow:!1,isDropTipshow:!1,isEditFileTagShow:!1,isPermissionDialogOpen:!1,isOpMenuOpen:!1},n}return i(t,e),s(t,[{key:"componentWillReceiveProps",value:function(e){var t=this;e.isItemFreezed===this.props.isItemFreezed||e.isItemFreezed||this.setState({highlight:!1,isOperationShow:!1},function(){e.activeDirent&&e.activeDirent.name===e.dirent.name&&t.setState({isOperationShow:!0})})}},{key:"render",value:function(){var e=this,t=this.props,n=t.path,r=t.dirent,a=t.activeDirent,o=g.Utils.joinPath(n,r.name),i="";this.props.currentRepoInfo&&(i=m.siteRoot+"library/"+this.props.repoID+"/"+this.props.currentRepoInfo.repo_name+g.Utils.encodePath(o));var s=m.siteRoot+"lib/"+this.props.repoID+"/file"+g.Utils.encodePath(o),c="",d="";r.file_tags&&r.file_tags.length>0&&(c=(0,f.default)(r.name).slice(0,7),d=r.file_tags.map(function(e){return e.name}).join(" "));var p=g.Utils.getDirentIcon(r),y=this.state.highlight?"tr-highlight ":"";y+=this.state.isDropTipshow?"tr-drop-effect":"",y+=a&&a.name===r.name?"tr-active":"",y+=r.isSelected?"tr-active":"";var v=(0,m.gettext)("locked by {name}").replace("{name}",r.lock_owner_name),b=g.Utils.isDesktop(),w=u.default.createElement("tr",{className:y,draggable:"true",onMouseEnter:this.onMouseEnter,onMouseOver:this.onMouseOver,onMouseLeave:this.onMouseLeave,onClick:this.onDirentClick,onDragStart:this.onItemDragStart,onDragEnter:this.onItemDragEnter,onDragOver:this.onItemDragOver,onDragLeave:this.onItemDragLeave,onDrop:this.onItemDragDrop,onMouseDown:this.onItemMouseDown,onContextMenu:this.onItemContextMenu},u.default.createElement("td",{className:"pl10 "+(this.state.isDragTipShow?"tr-drag-effect":"")},u.default.createElement("input",{type:"checkbox",className:"vam",onChange:this.onItemSelected,checked:r.isSelected})),u.default.createElement("td",{className:"pl10"},void 0!==r.starred&&!r.starred&&u.default.createElement("i",{className:"far fa-star star-empty cursor-pointer",onClick:this.onItemStarred}),void 0!==r.starred&&r.starred&&u.default.createElement("i",{className:"fas fa-star cursor-pointer",onClick:this.onItemStarred})),u.default.createElement("td",{className:"pl10"},u.default.createElement("div",{className:"dir-icon"},r.encoded_thumbnail_src?u.default.createElement("img",{ref:"drag_icon",src:""+m.siteRoot+r.encoded_thumbnail_src,className:"thumbnail cursor-pointer",onClick:this.onItemClick,alt:""}):u.default.createElement("img",{ref:"drag_icon",src:p,width:"24",alt:""}),r.is_locked&&u.default.createElement("img",{className:"locked",src:m.mediaUrl+"img/file-locked-32.png",alt:(0,m.gettext)("locked"),title:v}),u.default.createElement("div",{ref:"empty_content",style:{position:"absolute",width:"1px",height:"1px"}}))),u.default.createElement("td",{className:"name"},this.state.isRenameing?u.default.createElement(C.default,{hasSuffix:"dir"!==r.type,name:r.name,onRenameConfirm:this.onRenameConfirm,onRenameCancel:this.onRenameCancel}):u.default.createElement("a",{href:"dir"===r.type?i:s,onClick:this.onItemClick},r.name)),u.default.createElement("td",{className:"tag-list-title"},"dir"!==r.type&&r.file_tags&&r.file_tags.length>0&&u.default.createElement(l.Fragment,null,u.default.createElement("div",{id:"tag-list-title-"+c,className:"dirent-item tag-list tag-list-stacked"},r.file_tags.map(function(e,t){var n=r.file_tags.length;return u.default.createElement("span",{className:"file-tag",key:e.id,style:{zIndex:n-t,backgroundColor:e.color}})})),u.default.createElement(h.UncontrolledTooltip,{target:"tag-list-title-"+c,placement:"bottom"},d))),u.default.createElement("td",{className:"operation"},this.renderItemOperation()),u.default.createElement("td",{className:"file-size"},r.size&&r.size),u.default.createElement("td",{className:"last-update"},r.mtime_relative)),E=u.default.createElement("tr",null,u.default.createElement("td",{onClick:this.onItemClick},u.default.createElement("div",{className:"dir-icon"},r.encoded_thumbnail_src?u.default.createElement("img",{src:""+m.siteRoot+r.encoded_thumbnail_src,className:"thumbnail cursor-pointer",alt:""}):u.default.createElement("img",{src:p,width:"24",alt:""}),r.is_locked&&u.default.createElement("img",{className:"locked",src:m.mediaUrl+"img/file-locked-32.png",alt:(0,m.gettext)("locked"),title:v}))),u.default.createElement("td",{onClick:this.onItemClick},this.state.isRenameing?u.default.createElement(C.default,{hasSuffix:"dir"!==r.type,name:r.name,onRenameConfirm:this.onRenameConfirm,onRenameCancel:this.onRenameCancel}):u.default.createElement("a",{href:"dir"===r.type?i:s},r.name),u.default.createElement("br",null),r.size&&u.default.createElement("span",{className:"item-meta-info"},r.size),u.default.createElement("span",{className:"item-meta-info"},r.mtime_relative)),u.default.createElement("td",null,u.default.createElement(h.Dropdown,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu},u.default.createElement(h.DropdownToggle,{tag:"i",className:"sf-dropdown-toggle fa fa-ellipsis-v ml-0",title:(0,m.gettext)("More Operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),u.default.createElement("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu},u.default.createElement("div",{className:"mobile-operation-menu-bg-layer"}),u.default.createElement("div",{className:"mobile-operation-menu"},void 0!==r.starred&&u.default.createElement(h.DropdownItem,{className:"mobile-menu-item",onClick:this.onItemStarred},r.starred?(0,m.gettext)("Unstar"):(0,m.gettext)("Star")),this.props.getDirentItemMenuList(r,!0).map(function(t,n){if("Divider"!=t&&"Open via Client"!=t.key)return u.default.createElement(h.DropdownItem,{className:"mobile-menu-item",key:n,"data-op":t.key,onClick:e.onMobileMenuItemClick},t.value)}))))));return u.default.createElement(l.Fragment,null,b?w:E,this.state.isMoveDialogShow&&u.default.createElement(_.default,null,u.default.createElement(k.default,{path:this.props.path,repoID:this.props.repoID,dirent:this.props.dirent,isMutipleOperation:this.state.isMutipleOperation,onItemMove:this.props.onItemMove,onCancelMove:this.onItemMoveToggle,repoEncrypted:this.props.repoEncrypted})),this.state.isCopyDialogShow&&u.default.createElement(_.default,null,u.default.createElement(O.default,{path:this.props.path,repoID:this.props.repoID,dirent:this.props.dirent,isMutipleOperation:this.state.isMutipleOperation,onItemCopy:this.props.onItemCopy,onCancelCopy:this.onItemCopyToggle,repoEncrypted:this.props.repoEncrypted})),this.state.isEditFileTagShow&&u.default.createElement(x.default,{repoID:this.props.repoID,fileTagList:r.file_tags,filePath:o,toggleCancel:this.onEditFileTagToggle,onFileTagChanged:this.onFileTagChanged}),this.state.isZipDialogOpen&&u.default.createElement(_.default,null,u.default.createElement(R.default,{repoID:this.props.repoID,path:this.props.path,target:this.props.dirent.name,toggleDialog:this.closeZipDialog})),this.state.isShareDialogShow&&u.default.createElement(_.default,null,u.default.createElement(I.default,{itemType:r.type,itemName:r.name,itemPath:o,userPerm:r.permission,repoID:this.props.repoID,repoEncrypted:this.props.repoEncrypted,enableDirPrivateShare:this.props.enableDirPrivateShare,isGroupOwnedRepo:this.props.isGroupOwnedRepo,toggleDialog:this.closeSharedDialog})),this.state.isPermissionDialogOpen&&u.default.createElement(_.default,null,u.default.createElement(Y.default,{toggleDialog:this.onPermissionItem,repoID:this.props.repoID,folderPath:o,folderName:r.name,isDepartmentRepo:this.props.isGroupOwnedRepo})))}}]),t}(u.default.Component);B.propTypes=A,t.default=B},2282:function(e,t){!function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&n.rotl(e,8)|4278255360&n.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=n.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],n=0,r=0;n<e.length;n++,r+=8)t[r>>>5]|=e[n]<<24-r%32;return t},wordsToBytes:function(e){for(var t=[],n=0;n<32*e.length;n+=8)t.push(e[n>>>5]>>>24-n%32&255);return t},bytesToHex:function(e){for(var t=[],n=0;n<e.length;n++)t.push((e[n]>>>4).toString(16)),t.push((15&e[n]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],n=0;n<e.length;n+=2)t.push(parseInt(e.substr(n,2),16));return t},bytesToBase64:function(e){for(var n=[],r=0;r<e.length;r+=3)for(var a=e[r]<<16|e[r+1]<<8|e[r+2],o=0;o<4;o++)8*r+6*o<=8*e.length?n.push(t.charAt(a>>>6*(3-o)&63)):n.push("=");return n.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var n=[],r=0,a=0;r<e.length;a=++r%4)0!=a&&n.push((t.indexOf(e.charAt(r-1))&Math.pow(2,-2*a+8)-1)<<2*a|t.indexOf(e.charAt(r))>>>6-2*a);return n}};e.exports=n}()},2283:function(e,t){},2284:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(2),f=n(3),h={selectedDirentList:d.default.array,onHideDirentsDraggablePreview:d.default.func},m=function(e){function t(){var e,n,r,i;a(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=r=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),r.handleDragEnd=function(){r.element.style.opacity=0,r.props.onHideDirentsDraggablePreview()},r.handleDragOver=function(e){if(f.Utils.isIEBrower())return!1;e.preventDefault(),e.dataTransfer.dropEffect="move",r.element.style.top=e.clientY+"px",r.element.style.left=e.clientX+"px"},r.handleDrop=function(e){r.element.style.opacity=0,r.props.onHideDirentsDraggablePreview()},i=n,o(r,i)}return i(t,e),s(t,[{key:"componentDidMount",value:function(){document.addEventListener("dragover",this.handleDragOver),document.addEventListener("drop",this.handleDrop),document.addEventListener("dragend",this.handleDragEnd)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("dragover",this.handleDragOver),document.removeEventListener("drop",this.handleDrop),document.removeEventListener("dragend",this.handleDragEnd)}},{key:"render",value:function(){var e=this,t=this.props.selectedDirentList,n={position:"absolute",opacity:1,pointerEvents:"none",display:"block",left:"-9999px",top:"-9999px",zIndex:101,maxHeight:document.documentElement.clientHeight,overflow:"hidden"};return u.default.createElement("div",{style:n,ref:function(t){return e.element=t}},t.map(function(e,t){var n=f.Utils.getDirentIcon(e);return u.default.createElement("div",{key:t},e.encoded_thumbnail_src?u.default.createElement("img",{src:""+p.siteRoot+e.encoded_thumbnail_src,className:"thumbnail cursor-pointer",alt:""}):u.default.createElement("img",{src:n,width:"24",alt:""}))}))}}]),t}(u.default.Component);m.propTypes=h,t.default=m},2285:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(1319),f=r(p),h=n(2286),m=r(h),g=n(1318),y=r(g),v={path:d.default.string.isRequired,repoID:d.default.string.isRequired,currentRepoInfo:d.default.object.isRequired,readmeMarkdown:d.default.object,draftCounts:d.default.number,usedRepoTags:d.default.array.isRequired,updateUsedRepoTags:d.default.func.isRequired,direntList:d.default.array.isRequired,onItemClick:d.default.func.isRequired,onGridItemClick:d.default.func,onAddFile:d.default.func.isRequired,onItemDelete:d.default.func.isRequired,onItemMove:d.default.func.isRequired,onItemCopy:d.default.func.isRequired,onRenameNode:d.default.func.isRequired,isGroupOwnedRepo:d.default.bool.isRequired,userPerm:d.default.string,isRepoInfoBarShow:d.default.bool.isRequired,isDirentListLoading:d.default.bool.isRequired,isDirentDetailShow:d.default.bool.isRequired,enableDirPrivateShare:d.default.bool.isRequired,updateDirent:d.default.func.isRequired,showDirentDetail:d.default.func.isRequired,onAddFolder:d.default.func.isRequired,onFileTagChanged:d.default.func,onItemRename:d.default.func.isRequired},b=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){return"/"===this.props.path&&0===this.props.direntList.length?u.default.createElement(y.default,{path:this.props.path,isDirentListLoading:this.props.isDirentListLoading,onAddFile:this.props.onAddFile}):u.default.createElement(l.Fragment,null,this.props.isRepoInfoBarShow&&u.default.createElement(f.default,{repoID:this.props.repoID,currentPath:this.props.path,readmeMarkdown:this.props.readmeMarkdown,draftCounts:this.props.draftCounts,usedRepoTags:this.props.usedRepoTags,updateUsedRepoTags:this.props.updateUsedRepoTags,onFileTagChanged:this.props.onFileTagChanged}),u.default.createElement(m.default,{path:this.props.path,repoID:this.props.repoID,currentRepoInfo:this.props.currentRepoInfo,isGroupOwnedRepo:this.props.isGroupOwnedRepo,userPerm:this.props.userPerm,enableDirPrivateShare:this.props.enableDirPrivateShare,direntList:this.props.direntList,onAddFile:this.props.onAddFile,onItemClick:this.props.onItemClick,onItemDelete:this.props.onItemDelete,onItemMove:this.props.onItemMove,onItemCopy:this.props.onItemCopy,isDirentListLoading:this.props.isDirentListLoading,updateDirent:this.props.updateDirent,onRenameNode:this.props.onRenameNode,showDirentDetail:this.props.showDirentDetail,onGridItemClick:this.props.onGridItemClick,isDirentDetailShow:this.props.isDirentDetailShow,onItemRename:this.props.onItemRename,onAddFolder:this.props.onAddFolder,onFileTagChanged:this.props.onFileTagChanged}))}}]),t}(u.default.Component);b.propTypes=v,t.default=b},2286:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(2),f=n(3),h=n(4),m=n(356),g=r(m),y=n(8),v=r(y),b=n(13),w=r(b),E=n(747),S=r(E),C=n(2287),D=r(C),_=n(735),P=r(_),k=n(274),M=n(14),O=r(M),L=n(745),I=r(L),T=n(746),R=r(T),N=n(108),x=r(N),F=n(474),Y=r(F),Z=n(380),j=r(Z),A=n(1315),B=r(A),X=n(744),J=r(X),U=n(473),H=r(U),G=n(743),q=r(G),Q=n(5),W=r(Q);n(1038);var K={path:d.default.string.isRequired,repoID:d.default.string.isRequired,currentRepoInfo:d.default.object,direntList:d.default.array.isRequired,onAddFile:d.default.func,onItemDelete:d.default.func,onItemCopy:d.default.func.isRequired,onItemMove:d.default.func.isRequired,onRenameNode:d.default.func.isRequired,onItemClick:d.default.func.isRequired,isDirentListLoading:d.default.bool.isRequired,isGroupOwnedRepo:d.default.bool.isRequired,userPerm:d.default.string,enableDirPrivateShare:d.default.bool.isRequired,updateDirent:d.default.func.isRequired,isDirentDetailShow:d.default.bool.isRequired,onGridItemClick:d.default.func,onFileTagChanged:d.default.func,onAddFolder:d.default.func.isRequired,showDirentDetail:d.default.func.isRequired,onItemRename:d.default.func.isRequired},z=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onCreateFileToggle=function(){n.setState({isCreateFileDialogShow:!n.state.isCreateFileDialogShow})},n.onGridItemClick=function(e){n.setState({activeDirent:e}),n.props.onGridItemClick(e)},n.onMoveToggle=function(){n.setState({isMoveDialogShow:!n.state.isMoveDialogShow})},n.onCopyToggle=function(){n.setState({isCopyDialogShow:!n.state.isCopyDialogShow})},n.onAddFile=function(e,t){n.setState({isCreateFileDialogShow:!1}),n.props.onAddFile(e,t)},n.onAddFolder=function(e){n.setState({isCreateFolderDialogShow:!1}),n.props.onAddFolder(e)},n.onItemShare=function(e){e.nativeEvent.stopImmediatePropagation(),n.setState({isShareDialogShow:!n.state.isShareDialogShow})},n.closeSharedDialog=function(){n.setState({isShareDialogShow:!n.state.isShareDialogShow})},n.onItemDelete=function(e,t){t.nativeEvent.stopImmediatePropagation(),n.props.onItemDelete(e)},n.onMenuItemClick=function(e,t,r){switch((0,k.hideMenu)(),e){case"Download":n.onItemDownload(t,r);break;case"Share":n.onItemShare(r);break;case"Delete":n.onItemDelete(t,r);break;case"Rename":n.onItemRenameToggle();break;case"Move":n.onItemMoveToggle();break;case"Copy":n.onItemCopyToggle();break;case"Tags":n.onEditFileTagToggle();break;case"Permission":n.onPermissionItem();break;case"Unlock":n.onUnlockItem(t);break;case"Lock":n.onLockItem(t);break;case"Comment":n.onCommentItem();break;case"History":n.onHistory(t);break;case"New Folder":n.onCreateFolderToggle(t);break;case"New File":n.onCreateFileToggle(t);break;case"Access Log":n.onAccessLog(t);break;case"Open via Client":n.onOpenViaClient(t)}},n.onEditFileTagToggle=function(){n.setState({isEditFileTagShow:!n.state.isEditFileTagShow})},n.onFileTagChanged=function(){var e=n.state.activeDirent?n.state.activeDirent:"",t=f.Utils.joinPath(n.props.path,e.name);n.props.onFileTagChanged(e,t)},n.getDirentPath=function(e){var t=n.props.path;return"/"===t?t+e.name:t+"/"+e.name},n.closeZipDialog=function(){n.setState({isZipDialogOpen:!1})},n.onItemDownload=function(e,t){t.nativeEvent.stopImmediatePropagation();var r=e,a=n.props.repoID,o=n.getDirentPath(r);if("dir"===r.type)n.setState({isZipDialogOpen:!0});else{var i=g.default.getUrl({type:"download_file_url",repoID:a,filePath:o});location.href=i}},n.onCreateFolderToggle=function(){n.setState({isCreateFolderDialogShow:!n.state.isCreateFolderDialogShow})},n.onItemRenameToggle=function(){n.setState({isRenameDialogShow:!n.state.isRenameDialogShow})},n.onItemMoveToggle=function(){n.setState({isMoveDialogShow:!n.state.isMoveDialogShow})},n.onItemCopyToggle=function(){n.setState({isCopyDialogShow:!n.state.isCopyDialogShow})},n.onPermissionItem=function(){n.setState({isPermissionDialogOpen:!n.state.isPermissionDialogOpen})},n.onLockItem=function(e){var t=n.props.repoID,r=n.getDirentPath(e);h.seafileAPI.lockfile(t,r).then(function(){n.props.updateDirent(e,"is_locked",!0),n.props.updateDirent(e,"locked_by_me",!0);var t=p.username.split("@");n.props.updateDirent(e,"lock_owner_name",t[0])}).catch(function(e){var t=f.Utils.getErrorMsg(e);W.default.danger(t)})},n.onUnlockItem=function(e){var t=n.props.repoID,r=n.getDirentPath(e);h.seafileAPI.unlockfile(t,r).then(function(){n.props.updateDirent(e,"is_locked",!1),n.props.updateDirent(e,"locked_by_me",!1),n.props.updateDirent(e,"lock_owner_name","")}).catch(function(e){var t=f.Utils.getErrorMsg(e);W.default.danger(t)})},n.onCommentItem=function(){n.props.showDirentDetail("comments")},n.onHistory=function(e){var t=n.props.repoID,r=n.getDirentPath(e),a=g.default.getUrl({type:"file_revisions",repoID:t,filePath:r});location.href=a},n.onAccessLog=function(e){var t=n.getDirentPath(e),r=p.siteRoot+"repo/file-access/"+n.props.repoID+"/?p="+encodeURIComponent(t);window.open(r)},n.onOpenViaClient=function(e){var t=n.props.repoID,r=n.getDirentPath(e),a=g.default.getUrl({type:"open_via_client",repoID:t,filePath:r});location.href=a},n.onItemRename=function(e){n.props.onItemRename(n.state.activeDirent,e)},n.prepareImageItem=function(e){var t=!n.repoEncrypted,r=e.name,a=r.substr(r.lastIndexOf(".")+1).toLowerCase(),o="gif"==a,i=f.Utils.encodePath(f.Utils.joinPath(n.props.path,r)),s=n.props.repoID,l=void 0;return l=t&&!o?p.siteRoot+"thumbnail/"+s+"/"+p.thumbnailSizeForOriginal+i:p.siteRoot+"repo/"+s+"/raw"+i,{name:r,url:p.siteRoot+"lib/"+s+"/file"+i,src:l}},n.showImagePopup=function(e){var t=n.props.direntList.filter(function(e){return f.Utils.imageCheck(e.name)}),r=t.map(function(e){return n.prepareImageItem(e)});n.setState({isImagePopupOpen:!0,imageItems:r,imageIndex:t.indexOf(e)})},n.closeImagePopup=function(){n.setState({isImagePopupOpen:!1})},n.moveToPrevImage=function(){var e=n.state.imageItems.length;n.setState(function(t){return{imageIndex:(t.imageIndex+e-1)%e}})},n.moveToNextImage=function(){var e=n.state.imageItems.length;n.setState(function(t){return{imageIndex:(t.imageIndex+1)%e}})},n.checkDuplicatedName=function(e){return f.Utils.checkDuplicatedNameInList(n.props.direntList,e)},n.onMouseDown=function(e){e.stopPropagation(),e.button},n.onGridContainerMouseDown=function(e){n.onMouseDown(e)},n.onGridItemMouseDown=function(e){n.onMouseDown(e)},n.gridContainerClick=function(){n.props.isDirentDetailShow||n.onGridItemClick(null)},n.onGridContainerContextMenu=function(e){e.preventDefault();var t=n.props.userPerm;if("admin"===t||"rw"===t){var r=[O.default.NEW_FOLDER,O.default.NEW_FILE];n.handleContextClick(e,"dirent-grid-container-menu",r)}},n.onGridItemContextMenu=function(e,t){var r=n.getDirentItemMenuList(t,!0);n.handleContextClick(e,"grid-item-contextmenu",r,t),n.props.onGridItemClick&&n.props.onGridItemClick(t)},n.handleContextClick=function(e,t,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e.preventDefault(),e.stopPropagation();var o=e.clientX||e.touches&&e.touches[0].pageX,i=e.clientY||e.touches&&e.touches[0].pageY;n.props.posX&&(o-=n.props.posX),n.props.posY&&(i-=n.props.posY),(0,k.hideMenu)(),n.setState({activeDirent:a});var s={id:t,position:{x:o,y:i},target:e.target,currentObject:a,menuList:r};0!==r.length&&(0,k.showMenu)(s)},n.getDirentItemMenuList=function(e,t){var r=n.isRepoOwner,a=n.props.currentRepoInfo;return f.Utils.getDirentOperationList(r,a,e,t)},n.state={isImagePopupOpen:!1,imageItems:[],imageIndex:0,isShareDialogShow:!1,isMoveDialogShow:!1,isCopyDialogShow:!1,isEditFileTagShow:!1,isZipDialogOpen:!1,isRenameDialogShow:!1,isCreateFolderDialogShow:!1,isCreateFileDialogShow:!1,isPermissionDialogOpen:!1,isMutipleOperation:!1,isGridItemFreezed:!1,activeDirent:null},n.isRepoOwner=e.currentRepoInfo.owner_email===p.username,n}return i(t,e),s(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.direntList,r=t.path,a=this.state.activeDirent?this.state.activeDirent:"",o=f.Utils.joinPath(r,a.name);return this.props.isDirentListLoading?u.default.createElement(v.default,null):u.default.createElement(l.Fragment,null,u.default.createElement("ul",{className:"grid-view",onClick:this.gridContainerClick,onContextMenu:this.onGridContainerContextMenu,onMouseDown:this.onGridContainerMouseDown},0!==n.length&&n.map(function(t,n){return u.default.createElement(D.default,{key:n,dirent:t,repoID:e.props.repoID,path:e.props.path,onItemClick:e.props.onItemClick,currentRepoInfo:e.props.currentRepoInfo,showImagePopup:e.showImagePopup,onGridItemContextMenu:e.onGridItemContextMenu,onItemMove:e.props.onItemMove,onGridItemMouseDown:e.onGridItemMouseDown,onGridItemClick:e.onGridItemClick,activeDirent:e.state.activeDirent})})),u.default.createElement(P.default,{id:"grid-item-contextmenu",onMenuItemClick:this.onMenuItemClick}),u.default.createElement(P.default,{id:"dirent-grid-container-menu",onMenuItemClick:this.onMenuItemClick}),this.state.isCreateFolderDialogShow&&u.default.createElement(w.default,null,u.default.createElement(H.default,{parentPath:this.props.path,onAddFolder:this.onAddFolder,checkDuplicatedName:this.checkDuplicatedName,addFolderCancel:this.onCreateFolderToggle})),this.state.isCreateFileDialogShow&&u.default.createElement(w.default,null,u.default.createElement(J.default,{parentPath:this.props.path,onAddFile:this.onAddFile,checkDuplicatedName:this.checkDuplicatedName,addFileCancel:this.onCreateFileToggle})),this.state.isMoveDialogShow&&u.default.createElement(I.default,{path:this.props.path,repoID:this.props.repoID,repoEncrypted:this.props.currentRepoInfo.encrypted,isMutipleOperation:this.state.isMutipleOperation,onItemMove:this.props.onItemMove,onCancelMove:this.onMoveToggle,dirent:this.state.activeDirent}),this.state.isZipDialogOpen&&u.default.createElement(w.default,null,u.default.createElement(Y.default,{repoID:this.props.repoID,path:this.props.path,target:a.name,toggleDialog:this.closeZipDialog})),this.state.isCopyDialogShow&&u.default.createElement(R.default,{path:this.props.path,repoID:this.props.repoID,repoEncrypted:this.props.currentRepoInfo.encrypted,isMutipleOperation:this.state.isMutipleOperation,onItemCopy:this.props.onItemCopy,onCancelCopy:this.onCopyToggle,dirent:this.state.activeDirent}),this.state.isEditFileTagShow&&u.default.createElement(j.default,{repoID:this.props.repoID,fileTagList:a.file_tags,filePath:o,toggleCancel:this.onEditFileTagToggle,onFileTagChanged:this.onFileTagChanged}),this.state.isShareDialogShow&&u.default.createElement(w.default,null,u.default.createElement(x.default,{itemType:a.type,itemName:a.name,itemPath:o,userPerm:a.permission,repoID:this.props.repoID,repoEncrypted:!1,enableDirPrivateShare:this.props.enableDirPrivateShare,isGroupOwnedRepo:this.props.isGroupOwnedRepo,toggleDialog:this.closeSharedDialog})),this.state.isRenameDialogShow&&u.default.createElement(w.default,null,u.default.createElement(B.default,{dirent:this.state.activeDirent,onRename:this.onItemRename,checkDuplicatedName:this.checkDuplicatedName,toggleCancel:this.onItemRenameToggle})),this.state.isPermissionDialogOpen&&u.default.createElement(w.default,null,u.default.createElement(q.default,{toggleDialog:this.onPermissionItem,repoID:this.props.repoID,folderPath:o,folderName:a.name,isDepartmentRepo:this.props.isGroupOwnedRepo})),this.state.isImagePopupOpen&&u.default.createElement(w.default,null,u.default.createElement(S.default,{imageItems:this.state.imageItems,imageIndex:this.state.imageIndex,closeImagePopup:this.closeImagePopup,moveToPrevImage:this.moveToPrevImage,moveToNextImage:this.moveToNextImage})))}}]),t}(u.default.Component);z.propTypes=K,t.default=z},2287:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(1037),f=r(p),h=n(6),m=n(2),g=n(3),y={path:d.default.string.isRequired,repoID:d.default.string.isRequired,dirent:d.default.object.isRequired,onItemClick:d.default.func.isRequired,showImagePopup:d.default.func.isRequired,onGridItemContextMenu:d.default.func.isRequired,onGridItemClick:d.default.func.isRequired,activeDirent:d.default.object,onGridItemMouseDown:d.default.func,currentRepoInfo:d.default.object,onItemMove:d.default.func.isRequired},v=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onItemMove=function(e,t,r,a){n.props.onItemMove(e,t,r,a)},n.onItemClick=function(e){e.preventDefault(),e.stopPropagation();var t=n.props.dirent;n.props.dirent===n.props.activeDirent?(n.setState({isGridSelected:!1}),g.Utils.imageCheck(t.name)?n.props.showImagePopup(t):n.props.onItemClick(t)):(n.setState({isGridSelected:!1}),n.props.onGridItemClick(n.props.dirent))},n.onItemLinkClick=function(e){e.preventDefault();var t=n.props.dirent;g.Utils.imageCheck(t.name)?n.props.showImagePopup(t):n.props.onItemClick(t)},n.onGridItemDragStart=function(e){var t={nodeDirent:n.props.dirent,nodeParentPath:n.props.path};t=JSON.stringify(t),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("applicaiton/drag-item-info",t)},n.onGridItemDragEnter=function(e){"dir"===n.props.dirent.type&&n.setState({isGridDropTipShow:!0})},n.onGridItemDragOver=function(e){e.preventDefault(),e.dataTransfer.dropEffect="move"},n.onGridItemDragLeave=function(e){n.setState({isGridDropTipShow:!1})},n.onGridItemDragDrop=function(e){if(n.setState({isGridDropTipShow:!1}),!e.dataTransfer.files.length){var t=e.dataTransfer.getData("applicaiton/drag-item-info");t=JSON.parse(t);var r=t,a=r.nodeDirent,o=r.nodeParentPath,i=n.props.dirent;if(a.name!==i.name&&"dir"===i.type){var s=g.Utils.joinPath(n.props.path,n.props.dirent.name);n.onItemMove(n.props.currentRepoInfo,a,s,o)}}},n.onGridItemMouseDown=function(e){n.props.onGridItemMouseDown(e)},n.getFileUrl=function(e){var t=e.split("/");return-1!==t.indexOf("48")&&t.splice(t.indexOf("48"),1,"192"),t.join("/")},n.onGridItemContextMenu=function(e){var t=n.props.dirent;n.props.onGridItemContextMenu(e,t)},n.state={isGridSelected:!1,isGridDropTipShow:!1},n}return i(t,e),s(t,[{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState({isGridSelected:!1},function(){e.activeDirent&&e.activeDirent.name===e.dirent.name&&t.setState({isGridSelected:!0})})}},{key:"render",value:function(){var e=this.props,t=e.dirent,n=e.path,r=g.Utils.joinPath(n,t.name),a=g.Utils.getDirentIcon(t,!0),o=t.encoded_thumbnail_src?this.getFileUrl(t.encoded_thumbnail_src):"",i="",s="";t.file_tags&&t.file_tags.length>0&&(i=(0,f.default)(t.name).slice(0,7),s=t.file_tags.map(function(e){return e.name}).join(" "));var c="";this.props.currentRepoInfo&&(c=m.siteRoot+"library/"+this.props.repoID+"/"+this.props.currentRepoInfo.repo_name+g.Utils.encodePath(r));var d=m.siteRoot+"lib/"+this.props.repoID+"/file"+g.Utils.encodePath(r),p="grid-file-img-link cursor-pointer";p+=this.state.isGridSelected?" grid-selected-active":" ",p+=this.state.isGridDropTipShow?" grid-drop-show":" ";var y=(0,m.gettext)("locked by {name}");return y=y.replace("{name}",t.lock_owner_name),u.default.createElement(l.Fragment,null,u.default.createElement("li",{className:"grid-item",onContextMenu:this.onGridItemContextMenu,onMouseDown:this.onGridItemMouseDown},u.default.createElement("div",{className:p,draggable:"true",onClick:this.onItemClick,onDragStart:this.onGridItemDragStart,onDragEnter:this.onGridItemDragEnter,onDragOver:this.onGridItemDragOver,onDragLeave:this.onGridItemDragLeave,onDrop:this.onGridItemDragDrop},t.encoded_thumbnail_src?u.default.createElement("img",{src:""+m.siteRoot+o,ref:this.gridIcon,className:"thumbnail",onClick:this.onItemClick,alt:""}):u.default.createElement("img",{src:a,ref:this.gridIcon,width:"96",alt:""}),t.is_locked&&u.default.createElement("img",{className:"grid-file-locked-icon",src:m.mediaUrl+"img/file-locked-32.png",alt:(0,m.gettext)("locked"),title:y})),u.default.createElement("div",{className:"grid-file-name",onDragStart:this.onGridItemDragStart,draggable:"true"},"dir"!==t.type&&t.file_tags&&t.file_tags.length>0&&u.default.createElement(l.Fragment,null,u.default.createElement("div",{id:"tag-list-title-"+i,className:"dirent-item tag-list tag-list-stacked d-inline-block align-middle"},t.file_tags.map(function(e,n){var r=t.file_tags.length;return u.default.createElement("span",{className:"file-tag",key:e.id,style:{zIndex:r-n,backgroundColor:e.color}})})),u.default.createElement(h.UncontrolledTooltip,{target:"tag-list-title-"+i,placement:"bottom"},s)),u.default.createElement("a",{className:"grid-file-name-link "+(this.state.isGridSelected?"grid-link-selected-active":""),href:"dir"===t.type?c:d,onClick:this.onItemLinkClick},t.name))))}}]),t}(u.default.Component);v.propTypes=y,t.default=v},2288:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(2289),f=r(p),h=n(2291),m=r(h),g=n(1317),y=r(g),v={path:d.default.string.isRequired,repoID:d.default.string.isRequired,currentRepoInfo:d.default.object.isRequired,repoPermission:d.default.bool.isRequired,enableDirPrivateShare:d.default.bool.isRequired,userPerm:d.default.string,isGroupOwnedRepo:d.default.bool.isRequired,isTreeDataLoading:d.default.bool.isRequired,treeData:d.default.object.isRequired,currentNode:d.default.object,onNodeClick:d.default.func.isRequired,onNodeCollapse:d.default.func.isRequired,onNodeExpanded:d.default.func.isRequired,onRenameNode:d.default.func.isRequired,onDeleteNode:d.default.func.isRequired,onAddFileNode:d.default.func.isRequired,onAddFolderNode:d.default.func.isRequired,isViewFile:d.default.bool.isRequired,isFileLoading:d.default.bool.isRequired,isFileLoadedErr:d.default.bool.isRequired,hash:d.default.string,isDraft:d.default.bool.isRequired,hasDraft:d.default.bool.isRequired,goDraftPage:d.default.func.isRequired,filePermission:d.default.string,content:d.default.string,lastModified:d.default.string,latestContributor:d.default.string,onLinkClick:d.default.func.isRequired,isRepoInfoBarShow:d.default.bool.isRequired,draftCounts:d.default.number.isRequired,usedRepoTags:d.default.array.isRequired,readmeMarkdown:d.default.object,updateUsedRepoTags:d.default.func.isRequired,isDirentListLoading:d.default.bool.isRequired,direntList:d.default.array.isRequired,sortBy:d.default.string.isRequired,sortOrder:d.default.string.isRequired,sortItems:d.default.func.isRequired,onAddFolder:d.default.func.isRequired,onAddFile:d.default.func.isRequired,updateDirent:d.default.func.isRequired,onItemClick:d.default.func.isRequired,onItemSelected:d.default.func.isRequired,onItemDelete:d.default.func.isRequired,onItemRename:d.default.func.isRequired,onItemMove:d.default.func.isRequired,onItemCopy:d.default.func.isRequired,onDirentClick:d.default.func.isRequired,isAllItemSelected:d.default.bool.isRequired,onAllItemSelected:d.default.func.isRequired,selectedDirentList:d.default.array.isRequired,onItemsMove:d.default.func.isRequired,onItemsCopy:d.default.func.isRequired,onItemsDelete:d.default.func.isRequired,onFileTagChanged:d.default.func,showDirentDetail:d.default.func.isRequired},b=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onResizeMouseUp=function(){n.state.inResizing&&n.setState({inResizing:!1}),n.setCookie("navRate",n.state.navRate)},n.onResizeMouseDown=function(){n.containerWidth=n.refs.viewModeContainer.clientWidth,n.setState({inResizing:!0})},n.onResizeMouseMove=function(e){var t=n.containerWidth/.78*.22+3,r=(e.nativeEvent.clientX-t)/n.containerWidth;r<.1?n.setState({inResizing:!1,navRate:.12}):r>.4?n.setState({inResizing:!1,navRate:.38}):n.setState({navRate:r})},n.setCookie=function(e,t){var n=e+"="+t+";";document.cookie=n},n.getCookie=function(e){for(var t=e+"=",n=document.cookie.split(";"),r=0,a=n.length;r<a;r++){var o=n[r].trim();if(0==o.indexOf(t))return 1*o.substring(t.length,o.length)}return""},n.state={inResizing:!1,navRate:.25},n.containerWidth=null,n}return i(t,e),s(t,[{key:"componentWillMount",value:function(){var e=this.getCookie("navRate");e&&this.setState({navRate:e})}},{key:"render",value:function(){var e=this.state.inResizing?this.onResizeMouseMove:null,t=this.state.inResizing?"none":"",n="1 0 "+100*(1-this.state.navRate-.05)+"%";return u.default.createElement("div",{className:"dir-colunm-view",onMouseMove:e,onMouseUp:this.onResizeMouseUp,ref:"viewModeContainer"},u.default.createElement(f.default,{currentPath:this.props.path,repoPermission:this.props.repoPermission,isTreeDataLoading:this.props.isTreeDataLoading,treeData:this.props.treeData,currentNode:this.props.currentNode,onNodeClick:this.props.onNodeClick,onNodeCollapse:this.props.onNodeCollapse,onNodeExpanded:this.props.onNodeExpanded,onAddFolderNode:this.props.onAddFolderNode,onAddFileNode:this.props.onAddFileNode,onRenameNode:this.props.onRenameNode,onDeleteNode:this.props.onDeleteNode,repoID:this.props.repoID,navRate:this.state.navRate,inResizing:this.state.inResizing,currentRepoInfo:this.props.currentRepoInfo,onItemMove:this.props.onItemMove,onItemCopy:this.props.onItemCopy,selectedDirentList:this.props.selectedDirentList,onItemsMove:this.props.onItemsMove}),u.default.createElement("div",{className:"dir-content-resize",onMouseDown:this.onResizeMouseDown}),u.default.createElement("div",{className:"dir-content-main",style:{userSelect:t,flex:n}},this.props.isViewFile?u.default.createElement(m.default,{path:this.props.path,repoID:this.props.repoID,hash:this.props.hash,isDraft:this.props.isDraft,hasDraft:this.props.hasDraft,goDraftPage:this.props.goDraftPage,isFileLoading:this.props.isFileLoading,isFileLoadedErr:this.props.isFileLoadedErr,filePermission:this.props.filePermission,content:this.props.content,lastModified:this.props.lastModified,latestContributor:this.props.latestContributor,onLinkClick:this.props.onLinkClick}):u.default.createElement(y.default,{path:this.props.path,repoID:this.props.repoID,currentRepoInfo:this.props.currentRepoInfo,isGroupOwnedRepo:this.props.isGroupOwnedRepo,userPerm:this.props.userPerm,enableDirPrivateShare:this.props.enableDirPrivateShare,isRepoInfoBarShow:this.props.isRepoInfoBarShow,usedRepoTags:this.props.usedRepoTags,readmeMarkdown:this.props.readmeMarkdown,draftCounts:this.props.draftCounts,updateUsedRepoTags:this.props.updateUsedRepoTags,isDirentListLoading:this.props.isDirentListLoading,direntList:this.props.direntList,sortBy:this.props.sortBy,sortOrder:this.props.sortOrder,sortItems:this.props.sortItems,onAddFolder:this.props.onAddFolder,onAddFile:this.props.onAddFile,onItemClick:this.props.onItemClick,onItemSelected:this.props.onItemSelected,onItemDelete:this.props.onItemDelete,onItemRename:this.props.onItemRename,onItemMove:this.props.onItemMove,onItemCopy:this.props.onItemCopy,onDirentClick:this.props.onDirentClick,updateDirent:this.props.updateDirent,isAllItemSelected:this.props.isAllItemSelected,onAllItemSelected:this.props.onAllItemSelected,selectedDirentList:this.props.selectedDirentList,onItemsMove:this.props.onItemsMove,onItemsCopy:this.props.onItemsCopy,onItemsDelete:this.props.onItemsDelete,onFileTagChanged:this.props.onFileTagChanged,showDirentDetail:this.props.showDirentDetail})))}}]),t}(u.default.Component);b.propTypes=v,t.default=b},2289:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(1012),f=r(p),h=n(8),m=r(h),g=n(13),y=r(g),v=n(2290),b=r(v),w=n(746),E=r(w),S=n(745),C=r(S),D=n(473),_=r(D),P=n(744),k=r(P),M=n(747),O=r(M),L=n(2),I=n(3),T={currentPath:d.default.string.isRequired,repoPermission:d.default.bool.isRequired,isTreeDataLoading:d.default.bool.isRequired,treeData:d.default.object.isRequired,currentNode:d.default.object,onNodeClick:d.default.func.isRequired,onNodeCollapse:d.default.func.isRequired,onNodeExpanded:d.default.func.isRequired,onRenameNode:d.default.func.isRequired,onDeleteNode:d.default.func.isRequired,onAddFileNode:d.default.func.isRequired,onAddFolderNode:d.default.func.isRequired,repoID:d.default.string.isRequired,navRate:d.default.number,inResizing:d.default.bool.isRequired,currentRepoInfo:d.default.object.isRequired,onItemMove:d.default.func.isRequired,onItemCopy:d.default.func.isRequired,selectedDirentList:d.default.array.isRequired,onItemsMove:d.default.func.isRequired},R=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onNodeClick=function(e){if(n.setState({opNode:e}),I.Utils.imageCheck(e.object.name))return void n.showNodeImagePopup(e);n.props.onNodeClick(e)},n.onMenuItemClick=function(e,t){switch(n.setState({opNode:t}),e){case"New Folder":t?n.onAddFolderToggle():n.onAddFolderToggle("root");break;case"New File":t?n.onAddFileToggle():n.onAddFileToggle("root");break;case"Rename":n.onRenameToggle();break;case"Delete":n.onDeleteNode(t);break;case"Copy":n.onCopyToggle();break;case"Move":n.onMoveToggle();break;case"Open in New Tab":n.onOpenFile(t)}},n.onAddFileToggle=function(e){if("root"===e){var t=n.props.treeData.root;n.setState({isAddFileDialogShow:!n.state.isAddFileDialogShow,opNode:t})}else n.setState({isAddFileDialogShow:!n.state.isAddFileDialogShow})},n.onAddFolderToggle=function(e){if("root"===e){var t=n.props.treeData.root;n.setState({isAddFolderDialogShow:!n.state.isAddFolderDialogShow,opNode:t})}else n.setState({isAddFolderDialogShow:!n.state.isAddFolderDialogShow})},n.onRenameToggle=function(){n.setState({isRenameDialogShow:!n.state.isRenameDialogShow})},n.onCopyToggle=function(){n.setState({isCopyDialogShow:!n.state.isCopyDialogShow})},n.onMoveToggle=function(){n.setState({isMoveDialogShow:!n.state.isMoveDialogShow})},n.onAddFolderNode=function(e){n.setState({isAddFolderDialogShow:!n.state.isAddFolderDialogShow}),n.props.onAddFolderNode(e)},n.onAddFileNode=function(e,t){n.setState({isAddFileDialogShow:!n.state.isAddFileDialogShow}),n.props.onAddFileNode(e,t)},n.onRenameNode=function(e){n.setState({isRenameDialogShow:!n.state.isRenameDialogShow});var t=n.state.opNode;n.props.onRenameNode(t,e)},n.onDeleteNode=function(e){n.props.onDeleteNode(e)},n.onOpenFile=function(e){var t=L.siteRoot+"lib/"+n.props.repoID+"/file"+I.Utils.encodePath(e.path);window.open(t,"_blank")},n.checkDuplicatedName=function(e){var t=n.state.opNode;return(t.parentNode?t.parentNode:t).children.map(function(e){return e.object}).some(function(t){return t.name===e})},n.showNodeImagePopup=function(e){var t=e.parentNode.children,r=t.filter(function(e){return I.Utils.imageCheck(e.object.name)}),a=r.map(function(e){return e.object.name});n.setState({isNodeImagePopupOpen:!0,imageNodeItems:n.prepareImageItems(e),imageIndex:a.indexOf(e.object.name)})},n.prepareImageItems=function(e){var t=e.parentNode.children,r=t.filter(function(e){return I.Utils.imageCheck(e.object.name)}),a=!n.props.currentRepoInfo.encrypted,o=function(t){var r=t.object.name,o=I.Utils.encodePath(I.Utils.joinPath(e.parentNode.path,r)),i=r.substr(r.lastIndexOf(".")+1).toLowerCase(),s="gif"===i,l=n.props.repoID,u="";return u=a&&!s?L.siteRoot+"thumbnail/"+l+"/"+L.thumbnailSizeForOriginal+o:L.siteRoot+"repo/"+l+"/raw"+o,{name:r,url:L.siteRoot+"lib/"+l+"/file"+o,src:u}};return r.map(function(e){return o(e)})},n.closeNodeImagePopup=function(){n.setState({isNodeImagePopupOpen:!1})},n.moveToPrevImage=function(){var e=n.state.imageNodeItems.length;n.setState(function(t){return{imageIndex:(t.imageIndex+e-1)%e}})},n.moveToNextImage=function(){var e=n.state.imageNodeItems.length;n.setState(function(t){return{imageIndex:(t.imageIndex+1)%e}})},n.stopTreeScrollPropagation=function(e){e.stopPropagation()},n.state={opNode:null,isAddFileDialogShow:!1,isAddFolderDialogShow:!1,isRenameDialogShow:!1,isNodeImagePopupOpen:!1,imageNodeItems:[],imageIndex:0,isCopyDialogShow:!1,isMoveDialogShow:!1,isMutipleOperation:!1},n.isNodeMenuShow=!0,n}return i(t,e),s(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({opNode:e.currentNode})}},{key:"render",value:function(){var e=this.props.navRate?"0 0 "+100*this.props.navRate+"%":"0 0 25%",t=this.props.inResizing?"none":"";return u.default.createElement(l.Fragment,null,u.default.createElement("div",{className:"dir-content-nav",role:"navigation",style:{flex:e,userSelect:t},onScroll:this.stopTreeScrollPropagation},this.props.isTreeDataLoading?u.default.createElement(m.default,null):u.default.createElement(f.default,{repoPermission:this.props.repoPermission,isNodeMenuShow:this.isNodeMenuShow,treeData:this.props.treeData,currentPath:this.props.currentPath,onNodeClick:this.onNodeClick,onNodeExpanded:this.props.onNodeExpanded,onNodeCollapse:this.props.onNodeCollapse,onMenuItemClick:this.onMenuItemClick,onFreezedItem:this.onFreezedItem,onUnFreezedItem:this.onUnFreezedItem,onItemMove:this.props.onItemMove,currentRepoInfo:this.props.currentRepoInfo,selectedDirentList:this.props.selectedDirentList,onItemsMove:this.props.onItemsMove})),this.state.isAddFolderDialogShow&&u.default.createElement(y.default,null,u.default.createElement(_.default,{parentPath:this.state.opNode.path,onAddFolder:this.onAddFolderNode,checkDuplicatedName:this.checkDuplicatedName,addFolderCancel:this.onAddFolderToggle})),this.state.isAddFileDialogShow&&u.default.createElement(y.default,null,u.default.createElement(k.default,{parentPath:this.state.opNode.path,onAddFile:this.onAddFileNode,checkDuplicatedName:this.checkDuplicatedName,addFileCancel:this.onAddFileToggle})),this.state.isRenameDialogShow&&u.default.createElement(y.default,null,u.default.createElement(b.default,{currentNode:this.state.opNode,onRename:this.onRenameNode,checkDuplicatedName:this.checkDuplicatedName,toggleCancel:this.onRenameToggle})),this.state.isCopyDialogShow&&u.default.createElement(y.default,null,u.default.createElement(E.default,{path:this.state.opNode.parentNode.path,repoID:this.props.repoID,dirent:this.state.opNode.object,onItemCopy:this.props.onItemCopy,repoEncrypted:this.props.currentRepoInfo.encrypted,onCancelCopy:this.onCopyToggle,isMutipleOperation:this.state.isMutipleOperation})),this.state.isMoveDialogShow&&u.default.createElement(y.default,null,u.default.createElement(C.default,{path:this.state.opNode.parentNode.path,repoID:this.props.repoID,dirent:this.state.opNode.object,onItemMove:this.props.onItemMove,repoEncrypted:this.props.currentRepoInfo.encrypted,onCancelMove:this.onMoveToggle,isMutipleOperation:this.state.isMutipleOperation})),this.state.isNodeImagePopupOpen&&u.default.createElement(y.default,null,u.default.createElement(O.default,{imageItems:this.state.imageNodeItems,imageIndex:this.state.imageIndex,closeImagePopup:this.closeNodeImagePopup,moveToPrevImage:this.moveToPrevImage,moveToNextImage:this.moveToNextImage})))}}]),t}(u.default.Component);R.defaultProps={navRate:.25},R.propTypes=T,t.default=R},2290:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(2),f=n(3),h=n(6),m={currentNode:d.default.object,onRename:d.default.func.isRequired,toggleCancel:d.default.func.isRequired,checkDuplicatedName:d.default.func.isRequired},g=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleChange=function(e){e.target.value.trim()?n.setState({isSubmitBtnActive:!0}):n.setState({isSubmitBtnActive:!1}),n.setState({newName:e.target.value})},n.handleSubmit=function(){var e=n.validateInput(),t=e.isValid,r=e.errMessage;if(t){if(n.checkDuplicatedName()){var a=(0,p.gettext)('The name "{name}" is already taken. Please choose a different name.');a=a.replace("{name}",f.Utils.HTMLescape(n.state.newName)),n.setState({errMessage:a})}else n.props.onRename(n.state.newName)}else n.setState({errMessage:r})},n.handleKeyPress=function(e){"Enter"===e.key&&n.handleSubmit()},n.toggle=function(){n.props.toggleCancel()},n.changeState=function(e){var t=e.object.name;n.setState({newName:t})},n.validateInput=function(){var e=n.state.newName.trim(),t=!0,r="";return e?e.indexOf("/")>-1?(t=!1,r=(0,p.gettext)("Name should not include '/'."),{isValid:t,errMessage:r}):{isValid:t,errMessage:r}:(t=!1,r=(0,p.gettext)("Name is required."),{isValid:t,errMessage:r})},n.checkDuplicatedName=function(){return n.props.checkDuplicatedName(n.state.newName)},n.state={newName:"",errMessage:"",isSubmitBtnActive:!1},n.newInput=u.default.createRef(),n}return i(t,e),s(t,[{key:"componentWillMount",value:function(){this.setState({newName:this.props.currentNode.object.name})}},{key:"componentDidMount",value:function(){var e=this.props.currentNode;if(this.changeState(e),this.newInput.focus(),"file"===e.object.type){var t=e.object.name.lastIndexOf(".md");this.newInput.setSelectionRange(0,t,"forward")}else this.newInput.setSelectionRange(0,-1)}},{key:"componentWillReceiveProps",value:function(e){this.changeState(e.currentNode)}},{key:"render",value:function(){var e=this,t=this.props.currentNode.object.type;return u.default.createElement(h.Modal,{isOpen:!0,toggle:this.toggle},u.default.createElement(h.ModalHeader,{toggle:this.toggle},"file"===t?(0,p.gettext)("Rename File"):(0,p.gettext)("Rename Folder")),u.default.createElement(h.ModalBody,null,u.default.createElement("p",null,"file"===t?(0,p.gettext)("New file name"):(0,p.gettext)("New folder name")),u.default.createElement(h.Input,{onKeyPress:this.handleKeyPress,innerRef:function(t){e.newInput=t},placeholder:"newName",value:this.state.newName,onChange:this.handleChange}),this.state.errMessage&&u.default.createElement(h.Alert,{color:"danger",className:"mt-2"},this.state.errMessage)),u.default.createElement(h.ModalFooter,null,u.default.createElement(h.Button,{color:"secondary",onClick:this.toggle},(0,p.gettext)("Cancel")),u.default.createElement(h.Button,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive},(0,p.gettext)("Submit"))))}}]),t}(u.default.Component);g.propTypes=m,t.default=g},2291:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(3),f=n(2),h=n(4),m=n(5),g=r(m),y=n(1014),v=r(y),b={path:d.default.string.isRequired,repoID:d.default.string.isRequired,hash:d.default.string,isDraft:d.default.bool,hasDraft:d.default.bool,goDraftPage:d.default.func.isRequired,isFileLoading:d.default.bool.isRequired,isFileLoadedErr:d.default.bool.isRequired,filePermission:d.default.string,content:d.default.string,lastModified:d.default.string,latestContributor:d.default.string,onLinkClick:d.default.func.isRequired},w=function(e){function t(){var e,n,r,i;a(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=r=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),r.onEditClick=function(e){e.preventDefault();var t=r.props,n=t.path,a=t.repoID,o=f.siteRoot+"lib/"+a+"/file"+p.Utils.encodePath(n)+"?mode=edit";window.open(o)},r.onNewDraft=function(e){e.preventDefault();var t=r.props,n=t.path,a=t.repoID;h.seafileAPI.createDraft(a,n).then(function(e){window.location.href=f.siteRoot+"lib/"+e.data.origin_repo_id+"/file"+e.data.draft_file_path+"?mode=edit"}).catch(function(e){var t=p.Utils.getErrorMsg(e);g.default.danger(t)})},r.onOpenFile=function(e){e.preventDefault();var t=r.props,n=t.path,a=t.repoID,o=f.siteRoot+"lib/"+a+"/file"+p.Utils.encodePath(n);window.open(o,"_blank")},r.goDraftPage=function(e){e.preventDefault(),r.props.goDraftPage()},i=n,o(r,i)}return i(t,e),s(t,[{key:"componentDidMount",value:function(){if(this.props.hash){var e=this.props.hash;setTimeout(function(){window.location.hash=e},500)}}},{key:"render",value:function(){return this.props.isFileLoadedErr?u.default.createElement("div",{className:"message err-tip"},(0,f.gettext)("File does not exist.")):u.default.createElement(v.default,{isTOCShow:!1,isFileLoading:this.props.isFileLoading,markdownContent:this.props.content,lastModified:this.props.lastModified,latestContributor:this.props.latestContributor,onLinkClick:this.props.onLinkClick,repoID:this.props.repoID,path:this.props.path},u.default.createElement(l.Fragment,null,u.default.createElement("span",{className:"wiki-open-file position-fixed",onClick:this.onOpenFile},u.default.createElement("i",{className:"fas fa-expand-arrows-alt"})),!this.props.isDraft&&this.props.hasDraft&&u.default.createElement("div",{className:"seafile-btn-view-review text-center mt-2"},u.default.createElement("div",{className:"tag tag-green"},(0,f.gettext)("This file is in draft stage."),u.default.createElement("span",{className:"ml-2",onClick:this.goDraftPage},(0,f.gettext)("View Draft"))))))}}]),t}(u.default.Component);w.propTypes=b,t.default=w},2292:function(e,t){},2293:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function s(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=r(u),d=n(1),p=r(d),f=n(2294),h=r(f),m=n(1037),g=r(m),y=n(2),v=n(4),b=n(3),w=n(2295),E=r(w),S=n(2298),C=r(S),D=n(5),_=r(D);n(2299);var P={repoID:p.default.string.isRequired,direntList:p.default.array.isRequired,filetypes:p.default.array,chunkSize:p.default.number,withCredentials:p.default.bool,testMethod:p.default.string,testChunks:p.default.number,simultaneousUploads:p.default.number,fileParameterName:p.default.string,minFileSizeErrorCallback:p.default.func,fileTypeErrorCallback:p.default.func,dragAndDrop:p.default.bool.isRequired,path:p.default.string.isRequired,onFileUploadSuccess:p.default.func.isRequired},k=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.componentWillUnmount=function(){window.onbeforeunload=null,!0===n.props.dragAndDrop&&n.resumable.disableDropOnDocument()},n.onbeforeunload=function(){if(window.uploader&&window.uploader.isUploadProgressDialogShow&&100!==window.uploader.totalProgress)return""},n.bindCallbackHandler=function(){var e=n.props,t=e.minFileSizeErrorCallback,r=e.fileTypeErrorCallback;n.maxFilesErrorCallback&&(n.resumable.opts.maxFilesErrorCallback=n.maxFilesErrorCallback),t&&(n.resumable.opts.minFileSizeErrorCallback=n.props.minFileSizeErrorCallback),n.maxFileSizeErrorCallback&&(n.resumable.opts.maxFileSizeErrorCallback=n.maxFileSizeErrorCallback),r&&(n.resumable.opts.fileTypeErrorCallback=n.props.fileTypeErrorCallback)},n.bindEventHandler=function(){n.resumable.on("chunkingComplete",n.onChunkingComplete.bind(n)),n.resumable.on("fileAdded",n.onFileAdded.bind(n)),n.resumable.on("filesAddedComplete",n.filesAddedComplete.bind(n)),n.resumable.on("fileProgress",n.onFileProgress.bind(n)),n.resumable.on("fileSuccess",n.onFileUploadSuccess.bind(n)),n.resumable.on("progress",n.onProgress.bind(n)),n.resumable.on("complete",n.onComplete.bind(n)),n.resumable.on("pause",n.onPause.bind(n)),n.resumable.on("fileRetry",n.onFileRetry.bind(n)),n.resumable.on("fileError",n.onFileError.bind(n)),n.resumable.on("error",n.onError.bind(n)),n.resumable.on("beforeCancel",n.onBeforeCancel.bind(n)),n.resumable.on("cancel",n.onCancel.bind(n)),n.resumable.on("dragstart",n.onDragStart.bind(n))},n.maxFilesErrorCallback=function(e,t){var n=y.maxNumberOfFilesForFileupload,r=(0,y.gettext)("Please upload no more than {maxFiles} files at a time.");r=r.replace("{maxFiles}",n),_.default.danger(r)},n.maxFileSizeErrorCallback=function(e){var t=n.state.forbidUploadFileList;t.push(e),n.setState({forbidUploadFileList:t})},n.onChunkingComplete=function(e){!0===n.state.allFilesUploaded&&n.setState({allFilesUploaded:!1});var t="/"===n.props.path?"/":n.props.path+"/",r=e.fileName,a=e.relativePath,o=r===a;if(e.formData={},o)e.formData={parent_dir:t};else{var i=a.slice(0,a.lastIndexOf("/")+1);e.formData={parent_dir:t,relative_path:i}}},n.onFileAdded=function(e,t){if(e.fileName===e.relativePath&&1===t.length){for(var r=!1,a=n.props.direntList,o=0;o<a.length;o++)if("file"===a[o].type&&a[o].name===e.fileName){r=!0;break}if(r)n.setState({isUploadRemindDialogShow:!0,currentResumableFile:e});else{n.setUploadFileList(n.resumable.files);var i=n.props,s=i.repoID,l=i.path;v.seafileAPI.getFileServerUploadLink(s,l).then(function(t){n.resumable.opts.target=t.data+"?ret-json=1",n.resumableUpload(e)}).catch(function(e){var t=b.Utils.getErrorMsg(e);_.default.danger(t)})}}else if(n.setUploadFileList(n.resumable.files),!n.isUploadLinkLoaded){n.isUploadLinkLoaded=!0;var u=n.props,c=u.repoID,d=u.path;v.seafileAPI.getFileServerUploadLink(c,d).then(function(e){n.resumable.opts.target=e.data+"?ret-json=1",n.resumable.upload()}).catch(function(e){var t=b.Utils.getErrorMsg(e);_.default.danger(t)})}},n.resumableUpload=function(e){var t=n.props,r=t.repoID,a=t.path;v.seafileAPI.getFileUploadedBytes(r,a,e.fileName).then(function(t){var r=t.data.uploadedBytes,a=1024*parseInt(y.resumableUploadFileBlockSize)*1024||1048576,o=Math.floor(r/a);e.markChunksCompleted(o),n.resumable.upload()}).catch(function(e){var t=b.Utils.getErrorMsg(e);_.default.danger(t)})},n.filesAddedComplete=function(e,t){n.state.forbidUploadFileList.length>0&&0===t.length&&n.setState({isUploadProgressDialogShow:!0,totalProgress:100})},n.setUploadFileList=function(){var e=n.resumable.files;n.setState({uploadFileList:e,isUploadProgressDialogShow:!0}),b.Utils.registerGlobalVariable("uploader","isUploadProgressDialogShow",!0)},n.onFileProgress=function(e){var t=n.getBitrate(),r=n.state.uploadFileList.map(function(n){if(n.uniqueIdentifier===e.uniqueIdentifier&&t){var r=8*(n.size-n.size*n.progress()),a=Math.floor(r/t);n.remainingTime=a}return n});n.setState({uploadBitrate:t,uploadFileList:r})},n.getBitrate=function(){var e=0,t=0,r=(new Date).getTime();if(n.resumable.files.forEach(function(t){e+=t.progress()*t.size}),n.timestamp){var a=r-n.timestamp;if(a<n.bitrateInterval)return n.state.uploadBitrate;(e<n.loaded||0===n.loaded)&&(n.loaded=e),t=(e-n.loaded)*(1e3/a)*8}return n.timestamp=r,n.loaded=e,t},n.onProgress=function(){var e=Math.round(100*n.resumable.progress());n.setState({totalProgress:e}),b.Utils.registerGlobalVariable("uploader","totalProgress",e)},n.onFileUploadSuccess=function(e,t){var r=e.formData,a=(new Date).getTime()/1e3;if(t=r.replace?t:JSON.parse(t)[0],r.relative_path){var o=r.relative_path,i=o.slice(0,o.indexOf("/")),s={id:t.id,name:i,type:"dir",mtime:a};n.notifiedFolders.some(function(e){return e.name===s.name})||(n.notifiedFolders.push(s),n.props.onFileUploadSuccess(s));var l=n.state.uploadFileList.map(function(n){return n.uniqueIdentifier===e.uniqueIdentifier&&(n.newFileName=o+t.name,n.isSaved=!0),n});return void n.setState({uploadFileList:l})}if(r.replace){var u=e.fileName,c={id:t,name:u,type:"file",mtime:a};n.props.onFileUploadSuccess(c);var d=n.state.uploadFileList.map(function(t){return t.uniqueIdentifier===e.uniqueIdentifier&&(t.newFileName=u,t.isSaved=!0),t});return void n.setState({uploadFileList:d})}var p={id:t.id,type:"file",name:t.name,size:t.size,mtime:a};n.props.onFileUploadSuccess(p);var f=n.state.uploadFileList.map(function(n){return n.uniqueIdentifier===e.uniqueIdentifier&&(n.newFileName=t.name,n.isSaved=!0),n});n.setState({uploadFileList:f})},n.getFileServerErrorMessage=function(e){return{"File locked by others.":(0,y.gettext)("File locked by others."),"Invalid filename.":(0,y.gettext)("Invalid filename."),"File already exists.":(0,y.gettext)("File already exists."),"File size is too large.":(0,y.gettext)("File size is too large."),"Out of quota.":(0,y.gettext)("Out of quota."),"Internal error.":(0,y.gettext)("Internal Server Error")}[e]||e},n.onFileError=function(e,t){var r="";if(t){var a=t.replace(/\n/g,"");a=JSON.parse(a),r=n.getFileServerErrorMessage(a.error)}else r=(0,y.gettext)("Network error");var o=n.state.uploadFileList.map(function(t){return t.uniqueIdentifier===e.uniqueIdentifier&&(n.state.retryFileList.push(t),t.error=r),t});n.loaded=0,n.setState({retryFileList:n.state.retryFileList,uploadFileList:o})},n.onComplete=function(){n.notifiedFolders=[],n.isUploadLinkLoaded=!1,n.setState({allFilesUploaded:!0})},n.onPause=function(){},n.onError=function(e){n.isUploadLinkLoaded=!1,b.Utils.registerGlobalVariable("uploader","totalProgress",100)},n.onFileRetry=function(){},n.onBeforeCancel=function(){},n.onCancel=function(){},n.setHeaders=function(e,t){var n=t.offset,r=t.getOpt("chunkSize"),a=0===e.size?1:e.size,o=0!==n?n*r:0,i=Math.min(a,(n+1)*r)-1;return a-t.endByte<r&&!t.getOpt("forceChunkSize")&&(i=a),{Accept:"application/json; text/javascript, */*; q=0.01","Content-Disposition":'attachment; filename="'+encodeURI(e.fileName)+'"',"Content-Range":"bytes "+o+"-"+i+"/"+a}},n.setQuery=function(e){return e.formData},n.generateUniqueIdentifier=function(e){var t=e.webkitRelativePath||e.relativePath||e.fileName||e.name;return(0,g.default)(t+new Date)+t},n.onClick=function(e){e.nativeEvent.stopImmediatePropagation(),e.stopPropagation()},n.onFileUpload=function(){n.uploadInput.current.removeAttribute("webkitdirectory"),n.uploadInput.current.click()},n.onFolderUpload=function(){n.uploadInput.current.setAttribute("webkitdirectory","webkitdirectory"),n.uploadInput.current.click()},n.onDragStart=function(){n.uploadInput.current.setAttribute("webkitdirectory","webkitdirectory")},n.onCloseUploadDialog=function(){n.loaded=0,n.resumable.files=[],n.isUploadLinkLoaded=!1,n.setState({isUploadProgressDialogShow:!1,uploadFileList:[],forbidUploadFileList:[]}),b.Utils.registerGlobalVariable("uploader","isUploadProgressDialogShow",!1)},n.onUploadCancel=function(e){var t=n.state.uploadFileList.filter(function(t){return t.uniqueIdentifier!==e.uniqueIdentifier||(t.cancel(),!1)});n.resumable.isUploading()||(n.setState({totalProgress:"100",allFilesUploaded:!0}),n.loaded=0),n.setState({uploadFileList:t})},n.onCancelAllUploading=function(){var e=n.state.uploadFileList.filter(function(e){return!Math.round(1!==e.progress())||(e.cancel(),!1)});n.loaded=0,n.setState({allFilesUploaded:!0,totalProgress:"100",uploadFileList:e}),n.isUploadLinkLoaded=!1},n.onUploadRetry=function(e){v.seafileAPI.getFileServerUploadLink(n.props.repoID,n.props.path).then(function(t){n.resumable.opts.target=t.data+"?ret-json=1";var r=n.state.retryFileList.filter(function(t){return t.uniqueIdentifier!==e.uniqueIdentifier}),a=n.state.uploadFileList.map(function(t){return t.uniqueIdentifier===e.uniqueIdentifier&&(t.error=null,n.retryUploadFile(t)),t});n.setState({retryFileList:r,uploadFileList:a})}).catch(function(e){var t=b.Utils.getErrorMsg(e);_.default.danger(t)})},n.onUploadRetryAll=function(){v.seafileAPI.getFileServerUploadLink(n.props.repoID,n.props.path).then(function(e){n.resumable.opts.target=e.data+"?ret-json=1",n.state.retryFileList.forEach(function(e){e.error=!1,n.retryUploadFile(e)});var t=n.state.uploadFileList.slice(0);n.setState({retryFileList:[],uploadFileList:t})}).catch(function(e){var t=b.Utils.getErrorMsg(e);_.default.danger(t)})},n.retryUploadFile=function(e){var t=n.props,r=t.repoID,a=t.path,o=e.fileName;if(e.fileName!==e.relativePath){var i=e.formData.relative_path;o=("/"===a?a+i:a+"/"+i)+o}e.bootstrap();var s=!1;e.resumableObj.on("chunkingComplete",function(){s||v.seafileAPI.getFileUploadedBytes(r,a,o).then(function(t){var n=t.data.uploadedBytes,r=1024*parseInt(y.resumableUploadFileBlockSize)*1024||1048576,a=Math.floor(n/r);e.markChunksCompleted(a),e.resumableObj.upload()}).catch(function(e){var t=b.Utils.getErrorMsg(e);_.default.danger(t)}),s=!0})},n.replaceRepetitionFile=function(){var e=n.props,t=e.repoID,r=e.path;v.seafileAPI.getUpdateLink(t,r).then(function(e){n.resumable.opts.target=e.data;var t=n.resumable.files[n.resumable.files.length-1];t.formData.replace=1,t.formData.target_file=t.formData.parent_dir+t.fileName,n.setState({isUploadRemindDialogShow:!1}),n.setUploadFileList(n.resumable.files),n.resumable.upload()}).catch(function(e){var t=b.Utils.getErrorMsg(e);_.default.danger(t)})},n.uploadFile=function(){var e=n.resumable.files[n.resumable.files.length-1],t=n.props,r=t.repoID,o=t.path;v.seafileAPI.getFileServerUploadLink(r,o).then(function(t){n.resumable.opts.target=t.data+"?ret-json=1",n.setState({isUploadRemindDialogShow:!1,isUploadProgressDialogShow:!0,uploadFileList:[].concat(a(n.state.uploadFileList),[e])},function(){n.resumable.upload()}),b.Utils.registerGlobalVariable("uploader","isUploadProgressDialogShow",!0)}).catch(function(e){var t=b.Utils.getErrorMsg(e);_.default.danger(t)})},n.cancelFileUpload=function(){n.resumable.files.pop(),n.setState({isUploadRemindDialogShow:!1})},n.state={retryFileList:[],uploadFileList:[],forbidUploadFileList:[],totalProgress:0,isUploadProgressDialogShow:!1,isUploadRemindDialogShow:!1,currentResumableFile:null,uploadBitrate:0,allFilesUploaded:!1},n.uploadInput=c.default.createRef(),n.notifiedFolders=[],n.timestamp=null,n.loaded=0,n.bitrateInterval=500,window.onbeforeunload=n.onbeforeunload,n.isUploadLinkLoaded=!1,n}return s(t,e),l(t,[{key:"componentDidMount",value:function(){this.resumable=new h.default({target:"",query:this.setQuery||{},fileType:this.props.filetypes,maxFiles:y.maxNumberOfFilesForFileupload||void 0,maxFileSize:1e3*y.maxUploadFileSize*1e3||void 0,testMethod:this.props.testMethod||"post",testChunks:this.props.testChunks||!1,headers:this.setHeaders||{},withCredentials:this.props.withCredentials||!1,chunkSize:1024*parseInt(y.resumableUploadFileBlockSize)*1024||1048576,simultaneousUploads:this.props.simultaneousUploads||1,fileParameterName:this.props.fileParameterName,generateUniqueIdentifier:this.generateUniqueIdentifier,forceChunkSize:!0,maxChunkRetries:3,minFileSize:0}),this.resumable.assignBrowse(this.uploadInput.current,!0),!0===this.props.dragAndDrop&&this.resumable.enableDropOnDocument(),this.bindCallbackHandler(),this.bindEventHandler()}},{key:"render",value:function(){return c.default.createElement(u.Fragment,null,c.default.createElement("div",{className:"file-uploader-container"},c.default.createElement("div",{className:"file-uploader"},c.default.createElement("input",{className:"upload-input",type:"file",ref:this.uploadInput,onClick:this.onClick}))),this.state.isUploadRemindDialogShow&&c.default.createElement(C.default,{currentResumableFile:this.state.currentResumableFile,replaceRepetitionFile:this.replaceRepetitionFile,uploadFile:this.uploadFile,cancelFileUpload:this.cancelFileUpload}),this.state.isUploadProgressDialogShow&&c.default.createElement(E.default,{retryFileList:this.state.retryFileList,uploadFileList:this.state.uploadFileList,forbidUploadFileList:this.state.forbidUploadFileList,totalProgress:this.state.totalProgress,uploadBitrate:this.state.uploadBitrate,allFilesUploaded:this.state.allFilesUploaded,onCloseUploadDialog:this.onCloseUploadDialog,onCancelAllUploading:this.onCancelAllUploading,onUploadCancel:this.onUploadCancel,onUploadRetry:this.onUploadRetry,onUploadRetryAll:this.onUploadRetryAll}))}}]),t}(c.default.Component);k.propTypes=P,t.default=k},2294:function(e,t,n){!function(){"use strict";var t=function(e){function n(e,t,n,r){var o;return e.isFile?e.file(function(e){e.relativePath=t+e.name,n.push(e),r()}):(e.isDirectory?o=e:e instanceof File&&n.push(e),"function"===typeof e.webkitGetAsEntry&&(o=e.webkitGetAsEntry()),o&&o.isDirectory?a(o,t+o.name+"/",n,r):("function"===typeof e.getAsFile&&(e=e.getAsFile())instanceof File&&(e.relativePath=t+e.name,n.push(e)),void r()))}function r(e,t){if(!e||0===e.length)return t();e[0](function(){r(e.slice(1),t)})}function a(e,t,a,o){function i(){s.readEntries(function(e){if(e.length)return l=l.concat(e),i();r(l.map(function(e){return n.bind(null,e,t,a)}),o)})}var s=e.createReader(),l=[];i()}function o(e,t){if(e.length){l.fire("beforeAdd");var a=[];r(Array.prototype.map.call(e,function(e){var t=e;return"function"===typeof e.webkitGetAsEntry&&(t=e.webkitGetAsEntry()),n.bind(null,t,"",a)}),function(){a.length&&f(a,t)})}}function i(e,t,n){var r=this;r.opts={},r.getOpt=e.getOpt,r._prevProgress=0,r.resumableObj=e,r.file=t,r.fileName=t.fileName||t.name,r.size=t.size,r.relativePath=t.relativePath||t.webkitRelativePath||r.fileName,r.uniqueIdentifier=n,r._pause=!1,r.container="",r.preprocessState=0,r.error=null,r.remainingTime=-1,r.isSaved=!1,r.newFileName=r.fileName;var a=void 0!==n,o=function(e,t){switch(e){case"progress":r.resumableObj.fire("fileProgress",r,t);break;case"error":r.abort(),a=!0,r.chunks=[],r.resumableObj.fire("fileError",r,t);break;case"success":if(a)return;r.resumableObj.fire("fileProgress",r,t),r.isComplete()&&r.resumableObj.fire("fileSuccess",r,t);break;case"retry":r.resumableObj.fire("fileRetry",r)}};return r.chunks=[],r.abort=function(){var e=0;u.each(r.chunks,function(t){"uploading"==t.status()&&(t.abort(),e++)}),e>0&&r.resumableObj.fire("fileProgress",r)},r.cancel=function(){var e=r.chunks;r.chunks=[],u.each(e,function(e){"uploading"==e.status()&&(e.abort(),r.resumableObj.uploadNextChunk())}),r.resumableObj.removeFile(r),r.resumableObj.fire("fileProgress",r)},r.retry=function(){r.bootstrap();var e=!1;r.resumableObj.on("chunkingComplete",function(){e||r.resumableObj.upload(),e=!0})},r.bootstrap=function(){r.abort(),a=!1,r.chunks=[],r._prevProgress=0;for(var e=r.getOpt("forceChunkSize")?Math.ceil:Math.floor,t=Math.max(e(r.file.size/r.getOpt("chunkSize")),1),n=0;n<t;n++)!function(e){window.setTimeout(function(){r.chunks.push(new s(r.resumableObj,r,e,o)),r.resumableObj.fire("chunkingProgress",r,e/t)},0)}(n);window.setTimeout(function(){r.resumableObj.fire("chunkingComplete",r)},0)},r.progress=function(){if(a)return 1;var e=0,t=!1;return u.each(r.chunks,function(n){"error"==n.status()&&(t=!0),e+=n.progress(!0)}),e=t?1:e>.99999?1:e,e=Math.max(r._prevProgress,e),r._prevProgress=e,e},r.isUploading=function(){var e=!1;return u.each(r.chunks,function(t){if("uploading"==t.status())return e=!0,!1}),e},r.isComplete=function(){var e=!1;return 1!==r.preprocessState&&(u.each(r.chunks,function(t){var n=t.status();if("pending"==n||"uploading"==n||1===t.preprocessState)return e=!0,!1}),!e)},r.pause=function(e){r._pause="undefined"===typeof e?!r._pause:e},r.isPaused=function(){return r._pause},r.preprocessFinished=function(){r.preprocessState=2,r.upload()},r.upload=function(){var e=!1;if(!1===r.isPaused()){var t=r.getOpt("preprocessFile");if("function"===typeof t)switch(r.preprocessState){case 0:return r.preprocessState=1,t(r),!0;case 1:return!0}u.each(r.chunks,function(t){if("pending"==t.status()&&1!==t.preprocessState)return t.send(),e=!0,!1})}return e},r.markChunksCompleted=function(e){if(r.chunks&&!(r.chunks.length<=e))for(var t=0;t<e;t++)r.chunks[t].markComplete=!0},r.resumableObj.fire("chunkingStart",r),r.bootstrap(),this}function s(e,t,n,r){var a=this;a.opts={},a.getOpt=e.getOpt,a.resumableObj=e,a.fileObj=t,a.fileObjSize=t.size,a.fileObjType=t.file.type,a.offset=n,a.callback=r,a.lastProgressCallback=new Date,a.tested=!1,a.retries=0,a.pendingRetry=!1,a.preprocessState=0,a.markComplete=!1;var o=a.getOpt("chunkSize");return a.loaded=0,a.startByte=a.offset*o,a.endByte=Math.min(a.fileObjSize,(a.offset+1)*o),a.fileObjSize-a.endByte<o&&!a.getOpt("forceChunkSize")&&(a.endByte=a.fileObjSize),a.xhr=null,a.test=function(){a.xhr=new XMLHttpRequest;var e=function(e){a.tested=!0;var t=a.status();"success"==t?(a.callback(t,a.message()),a.resumableObj.uploadNextChunk()):a.send()};a.xhr.addEventListener("load",e,!1),a.xhr.addEventListener("error",e,!1),a.xhr.addEventListener("timeout",e,!1);var t=[],n=a.getOpt("parameterNamespace"),r=a.getOpt("query");"function"==typeof r&&(r=r(a.fileObj,a)),u.each(r,function(e,r){t.push([encodeURIComponent(n+e),encodeURIComponent(r)].join("="))}),t=t.concat([["chunkNumberParameterName",a.offset+1],["chunkSizeParameterName",a.getOpt("chunkSize")],["currentChunkSizeParameterName",a.endByte-a.startByte],["totalSizeParameterName",a.fileObjSize],["typeParameterName",a.fileObjType],["identifierParameterName",a.fileObj.uniqueIdentifier],["fileNameParameterName",a.fileObj.fileName],["relativePathParameterName",a.fileObj.relativePath],["totalChunksParameterName",a.fileObj.chunks.length]].filter(function(e){return a.getOpt(e[0])}).map(function(e){return[n+a.getOpt(e[0]),encodeURIComponent(e[1])].join("=")})),a.xhr.open(a.getOpt("testMethod"),u.getTarget("test",t)),a.xhr.timeout=a.getOpt("xhrTimeout"),a.xhr.withCredentials=a.getOpt("withCredentials");var o=a.getOpt("headers");"function"===typeof o&&(o=o(a.fileObj,a)),u.each(o,function(e,t){a.xhr.setRequestHeader(e,t)}),a.xhr.send(null)},a.preprocessFinished=function(){a.preprocessState=2,a.send()},a.send=function(){var e=a.getOpt("preprocess");if("function"===typeof e)switch(a.preprocessState){case 0:return a.preprocessState=1,void e(a);case 1:return}if(a.getOpt("testChunks")&&!a.tested)return void a.test();a.xhr=new XMLHttpRequest,a.xhr.upload.addEventListener("progress",function(e){new Date-a.lastProgressCallback>1e3*a.getOpt("throttleProgressCallbacks")&&(a.callback("progress"),a.lastProgressCallback=new Date),a.loaded=e.loaded||0},!1),a.loaded=0,a.pendingRetry=!1,a.callback("progress");var t=function(e){var t=a.status();if("success"==t||"error"==t)a.callback(t,a.message()),a.resumableObj.uploadNextChunk();else{a.callback("retry",a.message()),a.abort(),a.retries++;var n=a.getOpt("chunkRetryInterval");void 0!==n?(a.pendingRetry=!0,setTimeout(a.send,n)):a.send()}};a.xhr.addEventListener("load",t,!1),a.xhr.addEventListener("error",t,!1),a.xhr.addEventListener("timeout",t,!1);var n=[["chunkNumberParameterName",a.offset+1],["chunkSizeParameterName",a.getOpt("chunkSize")],["currentChunkSizeParameterName",a.endByte-a.startByte],["totalSizeParameterName",a.fileObjSize],["typeParameterName",a.fileObjType],["identifierParameterName",a.fileObj.uniqueIdentifier],["fileNameParameterName",a.fileObj.fileName],["relativePathParameterName",a.fileObj.relativePath],["totalChunksParameterName",a.fileObj.chunks.length]].filter(function(e){return a.getOpt(e[0])}).reduce(function(e,t){return e[a.getOpt(t[0])]=t[1],e},{}),r=a.getOpt("query");"function"==typeof r&&(r=r(a.fileObj,a)),u.each(r,function(e,t){n[e]=t});var o=a.fileObj.file.slice?"slice":a.fileObj.file.mozSlice?"mozSlice":a.fileObj.file.webkitSlice?"webkitSlice":"slice",i=a.fileObj.file[o](a.startByte,a.endByte,a.getOpt("setChunkTypeFromFile")?a.fileObj.file.type:""),s=null,l=[],c=a.getOpt("parameterNamespace");if("octet"===a.getOpt("method"))s=i,u.each(n,function(e,t){l.push([encodeURIComponent(c+e),encodeURIComponent(t)].join("="))});else if(s=new FormData,u.each(n,function(e,t){s.append(c+e,t),l.push([encodeURIComponent(c+e),encodeURIComponent(t)].join("="))}),"blob"==a.getOpt("chunkFormat"))s.append(c+a.getOpt("fileParameterName"),i,a.fileObj.fileName);else if("base64"==a.getOpt("chunkFormat")){var d=new FileReader;d.onload=function(e){s.append(c+a.getOpt("fileParameterName"),d.result),a.xhr.send(s)},d.readAsDataURL(i)}var p=u.getTarget("upload",l),f=a.getOpt("uploadMethod");"post"===f.toLowerCase()&&(p=u.getTarget("upload",[])),a.xhr.open(f,p),"octet"===a.getOpt("method")&&a.xhr.setRequestHeader("Content-Type","application/octet-stream"),a.xhr.timeout=a.getOpt("xhrTimeout"),a.xhr.withCredentials=a.getOpt("withCredentials");var h=a.getOpt("headers");"function"===typeof h&&(h=h(a.fileObj,a)),u.each(h,function(e,t){a.xhr.setRequestHeader(e,t)}),"blob"==a.getOpt("chunkFormat")&&a.xhr.send(s)},a.abort=function(){a.xhr&&a.xhr.abort(),a.xhr=null},a.status=function(){return a.pendingRetry?"uploading":a.markComplete?"success":a.xhr?a.xhr.readyState<4?"uploading":200==a.xhr.status||201==a.xhr.status?"success":u.contains(a.getOpt("permanentErrors"),a.xhr.status)||a.retries>=a.getOpt("maxChunkRetries")?"error":(a.abort(),"pending"):"pending"},a.message=function(){return a.xhr?a.xhr.responseText:""},a.progress=function(e){if("undefined"===typeof e&&(e=!1),0===a.fileObjSize)return 1;var t=e?(a.endByte-a.startByte)/a.fileObjSize:1;if(a.pendingRetry)return 0;switch(a.xhr&&a.xhr.status||a.markComplete||(t*=.95),a.status()){case"success":case"error":return 1*t;case"pending":return 0*t;default:return a.loaded/(a.endByte-a.startByte)*t}},this}if(!(this instanceof t))return new t(e);if(this.version=1,this.support="undefined"!==typeof File&&"undefined"!==typeof Blob&&"undefined"!==typeof FileList&&(!!Blob.prototype.webkitSlice||!!Blob.prototype.mozSlice||!!Blob.prototype.slice||!1),!this.support)return!1;var l=this;l.files=[],l.defaults={chunkSize:1048576,forceChunkSize:!1,simultaneousUploads:3,fileParameterName:"file",chunkNumberParameterName:"resumableChunkNumber",chunkSizeParameterName:"resumableChunkSize",currentChunkSizeParameterName:"resumableCurrentChunkSize",totalSizeParameterName:"resumableTotalSize",typeParameterName:"resumableType",identifierParameterName:"resumableIdentifier",fileNameParameterName:"resumableFilename",relativePathParameterName:"resumableRelativePath",totalChunksParameterName:"resumableTotalChunks",dragOverClass:"dragover",throttleProgressCallbacks:.5,query:{},headers:{},preprocess:null,preprocessFile:null,method:"multipart",uploadMethod:"POST",testMethod:"GET",prioritizeFirstAndLastChunk:!1,target:"/",testTarget:null,parameterNamespace:"",testChunks:!0,generateUniqueIdentifier:null,getTarget:null,maxChunkRetries:100,chunkRetryInterval:void 0,permanentErrors:[400,401,403,404,409,415,440,441,442,443,500,501],maxFiles:void 0,withCredentials:!1,xhrTimeout:0,clearInput:!0,chunkFormat:"blob",setChunkTypeFromFile:!1,maxFilesErrorCallback:function(e,t){var n=l.getOpt("maxFiles");alert("Please upload no more than "+n+" file"+(1===n?"":"s")+" at a time.")},minFileSize:1,minFileSizeErrorCallback:function(e,t){alert(e.fileName||e.name+" is too small, please upload files larger than "+u.formatSize(l.getOpt("minFileSize"))+".")},maxFileSize:void 0,maxFileSizeErrorCallback:function(e,t){alert(e.fileName||e.name+" is too large, please upload files less than "+u.formatSize(l.getOpt("maxFileSize"))+".")},fileType:[],fileTypeErrorCallback:function(e,t){alert(e.fileName||e.name+" has type not allowed, please upload files of type "+l.getOpt("fileType")+".")}},l.opts=e||{},l.getOpt=function(e){var n=this;if(e instanceof Array){var r={};return u.each(e,function(e){r[e]=n.getOpt(e)}),r}if(n instanceof s){if("undefined"!==typeof n.opts[e])return n.opts[e];n=n.fileObj}if(n instanceof i){if("undefined"!==typeof n.opts[e])return n.opts[e];n=n.resumableObj}if(n instanceof t)return"undefined"!==typeof n.opts[e]?n.opts[e]:n.defaults[e]},l.indexOf=function(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1},l.events=[],l.on=function(e,t){l.events.push(e.toLowerCase(),t)},l.fire=function(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);for(var n=e[0].toLowerCase(),t=0;t<=l.events.length;t+=2)l.events[t]==n&&l.events[t+1].apply(l,e.slice(1)),"catchall"==l.events[t]&&l.events[t+1].apply(null,e);"fileerror"==n&&l.fire("error",e[2],e[1]),"fileprogress"==n&&l.fire("progress")};var u={stopEvent:function(e){e.stopPropagation(),e.preventDefault()},each:function(e,t){if("undefined"!==typeof e.length){for(var n=0;n<e.length;n++)if(!1===t(e[n]))return}else for(n in e)if(!1===t(n,e[n]))return},generateUniqueIdentifier:function(e,t){var n=l.getOpt("generateUniqueIdentifier");if("function"===typeof n)return n(e,t);var r=e.webkitRelativePath||e.relativePath||e.fileName||e.name;return e.size+"-"+r.replace(/[^0-9a-zA-Z_-]/gim,"")},contains:function(e,t){var n=!1;return u.each(e,function(e){return e!=t||(n=!0,!1)}),n},formatSize:function(e){return e<1024?e+" bytes":e<1048576?(e/1024).toFixed(0)+" KB":e<1073741824?(e/1024/1024).toFixed(1)+" MB":(e/1024/1024/1024).toFixed(1)+" GB"},getTarget:function(e,t){var n=l.getOpt("target");if("test"===e&&l.getOpt("testTarget")&&(n="/"===l.getOpt("testTarget")?l.getOpt("target"):l.getOpt("testTarget")),"function"===typeof n)return n(t);var r=n.indexOf("?")<0?"?":"&",a=t.join("&");return a&&(n=n+r+a),n}},c=function(e){u.stopEvent(e);var t=e.dataTransfer;l.indexOf(t.types,"Files")<0||(e.dataTransfer&&e.dataTransfer.items?o(e.dataTransfer.items,e):e.dataTransfer&&e.dataTransfer.files&&o(e.dataTransfer.files,e),l.dragstart=!1)},d=function(e){},p=function(e){e.preventDefault();var t=e.dataTransfer;l.indexOf(t.types,"Files")>=0&&(e.stopPropagation(),t.dropEffect="copy",t.effectAllowed="copy",l.dragstart||(l.fire("dragstart",l),l.dragstart=!0))},f=function(e,t){var n=0,r=l.getOpt(["maxFiles","minFileSize","maxFileSize","maxFilesErrorCallback","minFileSizeErrorCallback","maxFileSizeErrorCallback","fileType","fileTypeErrorCallback"]);if("undefined"!==typeof r.maxFiles&&r.maxFiles<e.length+l.files.length){if(1!==r.maxFiles||1!==l.files.length||1!==e.length)return r.maxFilesErrorCallback(e,n++),!1;l.removeFile(l.files[0])}var a=[],o=[],s=e.length,c=function(){if(!--s){if(!a.length&&!o.length)return;window.setTimeout(function(){l.fire("filesAdded",a,o)},0)}};u.each(e,function(e){function s(n){l.getFromUniqueIdentifier(n)?o.push(e):function(){e.uniqueIdentifier=n;var r=new i(l,e,n);l.files.push(r),a.push(r),r.container="undefined"!=typeof t?t.srcElement:null,window.setTimeout(function(){l.fire("fileAdded",r,a)},0)}(),c()}var d=e.name,p=e.type;if(r.fileType.length>0){var f=!1;for(var h in r.fileType){r.fileType[h]=r.fileType[h].replace(/\s/g,"").toLowerCase();var m=(r.fileType[h].match(/^[^.][^\/]+$/)?".":"")+r.fileType[h];if(d.substr(-1*m.length).toLowerCase()===m||-1!==m.indexOf("/")&&(-1!==m.indexOf("*")&&p.substr(0,m.indexOf("*"))===m.substr(0,m.indexOf("*"))||p===m)){f=!0;break}}if(!f)return r.fileTypeErrorCallback(e,n++),!0}if("undefined"!==typeof r.minFileSize&&e.size<r.minFileSize)return r.minFileSizeErrorCallback(e,n++),!0;if("undefined"!==typeof r.maxFileSize&&e.size>r.maxFileSize)return r.maxFileSizeErrorCallback(e,n++),!0;var g=u.generateUniqueIdentifier(e,t);g&&"function"===typeof g.then?g.then(function(e){s(e)},function(){c()}):s(g)}),window.setTimeout(function(){l.fire("filesAddedComplete",l,a)},0)};return l.uploadNextChunk=function(){var e=!1;if(l.getOpt("prioritizeFirstAndLastChunk")&&(u.each(l.files,function(t){return t.chunks.length&&"pending"==t.chunks[0].status()&&0===t.chunks[0].preprocessState?(t.chunks[0].send(),e=!0,!1):t.chunks.length>1&&"pending"==t.chunks[t.chunks.length-1].status()&&0===t.chunks[t.chunks.length-1].preprocessState?(t.chunks[t.chunks.length-1].send(),e=!0,!1):void 0}),e))return!0;if(u.each(l.files,function(t){if(e=t.upload())return!1}),e)return!0;var t=!1;return u.each(l.files,function(e){if(!e.isComplete())return t=!0,!1}),t||l.fire("complete"),!1},l.assignBrowse=function(e,t){"undefined"==typeof e.length&&(e=[e]),u.each(e,function(e){var n;"INPUT"===e.tagName&&"file"===e.type?n=e:(n=document.createElement("input"),n.setAttribute("type","file"),n.style.display="none",e.addEventListener("click",function(){n.style.opacity=0,n.style.display="block",n.focus(),n.click(),n.style.display="none"},!1),e.appendChild(n));var r=l.getOpt("maxFiles");"undefined"===typeof r||1!=r?n.setAttribute("multiple","multiple"):n.removeAttribute("multiple"),t?n.setAttribute("webkitdirectory","webkitdirectory"):n.removeAttribute("webkitdirectory");var a=l.getOpt("fileType");"undefined"!==typeof a&&a.length>=1?n.setAttribute("accept",a.map(function(e){return e=e.replace(/\s/g,"").toLowerCase(),e.match(/^[^.][^\/]+$/)&&(e="."+e),e}).join(",")):n.removeAttribute("accept"),n.addEventListener("change",function(e){f(e.target.files,e),l.getOpt("clearInput")&&(e.target.value="")},!1)})},l.assignDrop=function(e){"undefined"==typeof e.length&&(e=[e]),u.each(e,function(e){e.addEventListener("dragover",p,!1),e.addEventListener("dragenter",p,!1),e.addEventListener("dragleave",d,!1),e.addEventListener("drop",c,!1)})},l.unAssignDrop=function(e){"undefined"==typeof e.length&&(e=[e]),u.each(e,function(e){e.removeEventListener("dragover",p),e.removeEventListener("dragenter",p),e.removeEventListener("dragleave",d),e.removeEventListener("drop",c)})},l.enableDropOnDocument=function(){document.addEventListener("dragover",p,!1),document.addEventListener("dragenter",p,!1),document.addEventListener("dragleave",d,!1),document.addEventListener("drop",c,!1)},l.disableDropOnDocument=function(){document.removeEventListener("dragover",p),document.removeEventListener("dragenter",p),document.removeEventListener("dragleave",d),document.removeEventListener("drop",c)},l.isUploading=function(){var e=!1;return u.each(l.files,function(t){if(t.isUploading())return e=!0,!1}),e},l.upload=function(){if(!l.isUploading()){l.fire("uploadStart");for(var e=1;e<=l.getOpt("simultaneousUploads");e++)l.uploadNextChunk()}},l.pause=function(){u.each(l.files,function(e){e.abort()}),l.fire("pause")},l.cancel=function(){l.fire("beforeCancel");for(var e=l.files.length-1;e>=0;e--)l.files[e].cancel();l.fire("cancel")},l.progress=function(){var e=0,t=0;return u.each(l.files,function(n){e+=n.progress()*n.size,t+=n.size}),t>0?e/t:0},l.addFile=function(e,t){f([e],t)},l.addFiles=function(e,t){f(e,t)},l.removeFile=function(e){for(var t=l.files.length-1;t>=0;t--)l.files[t]===e&&l.files.splice(t,1)},l.getFromUniqueIdentifier=function(e){var t=!1;return u.each(l.files,function(n){n.uniqueIdentifier==e&&(t=n)}),t},l.getSize=function(){var e=0;return u.each(l.files,function(t){e+=t.size}),e},l.handleDropEvent=function(e){c(e)},l.handleChangeEvent=function(e){f(e.target.files,e),e.target.value=""},l.updateQuery=function(e){l.opts.query=e},this};e.exports=t,e.exports.Resumable=t}()},2295:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(2),f=n(3),h=n(2296),m=r(h),g=n(2297),y=r(g),v={uploadBitrate:d.default.number.isRequired,totalProgress:d.default.number.isRequired,retryFileList:d.default.array.isRequired,uploadFileList:d.default.array.isRequired,forbidUploadFileList:d.default.array.isRequired,onCloseUploadDialog:d.default.func.isRequired,onCancelAllUploading:d.default.func.isRequired,onUploadCancel:d.default.func.isRequired,onUploadRetry:d.default.func.isRequired,onUploadRetryAll:d.default.func.isRequired,allFilesUploaded:d.default.bool.isRequired},b=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onCancelAllUploading=function(){n.props.onCancelAllUploading()},n.onMinimizeUpload=function(e){e.nativeEvent.stopImmediatePropagation(),n.setState({isMinimized:!n.state.isMinimized})},n.onCloseUpload=function(e){e.nativeEvent.stopImmediatePropagation(),n.props.onCloseUploadDialog()},n.state={isMinimized:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this,t=f.Utils.formatBitRate(this.props.uploadBitrate),n=(0,p.gettext)("File Upload"),r=(0,p.gettext)("File Uploading...")+" "+this.props.totalProgress+"% ("+t+")",a=u.default.createElement("span",{className:"sf2-icon-minus",onClick:this.onMinimizeUpload}),o=u.default.createElement(l.Fragment,null,u.default.createElement("span",{className:"sf2-icon-minus",onClick:this.onMinimizeUpload}),u.default.createElement("span",{className:"sf2-icon-x1",onClick:this.onCloseUpload})),i=this.props,s=i.totalProgress,c=i.allFilesUploaded,d=i.retryFileList;return u.default.createElement("div",{className:"uploader-list-view",style:{height:this.state.isMinimized?"2.25rem":"20rem"}},u.default.createElement("div",{className:"uploader-list-header"},u.default.createElement("div",{className:"title"},100===s?n:r),u.default.createElement("div",{className:"uploader-options"},100===s||c?o:a)),u.default.createElement("div",{className:"uploader-list-content"},u.default.createElement("table",{className:"table-thead-hidden"},u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:"35%"},(0,p.gettext)("name")),u.default.createElement("th",{width:"15%"},(0,p.gettext)("size")),u.default.createElement("th",{width:"35%"},(0,p.gettext)("progress")),u.default.createElement("th",{width:"15%"},(0,p.gettext)("state")))),u.default.createElement("tbody",null,u.default.createElement("tr",null,u.default.createElement("td",{className:"text-right",colSpan:3},d.length>0?u.default.createElement("span",{className:"cursor-pointer",onClick:this.props.onUploadRetryAll},(0,p.gettext)("Retry All")):u.default.createElement("span",{className:"cursor-pointer disabled-link"},(0,p.gettext)("Retry All"))),u.default.createElement("td",{className:"text-right",colSpan:1},c?u.default.createElement("span",{className:"cursor-pointer disabled-link"},(0,p.gettext)("Cancel All")):u.default.createElement("span",{className:"cursor-pointer",onClick:this.onCancelAllUploading},(0,p.gettext)("Cancel All")))),this.props.forbidUploadFileList.map(function(e,t){return u.default.createElement(y.default,{key:t,file:e})}),this.props.uploadFileList.map(function(t,n){return u.default.createElement(m.default,{key:n,resumableFile:t,onUploadCancel:e.props.onUploadCancel,onUploadRetry:e.props.onUploadRetry})})))))}}]),t}(u.default.Component);b.propTypes=v,t.default=b},2296:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(2),f=n(3),h={resumableFile:d.default.object.isRequired,onUploadCancel:d.default.func.isRequired,onUploadRetry:d.default.func.isRequired},m="uploading",g=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onUploadCancel=function(e){e.preventDefault(),n.props.onUploadCancel(n.props.resumableFile)},n.onUploadRetry=function(e){e.preventDefault(),n.props.onUploadRetry(n.props.resumableFile)},n.formatFileSize=function(e){return"number"!==typeof e?"":e>=1e9?(e/1e9).toFixed(1)+" G":e>=1e6?(e/1e6).toFixed(1)+" M":e>=1e3?(e/1e3).toFixed(1)+" K":e.toFixed(1)+" B"},n.state={uploadState:m},n}return i(t,e),s(t,[{key:"componentWillReceiveProps",value:function(e){var t=e.resumableFile,n=m;t.error?n="error":(0!==t.remainingTime||t.isSaved||(n="isSaving"),t.isSaved&&(n="uploaded")),this.setState({uploadState:n})}},{key:"render",value:function(){var e=this.props.resumableFile,t=Math.round(100*e.progress()),n=e.error;return u.default.createElement("tr",{className:"file-upload-item"},u.default.createElement("td",{className:"upload-name"},u.default.createElement("div",{className:"ellipsis"},e.newFileName)),u.default.createElement("td",null,u.default.createElement("span",{className:"file-size"},this.formatFileSize(e.size))),u.default.createElement("td",{className:"upload-progress"},(this.state.uploadState===m||"isSaving"===this.state.uploadState)&&u.default.createElement(l.Fragment,null,e.size>=1e8&&u.default.createElement(l.Fragment,null,e.isUploading()&&u.default.createElement("div",{className:"progress-container"},u.default.createElement("div",{className:"progress"},u.default.createElement("div",{className:"progress-bar",role:"progressbar",style:{width:t+"%"},"aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"100"})),-1===e.remainingTime&&u.default.createElement("div",{className:"progress-text"},(0,p.gettext)("Preparing to upload...")),e.remainingTime>0&&u.default.createElement("div",{className:"progress-text"},(0,p.gettext)("Remaining")," ",f.Utils.formatTime(e.remainingTime)),0===e.remainingTime&&u.default.createElement("div",{className:"progress-text"},(0,p.gettext)("Indexing..."))),!e.isUploading()&&u.default.createElement("div",{className:"progress-container d-flex align-items-center"},u.default.createElement("div",{className:"progress"},u.default.createElement("div",{className:"progress-bar",role:"progressbar",style:{width:t+"%"},"aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"100"})))),e.size<1e8&&u.default.createElement("div",{className:"progress-container d-flex align-items-center"},u.default.createElement("div",{className:"progress"},u.default.createElement("div",{className:"progress-bar",role:"progressbar",style:{width:t+"%"},"aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"100"})))),"error"===this.state.uploadState&&u.default.createElement("div",{className:"message err-message ml-0",dangerouslySetInnerHTML:{__html:n}})),u.default.createElement("td",{className:"upload-operation"},u.default.createElement(l.Fragment,null,this.state.uploadState===m&&u.default.createElement("a",{href:"#",onClick:this.onUploadCancel},(0,p.gettext)("Cancel")),"error"===this.state.uploadState&&u.default.createElement("a",{href:"#",onClick:this.onUploadRetry},(0,p.gettext)("Retry")),"isSaving"===this.state.uploadState&&u.default.createElement("span",{className:"saving"},(0,p.gettext)("Saving...")),"uploaded"===this.state.uploadState&&u.default.createElement("span",{className:"uploaded"},(0,p.gettext)("Uploaded")))))}}]),t}(u.default.Component);g.propTypes=h,t.default=g},2297:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(2),f={file:d.default.object},h=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.file,t=(0,p.gettext)("Please upload files less than {placeholder}M").replace("{placeholder}",p.maxUploadFileSize);return u.default.createElement("tr",{className:"file-upload-item"},u.default.createElement("td",{className:"upload-name"},u.default.createElement("div",{className:"ellipsis"},e.name)),u.default.createElement("td",{colSpan:3,className:"error"},t))}}]),t}(u.default.Component);h.propTypes=f,t.default=h},2298:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(2),f=n(6),h={currentResumableFile:d.default.object.isRequired,replaceRepetitionFile:d.default.func.isRequired,uploadFile:d.default.func.isRequired,cancelFileUpload:d.default.func.isRequired},m=function(e){function t(){var e,n,r,i;a(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=r=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),r.toggle=function(e){e.nativeEvent.stopImmediatePropagation(),r.props.cancelFileUpload()},r.replaceRepetitionFile=function(e){e.nativeEvent.stopImmediatePropagation(),r.props.replaceRepetitionFile()},r.uploadFile=function(e){e.nativeEvent.stopImmediatePropagation(),r.props.uploadFile()},i=n,o(r,i)}return i(t,e),s(t,[{key:"render",value:function(){var e=(0,p.gettext)("Replace file {filename}?");return e=e.replace("{filename}",'<span class="a-simaulte">'+this.props.currentResumableFile.fileName+"</span>"),u.default.createElement(f.Modal,{isOpen:!0,toggle:this.toggle},u.default.createElement(f.ModalHeader,{toggle:this.toggle},u.default.createElement("div",{dangerouslySetInnerHTML:{__html:e}})),u.default.createElement(f.ModalBody,null,u.default.createElement("p",null,(0,p.gettext)("A file with the same name already exists in this folder.")),u.default.createElement("p",null,(0,p.gettext)("Replacing it will overwrite its content."))),u.default.createElement(f.ModalFooter,null,u.default.createElement(f.Button,{color:"primary",onClick:this.replaceRepetitionFile},(0,p.gettext)("Replace")),u.default.createElement(f.Button,{color:"primary",onClick:this.uploadFile},(0,p.gettext)("Don't replace")),u.default.createElement(f.Button,{color:"secondary",onClick:this.toggle},(0,p.gettext)("Cancel"))))}}]),t}(u.default.Component);m.propTypes=h,t.default=m},2299:function(e,t){},23:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function l(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n(0),p=r(d),f=n(11),h=n(1),m=r(h),g=n(24),y=r(g),v=(0,f.css)({maxWidth:560,margin:"0 auto",top:0,left:0,right:0,position:"fixed",zIndex:999999}),b=function(e){return Object.hasOwnProperty.call(e,"id")},w=function(e){function t(e,n){i(this,t);var r=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.getToasts=function(){return r.state.toasts},r.closeAll=function(){r.getToasts().forEach(function(e){return e.close()})},r.notify=function(e,t){if(b(t)){var n=!0,a=!1,i=void 0;try{for(var s,l=r.state.toasts[Symbol.iterator]();!(n=(s=l.next()).done);n=!0){var u=s.value;String(u.id).startsWith(t.id)&&r.closeToast(u.id)}}catch(e){a=!0,i=e}finally{try{!n&&l.return&&l.return()}finally{if(a)throw i}}}var c=r.createToastInstance(e,t);return r.setState(function(e){return{toasts:[c].concat(o(e.toasts))}}),c},r.createToastInstance=function(e,n){var a=++t.idCounter,o=b(n)?n.id+"-"+a:a;return{id:o,title:e,description:n.description,hasCloseButton:n.hasCloseButton||!0,duration:n.duration||2,close:function(){return r.closeToast(o)},intent:n.intent}},r.closeToast=function(e){r.setState(function(t){return{toasts:t.toasts.map(function(t){return t.id===e?u({},t,{isShown:!1}):t})}})},r.removeToast=function(e){r.setState(function(t){return{toasts:t.toasts.filter(function(t){return t.id!==e})}})},e.bindNotify(r.notify),e.bindGetToasts(r.getToasts),e.bindCloseAll(r.closeAll),r.state={toasts:[]},r}return l(t,e),c(t,[{key:"render",value:function(){var e=this;return p.default.createElement("span",{className:v},this.state.toasts.map(function(t){var n=t.id,r=t.description,o=a(t,["id","description"]);return p.default.createElement(y.default,u({key:n,onRemove:function(){return e.removeToast(n)}},o),r)}))}}]),t}(p.default.PureComponent);w.propTypes={bindNotify:m.default.func.isRequired,bindGetToasts:m.default.func.isRequired,bindCloseAll:m.default.func.isRequired},w.idCounter=0,t.default=w},2300:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(2),h={type:d.default.oneOf(["move","copy"]).isRequired,asyncOperatedFilesLength:d.default.number.isRequired,asyncOperationProgress:d.default.oneOfType([d.default.string,d.default.number]).isRequired,toggleDialog:d.default.func.isRequired},m=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=e.type,n=e.asyncOperationProgress,r=e.asyncOperatedFilesLength,a="move"===t?(0,f.gettext)("Move {num} items"):(0,f.gettext)("Copy {num} items");a=a.replace("{num}",r);var o={width:n+"%",lineHeight:"40px",textAlign:"left"};return u.default.createElement(p.Modal,{isOpen:!0},u.default.createElement(p.ModalHeader,{toggle:this.props.toggleDialog},a),u.default.createElement(p.ModalBody,{style:{minHeight:"80px"}},u.default.createElement("div",{className:"progress",style:{height:"40px"}},u.default.createElement("div",{className:"progress-bar pl-2",role:"progressbar",style:o,"aria-valuenow":n,"aria-valuemin":"0","aria-valuemax":"100"},n+"%"))))}}]),t}(u.default.Component);m.propTypes=h,t.default=m},2301:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(6),d=n(1),p=r(d),f=n(47),h=r(f),m=n(2),g=n(15),y=n(4),v=n(3),b=n(8),w=r(b),E=n(39),S=r(E),C=n(13),D=r(C),_=n(1022),P=r(_),k=n(387),M=r(k),O=n(5),L=r(O),I=n(78),T=r(I),R=n(1023),N=r(R),x=n(2302),F=(r(x),n(2303)),Y=r(F),Z=n(2304),j=r(Z),A=n(2305),B=r(A),X=n(2307),J=r(X),U=n(2308),H=r(U),G=n(2310),q=r(G),Q=n(1025),W=r(Q),K=n(848),z=r(K),V=n(736),$=r(V);n(2311);var ee={onShowSidePanel:p.default.func.isRequired,onSearchedClick:p.default.func.isRequired,onGroupChanged:p.default.func.isRequired,onTabNavClick:p.default.func.isRequired,groupID:p.default.string},te=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.loadGroup=function(e){y.seafileAPI.getGroup(e).then(function(e){var t=new P.default(e.data),r=n.getEmptyTip(t),a=t.admins.indexOf(m.username)>-1,o=t.owner===m.username,i=0!==t.parent_group_id;n.setState({emptyTip:r,currentGroup:t,isStaff:a,isDepartmentGroup:i,isOwner:o,currentPage:1,repoList:[]},function(){n.loadRepos(n.state.currentPage)})}).catch(function(e){n.setState({isLoading:!1,errMessage:v.Utils.getErrorMsg(e,!0)})})},n.loadRepos=function(e){var t=n.state.perPage;y.seafileAPI.listGroupRepos(n.props.groupID,e,t).then(function(r){var a=!0;r.data.length<t&&(a=!1);var o=n.state.repoList,i=r.data.map(function(e){return new M.default(e)});i.length&&(o=o.concat(i)),n.setState({isLoading:!1,isLoadingMore:!1,currentPage:e,hasNextPage:a,repoList:v.Utils.sortRepos(o,n.state.sortBy,n.state.sortOrder)})}).catch(function(e){n.setState({isLoading:!1,isLoadingMore:!1,errMessage:v.Utils.getErrorMsg(e,!0)})})},n.getEmptyTip=function(e){var t=null;return e&&(t=0===e.parent_group_id?u.default.createElement(S.default,null,u.default.createElement("h2",null,(0,m.gettext)("No libraries shared with this group")),u.default.createElement("p",null,(0,m.gettext)('No libraries have been shared with this group yet. A library shared with a group can be accessed by all group members. You can share a library with a group in "My Libraries". You can also create a new library to be shared with this group by clicking the "New Library" button in the menu bar.'))):-1==e.admins.indexOf(m.username)?u.default.createElement(S.default,null,u.default.createElement("h2",null,(0,m.gettext)("No libraries"))):u.default.createElement(S.default,null,u.default.createElement("h2",null,(0,m.gettext)("No libraries")),u.default.createElement("p",null,(0,m.gettext)('You can create libraries by clicking the "New Library" button above.')))),t},n.onCreateRepoToggle=function(){n.setState({isCreateRepoDialogShow:!n.state.isCreateRepoDialogShow})},n.onCreateRepo=function(e,t){var r=n.props.groupID;t&&"department"===t?y.seafileAPI.createGroupOwnedLibrary(r,e).then(function(e){var t={repo_id:e.data.id,repo_name:e.data.name,owner_name:e.data.group_name,owner_email:e.data.owner,permission:e.data.permission,mtime:e.data.mtime,size:e.data.size,encrypted:e.data.encrypted},r=new M.default(t),a=n.addRepoItem(r);n.setState({repoList:a})}).catch(function(e){var t=v.Utils.getErrorMsg(e);L.default.danger(t)}):y.seafileAPI.createGroupRepo(r,e).then(function(e){var t=new M.default(e.data),r=n.addRepoItem(t);n.setState({repoList:r})}).catch(function(e){var t=v.Utils.getErrorMsg(e);L.default.danger(t)}),n.onCreateRepoToggle()},n.onItemDelete=function(e){var t=n.props.groupID,r=n.state.repoList.filter(function(t){return t.repo_id!==e.repo_id});n.setState({repoList:r}),n.loadGroup(t)},n.addRepoItem=function(e){var t=n.state.repoList.map(function(e){return e});return t.unshift(e),t},n.onItemUnshare=function(e){var t=n.state.currentGroup;y.seafileAPI.unshareRepoToGroup(e.repo_id,t.id).then(function(){var r=n.state.repoList.filter(function(t){return t.repo_id!==e.repo_id});n.setState({repoList:r}),n.loadGroup(t.id)}).catch(function(e){var t=v.Utils.getErrorMsg(e);L.default.danger(t)})},n.onItemRename=function(e,t){y.seafileAPI.renameGroupOwnedLibrary(n.props.groupID,e.repo_id,t).then(function(r){var a=n.state.repoList.map(function(n){return n.repo_id===e.repo_id&&(n.repo_name=t),n});n.setState({repoList:a})}).catch(function(e){var t=v.Utils.getErrorMsg(e);L.default.danger(t)})},n.onTabNavClick=function(e){n.props.onTabNavClick(e)},n.toggleGroupDropdown=function(){n.setState({showGroupDropdown:!n.state.showGroupDropdown})},n.toggleDismissGroupDialog=function(){n.setState({showDismissGroupDialog:!n.state.showDismissGroupDialog,showGroupDropdown:!1})},n.toggleRenameGroupDialog=function(){n.setState({showRenameGroupDialog:!n.state.showRenameGroupDialog,showGroupDropdown:!1})},n.toggleTransferGroupDialog=function(){n.setState({showTransferGroupDialog:!n.state.showTransferGroupDialog,showGroupDropdown:!1})},n.toggleImportMembersDialog=function(){n.setState({showImportMembersDialog:!n.state.showImportMembersDialog})},n.importMembersInBatch=function(e){L.default.notify((0,m.gettext)("It may take some time, please wait.")),y.seafileAPI.importGroupMembersViaFile(n.state.currentGroup.id,e).then(function(e){e.data.failed.map(function(e){var t=e.email+": "+e.error_msg;L.default.danger(t)})}).catch(function(e){var t=v.Utils.getErrorMsg(e);L.default.danger(t)})},n.toggleManageMembersDialog=function(){n.setState({showManageMembersDialog:!n.state.showManageMembersDialog,showGroupDropdown:!1})},n.toggleLeaveGroupDialog=function(){n.setState({isLeaveGroupDialogOpen:!n.state.isLeaveGroupDialogOpen,showGroupDropdown:!1})},n.listGroupMembers=function(){y.seafileAPI.listGroupMembers(n.props.groupID).then(function(e){n.setState({groupMembers:e.data})}).catch(function(e){var t=v.Utils.getErrorMsg(e);L.default.danger(t)})},n.toggleGroupMembersPopover=function(e){"open"===e?(n.listGroupMembers(),n.setState({showGroupMembersPopover:!0})):n.setState({showGroupMembersPopover:!1})},n.onItemDetails=function(e){n.setState({isShowDetails:!0,currentRepo:e})},n.closeDetails=function(){n.setState({isShowDetails:!1})},n.sortItems=function(e,t){h.default.save("seafile-repo-dir-sort-by",e),h.default.save("seafile-repo-dir-sort-order",t),n.setState({sortBy:e,sortOrder:t,repoList:v.Utils.sortRepos(n.state.repoList,e,t)})},n.translateRole=function(e){return"Admin"===e?(0,m.gettext)("Admin"):"Member"===e?(0,m.gettext)("Member"):"Owner"===e?(0,m.gettext)("Owner"):void 0},n.toggleSortOptionsDialog=function(){n.setState({isSortOptionsDialogOpen:!n.state.isSortOptionsDialogOpen})},n.handleScroll=function(e){var t=n.state,r=t.currentPage,a=t.hasNextPage,o=t.isLoadingMore;if(a&&!o){var i=e.target.clientHeight,s=e.target.scrollHeight;i+e.target.scrollTop+1>=s&&n.setState({isLoadingMore:!0},function(){n.loadRepos(r+1)})}},n.state={isLoading:!0,isLoadingMore:!1,errMessage:"",emptyTip:null,currentGroup:null,currentRepo:null,isStaff:!1,isOwner:!1,sortBy:h.default.load("seafile-repo-dir-sort-by")||"name",sortOrder:h.default.load("seafile-repo-dir-sort-order")||"asc",isSortOptionsDialogOpen:!1,repoList:[],currentPage:1,perPage:50,hasNextPage:!1,libraryType:"group",isCreateRepoDialogShow:!1,isDepartmentGroup:!1,showGroupDropdown:!1,showGroupMembersPopover:!1,showRenameGroupDialog:!1,showDismissGroupDialog:!1,showTransferGroupDialog:!1,showImportMembersDialog:!1,showManageMembersDialog:!1,groupMembers:[],isShowDetails:!1,isLeaveGroupDialogOpen:!1},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this.props.groupID;this.loadGroup(e)}},{key:"componentWillReceiveProps",value:function(e){e.groupID!==this.props.groupID&&this.loadGroup(e.groupID)}},{key:"render",value:function(){var e=this,t=this.state,n=t.errMessage,r=t.emptyTip,a=t.currentGroup,o=t.isDepartmentGroup,i=t.isStaff,s=!1;a&&(0===a.parent_group_id?s=!0:a.admins.indexOf(m.username)>-1&&(s=!0));var d=0;return o&&a.group_quota&&(d=a.group_quota_usage/a.group_quota*100+"%"),u.default.createElement(l.Fragment,null,u.default.createElement("div",{className:"main-panel-north border-left-show"},u.default.createElement("div",{className:"cur-view-toolbar"},u.default.createElement("span",{className:"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none",title:"Side Nav Menu",onClick:this.props.onShowSidePanel}),u.default.createElement("div",{className:"operation"},(!o&&m.canAddRepo||o&&i)&&(v.Utils.isDesktop()?u.default.createElement("button",{className:"btn btn-secondary operation-item",title:(0,m.gettext)("New Library"),onClick:this.onCreateRepoToggle},u.default.createElement("i",{className:"fas fa-plus-square text-secondary mr-1"}),(0,m.gettext)("New Library")):u.default.createElement("span",{className:"sf2-icon-plus mobile-toolbar-icon",title:(0,m.gettext)("New Library"),onClick:this.onCreateRepoToggle})))),u.default.createElement(T.default,{onSearchedClick:this.props.onSearchedClick})),u.default.createElement("div",{className:"main-panel-center flex-row"},u.default.createElement("div",{className:"cur-view-container"},u.default.createElement("div",{className:"cur-view-path"},a&&u.default.createElement(l.Fragment,null,u.default.createElement("div",{className:"path-container"},u.default.createElement(g.Link,{to:m.siteRoot+"groups/",onClick:function(){return e.onTabNavClick("groups")}},(0,m.gettext)("Groups")),u.default.createElement("span",{className:"path-split"},"/"),u.default.createElement("span",null,a.name),o&&u.default.createElement(l.Fragment,null,u.default.createElement("span",{className:"department-group-icon fas fa-building",title:(0,m.gettext)("This is a special group representing a department.")}),a.group_quota>0&&u.default.createElement("span",{className:"department-usage-container"},u.default.createElement("div",{className:"department-usage"},u.default.createElement("span",{id:"quota-bar",className:"department-quota-bar"},u.default.createElement("span",{id:"quota-usage",className:"usage",style:{width:d}})),u.default.createElement("span",{className:"department-quota-info"},v.Utils.bytesToSize(a.group_quota_usage)," / ",v.Utils.bytesToSize(a.group_quota)))))),u.default.createElement("div",{className:"path-tool"},s&&u.default.createElement(u.default.Fragment,null,u.default.createElement("a",{href:"#",className:"sf2-icon-cog1 action-icon group-top-action-icon",title:"Settings",id:"settings",onClick:this.toggleGroupDropdown}),u.default.createElement(c.Popover,{placement:"bottom",isOpen:this.state.showGroupDropdown,target:"settings",toggle:this.toggleGroupDropdown,hideArrow:!0,className:"sf-popover"},u.default.createElement("div",{className:"sf-popover-hd sf-popover-title"},u.default.createElement("span",null,(0,m.gettext)("Settings")),u.default.createElement("a",{href:"#",className:"sf-popover-close js-close sf2-icon-x1 action-icon",onClick:this.toggleGroupDropdown})),u.default.createElement("div",{className:"sf-popover-con"},(this.state.isStaff||this.state.isOwner)&&u.default.createElement("ul",{className:"sf-popover-list"},u.default.createElement("li",null,u.default.createElement("a",{href:"#",className:"sf-popover-item",onClick:this.toggleRenameGroupDialog},(0,m.gettext)("Rename"))),this.state.isOwner&&u.default.createElement("li",null,u.default.createElement("a",{href:"#",className:"sf-popover-item",onClick:this.toggleTransferGroupDialog},(0,m.gettext)("Transfer")))),(this.state.isStaff||this.state.isOwner)&&u.default.createElement("ul",{className:"sf-popover-list"},u.default.createElement("li",null,u.default.createElement("a",{href:"#",className:"sf-popover-item",onClick:this.toggleImportMembersDialog},(0,m.gettext)("Import Members"))),u.default.createElement("li",null,u.default.createElement("a",{href:"#",className:"sf-popover-item",onClick:this.toggleManageMembersDialog},(0,m.gettext)("Manage Members")))),this.state.isOwner&&u.default.createElement("ul",{className:"sf-popover-list"},u.default.createElement("li",null,u.default.createElement("a",{href:"#",className:"sf-popover-item",onClick:this.toggleDismissGroupDialog},(0,m.gettext)("Delete Group")))),!this.state.isOwner&&!this.state.isStaff&&!o&&u.default.createElement("ul",{className:"sf-popover-list"},u.default.createElement("li",null,u.default.createElement("a",{href:"#",className:"sf-popover-item",onClick:this.toggleLeaveGroupDialog},(0,m.gettext)("Leave Group"))))))),u.default.createElement("a",{href:"#",className:"sf2-icon-user2 action-icon group-top-action-icon",title:(0,m.gettext)("Members"),id:"groupMembers",onClick:function(){return e.toggleGroupMembersPopover("open")}}),u.default.createElement(c.Popover,{placement:"bottom",isOpen:this.state.showGroupMembersPopover,target:"groupMembers",toggle:this.toggleGroupMembersPopover,hideArrow:!0,className:"sf-popover"},u.default.createElement("div",{className:"sf-popover-hd sf-popover-title group-member-list-header"},u.default.createElement("span",null,(0,m.gettext)("Members")),u.default.createElement("a",{href:"#",className:"sf-popover-close js-close sf2-icon-x1 action-icon",onClick:this.toggleGroupMembersPopover})),u.default.createElement("div",{className:"sf-popover-con"},u.default.createElement("ul",{className:"sf-popover-list group-member-list"},this.state.groupMembers.map(function(t,n){return u.default.createElement("li",{key:n},u.default.createElement("a",{href:"#",className:"sf-popover-item user-item d-flex"},u.default.createElement("img",{src:t.avatar_url,alt:"",className:"group-member-avatar avatar"}),u.default.createElement("span",{className:"txt-item ellipsis d-flex"},u.default.createElement("span",{className:"group-member-name ellipsis"},t.name),u.default.createElement("span",{className:"group-member-admin"},e.translateRole(t.role)))))})))),!v.Utils.isDesktop()&&this.state.repoList.length>0&&u.default.createElement("span",{className:"sf3-font sf3-font-sort action-icon",onClick:this.toggleSortOptionsDialog}),this.state.isSortOptionsDialogOpen&&u.default.createElement($.default,{toggleDialog:this.toggleSortOptionsDialog,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems})))),u.default.createElement("div",{className:"cur-view-content d-block",onScroll:this.handleScroll},this.state.isLoading&&u.default.createElement(w.default,null),!this.state.isLoading&&n&&u.default.createElement("div",{className:"error text-center mt-2"},n),!this.state.isLoading&&0===this.state.repoList.length&&r,!this.state.isLoading&&this.state.repoList.length>0&&u.default.createElement(W.default,{repoList:this.state.repoList,hasNextPage:this.state.hasNextPage,currentGroup:this.state.currentGroup,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems,onItemUnshare:this.onItemUnshare,onItemDelete:this.onItemDelete,onItemDetails:this.onItemDetails,onItemRename:this.onItemRename}))),this.state.isShowDetails&&u.default.createElement("div",{className:"cur-view-detail"},u.default.createElement(z.default,{currentRepo:this.state.currentRepo,closeDetails:this.closeDetails}))),this.state.isCreateRepoDialogShow&&!this.state.isDepartmentGroup&&u.default.createElement(D.default,null,u.default.createElement(N.default,{libraryType:this.state.libraryType,onCreateToggle:this.onCreateRepoToggle,onCreateRepo:this.onCreateRepo})),this.state.isCreateRepoDialogShow&&this.state.isDepartmentGroup&&u.default.createElement(N.default,{isAdmin:this.state.isAdmin,onCreateToggle:this.onCreateRepoToggle,onCreateRepo:this.onCreateRepo,libraryType:"department"}),this.state.showRenameGroupDialog&&u.default.createElement(j.default,{showRenameGroupDialog:this.state.showRenameGroupDialog,toggleRenameGroupDialog:this.toggleRenameGroupDialog,loadGroup:this.loadGroup,groupID:this.props.groupID,onGroupChanged:this.props.onGroupChanged,currentGroupName:a.name}),this.state.showDismissGroupDialog&&u.default.createElement(Y.default,{showDismissGroupDialog:this.state.showDismissGroupDialog,toggleDismissGroupDialog:this.toggleDismissGroupDialog,loadGroup:this.loadGroup,groupID:this.props.groupID,onGroupChanged:this.props.onGroupChanged}),this.state.showTransferGroupDialog&&u.default.createElement(B.default,{toggleTransferGroupDialog:this.toggleTransferGroupDialog,groupID:this.props.groupID,onGroupChanged:this.props.onGroupChanged}),this.state.showImportMembersDialog&&u.default.createElement(J.default,{toggleImportMembersDialog:this.toggleImportMembersDialog,importMembersInBatch:this.importMembersInBatch}),this.state.showManageMembersDialog&&u.default.createElement(H.default,{toggleManageMembersDialog:this.toggleManageMembersDialog,groupID:this.props.groupID,onGroupChanged:this.props.onGroupChanged,isOwner:this.state.isOwner}),this.state.isLeaveGroupDialogOpen&&u.default.createElement(q.default,{toggleLeaveGroupDialog:this.toggleLeaveGroupDialog,groupID:this.props.groupID,onGroupChanged:this.props.onGroupChanged}))}}]),t}(u.default.Component);te.propTypes=ee,t.default=te},2302:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(2),h={onCreateRepo:d.default.func.isRequired,onCreateToggle:d.default.func.isRequired},m=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleChange=function(e){e.target.value.trim()?n.setState({isSubmitBtnActive:!0}):n.setState({isSubmitBtnActive:!1}),n.setState({repoName:e.target.value})},n.handleSubmit=function(){if(n.validateRepoName()){var e=n.createRepo(n.state.repoName);n.props.onCreateRepo(e,"department")}},n.handleKeyPress=function(e){"Enter"===e.key&&(n.handleSubmit(),e.preventDefault())},n.toggle=function(){n.props.onCreateToggle()},n.componentDidMount=function(){n.newInput.focus()},n.validateRepoName=function(){var e="",t=n.state.repoName.trim();return t.length?!(t.indexOf("/")>-1)||(e=(0,f.gettext)("Name should not include '/'."),n.setState({errMessage:e}),!1):(e=(0,f.gettext)("Name is required"),n.setState({errMessage:e}),!1)},n.createRepo=function(e){return{repo_name:e}},n.state={repoName:"",errMessage:"",isSubmitBtnActive:!1},n.newInput=u.default.createRef(),n}return i(t,e),s(t,[{key:"render",value:function(){var e=this;return u.default.createElement(p.Modal,{isOpen:!0,toggle:this.toggle},u.default.createElement(p.ModalHeader,{toggle:this.toggle},(0,f.gettext)("New Department Library")),u.default.createElement(p.ModalBody,null,u.default.createElement(p.Form,null,u.default.createElement(p.FormGroup,null,u.default.createElement(p.Label,{for:"repo-name"},(0,f.gettext)("Name")),u.default.createElement(p.Input,{id:"repo-name",onKeyPress:this.handleKeyPress,innerRef:function(t){e.newInput=t},value:this.state.repoName,onChange:this.handleChange,maxLength:f.maxFileName}))),this.state.errMessage&&u.default.createElement(p.Alert,{color:"danger"},this.state.errMessage)),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive},(0,f.gettext)("Submit"))))}}]),t}(u.default.Component);m.propTypes=h,t.default=m},2303:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(2),h=n(4),m=n(3),g=n(5),y=r(g),v=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.dismissGroup=function(){var e=n;h.seafileAPI.deleteGroup(n.props.groupID).then(function(t){e.props.onGroupChanged()}).catch(function(e){var t=m.Utils.getErrorMsg(e);y.default.danger(t)})},n}return i(t,e),s(t,[{key:"render",value:function(){return u.default.createElement(p.Modal,{isOpen:this.props.showDismissGroupDialog,toggle:this.props.toggleDismissGroupDialog},u.default.createElement(p.ModalHeader,null,(0,f.gettext)("Delete Group")),u.default.createElement(p.ModalBody,null,u.default.createElement("span",null,(0,f.gettext)("Really want to delete this group?"))),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{color:"secondary",onClick:this.props.toggleDismissGroupDialog},(0,f.gettext)("Cancel")),u.default.createElement(p.Button,{color:"primary",onClick:this.dismissGroup},(0,f.gettext)("Delete"))))}}]),t}(u.default.Component),b={showDismissGroupDialog:d.default.bool.isRequired,toggleDismissGroupDialog:d.default.func.isRequired,loadGroup:d.default.func.isRequired,groupID:d.default.string.isRequired,onGroupChanged:d.default.func.isRequired};v.propTypes=b,t.default=v},2304:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(2),f=n(4),h=n(6),m=n(3),g=r(m),y=n(5),v=r(y),b=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleGroupNameChange=function(e){e.target.value.trim()?n.setState({isSubmitBtnActive:!0}):n.setState({isSubmitBtnActive:!1});var t=e.target.value;n.setState({newGroupName:t})},n.renameGroup=function(){var e=n.state.newGroupName.trim();if(e){var t=n;f.seafileAPI.renameGroup(n.props.groupID,e).then(function(e){t.props.loadGroup(n.props.groupID),t.props.onGroupChanged(e.data.id)}).catch(function(e){var t=g.default.getErrorMsg(e);v.default.danger(t)})}n.setState({newGroupName:""}),n.props.toggleRenameGroupDialog()},n.handleKeyDown=function(e){13===e.keyCode&&n.renameGroup()},n.state={newGroupName:n.props.currentGroupName,isSubmitBtnActive:!1},n}return i(t,e),s(t,[{key:"render",value:function(){return u.default.createElement(h.Modal,{isOpen:this.props.showRenameGroupDialog,toggle:this.props.toggleRenameGroupDialog},u.default.createElement(h.ModalHeader,null,(0,p.gettext)("Rename Group")),u.default.createElement(h.ModalBody,null,u.default.createElement("label",{htmlFor:"newGroupName"},(0,p.gettext)("Rename group to")),u.default.createElement(h.Input,{type:"text",id:"newGroupName",value:this.state.newGroupName,onChange:this.handleGroupNameChange,onKeyDown:this.handleKeyDown})),u.default.createElement(h.ModalFooter,null,u.default.createElement(h.Button,{color:"secondary",onClick:this.props.toggleRenameGroupDialog},(0,p.gettext)("Cancel")),u.default.createElement(h.Button,{color:"primary",onClick:this.renameGroup,disabled:!this.state.isSubmitBtnActive},(0,p.gettext)("Submit"))))}}]),t}(u.default.Component),w={showRenameGroupDialog:d.default.bool.isRequired,toggleRenameGroupDialog:d.default.func.isRequired,loadGroup:d.default.func.isRequired,groupID:d.default.string.isRequired,onGroupChanged:d.default.func.isRequired,currentGroupName:d.default.string.isRequired};b.propTypes=w,t.default=b},2305:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(2),h=n(4),m=n(45),g=r(m),y=n(3);n(2306);var v={groupID:d.default.string.isRequired,toggleTransferGroupDialog:d.default.func.isRequired,onGroupChanged:d.default.func.isRequired},b=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleSelectChange=function(e){n.setState({selectedOption:e,errMessage:""}),n.options=[]},n.transferGroup=function(){var e=n.state.selectedOption&&n.state.selectedOption.email;e&&h.seafileAPI.transferGroup(n.props.groupID,e).then(function(e){n.props.toggleTransferGroupDialog()}).catch(function(e){var t=y.Utils.getErrorMsg(e);n.setState({errMessage:t})})},n.toggle=function(){n.props.toggleTransferGroupDialog()},n.state={selectedOption:null,errMessage:""},n.options=[],n}return i(t,e),s(t,[{key:"render",value:function(){return u.default.createElement(p.Modal,{isOpen:!0,toggle:this.toggle},u.default.createElement(p.ModalHeader,{toggle:this.toggle},(0,f.gettext)("Transfer Group")),u.default.createElement(p.ModalBody,null,u.default.createElement("p",null,(0,f.gettext)("Transfer group to")),u.default.createElement(g.default,{ref:"userSelect",isMulti:!1,className:"reviewer-select",placeholder:(0,f.gettext)("Please enter 1 or more character"),onSelectChange:this.handleSelectChange}),u.default.createElement("div",{className:"error"},this.state.errMessage)),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{color:"secondary",onClick:this.toggle},(0,f.gettext)("Close")),u.default.createElement(p.Button,{color:"primary",onClick:this.transferGroup},(0,f.gettext)("Submit"))))}}]),t}(u.default.Component);b.propTypes=v,t.default=b},2306:function(e,t){},2307:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(2),h={toggleImportMembersDialog:d.default.func.isRequired,importMembersInBatch:d.default.func.isRequired},m=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggle=function(){n.props.toggleImportMembersDialog()},n.openFileInput=function(){n.fileInputRef.current.click()},n.uploadFile=function(e){if(n.fileInputRef.current.files.length){var t=n.fileInputRef.current.files[0].name;if("xlsx"!=t.substr(t.lastIndexOf(".")+1))return void n.setState({errorMsg:(0,f.gettext)("Please choose a .xlsx file.")});var r=n.fileInputRef.current.files[0];n.props.importMembersInBatch(r),n.toggle()}},n.fileInputRef=u.default.createRef(),n.state={errorMsg:""},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.state.errorMsg;return u.default.createElement(p.Modal,{isOpen:!0,toggle:this.toggle},u.default.createElement(p.ModalHeader,{toggle:this.toggle},(0,f.gettext)("Import members from a .xlsx file")),u.default.createElement(p.ModalBody,null,u.default.createElement("p",null,u.default.createElement("a",{className:"text-secondary small",href:f.siteRoot+"api/v2.1/group-members-import-example/"},(0,f.gettext)("Download an example file"))),u.default.createElement("button",{className:"btn btn-outline-primary",onClick:this.openFileInput},(0,f.gettext)("Upload file")),u.default.createElement("input",{className:"d-none",type:"file",onChange:this.uploadFile,ref:this.fileInputRef}),e&&u.default.createElement(p.Alert,{color:"danger"},e)),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{color:"secondary",onClick:this.toggle},(0,f.gettext)("Cancel"))))}}]),t}(u.default.Component);m.propTypes=h,t.default=m},2308:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(3),h=n(2),m=n(4),g=n(750),y=r(g),v=n(45),b=r(v),w=n(5),E=r(w),S=n(8),C=r(S);n(2309);var D={groupID:d.default.string.isRequired,toggleManageMembersDialog:d.default.func.isRequired,onGroupChanged:d.default.func.isRequired,isOwner:d.default.bool.isRequired},_=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.listGroupMembers=function(e){var t=n.props.groupID,r=n.state,a=r.perPage,o=r.groupMembers;m.seafileAPI.listGroupMembers(t,e,a).then(function(t){var r=t.data;n.setState({isLoading:!1,isLoadingMore:!1,page:e,hasNextPage:!(r.length<a),groupMembers:o.concat(r)})}).catch(function(e){var t=f.Utils.getErrorMsg(e);E.default.danger(t),n.setState({isLoading:!1,isLoadingMore:!1,hasNextPage:!1})})},n.onSelectChange=function(e){n.setState({selectedOption:e,errMessage:[]})},n.addGroupMember=function(){for(var e=[],t=0;t<n.state.selectedOption.length;t++)e.push(n.state.selectedOption[t].email);m.seafileAPI.addGroupMembers(n.props.groupID,e).then(function(e){var t=e.data.success;n.setState({groupMembers:[].concat(t,n.state.groupMembers),selectedOption:null}),n.refs.userSelect.clearSelect(),e.data.failed.length>0&&n.setState({errMessage:e.data.failed})}).catch(function(e){var t=f.Utils.getErrorMsg(e);E.default.danger(t)})},n.toggleItemFreezed=function(e){n.setState({isItemFreezed:e})},n.toggle=function(){n.props.toggleManageMembersDialog()},n.handleScroll=function(e){var t=n.state,r=t.page,a=t.hasNextPage,o=t.isLoadingMore;if(a&&!o){var i=e.target.clientHeight,s=e.target.scrollHeight;i+e.target.scrollTop+1>=s&&n.setState({isLoadingMore:!0},function(){n.listGroupMembers(r+1)})}},n.changeMember=function(e){n.setState({groupMembers:n.state.groupMembers.map(function(t){return t.email==e.email&&(t=e),t})})},n.deleteMember=function(e){var t=n.state.groupMembers;t.splice(t.indexOf(e),1),n.setState({groupMembers:t})},n.state={isLoading:!0,isLoadingMore:!1,groupMembers:[],page:1,perPage:100,hasNextPage:!1,selectedOption:null,errMessage:[],isItemFreezed:!1},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){this.listGroupMembers(this.state.page)}},{key:"render",value:function(){var e=this,t=this.state,n=t.isLoading,r=t.hasNextPage;return u.default.createElement(p.Modal,{isOpen:!0,toggle:this.toggle},u.default.createElement(p.ModalHeader,{toggle:this.toggle},(0,h.gettext)("Manage group members")),u.default.createElement(p.ModalBody,null,u.default.createElement("p",null,(0,h.gettext)("Add group member")),u.default.createElement("div",{className:"add-members"},u.default.createElement(b.default,{placeholder:(0,h.gettext)("Select users..."),onSelectChange:this.onSelectChange,ref:"userSelect",isMulti:!0,className:"add-members-select"}),this.state.selectedOption?u.default.createElement(p.Button,{color:"secondary",onClick:this.addGroupMember},(0,h.gettext)("Submit")):u.default.createElement(p.Button,{color:"secondary",disabled:!0},(0,h.gettext)("Submit"))),this.state.errMessage.length>0&&this.state.errMessage.map(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return u.default.createElement("div",{className:"group-error error",key:t},e.error_msg)}),u.default.createElement("div",{className:"manage-members",onScroll:this.handleScroll},n?u.default.createElement(C.default,null):u.default.createElement(l.Fragment,null,u.default.createElement(p.Table,{size:"sm",className:"manage-members-table"},u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:"15%"}),u.default.createElement("th",{width:"45%"},(0,h.gettext)("Name")),u.default.createElement("th",{width:"30%"},(0,h.gettext)("Role")),u.default.createElement("th",{width:"10%"}))),u.default.createElement("tbody",null,this.state.groupMembers.length>0&&this.state.groupMembers.map(function(t,n){return u.default.createElement(k,{key:n,item:t,changeMember:e.changeMember,deleteMember:e.deleteMember,groupID:e.props.groupID,isOwner:e.props.isOwner,isItemFreezed:e.state.isItemFreezed,toggleItemFreezed:e.toggleItemFreezed})}))),r&&u.default.createElement(C.default,null)))),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{color:"secondary",onClick:this.toggle},(0,h.gettext)("Close"))))}}]),t}(u.default.Component);_.propTypes=D;var P={item:d.default.object.isRequired,changeMember:d.default.func.isRequired,deleteMember:d.default.func.isRequired,groupID:d.default.string.isRequired,isOwner:d.default.bool.isRequired},k=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onChangeUserRole=function(e){var t="Admin"===e?"True":"False";m.seafileAPI.setGroupAdmin(n.props.groupID,n.props.item.email,t).then(function(e){n.props.changeMember(e.data)}).catch(function(e){var t=f.Utils.getErrorMsg(e);E.default.danger(t)})},n.deleteMember=function(){var e=n.props.item;m.seafileAPI.deleteGroupMember(n.props.groupID,e.email).then(function(t){n.props.deleteMember(e),E.default.success((0,h.gettext)("Successfully deleted {name}.").replace("{name}",e.name))}).catch(function(e){var t=f.Utils.getErrorMsg(e);E.default.danger(t)})},n.handleMouseOver=function(){n.props.isItemFreezed||n.setState({highlight:!0})},n.handleMouseLeave=function(){n.props.isItemFreezed||n.setState({highlight:!1})},n.translateRole=function(e){return"Admin"===e?(0,h.gettext)("Admin"):"Member"===e?(0,h.gettext)("Member"):"Owner"===e?(0,h.gettext)("Owner"):void 0},n.roles=["Admin","Member"],n.state={highlight:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=e.item,n=e.isOwner,r="Owner"!==t.role&&!0===n||"Member"===t.role&&!1===n;return u.default.createElement("tr",{onMouseOver:this.handleMouseOver,onMouseLeave:this.handleMouseLeave,className:this.state.highlight?"editing":""},u.default.createElement("th",{scope:"row"},u.default.createElement("img",{className:"avatar",src:t.avatar_url,alt:""})),u.default.createElement("td",null,t.name),u.default.createElement("td",null,(!1===n||!0===n&&"Owner"===t.role)&&u.default.createElement("span",{className:"group-admin"},this.translateRole(t.role)),!0===n&&"Owner"!==t.role&&u.default.createElement(y.default,{isTextMode:!0,isEditIconShow:this.state.highlight,currentRole:t.role,roles:this.roles,onRoleChanged:this.onChangeUserRole,toggleItemFreezed:this.props.toggleItemFreezed})),u.default.createElement("td",null,r&&!this.props.isItemFreezed&&u.default.createElement("i",{className:"fa fa-times delete-group-member-icon",onClick:this.deleteMember})))}}]),t}(u.default.PureComponent);k.propTypes=P,t.default=_},2309:function(e,t){},2310:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(2),h=n(4),m=n(3),g=n(5),y=r(g),v=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.leaveGroup=function(){h.seafileAPI.quitGroup(n.props.groupID,f.username).then(function(e){n.props.onGroupChanged()}).catch(function(e){var t=m.Utils.getErrorMsg(e);y.default.danger(t)})},n}return i(t,e),s(t,[{key:"render",value:function(){return u.default.createElement(p.Modal,{isOpen:!0,toggle:this.props.toggleLeaveGroupDialog},u.default.createElement(p.ModalHeader,{toggle:this.props.toggleLeaveGroupDialog},(0,f.gettext)("Leave Group")),u.default.createElement(p.ModalBody,null,u.default.createElement("p",null,(0,f.gettext)("Really want to leave this group?"))),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{color:"secondary",onClick:this.props.toggleLeaveGroupDialog},(0,f.gettext)("Cancel")),u.default.createElement(p.Button,{color:"primary",onClick:this.leaveGroup},(0,f.gettext)("Leave"))))}}]),t}(u.default.Component),b={toggleLeaveGroupDialog:d.default.func.isRequired,groupID:d.default.string.isRequired,onGroupChanged:d.default.func.isRequired};v.propTypes=b,t.default=v},2311:function(e,t){},2312:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(2),f=n(4),h=n(3),m=n(8),g=r(m),y=n(1022),v=r(y),b=n(387),w=r(b),E=n(5),S=r(E),C=n(2313),D=r(C),_=n(1025),P=r(_),k=n(2314),M=r(k),O=n(848),L=r(O),I=n(39),T=r(I);n(2315);var R={group:d.default.object.isRequired,onItemDetails:d.default.func.isRequired},N=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onItemUnshare=function(e){var t=n.props.group;f.seafileAPI.unshareRepoToGroup(e.repo_id,t.id).then(function(){var t=n.state.repoList.filter(function(t){return t.repo_id!==e.repo_id});n.setState({repoList:t})}).catch(function(e){var t=h.Utils.getErrorMsg(e);S.default.danger(t)})},n.onItemDelete=function(e){var t=n.state.repoList.filter(function(t){return t.repo_id!==e.repo_id});n.setState({repoList:t})},n.onItemRename=function(e,t){var r=n.props.group;f.seafileAPI.renameGroupOwnedLibrary(r.id,e.repo_id,t).then(function(r){var a=n.state.repoList.map(function(n){return n.repo_id===e.repo_id&&(n.repo_name=t),n});n.setState({repoList:a})}).catch(function(e){var t=h.Utils.getErrorMsg(e);S.default.danger(t)})},n.state={repoList:[]},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this.props.group,t=e.repos.map(function(e){return new w.default(e)});this.setState({repoList:t})}},{key:"render",value:function(){var e=this.props.group,t=u.default.createElement("p",{className:"group-item-empty-tip"},(0,p.gettext)("No libraries"));return u.default.createElement("div",{className:"group-list-panel"},u.default.createElement("h4",{className:"group-item-heading ellipsis"},u.default.createElement("a",{href:p.siteRoot+"group/"+e.id+"/",title:e.name},e.name)),0===this.state.repoList.length?t:u.default.createElement(P.default,{isShowTableThread:!1,isShowRepoOwner:!1,currentGroup:this.props.group,repoList:this.state.repoList,onItemUnshare:this.onItemUnshare,onItemDelete:this.onItemDelete,onItemDetails:this.props.onItemDetails,onItemRename:this.onItemRename}))}}]),t}(u.default.Component);N.propTypes=R;var x=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.listGroups=function(){f.seafileAPI.listGroups(!0).then(function(e){var t=e.data.map(function(e){return new v.default(e)});n.setState({isLoading:!1,groupList:t.sort(function(e,t){return e.name.toLowerCase()<t.name.toLowerCase()?-1:1})})}).catch(function(e){n.setState({isLoading:!1,errorMsg:h.Utils.getErrorMsg(e,!0)})})},n.toggleAddGroupModal=function(){n.setState({showAddGroupModal:!n.state.showAddGroupModal})},n.onCreateGroup=function(){n.setState({showAddGroupModal:!1,isLoading:!0,groupList:[]}),n.listGroups()},n.onItemDetails=function(e){n.setState({isShowDetails:!0,currentRepo:e})},n.closeDetails=function(){n.setState({isShowDetails:!1})},n.state={isLoading:!0,errorMsg:"",groupList:[],showAddGroupModal:!1,isShowDetails:!1,currentRepo:null},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){this.listGroups()}},{key:"render",value:function(){var e=this,t=u.default.createElement(T.default,null,u.default.createElement("h2",null,(0,p.gettext)("No groups")),p.canAddGroup?u.default.createElement("p",null,(0,p.gettext)('You are not in any groups. Groups allow multiple people to collaborate on libraries. You can create a group by clicking the "New Group" button in the menu bar.')):u.default.createElement("p",null,(0,p.gettext)("You are not in any groups. Groups allow multiple people to collaborate on libraries. Groups you join will be listed here.")));return u.default.createElement(l.Fragment,null,u.default.createElement(D.default,{onShowSidePanel:this.props.onShowSidePanel,onSearchedClick:this.props.onSearchedClick,toggleAddGroupModal:this.toggleAddGroupModal}),u.default.createElement("div",{className:"main-panel-center flex-row"},u.default.createElement("div",{className:"cur-view-container"},u.default.createElement("div",{className:"cur-view-path"},u.default.createElement("h3",{className:"sf-heading"},(0,p.gettext)("My Groups"))),u.default.createElement("div",{className:"cur-view-content cur-view-content-groups"},this.state.isLoading&&u.default.createElement(g.default,null),!this.state.isLoading&&this.state.errorMsg&&u.default.createElement("div",{className:"error text-center mt-2"},this.state.errorMsg),!this.state.isLoading&&!this.state.errorMsg&&0==this.state.groupList.length&&t,!this.state.isLoading&&this.state.groupList.map(function(t,n){return u.default.createElement(N,{key:n,group:t,onItemDetails:e.onItemDetails})}))),this.state.isShowDetails&&u.default.createElement("div",{className:"cur-view-detail"},u.default.createElement(L.default,{currentRepo:this.state.currentRepo,closeDetails:this.closeDetails}))),this.state.showAddGroupModal&&u.default.createElement(M.default,{toggleAddGroupModal:this.toggleAddGroupModal,onCreateGroup:this.onCreateGroup,showAddGroupModal:this.state.showAddGroupModal}))}}]),t}(u.default.Component),F={onShowSidePanel:d.default.func.isRequired,onSearchedClick:d.default.func.isRequired};x.propTypes=F,t.default=x},2313:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(127),f=r(p),h=n(78),m=r(h),g=n(6),y=n(2),v={searchPlaceholder:d.default.string,onShowSidePanel:d.default.func.isRequired,onSearchedClick:d.default.func.isRequired,toggleAddGroupModal:d.default.func.isRequired},b=function(e){function t(e){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=e.onShowSidePanel,n=e.onSearchedClick;return u.default.createElement("div",{className:"main-panel-north border-left-show"},u.default.createElement("div",{className:"cur-view-toolbar"},u.default.createElement("span",{title:"Side Nav Menu",onClick:t,className:"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none"}),y.canAddGroup&&u.default.createElement("div",{className:"operation"},u.default.createElement(f.default,{query:"(min-width: 768px)"},u.default.createElement(g.Button,{color:"btn btn-secondary operation-item",onClick:this.props.toggleAddGroupModal},u.default.createElement("i",{className:"fas fa-plus-square text-secondary mr-1"}),(0,y.gettext)("New Group"))),u.default.createElement(f.default,{query:"(max-width: 767.8px)"},u.default.createElement("span",{className:"sf2-icon-plus mobile-toolbar-icon",title:(0,y.gettext)("New Group"),onClick:this.props.toggleAddGroupModal})))),u.default.createElement(m.default,{searchPlaceholder:this.props.searchPlaceholder,onSearchedClick:n}))}}]),t}(u.default.Component);b.propTypes=v,t.default=b},2314:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(2),f=n(4),h=n(6),m=n(3),g=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleGroupChange=function(e){var t=e.target.value;t.trim()?n.setState({isSubmitBtnActive:!0}):n.setState({isSubmitBtnActive:!1}),n.setState({groupName:t}),n.state.errorMsg&&n.setState({errorMsg:""})},n.handleSubmitGroup=function(){var e=n.state.groupName.trim();if(e){var t=n;f.seafileAPI.createGroup(e).then(function(e){t.props.onCreateGroup()}).catch(function(e){var t=m.Utils.getErrorMsg(e);n.setState({errorMsg:t})})}else n.setState({errorMsg:(0,p.gettext)("Name is required")});n.setState({groupName:""})},n.handleKeyDown=function(e){13===e.keyCode&&(n.handleSubmitGroup(),e.preventDefault())},n.state={groupName:"",errorMsg:"",isSubmitBtnActive:!1},n.newInput=u.default.createRef(),n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){this.newInput.focus(),this.newInput.setSelectionRange(0,0)}},{key:"render",value:function(){var e=this;return u.default.createElement(h.Modal,{isOpen:this.props.showAddGroupModal,toggle:this.props.toggleAddGroupModal},u.default.createElement(h.ModalHeader,{toggle:this.props.toggleAddGroupModal},(0,p.gettext)("New Group")),u.default.createElement(h.ModalBody,null,u.default.createElement("label",{htmlFor:"groupName"},(0,p.gettext)("Name")),u.default.createElement(h.Input,{innerRef:function(t){e.newInput=t},type:"text",id:"groupName",value:this.state.groupName,onChange:this.handleGroupChange,onKeyDown:this.handleKeyDown}),u.default.createElement("span",{className:"error"},this.state.errorMsg)),u.default.createElement(h.ModalFooter,null,u.default.createElement(h.Button,{color:"secondary",onClick:this.props.toggleAddGroupModal},(0,p.gettext)("Cancel")),u.default.createElement(h.Button,{color:"primary",onClick:this.handleSubmitGroup,disabled:!this.state.isSubmitBtnActive},(0,p.gettext)("Submit"))))}}]),t}(u.default.Component),y={toggleAddGroupModal:d.default.func.isRequired,onCreateGroup:d.default.func.isRequired,showAddGroupModal:d.default.bool.isRequired};g.propTypes=y,t.default=g},2315:function(e,t){},2316:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(6),d=n(1),p=r(d),f=n(7),h=r(f),m=n(2),g=n(3),y=n(4),v=n(2317),b=r(v),w=n(2318),E=r(w),S=n(2319),C=r(S),D=n(8),_=r(D),P=n(5),k=r(P),M=n(39),O=r(M);n(101);var L=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleOpMenu=function(){n.setState({isOpMenuOpen:!n.state.isOpMenuOpen})},n.onMouseEnter=function(){n.setState({isOpIconShown:!0})},n.onMouseLeave=function(){n.setState({isOpIconShown:!1})},n.deleteItem=function(){n.setState({isOpIconShown:!1});var e=n.props.invitation.token;y.seafileAPI.deleteInvitation(e).then(function(e){n.setState({deleted:!0}),k.default.success((0,m.gettext)("Successfully deleted 1 item."))}).catch(function(e){var t=g.Utils.getErrorMsg(e);k.default.danger(t),n.setState({isOpIconShown:!0})})},n.revokeItem=function(){n.setState({deleted:!0})},n.toggleRevokeDialog=function(){n.setState({isRevokeDialogOpen:!n.state.isRevokeDialogOpen})},n.state={isOpIconShown:!1,isOpMenuOpen:!1,isRevokeDialogOpen:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.state,t=e.isOpIconShown,n=e.deleted,r=e.isRevokeDialogOpen;if(n)return null;var a=this.props.invitation,o=u.default.createElement("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},u.default.createElement("td",null,a.accepter),u.default.createElement("td",null,(0,h.default)(a.invite_time).format("YYYY-MM-DD")),u.default.createElement("td",null,(0,h.default)(a.expire_time).format("YYYY-MM-DD")),u.default.createElement("td",null,a.accept_time&&u.default.createElement("i",{className:"sf2-icon-tick invite-accept-icon"})),u.default.createElement("td",null,t&&(a.accept_time?u.default.createElement("i",{className:"action-icon sf3-font sf3-font-cancel-invitation",title:(0,m.gettext)("Revoke Access"),onClick:this.toggleRevokeDialog}):u.default.createElement("i",{className:"action-icon sf2-icon-x3",title:(0,m.gettext)("Delete"),onClick:this.deleteItem})))),i=u.default.createElement("tr",null,u.default.createElement("td",null,a.accepter,u.default.createElement("br",null),u.default.createElement("span",{className:"item-meta-info"},(0,h.default)(a.invite_time).format("YYYY-MM-DD"),u.default.createElement("span",{className:"small"},"(",(0,m.gettext)("Invite Time"),")")),u.default.createElement("span",{className:"item-meta-info"},(0,h.default)(a.expire_time).format("YYYY-MM-DD"),u.default.createElement("span",{className:"small"},"(",(0,m.gettext)("Expiration"),")")),u.default.createElement("span",{className:"item-meta-info"},a.accept_time&&(0,m.gettext)("Accepted"))),u.default.createElement("td",null,u.default.createElement(c.Dropdown,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu},u.default.createElement(c.DropdownToggle,{tag:"i",className:"sf-dropdown-toggle fa fa-ellipsis-v ml-0",title:(0,m.gettext)("More Operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),u.default.createElement("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu},u.default.createElement("div",{className:"mobile-operation-menu-bg-layer"}),u.default.createElement("div",{className:"mobile-operation-menu"},a.accept_time?u.default.createElement(c.DropdownItem,{className:"mobile-menu-item",onClick:this.toggleRevokeDialog},(0,m.gettext)("Revoke Access")):u.default.createElement(c.DropdownItem,{className:"mobile-menu-item",onClick:this.deleteItem},(0,m.gettext)("Delete")))))));return u.default.createElement(l.Fragment,null,this.props.isDesktop?o:i,r&&u.default.createElement(C.default,{accepter:a.accepter,token:a.token,revokeInvitation:this.revokeItem,toggleDialog:this.toggleRevokeDialog}))}}]),t}(u.default.Component),I={invitation:p.default.object.isRequired};L.propTypes=I;var T=function(e){function t(e){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.data,t=e.loading,n=e.errorMsg,r=e.invitationsList;if(t)return u.default.createElement(_.default,null);if(n)return u.default.createElement("p",{className:"error text-center mt-2"},n);if(!r.length)return u.default.createElement(O.default,null,u.default.createElement("h2",null,(0,m.gettext)("No guest invitations")),u.default.createElement("p",null,(0,m.gettext)('You have not invited any guests yet. A guest can access shared libraries through the web interface allowing more efficient ways to collaborate than through links. You can invite a guest by clicking the "Invite Guest" button in the menu bar.')));var a=g.Utils.isDesktop();return u.default.createElement("table",{className:"table-hover"+(a?"":" table-thead-hidden")},u.default.createElement("thead",null,a?u.default.createElement("tr",null,u.default.createElement("th",{width:"25%"},(0,m.gettext)("Email")),u.default.createElement("th",{width:"20%"},(0,m.gettext)("Invite Time")),u.default.createElement("th",{width:"20%"},(0,m.gettext)("Expiration")),u.default.createElement("th",{width:"18%"},(0,m.gettext)("Accepted")),u.default.createElement("th",{width:"7%"})):u.default.createElement("tr",null,u.default.createElement("th",{width:"92%"}),u.default.createElement("th",{width:"8%"}))),u.default.createElement("tbody",null,r.map(function(e,t){return u.default.createElement(L,{key:t,isDesktop:a,invitation:e})})))}}]),t}(l.Component),R=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onInvitePeople=function(e){e.push.apply(e,n.state.invitationsList),n.setState({invitationsList:e})},n.toggleInvitePeopleDialog=function(){n.setState({isInvitePeopleDialogOpen:!n.state.isInvitePeopleDialogOpen})},n.state={loading:!0,errorMsg:"",invitationsList:[],isInvitePeopleDialogOpen:!1},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;y.seafileAPI.listInvitations().then(function(t){e.setState({invitationsList:t.data,loading:!1})}).catch(function(t){e.setState({loading:!1,errorMsg:g.Utils.getErrorMsg(t,!0)})})}},{key:"render",value:function(){return u.default.createElement(l.Fragment,null,u.default.createElement(b.default,{onShowSidePanel:this.props.onShowSidePanel,onSearchedClick:this.props.onSearchedClick,toggleInvitePeopleDialog:this.toggleInvitePeopleDialog}),u.default.createElement("div",{className:"main-panel-center flex-row"},u.default.createElement("div",{className:"cur-view-container"},u.default.createElement("div",{className:"cur-view-path"},u.default.createElement("h3",{className:"sf-heading"},(0,m.gettext)("Invite Guest"))),u.default.createElement("div",{className:"cur-view-content"},u.default.createElement(T,{data:this.state})))),this.state.isInvitePeopleDialogOpen&&u.default.createElement(E.default,{onInvitePeople:this.onInvitePeople,toggleDialog:this.toggleInvitePeopleDialog}))}}]),t}(u.default.Component),N={onShowSidePanel:p.default.func.isRequired,onSearchedClick:p.default.func.isRequired};R.propTypes=N,t.default=R},2317:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(78),f=r(p),h=n(6),m=n(2),g=n(3),y={onShowSidePanel:d.default.func.isRequired,onSearchedClick:d.default.func.isRequired,toggleInvitePeopleDialog:d.default.func.isRequired},v=function(e){function t(e){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=e.onShowSidePanel,n=e.onSearchedClick,r=e.toggleInvitePeopleDialog;return u.default.createElement("div",{className:"main-panel-north border-left-show"},u.default.createElement("div",{className:"cur-view-toolbar"},u.default.createElement("span",{title:"Side Nav Menu",onClick:t,className:"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none"}),g.Utils.isDesktop()?u.default.createElement("div",{className:"operation"},u.default.createElement(h.Button,{color:"btn btn-secondary operation-item",onClick:r},u.default.createElement("i",{className:"fas fa-plus-square text-secondary mr-1"}),(0,m.gettext)("Invite Guest"))):u.default.createElement("span",{className:"sf2-icon-plus mobile-toolbar-icon",title:(0,m.gettext)("Invite Guest"),onClick:r})),u.default.createElement(f.default,{searchPlaceholder:this.props.searchPlaceholder,onSearchedClick:n}))}}]),t}(u.default.Component);v.propTypes=y,t.default=v},2318:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(3),f=n(2),h=n(4),m=n(6),g=n(5),y=r(g),v=n(8),b=r(v),w={onInvitePeople:d.default.func.isRequired,toggleDialog:d.default.func.isRequired},E=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleInputChange=function(e){var t=e.target.value;n.setState({emails:t}),n.state.errorMsg&&n.setState({errorMsg:""})},n.handleKeyDown=function(e){13===e.keyCode&&(e.preventDefault(),n.handleSubmitInvite())},n.handleSubmitInvite=function(){var e=n.state.emails.trim();if(!e)return n.setState({errorMsg:(0,f.gettext)("It is required.")}),!1;var t=[];e=e.split(",");for(var r=0,a=e.length;r<a;r++){var o=e[r].trim();o&&t.push(o)}if(!t.length)return n.setState({errorMsg:(0,f.gettext)("Email is invalid.")}),!1;n.setState({isSubmitting:!0}),h.seafileAPI.invitePeople(t).then(function(e){n.props.toggleDialog();var t=e.data.success;if(t.length){var r="";r=1==t.length?(0,f.gettext)("Successfully invited %(email).").replace("%(email)",t[0].accepter):(0,f.gettext)("Successfully invited %(email) and %(num) other people.").replace("%(email)",t[0].accepter).replace("%(num)",t.length-1),y.default.success(r),n.props.onInvitePeople(t)}var a=e.data.failed;if(a.length)for(var o=0,i=a.length;o<i;o++){var s=a[o].email+": "+a[o].error_msg;y.default.danger(s)}}).catch(function(e){var t=p.Utils.getErrorMsg(e);y.default.danger(t),n.props.toggleDialog()})},n.state={emails:"",errorMsg:"",isSubmitting:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.state.isSubmitting;return u.default.createElement(m.Modal,{isOpen:!0,toggle:this.props.toggleDialog},u.default.createElement(m.ModalHeader,{toggle:this.props.toggleDialog},(0,f.gettext)("Invite Guest")),u.default.createElement(m.ModalBody,null,u.default.createElement("label",{htmlFor:"emails"},(0,f.gettext)("Emails")),u.default.createElement(m.Input,{type:"text",id:"emails",placeholder:(0,f.gettext)("Emails, separated by ','"),value:this.state.emails,onChange:this.handleInputChange,onKeyDown:this.handleKeyDown}),u.default.createElement("p",{className:"error mt-2"},this.state.errorMsg)),u.default.createElement(m.ModalFooter,null,u.default.createElement(m.Button,{color:"secondary",onClick:this.props.toggleDialog},(0,f.gettext)("Cancel")),u.default.createElement(m.Button,{className:"submit-btn",color:"primary",onClick:this.handleSubmitInvite,disabled:e},e?u.default.createElement(b.default,null):(0,f.gettext)("Submit"))))}}]),t}(u.default.Component);E.propTypes=w,t.default=E},2319:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(2),f=n(6),h=n(4),m=n(3),g=n(8),y=r(g),v=n(5),b=r(v),w={accepter:d.default.string.isRequired,token:d.default.string.isRequired,revokeInvitation:d.default.func.isRequired,toggleDialog:d.default.func.isRequired},E=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onRevokeInvitation=function(){n.setState({isSubmitting:!0}),h.seafileAPI.revokeInvitation(n.props.token).then(function(e){n.props.revokeInvitation(),n.props.toggleDialog();var t=(0,p.gettext)("Successfully revoked access of user {placeholder}.").replace("{placeholder}",n.props.accepter);b.default.success(t)}).catch(function(e){var t=m.Utils.getErrorMsg(e);b.default.danger(t),n.props.toggleDialog()})},n.state={isSubmitting:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=(e.accepter,e.toggleDialog),n=this.state.isSubmitting,r='<span class="op-target">'+m.Utils.HTMLescape(this.props.accepter)+"</span>",a=(0,p.gettext)("Are you sure to revoke access of user {placeholder} ?").replace("{placeholder}",r);return u.default.createElement(f.Modal,{isOpen:!0,toggle:t},u.default.createElement(f.ModalHeader,{toggle:t},(0,p.gettext)("Revoke Access")),u.default.createElement(f.ModalBody,null,u.default.createElement("p",{dangerouslySetInnerHTML:{__html:a}})),u.default.createElement(f.ModalFooter,null,u.default.createElement(f.Button,{color:"secondary",onClick:t},(0,p.gettext)("Cancel")),u.default.createElement(f.Button,{className:"submit-btn",color:"primary",onClick:this.onRevokeInvitation,disabled:n},n?u.default.createElement(y.default,null):(0,p.gettext)("Submit"))))}}]),t}(u.default.Component);E.propTypes=w,t.default=E},2320:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(127),h=r(f),m=n(4),g=n(2),y=n(3),v=n(5),b=r(v),w=n(13),E=r(w),S=n(39),C=r(S),D=n(78),_=r(D),P=n(2321),k=r(P),M=n(2322),O=r(M),L=n(2323),I=r(L),T={onShowSidePanel:d.default.func.isRequired,onSearchedClick:d.default.func.isRequired},R=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getWikis=function(){m.seafileAPI.listWikis().then(function(e){n.setState({loading:!1,wikis:e.data.data})}).catch(function(e){n.setState({loading:!1,errorMsg:y.Utils.getErrorMsg(e,!0)})})},n.clickMenuToggle=function(e){e.preventDefault(),n.onMenuToggle()},n.onMenuToggle=function(){n.setState({isShowAddWikiMenu:!n.state.isShowAddWikiMenu})},n.onSelectToggle=function(){n.setState({isShowSelectDialog:!n.state.isShowSelectDialog})},n.onCreateToggle=function(){n.setState({isShowCreateDialog:!n.state.isShowCreateDialog})},n.addWiki=function(e){m.seafileAPI.addWiki(e).then(function(e){n.state.wikis.push(e.data),n.setState({wikis:n.state.wikis})}).catch(function(e){if(e.response){var t=e.response.data.error_msg;b.default.danger(t)}})},n.renameWiki=function(e,t){m.seafileAPI.renameWiki(e.slug,t).then(function(t){var r=n.state.wikis.map(function(n){return n.name===e.name&&(n=t.data),n});n.setState({wikis:r})}).catch(function(e){if(e.response){var t=e.response.data.error_msg;b.default.danger(t)}})},n.deleteWiki=function(e){m.seafileAPI.deleteWiki(e.slug).then(function(){var t=n.state.wikis.filter(function(t){return t.name!==e.name});n.setState({wikis:t})}).catch(function(e){if(e.response){var t=e.response.data.error_msg;b.default.danger(t)}})},n.state={loading:!0,errorMsg:"",wikis:[],isShowAddWikiMenu:!1,isShowSelectDialog:!1,isShowCreateDialog:!1},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){this.getWikis()}},{key:"render",value:function(){return u.default.createElement(l.Fragment,null,u.default.createElement("div",{className:"main-panel-north border-left-show"},u.default.createElement("div",{className:"cur-view-toolbar"},u.default.createElement("span",{className:"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none",title:"Side Nav Menu",onClick:this.props.onShowSidePanel}),u.default.createElement("div",{className:"operation"},u.default.createElement(l.Fragment,null,u.default.createElement(h.default,{query:"(min-width: 768px)"},u.default.createElement(p.Button,{className:"btn btn-secondary operation-item",onClick:this.onSelectToggle},(0,g.gettext)("Publish a Library"))),u.default.createElement(h.default,{query:"(max-width: 767.8px)"},u.default.createElement("span",{className:"sf2-icon-plus mobile-toolbar-icon",title:(0,g.gettext)("Publish a Library"),onClick:this.onSelectToggle}))))),u.default.createElement(_.default,{onSearchedClick:this.props.onSearchedClick})),u.default.createElement("div",{className:"main-panel-center"},u.default.createElement("div",{className:"cur-view-container",id:"wikis"},u.default.createElement("div",{className:"cur-view-path"},u.default.createElement("div",{className:"path-container"},u.default.createElement("h3",{className:"sf-heading m-0"},(0,g.gettext)("Published Libraries")))),u.default.createElement("div",{className:"cur-view-content"},(this.state.loading||0!==this.state.wikis.length)&&u.default.createElement(I.default,{data:this.state,renameWiki:this.renameWiki,deleteWiki:this.deleteWiki}),!this.state.loading&&0===this.state.wikis.length&&u.default.createElement(C.default,null,u.default.createElement("h2",null,(0,g.gettext)("No published libraries")),u.default.createElement("p",null,(0,g.gettext)('You have not published any libraries yet. A published library can be accessed by anyone, not only users, via its URL. You can publish a library by clicking the "Publish a Library" button in the menu bar.')))))),this.state.isShowCreateDialog&&u.default.createElement(E.default,null,u.default.createElement(k.default,{toggleCancel:this.onCreateToggle,addWiki:this.addWiki})),this.state.isShowSelectDialog&&u.default.createElement(E.default,null,u.default.createElement(O.default,{toggleCancel:this.onSelectToggle,addWiki:this.addWiki})))}}]),t}(l.Component);R.propTypes=T,t.default=R},2321:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(2),f=n(6),h={toggleCancel:d.default.func.isRequired,addWiki:d.default.func.isRequired},m=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.inputNewName=function(e){event.target.value.trim()?n.setState({isSubmitBtnActive:!0}):n.setState({isSubmitBtnActive:!1}),n.setState({name:e.target.value})},n.handleKeyPress=function(e){"Enter"===e.key&&n.handleSubmit()},n.handleSubmit=function(){var e=n.state,t=e.isExist,r=e.name,a=e.repoID;n.props.addWiki(t,r,a),n.props.toggleCancel()},n.toggle=function(){n.props.toggleCancel()},n.state={isExist:!1,name:"",repoID:"",isSubmitBtnActive:!1},n.newName=u.default.createRef(),n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){this.newName.focus(),this.newName.setSelectionRange(0,-1)}},{key:"render",value:function(){var e=this;return u.default.createElement(f.Modal,{isOpen:!0},u.default.createElement(f.ModalHeader,{toggle:this.toggle},(0,p.gettext)("New Wiki")),u.default.createElement(f.ModalBody,null,u.default.createElement("label",{className:"form-label"},(0,p.gettext)("Name")),u.default.createElement(f.Input,{onKeyPress:this.handleKeyPress,innerRef:function(t){e.newName=t},value:this.state.name,onChange:this.inputNewName})),u.default.createElement(f.ModalFooter,null,u.default.createElement(f.Button,{color:"secondary",onClick:this.toggle},(0,p.gettext)("Cancel")),u.default.createElement(f.Button,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive},(0,p.gettext)("Submit"))))}}]),t}(u.default.Component);m.propTypes=h,t.default=m},2322:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(2),f=n(6),h=n(4),m=n(7),g=r(m),y=n(387),v=r(y),b=n(3),w={toggleCancel:d.default.func.isRequired,addWiki:d.default.func.isRequired},E=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onChange=function(e){n.setState({repoID:e.repo_id})},n.handleSubmit=function(){var e=n.state.repoID;n.props.addWiki(e),n.props.toggleCancel()},n.toggle=function(){n.props.toggleCancel()},n.state={repos:[],repoID:""},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;h.seafileAPI.listRepos().then(function(t){var n=t.data.repos.filter(function(e){switch(e.type){case"mine":return!e.encrypted;case"shared":return!e.encrypted&&e.is_admin;case"group":default:return!e.encrypted&&!t.data.repos.some(function(t){return t.type!=e.type&&t.repo_id==e.repo_id})}}).map(function(e){return new v.default(e)});n=b.Utils.sortRepos(n,"name","asc"),e.setState({repos:n})})}},{key:"render",value:function(){var e=this;return u.default.createElement(f.Modal,{isOpen:!0},u.default.createElement(f.ModalHeader,{toggle:this.toggle},(0,p.gettext)("Publish a Library")),u.default.createElement(f.ModalBody,{className:"dialog-list-container"},u.default.createElement("table",null,u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:"6%"}),u.default.createElement("th",{width:"9%"}),u.default.createElement("th",{width:"55%"},(0,p.gettext)("Name")),u.default.createElement("th",{width:"30%"},(0,p.gettext)("Last Update")))),u.default.createElement("tbody",null,this.state.repos.map(function(t,n){return u.default.createElement("tr",{key:n},u.default.createElement("td",{className:"text-center"},u.default.createElement("input",{type:"radio",className:"vam",name:"repo",value:t.repo_id,onChange:e.onChange.bind(e,t)})),u.default.createElement("td",{className:"text-center"},u.default.createElement("img",{src:b.Utils.getLibIconUrl(t,!1),width:"24",title:b.Utils.getLibIconTitle(t),alt:b.Utils.getLibIconTitle(t)})),u.default.createElement("td",null,t.repo_name),u.default.createElement("td",null,(0,g.default)(t.last_modified).fromNow()))})))),u.default.createElement(f.ModalFooter,null,u.default.createElement(f.Button,{color:"secondary",onClick:this.toggle},(0,p.gettext)("Cancel")),this.state.repoID?u.default.createElement(f.Button,{color:"primary",onClick:this.handleSubmit},(0,p.gettext)("Submit")):u.default.createElement(f.Button,{color:"primary",disabled:!0},(0,p.gettext)("Submit"))))}}]),t}(u.default.Component);E.propTypes=w,t.default=E},2323:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(2),f=n(3),h=n(2324),m=r(h),g=n(847),y=r(g),v={data:d.default.object.isRequired,renameWiki:d.default.func.isRequired,deleteWiki:d.default.func.isRequired},b=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.state={isItemFreezed:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this,t=this.props.data,n=t.loading,r=t.errorMsg,a=t.wikis;if(n)return u.default.createElement("span",{className:"loading-icon loading-tip"});if(r)return u.default.createElement("p",{className:"error text-center"},r);var o=f.Utils.isDesktop(),i=u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:"4%"}),u.default.createElement("th",{width:"36%"},(0,p.gettext)("Name")),u.default.createElement("th",{width:"25%"},(0,p.gettext)("Owner")),u.default.createElement("th",{width:"25%"},(0,p.gettext)("Last Update")),u.default.createElement("th",{width:"10%"})));return u.default.createElement("table",{className:o?"":"table-thead-hidden"},o?i:u.default.createElement(y.default,null),u.default.createElement("tbody",null,a.map(function(t,n){return u.default.createElement(m.default,{key:n,wiki:t,renameWiki:e.props.renameWiki,deleteWiki:e.props.deleteWiki,isItemFreezed:e.state.isItemFreezed,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem})})))}}]),t}(l.Component);b.propTypes=v,t.default=b},2324:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(6),d=n(1),p=r(d),f=n(7),h=r(f),m=n(2),g=n(3),y=n(13),v=r(y),b=n(2325),w=r(b),E={wiki:p.default.object.isRequired,deleteWiki:p.default.func.isRequired,isItemFreezed:p.default.bool.isRequired,onFreezedItem:p.default.func.isRequired,onUnfreezedItem:p.default.func.isRequired},S=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleOpMenu=function(){n.setState({isOpMenuOpen:!n.state.isOpMenuOpen})},n.onMouseEnter=function(){n.props.isItemFreezed||n.setState({highlight:!0})},n.onMouseLeave=function(){n.props.isItemFreezed||n.setState({highlight:!1})},n.onDeleteToggle=function(){n.props.onUnfreezedItem(),n.setState({isShowDeleteDialog:!n.state.isShowDeleteDialog})},n.onDeleteCancel=function(){n.props.onUnfreezedItem(),n.setState({isShowDeleteDialog:!n.state.isShowDeleteDialog})},n.deleteWiki=function(){var e=n.props.wiki;n.props.deleteWiki(e),n.setState({isShowDeleteDialog:!n.state.isShowDeleteDialog})},n.state={isOpMenuOpen:!1,isShowDeleteDialog:!1,highlight:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.wiki,t=m.siteRoot+"profile/"+encodeURIComponent(e.owner)+"/",n=g.Utils.getDefaultLibIconUrl(!1),r="action-icon sf2-icon-x3 "+(this.state.highlight?"":"invisible"),a=u.default.createElement("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},u.default.createElement("td",null,u.default.createElement("img",{src:n,width:"24",alt:""})),u.default.createElement("td",{className:"name"},u.default.createElement("a",{href:e.link},e.name)),u.default.createElement("td",null,u.default.createElement("a",{href:t,target:"_blank"},e.owner_nickname)),u.default.createElement("td",null,(0,h.default)(e.updated_at).fromNow()),u.default.createElement("td",{className:"text-center cursor-pointer"},u.default.createElement("span",{className:r,onClick:this.onDeleteToggle}))),o=u.default.createElement("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},u.default.createElement("td",null,u.default.createElement("img",{src:n,width:"24",alt:""})),u.default.createElement("td",null,u.default.createElement("a",{href:e.link},e.name),u.default.createElement("br",null),u.default.createElement("a",{href:t,target:"_blank",className:"item-meta-info"},e.owner_nickname),u.default.createElement("span",{className:"item-meta-info"},(0,h.default)(e.updated_at).fromNow())),u.default.createElement("td",null,u.default.createElement(c.Dropdown,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu},u.default.createElement(c.DropdownToggle,{tag:"i",className:"sf-dropdown-toggle fa fa-ellipsis-v ml-0",title:(0,m.gettext)("More Operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),u.default.createElement("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu},u.default.createElement("div",{className:"mobile-operation-menu-bg-layer"}),u.default.createElement("div",{className:"mobile-operation-menu"},u.default.createElement(c.DropdownItem,{className:"mobile-menu-item",onClick:this.onDeleteToggle},(0,m.gettext)("Unpublish")))))));return u.default.createElement(l.Fragment,null,g.Utils.isDesktop()?a:o,this.state.isShowDeleteDialog&&u.default.createElement(v.default,null,u.default.createElement(w.default,{toggleCancel:this.onDeleteCancel,handleSubmit:this.deleteWiki})))}}]),t}(l.Component);S.propTypes=E,t.default=S},2325:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(2),f=n(6),h={toggleCancel:d.default.func.isRequired,handleSubmit:d.default.func.isRequired},m=function(e){function t(){var e,n,r,i;a(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=r=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),r.toggle=function(){r.props.toggleCancel()},i=n,o(r,i)}return i(t,e),s(t,[{key:"render",value:function(){return u.default.createElement(f.Modal,{isOpen:!0,toggle:this.toggle},u.default.createElement(f.ModalHeader,{toggle:this.toggle},(0,p.gettext)("Unpublish Library")),u.default.createElement(f.ModalBody,null,u.default.createElement("p",null,(0,p.gettext)("Are you sure you want to unpublish this library?"))),u.default.createElement(f.ModalFooter,null,u.default.createElement(f.Button,{color:"secondary",onClick:this.toggle},(0,p.gettext)("Cancel")),u.default.createElement(f.Button,{color:"primary",onClick:this.props.handleSubmit},(0,p.gettext)("Unpublish"))))}}]),t}(u.default.Component);m.propTypes=h,t.default=m},2326:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(2327),d=r(c),p=function(e){return function(t){function n(e){return a(this,n),o(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e))}return i(n,t),s(n,[{key:"render",value:function(){return u.default.createElement(l.Fragment,null,u.default.createElement(d.default,this.props),u.default.createElement(e,this.props))}}]),n}(u.default.Component)};t.default=p},2327:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(78),f=r(p),h={searchPlaceholder:d.default.string,onShowSidePanel:d.default.func.isRequired,onSearchedClick:d.default.func.isRequired},m=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=e.onShowSidePanel,n=e.onSearchedClick;return u.default.createElement("div",{className:"main-panel-north"},u.default.createElement("div",{className:"cur-view-toolbar"},u.default.createElement("span",{className:"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none",title:"Side Nav Menu",onClick:t})),u.default.createElement(f.default,{searchPlaceholder:this.props.searchPlaceholder,onSearchedClick:n}))}}]),t}(u.default.Component);m.propTypes=h,t.default=m},235:function(e,t){function n(e){if(e=String(e),!(e.length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return n*c;case"days":case"day":case"d":return n*u;case"hours":case"hour":case"hrs":case"hr":case"h":return n*l;case"minutes":case"minute":case"mins":case"min":case"m":return n*s;case"seconds":case"second":case"secs":case"sec":case"s":return n*i;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}function r(e){return e>=u?Math.round(e/u)+"d":e>=l?Math.round(e/l)+"h":e>=s?Math.round(e/s)+"m":e>=i?Math.round(e/i)+"s":e+"ms"}function a(e){return o(e,u,"day")||o(e,l,"hour")||o(e,s,"minute")||o(e,i,"second")||e+" ms"}function o(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var i=1e3,s=60*i,l=60*s,u=24*l,c=365.25*u;e.exports=function(e,t){t=t||{};var o=typeof e;if("string"===o&&e.length>0)return n(e);if("number"===o&&!1===isNaN(e))return t.long?a(e):r(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},236:function(e,t,n){function r(){}function a(e){var n=""+e.type;if(t.BINARY_EVENT!==e.type&&t.BINARY_ACK!==e.type||(n+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(n+=e.nsp+","),null!=e.id&&(n+=e.id),null!=e.data){var r=o(e.data);if(!1===r)return y;n+=r}return p("encoded %j as %s",e,n),n}function o(e){try{return JSON.stringify(e)}catch(e){return!1}}function i(e,t){function n(e){var n=h.deconstructPacket(e),r=a(n.packet),o=n.buffers;o.unshift(r),t(o)}h.removeBlobs(e,n)}function s(){this.reconstructor=null}function l(e){var n=0,r={type:Number(e.charAt(0))};if(null==t.types[r.type])return d("unknown packet type "+r.type);if(t.BINARY_EVENT===r.type||t.BINARY_ACK===r.type){for(var a="";"-"!==e.charAt(++n)&&(a+=e.charAt(n),n!=e.length););if(a!=Number(a)||"-"!==e.charAt(n))throw new Error("Illegal attachments");r.attachments=Number(a)}if("/"===e.charAt(n+1))for(r.nsp="";++n;){var o=e.charAt(n);if(","===o)break;if(r.nsp+=o,n===e.length)break}else r.nsp="/";var i=e.charAt(n+1);if(""!==i&&Number(i)==i){for(r.id="";++n;){var o=e.charAt(n);if(null==o||Number(o)!=o){--n;break}if(r.id+=e.charAt(n),n===e.length)break}r.id=Number(r.id)}if(e.charAt(++n)){var s=u(e.substr(n));if(!(!1!==s&&(r.type===t.ERROR||m(s))))return d("invalid payload");r.data=s}return p("decoded %s as %j",e,r),r}function u(e){try{return JSON.parse(e)}catch(e){return!1}}function c(e){this.reconPack=e,this.buffers=[]}function d(e){return{type:t.ERROR,data:"parser error: "+e}}var p=n(703)("socket.io-parser"),f=n(106),h=n(705),m=n(345),g=n(346);t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=r,t.Decoder=s;var y=t.ERROR+'"encode error"';r.prototype.encode=function(e,n){if(p("encoding packet %j",e),t.BINARY_EVENT===e.type||t.BINARY_ACK===e.type)i(e,n);else{n([a(e)])}},f(s.prototype),s.prototype.add=function(e){var n;if("string"===typeof e)n=l(e),t.BINARY_EVENT===n.type||t.BINARY_ACK===n.type?(this.reconstructor=new c(n),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",n)):this.emit("decoded",n);else{if(!g(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(n=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",n))}},s.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},c.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=h.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},c.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},237:function(e,t,n){var r=n(710);e.exports=function(e){var t=e.xdomain,n=e.xscheme,a=e.enablesXDR;try{if("undefined"!==typeof XMLHttpRequest&&(!t||r))return new XMLHttpRequest}catch(e){}try{if("undefined"!==typeof XDomainRequest&&!n&&a)return new XDomainRequest}catch(e){}if(!t)try{return new(self[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}},238:function(e,t,n){function r(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.isReactNative=e.isReactNative,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}var a=n(107),o=n(106);e.exports=r,o(r.prototype),r.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},r.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},r.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},r.prototype.send=function(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)},r.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},r.prototype.onData=function(e){var t=a.decodePacket(e,this.socket.binaryType);this.onPacket(t)},r.prototype.onPacket=function(e){this.emit("packet",e)},r.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},239:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(2),h=n(4),m=n(45),g=r(m),y=n(5),v=r(y),b=n(3);n(148);var w={participant:d.default.object.isRequired,deleteFileParticipant:d.default.func.isRequired},E=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseOver=function(){n.setState({isOperationShow:!0})},n.onMouseLeave=function(){n.setState({isOperationShow:!1})},n.state={isOperationShow:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.participant;return u.default.createElement("div",{className:"participant-select-info",onMouseOver:this.onMouseOver,onMouseLeave:this.onMouseLeave},u.default.createElement("div",{className:"d-flex",style:{maxWidth:"90%"}},u.default.createElement("img",{className:"avatar participant-select-avatar",src:e.avatar_url,alt:""}),u.default.createElement("span",{className:"participant-select-name ellipsis"},e.name)),u.default.createElement("i",{className:"action-icon sf2-icon-x3 "+(!this.state.isOperationShow&&"o-hidden"),title:(0,f.gettext)("Delete"),onClick:this.props.deleteFileParticipant.bind(this,e.email)}))}}]),t}(l.Component);E.propTypes=w;var S={repoID:d.default.string.isRequired,filePath:d.default.string.isRequired,toggleFileParticipantDialog:d.default.func.isRequired,fileParticipantList:d.default.array.isRequired,onParticipantsChange:d.default.func},C=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleSelectChange=function(e){n.setState({selectedOption:e})},n.deleteFileParticipant=function(e){var t=n.props,r=t.repoID,a=t.filePath;h.seafileAPI.deleteFileParticipant(r,a,e).then(function(e){n.props.onParticipantsChange(r,a)}).catch(function(e){var t=b.Utils.getErrorMsg(e);v.default.danger(t)}),n.refs.userSelect.clearSelect()},n.addFileParticipant=function(){var e=n.state.selectedOption,t=n.props,r=t.repoID,a=t.filePath;if(e&&0!==e.length){var o=e.map(function(e){return e.email});h.seafileAPI.addFileParticipants(r,a,o).then(function(e){n.props.onParticipantsChange(r,a),e.data.failed.map(function(e){var t=(0,f.gettext)("Failed to add {email_placeholder}: {error_msg_placeholder}").replace("{email_placeholder}",e.email).replace("{error_msg_placeholder}",e.error_msg);v.default.danger(t,{duration:3})})}).catch(function(e){v.default.danger(b.Utils.getErrorMsg(e))}),n.setState({selectedOption:null}),n.refs.userSelect.clearSelect()}},n.state={selectedOption:null},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this,t=this.props.fileParticipantList.map(function(t,n){return u.default.createElement(E,{key:n,participant:t,deleteFileParticipant:e.deleteFileParticipant})});return u.default.createElement(p.Modal,{isOpen:!0,toggle:this.props.toggleFileParticipantDialog},u.default.createElement(p.ModalHeader,{toggle:this.props.toggleFileParticipantDialog},(0,f.gettext)("Participants")),u.default.createElement(p.ModalBody,null,u.default.createElement("div",{className:"participant-add"},u.default.createElement(g.default,{ref:"userSelect",isMulti:!0,className:"participant-select",placeholder:(0,f.gettext)("Select users..."),onSelectChange:this.handleSelectChange}),u.default.createElement(p.Button,{className:"btn btn-secondary ml-2",onClick:this.addFileParticipant},(0,f.gettext)("Add"))),t),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{color:"secondary",onClick:this.props.toggleFileParticipantDialog},(0,f.gettext)("Close"))))}}]),t}(l.Component);C.propTypes=S,t.default=C},24:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(11),d=n(1),p=r(d),f=n(46),h=r(f),m=n(25),g=r(m),y={deceleration:"cubic-bezier(0.0, 0.0, 0.2, 1)",acceleration:"cubic-bezier(0.4, 0.0, 1, 1)",spring:"cubic-bezier(0.175, 0.885, 0.320, 1.175)"},v=c.css.keyframes("openAnimation",{from:{opacity:0,transform:"translateY(-120%)"},to:{transform:"translateY(0)"}}),b=c.css.keyframes("closeAnimation",{from:{transform:"scale(1)",opacity:1},to:{transform:"scale(0.9)",opacity:0}}),w=(0,c.css)({display:"flex",flexDirection:"column",alignItems:"center",height:0,transition:"all 240ms "+y.deceleration,'&[data-state="entering"], &[data-state="entered"]':{animation:v+" 240ms "+y.spring+" both"},'&[data-state="exiting"]':{animation:b+" 120ms "+y.acceleration+" both"}}),E=function(e){function t(){var e,n,r,i;a(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=r=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),r.state={isShown:!0,height:0},r.close=function(){r.clearCloseTimer(),r.setState({isShown:!1})},r.startCloseTimer=function(){r.props.duration&&(r.closeTimer=setTimeout(function(){r.close()},1e3*r.props.duration))},r.clearCloseTimer=function(){r.closeTimer&&(clearTimeout(r.closeTimer),r.closeTimer=null)},r.handleMouseEnter=function(){r.clearCloseTimer()},r.handleMouseLeave=function(){r.startCloseTimer()},r.onRef=function(e){if(null!==e){var t=e.getBoundingClientRect(),n=t.height;r.setState({height:n})}},i=n,o(r,i)}return i(t,e),s(t,[{key:"componentDidUpdate",value:function(e){e.isShown!==this.props.isShown&&this.setState({isShown:this.props.isShown})}},{key:"componentDidMount",value:function(){this.startCloseTimer()}},{key:"componentWillUnmount",value:function(){this.clearCloseTimer()}},{key:"render",value:function(){var e=this;return u.default.createElement(h.default,{appear:!0,unmountOnExit:!0,timeout:240,in:this.state.isShown,onExited:this.props.onRemove},function(t){return u.default.createElement("div",{"data-state":t,className:w,onMouseEnter:e.handleMouseEnter,onMouseLeave:e.handleMouseLeave,style:{height:e.state.height,zIndex:e.props.zIndex,marginBottom:e.state.isShown?0:-e.state.height}},u.default.createElement("div",{ref:e.onRef,style:{padding:8}},u.default.createElement(g.default,{intent:e.props.intent,title:e.props.title,children:e.props.children,isRemoveable:e.props.hasCloseButton,onRemove:function(){return e.close()}})))})}}]),t}(u.default.PureComponent);E.propTypes={zIndex:p.default.number,duration:p.default.number,onRemove:p.default.func,intent:p.default.oneOf(["none","success","warning","danger"]).isRequired,title:p.default.node,children:p.default.node,hasCloseButton:p.default.bool,isShown:p.default.bool},E.defaultProps={intent:"none"},t.default=E},240:function(e,t,n){"use strict";function r(e){return(r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function s(e,t){return!t||"object"!==r(t)&&"function"!==typeof t?d(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(){return p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},p.apply(this,arguments)}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){h(e,t,n[t])})}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e,t){if(null==e)return{};var n,r,a=g(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function g(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}Object.defineProperty(t,"__esModule",{value:!0}),t.Collapse=t.collapseDuration=t.Fade=void 0;var y=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(0)),v=n(379),b=function(e){var t=e.component,n=e.duration,r=void 0===n?1:n,a=e.in,o=(e.onExited,m(e,["component","duration","in","onExited"])),i={entering:{opacity:0},entered:{opacity:1,transition:"opacity ".concat(r,"ms")},exiting:{opacity:0},exited:{opacity:0}};return y.default.createElement(v.Transition,{mountOnEnter:!0,unmountOnExit:!0,in:a,timeout:r},function(e){var n={style:f({},i[e])};return y.default.createElement(t,p({innerProps:n},o))})};t.Fade=b;var w=260;t.collapseDuration=w;var E=function(e){function t(){var e,n;a(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=s(this,(e=l(t)).call.apply(e,[this].concat(o))),h(d(d(n)),"duration",w),h(d(d(n)),"rafID",void 0),h(d(d(n)),"state",{width:"auto"}),h(d(d(n)),"transition",{exiting:{width:0,transition:"width ".concat(n.duration,"ms ease-out")},exited:{width:0}}),h(d(d(n)),"getWidth",function(e){e&&isNaN(n.state.width)&&(n.rafID=window.requestAnimationFrame(function(){var t=e.getBoundingClientRect(),r=t.width;n.setState({width:r})}))}),h(d(d(n)),"getStyle",function(e){return{overflow:"hidden",whiteSpace:"nowrap",width:e}}),h(d(d(n)),"getTransition",function(e){return n.transition[e]}),n}return u(t,e),i(t,[{key:"componentWillUnmount",value:function(){this.rafID&&window.cancelAnimationFrame(this.rafID)}},{key:"render",value:function(){var e=this,t=this.props,n=t.children,r=t.in,a=this.state.width;return y.default.createElement(v.Transition,{enter:!1,mountOnEnter:!0,unmountOnExit:!0,in:r,timeout:this.duration},function(t){var r=f({},e.getStyle(a),e.getTransition(t));return y.default.createElement("div",{ref:e.getWidth,style:r},n)})}}]),t}(y.Component);t.Collapse=E},25:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function o(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=function(e){return e&&e.__esModule?e:{default:e}}(l),c=n(11),d=function(e){function t(e){r(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.containerStyle=(0,c.css)({borderRadius:"3px",backgroundColor:"#fff",padding:"10px 16px",display:"flex",boxSizing:"border-box",boxShadow:"rgba(67, 90, 111, 0.3) 0px 0px 1px, rgba(67, 90, 111, 0.47) 0px 8px 10px -4px",justifyContent:"space-between",flexDirection:"row"}),n.containerBorderSuccess=(0,c.css)({borderLeft:"3px solid rgb(71, 184, 129)"}),n.containerBorderWarn=(0,c.css)({borderLeft:"3px solid rgb(217, 130, 43)"}),n.containerBorderDanger=(0,c.css)({borderLeft:"3px solid rgb(236, 76, 71)"}),n.containerBorderNotify=(0,c.css)({borderLeft:"3px solid rgb(16, 112, 202)"}),n.toastTextTitle=(0,c.css)({fontWeight:"600",fontSize:"14px",color:"#435a6f",margin:"0"}),n.toastTextChild=(0,c.css)({fontSize:"14px",color:"#999",margin:"0"}),n.toastClose=(0,c.css)({marginLeft:"15px",height:"24px",width:"24px",lineHeight:"22px",fontWeight:"700",textAlign:"center",fontSize:"20px",color:"#000",cursor:"pointer",opacity:"0.5",":hover":{opacity:1}}),n.toastIcon=(0,c.css)({marginRight:"10px",width:"14px",height:"20px",lineHeight:"20px"}),n}return o(t,e),s(t,[{key:"getContainerStyle",value:function(e){switch(e){case"success":return{borderStyle:this.containerBorderSuccess,iconColor:(0,c.css)({color:"rgb(71, 184, 129)"}),iconClass:"fa fa-check-circle"};case"warning":return{borderStyle:this.containerBorderWarn,iconColor:(0,c.css)({color:"rgb(217, 130, 43)"}),iconClass:"fa fa-exclamation-triangle"};case"none":return{borderStyle:this.containerBorderNotify,iconColor:(0,c.css)({color:"rgb(16, 112, 202)"}),iconClass:"fa fa-exclamation-circle"};case"danger":return{borderStyle:this.containerBorderDanger,iconColor:(0,c.css)({color:"rgb(236, 76, 71)"}),iconClass:"fa fa-exclamation-circle"}}}},{key:"render",value:function(){var e=this.getContainerStyle(this.props.intent);return u.default.createElement("div",(0,c.css)(e.borderStyle,this.containerStyle),u.default.createElement("div",{className:this.toastIcon},u.default.createElement("i",i({className:e.iconClass},e.iconColor))),u.default.createElement("div",{className:this.toastTextContainer},u.default.createElement("p",{className:this.toastTextTitle},this.props.title),this.props.children?u.default.createElement("p",{className:this.toastTextChild},this.props.children):null),u.default.createElement("div",{onClick:this.props.onRemove,className:this.toastClose},u.default.createElement("span",null,"\xd7")))}}]),t}(u.default.PureComponent);t.default=d},256:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(13),h=r(f),m=n(239),g=r(m),y=n(2);n(148);var v={onParticipantsChange:d.default.func.isRequired,participants:d.default.array.isRequired,repoID:d.default.string.isRequired,filePath:d.default.string.isRequired,showIconTip:d.default.bool.isRequired},b=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleDialog=function(){n.setState({showDialog:!n.state.showDialog})},n.tooltipToggle=function(){n.setState({tooltipOpen:!n.state.tooltipOpen})},n.state={showDialog:!1,tooltipOpen:!1},n.targetID="add-participant-icon",n}return i(t,e),s(t,[{key:"componentWillMount",value:function(){this.targetID=this.targetID+Math.floor(1e3*Math.random())}},{key:"render",value:function(){var e=this.props,t=e.participants,n=e.repoID,r=e.filePath,a=e.showIconTip;return u.default.createElement("div",{className:"participants mb-2 position-relative"},t.map(function(e,t){return u.default.createElement(E,{item:e,index:t,key:t})}),u.default.createElement("span",{className:"add-participants",onClick:this.toggleDialog,id:this.targetID},u.default.createElement("i",{className:"fas fa-plus-circle"})),a&&u.default.createElement(p.Tooltip,{toggle:this.tooltipToggle,delay:{show:0,hide:0},target:this.targetID,placement:"bottom",isOpen:this.state.tooltipOpen},(0,y.gettext)("Add participants")),this.state.showDialog&&u.default.createElement(h.default,null,u.default.createElement(g.default,{repoID:n,filePath:r,toggleFileParticipantDialog:this.toggleDialog,fileParticipantList:t,onParticipantsChange:this.props.onParticipantsChange})))}}]),t}(u.default.Component);b.propTypes=v;var w={index:d.default.number.isRequired,item:d.default.object.isRequired},E=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleAvatarTooltip=function(){n.setState({showAvatarTooltip:!n.state.showAvatarTooltip})},n.state={showAvatarTooltip:!1},n.targetID="participant-avatar-",n}return i(t,e),s(t,[{key:"componentWillMount",value:function(){this.targetID=this.targetID+this.props.index+Math.floor(1e3*Math.random())}},{key:"render",value:function(){var e=this.props,t=e.item,n=e.index;return u.default.createElement("span",{className:"participant-avatar"},u.default.createElement("img",{src:t.avatar_url,className:"avatar",id:this.targetID,alt:"avatar",key:n}),u.default.createElement(p.Tooltip,{toggle:this.toggleAvatarTooltip,delay:{show:0,hide:0},target:this.targetID,placement:"bottom",isOpen:this.state.showAvatarTooltip},t.name))}}]),t}(u.default.Component);E.propTypes=w,t.default=b},26:function(e,t,n){"use strict";function r(){var e=i.loginUrl+"?next="+encodeURIComponent(location.href),t=(0,i.gettext)("Permission denied. Please try {placeholder-left}login again.{placeholder-right}");return t=t.replace("{placeholder-left}",'<a class="action-link p-0" href='+e+">"),t=t.replace("{placeholder-right}","</a>"),o.default.createElement("span",{className:"error",dangerouslySetInnerHTML:{__html:t}})}Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(a),i=n(2);t.default=r},262:function(e,t){var n=[].indexOf;e.exports=function(e,t){if(n)return e.indexOf(t);for(var r=0;r<e.length;++r)if(e[r]===t)return r;return-1}},274:function(e,t,n){"use strict";function r(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window,r=void 0;"function"===typeof window.CustomEvent?r=new window.CustomEvent(e,{detail:t}):(r=document.createEvent("CustomEvent"),r.initCustomEvent(e,!1,!0,t)),n&&(n.dispatchEvent(r),(0,s.default)(l.store,t))}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];r(u,(0,s.default)({},e,{type:u}),t)}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];r(c,(0,s.default)({},e,{type:c}),t)}Object.defineProperty(t,"__esModule",{value:!0}),t.MENU_HIDE=t.MENU_SHOW=void 0,t.dispatchGlobalEvent=r,t.showMenu=a,t.hideMenu=o;var i=n(35),s=function(e){return e&&e.__esModule?e:{default:e}}(i),l=n(384),u=t.MENU_SHOW="REACT_CONTEXTMENU_SHOW",c=t.MENU_HIDE="REACT_CONTEXTMENU_HIDE"},275:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(6),d=n(1),p=r(d),f=n(5),h=r(f),m=n(83),g=r(m),y=n(2),v=n(4),b=n(3);n(276);var w={path:p.default.string.isRequired,repoID:p.default.string.isRequired},E=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={isOpen:!1,smartLink:""},n.toggle=n.toggle.bind(n),n.getInternalLink=n.getInternalLink.bind(n),n.copyToClipBoard=n.copyToClipBoard.bind(n),n}return i(t,e),s(t,[{key:"toggle",value:function(){this.setState({isOpen:!this.state.isOpen})}},{key:"getInternalLink",value:function(){var e=this,t=this.props.repoID,n=this.props.path;v.seafileAPI.getInternalLink(t,n).then(function(t){e.setState({isOpen:!0,smartLink:t.data.smart_link})}).catch(function(e){var t=b.Utils.getErrorMsg(e);h.default.danger(t)})}},{key:"copyToClipBoard",value:function(){(0,g.default)(this.state.smartLink),this.setState({isOpen:!1});var e=(0,y.gettext)("Internal link has been copied to clipboard");h.default.success(e)}},{key:"render",value:function(){return u.default.createElement("span",{className:"file-internal-link",title:(0,y.gettext)("Internal Link")},u.default.createElement("i",{className:"fa fa-link",onClick:this.getInternalLink}),u.default.createElement(c.Modal,{isOpen:this.state.isOpen,toggle:this.toggle},u.default.createElement(c.ModalHeader,{toggle:this.toggle},(0,y.gettext)("Internal Link")),u.default.createElement(c.ModalBody,null,u.default.createElement("p",{className:"tip mb-1"},(0,y.gettext)("An internal link is a link to a file or folder that can be accessed by users with read permission to the file or folder.")),u.default.createElement("p",null,u.default.createElement("a",{target:"_blank",href:this.state.smartLink},this.state.smartLink))),u.default.createElement(c.ModalFooter,null,u.default.createElement(c.Button,{color:"secondary",onClick:this.toggle},(0,y.gettext)("Cancel")),u.default.createElement(c.Button,{color:"primary",onClick:this.copyToClipBoard},(0,y.gettext)("Copy")))))}}]),t}(u.default.Component);E.propTypes=w,t.default=E},276:function(e,t){},277:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={control:{backgroundColor:"#fff",fontSize:14,fontWeight:"normal"},highlighter:{overflow:"hidden"},input:{margin:0},"&singleLine":{control:{display:"inline-block",width:130},highlighter:{padding:1,border:"2px inset transparent"},input:{padding:1,border:"2px inset"}},"&multiLine":{control:{},highlighter:{padding:9},input:{padding:"8px 6px",minHeight:90,height:90,border:"1px solid #e6e6dd",borderRadius:"5px",overfflowY:"auto","&focused":{backgroundColor:"#cee4e5",outlineOffset:"-2px",outlineColor:"-webkit-focus-ring-color",outlineStyle:"auto",outlineWidth:"5px"}}},suggestions:{list:{backgroundColor:"white",border:"1px solid rgba(0,0,0,0.15)",fontSize:14,maxHeight:200,overflow:"auto",position:"absolute",bottom:14,width:"150px"},item:{width:"auto",padding:"5px 15px",overflowX:"auto",borderBottom:"1px solid rgba(0,0,0,0.15)","&focused":{backgroundColor:"#f19654",color:"#fff",fontWeight:"400"}}}},a={};t.defaultStyle=r,t.defaultMentionStyle=a},278:function(e,t){},29:function(e,t,n){"use strict";(function(e){function r(){return o.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(r()<t)throw new RangeError("Invalid typed array length");return o.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=o.prototype):(null===e&&(e=new o(t)),e.length=t),e}function o(e,t,n){if(!o.TYPED_ARRAY_SUPPORT&&!(this instanceof o))return new o(e,t,n);if("number"===typeof e){if("string"===typeof t)throw new Error("If encoding is specified then the first argument must be a string");return u(this,e)}return i(this,e,t,n)}function i(e,t,n,r){if("number"===typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!==typeof ArrayBuffer&&t instanceof ArrayBuffer?p(e,t,n,r):"string"===typeof t?c(e,t,n):f(e,t)}function s(e){if("number"!==typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function l(e,t,n,r){return s(t),t<=0?a(e,t):void 0!==n?"string"===typeof r?a(e,t).fill(n,r):a(e,t).fill(n):a(e,t)}function u(e,t){if(s(t),e=a(e,t<0?0:0|h(t)),!o.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function c(e,t,n){if("string"===typeof n&&""!==n||(n="utf8"),!o.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|g(t,n);e=a(e,r);var i=e.write(t,n);return i!==r&&(e=e.slice(0,i)),e}function d(e,t){var n=t.length<0?0:0|h(t.length);e=a(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function p(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),o.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=o.prototype):e=d(e,t),e}function f(e,t){if(o.isBuffer(t)){var n=0|h(t.length);return e=a(e,n),0===e.length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!==typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!==typeof t.length||W(t.length)?a(e,0):d(e,t);if("Buffer"===t.type&&V(t.data))return d(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function h(e){if(e>=r())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r().toString(16)+" bytes");return 0|e}function m(e){return+e!=e&&(e=0),o.alloc(+e)}function g(e,t){if(o.isBuffer(e))return e.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!==typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return U(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return q(e).length;default:if(r)return U(e).length;t=(""+t).toLowerCase(),r=!0}}function y(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,t>>>=0,n<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return T(this,t,n);case"utf8":case"utf-8":return M(this,t,n);case"ascii":return L(this,t,n);case"latin1":case"binary":return I(this,t,n);case"base64":return k(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function v(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function b(e,t,n,r,a){if(0===e.length)return-1;if("string"===typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=a?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(a)return-1;n=e.length-1}else if(n<0){if(!a)return-1;n=0}if("string"===typeof t&&(t=o.from(t,r)),o.isBuffer(t))return 0===t.length?-1:w(e,t,n,r,a);if("number"===typeof t)return t&=255,o.TYPED_ARRAY_SUPPORT&&"function"===typeof Uint8Array.prototype.indexOf?a?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):w(e,[t],n,r,a);throw new TypeError("val must be string, number or Buffer")}function w(e,t,n,r,a){function o(e,t){return 1===i?e[t]:e.readUInt16BE(t*i)}var i=1,s=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;i=2,s/=2,l/=2,n/=2}var u;if(a){var c=-1;for(u=n;u<s;u++)if(o(e,u)===o(t,-1===c?0:u-c)){if(-1===c&&(c=u),u-c+1===l)return c*i}else-1!==c&&(u-=u-c),c=-1}else for(n+l>s&&(n=s-l),u=n;u>=0;u--){for(var d=!0,p=0;p<l;p++)if(o(e,u+p)!==o(t,p)){d=!1;break}if(d)return u}return-1}function E(e,t,n,r){n=Number(n)||0;var a=e.length-n;r?(r=Number(r))>a&&(r=a):r=a;var o=t.length;if(o%2!==0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var i=0;i<r;++i){var s=parseInt(t.substr(2*i,2),16);if(isNaN(s))return i;e[n+i]=s}return i}function S(e,t,n,r){return Q(U(t,e.length-n),e,n,r)}function C(e,t,n,r){return Q(H(t),e,n,r)}function D(e,t,n,r){return C(e,t,n,r)}function _(e,t,n,r){return Q(q(t),e,n,r)}function P(e,t,n,r){return Q(G(t,e.length-n),e,n,r)}function k(e,t,n){return 0===t&&n===e.length?K.fromByteArray(e):K.fromByteArray(e.slice(t,n))}function M(e,t,n){n=Math.min(e.length,n);for(var r=[],a=t;a<n;){var o=e[a],i=null,s=o>239?4:o>223?3:o>191?2:1;if(a+s<=n){var l,u,c,d;switch(s){case 1:o<128&&(i=o);break;case 2:l=e[a+1],128===(192&l)&&(d=(31&o)<<6|63&l)>127&&(i=d);break;case 3:l=e[a+1],u=e[a+2],128===(192&l)&&128===(192&u)&&(d=(15&o)<<12|(63&l)<<6|63&u)>2047&&(d<55296||d>57343)&&(i=d);break;case 4:l=e[a+1],u=e[a+2],c=e[a+3],128===(192&l)&&128===(192&u)&&128===(192&c)&&(d=(15&o)<<18|(63&l)<<12|(63&u)<<6|63&c)>65535&&d<1114112&&(i=d)}}null===i?(i=65533,s=1):i>65535&&(i-=65536,r.push(i>>>10&1023|55296),i=56320|1023&i),r.push(i),a+=s}return O(r)}function O(e){var t=e.length;if(t<=$)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=$));return n}function L(e,t,n){var r="";n=Math.min(e.length,n);for(var a=t;a<n;++a)r+=String.fromCharCode(127&e[a]);return r}function I(e,t,n){var r="";n=Math.min(e.length,n);for(var a=t;a<n;++a)r+=String.fromCharCode(e[a]);return r}function T(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var a="",o=t;o<n;++o)a+=J(e[o]);return a}function R(e,t,n){for(var r=e.slice(t,n),a="",o=0;o<r.length;o+=2)a+=String.fromCharCode(r[o]+256*r[o+1]);return a}function N(e,t,n){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function x(e,t,n,r,a,i){if(!o.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>a||t<i)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function F(e,t,n,r){t<0&&(t=65535+t+1);for(var a=0,o=Math.min(e.length-n,2);a<o;++a)e[n+a]=(t&255<<8*(r?a:1-a))>>>8*(r?a:1-a)}function Y(e,t,n,r){t<0&&(t=4294967295+t+1);for(var a=0,o=Math.min(e.length-n,4);a<o;++a)e[n+a]=t>>>8*(r?a:3-a)&255}function Z(e,t,n,r,a,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function j(e,t,n,r,a){return a||Z(e,t,n,4,3.4028234663852886e38,-3.4028234663852886e38),z.write(e,t,n,r,23,4),n+4}function A(e,t,n,r,a){return a||Z(e,t,n,8,1.7976931348623157e308,-1.7976931348623157e308),z.write(e,t,n,r,52,8),n+8}function B(e){if(e=X(e).replace(ee,""),e.length<2)return"";for(;e.length%4!==0;)e+="=";return e}function X(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function J(e){return e<16?"0"+e.toString(16):e.toString(16)}function U(e,t){t=t||1/0;for(var n,r=e.length,a=null,o=[],i=0;i<r;++i){if((n=e.charCodeAt(i))>55295&&n<57344){if(!a){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(i+1===r){(t-=3)>-1&&o.push(239,191,189);continue}a=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),a=n;continue}n=65536+(a-55296<<10|n-56320)}else a&&(t-=3)>-1&&o.push(239,191,189);if(a=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function H(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function G(e,t){for(var n,r,a,o=[],i=0;i<e.length&&!((t-=2)<0);++i)n=e.charCodeAt(i),r=n>>8,a=n%256,o.push(a),o.push(r);return o}function q(e){return K.toByteArray(B(e))}function Q(e,t,n,r){for(var a=0;a<r&&!(a+n>=t.length||a>=e.length);++a)t[a+n]=e[a];return a}function W(e){return e!==e}var K=n(706),z=n(707),V=n(466);t.Buffer=o,t.SlowBuffer=m,t.INSPECT_MAX_BYTES=50,o.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"===typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=r(),o.poolSize=8192,o._augment=function(e){return e.__proto__=o.prototype,e},o.from=function(e,t,n){return i(null,e,t,n)},o.TYPED_ARRAY_SUPPORT&&(o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&o[Symbol.species]===o&&Object.defineProperty(o,Symbol.species,{value:null,configurable:!0})),o.alloc=function(e,t,n){return l(null,e,t,n)},o.allocUnsafe=function(e){return u(null,e)},o.allocUnsafeSlow=function(e){return u(null,e)},o.isBuffer=function(e){return!(null==e||!e._isBuffer)},o.compare=function(e,t){if(!o.isBuffer(e)||!o.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,a=0,i=Math.min(n,r);a<i;++a)if(e[a]!==t[a]){n=e[a],r=t[a];break}return n<r?-1:r<n?1:0},o.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(e,t){if(!V(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return o.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=o.allocUnsafe(t),a=0;for(n=0;n<e.length;++n){var i=e[n];if(!o.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(r,a),a+=i.length}return r},o.byteLength=g,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)v(this,t,t+1);return this},o.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)v(this,t,t+3),v(this,t+1,t+2);return this},o.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)v(this,t,t+7),v(this,t+1,t+6),v(this,t+2,t+5),v(this,t+3,t+4);return this},o.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?M(this,0,e):y.apply(this,arguments)},o.prototype.equals=function(e){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===o.compare(this,e)},o.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},o.prototype.compare=function(e,t,n,r,a){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===a&&(a=this.length),t<0||n>e.length||r<0||a>this.length)throw new RangeError("out of range index");if(r>=a&&t>=n)return 0;if(r>=a)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,r>>>=0,a>>>=0,this===e)return 0;for(var i=a-r,s=n-t,l=Math.min(i,s),u=this.slice(r,a),c=e.slice(t,n),d=0;d<l;++d)if(u[d]!==c[d]){i=u[d],s=c[d];break}return i<s?-1:s<i?1:0},o.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},o.prototype.indexOf=function(e,t,n){return b(this,e,t,n,!0)},o.prototype.lastIndexOf=function(e,t,n){return b(this,e,t,n,!1)},o.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"===typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var a=this.length-t;if((void 0===n||n>a)&&(n=a),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return E(this,e,t,n);case"utf8":case"utf-8":return S(this,e,t,n);case"ascii":return C(this,e,t,n);case"latin1":case"binary":return D(this,e,t,n);case"base64":return _(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var $=4096;o.prototype.slice=function(e,t){var n=this.length;e=~~e,t=void 0===t?n:~~t,e<0?(e+=n)<0&&(e=0):e>n&&(e=n),t<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var r;if(o.TYPED_ARRAY_SUPPORT)r=this.subarray(e,t),r.__proto__=o.prototype;else{var a=t-e;r=new o(a,void 0);for(var i=0;i<a;++i)r[i]=this[i+e]}return r},o.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||N(e,t,this.length);for(var r=this[e],a=1,o=0;++o<t&&(a*=256);)r+=this[e+o]*a;return r},o.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||N(e,t,this.length);for(var r=this[e+--t],a=1;t>0&&(a*=256);)r+=this[e+--t]*a;return r},o.prototype.readUInt8=function(e,t){return t||N(e,1,this.length),this[e]},o.prototype.readUInt16LE=function(e,t){return t||N(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUInt16BE=function(e,t){return t||N(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUInt32LE=function(e,t){return t||N(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},o.prototype.readUInt32BE=function(e,t){return t||N(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||N(e,t,this.length);for(var r=this[e],a=1,o=0;++o<t&&(a*=256);)r+=this[e+o]*a;return a*=128,r>=a&&(r-=Math.pow(2,8*t)),r},o.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||N(e,t,this.length);for(var r=t,a=1,o=this[e+--r];r>0&&(a*=256);)o+=this[e+--r]*a;return a*=128,o>=a&&(o-=Math.pow(2,8*t)),o},o.prototype.readInt8=function(e,t){return t||N(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},o.prototype.readInt16LE=function(e,t){t||N(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt16BE=function(e,t){t||N(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt32LE=function(e,t){return t||N(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return t||N(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readFloatLE=function(e,t){return t||N(e,4,this.length),z.read(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return t||N(e,4,this.length),z.read(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return t||N(e,8,this.length),z.read(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return t||N(e,8,this.length),z.read(this,e,!1,52,8)},o.prototype.writeUIntLE=function(e,t,n,r){if(e=+e,t|=0,n|=0,!r){x(this,e,t,n,Math.pow(2,8*n)-1,0)}var a=1,o=0;for(this[t]=255&e;++o<n&&(a*=256);)this[t+o]=e/a&255;return t+n},o.prototype.writeUIntBE=function(e,t,n,r){if(e=+e,t|=0,n|=0,!r){x(this,e,t,n,Math.pow(2,8*n)-1,0)}var a=n-1,o=1;for(this[t+a]=255&e;--a>=0&&(o*=256);)this[t+a]=e/o&255;return t+n},o.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,1,255,0),o.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},o.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):F(this,e,t,!0),t+2},o.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):F(this,e,t,!1),t+2},o.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):Y(this,e,t,!0),t+4},o.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):Y(this,e,t,!1),t+4},o.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var a=Math.pow(2,8*n-1);x(this,e,t,n,a-1,-a)}var o=0,i=1,s=0;for(this[t]=255&e;++o<n&&(i*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/i>>0)-s&255;return t+n},o.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var a=Math.pow(2,8*n-1);x(this,e,t,n,a-1,-a)}var o=n-1,i=1,s=0;for(this[t+o]=255&e;--o>=0&&(i*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/i>>0)-s&255;return t+n},o.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,1,127,-128),o.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},o.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):F(this,e,t,!0),t+2},o.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):F(this,e,t,!1),t+2},o.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,4,2147483647,-2147483648),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):Y(this,e,t,!0),t+4},o.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):Y(this,e,t,!1),t+4},o.prototype.writeFloatLE=function(e,t,n){return j(this,e,t,!0,n)},o.prototype.writeFloatBE=function(e,t,n){return j(this,e,t,!1,n)},o.prototype.writeDoubleLE=function(e,t,n){return A(this,e,t,!0,n)},o.prototype.writeDoubleBE=function(e,t,n){return A(this,e,t,!1,n)},o.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var a,i=r-n;if(this===e&&n<t&&t<r)for(a=i-1;a>=0;--a)e[a+t]=this[a+n];else if(i<1e3||!o.TYPED_ARRAY_SUPPORT)for(a=0;a<i;++a)e[a+t]=this[a+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+i),t);return i},o.prototype.fill=function(e,t,n,r){if("string"===typeof e){if("string"===typeof t?(r=t,t=0,n=this.length):"string"===typeof n&&(r=n,n=this.length),1===e.length){var a=e.charCodeAt(0);a<256&&(e=a)}if(void 0!==r&&"string"!==typeof r)throw new TypeError("encoding must be a string");if("string"===typeof r&&!o.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"===typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0);var i;if("number"===typeof e)for(i=t;i<n;++i)this[i]=e;else{var s=o.isBuffer(e)?e:U(new o(e,r).toString()),l=s.length;for(i=0;i<n-t;++i)this[i+t]=s[i%l]}return this};var ee=/[^+\/0-9A-Za-z-_]/g}).call(t,n(30))},3:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Utils=void 0;var a=n(2),o=n(21),i=n(14),s=r(i),l=n(0),u=r(l),c=n(5),d=r(c),p=n(26),f=r(p),h=t.Utils={keyCodes:{esc:27,space:32,tab:9,up:38,down:40},bytesToSize:function(e){if("undefined"==typeof e)return" ";if(e<0)return"--";var t=["bytes","KB","MB","GB","TB","PB"];if(0===e)return e+" "+t[0];var n=parseInt(Math.floor(Math.log(e)/Math.log(1e3)),10);return 0===n?e+" "+t[n]:(e/Math.pow(1e3,n)).toFixed(1)+" "+t[n]},isHiDPI:function(){return(window.devicePixelRatio?window.devicePixelRatio:1)>1},isDesktop:function(){return window.innerWidth>=768},isWeChat:function(){var e=window.navigator.userAgent.toLowerCase(),t="micromessenger"==e.match(/MicroMessenger/i);return"micromessenger"==e.match(/MicroMessenger/i)&&"wxwork"==e.match(/wxwork/i)||t},FILEEXT_ICON_MAP:{md:"txt.png",txt:"txt.png",pdf:"pdf.png",doc:"word.png",docx:"word.png",odt:"word.png",fodt:"word.png",ppt:"ppt.png",pptx:"ppt.png",odp:"ppt.png",fodp:"ppt.png",xls:"excel.png",xlsx:"excel.png",ods:"excel.png",fods:"excel.png",mp4:"video.png",ogv:"video.png",webm:"video.png",mov:"video.png",flv:"video.png",wmv:"video.png",rmvb:"video.png",mp3:"music.png",oga:"music.png",ogg:"music.png",flac:"music.png",aac:"music.png",ac3:"music.png",wma:"music.png",jpg:"pic.png",jpeg:"pic.png",png:"pic.png",svg:"pic.png",gif:"pic.png",bmp:"pic.png",ico:"pic.png",default:"file.png"},imageCheck:function(e){return-1!=e.lastIndexOf(".")&&-1!=["gif","jpeg","jpg","png","ico","bmp","tif","tiff"].indexOf(e.substr(e.lastIndexOf(".")+1).toLowerCase())},getShareLinkPermissionList:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=[];return"library"===e?a.push("preview_download"):"dir"===e?"rw"!=t&&"admin"!=t&&"r"!=t||a.push("preview_download"):"file"===e&&("rw"!=t&&"admin"!=t&&"r"!=t||a.push("preview_download"),this.isEditableOfficeFile(n)&&("rw"==t||"admin"==t)&&r&&a.push("edit_download")),a.push("preview_only"),a},getShareLinkPermissionStr:function(e){var t=e.can_edit,n=e.can_download;return t?n?"edit_download":"cloud_edit":n?"preview_download":"preview_only"},isEditableOfficeFile:function(e){return-1!=e.lastIndexOf(".")&&-1!=["docx","pptx","xlsx"].indexOf(e.substr(e.lastIndexOf(".")+1).toLowerCase())},videoCheck:function(e){return-1!=e.lastIndexOf(".")&&-1!=["mp4","ogv","webm","mov"].indexOf(e.substr(e.lastIndexOf(".")+1).toLowerCase())},checkDuplicatedNameInList:function(e,t){return e.some(function(e){return e.name===t})},encodePath:function(e){if(!e)return"";for(var t=e.split("/"),n=[],r=0,a=t.length;r<a;r++)n.push(encodeURIComponent(t[r]));return n.join("/")},HTMLescape:function(e){return document.createElement("div").appendChild(document.createTextNode(e)).parentNode.innerHTML},generateDialogTitle:function(e,t){var n=this.HTMLescape(t),r='<span class="op-target ellipsis ellipsis-op-target" title='+n+">"+n+"</span>";return e.replace("{placeholder}",r)},getFileName:function(e){var t=e.lastIndexOf("/");return e.slice(t+1)},getPaths:function(e){for(var t=e.split("/").slice(1),n=[];t.length;)n.push("/"+t.join("/")),t.pop();return n.reverse()},getFolderName:function(e){return"/"===e?e:(e="/"!==e[e.length-1]?e:e.slice(0,e.length-2),e.slice(e.lastIndexOf("/")+1))},getDirName:function(e){var t=e.slice(0,e.lastIndexOf("/"));return""===t?"/":t},isChildPath:function(e,t){return this.getDirName(e)===t},isAncestorPath:function(e,t){return t.indexOf(e)>-1},renameAncestorPath:function(e,t,n){return e.replace(t,n)},joinPath:function(e,t){return"/"===e[e.length-1]?e+t:e+"/"+t},isSupportUploadFolder:function(){return-1!=navigator.userAgent.indexOf("Firefox")||navigator.userAgent.indexOf("Chrome")>-1||navigator.userAgent.indexOf("Safari")>-1},isIEBrower:function(){var e=navigator.userAgent,t=e.indexOf("compatible")>-1&&e.indexOf("MSIE")>-1,n=e.indexOf("Trident")>-1&&e.indexOf("rv:11.0")>-1;return t||n},getDefaultLibIconUrl:function(e){var t=h.isHiDPI()?48:24;t=e?256:t;return a.mediaUrl+"img/lib/"+t+"/lib.png"},getLibIconUrl:function(e,t){var n=e.permission||e.share_permission,r=h.isHiDPI()?48:24;r=t?256:r;var o="lib.png";switch(e.encrypted&&(o="lib-encrypted.png"),n){case"r":o="lib-readonly.png";break;case"preview":o="lib-cloud-preview.png";break;case"cloud-edit":o="lib-cloud-preview-edit.png"}return"read-only"==e.status&&(o="lib-readonly.png"),a.mediaUrl+"img/lib/"+r+"/"+o},getDirentIcon:function(e,t){var n=this.isHiDPI()?48:24;if(n=t?192:n,e.isDir()){var r=!1;return!e.permission||"r"!==e.permission&&"preview"!==e.permission||(r=!0),this.getFolderIconUrl(r,n)}return this.getFileIconUrl(e.name,n)},getAdminTemplateDirentIcon:function(e,t){var n=this.isHiDPI()?48:24;return n=t?192:n,e.is_file?this.getFileIconUrl(e.obj_name,n):this.getFolderIconUrl()},getFolderIconUrl:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments[1];return t||(t=h.isHiDPI()?48:24),t=t>24?192:24,a.mediaUrl+"img/folder"+(e?"-read-only-":"-")+t+".png"},getFileIconUrl:function(e,t){t||(t=h.isHiDPI()?48:24),t=t>24?192:24;var n="";return-1==e.lastIndexOf(".")?a.mediaUrl+"img/file/"+t+"/"+this.FILEEXT_ICON_MAP.default:(n=e.substr(e.lastIndexOf(".")+1).toLowerCase(),this.FILEEXT_ICON_MAP[n]?a.mediaUrl+"img/file/"+t+"/"+this.FILEEXT_ICON_MAP[n]:a.mediaUrl+"img/file/"+t+"/"+this.FILEEXT_ICON_MAP.default)},getLibIconTitle:function(e){var t,n=e.permission||e.share_permission;if(e.encrypted)t=(0,a.gettext)("Encrypted library");else if(e.is_admin)t=(0,a.gettext)("Admin access");else switch(n){case"rw":t=(0,a.gettext)("Read-Write library");break;case"r":t=(0,a.gettext)("Read-Only library");break;case"cloud-edit":t=(0,a.gettext)("Online Read-Write library");break;case"preview":t=(0,a.gettext)("Online Read-Only library")}return t},getFolderIconTitle:function(e){var t;switch(e.permission){case"rw":t=(0,a.gettext)("Read-Write folder");break;case"r":t=(0,a.gettext)("Read-Only folder");break;case"cloud-edit":t=(0,a.gettext)("Online Read-Write folder");break;case"preview":t=(0,a.gettext)("Online Read-Only folder")}return t},getFolderOperationList:function(e,t,n,r){var o=[],i=s.default.SHARE,l=s.default.DOWNLOAD,u=s.default.DELETE,c=s.default.RENAME,d=s.default.MOVE,p=s.default.COPY,f=s.default.PERMISSION,m=s.default.OPEN_VIA_CLIENT,g=n.permission;return r&&("rw"!=g&&"r"!=g||o.push(l),h.isHasPermissionToShare(t,g,n)&&o.push(i),"rw"==g&&o.push(u,"Divider")),"rw"==g&&(o.push(c,d,p),a.folderPermEnabled&&(e&&t.has_been_shared_out||t.is_admin)&&o.push("Divider",f),o.push("Divider",m)),"r"!=g||t.encrypted||o.push(p),o},getFileOperationList:function(e,t,n,r){var o=[],i=s.default.SHARE,l=s.default.DOWNLOAD,u=s.default.DELETE,c=s.default.RENAME,d=s.default.MOVE,p=s.default.COPY,f=s.default.TAGS,m=s.default.UNLOCK,g=s.default.LOCK,y=s.default.COMMENT,v=s.default.HISTORY,b=s.default.ACCESS_LOG,w=s.default.OPEN_VIA_CLIENT,E=n.permission;return r&&("rw"!=E&&"r"!=E||o.push(l),h.isHasPermissionToShare(t,E,n)&&o.push(i),"rw"==E&&(!n.is_locked||n.is_locked&&n.locked_by_me)&&o.push(u),o.push("Divider")),"rw"==E&&((!n.is_locked||n.is_locked&&n.locked_by_me)&&o.push(c,d),o.push(p,f),a.isPro&&(n.is_locked?(n.locked_by_me||"OnlineOffice"==n.lock_owner||e||t.is_admin)&&o.push(m):o.push(g)),o.push("Divider"),a.enableFileComment&&o.push(y),o.push(v),a.isPro&&a.fileAuditEnabled&&o.push(b),o.push("Divider",w)),"r"==E&&(t.encrypted||o.push(p),a.enableFileComment&&o.push(y),o.push(v)),o},getDirentOperationList:function(e,t,n,r){return"dir"==n.type?h.getFolderOperationList(e,t,n,r):h.getFileOperationList(e,t,n,r)},sharePerms:function(e){var t;switch(e){case"rw":t=(0,a.gettext)("Read-Write");break;case"r":t=(0,a.gettext)("Read-Only");break;case"admin":t=(0,a.gettext)("Admin");break;case"cloud-edit":t=(0,a.gettext)("Online Read-Write");break;case"preview":t=(0,a.gettext)("Online Read-Only")}return t},sharePermsExplanation:function(e){var t;switch(e){case"rw":t=(0,a.gettext)("User can read, write, upload, download and sync files.");break;case"r":t=(0,a.gettext)("User can read, download and sync files.");break;case"admin":t=(0,a.gettext)("Besides Write permission, user can also share the library.");break;case"cloud-edit":t=(0,a.gettext)("User can view and edit file online via browser. Files can't be downloaded.");break;case"preview":t=(0,a.gettext)("User can only view files online via browser. Files can't be downloaded.")}return t},getShareLinkPermissionObject:function(e){switch(e){case"preview_download":return{value:e,text:(0,a.gettext)("Preview and download"),permissionDetails:{can_edit:!1,can_download:!0}};case"preview_only":return{value:e,text:(0,a.gettext)("Preview only"),permissionDetails:{can_edit:!1,can_download:!1}};case"edit_download":return{value:e,text:(0,a.gettext)("Edit on cloud and download"),permissionDetails:{can_edit:!0,can_download:!0}};case"cloud_edit":return{value:e,text:(0,a.gettext)("Edit on cloud only"),permissionDetails:{can_edit:!0,can_download:!1}}}return{text:""}},formatSize:function(e){var t=e.bytes,n=e.precision||0;return t>=0&&t<1e3?t+" B":t>=1e3&&t<1e6?(t/1e3).toFixed(n)+" KB":t>=1e6&&t<1e9?(t/1e6).toFixed(n)+" MB":t>=1e9&&t<1e12?(t/1e9).toFixed(n)+" GB":t>=1e12?(t/1e12).toFixed(n)+" TB":t+" B"},formatBitRate:function(e){var t;return"number"!==typeof e?"":(t=e/8,t>=1e9?(t/1e9).toFixed(2)+" GB/s":t>=1e6?(t/1e6).toFixed(2)+" MB/s":t>=1e3?(t/1e3).toFixed(2)+" kB/s":t.toFixed(2)+" B/s")},isMarkdownFile:function(e){var t=e.lastIndexOf(".");if(-1===t)return!1;var n=e.substring(t).toLowerCase();return".md"===n||".markdown"===n},isInternalFileLink:function(e,t){return new RegExp(a.serviceURL+"/lib/"+t+"/file.*").test(e)},isInternalMarkdownLink:function(e,t){return new RegExp(a.serviceURL+"/lib/"+t+".*.md$").test(e)},isInternalDirLink:function(e,t){return new RegExp(a.serviceURL+"/library/"+t+".*").test(e)},getPathFromInternalMarkdownLink:function(e,t){var n=new RegExp(a.serviceURL+"/lib/"+t+"/file(.*.md)"),r=n.exec(e);return decodeURIComponent(r[1])},getPathFromInternalDirLink:function(e,t){var n=new RegExp(a.serviceURL+"/library/"+t+"(/.*)"),r=n.exec(e),o=decodeURIComponent(r[1]);return o=o.slice(1),o=o.slice(o.indexOf("/"))},isWikiInternalMarkdownLink:function(e,t){return t=encodeURIComponent(t),new RegExp(a.serviceURL+"/published/"+t+".*.md$").test(e)},isWikiInternalDirLink:function(e,t){return t=encodeURIComponent(t),new RegExp(a.serviceURL+"/published/"+t+".*").test(e)},getPathFromWikiInternalMarkdownLink:function(e,t){t=encodeURIComponent(t);var n=new RegExp(a.serviceURL+"/published/"+t+"(.*.md)"),r=n.exec(e),o=r[1];try{o=decodeURIComponent(o)}catch(e){o=o.replace(/%/g,"%25"),o=decodeURIComponent(o)}return o},getPathFromWikiInternalDirLink:function(e,t){t=encodeURIComponent(t);var n=new RegExp(a.serviceURL+"/published/"+t+"(/.*)"),r=n.exec(e),o=r[1];try{o=decodeURIComponent(o)}catch(e){o=o.replace(/%/g,"%25"),o=decodeURIComponent(o)}return o},compareTwoWord:function(e,t){var n,r,a=e.charCodeAt(0),i=t.charCodeAt(0);return 19968<a&&a<40869&&19968<i&&i<40869?(n=o.strChineseFirstPY.charAt(a-19968).toLowerCase(),r=o.strChineseFirstPY.charAt(i-19968).toLowerCase(),n>=r?1:-1):19968<a&&a<40869&&!(19968<i&&i<40869)?1:!(19968<a&&a<40869)&&19968<i&&i<40869?-1:(n=e.toLowerCase(),r=t.toLowerCase(),this.compareStrWithNumbersIn(n,r))},compareStrWithNumbersIn:function(e,t){var n,r,a,o=/\d+|\D+/g,i=/\d/,s=e.match(o),l=t.match(o),u=Math.min(s.length,l.length);if(s&&l&&(n=i.test(s[0]))==i.test(l[0]))for(var c=0;c<u;c++){if(r=s[c],a=l[c],n&&(r=parseInt(r,10),a=parseInt(a,10)),r!=a)return r<a?-1:1;n=!n}return(e>=t)-(e<=t)},sortRepos:function(e,t,n){var r=this,a=void 0;switch(t+"-"+n){case"name-asc":a=function(e,t){return e.repo_name?t.repo_name?r.compareTwoWord(e.repo_name,t.repo_name):-1:1};break;case"name-desc":a=function(e,t){return e.repo_name?t.repo_name?-r.compareTwoWord(e.repo_name,t.repo_name):1:-1};break;case"time-asc":a=function(e,t){return e.last_modified<t.last_modified?-1:1};break;case"time-desc":a=function(e,t){return e.last_modified<t.last_modified?1:-1};break;case"size-asc":a=function(e,t){if(e.size===t.size){return r.compareTwoWord(e.repo_name,t.repo_name)}return e.size_original<t.size_original?-1:1};break;case"size-desc":a=function(e,t){if(e.size===t.size){return-r.compareTwoWord(e.repo_name,t.repo_name)}return e.size_original<t.size_original?1:-1}}return e.sort(a),e},sortDirents:function(e,t,n){var r=this,a=void 0;switch(t+"-"+n){case"name-asc":a=function(e,t){return r.compareTwoWord(e.name,t.name)};break;case"name-desc":a=function(e,t){return-r.compareTwoWord(e.name,t.name)};break;case"time-asc":a=function(e,t){return e.mtime<t.mtime?-1:1};break;case"time-desc":a=function(e,t){return e.mtime<t.mtime?1:-1};break;case"size-asc":a=function(e,t){return"dir"==e.type&&"dir"==t.type?0:e.size_original<t.size_original?-1:1};break;case"size-desc":a=function(e,t){return"dir"==e.type&&"dir"==t.type?0:e.size_original<t.size_original?1:-1}}return e.sort(function(e,t){return"dir"==e.type&&"file"==t.type?-1:"file"==e.type&&"dir"==t.type?1:a(e,t)}),e},sortDirentsInSharedDir:function(e,t,n){var r=this,a=void 0;switch(t+"-"+n){case"name-asc":a=function(e,t){return e.is_dir?r.compareTwoWord(e.folder_name,t.folder_name):r.compareTwoWord(e.file_name,t.file_name)};break;case"name-desc":a=function(e,t){return-(e.is_dir?r.compareTwoWord(e.folder_name,t.folder_name):r.compareTwoWord(e.file_name,t.file_name))};break;case"time-asc":a=function(e,t){return e.last_modified<t.last_modified?-1:1};break;case"time-desc":a=function(e,t){return e.last_modified<t.last_modified?1:-1};break;case"size-asc":a=function(e,t){return e.is_dir?0:e.size<t.size?-1:1};break;case"size-desc":a=function(e,t){return e.is_dir?0:e.size<t.size?1:-1}}return e.sort(function(e,t){return e.is_dir&&!t.is_dir?-1:!e.is_dir&&t.is_dir?1:a(e,t)}),e},getErrorMsg:function(e,t){var n="";return e.response?403==e.response.status?(t&&d.default.danger(u.default.createElement(f.default,null),{id:"permission_denied",duration:3600}),n=(0,a.gettext)("Permission denied")):n=e.response.data&&e.response.data.error_msg?e.response.data.error_msg:(0,a.gettext)("Error"):n=(0,a.gettext)("Please check the network."),n},changeMarkdownNodes:function(e,t){return e.map(function(e){t(e),e.nodes&&e.nodes.length>0&&h.changeMarkdownNodes(e.nodes,t)}),e},chooseLanguage:function(e){var t=void 0;switch(e){case"py":t="python";break;case"js":t="javascript";break;case"c":t="text/x-csrc";break;case"cpp":t="text/x-c++src";break;case"java":t="text/x-java";break;case"cs":t="text/x-csharp";break;case"mdf":t="text/x-sql";break;case"html":t="htmlmixed";break;default:t=e}return t},DARK_COLOR_MAP:{red:"#D11507",orange:"#FF8C00",yellow:"#EDEF00",green:"#006400",cyan:"#00E0E1",blue:"#2510A3",indigo:"#350C56",purple:"#551054",pink:"#E3A5B0",azure:"#C4D0D0",lime:"#00E100",teal:"#006A6B",gray:"#545454","#FFA8A8":"#E49090","#FFA94D":"#E39136","#FFD43B":"#E0B815","#A0EC50":"#83CF32","#A9E34B":"#8DC72E","#63E6BE":"#43CAA4","#4FD2C9":"#2DB9B0","#72C3FC":"#57ABE3","#91A7FF":"#7A91E7","#E599F7":"#CC82DE","#B197FC":"#9B82E5","#F783AC":"#DF6D97","#CED4DA":"#A8ADB2"},getDarkColor:function(e){return this.DARK_COLOR_MAP[e]},getCopySuccessfulMessage:function(e){var t=void 0,n=e.length;return 1===n?t=(0,a.gettext)("Successfully copied %(name)s."):2===n?t=(0,a.gettext)("Successfully copied %(name)s and 1 other item."):(t=(0,a.gettext)("Successfully copied %(name)s and %(amount)s other items."),t=t.replace("%(amount)s",n-1)),t=t.replace("%(name)s",e[0])},getMoveSuccessMessage:function(e){var t=void 0,n=e.length;return 1===n?t=(0,a.gettext)("Successfully moved %(name)s."):2===n?t=(0,a.gettext)("Successfully moved %(name)s and 1 other item."):(t=(0,a.gettext)("Successfully moved %(name)s and %(amount)s other items."),t=t.replace("%(amount)s",n-1)),t=t.replace("%(name)s",e[0])},getCopyFailedMessage:function(e){var t=void 0,n=e.length;return n>1?(t=(0,a.gettext)("Failed to copy %(name)s and %(amount)s other item(s)."),t=t.replace("%(amount)s",n-1)):t=(0,a.gettext)("Failed to copy %(name)s."),t=t.replace("%(name)s",e[0])},getMoveFailedMessage:function(e){var t=void 0,n=e.length;return n>1?(t=(0,a.gettext)("Failed to move %(name)s and %(amount)s other item(s)."),t=t.replace("%(amount)s",n-1)):t=(0,a.gettext)("Failed to move %(name)s."),t=t.replace("%(name)s",e[0])},handleSearchedItemClick:function(e){if(!0===e.is_dir){var t=a.siteRoot+"library/"+e.repo_id+"/"+e.repo_name+e.path;window.open("about:blank").location.href=t}else{var n=a.siteRoot+"lib/"+e.repo_id+"/file"+h.encodePath(e.path);window.open("about:blank").location.href=n}},generatePassword:function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz0123456789",n="",r=0;r<e;r++)n+=t.charAt(Math.floor(Math.random()*t.length));return n},pathNormalize:function(e){for(var t=e.split("/"),n=[],r=0;r<t.length;r++)"."!==t[r]&&""!==t[r]&&(".."===t[r]?n.pop():n.push(t[r]));return n.join("/")},getEventData:function(e,t){return e.target.dataset?e.target.dataset[t]:e.target.getAttribute("data-"+t)},isHasPermissionToShare:function(e,t,n){var r=e.is_admin,o=e.is_virtual,i=e.encrypted,s=e.owner_email,l=s===a.username;if(i)return!0;if(n&&("rw"==t||"r"==t))return!0;if(a.canGenerateShareLink&&("rw"==t||"r"==t))return!0;if(a.canGenerateUploadLink&&"rw"==t)return!0;return!(o||!l&&!r)&&!0},registerGlobalVariable:function(e,t,n){window[e]||(window[e]={}),window[e][t]=n},formatTime:function(e){var t=parseInt(e),n=0,r=0;t>60&&(n=parseInt(t/60),t=parseInt(t%60)),n>60&&(r=parseInt(n/60),n=parseInt(n%60));var a=("00"+parseInt(t)).slice(-2);return a=n>0?("00"+parseInt(n)).slice(-2)+":"+a:"00:"+a,a=r>0?("00"+parseInt(r)).slice(-2)+":"+a:"00:"+a},hasNextPage:function(e,t,n){return e*t<n}}},31:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(10),f=r(p),h=n(3),m=n(4),g=n(2),y=n(5),v=r(y),b={isAdminPanel:d.default.bool},w=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getContainer=function(){return f.default.findDOMNode(n)},n.handleProps=function(){n.state.showInfo?n.addEvents():n.removeEvents()},n.addEvents=function(){["click","touchstart","keyup"].forEach(function(e){return document.addEventListener(e,n.handleDocumentClick,!0)})},n.removeEvents=function(){["click","touchstart","keyup"].forEach(function(e){return document.removeEventListener(e,n.handleDocumentClick,!0)})},n.handleDocumentClick=function(e){if(!e||3!==e.which&&("keyup"!==e.type||e.which===h.Utils.keyCodes.tab)){var t=n.getContainer();(!t.contains(e.target)||t===e.target||"keyup"===e.type&&e.which!==h.Utils.keyCodes.tab)&&n.setState({showInfo:!n.state.showInfo})}},n.onClickAccount=function(){n.isFirstMounted?(m.seafileAPI.getAccountInfo().then(function(e){n.setState({userName:e.data.name,contactEmail:e.data.email,usageRate:e.data.space_usage,quotaUsage:h.Utils.bytesToSize(e.data.usage),quotaTotal:h.Utils.bytesToSize(e.data.total),isStaff:e.data.is_staff,isInstAdmin:e.data.is_inst_admin,isOrgStaff:1===e.data.is_org_staff,showInfo:!n.state.showInfo})}).catch(function(e){var t=h.Utils.getErrorMsg(e);v.default.danger(t)}),n.isFirstMounted=!1):n.setState({showInfo:!n.state.showInfo})},n.renderMenu=function(){var e=void 0,t=n.state,r=t.isStaff,a=t.isOrgStaff,o=t.isInstAdmin;return n.props.isAdminPanel?r?e={url:g.siteRoot,text:(0,g.gettext)("Exit System Admin")}:a?e={url:g.siteRoot,text:(0,g.gettext)("Exit Organization Admin")}:o&&(e={url:g.siteRoot,text:(0,g.gettext)("Exit Institution Admin")}):r?e={url:g.siteRoot+"sys/info/",text:(0,g.gettext)("System Admin")}:a?e={url:g.siteRoot+"org/useradmin/",text:(0,g.gettext)("Organization Admin")}:o&&(e={url:g.siteRoot+"inst/useradmin/",text:(0,g.gettext)("Institution Admin")}),e&&u.default.createElement("a",{href:e.url,title:e.text,className:"item"},e.text)},n.renderAvatar=function(){return u.default.createElement("img",{src:g.appAvatarURL,width:"36",height:"36",className:"avatar",alt:(0,g.gettext)("Avatar")})},n.state={showInfo:!1,userName:"",contactEmail:"",quotaUsage:"",quotaTotal:"",isStaff:!1,isOrgStaff:!1,usageRate:""},n.isFirstMounted=!0,n}return i(t,e),s(t,[{key:"componentDidUpdate",value:function(e){this.handleProps()}},{key:"render",value:function(){return u.default.createElement("div",{id:"account"},u.default.createElement("a",{id:"my-info",onClick:this.onClickAccount,className:"account-toggle no-deco d-none d-md-block","aria-label":"View profile and more"},u.default.createElement("span",null,this.renderAvatar()),u.default.createElement("span",{className:"fas fa-caret-down vam"})),u.default.createElement("span",{className:"account-toggle sf2-icon-more mobile-icon d-md-none","aria-label":"View profile and more",onClick:this.onClickAccount}),u.default.createElement("div",{id:"user-info-popup",className:"account-popup sf-popover "+(this.state.showInfo?"":"hide")},u.default.createElement("div",{className:"outer-caret up-outer-caret"},u.default.createElement("div",{className:"inner-caret"})),u.default.createElement("div",{className:"sf-popover-con"},u.default.createElement("div",{className:"item o-hidden"},this.renderAvatar(),u.default.createElement("div",{className:"txt"},this.state.userName)),u.default.createElement("div",{id:"space-traffic"},u.default.createElement("div",{className:"item"},u.default.createElement("p",null,(0,g.gettext)("Used:")," ",this.state.quotaUsage," / ",this.state.quotaTotal),u.default.createElement("div",{id:"quota-bar"},u.default.createElement("span",{id:"quota-usage",className:"usage",style:{width:this.state.usageRate}})))),u.default.createElement("a",{href:g.siteRoot+"profile/",className:"item"},(0,g.gettext)("Settings")),this.renderMenu(),u.default.createElement("a",{href:g.logoutUrl,className:"item"},(0,g.gettext)("Log out")))))}}]),t}(l.Component);w.defaultProps={isAdminPanel:!1},w.propTypes=b,t.default=w},34:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t){var n=t.path,a=t.object,o=t.isLoaded,i=t.isPreload,s=t.isExpanded,l=t.parentNode;r(this,e),this.path=n||a.name,this.object=a,this.isLoaded=o||!1,this.isPreload=i||!1,this.isExpanded=s||!1,this.children=[],this.parentNode=l||null}return a(e,[{key:"clone",value:function(t){var n=new e({path:this.path,object:this.object.clone(),isLoaded:this.isLoaded,isPreload:this.isPreload,isExpanded:this.isExpanded,parentNode:t||null});return n.children=this.children.map(function(e){return e.clone(n)}),n}},{key:"setParent",value:function(e){this.path=this.generatePath(e),this.parentNode=e,this.isLoaded=!1}},{key:"hasChildren",value:function(){return 0!==this.children.length}},{key:"addChild",value:function(e){e.setParent(this);var t=this.children;if(e.object.isDir())this.children.unshift(e);else{for(var n=-1,r=0;r<t.length;r++)if(!t[r].object.isDir()){n=r;break}-1===n?this.children.push(e):0===n?this.children.unshift(e):this.children.splice(n,0,e)}}},{key:"addChildren",value:function(e){var t=this;e.forEach(function(e){e.setParent(t)}),this.children=e}},{key:"deleteChild",value:function(e){var t=this.children.filter(function(t){return t!==e});this.children=t}},{key:"rename",value:function(e){this.object.name=e,this.path=this.generatePath(this.parentNode),this.isExpanded?this.updateChildrenPath(this):this.isLoaded=!1}},{key:"updateChildrenPath",value:function(e){e.children.forEach(function(e){e.path=e.generatePath(e.parentNode),e.isExpanded?e.updateChildrenPath(e):e.isLoaded=!1})}},{key:"updateObjectProperties",value:function(e,t){var n=this;Array.isArray(e)&&Array.isArray(t)?e.forEach(function(e,r){n.object[e]=t[r]}):this.object[e]=t}},{key:"generatePath",value:function(e){return"/"===e.path?e.path+this.object.name:e.path+"/"+this.object.name}},{key:"serializeToJson",value:function(){var e=[];return this.hasChildren&&(e=this.children.map(function(e){return e.serializeToJson()})),{path:this.path,object:this.object.clone(),isLoaded:this.isLoaded,isPreload:this.isPreload,isExpanded:this.isExpanded,parentNode:this.parentNode,children:e}}}],[{key:"deserializefromJson",value:function(t){var n=t.path,r=t.object,a=t.isLoaded,o=t.isPreload,i=t.isExpanded,s=t.parentNode,l=t.children,u=void 0===l?[]:l;return r=r.clone(),new e({path:n,object:r,isLoaded:a,isPreload:o,isExpanded:i,parentNode:s,children:u.map(function(t){return e.deserializefromJson(t)})})}}]),e}();t.default=o},344:function(e,t){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var t=e,a=e.indexOf("["),o=e.indexOf("]");-1!=a&&-1!=o&&(e=e.substring(0,a)+e.substring(a,o).replace(/:/g,";")+e.substring(o,e.length));for(var i=n.exec(e||""),s={},l=14;l--;)s[r[l]]=i[l]||"";return-1!=a&&-1!=o&&(s.source=t,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s}},345:function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},346:function(e,t,n){(function(t){function n(e){return r&&t.isBuffer(e)||a&&(e instanceof ArrayBuffer||o(e))}e.exports=n;var r="function"===typeof t&&"function"===typeof t.isBuffer,a="function"===typeof ArrayBuffer,o=function(e){return"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer}}).call(t,n(29).Buffer)},347:function(e,t,n){function r(e,t){if(!(this instanceof r))return new r(e,t);e&&"object"===typeof e&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new p({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var n=t.parser||s;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}var a=n(708),o=n(352),i=n(106),s=n(236),l=n(353),u=n(354),c=n(172)("socket.io-client:manager"),d=n(262),p=n(724),f=Object.prototype.hasOwnProperty;e.exports=r,r.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var e in this.nsps)f.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},r.prototype.updateSocketIds=function(){for(var e in this.nsps)f.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},r.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},i(r.prototype),r.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},r.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},r.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},r.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},r.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},r.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},r.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},r.prototype.open=r.prototype.connect=function(e,t){if(c("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;c("opening %s",this.uri),this.engine=a(this.uri,this.opts);var n=this.engine,r=this;this.readyState="opening",this.skipReconnect=!1;var o=l(n,"open",function(){r.onopen(),e&&e()}),i=l(n,"error",function(t){if(c("connect_error"),r.cleanup(),r.readyState="closed",r.emitAll("connect_error",t),e){var n=new Error("Connection error");n.data=t,e(n)}else r.maybeReconnectOnOpen()});if(!1!==this._timeout){var s=this._timeout;c("connect attempt will timeout after %d",s);var u=setTimeout(function(){c("connect attempt timed out after %d",s),o.destroy(),n.close(),n.emit("error","timeout"),r.emitAll("connect_timeout",s)},s);this.subs.push({destroy:function(){clearTimeout(u)}})}return this.subs.push(o),this.subs.push(i),this},r.prototype.onopen=function(){c("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(l(e,"data",u(this,"ondata"))),this.subs.push(l(e,"ping",u(this,"onping"))),this.subs.push(l(e,"pong",u(this,"onpong"))),this.subs.push(l(e,"error",u(this,"onerror"))),this.subs.push(l(e,"close",u(this,"onclose"))),this.subs.push(l(this.decoder,"decoded",u(this,"ondecoded")))},r.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},r.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},r.prototype.ondata=function(e){this.decoder.add(e)},r.prototype.ondecoded=function(e){this.emit("packet",e)},r.prototype.onerror=function(e){c("error",e),this.emitAll("error",e)},r.prototype.socket=function(e,t){function n(){~d(a.connecting,r)||a.connecting.push(r)}var r=this.nsps[e];if(!r){r=new o(this,e,t),this.nsps[e]=r;var a=this;r.on("connecting",n),r.on("connect",function(){r.id=a.generateId(e)}),this.autoConnect&&n()}return r},r.prototype.destroy=function(e){var t=d(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},r.prototype.packet=function(e){c("writing packet %j",e);var t=this;e.query&&0===e.type&&(e.nsp+="?"+e.query),t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,function(n){for(var r=0;r<n.length;r++)t.engine.write(n[r],e.options);t.encoding=!1,t.processPacketQueue()}))},r.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},r.prototype.cleanup=function(){c("cleanup");for(var e=this.subs.length,t=0;t<e;t++){this.subs.shift().destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},r.prototype.close=r.prototype.disconnect=function(){c("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},r.prototype.onclose=function(e){c("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},r.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)c("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();c("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var n=setTimeout(function(){e.skipReconnect||(c("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open(function(t){t?(c("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(c("reconnect success"),e.onreconnect())}))},t);this.subs.push({destroy:function(){clearTimeout(n)}})}},r.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},348:function(e,t,n){function r(e){var t=!1,n=!1,r=!1!==e.jsonp;if("undefined"!==typeof location){var s="https:"===location.protocol,l=location.port;l||(l=s?443:80),t=e.hostname!==location.hostname||l!==e.port,n=e.secure!==s}if(e.xdomain=t,e.xscheme=n,"open"in new a(e)&&!e.forceJSONP)return new o(e);if(!r)throw new Error("JSONP disabled");return new i(e)}var a=n(237),o=n(711),i=n(720),s=n(721);t.polling=r,t.websocket=s},349:function(e,t,n){function r(e){var t=e&&e.forceBase64;c&&!t||(this.supportsBinary=!1),a.call(this,e)}var a=n(238),o=n(173),i=n(107),s=n(174),l=n(351),u=n(175)("engine.io-client:polling");e.exports=r;var c=function(){return null!=new(n(237))({xdomain:!1}).responseType}();s(r,a),r.prototype.name="polling",r.prototype.doOpen=function(){this.poll()},r.prototype.pause=function(e){function t(){u("paused"),n.readyState="paused",e()}var n=this;if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(u("we are currently polling - waiting to pause"),r++,this.once("pollComplete",function(){u("pre-pause polling complete"),--r||t()})),this.writable||(u("we are currently writing - waiting to pause"),r++,this.once("drain",function(){u("pre-pause writing complete"),--r||t()}))}else t()},r.prototype.poll=function(){u("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},r.prototype.onData=function(e){var t=this;u("polling got data %s",e);var n=function(e,n,r){if("opening"===t.readyState&&t.onOpen(),"close"===e.type)return t.onClose(),!1;t.onPacket(e)};i.decodePayload(e,this.socket.binaryType,n),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():u('ignoring poll - transport state "%s"',this.readyState))},r.prototype.doClose=function(){function e(){u("writing close packet"),t.write([{type:"close"}])}var t=this;"open"===this.readyState?(u("transport open - closing"),e()):(u("transport not open - deferring close"),this.once("open",e))},r.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")};i.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,n)})},r.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(e[this.timestampParam]=l()),this.supportsBinary||e.sid||(e.b64=1),e=o.encode(e),this.port&&("https"===t&&443!==Number(this.port)||"http"===t&&80!==Number(this.port))&&(n=":"+this.port),e.length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e}},350:function(e,t,n){(function(t){function r(e){if(!e||"object"!==typeof e)return!1;if(a(e)){for(var n=0,o=e.length;n<o;n++)if(r(e[n]))return!0;return!1}if("function"===typeof t&&t.isBuffer&&t.isBuffer(e)||"function"===typeof ArrayBuffer&&e instanceof ArrayBuffer||i&&e instanceof Blob||s&&e instanceof File)return!0;if(e.toJSON&&"function"===typeof e.toJSON&&1===arguments.length)return r(e.toJSON(),!0);for(var l in e)if(Object.prototype.hasOwnProperty.call(e,l)&&r(e[l]))return!0;return!1}var a=n(713),o=Object.prototype.toString,i="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===o.call(Blob),s="function"===typeof File||"undefined"!==typeof File&&"[object FileConstructor]"===o.call(File);e.exports=r}).call(t,n(29).Buffer)},351:function(e,t,n){"use strict";function r(e){var t="";do{t=s[e%l]+t,e=Math.floor(e/l)}while(e>0);return t}function a(e){var t=0;for(d=0;d<e.length;d++)t=t*l+u[e.charAt(d)];return t}function o(){var e=r(+new Date);return e!==i?(c=0,i=e):e+"."+r(c++)}for(var i,s="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),l=64,u={},c=0,d=0;d<l;d++)u[s[d]]=d;o.encode=r,o.decode=a,e.exports=o},352:function(e,t,n){function r(e,t,n){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}var a=n(236),o=n(106),i=n(723),s=n(353),l=n(354),u=n(172)("socket.io-client:socket"),c=n(173),d=n(350);e.exports=r;var p={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},f=o.prototype.emit;o(r.prototype),r.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[s(e,"open",l(this,"onopen")),s(e,"packet",l(this,"onpacket")),s(e,"close",l(this,"onclose"))]}},r.prototype.open=r.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)},r.prototype.send=function(){var e=i(arguments);return e.unshift("message"),this.emit.apply(this,e),this},r.prototype.emit=function(e){if(p.hasOwnProperty(e))return f.apply(this,arguments),this;var t=i(arguments),n={type:(void 0!==this.flags.binary?this.flags.binary:d(t))?a.BINARY_EVENT:a.EVENT,data:t};return n.options={},n.options.compress=!this.flags||!1!==this.flags.compress,"function"===typeof t[t.length-1]&&(u("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),this.flags={},this},r.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},r.prototype.onopen=function(){if(u("transport is open - connecting"),"/"!==this.nsp)if(this.query){var e="object"===typeof this.query?c.encode(this.query):this.query;u("sending connect packet with query %s",e),this.packet({type:a.CONNECT,query:e})}else this.packet({type:a.CONNECT})},r.prototype.onclose=function(e){u("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},r.prototype.onpacket=function(e){var t=e.nsp===this.nsp,n=e.type===a.ERROR&&"/"===e.nsp;if(t||n)switch(e.type){case a.CONNECT:this.onconnect();break;case a.EVENT:case a.BINARY_EVENT:this.onevent(e);break;case a.ACK:case a.BINARY_ACK:this.onack(e);break;case a.DISCONNECT:this.ondisconnect();break;case a.ERROR:this.emit("error",e.data)}},r.prototype.onevent=function(e){var t=e.data||[];u("emitting event %j",t),null!=e.id&&(u("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?f.apply(this,t):this.receiveBuffer.push(t)},r.prototype.ack=function(e){var t=this,n=!1;return function(){if(!n){n=!0;var r=i(arguments);u("sending ack %j",r),t.packet({type:d(r)?a.BINARY_ACK:a.ACK,id:e,data:r})}}},r.prototype.onack=function(e){var t=this.acks[e.id];"function"===typeof t?(u("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):u("bad ack %s",e.id)},r.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},r.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)f.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},r.prototype.ondisconnect=function(){u("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},r.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},r.prototype.close=r.prototype.disconnect=function(){return this.connected&&(u("performing disconnect (%s)",this.nsp),this.packet({type:a.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},r.prototype.compress=function(e){return this.flags.compress=e,this},r.prototype.binary=function(e){return this.flags.binary=e,this}},353:function(e,t){function n(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}e.exports=n},354:function(e,t){var n=[].slice;e.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var r=n.call(arguments,2);return function(){return t.apply(e,r.concat(n.call(arguments)))}}},355:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function o(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),s=n.n(i),l=n(1),u=n.n(l),c=n(73),d=n(471),p=n(136),f=n(372),h=n(378),m=n(12),g=n(385),y=(n.n(g),function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}()),v=n(469),b={markdownContent:u.a.string.isRequired,showTOC:u.a.bool,onContentRendered:u.a.func,activeTitleIndex:u.a.number,modifyValueBeforeRender:u.a.func},w=function(e){function t(e){r(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.scrollToNode=function(e){var t=new v(window.location.href);t.set("hash","user-content-"+e.text),window.location.href=t.toString()},n.getTitlesInfo=function(){for(var e=[],t=document.querySelectorAll('h2[id^="user-content"], h3[id^="user-content"]'),r=0;r<t.length;r++)e.push(t[r].offsetTop);n.titlesInfo=e},n.deserializeValue=function(e){var t=Object(p.deserialize)(e);n.props.modifyValueBeforeRender&&(t=t.toJSON(),t=n.props.modifyValueBeforeRender(t),t=m.Value.fromJSON(t)),n.setState({value:t})},n.titlesInfo=[],n.state={value:null},n}return o(t,e),y(t,[{key:"decorateNode",value:function(e){return Object(f.a)(e)}},{key:"componentWillMount",value:function(){this.deserializeValue(this.props.markdownContent)}},{key:"componentDidMount",value:function(){this.props.showTOC&&this.getTitlesInfo(),this.props.onContentRendered&&this.props.onContentRendered(this),window.markdownViewer=this}},{key:"componentWillReceiveProps",value:function(e){this.props.markdownContent!==e.markdownContent&&this.deserializeValue(e.markdownContent)}},{key:"componentWillUnmount",value:function(){window.markdownViewer=null}},{key:"render",value:function(){var e=this.state.value;return e?s.a.createElement(s.a.Fragment,null,s.a.createElement(c.Editor,{readOnly:!0,style:{width:"100%"},value:e,className:"article",renderNode:d.b,renderMark:d.a,decorateNode:this.decorateNode}),this.props.showTOC&&s.a.createElement("div",{className:"seafile-markdown-outline"},s.a.createElement(h.a,{document:e.document,isViewer:!0,editor:this,activeTitleIndex:this.props.activeTitleIndex}))):null}}]),t}(s.a.Component),E={activeTitleIndex:0,markdownContent:"",showTOC:!1,isShared:!1};w.propTypes=b,w.defaultProps=E,t.default=w},356:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(2),i=n(3),s=function(){function e(){r(this,e)}return a(e,null,[{key:"getUrl",value:function(e){var t="",n="";switch(e.type){case"download_historic_file":n="p="+e.filePath,t=o.siteRoot+"repo/"+o.historyRepoID+"/"+e.objID+"/download?"+n;break;case"download_file_url":t=o.siteRoot+"lib/"+e.repoID+"/file"+i.Utils.encodePath(e.filePath)+"?dl=1";break;case"file_revisions":n="p="+i.Utils.encodePath(e.filePath),t=o.siteRoot+"repo/file_revisions/"+e.repoID+"/?"+n;break;case"open_via_client":t="seafile://openfile?repo_id="+e.repoID+"&path="+i.Utils.encodePath(e.filePath);break;case"draft_view":t=o.siteRoot+"lib/"+e.repoID+"/file"+e.filePath+"?mode=edit&draft_id="+e.draftId;break;default:t=""}return t}}]),e}();t.default=s},380:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(2),h=n(4),m=n(3),g=n(726),y=r(g),v=n(844),b=r(v),w=n(5),E=r(w);n(845);var S={repoID:d.default.string.isRequired,repoTag:d.default.object.isRequired,filePath:d.default.string.isRequired,fileTagList:d.default.array.isRequired,onFileTagChanged:d.default.func.isRequired},C=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseEnter=function(){n.setState({showSelectedTag:!0})},n.onMouseLeave=function(){n.setState({showSelectedTag:!1})},n.getRepoTagIdList=function(){var e=[];return n.props.fileTagList.map(function(t){e.push(t.repo_tag_id)}),e},n.onEditFileTag=function(){var e=n.props,t=e.repoID,r=e.repoTag,a=e.filePath,o=n.getRepoTagIdList();if(-1===o.indexOf(r.id)){var i=r.id;h.seafileAPI.addFileTag(t,a,i).then(function(){o=n.getRepoTagIdList(),n.props.onFileTagChanged()}).catch(function(e){var t=m.Utils.getErrorMsg(e);E.default.danger(t)})}else{for(var s=null,l=n.props.fileTagList,u=0;u<l.length;u++)if(l[u].repo_tag_id===r.id){s=l[u];break}h.seafileAPI.deleteFileTag(t,s.id).then(function(){o=n.getRepoTagIdList(),n.props.onFileTagChanged()}).catch(function(e){var t=m.Utils.getErrorMsg(e);E.default.danger(t)})}},n.state={showSelectedTag:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.repoTag,t=this.getRepoTagIdList(),n=m.Utils.getDarkColor(e.color);return u.default.createElement("li",{key:e.id,className:"tag-list-item",onClick:this.onEditFileTag,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},u.default.createElement("div",{className:"tag-demo",style:{backgroundColor:e.color}},u.default.createElement("span",{className:this.state.showSelectedTag?"show-tag-selected":"",style:{backgroundColor:n}}),u.default.createElement("span",{className:"tag-name"},e.name),t.indexOf(e.id)>-1&&u.default.createElement("i",{className:"fas fa-check tag-operation"})))}}]),t}(u.default.Component);C.propTypes=S;var D={repoID:d.default.string.isRequired,filePath:d.default.string.isRequired,fileTagList:d.default.array.isRequired,onFileTagChanged:d.default.func.isRequired,toggleCancel:d.default.func.isRequired,createNewTag:d.default.func.isRequired},_=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getRepoTagList=function(){var e=n.props.repoID;h.seafileAPI.listRepoTags(e).then(function(e){var t=[];e.data.repo_tags.forEach(function(e){var n=new y.default(e);t.push(n)}),n.setState({repotagList:t})}).catch(function(e){var t=m.Utils.getErrorMsg(e);E.default.danger(t)})},n.state={repotagList:[]},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){this.getRepoTagList()}},{key:"render",value:function(){var e=this;return u.default.createElement(l.Fragment,null,u.default.createElement(p.ModalHeader,{toggle:this.props.toggleCancel},(0,f.gettext)("Select Tags")),u.default.createElement(p.ModalBody,null,u.default.createElement("ul",{className:"tag-list tag-list-container"},this.state.repotagList.map(function(t){return u.default.createElement(C,{key:t.id,repoTag:t,repoID:e.props.repoID,filePath:e.props.filePath,fileTagList:e.props.fileTagList,onFileTagChanged:e.props.onFileTagChanged})})),u.default.createElement("a",{href:"#",className:"add-tag-link",onClick:this.props.createNewTag},(0,f.gettext)("Create a new tag"))),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{onClick:this.props.toggleCancel},(0,f.gettext)("Close"))))}}]),t}(u.default.Component);_.propTypes=D;var P={repoID:d.default.string.isRequired,filePath:d.default.string.isRequired,fileTagList:d.default.array.isRequired,toggleCancel:d.default.func.isRequired,onFileTagChanged:d.default.func.isRequired},k=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.createNewTag=function(){n.setState({isCreateRepoTagShow:!n.state.isCreateRepoTagShow,isListRepoTagShow:!n.state.isListRepoTagShow})},n.onRepoTagCreated=function(e){var t=n.props,r=t.repoID,a=t.filePath;h.seafileAPI.addFileTag(r,a,e).then(function(){n.props.onFileTagChanged()}).catch(function(e){var t=m.Utils.getErrorMsg(e);E.default.danger(t)})},n.state={isCreateRepoTagShow:!1,isListRepoTagShow:!0},n}return i(t,e),s(t,[{key:"render",value:function(){return u.default.createElement(p.Modal,{isOpen:!0,toggle:this.props.toggleCancel},this.state.isListRepoTagShow&&u.default.createElement(_,{repoID:this.props.repoID,filePath:this.props.filePath,fileTagList:this.props.fileTagList,onFileTagChanged:this.props.onFileTagChanged,toggleCancel:this.props.toggleCancel,createNewTag:this.createNewTag}),this.state.isCreateRepoTagShow&&u.default.createElement(b.default,{repoID:this.props.repoID,onClose:this.props.toggleCancel,toggleCancel:this.createNewTag,onRepoTagCreated:this.onRepoTagCreated}))}}]),t}(u.default.Component);k.propTypes=P,t.default=k},381:function(e,t){},384:function(e,t,n){"use strict";function r(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return"function"===typeof e&&e.apply(void 0,n)}function a(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function o(){return Math.random().toString(36).substring(7)}Object.defineProperty(t,"__esModule",{value:!0}),t.callIfExists=r,t.hasOwnProp=a,t.uniqueId=o;t.store={},t.canUseDOM=Boolean("undefined"!==typeof window&&window.document&&window.document.createElement)},385:function(e,t){},386:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(2),i=n(4),s=function(){function e(){r(this,e)}return a(e,[{key:"getFiles",value:function(){return i.seafileAPI.listWikiDir(o.slug,"/").then(function(e){return e.data.dir_file_list.map(function(e){return{name:e.name,type:"dir"===e.type?"dir":"file",isExpanded:"dir"===e.type,parent_path:e.parent_dir,last_update_time:e.last_update_time,permission:e.permission,size:e.size}})})}},{key:"listRepoDir",value:function(){return i.seafileAPI.listDir(o.repoID,"/",{recursive:!0}).then(function(e){return e.data.dirent_list.map(function(e){return{name:e.name,type:"dir"===e.type?"dir":"file",isExpanded:"dir"===e.type,parent_path:e.parent_dir,last_update_time:e.mtime,permission:e.permission,size:e.size}})})}},{key:"createFile",value:function(e,t){return i.seafileAPI.createFile(o.repoID,e,t)}},{key:"deleteFile",value:function(e){return i.seafileAPI.deleteFile(o.repoID,e)}},{key:"renameFile",value:function(e,t){return i.seafileAPI.renameFile(o.repoID,e,t)}},{key:"createDir",value:function(e){return i.seafileAPI.createDir(o.repoID,e)}},{key:"deleteDir",value:function(e){return i.seafileAPI.deleteDir(o.repoID,e)}},{key:"renameDir",value:function(e,t){return i.seafileAPI.renameDir(o.repoID,e,t)}},{key:"getWikiFileContent",value:function(e,t){return i.seafileAPI.getWikiFileContent(e,t)}},{key:"getSource",value:function(){return i.seafileAPI.getSource()}},{key:"searchFiles",value:function(e,t){return i.seafileAPI.searchFiles(e,t)}},{key:"getAccountInfo",value:function(){return i.seafileAPI.getAccountInfo()}},{key:"getFileDownloadLink",value:function(e){return i.seafileAPI.getFileDownloadLink(o.historyRepoID,e)}},{key:"getFileContent",value:function(e){return i.seafileAPI.getFileContent(e)}},{key:"listFileHistoryRecords",value:function(e,t,n){return i.seafileAPI.listFileHistoryRecords(o.historyRepoID,e,t,n)}},{key:"revertFile",value:function(e,t){return i.seafileAPI.revertFile(o.historyRepoID,e,t)}},{key:"listDrafts",value:function(){return i.seafileAPI.listDrafts()}},{key:"deleteDraft",value:function(e){return i.seafileAPI.deleteDraft(e)}},{key:"publishDraft",value:function(e){return i.seafileAPI.publishDraft(e)}},{key:"zipDownload",value:function(e,t){return i.seafileAPI.zipDownload(o.repoID,e,t)}},{key:"queryZipProgress",value:function(e){return i.seafileAPI.queryZipProgress(e)}},{key:"cancelZipTask",value:function(e){return i.seafileAPI.cancelZipTask(e)}}]),e}(),l=new s;t.default=l},387:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=n(3),o=function e(t){r(this,e),this.repo_id=t.repo_id,this.repo_name=t.repo_name,this.permission=t.permission,this.size_original=t.size,this.size=a.Utils.bytesToSize(t.size),this.owner_name=t.owner_name,this.owner_email=t.owner_email,this.owner_contact_email=t.owner_contact_email,this.encrypted=t.encrypted,this.last_modified=t.last_modified,this.modifier_contact_email=t.modifier_contact_email,this.modifier_email=t.modifier_email,this.modifier_name=t.modifier_name,this.type=t.type,this.starred=t.starred,this.status=t.status,this.storage_name=t.storage_name,void 0!=t.is_admin&&(this.is_admin=t.is_admin)};t.default=o},388:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(2),h=n(3),m={repo:d.default.object.isRequired,isRepoDeleted:d.default.bool.isRequired,toggle:d.default.func.isRequired,onDeleteRepo:d.default.func.isRequired},g=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggle=function(){n.props.toggle()},n.onDeleteRepo=function(){n.setState({isRequestSended:!0},function(){n.props.onDeleteRepo(n.props.repo)})},n.state={isRequestSended:!1},n}return i(t,e),s(t,[{key:"componentWillReceiveProps",value:function(e){e.isRepoDeleted||this.setState({isRequestSended:!1})}},{key:"render",value:function(){var e=this.state.isRequestSended,t=this.props.repo,n='<span class="op-target">'+h.Utils.HTMLescape(t.repo_name||t.name)+"</span>",r=(0,f.gettext)("Are you sure you want to delete %s ?");return r=r.replace("%s",n),u.default.createElement(p.Modal,{isOpen:!0,toggle:this.toggle},u.default.createElement(p.ModalHeader,{toggle:this.toggle},(0,f.gettext)("Delete Library")),u.default.createElement(p.ModalBody,null,u.default.createElement("p",{dangerouslySetInnerHTML:{__html:r}})),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{color:"secondary",onClick:this.toggle},(0,f.gettext)("Cancel")),u.default.createElement(p.Button,{color:"primary",disabled:e,onClick:this.onDeleteRepo},(0,f.gettext)("Delete"))))}}]),t}(l.Component);g.propTypes=m,t.default=g},389:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){o(e,t,n[t])})}return e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(null==e)return{};var n,r,a=s(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function s(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ValueContainer=t.SingleValue=t.Placeholder=t.MultiValue=t.Input=void 0;var l=r(n(725)),u=r(n(841)),c=n(842),d=r(n(737)),p=r(n(738)),f=r(n(739)),h=r(n(740)),m=r(n(741)),g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,c.defaultComponents)({components:e}),n=t.Input,r=t.MultiValue,o=t.Placeholder,s=t.SingleValue,l=t.ValueContainer,u=i(t,["Input","MultiValue","Placeholder","SingleValue","ValueContainer"]);return a({Input:(0,d.default)(n),MultiValue:(0,p.default)(r),Placeholder:(0,f.default)(o),SingleValue:(0,h.default)(s),ValueContainer:(0,m.default)(l)},u)},y=g(),v=y.Input;t.Input=v;var b=y.MultiValue;t.MultiValue=b;var w=y.Placeholder;t.Placeholder=w;var E=y.SingleValue;t.SingleValue=E;var S=y.ValueContainer;t.ValueContainer=S;var C=(0,l.default)(g,u.default);t.default=C},39:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(2),f={forDialog:d.default.bool},h=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){return u.default.createElement("div",{className:this.props.forDialog?"text-center mt-8":"empty-tip"},u.default.createElement("img",{src:p.mediaUrl+"img/no-items-tip.png",alt:"",width:"100",height:"100",className:"no-items-img-tip"}),this.props.children)}}]),t}(u.default.Component);h.propTypes=f,t.default=h},390:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canUseDOM=void 0;var r=n(1034),a=function(e){return e&&e.__esModule?e:{default:e}}(r),o=a.default,i=o.canUseDOM?window.HTMLElement:{};t.canUseDOM=o.canUseDOM;t.default=i},4:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.seafileAPI=void 0;var r=n(47),a=function(e){return e&&e.__esModule?e:{default:e}}(r),o=n(60),i=n(2),s=new o.SeafileAPI,l=a.default.load("sfcsrftoken");s.initForSeahubUsage({siteRoot:i.siteRoot,xcsrfHeaders:l}),t.seafileAPI=s},43:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(7),s=r(i),l=n(3),u=n(72),c=r(u),d=function(){function e(t){if(a(this,e),this.id=t.id||"0000000000000000",this.name=t.name,this.type=t.type,this.mtime=t.mtime,0==t.mtime?this.mtime_relative="":this.mtime_relative=s.default.unix(t.mtime).fromNow(),this.permission=t.permission||"rw",this.isSelected=!1,this.starred=t.starred||!1,"file"===t.type){this.size_original=t.size,this.size=l.Utils.bytesToSize(t.size),this.is_locked=t.is_locked||!1,this.lock_time=t.lock_time||"",this.lock_owner=t.lock_owner||null,this.lock_owner_name=t.lock_owner_name||null,this.locked_by_me=t.locked_by_me||!1,this.modifier_name=t.modifier_name||"",this.modifier_email=t.modifier_email||"",this.modifier_contact_email=t.modifier_contact_email||"";var n=[];t.file_tags&&(n=t.file_tags.map(function(e){return new c.default(e)})),this.file_tags=n,t.encoded_thumbnail_src&&(this.encoded_thumbnail_src=t.encoded_thumbnail_src)}}return o(e,[{key:"clone",value:function(){return new e(this)}},{key:"isDir",value:function(){return"file"!==this.type}}]),e}();t.default=d},45:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=n(0),c=r(u),d=n(1),p=r(d),f=n(255),h=r(f),m=n(4),g=n(2),y=n(3),v=n(5),b=r(v);n(114);var w={placeholder:p.default.string.isRequired,onSelectChange:p.default.func.isRequired,isMulti:p.default.bool.isRequired,className:p.default.string},E=function(e){return c.default.createElement("div",l({},e.innerProps,{style:{margin:"6px 10px",textAlign:"center",color:"hsl(0,0%,50%)"}}),(0,g.gettext)("User not found"))},S=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleSelectChange=function(e){n.options=[],n.props.onSelectChange(e)},n.loadOptions=function(e,t){var r=e.trim();r.length>0&&m.seafileAPI.searchUsers(r).then(function(e){n.options=[];for(var r=0;r<e.data.users.length;r++){var a=e.data.users[r],o={};o.value=a.name,o.email=a.email,o.label=g.enableShowContactEmailWhenSearchUser?c.default.createElement("div",{className:"d-flex"},c.default.createElement("img",{src:a.avatar_url,className:"avatar",width:"24",alt:""}),c.default.createElement("div",{className:"ml-2"},c.default.createElement("span",{className:"user-option-name"},a.name),c.default.createElement("br",null),c.default.createElement("span",{className:"user-option-email"},a.contact_email))):c.default.createElement(c.default.Fragment,null,c.default.createElement("img",{src:a.avatar_url,className:"select-module select-module-icon avatar",alt:""}),c.default.createElement("span",{className:"select-module select-module-name"},a.name)),n.options.push(o)}t(n.options)}).catch(function(e){var t=y.Utils.getErrorMsg(e);b.default.danger(t)})},n.clearSelect=function(){n.refs.userSelect.select.onChange([],{action:"clear"})},n.options=[],n}return i(t,e),s(t,[{key:"render",value:function(){return c.default.createElement(h.default,{isClearable:!0,classNamePrefix:!0,components:{NoOptionsMessage:E},isMulti:this.props.isMulti,loadOptions:this.loadOptions,onChange:this.handleSelectChange,placeholder:this.props.placeholder,className:"user-select "+this.props.className,value:this.props.value,ref:"userSelect"})}}]),t}(c.default.Component);S.propTypes=w,t.default=S},466:function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},472:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(82),h=r(f),m=n(389),g=r(m),y=n(4),v=n(2),b=n(3),w=n(5),E=r(w),S=n(45),C=r(S),D={itemName:d.default.string.isRequired,toggleDialog:d.default.func.isRequired,submit:d.default.func.isRequired,canTransferToDept:d.default.bool},_=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleSelectChange=function(e){n.setState({selectedOption:e})},n.submit=function(){var e=n.state.selectedOption;n.props.submit(e)},n.onClick=function(){n.setState({transferToUser:!n.state.transferToUser})},n.state={selectedOption:null,errorMsg:[],transferToUser:!0},n.options=[],n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;v.isPro&&y.seafileAPI.listDepartments().then(function(t){for(var n=0;n<t.data.length;n++){var r={};r.value=t.data[n].name,r.email=t.data[n].email,r.label=t.data[n].name,e.options.push(r)}}).catch(function(e){var t=b.Utils.getErrorMsg(e);E.default.danger(t)})}},{key:"render",value:function(){var e=this.props.itemName,t='<span class="op-target" title='+e+">"+e+"</span>",n=(0,v.gettext)("Transfer Library {library_name}"),r=n.replace("{library_name}",t),a=!0;return void 0!=this.props.canTransferToDept&&(a=this.props.canTransferToDept),u.default.createElement(p.Modal,{isOpen:!0},u.default.createElement(p.ModalHeader,{toggle:this.props.toggleDialog},u.default.createElement("div",{dangerouslySetInnerHTML:{__html:r}})),u.default.createElement(p.ModalBody,null,this.state.transferToUser?u.default.createElement(C.default,{ref:"userSelect",isMulti:!1,className:"reviewer-select",placeholder:(0,v.gettext)("Select a user"),onSelectChange:this.handleSelectChange}):u.default.createElement(h.default,{isClearable:!0,isMulti:!1,maxMenuHeight:200,hideSelectedOptions:!0,components:(0,g.default)(),placeholder:(0,v.gettext)("Select a department"),options:this.options,onChange:this.handleSelectChange}),v.isPro&&a&&u.default.createElement("span",{className:"action-link",onClick:this.onClick},this.state.transferToUser?(0,v.gettext)("Transfer to department"):(0,v.gettext)("Transfer to user"))),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{color:"secondary",onClick:this.props.toggleDialog},(0,v.gettext)("Cancel")),u.default.createElement(p.Button,{color:"primary",onClick:this.submit},(0,v.gettext)("Submit"))))}}]),t}(u.default.Component);_.propTypes=D,t.default=_},473:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(2),h=n(3),m={fileType:d.default.string,parentPath:d.default.string.isRequired,onAddFolder:d.default.func.isRequired,checkDuplicatedName:d.default.func.isRequired,addFolderCancel:d.default.func.isRequired},g=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleChange=function(e){e.target.value.trim()?n.setState({isSubmitBtnActive:!0}):n.setState({isSubmitBtnActive:!1}),n.setState({childName:e.target.value})},n.handleSubmit=function(){if(n.state.isSubmitBtnActive){var e=n.state.childName;if(n.checkDuplicatedName()){var t=(0,f.gettext)('The name "{name}" is already taken. Please choose a different name.');t=t.replace("{name}",h.Utils.HTMLescape(e)),n.setState({errMessage:t})}else{var r=n.state.parentPath+e;n.props.onAddFolder(r)}}},n.handleKeyPress=function(e){"Enter"===e.key&&(n.handleSubmit(),e.preventDefault())},n.toggle=function(){n.props.addFolderCancel()},n.checkDuplicatedName=function(){return n.props.checkDuplicatedName(n.state.childName)},n.state={parentPath:"",childName:"",errMessage:"",isSubmitBtnActive:!1},n.newInput=u.default.createRef(),n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this.props.parentPath;"/"===e[e.length-1]?this.setState({parentPath:e}):this.setState({parentPath:e+"/"}),this.newInput.focus(),this.newInput.setSelectionRange(0,0)}},{key:"render",value:function(){var e=this;return u.default.createElement(p.Modal,{isOpen:!0,toggle:this.toggle},u.default.createElement(p.ModalHeader,{toggle:this.toggle},(0,f.gettext)("New Folder")),u.default.createElement(p.ModalBody,null,u.default.createElement(p.Form,null,u.default.createElement(p.FormGroup,null,u.default.createElement(p.Label,{for:"folderName"},(0,f.gettext)("Name")),u.default.createElement(p.Input,{id:"folderName",value:this.state.childName,innerRef:function(t){e.newInput=t},onKeyPress:this.handleKeyPress,onChange:this.handleChange}))),this.state.errMessage&&u.default.createElement(p.Alert,{color:"danger",className:"mt-2"},this.state.errMessage)),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{color:"secondary",onClick:this.toggle},(0,f.gettext)("Cancel")),u.default.createElement(p.Button,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive},(0,f.gettext)("Submit"))))}}]),t}(u.default.Component);g.propTypes=m,t.default=g},474:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(2),h=n(4),m=n(3),g=n(8),y=r(g),v={token:d.default.string,path:d.default.string.isRequired,repoID:d.default.string,target:d.default.oneOfType([d.default.string,d.default.array]),toggleDialog:d.default.func.isRequired},b=void 0,w=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.queryZipProgress=function(){var e=n.state.zipToken;h.seafileAPI.queryZipProgress(e).then(function(t){var r=t.data;n.setState({zipProgress:0==r.total?"100%":(r.zipped/r.total*100).toFixed(2)+"%"}),r.total==r.zipped&&(clearInterval(b),n.props.toggleDialog(),location.href=f.fileServerRoot+"zip/"+e)}).catch(function(e){clearInterval(b);var t=m.Utils.getErrorMsg(e);n.setState({isLoading:!1,errorMsg:t})})},n.cancelZipTask=function(){var e=n.state.zipToken;h.seafileAPI.cancelZipTask(e).then(function(e){}).catch(function(e){})},n.toggleDialog=function(){var e=n.state.zipProgress;e&&"100%"!=e&&(clearInterval(b),n.cancelZipTask()),n.props.toggleDialog()},n.state={isLoading:!0,errorMsg:"",zipProgress:null},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.token,r=t.path,a=t.repoID,o=t.target,i=void 0;i=n?o.length?h.seafileAPI.getShareLinkDirentsZipTask(n,r,o):h.seafileAPI.getShareLinkZipTask(n,r):h.seafileAPI.zipDownload(a,r,o),i.then(function(t){var n=t.data.zip_token;e.setState({isLoading:!1,errorMsg:"",zipToken:n}),e.queryZipProgress(),b=setInterval(e.queryZipProgress,1e3)}).catch(function(t){var n=m.Utils.getErrorMsg(t);e.setState({isLoading:!1,errorMsg:n})})}},{key:"render",value:function(){return u.default.createElement(p.Modal,{isOpen:!0,toggle:this.toggleDialog},u.default.createElement(p.ModalHeader,{toggle:this.toggleDialog},(0,f.gettext)("Download")),u.default.createElement(p.ModalBody,null,u.default.createElement(E,{data:this.state})))}}]),t}(u.default.Component),E=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.data,t=e.isLoading,n=e.errorMsg,r=e.zipProgress;return t?u.default.createElement(y.default,null):n?u.default.createElement("p",{className:"error mt-4 text-center"},n):u.default.createElement("p",{className:"mt-4 text-center"},(0,f.gettext)("Packaging...")+" "+r)}}]),t}(u.default.Component);w.propTypes=v,t.default=w},5:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(22),a=function(e){return e&&e.__esModule?e:{default:e}}(r),o=new a.default;t.default=o},53:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(3),f=n(62),h=r(f),m={isTextMode:d.default.bool.isRequired,isEditIconShow:d.default.bool.isRequired,permissions:d.default.array.isRequired,currentPermission:d.default.string.isRequired,onPermissionChanged:d.default.func.isRequired},g=function(e){function t(){var e,n,r,i;a(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=r=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),r.translatePermission=function(e){return p.Utils.sharePerms(e)},r.translateExplanation=function(e){return p.Utils.sharePermsExplanation(e)},i=n,o(r,i)}return i(t,e),s(t,[{key:"render",value:function(){return u.default.createElement(h.default,{isTextMode:this.props.isTextMode,isEditIconShow:this.props.isEditIconShow,options:this.props.permissions,currentOption:this.props.currentPermission,onOptionChanged:this.props.onPermissionChanged,translateOption:this.translatePermission,translateExplanation:this.translateExplanation})}}]),t}(u.default.Component);g.propTypes=m,t.default=g},62:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(2),f=n(82),h=r(f);n(137);var m={isTextMode:d.default.bool.isRequired,isEditIconShow:d.default.bool.isRequired,options:d.default.array.isRequired,currentOption:d.default.string.isRequired,translateOption:d.default.func.isRequired,translateExplanation:d.default.func,onOptionChanged:d.default.func.isRequired,toggleItemFreezed:d.default.func},g=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.setOptions=function(){n.options=[];for(var e=n.props.options,t=0,r=e.length;t<r;t++){var a={};a.value=e[t],e[t].length?a.label=u.default.createElement("div",null,n.props.translateOption(e[t]),n.props.translateExplanation&&u.default.createElement("div",{className:"permission-editor-explanation"},n.props.translateExplanation(e[t]))):a.label=u.default.createElement("div",{style:{minHeight:"1em"}}),n.options.push(a)}n.setState({options:n.options})},n.onEditPermission=function(e){e.nativeEvent.stopImmediatePropagation(),n.setState({isEditing:!0}),n.props.toggleItemFreezed&&n.props.toggleItemFreezed(!0)},n.onOptionChanged=function(e){var t=e.value;t!==n.props.currentOption&&n.props.onOptionChanged(t),n.setState({isEditing:!1}),n.props.toggleItemFreezed&&n.props.toggleItemFreezed(!1)},n.onSelectHandler=function(e){e.nativeEvent.stopImmediatePropagation()},n.onHideSelect=function(){n.setState({isEditing:!1}),n.props.toggleItemFreezed&&n.props.toggleItemFreezed(!1)},n.state={isEditing:!1,options:[]},n.options=[],n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.onHideSelect),this.setOptions()}},{key:"componentWillReceiveProps",value:function(){this.setOptions()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.onHideSelect)}},{key:"render",value:function(){var e=this.props,t=e.currentOption,n=e.isTextMode;return u.default.createElement("div",{className:"permission-editor",onClick:this.onSelectHandler},(!n||this.state.isEditing)&&u.default.createElement(h.default,{options:this.state.options,className:"permission-editor-select",classNamePrefix:"permission-editor",placeholder:this.props.translateOption(t),onChange:this.onOptionChanged,captureMenuScroll:!1}),n&&!this.state.isEditing&&u.default.createElement("div",null,this.props.translateOption(t),this.props.isEditIconShow&&u.default.createElement("span",{title:(0,p.gettext)("Edit"),className:"fa fa-pencil-alt attr-action-icon",onClick:this.onEditPermission})))}}]),t}(u.default.Component);g.propTypes=m,t.default=g},68:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(4),h=n(2),m=n(3),g=n(5),y=r(g),v=n(84),b=r(v),w=n(88),E=r(w),S=n(8),C=r(S),D=n(92),_=r(D);n(94);var P={isShowFile:d.default.bool,repoID:d.default.string,onDirentItemClick:d.default.func,onRepoItemClick:d.default.func,mode:d.default.oneOf(["current_repo_and_other_repos","only_all_repos","only_current_library"]),fileSuffixes:d.default.array},k=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onOtherRepoToggle=function(){if(n.state.hasRequest)n.setState({isOtherRepoShow:!n.state.isOtherRepoShow});else{var e=n;f.seafileAPI.listRepos().then(function(t){for(var r=t.data.repos,a=[],o=[],i=0;i<r.length;i++)"rw"===r[i].permission&&(e.props.repoID&&r[i].repo_name===e.state.currentRepoInfo.repo_name||o.indexOf(r[i].repo_id)>-1||(a.push(r[i]),o.push(r[i].repo_id)));a=m.Utils.sortRepos(a,"name","asc"),n.setState({repoList:a,isOtherRepoShow:!n.state.isOtherRepoShow,selectedItemInfo:{}})})}},n.onCurrentRepoToggle=function(){n.setState({isCurrentRepoShow:!n.state.isCurrentRepoShow})},n.onDirentItemClick=function(e,t,r){n.props.onDirentItemClick(e,t,r),n.setState({selectedRepo:e,selectedPath:t})},n.onRepoItemClick=function(e){n.props.onRepoItemClick&&n.props.onRepoItemClick(e),n.setState({selectedRepo:e,selectedPath:""})},n.onCloseSearching=function(){n.setState({isSearching:!1,isResultGot:!1,searchInfo:"",searchResults:[]}),n.inputValue="",n.timer=null,n.source=null},n.onSearchInfoChanged=function(e){var t=e.target.value.trim();if(n.setState({searchInfo:t}),n.inputValue===t)return!1;if(n.inputValue=t,0===t.length)return n.setState({isSearching:!1,searchResults:[]}),!1;if(!n.state.searchResults.length&&t.length>0&&n.setState({isSearching:!0,isResultGot:!1}),""===n.inputValue||n.getValueLength(n.inputValue)<3)return n.setState({isResultGot:!1}),!1;var r=n.props.repoID,a=n.props.isShowFile,o=n.props.mode,i="only_current_library"===o?r:"all",s={q:t,search_repo:i,search_ftypes:"all",obj_type:a?"file":"dir"};n.timer&&clearTimeout(n.timer),n.timer=setTimeout(n.getSearchResult(s),500)},n.getSearchResult=function(e){n.source&&n.cancelRequest(),n.setState({isResultGot:!1}),n.source=f.seafileAPI.getSource(),n.sendRequest(e,n.source.token)},n.sendRequest=function(e,t){f.seafileAPI.searchFiles(e,t).then(function(e){if(!e.data.total)return n.setState({searchResults:[],isResultGot:!0}),void(n.source=null);var t=n.formatResultItems(e.data.results);n.setState({searchResults:t,isResultGot:!0}),n.source=null})},n.cancelRequest=function(){n.source.cancel("prev request is cancelled")},n.getValueLength=function(e){for(var t,n=0,r=0;n<e.length;n++)t=e.charCodeAt(n),10==t?r+=2:t<127?r+=1:t>=128&&t<=2047?r+=2:t>=2048&&t<=65535&&(r+=3);return r},n.formatResultItems=function(e){for(var t=[],n=e.length>10?10:e.length,r=0;r<n;r++)t[r]={},t[r].index=[r],t[r].name=e[r].name,t[r].path=e[r].fullpath,t[r].repo_id=e[r].repo_id,t[r].repo_name=e[r].repo_name,t[r].is_dir=e[r].is_dir,t[r].link_content=decodeURI(e[r].fullpath).substring(1),t[r].content=e[r].content_highlight;return t},n.onSearchedItemClick=function(e){e.type=e.is_dir?"dir":"file";var t=new b.default(e);n.props.onDirentItemClick(t,e.path,e)},n.renderSearchedView=function(){return n.getValueLength(n.inputValue)<3?"":n.state.isResultGot?n.state.isResultGot&&0===n.state.searchResults.length?u.default.createElement("div",{className:"search-result-none text-center"},(0,h.gettext)("No results matching.")):n.state.isResultGot&&n.state.searchResults.length>0?u.default.createElement(_.default,{searchResults:n.state.searchResults,onItemClick:n.onSearchedItemClick,onSearchedItemDoubleClick:n.onSearchedItemDoubleClick}):void 0:u.default.createElement(C.default,null)},n.onSearchedItemDoubleClick=function(e){if("dir"===e.type){var t={repoID:e.repo_id,filePath:e.path};if(n.setState({selectedItemInfo:t}),n.props.repoID&&e.repo_id===n.props.repoID)f.seafileAPI.getRepoInfo(n.props.repoID).then(function(t){var r=new b.default(t.data),a=e.path.substring(0,e.path.length-1);n.setState({selectedRepo:r,selectedPath:a,isCurrentRepoShow:!0})}).catch(function(e){var t=m.Utils.getErrorMsg(e);y.default.danger(t)});else if(n.state.hasRequest)n.setState({isOtherRepoShow:!n.state.isOtherRepoShow});else{var r=n;f.seafileAPI.listRepos().then(function(t){for(var a=t.data.repos,o=[],i=[],s=0;s<a.length;s++)"rw"===a[s].permission&&(r.props.repoID&&a[s].repo_name===r.state.currentRepoInfo.repo_name||i.indexOf(a[s].repo_id)>-1||(o.push(a[s]),i.push(a[s].repo_id)));o=m.Utils.sortRepos(o,"name","asc");var l=o.filter(function(t){return t.repo_id===e.repo_id}),u=e.path.substring(0,e.path.length-1),c=l[0];n.setState({repoList:o,isOtherRepoShow:!0,selectedPath:u,selectedRepo:c})})}n.onCloseSearching()}},n.onScroll=function(e){e.stopPropagation()},n.renderRepoListView=function(){return u.default.createElement("div",{className:"file-chooser-container user-select-none",onScroll:n.onScroll},"current_repo_and_other_repos"===n.props.mode&&u.default.createElement(l.Fragment,null,u.default.createElement("div",{className:"list-view"},u.default.createElement("div",{className:"list-view-header"},u.default.createElement("span",{className:"item-toggle fa "+(n.state.isCurrentRepoShow?"fa-caret-down":"fa-caret-right"),onClick:n.onCurrentRepoToggle}),u.default.createElement("span",{className:"library"},(0,h.gettext)("Current Library"))),n.state.isCurrentRepoShow&&n.state.currentRepoInfo&&u.default.createElement(E.default,{initToShowChildren:!0,currentRepoInfo:n.state.currentRepoInfo,selectedRepo:n.state.selectedRepo,selectedPath:n.state.selectedPath,onRepoItemClick:n.onRepoItemClick,onDirentItemClick:n.onDirentItemClick,isShowFile:n.props.isShowFile,fileSuffixes:n.props.fileSuffixes,selectedItemInfo:n.state.selectedItemInfo})),u.default.createElement("div",{className:"list-view"},u.default.createElement("div",{className:"list-view-header"},u.default.createElement("span",{className:"item-toggle fa "+(n.state.isOtherRepoShow?"fa-caret-down":"fa-caret-right"),onClick:n.onOtherRepoToggle}),u.default.createElement("span",{className:"library"},(0,h.gettext)("Other Libraries"))),n.state.isOtherRepoShow&&u.default.createElement(E.default,{initToShowChildren:!1,repoList:n.state.repoList,selectedRepo:n.state.selectedRepo,selectedPath:n.state.selectedPath,onRepoItemClick:n.onRepoItemClick,onDirentItemClick:n.onDirentItemClick,isShowFile:n.props.isShowFile,fileSuffixes:n.props.fileSuffixes,selectedItemInfo:n.state.selectedItemInfo}))),"only_current_library"===n.props.mode&&u.default.createElement("div",{className:"list-view"},u.default.createElement("div",{className:"list-view-header"},u.default.createElement("span",{className:"item-toggle fa "+(n.state.isCurrentRepoShow?"fa-caret-down":"fa-caret-right"),onClick:n.onCurrentRepoToggle}),u.default.createElement("span",{className:"library"},(0,h.gettext)("Current Library"))),n.state.isCurrentRepoShow&&n.state.currentRepoInfo&&u.default.createElement(E.default,{initToShowChildren:!0,currentRepoInfo:n.state.currentRepoInfo,selectedRepo:n.state.selectedRepo,selectedPath:n.state.selectedPath,onRepoItemClick:n.onRepoItemClick,onDirentItemClick:n.onDirentItemClick,isShowFile:n.props.isShowFile,fileSuffixes:n.props.fileSuffixes,selectedItemInfo:n.state.selectedItemInfo})),"only_all_repos"===n.props.mode&&u.default.createElement("div",{className:"file-chooser-container"},u.default.createElement("div",{className:"list-view"},u.default.createElement("div",{className:"list-view-header"},u.default.createElement("span",{className:"item-toggle fa fa-caret-down"}),u.default.createElement("span",{className:"library"},(0,h.gettext)("Libraries"))),u.default.createElement(E.default,{initToShowChildren:!1,repoList:n.state.repoList,selectedRepo:n.state.selectedRepo,selectedPath:n.state.selectedPath,onRepoItemClick:n.onRepoItemClick,onDirentItemClick:n.onDirentItemClick,isShowFile:n.props.isShowFile,fileSuffixes:n.props.fileSuffixes,selectedItemInfo:n.state.selectedItemInfo}))))},n.state={hasRequest:!1,isCurrentRepoShow:!0,isOtherRepoShow:!1,repoList:[],currentRepoInfo:null,selectedRepo:null,selectedPath:"",isSearching:!1,isResultGot:!1,searchInfo:"",searchResults:[],selectedItemInfo:{}},n.inputValue="",n.timer=null,n.source=null,n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;if(this.props.repoID){var t=this.props.repoID;f.seafileAPI.getRepoInfo(t).then(function(t){var n=new b.default(t.data);e.setState({currentRepoInfo:n,selectedRepo:n}),e.props.onRepoItemClick(n)}).catch(function(e){var t=m.Utils.getErrorMsg(e);y.default.danger(t)})}else f.seafileAPI.listRepos().then(function(t){for(var n=t.data.repos,r=[],a=[],o=0;o<n.length;o++)"rw"===n[o].permission&&(a.indexOf(n[o].repo_id)>-1||(r.push(n[o]),a.push(n[o].repo_id)));r=m.Utils.sortRepos(r,"name","asc"),e.setState({repoList:r})})}},{key:"render",value:function(){return!this.state.selectedRepo&&this.props.repoID?"":u.default.createElement(l.Fragment,null,h.isPro&&u.default.createElement("div",{className:"file-chooser-search-input"},u.default.createElement(p.Input,{className:"search-input mb-2",placeholder:(0,h.gettext)("Search..."),type:"text",value:this.state.searchInfo,onChange:this.onSearchInfoChanged}),0!==this.state.searchInfo.length&&u.default.createElement("span",{className:"search-control attr-action-icon fas fa-times",onClick:this.onCloseSearching})),this.state.isSearching&&u.default.createElement("div",{className:"file-chooser-search-container"},this.renderSearchedView()),!this.state.isSearching&&this.renderRepoListView())}}]),t}(u.default.Component);k.propTypes=P,t.default=k},700:function(e,t,n){function r(e,t){"object"===typeof e&&(t=e,e=void 0),t=t||{};var n,r=a(e),o=r.source,u=r.id,c=r.path,d=l[u]&&c in l[u].nsps,p=t.forceNew||t["force new connection"]||!1===t.multiplex||d;return p?(s("ignoring socket cache for %s",o),n=i(o,t)):(l[u]||(s("new io instance for %s",o),l[u]=i(o,t)),n=l[u]),r.query&&!t.query&&(t.query=r.query),n.socket(r.path,t)}var a=n(701),o=n(236),i=n(347),s=n(172)("socket.io-client");e.exports=t=r;var l=t.managers={};t.protocol=o.protocol,t.connect=r,t.Manager=n(347),t.Socket=n(352)},701:function(e,t,n){function r(e,t){var n=e;t=t||"undefined"!==typeof location&&location,null==e&&(e=t.protocol+"//"+t.host),"string"===typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(o("protocol-less url %s",e),e="undefined"!==typeof t?t.protocol+"//"+e:"https://"+e),o("parse %s",e),n=a(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";var r=-1!==n.host.indexOf(":"),i=r?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+i+":"+n.port,n.href=n.protocol+"://"+i+(t&&t.port===n.port?"":":"+n.port),n}var a=n(344),o=n(172)("socket.io-client:url");e.exports=r},702:function(e,t,n){function r(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}function a(e){function n(){if(n.enabled){var e=n,r=+new Date,o=r-(a||r);e.diff=o,e.prev=a,e.curr=r,a=r;for(var i=new Array(arguments.length),s=0;s<i.length;s++)i[s]=arguments[s];i[0]=t.coerce(i[0]),"string"!==typeof i[0]&&i.unshift("%O");var l=0;i[0]=i[0].replace(/%([a-zA-Z%])/g,function(n,r){if("%%"===n)return n;l++;var a=t.formatters[r];if("function"===typeof a){var o=i[l];n=a.call(e,o),i.splice(l,1),l--}return n}),t.formatArgs.call(e,i);(n.log||t.log||console.log.bind(console)).apply(e,i)}}var a;return n.namespace=e,n.enabled=t.enabled(e),n.useColors=t.useColors(),n.color=r(e),n.destroy=o,"function"===typeof t.init&&t.init(n),t.instances.push(n),n}function o(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}function i(e){t.save(e),t.names=[],t.skips=[];var n,r=("string"===typeof e?e:"").split(/[\s,]+/),a=r.length;for(n=0;n<a;n++)r[n]&&(e=r[n].replace(/\*/g,".*?"),"-"===e[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var o=t.instances[n];o.enabled=t.enabled(o.namespace)}}function s(){t.enable("")}function l(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1}function u(e){return e instanceof Error?e.stack||e.message:e}t=e.exports=a.debug=a.default=a,t.coerce=u,t.disable=s,t.enable=i,t.enabled=l,t.humanize=n(235),t.instances=[],t.names=[],t.skips=[],t.formatters={}},703:function(e,t,n){(function(r){function a(){return!("undefined"===typeof window||!window.process||"renderer"!==window.process.type)||("undefined"===typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))}function o(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),n){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var a=0,o=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(a++,"%c"===e&&(o=a))}),e.splice(o,0,r)}}function i(){return"object"===typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function s(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}}function l(){var e;try{e=t.storage.debug}catch(e){}return!e&&"undefined"!==typeof r&&"env"in r&&(e=Object({NODE_ENV:"production",PUBLIC_URL:"/media/seafile-editor"}).DEBUG),e}t=e.exports=n(704),t.log=i,t.formatArgs=o,t.save=s,t.load=l,t.useColors=a,t.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(l())}).call(t,n(48))},704:function(e,t,n){function r(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}function a(e){function n(){if(n.enabled){var e=n,r=+new Date,o=r-(a||r);e.diff=o,e.prev=a,e.curr=r,a=r;for(var i=new Array(arguments.length),s=0;s<i.length;s++)i[s]=arguments[s];i[0]=t.coerce(i[0]),"string"!==typeof i[0]&&i.unshift("%O");var l=0;i[0]=i[0].replace(/%([a-zA-Z%])/g,function(n,r){if("%%"===n)return n;l++;var a=t.formatters[r];if("function"===typeof a){var o=i[l];n=a.call(e,o),i.splice(l,1),l--}return n}),t.formatArgs.call(e,i);(n.log||t.log||console.log.bind(console)).apply(e,i)}}var a;return n.namespace=e,n.enabled=t.enabled(e),n.useColors=t.useColors(),n.color=r(e),n.destroy=o,"function"===typeof t.init&&t.init(n),t.instances.push(n),n}function o(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}function i(e){t.save(e),t.names=[],t.skips=[];var n,r=("string"===typeof e?e:"").split(/[\s,]+/),a=r.length;for(n=0;n<a;n++)r[n]&&(e=r[n].replace(/\*/g,".*?"),"-"===e[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var o=t.instances[n];o.enabled=t.enabled(o.namespace)}}function s(){t.enable("")}function l(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1}function u(e){return e instanceof Error?e.stack||e.message:e}t=e.exports=a.debug=a.default=a,t.coerce=u,t.disable=s,t.enable=i,t.enabled=l,t.humanize=n(235),t.instances=[],t.names=[],t.skips=[],t.formatters={}},705:function(e,t,n){function r(e,t){if(!e)return e;if(i(e)){var n={_placeholder:!0,num:t.length};return t.push(e),n}if(o(e)){for(var a=new Array(e.length),s=0;s<e.length;s++)a[s]=r(e[s],t);return a}if("object"===typeof e&&!(e instanceof Date)){var a={};for(var l in e)a[l]=r(e[l],t);return a}return e}function a(e,t){if(!e)return e;if(e&&e._placeholder)return t[e.num];if(o(e))for(var n=0;n<e.length;n++)e[n]=a(e[n],t);else if("object"===typeof e)for(var r in e)e[r]=a(e[r],t);return e}var o=n(345),i=n(346),s=Object.prototype.toString,l="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===s.call(Blob),u="function"===typeof File||"undefined"!==typeof File&&"[object FileConstructor]"===s.call(File);t.deconstructPacket=function(e){var t=[],n=e.data,a=e;return a.data=r(n,t),a.attachments=t.length,{packet:a,buffers:t}},t.reconstructPacket=function(e,t){return e.data=a(e.data,t),e.attachments=void 0,e},t.removeBlobs=function(e,t){function n(e,s,c){if(!e)return e;if(l&&e instanceof Blob||u&&e instanceof File){r++;var d=new FileReader;d.onload=function(){c?c[s]=this.result:a=this.result,--r||t(a)},d.readAsArrayBuffer(e)}else if(o(e))for(var p=0;p<e.length;p++)n(e[p],p,e);else if("object"===typeof e&&!i(e))for(var f in e)n(e[f],f,e)}var r=0,a=e;n(a),r||t(a)}},706:function(e,t,n){"use strict";function r(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===e[t-2]?2:"="===e[t-1]?1:0}function a(e){return 3*e.length/4-r(e)}function o(e){var t,n,a,o,i,s=e.length;o=r(e),i=new d(3*s/4-o),n=o>0?s-4:s;var l=0;for(t=0;t<n;t+=4)a=c[e.charCodeAt(t)]<<18|c[e.charCodeAt(t+1)]<<12|c[e.charCodeAt(t+2)]<<6|c[e.charCodeAt(t+3)],i[l++]=a>>16&255,i[l++]=a>>8&255,i[l++]=255&a;return 2===o?(a=c[e.charCodeAt(t)]<<2|c[e.charCodeAt(t+1)]>>4,i[l++]=255&a):1===o&&(a=c[e.charCodeAt(t)]<<10|c[e.charCodeAt(t+1)]<<4|c[e.charCodeAt(t+2)]>>2,i[l++]=a>>8&255,i[l++]=255&a),i}function i(e){return u[e>>18&63]+u[e>>12&63]+u[e>>6&63]+u[63&e]}function s(e,t,n){for(var r,a=[],o=t;o<n;o+=3)r=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),a.push(i(r));return a.join("")}function l(e){for(var t,n=e.length,r=n%3,a="",o=[],i=0,l=n-r;i<l;i+=16383)o.push(s(e,i,i+16383>l?l:i+16383));return 1===r?(t=e[n-1],a+=u[t>>2],a+=u[t<<4&63],a+="=="):2===r&&(t=(e[n-2]<<8)+e[n-1],a+=u[t>>10],a+=u[t>>4&63],a+=u[t<<2&63],a+="="),o.push(a),o.join("")}t.byteLength=a,t.toByteArray=o,t.fromByteArray=l;for(var u=[],c=[],d="undefined"!==typeof Uint8Array?Uint8Array:Array,p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",f=0,h=p.length;f<h;++f)u[f]=p[f],c[p.charCodeAt(f)]=f;c["-".charCodeAt(0)]=62,c["_".charCodeAt(0)]=63},707:function(e,t){t.read=function(e,t,n,r,a){var o,i,s=8*a-r-1,l=(1<<s)-1,u=l>>1,c=-7,d=n?a-1:0,p=n?-1:1,f=e[t+d];for(d+=p,o=f&(1<<-c)-1,f>>=-c,c+=s;c>0;o=256*o+e[t+d],d+=p,c-=8);for(i=o&(1<<-c)-1,o>>=-c,c+=r;c>0;i=256*i+e[t+d],d+=p,c-=8);if(0===o)o=1-u;else{if(o===l)return i?NaN:1/0*(f?-1:1);i+=Math.pow(2,r),o-=u}return(f?-1:1)*i*Math.pow(2,o-r)},t.write=function(e,t,n,r,a,o){var i,s,l,u=8*o-a-1,c=(1<<u)-1,d=c>>1,p=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,h=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,i=c):(i=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-i))<1&&(i--,l*=2),t+=i+d>=1?p/l:p*Math.pow(2,1-d),t*l>=2&&(i++,l/=2),i+d>=c?(s=0,i=c):i+d>=1?(s=(t*l-1)*Math.pow(2,a),i+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,a),i=0));a>=8;e[n+f]=255&s,f+=h,s/=256,a-=8);for(i=i<<a|s,u+=a;u>0;e[n+f]=255&i,f+=h,i/=256,u-=8);e[n+f-h]|=128*m}},708:function(e,t,n){e.exports=n(709),e.exports.parser=n(107)},709:function(e,t,n){function r(e,t){if(!(this instanceof r))return new r(e,t);t=t||{},e&&"object"===typeof e&&(t=e,e=null),e?(e=c(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=c(t.host).host),this.secure=null!=t.secure?t.secure:"undefined"!==typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.agent=t.agent||!1,this.hostname=t.hostname||("undefined"!==typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!==typeof location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"===typeof this.query&&(this.query=d.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.transportOptions=t.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.perMessageDeflate=!1!==t.perMessageDeflate&&(t.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=t.pfx||null,this.key=t.key||null,this.passphrase=t.passphrase||null,this.cert=t.cert||null,this.ca=t.ca||null,this.ciphers=t.ciphers||null,this.rejectUnauthorized=void 0===t.rejectUnauthorized||t.rejectUnauthorized,this.forceNode=!!t.forceNode,this.isReactNative="undefined"!==typeof navigator&&"string"===typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),("undefined"===typeof self||this.isReactNative)&&(t.extraHeaders&&Object.keys(t.extraHeaders).length>0&&(this.extraHeaders=t.extraHeaders),t.localAddress&&(this.localAddress=t.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}function a(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}var o=n(348),i=n(106),s=n(175)("engine.io-client:socket"),l=n(262),u=n(107),c=n(344),d=n(173);e.exports=r,r.priorWebsocketSuccess=!1,i(r.prototype),r.protocol=u.protocol,r.Socket=r,r.Transport=n(238),r.transports=n(348),r.parser=n(107),r.prototype.createTransport=function(e){s('creating transport "%s"',e);var t=a(this.query);t.EIO=u.protocol,t.transport=e;var n=this.transportOptions[e]||{};return this.id&&(t.sid=this.id),new o[e]({query:t,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0,isReactNative:this.isReactNative})},r.prototype.open=function(){var e;if(this.rememberUpgrade&&r.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout(function(){t.emit("error","No transports available")},0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},r.prototype.setTransport=function(e){s("setting transport %s",e.name);var t=this;this.transport&&(s("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},r.prototype.probe=function(e){function t(){if(p.onlyBinaryUpgrades){var t=!this.supportsBinary&&p.transport.supportsBinary;d=d||t}d||(s('probe transport "%s" opened',e),c.send([{type:"ping",data:"probe"}]),c.once("packet",function(t){if(!d)if("pong"===t.type&&"probe"===t.data){if(s('probe transport "%s" pong',e),p.upgrading=!0,p.emit("upgrading",c),!c)return;r.priorWebsocketSuccess="websocket"===c.name,s('pausing current transport "%s"',p.transport.name),p.transport.pause(function(){d||"closed"!==p.readyState&&(s("changing transport and sending upgrade packet"),u(),p.setTransport(c),c.send([{type:"upgrade"}]),p.emit("upgrade",c),c=null,p.upgrading=!1,p.flush())})}else{s('probe transport "%s" failed',e);var n=new Error("probe error");n.transport=c.name,p.emit("upgradeError",n)}}))}function n(){d||(d=!0,u(),c.close(),c=null)}function a(t){var r=new Error("probe error: "+t);r.transport=c.name,n(),s('probe transport "%s" failed because of error: %s',e,t),p.emit("upgradeError",r)}function o(){a("transport closed")}function i(){a("socket closed")}function l(e){c&&e.name!==c.name&&(s('"%s" works - aborting "%s"',e.name,c.name),n())}function u(){c.removeListener("open",t),c.removeListener("error",a),c.removeListener("close",o),p.removeListener("close",i),p.removeListener("upgrading",l)}s('probing transport "%s"',e);var c=this.createTransport(e,{probe:1}),d=!1,p=this;r.priorWebsocketSuccess=!1,c.once("open",t),c.once("error",a),c.once("close",o),this.once("close",i),this.once("upgrading",l),c.open()},r.prototype.onOpen=function(){if(s("socket open"),this.readyState="open",r.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){s("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},r.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(s('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else s('packet received with socket readyState "%s"',this.readyState)},r.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},r.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){"closed"!==t.readyState&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},r.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){s("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},r.prototype.ping=function(){var e=this;this.sendPacket("ping",function(){e.emit("ping")})},r.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},r.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(s("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},r.prototype.write=r.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},r.prototype.sendPacket=function(e,t,n,r){if("function"===typeof t&&(r=t,t=void 0),"function"===typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){n=n||{},n.compress=!1!==n.compress;var a={type:e,data:t,options:n};this.emit("packetCreate",a),this.writeBuffer.push(a),r&&this.once("flush",r),this.flush()}},r.prototype.close=function(){function e(){r.onClose("forced close"),s("socket closing - telling transport to close"),r.transport.close()}function t(){r.removeListener("upgrade",t),r.removeListener("upgradeError",t),e()}function n(){r.once("upgrade",t),r.once("upgradeError",t)}if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var r=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?n():e()}):this.upgrading?n():e()}return this},r.prototype.onError=function(e){s("socket error %j",e),r.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},r.prototype.onClose=function(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){s('socket close with reason: "%s"',e);var n=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),n.writeBuffer=[],n.prevBufferLen=0}},r.prototype.filterUpgrades=function(e){for(var t=[],n=0,r=e.length;n<r;n++)~l(this.transports,e[n])&&t.push(e[n]);return t}},710:function(e,t){try{e.exports="undefined"!==typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},711:function(e,t,n){function r(){}function a(e){if(l.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,"undefined"!==typeof location){var t="https:"===location.protocol,n=location.port;n||(n=t?443:80),this.xd="undefined"!==typeof location&&e.hostname!==location.hostname||n!==e.port,this.xs=e.secure!==t}}function o(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}function i(){for(var e in o.requests)o.requests.hasOwnProperty(e)&&o.requests[e].abort()}var s=n(237),l=n(349),u=n(106),c=n(174),d=n(175)("engine.io-client:polling-xhr");if(e.exports=a,e.exports.Request=o,c(a,l),a.prototype.supportsBinary=!0,a.prototype.request=function(e){return e=e||{},e.uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new o(e)},a.prototype.doWrite=function(e,t){var n="string"!==typeof e&&void 0!==e,r=this.request({method:"POST",data:e,isBinary:n}),a=this;r.on("success",t),r.on("error",function(e){a.onError("xhr post error",e)}),this.sendXhr=r},a.prototype.doPoll=function(){d("xhr poll");var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e},u(o.prototype),o.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new s(e),n=this;try{d("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.extraHeaders){t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0);for(var r in this.extraHeaders)this.extraHeaders.hasOwnProperty(r)&&t.setRequestHeader(r,this.extraHeaders[r])}}catch(e){}if("POST"===this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{t.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in t&&(t.withCredentials=!0),this.requestTimeout&&(t.timeout=this.requestTimeout),this.hasXDR()?(t.onload=function(){n.onLoad()},t.onerror=function(){n.onError(t.responseText)}):t.onreadystatechange=function(){if(2===t.readyState)try{var e=t.getResponseHeader("Content-Type");n.supportsBinary&&"application/octet-stream"===e&&(t.responseType="arraybuffer")}catch(e){}4===t.readyState&&(200===t.status||1223===t.status?n.onLoad():setTimeout(function(){n.onError(t.status)},0))},d("xhr data %s",this.data),t.send(this.data)}catch(e){return void setTimeout(function(){n.onError(e)},0)}"undefined"!==typeof document&&(this.index=o.requestsCount++,o.requests[this.index]=this)},o.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},o.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},o.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},o.prototype.cleanup=function(e){if("undefined"!==typeof this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=r:this.xhr.onreadystatechange=r,e)try{this.xhr.abort()}catch(e){}"undefined"!==typeof document&&delete o.requests[this.index],this.xhr=null}},o.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type")}catch(e){}e="application/octet-stream"===t?this.xhr.response||this.xhr.responseText:this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},o.prototype.hasXDR=function(){return"undefined"!==typeof XDomainRequest&&!this.xs&&this.enablesXDR},o.prototype.abort=function(){this.cleanup()},o.requestsCount=0,o.requests={},"undefined"!==typeof document)if("function"===typeof attachEvent)attachEvent("onunload",i);else if("function"===typeof addEventListener){var p="onpagehide"in self?"pagehide":"unload";addEventListener(p,i,!1)}},712:function(e,t){e.exports=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var r in e)n.call(e,r)&&t.push(r);return t}},713:function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},714:function(e,t){e.exports=function(e,t,n){var r=e.byteLength;if(t=t||0,n=n||r,e.slice)return e.slice(t,n);if(t<0&&(t+=r),n<0&&(n+=r),n>r&&(n=r),t>=r||t>=n||0===r)return new ArrayBuffer(0);for(var a=new Uint8Array(e),o=new Uint8Array(n-t),i=t,s=0;i<n;i++,s++)o[s]=a[i];return o.buffer}},715:function(e,t){function n(e,t,n){function a(e,r){if(a.count<=0)throw new Error("after called too many times");--a.count,e?(o=!0,t(e),t=n):0!==a.count||o||t(null,r)}var o=!1;return n=n||r,a.count=e,0===e?t():a}function r(){}e.exports=n},716:function(e,t){function n(e){for(var t,n,r=[],a=0,o=e.length;a<o;)t=e.charCodeAt(a++),t>=55296&&t<=56319&&a<o?(n=e.charCodeAt(a++),56320==(64512&n)?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),a--)):r.push(t);return r}function r(e){for(var t,n=e.length,r=-1,a="";++r<n;)t=e[r],t>65535&&(t-=65536,a+=h(t>>>10&1023|55296),t=56320|1023&t),a+=h(t);return a}function a(e,t){if(e>=55296&&e<=57343){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function o(e,t){return h(e>>t&63|128)}function i(e,t){if(0==(4294967168&e))return h(e);var n="";return 0==(4294965248&e)?n=h(e>>6&31|192):0==(4294901760&e)?(a(e,t)||(e=65533),n=h(e>>12&15|224),n+=o(e,6)):0==(4292870144&e)&&(n=h(e>>18&7|240),n+=o(e,12),n+=o(e,6)),n+=h(63&e|128)}function s(e,t){t=t||{};for(var r,a=!1!==t.strict,o=n(e),s=o.length,l=-1,u="";++l<s;)r=o[l],u+=i(r,a);return u}function l(){if(f>=p)throw Error("Invalid byte index");var e=255&d[f];if(f++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function u(e){var t,n,r,o,i;if(f>p)throw Error("Invalid byte index");if(f==p)return!1;if(t=255&d[f],f++,0==(128&t))return t;if(192==(224&t)){if(n=l(),(i=(31&t)<<6|n)>=128)return i;throw Error("Invalid continuation byte")}if(224==(240&t)){if(n=l(),r=l(),(i=(15&t)<<12|n<<6|r)>=2048)return a(i,e)?i:65533;throw Error("Invalid continuation byte")}if(240==(248&t)&&(n=l(),r=l(),o=l(),(i=(7&t)<<18|n<<12|r<<6|o)>=65536&&i<=1114111))return i;throw Error("Invalid UTF-8 detected")}function c(e,t){t=t||{};var a=!1!==t.strict;d=n(e),p=d.length,f=0;for(var o,i=[];!1!==(o=u(a));)i.push(o);return r(i)}var d,p,f,h=String.fromCharCode;e.exports={version:"2.1.2",encode:s,decode:c}},717:function(e,t){!function(){"use strict";for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=new Uint8Array(256),r=0;r<e.length;r++)n[e.charCodeAt(r)]=r;t.encode=function(t){var n,r=new Uint8Array(t),a=r.length,o="";for(n=0;n<a;n+=3)o+=e[r[n]>>2],o+=e[(3&r[n])<<4|r[n+1]>>4],o+=e[(15&r[n+1])<<2|r[n+2]>>6],o+=e[63&r[n+2]];return a%3===2?o=o.substring(0,o.length-1)+"=":a%3===1&&(o=o.substring(0,o.length-2)+"=="),o},t.decode=function(e){var t,r,a,o,i,s=.75*e.length,l=e.length,u=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var c=new ArrayBuffer(s),d=new Uint8Array(c);for(t=0;t<l;t+=4)r=n[e.charCodeAt(t)],a=n[e.charCodeAt(t+1)],o=n[e.charCodeAt(t+2)],i=n[e.charCodeAt(t+3)],d[u++]=r<<2|a>>4,d[u++]=(15&a)<<4|o>>2,d[u++]=(3&o)<<6|63&i;return c}}()},718:function(e,t){function n(e){return e.map(function(e){if(e.buffer instanceof ArrayBuffer){var t=e.buffer;if(e.byteLength!==t.byteLength){var n=new Uint8Array(e.byteLength);n.set(new Uint8Array(t,e.byteOffset,e.byteLength)),t=n.buffer}return t}return e})}function r(e,t){t=t||{};var r=new o;return n(e).forEach(function(e){r.append(e)}),t.type?r.getBlob(t.type):r.getBlob()}function a(e,t){return new Blob(n(e),t||{})}var o="undefined"!==typeof o?o:"undefined"!==typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!==typeof MSBlobBuilder?MSBlobBuilder:"undefined"!==typeof MozBlobBuilder&&MozBlobBuilder,i=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),s=i&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),l=o&&o.prototype.append&&o.prototype.getBlob;"undefined"!==typeof Blob&&(r.prototype=Blob.prototype,a.prototype=Blob.prototype),e.exports=function(){return i?s?Blob:a:l?r:void 0}()},719:function(e,t,n){function r(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}function a(e){function n(){if(n.enabled){var e=n,r=+new Date,o=r-(a||r);e.diff=o,e.prev=a,e.curr=r,a=r;for(var i=new Array(arguments.length),s=0;s<i.length;s++)i[s]=arguments[s];i[0]=t.coerce(i[0]),"string"!==typeof i[0]&&i.unshift("%O");var l=0;i[0]=i[0].replace(/%([a-zA-Z%])/g,function(n,r){if("%%"===n)return n;l++;var a=t.formatters[r];if("function"===typeof a){var o=i[l];n=a.call(e,o),i.splice(l,1),l--}return n}),t.formatArgs.call(e,i);(n.log||t.log||console.log.bind(console)).apply(e,i)}}var a;return n.namespace=e,n.enabled=t.enabled(e),n.useColors=t.useColors(),n.color=r(e),n.destroy=o,"function"===typeof t.init&&t.init(n),t.instances.push(n),n}function o(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}function i(e){t.save(e),t.names=[],t.skips=[];var n,r=("string"===typeof e?e:"").split(/[\s,]+/),a=r.length;for(n=0;n<a;n++)r[n]&&(e=r[n].replace(/\*/g,".*?"),"-"===e[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var o=t.instances[n];o.enabled=t.enabled(o.namespace)}}function s(){t.enable("")}function l(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1}function u(e){return e instanceof Error?e.stack||e.message:e}t=e.exports=a.debug=a.default=a,t.coerce=u,t.disable=s,t.enable=i,t.enabled=l,t.humanize=n(235),t.instances=[],t.names=[],t.skips=[],t.formatters={}},72:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function e(t){r(this,e),this.id=t.file_tag_id,this.repo_tag_id=t.repo_tag_id,this.name=t.tag_name,this.color=t.tag_color};t.default=a},720:function(e,t,n){(function(t){function r(){}function a(){return"undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof t?t:{}}function o(e){if(i.call(this,e),this.query=this.query||{},!l){var t=a();l=t.___eio=t.___eio||[]}this.index=l.length;var n=this;l.push(function(e){n.onData(e)}),this.query.j=this.index,"function"===typeof addEventListener&&addEventListener("beforeunload",function(){n.script&&(n.script.onerror=r)},!1)}var i=n(349),s=n(174);e.exports=o;var l,u=/\n/g,c=/\\n/g;s(o,i),o.prototype.supportsBinary=!1,o.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),i.prototype.doClose.call(this)},o.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(t,n):(document.head||document.body).appendChild(t),this.script=t,"undefined"!==typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},o.prototype.doWrite=function(e,t){function n(){r(),t()}function r(){if(a.iframe)try{a.form.removeChild(a.iframe)}catch(e){a.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+a.iframeId+'">';o=document.createElement(e)}catch(e){o=document.createElement("iframe"),o.name=a.iframeId,o.src="javascript:0"}o.id=a.iframeId,a.form.appendChild(o),a.iframe=o}var a=this;if(!this.form){var o,i=document.createElement("form"),s=document.createElement("textarea"),l=this.iframeId="eio_iframe_"+this.index;i.className="socketio",i.style.position="absolute",i.style.top="-1000px",i.style.left="-1000px",i.target=l,i.method="POST",i.setAttribute("accept-charset","utf-8"),s.name="d",i.appendChild(s),document.body.appendChild(i),this.form=i,this.area=s}this.form.action=this.uri(),r(),e=e.replace(c,"\\\n"),this.area.value=e.replace(u,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===a.iframe.readyState&&n()}:this.iframe.onload=n}}).call(t,n(30))},721:function(e,t,n){(function(t){function r(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=a&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(p=o),i.call(this,e)}var a,o,i=n(238),s=n(107),l=n(173),u=n(174),c=n(351),d=n(175)("engine.io-client:websocket");if("undefined"===typeof self)try{o=n(722)}catch(e){}else a=self.WebSocket||self.MozWebSocket;var p=a||o;e.exports=r,u(r,i),r.prototype.name="websocket",r.prototype.supportsBinary=!0,r.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,n={agent:this.agent,perMessageDeflate:this.perMessageDeflate};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?t?new p(e,t):new p(e):new p(e,t,n)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},r.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},r.prototype.write=function(e){function n(){r.emit("flush"),setTimeout(function(){r.writable=!0,r.emit("drain")},0)}var r=this;this.writable=!1;for(var a=e.length,o=0,i=a;o<i;o++)!function(e){s.encodePacket(e,r.supportsBinary,function(o){if(!r.usingBrowserWebSocket){var i={};if(e.options&&(i.compress=e.options.compress),r.perMessageDeflate){("string"===typeof o?t.byteLength(o):o.length)<r.perMessageDeflate.threshold&&(i.compress=!1)}}try{r.usingBrowserWebSocket?r.ws.send(o):r.ws.send(o,i)}catch(e){d("websocket closed before onclose event")}--a||n()})}(e[o])},r.prototype.onClose=function(){i.prototype.onClose.call(this)},r.prototype.doClose=function(){"undefined"!==typeof this.ws&&this.ws.close()},r.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"===t&&443!==Number(this.port)||"ws"===t&&80!==Number(this.port))&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=c()),this.supportsBinary||(e.b64=1),e=l.encode(e),e.length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e},r.prototype.check=function(){return!!p&&!("__initialize"in p&&this.name===r.prototype.name)}}).call(t,n(29).Buffer)},722:function(e,t){},723:function(e,t){function n(e,t){var n=[];t=t||0;for(var r=t||0;r<e.length;r++)n[r-t]=e[r];return n}e.exports=n},724:function(e,t){function n(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=n,n.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(e){this.ms=e},n.prototype.setMax=function(e){this.max=e},n.prototype.setJitter=function(e){this.jitter=e}},726:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function e(t){r(this,e),this.id=t.repo_tag_id,this.fileCount=t.files_count,this.name=t.tag_name,this.color=t.tag_color};t.default=a},727:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(949),h=r(f),m=n(950),g=r(m),y=n(13),v=r(y),b={repoID:d.default.string.isRequired,filePath:d.default.string.isRequired,toggleCancel:d.default.func.isRequired,onRelatedFileChange:d.default.func.isRequired,dirent:d.default.object.isRequired,relatedFiles:d.default.array,viewMode:d.default.oneOf(["list_related_file","add_related_file"]).isRequired},w=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onAddRelatedFileToggle=function(){n.setState({showListRelatedFileDialog:!1})},n.onCloseAddRelatedFileDialog=function(){n.setState({showListRelatedFileDialog:!0})},n.state={showListRelatedFileDialog:"list_related_file"===e.viewMode},n}return i(t,e),s(t,[{key:"render",value:function(){return u.default.createElement(v.default,null,u.default.createElement(p.Modal,{isOpen:!0,toggle:this.props.toggleCancel,size:"lg",style:{width:"650px"}},this.state.showListRelatedFileDialog&&u.default.createElement(g.default,{filePath:this.props.filePath,relatedFiles:this.props.relatedFiles,repoID:this.props.repoID,toggleCancel:this.props.toggleCancel,addRelatedFileToggle:this.onAddRelatedFileToggle,onRelatedFileChange:this.props.onRelatedFileChange}),!this.state.showListRelatedFileDialog&&u.default.createElement(h.default,{filePath:this.props.filePath,repoID:this.props.repoID,toggleCancel:this.onCloseAddRelatedFileDialog,onRelatedFileChange:this.props.onRelatedFileChange,dirent:this.props.dirent,onClose:this.props.toggleCancel})))}}]),t}(u.default.Component);w.propTypes=b,t.default=w},733:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(734),f=r(p),h=n(6),m=n(2),g=n(3),y={tagName:d.default.string,item:d.default.object.isRequired,toggleClass:d.default.string,isHandleContextMenuEvent:d.default.bool,getMenuList:d.default.func.isRequired,onMenuItemClick:d.default.func.isRequired,freezeItem:d.default.func,unfreezeItem:d.default.func},v=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onShowMenu=function(){},n.onHideMenu=function(){n.state.isItemMenuShow&&(n.setState({isItemMenuShow:!1}),"function"===typeof n.props.unfreezeItem&&n.props.unfreezeItem())},n.onDropdownToggleClick=function(e){e.preventDefault(),e.stopPropagation(),n.toggleOperationMenu()},n.toggleOperationMenu=function(){n.setState({isItemMenuShow:!n.state.isItemMenuShow},function(){n.state.isItemMenuShow&&"function"===typeof n.props.freezeItem?n.props.freezeItem():n.state.isItemMenuShow||"function"!==typeof n.props.unfreezeItem||n.props.unfreezeItem()})},n.onMenuItemClick=function(e){var t=g.Utils.getEventData(e,"toggle"),r=n.props.item;n.props.onMenuItemClick(t,e,r)},n.state={menuList:[],isItemMenuShow:!1},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){this.props.isHandleContextMenuEvent&&(this.listenerId=f.default.register(this.onShowMenu,this.onHideMenu));var e=this.props.item,t=this.props.getMenuList(e);this.setState({menuList:t})}},{key:"componentWillReceiveProps",value:function(e){var t=e.item;if(t.name!==this.props.item.name){var n=this.props.getMenuList(t);this.setState({menuList:n})}}},{key:"componentWillUnmount",value:function(){this.props.isHandleContextMenuEvent&&this.listenerId&&f.default.unregister(this.listenerId)}},{key:"render",value:function(){var e=this,t=this.state.menuList,n=this.props,r=n.toggleClass,a=n.tagName;return r="sf-dropdown-toggle "+r,t.length?a&&"button"===a?u.default.createElement(h.ButtonDropdown,{isOpen:this.state.isItemMenuShow,toggle:this.onDropdownToggleClick,title:(0,m.gettext)("More Operations")},u.default.createElement(h.DropdownToggle,{className:r,"data-toggle":"dropdown",title:(0,m.gettext)("More Operations"),"aria-expanded":this.state.isItemMenuShow}),u.default.createElement(h.DropdownMenu,null,t.map(function(t,n){return"Divider"===t?u.default.createElement(h.DropdownItem,{key:n,divider:!0}):u.default.createElement(h.DropdownItem,{key:n,"data-toggle":t.key,onClick:e.onMenuItemClick},t.value)}))):u.default.createElement(h.Dropdown,{isOpen:this.state.isItemMenuShow,toggle:this.onDropdownToggleClick},u.default.createElement(h.DropdownToggle,{tag:a||"i",className:r,title:(0,m.gettext)("More Operations"),"data-toggle":"dropdown","aria-expanded":this.state.isItemMenuShow}),u.default.createElement(h.DropdownMenu,null,t.map(function(t,n){return"Divider"===t?u.default.createElement(h.DropdownItem,{key:n,divider:!0}):u.default.createElement(h.DropdownItem,{key:n,"data-toggle":t.key,onClick:e.onMenuItemClick},t.value)}))):""}}]),t}(u.default.Component);v.defaultProps={isHandleContextMenuEvent:!0,toggleClass:"sf2-icon-caret-down"},v.propTypes=y,t.default=v},734:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=n(274),o=n(384),i=function e(){var t=this;r(this,e),this.handleShowEvent=function(e){for(var n in t.callbacks)(0,o.hasOwnProp)(t.callbacks,n)&&t.callbacks[n].show(e)},this.handleHideEvent=function(e){for(var n in t.callbacks)(0,o.hasOwnProp)(t.callbacks,n)&&t.callbacks[n].hide(e)},this.register=function(e,n){var r=(0,o.uniqueId)();return t.callbacks[r]={show:e,hide:n},r},this.unregister=function(e){e&&t.callbacks[e]&&delete t.callbacks[e]},this.callbacks={},o.canUseDOM&&(window.addEventListener(a.MENU_SHOW,this.handleShowEvent),window.addEventListener(a.MENU_HIDE,this.handleHideEvent))};t.default=new i},735:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(734),f=r(p),h=n(274),m=n(384),g=n(3),y={id:d.default.string.isRequired,rtl:d.default.bool,onMenuItemClick:d.default.func.isRequired,onShowMenu:d.default.func,onHideMenu:d.default.func},v=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.registerHandlers=function(){document.addEventListener("mousedown",n.handleOutsideClick),document.addEventListener("touchstart",n.handleOutsideClick),document.addEventListener("scroll",n.handleHide),document.addEventListener("contextmenu",n.handleHide),document.addEventListener("keydown",n.handleKeyNavigation),window.addEventListener("resize",n.handleHide)},n.unregisterHandlers=function(){document.removeEventListener("mousedown",n.handleOutsideClick),document.removeEventListener("touchstart",n.handleOutsideClick),document.removeEventListener("scroll",n.handleHide),document.removeEventListener("contextmenu",n.handleHide),document.removeEventListener("keydown",n.handleKeyNavigation),window.removeEventListener("resize",n.handleHide)},n.handleShow=function(e){if(e.detail.id===n.props.id&&!n.state.isVisible){var t=e.detail.position,r=t.x,a=t.y,o=e.detail,i=o.currentObject,s=o.menuList;n.setState({isVisible:!0,x:r,y:a,currentObject:i,menuList:s}),n.registerHandlers(),(0,m.callIfExists)(n.props.onShowMenu,e)}},n.handleHide=function(e){!n.state.isVisible||e.detail&&e.detail.id&&e.detail.id!==n.props.id||(n.unregisterHandlers(),n.setState({isVisible:!1}),(0,m.callIfExists)(n.props.onHideMenu,e))},n.handleOutsideClick=function(e){n.menu.contains(e.target)||(0,h.hideMenu)()},n.handleMouseLeave=function(e){e.preventDefault(),n.props.hideOnLeave&&(0,h.hideMenu)()},n.handleContextMenu=function(e){n.handleHide(e)},n.handleKeyNavigation=function(e){!1!==n.state.isVisible&&(e.preventDefault(),n.hideMenu(e))},n.hideMenu=function(e){27!==e.keyCode&&13!==e.keyCode||(0,h.hideMenu)()},n.getMenuPosition=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r={top:t,left:e};if(!n.menu)return r;var a=window,o=a.innerWidth,i=a.innerHeight,s=n.menu.getBoundingClientRect();return t+s.height>i&&(r.top-=s.height),e+s.width>o&&(r.left-=s.width),r.top<0&&(r.top=s.height<i?(i-s.height)/2:0),r.left<0&&(r.left=s.width<o?(o-s.width)/2:0),r},n.getRTLMenuPosition=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r={top:t,left:e};if(!n.menu)return r;var a=window,o=a.innerWidth,i=a.innerHeight,s=n.menu.getBoundingClientRect();return r.left=e-s.width,t+s.height>i&&(r.top-=s.height),r.left<0&&(r.left+=s.width),r.top<0&&(r.top=s.height<i?(i-s.height)/2:0),r.left+s.width>o&&(r.left=s.width<o?(o-s.width)/2:0),r},n.onMenuItemClick=function(e){e.stopPropagation();var t=g.Utils.getEventData(e,"operation"),r=n.state.currentObject;n.props.onMenuItemClick(t,r,e)},n.onContextMenu=function(e){e.stopPropagation()},n.state={x:0,y:0,isVisible:!1,currentObject:null,menuList:[]},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){this.listenId=f.default.register(this.handleShow,this.handleHide)}},{key:"componentDidUpdate",value:function(){var e=this;if(this.state.isVisible){var t=window.requestAnimationFrame||setTimeout;t(function(){var n=e.state,r=n.x,a=n.y,o=e.props.rtl?e.getRTLMenuPosition(r,a):e.getMenuPosition(r,a),i=o.top,s=o.left;t(function(){e.menu&&(e.menu.style.top=i+"px",e.menu.style.left=s+"px",e.menu.style.opacity=1,e.menu.style.pointerEvents="auto")})})}else{if(!this.menu)return;this.menu.style.opacity=0,this.menu.style.pointerEvents="none"}}},{key:"componentWillUnmount",value:function(){this.listenId&&f.default.unregister(this.listenId),this.unregisterHandlers()}},{key:"render",value:function(){var e=this,t={position:"fixed",opacity:0,pointerEvents:"none",display:"block"};return u.default.createElement("div",{role:"menu",className:"seafile-contextmenu dropdown-menu",style:t,ref:function(t){e.menu=t}},this.state.menuList.map(function(t,n){return"Divider"===t?u.default.createElement("div",{key:n,className:"seafile-divider dropdown-divider"}):u.default.createElement("button",{key:n,className:"seafile-contextmenu-item dropdown-item","data-operation":t.key,onClick:e.onMenuItemClick,onContextMenu:e.onContextMenu},t.value)}))}}]),t}(u.default.Component);v.propTypes=y,t.default=v},736:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(a)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=r(u),d=n(1),p=r(d),f=n(6),h=n(2),m={toggleDialog:p.default.func.isRequired,sortBy:p.default.string.isRequired,sortOrder:p.default.string.isRequired,sortItems:p.default.func.isRequired},g=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));y.call(n),n.sortOptions=[{value:"name-asc",text:(0,h.gettext)("By name ascending")},{value:"name-desc",text:(0,h.gettext)("By name descending")},{value:"size-asc",text:(0,h.gettext)("By size ascending")},{value:"size-desc",text:(0,h.gettext)("By size descending")},{value:"time-asc",text:(0,h.gettext)("By time ascending")},{value:"time-desc",text:(0,h.gettext)("By time descending")}];var r=n.props,i=r.sortBy,s=r.sortOrder;return n.state={currentOption:i+"-"+s},n}return i(t,e),l(t,[{key:"render",value:function(){var e=this;return c.default.createElement(f.Modal,{isOpen:!0,toggle:this.props.toggleDialog},c.default.createElement(f.ModalBody,null,this.sortOptions.map(function(t,n){return c.default.createElement(u.Fragment,{key:n},c.default.createElement("input",{id:"option-"+n,className:"align-middle",type:"radio",name:"sort-option",value:t.value,checked:e.state.currentOption==t.value,onChange:e.switchOption}),c.default.createElement("label",{htmlFor:"option-"+n,className:"align-middle m-2"},t.text),c.default.createElement("br",null))})))}}]),t}(c.default.Component),y=function(){var e=this;this.switchOption=function(t){if(t.target.checked){e.setState({currentOption:t.target.value});var n=t.target.value.split("-"),r=s(n,2),a=r[0],o=r[1];e.props.sortItems(a,o),e.props.toggleDialog()}}};g.propTypes=m,t.default=g},737:function(e,t,n){"use strict";function r(e,t){if(null==e)return{};var n,r,o=a(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function a(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(e){return e&&e.__esModule?e:{default:e}}(n(0)),i=function(e){return function(t){var n=(t.in,t.onExited,t.appear,t.enter,t.exit,r(t,["in","onExited","appear","enter","exit"]));return o.default.createElement(e,n)}},s=i;t.default=s},738:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function a(e,t){if(null==e)return{};var n,r,a=o(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function o(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(n(0)),s=n(240),l=function(e){return function(t){var n=t.in,o=t.onExited,l=a(t,["in","onExited"]);return i.default.createElement(s.Collapse,{in:n,onExited:o},i.default.createElement(e,r({cropWithEllipsis:n},l)))}},u=l;t.default=u},739:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){return e&&e.__esModule?e:{default:e}}(n(0)),o=n(240),i=function(e){return function(t){return a.default.createElement(o.Fade,r({component:e,duration:t.isMulti?o.collapseDuration:1},t))}},s=i;t.default=s},740:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){return e&&e.__esModule?e:{default:e}}(n(0)),o=n(240),i=function(e){return function(t){return a.default.createElement(o.Fade,r({component:e},t))}},s=i;t.default=s},741:function(e,t,n){"use strict";function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){return e&&e.__esModule?e:{default:e}}(n(0)),o=n(379),i=function(e){return function(t){return a.default.createElement(o.TransitionGroup,r({component:e},t))}},s=i;t.default=s},742:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e){return(a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(){return o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o.apply(this,arguments)}function i(e){return u(e)||l(e)||s()}function s(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function l(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function u(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),e}function f(e,t){return!t||"object"!==a(t)&&"function"!==typeof t?y(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.makeCreatableSelect=t.defaultProps=void 0;var b=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(0)),w=r(n(840)),E=n(467),S=r(n(843)),C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n=String(e).toLowerCase(),r=String(t.value).toLowerCase(),a=String(t.label).toLowerCase();return r===n||a===n},D={formatCreateLabel:function(e){return'Create "'.concat(e,'"')},isValidNewOption:function(e,t,n){return!(!e||t.some(function(t){return C(e,t)})||n.some(function(t){return C(e,t)}))},getNewOptionData:function(e,t){return{label:t,value:e,__isNew__:!0}}},_=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){v(e,t,n[t])})}return e}({allowCreateWhileLoading:!1,createOptionPosition:"last"},D);t.defaultProps=_;var P=function(e){var t,n;return n=t=function(t){function n(e){var t;c(this,n),t=f(this,h(n).call(this,e)),v(y(y(t)),"select",void 0),v(y(y(t)),"onChange",function(e,n){var r=t.props,a=r.getNewOptionData,o=r.inputValue,s=r.isMulti,l=r.onChange,u=r.onCreateOption,c=r.value;if("select-option"!==n.action)return l(e,n);var d=t.state.newOption,p=Array.isArray(e)?e:[e];if(p[p.length-1]!==d)l(e,n);else if(u)u(o);else{var f=a(o,o),h={action:"create-option"};s?l([].concat(i((0,E.cleanValue)(c)),[f]),h):l(f,h)}});var r=e.options||[];return t.state={newOption:void 0,options:r},t}return m(n,t),p(n,[{key:"componentWillReceiveProps",value:function(e){var t=e.allowCreateWhileLoading,n=e.createOptionPosition,r=e.formatCreateLabel,a=e.getNewOptionData,o=e.inputValue,s=e.isLoading,l=e.isValidNewOption,u=e.value,c=e.options||[],d=this.state.newOption;d=l(o,(0,E.cleanValue)(u),c)?a(o,r(o)):void 0,this.setState({newOption:d,options:!t&&s||!d?c:"first"===n?[d].concat(i(c)):[].concat(i(c),[d])})}},{key:"focus",value:function(){this.select.focus()}},{key:"blur",value:function(){this.select.blur()}},{key:"render",value:function(){var t=this,n=o({},this.props),r=this.state.options;return b.default.createElement(e,o({},n,{ref:function(e){t.select=e},options:r,onChange:this.onChange}))}}]),n}(b.Component),v(t,"defaultProps",_),n};t.makeCreatableSelect=P;var k=P(w.default),M=(0,S.default)(k);t.default=M},743:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(2),h=n(3),m=n(2247),g=r(m),y=n(2248),v=r(y);n(147),n(2249);var b={repoID:d.default.string.isRequired,repoName:d.default.string,isDepartmentRepo:d.default.bool,folderPath:d.default.string,folderName:d.default.string,toggleDialog:d.default.func.isRequired},w=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggle=function(e){n.state.activeTab!==e&&n.setState({activeTab:e})},n.renderContent=function(){var e=n.state.activeTab;return u.default.createElement(l.Fragment,null,u.default.createElement("div",{className:"share-dialog-side"},u.default.createElement(p.Nav,{pills:!0},u.default.createElement(p.NavItem,null,u.default.createElement(p.NavLink,{className:"userPermission"===e?"active":"",onClick:n.toggle.bind(n,"userPermission")},(0,f.gettext)("User Permission"))),u.default.createElement(p.NavItem,null,u.default.createElement(p.NavLink,{className:"groupPermission"===e?"active":"",onClick:n.toggle.bind(n,"groupPermission")},(0,f.gettext)("Group Permission"))))),u.default.createElement("div",{className:"share-dialog-main"},u.default.createElement(p.TabContent,{activeTab:n.state.activeTab},u.default.createElement(p.TabPane,{tabId:"userPermission"},u.default.createElement(g.default,{repoID:n.props.repoID,repoName:n.props.repoName,folderPath:n.props.folderPath,isDepartmentRepo:n.props.isDepartmentRepo})),u.default.createElement(p.TabPane,{tabId:"groupPermission"},u.default.createElement(v.default,{repoID:n.props.repoID,repoName:n.props.repoName,folderPath:n.props.folderPath,isDepartmentRepo:n.props.isDepartmentRepo})))))},n.state={activeTab:"userPermission"},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=e.repoName,n=e.folderName;return u.default.createElement("div",null,u.default.createElement(p.Modal,{isOpen:!0,style:{maxWidth:"980px"},className:"share-dialog",toggle:this.props.toggleDialog},u.default.createElement(p.ModalHeader,{toggle:this.props.toggleDialog},u.default.createElement("span",{dangerouslySetInnerHTML:{__html:t?h.Utils.generateDialogTitle((0,f.gettext)("{placeholder} Folder Permission"),t):h.Utils.generateDialogTitle((0,f.gettext)("Set {placeholder}'s permission"),n)}})),u.default.createElement(p.ModalBody,{className:"dialog-list-container share-dialog-content"},this.renderContent())))}}]),t}(u.default.Component);w.propTypes=b,t.default=w},744:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(2),h=n(3),m={fileType:d.default.string,parentPath:d.default.string.isRequired,onAddFile:d.default.func.isRequired,checkDuplicatedName:d.default.func.isRequired,addFileCancel:d.default.func.isRequired},g=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleChange=function(e){e.target.value.trim()?n.setState({isSubmitBtnActive:!0}):n.setState({isSubmitBtnActive:!1}),n.setState({childName:e.target.value})},n.handleSubmit=function(){if(n.state.isSubmitBtnActive){var e=n.checkDuplicatedName(),t=n.state.childName;if(e){var r=(0,f.gettext)('The name "{name}" is already taken. Please choose a different name.');r=r.replace("{name}",h.Utils.HTMLescape(t)),n.setState({errMessage:r})}else{var a=n.state.parentPath+t,o=n.state.isDraft;n.props.onAddFile(a,o)}}},n.handleKeyPress=function(e){"Enter"===e.key&&(n.handleSubmit(),e.preventDefault())},n.handleCheck=function(){var e=n.state.childName.lastIndexOf(".");if(n.state.isDraft){var t=n.state.childName.substring(e-7,e),r=n.state.childName.substring(0,e-7),a=n.state.childName.substring(e);"(draft)"===t?n.setState({childName:r+a,isDraft:!n.state.isDraft}):n.setState({isDraft:!n.state.isDraft})}if(!n.state.isDraft)if(e>0){var o=n.state.childName.substring(0,e),i=n.state.childName.substring(e);n.setState({childName:o+"(draft)"+i,isDraft:!n.state.isDraft})}else 0===e?n.setState({childName:"(draft)"+n.state.childName,isDraft:!n.state.isdraft}):n.setState({isDraft:!n.state.isdraft})},n.toggle=function(){n.props.addFileCancel()},n.checkDuplicatedName=function(){return n.props.checkDuplicatedName(n.state.childName)},n.state={parentPath:"",childName:e.fileType||"",isDraft:!1,errMessage:"",isSubmitBtnActive:!1},n.newInput=u.default.createRef(),n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this.props.parentPath;"/"===e[e.length-1]?this.setState({parentPath:e}):this.setState({parentPath:e+"/"}),this.newInput.focus(),this.newInput.setSelectionRange(0,0)}},{key:"render",value:function(){var e=this;return u.default.createElement(p.Modal,{isOpen:!0,toggle:this.toggle},u.default.createElement(p.ModalHeader,{toggle:this.toggle},(0,f.gettext)("New File")),u.default.createElement(p.ModalBody,null,u.default.createElement(p.Form,null,u.default.createElement(p.FormGroup,null,u.default.createElement(p.Label,{for:"fileName"},(0,f.gettext)("Name")),u.default.createElement(p.Input,{id:"fileName",onKeyPress:this.handleKeyPress,innerRef:function(t){e.newInput=t},value:this.state.childName,onChange:this.handleChange})),".md"==this.props.fileType&&f.isDocs&&u.default.createElement(p.FormGroup,{check:!0},u.default.createElement(p.Label,{check:!0},u.default.createElement(p.Input,{type:"checkbox",onChange:this.handleCheck}),"  ",(0,f.gettext)("This is a draft")))),this.state.errMessage&&u.default.createElement(p.Alert,{color:"danger",className:"mt-2"},this.state.errMessage)),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{color:"secondary",onClick:this.toggle},(0,f.gettext)("Cancel")),u.default.createElement(p.Button,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive},(0,f.gettext)("Submit"))))}}]),t}(u.default.Component);g.propTypes=m,t.default=g},745:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(2),h=n(3),m=n(68),g=r(m),y={path:d.default.string.isRequired,repoID:d.default.string.isRequired,dirent:d.default.object,selectedDirentList:d.default.array,isMutipleOperation:d.default.bool.isRequired,onItemMove:d.default.func,onItemsMove:d.default.func,onCancelMove:d.default.func.isRequired,repoEncrypted:d.default.bool.isRequired},v=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleSubmit=function(){n.props.isMutipleOperation?n.moveItems():n.moveItem()},n.moveItems=function(){var e=n.props.repoID,t=n.state,r=t.repo,a=t.selectedPath,o=(0,f.gettext)("Invalid destination path");if(!r||""===a)return void n.setState({errMessage:o});var i=n.props.selectedDirentList,s=[];if(i.forEach(function(e){var t=h.Utils.joinPath(n.props.path,e.name);s.push(t)}),s.some(function(e){return e===a}))return void n.setState({errMessage:o});if(a&&a===n.props.path&&r.repo_id===e)return void n.setState({errMessage:o});var l="";if(s.some(function(e){var t=a.length>e.length&&a.indexOf(e)>-1;return t&&(l=e),t}))return o=(0,f.gettext)("Can not move directory %(src)s to its subdirectory %(des)s"),o=o.replace("%(src)s",l),o=o.replace("%(des)s",a),void n.setState({errMessage:o});n.props.onItemsMove(r,a),n.toggle()},n.moveItem=function(){var e=n.props.repoID,t=n.state,r=t.repo,a=t.selectedPath,o=h.Utils.joinPath(n.props.path,n.props.dirent.name),i=(0,f.gettext)("Invalid destination path");return!r||r.repo_id===e&&""===a?void n.setState({errMessage:i}):a&&o===a?void n.setState({errMessage:i}):a&&n.props.path===a&&r.repo_id===e?void n.setState({errMessage:i}):a&&a.length>o.length&&a.indexOf(o)>-1?(i=(0,f.gettext)("Can not move directory %(src)s to its subdirectory %(des)s"),i=i.replace("%(src)s",o),i=i.replace("%(des)s",a),void n.setState({errMessage:i})):(n.props.onItemMove(r,n.props.dirent,a,n.props.path),void n.toggle())},n.toggle=function(){n.props.onCancelMove()},n.onDirentItemClick=function(e,t){n.setState({repo:e,selectedPath:t,errMessage:""})},n.onRepoItemClick=function(e){n.setState({repo:e,selectedPath:"/",errMessage:""})},n.state={repo:null,selectedPath:"",errMessage:""},n}return i(t,e),s(t,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.errMessage!==t.errMessage}},{key:"render",value:function(){var e=(0,f.gettext)("Move {placeholder} to");e=this.props.isMutipleOperation?(0,f.gettext)("Move selected item(s) to:"):e.replace("{placeholder}",'<span class="op-target">'+h.Utils.HTMLescape(this.props.dirent.name)+"</span>");var t=this.props.repoEncrypted?"only_current_library":"current_repo_and_other_repos";return u.default.createElement(p.Modal,{isOpen:!0,toggle:this.toggle},u.default.createElement(p.ModalHeader,{toggle:this.toggle},u.default.createElement("div",{dangerouslySetInnerHTML:{__html:e}})),u.default.createElement(p.ModalBody,null,u.default.createElement(g.default,{repoID:this.props.repoID,onDirentItemClick:this.onDirentItemClick,onRepoItemClick:this.onRepoItemClick,mode:t}),this.state.errMessage&&u.default.createElement(p.Alert,{color:"danger",style:{margin:"0.5rem"}},this.state.errMessage)),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{color:"secondary",onClick:this.toggle},(0,f.gettext)("Cancel")),u.default.createElement(p.Button,{color:"primary",onClick:this.handleSubmit},(0,f.gettext)("Submit"))))}}]),t}(u.default.Component);v.propTypes=y,t.default=v},746:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(2),h=n(3),m=n(68),g=r(m),y={path:d.default.string.isRequired,repoID:d.default.string.isRequired,dirent:d.default.object,selectedDirentList:d.default.array,isMutipleOperation:d.default.bool.isRequired,onItemCopy:d.default.func,onItemsCopy:d.default.func,onCancelCopy:d.default.func.isRequired,repoEncrypted:d.default.bool.isRequired},v=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleSubmit=function(){n.props.isMutipleOperation?n.copyItems():n.copyItem()},n.copyItems=function(){var e=(n.props.repoID,n.state),t=e.repo,r=e.selectedPath,a=(0,f.gettext)("Invalid destination path");if(!t||""===r)return void n.setState({errMessage:a});var o=n.props.selectedDirentList,i=[];if(o.forEach(function(e){var t=h.Utils.joinPath(n.props.path,e.name);i.push(t)}),i.some(function(e){return e===r}))return void n.setState({errMessage:a});var s="";if(i.some(function(e){var t=r.length>e.length&&r.indexOf(e)>-1;return t&&(s=e),t}))return a=(0,f.gettext)("Can not move directory %(src)s to its subdirectory %(des)s"),a=a.replace("%(src)s",s),a=a.replace("%(des)s",r),void n.setState({errMessage:a});n.props.onItemsCopy(t,r),n.toggle()},n.copyItem=function(){var e=n.state,t=e.repo,r=e.repoID,a=e.selectedPath,o=h.Utils.joinPath(n.props.path,n.props.dirent.name),i="Invalid destination path";return!t||t.repo_id===r&&""===a?void n.setState({errMessage:i}):a&&o===a?void n.setState({errMessage:i}):a&&n.props.path===a&&t.repo_id===r?void n.setState({errMessage:i}):a&&a.length>o.length&&a.indexOf(o)>-1?(i=(0,f.gettext)("Can not copy directory %(src)s to its subdirectory %(des)s"),i=i.replace("%(src)s",o),i=i.replace("%(des)s",a),void n.setState({errMessage:i})):(n.props.onItemCopy(t,n.props.dirent,a,n.props.path),void n.toggle())},n.toggle=function(){n.props.onCancelCopy()},n.onDirentItemClick=function(e,t){n.setState({repo:e,selectedPath:t,errMessage:""})},n.onRepoItemClick=function(e){n.setState({repo:e,selectedPath:"/",errMessage:""})},n.state={repo:null,selectedPath:"",errMessage:""},n}return i(t,e),s(t,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.errMessage!==t.errMessage}},{key:"render",value:function(){var e=(0,f.gettext)("Copy {placeholder} to");e=this.props.isMutipleOperation?(0,f.gettext)("Copy selected item(s) to:"):e.replace("{placeholder}",'<span class="op-target">'+h.Utils.HTMLescape(this.props.dirent.name)+"</span>");var t=this.props.repoEncrypted?"only_current_library":"current_repo_and_other_repos";return u.default.createElement(p.Modal,{isOpen:!0,toggle:this.toggle},u.default.createElement(p.ModalHeader,{toggle:this.toggle},u.default.createElement("div",{dangerouslySetInnerHTML:{__html:e}})),u.default.createElement(p.ModalBody,null,u.default.createElement(g.default,{repoID:this.props.repoID,onDirentItemClick:this.onDirentItemClick,onRepoItemClick:this.onRepoItemClick,mode:t}),this.state.errMessage&&u.default.createElement(p.Alert,{color:"danger",style:{margin:"0.5rem"}},this.state.errMessage)),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{color:"secondary",onClick:this.toggle},(0,f.gettext)("Cancel")),u.default.createElement(p.Button,{color:"primary",onClick:this.handleSubmit},(0,f.gettext)("Submit"))))}}]),t}(u.default.Component);v.propTypes=y,t.default=v},747:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(2),f=n(1027),h=r(f);n(1036);var m={imageItems:d.default.array.isRequired,imageIndex:d.default.number.isRequired,closeImagePopup:d.default.func.isRequired,moveToPrevImage:d.default.func.isRequired,moveToNextImage:d.default.func.isRequired},g=function(e){function t(e){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.imageItems,t=this.props.imageIndex,n=e.length,r=n&&u.default.createElement(l.Fragment,null,u.default.createElement("span",null,(0,p.gettext)("%curr% of %total%").replace("%curr%",t+1).replace("%total%",n)),u.default.createElement("br",null),u.default.createElement("a",{href:e[t].url,target:"_blank"},(0,p.gettext)("Open in New Tab")));return u.default.createElement(h.default,{mainSrc:e[t].src,imageTitle:e[t].name,imageCaption:r,nextSrc:e[(t+1)%n].src,prevSrc:e[(t+n-1)%n].src,onCloseRequest:this.props.closeImagePopup,onMovePrevRequest:this.props.moveToPrevImage,onMoveNextRequest:this.props.moveToNextImage,imagePadding:70,imageLoadErrorMessage:(0,p.gettext)("The image could not be loaded."),prevLabel:(0,p.gettext)("Previous (Left arrow key)"),nextLabel:(0,p.gettext)("Next (Right arrow key)"),closeLabel:(0,p.gettext)("Close (Esc)"),zoomInLabel:(0,p.gettext)("Zoom in"),zoomOutLabel:(0,p.gettext)("Zoom out")})}}]),t}(u.default.Component);g.propTypes=m,t.default=g},748:function(e,t,n){"use strict";function r(e){var t=e.offsetWidth<=0&&e.offsetHeight<=0;if(t&&!e.innerHTML)return!0;var n=window.getComputedStyle(e);return t?"visible"!==n.getPropertyValue("overflow")||e.scrollWidth<=0&&e.scrollHeight<=0:"none"==n.getPropertyValue("display")}function a(e){for(var t=e;t&&t!==document.body;){if(r(t))return!1;t=t.parentNode}return!0}function o(e,t){var n=e.nodeName.toLowerCase();return(l.test(n)&&!e.disabled||("a"===n?e.href||t:t))&&a(e)}function i(e){var t=e.getAttribute("tabindex");null===t&&(t=void 0);var n=isNaN(t);return(n||t>=0)&&o(e,!n)}function s(e){return[].slice.call(e.querySelectorAll("*"),0).filter(i)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var l=/input|select|textarea|button|object/;e.exports=t.default},749:function(e,t,n){"use strict";function r(e,t){if(!e||!e.length)throw new Error("react-modal: No elements were found for selector "+t+".")}function a(e){var t=e;if("string"===typeof t&&p.canUseDOM){var n=document.querySelectorAll(t);r(n,t),t="length"in n?n[0]:n}return f=t||f}function o(e){return!(!e&&!f)||((0,d.default)(!1,["react-modal: App element is not defined.","Please use `Modal.setAppElement(el)` or set `appElement={el}`.","This is needed so screen readers don't see main content","when modal is opened. It is not recommended, but you can opt-out","by setting `ariaHideApp={false}`."].join(" ")),!1)}function i(e){o(e)&&(e||f).setAttribute("aria-hidden","true")}function s(e){o(e)&&(e||f).removeAttribute("aria-hidden")}function l(){f=null}function u(){f=null}Object.defineProperty(t,"__esModule",{value:!0}),t.assertNodeList=r,t.setElement=a,t.validateElement=o,t.hide=i,t.show=s,t.documentNotReadyOrSSRTesting=l,t.resetForTesting=u;var c=n(1033),d=function(e){return e&&e.__esModule?e:{default:e}}(c),p=n(390),f=null},75:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(3),s=n(77),l=r(s),u=n(34),c=r(u),d=n(43),p=r(d),f=function(){function e(){a(this,e)}return o(e,[{key:"expandNode",value:function(e,t){e.expandNode(t)}},{key:"collapseNode",value:function(e,t){var n=e.clone();return t=n.getNodeByPath(t.path),n.collapseNode(t),n}},{key:"findNodeByPath",value:function(e,t){return e.clone().getNodeByPath(t)}},{key:"getNodeChildrenObject",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"name",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"asc",a=e.getNodeChildrenObject(t);return a=i.Utils.sortDirents(a,n,r)}},{key:"addNodeToParent",value:function(e,t,n){return e.addNodeToParentNode(t,n),e}},{key:"addNodeListToParent",value:function(e,t,n){return e.addNodeListToParent(t,n),e}},{key:"addNodeToParentByPath",value:function(e,t,n){var r=e.clone(),a=r.getNodeByPath(n);return r.addNodeToParent(t,a),r}},{key:"deleteNodeByPath",value:function(e,t){var n=e.clone(),r=n.getNodeByPath(t);return n.deleteNode(r),n}},{key:"deleteNodeListByPaths",value:function(e,t){var n=e.clone();return t.forEach(function(e){var t=n.getNodeByPath(e);n.deleteNode(t)}),n}},{key:"renameNodeByPath",value:function(e,t,n){var r=e.clone(),a=r.getNodeByPath(t);return r.renameNode(a,n),r}},{key:"updateNodeByPath",value:function(e,t,n,r){var a=e.clone(),o=a.getNodeByPath(t);return a.updateNode(o,n,r),a}},{key:"moveNodeByPath",value:function(e,t,n,r){var a=e.clone(),o=a.getNodeByPath(t),i=a.getNodeByPath(n);return i&&o&&(o.object.name=r,a.moveNode(o,i)),!i&&o&&a.deleteNode(o),a}},{key:"moveNodeListByPaths",value:function(e,t,n){var r=e.clone(),a=r.getNodeByPath(n);return a?t.forEach(function(e){var t=r.getNodeByPath(e);r.moveNode(t,a)}):t.forEach(function(e){var t=r.getNodeByPath(e);r.delete(t)}),r}},{key:"copyNodeByPath",value:function(e,t,n,r){var a=e.clone(),o=a.getNodeByPath(n),i=a.getNodeByPath(t);if(o){var s=i.clone();s.object.name=r,a.copyNode(s,o)}return a}},{key:"copyNodeListByPaths",value:function(e,t,n){var r=e.clone(),a=r.getNodeByPath(n);return a&&t.forEach(function(e){var t=r.getNodeByPath(e);r.copyNode(t,a)}),r}},{key:"buildTree",value:function(){var e=new l.default,t=new p.default({name:"/"}),n=new c.default({object:t,isLoaded:!1,isExpanded:!0});return e.setRoot(n),e}}]),e}(),h=new f;t.default=h},750:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(2),f=n(62),h=r(f),m={isTextMode:d.default.bool.isRequired,isEditIconShow:d.default.bool.isRequired,roles:d.default.array.isRequired,currentRole:d.default.string.isRequired,onRoleChanged:d.default.func.isRequired,toggleItemFreezed:d.default.func},g=function(e){function t(){var e,n,r,i;a(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=r=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),r.translateRole=function(e){return"Admin"===e?(0,p.gettext)("Admin"):"Member"===e?(0,p.gettext)("Member"):void 0},i=n,o(r,i)}return i(t,e),s(t,[{key:"render",value:function(){return u.default.createElement(h.default,{isTextMode:this.props.isTextMode,isEditIconShow:this.props.isEditIconShow,options:this.props.roles,currentOption:this.props.currentRole,onOptionChanged:this.props.onRoleChanged,translateOption:this.translateRole,toggleItemFreezed:this.props.toggleItemFreezed})}}]),t}(u.default.Component);g.propTypes=m,t.default=g},77:function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(34),s=function(e){return e&&e.__esModule?e:{default:e}}(i),l=function(){function e(){a(this,e),this.root=null}return o(e,[{key:"clone",value:function(){var t=new e;return this.root&&(t.root=this.root.clone()),t}},{key:"setRoot",value:function(e){this.root=e}},{key:"getNodeByPath",value:function(e){function t(t){return t.path===e&&(n=t,!0)}var n=null;return this.traverseDF(t),n}},{key:"getNodeChildrenObject",value:function(e){return e.children.map(function(e){return e.object})}},{key:"addNodeToParent",value:function(e,t){t.addChild(e)}},{key:"addNodeListToParent",value:function(e,t){e.forEach(function(e){t.addChild(e)})}},{key:"deleteNode",value:function(e){this.getNodeByPath(e.parentNode.path).deleteChild(e)}},{key:"deleteNodeList",value:function(e){var t=this;e.forEach(function(e){t.deleteNode(e)})}},{key:"renameNode",value:function(e,t){e.rename(t)}},{key:"updateNode",value:function(e,t,n){e.updateObjectParam(t,n)}},{key:"moveNode",value:function(e,t){this.deleteNode(e),t.addChild(e)}},{key:"copyNode",value:function(e,t){t.addChild(e)}},{key:"traverseDF",value:function(e){var t=[],n=!1;t.unshift(this.root);for(var a=t.shift();!n&&a;)(n=1==e(a))||(t.unshift.apply(t,r(a.children)),a=t.shift())}},{key:"traverseBF",value:function(e){var t=[],n=!1;t.push(this.root);for(var a=t.shift();!n&&a;)(n=!0===e(a))||(t.push.apply(t,r(a.children)),a=t.shift())}},{key:"expandNode",value:function(e){for(e.isExpanded=!0;e.parentNode;)e.parentNode.isExpanded=!0,e=e.parentNode}},{key:"collapseNode",value:function(e){e.isExpanded=!1}},{key:"isNodeChild",value:function(e,t){return t.children.some(function(t){return t.path===e.path})}},{key:"serializeToJson",value:function(){return this.root.serializeToJson()}},{key:"deserializefromJson",value:function(t){var n=s.default.deserializefromJson(t),r=new e;return r.setRoot(n),r}}]),e}();t.default=l},78:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(2),f=n(115),h=r(f),m=n(118),g=r(m),y=n(31),v=r(y),b=n(140),w=r(b),E={repoID:d.default.string,onSearchedClick:d.default.func.isRequired,searchPlaceholder:d.default.string},S=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.searchPlaceholder||(0,p.gettext)("Search Files");return u.default.createElement("div",{className:"common-toolbar"},p.isPro&&u.default.createElement(h.default,{repoID:this.props.repoID,placeholder:e,onSearchedClick:this.props.onSearchedClick}),u.default.createElement(g.default,null),u.default.createElement(v.default,null),p.showLogoutIcon&&u.default.createElement(w.default,null))}}]),t}(u.default.Component);S.propTypes=E,t.default=S},79:function(e,t){},8:function(e,t,n){"use strict";function r(){return o.default.createElement("span",{className:"loading-icon loading-tip"})}Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(a);t.default=r},83:function(e,t,n){"use strict";function r(e){var t=void 0,n=void 0,r=void 0,a=void 0,i=!1;try{t=(0,o.default)(),n=document.createRange(),r=document.getSelection(),a=document.createElement("a"),a.textContent=e,document.body.appendChild(a),n.selectNode(a),r.addRange(n);document.execCommand("copy");i=!0}catch(e){}finally{r&&("function"==typeof r.removeRange?r.removeRange(n):r.removeAllRanges()),a&&document.body.removeChild(a),t()}return i}Object.defineProperty(t,"__esModule",{value:!0});var a=n(203),o=function(e){return e&&e.__esModule?e:{default:e}}(a);t.default=r},84:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=n(3),o=function e(t){r(this,e),this.repo_id=t.repo_id,this.repo_name=t.repo_name,this.permission=t.permission,this.size=a.Utils.bytesToSize(t.size),this.file_count=t.file_count,this.owner_name=t.owner_name,this.owner_email=t.owner_email,this.owner_contact_email=t.owner_contact_email,this.is_admin=t.is_admin,this.is_virtual=t.is_virtual,this.no_quota=t.no_quota,this.has_been_shared_out=t.has_been_shared_out,this.encrypted=t.encrypted,this.lib_need_decrypt=t.lib_need_decrypt,this.last_modified=t.last_modified,this.status=t.status};t.default=o},844:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(2),h=n(4),m=n(3),g={repoID:d.default.string.isRequired,onRepoTagCreated:d.default.func,toggleCancel:d.default.func.isRequired,onClose:d.default.func.isRequired},y=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.inputNewName=function(e){n.setState({tagName:e.target.value}),n.state.errorMsg&&n.setState({errorMsg:""})},n.selectTagcolor=function(e){n.setState({tagColor:e.target.value})},n.createTag=function(){var e=n.state.tagName,t=n.state.tagColor,r=n.props.repoID;h.seafileAPI.createRepoTag(r,e,t).then(function(e){var t=e.data.repo_tag.repo_tag_id;n.props.onRepoTagCreated&&n.props.onRepoTagCreated(t),n.props.toggleCancel()}).catch(function(t){var r=void 0;500===t.response.status?r=(0,f.gettext)("Internal Server Error"):400===t.response.status&&(r=(0,f.gettext)('Tag "{name}" already exists.'),r=r.replace("{name}",m.Utils.HTMLescape(e))),n.setState({errorMsg:r})})},n.handleKeyPress=function(e){"Enter"===e.key&&n.createTag()},n.state={tagName:"",tagColor:"",newTag:{},errorMsg:"",colorList:["#FFA8A8","#FFA94D","#FFD43B","#A0EC50","#A9E34B","#63E6BE","#4FD2C9","#72C3FC","#91A7FF","#E599F7","#B197FC","#F783AC","#CED4DA"]},n.newInput=u.default.createRef(),n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){this.setState({tagColor:this.state.colorList[0]}),this.newInput.focus(),this.newInput.setSelectionRange(0,0)}},{key:"render",value:function(){var e=this,t=this.state.colorList,n=!!this.state.tagName.trim();return u.default.createElement(l.Fragment,null,u.default.createElement(p.ModalHeader,{toggle:this.props.onClose},u.default.createElement("span",{className:"tag-dialog-back fas fa-sm fa-arrow-left",onClick:this.props.toggleCancel,"aria-label":(0,f.gettext)("Back")}),(0,f.gettext)("New Tag")),u.default.createElement(p.ModalBody,null,u.default.createElement("div",{role:"form",className:"tag-create"},u.default.createElement("div",{className:"form-group"},u.default.createElement("label",{className:"form-label"},(0,f.gettext)("Name")),u.default.createElement(p.Input,{onKeyPress:this.handleKeyPress,innerRef:function(t){e.newInput=t},value:this.state.tagName,onChange:this.inputNewName}),u.default.createElement("div",{className:"mt-2"},u.default.createElement("span",{className:"error"},this.state.errorMsg))),u.default.createElement("div",{className:"form-group"},u.default.createElement("label",{className:"form-label"},(0,f.gettext)("Select a color")),u.default.createElement("div",{className:"row gutters-xs"},t.map(function(t,n){return u.default.createElement("div",{key:n,className:"col-auto",onChange:e.selectTagcolor},u.default.createElement("label",{className:"colorinput"},0===n?u.default.createElement("input",{name:"color",type:"radio",value:t,className:"colorinput-input",defaultChecked:!0,onClick:e.selectTagcolor}):u.default.createElement("input",{name:"color",type:"radio",value:t,className:"colorinput-input",onClick:e.selectTagcolor}),u.default.createElement("span",{className:"colorinput-color",style:{backgroundColor:t}})))}))))),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{color:"secondary",onClick:this.props.toggleCancel},(0,f.gettext)("Cancel")),n?u.default.createElement(p.Button,{color:"primary",onClick:this.createTag},(0,f.gettext)("Save")):u.default.createElement(p.Button,{color:"primary",disabled:!0},(0,f.gettext)("Save"))))}}]),t}(u.default.Component);y.propTypes=g,t.default=y},845:function(e,t){},846:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(83),h=r(f),m=n(2),g=n(5),y=r(g),v={link:d.default.string.isRequired,toggleDialog:d.default.func.isRequired},b=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.copyToClipboard=function(){(0,h.default)(n.props.link),n.props.toggleDialog(),y.default.success((0,m.gettext)("The link is copied to the clipboard."))},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=e.link,n=e.toggleDialog;return u.default.createElement(p.Modal,{isOpen:!0,toggle:n},u.default.createElement(p.ModalHeader,{toggle:n},(0,m.gettext)("Link")),u.default.createElement(p.ModalBody,null,u.default.createElement("a",{href:t},t)),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{color:"primary",onClick:this.copyToClipboard},(0,m.gettext)("Copy")),u.default.createElement(p.Button,{color:"secondary",onClick:n},(0,m.gettext)("Close"))))}}]),t}(u.default.Component);b.propTypes=v,t.default=b},847:function(e,t,n){"use strict";function r(){return o.default.createElement("thead",null,o.default.createElement("tr",null,o.default.createElement("th",{width:"12%"},o.default.createElement("span",{className:"sr-only"},(0,i.gettext)("Library Type"))),o.default.createElement("th",{width:"80%"}),o.default.createElement("th",{width:"8%"},o.default.createElement("span",{className:"sr-only"},(0,i.gettext)("Actions")))))}Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(a),i=n(2);t.default=r},848:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(7),f=r(p),h=n(3),m=n(2),g=n(4),y=n(5),v=r(y);n(381);var b={currentRepo:d.default.object.isRequired,closeDetails:d.default.func.isRequired},w=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getFileCounts=function(e){g.seafileAPI.getRepoInfo(e.repo_id).then(function(e){n.setState({fileCount:e.data.file_count})}).catch(function(e){var t=h.Utils.getErrorMsg(e);v.default.danger(t)})},n.state={fileCount:0},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this.props.currentRepo;this.getFileCounts(e)}},{key:"componentWillReceiveProps",value:function(e){e.currentRepo.repo_id!==this.props.currentRepo.repo_id&&this.getFileCounts(e.currentRepo)}},{key:"render",value:function(){var e=this.props.currentRepo,t=h.Utils.getLibIconUrl(e),n=h.Utils.getLibIconUrl(e,!0);return u.default.createElement("div",{className:"detail-container"},u.default.createElement("div",{className:"detail-header"},u.default.createElement("div",{className:"detail-control sf2-icon-x1",onClick:this.props.closeDetails}),u.default.createElement("div",{className:"detail-title dirent-title"},u.default.createElement("img",{src:t,width:"24",height:"24",alt:""}),"  ",u.default.createElement("span",{className:"name ellipsis",title:e.repo_name},e.repo_name))),u.default.createElement("div",{className:"detail-body dirent-info"},u.default.createElement("div",{className:"img"},u.default.createElement("img",{src:n,height:"96",alt:""})),u.default.createElement("div",{className:"dirent-table-container"},u.default.createElement("table",{className:"table-thead-hidden"},u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:"35%"}),u.default.createElement("th",{width:"65%"}))),u.default.createElement("tbody",null,u.default.createElement("tr",null,u.default.createElement("th",null,(0,m.gettext)("Files")),u.default.createElement("td",null,this.state.fileCount)),u.default.createElement("tr",null,u.default.createElement("th",null,(0,m.gettext)("Size")),u.default.createElement("td",null,e.size)),u.default.createElement("tr",null,u.default.createElement("th",null,(0,m.gettext)("Last Update")),u.default.createElement("td",null,(0,f.default)(e.last_modified).fromNow())))))))}}]),t}(u.default.Component);w.propTypes=b,t.default=w},88:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(89),f=r(p),h={currentRepoInfo:d.default.object,isShowFile:d.default.bool,repo:d.default.object,repoList:d.default.array,selectedRepo:d.default.object,initToShowChildren:d.default.bool.isRequired,selectedPath:d.default.string,onDirentItemClick:d.default.func.isRequired,onRepoItemClick:d.default.func.isRequired,fileSuffixes:d.default.array,selectedItemInfo:d.default.object},m=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.currentRepoInfo,r=t.repoList;return n&&(r=[],r.push(n)),u.default.createElement("ul",{className:"list-view-content file-chooser-item"},r.length>0&&r.map(function(t,n){return u.default.createElement(f.default,{key:n,repo:t,initToShowChildren:e.props.initToShowChildren,selectedRepo:e.props.selectedRepo,selectedPath:e.props.selectedPath,onRepoItemClick:e.props.onRepoItemClick,onDirentItemClick:e.props.onDirentItemClick,isShowFile:e.props.isShowFile,fileSuffixes:e.props.fileSuffixes,selectedItemInfo:e.props.selectedItemInfo})}))}}]),t}(u.default.Component);m.propTypes=h,t.default=m},89:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(90),f=r(p),h=n(34),m=r(h),g=n(43),y=r(g),v=n(4),b=n(75),w=r(b),E=n(3),S=n(5),C=r(S),D={isShowFile:d.default.bool,selectedPath:d.default.string,selectedRepo:d.default.object,repo:d.default.object.isRequired,initToShowChildren:d.default.bool.isRequired,onDirentItemClick:d.default.func.isRequired,onRepoItemClick:d.default.func.isRequired,fileSuffixes:d.default.array,selectedItemInfo:d.default.object},_=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.addResponseListToNode=function(e,t){t.isLoaded=!0,t.isExpanded=!0;var n=e.map(function(e){return new y.default(e)});n=E.Utils.sortDirents(n,"name","asc");var r=n.map(function(e){return new m.default({object:e})});t.addChildren(r)},n.onNodeExpanded=function(e){var t=n.props.repo.repo_id,r=n.state.treeData.clone();e=r.getNodeByPath(e.path),e.isLoaded?(r.expandNode(e),n.setState({treeData:r})):v.seafileAPI.listDir(t,e.path).then(function(t){var a=[];a=!0===n.props.isShowFile?t.data.dirent_list:t.data.dirent_list.filter(function(e){return"dir"===e.type}),n.addResponseListToNode(a,e),n.setState({treeData:r})}).catch(function(e){var t=E.Utils.getErrorMsg(e);C.default.danger(t)})},n.onNodeCollapse=function(e){var t=w.default.collapseNode(n.state.treeData,e);n.setState({treeData:t})},n.loadNodeAndParentsByPath=function(e,t){var r=n.state.treeData.clone();v.seafileAPI.listDir(e,t,{with_parents:!0}).then(function(e){var t=e.data.dirent_list;t=t.filter(function(e){return"dir"===e.type});for(var a={},o=0;o<t.length;o++){var i=t[o],s=i.parent_dir,l="/"===s?"/":s.slice(0,s.length-1);a[l]||(a[l]=[]),a[l].push(i)}for(var u in a){var c=r.getNodeByPath(u);c.isLoaded||n.addResponseListToNode(a[u],c)}n.setState({treeData:r})}).catch(function(e){var t=E.Utils.getErrorMsg(e);C.default.danger(t)})},n.onToggleClick=function(e){e.stopPropagation(),n.setState({isShowChildren:!n.state.isShowChildren})},n.onDirentItemClick=function(e,t){var r=n.props.repo;n.props.onDirentItemClick(r,e,t)},n.onRepoItemClick=function(e){n.isCurrentRepo()&&""===n.props.selectedPath?n.onToggleClick(e):n.props.onRepoItemClick(n.props.repo)},n.isCurrentRepo=function(){var e=n.props,t=e.selectedRepo,r=e.repo;return t&&r.repo_id===t.repo_id},n.state={isShowChildren:n.props.initToShowChildren,treeData:w.default.buildTree()},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.repo.repo_id;v.seafileAPI.listDir(t,"/").then(function(t){var n=e.state.treeData.clone(),r=[];r=!0===e.props.isShowFile?t.data.dirent_list:t.data.dirent_list.filter(function(e){return"dir"===e.type}),e.addResponseListToNode(r,n.root),e.setState({treeData:n})}).catch(function(e){var t=E.Utils.getErrorMsg(e);C.default.danger(t)}),this.props.selectedItemInfo.repoID===this.props.repo.repo_id&&(this.setState({isShowChildren:!0}),this.loadNodeAndParentsByPath(this.props.selectedItemInfo.repoID,this.props.selectedItemInfo.filePath))}},{key:"render",value:function(){var e=!1;return this.isCurrentRepo()&&!this.props.selectedPath&&(e=!0),u.default.createElement("li",null,u.default.createElement("div",{className:(e?"item-active":"")+" item-info",onClick:this.onRepoItemClick},u.default.createElement("div",{className:"item-text"},u.default.createElement("span",{className:"name user-select-none ellipsis"},this.props.repo.repo_name)),u.default.createElement("div",{className:"item-left-icon"},u.default.createElement("span",{className:"item-toggle icon fa "+(this.state.isShowChildren?"fa-caret-down":"fa-caret-right"),onClick:this.onToggleClick}),u.default.createElement("i",{className:"tree-node-icon"},u.default.createElement("span",{className:"icon far fa-folder tree-node-icon"})))),this.state.isShowChildren&&u.default.createElement(f.default,{repo:this.props.repo,onDirentItemClick:this.onDirentItemClick,selectedRepo:this.props.selectedRepo,selectedPath:this.props.selectedPath,fileSuffixes:this.props.fileSuffixes,treeData:this.state.treeData,onNodeCollapse:this.onNodeCollapse,onNodeExpanded:this.onNodeExpanded}))}}]),t}(u.default.Component);_.propTypes=D,t.default=_},90:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(91),f=r(p),h={selectedPath:d.default.string,selectedRepo:d.default.object,repo:d.default.object.isRequired,onDirentItemClick:d.default.func.isRequired,treeData:d.default.object.isRequired,onNodeCollapse:d.default.func.isRequired,onNodeExpanded:d.default.func.isRequired,fileSuffixes:d.default.array},m=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){return u.default.createElement("div",{className:"list-view-content",style:{marginLeft:"-1.5rem"}},u.default.createElement(f.default,{node:this.props.treeData.root,onNodeCollapse:this.props.onNodeCollapse,onNodeExpanded:this.props.onNodeExpanded,repo:this.props.repo,onDirentItemClick:this.props.onDirentItemClick,selectedRepo:this.props.selectedRepo,selectedPath:this.props.selectedPath,fileSuffixes:this.props.fileSuffixes}))}}]),t}(u.default.Component);m.propTypes=h,t.default=m},91:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p={selectedPath:d.default.string,selectedRepo:d.default.object,repo:d.default.object.isRequired,onDirentItemClick:d.default.func.isRequired,node:d.default.object.isRequired,onNodeCollapse:d.default.func.isRequired,onNodeExpanded:d.default.func.isRequired,filePath:d.default.string,fileSuffixes:d.default.array},f=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.onToggleClick=function(e){e.stopPropagation();var t=n.props.node;t.isExpanded?n.props.onNodeCollapse(t):n.props.onNodeExpanded(t)},n.onItemClick=function(e){e.stopPropagation();var t=!1;n.props.selectedRepo&&(t=n.props.selectedRepo.repo_id===n.props.repo.repo_id),t?n.props.selectedPath!==n.state.filePath?n.props.onDirentItemClick(n.state.filePath,n.props.node.object):"dir"===n.props.node.object.type&&n.onToggleClick(e):n.props.onDirentItemClick(n.state.filePath,n.props.node.object)},n.renderChildren=function(){var e=n.props.node;return e.hasChildren()?u.default.createElement("div",{className:"list-view-content"},e.children.map(function(e){return u.default.createElement(t,{key:e.path,node:e,onNodeCollapse:n.props.onNodeCollapse,onNodeExpanded:n.props.onNodeExpanded,repo:n.props.repo,onDirentItemClick:n.props.onDirentItemClick,selectedRepo:n.props.selectedRepo,selectedPath:n.props.selectedPath,fileSuffixes:n.props.fileSuffixes})})):""};var r=n.props.filePath?n.props.filePath+"/"+n.props.node.object.name:n.props.node.path;return n.state={filePath:r},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.node,t=!1;this.props.selectedRepo&&(t=this.props.selectedRepo.repo_id===this.props.repo.repo_id);var n=this.props.selectedPath===this.state.filePath,r=e.object.name;if(this.props.fileSuffixes&&r&&"file"===e.object.type)if(-1!==r.indexOf(".")){var a=r.slice(r.lastIndexOf(".")+1).toLowerCase();if(!this.props.fileSuffixes.includes(a))return null}else if("file"===e.object.type)return null;return u.default.createElement("div",{className:"file-chooser-item"},u.default.createElement("div",{className:"/"===e.path?"hide":""},u.default.createElement("div",{className:(t&&n?"item-active":"")+" item-info",onClick:this.onItemClick},u.default.createElement("div",{className:"item-text"},u.default.createElement("span",{className:"name user-select-none ellipsis"},e.object&&e.object.name)),u.default.createElement("div",{className:"item-left-icon"},"file"!==e.object.type&&u.default.createElement("span",{className:"icon item-toggle fa "+(e.isExpanded?"fa-caret-down":"fa-caret-right"),onClick:this.onToggleClick}),u.default.createElement("i",{className:"tree-node-icon"},u.default.createElement("span",{className:"icon far "+("dir"===e.object.type?"fa-folder":"fa-file")}))))),e.isExpanded&&this.renderChildren())}}]),t}(u.default.Component);f.propTypes=p,t.default=f},92:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(93),f=r(p),h={searchResults:d.default.array.isRequired,onItemClick:d.default.func.isRequired,onSearchedItemDoubleClick:d.default.func.isRequired},m=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onItemClick=function(e){n.setState({currentItem:e}),n.props.onItemClick(e)},n.state={currentItem:null},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this;return u.default.createElement("table",{className:"table-thead-hidden file-chooser-table",rules:"node",frame:"void"},u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:"8%"}),u.default.createElement("th",{width:"92%"}))),u.default.createElement("tbody",null,this.props.searchResults.map(function(t,n){return u.default.createElement(f.default,{key:n,item:t,currentItem:e.state.currentItem,onItemClick:e.onItemClick,onSearchedItemDoubleClick:e.props.onSearchedItemDoubleClick})})))}}]),t}(u.default.Component);m.propTypes=h,t.default=m},93:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(3),f={currentItem:d.default.object,onItemClick:d.default.func.isRequired,onSearchedItemDoubleClick:d.default.func.isRequired},h=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseEnter=function(){n.setState({highlight:!0})},n.onMouseLeave=function(){n.setState({highlight:!1})},n.onClick=function(){var e=n.props.item;n.props.onItemClick(e)},n.searchItemDoubleClick=function(e){var t=n.props.item;n.props.onSearchedItemDoubleClick(t)},n.state={highlight:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=e.item,n=e.currentItem,r=t.link_content?p.Utils.getFolderIconUrl(!1,192):p.Utils.getDefaultLibIconUrl(!1),a=t.is_dir?r:p.Utils.getFileIconUrl(t.name,192),o=this.state.highlight?"tr-highlight":"";return n&&t.repo_id===n.repo_id&&t.path===n.path&&(o="tr-active"),u.default.createElement("tr",{className:o,onClick:this.onClick,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onDoubleClick:this.searchItemDoubleClick},u.default.createElement("td",{className:"text-center"},u.default.createElement("img",{className:"item-img",src:a,alt:"",width:"24"})),u.default.createElement("td",null,u.default.createElement("span",{className:"item-link"},t.repo_name,"/",t.link_content)))}}]),t}(u.default.Component);h.propTypes=f,t.default=h},94:function(e,t){},949:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(2),h=n(4),m=n(3),g=n(68),y=r(g);n(381);var v={repoID:d.default.string.isRequired,filePath:d.default.string.isRequired,toggleCancel:d.default.func.isRequired,onRelatedFileChange:d.default.func.isRequired,dirent:d.default.object.isRequired,onClose:d.default.func},b=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleSubmit=function(){n.onAddRelatedFile()},n.onAddRelatedFile=function(){var e=n.state,t=e.repo,r=e.selectedPath,a=n.props.repoID,o=t.repo_id,i=n.props.filePath,s=r;if(a===o&&i===s){var l=(0,f.gettext)("Can not select self as a related file.");return void n.setState({errMessage:l})}h.seafileAPI.addRelatedFile(a,o,i,s).then(function(e){n.props.onRelatedFileChange(),n.toggle()}).catch(function(e){var t=m.Utils.getErrorMsg(e);n.setState({errMessage:t})})},n.toggle=function(){n.props.toggleCancel()},n.onDirentItemClick=function(e,t,r){"file"===r.type?n.setState({repo:e,selectedPath:t}):n.setState({repo:null,selectedPath:""})},n.onRepoItemClick=function(e){n.setState({repo:null,selectedPath:""})},n.state={repo:null,selectedPath:"",isShowFile:!0,errMessage:""},n}return i(t,e),s(t,[{key:"render",value:function(){var e=(0,f.gettext)("Select related file for {placeholder}");return e=e.replace("{placeholder}",'<span class="op-target">'+m.Utils.HTMLescape(this.props.dirent.name)+"</span>"),u.default.createElement("div",{className:"sf-add-related-file"},u.default.createElement(p.ModalHeader,{toggle:this.props.onClose},u.default.createElement("span",{className:"tag-dialog-back fas fa-sm fa-arrow-left",onClick:this.toggle,"aria-label":(0,f.gettext)("Back")}),(0,f.gettext)("Select File")),u.default.createElement(p.ModalBody,null,u.default.createElement("div",{className:"related-file-subtitle",dangerouslySetInnerHTML:{__html:e}}),u.default.createElement(y.default,{isShowFile:this.state.isShowFile,repoID:this.props.repoID,onDirentItemClick:this.onDirentItemClick,onRepoItemClick:this.onRepoItemClick,mode:"current_repo_and_other_repos"}),this.state.errMessage&&u.default.createElement(p.Alert,{color:"danger"},this.state.errMessage)),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{color:"secondary",onClick:this.toggle},(0,f.gettext)("Cancel")),this.state.selectedPath?u.default.createElement(p.Button,{color:"primary",onClick:this.handleSubmit},(0,f.gettext)("Submit")):u.default.createElement(p.Button,{color:"primary",disabled:!0},(0,f.gettext)("Submit"))))}}]),t}(u.default.Component);b.propTypes=v,t.default=b},950:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(6),f=n(43),h=r(f),m=n(2),g=n(4),y=n(3),v=n(5),b=r(v);n(951);var w={relatedFiles:d.default.array.isRequired,repoID:d.default.string.isRequired,filePath:d.default.string.isRequired,toggleCancel:d.default.func.isRequired,addRelatedFileToggle:d.default.func.isRequired,onRelatedFileChange:d.default.func.isRequired},E=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onDeleteRelatedFile=function(e){var t=n.props.filePath,r=n.props.repoID,a=e.related_id;g.seafileAPI.deleteRelatedFile(r,t,a).then(function(e){n.props.onRelatedFileChange()}).catch(function(e){var t=y.Utils.getErrorMsg(e);b.default.danger(t)})},n.toggle=function(){n.props.toggleCancel()},n.getDirentList=function(e){if(0===e.length)return void n.setState({direntList:[]});var t=[];e.map(function(e){g.seafileAPI.getFileInfo(e.repo_id,e.path).then(function(n){var r=new h.default(n.data);r.repo_name=e.repo_name,r.related_id=e.related_id,r.link=m.siteRoot+"lib/"+e.repo_id+"/file"+y.Utils.encodePath(e.path),t.push(r)})}),n.setState({direntList:t})},n.state={direntList:[]},n}return i(t,e),s(t,[{key:"componentWillMount",value:function(){this.getDirentList(this.props.relatedFiles)}},{key:"componentWillReceiveProps",value:function(e){e.relatedFiles.length!==this.props.relatedFiles.length&&this.getDirentList(e.relatedFiles)}},{key:"render",value:function(){var e=this;return u.default.createElement(l.Fragment,null,u.default.createElement(p.ModalHeader,{toggle:this.toggle},(0,m.gettext)("Related Files")),u.default.createElement(p.ModalBody,{className:this.state.direntList.length>0?"list-related-file-body":""},u.default.createElement(p.Table,{hover:!0,size:"sm",className:"list-related-file-table"},u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:"40%"},(0,m.gettext)("Name")),u.default.createElement("th",{width:"20%"},(0,m.gettext)("Library Name")),u.default.createElement("th",{width:"13%"},(0,m.gettext)("Size")),u.default.createElement("th",{width:"20%"},(0,m.gettext)("Last Update")),u.default.createElement("th",{width:"5%"}),u.default.createElement("th",{width:"2%"}))),u.default.createElement("tbody",null,this.state.direntList.map(function(t,n){return u.default.createElement(u.default.Fragment,{key:n},u.default.createElement(C,{relatedFile:t,onDeleteRelatedFile:e.onDeleteRelatedFile}))}))),u.default.createElement("a",{href:"#",className:"add-related-file-link",onClick:this.props.addRelatedFileToggle},(0,m.gettext)("Add File"))),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{color:"secondary",onClick:this.toggle},(0,m.gettext)("Close"))))}}]),t}(u.default.Component);E.propTypes=w;var S={relatedFile:d.default.object,onDeleteRelatedFile:d.default.func.isRequired},C=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseEnter=function(){n.setState({active:!0})},n.onMouseLeave=function(){n.setState({active:!1})},n.state={active:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.state.active?"action-icon sf2-icon-x3":"action-icon vh sf2-icon-x3",t=this.props.relatedFile;return u.default.createElement("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},u.default.createElement("td",null,u.default.createElement("a",{href:t.link,target:"_blank"},t.name)),u.default.createElement("td",null,t.repo_name),u.default.createElement("td",null,t.size),u.default.createElement("td",null,t.mtime_relative),u.default.createElement("td",null,u.default.createElement("i",{className:e,onClick:this.props.onDeleteRelatedFile.bind(this,t)})),u.default.createElement("td",null))}}]),t}(u.default.Component);C.propTypes=S,t.default=E},951:function(e,t){},98:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),u=r(l),c=n(1),d=r(c),p=n(7),f=r(p),h=n(263),m=r(h),g=n(264),y=r(g),v=n(138);n(139),n(153);var b={disabledDate:d.default.func.isRequired,value:d.default.object,onChange:d.default.func.isRequired},w=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.closeDialog=function(){n.setState({isOpen:!1})},n.openDialog=function(){n.setState({isOpen:!0})},n.clickOutsideToClose=function(e){n.inputRef.current.contains(e.target)||n.calendarContainerRef.current.contains(e.target)||n.closeDialog()},n.getCalendarContainer=function(){return n.calendarContainerRef.current},n.defaultCalendarValue=null,n.calendarContainerRef=u.default.createRef(),n.inputRef=u.default.createRef(),n.state={isOpen:!1},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=window.app.config.lang;this.defaultCalendarValue=(0,f.default)().locale(e).clone(),document.addEventListener("click",this.clickOutsideToClose)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.clickOutsideToClose)}},{key:"render",value:function(){var e=this,t=this.props,n=!0;void 0!=t.showHourAndMinute&&(n=t.showHourAndMinute);var r=n?"YYYY-MM-DD HH:mm":"YYYY-MM-DD",a=u.default.createElement(m.default,{defaultValue:this.defaultCalendarValue,disabledDate:t.disabledDate,format:r,locale:(0,v.translateCalendar)(),showHourAndMinute:n});return u.default.createElement(y.default,{disabled:t.disabled,getCalendarContainer:this.getCalendarContainer,calendar:a,value:t.value,open:this.state.isOpen,onChange:t.onChange},function(n){var a=n.value;return u.default.createElement("div",null,u.default.createElement("input",{placeholder:r,style:{width:t.inputWidth||250},tabIndex:"-1",disabled:t.disabled,readOnly:!0,value:a&&a.format(r)||"",className:"form-control",onClick:e.openDialog,ref:e.inputRef}),u.default.createElement("div",{ref:e.calendarContainerRef}))})}}]),t}(u.default.Component);w.propsTypes=b,t.default=w}},[2214]);