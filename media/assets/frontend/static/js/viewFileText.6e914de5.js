"use strict";(self.webpackChunkseahub_frontend=self.webpackChunkseahub_frontend||[]).push([[4263],{36971:function(t,n,e){var i=e(23029),a=e(92901),s=e(39874),r=e(85501),c=e(9950),o=e(17119),u=e(4086),p=e(40326),d=e(46842),f=e(49690),h=e(44513),v=e(97011),l=e(65604),S=(e(61610),e(44414)),g=window.app.pageOptions,P=g.err,A=g.fileExt,C=g.fileContent,m=g.repoID,x=g.filePath,k=g.fileName,y=g.canEditFile,w=g.username,j=function(t){function n(){return(0,i.A)(this,n),(0,s.A)(this,n,arguments)}return(0,r.A)(n,t),(0,a.A)(n,[{key:"render",value:function(){return P?(0,S.jsx)(h.A,{}):(0,S.jsx)("div",{className:"file-view-content flex-1 text-file-view",children:(0,S.jsx)(f.A,{fileExt:A,value:this.props.content,readOnly:!y,onChange:this.props.updateContent})})}}])}(c.Component),b=function(t){function n(t){var e;return(0,i.A)(this,n),(e=(0,s.A)(this,n,[t])).updateContent=function(t){e.setState({needSave:!0,content:t})},e.addParticipant=function(){v.e.addFileParticipants(m,x,[w]).then((function(t){200===t.status&&(e.isParticipant=!0,e.getParticipants())}))},e.getParticipants=function(){v.e.listFileParticipants(m,x).then((function(t){var n=t.data.participant_list;e.setState({participants:n}),n.length>0&&(e.isParticipant=n.every((function(t){return t.email==w})))}))},e.onParticipantsChange=function(){e.getParticipants()},e.state={content:C,needSave:!1,isSaving:!1,participants:[]},e.onSave=e.onSave.bind(e),e.isParticipant=!1,e}return(0,r.A)(n,t),(0,a.A)(n,[{key:"onSave",value:function(){var t=this;this.isParticipant||this.addParticipant();var n=l.Aq.getDirName(x);return v.e.getUpdateLink(m,n).then((function(n){var e=n.data;return t.setState({isSaving:!0}),v.e.updateFile(e,x,k,t.state.content).then((function(){u.A.success((0,p.AP)("Successfully saved"),{duration:2}),t.setState({isSaving:!1,needSave:!1})}))}))}},{key:"componentDidMount",value:function(){this.getParticipants()}},{key:"render",value:function(){return(0,S.jsx)(d.A,{content:(0,S.jsx)(j,{content:this.state.content,updateContent:this.updateContent}),isSaving:this.state.isSaving,needSave:this.state.needSave,onSave:this.onSave,participants:this.state.participants,onParticipantsChange:this.onParticipantsChange})}}])}(c.Component);o.render((0,S.jsx)(b,{}),document.getElementById("wrapper"))}},function(t){t.O(0,[4223],(function(){return n=36971,t(t.s=n);var n}));t.O()}]);