(this["webpackJsonpseahub-frontend"]=this["webpackJsonpseahub-frontend"]||[]).push([[36],{101:function(e,t,n){"use strict";function i(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return"function"===typeof e&&e.apply(void 0,n)}function o(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function a(){return Math.random().toString(36).substring(7)}n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return r})),n.d(t,"b",(function(){return s}));var r={},s=Boolean("undefined"!==typeof window&&window.document&&window.document.createElement)},156:function(e,t,n){"use strict";var i=n(3),o=n(67),a=n(101);t.a=new function e(){var t=this;Object(i.a)(this,e),this.handleShowEvent=function(e){for(var n in t.callbacks)Object(a.c)(t.callbacks,n)&&t.callbacks[n].show(e)},this.handleHideEvent=function(e){for(var n in t.callbacks)Object(a.c)(t.callbacks,n)&&t.callbacks[n].hide(e)},this.register=function(e,n){var i=Object(a.e)();return t.callbacks[i]={show:e,hide:n},i},this.unregister=function(e){e&&t.callbacks[e]&&delete t.callbacks[e]},this.callbacks={},a.b&&(window.addEventListener(o.b,this.handleShowEvent),window.addEventListener(o.a,this.handleHideEvent))}},163:function(e,t,n){"use strict";var i=n(3),o=n(5),a=n(7),r=n(6),s=n(2),c=n.n(s),d=n(156),l=n(67),p=n(101),h=n(4),u=n(0),f=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(e){var o;return Object(i.a)(this,n),(o=t.call(this,e)).registerHandlers=function(){document.addEventListener("mousedown",o.handleOutsideClick),document.addEventListener("touchstart",o.handleOutsideClick),document.addEventListener("scroll",o.handleHide),document.addEventListener("contextmenu",o.handleHide),document.addEventListener("keydown",o.handleKeyNavigation),window.addEventListener("resize",o.handleHide)},o.unregisterHandlers=function(){document.removeEventListener("mousedown",o.handleOutsideClick),document.removeEventListener("touchstart",o.handleOutsideClick),document.removeEventListener("scroll",o.handleHide),document.removeEventListener("contextmenu",o.handleHide),document.removeEventListener("keydown",o.handleKeyNavigation),window.removeEventListener("resize",o.handleHide)},o.handleShow=function(e){if(e.detail.id===o.props.id){var t=e.detail.position,n=t.x,i=t.y,a=e.detail,r=a.currentObject,s=a.menuList;o.setState({isVisible:!0,x:n,y:i,currentObject:r,menuList:s}),o.registerHandlers(),Object(p.a)(o.props.onShowMenu,e)}},o.handleHide=function(e){!o.state.isVisible||e.detail&&e.detail.id&&e.detail.id!==o.props.id||(o.unregisterHandlers(),o.setState({isVisible:!1}),Object(p.a)(o.props.onHideMenu,e))},o.handleOutsideClick=function(e){o.menu.contains(e.target)||Object(l.c)()},o.handleMouseLeave=function(e){e.preventDefault(),o.props.hideOnLeave&&Object(l.c)()},o.handleContextMenu=function(e){o.handleHide(e)},o.handleKeyNavigation=function(e){!1!==o.state.isVisible&&(e.preventDefault(),o.hideMenu(e))},o.hideMenu=function(e){27!==e.keyCode&&13!==e.keyCode||Object(l.c)()},o.getMenuPosition=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n={top:t,left:e};if(!o.menu)return n;var i=window,a=i.innerWidth,r=i.innerHeight,s=o.menu.getBoundingClientRect();return t+s.height>r&&(n.top-=s.height),e+s.width>a&&(n.left-=s.width),n.top<0&&(n.top=s.height<r?(r-s.height)/2:0),n.left<0&&(n.left=s.width<a?(a-s.width)/2:0),n},o.getRTLMenuPosition=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n={top:t,left:e};if(!o.menu)return n;var i=window,a=i.innerWidth,r=i.innerHeight,s=o.menu.getBoundingClientRect();return n.left=e-s.width,t+s.height>r&&(n.top-=s.height),n.left<0&&(n.left+=s.width),n.top<0&&(n.top=s.height<r?(r-s.height)/2:0),n.left+s.width>a&&(n.left=s.width<a?(a-s.width)/2:0),n},o.onMenuItemClick=function(e){e.stopPropagation();var t=h.a.getEventData(e,"operation"),n=o.state.currentObject;o.props.onMenuItemClick(t,n,e)},o.onContextMenu=function(e){e.stopPropagation()},o.state={x:0,y:0,isVisible:!1,currentObject:null,menuList:[]},o}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.listenId=d.a.register(this.handleShow,this.handleHide)}},{key:"componentDidUpdate",value:function(){var e=this;if(this.state.isVisible){var t=window.requestAnimationFrame||setTimeout;t((function(){var n=e.state,i=n.x,o=n.y,a=e.props.rtl?e.getRTLMenuPosition(i,o):e.getMenuPosition(i,o),r=a.top,s=a.left;t((function(){e.menu&&(e.menu.style.top="".concat(r,"px"),e.menu.style.left="".concat(s,"px"),e.menu.style.opacity=1,e.menu.style.pointerEvents="auto")}))}))}else{if(!this.menu)return;this.menu.style.opacity=0,this.menu.style.pointerEvents="none"}}},{key:"componentWillUnmount",value:function(){this.listenId&&d.a.unregister(this.listenId),this.unregisterHandlers()}},{key:"render",value:function(){var e=this;return Object(u.jsx)("div",{role:"menu",className:"seafile-contextmenu dropdown-menu",style:{position:"fixed",opacity:0,pointerEvents:"none",display:"block"},ref:function(t){e.menu=t},children:this.state.menuList.map((function(t,n){return"Divider"===t?Object(u.jsx)("div",{className:"seafile-divider dropdown-divider"},n):Object(u.jsx)("button",{className:"seafile-contextmenu-item dropdown-item","data-operation":t.key,onClick:e.onMenuItemClick,onContextMenu:e.onContextMenu,children:t.value},n)}))})}}]),n}(c.a.Component);t.a=f},1654:function(e,t,n){n(76),e.exports=n(1755)},1655:function(e,t,n){},1656:function(e,t,n){},1657:function(e,t,n){},1755:function(e,t,n){"use strict";n.r(t);var i=n(3),o=n(5),a=n(7),r=n(6),s=n(2),c=n.n(s),d=n(31),l=n.n(d),p=n(12),h=n.n(p),u=n(87),f=n.n(u),m=n(121),v=n(1),j=n(4),b=n(8),g=n(134),k=n(162),w=n(114),x=n(116),N=n(19),C=n(380),O=n(52),D=(n(1655),n(0)),M=function(){function e(t){var n=t.name,o=t.href,a=t.parentNode;Object(i.a)(this,e),this.name=n,this.href=o,this.parentNode=a||null,this.children=[]}return Object(o.a)(e,[{key:"setParent",value:function(e){this.parentNode=e}},{key:"addChildren",value:function(e){var t=this;e.forEach((function(e){e.setParent(t)})),this.children=e}}]),e}(),y=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(e){var o;return Object(i.a)(this,n),(o=t.call(this,e)).bindClickEvent=function(){o.links=document.querySelectorAll(".".concat("wiki-nav-content"," a")),o.links.forEach((function(e){e.addEventListener("click",o.onLinkClick)}))},o.removeClickEvent=function(){o.links.forEach((function(e){e.removeEventListener("click",o.onLinkClick)}))},o.onLinkClick=function(e){e.preventDefault();var t=e.target.getAttribute("data-path");if(t!==o.state.currentPath){t&&o.setState({currentPath:t});var n=o.getLink(e.target);n&&o.props.onLinkClick(n)}},o.getLink=function(e){var t=e.tagName;if(t&&"HTML"!==t)return"A"===t?e.href:o.getLink(e.parentNode)},o.changeInlineNode=function(e){var t;if("link"==e.type||"image"===e.type)if("image"==e.type&&v.Fb){if(t=e.data.src,!new RegExp(v.kc+"/lib/"+v.fc+"/file.*raw=1").test(t))return;var n=t.indexOf("/file"),i=t.indexOf("?"),o=t.substring(n+5,i);e.data.src=v.kc+"/view-image-via-public-wiki/?slug="+v.xc+"&path="+o}else if("link"==e.type){t=e.data.href;if(new RegExp(/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[\-;:&=\+\$,\w]+@)?[A-Za-z0-9\.\-]+|(?:www\.|[\-;:&=\+\$,\w]+@)[A-Za-z0-9\.\-]+)((?:\/[\+~%\/\.\w\-_]*)?\??(?:[\-\+=&;%@\.\w_]*)#?(?:[\.\!\/\\\w]*))?)/).test(t)){if(j.a.isInternalMarkdownLink(t,v.fc)){var a=j.a.getPathFromInternalMarkdownLink(t,v.fc);e.data.href=v.kc+"/published/"+v.xc+a}else if(j.a.isInternalDirLink(t,v.fc)){var r=j.a.getPathFromInternalDirLink(t,v.fc);e.data.href=v.kc+"/published/"+v.xc+r}}else e.data.href=v.kc+"/published/"+v.xc+"/"+t}return e},o.getRootNode=function(){var e=Object(O.j)(o.props.indexContent);j.a.changeMarkdownNodes(e,o.changeInlineNode).map((function(e){if("unordered_list"===e.type||"ordered_list"===e.type){var t=o.transSlateToTree(e.children,o.treeRoot);o.setNodePath(t,"/"),o.treeRoot=t}}))},o.setNodePath=function(e,t){var n=e.name,i="/"===t?t+n:t+"/"+n;e.path=i,e.children.length>0&&e.children.map((function(e){o.setNodePath(e,i)}))},o.transSlateToTree=function(e,t){var n=e.map((function(e){if(2!==e.children.length||"unordered_list"!==e.children[1].type&&"ordered_list"!==e.children[1].type)return e.children[0]&&"paragraph"===e.children[0].type?o.transParagraph(e.children[0]):new M({name:"",href:""});var t=e.children[0],n=o.transParagraph(t),i=e.children[1];return o.transSlateToTree(i.children,n)}));return t.addChildren(n),t},o.transParagraph=function(e){var t;if(e.children[1]&&"link"===e.children[1].type){var n=e.children[1],i=n.children[0],o=i?i.text:"";t=new M({name:o,href:n.data.href})}else if(e.children[0]){var a=e.children[0],r=a.text?a.text:"";t=new M({name:r,href:""})}else t=new M({name:"",href:""});return t},o.links=[],o.treeRoot=new M({name:"",href:""}),o.state={currentPath:""},o}return Object(o.a)(n,[{key:"componentWillMount",value:function(){this.getRootNode()}},{key:"componentDidMount",value:function(){this.bindClickEvent()}},{key:"componentWillReceiveProps",value:function(){this.removeClickEvent()}},{key:"componentDidUpdate",value:function(){this.bindClickEvent()}},{key:"componentWillUnmount",value:function(){this.removeClickEvent()}},{key:"render",value:function(){return Object(D.jsx)("div",{className:"mx-4 o-hidden",children:Object(D.jsx)(L,{node:this.treeRoot,bindClickEvent:this.bindClickEvent,currentPath:this.state.currentPath})})}}]),n}(c.a.Component),L=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(e){var o;return Object(i.a)(this,n),(o=t.call(this,e)).toggleExpanded=function(){o.setState({expanded:!o.state.expanded},(function(){o.state.expanded&&o.props.bindClickEvent()}))},o.renderLink=function(e){var t=e.href,n=e.name,i=e.path,a="wiki-nav-content ".concat(i===o.props.currentPath?"wiki-nav-content-highlight":"");return t&&n?Object(D.jsx)("div",{className:a,children:Object(D.jsx)("a",{href:t,"data-path":i,onClick:o.toggleExpanded,title:n,children:n})}):n?Object(D.jsx)("div",{className:"wiki-nav-content",children:Object(D.jsx)("span",{onClick:o.toggleExpanded,title:n,children:n})}):null},o.state={expanded:!1},o}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.props.node&&!this.props.node.parentNode&&this.setState({expanded:!0},(function(){e.props.bindClickEvent()}))}},{key:"render",value:function(){var e=this,t=this.props.node;return t.children.length>0?Object(D.jsxs)(c.a.Fragment,{children:[t.parentNode&&Object(D.jsxs)(c.a.Fragment,{children:[Object(D.jsx)("span",{className:"switch-btn",onClick:this.toggleExpanded,children:this.state.expanded?Object(D.jsx)("i",{className:"fa fa-caret-down"}):Object(D.jsx)("i",{className:"fa fa-caret-right"})}),this.renderLink(t)]}),this.state.expanded&&t.children.map((function(t,i){return Object(D.jsx)("div",{className:"pl-4 position-relative",children:Object(D.jsx)(n,{node:t,bindClickEvent:e.props.bindClickEvent,currentPath:e.props.currentPath})},i)}))]}):this.renderLink(t)}}]),n}(c.a.Component),S=y,E=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(e){var o;return Object(i.a)(this,n),(o=t.call(this,e)).renderIndexView=function(){return Object(D.jsx)(s.Fragment,{children:Object(D.jsxs)("div",{className:"wiki-pages-container",children:[Object(D.jsx)("div",{style:{marginTop:"2px"}}),Object(D.jsx)(S,{indexContent:o.props.indexContent,onLinkClick:o.props.onLinkClick})]})})},o.renderTreeView=function(){return Object(D.jsx)(s.Fragment,{children:Object(D.jsx)("div",{className:"wiki-pages-container",children:o.props.treeData&&Object(D.jsx)(C.a,{treeData:o.props.treeData,currentPath:o.props.currentPath,isNodeMenuShow:o.isNodeMenuShow,onNodeClick:o.props.onNodeClick,onNodeCollapse:o.props.onNodeCollapse,onNodeExpanded:o.props.onNodeExpanded})})})},o.isNodeMenuShow=!1,o}return Object(o.a)(n,[{key:"render",value:function(){return Object(D.jsxs)("div",{className:"side-panel wiki-side-panel ".concat(this.props.closeSideBar?"":"left-zero"),children:[Object(D.jsx)("div",{className:"side-panel-top panel-top",children:Object(D.jsx)(x.a,{onCloseSidePanel:this.props.onCloseSide})}),Object(D.jsxs)("div",{id:"side-nav",className:"wiki-side-nav",role:"navigation",children:[this.props.isTreeDataLoading&&Object(D.jsx)(N.a,{}),!this.props.isTreeDataLoading&&this.props.indexNode&&this.renderIndexView(),!this.props.isTreeDataLoading&&!this.props.indexNode&&this.renderTreeView(),v.Hc&&v.ec&&Object(D.jsx)("div",{className:"text-left p-2",children:Object(D.jsx)("a",{href:v.vc+"library/"+v.fc+"/"+v.xc+"/",className:"text-dark text-decoration-underline",children:Object(v.tb)("Go to Library")})})]})]})}}]),n}(s.Component),I=n(370),P=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(e){var o;return Object(i.a)(this,n),(o=t.call(this,e)).onMouseEnter=function(){o.setState({highlight:!0})},o.onMouseLeave=function(){o.setState({highlight:!1})},o.onContextMenu=function(e){e.preventDefault(),e.stopPropagation()},o.onDirentClick=function(e){e.preventDefault(),o.props.onDirentClick(o.props.dirent)},o.state={highlight:!1},o}return Object(o.a)(n,[{key:"render",value:function(){var e=this.props,t=e.path,n=e.dirent,i=v.vc+"published"+j.a.joinPath(t,n.name),o=j.a.getDirentIcon(n);return j.a.isDesktop()?Object(D.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onContextMenu:this.onContextMenu,children:[Object(D.jsx)("td",{className:"text-center",children:Object(D.jsx)("img",{src:o,width:"24",alt:""})}),Object(D.jsx)("td",{className:"name",children:Object(D.jsx)("a",{href:i,onClick:this.onDirentClick,children:n.name})}),Object(D.jsx)("td",{children:n.size}),Object(D.jsx)("td",{children:n.mtime_relative})]}):Object(D.jsxs)("tr",{children:[Object(D.jsx)("td",{className:"text-center",children:Object(D.jsx)("img",{src:o,width:"24",alt:""})}),Object(D.jsxs)("td",{children:[Object(D.jsx)("a",{href:i,onClick:this.onDirentClick,children:n.name}),Object(D.jsx)("br",{}),Object(D.jsx)("span",{className:"item-meta-info",children:n.size}),Object(D.jsx)("span",{className:"item-meta-info",children:n.mtime_relative})]})]})}}]),n}(c.a.Component),T=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){var e=this,t=j.a.isDesktop();return Object(D.jsxs)("table",{className:"table-hover ".concat(t?"":"table-thead-hidden"),children:[Object(D.jsx)("thead",{children:t?Object(D.jsxs)("tr",{children:[Object(D.jsx)("th",{style:{width:"4%"}}),Object(D.jsx)("th",{style:{width:"66%"},children:Object(v.tb)("Name")}),Object(D.jsx)("th",{style:{width:"15%"},children:Object(v.tb)("Size")}),Object(D.jsx)("th",{style:{width:"15%"},children:Object(v.tb)("Last Update")})]}):Object(D.jsxs)("tr",{children:[Object(D.jsx)("th",{width:"12%"}),Object(D.jsx)("th",{width:"88%"})]})}),Object(D.jsx)("tbody",{children:0!==this.props.direntList.length&&this.props.direntList.map((function(t,n){return Object(D.jsx)(P,{path:e.props.path,dirent:t,onDirentClick:e.props.onDirentClick},n)}))})]})}}]),n}(c.a.Component),F=T,B=n(386),z=n(434),R=n(99),W=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(){var e;Object(i.a)(this,n);for(var o=arguments.length,a=new Array(o),r=0;r<o;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))).onMenuClick=function(){e.props.onMenuClick()},e.onEditClick=function(t){t.preventDefault();var n=v.vc+"lib/"+v.fc+"/file"+e.props.path+"?mode=edit";window.open(n)},e.onMainNavBarClick=function(t){var n=j.a.getEventData(t,"path");e.props.onMainNavBarClick(n)},e.renderNavPath=function(){var t=e.props.path.split("/"),n="";return t.map((function(i,o){if(""!==i)return o===t.length-1?Object(D.jsxs)(s.Fragment,{children:[Object(D.jsx)("span",{className:"path-split",children:"/"}),Object(D.jsx)("span",{className:"path-file-name",children:i})]},o):(n+="/"+i,Object(D.jsxs)(s.Fragment,{children:[Object(D.jsx)("span",{className:"path-split",children:"/"}),Object(D.jsx)("a",{className:"path-link","data-path":n,onClick:e.onMainNavBarClick,children:i})]},o))}))},e}return Object(o.a)(n,[{key:"render",value:function(){var e=this.props,t=e.onSearchedClick,n=(e.permission,Object(v.tb)("Search files in this library")),i=Object(D.jsx)("div",{className:"message err-tip",children:Object(v.tb)("Folder does not exist.")}),o=this.props.pathExist&&!this.props.isDataLoading&&this.props.isViewFile;return Object(D.jsxs)("div",{className:"main-panel wiki-main-panel",children:[Object(D.jsx)("div",{className:"main-panel-hide hide",children:this.props.content}),Object(D.jsxs)("div",{className:"main-panel-north panel-top ".concat("rw"===this.props.permission?"border-left-show":""),children:[!v.Hc&&Object(D.jsxs)(s.Fragment,{children:[Object(D.jsx)("div",{className:"cur-view-toolbar",children:Object(D.jsx)("span",{className:"sf2-icon-menu hidden-md-up d-md-none side-nav-toggle",title:"Side Nav Menu",onClick:this.onMenuClick})}),Object(D.jsx)("div",{className:"common-toolbar",children:v.Eb&&Object(D.jsx)(B.a,{isPublic:!0,repoID:v.fc,onSearchedClick:t,placeholder:n})})]}),v.Hc&&Object(D.jsxs)(s.Fragment,{children:[Object(D.jsxs)("div",{className:"cur-view-toolbar",children:[Object(D.jsx)("span",{className:"sf2-icon-menu hidden-md-up d-md-none side-nav-toggle",title:"Side Nav Menu",onClick:this.onMenuClick}),"rw"==this.props.permission&&(j.a.isDesktop()?Object(D.jsx)("button",{className:"btn btn-secondary operation-item",title:Object(v.tb)("Edit"),onClick:this.onEditClick,children:Object(v.tb)("Edit")}):Object(D.jsx)("span",{className:"fa fa-pencil-alt mobile-toolbar-icon",title:Object(v.tb)("Edit"),onClick:this.onEditClick,style:{fontSize:"1.1rem"}}))]}),Object(D.jsxs)("div",{className:"common-toolbar",children:[v.Eb&&Object(D.jsx)(B.a,{isPublic:!0,repoID:v.fc,onSearchedClick:t,placeholder:n}),Object(D.jsx)(z.a,{}),Object(D.jsx)(R.a,{})]})]})]}),Object(D.jsx)("div",{className:"main-panel-center",children:Object(D.jsxs)("div",{className:"cur-view-content ".concat(o?"o-hidden":""),children:[!this.props.pathExist&&i,this.props.pathExist&&this.props.isDataLoading&&Object(D.jsx)(N.a,{}),o&&Object(D.jsx)(I.a,{markdownContent:this.props.content,isFileLoading:this.props.isDataLoading,lastModified:this.props.lastModified,latestContributor:this.props.latestContributor,onLinkClick:this.props.onLinkClick,isWiki:!0,path:this.props.path}),!this.props.isDataLoading&&!this.props.isViewFile&&Object(D.jsx)(F,{path:this.props.path,direntList:this.props.direntList,onDirentClick:this.props.onDirentClick})]})})]})}}]),n}(s.Component),H=W;n(219),n(1656),n(1657),n(152),n(170);h.a.locale(v.Hb);var A=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(e){var o;return Object(i.a)(this,n),(o=t.call(this,e)).loadSidePanel=function(e){v.vb?o.loadIndexNode():(e="None"===v.Bb?"/":e,o.loadNodeAndParentsByPath(e))},o.loadWikiData=function(e){if(o.pythonWrapper=document.getElementById("wiki-file-content"),"False"!==v.Bb)if(o.removePythonWrapper(),"True"!==v.Bb)if("None"!==v.Bb||"/home.md"!==e){if("None"===v.Bb){o.setState({pathExist:!1});var t=v.vc+"published/"+v.xc+j.a.encodePath(e);window.history.pushState({url:t,path:e},e,t)}}else o.showDir("/");else o.showDir(e);else o.setState({path:e})},o.loadIndexNode=function(){b.a.listWikiDir(v.xc,"/").then((function(e){var t=o.state.treeData;o.addFirstResponseListToNode(e.data.dirent_list,t.root);var n=t.getNodeByPath(o.indexPath);b.a.getWikiFileContent(v.xc,n.path).then((function(e){o.setState({treeData:t,indexNode:n,indexContent:e.data.content,isTreeDataLoading:!1})}))})).catch((function(){o.setState({isLoadFailed:!0})}))},o.showDir=function(e){o.removePythonWrapper(),o.loadDirentList(e);var t=v.vc+"published/"+v.xc+j.a.encodePath(e);window.history.pushState({url:t,path:e},e,t)},o.showFile=function(e){o.setState({isDataLoading:!0,isViewFile:!0,path:e}),o.removePythonWrapper(),b.a.getWikiFileContent(v.xc,e).then((function(e){var t=e.data;o.setState({isDataLoading:!1,content:t.content,permission:t.permission,lastModified:h.a.unix(t.last_modified).fromNow(),latestContributor:t.latest_contributor})}));var t=window.location.hash,n=v.vc+"published/"+v.xc+j.a.encodePath(e)+t;"/home.md"===e?window.history.replaceState({url:n,path:e},e,n):window.history.pushState({url:n,path:e},e,n)},o.loadDirentList=function(e){o.setState({isDataLoading:!0}),b.a.listWikiDir(v.xc,e).then((function(t){var n=t.data.dirent_list.map((function(e){return new g.a(e)}));"/"===e&&(n=n.filter((function(e){if("dir"===e.type){var t=e.name.toLowerCase();return"drafts"!==t&&"images"!==t&&"downloads"!==t}return!0}))),n=j.a.sortDirents(n,"name","asc"),o.setState({path:e,isViewFile:!1,direntList:n,isDataLoading:!1})})).catch((function(){o.setState({isLoadFailed:!0})}))},o.loadTreeNodeByPath=function(e){var t=o.state.treeData.clone(),n=t.getNodeByPath(e);n.isLoaded?(t.getNodeByPath(n.parentNode.path).isExpanded=!0,o.setState({treeData:t,currentNode:n})):b.a.listWikiDir(v.xc,n.path).then((function(e){o.addResponseListToNode(e.data.dirent_list,n),t.getNodeByPath(n.parentNode.path).isExpanded=!0,o.setState({treeData:t,currentNode:n})}))},o.loadNodeAndParentsByPath=function(e){var t=o.state.treeData.clone();j.a.isMarkdownFile(e)&&(e=j.a.getDirName(e)),b.a.listWikiDir(v.xc,e,!0).then((function(e){for(var n=e.data.dirent_list,i={},a=0;a<n.length;a++){var r=n[a],s=r.parent_dir;i[s]||(i[s]=[]),i[s].push(r)}for(var c in i){var d=t.getNodeByPath(c);d.isLoaded||"/"!==d.path?d.isLoaded||o.addResponseListToNode(i[c],d):o.addFirstResponseListToNode(i[c],d)}o.setState({isTreeDataLoading:!1,treeData:t})})).catch((function(){o.setState({isLoadFailed:!0})}))},o.removePythonWrapper=function(){o.pythonWrapper&&(document.body.removeChild(o.pythonWrapper),o.pythonWrapper=null)},o.onConentLinkClick=function(e){e.preventDefault(),e.stopPropagation();var t="";if("A"!==e.target.tagName){for(var n=e.target.parentNode;"A"!==n.tagName;)n=n.parentNode;t=n.href}else t=e.target.href;o.onLinkClick(t)},o.onLinkClick=function(e){var t=e;if(j.a.isWikiInternalMarkdownLink(t,v.xc)){var n=j.a.getPathFromWikiInternalMarkdownLink(t,v.xc);o.showFile(n)}else if(j.a.isWikiInternalDirLink(t,v.xc)){var i=j.a.getPathFromWikiInternalDirLink(t,v.xc);o.showDir(i)}else window.location.href=t;o.state.closeSideBar||o.setState({closeSideBar:!0})},o.onpopstate=function(e){if(e.state&&e.state.path){var t=e.state.path;j.a.isMarkdownFile(t)?o.showFile(t):(o.loadDirentList(t),o.setState({path:t,isViewFile:!1}))}},o.onSearchedClick=function(e){var t=e.is_dir?e.path.slice(0,e.path.length-1):e.path;if(o.state.currentPath!==t){for(var n=-1,i=j.a.getPaths(t),a=0;a<i.length;a++){var r=o.state.treeData.getNodeByPath(r);if(!r){n=a;break}}if(-1===n){var s=o.state.treeData.clone(),c=s.getNodeByPath(e.path);w.a.expandNode(c),o.setState({treeData:s})}else o.loadNodeAndParentsByPath(t);if(e.is_dir)o.showDir(t);else if(j.a.isMarkdownFile(t))o.showFile(t);else{var d=v.vc+"d/"+v.rc+"/files/?p="+j.a.encodePath(t);window.open("about:blank").location.href=d}}},o.onMenuClick=function(){o.setState({closeSideBar:!o.state.closeSideBar})},o.onMainNavBarClick=function(e){var t=o.state.treeData.clone(),n=t.getNodeByPath(e);t.expandNode(n),o.setState({treeData:t,currentNode:n}),o.showDir(n.path)},o.onDirentClick=function(e){var t=j.a.joinPath(o.state.path,e.name);if(e.isDir())o.loadTreeNodeByPath(t),o.showDir(t);else if(j.a.isMarkdownFile(t))o.showFile(t);else{var n=window.open("about:blank"),i=v.vc+"d/"+v.rc+"/files/?p="+j.a.encodePath(t);n.location.href=i}},o.onCloseSide=function(){o.setState({closeSideBar:!o.state.closeSideBar})},o.onNodeClick=function(e){if(o.state.pathExist||o.setState({pathExist:!0}),e.object.isDir()){if(!e.isLoaded){var t=o.state.treeData.clone();e=t.getNodeByPath(e.path),b.a.listWikiDir(v.xc,e.path).then((function(n){o.addResponseListToNode(n.data.dirent_list,e),t.collapseNode(e),o.setState({treeData:t})}))}if(e.path===o.state.path)if(e.isExpanded){var n=w.a.collapseNode(o.state.treeData,e);o.setState({treeData:n})}else{var i=o.state.treeData.clone();e=i.getNodeByPath(e.path),i.expandNode(e),o.setState({treeData:i})}}if(e.path!==o.state.path)if(e.object.isDir())o.showDir(e.path);else if(j.a.isMarkdownFile(e.path))e.path!==o.state.path&&o.showFile(e.path),o.onCloseSide();else{var a=window.open("about:blank"),r=v.vc+"d/"+v.rc+"/files/?p="+j.a.encodePath(e.path);a.location.href=r}},o.onNodeCollapse=function(e){var t=w.a.collapseNode(o.state.treeData,e);o.setState({treeData:t})},o.onNodeExpanded=function(e){var t=o.state.treeData.clone();(e=t.getNodeByPath(e.path)).isLoaded?(t.expandNode(e),o.setState({treeData:t})):b.a.listWikiDir(v.xc,e.path).then((function(n){o.addResponseListToNode(n.data.dirent_list,e),o.setState({treeData:t})}))},o.addFirstResponseListToNode=function(e,t){t.isLoaded=!0,t.isExpanded=!0;var n=e.map((function(e){return new g.a(e)}));n=n.filter((function(e){if("dir"===e.type){var t=e.name.toLowerCase();return"drafts"!==t&&"images"!==t&&"downloads"!==t}return!0}));var i=(n=j.a.sortDirents(n,"name","asc")).map((function(e){return new k.a({object:e})}));t.addChildren(i)},o.addResponseListToNode=function(e,t){t.isLoaded=!0,t.isExpanded=!0;var n=e.map((function(e){return new g.a(e)})),i=(n=j.a.sortDirents(n,"name","asc")).map((function(e){return new k.a({object:e})}));t.addChildren(i)},o.state={path:"",pathExist:!0,closeSideBar:!1,isViewFile:!0,isDataLoading:!1,direntList:[],content:"",permission:"",lastModified:"",latestContributor:"",isTreeDataLoading:!0,treeData:w.a.buildTree(),currentNode:null,indexNode:null,indexContent:""},window.onpopstate=o.onpopstate,o.indexPath="/index.md",o.homePath="/home.md",o.pythonWrapper=null,o}return Object(o.a)(n,[{key:"componentWillMount",value:function(){j.a.isDesktop()||this.setState({closeSideBar:!0})}},{key:"componentDidMount",value:function(){var e=this;this.loadSidePanel(v.yb),this.loadWikiData(v.yb),this.links=document.querySelectorAll("#wiki-file-content a"),this.links.forEach((function(t){return t.addEventListener("click",e.onConentLinkClick)}))}},{key:"componentWillUnmount",value:function(){var e=this;this.links.forEach((function(t){return t.removeEventListener("click",e.onConentLinkClick)}))}},{key:"render",value:function(){return Object(D.jsxs)("div",{id:"main",className:"wiki-main",children:[Object(D.jsx)(E,{isTreeDataLoading:this.state.isTreeDataLoading,closeSideBar:this.state.closeSideBar,currentPath:this.state.path,treeData:this.state.treeData,indexNode:this.state.indexNode,indexContent:this.state.indexContent,onCloseSide:this.onCloseSide,onNodeClick:this.onNodeClick,onNodeCollapse:this.onNodeCollapse,onNodeExpanded:this.onNodeExpanded,onLinkClick:this.onLinkClick}),Object(D.jsx)(H,{path:this.state.path,pathExist:this.state.pathExist,isViewFile:this.state.isViewFile,isDataLoading:this.state.isDataLoading,content:this.state.content,permission:this.state.permission,lastModified:this.state.lastModified,latestContributor:this.state.latestContributor,direntList:this.state.direntList,onLinkClick:this.onLinkClick,onMenuClick:this.onMenuClick,onSearchedClick:this.onSearchedClick,onMainNavBarClick:this.onMainNavBarClick,onDirentClick:this.onDirentClick}),Object(D.jsx)(f.a,{query:"(max-width: 767.8px)",children:Object(D.jsx)(m.a,{isOpen:!this.state.closeSideBar,toggle:this.onCloseSide,contentClassName:"d-none"})})]})}}]),n}(s.Component);l.a.render(Object(D.jsx)(A,{}),document.getElementById("wrapper"))},181:function(e,t,n){"use strict";var i=n(3),o=n(5),a=n(7),r=n(6),s=n(2),c=n.n(s),d=n(156),l=n(1001),p=n(313),h=n(312),u=n(189),f=n(310),m=n(1),v=n(4),j=n(0),b=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(e){var o;return Object(i.a)(this,n),(o=t.call(this,e)).onShowMenu=function(){},o.onHideMenu=function(){o.state.isItemMenuShow&&(o.setState({isItemMenuShow:!1}),"function"===typeof o.props.unfreezeItem&&o.props.unfreezeItem())},o.onDropdownToggleKeyDown=function(e){"Enter"!=e.key&&"Space"!=e.key||o.onDropdownToggleClick(e)},o.onDropdownToggleClick=function(e){e.preventDefault(),e.stopPropagation(),o.toggleOperationMenu()},o.toggleOperationMenu=function(){o.setState({isItemMenuShow:!o.state.isItemMenuShow},(function(){o.state.isItemMenuShow&&"function"===typeof o.props.freezeItem?o.props.freezeItem():o.state.isItemMenuShow||"function"!==typeof o.props.unfreezeItem||o.props.unfreezeItem()}))},o.onMenuItemKeyDown=function(e){"Enter"!=e.key&&"Space"!=e.key||o.onMenuItemClick(e)},o.onMenuItemClick=function(e){var t=v.a.getEventData(e,"toggle"),n=o.props.item;o.props.onMenuItemClick(t,e,n)},o.state={menuList:[],isItemMenuShow:!1},o}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.props.isHandleContextMenuEvent&&(this.listenerId=d.a.register(this.onShowMenu,this.onHideMenu));var e=this.props.item,t=this.props.getMenuList(e);this.setState({menuList:t})}},{key:"componentWillReceiveProps",value:function(e){var t=e.item;if(t.name!==this.props.item.name){var n=this.props.getMenuList(t);this.setState({menuList:n})}}},{key:"componentWillUnmount",value:function(){this.props.isHandleContextMenuEvent&&this.listenerId&&d.a.unregister(this.listenerId)}},{key:"render",value:function(){var e=this,t=this.state.menuList,n=this.props,i=n.toggleClass,o=n.tagName;return i="sf-dropdown-toggle "+i,t.length?o&&"button"===o?Object(j.jsxs)(l.a,{isOpen:this.state.isItemMenuShow,toggle:this.onDropdownToggleClick,children:[Object(j.jsx)(p.a,{className:i,"data-toggle":"dropdown",title:Object(m.tb)("More Operations"),"aria-label":Object(m.tb)("More Operations"),"aria-expanded":this.state.isItemMenuShow,onKeyDown:this.onDropdownToggleKeyDown}),Object(j.jsx)(h.a,{children:t.map((function(t,n){return"Divider"===t?Object(j.jsx)(u.a,{divider:!0},n):Object(j.jsx)(u.a,{"data-toggle":t.key,onClick:e.onMenuItemClick,onKeyDown:e.onMenuItemKeyDown,children:t.value},n)}))})]}):Object(j.jsxs)(f.a,{isOpen:this.state.isItemMenuShow,toggle:this.onDropdownToggleClick,className:"vam",children:[Object(j.jsx)(p.a,{tag:o||"i",role:"button",tabIndex:"0",className:i,title:Object(m.tb)("More Operations"),"data-toggle":"dropdown","aria-expanded":this.state.isItemMenuShow,"aria-label":Object(m.tb)("More Operations"),onKeyDown:this.onDropdownToggleKeyDown}),Object(j.jsx)(h.a,{children:t.map((function(t,n){return"Divider"===t?Object(j.jsx)(u.a,{divider:!0},n):Object(j.jsx)(u.a,{"data-toggle":t.key,onClick:e.onMenuItemClick,onKeyDown:e.onMenuItemKeyDown,children:t.value},n)}))})]}):""}}]),n}(c.a.Component);b.defaultProps={isHandleContextMenuEvent:!0,toggleClass:"sf2-icon-caret-down"},t.a=b},370:function(e,t,n){"use strict";var i=n(3),o=n(5),a=n(7),r=n(6),s=n(2),c=n.n(s),d=n(52),l=n(1),p=n(19),h=n(4),u=n(0),f="wiki-page-content",m=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(e){var o;return Object(i.a)(this,n),(o=t.call(this,e)).getTitlesInfo=function(){var e=[],t=document.querySelectorAll('h1[id^="user-content"]')[0];if(t){var n=t.getAttribute("id"),i=n&&n.replace("user-content-","");i=i?"".concat(i," - ").concat(l.xc):l.xc,h.a.updateTabTitle(i)}for(var a=document.querySelectorAll('h2[id^="user-content"], h3[id^="user-content"]'),r=0;r<a.length;r++)e.push(a[r].offsetTop);o.titlesInfo=e},o.onLinkClick=function(e){e.preventDefault(),e.stopPropagation();var t="";if("A"!==e.target.tagName){for(var n=e.target.parentNode;"A"!==n.tagName;)n=n.parentNode;t=n.href}else t=e.target.href;o.props.onLinkClick(t)},o.onScrollHandler=function(){var e,t=o.markdownContainer.current.scrollTop+180,n=o.titlesInfo.length;if(t<=o.titlesInfo[0])return e=0,void o.setState({activeTitleIndex:e});if(t>o.titlesInfo[n-1])return e=o.titlesInfo.length-1,void o.setState({activeTitleIndex:e});for(var i=0;i<n;i++)if(!(t>o.titlesInfo[i])){e=i-1;break}o.setState({activeTitleIndex:e})},o.changeInlineNode=function(e){var t,n;if("image"==e.type&&l.Fb){if(t=e.data.src,new RegExp(l.kc+"/lib/"+l.fc+"/file.*raw=1").test(t)){var i=t.indexOf("/file"),a=t.indexOf("?");n=t.substring(i+5,a)}else{if(!/^\.\.\/*/.test(t)&&!/^\.\/*/.test(t))return;var r=o.props.path,s=r.slice(0,r.lastIndexOf("/"))+"/"+t;n=h.a.pathNormalize(s)}e.data.src=l.kc+"/view-image-via-public-wiki/?slug="+l.xc+"&path="+n}else if("link"==e.type)if(t=e.data.href,h.a.isInternalFileLink(t,l.fc))if(h.a.isInternalMarkdownLink(t,l.fc)){var c=h.a.getPathFromInternalMarkdownLink(t,l.fc);e.data.href=l.kc+"/published/"+l.xc+c}else e.data.href=t.replace(/(.*)lib\/([-0-9a-f]{36})\/file(.*)/g,(function(e,t,n,i){return"".concat(t,"d/").concat(l.rc,"/files/?p=").concat(i,"&dl=1")}));else if(h.a.isInternalDirLink(t,l.fc)){var d=h.a.getPathFromInternalDirLink(t,l.fc);e.data.href=l.kc+"/published/"+l.xc+d}return e},o.modifyValueBeforeRender=function(e){return h.a.changeMarkdownNodes(e,o.changeInlineNode)},o.renderMarkdown=function(){var e=!0;return!1===o.props.isTOCShow&&(e=!1),o.props.isWiki?Object(u.jsx)(d.d,{showTOC:e,scriptSource:l.Rb+"js/mathjax/tex-svg.js",markdownContent:o.props.markdownContent,activeTitleIndex:o.state.activeTitleIndex,modifyValueBeforeRender:o.modifyValueBeforeRender}):Object(u.jsx)(d.d,{showTOC:e,scriptSource:l.Rb+"js/mathjax/tex-svg.js",markdownContent:o.props.markdownContent,activeTitleIndex:o.state.activeTitleIndex})},o.state={activeTitleIndex:0},o.markdownContainer=c.a.createRef(),o.links=[],o.titlesInfo=[],o}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.links=document.querySelectorAll(".".concat(f," a")),this.links.forEach((function(t){t.addEventListener("click",e.onLinkClick)})),this.getTitlesInfo()}},{key:"componentWillReceiveProps",value:function(e){var t=this;this.props.markdownContent!==e.markdownContent&&this.links.forEach((function(e){e.removeEventListener("click",t.onLinkClick)}))}},{key:"componentDidUpdate",value:function(){var e=this;this.links=document.querySelectorAll(".".concat(f," a")),this.links.forEach((function(t){t.addEventListener("click",e.onLinkClick)})),0===this.titlesInfo.length&&this.getTitlesInfo()}},{key:"componentWillUnmount",value:function(){var e=this;this.links.forEach((function(t){t.removeEventListener("click",e.onLinkClick)}))}},{key:"render",value:function(){if(this.props.isFileLoading)return Object(u.jsx)(p.a,{});var e="".concat(this.props.repoID?f+" w-100":f);return Object(u.jsx)("div",{ref:this.markdownContainer,className:"wiki-page-container",onScroll:this.onScrollHandler.bind(this),children:Object(u.jsxs)("div",{className:e,children:[this.props.children,this.renderMarkdown(),Object(u.jsxs)("p",{id:"wiki-page-last-modified",children:[Object(l.tb)("Last modified by")," ",this.props.latestContributor,", ",Object(u.jsx)("span",{children:this.props.lastModified})]})]})})}}]),n}(c.a.Component);d.d.defaultProps={isWiki:!1},t.a=m},380:function(e,t,n){"use strict";var i=n(3),o=n(5),a=n(7),r=n(6),s=n(2),c=n.n(s),d=n(45),l=n(1),p=n(181),h=n(4),u=n(0),f=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(e){var o;Object(i.a)(this,n),(o=t.call(this,e)).onMouseEnter=function(){o.props.isItemFreezed||o.setState({isShowOperationMenu:!0,isHighlight:!0})},o.onMouseOver=function(){o.props.isItemFreezed||o.setState({isShowOperationMenu:!0,isHighlight:!0})},o.onMouseLeave=function(){o.props.isItemFreezed||o.setState({isShowOperationMenu:!1,isHighlight:!1})},o.onNodeClick=function(){var e=o.props.node.object;if(e.isDir())o.props.onNodeClick(o.props.node);else{var t=h.a.getUserPermission(e.permission),n=t.isCustomPermission,i=t.customPermission;if(n){var a=i.permission,r=a.preview,s=a.modify;if(!r&&!s)return}o.props.onNodeClick(o.props.node)}},o.onLoadToggle=function(e){e.stopPropagation();var t=o.props.node;t.isExpanded?o.props.onNodeCollapse(t):o.props.onNodeExpanded(t)},o.onNodeDragStart=function(e){if(h.a.isIEBrower()||!o.canDrag)return!1;o.props.onNodeDragStart(e,o.props.node)},o.onNodeDragEnter=function(e){if(h.a.isIEBrower()||!o.canDrag)return!1;"dir"===o.props.node.object.type&&o.setState({isNodeDropShow:!0}),o.props.onNodeDragEnter(e,o.props.node)},o.onNodeDragMove=function(e){if(h.a.isIEBrower()||!o.canDrag)return!1;o.props.onNodeDragMove(e)},o.onNodeDragLeave=function(e){if(h.a.isIEBrower()||!o.canDrag)return!1;o.setState({isNodeDropShow:!1}),o.props.onNodeDragLeave(e,o.props.node)},o.onNodeDrop=function(e){if(h.a.isIEBrower()||!o.canDrag)return!1;e.stopPropagation(),o.setState({isNodeDropShow:!1}),o.props.onNodeDrop(e,o.props.node)},o.unfreezeItem=function(){o.setState({isShowOperationMenu:!1}),o.props.unfreezeItem()},o.onMenuItemClick=function(e,t,n){o.props.onMenuItemClick(e,n)},o.onItemMouseDown=function(e){e.stopPropagation(),e.button},o.onItemContextMenu=function(e){o.handleContextClick(e)},o.handleContextClick=function(e){o.props.handleContextClick(e,o.props.node),o.setState({isShowOperationMenu:!1})},o.getNodeTypeAndIcon=function(){var e=o.props.node,t="",n="";if("dir"===e.object.type)t=Object(u.jsx)("i",{className:"far fa-folder"}),n="dir";else{var i=e.object.name.lastIndexOf(".");if(-1===i)t=Object(u.jsx)("i",{className:"far fa-file"}),n="file";else{var a=e.object.name.slice(i).toLowerCase();".png"===a||".jpg"===a||".jpeg"===a||".gif"===a||".bmp"===a?(t=Object(u.jsx)("i",{className:"far fa-image"}),n="image"):".md"===a||".markdown"===a?(t=Object(u.jsx)("i",{className:"far fa-file-alt"}),n="file"):(t=Object(u.jsx)("i",{className:"far fa-file"}),n="file")}}return{icon:t,type:n}},o.calculateMenuList=function(e){var t=d.a.NEW_FOLDER,n=d.a.NEW_FILE,i=d.a.COPY,a=d.a.MOVE,r=d.a.RENAME,s=d.a.DELETE,c=d.a.OPEN_VIA_CLIENT,l=[r,s,i,a,c];"dir"===e.object.type&&(l=[t,n,i,a,r,s]);var p=o.props.userPerm,u=h.a.getUserPermission(p),f=u.isCustomPermission,m=u.customPermission;if(!f)return l;l=[];var v=m.permission,j=v.create,b=v.modify,g=v.delete,k=v.copy;return"dir"===e.object.type&&j&&l.push(t,n),k&&l.push(i),b&&l.push(a,r),g&&l.push(s),"dir"!==e.object.type&&l.push(c),l},o.renderChildren=function(){var e=o.props,t=e.node,i=e.paddingLeft;return t.hasChildren()?Object(u.jsx)("div",{className:"children",style:{paddingLeft:i},children:t.children.map((function(e){return Object(u.jsx)(n,{node:e,paddingLeft:i,userPerm:o.props.userPerm,currentPath:o.props.currentPath,isNodeMenuShow:o.props.isNodeMenuShow,isItemFreezed:o.props.isItemFreezed,onNodeClick:o.props.onNodeClick,onNodeCollapse:o.props.onNodeCollapse,onNodeExpanded:o.props.onNodeExpanded,freezeItem:o.props.freezeItem,onMenuItemClick:o.props.onMenuItemClick,unfreezeItem:o.unfreezeItem,onNodeDragStart:o.props.onNodeDragStart,onNodeDragMove:o.props.onNodeDragMove,onNodeDrop:o.props.onNodeDrop,onNodeDragEnter:o.props.onNodeDragEnter,onNodeDragLeave:o.props.onNodeDragLeave,handleContextClick:o.props.handleContextClick},e.path)}))}):""},o.state={isHighlight:!1,isShowOperationMenu:!1,isNodeDropShow:!1};var a=e.userPerm;o.canDrag="rw"===a;var r=h.a.getUserPermission(a),s=r.isCustomPermission,c=r.customPermission;if(s){var l=c.permission.modify;o.canDrag=l}return o}return Object(o.a)(n,[{key:"componentWillReceiveProps",value:function(e){e.isItemFreezed||this.setState({isShowOperationMenu:!1,isHighlight:!1})}},{key:"render",value:function(){var e=this.props,t=e.currentPath,n=e.node,i=e.isNodeMenuShow,o=e.userPerm,a=this.getNodeTypeAndIcon(),r=a.type,s=a.icon,c=this.state.isHighlight?"tree-node-inner-hover ":"";n.path===t&&(c="tree-node-hight-light");var d=h.a.getUserPermission(o).isCustomPermission;return Object(u.jsxs)("div",{className:"tree-node",children:[Object(u.jsxs)("div",{type:r,className:"tree-node-inner text-nowrap ".concat(c," ").concat("/"===n.path?"hide":""," ").concat(this.state.isNodeDropShow?"tree-node-drop":""),title:n.object.name,onMouseEnter:this.onMouseEnter,onMouseOver:this.onMouseOver,onMouseLeave:this.onMouseLeave,onMouseDown:this.onItemMouseDown,onContextMenu:this.onItemContextMenu,onClick:this.onNodeClick,children:[Object(u.jsx)("div",{className:"tree-node-text",draggable:this.canDrag,onDragStart:this.onNodeDragStart,onDragEnter:this.onNodeDragEnter,onDragLeave:this.onNodeDragLeave,onDragOver:this.onNodeDragMove,onDrop:this.onNodeDrop,children:n.object.name}),Object(u.jsxs)("div",{className:"left-icon",children:["dir"===r&&(!n.isLoaded||n.isLoaded&&n.hasChildren())&&Object(u.jsx)("i",{className:"folder-toggle-icon fa ".concat(n.isExpanded?"fa-caret-down":"fa-caret-right"),onMouseDown:function(e){return e.stopPropagation()},onClick:this.onLoadToggle}),Object(u.jsx)("i",{className:"tree-node-icon",children:s})]}),i&&Object(u.jsx)("div",{className:"right-icon",children:("rw"===o||l.ec||d)&&this.state.isShowOperationMenu&&Object(u.jsx)(p.a,{item:this.props.node,toggleClass:"fas fa-ellipsis-v",getMenuList:this.calculateMenuList,onMenuItemClick:this.onMenuItemClick,freezeItem:this.props.freezeItem,unfreezeItem:this.unfreezeItem})})]}),n.isExpanded&&this.renderChildren()]})}}]),n}(c.a.Component),m=n(163),v=n(67),j=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(e){var o;Object(i.a)(this,n),(o=t.call(this,e)).onItemMove=function(e,t,n,i){o.props.onItemMove(e,t,n,i)},o.onNodeDragStart=function(e,t){if(h.a.isIEBrower())return!1;var n={nodeDirent:t.object,nodeParentPath:t.parentNode.path,nodeRootPath:t.path};n=JSON.stringify(n),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("applicaiton/drag-item-info",n)},o.onNodeDragEnter=function(e,t){if(h.a.isIEBrower()||!o.canDrop)return!1;e.persist(),"tree-view tree "===e.target.className&&o.setState({isTreeViewDropTipShow:!0})},o.onNodeDragMove=function(e){if(h.a.isIEBrower()||!o.canDrop)return!1;e.preventDefault(),e.dataTransfer.dropEffect="move"},o.onNodeDragLeave=function(e,t){if(h.a.isIEBrower()||!o.canDrop)return!1;"tree-view tree tree-view-drop"===e.target.className&&o.setState({isTreeViewDropTipShow:!1})},o.onContainerClick=function(e){Object(v.c)()},o.onNodeClick=function(e){Object(v.c)(),o.props.onNodeClick(e)},o.onNodeDrop=function(e,t){if(h.a.isIEBrower()||!o.canDrop)return!1;if(!e.dataTransfer.files.length){var n=e.dataTransfer.getData("applicaiton/drag-item-info"),i=n=JSON.parse(n),a=i.nodeDirent,r=i.nodeParentPath,s=i.nodeRootPath,c=t;if(Array.isArray(n))return c?void o.onMoveItems(n,c,o.props.currentRepoInfo,c.path):("/"===n[0].nodeParentPath||o.props.onItemsMove(o.props.currentRepoInfo,"/"),void o.setState({isTreeViewDropTipShow:!1}));if(!c)return"/"===r||o.onItemMove(o.props.currentRepoInfo,a,"/",r),void o.setState({isTreeViewDropTipShow:!1});if("dir"===c.object.type&&r!==c.path&&(r!==c.parentNode.path||c.object.name!==a.name)){if("dir"===c.object.type&&"dir"===a.type)if(c.parentNode.path!==r)if(h.a.getPaths(c.path).includes(s))return;o.onItemMove(o.props.currentRepoInfo,a,c.path,r)}}},o.onMoveItems=function(e,t,n,i){var a=[],r=h.a.getPaths(i);(e.forEach((function(e){var t=e.nodeRootPath;a.push(t)})),"dir"===t.object.type)&&(a.some((function(e){return e===i}))||e[0].nodeParentPath&&e[0].nodeParentPath===t.path||a.some((function(e){return r.includes(e)}))||o.props.onItemsMove(n,i))},o.freezeItem=function(){o.setState({isItemFreezed:!0})},o.unfreezeItem=function(){o.setState({isItemFreezed:!1})},o.onMenuItemClick=function(e,t){o.props.onMenuItemClick(e,t),Object(v.c)()},o.onMouseDown=function(e){e.stopPropagation(),e.button},o.onContextMenu=function(e){e.preventDefault();var t=o.props.currentRepoInfo;if("admin"!==t.permission&&"rw"!==t.permission)return"";o.handleContextClick(e)},o.handleContextClick=function(e,t){if(e.preventDefault(),e.stopPropagation(),o.props.isNodeMenuShow){var n=e.clientX||e.touches&&e.touches[0].pageX,i=e.clientY||e.touches&&e.touches[0].pageY;o.props.posX&&(n-=o.props.posX),o.props.posY&&(i-=o.props.posY),Object(v.c)();var a=o.getMenuList(t),r={id:"tree-node-contextmenu",position:{x:n,y:i},target:e.target,currentObject:t,menuList:a};Object(v.d)(r)}},o.getMenuList=function(e){var t=[],n=d.a.NEW_FOLDER,i=d.a.NEW_FILE,a=d.a.COPY,r=d.a.MOVE,s=d.a.RENAME,c=d.a.DELETE,l=d.a.OPEN_VIA_CLIENT;if(!e)return[n,i];t="dir"===e.object.type?[n,i,a,r,s,c]:[s,c,a,r,l];var p=o.props.userPerm,u=h.a.getUserPermission(p),f=u.isCustomPermission,m=u.customPermission;if(!f)return t;t=[];var v=m.permission,j=v.create,b=v.modify,g=v.delete,k=v.copy;return e?("dir"===e.object.type&&j&&t.push(n,i),k&&t.push(a),b&&t.push(r,s),g&&t.push(c),"dir"!==e.object.type&&t.push(l),t):(j&&t.push(n,i),t)},o.onShowMenu=function(){o.freezeItem()},o.onHideMenu=function(){o.unfreezeItem()},o.state={isItemFreezed:!1,isTreeViewDropTipShow:!1};var a=e.userPerm;o.canDrop="rw"===a;var r=h.a.getUserPermission(a),s=r.isCustomPermission,c=r.customPermission;if(s){var l=c.permission.modify;o.canDrop=l}return o}return Object(o.a)(n,[{key:"render",value:function(){return Object(u.jsxs)("div",{className:"tree-view tree ".concat(this.state.isTreeViewDropTipShow&&this.canDrop?"tree-view-drop":""),onDrop:this.onNodeDrop,onDragEnter:this.onNodeDragEnter,onDragLeave:this.onNodeDragLeave,onMouseDown:this.onMouseDown,onContextMenu:this.onContextMenu,onClick:this.onContainerClick,children:[Object(u.jsx)(f,{userPerm:this.props.userPerm,node:this.props.treeData.root,currentPath:this.props.currentPath,paddingLeft:20,isNodeMenuShow:this.props.isNodeMenuShow,isItemFreezed:this.state.isItemFreezed,onNodeClick:this.onNodeClick,onMenuItemClick:this.props.onMenuItemClick,onNodeExpanded:this.props.onNodeExpanded,onNodeCollapse:this.props.onNodeCollapse,onNodeDragStart:this.onNodeDragStart,freezeItem:this.freezeItem,unfreezeItem:this.unfreezeItem,onNodeDragMove:this.onNodeDragMove,onNodeDrop:this.onNodeDrop,onNodeDragEnter:this.onNodeDragEnter,onNodeDragLeave:this.onNodeDragLeave,handleContextClick:this.handleContextClick}),Object(u.jsx)(m.a,{id:"tree-node-contextmenu",onMenuItemClick:this.onMenuItemClick,onHideMenu:this.onHideMenu,onShowMenu:this.onShowMenu})]})}}]),n}(c.a.Component);t.a=j},67:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return l}));var i=n(115),o=n.n(i),a=n(101),r="REACT_CONTEXTMENU_SHOW",s="REACT_CONTEXTMENU_HIDE";function c(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;"function"===typeof window.CustomEvent?n=new window.CustomEvent(e,{detail:t}):(n=document.createEvent("CustomEvent")).initCustomEvent(e,!1,!0,t),i&&(i.dispatchEvent(n),o()(a.d,t))}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;c(r,o()({},e,{type:r}),t)}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;c(s,o()({},e,{type:s}),t)}}},[[1654,1,0]]]);
//# sourceMappingURL=wiki.chunk.js.map