"use strict";(self.webpackChunkseahub_frontend=self.webpackChunkseahub_frontend||[]).push([[7866],{88002:function(e,t,i){i.d(t,{A:function(){return m}});var n=i(23029),a=i(92901),o=i(39874),s=i(85501),r=i(9950),l=i(58195),c=i(14113),d=i(99308),u=i(40326),h=i(44414),p=function(e){function t(){return(0,n.A)(this,t),(0,o.A)(this,t,arguments)}return(0,s.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.type,i=e.asyncOperationProgress,n=e.asyncOperatedFilesLength,a="move"===t?(0,u.AP)("Move {num} items"):(0,u.AP)("Copy {num} items");a=a.replace("{num}",n);var o={width:i+"%",lineHeight:"40px",textAlign:"left"};return(0,h.jsxs)(l.A,{isOpen:!0,toggle:this.props.toggleDialog,className:"copy-move-dirent-progress-dialog",children:[(0,h.jsx)(c.A,{toggle:this.props.toggleDialog,children:a}),(0,h.jsx)(d.A,{children:(0,h.jsx)("div",{className:"progress",children:(0,h.jsx)("div",{className:"progress-bar pl-2",role:"progressbar",style:o,"aria-valuenow":i,"aria-valuemin":"0","aria-valuemax":"100",children:i+"%"})})})]})}}])}(r.Component),m=p},60472:function(e,t,i){i.d(t,{A:function(){return U}});var n=i(23029),a=i(92901),o=i(39874),s=i(85501),r=i(9950),l=i(40326),c=i(11942),d=i.n(c),u=i(34806),h=i.n(u);function p(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function m(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?p(Object(i),!0).forEach((function(t){g(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):p(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function f(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,P(n.key),n)}}function g(e,t,i){return(t=P(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function v(){return v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},v.apply(this,arguments)}function b(e){return b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},b(e)}function x(e,t){return x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},x(e,t)}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function S(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=b(e);if(t){var a=b(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return y(e)}(this,i)}}function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var n,a,o,s,r=[],l=!0,c=!1;try{if(o=(i=i.call(e)).next,0===t){if(Object(i)!==i)return;l=!1}else for(;!(l=(n=o.call(i)).done)&&(r.push(n.value),r.length!==t);l=!0);}catch(d){c=!0,a=d}finally{try{if(!l&&null!=i.return&&(s=i.return(),Object(s)!==s))return}finally{if(c)throw a}}return r}}(e,t)||w(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e){return function(e){if(Array.isArray(e))return j(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||w(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){if(e){if("string"===typeof e)return j(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?j(e,t):void 0}}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function P(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}function C(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e)return"";var i=e;return t&&Object.keys(t).forEach((function(e){i=i.replace(e,t[e])})),i}function I(){return"undefined"!==typeof i.g.window?i.g.window.innerWidth:0}function _(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.g.window.self,t=e.document.referrer;if(e===i.g.window.top||!t)return e;var n=function(e){return e.match(/(.*\/\/.*?)(\/|$)/)[1]};return n(e.location.href)===n(t)?_(e.parent):e}var D=300,M=27,F=37,N=39,L=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&x(e,t)}(s,e);var t,n,a,o=S(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),g(y(t=o.call(this,e)),"handleWheel",(function(e){e.preventDefault()})),t.state={isClosing:!e.animationDisabled,shouldAnimate:!1,zoomLevel:0,offsetX:0,offsetY:0,loadErrorStatus:{},rotateDeg:0},t.outerEl=r.createRef(),t.zoomInBtn=r.createRef(),t.zoomOutBtn=r.createRef(),t.caption=r.createRef(),t.closeIfClickInner=t.closeIfClickInner.bind(y(t)),t.handleImageDoubleClick=t.handleImageDoubleClick.bind(y(t)),t.handleImageClick=t.handleImageClick.bind(y(t)),t.handleImageMouseWheel=t.handleImageMouseWheel.bind(y(t)),t.handleKeyInput=t.handleKeyInput.bind(y(t)),t.handleMouseUp=t.handleMouseUp.bind(y(t)),t.handleMouseDown=t.handleMouseDown.bind(y(t)),t.handleMouseMove=t.handleMouseMove.bind(y(t)),t.handleOuterMousewheel=t.handleOuterMousewheel.bind(y(t)),t.handleTouchStart=t.handleTouchStart.bind(y(t)),t.handleTouchMove=t.handleTouchMove.bind(y(t)),t.handleTouchEnd=t.handleTouchEnd.bind(y(t)),t.handlePointerEvent=t.handlePointerEvent.bind(y(t)),t.handleCaptionMousewheel=t.handleCaptionMousewheel.bind(y(t)),t.handleWindowResize=t.handleWindowResize.bind(y(t)),t.handleZoomInButtonClick=t.handleZoomInButtonClick.bind(y(t)),t.handleZoomOutButtonClick=t.handleZoomOutButtonClick.bind(y(t)),t.requestClose=t.requestClose.bind(y(t)),t.requestMoveNext=t.requestMoveNext.bind(y(t)),t.requestMovePrev=t.requestMovePrev.bind(y(t)),t.rotateImage=t.rotateImage.bind(y(t)),t}return t=s,n=[{key:"UNSAFE_componentWillMount",value:function(){this.timeouts=[],this.currentAction=0,this.eventsSource=0,this.pointerList=[],this.preventInnerClose=!1,this.preventInnerCloseTimeout=null,this.keyPressed=!1,this.imageCache={},this.lastKeyDownTime=0,this.resizeTimeout=null,this.wheelActionTimeout=null,this.resetScrollTimeout=null,this.scrollX=0,this.scrollY=0,this.moveStartX=0,this.moveStartY=0,this.moveStartOffsetX=0,this.moveStartOffsetY=0,this.swipeStartX=0,this.swipeStartY=0,this.swipeEndX=0,this.swipeEndY=0,this.pinchTouchList=null,this.pinchDistance=0,this.keyCounter=0,this.moveRequested=!1,this.props.animationDisabled||this.setState({isClosing:!1})}},{key:"componentDidMount",value:function(){var e=this;this.windowContext=_(),this.listeners={resize:this.handleWindowResize,mouseup:this.handleMouseUp,touchend:this.handleTouchEnd,touchcancel:this.handleTouchEnd,pointerdown:this.handlePointerEvent,pointermove:this.handlePointerEvent,pointerup:this.handlePointerEvent,pointercancel:this.handlePointerEvent},Object.keys(this.listeners).forEach((function(t){e.windowContext.addEventListener(t,e.listeners[t])})),document.addEventListener("wheel",this.handleWheel,{passive:!1}),this.loadAllImages()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this,i=!1,n={},a={};this.getSrcTypes().forEach((function(o){t.props[o.name]!==e[o.name]&&(i=!0,n[t.props[o.name]]=!0,a[e[o.name]]=!0)})),(i||this.moveRequested)&&(Object.keys(n).forEach((function(e){!(e in a)&&e in t.imageCache&&(t.imageCache[e].loaded=!1)})),this.moveRequested=!1,this.loadAllImages(e))}},{key:"shouldComponentUpdate",value:function(){return!this.moveRequested}},{key:"componentWillUnmount",value:function(){var e=this;this.didUnmount=!0,Object.keys(this.listeners).forEach((function(t){e.windowContext.removeEventListener(t,e.listeners[t])})),document.removeEventListener("wheel",this.handleWheel,{passive:!1}),this.timeouts.forEach((function(e){return clearTimeout(e)}))}},{key:"setTimeout",value:function(e){function t(t,i){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){var i=this,n=setTimeout((function(){i.timeouts=i.timeouts.filter((function(e){return e!==n})),e()}),t);return this.timeouts.push(n),n}))},{key:"setPreventInnerClose",value:function(){var e=this;this.preventInnerCloseTimeout&&this.clearTimeout(this.preventInnerCloseTimeout),this.preventInnerClose=!0,this.preventInnerCloseTimeout=this.setTimeout((function(){e.preventInnerClose=!1,e.preventInnerCloseTimeout=null}),100)}},{key:"getBestImageForType",value:function(e){var t=this.props[e],i={};if(this.isImageLoaded(t))i=this.getFitSizes(this.imageCache[t].width,this.imageCache[t].height);else{if(!this.isImageLoaded(this.props["".concat(e,"Thumbnail")]))return null;t=this.props["".concat(e,"Thumbnail")],i=this.getFitSizes(this.imageCache[t].width,this.imageCache[t].height,!0)}return{src:t,height:this.imageCache[t].height,width:this.imageCache[t].width,targetHeight:i.height,targetWidth:i.width}}},{key:"getFitSizes",value:function(e,t,i){var n=this.getLightboxRect(),a=n.height-2*this.props.imagePadding,o=n.width-2*this.props.imagePadding;return i||(a=Math.min(a,t),o=Math.min(o,e)),o/a>e/t?{width:e*a/t,height:a}:{width:o,height:t*o/e}}},{key:"getMaxOffsets",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.zoomLevel,t=this.getBestImageForType("mainSrc");if(null===t)return{maxX:0,minX:0,maxY:0,minY:0};var i=this.getLightboxRect(),n=this.getZoomMultiplier(e),a=0,o=0;return{maxX:a=n*t.width-i.width<0?(i.width-n*t.width)/2:(n*t.width-i.width)/2,maxY:o=n*t.height-i.height<0?(i.height-n*t.height)/2:(n*t.height-i.height)/2,minX:-1*a,minY:-1*o}}},{key:"getSrcTypes",value:function(){return[{name:"mainSrc",keyEnding:"i".concat(this.keyCounter)},{name:"mainSrcThumbnail",keyEnding:"t".concat(this.keyCounter)},{name:"nextSrc",keyEnding:"i".concat(this.keyCounter+1)},{name:"nextSrcThumbnail",keyEnding:"t".concat(this.keyCounter+1)},{name:"prevSrc",keyEnding:"i".concat(this.keyCounter-1)},{name:"prevSrcThumbnail",keyEnding:"t".concat(this.keyCounter-1)}]}},{key:"getZoomMultiplier",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.zoomLevel;return Math.pow(1.007,e)}},{key:"getLightboxRect",value:function(){return this.outerEl.current?this.outerEl.current.getBoundingClientRect():{width:I(),height:"undefined"!==typeof i.g.window?i.g.window.innerHeight:0,top:0,right:0,bottom:0,left:0}}},{key:"clearTimeout",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){this.timeouts=this.timeouts.filter((function(t){return t!==e})),clearTimeout(e)}))},{key:"changeZoom",value:function(e,t,i){if(this.props.enableZoom){var n=Math.max(0,Math.min(D,e));if(n!==this.state.zoomLevel)if(0!==n){var a=this.getBestImageForType("mainSrc");if(null!==a){var o=this.getZoomMultiplier(),s=this.getZoomMultiplier(n),r=this.getLightboxRect(),l="undefined"!==typeof t?t-r.left:r.width/2,c="undefined"!==typeof i?i-r.top:r.height/2,d=(r.width-a.width*o)/2,u=(r.height-a.height*o)/2,h=l-(l-(d-this.state.offsetX))/o*s,p=c-(c-(u-this.state.offsetY))/o*s,m=(r.width-a.width*s)/2-h,f=(r.height-a.height*s)/2-p;if(3!==this.currentAction){var g=this.getMaxOffsets();this.state.zoomLevel>n&&(m=Math.max(g.minX,Math.min(g.maxX,m)),f=Math.max(g.minY,Math.min(g.maxY,f)))}this.setState({zoomLevel:n,offsetX:m,offsetY:f})}}else this.setState({zoomLevel:n,offsetX:0,offsetY:0})}}},{key:"closeIfClickInner",value:function(e){!this.preventInnerClose&&e.target.className.search(/\bril-inner\b/)>-1&&this.requestClose(e)}},{key:"handleKeyInput",value:function(e){if(e.stopPropagation(),!this.isAnimating())if("keyup"!==e.type){var t=e.which||e.keyCode,i=new Date;if(!(i.getTime()-this.lastKeyDownTime<this.props.keyRepeatLimit&&t!==M))switch(this.lastKeyDownTime=i.getTime(),t){case M:e.preventDefault(),this.requestClose(e);break;case F:if(!this.props.prevSrc)return;e.preventDefault(),this.keyPressed=!0,this.requestMovePrev(e);break;case N:if(!this.props.nextSrc)return;e.preventDefault(),this.keyPressed=!0,this.requestMoveNext(e)}}else this.lastKeyDownTime-=this.props.keyRepeatKeyupBonus}},{key:"handleOuterMousewheel",value:function(e){var t=this;e.stopPropagation(),this.clearTimeout(this.resetScrollTimeout),this.resetScrollTimeout=this.setTimeout((function(){t.scrollX=0,t.scrollY=0}),300)}},{key:"handleImageMouseWheel",value:function(e){if(parseInt(e.deltaY)!==parseFloat(e.deltaY)){if(Math.abs(e.deltaY)>=Math.abs(e.deltaX)){if(e.stopPropagation(),Math.abs(e.deltaY)<1)return;this.scrollX=0,this.scrollY+=e.deltaY,this.changeZoom(this.state.zoomLevel-e.deltaY,e.clientX,e.clientY)}}else if(Math.abs(e.deltaY)>Math.abs(e.deltaX)){var t=this.state.offsetY+e.deltaY;t=t<0?0:t,this.setState({offsetY:t})}else{var i=this.state.offsetX+e.deltaX;i=i<0?0:i,this.setState({offsetX:i})}}},{key:"handleImageDoubleClick",value:function(e){this.state.zoomLevel>0?this.changeZoom(0,e.clientX,e.clientY):this.changeZoom(this.state.zoomLevel+100,e.clientX,e.clientY)}},{key:"handleImageClick",value:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()}},{key:"shouldHandleEvent",value:function(e){if(this.eventsSource===e)return!0;if(0===this.eventsSource)return this.eventsSource=e,!0;switch(e){case 1:default:return!1;case 2:return this.eventsSource=2,this.filterPointersBySource(),!0;case 3:return 1===this.eventsSource&&(this.eventsSource=3,this.filterPointersBySource(),!0)}}},{key:"addPointer",value:function(e){this.pointerList.push(e)}},{key:"removePointer",value:function(e){this.pointerList=this.pointerList.filter((function(t){return t.id!==e.id}))}},{key:"filterPointersBySource",value:function(){var e=this;this.pointerList=this.pointerList.filter((function(t){return t.source===e.eventsSource}))}},{key:"handleMouseDown",value:function(e){this.shouldHandleEvent(1)&&s.isTargetMatchImage(e.target)&&(this.addPointer(s.parseMouseEvent(e)),this.multiPointerStart(e))}},{key:"handleMouseMove",value:function(e){this.shouldHandleEvent(1)&&this.multiPointerMove(e,[s.parseMouseEvent(e)])}},{key:"handleMouseUp",value:function(e){this.shouldHandleEvent(1)&&(this.removePointer(s.parseMouseEvent(e)),this.multiPointerEnd(e))}},{key:"handlePointerEvent",value:function(e){if(this.shouldHandleEvent(3))switch(e.type){case"pointerdown":s.isTargetMatchImage(e.target)&&(this.addPointer(s.parsePointerEvent(e)),this.multiPointerStart(e));break;case"pointermove":this.multiPointerMove(e,[s.parsePointerEvent(e)]);break;case"pointerup":case"pointercancel":this.removePointer(s.parsePointerEvent(e)),this.multiPointerEnd(e)}}},{key:"handleTouchStart",value:function(e){var t=this;this.shouldHandleEvent(2)&&s.isTargetMatchImage(e.target)&&([].forEach.call(e.changedTouches,(function(e){return t.addPointer(s.parseTouchPointer(e))})),this.multiPointerStart(e))}},{key:"handleTouchMove",value:function(e){this.shouldHandleEvent(2)&&this.multiPointerMove(e,[].map.call(e.changedTouches,(function(e){return s.parseTouchPointer(e)})))}},{key:"handleTouchEnd",value:function(e){var t=this;this.shouldHandleEvent(2)&&([].map.call(e.changedTouches,(function(e){return t.removePointer(s.parseTouchPointer(e))})),this.multiPointerEnd(e))}},{key:"decideMoveOrSwipe",value:function(e){this.state.zoomLevel<=0?this.handleSwipeStart(e):this.handleMoveStart(e)}},{key:"multiPointerStart",value:function(e){switch(this.handleEnd(null),this.pointerList.length){case 1:e.preventDefault(),this.decideMoveOrSwipe(this.pointerList[0]);break;case 2:e.preventDefault(),this.handlePinchStart(this.pointerList)}}},{key:"multiPointerMove",value:function(e,t){switch(this.currentAction){case 1:e.preventDefault(),this.handleMove(t[0]);break;case 2:e.preventDefault(),this.handleSwipe(t[0]);break;case 3:e.preventDefault(),this.handlePinch(t)}}},{key:"multiPointerEnd",value:function(e){switch(0!==this.currentAction&&(this.setPreventInnerClose(),this.handleEnd(e)),this.pointerList.length){case 0:this.eventsSource=0;break;case 1:e.preventDefault(),this.decideMoveOrSwipe(this.pointerList[0]);break;case 2:e.preventDefault(),this.handlePinchStart(this.pointerList)}}},{key:"handleEnd",value:function(e){switch(this.currentAction){case 1:this.handleMoveEnd(e);break;case 2:this.handleSwipeEnd(e);break;case 3:this.handlePinchEnd(e)}}},{key:"handleMoveStart",value:function(e){var t=e.x,i=e.y;this.props.enableZoom&&(this.currentAction=1,this.moveStartX=t,this.moveStartY=i,this.moveStartOffsetX=this.state.offsetX,this.moveStartOffsetY=this.state.offsetY)}},{key:"handleMove",value:function(e){var t=e.x,i=e.y,n=this.moveStartX-t+this.moveStartOffsetX,a=this.moveStartY-i+this.moveStartOffsetY;this.state.offsetX===n&&this.state.offsetY===a||this.setState({offsetX:n,offsetY:a})}},{key:"handleMoveEnd",value:function(){var e=this;this.currentAction=0,this.moveStartX=0,this.moveStartY=0,this.moveStartOffsetX=0,this.moveStartOffsetY=0;var t=this.getMaxOffsets(),i=Math.max(t.minX,Math.min(t.maxX,this.state.offsetX)),n=Math.max(t.minY,Math.min(t.maxY,this.state.offsetY));i===this.state.offsetX&&n===this.state.offsetY||(this.setState({offsetX:i,offsetY:n,shouldAnimate:!0}),this.setTimeout((function(){e.setState({shouldAnimate:!1})}),this.props.animationDuration))}},{key:"handleSwipeStart",value:function(e){var t=e.x,i=e.y;this.currentAction=2,this.swipeStartX=t,this.swipeStartY=i,this.swipeEndX=t,this.swipeEndY=i}},{key:"handleSwipe",value:function(e){var t=e.x,i=e.y;this.swipeEndX=t,this.swipeEndY=i}},{key:"handleSwipeEnd",value:function(e){var t=this.swipeEndX-this.swipeStartX,i=Math.abs(t),n=Math.abs(this.swipeEndY-this.swipeStartY);if(this.currentAction=0,this.swipeStartX=0,this.swipeStartY=0,this.swipeEndX=0,this.swipeEndY=0,!(!e||this.isAnimating()||i<1.5*n)){if(i<200&&i<this.getLightboxRect().width/4)return;t>0&&this.props.prevSrc?(e.preventDefault(),this.requestMovePrev()):t<0&&this.props.nextSrc&&(e.preventDefault(),this.requestMoveNext())}}},{key:"calculatePinchDistance",value:function(){var e=k(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pinchTouchList,2),t=e[0],i=e[1];return Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2))}},{key:"calculatePinchCenter",value:function(){var e=k(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pinchTouchList,2),t=e[0],i=e[1];return{x:t.x-(t.x-i.x)/2,y:t.y-(t.y-i.y)/2}}},{key:"handlePinchStart",value:function(e){this.props.enableZoom&&(this.currentAction=3,this.pinchTouchList=e.map((function(e){return{id:e.id,x:e.x,y:e.y}})),this.pinchDistance=this.calculatePinchDistance())}},{key:"handlePinch",value:function(e){this.pinchTouchList=this.pinchTouchList.map((function(t){for(var i=0;i<e.length;i+=1)if(e[i].id===t.id)return e[i];return t}));var t=this.calculatePinchDistance(),i=this.state.zoomLevel+t-this.pinchDistance;this.pinchDistance=t;var n=this.calculatePinchCenter(this.pinchTouchList),a=n.x,o=n.y;this.changeZoom(i,a,o)}},{key:"handlePinchEnd",value:function(){this.currentAction=0,this.pinchTouchList=null,this.pinchDistance=0}},{key:"handleWindowResize",value:function(){this.clearTimeout(this.resizeTimeout),this.resizeTimeout=this.setTimeout(this.forceUpdate.bind(this),100)}},{key:"handleZoomInButtonClick",value:function(){var e=this.state.zoomLevel+100;this.changeZoom(e),e===D&&this.zoomOutBtn.current.focus()}},{key:"handleZoomOutButtonClick",value:function(){var e=this.state.zoomLevel-100;this.changeZoom(e),0===e&&this.zoomInBtn.current.focus()}},{key:"handleCaptionMousewheel",value:function(e){if(e.stopPropagation(),this.caption.current){var t=this.caption.current.getBoundingClientRect().height,i=this.caption.current,n=i.scrollHeight,a=i.scrollTop;(e.deltaY>0&&t+a>=n||e.deltaY<0&&a<=0)&&e.preventDefault()}}},{key:"isAnimating",value:function(){return this.state.shouldAnimate||this.state.isClosing}},{key:"isImageLoaded",value:function(e){return e&&e in this.imageCache&&this.imageCache[e].loaded}},{key:"loadImage",value:function(e,t,n){var a=this;if(this.isImageLoaded(t))this.setTimeout((function(){n()}),1);else{var o=new i.g.Image;this.props.imageCrossOrigin&&(o.crossOrigin=this.props.imageCrossOrigin),o.onerror=function(i){a.props.onImageLoadError(t,e,i),a.setState((function(t){return{loadErrorStatus:m(m({},t.loadErrorStatus),{},g({},e,!0))}})),n(i)},o.onload=function(){a.props.onImageLoad(t,e,o),a.imageCache[t]={loaded:!0,width:o.width,height:o.height},n()},o.src=t}}},{key:"loadAllImages",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props;this.getSrcTypes().forEach((function(i){var n=i.name;t[n]&&e.state.loadErrorStatus[n]&&e.setState((function(e){return{loadErrorStatus:m(m({},e.loadErrorStatus),{},g({},n,!1))}})),t[n]&&!e.isImageLoaded(t[n])&&e.loadImage(n,t[n],function(t,i){return function(n){n||e.props[t]!==i||e.didUnmount||e.forceUpdate()}}(n,t[n]))}))}},{key:"requestClose",value:function(e){var t=this,i=function(){t.saveRotateImage(),t.props.onCloseRequest(e)};this.props.animationDisabled||"keydown"===e.type&&!this.props.animationOnKeyInput?i():(this.setState({isClosing:!0}),this.setTimeout(i,this.props.animationDuration))}},{key:"requestMove",value:function(e,t){var i=this,n={zoomLevel:0,offsetX:0,offsetY:0};this.props.animationDisabled||this.keyPressed&&!this.props.animationOnKeyInput||(n.shouldAnimate=!0,this.setTimeout((function(){return i.setState({shouldAnimate:!1})}),this.props.animationDuration)),this.keyPressed=!1,this.moveRequested=!0,this.saveRotateImage(),"prev"===e?(this.keyCounter-=1,this.setState(n),this.props.onMovePrevRequest(t)):(this.keyCounter+=1,this.setState(n),this.props.onMoveNextRequest(t))}},{key:"requestMoveNext",value:function(e){this.requestMove("next",e)}},{key:"requestMovePrev",value:function(e){this.requestMove("prev",e)}},{key:"saveRotateImage",value:function(){this.props.onRotateImage&&0!==this.state.rotateDeg&&360!==this.state.rotateDeg&&(this.props.onRotateImage(this.state.rotateDeg),this.setState({rotateDeg:0}))}},{key:"rotateImage",value:function(){var e=this.state.rotateDeg;e=e>=360?this.state.rotateDeg-270:e+90,this.setState({rotateDeg:e})}},{key:"render",value:function(){var e=this,t=this.props,n=t.animationDisabled,a=t.animationDuration,o=t.clickOutsideToClose,l=t.discourageDownloads,c=t.enableZoom,d=t.imageTitle,u=t.nextSrc,p=t.prevSrc,f=t.isDesktop,g=t.toolbarButtons,b=t.reactModalStyle,x=t.onAfterOpen,y=t.imageCrossOrigin,S=t.reactModalProps,k=t.onRotateImage,w=this.state,j=w.zoomLevel,P=w.offsetX,I=w.offsetY,_=w.isClosing,M=w.loadErrorStatus,F=w.rotateDeg,N=this.getLightboxRect(),L={};!n&&this.isAnimating()&&(L=m(m({},L),{},{transition:"transform ".concat(a,"ms")}));var T={};this.getSrcTypes().forEach((function(e){var t=e.name,i=e.keyEnding;T[t]=i}));var O=[],E=function(t,i,n){if(e.props[t]){var a,o=e.getBestImageForType(t),c=m(m({},L),s.getTransform(m(m({},n),o)));if(j>0&&(c.cursor="move"),c.transform="".concat(c.transform," rotate(").concat(F,"deg)"),null===o&&(a=M,Object.keys(a).some((function(e){return a[e]}))))O.push(r.createElement("div",{className:"".concat(i," ril__image ril-errored"),style:c,key:e.props[t]+T[t]},r.createElement("div",{className:"ril__errorContainer"},e.props.imageLoadErrorMessage)));else if(null!==o){var u=o.src;l?(c.backgroundImage="url('".concat(u,"')"),O.push(r.createElement("div",{className:"".concat(i," ril__image ril__imageDiscourager"),onDoubleClick:e.handleImageDoubleClick,onWheel:e.handleImageMouseWheel,style:c,key:u+T[t]},r.createElement("div",{className:"ril-download-blocker ril__downloadBlocker"})))):O.push(r.createElement("img",v({},y?{crossOrigin:y}:{},{className:"".concat(i," ril__image"),onDoubleClick:e.handleImageDoubleClick,onClick:e.handleImageClick,onWheel:e.handleImageMouseWheel,onDragStart:function(e){return e.preventDefault()},style:c,src:u,key:u+T[t],alt:"string"===typeof d?d:C("Image"),draggable:!1})))}else{var h=r.createElement("div",{className:"ril-loading-circle ril__loadingCircle ril__loadingContainer__icon"},A(new Array(12)).map((function(e,t){return r.createElement("div",{key:t,className:"ril-loading-circle-point ril__loadingCirclePoint"})})));O.push(r.createElement("div",{className:"".concat(i," ril__image ril-not-loaded"),style:c,key:e.props[t]+T[t]},r.createElement("div",{className:"ril__loadingContainer"},h)))}}},U=this.getZoomMultiplier();E("nextSrc","ril-image-next ril__imageNext",{x:N.width}),E("mainSrc","ril-image-current",{x:-1*P,y:-1*I,zoom:U}),E("prevSrc","ril-image-prev ril__imagePrev",{x:-1*N.width});var z={overlay:m({zIndex:1e3,backgroundColor:"transparent"},b.overlay),content:m({backgroundColor:"transparent",overflow:"hidden",border:"none",borderRadius:0,padding:0,top:0,left:0,right:0,bottom:0},b.content)};return r.createElement(h(),v({isOpen:!0,onRequestClose:o?this.requestClose:void 0,onAfterOpen:function(){e.outerEl.current&&e.outerEl.current.focus(),x()},style:z,contentLabel:C("Lightbox"),appElement:"undefined"!==typeof i.g.window?i.g.window.document.body:void 0},S),r.createElement("div",{className:"ril-outer ril__outer ril__outerAnimating ".concat(this.props.wrapperClassName," ").concat(_?"ril-closing ril__outerClosing":""),style:{transition:"opacity ".concat(a,"ms"),animationDuration:"".concat(a,"ms"),animationDirection:_?"normal":"reverse"},ref:this.outerEl,onWheel:this.handleOuterMousewheel,onMouseMove:this.handleMouseMove,onMouseDown:this.handleMouseDown,onTouchStart:this.handleTouchStart,onTouchMove:this.handleTouchMove,tabIndex:"-1",onKeyDown:this.handleKeyInput,onKeyUp:this.handleKeyInput},r.createElement("div",{className:"ril-inner ril__inner",onClick:o?this.closeIfClickInner:void 0},O),p&&f&&r.createElement("button",{type:"button",className:"ril-prev-button ril__navButtons ril__navButtonPrev",key:"prev","aria-label":this.props.prevLabel,onClick:this.isAnimating()?void 0:this.requestMovePrev}),u&&f&&r.createElement("button",{type:"button",className:"ril-next-button ril__navButtons ril__navButtonNext",key:"next","aria-label":this.props.nextLabel,onClick:this.isAnimating()?void 0:this.requestMoveNext}),r.createElement("div",{className:"ril-toolbar ril__toolbar"},r.createElement("ul",{className:"ril-toolbar-left ril__toolbarSide ril__toolbarLeftSide"},r.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},r.createElement("span",{className:"ril-toolbar__item__child ril__toolbarItemChild"},d))),r.createElement("ul",{className:"ril-toolbar-right ril__toolbarSide ril__toolbarRightSide"},g&&g.map((function(e,t){return r.createElement("li",{key:"button_".concat(t+1),className:"ril-toolbar__item ril__toolbarItem"},e)})),r.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},r.createElement("button",{type:"button",key:"close","aria-label":this.props.closeLabel,className:"ril-close ril-toolbar__item__child ril__toolbarItemChild ril__builtinButton ril__closeButton",onClick:this.isAnimating()?void 0:this.requestClose})))),r.createElement("div",{onMouseDown:function(e){return e.stopPropagation()},className:"ril-caption ril__caption"},c&&r.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},r.createElement("button",{type:"button",key:"zoom-in","aria-label":this.props.zoomInLabel,className:["ril-zoom-in","ril__toolbarItemChild","ril__builtinButton","ril__zoomInButton"].concat(A(j===D?["ril__builtinButtonDisabled"]:[])).join(" "),ref:this.zoomInBtn,disabled:this.isAnimating()||j===D,onClick:this.isAnimating()||j===D?void 0:this.handleZoomInButtonClick})),c&&r.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},r.createElement("button",{type:"button",key:"zoom-out","aria-label":this.props.zoomOutLabel,className:["ril-zoom-out","ril__toolbarItemChild","ril__builtinButton","ril__zoomOutButton"].concat(A(0===j?["ril__builtinButtonDisabled"]:[])).join(" "),ref:this.zoomOutBtn,disabled:this.isAnimating()||0===j,onClick:this.isAnimating()||0===j?void 0:this.handleZoomOutButtonClick})),k&&r.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},r.createElement("button",{type:"button",className:["ril-rotate","ril__toolbarItemChild","ril__builtinButton","ril__rotateButton","ril_rotateImageButton"].join(" "),onClick:this.rotateImage})))))}}],a=[{key:"isTargetMatchImage",value:function(e){return e&&/ril-image-current/.test(e.className)}},{key:"parseMouseEvent",value:function(e){return{id:"mouse",source:1,x:parseInt(e.clientX,10),y:parseInt(e.clientY,10)}}},{key:"parseTouchPointer",value:function(e){return{id:e.identifier,source:2,x:parseInt(e.clientX,10),y:parseInt(e.clientY,10)}}},{key:"parsePointerEvent",value:function(e){return{id:e.pointerId,source:3,x:parseInt(e.clientX,10),y:parseInt(e.clientY,10)}}},{key:"getTransform",value:function(e){var t=e.x,i=void 0===t?0:t,n=e.y,a=void 0===n?0:n,o=e.zoom,s=void 0===o?1:o,r=e.width,l=e.targetWidth,c=i,d=I();r>d&&(c+=(d-r)/2);var u=s*(l/r);return{transform:"translate3d(".concat(c,"px,").concat(a,"px,0) scale3d(").concat(u,",").concat(u,",1)")}}}],n&&f(t.prototype,n),a&&f(t,a),Object.defineProperty(t,"prototype",{writable:!1}),s}(r.Component);L.propTypes={isDesktop:d().bool,mainSrc:d().string.isRequired,prevSrc:d().string,nextSrc:d().string,mainSrcThumbnail:d().string,prevSrcThumbnail:d().string,nextSrcThumbnail:d().string,onCloseRequest:d().func.isRequired,onMovePrevRequest:d().func,onMoveNextRequest:d().func,onImageLoadError:d().func,onImageLoad:d().func,onAfterOpen:d().func,discourageDownloads:d().bool,animationDisabled:d().bool,animationOnKeyInput:d().bool,animationDuration:d().number,keyRepeatLimit:d().number,keyRepeatKeyupBonus:d().number,imageTitle:d().node,imageCaption:d().node,imageCrossOrigin:d().string,reactModalStyle:d().object,imagePadding:d().number,wrapperClassName:d().string,toolbarButtons:d().arrayOf(d().node),clickOutsideToClose:d().bool,enableZoom:d().bool,reactModalProps:d().shape({}),nextLabel:d().string,prevLabel:d().string,zoomInLabel:d().string,zoomOutLabel:d().string,closeLabel:d().string,imageLoadErrorMessage:d().node,onRotateImage:d().func},L.defaultProps={isDesktop:!0,imageTitle:null,imageCaption:null,toolbarButtons:null,reactModalProps:{},animationDisabled:!1,animationDuration:300,animationOnKeyInput:!1,clickOutsideToClose:!0,closeLabel:"Close lightbox",discourageDownloads:!1,enableZoom:!0,imagePadding:10,imageCrossOrigin:null,keyRepeatKeyupBonus:40,keyRepeatLimit:180,mainSrcThumbnail:null,nextLabel:"Next image",nextSrc:null,nextSrcThumbnail:null,onAfterOpen:function(){},onImageLoadError:function(){},onImageLoad:function(){},onMoveNextRequest:function(){},onMovePrevRequest:function(){},prevLabel:"Previous image",prevSrc:null,prevSrcThumbnail:null,reactModalStyle:{},wrapperClassName:"",zoomInLabel:"Zoom in",zoomOutLabel:"Zoom out",imageLoadErrorMessage:"This image failed to load",onRotateImage:null};var T=L,O=i(44414),E=function(e){function t(){return(0,n.A)(this,t),(0,o.A)(this,t,arguments)}return(0,s.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props.imageItems,t=this.props.imageIndex,i=e.length,n=e[t].name,a="".concat(n," (").concat(t+1,"/").concat(i,")");return(0,O.jsx)(T,{imageTitle:a,mainSrc:e[t].src,nextSrc:e[(t+1)%i].src,prevSrc:e[(t+i-1)%i].src,onCloseRequest:this.props.closeImagePopup,onMovePrevRequest:this.props.moveToPrevImage,onMoveNextRequest:this.props.moveToNextImage,imagePadding:70,imageLoadErrorMessage:(0,l.AP)("The image could not be loaded."),prevLabel:(0,l.AP)("Previous (Left arrow key)"),nextLabel:(0,l.AP)("Next (Right arrow key)"),closeLabel:(0,l.AP)("Close (Esc)"),zoomInLabel:(0,l.AP)("Zoom in"),zoomOutLabel:(0,l.AP)("Zoom out")})}}])}(r.Component),U=E},16670:function(e,t,i){var n,a=i(23029),o=i(92901),s=i(39874),r=i(85501),l=i(9950),c=i(58195),d=i(14113),u=i(99308),h=i(40326),p=i(97011),m=i(65604),f=i(81446),g=i(44414),v=function(e){function t(e){var i;return(0,a.A)(this,t),(i=(0,s.A)(this,t,[e])).queryZipProgress=function(){var e=i.state.zipToken;p.e.queryZipProgress(e).then((function(t){var a=t.data;if(1==a.failed){var o;switch(clearInterval(n),a.failed_reason){case"size too large":o=(0,h.AP)("Failed to download. The total size of the files exceeded the limit.");break;case"internal error":o=(0,h.AP)("Internal Server Error");break;default:o=(0,h.AP)("Error")}i.setState({isLoading:!1,errorMsg:o})}else i.setState({zipProgress:0==a.total?"100%":(a.zipped/a.total*100).toFixed(2)+"%"}),a.total==a.zipped&&(clearInterval(n),i.props.toggleDialog(),location.href="".concat(h.IX,"zip/").concat(e))})).catch((function(e){clearInterval(n);var t=m.Aq.getErrorMsg(e);i.setState({isLoading:!1,errorMsg:t})}))},i.cancelZipTask=function(){var e=i.state.zipToken;p.e.cancelZipTask(e).then((function(e){})).catch((function(e){}))},i.toggleDialog=function(){var e=i.state.zipProgress;e&&"100%"!=e&&(clearInterval(n),i.cancelZipTask()),i.props.toggleDialog()},i.state={isLoading:!0,errorMsg:"",zipProgress:null},i}return(0,r.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,i=t.token,a=t.path,o=t.repoID,s=t.target;(i?s.length?p.e.getShareLinkDirentsZipTask(i,a,s):p.e.getShareLinkZipTask(i,a):p.e.zipDownload(o,a,s)).then((function(t){var i=t.data.zip_token;e.setState({isLoading:!1,errorMsg:"",zipToken:i}),e.queryZipProgress(),n=setInterval(e.queryZipProgress,1e3)})).catch((function(t){var i=m.Aq.getErrorMsg(t);e.setState({isLoading:!1,errorMsg:i})}))}},{key:"render",value:function(){return(0,g.jsxs)(c.A,{isOpen:!0,toggle:this.toggleDialog,children:[(0,g.jsx)(d.A,{toggle:this.toggleDialog,children:(0,h.AP)("Download")}),(0,g.jsx)(u.A,{children:(0,g.jsx)(b,{data:this.state})})]})}}])}(l.Component),b=function(e){function t(){return(0,a.A)(this,t),(0,s.A)(this,t,arguments)}return(0,r.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.data,t=e.isLoading,i=e.errorMsg,n=e.zipProgress;return t?(0,g.jsx)(f.A,{}):i?(0,g.jsxs)("div",{className:"text-center mt-7 mb-8",children:[(0,g.jsx)("img",{src:"".concat(h.SG,"img/error-tip.png"),alt:"",width:"100"}),(0,g.jsx)("p",{className:"mt-3",children:i})]}):(0,g.jsx)("p",{className:"mt-4 text-center",children:"".concat((0,h.AP)("Packaging...")," ").concat(n)})}}])}(l.Component);t.A=v},39143:function(e,t,i){i.d(t,{A:function(){return A}});var n=i(23029),a=i(92901),o=i(39874),s=i(85501),r=i(9950),l=i(40866),c=i(58195),d=i(14113),u=i(99308),h=i(85907),p=i(18849),m=i(59051),f=i.n(m),g=i(40326),v=i(97011),b=i(65604),x=i(4086),y=i(44414),S=function(e){function t(e){var i;return(0,n.A)(this,t),(i=(0,o.A)(this,t,[e])).onFileTagChanged=function(e){var t=e.parent_path,n={name:e.filename},a="/"===t?t+e.filename:t+"/"+e.filename;i.props.onFileTagChanged(n,a)},i.onDeleteTaggedFile=function(e){var t=i.props.repoID,n=e.file_tag_id;v.e.deleteFileTag(t,n).then((function(t){i.getTaggedFiles(),i.props.updateUsedRepoTags(),i.props.onFileTagChanged&&!e.file_deleted&&i.onFileTagChanged(e)})).catch((function(e){var t=b.Aq.getErrorMsg(e);x.A.danger(t)}))},i.getTaggedFiles=function(){var e=i.props,t=e.repoID,n=e.currentTag,a=e.shareLinkToken;(a?v.e.getShareLinkTaggedFiles(a,n.id):v.e.listTaggedFiles(t,n.id)).then((function(e){var t=[];void 0!==e.data.tagged_files&&e.data.tagged_files.forEach((function(e){var i=e;t.push(i)})),i.setState({taggedFileList:t})})).catch((function(e){var t=b.Aq.getErrorMsg(e);x.A.danger(t)}))},i.state={taggedFileList:[]},i}return(0,s.A)(t,e),(0,a.A)(t,[{key:"componentDidMount",value:function(){this.getTaggedFiles()}},{key:"render",value:function(){var e=this,t=this.state.taggedFileList;return(0,y.jsxs)(c.A,{isOpen:!0,style:{maxWidth:"678px"},children:[(0,y.jsx)(d.A,{toggle:this.props.onClose,children:(0,g.AP)("Tagged Files")}),(0,y.jsx)(u.A,{className:"dialog-list-container",children:(0,y.jsxs)("table",{children:[(0,y.jsx)("thead",{children:(0,y.jsxs)("tr",{children:[(0,y.jsx)("th",{width:"50%",className:"ellipsis",children:(0,g.AP)("Name")}),(0,y.jsx)("th",{width:"20%",children:(0,g.AP)("Size")}),(0,y.jsx)("th",{width:"22%",children:(0,g.AP)("Last Update")}),(0,y.jsx)("th",{width:"8%"})]})}),(0,y.jsx)("tbody",{children:t.map((function(t,i){return(0,y.jsx)(k,{repoID:e.props.repoID,taggedFile:t,onDeleteTaggedFile:e.onDeleteTaggedFile,shareLinkToken:e.props.shareLinkToken,enableFileDownload:e.props.enableFileDownload},i)}))})]})}),(0,y.jsx)(h.A,{children:(0,y.jsx)(p.A,{color:"secondary",onClick:this.props.toggleCancel,children:(0,g.AP)("Close")})})]})}}])}(r.Component),k=function(e){function t(e){var i;return(0,n.A)(this,t),(i=(0,o.A)(this,t,[e])).onMouseEnter=function(){i.setState({active:!0})},i.onMouseLeave=function(){i.setState({active:!1})},i.deleteFile=function(e){e.preventDefault(),i.props.onDeleteTaggedFile(i.props.taggedFile)},i.state={active:!1},i}return(0,s.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.taggedFile,i=e.shareLinkToken,n=e.enableFileDownload,a=t.parent_path?b.Aq.joinPath(t.parent_path,t.filename):"",o=i?g.Yc+"d/"+i+"/files/?p="+b.Aq.encodePath(a):g.Yc+"lib/"+this.props.repoID+"/file"+b.Aq.encodePath(a);return(0,y.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onFocus:this.onMouseEnter,children:[t.file_deleted?(0,y.jsx)(r.Fragment,{children:(0,y.jsxs)("td",{colSpan:"3",className:"name",children:[t.filename," ",(0,y.jsx)("span",{style:{color:"red"},children:(0,g.AP)("deleted")})]})}):(0,y.jsxs)(r.Fragment,{children:[(0,y.jsx)("td",{children:(0,y.jsx)("a",{href:o,target:"_blank",className:"d-inline-block w-100 ellipsis",title:t.filename,rel:"noreferrer",children:t.filename})}),(0,y.jsx)("td",{children:b.Aq.bytesToSize(t.size)}),(0,y.jsx)("td",{children:f().unix(t.mtime).fromNow()})]}),(0,y.jsxs)("td",{children:[!i&&(0,y.jsx)("a",{href:"#",role:"button","aria-label":(0,g.AP)("Delete"),title:(0,g.AP)("Delete"),className:"action-icon sf2-icon-x3".concat(this.state.active?"":" invisible"),onClick:this.deleteFile}),i&&n&&(0,y.jsx)("a",{className:"action-icon sf2-icon-download".concat(this.state.active?"":" invisible"),href:"".concat(o,"&dl=1"),title:(0,g.AP)("Download"),"aria-label":(0,g.AP)("Download")})]})]})}}])}(r.Component),A=function(e){function t(e){var i;return(0,n.A)(this,t),(i=(0,o.A)(this,t,[e])).onListTaggedFiles=function(e){i.setState({currentTag:e,isListTaggedFileShow:!i.state.isListTaggedFileShow})},i.onCloseDialog=function(){i.setState({isListTaggedFileShow:!1})},i.state={currentTag:null,isListTaggedFileShow:!1},i}return(0,s.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this,t=this.props,i=t.repoID,n=t.usedRepoTags,a=t.className;return(0,y.jsxs)("div",{className:"repo-info-bar ".concat(a||""),children:[n.length>0&&(0,y.jsx)("ul",{className:"used-tag-list",children:n.map((function(t){return(0,y.jsxs)("li",{className:"used-tag-item",children:[(0,y.jsx)("span",{className:"used-tag",style:{backgroundColor:t.color}}),(0,y.jsx)("span",{className:"used-tag-name",title:t.name,children:t.name}),(0,y.jsx)("button",{type:"button",className:"used-tag-files border-0 bg-transparent",onClick:e.onListTaggedFiles.bind(e,t),children:t.fileCount>1?t.fileCount+" files":t.fileCount+" file"})]},t.id)}))}),this.state.isListTaggedFileShow&&(0,y.jsx)(l.A,{children:(0,y.jsx)(S,{repoID:i,currentTag:this.state.currentTag,onClose:this.onCloseDialog,toggleCancel:this.onListTaggedFiles,updateUsedRepoTags:this.props.updateUsedRepoTags,onFileTagChanged:this.props.onFileTagChanged,shareLinkToken:this.props.shareLinkToken,enableFileDownload:this.props.enableFileDownload})})]})}}])}(r.Component)},23088:function(e,t,i){var n=i(90675),a=i(10467),o=i(23029),s=i(92901),r=i(39874),l=i(85501),c=i(9950),d=i(72517),u=i.n(d),h=i(17119),p=i(18849),m=i(19260),f=i(6030),g=i(68879),v=i(78297),b=i(59051),x=i.n(b),y=i(51925),S=i(40326),k=i(65604),A=i(97011),w=i(81446),j=i(4086),P=i(40866),C=i(16670),I=i(60472),_=i(60436),D=i(68238),M=i.n(D),F=i(44414),N="uploading",L="error",T="isSaving",O="uploaded",E=function(e){function t(e){var i;return(0,o.A)(this,t),(i=(0,r.A)(this,t,[e])).onUploadCancel=function(e){e.preventDefault(),i.props.onUploadCancel(i.props.resumableFile)},i.onUploadRetry=function(e){e.preventDefault(),i.props.onUploadRetry(i.props.resumableFile)},i.formatFileSize=function(e){return"number"!==typeof e?"":e>=1e9?(e/1e9).toFixed(1)+" G":e>=1e6?(e/1e6).toFixed(1)+" M":e>=1e3?(e/1e3).toFixed(1)+" K":e.toFixed(1)+" B"},i.state={uploadState:N},i}return(0,l.A)(t,e),(0,s.A)(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.resumableFile,i=N;t.error?i=L:(0!==t.remainingTime||t.isSaved||(i=T),t.isSaved&&(i=O)),this.setState({uploadState:i})}},{key:"render",value:function(){var e=this.props.resumableFile,t=Math.round(100*e.progress()),i=e.error;return(0,F.jsxs)("tr",{className:"file-upload-item",children:[(0,F.jsx)("td",{className:"upload-name",children:(0,F.jsx)("div",{className:"ellipsis",children:e.newFileName})}),(0,F.jsx)("td",{children:(0,F.jsx)("span",{className:"file-size",children:this.formatFileSize(e.size)})}),(0,F.jsxs)("td",{className:"upload-progress",children:[(this.state.uploadState===N||this.state.uploadState===T)&&(0,F.jsxs)(c.Fragment,{children:[e.size>=1e8&&(0,F.jsxs)(c.Fragment,{children:[e.isUploading()&&(0,F.jsxs)("div",{className:"progress-container",children:[(0,F.jsx)("div",{className:"progress",children:(0,F.jsx)("div",{className:"progress-bar",role:"progressbar",style:{width:"".concat(t,"%")},"aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"100"})}),-1===e.remainingTime&&(0,F.jsx)("div",{className:"progress-text",children:(0,S.AP)("Preparing to upload...")}),e.remainingTime>0&&(0,F.jsxs)("div",{className:"progress-text",children:[(0,S.AP)("Remaining")," ",k.Aq.formatTime(e.remainingTime)]}),0===e.remainingTime&&(0,F.jsx)("div",{className:"progress-text",children:(0,S.AP)("Saving...")})]}),!e.isUploading()&&(0,F.jsx)("div",{className:"progress-container d-flex align-items-center",children:(0,F.jsx)("div",{className:"progress",children:(0,F.jsx)("div",{className:"progress-bar",role:"progressbar",style:{width:"".concat(t,"%")},"aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"100"})})})]}),e.size<1e8&&(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)("div",{className:"progress-container d-flex align-items-center",children:(0,F.jsx)("div",{className:"progress",children:(0,F.jsx)("div",{className:"progress-bar",role:"progressbar",style:{width:"".concat(t,"%")},"aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"100"})})}),this.state.uploadState===N&&(0,F.jsxs)(F.Fragment,{children:[0==t&&(0,F.jsx)("p",{className:"progress-text mb-0",children:(0,S.AP)("Waiting...")}),t>0&&(0,F.jsx)("p",{className:"progress-text mb-0",children:"".concat((0,S.AP)("Uploading...")," ").concat(t,"%")})]}),this.state.uploadState===T&&(0,F.jsx)("p",{className:"progress-text mb-0",children:(0,S.AP)("Saving...")})]})]}),this.state.uploadState===O&&(0,F.jsxs)("div",{className:"d-flex align-items-center",children:[(0,F.jsx)("span",{className:"upload-success-icon sf2-icon-tick mr-2"}),(0,F.jsx)("span",{className:"upload-success-msg",children:(0,S.AP)("Uploaded")})]}),this.state.uploadState===L&&(0,F.jsxs)("div",{className:"d-flex align-items-center",children:[(0,F.jsx)("span",{className:"upload-failure-icon sf3-font sf3-font-info mr-2"}),(0,F.jsx)("span",{className:"upload-failure-msg",dangerouslySetInnerHTML:{__html:i}})]})]}),(0,F.jsx)("td",{className:"upload-operation",children:(0,F.jsxs)(c.Fragment,{children:[this.state.uploadState===N&&(0,F.jsx)("a",{href:"#",onClick:this.onUploadCancel,role:"button",children:(0,S.AP)("Cancel")}),this.state.uploadState===L&&(0,F.jsx)("a",{href:"#",onClick:this.onUploadRetry,role:"button",children:(0,S.AP)("Retry")})]})})]})}}])}(c.Component),U=function(e){function t(){return(0,o.A)(this,t),(0,r.A)(this,t,arguments)}return(0,l.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.file;return(0,F.jsxs)("tr",{className:"file-upload-item",children:[(0,F.jsx)("td",{className:"upload-name",children:(0,F.jsx)("div",{className:"ellipsis",title:e.name,children:e.name})}),(0,F.jsx)("td",{children:k.Aq.bytesToSize(e.size)}),(0,F.jsx)("td",{children:(0,F.jsxs)("div",{className:"d-flex align-items-center",children:[(0,F.jsx)("span",{className:"upload-failure-icon sf3-font sf3-font-info mr-2"}),(0,F.jsx)("span",{className:"upload-failure-msg",children:(0,S.AP)("File too large")})]})}),(0,F.jsx)("td",{})]})}}])}(c.Component),z=U,q=function(e){function t(e){var i;return(0,o.A)(this,t),(i=(0,r.A)(this,t,[e])).onCancelAllUploading=function(){i.props.onCancelAllUploading()},i.onMinimizeUpload=function(e){e.nativeEvent.stopImmediatePropagation(),i.setState({isMinimized:!i.state.isMinimized})},i.onCloseUpload=function(e){e.nativeEvent.stopImmediatePropagation(),i.props.onCloseUploadDialog()},i.state={isMinimized:!1},i}return(0,l.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e,t=this,i=this.props,n=i.totalProgress,a=i.retryFileList,o=i.uploadBitrate,s=i.uploadFileList,r=i.forbidUploadFileList,l=i.isUploading,c=(0,S.AP)("{uploaded_files_num}/{all_files_num} Files").replace("{uploaded_files_num}",s.filter((function(e){return e.isSaved})).length).replace("{all_files_num}",s.length);if(!l){var d=s.filter((function(e){return e.error})).length+r.length;d>0&&(e=(0,S.AP)("{failed_files_num} file(s) failed to upload").replace("{failed_files_num}",d))}return(0,F.jsxs)("div",{className:"uploader-list-view mw-100",style:{height:this.state.isMinimized?document.querySelector(".uploader-list-header").offsetHeight:"20rem"},children:[(0,F.jsxs)("div",{className:"uploader-list-header flex-shrink-0",children:[(0,F.jsx)("div",{children:l?(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)("span",{children:(0,S.AP)("File Uploading...")}),(0,F.jsx)("span",{className:"ml-2",children:"".concat(n,"% (").concat(k.Aq.formatBitRate(o),")")}),(0,F.jsx)("div",{className:"progress",children:(0,F.jsx)("div",{className:"progress-bar",role:"progressbar",style:{width:"".concat(n,"%")},"aria-valuenow":n,"aria-valuemin":"0","aria-valuemax":"100"})})]}):(0,F.jsx)(F.Fragment,{children:e?(0,F.jsx)("p",{className:"m-0 error",children:e}):(0,F.jsx)("p",{className:"m-0",children:(0,S.AP)("All files uploaded")})})}),(0,F.jsxs)("div",{className:"upload-dialog-op-container",children:[(0,F.jsx)("span",{className:"sf2-icon-minus upload-dialog-op",onClick:this.onMinimizeUpload}),!l&&(0,F.jsx)("span",{className:"sf2-icon-x1 upload-dialog-op",onClick:this.onCloseUpload})]})]}),(0,F.jsxs)("div",{className:"uploader-list-content",children:[(0,F.jsxs)("div",{className:"d-flex justify-content-between align-items-center border-bottom uploader-content-bar",children:[s.length>0&&(0,F.jsx)("span",{children:c}),(0,F.jsxs)("div",{className:"ml-auto",children:[(0,F.jsx)("button",{className:"btn btn-lg border-0 background-transparent px-0",onClick:this.props.onUploadRetryAll,disabled:0==a.length,children:(0,S.AP)("Retry All")}),(0,F.jsx)("button",{className:"btn btn-lg border-0 background-transparent px-0 ml-3",onClick:this.props.onCancelAllUploading,disabled:!l,children:(0,S.AP)("Cancel All")})]})]}),(0,F.jsxs)("table",{className:"table-thead-hidden",children:[(0,F.jsx)("thead",{children:(0,F.jsxs)("tr",{children:[(0,F.jsx)("th",{width:"40%",children:(0,S.AP)("name")}),(0,F.jsx)("th",{width:"15%",children:(0,S.AP)("size")}),(0,F.jsx)("th",{width:"30%",children:(0,S.AP)("progress")}),(0,F.jsx)("th",{width:"15%",children:(0,S.AP)("state")})]})}),(0,F.jsxs)("tbody",{children:[this.props.forbidUploadFileList.map((function(e,t){return(0,F.jsx)(z,{file:e},t)})),this.props.uploadFileList.map((function(e,i){return(0,F.jsx)(E,{resumableFile:e,onUploadCancel:t.props.onUploadCancel,onUploadRetry:t.props.onUploadRetry},i)}))]})]})]})]})}}])}(c.Component),R=(i(89183),function(e){function t(e){var i;return(0,o.A)(this,t),(i=(0,r.A)(this,t,[e])).componentWillUnmount=function(){window.onbeforeunload=null,!0===i.props.dragAndDrop&&i.resumable.disableDropOnDocument()},i.onbeforeunload=function(){if(window.uploader&&window.uploader.isUploadProgressDialogShow&&100!==window.uploader.totalProgress)return""},i.bindCallbackHandler=function(){var e=i.props,t=e.minFileSizeErrorCallback,n=e.fileTypeErrorCallback;i.maxFilesErrorCallback&&(i.resumable.opts.maxFilesErrorCallback=i.maxFilesErrorCallback),t&&(i.resumable.opts.minFileSizeErrorCallback=i.props.minFileSizeErrorCallback),i.maxFileSizeErrorCallback&&(i.resumable.opts.maxFileSizeErrorCallback=i.maxFileSizeErrorCallback),n&&(i.resumable.opts.fileTypeErrorCallback=i.props.fileTypeErrorCallback)},i.bindEventHandler=function(){i.resumable.on("chunkingComplete",i.onChunkingComplete.bind(i)),i.resumable.on("fileAdded",i.onFileAdded.bind(i)),i.resumable.on("filesAddedComplete",i.filesAddedComplete.bind(i)),i.resumable.on("fileProgress",i.onFileProgress.bind(i)),i.resumable.on("fileSuccess",i.onFileUploadSuccess.bind(i)),i.resumable.on("progress",i.onProgress.bind(i)),i.resumable.on("complete",i.onComplete.bind(i)),i.resumable.on("pause",i.onPause.bind(i)),i.resumable.on("fileRetry",i.onFileRetry.bind(i)),i.resumable.on("fileError",i.onFileError.bind(i)),i.resumable.on("error",i.onError.bind(i)),i.resumable.on("beforeCancel",i.onBeforeCancel.bind(i)),i.resumable.on("cancel",i.onCancel.bind(i)),i.resumable.on("dragstart",i.onDragStart.bind(i))},i.maxFilesErrorCallback=function(e,t){var i=S.YX,n=(0,S.AP)("Please upload no more than {maxFiles} files at a time.");n=n.replace("{maxFiles}",i),j.A.danger(n)},i.maxFileSizeErrorCallback=function(e){var t=i.state.forbidUploadFileList;t.push(e),i.setState({forbidUploadFileList:t})},i.onChunkingComplete=function(e){var t="/"===i.props.path?"/":i.props.path+"/",n=e.fileName,a=e.relativePath,o=n===a;if(e.formData={},o)e.formData={parent_dir:t};else{var s=a.slice(0,a.lastIndexOf("/")+1);e.formData={parent_dir:t,relative_path:s}}},i.onFileAdded=function(e,t){if(e.fileName===e.relativePath&&1===t.length){i.setUploadFileList(i.resumable.files);var n=i.props,a=n.token,o=n.relativePath;A.e.sharedLinkGetFileUploadUrl(a,o).then((function(t){i.resumable.opts.target=t.data.upload_link+"?ret-json=1",i.resumableUpload(e)})).catch((function(e){var t=k.Aq.getErrorMsg(e);j.A.danger(t)}))}else if(i.setUploadFileList(i.resumable.files),!i.isUploadLinkLoaded){i.isUploadLinkLoaded=!0;var s=i.props,r=s.token,l=s.relativePath;A.e.sharedLinkGetFileUploadUrl(r,l).then((function(e){i.resumable.opts.target=e.data.upload_link+"?ret-json=1",i.resumable.upload()})).catch((function(e){var t=k.Aq.getErrorMsg(e);j.A.danger(t)}))}},i.resumableUpload=function(e){var t=i.props,n=t.repoID,a=t.path;A.e.getFileUploadedBytes(n,a,e.fileName).then((function(t){var n=t.data.uploadedBytes,a=1024*parseInt(S.QV)*1024||1048576,o=Math.floor(n/a);e.markChunksCompleted(o),i.resumable.upload()})).catch((function(e){var t=k.Aq.getErrorMsg(e);j.A.danger(t)}))},i.filesAddedComplete=function(e,t){i.state.forbidUploadFileList.length>0&&0===t.length&&i.setState({isUploadProgressDialogShow:!0,totalProgress:100})},i.setUploadFileList=function(){var e=i.resumable.files;i.setState({uploadFileList:e,isUploadProgressDialogShow:!0}),k.Aq.registerGlobalVariable("uploader","isUploadProgressDialogShow",!0)},i.onFileProgress=function(e){var t=i.getBitrate(),n=i.state.uploadFileList.map((function(i){if(i.uniqueIdentifier===e.uniqueIdentifier&&t){var n=8*(i.size-i.size*i.progress()),a=Math.floor(n/t);i.remainingTime=a}return i}));i.setState({uploadBitrate:t,uploadFileList:n})},i.getBitrate=function(){var e=0,t=0,n=(new Date).getTime();if(i.resumable.files.forEach((function(t){e+=t.progress()*t.size})),i.timestamp){var a=n-i.timestamp;if(a<i.bitrateInterval)return i.state.uploadBitrate;(e<i.loaded||0===i.loaded)&&(i.loaded=e),t=(e-i.loaded)*(1e3/a)*8}return i.timestamp=n,i.loaded=e,t},i.onProgress=function(){var e=Math.round(100*i.resumable.progress());i.setState({totalProgress:e}),k.Aq.registerGlobalVariable("uploader","totalProgress",e)},i.onFileUploadSuccess=function(e,t){var n=e.formData,a=(new Date).getTime()/1e3;t=n.replace?t:JSON.parse(t)[0],n.relative_path;var o={id:t.id,type:"file",name:t.name,size:t.size,mtime:a};i.props.onFileUploadSuccess(o);var s=i.state.uploadFileList.map((function(i){return i.uniqueIdentifier===e.uniqueIdentifier&&(i.newFileName=t.name,i.isSaved=!0),i}));i.setState({uploadFileList:s})},i.onFileError=function(e,t){var n="";if(t){var a=t.replace(/\n/g,"");a=JSON.parse(a),"File locked by others."===(n=a.error)&&(n=(0,S.AP)("File is locked by others.")),"Internal error."===n&&(n=(0,S.AP)("Internal Server Error"))}else n=(0,S.AP)("Network error");var o=i.state.uploadFileList.map((function(t){return t.uniqueIdentifier===e.uniqueIdentifier&&(i.state.retryFileList.push(t),t.error=n),t}));i.loaded=0,i.setState({retryFileList:i.state.retryFileList,uploadFileList:o})},i.onComplete=function(){i.notifiedFolders=[],i.isUploadLinkLoaded=!1},i.onPause=function(){},i.onError=function(e){i.isUploadLinkLoaded=!1,k.Aq.registerGlobalVariable("uploader","totalProgress",100)},i.onFileRetry=function(){},i.onBeforeCancel=function(){},i.onCancel=function(){},i.setHeaders=function(e,t){var i=t.offset,n=t.getOpt("chunkSize"),a=0===e.size?1:e.size,o=0!==i?i*n:0,s=Math.min(a,(i+1)*n)-1;return a-t.endByte<n&&!t.getOpt("forceChunkSize")&&(s=a),{Accept:"application/json; text/javascript, */*; q=0.01","Content-Disposition":'attachment; filename="'+encodeURI(e.fileName)+'"',"Content-Range":"bytes "+o+"-"+s+"/"+a}},i.setQuery=function(e){return e.formData},i.generateUniqueIdentifier=function(e){var t=e.webkitRelativePath||e.relativePath||e.fileName||e.name;return u()(t+new Date)+t},i.onClick=function(e){e.nativeEvent.stopImmediatePropagation(),e.stopPropagation()},i.onFileUpload=function(){i.uploadInput.current.removeAttribute("webkitdirectory"),i.uploadInput.current.click()},i.onFolderUpload=function(){i.uploadInput.current.setAttribute("webkitdirectory","webkitdirectory"),i.uploadInput.current.click()},i.onDragStart=function(){i.uploadInput.current.setAttribute("webkitdirectory","webkitdirectory")},i.onCloseUploadDialog=function(){i.loaded=0,i.resumable.files=[],i.isUploadLinkLoaded=!1,i.setState({isUploadProgressDialogShow:!1,uploadFileList:[],forbidUploadFileList:[]}),k.Aq.registerGlobalVariable("uploader","isUploadProgressDialogShow",!1)},i.onUploadCancel=function(e){var t=i.state.uploadFileList.filter((function(t){return t.uniqueIdentifier!==e.uniqueIdentifier||(t.cancel(),!1)}));i.resumable.isUploading()||(i.setState({totalProgress:100}),i.loaded=0),i.setState({uploadFileList:t})},i.onCancelAllUploading=function(){var e=i.state.uploadFileList.filter((function(e){return!Math.round(1!==e.progress())||(e.cancel(),!1)}));i.loaded=0,i.setState({totalProgress:100,uploadFileList:e}),i.isUploadLinkLoaded=!1},i.onUploadRetry=function(e){var t=i.props,n=t.token,a=t.relativePath;A.e.sharedLinkGetFileUploadUrl(n,a).then((function(t){i.resumable.opts.target=t.data.upload_link+"?ret-json=1";var n=i.state.retryFileList.filter((function(t){return t.uniqueIdentifier!==e.uniqueIdentifier})),a=i.state.uploadFileList.map((function(t){return t.uniqueIdentifier===e.uniqueIdentifier&&(t.error=null,i.retryUploadFile(t)),t}));i.setState({retryFileList:n,uploadFileList:a})})).catch((function(e){var t=k.Aq.getErrorMsg(e);j.A.danger(t)}))},i.onUploadRetryAll=function(){var e=i.props,t=e.token,n=e.relativePath;A.e.sharedLinkGetFileUploadUrl(t,n).then((function(e){i.resumable.opts.target=e.data.upload_link+"?ret-json=1",i.state.retryFileList.forEach((function(e){e.error=!1,i.retryUploadFile(e)}));var t=i.state.uploadFileList.slice(0);i.setState({retryFileList:[],uploadFileList:t})})).catch((function(e){var t=k.Aq.getErrorMsg(e);j.A.danger(t)}))},i.retryUploadFile=function(e){var t=i.props,n=t.repoID,a=t.path,o=e.fileName;if(!(e.fileName===e.relativePath)){var s=e.formData.relative_path;o=("/"===a?a+s:a+"/"+s)+o}e.bootstrap();var r=!1;e.resumableObj.on("chunkingComplete",(function(){r||A.e.getFileUploadedBytes(n,a,o).then((function(t){var i=t.data.uploadedBytes,n=1024*parseInt(S.QV)*1024||1048576,a=Math.floor(i/n);e.markChunksCompleted(a),e.resumableObj.upload()})).catch((function(e){var t=k.Aq.getErrorMsg(e);j.A.danger(t)})),r=!0}))},i.uploadFile=function(){var e=i.resumable.files[i.resumable.files.length-1],t=i.props,n=t.token,a=t.relativePath;A.e.sharedLinkGetFileUploadUrl(n,a).then((function(t){i.resumable.opts.target=t.data.upload_link+"?ret-json=1",i.setState({isUploadRemindDialogShow:!1,isUploadProgressDialogShow:!0,uploadFileList:[].concat((0,_.A)(i.state.uploadFileList),[e])},(function(){i.resumable.upload()})),k.Aq.registerGlobalVariable("uploader","isUploadProgressDialogShow",!0)})).catch((function(e){var t=k.Aq.getErrorMsg(e);j.A.danger(t)}))},i.cancelFileUpload=function(){i.resumable.files.pop(),i.setState({isUploadRemindDialogShow:!1})},i.state={retryFileList:[],uploadFileList:[],forbidUploadFileList:[],totalProgress:0,isUploadProgressDialogShow:!1,isUploadRemindDialogShow:!1,currentResumableFile:null,uploadBitrate:0},i.uploadInput=c.createRef(),i.notifiedFolders=[],i.timestamp=null,i.loaded=0,i.bitrateInterval=500,window.onbeforeunload=i.onbeforeunload,i.isUploadLinkLoaded=!1,i}return(0,l.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){this.resumable=new(M())({target:"",query:this.setQuery||{},fileType:this.props.filetypes,maxFiles:S.YX||void 0,maxFileSize:1e3*S.hn*1e3||void 0,testMethod:this.props.testMethod||"post",testChunks:this.props.testChunks||!1,headers:this.setHeaders||{},withCredentials:this.props.withCredentials||!1,chunkSize:1024*parseInt(S.QV)*1024||1048576,simultaneousUploads:this.props.simultaneousUploads||1,fileParameterName:this.props.fileParameterName,generateUniqueIdentifier:this.generateUniqueIdentifier,forceChunkSize:!0,maxChunkRetries:3,minFileSize:0}),this.resumable.assignBrowse(this.uploadInput.current,!0),!0===this.props.dragAndDrop&&this.resumable.enableDropOnDocument(),this.bindCallbackHandler(),this.bindEventHandler()}},{key:"render",value:function(){return(0,F.jsxs)(c.Fragment,{children:[(0,F.jsx)("div",{className:"file-uploader-container",children:(0,F.jsx)("div",{className:"file-uploader",children:(0,F.jsx)("input",{className:"upload-input",type:"file",ref:this.uploadInput,onClick:this.onClick,"aria-label":(0,S.AP)("Upload")})})}),this.state.isUploadProgressDialogShow&&(0,F.jsx)(q,{retryFileList:this.state.retryFileList,uploadFileList:this.state.uploadFileList,forbidUploadFileList:this.state.forbidUploadFileList,totalProgress:this.state.totalProgress,uploadBitrate:this.state.uploadBitrate,onCloseUploadDialog:this.onCloseUploadDialog,onCancelAllUploading:this.onCancelAllUploading,onUploadCancel:this.onUploadCancel,onUploadRetry:this.onUploadRetry,onUploadRetryAll:this.onUploadRetryAll,isUploading:this.resumable.isUploading()})]})}}])}(c.Component)),B=R,Y=i(58195),X=i(14113),Z=i(99308),W=i(76115),H=i(85907),K=i(50022),G=function(e){function t(e){var i;return(0,o.A)(this,t),(i=(0,r.A)(this,t,[e])).onSaveSharedFile=function(){i.props.handleSaveSharedDir(i.state.repo.repo_id,i.state.selectedPath)},i.onDirentItemClick=function(e,t,n){"dir"===n.type?i.setState({repo:e,selectedPath:t}):i.setState({repo:null,selectedPath:""})},i.onRepoItemClick=function(e){i.setState({repo:e,selectedPath:"/"})},i.state={repo:null,selectedPath:"",errMessage:""},i}return(0,l.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){return(0,F.jsxs)(Y.A,{isOpen:!0,className:"sf-save-file",toggle:this.props.toggleCancel,children:[(0,F.jsx)(X.A,{toggle:this.props.toggleCancel,children:(0,S.AP)("Save to:")}),(0,F.jsxs)(Z.A,{children:[(0,F.jsx)(K.A,{isShowFile:!1,onDirentItemClick:this.onDirentItemClick,onRepoItemClick:this.onRepoItemClick,mode:"only_all_repos"}),this.state.errMessage&&(0,F.jsx)(W.A,{color:"danger",children:this.state.errMessage})]}),(0,F.jsxs)(H.A,{children:[(0,F.jsx)(p.A,{color:"secondary",onClick:this.props.toggleCancel,children:(0,S.AP)("Cancel")}),this.state.selectedPath?(0,F.jsx)(p.A,{color:"primary",onClick:this.onSaveSharedFile,children:(0,S.AP)("Submit")}):(0,F.jsx)(p.A,{color:"primary",disabled:!0,children:(0,S.AP)("Submit")})]})]})}}])}(c.Component),V=i(88002),Q=i(39143),$=i(25531);i(47100);x().locale(window.app.config.lang);var J=window.app.pageOptions.name,ee=window.shared.pageOptions,te=ee.token,ie=ee.dirName,ne=ee.dirPath,ae=ee.sharedBy,oe=ee.repoID,se=ee.relativePath,re=ee.mode,le=ee.thumbnailSize,ce=ee.zipped,de=ee.trafficOverLimit,ue=ee.canDownload,he=ee.noQuota,pe=ee.canUpload,me=ee.enableVideoThumbnail,fe=ee.enablePDFThumbnail,ge=!de&&ue,ve=function(e){function t(e){var i;return(0,o.A)(this,t),(i=(0,r.A)(this,t,[e])).sortItems=function(e,t){i.setState({sortBy:e,sortOrder:t,items:k.Aq.sortDirentsInSharedDir(i.state.items,e,t)})},i.getThumbnails=function(){var e=i.state.items.filter((function(e){return!e.is_dir&&(k.Aq.imageCheck(e.file_name)||me&&k.Aq.videoCheck(e.file_name)||fe&&k.Aq.pdfCheck(e.file_name))&&!e.encoded_thumbnail_src}));if(0!=e.length){var t=e.length,n=i,a=function(i){var o=e[i];A.e.getShareLinkThumbnail(te,o.file_path,le).then((function(e){o.encoded_thumbnail_src=e.data.encoded_thumbnail_src})).catch((function(e){})).then((function(){i<t-1?a(++i):n.setState({items:n.state.items})}))};a(0)}},i.renderPath=function(){return(0,F.jsxs)(c.Fragment,{children:[ce.map((function(e,t){return t!=ce.length-1?(0,F.jsxs)(c.Fragment,{children:[(0,F.jsx)("a",{href:"?p=".concat(encodeURIComponent(e.path),"&mode=").concat(re),className:"mx-1 ellipsis",title:e.name,children:e.name}),(0,F.jsx)("span",{children:" / "})]},t):null})),(0,F.jsx)("span",{className:"ml-1 ellipsis",title:ce[ce.length-1].name,children:ce[ce.length-1].name})]})},i.zipDownloadFolder=function(e){S.B$?A.e.getShareLinkZipTask(te,e).then((function(e){var t=e.data.zip_token;location.href="".concat(S.IX,"zip/").concat(t)})).catch((function(e){var t=k.Aq.getErrorMsg(e);i.setState({isLoading:!1,errorMsg:t})})):i.setState({isZipDialogOpen:!0,zipFolderPath:e})},i.zipDownloadSelectedItems=function(){if(S.B$){var e=i.state.items.filter((function(e){return e.isSelected})).map((function(e){return e.file_name||e.folder_name}));A.e.getShareLinkDirentsZipTask(te,se,e).then((function(e){var t=e.data.zip_token;location.href="".concat(S.IX,"zip/").concat(t)})).catch((function(e){var t=k.Aq.getErrorMsg(e);i.setState({isLoading:!1,errorMsg:t})}))}else i.setState({isZipDialogOpen:!0,zipFolderPath:se,selectedItems:i.state.items.filter((function(e){return e.isSelected})).map((function(e){return e.file_name||e.folder_name}))})},i.saveSelectedItems=function(){i.setState({isSaveSharedDirDialogShow:!0,itemsForSave:i.state.items.filter((function(e){return e.isSelected})).map((function(e){return e.file_name||e.folder_name}))})},i.saveAllItems=function(){i.setState({isSaveSharedDirDialogShow:!0,itemsForSave:i.state.items.map((function(e){return e.file_name||e.folder_name}))})},i.toggleSaveSharedDirCancel=function(){i.setState({isSaveSharedDirDialogShow:!1,itemsForSave:[]})},i.handleSaveSharedDir=function(e,t){var n=i.state.itemsForSave;A.e.saveSharedDir(e,t,te,se,n).then((function(e){i.setState({isSaveSharedDirDialogShow:!1,itemsForSave:[],isCopyMoveProgressDialogShow:!0,asyncCopyMoveTaskId:e.data.task_id,asyncOperatedFilesLength:n.length},(function(){i.getAsyncCopyMoveProgress()}))})).catch((function(e){var t=k.Aq.getErrorMsg(e);i.setState({errMessage:t})}))},i.onProgressDialogToggle=function(){if(100!==i.state.asyncOperationProgress){var e=i.state.asyncCopyMoveTaskId;A.e.cancelCopyMoveOperation(e)}i.setState({asyncOperationProgress:0,isCopyMoveProgressDialogShow:!1})},i.closeZipDialog=function(){i.setState({isZipDialogOpen:!1,zipFolderPath:"",selectedItems:[]})},i.prepareImageItem=function(e){var t=e.file_name,i="gif"==t.substr(t.lastIndexOf(".")+1).toLowerCase(),n="".concat(S.Yc,"d/").concat(te,"/files/?p=").concat(encodeURIComponent(e.file_path));return{name:t,url:n,src:i?"".concat(n,"&raw=1"):"".concat(S.Yc,"thumbnail/").concat(te,"/").concat(S.oC).concat(k.Aq.encodePath(e.file_path))}},i.showImagePopup=function(e){var t=i.state.items.filter((function(e){return!e.is_dir&&k.Aq.imageCheck(e.file_name)})),n=t.map((function(e){return i.prepareImageItem(e)}));i.setState({isImagePopupOpen:!0,imageItems:n,imageIndex:t.indexOf(e)})},i.closeImagePopup=function(){i.setState({isImagePopupOpen:!1})},i.moveToPrevImage=function(){var e=i.state.imageItems.length;i.setState((function(t){return{imageIndex:(t.imageIndex+e-1)%e}}))},i.moveToNextImage=function(){var e=i.state.imageItems.length;i.setState((function(t){return{imageIndex:(t.imageIndex+1)%e}}))},i.toggleAllSelected=function(){i.setState((function(e){return{isAllItemsSelected:!e.isAllItemsSelected,items:i.state.items.map((function(t){return t.isSelected=!e.isAllItemsSelected,t}))}}))},i.toggleItemSelected=function(e,t){i.setState({items:i.state.items.map((function(i){return i===e&&(i.isSelected=t),i}))},(function(){i.setState({isAllItemsSelected:!i.state.items.some((function(e){return!e.isSelected}))})}))},i.onUploadFile=function(e){e.nativeEvent.stopImmediatePropagation(),i.uploader.onFileUpload()},i.onFileUploadSuccess=function(e){var t=e.name,n=e.size,a={isSelected:!1,file_name:t,file_path:k.Aq.joinPath(se,t),is_dir:!1,last_modified:x()().format(),size:n},o=i.state.items.filter((function(e){return e.is_dir})),s=Array.from(i.state.items);s.splice(o.length,0,a),i.setState({items:s}),A.e.shareLinksUploadDone(te,k.Aq.joinPath(ne,t))},i.getShareLinkRepoTags=function(){A.e.getShareLinkRepoTags(te).then((function(e){var t=[];e.data.repo_tags.forEach((function(e){var i=new $.A(e);i.fileCount>0&&t.push(i)})),i.setState({usedRepoTags:t}),k.Aq.isDesktop()&&0!=t.length&&"/"==se&&i.setState({isRepoInfoBarShow:!0})})).catch((function(e){var t=k.Aq.getErrorMsg(e);j.A.danger(t)}))},i.state={isLoading:!0,errorMsg:"",items:[],isAllItemsSelected:!1,selectedItems:[],sortBy:"name",sortOrder:"asc",isZipDialogOpen:!1,zipFolderPath:"",usedRepoTags:[],isRepoInfoBarShow:!1,isSaveSharedDirDialogShow:!1,itemsForSave:[],asyncCopyMoveTaskId:"",asyncOperationProgress:0,asyncOperatedFilesLength:0,isCopyMoveProgressDialogShow:!1,isImagePopupOpen:!1,imageItems:[],imageIndex:0},i}return(0,l.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this;de&&j.A.danger((0,S.AP)("File download is disabled: the share link traffic of owner is used up."),{duration:3}),A.e.listSharedDir(te,se,le).then((function(t){var i=t.data.dirent_list.map((function(e){return e.isSelected=!1,e}));e.setState({isLoading:!1,errorMsg:"",items:k.Aq.sortDirentsInSharedDir(i,e.state.sortBy,e.state.sortOrder)}),e.getThumbnails()})).catch((function(t){var i=k.Aq.getErrorMsg(t);e.setState({isLoading:!1,errorMsg:i})})),this.getShareLinkRepoTags()}},{key:"getAsyncCopyMoveProgress",value:function(){var e=(0,a.A)((0,n.A)().mark((function e(){var t,i,a,o,s,r;return(0,n.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.asyncCopyMoveTaskId,e.prev=1,e.next=4,A.e.queryAsyncOperationProgress(t);case 4:if(i=e.sent,!(a=i.data).failed){e.next=11;break}return o=(0,S.AP)("Failed to copy files to another library."),j.A.danger(o),this.setState({asyncOperationProgress:0,isCopyMoveProgressDialogShow:!1}),e.abrupt("return");case 11:if(!a.successful){e.next=16;break}return this.setState({asyncOperationProgress:0,isCopyMoveProgressDialogShow:!1}),s=(0,S.AP)("Successfully copied files to another library."),j.A.success(s),e.abrupt("return");case 16:r=a.total?parseInt((a.done/a.total*100).toFixed(2)):0,this.getAsyncCopyMoveProgress(),this.setState({asyncOperationProgress:r}),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(1),this.setState({asyncOperationProgress:0,isCopyMoveProgressDialogShow:!1});case 24:case"end":return e.stop()}}),e,this,[[1,21]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=k.Aq.isDesktop(),i="btn btn-secondary btn-icon sf-view-mode-btn";return(0,F.jsxs)(c.Fragment,{children:[(0,F.jsxs)("div",{className:"h-100 d-flex flex-column",children:[(0,F.jsxs)("div",{className:"top-header d-flex justify-content-between",children:[(0,F.jsx)("a",{href:S.Yc,children:(0,F.jsx)("img",{src:S.SG+S.VI,height:S.hM,width:S.gA,title:S.q0,alt:"logo"})}),J&&(0,F.jsx)(y.A,{})]}),(0,F.jsx)("div",{className:"o-auto",children:(0,F.jsxs)("div",{className:"shared-dir-view-main",children:[(0,F.jsx)("h2",{className:"h3 text-truncate",title:ie,children:ie}),(0,F.jsxs)("p",{children:[(0,S.AP)("Shared by: "),ae]}),(0,F.jsxs)("div",{className:"d-flex justify-content-between align-items-center op-bar",children:[(0,F.jsxs)("p",{className:"m-0 mr-4 ellipsis d-flex align-items-center",children:[(0,S.AP)("Current path: "),this.renderPath()]}),(0,F.jsxs)("div",{className:"flex-none",children:[t&&(0,F.jsxs)("div",{className:"view-mode btn-group",children:[(0,F.jsx)("a",{href:"?p=".concat(encodeURIComponent(se),"&mode=list"),className:"".concat(i," sf2-icon-list-view ").concat("list"==re?"current-mode":""),title:(0,S.AP)("List"),"aria-label":(0,S.AP)("List")}),(0,F.jsx)("a",{href:"?p=".concat(encodeURIComponent(se),"&mode=grid"),className:"".concat(i," sf2-icon-grid-view ").concat("grid"==re?"current-mode":""),title:(0,S.AP)("Grid"),"aria-label":(0,S.AP)("Grid")})]}),pe&&(0,F.jsx)(p.A,{disabled:he,title:he?(0,S.AP)("The owner of this library has run out of space."):"",onClick:this.onUploadFile,className:"ml-2 shared-dir-op-btn shared-dir-upload-btn",children:(0,S.AP)("Upload")}),ge&&(0,F.jsx)(c.Fragment,{children:this.state.items.some((function(e){return e.isSelected}))?(0,F.jsxs)(c.Fragment,{children:[(0,F.jsx)(p.A,{color:"success",onClick:this.zipDownloadSelectedItems,className:"ml-2 shared-dir-op-btn",children:(0,S.AP)("ZIP Selected Items")}),ue&&J&&J!==ae&&(0,F.jsx)(p.A,{color:"success",onClick:this.saveSelectedItems,className:"ml-2 shared-dir-op-btn",children:(0,S.AP)("Save Selected Items")})]}):(0,F.jsxs)(c.Fragment,{children:[(0,F.jsx)(p.A,{color:"success",onClick:this.zipDownloadFolder.bind(this,se),className:"ml-2 shared-dir-op-btn",children:(0,S.AP)("ZIP")}),ue&&J&&J!==ae&&(0,F.jsx)(p.A,{color:"success",onClick:this.saveAllItems,className:"ml-2 shared-dir-op-btn",children:(0,S.AP)("Save")})]})})]})]}),!he&&pe&&(0,F.jsx)(B,{ref:function(t){return e.uploader=t},dragAndDrop:!1,token:te,path:"/"===ne?ne:ne.replace(/\/+$/,""),relativePath:"/"===se?se:se.replace(/\/+$/,""),repoID:oe,onFileUploadSuccess:this.onFileUploadSuccess}),this.state.isRepoInfoBarShow&&(0,F.jsx)(Q.A,{repoID:oe,currentPath:"/",usedRepoTags:this.state.usedRepoTags,shareLinkToken:te,enableFileDownload:ge,className:"mx-0"}),(0,F.jsx)(be,{isDesktop:t,isLoading:this.state.isLoading,errorMsg:this.state.errorMsg,items:this.state.items,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems,isAllItemsSelected:this.state.isAllItemsSelected,toggleAllSelected:this.toggleAllSelected,toggleItemSelected:this.toggleItemSelected,zipDownloadFolder:this.zipDownloadFolder,showImagePopup:this.showImagePopup})]})})]}),this.state.isZipDialogOpen&&(0,F.jsx)(P.A,{children:(0,F.jsx)(C.A,{token:te,path:this.state.zipFolderPath,target:this.state.selectedItems,toggleDialog:this.closeZipDialog})}),this.state.isSaveSharedDirDialogShow&&(0,F.jsx)(G,{sharedToken:te,parentDir:se,items:this.state.itemsForSave,toggleCancel:this.toggleSaveSharedDirCancel,handleSaveSharedDir:this.handleSaveSharedDir}),this.state.isCopyMoveProgressDialogShow&&(0,F.jsx)(V.A,{type:"copy",asyncOperatedFilesLength:this.state.asyncOperatedFilesLength,asyncOperationProgress:this.state.asyncOperationProgress,toggleDialog:this.onProgressDialogToggle}),this.state.isImagePopupOpen&&(0,F.jsx)(P.A,{children:(0,F.jsx)(I.A,{imageItems:this.state.imageItems,imageIndex:this.state.imageIndex,closeImagePopup:this.closeImagePopup,moveToPrevImage:this.moveToPrevImage,moveToNextImage:this.moveToNextImage})})]})}}])}(c.Component),be=function(e){function t(e){var i;return(0,o.A)(this,t),(i=(0,r.A)(this,t,[e])).sortByName=function(e){e.preventDefault();var t="asc"==i.props.sortOrder?"desc":"asc";i.props.sortItems("name",t)},i.sortByTime=function(e){e.preventDefault();var t="asc"==i.props.sortOrder?"desc":"asc";i.props.sortItems("time",t)},i.sortBySize=function(e){e.preventDefault();var t="asc"==i.props.sortOrder?"desc":"asc";i.props.sortItems("size",t)},i}return(0,l.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this,t=this.props,i=t.isDesktop,n=t.isLoading,a=t.errorMsg,o=t.items,s=t.sortBy,r=t.sortOrder,l=t.isAllItemsSelected;if(n)return(0,F.jsx)(w.A,{});if(a)return(0,F.jsx)("p",{className:"error mt-6 text-center",children:a});var c=(0,F.jsx)("tbody",{children:o.map((function(t,n){return(0,F.jsx)(xe,{isDesktop:i,item:t,zipDownloadFolder:e.props.zipDownloadFolder,showImagePopup:e.props.showImagePopup,toggleItemSelected:e.props.toggleItemSelected},n)}))});if(!i)return(0,F.jsxs)("table",{className:"table-hover table-thead-hidden",children:[(0,F.jsx)("thead",{children:(0,F.jsxs)("tr",{children:[(0,F.jsx)("th",{width:"12%"}),(0,F.jsx)("th",{width:"80%"}),(0,F.jsx)("th",{width:"8%"})]})}),c]});var d=(0,F.jsx)("span",{className:"sf3-font ".concat("asc"==r?"sf3-font-down rotate-180 d-inline-block":"sf3-font-down")});return"list"==re?(0,F.jsxs)("table",{className:"table-hover",children:[(0,F.jsx)("thead",{children:(0,F.jsxs)("tr",{children:[ge&&(0,F.jsx)("th",{width:"3%",className:"text-center",children:(0,F.jsx)("input",{type:"checkbox",checked:l,onChange:this.props.toggleAllSelected})}),(0,F.jsx)("th",{width:"5%"}),(0,F.jsx)("th",{width:ge?"50%":"53%",children:(0,F.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByName,children:[(0,S.AP)("Name")," ","name"==s&&d]})}),(0,F.jsx)("th",{width:"8%"}),(0,F.jsx)("th",{width:"14%",children:(0,F.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortBySize,children:[(0,S.AP)("Size")," ","size"==s&&d]})}),(0,F.jsx)("th",{width:"13%",children:(0,F.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByTime,children:[(0,S.AP)("Last Update")," ","time"==s&&d]})}),(0,F.jsx)("th",{width:"7%"})]})}),c]}):(0,F.jsx)("ul",{className:"grid-view",children:o.map((function(t,i){return(0,F.jsx)(ye,{item:t,zipDownloadFolder:e.props.zipDownloadFolder,showImagePopup:e.props.showImagePopup},i)}))})}}])}(c.Component),xe=function(e){function t(e){var i;return(0,o.A)(this,t),(i=(0,r.A)(this,t,[e])).toggleOpMenu=function(){i.setState({isOpMenuOpen:!i.state.isOpMenuOpen})},i.handleMouseOver=function(){i.setState({isIconShown:!0})},i.handleMouseOut=function(){i.setState({isIconShown:!1})},i.zipDownloadFolder=function(e){e.preventDefault(),i.props.zipDownloadFolder.bind(i,i.props.item.folder_path)()},i.handleFileClick=function(e){var t=i.props.item;k.Aq.imageCheck(t.file_name)&&(e.preventDefault(),i.props.showImagePopup(t))},i.toggleItemSelected=function(e){i.props.toggleItemSelected(i.props.item,e.target.checked)},i.state={isIconShown:!1,isOpMenuOpen:!1},i}return(0,l.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props,t=e.item,i=e.isDesktop,n=this.state.isIconShown,a="",o="";if(t.file_tags&&t.file_tags.length>0&&(a=u()(t.file_name).slice(0,7),o=t.file_tags.map((function(e){return e.tag_name})).join(" ")),t.is_dir)return i?(0,F.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[ge&&(0,F.jsx)("td",{className:"text-center",children:(0,F.jsx)("input",{type:"checkbox",checked:t.isSelected,onChange:this.toggleItemSelected})}),(0,F.jsx)("td",{className:"text-center",children:(0,F.jsx)("img",{src:k.Aq.getFolderIconUrl(),alt:"",width:"24"})}),(0,F.jsx)("td",{children:(0,F.jsx)("a",{href:"?p=".concat(encodeURIComponent(t.folder_path.substr(0,t.folder_path.length-1)),"&mode=").concat(re),children:t.folder_name})}),(0,F.jsx)("td",{}),(0,F.jsx)("td",{}),(0,F.jsx)("td",{title:x()(t.last_modified).format("llll"),children:x()(t.last_modified).fromNow()}),(0,F.jsx)("td",{children:ge&&(0,F.jsx)("a",{role:"button",className:"action-icon sf2-icon-download".concat(n?"":" invisible"),href:"#",onClick:this.zipDownloadFolder,title:(0,S.AP)("Download"),"aria-label":(0,S.AP)("Download")})})]}):(0,F.jsxs)("tr",{children:[(0,F.jsx)("td",{className:"text-center",children:(0,F.jsx)("img",{src:k.Aq.getFolderIconUrl(),alt:"",width:"24"})}),(0,F.jsxs)("td",{children:[(0,F.jsx)("a",{href:"?p=".concat(encodeURIComponent(t.folder_path.substr(0,t.folder_path.length-1)),"&mode=").concat(re),children:t.folder_name}),(0,F.jsx)("br",{}),(0,F.jsx)("span",{className:"item-meta-info",children:x()(t.last_modified).fromNow()})]}),(0,F.jsx)("td",{children:ge&&(0,F.jsxs)(m.A,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu,children:[(0,F.jsx)(f.A,{tag:"i",className:"sf-dropdown-toggle sf3-font sf3-font-more-vertical ml-0",title:(0,S.AP)("More operations"),"aria-label":(0,S.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),(0,F.jsxs)("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu,children:[(0,F.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),(0,F.jsx)("div",{className:"mobile-operation-menu",children:(0,F.jsx)(g.A,{className:"mobile-menu-item",onClick:this.zipDownloadFolder,children:(0,S.AP)("Download")})})]})]})})]});var s="".concat(S.Yc,"d/").concat(te,"/files/?p=").concat(encodeURIComponent(t.file_path)),r=t.encoded_thumbnail_src?"".concat(S.Yc).concat(t.encoded_thumbnail_src):"";return i?(0,F.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[ge&&(0,F.jsx)("td",{className:"text-center",children:(0,F.jsx)("input",{type:"checkbox",checked:t.isSelected,onChange:this.toggleItemSelected})}),(0,F.jsx)("td",{className:"text-center",children:r?(0,F.jsx)("img",{className:"thumbnail",src:r,alt:""}):(0,F.jsx)("img",{src:k.Aq.getFileIconUrl(t.file_name),alt:"",width:"24"})}),(0,F.jsx)("td",{children:(0,F.jsx)("a",{href:s,onClick:this.handleFileClick,children:t.file_name})}),(0,F.jsx)("td",{className:"tag-list-title",children:t.file_tags&&t.file_tags.length>0&&(0,F.jsxs)(c.Fragment,{children:[(0,F.jsx)("div",{id:"tag-list-title-".concat(a),className:"dirent-item tag-list tag-list-stacked",children:t.file_tags.map((function(e,i){var n=t.file_tags.length;return(0,F.jsx)("span",{className:"file-tag",style:{zIndex:n-i,backgroundColor:e.tag_color}},e.file_tag_id)}))}),(0,F.jsx)(v.A,{target:"tag-list-title-".concat(a),placement:"bottom",children:o})]})}),(0,F.jsx)("td",{children:k.Aq.bytesToSize(t.size)}),(0,F.jsx)("td",{title:x()(t.last_modified).format("llll"),children:x()(t.last_modified).fromNow()}),(0,F.jsx)("td",{children:ge&&(0,F.jsx)("a",{className:"action-icon sf2-icon-download".concat(n?"":" invisible"),href:"".concat(s,"&dl=1"),title:(0,S.AP)("Download"),"aria-label":(0,S.AP)("Download")})})]}):(0,F.jsxs)("tr",{children:[(0,F.jsx)("td",{className:"text-center",children:r?(0,F.jsx)("img",{className:"thumbnail",src:r,alt:""}):(0,F.jsx)("img",{src:k.Aq.getFileIconUrl(t.file_name),alt:"",width:"24"})}),(0,F.jsxs)("td",{children:[(0,F.jsx)("a",{href:s,onClick:this.handleFileClick,children:t.file_name}),(0,F.jsx)("br",{}),(0,F.jsx)("span",{className:"item-meta-info",children:k.Aq.bytesToSize(t.size)}),(0,F.jsx)("span",{className:"item-meta-info",children:x()(t.last_modified).fromNow()})]}),(0,F.jsx)("td",{children:ge&&(0,F.jsxs)(m.A,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu,children:[(0,F.jsx)(f.A,{tag:"i",className:"sf-dropdown-toggle sf3-font sf3-font-more-vertical ml-0",title:(0,S.AP)("More operations"),"aria-label":(0,S.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),(0,F.jsxs)("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu,children:[(0,F.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),(0,F.jsx)("div",{className:"mobile-operation-menu",children:(0,F.jsx)(g.A,{className:"mobile-menu-item",tag:"a",href:"".concat(s,"&dl=1"),children:(0,S.AP)("Download")})})]})]})})]})}}])}(c.Component),ye=function(e){function t(e){var i;return(0,o.A)(this,t),(i=(0,r.A)(this,t,[e])).handleMouseOver=function(){i.setState({isIconShown:!0})},i.handleMouseOut=function(){i.setState({isIconShown:!1})},i.zipDownloadFolder=function(e){e.preventDefault(),i.props.zipDownloadFolder.bind(i,i.props.item.folder_path)()},i.handleFileClick=function(e){var t=i.props.item;k.Aq.imageCheck(t.file_name)&&(e.preventDefault(),i.props.showImagePopup(t))},i.state={isIconShown:!1},i}return(0,l.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.item,t=this.state.isIconShown;if(e.is_dir){var i="?p=".concat(encodeURIComponent(e.folder_path.substr(0,e.folder_path.length-1)),"&mode=").concat(re);return(0,F.jsxs)("li",{className:"grid-item",onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[(0,F.jsx)("a",{href:i,className:"grid-file-img-link d-block",children:(0,F.jsx)("img",{src:k.Aq.getFolderIconUrl(!1,192),alt:"",width:"96",height:"96"})}),(0,F.jsx)("a",{href:i,className:"grid-file-name grid-file-name-link",children:e.folder_name}),ge&&(0,F.jsx)("a",{role:"button",className:"action-icon sf2-icon-download".concat(t?"":" invisible"),href:"#",onClick:this.zipDownloadFolder,title:(0,S.AP)("Download"),"aria-label":(0,S.AP)("Download")})]})}var n="".concat(S.Yc,"d/").concat(te,"/files/?p=").concat(encodeURIComponent(e.file_path)),a=e.encoded_thumbnail_src?"".concat(S.Yc).concat(e.encoded_thumbnail_src):"";return(0,F.jsxs)("li",{className:"grid-item",onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[(0,F.jsx)("a",{href:n,className:"grid-file-img-link d-block",onClick:this.handleFileClick,children:a?(0,F.jsx)("img",{className:"thumbnail",src:a,alt:""}):(0,F.jsx)("img",{src:k.Aq.getFileIconUrl(e.file_name),alt:"",width:"96",height:"96"})}),(0,F.jsx)("a",{href:n,className:"grid-file-name grid-file-name-link",onClick:this.handleFileClick,children:e.file_name}),ge&&(0,F.jsx)("a",{className:"action-icon sf2-icon-download".concat(t?"":" invisible"),href:"".concat(n,"&dl=1"),title:(0,S.AP)("Download"),"aria-label":(0,S.AP)("Download")})]})}}])}(c.Component);h.render((0,F.jsx)(ve,{}),document.getElementById("wrapper"))},47100:function(){}},function(e){e.O(0,[4223],(function(){return t=23088,e(e.s=t);var t}));e.O()}]);