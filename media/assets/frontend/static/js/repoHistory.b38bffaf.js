"use strict";(self.webpackChunkseahub_frontend=self.webpackChunkseahub_frontend||[]).push([[6245],{12086:function(e,t,i){var a=i(23029),s=i(92901),n=i(39874),o=i(85501),r=i(9950),l=i(58195),c=i(99308),h=i(85907),d=i(20015),m=i(40326),u=i(97011),g=i(65604),p=i(4086),f=i(20338),x=i(44414),P=function(e){function t(e){var i;return(0,a.A)(this,t),(i=(0,n.A)(this,t,[e])).handleInputChange=function(e){i.setState({inputValue:e})},i.formSubmit=function(){var e=i.state.inputValue.map((function(e,t){return e.value})).join(","),t=i.props,a=t.repoID,s=t.commitID;i.setState({submitBtnDisabled:!0}),u.e.updateRepoCommitLabels(a,s,e).then((function(e){i.props.updateCommitLabels(e.data.revisionTags.map((function(e,t){return e.tag}))),i.props.toggleDialog(),p.A.success((0,m.AP)("Successfully edited labels."))})).catch((function(e){var t=g.Aq.getErrorMsg(e);i.setState({formErrorMsg:t,submitBtnDisabled:!1})}))},i.state={inputValue:i.props.commitLabels.map((function(e,t){return{label:e,value:e}})),submitBtnDisabled:!1},i}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.state.formErrorMsg;return(0,x.jsxs)(l.A,{isOpen:!0,toggle:this.props.toggleDialog,children:[(0,x.jsx)(f.A,{toggle:this.props.toggleDialog,children:(0,m.AP)("Edit labels")}),(0,x.jsx)(c.A,{children:(0,x.jsxs)(r.Fragment,{children:[(0,x.jsx)(d.A,{defaultValue:this.props.commitLabels.map((function(e,t){return{label:e,value:e}})),isMulti:!0,onChange:this.handleInputChange,placeholder:""}),e&&(0,x.jsx)("p",{className:"error m-0 mt-2",children:e})]})}),(0,x.jsx)(h.A,{children:(0,x.jsx)("button",{className:"btn btn-primary",disabled:this.state.submitBtnDisabled,onClick:this.formSubmit,children:(0,m.AP)("Submit")})})]})}}])}(r.Component);t.A=P},92512:function(e,t,i){var a=i(23029),s=i(92901),n=i(39874),o=i(85501),r=i(9950),l=i(17119),c=i(13690),h=i(4159),d=i.n(h),m=i(65604),u=i(40326),g=i(97011),p=i(81446),f=i(62376),x=i(40866),P=i(72991),b=i(33e3),A=i(12086),D=(i(18291),i(81848),i(20899),i(44414)),j=window.app.pageOptions,v=j.repoID,w=j.repoName,C=j.userPerm,L=j.showLabel,M=function(e){function t(e){var i;return(0,a.A)(this,t),(i=(0,n.A)(this,t,[e])).getItems=function(e){g.e.getRepoHistory(v,e,i.state.perPage).then((function(t){i.setState({isLoading:!1,currentPage:e,items:t.data.data,hasNextPage:t.data.more})})).catch((function(e){i.setState({isLoading:!1,errorMsg:m.Aq.getErrorMsg(e,!0)})}))},i.resetPerPage=function(e){i.setState({perPage:e},(function(){i.getItems(1)}))},i.onSearchedClick=function(e){if(!0===e.is_dir){var t=u.Yc+"library/"+e.repo_id+"/"+e.repo_name+e.path;(0,c.oo)(t,{replace:!0})}else{var i=u.Yc+"lib/"+e.repo_id+"/file"+m.Aq.encodePath(e.path);window.open("about:blank").location.href=i}},i.goBack=function(e){e.preventDefault(),window.history.back()},i.state={isLoading:!0,errorMsg:"",currentPage:1,perPage:100,hasNextPage:!1,items:[]},i}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,i=this.state,a=i.currentPage,s=i.perPage;this.setState({perPage:parseInt(t.get("per_page")||s),currentPage:parseInt(t.get("page")||a)},(function(){e.getItems(e.state.currentPage)}))}},{key:"render",value:function(){var e=(0,u.AP)("{placeholder} Modification History");return e=e.replace("{placeholder}",'<span class="op-target text-truncate mx-1">'+m.Aq.HTMLescape(w)+"</span>"),(0,D.jsx)(r.Fragment,{children:(0,D.jsxs)("div",{className:"h-100 d-flex flex-column",children:[(0,D.jsxs)("div",{className:"top-header d-flex justify-content-between",children:[(0,D.jsx)("a",{href:u.Yc,children:(0,D.jsx)("img",{src:u.SG+u.VI,height:u.hM,width:u.gA,title:u.q0,alt:"logo"})}),(0,D.jsx)(P.A,{onSearchedClick:this.onSearchedClick})]}),(0,D.jsx)("div",{className:"flex-auto container-fluid pt-4 pb-6 o-auto",children:(0,D.jsx)("div",{className:"row",children:(0,D.jsxs)("div",{className:"col-md-10 offset-md-1",children:[(0,D.jsx)("h2",{dangerouslySetInnerHTML:{__html:e},className:"d-flex text-nowrap"}),(0,D.jsx)("a",{href:"#",className:"go-back",title:(0,u.AP)("Back"),onClick:this.goBack,role:"button","aria-label":(0,u.AP)("Back"),children:(0,D.jsx)("span",{className:"sf3-font sf3-font-down rotate-90 d-inline-block"})}),"rw"==C&&(0,D.jsx)("p",{className:"tip",children:(0,u.AP)("Tip: a snapshot will be generated after modification, which records the library state after the modification.")}),(0,D.jsx)(N,{isLoading:this.state.isLoading,errorMsg:this.state.errorMsg,items:this.state.items,currentPage:this.state.currentPage,hasNextPage:this.state.hasNextPage,curPerPage:this.state.perPage,resetPerPage:this.resetPerPage,getListByPage:this.getItems})]})})})]})})}}])}(r.Component),N=function(e){function t(e){var i;return(0,a.A)(this,t),(i=(0,n.A)(this,t,[e])).getPreviousPage=function(){i.props.getListByPage(i.props.currentPage-1)},i.getNextPage=function(){i.props.getListByPage(i.props.currentPage+1)},i.theadData=L?[{width:"43%",text:(0,u.AP)("Description")},{width:"12%",text:(0,u.AP)("Time")},{width:"9%",text:(0,u.AP)("Modifier")},{width:"12%",text:"".concat((0,u.AP)("Device")," / ").concat((0,u.AP)("Version"))},{width:"12%",text:(0,u.AP)("Labels")},{width:"12%",text:""}]:[{width:"43%",text:(0,u.AP)("Description")},{width:"15%",text:(0,u.AP)("Time")},{width:"15%",text:(0,u.AP)("Modifier")},{width:"15%",text:"".concat((0,u.AP)("Device")," / ").concat((0,u.AP)("Version"))},{width:"12%",text:""}],i}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props,t=e.isLoading,i=e.errorMsg,a=e.items,s=e.curPerPage,n=e.currentPage,o=e.hasNextPage;return t?(0,D.jsx)(p.A,{}):i?(0,D.jsx)("p",{className:"error mt-6 text-center",children:i}):(0,D.jsxs)(r.Fragment,{children:[(0,D.jsxs)("table",{className:"table-hover",children:[(0,D.jsx)("thead",{children:(0,D.jsx)("tr",{children:this.theadData.map((function(e,t){return(0,D.jsx)("th",{width:e.width,children:e.text},t)}))})}),(0,D.jsx)("tbody",{children:a.map((function(e,t){return e.isFirstCommit=1==n&&0==t,e.showDetails=o||t!=a.length-1,(0,D.jsx)(S,{item:e},t)}))})]}),(0,D.jsx)(f.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:n,hasNextPage:o,curPerPage:s,resetPerPage:this.props.resetPerPage})]})}}])}(r.Component),S=function(e){function t(e){var i;return(0,a.A)(this,t),(i=(0,n.A)(this,t,[e])).handleMouseOver=function(){i.setState({isIconShown:!0})},i.handleMouseOut=function(){i.setState({isIconShown:!1})},i.showCommitDetails=function(e){e.preventDefault(),i.setState({isCommitDetailsDialogOpen:!i.state.isCommitDetailsDialogOpen})},i.toggleCommitDetailsDialog=function(){i.setState({isCommitDetailsDialogOpen:!i.state.isCommitDetailsDialogOpen})},i.editLabel=function(e){e.preventDefault(),i.setState({isCommitLabelUpdateDialogOpen:!i.state.isCommitLabelUpdateDialogOpen})},i.toggleLabelEditDialog=function(){i.setState({isCommitLabelUpdateDialogOpen:!i.state.isCommitLabelUpdateDialogOpen})},i.updateLabels=function(e){i.setState({labels:e})},i.state={labels:i.props.item.tags,isIconShown:!1,isCommitLabelUpdateDialogOpen:!1,isCommitDetailsDialogOpen:!1},i}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.item,t=this.state,i=t.isIconShown,a=t.isCommitLabelUpdateDialogOpen,s=t.isCommitDetailsDialogOpen,n=t.labels,o="";return o=e.email?e.second_parent_id?(0,u.AP)("None"):(0,D.jsx)("a",{href:"".concat(u.Yc,"profile/").concat(encodeURIComponent(e.email),"/"),children:e.name}):(0,u.AP)("Unknown"),(0,D.jsxs)(r.Fragment,{children:[(0,D.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[(0,D.jsxs)("td",{children:[e.description,e.showDetails&&(0,D.jsx)("a",{href:"#",className:"details",onClick:this.showCommitDetails,role:"button",children:(0,u.AP)("Details")})]}),(0,D.jsx)("td",{title:d()(e.time).format("dddd, MMMM D, YYYY h:mm:ss A"),children:d()(e.time).format("YYYY-MM-DD")}),(0,D.jsx)("td",{children:o}),(0,D.jsx)("td",{children:e.client_version?"".concat(e.device_name," / ").concat(e.client_version):"API / --"}),L&&(0,D.jsxs)("td",{children:[n.map((function(e,t){return(0,D.jsx)("span",{className:"commit-label",children:e},t)})),"rw"==C&&(0,D.jsx)("a",{href:"#",role:"button",className:"attr-action-icon sf3-font sf3-font-rename ".concat(i?"":"invisible"),title:(0,u.AP)("Edit"),"aria-label":(0,u.AP)("Edit"),onClick:this.editLabel})]}),(0,D.jsx)("td",{children:"rw"==C&&(e.isFirstCommit?(0,D.jsx)("span",{className:i?"":"invisible",children:(0,u.AP)("Current Version")}):(0,D.jsx)("a",{href:"".concat(u.Yc,"repo/").concat(v,"/snapshot/?commit_id=").concat(e.commit_id),className:i?"":"invisible",children:(0,u.AP)("View Snapshot")}))})]}),s&&(0,D.jsx)(x.A,{children:(0,D.jsx)(b.A,{repoID:v,commitID:e.commit_id,commitTime:e.time,toggleDialog:this.toggleCommitDetailsDialog})}),a&&(0,D.jsx)(x.A,{children:(0,D.jsx)(A.A,{repoID:v,commitID:e.commit_id,commitLabels:n,updateCommitLabels:this.updateLabels,toggleDialog:this.toggleLabelEditDialog})})]})}}])}(r.Component);l.render((0,D.jsx)(M,{}),document.getElementById("wrapper"))},20899:function(){}},function(e){e.O(0,[4223],(function(){return t=92512,e(e.s=t);var t}));e.O()}]);