/*! For license information please see sysAdmin.68009afb.js.LICENSE.txt */
(self.webpackChunkseahub_frontend=self.webpackChunkseahub_frontend||[]).push([[7583],{52622:function(e,t,n){"use strict";var r=n(23029),i=n(92901),s=n(39874),a=n(85501),o=n(9950),l=n(58195),c=n(14113),d=n(99308),h=n(85907),u=n(18849),g=n(65604),p=n(40326),m=n(44414),f=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,s.A)(this,t,[e])).submit=function(){n.props.changeGroup2Department(),n.props.toggleDialog()},n.state={selectedOption:null},n}return(0,a.A)(t,e),(0,i.A)(t,[{key:"render",value:function(){var e='<span class="op-target">'+g.Aq.HTMLescape(this.props.groupName)+"</span>",t=(0,p.AP)("Are you sure to change group {placeholder} to department ?").replace("{placeholder}",e);return(0,m.jsxs)(l.A,{isOpen:!0,toggle:this.props.toggleDialog,children:[(0,m.jsx)(c.A,{toggle:this.props.toggleDialog,children:(0,p.AP)("Change group to department")}),(0,m.jsx)(d.A,{children:(0,m.jsx)("p",{dangerouslySetInnerHTML:{__html:t}})}),(0,m.jsxs)(h.A,{children:[(0,m.jsx)(u.A,{color:"secondary",onClick:this.props.toggleDialog,children:(0,p.AP)("Cancel")}),(0,m.jsx)(u.A,{color:"primary",onClick:this.submit,children:(0,p.AP)("Submit")})]})]})}}])}(o.Component);t.A=f},33e3:function(e,t,n){"use strict";n.d(t,{A:function(){return P}});var r=n(23029),i=n(92901),s=n(39874),a=n(85501),o=n(9950),l=n(58195),c=n(14113),d=n(99308),h=n(59051),u=n.n(h),g=n(40326),p=n(97011),m=n(65604),f=n(81446),x=n(44414),v=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,s.A)(this,t,[e])).state={isLoading:!0,errorMsg:""},n}return(0,a.A)(t,e),(0,i.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.repoID,r=t.commitID;p.e.getCommitDetails(n,r).then((function(t){e.setState({isLoading:!1,errorMsg:"",commitDetails:t.data})})).catch((function(t){var n=m.Aq.getErrorMsg(t);e.setState({isLoading:!1,errorMsg:n})}))}},{key:"render",value:function(){var e=this.props,t=e.toggleDialog,n=e.commitTime;return(0,x.jsxs)(l.A,{isOpen:!0,centered:!0,toggle:t,children:[(0,x.jsx)(c.A,{toggle:t,children:(0,g.AP)("Modification Details")}),(0,x.jsxs)(d.A,{children:[(0,x.jsx)("p",{className:"small",children:u()(n).format("YYYY-MM-DD HH:mm:ss")}),(0,x.jsx)(A,{data:this.state})]})]})}}])}(o.Component),A=function(e){function t(){var e;(0,r.A)(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=(0,s.A)(this,t,[].concat(i))).renderDetails=function(e){for(var t=[{type:"new",title:(0,g.AP)("New files")},{type:"removed",title:(0,g.AP)("Deleted files")},{type:"renamed",title:(0,g.AP)("Renamed or Moved files")},{type:"modified",title:(0,g.AP)("Modified files")},{type:"newdir",title:(0,g.AP)("New directories")},{type:"deldir",title:(0,g.AP)("Deleted directories")}],n=!0,r=0,i=t.length;r<i;r++)if(e[t[r].type].length){n=!1;break}return n?(0,x.jsx)("p",{children:e.cmt_desc}):(0,x.jsx)(o.Fragment,{children:t.map((function(t,n){return e[t.type].length?(0,x.jsxs)(o.Fragment,{children:[(0,x.jsx)("h6",{children:t.title}),(0,x.jsx)("ul",{children:e[t.type].map((function(e,t){return(0,x.jsx)("li",{dangerouslySetInnerHTML:{__html:e},className:"commit-detail-item text-truncate"},t)}))})]},n):null}))})},e}return(0,a.A)(t,e),(0,i.A)(t,[{key:"render",value:function(){var e=this.props.data,t=e.isLoading,n=e.errorMsg,r=e.commitDetails;return t?(0,x.jsx)(f.A,{}):n?(0,x.jsx)("p",{className:"error mt-4 text-center",children:n}):this.renderDetails(r)}}])}(o.Component),P=v},81617:function(e,t,n){"use strict";var r=n(23029),i=n(92901),s=n(39874),a=n(85501),o=n(9950),l=n(58195),c=n(14113),d=n(99308),h=n(19247),u=n(76152),g=n(55627),p=n(85077),m=n(76115),f=n(85907),x=n(18849),v=n(40326),A=n(65604),P=n(44414),y=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,s.A)(this,t,[e])).handleChange=function(e){e.target.value.trim()?n.setState({isSubmitBtnActive:!0}):n.setState({isSubmitBtnActive:!1}),n.setState({childName:e.target.value})},n.handleSubmit=function(){if(n.state.isSubmitBtnActive){var e=n.state.childName,t=(0,A.yS)(e),r=t.isValid,i=t.errMessage;if(r){if(n.props.checkDuplicatedName(e)){var s=(0,v.AP)('The name "{name}" is already taken. Please choose a different name.');return s=s.replace("{name}",A.Aq.HTMLescape(e)),void n.setState({errMessage:s})}n.props.onAddFolder(n.state.parentPath+e)}else n.setState({errMessage:i})}},n.handleKeyDown=function(e){"Enter"===e.key&&(n.handleSubmit(),e.preventDefault())},n.toggle=function(){n.props.addFolderCancel()},n.state={parentPath:"",childName:"",errMessage:"",isSubmitBtnActive:!1},n}return(0,a.A)(t,e),(0,i.A)(t,[{key:"componentDidMount",value:function(){var e=this.props.parentPath;"/"===e[e.length-1]?this.setState({parentPath:e}):this.setState({parentPath:e+"/"})}},{key:"render",value:function(){return(0,P.jsxs)(l.A,{isOpen:!0,toggle:this.toggle,autoFocus:!1,children:[(0,P.jsx)(c.A,{toggle:this.toggle,children:(0,v.AP)("New Folder")}),(0,P.jsxs)(d.A,{children:[(0,P.jsx)(h.A,{children:(0,P.jsxs)(u.A,{children:[(0,P.jsx)(g.A,{for:"folderName",children:(0,v.AP)("Name")}),(0,P.jsx)(p.A,{id:"folderName",value:this.state.childName,onKeyDown:this.handleKeyDown,onChange:this.handleChange,autoFocus:!0})]})}),this.state.errMessage&&(0,P.jsx)(m.A,{color:"danger",className:"mt-2",children:this.state.errMessage})]}),(0,P.jsxs)(f.A,{children:[(0,P.jsx)(x.A,{color:"secondary",onClick:this.toggle,children:(0,v.AP)("Cancel")}),(0,P.jsx)(x.A,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive,children:(0,v.AP)("Submit")})]})]})}}])}(o.Component);t.A=y},61314:function(e,t,n){"use strict";var r=n(23029),i=n(92901),s=n(39874),a=n(85501),o=n(9950),l=n(19260),c=n(6030),d=n(33151),h=n(68879),u=n(40326),g=n(65604),p=n(44414),m=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,s.A)(this,t,[e])).onMenuItemClick=function(e){var t=g.Aq.getEventData(e,"op");n.props.onMenuItemClick(t)},n.onDropdownToggleClick=function(e){n.toggleOperationMenu(e)},n.toggleOperationMenu=function(e){n.setState({isItemMenuShow:!n.state.isItemMenuShow},(function(){n.state.isItemMenuShow?n.props.onFreezedItem():n.props.onUnfreezedItem()}))},n.state={isItemMenuShow:!1},n}return(0,a.A)(t,e),(0,i.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.operations,r=t.translateOperations;return(0,p.jsxs)(l.A,{isOpen:this.state.isItemMenuShow,toggle:this.toggleOperationMenu,children:[(0,p.jsx)(c.A,{tag:"i",className:"d-flex w-5 h-5 align-items-center justify-content-center sf-dropdown-toggle sf3-font sf3-font-more-vertical",title:(0,u.AP)("More operations"),"aria-label":(0,u.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isItemMenuShow}),(0,p.jsx)(d.A,{className:"my-1 mr-2",children:n.map((function(t,n){return(0,p.jsx)(h.A,{"data-op":t,onClick:e.onMenuItemClick,children:r(t)},n)}))})]})}}])}(o.Component);t.A=m},91611:function(e,t,n){"use strict";var r=n(23029),i=n(92901),s=n(39874),a=n(85501),o=n(9950),l=n(58195),c=n(14113),d=n(99308),h=n(85907),u=n(18849),g=n(25328),p=n(40326),m=n(4086),f=n(44414),x=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,s.A)(this,t,[e])).copyToClipboard=function(){(0,g.A)(n.props.link),n.props.toggleDialog(),m.A.success((0,p.AP)("The link is copied to the clipboard."),{duration:2})},n}return(0,a.A)(t,e),(0,i.A)(t,[{key:"render",value:function(){var e=this.props,t=e.link,n=e.toggleDialog;return(0,f.jsxs)(l.A,{isOpen:!0,toggle:n,children:[(0,f.jsx)(c.A,{toggle:n,children:(0,p.AP)("Link")}),(0,f.jsx)(d.A,{children:(0,f.jsx)("a",{href:t,children:t})}),(0,f.jsxs)(h.A,{children:[(0,f.jsx)(u.A,{color:"primary",onClick:this.copyToClipboard,children:(0,p.AP)("Copy")}),(0,f.jsx)(u.A,{color:"secondary",onClick:n,children:(0,p.AP)("Close")})]})]})}}])}(o.Component);t.A=x},43226:function(e,t,n){"use strict";var r=n(23029),i=n(92901),s=n(39874),a=n(85501),o=n(9950),l=n(58195),c=n(14113),d=n(99308),h=n(19247),u=n(76152),g=n(48918),p=n(85077),m=n(30038),f=n(99121),x=n(85907),v=n(18849),A=n(40326),P=n(44414),y=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,s.A)(this,t,[e])).toggle=function(){n.props.toggle()},n.handleQuotaChange=function(e){var t=e.target.value;n.setState({quota:t,isSubmitBtnActive:""!=t.trim()})},n.handleKeyDown=function(e){"Enter"==e.key&&(n.handleSubmit(),e.preventDefault())},n.handleSubmit=function(){n.props.updateQuota(n.state.quota.trim()),n.toggle()},n.state={quota:"",isSubmitBtnActive:!1},n}return(0,a.A)(t,e),(0,i.A)(t,[{key:"render",value:function(){var e=this.state,t=e.quota,n=e.isSubmitBtnActive;return(0,P.jsxs)(l.A,{isOpen:!0,toggle:this.toggle,children:[(0,P.jsx)(c.A,{toggle:this.toggle,children:(0,A.AP)("Set Quota")}),(0,P.jsx)(d.A,{children:(0,P.jsx)(h.A,{children:(0,P.jsxs)(u.A,{children:[(0,P.jsxs)(g.A,{children:[(0,P.jsx)(p.A,{type:"text",className:"form-control",value:t,onKeyDown:this.handleKeyDown,onChange:this.handleQuotaChange}),(0,P.jsx)(m.A,{addonType:"append",children:(0,P.jsx)(f.A,{children:"MB"})})]}),(0,P.jsxs)("p",{className:"small text-secondary mt-2 mb-2",children:[(0,A.AP)("An integer that is greater than or equal to 0."),(0,P.jsx)("br",{}),(0,A.AP)("Tip: 0 means default limit")]})]})})}),(0,P.jsxs)(x.A,{children:[(0,P.jsx)(v.A,{color:"secondary",onClick:this.toggle,children:(0,A.AP)("Cancel")}),(0,P.jsx)(v.A,{color:"primary",onClick:this.handleSubmit,disabled:!n,children:(0,A.AP)("Submit")})]})]})}}])}(o.Component);t.A=y},96763:function(e,t,n){"use strict";var r=n(23029),i=n(92901),s=n(39874),a=n(85501),o=n(9950),l=n(40326),c=n(58195),d=n(14113),h=n(99308),u=n(85907),g=n(18849),p=n(44414),m=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,s.A)(this,t,[e])).handleInputChange=function(e){n.setState({inputChecked:e.target.checked})},n.unlinkDevice=function(){n.props.toggleDialog(),n.props.unlinkDevice(n.state.inputChecked)},n.state={inputChecked:!1},n}return(0,a.A)(t,e),(0,i.A)(t,[{key:"render",value:function(){var e=this.state.inputChecked,t=this.props.toggleDialog;return(0,p.jsxs)(c.A,{isOpen:!0,toggle:t,children:[(0,p.jsx)(d.A,{toggle:t,children:(0,l.AP)("Unlink device")}),(0,p.jsxs)(h.A,{children:[(0,p.jsx)("p",{children:(0,l.AP)("Are you sure you want to unlink this device?")}),l.am&&(0,p.jsxs)("div",{className:"d-flex align-items-center",children:[(0,p.jsx)("input",{id:"delete-files",className:"mr-1",type:"checkbox",checked:e,onChange:this.handleInputChange}),(0,p.jsx)("label",{htmlFor:"delete-files",className:"m-0",children:(0,l.AP)("Delete files from this device the next time it comes online.")})]})]}),(0,p.jsxs)(u.A,{children:[(0,p.jsx)(g.A,{color:"secondary",onClick:t,children:(0,l.AP)("Cancel")}),(0,p.jsx)(g.A,{color:"primary",onClick:this.unlinkDevice,children:(0,l.AP)("Unlink")})]})]})}}])}(o.Component);t.A=m},61655:function(e,t,n){"use strict";var r=n(89379),i=n(23029),s=n(92901),a=n(39874),o=n(85501),l=n(9950),c=n(17119),d=n(70446),h=n.n(d),u=n(58195),g=n(13690),p=n(28321),m=n(40326),f=n(65604),x=n(66945),v=n(49403),A=n(44414),P=function(e){function t(){var e;(0,i.A)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=(0,a.A)(this,t,[].concat(r))).getActiveClass=function(t){return e.props.currentTab==t?"active":""},e}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this;return(0,A.jsxs)("div",{className:"side-panel ".concat(this.props.isSidePanelClosed?"":"left-zero"),children:[(0,A.jsx)("div",{className:"side-panel-north",children:(0,A.jsx)(v.A,{onCloseSidePanel:this.props.onCloseSidePanel})}),(0,A.jsx)("div",{className:"side-panel-center",children:(0,A.jsx)("div",{className:"side-nav",children:(0,A.jsxs)("div",{className:"side-nav-con",children:[(0,A.jsx)("h3",{className:"sf-heading",children:(0,m.AP)("System Admin")}),(0,A.jsxs)("ul",{className:"nav nav-pills flex-column nav-container",children:[m.Tr&&(0,A.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("info")),children:(0,A.jsxs)(g.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("info")),to:m.Yc+"sys/info/",onClick:function(){return e.props.tabItemClick("info")},children:[(0,A.jsx)("span",{className:"sf2-icon-info","aria-hidden":"true"}),(0,A.jsx)("span",{className:"nav-text",children:(0,m.AP)("Info")})]})}),(m.am||!m.Ez)&&m.m$&&(0,A.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("statistic")),children:(0,A.jsxs)(g.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("statistic")),to:m.Yc+"sys/statistics/file/",onClick:function(){return e.props.tabItemClick("statistic")},children:[(0,A.jsx)("span",{className:"sf2-icon-histogram","aria-hidden":"true"}),(0,A.jsx)("span",{className:"nav-text",children:(0,m.AP)("Statistic")})]})}),m.Iw&&(0,A.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("devices")),children:(0,A.jsxs)(g.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("devices")),to:m.Yc+"sys/desktop-devices/",onClick:function(){return e.props.tabItemClick("devices")},children:[(0,A.jsx)("span",{className:"sf2-icon-monitor","aria-hidden":"true"}),(0,A.jsx)("span",{className:"nav-text",children:(0,m.AP)("Devices")})]})}),m.sh&&m.s4&&(0,A.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("web-settings")),children:(0,A.jsxs)(g.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("web-settings")),to:m.Yc+"sys/web-settings/",onClick:function(){return e.props.tabItemClick("web-settings")},children:[(0,A.jsx)("span",{className:"sf2-icon-cog2","aria-hidden":"true"}),(0,A.jsx)("span",{className:"nav-text",children:(0,m.AP)("Settings")})]})}),m.$j&&(0,A.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("libraries")),children:(0,A.jsxs)(g.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("libraries")),to:m.Yc+"sys/all-libraries/",onClick:function(){return e.props.tabItemClick("libraries")},children:[(0,A.jsx)("span",{className:"sf2-icon-library","aria-hidden":"true"}),(0,A.jsx)("span",{className:"nav-text",children:(0,m.AP)("Libraries")})]})}),m.jR&&(0,A.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("users")),children:(0,A.jsxs)(g.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("users")),to:m.Yc+"sys/users/",onClick:function(){return e.props.tabItemClick("users")},children:[(0,A.jsx)("span",{className:"sf2-icon-user","aria-hidden":"true"}),(0,A.jsx)("span",{className:"nav-text",children:(0,m.AP)("Users")})]})}),m.XV&&(0,A.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("groups")),children:(0,A.jsxs)(g.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("groups")),to:m.Yc+"sys/groups/",onClick:function(){return e.props.tabItemClick("groups")},children:[(0,A.jsx)("span",{className:"sf2-icon-group","aria-hidden":"true"}),(0,A.jsx)("span",{className:"nav-text",children:(0,m.AP)("Groups")})]})}),m.am&&m.XV&&(0,A.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("departments")),children:(0,A.jsxs)(g.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("departments")),to:m.Yc+"sys/departments/",onClick:function(){return e.props.tabItemClick("departments")},children:[(0,A.jsx)("span",{className:"sf2-icon-organization","aria-hidden":"true"}),(0,A.jsx)("span",{className:"nav-text",children:(0,m.AP)("Departments")})]})}),m.wA&&m.Iw&&(0,A.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("organizations")),children:(0,A.jsxs)(g.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("organizations")),to:m.Yc+"sys/organizations/",onClick:function(){return e.props.tabItemClick("organizations")},children:[(0,A.jsx)("span",{className:"sf2-icon-organization","aria-hidden":"true"}),(0,A.jsx)("span",{className:"nav-text",children:(0,m.AP)("Organizations")})]})}),m.am&&m.Oq&&m.Iw&&(0,A.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("institutions")),children:(0,A.jsxs)(g.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("institutions")),to:m.Yc+"sys/institutions/",onClick:function(){return e.props.tabItemClick("institutions")},children:[(0,A.jsx)("span",{className:"sf2-icon-organization","aria-hidden":"true"}),(0,A.jsx)("span",{className:"nav-text",children:(0,m.AP)("Institutions")})]})}),m.Iw&&(0,A.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("notifications")),children:(0,A.jsxs)(g.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("notifications")),to:m.Yc+"sys/notifications/",onClick:function(){return e.props.tabItemClick("notifications")},children:[(0,A.jsx)("span",{className:"sf2-icon-msgs","aria-hidden":"true"}),(0,A.jsx)("span",{className:"nav-text",children:(0,m.AP)("Notifications")})]})}),m.Iw&&(0,A.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("links")),children:(0,A.jsxs)(g.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("links")),to:m.Yc+"sys/share-links/",onClick:function(){return e.props.tabItemClick("links")},children:[(0,A.jsx)("span",{className:"sf2-icon-link","aria-hidden":"true"}),(0,A.jsx)("span",{className:"nav-text",children:(0,m.AP)("Links")})]})}),m.w4&&m.ju&&(0,A.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("logs")),children:(0,A.jsxs)(g.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("logs")),to:m.Yc+"sys/logs/login",onClick:function(){return e.props.tabItemClick("logs")},children:[(0,A.jsx)("span",{className:"sf2-icon-clock","aria-hidden":"true"}),(0,A.jsx)("span",{className:"nav-text",children:(0,m.AP)("Logs")})]})}),m.am&&m.Iw&&m.n5&&(0,A.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("file-scan-records")),children:(0,A.jsxs)(g.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("file-scan-records")),to:m.Yc+"sys/file-scan-records/",onClick:function(){return e.props.tabItemClick("file-scan-records")},children:[(0,A.jsx)("span",{className:"sf2-icon-security","aria-hidden":"true"}),(0,A.jsx)("span",{className:"nav-text",children:(0,m.AP)("File Scan")})]})}),m.am&&m.Iw&&(0,A.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("virus-files")),children:(0,A.jsxs)(g.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("virus-files")),to:m.Yc+"sys/virus-files/all/",onClick:function(){return e.props.tabItemClick("virus-files")},children:[(0,A.jsx)("span",{className:"sf2-icon-security","aria-hidden":"true"}),(0,A.jsx)("span",{className:"nav-text",children:(0,m.AP)("Virus Scan")})]})}),m.am&&m.JC&&m.Iw&&(0,A.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("invitations")),children:(0,A.jsxs)(g.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("invitations")),to:m.Yc+"sys/invitations/",onClick:function(){return e.props.tabItemClick("invitations")},children:[(0,A.jsx)("span",{className:"sf2-icon-invite","aria-hidden":"true"}),(0,A.jsx)("span",{className:"nav-text",children:(0,m.AP)("Invitations")})]})}),m.Iw&&m.a8&&(0,A.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("termsandconditions")),children:(0,A.jsxs)(g.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("termsandconditions")),to:m.Yc+"sys/terms-and-conditions/",onClick:function(){return e.props.tabItemClick("termsandconditions")},children:[(0,A.jsx)("span",{className:"sf2-icon-wiki","aria-hidden":"true"}),(0,A.jsx)("span",{className:"nav-text",children:(0,m.AP)("Terms and Conditions")})]})}),m.am&&m.hP&&(0,A.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("adminLogs")),children:(0,A.jsxs)(g.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("adminLogs")),to:m.Yc+"sys/admin-logs/operation",onClick:function(){return e.props.tabItemClick("adminLogs")},children:[(0,A.jsx)("span",{className:"sf2-icon-admin-log","aria-hidden":"true"}),(0,A.jsx)("span",{className:"nav-text",children:(0,m.AP)("Admin Logs")})]})}),m.Iw&&m.Lp&&(0,A.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("work-weixin")),children:(0,A.jsxs)(g.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("work-weixin")),to:m.Yc+"sys/work-weixin/",onClick:function(){return e.props.tabItemClick("work-weixin")},children:[(0,A.jsx)("span",{className:"sf3-font-enterprise-wechat sf3-font","aria-hidden":"true"}),(0,A.jsx)("span",{className:"nav-text",children:"\u4f01\u4e1a\u5fae\u4fe1\u96c6\u6210"})]})}),m.Iw&&m.MT&&(0,A.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("dingtalk")),children:(0,A.jsxs)(g.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("dingtalk")),to:m.Yc+"sys/dingtalk/",onClick:function(){return e.props.tabItemClick("dingtalk")},children:[(0,A.jsx)("span",{className:"sf3-font-dingtalk sf3-font","aria-hidden":"true"}),(0,A.jsx)("span",{className:"nav-text",children:"\u9489\u9489\u96c6\u6210"})]})}),m.Iw&&m.DY&&(0,A.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("abuse-reports")),children:(0,A.jsxs)(g.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("abuse-reports")),to:m.Yc+"sys/abuse-reports/",onClick:function(){return e.props.tabItemClick("abuse-reports")},children:[(0,A.jsx)("span",{className:"sf2-icon-monitor","aria-hidden":"true"}),(0,A.jsx)("span",{className:"nav-text",children:(0,m.AP)("Abuse Reports")})]})})]})]})})})]})}}])}(l.Component),y=P,b=function(e){function t(){return(0,i.A)(this,t),(0,a.A)(this,t,arguments)}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){return(0,A.jsx)("div",{className:"main-panel",children:this.props.children})}}])}(l.Component),j=b,S=n(18849),D=n(97011),w=n(4086),I=n(81446),k=n(32043),_=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).uploadLicenseFile=function(e){if(n.fileInput.current.files.length){var t=n.fileInput.current.files[0];D.e.sysAdminUploadLicense(t).then((function(e){var t=n.state.sysInfo;Object.assign(t,e.data,{with_license:!0}),n.setState({sysInfo:t})})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))}},n.openFileInput=function(){n.fileInput.current.click()},n.renderLicenseDescString=function(e,t,n){return"life-time"==e?"zh-cn"==window.app.config.lang?"\u6c38\u4e45\u6388\u6743\u7ed9 "+t+"\uff0c\u6280\u672f\u652f\u6301\u670d\u52a1\u81f3 "+n+" \u5230\u671f":(0,m.AP)("licensed to {placeholder_license_to}, upgrade service expired in {placeholder_license_expiration}").replace("{placeholder_license_to}",t).replace("{placeholder_license_expiration}",n):(0,m.AP)("licensed to {placeholder_license_to}, expires on {placeholder_license_expiration}").replace("{placeholder_license_to}",t).replace("{placeholder_license_expiration}",n)},n.state={loading:!0,errorMsg:"",sysInfo:{}},n.fileInput=l.createRef(),n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this;D.e.sysAdminGetSysInfo().then((function(t){e.setState({loading:!1,sysInfo:t.data})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this.state.sysInfo,t=e.license_mode,n=e.license_to,i=e.license_expiration,s=e.org_count,a=e.repos_count,o=e.total_files_count,c=e.total_storage,d=e.total_devices_count,h=e.current_connected_devices_count,u=e.license_maxusers,g=e.multi_tenancy_enabled,p=e.active_users_count,x=e.users_count,v=e.groups_count,P=e.with_license,y=this.state,b=y.loading,j=y.errorMsg;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)({},this.props)),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container system-admin-info",children:[(0,A.jsx)("div",{className:"cur-view-path",children:(0,A.jsx)("h3",{className:"sf-heading",children:(0,m.AP)("Info")})}),(0,A.jsxs)("div",{className:"cur-view-content",children:[b&&(0,A.jsx)(I.A,{}),j&&(0,A.jsx)("p",{className:"error text-center mt-4",children:j}),!b&&!j&&(0,A.jsxs)("dl",{className:"flex-1 m-0",children:[(0,A.jsx)("dt",{className:"info-item-heading",children:(0,m.AP)("System Info")}),m.am?(0,A.jsxs)("dd",{className:"info-item-content",children:[(0,m.AP)("Professional Edition"),P&&" "+this.renderLicenseDescString(t,n,i),(0,A.jsx)("br",{}),m.gv&&(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(S.A,{type:"button",className:"mt-2",onClick:this.openFileInput,children:(0,m.AP)("Upload license")}),(0,A.jsx)("input",{className:"d-none",type:"file",onChange:this.uploadLicenseFile,ref:this.fileInput})]})]}):(0,A.jsxs)("dd",{className:"info-item-content",children:[(0,m.AP)("Community Edition"),(0,A.jsx)("a",{className:"ml-1",href:"https://download.seafile.com/published/seafile-manual/deploy_pro/migrate_from_seafile_community_server.md",target:"_blank",rel:"noreferrer",children:(0,m.AP)("Upgrade to Pro Edition")})]}),(0,A.jsx)("dt",{className:"info-item-heading",children:(0,m.AP)("Version")}),(0,A.jsx)("dd",{className:"info-item-content",children:m.si}),(0,A.jsxs)("dt",{className:"info-item-heading",children:[(0,m.AP)("Libraries")," / ",(0,m.AP)("Files")]}),(0,A.jsxs)("dd",{className:"info-item-content",children:[a," / ",o]}),(0,A.jsx)("dt",{className:"info-item-heading",children:(0,m.AP)("Storage Used")}),(0,A.jsx)("dd",{className:"info-item-content",children:f.Aq.bytesToSize(c)}),(0,A.jsxs)("dt",{className:"info-item-heading",children:[(0,m.AP)("Total Devices")," / ",(0,m.AP)("Current Connected Devices")]}),(0,A.jsxs)("dd",{className:"info-item-content",children:[d," / ",h]}),m.am?(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("dt",{className:"info-item-heading",children:[(0,m.AP)("Activated Users")," / ",(0,m.AP)("Total Users")," / ",(0,m.AP)("Limits")]}),(0,A.jsxs)("dd",{className:"info-item-content",children:[p," / ",x," / ",P?u:"--"]})]}):(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("dt",{className:"info-item-heading",children:[(0,m.AP)("Activated Users")," / ",(0,m.AP)("Total Users")]}),(0,A.jsxs)("dd",{className:"info-item-content",children:[p," / ",x]})]}),(0,A.jsx)("dt",{className:"info-item-heading",children:(0,m.AP)("Groups")}),(0,A.jsx)("dd",{className:"info-item-content",children:v}),g&&(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)("dt",{className:"info-item-heading",children:(0,m.AP)("Organizations")}),(0,A.jsx)("dd",{className:"info-item-content",children:s})]})]})]})]})})]})}}])}(l.Component),N=_,M=n(59051),C=n.n(M),O=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).navItems=[{name:"fileStatistic",urlPart:"statistics/file",text:(0,m.AP)("File")},{name:"storageStatistic",urlPart:"statistics/storage",text:(0,m.AP)("Storage")},{name:"usersStatistic",urlPart:"statistics/user",text:(0,m.AP)("Users")},{name:"trafficStatistic",urlPart:"statistics/traffic",text:(0,m.AP)("Traffic")},{name:"reportsStatistic",urlPart:"statistics/reports",text:(0,m.AP)("Reports")}],n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.currentItem;return(0,A.jsx)("div",{className:"cur-view-path tab-nav-container",children:(0,A.jsx)("ul",{className:"nav",children:this.navItems.map((function(t,n){return(0,A.jsx)("li",{className:"nav-item",children:(0,A.jsx)(g.N_,{to:"".concat(m.Yc,"sys/").concat(t.urlPart,"/"),className:"nav-link".concat(e==t.name?" active":""),children:t.text})},n)}))})})}}])}(l.Component),L=n(64467),T=n(87143),F=n(86547),R=n.n(F),E=n(81139),U=(n(19617),"YYYY-MM-DD"),z=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).defaultCalendarValue=null,n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=window.app.config.lang;this.defaultCalendarValue=C()().locale(e).clone()}},{key:"render",value:function(){var e=this.props,t=(0,A.jsx)(T.default,{defaultValue:this.defaultCalendarValue,disabledDate:e.disabledDate,format:U,locale:(0,E.r)()});return(0,A.jsx)(R(),{calendar:t,value:e.value,onChange:e.onChange,children:function(e){var t=e.value;return(0,A.jsx)("span",{children:(0,A.jsx)("input",{placeholder:"yyyy-mm-dd",tabIndex:"-1",readOnly:!0,value:t&&t.format(U)||"",className:"form-control system-statistic-input"})})}})}}])}(l.Component),B=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).changeActive=function(e){if(n.state.statisticType!==e){var t,r=C()().format("YYYY-MM-DD 00:00:00");switch(e){case"oneWeek":t=C()().subtract(6,"d").format("YYYY-MM-DD 00:00:00");break;case"oneMonth":t=C()().subtract(29,"d").format("YYYY-MM-DD 00:00:00");break;case"oneYear":t=C()().subtract(364,"d").format("YYYY-MM-DD 00:00:00")}n.setState({statisticType:e});n.props.getActiviesFiles(t,r,"day")}},n.disabledStartDate=function(e){if(!e)return!1;var t=C()().format(),r=n.state.endValue;return r?r.isBefore(e)||C()(e).format()>t:t<C()(e).format()},n.disabledEndDate=function(e){if(!e)return!1;var t=C()().format(),r=n.state.startValue;return r?e.isBefore(r)||C()(e).format()>t:t<C()(e).format()},n.onChange=function(e,t){n.setState((0,L.default)({},e,t))},n.onSubmit=function(){var e=n.state,t=e.startValue,r=e.endValue;if(t&&r){n.setState({statisticType:"itemButton"});var i=C()(t).format("YYYY-MM-DD 00:00:00"),s=C()(r).format("YYYY-MM-DD 00:00:00");n.props.getActiviesFiles(i,s,"day")}},n.state={statisticType:"oneWeek",startValue:null,endValue:null},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=C()().format("YYYY-MM-DD 00:00:00"),t=C()().subtract(6,"d").format("YYYY-MM-DD 00:00:00");this.props.getActiviesFiles(t,e,"day")}},{key:"render",value:function(){var e=this.state,t=e.statisticType,n=e.endValue,r=e.startValue;return(0,A.jsxs)(l.Fragment,{children:[this.props.children,(0,A.jsxs)("div",{className:"system-statistic-time-range",children:[(0,A.jsxs)("div",{className:"sys-stat-tool",children:[(0,A.jsx)("div",{className:"system-statistic-item border-right-0 rounded-left ".concat("oneWeek"===t?"item-active":""),onClick:this.changeActive.bind(this,"oneWeek"),children:(0,m.AP)("7 Days")}),(0,A.jsx)("div",{className:"system-statistic-item border-right-0 ".concat("oneMonth"===t?"item-active":""),onClick:this.changeActive.bind(this,"oneMonth"),children:(0,m.AP)("30 Days")}),(0,A.jsx)("div",{className:"system-statistic-item rounded-right ".concat("oneYear"===t?"item-active":""),onClick:this.changeActive.bind(this,"oneYear"),children:(0,m.AP)("1 Year")})]}),(0,A.jsxs)("div",{className:"system-statistic-input-container",children:[(0,A.jsx)(z,{disabledDate:this.disabledStartDate,value:r,onChange:this.onChange.bind(this,"startValue")}),(0,A.jsx)("span",{className:"system-statistic-connect",children:"-"}),(0,A.jsx)(z,{disabledDate:this.disabledEndDate,value:n,onChange:this.onChange.bind(this,"endValue")}),(0,A.jsx)(S.A,{color:"primary",className:"operation-item system-statistic-button",onClick:this.onSubmit,children:(0,m.AP)("Submit")})]})]})]})}}])}(l.Component),q=n(60780),Y=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).titleCallback=function(e,t){return t.datasets[e.datasetIndex].label+": "+f.Aq.bytesToSize(e.yLabel)},n.ticksCallback=function(e,t,n){return f.Aq.bytesToSize(e)},n.state={data:{},opations:{}},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.labels,n=e.filesData,r=e.isTitleCallback,i=e.isTicksCallback,s=e.suggestedMaxNumbers,a=e.isLegendStatus,o=e.chartTitle,l=this,c={labels:t,datasets:n},d={title:{display:!0,fontSize:14,text:o},elements:{line:{fill:!1,tension:0,borderWidth:2}},legend:{display:a,labels:{usePointStyle:!0}},tooltips:{callbacks:{label:function(e,t){return r?l.titleCallback(e,t):t.datasets[e.datasetIndex].label+": "+e.yLabel}}},layout:{padding:{right:100}},scales:{yAxes:[{ticks:{beginAtZero:!0,suggestedMax:s,callback:function(e,t,n){return i?l.ticksCallback(e,t,n):e}}}],xAxes:[{ticks:{maxTicksLimit:20}}]}};this.setState({data:c,options:d})}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t={labels:e.labels,datasets:e.filesData};this.setState({data:t})}},{key:"render",value:function(){var e=this.state,t=e.data,n=e.options;return(0,A.jsx)(q.N1,{data:t,options:n})}}])}(l.Component),V=(n(63864),function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).getActiviesFiles=function(e,t,r){var i=n.state.filesData;D.e.sysAdminStatisticFiles(e,t,r).then((function(e){var t=[],r=[],s=[],a=[],o=[],l=e.data;if(Array.isArray(l)){l.forEach((function(e){t.push(C()(e.datetime).format("YYYY-MM-DD")),r.push(e.added),s.push(e.deleted),o.push(e.modified),a.push(e.visited)}));var c={label:(0,m.AP)("Added"),data:r,borderColor:"#57cd6b",backgroundColor:"#57cd6b"},d={label:(0,m.AP)("Visited"),data:a,borderColor:"#fd913a",backgroundColor:"#fd913a"},h={label:(0,m.AP)("Modified"),data:o,borderColor:"#72c3fc",backgroundColor:"#72c3fc"},u={label:(0,m.AP)("Deleted"),data:s,borderColor:"#f75356",backgroundColor:"#f75356"};i=[d,c,h,u]}n.setState({filesData:i,labels:t,isLoading:!1})})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.state={filesData:[],labels:[],isLoading:!0},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.state,t=e.labels,n=e.filesData,i=e.isLoading;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)({},this.props)),(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)(O,{currentItem:"fileStatistic"}),(0,A.jsxs)("div",{className:"cur-view-content",children:[(0,A.jsx)(B,{getActiviesFiles:this.getActiviesFiles}),i&&(0,A.jsx)(I.A,{}),!i&&t.length>0&&(0,A.jsx)(Y,{labels:t,filesData:n,suggestedMaxNumbers:10,isLegendStatus:!0,chartTitle:(0,m.AP)("File Operations")})]})]})]})}}])}(l.Component)),H=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).getActiviesFiles=function(e,t,r){var i=n.state.filesData;D.e.sysAdminStatisticStorages(e,t,r).then((function(e){var t=[],r=[],s=e.data;if(Array.isArray(s)){s.forEach((function(e){t.push(C()(e.datetime).format("YYYY-MM-DD")),r.push(e.total_storage)}));var a={label:(0,m.AP)("Total Storage"),data:r,borderColor:"#fd913a",backgroundColor:"#fd913a"};i=[a]}n.setState({filesData:i,labels:t,isLoading:!1})})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.state={filesData:[],labels:[],isLoading:!0},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.state,t=e.labels,n=e.filesData,i=e.isLoading;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)({},this.props)),(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)(O,{currentItem:"storageStatistic"}),(0,A.jsxs)("div",{className:"cur-view-content",children:[(0,A.jsx)(B,{getActiviesFiles:this.getActiviesFiles}),i&&(0,A.jsx)(I.A,{}),!i&&t.length>0&&(0,A.jsx)(Y,{labels:t,filesData:n,suggestedMaxNumbers:1e7,isTitleCallback:!0,isTicksCallback:!0,isLegendStatus:!1,chartTitle:(0,m.AP)("Total Storage")})]})]})]})}}])}(l.Component),W=n(85077),G=function(e){function t(e){return(0,i.A)(this,t),(0,a.A)(this,t,[e])}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props,t=e.type,n=e.sortBy,r="asc"==e.sortOrder?(0,A.jsx)("span",{className:"sf3-font sf3-font-down rotate-180 d-inline-block"}):(0,A.jsx)("span",{className:"sf3-font sf3-font-down"});return(0,A.jsxs)("table",{className:"table-hover",children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"16%",children:"user"==t?(0,m.AP)("User"):(0,m.AP)("Organization")}),(0,A.jsx)("th",{width:"11%",children:(0,A.jsxs)("div",{className:"d-block table-sort-op cursor-pointer",onClick:this.props.sortItems.bind(this,"sync_file_upload"),children:[(0,m.AP)("Sync Upload")," ","sync_file_upload"===n&&r]})}),(0,A.jsx)("th",{width:"14%",children:(0,A.jsxs)("div",{className:"d-block table-sort-op cursor-pointer",onClick:this.props.sortItems.bind(this,"sync_file_download"),children:[(0,m.AP)("Sync Download")," ","sync_file_download"===n&&r]})}),(0,A.jsx)("th",{width:"11%",children:(0,A.jsxs)("div",{className:"d-block table-sort-op cursor-pointer",onClick:this.props.sortItems.bind(this,"web_file_upload"),children:[(0,m.AP)("Web Upload")," ","web_file_upload"===n&&r]})}),(0,A.jsx)("th",{width:"14%",children:(0,A.jsxs)("div",{className:"d-block table-sort-op cursor-pointer",onClick:this.props.sortItems.bind(this,"web_file_download"),children:[(0,m.AP)("Web Download")," ","web_file_download"===n&&r]})}),(0,A.jsx)("th",{width:"17%",children:(0,A.jsxs)("div",{className:"d-block table-sort-op cursor-pointer",onClick:this.props.sortItems.bind(this,"link_file_upload"),children:[(0,m.AP)("Share link upload")," ","link_file_upload"===n&&r]})}),(0,A.jsx)("th",{width:"17%",children:(0,A.jsxs)("div",{className:"d-block table-sort-op cursor-pointer",onClick:this.props.sortItems.bind(this,"link_file_download"),children:[(0,m.AP)("Share link download")," ","link_file_download"===n&&r]})})]})}),(0,A.jsx)("tbody",{children:this.props.children})]})}}])}(l.Component),Q=function(e){function t(){var e;(0,i.A)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=(0,a.A)(this,t,[].concat(r))).trafficName=function(){var t=e.props,n=t.userTrafficItem;switch(t.type){case"user":return n.name?(0,A.jsx)("a",{href:m.Yc+"sys/users/"+n.email+"/",children:n.name}):(0,A.jsx)("span",{children:"--"});case"org":return(0,A.jsx)("span",{children:n.org_name})}},e}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.userTrafficItem,t=f.Aq.bytesToSize(e.sync_file_upload),n=f.Aq.bytesToSize(e.sync_file_download),r=f.Aq.bytesToSize(e.web_file_upload),i=f.Aq.bytesToSize(e.web_file_download),s=f.Aq.bytesToSize(e.link_file_upload),a=f.Aq.bytesToSize(e.link_file_download);return(0,A.jsxs)("tr",{children:[(0,A.jsx)("td",{children:this.trafficName()}),(0,A.jsx)("td",{children:t}),(0,A.jsx)("td",{children:n}),(0,A.jsx)("td",{children:r}),(0,A.jsx)("td",{children:i}),(0,A.jsx)("td",{children:s}),(0,A.jsx)("td",{children:a})]})}}])}(l.Component),K=Q,X=n(62376),$=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).getPreviousPage=function(){n.getTrafficList(n.state.month,n.state.currentPage-1)},n.getNextPage=function(){n.getTrafficList(n.state.month,n.state.currentPage+1)},n.handleChange=function(e){var t=e.target.value;n.setState({month:t})},n.handleKeyPress=function(e){var t=n.state.month;if("Enter"===e.key){if(!/^([012]\d{3})(0[1-9]|1[012])$/.test(t)){var r=(0,m.AP)("Invalid month, should be yyyymm.");return void n.setState({errorMessage:r})}n.getTrafficList(t,n.initPage),e.target.blur(),e.preventDefault()}},n.getTrafficList=function(e,t){var r=n.state,i=r.perPage,s=r.sortBy,a=r.sortOrder,o="asc"==a?s:"".concat(s,"_").concat(a);n.setState({isLoading:!0,errorMessage:""}),D.e.sysAdminListOrgTraffic(e,t,i,o).then((function(r){var i=r.data.org_monthly_traffic_list.slice(0);n.setState({month:e,currentPage:t,orgTrafficList:i,hasNextPage:r.data.has_next_page,isLoading:!1})})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.sortItems=function(e){n.setState({sortBy:e,sortOrder:"asc"==n.state.sortOrder?"desc":"asc"},(function(){var e=n.state,t=e.month,r=e.currentPage;n.getTrafficList(t,r)}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){return n.getTrafficList(n.initPage,n.initMonth)}))},n.state={orgTrafficList:[],perPage:25,currentPage:1,hasNextPage:!1,month:C()().format("YYYYMM"),isLoading:!1,errorMessage:"",sortBy:"link_file_download",sortOrder:"desc"},n.initPage=1,n.initMonth=C()().format("YYYYMM"),n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,r=n.currentPage,i=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||i),currentPage:parseInt(t.get("page")||r)},(function(){e.getTrafficList(e.initMonth,e.state.currentPage)}))}},{key:"render",value:function(){var e=this.state,t=e.isLoading,n=e.errorMessage,r=e.orgTrafficList,i=e.currentPage,s=e.hasNextPage,a=e.perPage,o=e.sortBy,c=e.sortOrder;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("div",{className:"d-flex align-items-center mt-4",children:[(0,A.jsx)("span",{className:"statistic-reports-tip",children:(0,m.AP)("Month:")}),(0,A.jsx)(W.A,{className:"statistic-reports-input",defaultValue:C()().format("YYYYMM"),onChange:this.handleChange,onKeyPress:this.handleKeyPress}),n&&(0,A.jsx)("div",{className:"error",children:n})]}),t&&(0,A.jsx)(I.A,{}),!t&&(0,A.jsx)(G,{type:"org",sortItems:this.sortItems,sortBy:o,sortOrder:c,children:r.length>0&&r.map((function(e,t){return(0,A.jsx)(K,{userTrafficItem:e,type:"org"},t)}))}),(0,A.jsx)(X.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:i,hasNextPage:s,curPerPage:a,resetPerPage:this.resetPerPage})]})}}])}(l.Component),Z=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).getPreviousPage=function(){n.getTrafficList(n.state.month,n.state.currentPage-1)},n.getNextPage=function(){n.getTrafficList(n.state.month,n.state.currentPage+1)},n.handleChange=function(e){var t=e.target.value;n.setState({month:t})},n.handleKeyPress=function(e){var t=n.state.month;if("Enter"===e.key){if(!/^([012]\d{3})(0[1-9]|1[012])$/.test(t)){var r=(0,m.AP)("Invalid month, should be yyyymm.");return void n.setState({errorMessage:r})}n.getTrafficList(t,n.initPage),e.target.blur(),e.preventDefault()}},n.getTrafficList=function(e,t){var r=n.state,i=r.perPage,s=r.sortBy,a=r.sortOrder,o="asc"==a?s:"".concat(s,"_").concat(a);n.setState({isLoading:!0,errorMessage:""}),D.e.sysAdminListUserTraffic(e,t,i,o).then((function(r){var i=r.data.user_monthly_traffic_list.slice(0);n.setState({month:e,currentPage:t,userTrafficList:i,hasNextPage:r.data.has_next_page,isLoading:!1})})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.sortItems=function(e){n.setState({sortBy:e,sortOrder:"asc"==n.state.sortOrder?"desc":"asc"},(function(){var e=n.state,t=e.month,r=e.currentPage;n.getTrafficList(t,r)}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){return n.getTrafficList(n.initMonth,n.initPage)}))},n.state={userTrafficList:[],hasNextPage:!1,perPage:25,currentPage:1,month:C()().format("YYYYMM"),isLoading:!1,errorMessage:"",sortBy:"link_file_download",sortOrder:"desc"},n.initPage=1,n.initMonth=C()().format("YYYYMM"),n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,r=n.currentPage,i=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||i),currentPage:parseInt(t.get("page")||r)},(function(){e.getTrafficList(e.initMonth,e.state.currentPage)}))}},{key:"render",value:function(){var e=this.state,t=e.isLoading,n=e.errorMessage,r=e.userTrafficList,i=e.currentPage,s=e.hasNextPage,a=e.perPage,o=e.sortBy,c=e.sortOrder;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("div",{className:"d-flex align-items-center mt-4",children:[(0,A.jsx)("span",{className:"statistic-reports-tip",children:(0,m.AP)("Month:")}),(0,A.jsx)(W.A,{className:"statistic-reports-input",defaultValue:C()().format("YYYYMM"),onChange:this.handleChange,onKeyPress:this.handleKeyPress}),n&&(0,A.jsx)("div",{className:"error",children:n})]}),t&&(0,A.jsx)(I.A,{}),!t&&(0,A.jsx)(G,{type:"user",sortItems:this.sortItems,sortBy:o,sortOrder:c,children:r.length>0&&r.map((function(e,t){return(0,A.jsx)(K,{userTrafficItem:e,type:"user"},t)}))}),(0,A.jsx)(X.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:i,hasNextPage:s,curPerPage:a,resetPerPage:this.resetPerPage})]})}}])}(l.Component),J=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).changeTabActive=function(e){n.setState({tabActive:e})},n.getActiviesFiles=function(e,t,r){D.e.sysAdminStatisticTraffic(e,t,r).then((function(e){var t=[],r=[],i=[],s=[],a=[],o=[],l=[],c=[],d=[],h=e.data;if(Array.isArray(h)){h.forEach((function(e){t.push(C()(e.datetime).format("YYYY-MM-DD")),s.push(e["link-file-upload"]),a.push(e["link-file-download"]),o.push(e["sync-file-upload"]),l.push(e["sync-file-download"]),c.push(e["web-file-upload"]),d.push(e["web-file-download"]),r.push(e["link-file-upload"]+e["sync-file-upload"]+e["web-file-upload"]),i.push(e["link-file-download"]+e["sync-file-download"]+e["web-file-download"])}));var u=[{label:(0,m.AP)("Upload"),data:s,borderColor:"#fd913a",backgroundColor:"#fd913a"},{label:(0,m.AP)("Download"),data:a,borderColor:"#57cd6b",backgroundColor:"#57cd6b"}],g=[{label:(0,m.AP)("Upload"),data:o,borderColor:"#fd913a",backgroundColor:"#fd913a"},{label:(0,m.AP)("Download"),data:l,borderColor:"#57cd6b",backgroundColor:"#57cd6b"}],p=[{label:(0,m.AP)("Upload"),data:c,borderColor:"#fd913a",backgroundColor:"#fd913a"},{label:(0,m.AP)("Download"),data:d,borderColor:"#57cd6b",backgroundColor:"#57cd6b"}],f=[{label:(0,m.AP)("Upload"),data:r,borderColor:"#fd913a",backgroundColor:"#fd913a"},{label:(0,m.AP)("Download"),data:i,borderColor:"#57cd6b",backgroundColor:"#57cd6b"}];n.setState({linkData:u,syncData:g,webData:p,filesData:f,labels:t,isLoading:!1})}})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.renderCommonTool=function(){var e=n.state.tabActive;return"system"===e?(0,A.jsx)(B,{getActiviesFiles:n.getActiviesFiles,children:(0,A.jsxs)("div",{className:"statistic-traffic-tab",children:[(0,A.jsx)("div",{className:"statistic-traffic-tab-item ".concat("system"===e?"active":""),onClick:n.changeTabActive.bind(n,"system"),children:(0,m.AP)("System")}),(0,A.jsx)("div",{className:"statistic-traffic-tab-item ".concat("user"===e?"active":""),onClick:n.changeTabActive.bind(n,"user"),children:(0,m.AP)("Users")}),(0,A.jsx)("div",{className:"statistic-traffic-tab-item ".concat("organizations"===e?"active":""),onClick:n.changeTabActive.bind(n,"organizations"),children:(0,m.AP)("Organizations")})]})}):(0,A.jsxs)("div",{className:"statistic-traffic-tab",children:[(0,A.jsx)("div",{className:"statistic-traffic-tab-item ".concat("system"===e?"active":""),onClick:n.changeTabActive.bind(n,"system"),children:(0,m.AP)("System")}),(0,A.jsx)("div",{className:"statistic-traffic-tab-item ".concat("user"===e?"active":""),onClick:n.changeTabActive.bind(n,"user"),children:(0,m.AP)("Users")}),(0,A.jsx)("div",{className:"statistic-traffic-tab-item ".concat("organizations"===e?"active":""),onClick:n.changeTabActive.bind(n,"organizations"),children:(0,m.AP)("Organizations")})]})},n.state={filesData:[],linkData:[],syncData:[],webData:[],labels:[],isLoading:!0,tabActive:"system"},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.state,t=e.labels,n=e.filesData,i=e.linkData,s=e.syncData,a=e.webData,o=e.isLoading,c=e.tabActive;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)({},this.props)),(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)(O,{currentItem:"trafficStatistic"}),(0,A.jsxs)("div",{className:"cur-view-content",children:[this.renderCommonTool(),o&&(0,A.jsx)(I.A,{}),!o&&"system"===c&&(0,A.jsxs)("div",{className:"statistic-traffic-chart-container",children:[(0,A.jsx)("div",{className:"mb-4",children:t.length>0&&(0,A.jsx)(Y,{labels:t,filesData:n,chartTitle:(0,m.AP)("Total Traffic"),suggestedMaxNumbers:1e7,isTitleCallback:!0,isTicksCallback:!0,isLegendStatus:!0})}),(0,A.jsx)("div",{className:"mb-4",children:t.length>0&&(0,A.jsx)(Y,{labels:t,filesData:a,chartTitle:(0,m.AP)("Web Traffic"),suggestedMaxNumbers:1e7,isTitleCallback:!0,isTicksCallback:!0,isLegendStatus:!0})}),(0,A.jsx)("div",{className:"mb-4",children:t.length>0&&(0,A.jsx)(Y,{labels:t,filesData:i,chartTitle:(0,m.AP)("Share Link Traffic"),suggestedMaxNumbers:1e7,isTitleCallback:!0,isTicksCallback:!0,isLegendStatus:!0})}),(0,A.jsx)("div",{className:"mb-4",children:t.length>0&&(0,A.jsx)(Y,{labels:t,filesData:s,chartTitle:(0,m.AP)("Sync Traffic"),suggestedMaxNumbers:1e7,isTitleCallback:!0,isTicksCallback:!0,isLegendStatus:!0})})]}),!o&&"user"===c&&(0,A.jsx)(Z,{}),!o&&"organizations"===c&&(0,A.jsx)($,{})]})]})]})}}])}(l.Component),ee=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).getActiviesFiles=function(e,t,r){var i=n.state.filesData;D.e.sysAdminStatisticActiveUsers(e,t,r).then((function(e){var t=[],r=[],s=e.data;if(Array.isArray(s)){s.forEach((function(e){t.push(C()(e.datetime).format("YYYY-MM-DD")),r.push(e.count)}));var a={label:(0,m.AP)("Active Users"),data:r,borderColor:"#fd913a",backgroundColor:"#fd913a"};i=[a]}n.setState({filesData:i,labels:t,isLoading:!1})})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.state={filesData:[],labels:[],isLoading:!0},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.state,t=e.labels,n=e.filesData,i=e.isLoading;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)({},this.props)),(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)(O,{currentItem:"usersStatistic"}),(0,A.jsxs)("div",{className:"cur-view-content",children:[(0,A.jsx)(B,{getActiviesFiles:this.getActiviesFiles}),i&&(0,A.jsx)(I.A,{}),!i&&t.length>0&&(0,A.jsx)(Y,{labels:t,filesData:n,suggestedMaxNumbers:10,isLegendStatus:!1,chartTitle:(0,m.AP)("Active Users")})]})]})]})}}])}(l.Component),te=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleChange=function(e){var t=e.target.value;n.setState({month:t})},n.onGenerateReports=function(e){var t=m.Yc+"api/v2.1/admin/statistics/",r=n.state.month;if(r){if("month"===e){if(!/^([012]\d{3})(0[1-9]|1[012])$/.test(r)){var i=(0,m.AP)("Invalid month, should be yyyymm.");return void n.setState({errorMessage:i})}}switch(e){case"month":t+="system-user-traffic/excel/?month="+r;break;case"storage":t+="system-user-storage/excel/?"}n.setState({errorMessage:""}),window.location.href=t}else{var s=(0,m.AP)("It is required.");n.setState({errorMessage:s})}},n.state={month:C()().format("YYYYMM"),errorMessage:""},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.state.errorMessage;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)({},this.props)),(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)(O,{currentItem:"reportsStatistic"}),(0,A.jsxs)("div",{className:"cur-view-content",children:[(0,A.jsxs)("div",{className:"statistic-reports",children:[(0,A.jsx)("div",{className:"statistic-reports-title",children:(0,m.AP)("Monthly User Traffic")}),(0,A.jsxs)("div",{className:"d-flex align-items-center mt-4",children:[(0,A.jsx)("span",{className:"statistic-reports-tip",children:(0,m.AP)("Month:")}),(0,A.jsx)(W.A,{className:"statistic-reports-input",defaultValue:C()().format("YYYYMM"),onChange:this.handleChange}),(0,A.jsx)(S.A,{className:"statistic-reports-submit operation-item",onClick:this.onGenerateReports.bind(this,"month"),children:(0,m.AP)("Create Report")})]}),e&&(0,A.jsx)("div",{className:"error",children:e})]}),(0,A.jsxs)("div",{className:"statistic-reports",children:[(0,A.jsx)("div",{className:"statistic-reports-title",children:(0,m.AP)("User Storage")}),(0,A.jsx)(S.A,{className:"mt-4 operation-item",onClick:this.onGenerateReports.bind(this,"storage"),children:(0,m.AP)("Create Report")})]})]})]})]})}}])}(l.Component),ne=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).navItems=[{name:"desktop",urlPart:"desktop-devices",text:(0,m.AP)("Desktop")},{name:"mobile",urlPart:"mobile-devices",text:(0,m.AP)("Mobile")}],m.am&&n.navItems.push({name:"errors",urlPart:"device-errors",text:(0,m.AP)("Errors")}),n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.currentItem;return(0,A.jsx)("div",{className:"cur-view-path tab-nav-container",children:(0,A.jsx)("ul",{className:"nav",children:this.navItems.map((function(t,n){return(0,A.jsx)("li",{className:"nav-item",children:(0,A.jsx)(g.N_,{to:"".concat(m.Yc,"sys/").concat(t.urlPart,"/"),className:"nav-link".concat(e==t.name?" active":""),children:t.text})},n)}))})})}}])}(l.Component),re=ne,ie=n(43066),se=n(96763),ae=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).getPreviousPageDevicesList=function(){n.props.getDevicesListByPage(n.props.pageInfo.current_page-1)},n.getNextPageDevicesList=function(){n.props.getDevicesListByPage(n.props.pageInfo.current_page+1)},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg,r=e.items,i=e.pageInfo,s=e.curPerPage;if(t)return(0,A.jsx)(I.A,{});if(n)return(0,A.jsx)("p",{className:"error text-center",children:n});var a=(0,A.jsx)(ie.A,{text:(0,m.AP)("No connected devices")}),o=(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("table",{className:"table-hover",children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"19%",children:(0,m.AP)("User")}),(0,A.jsxs)("th",{width:"19%",children:[(0,m.AP)("Platform")," / ",(0,m.AP)("Version")]}),(0,A.jsx)("th",{width:"19%",children:(0,m.AP)("Device Name")}),(0,A.jsx)("th",{width:"19%",children:(0,m.AP)("IP")}),(0,A.jsx)("th",{width:"19%",children:(0,m.AP)("Last Access")}),(0,A.jsx)("th",{width:"5%"})]})}),(0,A.jsx)("tbody",{children:r.map((function(e,t){return(0,A.jsx)(oe,{item:e},t)}))})]}),(0,A.jsx)(X.A,{gotoPreviousPage:this.getPreviousPageDevicesList,gotoNextPage:this.getNextPageDevicesList,currentPage:i.current_page,hasNextPage:i.has_next_page,curPerPage:s,resetPerPage:this.props.resetPerPage})]});return r.length?o:a}}])}(l.Component),oe=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleMouseOver=function(){n.setState({isOpIconShown:!0})},n.handleMouseOut=function(){n.setState({isOpIconShown:!1})},n.handleUnlink=function(e){e.preventDefault(),n.props.item.is_desktop_client?n.toggleUnlinkDeviceDialog():n.unlinkDevice(!0)},n.toggleUnlinkDeviceDialog=function(){n.setState({isUnlinkDeviceDialogOpen:!n.state.isUnlinkDeviceDialogOpen})},n.unlinkDevice=function(e){var t=n.props.item,r=t.platform,i=t.device_id,s=t.user;D.e.sysAdminUnlinkDevice(r,i,s,e).then((function(e){n.setState({unlinked:!0});var t=(0,m.AP)("Successfully unlinked the device.");w.A.success(t)})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.state={unlinked:!1,isOpIconShown:!1,isUnlinkDeviceDialogOpen:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.item,t=this.state,n=t.unlinked,r=t.isUnlinkDeviceDialogOpen,i=t.isOpIconShown;return n?null:(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("tr",{onMouseEnter:this.handleMouseOver,onMouseLeave:this.handleMouseOut,children:[(0,A.jsx)("td",{children:e.user_name}),(0,A.jsxs)("td",{children:[e.platform," / ",e.client_version]}),(0,A.jsx)("td",{children:e.device_name}),(0,A.jsx)("td",{children:e.last_login_ip}),(0,A.jsx)("td",{children:(0,A.jsx)("span",{title:C()(e.last_accessed).format("llll"),children:C()(e.last_accessed).fromNow()})}),(0,A.jsx)("td",{children:(0,A.jsx)("a",{href:"#",className:"sf3-font-delete1 sf3-font action-icon ".concat(i?"":"invisible"),title:(0,m.AP)("Unlink"),onClick:this.handleUnlink})})]}),r&&(0,A.jsx)(se.A,{unlinkDevice:this.unlinkDevice,toggleDialog:this.toggleUnlinkDeviceDialog})]})}}])}(l.Component),le=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).getDevicesListByPage=function(e){var t=n.props.devicesPlatform,r=n.state.perPage;D.e.sysAdminListDevices(t,e,r).then((function(e){n.setState({devicesData:e.data.devices,pageInfo:e.data.page_info,loading:!1})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){n.getDevicesListByPage(1)}))},n.state={loading:!0,errorMsg:"",devicesData:[],pageInfo:{},perPage:25},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,r=n.currentPage,i=void 0===r?1:r,s=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||s),currentPage:parseInt(t.get("page")||i)},(function(){e.getDevicesListByPage(e.state.currentPage)}))}},{key:"render",value:function(){return(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsx)(ae,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.devicesData,getDevicesListByPage:this.getDevicesListByPage,curPerPage:this.state.perPage,resetPerPage:this.resetPerPage,pageInfo:this.state.pageInfo})})}}])}(l.Component),ce=function(e){function t(e){return(0,i.A)(this,t),(0,a.A)(this,t,[e])}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)({},this.props)),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)(re,{currentItem:"desktop"}),(0,A.jsx)(le,{devicesPlatform:"desktop"})]})})]})}}])}(l.Component),de=function(e){function t(e){return(0,i.A)(this,t),(0,a.A)(this,t,[e])}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)({},this.props)),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)(re,{currentItem:"mobile"}),(0,A.jsx)(le,{devicesPlatform:"mobile"})]})})]})}}])}(l.Component),he=function(e){function t(){return(0,i.A)(this,t),(0,a.A)(this,t,arguments)}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){return(0,A.jsx)(g.N_,{to:"".concat(m.Yc,"sys/users/").concat(encodeURIComponent(this.props.email),"/"),children:this.props.name})}}])}(l.Component),ue=he,ge=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).getPreviousPageDeviceErrorsList=function(){n.props.getDeviceErrorsListByPage(n.props.pageInfo.current_page-1)},n.getNextPageDeviceErrorsList=function(){n.props.getDeviceErrorsListByPage(n.props.pageInfo.current_page+1)},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg,r=e.items,i=e.pageInfo,s=e.curPerPage;if(t)return(0,A.jsx)(I.A,{});if(n)return(0,A.jsx)("p",{className:"error text-center",children:n});var a=(0,A.jsx)(ie.A,{text:(0,m.AP)("No sync errors")}),o=(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("table",{className:"table-hover",children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"16%",children:(0,m.AP)("User")}),(0,A.jsxs)("th",{width:"20%",children:[(0,m.AP)("Device")," / ",(0,m.AP)("Version")]}),(0,A.jsx)("th",{width:"16%",children:(0,m.AP)("IP")}),(0,A.jsx)("th",{width:"16%",children:(0,m.AP)("Library")}),(0,A.jsx)("th",{width:"16%",children:(0,m.AP)("Error")}),(0,A.jsx)("th",{width:"16%",children:(0,m.AP)("Time")})]})}),(0,A.jsx)("tbody",{children:r.map((function(e,t){return(0,A.jsx)(pe,{item:e},t)}))})]}),(0,A.jsx)(X.A,{gotoPreviousPage:this.getPreviousPageDeviceErrorsList,gotoNextPage:this.getNextPageDeviceErrorsList,currentPage:i.current_page,hasNextPage:i.has_next_page,curPerPage:s,resetPerPage:this.props.resetPerPage})]});return r.length?o:a}}])}(l.Component),pe=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleMouseOver=function(){n.setState({isOpIconShown:!0})},n.handleMouseOut=function(){n.setState({isOpIconShown:!1})},n.state={isOpIconShown:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.item;return(0,A.jsxs)("tr",{onMouseEnter:this.handleMouseOver,onMouseLeave:this.handleMouseOut,children:[(0,A.jsx)("td",{children:(0,A.jsx)(ue,{email:e.email,name:e.name})}),(0,A.jsxs)("td",{children:[e.device_name," / ",e.client_version]}),(0,A.jsx)("td",{children:e.device_ip}),(0,A.jsx)("td",{children:(0,A.jsx)(g.N_,{to:"".concat(m.Yc,"sysadmin/#libs/").concat(e.repo_id),children:e.repo_name})}),(0,A.jsx)("td",{children:e.error_msg}),(0,A.jsx)("td",{children:(0,A.jsx)("span",{className:"item-meta-info",title:C()(e.last_accessed).format("llll"),children:C()(e.error_time).fromNow()})})]})}}])}(l.Component),me=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).getDeviceErrorsListByPage=function(e){var t=n.state.perPage;D.e.sysAdminListDeviceErrors(e,t).then((function(e){n.setState({loading:!1,devicesErrors:e.data.device_errors,pageInfo:e.data.page_info,isCleanBtnShown:e.data.device_errors.length>0})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.clean=function(){D.e.sysAdminClearDeviceErrors().then((function(e){n.setState({devicesErrors:[],isCleanBtnShown:!1});var t=(0,m.AP)("Successfully cleaned all errors.");w.A.success(t)})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){n.getDeviceErrorsListByPage(1)}))},n.state={loading:!0,errorMsg:"",devicesErrors:[],isCleanBtnShown:!1,pageInfo:{},perPage:25},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,r=n.currentPage,i=void 0===r?1:r,s=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||s),currentPage:parseInt(t.get("page")||i)},(function(){e.getDeviceErrorsListByPage(e.state.currentPage)}))}},{key:"render",value:function(){return(0,A.jsxs)(l.Fragment,{children:[this.state.isCleanBtnShown?(0,A.jsx)(k.A,(0,r.A)((0,r.A)({},this.props),{},{children:(0,A.jsx)(S.A,{className:"operation-item",onClick:this.clean,children:(0,m.AP)("Clean")})})):(0,A.jsx)(k.A,(0,r.A)({},this.props)),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)(re,{currentItem:"errors"}),(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsx)(ge,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.devicesErrors,getDeviceErrorsListByPage:this.getDeviceErrorsListByPage,curPerPage:this.state.perPage,resetPerPage:this.resetPerPage,pageInfo:this.state.pageInfo})})]})})]})}}])}(l.Component),fe=n(26910),xe=n(58801),ve=function(){return(0,s.A)((function e(){(0,i.A)(this,e)}),[{key:"init",value:function(e){var t=e.server,n=e.username,r=e.password,i=e.token;return this.server=t,this.username=n,this.password=r,this.token=i,this.token&&this.server&&(this.req=fe.A.create({baseURL:this.server,headers:{Authorization:"Token "+this.token}})),this}},{key:"initForSeahubUsage",value:function(e){var t=e.siteRoot,n=e.xcsrfHeaders;if(t&&"/"===t.charAt(t.length-1)){var r=t.substring(0,t.length-1);this.server=r}else this.server=t;return this.req=fe.A.create({headers:{"X-CSRFToken":n}}),this}},{key:"_sendPostRequest",value:function(e,t){return t.getHeaders?this.req.post(e,t,{headers:t.getHeaders()}):this.req.post(e,t)}},{key:"sysAdminListUsers",value:function(e,t,n,r,i,s,a){var o=this.server+"/api/v2.1/admin/users/",l={page:e,per_page:t};return s&&(l.is_active=s),a&&(l.role=a),n&&(l.source="LDAPImport"),r&&(l.order_by=r,l.direction=i),this.req.get(o,{params:l})}},{key:"sysAdminExportLogsExcel",value:function(e,t,n){var r=this.server+"/api/v2.1/admin/logs/export-excel/",i={start:e,end:t,logType:n};return this.req.get(r,{params:i})}},{key:"adminGroup2Department",value:function(e){var t=this.server+"/api/v2.1/admin/groups/"+e+"/group-to-department/";return this.req.post(t)}}])}(),Ae=new ve,Pe=xe.Ay.load("sfcsrftoken");Ae.initForSeahubUsage({siteRoot:m.Yc,xcsrfHeaders:Pe});var ye=n(43226),be=n(14113),je=n(99308),Se=n(76115),De=n(85907),we=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).toggle=function(){n.props.toggle()},n.openFileInput=function(){n.fileInputRef.current.click()},n.uploadFile=function(e){if(n.fileInputRef.current.files.length){var t=n.fileInputRef.current.files[0].name;if("xlsx"==t.substr(t.lastIndexOf(".")+1)){var r=n.fileInputRef.current.files[0];n.props.importUserInBatch(r),n.toggle()}else n.setState({errorMsg:(0,m.AP)("Please choose a .xlsx file.")})}},n.state={errorMsg:""},n.fileInputRef=l.createRef(),n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.state.errorMsg;return(0,A.jsxs)(u.A,{isOpen:!0,toggle:this.toggle,children:[(0,A.jsx)(be.A,{toggle:this.toggle,children:(0,m.AP)("Import users from a .xlsx file")}),(0,A.jsxs)(je.A,{children:[(0,A.jsx)("p",{children:(0,A.jsx)("a",{className:"text-secondary small",href:"".concat(m.Yc,"useradmin/batchadduser/example/"),children:(0,m.AP)("Download an example file")})}),(0,A.jsx)("button",{className:"btn btn-outline-primary",onClick:this.openFileInput,children:(0,m.AP)("Upload file")}),(0,A.jsx)("input",{className:"d-none",type:"file",onChange:this.uploadFile,ref:this.fileInputRef}),e&&(0,A.jsx)(Se.A,{color:"danger",children:e})]}),(0,A.jsx)(De.A,{children:(0,A.jsx)(S.A,{color:"secondary",onClick:this.toggle,children:(0,m.AP)("Cancel")})})]})}}])}(l.Component),Ie=n(19247),ke=n(76152),_e=n(55627),Ne=n(48918),Me=n(30038),Ce=n(98702),Oe=function(e){function t(){var e;(0,i.A)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=(0,a.A)(this,t,[].concat(r))).translateRoles=function(e){switch(e){case"default":return(0,m.AP)("Default");case"guest":return(0,m.AP)("Guest");default:return e}},e}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){return(0,A.jsx)(Ce.A,{isTextMode:this.props.isTextMode,isEditIconShow:this.props.isEditIconShow,options:this.props.roleOptions,currentOption:this.props.currentRole,onOptionChanged:this.props.onRoleChanged,translateOption:this.translateRoles})}}])}(l.Component),Le=Oe,Te=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).checkSubmitBtnActive=function(){var e=n.state,t=e.email,r=e.password,i=e.passwordAgain,s=!0;s=!!(t.trim()&&r.trim()&&i.trim()),n.setState({isSubmitBtnActive:s})},n.toggle=function(){n.props.toggleDialog()},n.togglePasswordVisible=function(){n.setState({isPasswordVisible:!n.state.isPasswordVisible})},n.inputPassword=function(e){var t=e.target.value;n.setState({password:t,errorMsg:""},n.checkSubmitBtnActive)},n.inputPasswordAgain=function(e){var t=e.target.value;n.setState({passwordAgain:t,errorMsg:""},n.checkSubmitBtnActive)},n.generatePassword=function(){var e=f.Aq.generatePassword(8);n.setState({password:e,passwordAgain:e},n.checkSubmitBtnActive)},n.inputEmail=function(e){var t=e.target.value;n.setState({email:t},n.checkSubmitBtnActive)},n.inputName=function(e){var t=e.target.value;n.setState({name:t})},n.updateRole=function(e){n.setState({role:e})},n.handleSubmit=function(){var e=n.state,t=e.email,r=e.password,i=e.passwordAgain,s=e.name,a=e.role;if(r==i){var o={email:t.trim(),name:s.trim(),password:r.trim()};n.props.showRole&&(o.role=a),n.props.addUser(o),n.toggle()}else n.setState({errorMsg:(0,m.AP)("Passwords do not match.")})},n.state={errorMsg:"",isPasswordVisible:!1,password:"",passwordAgain:"",email:"",name:"",role:"default",isSubmitBtnActive:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props,t=e.dialogTitle,n=e.showRole,r=this.state,i=r.errorMsg,s=r.isPasswordVisible,a=r.email,o=r.name,l=r.role,c=r.password,d=r.passwordAgain,h=r.isSubmitBtnActive;return(0,A.jsxs)(u.A,{isOpen:!0,toggle:this.toggle,children:[(0,A.jsx)(be.A,{toggle:this.toggle,children:t||(0,m.AP)("Add Member")}),(0,A.jsxs)(je.A,{children:[(0,A.jsxs)(Ie.A,{autoComplete:"off",children:[(0,A.jsxs)(ke.A,{children:[(0,A.jsx)(_e.A,{children:(0,m.AP)("Email")}),(0,A.jsx)(W.A,{value:a,onChange:this.inputEmail})]}),(0,A.jsxs)(ke.A,{children:[(0,A.jsx)(_e.A,{children:(0,m.AP)("Name(optional)")}),(0,A.jsx)(W.A,{type:"text",value:o,onChange:this.inputName})]}),n&&(0,A.jsxs)(ke.A,{children:[(0,A.jsxs)(_e.A,{children:[(0,m.AP)("Role"),(0,A.jsx)("span",{className:"small text-secondary ml-1 sf3-font sf3-font-tips",title:(0,m.AP)("You can also add a user as a guest, who will not be allowed to create libraries and groups.")})]}),(0,A.jsx)(Le,{isTextMode:!1,isEditIconShow:!1,currentRole:l,roleOptions:this.props.availableRoles,onRoleChanged:this.updateRole})]}),(0,A.jsxs)(ke.A,{children:[(0,A.jsx)(_e.A,{children:(0,m.AP)("Password")}),(0,A.jsxs)(Ne.A,{children:[(0,A.jsx)(W.A,{autoComplete:"new-password",type:s?"text":"password",value:c||"",onChange:this.inputPassword}),(0,A.jsxs)(Me.A,{addonType:"append",children:[(0,A.jsx)(S.A,{className:"mt-0",onClick:this.togglePasswordVisible,children:(0,A.jsx)("i",{className:"link-operation-icon sf3-font sf3-font-eye".concat(this.state.isPasswordVisible?"":"-slash")})}),(0,A.jsx)(S.A,{className:"mt-0",onClick:this.generatePassword,children:(0,A.jsx)("i",{className:"link-operation-icon sf3-font sf3-font-magic"})})]})]})]}),(0,A.jsxs)(ke.A,{children:[(0,A.jsx)(_e.A,{children:(0,m.AP)("Password again")}),(0,A.jsx)(W.A,{type:s?"text":"password",value:d||"",onChange:this.inputPasswordAgain})]})]}),i&&(0,A.jsx)(Se.A,{color:"danger",children:i})]}),(0,A.jsxs)(De.A,{children:[(0,A.jsx)(S.A,{color:"secondary",onClick:this.toggle,children:(0,m.AP)("Cancel")}),(0,A.jsx)(S.A,{color:"primary",onClick:this.handleSubmit,disabled:!h,children:(0,m.AP)("Submit")})]})]})}}])}(l.Component),Fe=n(94988),Re=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).toggle=function(){n.props.toggle()},n.handleSelectChange=function(e){n.setState({options:e,isSubmitBtnActive:e.length>0})},n.handleSubmit=function(){n.props.addAdminInBatch(n.state.options.map((function(e){return e.email}))),n.toggle()},n.state={options:null,isSubmitBtnActive:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){return(0,A.jsxs)(u.A,{isOpen:!0,toggle:this.toggle,children:[(0,A.jsx)(be.A,{toggle:this.toggle,children:(0,m.AP)("Add Admin")}),(0,A.jsx)(je.A,{children:(0,A.jsx)(Fe.A,{isMulti:!0,placeholder:(0,m.AP)("Search users"),onSelectChange:this.handleSelectChange})}),(0,A.jsxs)(De.A,{children:[(0,A.jsx)(S.A,{color:"secondary",onClick:this.toggle,children:(0,m.AP)("Cancel")}),(0,A.jsx)(S.A,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive,children:(0,m.AP)("Submit")})]})]})}}])}(l.Component),Ee=n(82487),Ue=(0,s.A)((function e(t){(0,i.A)(this,e),this.email=t.email,this.name=t.name,this.contact_email=t.contact_email,this.login_id=t.login_id,this.last_login=t.last_login,this.last_access_time=t.last_access_time,this.create_time=t.create_time,this.is_active=t.is_active,this.is_staff=t.is_staff,this.reference_id=t.reference_id,this.department=t.department,this.quota_total=t.quota_total,this.quota_usage=t.quota_usage,this.role=t.role,this.institution=t.institution,t.org_id&&(this.org_id=t.org_id),t.org_name&&(this.org_name=t.org_name),this.isSelected=!1})),ze=(0,s.A)((function e(t){(0,i.A)(this,e),this.email=t.email,this.name=t.name,this.contact_email=t.contact_email,this.login_id=t.login_id,this.last_login=t.last_login,this.last_access_time=t.last_access_time,this.create_time=t.create_time,this.is_active=t.is_active,this.is_staff=t.is_staff,this.quota_total=t.quota_total,this.quota_usage=t.quota_usage,this.admin_role=t.admin_role,this.isSelected=!1})),Be=n(33320),qe=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).navItems=[{name:"database",urlPart:"users",text:(0,m.AP)("Database")}],m.eB&&n.navItems.push({name:"ldap",urlPart:"users/ldap",text:(0,m.AP)("LDAP")},{name:"ldap-imported",urlPart:"users/ldap-imported",text:(0,m.AP)("LDAP(imported)")}),m.gv&&n.navItems.push({name:"admin",urlPart:"users/admins",text:(0,m.AP)("Admin")}),n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.currentItem;return(0,A.jsx)("div",{className:"cur-view-path tab-nav-container",children:(0,A.jsx)("ul",{className:"nav",children:this.navItems.map((function(t,n){return(0,A.jsx)("li",{className:"nav-item",children:(0,A.jsx)(g.N_,{to:"".concat(m.Yc,"sys/").concat(t.urlPart,"/"),className:"nav-link".concat(e==t.name?" active":""),children:t.text})},n)}))})})}}])}(l.Component),Ye=qe,Ve=n(66149),He=n(61314),We=n(19260),Ge=n(6030),Qe=n(33151),Ke=n(68879),Xe=window.sysadmin.pageOptions.availableRoles,$e=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).translateStatus=function(e){switch(e){case"0":return(0,m.AP)("Inactive");case"1":return(0,m.AP)("Active");default:return(0,m.AP)("All")}},n.translateRole=function(e){switch(e){case"default":return(0,m.AP)("Default");case"guest":return(0,m.AP)("Guest");default:return(0,m.AP)("All")}},n.toggleStatusDropdown=function(){n.setState({isStatusOpen:!n.state.isStatusOpen})},n.toggleRoleDropdown=function(){n.setState({isRoleOpen:!n.state.isRoleOpen})},n.renderCheck=function(){return(0,A.jsx)("span",{className:"sf2-icon-tick text-gray font-weight-bold"})},n.state={isStatusOpen:!1,isRoleOpen:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.onStatusChange,r=t.onRoleChange;return(0,A.jsxs)("div",{className:"users-filter-bar mt-4 mb-2 d-flex",children:[(0,A.jsxs)(We.A,{isOpen:this.state.isStatusOpen,toggle:this.toggleStatusDropdown,children:[(0,A.jsxs)(Ge.A,{tag:"div","data-toggle":"dropdown","aria-expanded":this.state.isStatusOpen,className:"users-filter-bar-dropdown-toggle",children:[(0,A.jsxs)("span",{children:[(0,m.AP)("Status"),": ",this.translateStatus(this.props.isActive)]}),(0,A.jsx)("span",{className:"sf3-font-down sf3-font"})]}),(0,A.jsxs)(Qe.A,{children:[(0,A.jsxs)(Ke.A,{onClick:function(){n("")},children:[(0,A.jsx)("span",{children:(0,m.AP)("All")}),""===this.props.isActive&&this.renderCheck()]},0),(0,A.jsxs)(Ke.A,{onClick:function(){n("1")},children:[(0,A.jsx)("span",{children:(0,m.AP)("Active")}),"1"===this.props.isActive&&this.renderCheck()]},1),(0,A.jsxs)(Ke.A,{onClick:function(){n("0")},children:[(0,A.jsx)("span",{children:(0,m.AP)("Inactive")}),"0"===this.props.isActive&&this.renderCheck()]},2)]})]}),(0,A.jsxs)(We.A,{isOpen:this.state.isRoleOpen,toggle:this.toggleRoleDropdown,className:"ml-4",children:[(0,A.jsxs)(Ge.A,{tag:"div","data-toggle":"dropdown","aria-expanded":this.state.isRoleOpen,className:"users-filter-bar-dropdown-toggle",children:[(0,A.jsxs)("span",{children:[(0,m.AP)("Role"),": ",this.translateRole(this.props.role)]}),(0,A.jsx)("span",{className:"sf3-font-down sf3-font"})]}),(0,A.jsxs)(Qe.A,{children:[(0,A.jsxs)(Ke.A,{onClick:function(){r("")},children:[(0,A.jsx)("span",{children:(0,m.AP)("All")}),""===this.props.role&&this.renderCheck()]},0),Xe.map((function(t,n){return(0,A.jsxs)(Ke.A,{onClick:function(){r(t)},children:[(0,A.jsx)("span",{children:e.translateRole(t)}),e.props.role===t&&e.renderCheck()]},n)}))]})]})]})}}])}(l.Component),Ze=window.sysadmin.pageOptions,Je=Ze.availableRoles,et=Ze.availableAdminRoles,tt=Ze.institutions,nt=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleItemFreezed=function(e){n.setState({isItemFreezed:e})},n.onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.getPreviousPage=function(){n.props.getListByPage(n.props.currentPage-1,n.props.is_active,n.props.role)},n.getNextPage=function(){n.props.getListByPage(n.props.currentPage+1,n.props.is_active,n.props.role)},n.sortByQuotaUsage=function(e){e.preventDefault(),n.props.sortByQuotaUsage()},n.state={isItemFreezed:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.isAdmin,r=t.loading,i=t.errorMsg,s=t.items,a=t.isAllUsersSelected,o=t.curPerPage,c=t.hasNextPage,d=t.currentPage,h=t.sortBy,u=t.sortOrder;if(r)return(0,A.jsx)(I.A,{});if(i)return(0,A.jsx)("p",{className:"error text-center mt-4",children:i});var g,p=[];g=""==h?(0,A.jsx)("span",{className:"sf3-font sf3-font-sort3"}):(0,A.jsx)("span",{className:"sf3-font ".concat("asc"==u?"sf3-font-down rotate-180 d-inline-block":"sf3-font-down")});var f=(0,m.AP)("Space Used"),x=void 0!=h?(0,A.jsxs)("a",{className:"d-inline-block table-sort-op",href:"#",onClick:this.sortByQuotaUsage,children:[f," ",g]}):f,v=(0,A.jsxs)(l.Fragment,{children:[x," / ".concat((0,m.AP)("Quota"))]}),P="".concat((0,m.AP)("Name")," / ").concat((0,m.AP)("Contact Email")),y="".concat((0,m.AP)("Created At")," / ").concat((0,m.AP)("Last Login")," / ").concat((0,m.AP)("Last Access"));m.am?p.push({width:"20%",text:P},{width:"15%",text:(0,m.AP)("Status")},{width:"15%",text:(0,m.AP)("Role")}):p.push({width:"30%",text:P},{width:"20%",text:(0,m.AP)("Status")}),m.Oq&&!n?p.push({width:"14%",text:v},{width:"14%",text:(0,m.AP)("Institution")},{width:"14%",text:y},{width:"5%",text:""}):p.push({width:"20%",text:v},{width:"22%",text:y},{width:"5%",text:""});var b=(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("table",{children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"3%",className:"pl-2",children:(0,A.jsx)("input",{type:"checkbox",className:"vam",onChange:this.props.toggleSelectAllUsers,checked:a})}),p.map((function(e,t){return(0,A.jsx)("th",{width:e.width,children:e.text},t)}))]})}),(0,A.jsx)("tbody",{children:s.map((function(t,n){return n<e.props.curPerPage?(0,A.jsx)(rt,{item:t,isItemFreezed:e.state.isItemFreezed,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem,toggleItemFreezed:e.toggleItemFreezed,updateUser:e.props.updateUser,deleteUser:e.props.deleteUser,updateAdminRole:e.props.updateAdminRole,revokeAdmin:e.props.revokeAdmin,onUserSelected:e.props.onUserSelected,isAdmin:e.props.isAdmin,isLDAPImported:e.props.isLDAPImported},n):null}))})]}),!this.props.isAdmin&&!this.props.isSearchResult&&(0,A.jsx)(X.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:d,hasNextPage:c,curPerPage:o,resetPerPage:this.props.resetPerPage})]});return(0,A.jsxs)("div",{children:["database"===this.props.currentItem&&(0,A.jsx)($e,{isActive:this.props.is_active,role:this.props.role,onStatusChange:this.props.onStatusChange,onRoleChange:this.props.onRoleChange}),s.length?b:(0,A.jsx)(ie.A,{text:(0,m.AP)("No users")})]})}}])}(l.Component),rt=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleMouseEnter=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!0,highlight:!0})},n.handleMouseLeave=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!1,highlight:!1})},n.onUnfreezedItem=function(){n.setState({highlight:!1,isOpIconShow:!1}),n.props.onUnfreezedItem()},n.toggleSetQuotaDialog=function(){n.setState({isSetQuotaDialogOpen:!n.state.isSetQuotaDialogOpen})},n.toggleDeleteUserDialog=function(){n.setState({isDeleteUserDialogOpen:!n.state.isDeleteUserDialogOpen})},n.toggleResetUserPasswordDialog=function(){n.setState({isResetUserPasswordDialogOpen:!n.state.isResetUserPasswordDialogOpen})},n.toggleRevokeAdminDialog=function(){n.setState({isRevokeAdminDialogOpen:!n.state.isRevokeAdminDialogOpen})},n.toggleConfirmInactiveDialog=function(){n.setState({isConfirmInactiveDialogOpen:!n.state.isConfirmInactiveDialogOpen})},n.onUserSelected=function(){n.props.onUserSelected(n.props.item)},n.updateStatus=function(e){var t="active"==e.value;t&&w.A.notify((0,m.AP)("It may take some time, please wait.")),n.props.updateUser(n.props.item.email,"is_active",t)},n.setUserInactive=function(){n.props.updateUser(n.props.item.email,"is_active",!1)},n.updateRole=function(e){n.props.updateUser(n.props.item.email,"role",e.value)},n.updateAdminRole=function(e){n.props.updateAdminRole(n.props.item.email,e.value)},n.translateRole=function(e){switch(e){case"default":return(0,m.AP)("Default");case"guest":return(0,m.AP)("Guest");default:return e}},n.translateAdminRole=function(e){switch(e){case"default_admin":return(0,m.AP)("Default Admin");case"system_admin":return(0,m.AP)("System Admin");case"daily_admin":return(0,m.AP)("Daily Admin");case"audit_admin":return(0,m.AP)("Audit Admin");default:return e}},n.translateStatus=function(e){switch(e){case"active":return(0,m.AP)("Active");case"inactive":return(0,m.AP)("Inactive")}},n.updateInstitution=function(e){n.props.updateUser(n.props.item.email,"institution",e.value)},n.updateQuota=function(e){n.props.updateUser(n.props.item.email,"quota_total",e)},n.deleteUser=function(){w.A.notify((0,m.AP)("It may take some time, please wait.")),n.props.deleteUser(n.props.item.email,n.props.item.name)},n.resetPassword=function(){w.A.notify((0,m.AP)("It may take some time, please wait.")),D.e.sysAdminResetUserPassword(n.props.item.email).then((function(e){w.A.success(e.data.reset_tip)})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.revokeAdmin=function(){var e=n.props.item;n.props.revokeAdmin(e.email,e.name)},n.getMenuOperations=function(){var e=n.props,t=e.isAdmin,r=e.isLDAPImported,i=e.isSearchResult,s=e.item,a=["Delete"];return(!r||i&&"db"==s.source)&&a.push("Reset Password"),t&&(a=["Revoke Admin"]),a},n.translateOperations=function(e){var t="";switch(e){case"Delete":t=(0,m.AP)("Delete");break;case"Reset Password":t=(0,m.AP)("Reset Password");break;case"Revoke Admin":t=(0,m.AP)("Revoke Admin")}return t},n.onMenuItemClick=function(e){switch(e){case"Delete":n.toggleDeleteUserDialog();break;case"Reset Password":n.toggleResetUserPasswordDialog();break;case"Revoke Admin":n.toggleRevokeAdminDialog()}},n.state={isOpIconShown:!1,highlight:!1,isSetQuotaDialogOpen:!1,isDeleteUserDialogOpen:!1,isResetUserPasswordDialogOpen:!1,isRevokeAdminDialogOpen:!1,isConfirmInactiveDialogOpen:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.item,r=t.isAdmin,i=this.state,s=i.highlight,a=i.isOpIconShown,o=i.isSetQuotaDialogOpen,c=i.isDeleteUserDialogOpen,d=i.isResetUserPasswordDialogOpen,h=i.isRevokeAdminDialogOpen,u=i.isConfirmInactiveDialogOpen,p='<span class="op-target">'+f.Aq.HTMLescape(n.name)+"</span>",x=(0,m.AP)("Are you sure you want to delete {placeholder} ?").replace("{placeholder}",p),v=(0,m.AP)("Are you sure you want to reset the password of {placeholder} ?").replace("{placeholder}",p),P=(0,m.AP)("Are you sure you want to revoke the admin permission of {placeholder} ?").replace("{placeholder}",p),y=(0,m.AP)("Are you sure you want to set {user_placeholder} inactive?").replace("{user_placeholder}",p),b=n.is_active?"active":"inactive";this.statusOptions=["active","inactive"].map((function(t){return{value:t,text:e.translateStatus(t),isSelected:t==b}}));var j,S,D,w=this.statusOptions.filter((function(e){return e.isSelected}))[0];if(r){var I=n.admin_role;this.adminRoleOptions=et.map((function(t){return{value:t,text:e.translateAdminRole(t),isSelected:t==I}})),j=this.adminRoleOptions.filter((function(e){return e.isSelected}))[0]}else{var k=n.role;this.roleOptions=Je.map((function(t){return{value:t,text:e.translateRole(t),isSelected:t==k}})),S=this.roleOptions.filter((function(e){return e.isSelected}))[0]||{value:k,text:this.translateRole(k),isSelected:!0}}if(m.Oq&&!r){var _=n.institution;this.instOptions=tt.map((function(e){return{value:e,text:e,isSelected:e==_}})),D=this.instOptions.filter((function(e){return e.isSelected}))[0]}return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,A.jsx)("td",{className:"pl-2",children:(0,A.jsx)("input",{type:"checkbox",className:"vam",onChange:this.onUserSelected,checked:n.isSelected})}),(0,A.jsxs)("td",{children:[(0,A.jsx)(ue,{email:n.email,name:n.name}),n.contact_email&&(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)("br",{}),n.contact_email]}),n.org_id&&(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)("br",{}),(0,A.jsxs)(g.N_,{to:"".concat(m.Yc,"sys/organizations/").concat(n.org_id,"/info/"),children:["(",n.org_name,")"]})]})]}),(0,A.jsx)("td",{children:(0,A.jsx)(Ve.A,{isDropdownToggleShown:s,currentSelectedOption:w,options:this.statusOptions,selectOption:this.updateStatus,toggleItemFreezed:this.props.toggleItemFreezed,operationBeforeSelect:n.is_active?this.toggleConfirmInactiveDialog:void 0})}),m.am&&(0,A.jsx)("td",{children:r?(0,A.jsx)(Ve.A,{isDropdownToggleShown:s,currentSelectedOption:j,options:this.adminRoleOptions,selectOption:this.updateAdminRole,toggleItemFreezed:this.props.toggleItemFreezed}):(0,A.jsx)(Ve.A,{isDropdownToggleShown:s,currentSelectedOption:S,options:this.roleOptions,selectOption:this.updateRole,toggleItemFreezed:this.props.toggleItemFreezed})}),(0,A.jsxs)("td",{children:["".concat(f.Aq.bytesToSize(n.quota_usage)," / ").concat(n.quota_total>0?f.Aq.bytesToSize(n.quota_total):"--"),(0,A.jsx)("span",{title:(0,m.AP)("Edit"),className:"sf3-font sf3-font-rename attr-action-icon ".concat(a?"":"invisible"),onClick:this.toggleSetQuotaDialog})]}),m.Oq&&!r&&(0,A.jsx)("td",{children:(0,A.jsx)(Ve.A,{isDropdownToggleShown:s&&tt.length>0,currentSelectedOption:D,options:this.instOptions,selectOption:this.updateInstitution,toggleItemFreezed:this.props.toggleItemFreezed})}),(0,A.jsxs)("td",{children:["".concat(n.create_time?C()(n.create_time).format("YYYY-MM-DD HH:mm"):"--"," /"),(0,A.jsx)("br",{}),"".concat(n.last_login?C()(n.last_login).fromNow():"--"),(0,A.jsx)("br",{}),"".concat(n.last_access_time?C()(n.last_access_time).fromNow():"--")]}),(0,A.jsx)("td",{children:n.email!=m.Xh&&a&&(0,A.jsx)(He.A,{operations:this.getMenuOperations(),translateOperations:this.translateOperations,onMenuItemClick:this.onMenuItemClick,onFreezedItem:this.props.onFreezedItem,onUnfreezedItem:this.onUnfreezedItem})})]}),o&&(0,A.jsx)(ye.A,{toggle:this.toggleSetQuotaDialog,updateQuota:this.updateQuota}),c&&(0,A.jsx)(Ee.A,{title:(0,m.AP)("Delete User"),message:x,executeOperation:this.deleteUser,confirmBtnText:(0,m.AP)("Delete"),toggleDialog:this.toggleDeleteUserDialog}),d&&(0,A.jsx)(Ee.A,{title:(0,m.AP)("Reset Password"),message:v,executeOperation:this.resetPassword,confirmBtnText:(0,m.AP)("Reset"),toggleDialog:this.toggleResetUserPasswordDialog}),h&&(0,A.jsx)(Ee.A,{title:(0,m.AP)("Revoke Admin"),message:P,executeOperation:this.revokeAdmin,confirmBtnText:(0,m.AP)("Revoke"),toggleDialog:this.toggleRevokeAdminDialog}),u&&(0,A.jsx)(Ee.A,{title:(0,m.AP)("Set user inactive"),message:y,executeOperation:this.setUserInactive,confirmBtnText:(0,m.AP)("Set"),toggleDialog:this.toggleConfirmInactiveDialog})]})}}])}(l.Component),it=nt,st=window.sysadmin.pageOptions.availableRoles,at=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleImportUserDialog=function(){n.setState({isImportUserDialogOpen:!n.state.isImportUserDialogOpen})},n.toggleAddUserDialog=function(){n.setState({isAddUserDialogOpen:!n.state.isAddUserDialogOpen})},n.toggleBatchSetQuotaDialog=function(){n.setState({isBatchSetQuotaDialogOpen:!n.state.isBatchSetQuotaDialogOpen})},n.toggleBatchDeleteUserDialog=function(){n.setState({isBatchDeleteUserDialogOpen:!n.state.isBatchDeleteUserDialogOpen})},n.onUserSelected=function(e){var t=!1,r=[],i=n.state.userList.map((function(n){return n.email===e.email&&(n.isSelected=!n.isSelected),1==n.isSelected?(t=!0,r.push(n)):r=r.filter((function(e){return e.email!=n.email})),n}));n.setState({userList:i,hasUserSelected:t,selectedUserList:r})},n.toggleSelectAllUsers=function(){if(n.state.isAllUsersSelected){var e=n.state.userList.map((function(e){return e.isSelected=!1,e}));n.setState({userList:e,hasUserSelected:!1,isAllUsersSelected:!1,selectedUserList:[]})}else{var t=n.state.userList.map((function(e){return e.isSelected=!0,e}));n.setState({userList:t,hasUserSelected:!0,isAllUsersSelected:!0,selectedUserList:t})}},n.getUserList=function(){D.e.sysAdminListAdmins().then((function(e){var t=e.data.admin_user_list.map((function(e){return new ze(e)}));n.setState({userList:t,loading:!1})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.getUsersListByPage=function(e,t,r){var i=n.state,s=i.perPage,a=i.sortBy,o=i.sortOrder,l=n.props.isLDAPImported;Ae.sysAdminListUsers(e,s,l,a,o,t,r).then((function(t){var r=t.data.data.map((function(e){return new Ue(e)}));n.setState({userList:r,loading:!1,hasNextPage:f.Aq.hasNextPage(e,s,t.data.total_count),currentPage:e})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.updateURL=function(e,t){var n=new URL(location.href),r=new URLSearchParams(n.search);r.set("page",e),r.set("per_page",t),n.search=r.toString(),(0,g.oo)(n.toString())},n.onStatusChange=function(e){n.setState({is_active:e,currentPage:1},(function(){var e=n.state,t=e.currentPage,r=e.perPage,i=e.is_active,s=e.role;n.updateURL(t,r),n.getUsersListByPage(t,i,s)}))},n.onRoleChange=function(e){n.setState({role:e,currentPage:1},(function(){var e=n.state,t=e.currentPage,r=e.perPage,i=e.is_active,s=e.role;n.updateURL(t,r),n.getUsersListByPage(t,i,s)}))},n.sortByQuotaUsage=function(){n.setState({sortBy:"quota_usage",sortOrder:"asc"==n.state.sortOrder?"desc":"asc",currentPage:1},(function(){var e=new URL(location.href),t=new URLSearchParams(e.search),r=n.state,i=r.currentPage,s=r.sortBy,a=r.sortOrder,o=r.is_active,l=r.role;t.set("page",i),t.set("order_by",s),t.set("direction",a),e.search=t.toString(),(0,g.oo)(e.toString()),n.getUsersListByPage(i,o,l)}))},n.deleteUser=function(e,t){D.e.sysAdminDeleteUser(e).then((function(r){var i=n.state.userList.filter((function(t){return t.email!=e}));n.setState({userList:i});var s=(0,m.AP)("Deleted user %s");s=s.replace("%s",t),w.A.success(s)})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.setUserQuotaInBatch=function(e){var t=n.state.selectedUserList.map((function(e){return e.email}));D.e.sysAdminSetUserQuotaInBatch(t,e).then((function(e){var t=n.state.userList.map((function(t){return e.data.success.forEach((function(e){t.email==e.email&&(t.quota_total=e.quota_total)})),t}));n.setState({userList:t})})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.deleteUserInBatch=function(){var e=n.state.selectedUserList.map((function(e){return e.email}));D.e.sysAdminDeleteUserInBatch(e).then((function(t){if(t.data.success.length){var r=n.state.userList.filter((function(e){return!t.data.success.some((function(t){return t.email==e.email}))}));n.setState({userList:r,hasUserSelected:e.length!=t.data.success.length});var i=t.data.success.length,s=1==i?(0,m.AP)("Successfully deleted 1 user."):(0,m.AP)("Successfully deleted {user_number_placeholder} users.").replace("{user_number_placeholder}",i);w.A.success(s)}t.data.failed.forEach((function(e){var t="".concat(e.email,": ").concat(e.error_msg);w.A.danger(t)}))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.importUserInBatch=function(e){w.A.notify((0,m.AP)("It may take some time, please wait.")),D.e.sysAdminImportUserViaFile(e).then((function(e){if(e.data.success.length){var t=e.data.success.map((function(e){return void 0==e.institution&&(e.institution=""),new Ue(e)}));n.setState({userList:t.concat(n.state.userList)})}e.data.failed.forEach((function(e){var t="".concat(e.email,": ").concat(e.error_msg);w.A.danger(t)}))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.addUser=function(e){w.A.notify((0,m.AP)("It may take some time, please wait."));var t=e.email,r=e.name,i=e.role,s=e.password;D.e.sysAdminAddUser(t,r,i,s).then((function(e){var t=n.state.userList;t.unshift(e.data),n.setState({userList:t}),w.A.success(e.data.add_user_tip)})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){n.getUsersListByPage(1,n.state.is_active,n.state.role)}))},n.updateUser=function(e,t,r){D.e.sysAdminUpdateUser(e,t,r).then((function(i){var s=n.state.userList.map((function(n){return n.email==e&&(n[t]=i.data[t]),n}));n.setState({userList:s});var a="is_active"==t&&r?i.data.update_status_tip:(0,m.AP)("Edit succeeded");w.A.success(a)})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.updateAdminRole=function(e,t){D.e.sysAdminUpdateAdminRole(e,t).then((function(t){var r=n.state.userList.map((function(n){return n.email==e&&(n.admin_role=t.data.role),n}));n.setState({userList:r}),w.A.success((0,m.AP)("Edit succeeded"))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.revokeAdmin=function(e,t){D.e.sysAdminUpdateUser(e,"is_staff",!1).then((function(r){var i=n.state.userList.filter((function(t){return t.email!=e}));n.setState({userList:i}),w.A.success((0,m.AP)("Successfully revoked the admin permission of {placeholder}.").replace("{placeholder}",t))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.getOperationsForAll=function(){var e=n.props,t=e.isAdmin,r=e.isLDAPImported;return t?(0,A.jsx)(S.A,{className:"btn btn-secondary operation-item",onClick:n.toggleBatchAddAdminDialog,children:(0,m.AP)("Add Admin")}):r?(0,A.jsx)("a",{className:"btn btn-secondary operation-item",href:"".concat(m.Yc,"sys/useradmin/export-excel/"),children:(0,m.AP)("Export Excel")}):(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(S.A,{className:"btn btn-secondary operation-item",onClick:n.toggleImportUserDialog,children:(0,m.AP)("Import Users")}),(0,A.jsx)(S.A,{className:"btn btn-secondary operation-item",onClick:n.toggleAddUserDialog,children:(0,m.AP)("Add User")}),(0,A.jsx)("a",{className:"btn btn-secondary operation-item",href:"".concat(m.Yc,"sys/useradmin/export-excel/"),children:(0,m.AP)("Export Excel")})]})},n.getCurrentNavItem=function(){var e=n.props,t=e.isAdmin,r=e.isLDAPImported,i="database";return t?i="admin":r&&(i="ldap-imported"),i},n.toggleBatchAddAdminDialog=function(){n.setState({isBatchAddAdminDialogOpen:!n.state.isBatchAddAdminDialogOpen})},n.addAdminInBatch=function(e){D.e.sysAdminAddAdminInBatch(e).then((function(e){var t=e.data.success.map((function(e){return new ze(e)}));n.setState({userList:t.concat(n.state.userList)}),e.data.failed.forEach((function(e){var t="".concat(e.email,": ").concat(e.error_msg);w.A.danger(t)}))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.getSearch=function(){return n.props.isAdmin?null:(0,A.jsx)(Be.A,{placeholder:(0,m.AP)("Search users"),submit:n.searchItems})},n.searchItems=function(e){(0,g.oo)("".concat(m.Yc,"sys/search-users/?query=").concat(encodeURIComponent(e)))},n.state={loading:!0,errorMsg:"",userList:[],hasNextPage:!1,currentPage:1,perPage:25,hasUserSelected:!1,selectedUserList:[],isAllUsersSelected:!1,isImportUserDialogOpen:!1,isAddUserDialogOpen:!1,isBatchSetQuotaDialogOpen:!1,isBatchDeleteUserDialogOpen:!1,isBatchAddAdminDialogOpen:!1,is_active:null,role:null},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this;if(this.props.isAdmin)this.getUserList();else{var t=new URL(window.location).searchParams,n=this.state,r=n.currentPage,i=n.perPage,s=n.sortBy,a=void 0===s?"":s,o=n.sortOrder,l=void 0===o?"asc":o,c=n.is_active,d=n.role;this.setState({perPage:parseInt(t.get("per_page")||i),currentPage:parseInt(t.get("page")||r),sortBy:t.get("order_by")||a,sortOrder:t.get("direction")||l},(function(){e.getUsersListByPage(e.state.currentPage,c,d)}))}}},{key:"render",value:function(){var e=this.props,t=e.isAdmin,n=e.isLDAPImported,i=this.state,s=i.hasUserSelected,a=i.isImportUserDialogOpen,o=i.isAddUserDialogOpen,c=i.isBatchDeleteUserDialogOpen,d=i.isBatchSetQuotaDialogOpen,h=i.isBatchAddAdminDialogOpen;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)((0,r.A)({search:this.getSearch()},this.props),{},{children:s?(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(S.A,{className:"btn btn-secondary operation-item",onClick:this.toggleBatchSetQuotaDialog,children:(0,m.AP)("Set Quota")}),(0,A.jsx)(S.A,{className:"btn btn-secondary operation-item",onClick:this.toggleBatchDeleteUserDialog,children:(0,m.AP)("Delete Users")})]}):this.getOperationsForAll()})),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)(Ye,{currentItem:this.getCurrentNavItem()}),(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsx)(it,{isAdmin:t,isLDAPImported:n,loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.userList,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortByQuotaUsage:this.sortByQuotaUsage,currentPage:this.state.currentPage,hasNextPage:this.state.hasNextPage,curPerPage:this.state.perPage,is_active:this.state.is_active,role:this.state.role,resetPerPage:this.resetPerPage,getListByPage:this.getUsersListByPage,updateUser:this.updateUser,deleteUser:this.deleteUser,updateAdminRole:this.updateAdminRole,revokeAdmin:this.revokeAdmin,onUserSelected:this.onUserSelected,isAllUsersSelected:this.isAllUsersSelected,toggleSelectAllUsers:this.toggleSelectAllUsers,onRoleChange:this.onRoleChange,onStatusChange:this.onStatusChange,currentItem:this.getCurrentNavItem()})})]})}),a&&(0,A.jsx)(we,{toggle:this.toggleImportUserDialog,importUserInBatch:this.importUserInBatch}),o&&(0,A.jsx)(Te,{dialogTitle:(0,m.AP)("Add User"),showRole:m.am,availableRoles:st,addUser:this.addUser,toggleDialog:this.toggleAddUserDialog}),d&&(0,A.jsx)(ye.A,{toggle:this.toggleBatchSetQuotaDialog,updateQuota:this.setUserQuotaInBatch}),c&&(0,A.jsx)(Ee.A,{title:(0,m.AP)("Delete Users"),message:(0,m.AP)("Are you sure you want to delete the selected user(s) ?"),executeOperation:this.deleteUserInBatch,confirmBtnText:(0,m.AP)("Delete"),toggleDialog:this.toggleBatchDeleteUserDialog}),h&&(0,A.jsx)(Re,{addAdminInBatch:this.addAdminInBatch,toggle:this.toggleBatchAddAdminDialog})]})}}])}(l.Component),ot=at,lt=function(e){function t(){return(0,i.A)(this,t),(0,a.A)(this,t,arguments)}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){return(0,A.jsx)(ot,(0,r.A)({isAdmin:!0},this.props))}}])}(l.Component),ct=lt,dt=function(e){function t(){return(0,i.A)(this,t),(0,a.A)(this,t,arguments)}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){return(0,A.jsx)(ot,(0,r.A)({isLDAPImported:!0},this.props))}}])}(l.Component),ht=dt,ut=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).getPreviousPage=function(){n.props.getListByPage(n.props.currentPage-1)},n.getNextPage=function(){n.props.getListByPage(n.props.currentPage+1)},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg,r=e.items,i=e.curPerPage,s=e.hasNextPage,a=e.currentPage;if(t)return(0,A.jsx)(I.A,{});if(n)return(0,A.jsx)("p",{className:"error text-center mt-4",children:n});var o=(0,A.jsx)(ie.A,{text:(0,m.AP)("No users")}),c=(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("table",{className:"table-hover",children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"40%",children:(0,m.AP)("Email")}),(0,A.jsxs)("th",{width:"30%",children:[(0,m.AP)("Space Used")," / ",(0,m.AP)("Quota")]}),(0,A.jsx)("th",{width:"30%",children:(0,m.AP)("Last Login")})]})}),(0,A.jsx)("tbody",{children:r.map((function(e,t){return(0,A.jsx)(gt,{item:e},t)}))})]}),(0,A.jsx)(X.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:a,hasNextPage:s,curPerPage:i,resetPerPage:this.props.resetPerPage})]});return r.length?c:o}}])}(l.Component),gt=function(e){function t(){return(0,i.A)(this,t),(0,a.A)(this,t,arguments)}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.item;return(0,A.jsx)(l.Fragment,{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("td",{children:(0,A.jsx)(ue,{email:e.email,name:e.email})}),(0,A.jsx)("td",{children:"".concat(f.Aq.bytesToSize(e.quota_usage)," / ").concat(e.quota_total>0?f.Aq.bytesToSize(e.quota_total):"--")}),(0,A.jsx)("td",{children:e.last_login?C()(e.last_login).fromNow():"--"})]})})}}])}(l.Component),pt=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).getUsersListByPage=function(e){var t=n.state.perPage;D.e.sysAdminListLDAPUsers(e,t).then((function(t){n.setState({loading:!1,userList:t.data.ldap_user_list,hasNextPage:t.data.has_next_page,currentPage:e})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){n.getUsersListByPage(1)}))},n.state={loading:!0,errorMsg:"",userList:{},hasNextPage:!1,currentPage:1,perPage:25},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,r=n.currentPage,i=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||i),currentPage:parseInt(t.get("page")||r)},(function(){e.getUsersListByPage(e.state.currentPage)}))}},{key:"render",value:function(){return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)({},this.props)),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)(Ye,{currentItem:"ldap"}),(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsx)(ut,{resetPerPage:this.resetPerPage,loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.userList,currentPage:this.state.currentPage,hasNextPage:this.state.hasNextPage,curPerPage:this.state.perPage,getListByPage:this.getUsersListByPage})})]})})]})}}])}(l.Component),mt=pt,ft=n(23931),xt=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleBatchSetQuotaDialog=function(){n.setState({isBatchSetQuotaDialogOpen:!n.state.isBatchSetQuotaDialogOpen})},n.toggleBatchDeleteUserDialog=function(){n.setState({isBatchDeleteUserDialogOpen:!n.state.isBatchDeleteUserDialogOpen})},n.onUserSelected=function(e){var t=!1,r=[],i=n.state.userList.map((function(n){return n.email===e.email&&(n.isSelected=!n.isSelected),1==n.isSelected?(t=!0,r.push(n)):r=r.filter((function(e){return e.email!=n.email})),n}));n.setState({userList:i,hasUserSelected:t,selectedUserList:r})},n.toggleSelectAllUsers=function(){if(n.state.isAllUsersSelected){var e=n.state.userList.map((function(e){return e.isSelected=!1,e}));n.setState({userList:e,hasUserSelected:!1,isAllUsersSelected:!1,selectedUserList:[]})}else{var t=n.state.userList.map((function(e){return e.isSelected=!0,e}));n.setState({userList:t,hasUserSelected:!0,isAllUsersSelected:!0,selectedUserList:t})}},n.getItems=function(e){D.e.sysAdminSearchUsers(n.state.query.trim(),e,n.state.perPage).then((function(e){n.setState({userList:e.data.user_list,loading:!1,pageInfo:e.data.page_info})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){n.getItems(1)}))},n.deleteUser=function(e,t){D.e.sysAdminDeleteUser(e).then((function(r){var i=n.state.userList.filter((function(t){return t.email!=e}));n.setState({userList:i});var s=(0,m.AP)("Deleted user %s");s=s.replace("%s",t),w.A.success(s)})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.setUserQuotaInBatch=function(e){var t=n.state.selectedUserList.map((function(e){return e.email}));D.e.sysAdminSetUserQuotaInBatch(t,e).then((function(e){var t=n.state.userList.map((function(t){return e.data.success.forEach((function(e){t.email==e.email&&(t.quota_total=e.quota_total)})),t}));n.setState({userList:t})})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.deleteUserInBatch=function(){var e=n.state.selectedUserList.map((function(e){return e.email}));D.e.sysAdminDeleteUserInBatch(e).then((function(t){if(t.data.success.length){var r=n.state.userList.filter((function(e){return!t.data.success.some((function(t){return t.email==e.email}))}));n.setState({userList:r,hasUserSelected:e.length!=t.data.success.length});var i=t.data.success.length,s=1==i?(0,m.AP)("Successfully deleted 1 user."):(0,m.AP)("Successfully deleted {user_number_placeholder} users.").replace("{user_number_placeholder}",i);w.A.success(s)}t.data.failed.forEach((function(e){var t="".concat(e.email,": ").concat(e.error_msg);w.A.danger(t)}))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.updateUser=function(e,t,r){D.e.sysAdminUpdateUser(e,t,r).then((function(i){var s=n.state.userList.map((function(n){return n.email==e&&(n[t]=i.data[t]),n}));n.setState({userList:s});var a="is_active"==t&&r?i.data.update_status_tip:(0,m.AP)("Edit succeeded");w.A.success(a)})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.updateAdminRole=function(e,t){D.e.sysAdminUpdateAdminRole(e,t).then((function(t){var r=n.state.userList.map((function(n){return n.email==e&&(n.admin_role=t.data.role),n}));n.setState({userList:r}),w.A.success((0,m.AP)("Edit succeeded"))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.revokeAdmin=function(e,t){D.e.sysAdminUpdateUser(e,"is_staff",!1).then((function(r){var i=n.state.userList.filter((function(t){return t.email!=e}));n.setState({userList:i}),w.A.success((0,m.AP)("Successfully revoked the admin permission of {placeholder}.").replace("{placeholder}",t))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.handleInputChange=function(e){n.setState({query:e.target.value},n.checkSubmitBtnActive)},n.checkSubmitBtnActive=function(){var e=n.state.query;n.setState({isSubmitBtnActive:e.trim()})},n.getPreviousPageList=function(){n.getItems(n.state.pageInfo.current_page-1)},n.getNextPageList=function(){n.getItems(n.state.pageInfo.current_page+1)},n.handleKeyDown=function(e){13===e.keyCode&&(n.state.isSubmitBtnActive&&n.getItems())},n.state={query:"",isSubmitBtnActive:!1,loading:!0,errorMsg:"",userList:[],pageInfo:{has_next_page:!1,current_page:1},currentPage:1,perPage:25,hasUserSelected:!1,selectedUserList:[],isAllUsersSelected:!1,isBatchSetQuotaDialogOpen:!1,isBatchDeleteUserDialogOpen:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(document.location).searchParams,n=this.state,r=n.currentPage,i=n.perPage;this.setState({query:t.get("query")||"",currentPage:parseInt(t.get("page")||r),perPage:parseInt(t.get("per_page")||i)},(function(){e.getItems(e.state.currentPage)}))}},{key:"render",value:function(){var e=this.state,t=e.query,n=e.isSubmitBtnActive,i=this.state,s=i.hasUserSelected,a=i.isBatchDeleteUserDialogOpen,o=i.isBatchSetQuotaDialogOpen;return(0,A.jsxs)(l.Fragment,{children:[s?(0,A.jsx)(k.A,(0,r.A)((0,r.A)({},this.props),{},{children:(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(S.A,{className:"btn btn-secondary operation-item",onClick:this.toggleBatchSetQuotaDialog,children:(0,m.AP)("Set Quota")}),(0,A.jsx)(S.A,{className:"btn btn-secondary operation-item",onClick:this.toggleBatchDeleteUserDialog,children:(0,m.AP)("Delete Users")})]})})):(0,A.jsx)(k.A,(0,r.A)({},this.props)),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)("div",{className:"cur-view-path",children:(0,A.jsx)("h3",{className:"sf-heading",children:(0,m.AP)("Users")})}),(0,A.jsxs)("div",{className:"cur-view-content",children:[(0,A.jsxs)("div",{className:"mt-4 mb-6",children:[(0,A.jsx)("h4",{className:"border-bottom font-weight-normal mb-2 pb-1",children:(0,m.AP)("Search Users")}),(0,A.jsxs)(Ie.A,{tag:"div",children:[(0,A.jsx)(ke.A,{row:!0,children:(0,A.jsx)(ft.A,{sm:5,children:(0,A.jsx)(W.A,{type:"text",name:"query",value:t,placeholder:(0,m.AP)("Search users"),onChange:this.handleInputChange,onKeyDown:this.handleKeyDown})})}),(0,A.jsx)(ke.A,{row:!0,children:(0,A.jsx)(ft.A,{sm:{size:5},children:(0,A.jsx)("button",{className:"btn btn-outline-primary",disabled:!n,onClick:this.getItems,children:(0,m.AP)("Submit")})})})]})]}),(0,A.jsxs)("div",{className:"mt-4 mb-6",children:[(0,A.jsx)("h4",{className:"border-bottom font-weight-normal mb-2 pb-1",children:(0,m.AP)("Result")}),(0,A.jsx)(it,{isLDAPImported:!1,isAdmin:!1,isSearchResult:!0,loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.userList,updateUser:this.updateUser,deleteUser:this.deleteUser,updateAdminRole:this.updateAdminRole,revokeAdmin:this.revokeAdmin,onUserSelected:this.onUserSelected,isAllUsersSelected:this.isAllUsersSelected,toggleSelectAllUsers:this.toggleSelectAllUsers})]})]})]})}),o&&(0,A.jsx)(ye.A,{toggle:this.toggleBatchSetQuotaDialog,updateQuota:this.setUserQuotaInBatch}),a&&(0,A.jsx)(Ee.A,{title:(0,m.AP)("Delete Users"),message:(0,m.AP)("Are you sure you want to delete the selected user(s) ?"),executeOperation:this.deleteUserInBatch,confirmBtnText:(0,m.AP)("Delete"),toggleDialog:this.toggleBatchDeleteUserDialog}),this.state.pageInfo&&(0,A.jsx)(X.A,{gotoPreviousPage:this.getPreviousPageList,gotoNextPage:this.getNextPageList,currentPage:this.state.pageInfo.current_page,hasNextPage:this.state.pageInfo.has_next_page,curPerPage:this.state.perPage,resetPerPage:this.resetPerPage})]})}}])}(l.Component),vt=xt,At=n(99121),Pt=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).toggle=function(){n.props.toggle()},n.handleRateLimitChange=function(e){var t=e.target.value;n.setState({rateLimit:t,isSubmitBtnActive:""!=t.trim()})},n.handleKeyDown=function(e){"Enter"==e.key&&(n.handleSubmit(),e.preventDefault())},n.handleSubmit=function(){n.props.updateUploadDownloadRateLimit(n.props.uploadOrDownload,n.state.rateLimit.trim()),n.toggle()},n.state={rateLimit:"",isSubmitBtnActive:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.state,t=e.rateLimit,n=e.isSubmitBtnActive;return(0,A.jsxs)(u.A,{isOpen:!0,toggle:this.toggle,children:[(0,A.jsx)(be.A,{toggle:this.toggle,children:"upload"==this.props.uploadOrDownload?(0,m.AP)("Set Upload Rate Limit"):(0,m.AP)("Set Download Rate Limit")}),(0,A.jsx)(je.A,{children:(0,A.jsx)(Ie.A,{children:(0,A.jsxs)(ke.A,{children:[(0,A.jsxs)(Ne.A,{children:[(0,A.jsx)(W.A,{type:"text",className:"form-control",value:t,onKeyDown:this.handleKeyDown,onChange:this.handleRateLimitChange}),(0,A.jsx)(Me.A,{addonType:"append",children:(0,A.jsx)(At.A,{children:"kB/s"})})]}),(0,A.jsxs)("p",{className:"small text-secondary mt-2 mb-2",children:[(0,m.AP)("An integer that is greater than or equal to 0."),(0,A.jsx)("br",{}),(0,m.AP)("Tip: 0 means default limit")]})]})})}),(0,A.jsxs)(De.A,{children:[(0,A.jsx)(S.A,{color:"secondary",onClick:this.toggle,children:(0,m.AP)("Cancel")}),(0,A.jsx)(S.A,{color:"primary",onClick:this.handleSubmit,disabled:!n,children:(0,m.AP)("Submit")})]})]})}}])}(l.Component),yt=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleInputChange=function(e){var t=e.target.value;n.setState({value:t})},n.handleKeyDown=function(e){"Enter"==e.key&&(n.handleSubmit(),e.preventDefault())},n.handleSubmit=function(){n.props.updateValue(n.state.value.trim()),n.props.toggleDialog()},n.state={value:n.props.value,isSubmitBtnActive:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.toggleDialog;return(0,A.jsxs)(u.A,{isOpen:!0,toggle:e,children:[(0,A.jsx)(be.A,{toggle:e,children:this.props.dialogTitle}),(0,A.jsx)(je.A,{children:(0,A.jsx)(Ie.A,{children:(0,A.jsx)(ke.A,{children:(0,A.jsx)(W.A,{type:"text",value:this.state.value,onKeyDown:this.handleKeyDown,onChange:this.handleInputChange})})})}),(0,A.jsxs)(De.A,{children:[(0,A.jsx)(S.A,{color:"secondary",onClick:e,children:(0,m.AP)("Cancel")}),(0,A.jsx)(S.A,{color:"primary",onClick:this.handleSubmit,children:(0,m.AP)("Submit")})]})]})}}])}(l.Component),bt=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).navItems=[{name:"info",urlPart:"",text:(0,m.AP)("Info")},{name:"owned-repos",urlPart:"owned-libraries",text:(0,m.AP)("Owned Libraries")},{name:"shared-repos",urlPart:"shared-libraries",text:(0,m.AP)("Shared Libraries")},{name:"links",urlPart:"shared-links",text:(0,m.AP)("Shared Links")},{name:"groups",urlPart:"groups",text:(0,m.AP)("Groups")}],n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props,t=e.currentItem,n=e.email,r=e.userName;return(0,A.jsxs)("div",{children:[(0,A.jsx)("div",{className:"cur-view-path",children:(0,A.jsxs)("h3",{className:"sf-heading",children:[(0,A.jsx)(g.N_,{to:"".concat(m.Yc,"sys/users/"),children:(0,m.AP)("Users")})," / ",r]})}),(0,A.jsx)("ul",{className:"nav border-bottom mx-4",children:this.navItems.map((function(e,r){return(0,A.jsx)("li",{className:"nav-item mr-2",children:(0,A.jsx)(g.N_,{to:"".concat(m.Yc,"sys/users/").concat(encodeURIComponent(n),"/").concat(e.urlPart),className:"nav-link ".concat(t==e.name?" active":""),children:e.text})},r)}))})]})}}])}(l.Component),jt=bt,St=window.sysadmin.pageOptions,Dt=St.twoFactorAuthEnabled,wt=St.availableRoles,It=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleSetQuotaDialog=function(){n.setState({isSetQuotaDialogOpen:!n.state.isSetQuotaDialogOpen})},n.toggleSetUserUploadRateLimitDialog=function(){n.setState({isSetUserUploadRateLimitDialogOpen:!n.state.isSetUserUploadRateLimitDialogOpen})},n.toggleSetUserDownloadRateLimitDialog=function(){n.setState({isSetUserDownloadRateLimitDialogOpen:!n.state.isSetUserDownloadRateLimitDialogOpen})},n.updateQuota=function(e){n.props.updateUser("quota_total",e)},n.updateUploadDownloadRateLimit=function(e,t){"upload"==e&&n.props.updateUser("upload_rate_limit",t),"download"==e&&n.props.updateUser("download_rate_limit",t)},n.toggleDialog=function(e,t){n.setState({currentKey:e,dialogTitle:t,isUpdateUserDialogOpen:!n.state.isUpdateUserDialogOpen})},n.toggleSetNameDialog=function(){n.toggleDialog("name",(0,m.AP)("Set Name"))},n.toggleSetUserLoginIDDialog=function(){n.toggleDialog("login_id",(0,m.AP)("Set Login ID"))},n.toggleSetUserComtactEmailDialog=function(){n.toggleDialog("contact_email",(0,m.AP)("Set Contact Email"))},n.updateValue=function(e){n.props.updateUser(n.state.currentKey,e)},n.toggleUpdateUserDialog=function(){n.toggleDialog("","")},n.showEditIcon=function(e){return(0,A.jsx)("span",{title:(0,m.AP)("Edit"),className:"sf3-font sf3-font-rename attr-action-icon",onClick:e})},n.state={currentKey:"",dialogTitle:"",isSetQuotaDialogOpen:!1,isSetUserUploadRateLimitDialogOpen:!1,isSetUserDownloadRateLimitDialogOpen:!1,isUpdateUserDialogOpen:!1,highlight:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg,r=this.state.highlight;if(t)return(0,A.jsx)(I.A,{});if(n)return(0,A.jsx)("p",{className:"error text-center mt-4",children:n});var i=this.props.userInfo,s=this.state,a=s.currentKey,o=s.dialogTitle,c=s.isSetQuotaDialogOpen,d=s.isUpdateUserDialogOpen,h=s.isSetUserUploadRateLimitDialogOpen,u=s.isSetUserDownloadRateLimitDialogOpen;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("dl",{className:"m-0",children:[(0,A.jsx)("dt",{className:"info-item-heading",children:(0,m.AP)("Avatar")}),(0,A.jsx)("dd",{className:"info-item-content",children:(0,A.jsx)("img",{src:i.avatar_url,alt:i.name,width:"80",className:"rounded"})}),(0,A.jsx)("dt",{className:"info-item-heading",children:(0,m.AP)("Email")}),(0,A.jsx)("dd",{className:"info-item-content",children:i.email}),i.org_name&&(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)("dt",{className:"info-item-heading",children:(0,m.AP)("Organization")}),(0,A.jsx)("dd",{className:"info-item-content",children:i.org_name})]}),(0,A.jsx)("dt",{className:"info-item-heading",children:(0,m.AP)("Name")}),(0,A.jsxs)("dd",{className:"info-item-content",children:[i.name||"--",this.showEditIcon(this.toggleSetNameDialog)]}),(0,A.jsx)("dt",{className:"info-item-heading",children:(0,m.AP)("Login ID")}),(0,A.jsxs)("dd",{className:"info-item-content",children:[i.login_id||"--",this.showEditIcon(this.toggleSetUserLoginIDDialog)]}),(0,A.jsx)("dt",{className:"info-item-heading",children:(0,m.AP)("Contact Email")}),(0,A.jsxs)("dd",{className:"info-item-content",children:[i.contact_email||"--",this.showEditIcon(this.toggleSetUserComtactEmailDialog)]}),(0,A.jsx)("dt",{className:"info-item-heading",children:(0,m.AP)("Role")}),(0,A.jsx)("dd",{className:"info-item-content",children:(0,A.jsx)(Ve.A,{isDropdownToggleShown:r,currentSelectedOption:this.props.currentSelectedRoleOption,options:this.props.roleOptions,selectOption:this.props.updateRole,toggleItemFreezed:this.props.toggleItemFreezed})}),(0,A.jsx)("dt",{className:"info-item-heading",children:(0,m.AP)("Space Used / Quota")}),(0,A.jsxs)("dd",{className:"info-item-content",children:["".concat(f.Aq.bytesToSize(i.quota_usage)," / ").concat(i.quota_total>0?f.Aq.bytesToSize(i.quota_total):"--"),this.showEditIcon(this.toggleSetQuotaDialog)]}),m.am&&(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)("dt",{className:"info-item-heading",children:(0,m.AP)("Upload Rate Limit")}),(0,A.jsxs)("dd",{className:"info-item-content",children:[i.upload_rate_limit>0?i.upload_rate_limit+" kB/s":"--",this.showEditIcon(this.toggleSetUserUploadRateLimitDialog)]}),(0,A.jsx)("dt",{className:"info-item-heading",children:(0,m.AP)("Download Rate Limit")}),(0,A.jsxs)("dd",{className:"info-item-content",children:[i.download_rate_limit>0?i.download_rate_limit+" kB/s":"--",this.showEditIcon(this.toggleSetUserDownloadRateLimitDialog)]})]}),Dt&&(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)("dt",{className:"info-item-heading",children:(0,m.AP)("Two-Factor Authentication")}),(0,A.jsxs)("dd",{className:"info-item-content",children:[i.has_default_device?(0,A.jsxs)(ke.A,{children:[(0,A.jsx)("p",{className:"mb-1",children:(0,m.AP)("Status: enabled")}),(0,A.jsx)(S.A,{onClick:this.props.disable2FA,children:(0,m.AP)("Disable Two-Factor Authentication")})]}):(0,A.jsx)(ke.A,{children:(0,A.jsx)(S.A,{disabled:!0,children:(0,m.AP)("Disable Two-Factor Authentication")})}),(0,A.jsx)(ke.A,{check:!0,children:(0,A.jsxs)(_e.A,{check:!0,children:[(0,A.jsx)(W.A,{type:"checkbox",checked:i.is_force_2fa,onChange:this.props.toggleForce2fa}),(0,A.jsx)("span",{children:(0,m.AP)("Force Two-Factor Authentication")})]})})]})]})]}),c&&(0,A.jsx)(ye.A,{updateQuota:this.updateQuota,toggle:this.toggleSetQuotaDialog}),m.am&&h&&(0,A.jsx)(Pt,{uploadOrDownload:"upload",updateUploadDownloadRateLimit:this.updateUploadDownloadRateLimit,toggle:this.toggleSetUserUploadRateLimitDialog}),m.am&&u&&(0,A.jsx)(Pt,{uploadOrDownload:"download",updateUploadDownloadRateLimit:this.updateUploadDownloadRateLimit,toggle:this.toggleSetUserDownloadRateLimitDialog}),d&&(0,A.jsx)(yt,{dialogTitle:o,value:i[a],updateValue:this.updateValue,toggleDialog:this.toggleUpdateUserDialog})]})}}])}(l.Component),kt=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).updateUser=function(e,t){var r=n.state.userInfo.email;D.e.sysAdminUpdateUser(r,e,t).then((function(t){var r=n.state.userInfo;r[e]=t.data[e],n.setState({userInfo:r}),w.A.success((0,m.AP)("Edit succeeded"))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.updateRole=function(e){n.updateUser("role",e.value)},n.disable2FA=function(){var e=n.state.userInfo.email;D.e.sysAdminDeleteTwoFactorAuth(e).then((function(e){var t=n.state.userInfo;t.has_default_device=!1,n.setState({userInfo:t})})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.toggleForce2fa=function(e){var t=n.state.userInfo.email,r=e.target.checked;D.e.sysAdminSetForceTwoFactorAuth(t,r).then((function(e){var t=n.state.userInfo;t.is_force_2fa=r,n.setState({userInfo:t})})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.translateRole=function(e){switch(e){case"default":return(0,m.AP)("Default");case"guest":return(0,m.AP)("Guest");default:return e}},n.state={loading:!0,errorMsg:"",userInfo:{}},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=decodeURIComponent(this.props.email);D.e.sysAdminGetUser(t,160).then((function(t){e.setState({loading:!1,userInfo:t.data})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e,t=this,n=this.state.userInfo,i=n.role;return this.roleOptions=wt.map((function(e){return{value:e,text:t.translateRole(e),isSelected:e==i}})),e=this.roleOptions.filter((function(e){return e.isSelected}))[0]||{value:i,text:this.translateRole(i),isSelected:!0},(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)({},this.props)),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)(jt,{currentItem:"info",email:this.props.email,userName:n.name}),(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsx)(It,{loading:this.state.loading,errorMsg:this.state.errorMsg,userInfo:this.state.userInfo,roleOptions:this.roleOptions,currentSelectedRoleOption:e,updateRole:this.updateRole,updateUser:this.updateUser,disable2FA:this.disable2FA,toggleForce2fa:this.toggleForce2fa})})]})})]})}}])}(l.Component),_t=n(85267),Nt=window.sysadmin.pageOptions.enableSysAdminViewRepo,Mt=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.state={isItemFreezed:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,i=t.items;if(n)return(0,A.jsx)(I.A,{});if(r)return(0,A.jsx)("p",{className:"error text-center mt-4",children:r});var s=(0,A.jsx)(ie.A,{text:(0,m.AP)("No libraries")}),a=(0,A.jsx)(l.Fragment,{children:(0,A.jsxs)("table",{children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"5%"}),(0,A.jsx)("th",{width:"35%",children:(0,m.AP)("Name")}),(0,A.jsx)("th",{width:"30%",children:(0,m.AP)("Size")}),(0,A.jsx)("th",{width:"25%",children:(0,m.AP)("Last Update")}),(0,A.jsx)("th",{width:"5%"})]})}),(0,A.jsx)("tbody",{children:i.map((function(t,n){return(0,A.jsx)(Ct,{item:t,isItemFreezed:e.state.isItemFreezed,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem,deleteRepo:e.props.deleteRepo,transferRepo:e.props.transferRepo},n)}))})]})});return i.length?a:s}}])}(l.Component),Ct=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleMouseEnter=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!0,highlight:!0})},n.handleMouseLeave=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!1,highlight:!1})},n.onUnfreezedItem=function(){n.setState({highlight:!1,isOpIconShow:!1}),n.props.onUnfreezedItem()},n.toggleDeleteDialog=function(){n.setState({isDeleteDialogOpen:!n.state.isDeleteDialogOpen})},n.deleteRepo=function(){n.props.deleteRepo(n.props.item.id)},n.toggleTransferDialog=function(){n.setState({isTransferDialogOpen:!n.state.isTransferDialogOpen})},n.transferRepo=function(e){n.props.transferRepo(n.props.item.id,e.email),n.toggleTransferDialog()},n.renderRepoName=function(){var e=n.props.item;return e.name?m.am&&Nt&&!e.encrypted?(0,A.jsx)(g.N_,{to:"".concat(m.Yc,"sys/libraries/").concat(e.id,"/"),children:e.name}):e.name:(0,m.AP)("Broken ({repo_id_placeholder})").replace("{repo_id_placeholder}",e.id)},n.translateOperations=function(e){var t="";switch(e){case"Delete":t=(0,m.AP)("Delete");break;case"Transfer":t=(0,m.AP)("Transfer")}return t},n.onMenuItemClick=function(e){switch(e){case"Delete":n.toggleDeleteDialog();break;case"Transfer":n.toggleTransferDialog()}},n.state={isOpIconShown:!1,highlight:!1,isDeleteDialogOpen:!1,isTransferDialogOpen:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.item,t=this.state,n=t.isOpIconShown,r=t.isDeleteDialogOpen,i=t.isTransferDialogOpen,s=f.Aq.getLibIconUrl(e),a=f.Aq.getLibIconTitle(e),o='<span class="op-target">'+f.Aq.HTMLescape(e.name)+"</span>",c=(0,m.AP)("Are you sure you want to delete {placeholder} ?").replace("{placeholder}",o);return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,A.jsx)("td",{children:(0,A.jsx)("img",{src:s,title:a,alt:a,width:"24"})}),(0,A.jsx)("td",{children:this.renderRepoName()}),(0,A.jsx)("td",{children:f.Aq.bytesToSize(e.size)}),(0,A.jsx)("td",{children:C()(e.last_modified).fromNow()}),(0,A.jsx)("td",{children:n&&(0,A.jsx)(He.A,{operations:["Delete","Transfer"],translateOperations:this.translateOperations,onMenuItemClick:this.onMenuItemClick,onFreezedItem:this.props.onFreezedItem,onUnfreezedItem:this.onUnfreezedItem})})]}),r&&(0,A.jsx)(Ee.A,{title:(0,m.AP)("Delete Library"),message:c,executeOperation:this.deleteRepo,confirmBtnText:(0,m.AP)("Delete"),toggleDialog:this.toggleDeleteDialog}),i&&(0,A.jsx)(_t.A,{itemName:e.name,submit:this.transferRepo,canTransferToDept:!1,toggleDialog:this.toggleTransferDialog})]})}}])}(l.Component),Ot=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).deleteRepo=function(e){D.e.sysAdminDeleteRepo(e).then((function(t){var r=n.state.repoList.filter((function(t){return t.id!=e}));n.setState({repoList:r}),w.A.success((0,m.AP)("Successfully deleted 1 item."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.transferRepo=function(e,t){D.e.sysAdminTransferRepo(e,t).then((function(t){var r=n.state.repoList.filter((function(t){return t.id!=e}));n.setState({repoList:r});var i=(0,m.AP)("Successfully transferred the library.");w.A.success(i)})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.state={loading:!0,errorMsg:"",userInfo:{},repoList:[]},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=decodeURIComponent(this.props.email);D.e.sysAdminGetUser(t).then((function(t){e.setState({userInfo:t.data})})),D.e.sysAdminListReposByOwner(t).then((function(t){e.setState({loading:!1,repoList:t.data.repos})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)({},this.props)),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)(jt,{currentItem:"owned-repos",email:this.props.email,userName:this.state.userInfo.name}),(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsx)(Mt,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.repoList,deleteRepo:this.deleteRepo,transferRepo:this.transferRepo})})]})})]})}}])}(l.Component),Lt=window.sysadmin.pageOptions.enableSysAdminViewRepo,Tt=function(e){function t(){return(0,i.A)(this,t),(0,a.A)(this,t,arguments)}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg,r=e.items;if(t)return(0,A.jsx)(I.A,{});if(n)return(0,A.jsx)("p",{className:"error text-center mt-4",children:n});var i=(0,A.jsx)(l.Fragment,{children:(0,A.jsxs)("table",{className:"table-hover",children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"5%"}),(0,A.jsx)("th",{width:"35%",children:(0,m.AP)("Name")}),(0,A.jsx)("th",{width:"20%",children:(0,m.AP)("Share From")}),(0,A.jsx)("th",{width:"20%",children:(0,m.AP)("Size")}),(0,A.jsx)("th",{width:"20%",children:(0,m.AP)("Last Update")})]})}),(0,A.jsx)("tbody",{children:r.map((function(e,t){return(0,A.jsx)(Ft,{item:e},t)}))})]})});return r.length?i:(0,A.jsx)(ie.A,{text:(0,m.AP)("No libraries")})}}])}(l.Component),Ft=function(e){function t(){var e;(0,i.A)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=(0,a.A)(this,t,[].concat(r))).renderRepoName=function(){var t=e.props.item;return t.name?m.am&&Lt&&!t.encrypted?(0,A.jsx)(g.N_,{to:"".concat(m.Yc,"sys/libraries/").concat(t.id,"/"),children:t.name}):t.name:(0,m.AP)("Broken ({repo_id_placeholder})").replace("{repo_id_placeholder}",t.id)},e.getOwnerLink=function(){var t,n=e.props.item,r=n.owner_email.indexOf("@seafile_group");if(-1==r)t=(0,A.jsx)(ue,{email:n.owner_email,name:n.owner_name});else{var i=n.owner_email.substring(0,r);t=(0,A.jsx)(g.N_,{to:"".concat(m.Yc,"sys/departments/").concat(i,"/"),children:n.owner_name})}return t},e}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.item,t=f.Aq.getLibIconUrl(e),n=f.Aq.getLibIconTitle(e);return(0,A.jsx)(l.Fragment,{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("td",{children:(0,A.jsx)("img",{src:t,title:n,alt:n,width:"24"})}),(0,A.jsx)("td",{children:this.renderRepoName()}),(0,A.jsx)("td",{children:this.getOwnerLink()}),(0,A.jsx)("td",{children:f.Aq.bytesToSize(e.size)}),(0,A.jsx)("td",{children:C()(e.last_modify).fromNow()})]})})}}])}(l.Component),Rt=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).state={loading:!0,errorMsg:"",userInfo:{},repoList:[]},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=decodeURIComponent(this.props.email);D.e.sysAdminGetUser(t).then((function(t){e.setState({userInfo:t.data})})),D.e.sysAdminListShareInRepos(t).then((function(t){e.setState({loading:!1,repoList:t.data.repo_list})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)({},this.props)),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)(jt,{currentItem:"shared-repos",email:this.props.email,userName:this.state.userInfo.name}),(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsx)(Tt,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.repoList})})]})})]})}}])}(l.Component),Et=Rt,Ut=n(91611),zt=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.state={isItemFreezed:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,i=t.items;if(n)return(0,A.jsx)(I.A,{});if(r)return(0,A.jsx)("p",{className:"error text-center mt-4",children:r});var s=(0,A.jsx)(ie.A,{text:(0,m.AP)("No shared links")}),a=(0,A.jsx)(l.Fragment,{children:(0,A.jsxs)("table",{children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"5%"}),(0,A.jsx)("th",{width:"30%",children:(0,m.AP)("Name")}),(0,A.jsx)("th",{width:"20%",children:(0,m.AP)("Size")}),(0,A.jsx)("th",{width:"20%",children:(0,m.AP)("Type")}),(0,A.jsx)("th",{width:"20%",children:(0,m.AP)("Visits")}),(0,A.jsx)("th",{width:"5%"})]})}),(0,A.jsx)("tbody",{children:i.map((function(t,n){return(0,A.jsx)(Bt,{item:t,isItemFreezed:e.state.isItemFreezed,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem,deleteItem:e.props.deleteItem},n)}))})]})});return i.length?a:s}}])}(l.Component),Bt=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleMouseEnter=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!0,highlight:!0})},n.handleMouseLeave=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!1,highlight:!1})},n.onUnfreezedItem=function(){n.setState({highlight:!1,isOpIconShow:!1}),n.props.onUnfreezedItem()},n.toggleLinkDialog=function(){n.setState({isLinkDialogOpen:!n.state.isLinkDialogOpen})},n.deleteItem=function(){n.props.deleteItem(n.props.item)},n.translateOperations=function(e){var t="";switch(e){case"View":t=(0,m.AP)("View");break;case"Delete":t=(0,m.AP)("Delete")}return t},n.onMenuItemClick=function(e){switch(e){case"View":n.toggleLinkDialog();break;case"Delete":n.deleteItem()}},n.getRoleText=function(){var e;switch(n.props.item.role){case"Owner":e=(0,m.AP)("Owner");break;case"Admin":e=(0,m.AP)("Admin");break;case"Member":e=(0,m.AP)("Member")}return e},n.getIconUrl=function(){var e=n.props.item;return"upload"==e.type||e.is_dir?f.Aq.getFolderIconUrl():f.Aq.getFileIconUrl(e.obj_name)},n.state={isOpIconShown:!1,highlight:!1,isLinkDialogOpen:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.item,t=this.state,n=t.isOpIconShown,r=t.isLinkDialogOpen;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,A.jsx)("td",{children:(0,A.jsx)("img",{src:this.getIconUrl(),alt:"",width:"24"})}),(0,A.jsx)("td",{children:"/"==e.obj_name?e.repo_name:e.obj_name}),"upload"==e.type?(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)("td",{}),(0,A.jsx)("td",{children:(0,m.AP)("Upload")})]}):(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)("td",{children:e.is_dir?null:f.Aq.bytesToSize(e.size)}),(0,A.jsx)("td",{children:(0,m.AP)("Download")})]}),(0,A.jsx)("td",{children:e.view_cnt}),(0,A.jsx)("td",{children:n&&(0,A.jsx)(He.A,{operations:["View","Delete"],translateOperations:this.translateOperations,onMenuItemClick:this.onMenuItemClick,onFreezedItem:this.props.onFreezedItem,onUnfreezedItem:this.onUnfreezedItem})})]}),r&&(0,A.jsx)(Ut.A,{link:e.link,toggleDialog:this.toggleLinkDialog})]})}}])}(l.Component),qt=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).deleteItem=function(e){var t=e.type,r=e.token;"download"==t?D.e.sysAdminDeleteShareLink(r).then((function(e){var t=n.state.shareLinkItems.filter((function(e){return e.token!=r}));n.setState({shareLinkItems:t}),w.A.success((0,m.AP)("Successfully deleted 1 item."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)})):D.e.sysAdminDeleteUploadLink(r).then((function(e){var t=n.state.uploadLinkItems.filter((function(e){return e.token!=r}));n.setState({uploadLinkItems:t}),w.A.success((0,m.AP)("Successfully deleted 1 item."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.state={loading:!0,errorMsg:"",userInfo:{},uploadLinkItems:[],shareLinkItems:[]},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=decodeURIComponent(this.props.email);D.e.sysAdminGetUser(t).then((function(t){e.setState({userInfo:t.data})})),D.e.sysAdminListShareLinksByUser(t).then((function(t){var n=t.data.share_link_list.map((function(e){return e.type="download",e}));n.sort((function(e,t){return e.is_dir?-1:1})),e.setState({loading:!1,shareLinkItems:n})})),D.e.sysAdminListUploadLinksByUser(t).then((function(t){var n=t.data.upload_link_list.map((function(e){return e.type="upload",e}));e.setState({loading:!1,uploadLinkItems:n})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this.state,t=e.shareLinkItems,n=e.uploadLinkItems;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)({},this.props)),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)(jt,{currentItem:"links",email:this.props.email,userName:this.state.userInfo.name}),(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsx)(zt,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:[].concat(n,t),deleteItem:this.deleteItem})})]})})]})}}])}(l.Component),Yt=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.state={isItemFreezed:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,i=t.items;if(n)return(0,A.jsx)(I.A,{});if(r)return(0,A.jsx)("p",{className:"error text-center mt-4",children:r});var s=(0,A.jsx)(ie.A,{text:(0,m.AP)("No groups")}),a=(0,A.jsx)(l.Fragment,{children:(0,A.jsxs)("table",{children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"35%",children:(0,m.AP)("Name")}),(0,A.jsx)("th",{width:"30%",children:(0,m.AP)("Role")}),(0,A.jsx)("th",{width:"35%",children:(0,m.AP)("Created At")})]})}),(0,A.jsx)("tbody",{children:i.map((function(t,n){return(0,A.jsx)(Vt,{item:t,isItemFreezed:e.state.isItemFreezed,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem},n)}))})]})});return i.length?a:s}}])}(l.Component),Vt=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleMouseEnter=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!0,highlight:!0})},n.handleMouseLeave=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!1,highlight:!1})},n.onUnfreezedItem=function(){n.setState({highlight:!1,isOpIconShow:!1}),n.props.onUnfreezedItem()},n.getRoleText=function(){var e;switch(n.props.item.role){case"Owner":e=(0,m.AP)("Owner");break;case"Admin":e=(0,m.AP)("Admin");break;case"Member":e=(0,m.AP)("Member")}return e},n.state={isOpIconShown:!1,highlight:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.item,t=0==e.parent_group_id?"".concat(m.Yc,"sys/groups/").concat(e.id,"/libraries/"):"".concat(m.Yc,"sys/departments/").concat(e.id,"/");return(0,A.jsx)(l.Fragment,{children:(0,A.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,A.jsx)("td",{children:(0,A.jsx)(g.N_,{to:t,children:e.name})}),(0,A.jsx)("td",{children:this.getRoleText()}),(0,A.jsx)("td",{children:C()(e.created_at).format("YYYY-MM-DD HH:mm")})]})})}}])}(l.Component),Ht=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).state={loading:!0,errorMsg:"",userInfo:{},items:[]},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=decodeURIComponent(this.props.email);D.e.sysAdminGetUser(t).then((function(t){e.setState({userInfo:t.data})})),D.e.sysAdminListGroupsJoinedByUser(t).then((function(t){e.setState({loading:!1,items:t.data.group_list})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)({},this.props)),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)(jt,{currentItem:"groups",email:this.props.email,userName:this.state.userInfo.name}),(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsx)(Yt,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.items})})]})})]})}}])}(l.Component),Wt=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleRepoNameChange=function(e){var t=e.target.value;n.setState({repoName:t,isSubmitBtnActive:t.trim()})},n.handleSubmit=function(){var e=n.state,t=e.repoName,r=e.ownerEmail;n.props.createRepo(t.trim(),r),n.toggle()},n.handleSelectChange=function(e){n.setState({ownerEmail:e?e.email:""})},n.handleKeyDown=function(e){"Enter"===e.key&&(n.handleSubmit(),e.preventDefault())},n.toggle=function(){n.props.toggleDialog()},n.state={repoName:"",ownerEmail:"",errMessage:"",isSubmitBtnActive:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){return(0,A.jsxs)(u.A,{isOpen:!0,toggle:this.toggle,autoFocus:!1,children:[(0,A.jsx)(be.A,{toggle:this.toggle,children:(0,m.AP)("New Library")}),(0,A.jsxs)(je.A,{children:[(0,A.jsxs)(Ie.A,{children:[(0,A.jsxs)(ke.A,{children:[(0,A.jsx)(_e.A,{for:"repoName",children:(0,m.AP)("Name")}),(0,A.jsx)(W.A,{id:"repoName",onKeyDown:this.handleKeyDown,value:this.state.repoName,onChange:this.handleRepoNameChange,autoFocus:!0})]}),(0,A.jsxs)(ke.A,{children:[(0,A.jsxs)(_e.A,{for:"userSelect",children:[(0,m.AP)("Owner"),(0,A.jsx)("span",{className:"small text-secondary",children:(0,m.AP)("(If left blank, owner will be admin)")})]}),(0,A.jsx)(Fe.A,{id:"userSelect",isMulti:!1,placeholder:(0,m.AP)("Select a user"),onSelectChange:this.handleSelectChange})]})]}),this.state.errMessage&&(0,A.jsx)(Se.A,{color:"danger",children:this.state.errMessage})]}),(0,A.jsxs)(De.A,{children:[(0,A.jsx)(S.A,{color:"secondary",onClick:this.toggle,children:(0,m.AP)("Cancel")}),(0,A.jsx)(S.A,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive,children:(0,m.AP)("Submit")})]})]})}}])}(l.Component),Gt=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).navItems=[{name:"all",urlPart:"all-libraries",text:(0,m.AP)("All")},{name:"system",urlPart:"system-library",text:(0,m.AP)("System")},{name:"trash",urlPart:"trash-libraries",text:(0,m.AP)("Trash")}],n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.currentItem;return(0,A.jsx)("div",{className:"cur-view-path tab-nav-container",children:(0,A.jsx)("ul",{className:"nav",children:this.navItems.map((function(t,n){return(0,A.jsx)("li",{className:"nav-item",children:(0,A.jsx)(g.N_,{to:"".concat(m.Yc,"sys/").concat(t.urlPart,"/"),className:"nav-link".concat(e==t.name?" active":""),children:t.text})},n)}))})})}}])}(l.Component),Qt=Gt,Kt=n(40866),Xt=n(73606),$t=n(52308),Zt=n(8743),Jt=n(36640),en=n(51445),tn=n(52088),nn=n(89470),rn=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).onMouseEnter=function(){n.setState({isOperationShow:!0})},n.onMouseLeave=function(){n.setState({isOperationShow:!1})},n.deleteShareItem=function(){var e=n.props.item;n.props.deleteShareItem(e.user_email)},n.onChangeUserPermission=function(e){var t=n.props.item;n.props.onChangeUserPermission(t,e)},n.state={isOperationShow:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.item,t=f.Aq.getSharedPermission(e);return(0,A.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[(0,A.jsx)("td",{className:"name",children:e.user_name}),(0,A.jsx)("td",{children:(0,A.jsx)(nn.A,{repoID:e.repo_id,isTextMode:!0,autoFocus:!0,isEditIconShow:this.state.isOperationShow,currentPermission:t,permissions:this.props.permissions,onPermissionChanged:this.onChangeUserPermission,isSysAdmin:!0})}),(0,A.jsx)("td",{children:(0,A.jsx)("span",{className:"sf2-icon-x3 action-icon ".concat(this.state.isOperationShow?"":"hide"),onClick:this.deleteShareItem,title:(0,m.AP)("Delete")})})]})}}])}(l.Component),sn=function(e){function t(){return(0,i.A)(this,t),(0,a.A)(this,t,arguments)}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this,t=this.props.items;return(0,A.jsx)("tbody",{children:t.map((function(t,n){return(0,A.jsx)(rn,{item:t,permissions:e.props.permissions,deleteShareItem:e.props.deleteShareItem,onChangeUserPermission:e.props.onChangeUserPermission},n)}))})}}])}(l.Component),an=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleSelectChange=function(e){n.setState({selectedOption:e}),n.options=[]},n.setPermission=function(e){n.setState({permission:e})},n.shareToUser=function(){var e=[],t=n.props.repoID;if(n.state.selectedOption&&n.state.selectedOption.length>0)for(var r=0;r<n.state.selectedOption.length;r++)e[r]=n.state.selectedOption[r].email;D.e.sysAdminAddRepoSharedItem(t,"user",e,n.state.permission).then((function(e){var t=[];if(e.data.failed.length>0)for(var r=0;r<e.data.failed.length;r++)t[r]=e.data.failed[r];var i=e.data.success;n.setState({errorMsg:t,sharedItems:n.state.sharedItems.concat(i),selectedOption:null,permission:"rw"}),n.refs.userSelect.clearSelect()})).catch((function(e){if(e.response){var t=(0,m.AP)("Library can not be shared to owner."),r=[];r.push(t),n.setState({errorMsg:r,selectedOption:null})}}))},n.deleteShareItem=function(e){var t=n.props.repoID;D.e.sysAdminDeleteRepoSharedItem(t,"user",e).then((function(t){n.setState({sharedItems:n.state.sharedItems.filter((function(t){return t.user_email!==e}))})})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.onChangeUserPermission=function(e,t){var r=n.props.repoID,i=e.user_email;D.e.sysAdminUpdateRepoSharedItemPermission(r,"user",i,t).then((function(){n.updateSharedItems(e,t)})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.updateSharedItems=function(e,t){var r=e.user_name,i=n.state.sharedItems.map((function(e){var n=e.user_name;return r===n&&(e.permission=t,e.is_admin="admin"===t),e}));n.setState({sharedItems:i})},n.state={selectedOption:null,errorMsg:[],permission:"rw",sharedItems:[]},n.options=[],n.permissions=["rw","r"],m.am&&n.permissions.push("admin","cloud-edit","preview"),n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.repoID;D.e.sysAdminListRepoSharedItems(t,"user").then((function(t){0!==t.data.length&&e.setState({sharedItems:t.data})})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))}},{key:"render",value:function(){var e=this.state.sharedItems;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("table",{children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"50%",children:(0,m.AP)("User")}),(0,A.jsx)("th",{width:"35%",children:(0,m.AP)("Permission")}),(0,A.jsx)("th",{width:"15%"})]})}),(0,A.jsxs)("tbody",{children:[(0,A.jsxs)("tr",{children:[(0,A.jsx)("td",{children:(0,A.jsx)(Fe.A,{ref:"userSelect",isMulti:!0,placeholder:(0,m.AP)("Search users"),onSelectChange:this.handleSelectChange})}),(0,A.jsx)("td",{children:(0,A.jsx)(nn.A,{repoID:this.props.repoID,isTextMode:!1,isEditIconShow:!1,currentPermission:this.state.permission,permissions:this.permissions,onPermissionChanged:this.setPermission,isSysAdmin:!0})}),(0,A.jsx)("td",{children:(0,A.jsx)(S.A,{color:"primary",onClick:this.shareToUser,children:(0,m.AP)("Submit")})})]}),this.state.errorMsg.length>0&&this.state.errorMsg.map((function(e,t){var n="";return n=e.email?e.email+": "+e.error_msg:e,(0,A.jsx)("tr",{children:(0,A.jsx)("td",{colSpan:3,children:(0,A.jsx)("p",{className:"error",children:n})})},t)}))]})]}),(0,A.jsx)("div",{className:"share-list-container",children:(0,A.jsxs)("table",{className:"table-thead-hidden",children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"50%",children:(0,m.AP)("User")}),(0,A.jsx)("th",{width:"35%",children:(0,m.AP)("Permission")}),(0,A.jsx)("th",{width:"15%"})]})}),(0,A.jsx)(sn,{items:e,permissions:this.permissions,deleteShareItem:this.deleteShareItem,onChangeUserPermission:this.onChangeUserPermission})]})})]})}}])}(l.Component),on=an,ln=n(76229),cn=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).onMouseEnter=function(){n.setState({isOperationShow:!0})},n.onMouseLeave=function(){n.setState({isOperationShow:!1})},n.deleteShareItem=function(){var e=n.props.item;n.props.deleteShareItem(e.group_id)},n.onChangeUserPermission=function(e){var t=n.props.item;n.props.onChangeUserPermission(t,e)},n.state={isOperationShow:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.item,t=f.Aq.getSharedPermission(e);return(0,A.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[(0,A.jsx)("td",{className:"name",children:e.group_name}),(0,A.jsx)("td",{children:(0,A.jsx)(nn.A,{repoID:e.repo_id,isTextMode:!0,autoFocus:!0,isEditIconShow:this.state.isOperationShow,currentPermission:t,permissions:this.props.permissions,onPermissionChanged:this.onChangeUserPermission,isSysAdmin:!0})}),(0,A.jsx)("td",{children:(0,A.jsx)("span",{className:"sf2-icon-x3 action-icon ".concat(this.state.isOperationShow?"":"hide"),onClick:this.deleteShareItem,title:(0,m.AP)("Delete")})})]})}}])}(l.Component),dn=function(e){function t(){return(0,i.A)(this,t),(0,a.A)(this,t,arguments)}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this,t=this.props.items;return(0,A.jsx)("tbody",{children:t.map((function(t,n){return(0,A.jsx)(cn,{item:t,permissions:e.props.permissions,deleteShareItem:e.props.deleteShareItem,onChangeUserPermission:e.props.onChangeUserPermission},n)}))})}}])}(l.Component),hn=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleSelectChange=function(e){n.setState({selectedOption:e})},n.loadOptions=function(){D.e.shareableGroups().then((function(e){n.options=[];for(var t=0;t<e.data.length;t++){var r={};r.value=e.data[t].name,r.id=e.data[t].id,r.label=e.data[t].name,n.options.push(r)}})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.listSharedGroups=function(){var e=n.props.repoID;D.e.sysAdminListRepoSharedItems(e,"group").then((function(e){0!==e.data.length&&n.setState({sharedItems:e.data})})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.setPermission=function(e){n.setState({permission:e})},n.shareToGroup=function(){var e=[],t=n.props.repoID;n.state.selectedOption&&(e[0]=n.state.selectedOption.id),D.e.sysAdminAddRepoSharedItem(t,"group",e,n.state.permission).then((function(e){var t=[];if(e.data.failed.length>0)for(var r=0;r<e.data.failed.length;r++)t[r]=e.data.failed[r];var i=e.data.success;n.setState({errorMsg:t,sharedItems:n.state.sharedItems.concat(i),selectedOption:null,permission:"rw"})})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.deleteShareItem=function(e){var t=n.props.repoID;D.e.sysAdminDeleteRepoSharedItem(t,"group",e).then((function(){n.setState({sharedItems:n.state.sharedItems.filter((function(t){return t.group_id!==e}))})})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.onChangeUserPermission=function(e,t){var r=n.props.repoID,i=e.group_id;D.e.sysAdminUpdateRepoSharedItemPermission(r,"group",i,t).then((function(){n.updateSharedItems(e,t)})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.updateSharedItems=function(e,t){var r=e.group_id,i=n.state.sharedItems.map((function(e){var n=e.group_id;return r===n&&(e.permission=t,e.is_admin="admin"===t),e}));n.setState({sharedItems:i})},n.state={selectedOption:null,errorMsg:[],permission:"rw",sharedItems:[]},n.options=[],n.permissions=["rw","r"],m.am&&n.permissions.push("admin","cloud-edit","preview"),n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){this.loadOptions(),this.listSharedGroups()}},{key:"render",value:function(){return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("table",{children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"50%",children:(0,m.AP)("Group")}),(0,A.jsx)("th",{width:"35%",children:(0,m.AP)("Permission")}),(0,A.jsx)("th",{width:"15%"})]})}),(0,A.jsxs)("tbody",{children:[(0,A.jsxs)("tr",{children:[(0,A.jsx)("td",{children:(0,A.jsx)(ln.by,{onChange:this.handleSelectChange,options:this.options,placeholder:(0,m.AP)("Select groups"),maxMenuHeight:200,value:this.state.selectedOption,components:{NoOptionsMessage:ln.iI}})}),(0,A.jsx)("td",{children:(0,A.jsx)(nn.A,{repoID:this.props.repoID,isTextMode:!1,isEditIconShow:!1,currentPermission:this.state.permission,permissions:this.permissions,onPermissionChanged:this.setPermission,isSysAdmin:!0})}),(0,A.jsx)("td",{children:(0,A.jsx)(S.A,{color:"primary",onClick:this.shareToGroup,children:(0,m.AP)("Submit")})})]}),this.state.errorMsg.length>0&&this.state.errorMsg.map((function(e,t){var n=e.group_name+": "+e.error_msg;return(0,A.jsx)("tr",{children:(0,A.jsx)("td",{colSpan:3,children:(0,A.jsx)("p",{className:"error",children:n})})},t)}))]})]}),(0,A.jsx)("div",{className:"share-list-container",children:(0,A.jsxs)("table",{className:"table-thead-hidden",children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"50%",children:(0,m.AP)("Group")}),(0,A.jsx)("th",{width:"35%",children:(0,m.AP)("Permission")}),(0,A.jsx)("th",{width:"15%"})]})}),(0,A.jsx)(dn,{items:this.state.sharedItems,permissions:this.permissions,deleteShareItem:this.deleteShareItem,onChangeUserPermission:this.onChangeUserPermission})]})})]})}}])}(l.Component),un=hn,gn=(n(59625),function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).getInitialActiveTab=function(){return"shareToUser"},n.toggle=function(e){n.state.activeTab!==e&&n.setState({activeTab:e})},n.renderDirContent=function(){var e=n.state.activeTab,t=n.props,r=t.enableDirPrivateShare,i=t.isGroupOwnedRepo;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)("div",{className:"share-dialog-side",children:(0,A.jsx)($t.A,{pills:!0,children:r&&(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(Zt.A,{children:(0,A.jsx)(Jt.A,{className:"shareToUser"===e?"active":"",onClick:n.toggle.bind(n,"shareToUser"),children:(0,m.AP)("Share to user")})}),(0,A.jsx)(Zt.A,{children:(0,A.jsx)(Jt.A,{className:"shareToGroup"===e?"active":"",onClick:n.toggle.bind(n,"shareToGroup"),children:(0,m.AP)("Share to group")})})]})})}),(0,A.jsx)("div",{className:"share-dialog-main",children:(0,A.jsx)(en.A,{activeTab:n.state.activeTab,children:r&&(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(tn.A,{tabId:"shareToUser",children:(0,A.jsx)(on,{itemType:"library",isGroupOwnedRepo:i,itemPath:n.props.itemPath,repoID:n.props.repoID,isRepoOwner:n.state.isRepoOwner})}),(0,A.jsx)(tn.A,{tabId:"shareToGroup",children:(0,A.jsx)(un,{itemType:"library",isGroupOwnedRepo:i,itemPath:n.props.itemPath,repoID:n.props.repoID,isRepoOwner:n.state.isRepoOwner})})]})})})]})},n.state={activeTab:n.getInitialActiveTab(),isRepoOwner:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){return(0,A.jsx)("div",{children:(0,A.jsxs)(u.A,{isOpen:!0,style:{maxWidth:"720px"},className:"share-dialog",toggle:this.props.toggleDialog,children:[(0,A.jsxs)(be.A,{toggle:this.props.toggleDialog,children:[(0,m.AP)("Share")," ",(0,A.jsx)("span",{className:"op-target",title:this.props.itemName,children:this.props.itemName})]}),(0,A.jsx)(je.A,{className:"share-dialog-content",children:this.renderDirContent()})]})})}}])}(l.Component)),pn=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).submit=function(){var e=n.state.keepDays;n.state.autoHistory&&(e=n.state.expireDays);var t=n.props.repoID;if(/^-?\d+$/.test(e)){var r=(0,m.AP)("Successfully set library history.");D.e.sysAdminUpdateRepoHistorySetting(t,e).then((function(e){w.A.success(r),n.setState({keepDays:e.data.keep_days}),n.props.toggleDialog()})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))}else n.setState({errorInfo:(0,m.AP)("Please enter a non-negative integer")})},n.handleKeyDown=function(e){"Enter"===e.key&&(n.submit(),e.preventDefault())},n.onChange=function(e){var t=e.target.value;n.setState({keepDays:t,expireDays:t})},n.setLimitDays=function(e){"allHistory"===e?n.setState({keepDays:-1}):"noHistory"===e?n.setState({keepDays:0}):n.setState({disabled:!1}),n.setState({allHistory:"allHistory"===e,noHistory:"noHistory"===e,autoHistory:"autoHistory"===e})},n.state={keepDays:-1,expireDays:30,disabled:!0,allHistory:!0,noHistory:!1,autoHistory:!1,errorInfo:""},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this;D.e.sysAdminGetRepoHistorySetting(this.props.repoID).then((function(t){e.setState({keepDays:t.data.keep_days,allHistory:t.data.keep_days<0,noHistory:0===t.data.keep_days,autoHistory:t.data.keep_days>0,disabled:!(t.data.keep_days>0),expireDays:t.data.keep_days>0?t.data.keep_days:30})})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))}},{key:"render",value:function(){var e=this,t=this.props.itemName,n=(0,m.AP)("{placeholder} History Setting");return n=n.replace("{placeholder}",'<span class="op-target text-truncate mx-1">'+f.Aq.HTMLescape(t)+"</span>"),(0,A.jsxs)(u.A,{isOpen:!0,toggle:this.props.toggleDialog,children:[(0,A.jsx)(be.A,{toggle:this.props.toggleDialog,children:(0,A.jsx)("span",{dangerouslySetInnerHTML:{__html:n},className:"d-flex mw-100"})}),(0,A.jsx)(je.A,{children:(0,A.jsxs)(Ie.A,{children:[(0,A.jsxs)(ke.A,{check:!0,children:[(0,A.jsx)(W.A,{type:"radio",name:"radio1",checked:this.state.allHistory,onChange:function(){e.setLimitDays("allHistory")}})," ",(0,A.jsx)(_e.A,{children:(0,m.AP)("Keep full history")})]}),(0,A.jsxs)(ke.A,{check:!0,children:[(0,A.jsx)(W.A,{type:"radio",name:"radio1",checked:this.state.noHistory,onChange:function(){e.setLimitDays("noHistory")}})," ",(0,A.jsx)(_e.A,{children:(0,m.AP)("Don't keep history")})]}),(0,A.jsxs)(ke.A,{check:!0,children:[(0,A.jsx)(W.A,{type:"radio",name:"radio1",checked:this.state.autoHistory,onChange:function(){e.setLimitDays("autoHistory")}})," ",(0,A.jsx)(_e.A,{children:(0,m.AP)("Only keep a period of history:")}),(0,A.jsx)(W.A,{type:"text",className:"expire-input",value:this.state.expireDays,onChange:this.onChange,disabled:this.state.disabled,onKeyDown:this.handleKeyDown})," ",(0,A.jsx)(_e.A,{children:(0,A.jsx)("span",{children:(0,m.AP)("days")})})]}),this.state.errorInfo&&(0,A.jsx)(Se.A,{color:"danger",children:this.state.errorInfo})]})}),(0,A.jsxs)(De.A,{children:[(0,A.jsx)(S.A,{color:"secondary",onClick:this.props.toggleDialog,children:(0,m.AP)("Cancel")}),(0,A.jsx)(S.A,{color:"primary",onClick:this.submit,children:(0,m.AP)("Submit")})]})]})}}])}(l.Component),mn=window.sysadmin.pageOptions.enableSysAdminViewRepo,fn=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.getPreviousPageList=function(){n.props.getListByPage(n.props.pageInfo.current_page-1)},n.getNextPageList=function(){n.props.getListByPage(n.props.pageInfo.current_page+1)},n.sortByFileCount=function(e){e.preventDefault(),n.props.sortItems("file_count")},n.sortBySize=function(e){e.preventDefault(),n.props.sortItems("size")},n.state={isItemFreezed:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,i=t.items,s=t.pageInfo,a=t.curPerPage,o=t.sortBy;if(n)return(0,A.jsx)(I.A,{});if(r)return(0,A.jsx)("p",{className:"error text-center",children:r});var c=(0,A.jsx)(ie.A,{text:(0,m.AP)("No libraries")}),d=(0,A.jsx)("span",{className:"sf3-font sf3-font-sort3"}),h=(0,A.jsx)("span",{className:"sf3-font sf3-font-down"}),u=(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("table",{children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"5%"}),(0,A.jsx)("th",{width:"25%",children:(0,m.AP)("Name")}),(0,A.jsx)("th",{width:"15%",children:void 0!=o?(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("a",{className:"d-inline-block table-sort-op",href:"#",onClick:this.sortByFileCount,children:[(0,m.AP)("Files")," ","file_count"==o?h:d]})," / ",(0,A.jsxs)("a",{className:"d-inline-block table-sort-op",href:"#",onClick:this.sortBySize,children:[(0,m.AP)("Size")," ","size"==o?h:d]})]}):(0,m.AP)("Files")/(0,m.AP)("Size")}),(0,A.jsx)("th",{width:"32%",children:"ID"}),(0,A.jsx)("th",{width:"18%",children:(0,m.AP)("Owner")}),(0,A.jsx)("th",{width:"5%"})]})}),(0,A.jsx)("tbody",{children:i.map((function(t,n){return(0,A.jsx)(xn,{repo:t,isItemFreezed:e.state.isItemFreezed,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem,onDeleteRepo:e.props.onDeleteRepo,onTransferRepo:e.props.onTransferRepo},n)}))})]}),s&&(0,A.jsx)(X.A,{gotoPreviousPage:this.getPreviousPageList,gotoNextPage:this.getNextPageList,currentPage:s.current_page,hasNextPage:s.has_next_page,curPerPage:a,resetPerPage:this.props.resetPerPage})]});return i.length?u:c}}])}(l.Component),xn=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).onDeleteRepo=function(e){D.e.sysAdminDeleteRepo(e.id).then((function(t){n.props.onDeleteRepo(e),n.setState({isDeleteDialogOpen:!1,isRepoDeleted:!0});var r=(0,m.AP)("Successfully deleted {name}.").replace("{name}",e.name);w.A.success(r)})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t),n.setState({isRepoDeleted:!1})}))},n.onTransferRepo=function(e){D.e.sysAdminTransferRepo(n.props.repo.id,e.email).then((function(e){n.props.onTransferRepo(e.data);var t=(0,m.AP)("Successfully transferred the library.");w.A.success(t)})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)})),n.toggleTransferDialog()},n.handleMouseOver=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!0,highlight:!0})},n.handleMouseOut=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!1,highlight:!1})},n.onUnfreezedItem=function(){n.setState({highlight:!1,isOpIconShow:!1}),n.props.onUnfreezedItem()},n.onMenuItemClick=function(e){switch(e){case"Share":n.toggleShareDialog();break;case"Delete":n.toggleDeleteDialog();break;case"Transfer":n.toggleTransferDialog();break;case"History Setting":n.toggleHistorySettingDialog()}},n.toggleShareDialog=function(){n.setState({isShareDialogOpen:!n.state.isShareDialogOpen})},n.toggleDeleteDialog=function(){n.setState({isDeleteDialogOpen:!n.state.isDeleteDialogOpen})},n.toggleTransferDialog=function(){n.setState({isTransferDialogOpen:!n.state.isTransferDialogOpen})},n.toggleHistorySettingDialog=function(){n.setState({isHistorySettingDialogOpen:!n.state.isHistorySettingDialogOpen})},n.renderRepoName=function(){var e=n.props.repo;return e.name?m.am&&mn&&!e.encrypted?(0,A.jsx)(g.N_,{to:"".concat(m.Yc,"sys/libraries/").concat(e.id,"/"),children:e.name}):e.name:"--"},n.translateOperations=function(e){var t="";switch(e){case"Share":t=(0,m.AP)("Share");break;case"Delete":t=(0,m.AP)("Delete");break;case"Transfer":t=(0,m.AP)("Transfer");break;case"History Setting":t=(0,m.AP)("History Setting")}return t},n.getOperations=function(){var e=n.props.repo,t=["Delete","Transfer"];return-1!=e.owner_email.indexOf("@seafile_group")?t=["Transfer"]:(e.encrypted||t.push("Share"),t.push("History Setting"),t)},n.state={isOpIconShown:!1,highlight:!1,isShareDialogOpen:!1,isDeleteDialogOpen:!1,isTransferDialogOpen:!1,isHistorySettingDialogOpen:!1,isRepoDeleted:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e,t=this.props.repo,n=this.state,r=n.isOpIconShown,i=n.isShareDialogOpen,s=n.isDeleteDialogOpen,a=n.isTransferDialogOpen,o=n.isHistorySettingDialogOpen,c=f.Aq.getLibIconUrl(t),d=f.Aq.getLibIconTitle(t),h=t.owner_email.indexOf("@seafile_group"),u=-1!=h;return u&&(e=t.owner_email.substring(0,h)),(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.handleMouseOver,onMouseLeave:this.handleMouseOut,children:[(0,A.jsx)("td",{children:(0,A.jsx)("img",{src:c,title:d,alt:d,width:"24"})}),(0,A.jsx)("td",{children:this.renderRepoName()}),(0,A.jsx)("td",{children:"".concat(t.file_count," / ").concat(f.Aq.bytesToSize(t.size))}),(0,A.jsx)("td",{children:t.id}),(0,A.jsx)("td",{children:u?(0,A.jsx)(g.N_,{to:"".concat(m.Yc,"sys/departments/").concat(e,"/"),children:t.owner_name}):(0,A.jsx)(ue,{email:t.owner_email,name:t.owner_name})}),(0,A.jsx)("td",{children:r&&(0,A.jsx)(He.A,{operations:this.getOperations(),translateOperations:this.translateOperations,onMenuItemClick:this.onMenuItemClick,onFreezedItem:this.props.onFreezedItem,onUnfreezedItem:this.onUnfreezedItem})})]}),i&&(0,A.jsx)(Kt.A,{children:(0,A.jsx)(gn,{itemName:t.name,itemPath:"/",repoID:t.id,isGroupOwnedRepo:u,repoEncrypted:t.encrypted,enableDirPrivateShare:!0,userPerm:t.permission,toggleDialog:this.toggleShareDialog})}),s&&(0,A.jsx)(Kt.A,{children:(0,A.jsx)(Xt.A,{repo:t,isRepoDeleted:this.state.isRepoDeleted,onDeleteRepo:this.onDeleteRepo,toggle:this.toggleDeleteDialog})}),a&&(0,A.jsx)(Kt.A,{children:(0,A.jsx)(_t.A,{itemName:t.name,submit:this.onTransferRepo,toggleDialog:this.toggleTransferDialog,isSysAdmin:!0})}),o&&(0,A.jsx)(Kt.A,{children:(0,A.jsx)(pn,{repoID:t.id,itemName:t.name,toggleDialog:this.toggleHistorySettingDialog})})]})}}])}(l.Component),vn=fn,An=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleCreateRepoDialog=function(){n.setState({isCreateRepoDialogOpen:!n.state.isCreateRepoDialogOpen})},n.getReposByPage=function(e){var t=n.state,r=t.perPage,i=t.sortBy;D.e.sysAdminListAllRepos(e,r,i).then((function(e){n.setState({loading:!1,repos:e.data.repos,pageInfo:e.data.page_info})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.sortItems=function(e){n.setState({currentPage:1,sortBy:e},(function(){var e=new URL(location.href),t=new URLSearchParams(e.search),r=n.state,i=r.currentPage,s=r.sortBy;t.set("page",i),t.set("order_by",s),e.search=t.toString(),(0,g.oo)(e.toString()),n.getReposByPage(i)}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){n.getReposByPage(1)}))},n.createRepo=function(e,t){D.e.sysAdminCreateRepo(e,t).then((function(e){n.state.repos.unshift(e.data),n.setState({repos:n.state.repos})})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.onDeleteRepo=function(e){var t=n.state.repos.filter((function(t){return t.id!=e.id}));n.setState({repos:t})},n.onTransferRepo=function(e){var t=n.state.repos.map((function(t){return t.id==e.id?e:t}));n.setState({repos:t})},n.getSearch=function(){return(0,A.jsx)(Be.A,{placeholder:(0,m.AP)("Search libraries by name or ID"),submit:n.searchRepos})},n.searchRepos=function(e){n.getValueLength(e)<3?w.A.notify((0,m.AP)("Required at least three letters.")):(0,g.oo)("".concat(m.Yc,"sys/search-libraries/?name_or_id=").concat(encodeURIComponent(e)))},n.state={loading:!0,errorMsg:"",repos:[],pageInfo:{},perPage:25,sortBy:"",isCreateRepoDialogOpen:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,r=n.currentPage,i=void 0===r?1:r,s=n.perPage,a=n.sortBy;this.setState({sortBy:t.get("order_by")||a,perPage:parseInt(t.get("per_page")||s),currentPage:parseInt(t.get("page")||i)},(function(){e.getReposByPage(e.state.currentPage)}))}},{key:"getValueLength",value:function(e){for(var t,n=0,r=0,i=e.length;r<i;r++)10===(t=e.charCodeAt(r))?n+=2:t<127?n+=1:t>=128&&t<=2047?n+=2:t>=2048&&t<=65535&&(n+=3);return n}},{key:"render",value:function(){var e=this.state.isCreateRepoDialogOpen;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)((0,r.A)({search:this.getSearch()},this.props),{},{children:(0,A.jsxs)(S.A,{className:"btn btn-secondary operation-item",onClick:this.toggleCreateRepoDialog,children:[(0,A.jsx)("i",{className:"sf3-font sf3-font-enlarge text-secondary mr-1"}),(0,m.AP)("New Library")]})})),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)(Qt,{currentItem:"all"}),(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsx)(vn,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.repos,sortBy:this.state.sortBy,sortItems:this.sortItems,pageInfo:this.state.pageInfo,curPerPage:this.state.perPage,getListByPage:this.getReposByPage,resetPerPage:this.resetPerPage,onDeleteRepo:this.onDeleteRepo,onTransferRepo:this.onTransferRepo})})]})}),e&&(0,A.jsx)(Wt,{createRepo:this.createRepo,toggleDialog:this.toggleCreateRepoDialog})]})}}])}(l.Component),Pn=function(e){function t(){return(0,i.A)(this,t),(0,a.A)(this,t,arguments)}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg,r=e.items;return t?(0,A.jsx)(I.A,{}):n?(0,A.jsx)("p",{className:"error text-center",children:n}):(0,A.jsx)(l.Fragment,{children:(0,A.jsxs)("table",{className:"table-hover",children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"33%",children:(0,m.AP)("Name")}),(0,A.jsx)("th",{width:"34%",children:"ID"}),(0,A.jsx)("th",{width:"33%",children:(0,m.AP)("Description")})]})}),(0,A.jsx)("tbody",{children:r.map((function(e,t){return(0,A.jsx)(yn,{item:e},t)}))})]})})}}])}(l.Component),yn=function(e){function t(){return(0,i.A)(this,t),(0,a.A)(this,t,arguments)}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.item;return(0,A.jsxs)("tr",{children:[(0,A.jsx)("td",{children:(0,A.jsx)(g.N_,{to:"".concat(m.Yc,"sys/libraries/").concat(e.id,"/"),children:e.name})}),(0,A.jsx)("td",{children:e.id}),(0,A.jsx)("td",{children:e.description})]})}}])}(l.Component),bn=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).state={loading:!0,errorMsg:"",items:[]},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this;D.e.sysAdminGetSystemRepoInfo().then((function(t){var n=[];n.push(t.data),e.setState({items:n,loading:!1})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)({},this.props)),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)(Qt,{currentItem:"system"}),(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsx)(Pn,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.items})})]})})]})}}])}(l.Component),jn=window.sysadmin.pageOptions.trashReposExpireDays,Sn=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.getPreviousPageList=function(){n.props.getListByPage(n.props.pageInfo.current_page-1)},n.getNextPageList=function(){n.props.getListByPage(n.props.pageInfo.current_page+1)},n.state={isItemFreezed:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,i=t.items,s=t.pageInfo,a=t.curPerPage;if(n)return(0,A.jsx)(I.A,{});if(r)return(0,A.jsx)("p",{className:"error text-center mt-4",children:r});var o=(0,A.jsx)(ie.A,{text:(0,m.AP)("No deleted libraries")}),c=(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)("p",{className:"mt-4 small text-secondary",children:(0,m.AP)("Tip: libraries deleted {trashReposExpireDays} days ago will be cleaned automatically.").replace("{trashReposExpireDays}",jn)}),(0,A.jsxs)("table",{className:"table-hover",children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"5%"}),(0,A.jsx)("th",{width:"43%",children:(0,m.AP)("Name")}),(0,A.jsx)("th",{width:"27%",children:(0,m.AP)("Owner")}),(0,A.jsx)("th",{width:"20%",children:(0,m.AP)("Deleted Time")}),(0,A.jsx)("th",{width:"5%"})]})}),(0,A.jsx)("tbody",{children:i.map((function(t,n){return(0,A.jsx)(Dn,{repo:t,isItemFreezed:e.state.isItemFreezed,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem,onDeleteRepo:e.props.onDeleteRepo,onRestoreRepo:e.props.onRestoreRepo},n)}))})]}),s&&(0,A.jsx)(X.A,{gotoPreviousPage:this.getPreviousPageList,gotoNextPage:this.getNextPageList,currentPage:s.current_page,hasNextPage:s.has_next_page,curPerPage:a,resetPerPage:this.props.resetPerPage})]});return i.length?c:o}}])}(l.Component),Dn=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleMouseOver=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!0,highlight:!0})},n.handleMouseOut=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!1,highlight:!1})},n.onUnfreezedItem=function(){n.setState({highlight:!1,isOpIconShow:!1}),n.props.onUnfreezedItem()},n.onDeleteRepo=function(){var e=n.props.repo;D.e.sysAdminDeleteTrashRepo(e.id).then((function(t){n.props.onDeleteRepo(e);var r=(0,m.AP)("Successfully deleted {name}.").replace("{name}",e.name);w.A.success(r)})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.onRestoreRepo=function(){var e=n.props.repo;D.e.sysAdminRestoreTrashRepo(e.id).then((function(t){n.props.onRestoreRepo(e);var r=(0,m.AP)("Successfully restored the library.");w.A.success(r)})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.toggleDeleteRepoDialog=function(e){e&&e.preventDefault(),n.setState({isDeleteRepoDialogOpen:!n.state.isDeleteRepoDialogOpen})},n.toggleRestoreRepoDialog=function(e){e&&e.preventDefault(),n.setState({isRestoreRepoDialogOpen:!n.state.isRestoreRepoDialogOpen})},n.translateOperations=function(e){var t="";switch(e){case"Restore":t=(0,m.AP)("Restore");break;case"Delete":t=(0,m.AP)("Delete")}return t},n.onMenuItemClick=function(e){switch(e){case"Restore":n.toggleRestoreRepoDialog();break;case"Delete":n.toggleDeleteRepoDialog()}},n.state={highlight:!1,isOpIconShown:!1,isDeleteRepoDialogOpen:!1,isRestoreRepoDialogOpen:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.repo,t=this.state,n=t.isOpIconShown,r=t.isDeleteRepoDialogOpen,i=t.isRestoreRepoDialogOpen,s=f.Aq.getLibIconUrl(e),a=f.Aq.getLibIconTitle(e),o='<span class="op-target">'+f.Aq.HTMLescape(e.name)+"</span>";return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("tr",{onMouseEnter:this.handleMouseOver,onMouseLeave:this.handleMouseOut,children:[(0,A.jsx)("td",{children:(0,A.jsx)("img",{src:s,title:a,alt:a,width:"24"})}),(0,A.jsx)("td",{children:e.name}),(0,A.jsx)("td",{children:-1==e.owner.indexOf("@seafile_group")?(0,A.jsx)(ue,{email:e.owner,name:e.owner_name}):e.group_name}),(0,A.jsx)("td",{children:C()(e.delete_time).fromNow()}),(0,A.jsx)("td",{children:n&&(0,A.jsx)(He.A,{operations:["Restore","Delete"],translateOperations:this.translateOperations,onMenuItemClick:this.onMenuItemClick,onFreezedItem:this.props.onFreezedItem,onUnfreezedItem:this.onUnfreezedItem})})]}),r&&(0,A.jsx)(Kt.A,{children:(0,A.jsx)(Ee.A,{title:(0,m.AP)("Delete Library"),message:(0,m.AP)("Are you sure you want to delete {placeholder} completely?").replace("{placeholder}",o),executeOperation:this.onDeleteRepo,confirmBtnText:(0,m.AP)("Delete"),toggleDialog:this.toggleDeleteRepoDialog})}),i&&(0,A.jsx)(Kt.A,{children:(0,A.jsx)(Ee.A,{title:(0,m.AP)("Restore Library"),message:(0,m.AP)("Are you sure you want to restore {placeholder}?").replace("{placeholder}",o),executeOperation:this.onRestoreRepo,confirmBtnText:(0,m.AP)("Restore"),toggleDialog:this.toggleRestoreRepoDialog})})]})}}])}(l.Component),wn=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleCleanTrashDialog=function(){n.setState({isCleanTrashDialogOpen:!n.state.isCleanTrashDialogOpen})},n.getReposByPage=function(e){var t=n.state.perPage;D.e.sysAdminListTrashRepos(e,t).then((function(e){n.setState({repos:e.data.repos,pageInfo:e.data.page_info,loading:!1})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){n.getReposByPage(1)}))},n.onDeleteRepo=function(e){var t=n.state.repos.filter((function(t){return t.id!=e.id}));n.setState({repos:t})},n.onRestoreRepo=function(e){var t=n.state.repos.filter((function(t){return t.id!=e.id}));n.setState({repos:t})},n.cleanTrash=function(){D.e.sysAdminCleanTrashRepos().then((function(e){n.setState({repos:[]}),w.A.success((0,m.AP)("Successfully cleared trash."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.getSearch=function(){return(0,A.jsx)(Be.A,{placeholder:(0,m.AP)("Search libraries by owner"),submit:n.searchRepos})},n.searchRepos=function(e){D.e.sysAdminSearchTrashRepos(e).then((function(e){n.setState({repos:e.data.repos,pageInfo:null,errorMsg:"",loading:!1})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.state={loading:!0,errorMsg:"",repos:[],pageInfo:{},perPage:25,isCleanTrashDialogOpen:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,r=n.currentPage,i=void 0===r?1:r,s=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||s),currentPage:parseInt(t.get("page")||i)},(function(){e.getReposByPage(e.state.currentPage)}))}},{key:"render",value:function(){var e=this.state.isCleanTrashDialogOpen;return(0,A.jsxs)(l.Fragment,{children:[this.state.repos.length?(0,A.jsx)(k.A,(0,r.A)((0,r.A)({},this.props),{},{children:(0,A.jsx)(S.A,{className:"operation-item",onClick:this.toggleCleanTrashDialog,children:(0,m.AP)("Clean")})})):(0,A.jsx)(k.A,(0,r.A)({},this.props)),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)(Qt,{currentItem:"trash"}),(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsx)(Sn,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.repos,pageInfo:this.state.pageInfo,onDeleteRepo:this.onDeleteRepo,onRestoreRepo:this.onRestoreRepo,getListByPage:this.getReposByPage,resetPerPage:this.resetPerPage,curPerPage:this.state.perPage})})]})}),e&&(0,A.jsx)(Ee.A,{title:(0,m.AP)("Clear Trash"),message:(0,m.AP)("Are you sure you want to clear trash?"),executeOperation:this.cleanTrash,confirmBtnText:(0,m.AP)("Clear"),toggleDialog:this.toggleCleanTrashDialog})]})}}])}(l.Component),In=wn,kn=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).getRepos=function(e){var t=n.state,r=t.name,i=t.perPage;n.getValueLength(r)<3?w.A.notify((0,m.AP)("Required at least three letters.")):D.e.sysAdminSearchRepos(r,e,i).then((function(e){n.setState({loading:!1,errorMsg:"",repos:e.data.repo_list,pageInfo:e.data.page_info})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.searchRepos=function(){var e=n.state.currentPage;n.getRepos(e)},n.onDeleteRepo=function(e){var t=n.state.repos.filter((function(t){return t.id!=e.id}));n.setState({repos:t})},n.onTransferRepo=function(e){var t=n.state.repos.map((function(t){return t.id==e.id?e:t}));n.setState({repos:t})},n.handleNameInputChange=function(e){n.setState({name:e.target.value,currentPage:1},n.checkSubmitBtnActive)},n.checkSubmitBtnActive=function(){var e=n.state.name;n.setState({isSubmitBtnActive:e.trim()})},n.handleKeyDown=function(e){13===e.keyCode&&(n.state.isSubmitBtnActive&&n.searchRepos())},n.resetPerPage=function(e){n.setState({perPage:e,currentPage:1},(function(){n.searchRepos()}))},n.state={name:"",currentPage:1,perPage:25,isSubmitBtnActive:!1,loading:!0,errorMsg:"",repos:[],pageInfo:{}},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(document.location).searchParams,n=this.state,r=n.currentPage,i=n.perPage;this.setState({name:t.get("name_or_id")||"",perPage:parseInt(t.get("per_page")||i),currentPage:parseInt(t.get("page")||r)},(function(){e.getRepos(e.state.currentPage)}))}},{key:"getValueLength",value:function(e){for(var t,n=0,r=0,i=e.length;r<i;r++)10===(t=e.charCodeAt(r))?n+=2:t<127?n+=1:t>=128&&t<=2047?n+=2:t>=2048&&t<=65535&&(n+=3);return n}},{key:"render",value:function(){var e=this.state,t=e.name,n=e.isSubmitBtnActive;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)({},this.props)),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)("div",{className:"cur-view-path",children:(0,A.jsx)("h3",{className:"sf-heading",children:(0,m.AP)("Libraries")})}),(0,A.jsxs)("div",{className:"cur-view-content",children:[(0,A.jsxs)("div",{className:"mt-4 mb-6",children:[(0,A.jsx)("h4",{className:"border-bottom font-weight-normal mb-2 pb-1",children:(0,m.AP)("Search Libraries")}),(0,A.jsx)("p",{className:"text-secondary small",children:(0,m.AP)("Tip: you can search by keyword in name or ID.")}),(0,A.jsxs)(Ie.A,{tag:"div",children:[(0,A.jsxs)(ke.A,{row:!0,children:[(0,A.jsx)(_e.A,{for:"name",sm:1,children:(0,m.AP)("Name or ID")}),(0,A.jsx)(ft.A,{sm:5,children:(0,A.jsx)(W.A,{type:"text",name:"name",id:"name",value:t,onChange:this.handleNameInputChange,onKeyDown:this.handleKeyDown})})]}),(0,A.jsx)(ke.A,{row:!0,children:(0,A.jsx)(ft.A,{sm:{size:5,offset:1},children:(0,A.jsx)("button",{className:"btn btn-outline-primary",disabled:!n,onClick:this.searchRepos,children:(0,m.AP)("Submit")})})})]})]}),(0,A.jsxs)("div",{className:"mt-4 mb-6",children:[(0,A.jsx)("h4",{className:"border-bottom font-weight-normal mb-2 pb-1",children:(0,m.AP)("Result")}),(0,A.jsx)(vn,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.repos,pageInfo:this.state.pageInfo,curPerPage:this.state.perPage,getListByPage:this.getRepos,resetPerPage:this.resetPerPage,onDeleteRepo:this.onDeleteRepo,onTransferRepo:this.onTransferRepo})]})]})]})})]})}}])}(l.Component),_n=n(81617),Nn=function(){return(0,s.A)((function e(t){(0,i.A)(this,e),this.name=t.obj_name,this.mtime=t.last_update,this.size=t.file_size,this.is_file=t.is_file}),[{key:"isDir",value:function(){return!this.is_file}}])}(),Mn=function(e){function t(){var e;(0,i.A)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=(0,a.A)(this,t,[].concat(r))).onPathClick=function(t){var n=f.Aq.getEventData(t,"path");e.props.onPathClick(n)},e.turnPathToLink=function(t){var n=(t="/"===t[t.length-1]?t.slice(0,t.length-1):t).split("/"),r="";return n.map((function(t,i){return""===t?null:i===n.length-1?(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)("span",{className:"path-split",children:"/"}),(0,A.jsx)("span",{className:"path-file-name",children:t})]},i):(r+="/"+t,(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)("span",{className:"path-split",children:"/"}),(0,A.jsx)("a",{className:"path-link","data-path":r,onClick:e.onPathClick,children:t})]},i))}))},e}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props,t=e.isSystemRepo,n=e.currentPath,r=e.repoName,i=this.turnPathToLink(n);return(0,A.jsxs)("div",{className:"path-container",children:[t?(0,A.jsx)("a",{href:"".concat(m.Yc,"sys/system-library/"),children:(0,m.AP)("System")}):(0,A.jsx)("a",{href:"".concat(m.Yc,"sys/all-libraries/"),children:(0,m.AP)("All")}),(0,A.jsx)("span",{className:"path-split",children:"/"}),"/"===n||""===n?(0,A.jsx)("span",{className:"path-repo-name",children:r}):(0,A.jsx)("a",{className:"path-link","data-path":"/",onClick:this.onPathClick,children:r}),i]})}}])}(l.Component),Cn=Mn,On=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleMouseOver=function(){n.setState({isOpIconShown:!0})},n.handleMouseOut=function(){n.setState({isOpIconShown:!1})},n.openFolder=function(){n.props.openFolder(n.props.dirent)},n.deleteDirent=function(e){e.preventDefault(),n.props.deleteDirent(n.props.dirent)},n.downloadDirent=function(e){e.preventDefault(),n.props.downloadDirent(n.props.dirent)},n.state={isOpIconShown:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.state.isOpIconShown,t=this.props,n=t.dirent,r=t.fromSystemRepo,i=f.Aq.getDirentIcon(n);return(0,A.jsx)(l.Fragment,{children:(0,A.jsxs)("tr",{onMouseEnter:this.handleMouseOver,onMouseLeave:this.handleMouseOut,children:[(0,A.jsx)("td",{className:"text-center",children:(0,A.jsx)("img",{src:i,width:"24",alt:""})}),(0,A.jsx)("td",{children:n.is_file?n.name:(0,A.jsx)(g.N_,{to:"#",onClick:this.openFolder,children:n.name})}),(0,A.jsxs)("td",{children:[e&&r&&(0,A.jsx)("a",{href:"#",className:"op-icon sf3-font-delete1 sf3-font",title:(0,m.AP)("Delete"),onClick:this.deleteDirent}),e&&n.is_file&&(0,A.jsx)("a",{href:"#",className:"op-icon sf3-font sf3-font-download1",title:(0,m.AP)("Download"),onClick:this.downloadDirent})]}),(0,A.jsx)("td",{children:n.size}),(0,A.jsx)("td",{children:C()(n.mtime).fromNow()})]})})}}])}(l.Component),Ln=function(e){function t(){return(0,i.A)(this,t),(0,a.A)(this,t,arguments)}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,i=t.direntList;return n?(0,A.jsx)(I.A,{}):r?(0,A.jsx)("p",{className:"error text-center mt-4",children:r}):(0,A.jsx)(l.Fragment,{children:(0,A.jsxs)("table",{className:"table-hover",children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"5%"}),(0,A.jsx)("th",{width:"55%",children:(0,m.AP)("Name")}),(0,A.jsx)("th",{width:"10%"}),(0,A.jsx)("th",{width:"15%",children:(0,m.AP)("Size")}),(0,A.jsx)("th",{width:"15%",children:(0,m.AP)("Last Update")})]})}),(0,A.jsx)("tbody",{children:i.map((function(t,n){return(0,A.jsx)(On,{dirent:t,openFolder:e.props.openFolder,deleteDirent:e.props.deleteDirent,downloadDirent:e.props.downloadDirent,fromSystemRepo:e.props.fromSystemRepo},n)}))})]})})}}])}(l.Component),Tn=Ln,Fn=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).onPathClick=function(e){n.loadDirentList(e)},n.toggleNewFolderDialog=function(){n.setState({isNewFolderDialogOpen:!n.state.isNewFolderDialogOpen})},n.createNewFolder=function(e){var t=f.Aq.getFileName(e);D.e.sysAdminCreateSysRepoFolder(n.props.repoID,n.state.path,t).then((function(e){var t=new Nn(e.data),r=n.state.direntList;r.unshift(t),n.setState({direntList:r}),n.toggleNewFolderDialog()})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.openFolder=function(e){var t=f.Aq.joinPath(n.state.path,e.name);e.is_file||n.loadDirentList(t)},n.loadDirentList=function(e){var t=n.props.repoID;D.e.sysAdminListRepoDirents(t,e).then((function(r){var i=r.data,s=i.is_system_library,a=i.repo_name,o=i.dirent_list,l=[];o.forEach((function(e){var t=new Nn(e);l.push(t)})),n.setState({loading:!1,repoName:a,isSystemRepo:s,direntList:l,path:e},(function(){var r=m.Yc+"sys/libraries/"+t+"/"+encodeURIComponent(n.state.repoName)+f.Aq.encodePath(e);window.history.replaceState({url:r,path:e},e,r)}))})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.deleteDirent=function(e){var t=f.Aq.joinPath(n.state.path,e.name);D.e.sysAdminDeleteRepoDirent(n.props.repoID,t).then((function(t){w.A.success((0,m.AP)("Successfully deleted 1 item."));var r=n.state.direntList.filter((function(t){return t.name!=e.name}));n.setState({direntList:r})})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.downloadDirent=function(e){var t=f.Aq.joinPath(n.state.path,e.name);D.e.sysAdminGetRepoFileDownloadURL(n.props.repoID,t).then((function(e){location.href=e.data.download_url})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.openFileInput=function(){n.fileInput.current.click()},n.onFileInputChange=function(){if(n.fileInput.current.files.length){var e=n.fileInput.current.files[0],t=n.state.path;D.e.sydAdminGetSysRepoItemUploadURL(t).then((function(r){var i=new FormData;i.append("parent_dir",t),i.append("file",e),fe.A.post(r.data.upload_link,i).then((function(e){var t=e.data[0],r=new Nn({is_file:!0,obj_name:t.name,file_size:f.Aq.bytesToSize(t.size),last_update:(new Date).getTime()}),i=n.state.direntList,s=i.filter((function(e){return!e.is_file}));i.splice(s.length,0,r),n.setState({direntList:i})}))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))}},n.checkDuplicatedName=function(e){return n.state.direntList.some((function(t){return t.name===e}))},n.state={loading:!0,errorMsg:"",isSystemRepo:!1,repoName:"",path:"",direntList:[],isNewFolderDialogOpen:!1},n.fileInput=l.createRef(),n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){this.loadDirentList("/")}},{key:"render",value:function(){var e=this.state,t=e.loading,n=e.errorMsg,i=e.repoName,s=e.direntList,a=e.isSystemRepo,o=e.path,c=e.isNewFolderDialogOpen,d=this.props.repoID;return(0,A.jsxs)(l.Fragment,{children:[a?(0,A.jsx)(k.A,(0,r.A)((0,r.A)({},this.props),{},{children:(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)("input",{className:"d-none",type:"file",onChange:this.onFileInputChange,ref:this.fileInput}),(0,A.jsx)(S.A,{className:"operation-item",onClick:this.openFileInput,children:(0,m.AP)("Upload")}),(0,A.jsx)(S.A,{className:"operation-item",onClick:this.toggleNewFolderDialog,children:(0,m.AP)("New Folder")})]})})):(0,A.jsx)(k.A,(0,r.A)({},this.props)),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)("div",{className:"cur-view-path align-items-center",children:(0,A.jsx)(Cn,{isSystemRepo:a,repoID:d,repoName:i,currentPath:o,onPathClick:this.onPathClick})}),(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsx)(Tn,{loading:t,errorMsg:n,fromSystemRepo:a,direntList:s,openFolder:this.openFolder,deleteDirent:this.deleteDirent,downloadDirent:this.downloadDirent})})]})}),c&&(0,A.jsx)(_n.A,{parentPath:o,checkDuplicatedName:this.checkDuplicatedName,onAddFolder:this.createNewFolder,addFolderCancel:this.toggleNewFolderDialog})]})}}])}(l.Component),Rn=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleRepoNameChange=function(e){e.target.value.trim()?n.setState({isSubmitBtnActive:!0}):n.setState({isSubmitBtnActive:!1}),n.setState({groupName:e.target.value})},n.handleSubmit=function(){var e=n.state.groupName.trim();n.props.createGroup(e,n.state.ownerEmail)},n.handleSelectChange=function(e){n.setState({ownerEmail:e&&e.length?e[0].email:""})},n.handleKeyDown=function(e){"Enter"===e.key&&(n.handleSubmit(),e.preventDefault())},n.toggle=function(){n.props.toggleDialog()},n.state={groupName:"",ownerEmail:"",errMessage:"",isSubmitBtnActive:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){return(0,A.jsxs)(u.A,{isOpen:!0,toggle:this.toggle,autoFocus:!1,children:[(0,A.jsx)(be.A,{toggle:this.toggle,children:(0,m.AP)("New Group")}),(0,A.jsxs)(je.A,{children:[(0,A.jsx)(Ie.A,{children:(0,A.jsxs)(ke.A,{children:[(0,A.jsx)(_e.A,{for:"groupName",children:(0,m.AP)("Name")}),(0,A.jsx)(W.A,{id:"groupName",onKeyDown:this.handleKeyDown,value:this.state.groupName,onChange:this.handleRepoNameChange,autoFocus:!0}),(0,A.jsxs)(_e.A,{className:"mt-2",children:[(0,m.AP)("Owner"),(0,A.jsx)("span",{className:"small text-secondary",children:(0,m.AP)("(If left blank, owner will be admin)")})]}),(0,A.jsx)(Fe.A,{isMulti:!1,placeholder:(0,m.AP)("Select a user"),onSelectChange:this.handleSelectChange})]})}),this.state.errMessage&&(0,A.jsx)(Se.A,{color:"danger",children:this.state.errMessage})]}),(0,A.jsxs)(De.A,{children:[(0,A.jsx)(S.A,{color:"secondary",onClick:this.toggle,children:(0,m.AP)("Cancel")}),(0,A.jsx)(S.A,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive,children:(0,m.AP)("Submit")})]})]})}}])}(l.Component),En=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleSelectChange=function(e){n.setState({selectedOption:e,submitBtnDisabled:null==e})},n.submit=function(){var e=n.state.selectedOption.email;n.props.transferGroup(e),n.props.toggleDialog()},n.state={selectedOption:null,submitBtnDisabled:!0},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.state.submitBtnDisabled,t='<span class="op-target">'+f.Aq.HTMLescape(this.props.groupName)+"</span>",n=(0,m.AP)("Transfer Group {placeholder} to").replace("{placeholder}",t);return(0,A.jsxs)(u.A,{isOpen:!0,toggle:this.props.toggleDialog,children:[(0,A.jsx)(be.A,{toggle:this.props.toggleDialog,children:(0,A.jsx)("span",{dangerouslySetInnerHTML:{__html:n}})}),(0,A.jsx)(je.A,{children:(0,A.jsx)(Fe.A,{ref:"userSelect",isMulti:!1,placeholder:(0,m.AP)("Select a user"),onSelectChange:this.handleSelectChange})}),(0,A.jsxs)(De.A,{children:[(0,A.jsx)(S.A,{color:"secondary",onClick:this.props.toggleDialog,children:(0,m.AP)("Cancel")}),(0,A.jsx)(S.A,{color:"primary",onClick:this.submit,disabled:e,children:(0,m.AP)("Submit")})]})]})}}])}(l.Component),Un=n(52622),zn=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.getPreviousPage=function(){n.props.getListByPage(n.props.pageInfo.current_page-1)},n.getNextPage=function(){n.props.getListByPage(n.props.pageInfo.current_page+1)},n.state={isItemFreezed:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,i=t.items,s=t.pageInfo,a=t.curPerPage;if(n)return(0,A.jsx)(I.A,{});if(r)return(0,A.jsx)("p",{className:"error text-center mt-4",children:r});var o=(0,A.jsx)(ie.A,{text:(0,m.AP)("No groups")}),c=(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("table",{children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"35%",children:(0,m.AP)("Name")}),(0,A.jsx)("th",{width:"40%",children:(0,m.AP)("Owner")}),(0,A.jsx)("th",{width:"20%",children:(0,m.AP)("Created At")}),(0,A.jsx)("th",{width:"5%"})]})}),(0,A.jsx)("tbody",{children:i.map((function(t,n){return(0,A.jsx)(Bn,{item:t,isItemFreezed:e.state.isItemFreezed,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem,deleteGroup:e.props.deleteGroup,transferGroup:e.props.transferGroup,changeGroup2Department:e.props.changeGroup2Department},n)}))})]}),s&&(0,A.jsx)(X.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:s.current_page,hasNextPage:s.has_next_page,curPerPage:a,resetPerPage:this.props.resetPerPage})]});return i.length?c:o}}])}(l.Component),Bn=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleMouseEnter=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!0,highlight:!0})},n.handleMouseLeave=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!1,highlight:!1})},n.onUnfreezedItem=function(){n.setState({highlight:!1,isOpIconShow:!1}),n.props.onUnfreezedItem()},n.onMenuItemClick=function(e){switch(e){case"Delete":n.toggleDeleteDialog();break;case"Transfer":n.toggleTransferDialog();break;case"Change":n.toggleChangeDialog()}},n.toggleDeleteDialog=function(e){e&&e.preventDefault(),n.setState({isDeleteDialogOpen:!n.state.isDeleteDialogOpen})},n.toggleTransferDialog=function(e){e&&e.preventDefault(),n.setState({isTransferDialogOpen:!n.state.isTransferDialogOpen})},n.toggleChangeDialog=function(e){e&&e.preventDefault(),n.setState({isChangeDialogOpen:!n.state.isChangeDialogOpen})},n.deleteGroup=function(){n.props.deleteGroup(n.props.item.id)},n.transferGroup=function(e){n.props.transferGroup(n.props.item.id,e)},n.changeGroup=function(){n.props.changeGroup2Department(n.props.item.id)},n.translateOperations=function(e){var t="";switch(e){case"Delete":t=(0,m.AP)("Delete");break;case"Transfer":t=(0,m.AP)("Transfer");break;case"Change":t=(0,m.AP)("Change to department")}return t},n.state={isOpIconShown:!1,highlight:!1,isDeleteDialogOpen:!1,isTransferDialogOpen:!1,isChangeDialogOpen:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.item,t=this.state,n=t.isOpIconShown,r=t.isDeleteDialogOpen,i=t.isTransferDialogOpen,s=t.isChangeDialogOpen,a='<span class="op-target">'+f.Aq.HTMLescape(e.name)+"</span>",o=(0,m.AP)("Are you sure you want to delete {placeholder} ?").replace("{placeholder}",a),c=0==e.parent_group_id?"".concat(m.Yc,"sys/groups/").concat(e.id,"/libraries/"):"".concat(m.Yc,"sys/departments/").concat(e.id,"/");return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,A.jsx)("td",{children:(0,A.jsx)(g.N_,{to:c,children:e.name})}),(0,A.jsx)("td",{children:"system admin"==e.owner?"--":(0,A.jsx)(ue,{email:e.owner,name:e.owner_name})}),(0,A.jsx)("td",{children:(0,A.jsx)("span",{title:C()(e.created_at).format("llll"),children:C()(e.created_at).fromNow()})}),(0,A.jsx)("td",{children:n&&"system admin"!=e.owner&&(0,A.jsx)(He.A,{operations:["Delete","Transfer","Change"],translateOperations:this.translateOperations,onMenuItemClick:this.onMenuItemClick,onFreezedItem:this.props.onFreezedItem,onUnfreezedItem:this.onUnfreezedItem})})]}),r&&(0,A.jsx)(Ee.A,{title:(0,m.AP)("Delete Group"),message:o,executeOperation:this.deleteGroup,confirmBtnText:(0,m.AP)("Delete"),toggleDialog:this.toggleDeleteDialog}),i&&(0,A.jsx)(En,{groupName:e.name,transferGroup:this.transferGroup,toggleDialog:this.toggleTransferDialog}),s&&(0,A.jsx)(Un.A,{groupName:e.name,changeGroup2Department:this.changeGroup,toggleDialog:this.toggleChangeDialog})]})}}])}(l.Component),qn=zn,Yn=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleCreateGroupDialog=function(){n.setState({isCreateGroupDialogOpen:!n.state.isCreateGroupDialogOpen})},n.getGroupListByPage=function(e){D.e.sysAdminListAllGroups(e,n.state.perPage).then((function(e){n.setState({loading:!1,groupList:e.data.groups,pageInfo:e.data.page_info})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){n.getGroupListByPage(1)}))},n.createGroup=function(e,t){D.e.sysAdminCreateNewGroup(e,t).then((function(e){var t=n.state.groupList;t.unshift(e.data),n.setState({groupList:t}),n.toggleCreateGroupDialog()})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.deleteGroup=function(e){D.e.sysAdminDismissGroupByID(e).then((function(t){var r=n.state.groupList.filter((function(t){return t.id!=e}));n.setState({groupList:r}),w.A.success((0,m.AP)("Successfully deleted 1 item."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.transferGroup=function(e,t){D.e.sysAdminTransferGroup(t,e).then((function(t){var r=n.state.groupList.map((function(n){return n.id==e&&(n=t.data),n}));n.setState({groupList:r}),w.A.success((0,m.AP)("Successfully transferred the group."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.changeGroup2Department=function(e){Ae.adminGroup2Department(e).then((function(t){var r=n.state.groupList.map((function(n){return n.id==e&&(n=t.data),n}));n.setState({groupList:r}),w.A.success((0,m.AP)("Successfully change the group"))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.getSearch=function(){return(0,A.jsx)(Be.A,{placeholder:(0,m.AP)("Search groups by name"),submit:n.searchGroups})},n.searchGroups=function(e){(0,g.oo)("".concat(m.Yc,"sys/search-groups/?name=").concat(encodeURIComponent(e)))},n.state={loading:!0,errorMsg:"",groupList:[],pageInfo:{},perPage:25,isCreateGroupDialogOpen:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,r=n.currentPage,i=void 0===r?1:r,s=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||s),currentPage:parseInt(t.get("page")||i)},(function(){e.getGroupListByPage(e.state.currentPage)}))}},{key:"render",value:function(){var e=this.state.isCreateGroupDialogOpen;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)((0,r.A)({search:this.getSearch()},this.props),{},{children:(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(S.A,{className:"operation-item",onClick:this.toggleCreateGroupDialog,children:(0,m.AP)("New Group")}),(0,A.jsx)("a",{className:"btn btn-secondary operation-item",href:"".concat(m.Yc,"sys/groupadmin/export-excel/"),children:(0,m.AP)("Export Excel")})]})})),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)("div",{className:"cur-view-path",children:(0,A.jsx)("h3",{className:"sf-heading",children:(0,m.AP)("Groups")})}),(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsx)(qn,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.groupList,pageInfo:this.state.pageInfo,deleteGroup:this.deleteGroup,transferGroup:this.transferGroup,changeGroup2Department:this.changeGroup2Department,getListByPage:this.getGroupListByPage,resetPerPage:this.resetPerPage,curPerPage:this.state.perPage})})]})}),e&&(0,A.jsx)(Rn,{createGroup:this.createGroup,toggleDialog:this.toggleCreateGroupDialog})]})}}])}(l.Component),Vn=Yn,Hn=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).getGroups=function(){var e=n.state.name;D.e.sysAdminSearchGroups(e).then((function(e){n.setState({loading:!1,groupList:e.data.group_list})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.deleteGroup=function(e){D.e.sysAdminDismissGroupByID(e).then((function(t){var r=n.state.groupList.filter((function(t){return t.id!=e}));n.setState({groupList:r}),w.A.success((0,m.AP)("Successfully deleted 1 item."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.transferGroup=function(e,t){D.e.sysAdminTransferGroup(t,e).then((function(t){var r=n.state.groupList.map((function(n){return n.id==e&&(n=t.data),n}));n.setState({groupList:r}),w.A.success((0,m.AP)("Successfully transferred the group."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.handleNameInputChange=function(e){n.setState({name:e.target.value},n.checkSubmitBtnActive)},n.checkSubmitBtnActive=function(){var e=n.state.name;n.setState({isSubmitBtnActive:e.trim()})},n.handleKeyDown=function(e){13===e.keyCode&&(n.state.isSubmitBtnActive&&n.getGroups())},n.state={name:"",isSubmitBtnActive:!1,loading:!0,errorMsg:"",groupList:[],pageInfo:null},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=new URL(document.location).searchParams;this.setState({name:e.get("name")||""},this.getGroups)}},{key:"render",value:function(){var e=this.state,t=e.name,n=e.isSubmitBtnActive;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)({},this.props)),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)("div",{className:"cur-view-path",children:(0,A.jsx)("h3",{className:"sf-heading",children:(0,m.AP)("Groups")})}),(0,A.jsxs)("div",{className:"cur-view-content",children:[(0,A.jsxs)("div",{className:"mt-4 mb-6",children:[(0,A.jsx)("h4",{className:"border-bottom font-weight-normal mb-2 pb-1",children:(0,m.AP)("Search Groups")}),(0,A.jsx)("p",{className:"text-secondary small",children:(0,m.AP)("Tip: you can search by keyword in name.")}),(0,A.jsxs)(Ie.A,{tag:"div",children:[(0,A.jsxs)(ke.A,{row:!0,children:[(0,A.jsx)(_e.A,{for:"name",sm:1,children:(0,m.AP)("Name")}),(0,A.jsx)(ft.A,{sm:5,children:(0,A.jsx)(W.A,{type:"text",name:"name",id:"name",value:t,onChange:this.handleNameInputChange,onKeyDown:this.handleKeyDown})})]}),(0,A.jsx)(ke.A,{row:!0,children:(0,A.jsx)(ft.A,{sm:{size:5,offset:1},children:(0,A.jsx)("button",{className:"btn btn-outline-primary",disabled:!n,onClick:this.getGroups,children:(0,m.AP)("Submit")})})})]})]}),(0,A.jsxs)("div",{className:"mt-4 mb-6",children:[(0,A.jsx)("h4",{className:"border-bottom font-weight-normal mb-2 pb-1",children:(0,m.AP)("Result")}),(0,A.jsx)(qn,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.groupList,deleteGroup:this.deleteGroup,transferGroup:this.transferGroup})]})]})]})})]})}}])}(l.Component),Wn=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).navItems=[{name:"repos",urlPart:"groups/"+n.props.groupID+"/libraries",text:(0,m.AP)("Libraries")},{name:"members",urlPart:"groups/"+n.props.groupID+"/members",text:(0,m.AP)("Members")}],n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props,t=e.groupName,n=e.currentItem;return(0,A.jsxs)("div",{children:[(0,A.jsx)("div",{className:"cur-view-path",children:(0,A.jsxs)("h3",{className:"sf-heading",children:[(0,A.jsx)(g.N_,{to:"".concat(m.Yc,"sys/groups/"),children:(0,m.AP)("Groups")})," / ",t]})}),(0,A.jsx)("ul",{className:"nav border-bottom mx-4",children:this.navItems.map((function(e,t){return(0,A.jsx)("li",{className:"nav-item mr-2",children:(0,A.jsx)(g.N_,{to:"".concat(m.Yc,"sys/").concat(e.urlPart,"/"),className:"nav-link ".concat(n==e.name?" active":""),children:e.text})},t)}))})]})}}])}(l.Component),Gn=Wn,Qn=window.sysadmin.pageOptions.enableSysAdminViewRepo,Kn=function(e){function t(e){return(0,i.A)(this,t),(0,a.A)(this,t,[e])}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,i=t.items;if(n)return(0,A.jsx)(I.A,{});if(r)return(0,A.jsx)("p",{className:"error text-center mt-4",children:r});var s=(0,A.jsx)(ie.A,{text:(0,m.AP)("No libraries")}),a=(0,A.jsx)(l.Fragment,{children:(0,A.jsxs)("table",{className:"table-hover",children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"5%"}),(0,A.jsx)("th",{width:"30%",children:(0,m.AP)("Name")}),(0,A.jsx)("th",{width:"30%",children:(0,m.AP)("Size")}),(0,A.jsx)("th",{width:"25%",children:(0,m.AP)("Shared By")}),(0,A.jsx)("th",{width:"10%"})]})}),(0,A.jsx)("tbody",{children:i.map((function(t,n){return(0,A.jsx)(Xn,{item:t,unshareRepo:e.props.unshareRepo},n)}))})]})});return i.length?a:s}}])}(l.Component),Xn=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleMouseEnter=function(){n.setState({isOpIconShown:!0})},n.handleMouseLeave=function(){n.setState({isOpIconShown:!1})},n.toggleUnshareRepoDialog=function(e){e&&e.preventDefault(),n.setState({isUnshareRepoDialogOpen:!n.state.isUnshareRepoDialogOpen})},n.unshareRepo=function(){var e=n.props.item;n.props.unshareRepo(e.repo_id,e.name),n.toggleUnshareRepoDialog()},n.renderRepoName=function(){var e=n.props.item,t=e;return t.id=e.repo_id,t.name?m.am&&Qn&&!t.encrypted?(0,A.jsx)("a",{href:"".concat(m.Yc,"sys/libraries/").concat(t.id,"/"),children:t.name}):t.name:"--"},n.state={isOpIconShown:!1,isUnshareRepoDialogOpen:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.state,t=e.isOpIconShown,n=e.isUnshareRepoDialogOpen,r=this.props.item,i=f.Aq.getLibIconUrl(r),s=f.Aq.getLibIconTitle(r),a='<span class="op-target">'+f.Aq.HTMLescape(r.name)+"</span>",o=(0,m.AP)("Are you sure you want to unshare {placeholder} ?").replace("{placeholder}",a);return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("tr",{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,A.jsx)("td",{children:(0,A.jsx)("img",{src:i,title:s,alt:s,width:"24"})}),(0,A.jsx)("td",{children:this.renderRepoName()}),(0,A.jsx)("td",{children:f.Aq.bytesToSize(r.size)}),(0,A.jsx)("td",{children:(0,A.jsx)(ue,{email:r.shared_by,name:r.shared_by_name})}),(0,A.jsx)("td",{children:(0,A.jsx)("a",{href:"#",className:"action-icon sf2-icon-x3 ".concat(t?"":"invisible"),title:(0,m.AP)("Unshare"),onClick:this.toggleUnshareRepoDialog})})]}),n&&(0,A.jsx)(Ee.A,{title:(0,m.AP)("Unshare Library"),message:o,executeOperation:this.unshareRepo,confirmBtnText:(0,m.AP)("Unshare"),toggleDialog:this.toggleUnshareRepoDialog})]})}}])}(l.Component),$n=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).unshareRepo=function(e,t){D.e.sysAdminUnshareRepoFromGroup(n.props.groupID,e).then((function(r){var i=n.state.repoList.filter((function(t){return t.repo_id!=e}));n.setState({repoList:i});var s=(0,m.AP)("Successfully unshared library {placeholder}").replace("{placeholder}",t);w.A.success(s)})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.state={loading:!0,errorMsg:"",groupName:"",repoList:[]},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this;D.e.sysAdminListGroupRepos(this.props.groupID).then((function(t){e.setState({loading:!1,repoList:t.data.libraries,groupName:t.data.group_name})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)({},this.props)),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)(Gn,{groupID:this.props.groupID,groupName:this.state.groupName,currentItem:"repos"}),(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsx)(Kn,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.repoList,unshareRepo:this.unshareRepo})})]})})]})}}])}(l.Component),Zn=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleSelectChange=function(e){n.setState({selectedOptions:e,isSubmitBtnDisabled:!e.length})},n.addMembers=function(){var e=n.state.selectedOptions.map((function(e){return e.email}));n.props.addMembers(e),n.props.toggle()},n.state={selectedOptions:null,isSubmitBtnDisabled:!0},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.state.isSubmitBtnDisabled;return(0,A.jsxs)(u.A,{isOpen:!0,toggle:this.props.toggle,children:[(0,A.jsx)(be.A,{toggle:this.props.toggle,children:(0,m.AP)("Add Member")}),(0,A.jsx)(je.A,{children:(0,A.jsx)(Fe.A,{ref:"userSelect",isMulti:!0,placeholder:(0,m.AP)("Search users"),onSelectChange:this.handleSelectChange})}),(0,A.jsxs)(De.A,{children:[(0,A.jsx)(S.A,{color:"secondary",onClick:this.props.toggle,children:(0,m.AP)("Cancel")}),(0,A.jsx)(S.A,{color:"primary",onClick:this.addMembers,disabled:e,children:(0,m.AP)("Submit")})]})]})}}])}(l.Component),Jn=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleItemFreezed=function(e){n.setState({isItemFreezed:e})},n.getPreviousPageList=function(){n.props.getListByPage(n.props.pageInfo.current_page-1)},n.getNextPageList=function(){n.props.getListByPage(n.props.pageInfo.current_page+1)},n.state={isItemFreezed:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,i=t.items,s=t.pageInfo,a=t.curPerPage;if(n)return(0,A.jsx)(I.A,{});if(r)return(0,A.jsx)("p",{className:"error text-center mt-4",children:r});var o=(0,A.jsx)(ie.A,{text:(0,m.AP)("No members")}),c=(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("table",{children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"5%"}),(0,A.jsx)("th",{width:"55%",children:(0,m.AP)("Name")}),(0,A.jsx)("th",{width:"30%",children:(0,m.AP)("Role")}),(0,A.jsx)("th",{width:"10%"})]})}),(0,A.jsx)("tbody",{children:i.map((function(t,n){return(0,A.jsx)(er,{item:t,isItemFreezed:e.state.isItemFreezed,toggleItemFreezed:e.toggleItemFreezed,removeMember:e.props.removeMember,updateMemberRole:e.props.updateMemberRole},n)}))})]}),s&&(0,A.jsx)(X.A,{gotoPreviousPage:this.getPreviousPageList,gotoNextPage:this.getNextPageList,currentPage:s.current_page,hasNextPage:s.has_next_page,curPerPage:a,resetPerPage:this.props.resetPerPage})]});return i.length?c:o}}])}(l.Component),er=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleMouseEnter=function(){n.props.isItemFreezed||n.setState({highlighted:!0})},n.handleMouseLeave=function(){n.props.isItemFreezed||n.setState({highlighted:!1})},n.toggleDeleteDialog=function(e){e&&e.preventDefault(),n.setState({isDeleteDialogOpen:!n.state.isDeleteDialogOpen})},n.removeMember=function(){var e=n.props.item;n.props.removeMember(e.email,e.name),n.toggleDeleteDialog()},n.updateMemberRole=function(e){n.props.updateMemberRole(n.props.item.email,e.value)},n.roleOptions=[{value:"Admin",text:(0,m.AP)("Admin"),isSelected:!1},{value:"Member",text:(0,m.AP)("Member"),isSelected:!1}],n.state={highlighted:!1,isDeleteDialogOpen:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.state,t=e.highlighted,n=e.isDeleteDialogOpen,r=this.props.item,i='<span class="op-target">'+f.Aq.HTMLescape(r.name)+"</span>",s=(0,m.AP)("Are you sure you want to remove {placeholder} ?").replace("{placeholder}",i),a=r.role;this.roleOptions=this.roleOptions.map((function(e){return e.isSelected=e.value==a,e}));var o=this.roleOptions.filter((function(e){return e.isSelected}))[0];return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("tr",{className:t?"tr-highlight":"",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,A.jsx)("td",{children:(0,A.jsx)("img",{src:r.avatar_url,alt:"",className:"rounded-circle",width:"24"})}),(0,A.jsx)("td",{children:(0,A.jsx)(ue,{email:r.email,name:r.name})}),(0,A.jsx)("td",{children:"Owner"==r.role?(0,m.AP)("Owner"):(0,A.jsx)(Ve.A,{isDropdownToggleShown:t,currentSelectedOption:o,options:this.roleOptions,selectOption:this.updateMemberRole,toggleItemFreezed:this.props.toggleItemFreezed})}),(0,A.jsx)("td",{children:"Owner"!=r.role&&(0,A.jsx)("a",{href:"#",className:"action-icon sf2-icon-x3 ".concat(t?"":"invisible"),title:(0,m.AP)("Remove"),onClick:this.toggleDeleteDialog})})]}),n&&(0,A.jsx)(Ee.A,{title:(0,m.AP)("Remove Member"),message:s,executeOperation:this.removeMember,confirmBtnText:(0,m.AP)("Remove"),toggleDialog:this.toggleDeleteDialog})]})}}])}(l.Component),tr=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).getListByPage=function(e){var t=n.state.perPage;D.e.sysAdminListGroupMembers(n.props.groupID,e,t).then((function(e){n.setState({loading:!1,memberList:e.data.members,groupName:e.data.group_name,pageInfo:e.data.page_info})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){n.getListByPage(1)}))},n.toggleAddMemgerDialog=function(){n.setState({isAddMemberDialogOpen:!n.state.isAddMemberDialogOpen})},n.addMembers=function(e){D.e.sysAdminAddGroupMember(n.props.groupID,e).then((function(e){var t=e.data.success;t.length&&(n.setState({memberList:t.concat(n.state.memberList)}),t.forEach((function(e){var t=(0,m.AP)("Successfully added {email_placeholder}").replace("{email_placeholder}",e.email);w.A.success(t)}))),e.data.failed.forEach((function(e){var t=(0,m.AP)("Failed to add {email_placeholder}: {error_msg_placeholder}").replace("{email_placeholder}",e.email).replace("{error_msg_placeholder}",e.error_msg);w.A.danger(t,{duration:3})}))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.removeMember=function(e,t){D.e.sysAdminDeleteGroupMember(n.props.groupID,e).then((function(r){var i=n.state.memberList.filter((function(t){return t.email!=e}));n.setState({memberList:i}),w.A.success((0,m.AP)("Successfully removed {placeholder}.").replace("{placeholder}",t))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.updateMemberRole=function(e,t){var r="Admin"==t;D.e.sysAdminUpdateGroupMemberRole(n.props.groupID,e,r).then((function(r){var i=n.state.memberList.map((function(n){return n.email==e&&(n.role=t),n}));n.setState({memberList:i})})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.state={loading:!0,errorMsg:"",groupName:"",memberList:[],pageInfo:{},currentPage:1,perPage:25,isAddMemberDialogOpen:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,r=n.currentPage,i=n.perPage;this.setState({currentPage:parseInt(t.get("page")||r),perPage:parseInt(t.get("per_page")||i)},(function(){e.getListByPage(e.state.currentPage)}))}},{key:"render",value:function(){var e=this.state.isAddMemberDialogOpen;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)((0,r.A)({},this.props),{},{children:(0,A.jsx)(S.A,{className:"btn btn-secondary operation-item",onClick:this.toggleAddMemgerDialog,children:(0,m.AP)("Add Member")})})),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)(Gn,{currentItem:"members",groupID:this.props.groupID,groupName:this.state.groupName}),(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsx)(Jn,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.memberList,removeMember:this.removeMember,updateMemberRole:this.updateMemberRole,pageInfo:this.state.pageInfo,curPerPage:this.state.perPage,getListByPage:this.getListByPage,resetPerPage:this.resetPerPage})})]})}),e&&(0,A.jsx)(Zn,{addMembers:this.addMembers,toggle:this.toggleAddMemgerDialog})]})}}])}(l.Component),nr=(n(13669),function(e){function t(){return(0,i.A)(this,t),(0,a.A)(this,t,arguments)}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){return(0,A.jsx)("div",{className:"h-100 org-departments",children:this.props.children})}}])}(l.Component)),rr=nr,ir=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleSubmit=function(){if(n.validateName()){var e=-1;n.props.parentGroupID&&(e=n.props.parentGroupID),D.e.sysAdminAddNewDepartment(e,n.state.departName.trim()).then((function(e){n.props.toggle(),n.props.onAddNewDepartment(e.data)})).catch((function(e){var t=(0,m.AP)(e.response.data.error_msg);n.setState({errMessage:t})}))}},n.validateName=function(){var e="";return!!n.state.departName.trim().length||(e=(0,m.AP)("Name is required"),n.setState({errMessage:e}),!1)},n.handleChange=function(e){n.setState({departName:e.target.value})},n.handleKeyDown=function(e){"Enter"===e.key&&(n.handleSubmit(),e.preventDefault())},n.state={departName:"",errMessage:""},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.parentGroupID?(0,m.AP)("New Sub-department"):(0,m.AP)("New Department");return(0,A.jsxs)(u.A,{isOpen:!0,toggle:this.props.toggle,autoFocus:!1,children:[(0,A.jsx)(be.A,{toggle:this.props.toggle,children:e}),(0,A.jsxs)(je.A,{children:[(0,A.jsx)(Ie.A,{children:(0,A.jsxs)(ke.A,{children:[(0,A.jsx)(_e.A,{for:"departName",children:(0,m.AP)("Name")}),(0,A.jsx)(W.A,{id:"departName",onKeyDown:this.handleKeyDown,value:this.state.departName,onChange:this.handleChange,autoFocus:!0})]})}),this.state.errMessage&&(0,A.jsx)("p",{className:"error",children:this.state.errMessage})]}),(0,A.jsxs)(De.A,{children:[(0,A.jsx)(S.A,{color:"secondary",onClick:this.props.toggle,children:(0,m.AP)("Cancel")}),(0,A.jsx)(S.A,{color:"primary",onClick:this.handleSubmit,children:(0,m.AP)("Submit")})]})]})}}])}(l.Component),sr=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleSubmit=function(){n.validateName()&&D.e.sysAdminRenameDepartment(n.props.groupID,n.state.departmentName.trim()).then((function(e){n.props.toggle(),n.props.onDepartmentNameChanged(e.data),w.A.success((0,m.AP)("Success"))})).catch((function(e){var t=f.Aq.getErrorMsg(e);n.setState({errMessage:t})}))},n.validateName=function(){var e="";return!!n.state.departmentName.trim().length||(e=(0,m.AP)("Name is required"),n.setState({errMessage:e}),!1)},n.handleChange=function(e){n.setState({departmentName:e.target.value})},n.handleKeyDown=function(e){"Enter"===e.key&&(n.handleSubmit(),e.preventDefault())},n.onAfterModelOpened=function(){n.newInput.current&&(n.newInput.current.focus(),n.newInput.current.select())},n.state={departmentName:n.props.name,errMessage:""},n.newInput=l.createRef(),n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=(0,m.AP)("Rename Department");return(0,A.jsxs)(u.A,{isOpen:!0,toggle:this.props.toggle,onOpened:this.onAfterModelOpened,children:[(0,A.jsx)(be.A,{toggle:this.props.toggle,children:e}),(0,A.jsxs)(je.A,{children:[(0,A.jsx)(Ie.A,{children:(0,A.jsxs)(ke.A,{children:[(0,A.jsx)(_e.A,{for:"departmentName",children:(0,m.AP)("Name")}),(0,A.jsx)(W.A,{id:"departmentName",onKeyDown:this.handleKeyDown,value:this.state.departmentName,onChange:this.handleChange,innerRef:this.newInput})]})}),this.state.errMessage&&(0,A.jsx)("p",{className:"error",children:this.state.errMessage})]}),(0,A.jsxs)(De.A,{children:[(0,A.jsx)(S.A,{color:"secondary",onClick:this.props.toggle,children:(0,m.AP)("Cancel")}),(0,A.jsx)(S.A,{color:"primary",onClick:this.handleSubmit,children:(0,m.AP)("Submit")})]})]})}}])}(l.Component),ar=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).deleteDepart=function(){n.props.toggle();var e=n.props.group;D.e.sysAdminDeleteDepartment(e.id).then((function(t){n.props.onDeleteDepartment(e.id)})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.group,t=(0,m.AP)("Are you sure you want to delete {placeholder} ?");return t=t.replace("{placeholder}",'<span class="op-target">'+f.Aq.HTMLescape(e.name)+"</span>"),(0,A.jsxs)(u.A,{isOpen:!0,toggle:this.props.toggle,children:[(0,A.jsx)(be.A,{toggle:this.props.toggle,children:(0,m.AP)("Delete Department")}),(0,A.jsx)(je.A,{children:(0,A.jsx)("p",{dangerouslySetInnerHTML:{__html:t}})}),(0,A.jsxs)(De.A,{children:[(0,A.jsx)(S.A,{color:"secondary",onClick:this.props.toggle,children:(0,m.AP)("Cancel")}),(0,A.jsx)(S.A,{color:"primary",onClick:this.deleteDepart,children:(0,m.AP)("Delete")})]})]})}}])}(l.Component),or=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).setGroupQuota=function(){var e=n.state.quota;if(e.length&&/^[1-9]\d*$/im.test(e)||-2==e){n.setState({errMessage:""});var t=-2==n.state.quota?n.state.quota:1e6*n.state.quota;D.e.sysAdminUpdateDepartmentQuota(n.props.groupID,t).then((function(e){n.props.toggle(),n.props.onSetQuota(e.data)})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))}else{var r=(0,m.AP)("Quota is invalid.");n.setState({errMessage:r})}},n.handleChange=function(e){var t=e.target.value.trim();n.setState({quota:t})},n.handleKeyDown=function(e){"Enter"===e.key&&(n.setGroupQuota(),e.preventDefault())},n.state={quota:"",errMessage:""},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){return(0,A.jsxs)(u.A,{isOpen:!0,toggle:this.props.toggle,autoFocus:!1,children:[(0,A.jsx)(be.A,{toggle:this.props.toggle,children:(0,m.AP)("Set Quota")}),(0,A.jsxs)(je.A,{children:[(0,A.jsxs)(Ne.A,{children:[(0,A.jsx)(W.A,{onKeyDown:this.handleKeyDown,value:this.state.quota,onChange:this.handleChange,autoFocus:!0}),(0,A.jsx)(Me.A,{addonType:"append",children:"MB"})]}),(0,A.jsxs)("p",{className:"tip",children:[(0,A.jsx)("br",{}),(0,A.jsx)("span",{children:(0,m.AP)("An integer that is greater than 0 or equal to -2.")}),(0,A.jsx)("br",{}),(0,A.jsx)("span",{children:(0,m.AP)("Tip: -2 means no limit.")})]}),this.state.errMessage&&(0,A.jsx)("p",{className:"error",children:this.state.errMessage})]}),(0,A.jsxs)(De.A,{children:[(0,A.jsx)(S.A,{color:"secondary",onClick:this.props.toggle,children:(0,m.AP)("Cancel")}),(0,A.jsx)(S.A,{color:"primary",onClick:this.setGroupQuota,children:(0,m.AP)("Submit")})]})]})}}])}(l.Component),lr=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleMouseOver=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!0,highlight:!0})},n.handleMouseOut=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!1,highlight:!1})},n.onUnfreezedItem=function(){n.setState({highlight:!1,isOpIconShow:!1}),n.props.onUnfreezedItem()},n.translateOperations=function(e){var t="";switch(e){case"Rename":t=(0,m.AP)("Rename");break;case"Delete":t=(0,m.AP)("Delete")}return t},n.onMenuItemClick=function(e){switch(e){case"Rename":n.toggleRenameDialog();break;case"Delete":n.toggleDeleteDialog()}},n.toggleRenameDialog=function(){n.setState({isRenameDialogOpen:!n.state.isRenameDialogOpen})},n.toggleDeleteDialog=function(){n.setState({isDeleteDialogOpen:!n.state.isDeleteDialogOpen})},n.toggleSetQuotaDialog=function(){n.setState({isSetQuotaDialogOpen:!n.state.isSetQuotaDialogOpen})},n.state={isOpIconShown:!1,highlight:!1,isSetQuotaDialogOpen:!1,isDeleteDialogOpen:!1,isRenameDialogOpen:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.group,t=this.state,n=t.highlight,r=t.isOpIconShown,i=t.isRenameDialogOpen,s=t.isDeleteDialogOpen,a=t.isSetQuotaDialogOpen,o=m.Yc+"sys/departments/"+e.id+"/";return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.handleMouseOver,onMouseLeave:this.handleMouseOut,children:[(0,A.jsx)("td",{children:(0,A.jsx)(g.N_,{to:o,children:e.name})}),(0,A.jsx)("td",{children:C()(e.created_at).fromNow()}),(0,A.jsxs)("td",{children:[f.Aq.bytesToSize(e.quota)," ",(0,A.jsx)("span",{onClick:this.toggleSetQuotaDialog,title:(0,m.AP)("Edit"),className:"sf3-font sf3-font-rename attr-action-icon ".concat(n?"":"vh")})]}),(0,A.jsx)("td",{children:r&&(0,A.jsx)(He.A,{operations:["Rename","Delete"],translateOperations:this.translateOperations,onMenuItemClick:this.onMenuItemClick,onFreezedItem:this.props.onFreezedItem,onUnfreezedItem:this.onUnfreezedItem})})]}),s&&(0,A.jsx)(Kt.A,{children:(0,A.jsx)(ar,{group:e,onDeleteDepartment:this.props.onDeleteDepartment,toggle:this.toggleDeleteDialog})}),a&&(0,A.jsx)(Kt.A,{children:(0,A.jsx)(or,{groupID:e.id,onSetQuota:this.props.onSetDepartmentQuota,toggle:this.toggleSetQuotaDialog})}),i&&(0,A.jsx)(sr,{groupID:e.id,name:e.name,toggle:this.toggleRenameDialog,onDepartmentNameChanged:this.props.onDepartmentNameChanged})]})}}])}(l.Component),cr=lr;C().locale(m.vV);var dr=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.listDepartments=function(){D.e.sysAdminListAllDepartments().then((function(e){n.setState({groups:e.data.data})}))},n.toggleAddDepartDialog=function(){n.setState({isShowAddDepartDialog:!n.state.isShowAddDepartDialog})},n.onDepartmentNameChanged=function(e){n.setState({groups:n.state.groups.map((function(t){return t.id==e.id&&(t.name=e.name),t}))})},n.onAddNewDepartment=function(e){var t=n.state.groups;t.unshift(e),n.setState({groups:t})},n.onDeleteDepartment=function(e){var t=n.state.groups;n.setState({groups:t.filter((function(t){return t.id!=e}))})},n.onSetDepartmentQuota=function(e){var t=n.state.groups;n.setState({groups:t.map((function(t){return t.id==e.id&&(t.quota=e.quota),t}))})},n.state={groups:null,groupID:"",isShowAddDepartDialog:!1,isItemFreezed:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){this.listDepartments()}},{key:"render",value:function(){var e=this,t=this.state.groups,n=(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)("button",{className:"btn btn-secondary operation-item",title:(0,m.AP)("New Department"),onClick:this.toggleAddDepartDialog,children:(0,m.AP)("New Department")}),this.state.isShowAddDepartDialog&&(0,A.jsx)(Kt.A,{children:(0,A.jsx)(ir,{onAddNewDepartment:this.onAddNewDepartment,groupID:this.state.groupID,toggle:this.toggleAddDepartDialog})})]});return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)((0,r.A)({},this.props),{},{children:n})),(0,A.jsx)("div",{className:"main-panel-center flex-row h-100",children:(0,A.jsxs)("div",{className:"cur-view-container o-auto",children:[(0,A.jsx)("div",{className:"cur-view-path",children:(0,A.jsx)("div",{className:"fleft",children:(0,A.jsx)("h3",{className:"sf-heading",children:(0,m.AP)("Departments")})})}),(0,A.jsx)("div",{className:"cur-view-content",children:t&&t.length>0?(0,A.jsxs)("table",{children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"40%",children:(0,m.AP)("Name")}),(0,A.jsx)("th",{width:"25%",children:(0,m.AP)("Created At")}),(0,A.jsx)("th",{width:"20%",children:(0,m.AP)("Quota")}),(0,A.jsx)("th",{width:"15%"})]})}),(0,A.jsx)("tbody",{children:t.map((function(t,n){return(0,A.jsx)(l.Fragment,{children:(0,A.jsx)(cr,{group:t,isItemFreezed:e.state.isItemFreezed,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem,onDepartmentNameChanged:e.onDepartmentNameChanged,onDeleteDepartment:e.onDeleteDepartment,onSetDepartmentQuota:e.onSetDepartmentQuota})},t.id)}))})]}):(0,A.jsx)("p",{className:"no-group",children:(0,m.AP)("No departments")})})]})})]})}}])}(l.Component),hr=dr,ur=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleSelectChange=function(e){n.setState({selectedOption:e})},n.handleSubmit=function(){if(n.state.selectedOption){var e=n.state.selectedOption.map((function(e){return e.email}));n.refs.orgSelect.clearSelect(),n.setState({errMessage:[]}),D.e.sysAdminAddGroupMember(n.props.groupID,e).then((function(e){n.setState({selectedOption:null}),e.data.failed.length>0&&n.setState({errMessage:e.data.failed[0].error_msg}),e.data.success.length>0&&(n.props.onAddNewMembers(e.data.success),n.props.toggle())})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))}},n.state={selectedOption:null,errMessage:""},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){return(0,A.jsxs)(u.A,{isOpen:!0,toggle:this.props.toggle,children:[(0,A.jsx)(be.A,{toggle:this.props.toggle,children:(0,m.AP)("Add Member")}),(0,A.jsxs)(je.A,{children:[(0,A.jsx)(Fe.A,{placeholder:(0,m.AP)("Search users"),onSelectChange:this.handleSelectChange,ref:"orgSelect",isMulti:!0,className:"org-add-member-select"}),this.state.errMessage&&(0,A.jsx)("p",{className:"error",children:this.state.errMessage})]}),(0,A.jsxs)(De.A,{children:[(0,A.jsx)(S.A,{color:"secondary",onClick:this.props.toggle,children:(0,m.AP)("Cancel")}),(0,A.jsx)(S.A,{color:"primary",onClick:this.handleSubmit,children:(0,m.AP)("Submit")})]})]})}}])}(l.Component),gr=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleSubmit=function(){n.validateName()&&D.e.sysAdminAddRepoInDepartment(n.props.groupID,n.state.repoName.trim()).then((function(e){n.props.toggle(),n.props.onAddNewRepo(e.data)})).catch((function(e){var t=f.Aq.getErrorMsg(e);n.setState({errMessage:t})}))},n.validateName=function(){var e="";return!!n.state.repoName.trim().length||(e=(0,m.AP)("Name is required"),n.setState({errMessage:e}),!1)},n.handleChange=function(e){n.setState({repoName:e.target.value})},n.handleKeyDown=function(e){"Enter"===e.key&&(n.handleSubmit(),e.preventDefault())},n.state={repoName:"",errMessage:""},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){return(0,A.jsxs)(u.A,{isOpen:!0,toggle:this.props.toggle,autoFocus:!1,children:[(0,A.jsx)(be.A,{toggle:this.props.toggle,children:(0,m.AP)("New Library")}),(0,A.jsxs)(je.A,{children:[(0,A.jsx)(Ie.A,{children:(0,A.jsxs)(ke.A,{children:[(0,A.jsx)(_e.A,{for:"repoName",children:(0,m.AP)("Name")}),(0,A.jsx)(W.A,{id:"repoName",onKeyDown:this.handleKeyDown,value:this.state.repoName,onChange:this.handleChange,autoFocus:!0})]})}),this.state.errMessage&&(0,A.jsx)("p",{className:"error",children:this.state.errMessage})]}),(0,A.jsxs)(De.A,{children:[(0,A.jsx)(S.A,{color:"secondary",onClick:this.props.toggle,children:(0,m.AP)("Cancel")}),(0,A.jsx)(S.A,{color:"primary",onClick:this.handleSubmit,children:(0,m.AP)("Submit")})]})]})}}])}(l.Component);C().locale(m.vV);var pr=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).getDepartmentInfo=function(e){D.e.sysAdminGetDepartmentInfo(e,!0).then((function(e){n.setState({ancestorGroups:e.data.ancestor_groups,groupName:e.data.name})})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.onDepartmentNameChanged=function(e){n.setState({groupName:e.name})},n.toggleRenameDepartmentDialog=function(){n.setState({isShowRenameDepartmentDialog:!n.state.isShowRenameDepartmentDialog})},n.toggleAddRepoDialog=function(){n.setState({isShowAddRepoDialog:!n.state.isShowAddRepoDialog})},n.toggleAddMemberDialog=function(){n.setState({isShowAddMemberDialog:!n.state.isShowAddMemberDialog})},n.toggleAddDepartmentDialog=function(){n.setState({isShowAddDepartmentDialog:!n.state.isShowAddDepartmentDialog})},n.state={groupName:"",ancestorGroups:[],isShowAddDepartmentDialog:!1,isShowAddMemberDialog:!1,isShowRenameDepartmentDialog:!1,isShowAddRepoDialog:!1},n.navItems=[{name:"subDepartments",urlPart:"/",text:(0,m.AP)("Sub-departments")},{name:"members",urlPart:"/members/",text:(0,m.AP)("Members")},{name:"repos",urlPart:"/libraries/",text:(0,m.AP)("Libraries")}],n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this.props.groupID;this.getDepartmentInfo(e)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.groupID!==e.groupID&&this.getDepartmentInfo(e.groupID)}},{key:"render",value:function(){var e=this.props,t=e.groupID,n=e.currentItem,i=this.state.groupName,s="btn btn-secondary operation-item",a=(0,A.jsxs)(l.Fragment,{children:[t&&(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)("button",{className:s,title:(0,m.AP)("Rename Department"),onClick:this.toggleRenameDepartmentDialog,children:(0,m.AP)("Rename Department")}),"subDepartments"==n&&(0,A.jsx)("button",{className:s,title:(0,m.AP)("New Sub-department"),onClick:this.toggleAddDepartmentDialog,children:(0,m.AP)("New Sub-department")}),"members"==n&&(0,A.jsx)("button",{className:s,title:(0,m.AP)("Add Member"),onClick:this.toggleAddMemberDialog,children:(0,m.AP)("Add Member")}),"repos"==n&&(0,A.jsx)("button",{className:s,onClick:this.toggleAddRepoDialog,title:(0,m.AP)("New Library"),children:(0,m.AP)("New Library")})]}),this.state.isShowRenameDepartmentDialog&&(0,A.jsx)(Kt.A,{children:(0,A.jsx)(sr,{groupID:t,name:i,toggle:this.toggleRenameDepartmentDialog,onDepartmentNameChanged:this.onDepartmentNameChanged})}),this.state.isShowAddMemberDialog&&(0,A.jsx)(Kt.A,{children:(0,A.jsx)(ur,{toggle:this.toggleAddMemberDialog,onAddNewMembers:this.props.onAddNewMembers,groupID:t})}),this.state.isShowAddRepoDialog&&(0,A.jsx)(Kt.A,{children:(0,A.jsx)(gr,{toggle:this.toggleAddRepoDialog,onAddNewRepo:this.props.onAddNewRepo,groupID:t})}),this.state.isShowAddDepartmentDialog&&(0,A.jsx)(Kt.A,{children:(0,A.jsx)(ir,{onAddNewDepartment:this.props.onAddNewDepartment,parentGroupID:t,toggle:this.toggleAddDepartmentDialog})})]});return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)((0,r.A)({},this.props),{},{children:a})),(0,A.jsx)("div",{className:"main-panel-center flex-row h-100",children:(0,A.jsxs)("div",{className:"cur-view-container o-auto",children:[(0,A.jsx)("div",{className:"cur-view-path",children:(0,A.jsx)("div",{className:"fleft",children:(0,A.jsxs)("h3",{className:"sf-heading",children:[t?(0,A.jsx)(g.N_,{to:m.Yc+"sys/departments/",children:(0,m.AP)("Departments")}):(0,A.jsx)("span",{children:(0,m.AP)("Departments")}),this.state.ancestorGroups.map((function(e){var t=m.Yc+"sys/departments/"+e.id+"/";return(0,A.jsxs)("span",{children:[" / ",(0,A.jsx)(g.N_,{to:t,children:e.name})]},e.id)})),t&&(0,A.jsxs)("span",{children:[" / ",i]})]})})}),(0,A.jsx)("ul",{className:"nav border-bottom mx-4",children:this.navItems.map((function(e,r){return(0,A.jsx)("li",{className:"nav-item mr-2",children:(0,A.jsx)(g.N_,{to:"".concat(m.Yc,"sys/departments/").concat(t).concat(e.urlPart),className:"nav-link ".concat(n==e.name?" active":""),children:e.text})},r)}))}),this.props.children]})})]})}}])}(l.Component);C().locale(m.vV);var mr=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).listSubDepartments=function(e){D.e.sysAdminGetDepartmentInfo(e,!0).then((function(e){n.setState({groups:e.data.groups})})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.onSubDepartmentNameChanged=function(e){n.setState({groups:n.state.groups.map((function(t){return t.id==e.id&&(t.name=e.name),t}))})},n.onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.onAddNewDepartment=function(e){var t=n.state.groups;t.unshift(e),n.setState({groups:t})},n.onDeleteDepartment=function(e){var t=n.state.groups;n.setState({groups:t.filter((function(t){return t.id!=e}))})},n.onSetDepartmentQuota=function(e){var t=n.state.groups;n.setState({groups:t.map((function(t){return t.id==e.id&&(t.quota=e.quota),t}))})},n.state={isItemFreezed:!1,groups:[]},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){this.listSubDepartments(this.props.groupID)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.groupID!==e.groupID&&this.listSubDepartments(e.groupID)}},{key:"render",value:function(){var e=this,t=this.state.groups,n=this.props.groupID;return(0,A.jsx)(pr,{groupID:n,currentItem:"subDepartments",onAddNewDepartment:this.onAddNewDepartment,children:(0,A.jsx)("div",{className:"cur-view-content",children:t&&t.length>0?(0,A.jsxs)("table",{children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"40%",children:(0,m.AP)("Name")}),(0,A.jsx)("th",{width:"25%",children:(0,m.AP)("Created At")}),(0,A.jsx)("th",{width:"20%",children:(0,m.AP)("Quota")}),(0,A.jsx)("th",{width:"15%"})]})}),(0,A.jsx)("tbody",{children:t.map((function(t,n){return(0,A.jsx)(cr,{isItemFreezed:e.state.isItemFreezed,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem,onDepartmentNameChanged:e.onSubDepartmentNameChanged,group:t,onDeleteDepartment:e.onDeleteDepartment,onSetDepartmentQuota:e.onSetDepartmentQuota},t.id)}))})]}):(0,A.jsx)("p",{className:"no-group",children:(0,m.AP)("No sub-departments")})})})}}])}(l.Component),fr=mr,xr=n(60436),vr=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).deleteMember=function(){var e=n.props.member.email;D.e.sysAdminDeleteGroupMember(n.props.groupID,e).then((function(e){e.data.success&&(n.props.onMemberChanged(),n.props.toggle())})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=(0,m.AP)("Are you sure you want to delete {placeholder} ?");return e=e.replace("{placeholder}",'<span class="op-target">'+f.Aq.HTMLescape(this.props.member.name)+"</span>"),(0,A.jsxs)(u.A,{isOpen:!0,toggle:this.props.toggle,children:[(0,A.jsx)(be.A,{toggle:this.props.toggle,children:(0,m.AP)("Delete Member")}),(0,A.jsx)(je.A,{children:(0,A.jsx)("div",{dangerouslySetInnerHTML:{__html:e}})}),(0,A.jsxs)(De.A,{children:[(0,A.jsx)(S.A,{color:"secondary",onClick:this.props.toggle,children:(0,m.AP)("Cancel")}),(0,A.jsx)(S.A,{color:"primary",onClick:this.deleteMember,children:(0,m.AP)("Delete")})]})]})}}])}(l.Component),Ar=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).onMouseEnter=function(){n.props.isItemFreezed||n.setState({highlight:!0})},n.onMouseLeave=function(){n.props.isItemFreezed||n.setState({highlight:!1})},n.onChangeUserRole=function(e){var t="Admin"===e.value;D.e.sysAdminUpdateGroupMemberRole(n.props.groupID,n.props.member.email,t).then((function(e){n.props.onMemberChanged()})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)})),n.setState({highlight:!1})},n.state={highlight:!1},n.roleOptions=[{value:"Admin",text:(0,m.AP)("Admin"),isSelected:!1},{value:"Member",text:(0,m.AP)("Member"),isSelected:!1}],n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.member,t=this.state.highlight;if("Owner"===e.role)return null;this.roleOptions=this.roleOptions.map((function(t){return t.isSelected=t.value==e.role,t}));var n=this.roleOptions.filter((function(e){return e.isSelected}))[0];return(0,A.jsxs)("tr",{className:t?"tr-highlight":"",onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[(0,A.jsx)("td",{children:(0,A.jsx)("img",{src:e.avatar_url,alt:"member-header",width:"24",className:"avatar"})}),(0,A.jsx)("td",{children:(0,A.jsx)(ue,{email:e.email,name:e.name})}),(0,A.jsx)("td",{children:(0,A.jsx)(Ve.A,{isDropdownToggleShown:t,currentSelectedOption:n,options:this.roleOptions,selectOption:this.onChangeUserRole,toggleItemFreezed:this.props.toggleItemFreezed})}),(0,A.jsx)("td",{className:"cursor-pointer text-center",onClick:this.props.showDeleteMemberDialog.bind(this,e),children:(0,A.jsx)("span",{className:"sf2-icon-x3 action-icon ".concat(t?"":"vh"),title:"Delete"})})]})}}])}(l.Component);C().locale(m.vV);var Pr=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).listMembers=function(e,t,r){D.e.sysAdminListGroupMembers(e,t,r).then((function(e){n.setState({members:e.data.members,currentPageInfo:e.data.page_info})})).catch((function(e){var t=f.Aq.getErrorMsg(e);n.setState({membersErrorMsg:t})}))},n.getPreviousPageList=function(){n.listMembers(n.props.groupID,n.state.currentPageInfo.current_page-1,n.state.perPage)},n.getNextPageList=function(){n.listMembers(n.props.groupID,n.state.currentPageInfo.current_page+1,n.state.perPage)},n.resetPerPage=function(e){n.setState({perPage:e},(function(){n.listMembers(n.props.groupID,1,e)}))},n.toggleCancel=function(){n.setState({showDeleteMemberDialog:!1})},n.onMemberChanged=function(){n.listMembers(n.props.groupID,n.state.currentPageInfo.current_page,n.state.perPage)},n.toggleItemFreezed=function(e){n.setState({isItemFreezed:e})},n.showDeleteMemberDialog=function(e){n.setState({showDeleteMemberDialog:!0,deletedMember:e})},n.onAddNewMembers=function(e){var t=n.state.members;t.unshift.apply(t,(0,xr.A)(e)),n.setState({members:t})},n.state={isItemFreezed:!1,members:[],membersErrorMsg:"",currentPageInfo:{},currentPage:1,perPage:25,deletedMember:{},showDeleteMemberDialog:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,r=n.currentPage,i=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||i),currentPage:parseInt(t.get("page")||r)},(function(){var t=e.props.groupID;e.listMembers(t,e.state.currentPage,e.state.perPage)}))}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.groupID!==e.groupID&&this.listMembers(e.groupID,this.state.currentPage,this.state.perPage)}},{key:"render",value:function(){var e=this,t=this.state,n=t.members,r=t.membersErrorMsg,i=this.props.groupID;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(pr,{groupID:i,currentItem:"members",onAddNewMembers:this.onAddNewMembers,children:(0,A.jsx)("div",{className:"cur-view-content",children:r?(0,A.jsx)("p",{className:"error text-center",children:r}):0==n.length?(0,A.jsx)("p",{className:"no-member",children:(0,m.AP)("No members")}):(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("table",{children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"5%"}),(0,A.jsx)("th",{width:"50%",children:(0,m.AP)("Name")}),(0,A.jsx)("th",{width:"15%",children:(0,m.AP)("Role")}),(0,A.jsx)("th",{width:"30%"})]})}),(0,A.jsx)("tbody",{children:n.map((function(t,n){return(0,A.jsx)(l.Fragment,{children:(0,A.jsx)(Ar,{member:t,showDeleteMemberDialog:e.showDeleteMemberDialog,isItemFreezed:e.state.isItemFreezed,onMemberChanged:e.onMemberChanged,toggleItemFreezed:e.toggleItemFreezed,groupID:i})},n)}))})]}),this.state.currentPageInfo&&(0,A.jsx)(X.A,{gotoPreviousPage:this.getPreviousPageList,gotoNextPage:this.getNextPageList,currentPage:this.state.currentPageInfo.current_page,hasNextPage:this.state.currentPageInfo.has_next_page,curPerPage:this.state.perPage,resetPerPage:this.resetPerPage})]})})}),this.state.showDeleteMemberDialog&&(0,A.jsx)(Kt.A,{children:(0,A.jsx)(vr,{toggle:this.toggleCancel,onMemberChanged:this.onMemberChanged,member:this.state.deletedMember,groupID:i})})]})}}])}(l.Component),yr=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).deleteRepo=function(){D.e.sysAdminDeleteRepoInDepartment(n.props.groupID,n.props.repo.repo_id).then((function(e){e.data.success&&(n.props.onRepoChanged(),n.props.toggle())})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.repo,t=(0,m.AP)("Are you sure you want to delete {placeholder} ?");return t=t.replace("{placeholder}",'<span class="op-target">'+f.Aq.HTMLescape(e.name||e.repo_name)+"</span>"),(0,A.jsxs)(u.A,{isOpen:!0,toggle:this.props.toggle,children:[(0,A.jsx)(be.A,{toggle:this.props.toggle,children:(0,m.AP)("Delete Library")}),(0,A.jsx)(je.A,{children:(0,A.jsx)("div",{dangerouslySetInnerHTML:{__html:t}})}),(0,A.jsxs)(De.A,{children:[(0,A.jsx)(S.A,{color:"secondary",onClick:this.props.toggle,children:(0,m.AP)("Cancel")}),(0,A.jsx)(S.A,{color:"primary",onClick:this.deleteRepo,children:(0,m.AP)("Delete")})]})]})}}])}(l.Component),br=window.sysadmin.pageOptions.enableSysAdminViewRepo,jr=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).onMouseEnter=function(){n.setState({highlight:!0})},n.onMouseLeave=function(){n.setState({highlight:!1})},n.state={highlight:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.repo,t=e.name||e.repo_name,n=this.state.highlight,r=f.Aq.getLibIconUrl(e);return(0,A.jsxs)("tr",{className:n?"tr-highlight":"",onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[(0,A.jsx)("td",{children:(0,A.jsx)("img",{src:r,width:"24",alt:(0,m.AP)("icon")})}),br?(0,A.jsx)("td",{children:(0,A.jsx)("a",{href:"".concat(m.Yc,"sys/libraries/").concat(e.repo_id,"/").concat(encodeURIComponent(t),"/"),children:t})}):(0,A.jsx)("td",{children:t}),(0,A.jsx)("td",{children:f.Aq.bytesToSize(e.size)}),(0,A.jsx)("td",{className:"cursor-pointer text-center",onClick:this.props.showDeleteRepoDialog.bind(this,e),children:(0,A.jsx)("span",{className:"sf3-font-delete1 sf3-font action-icon ".concat(n?"":"vh"),title:"Delete"})})]})}}])}(l.Component);C().locale(m.vV);var Sr=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).listGroupRepo=function(e){D.e.sysAdminListGroupRepos(e).then((function(e){n.setState({repos:e.data.libraries})})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.toggleCancel=function(){n.setState({showDeleteRepoDialog:!1})},n.onRepoChanged=function(){n.listGroupRepo(n.props.groupID)},n.showDeleteRepoDialog=function(e){n.setState({showDeleteRepoDialog:!0,deletedRepo:e})},n.onAddNewRepo=function(e){var t=n.state.repos;t.unshift(e),n.setState({repos:t})},n.state={repos:[],deletedRepo:{},showDeleteRepoDialog:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this.props.groupID;this.listGroupRepo(e)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.groupID!==e.groupID&&this.listGroupRepo(e.groupID)}},{key:"render",value:function(){var e=this,t=this.state.repos,n=this.props.groupID;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(pr,{groupID:n,currentItem:"repos",onAddNewRepo:this.onAddNewRepo,children:t.length>0?(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsxs)("table",{children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"5%"}),(0,A.jsx)("th",{width:"50%",children:(0,m.AP)("Name")}),(0,A.jsx)("th",{width:"30%",children:(0,m.AP)("Size")}),(0,A.jsx)("th",{width:"15%"})]})}),(0,A.jsx)("tbody",{children:t.map((function(t,n){return(0,A.jsx)(jr,{repo:t,showDeleteRepoDialog:e.showDeleteRepoDialog},n)}))})]})}):(0,A.jsx)("p",{className:"no-libraty",children:(0,m.AP)("No libraries")})}),this.state.showDeleteRepoDialog&&(0,A.jsx)(Kt.A,{children:(0,A.jsx)(yr,{toggle:this.toggleCancel,onRepoChanged:this.onRepoChanged,repo:this.state.deletedRepo,groupID:n})})]})}}])}(l.Component),Dr=Sr,wr=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).navItems=[{name:"shareLinks",urlPart:"share-links",text:(0,m.AP)("Share Links")},{name:"uploadLinks",urlPart:"upload-links",text:(0,m.AP)("Upload Links")}],n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.currentItem;return(0,A.jsx)("div",{className:"cur-view-path tab-nav-container",children:(0,A.jsx)("ul",{className:"nav",children:this.navItems.map((function(t,n){return(0,A.jsx)("li",{className:"nav-item",children:(0,A.jsx)(g.N_,{to:"".concat(m.Yc,"sys/").concat(t.urlPart,"/"),className:"nav-link".concat(e==t.name?" active":""),children:t.text})},n)}))})})}}])}(l.Component),Ir=wr,kr=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).getPreviousPage=function(){n.props.getShareLinksByPage(n.props.currentPage-1)},n.getNextPage=function(){n.props.getShareLinksByPage(n.props.currentPage+1)},n.sortByTime=function(e){e.preventDefault(),n.props.sortItems("ctime")},n.sortByCount=function(e){e.preventDefault(),n.props.sortItems("view_cnt")},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,i=t.items,s=t.perPage,a=t.currentPage,o=t.hasNextPage,c=t.sortBy,d=t.sortOrder;if(n)return(0,A.jsx)(I.A,{});if(r)return(0,A.jsx)("p",{className:"error text-center",children:r});var h=(0,A.jsx)(ie.A,{text:(0,m.AP)("No share links")}),u=(0,A.jsx)("span",{className:"sf3-font sf3-font-sort3"}),g=(0,A.jsx)("span",{className:"sf3-font ".concat("asc"==d?"sf3-font-down rotate-180 d-inline-block":"sf3-font-down")}),p=(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("table",{className:"table-hover",children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"18%",children:(0,m.AP)("Name")}),(0,A.jsx)("th",{width:"18%",children:(0,m.AP)("Token")}),(0,A.jsx)("th",{width:"18%",children:(0,m.AP)("Owner")}),(0,A.jsx)("th",{width:"15%",children:(0,A.jsxs)("a",{className:"d-inline-block table-sort-op",href:"#",onClick:this.sortByTime,children:[(0,m.AP)("Created At")," ","ctime"==c?g:u]})}),(0,A.jsx)("th",{width:"10%",children:(0,A.jsxs)("a",{className:"d-inline-block table-sort-op",href:"#",onClick:this.sortByCount,children:[(0,m.AP)("Visit count")," ","view_cnt"==c?g:u]})}),(0,A.jsx)("th",{width:"11%",children:(0,m.AP)("Expiration")}),(0,A.jsx)("th",{width:"10%"})]})}),i&&(0,A.jsx)("tbody",{children:i.map((function(t,n){return(0,A.jsx)(_r,{item:t,deleteShareLink:e.props.deleteShareLink},n)}))})]}),(0,A.jsx)(X.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:a,hasNextPage:o,curPerPage:s,resetPerPage:this.props.resetPerPage})]});return i.length?p:h}}])}(l.Component),_r=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleMouseOver=function(){n.setState({isOpIconShown:!0})},n.handleMouseOut=function(){n.setState({isOpIconShown:!1})},n.deleteShareLink=function(){n.props.deleteShareLink(n.props.item.token)},n.renderExpiration=function(){var e=n.props.item;if(!e.expire_date)return"--";var t=C()(e.expire_date).format("YYYY-MM-DD"),r=C()(e.expire_date).format("YYYY-MM-DD HH:mm:ss");return(0,A.jsx)("span",{className:e.is_expired?"error":"",title:r,children:t})},n.state={isOpIconShown:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.state.isOpIconShown,t=this.props.item,n="action-icon sf3-font-delete1 sf3-font ".concat(e?"":"invisible");return(0,A.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,children:[(0,A.jsx)("td",{children:t.obj_name}),(0,A.jsx)("td",{children:t.token}),(0,A.jsx)("td",{children:(0,A.jsx)(ue,{email:t.creator_email,name:t.creator_name})}),(0,A.jsx)("td",{children:C()(t.ctime).fromNow()}),(0,A.jsx)("td",{children:t.view_cnt}),(0,A.jsx)("td",{children:this.renderExpiration()}),(0,A.jsx)("td",{children:(0,A.jsx)("a",{href:"#",className:n,title:(0,m.AP)("Remove"),onClick:this.deleteShareLink})})]})}}])}(l.Component),Nr=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).getShareLinksByPage=function(e){var t=n.state,r=t.perPage,i=t.sortBy,s=t.sortOrder;D.e.sysAdminListShareLinks(e,r,i,s).then((function(t){n.setState({shareLinkList:t.data.share_link_list,loading:!1,currentPage:e,hasNextPage:f.Aq.hasNextPage(e,r,t.data.count)})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.sortItems=function(e){n.setState({currentPage:1,sortBy:e,sortOrder:"asc"==n.state.sortOrder?"desc":"asc"},(function(){var e=new URL(location.href),t=new URLSearchParams(e.search),r=n.state,i=r.currentPage,s=r.sortBy,a=r.sortOrder;t.set("page",i),t.set("order_by",s),t.set("direction",a),e.search=t.toString(),(0,g.oo)(e.toString()),n.getShareLinksByPage(i)}))},n.deleteShareLink=function(e){D.e.sysAdminDeleteShareLink(e).then((function(t){var r=n.state.shareLinkList.filter((function(t){return t.token!=e}));n.setState({shareLinkList:r})})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){return n.getShareLinksByPage(n.initPage)}))},n.state={loading:!0,errorMsg:"",shareLinkList:[],perPage:25,currentPage:1,hasNextPage:!1,sortBy:"",sortOrder:"asc"},n.initPage=1,n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,r=n.currentPage,i=n.perPage,s=n.sortBy,a=n.sortOrder;this.setState({perPage:parseInt(t.get("per_page")||i),currentPage:parseInt(t.get("page")||r),sortBy:t.get("order_by")||s,sortOrder:t.get("direction")||a},(function(){e.getShareLinksByPage(e.state.currentPage)}))}},{key:"render",value:function(){var e=this.state,t=e.shareLinkList,n=e.currentPage,i=e.perPage,s=e.hasNextPage;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)({},this.props)),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)(Ir,{currentItem:"shareLinks"}),(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsx)(kr,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:t,currentPage:n,perPage:i,hasNextPage:s,getShareLinksByPage:this.getShareLinksByPage,resetPerPage:this.resetPerPage,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems,deleteShareLink:this.deleteShareLink})})]})})]})}}])}(l.Component),Mr=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).getPreviousPage=function(){n.props.getUploadLinksByPage(n.props.currentPage-1)},n.getNextPage=function(){n.props.getUploadLinksByPage(n.props.currentPage+1)},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,i=t.items,s=t.perPage,a=t.currentPage,o=t.hasNextPage;if(n)return(0,A.jsx)(I.A,{});if(r)return(0,A.jsx)("p",{className:"error text-center",children:r});var c=(0,A.jsx)(ie.A,{text:(0,m.AP)("No upload links")}),d=(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("table",{className:"table-hover",children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"18%",children:(0,m.AP)("Name")}),(0,A.jsx)("th",{width:"18%",children:(0,m.AP)("Token")}),(0,A.jsx)("th",{width:"18%",children:(0,m.AP)("Owner")}),(0,A.jsx)("th",{width:"15%",children:(0,m.AP)("Created At")}),(0,A.jsx)("th",{width:"10%",children:(0,m.AP)("Visit count")}),(0,A.jsx)("th",{width:"11%",children:(0,m.AP)("Expiration")}),(0,A.jsx)("th",{width:"10%"})]})}),i&&(0,A.jsx)("tbody",{children:i.map((function(t,n){return(0,A.jsx)(Cr,{item:t,deleteUploadLink:e.props.deleteUploadLink},n)}))})]}),(0,A.jsx)(X.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:a,hasNextPage:o,curPerPage:s,resetPerPage:this.props.resetPerPage})]});return i.length?d:c}}])}(l.Component),Cr=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleMouseOver=function(){n.setState({isOpIconShown:!0})},n.handleMouseOut=function(){n.setState({isOpIconShown:!1})},n.deleteUploadLink=function(){n.props.deleteUploadLink(n.props.item.token)},n.renderExpiration=function(){var e=n.props.item;if(!e.expire_date)return"--";var t=C()(e.expire_date).format("YYYY-MM-DD"),r=C()(e.expire_date).format("YYYY-MM-DD HH:mm:ss");return(0,A.jsx)("span",{className:e.is_expired?"error":"",title:r,children:t})},n.state={isOpIconShown:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.state.isOpIconShown,t=this.props.item,n="action-icon sf3-font-delete1 sf3-font ".concat(e?"":"invisible");return(0,A.jsx)(l.Fragment,{children:(0,A.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,children:[(0,A.jsx)("td",{children:t.path}),(0,A.jsx)("td",{children:t.token}),(0,A.jsx)("td",{children:(0,A.jsx)(ue,{email:t.creator_email,name:t.creator_name})}),(0,A.jsx)("td",{children:C()(t.ctime).fromNow()}),(0,A.jsx)("td",{children:t.view_cnt}),(0,A.jsx)("td",{children:this.renderExpiration()}),(0,A.jsx)("td",{children:(0,A.jsx)("a",{href:"#",className:n,title:(0,m.AP)("Remove"),onClick:this.deleteUploadLink})})]})})}}])}(l.Component),Or=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).getUploadLinksByPage=function(e){var t=n.state.perPage;D.e.sysAdminListAllUploadLinks(e,t).then((function(r){n.setState({uploadLinkList:r.data.upload_link_list,loading:!1,currentPage:e,hasNextPage:f.Aq.hasNextPage(e,t,r.data.count)})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.deleteUploadLink=function(e){D.e.sysAdminDeleteUploadLink(e).then((function(t){var r=n.state.uploadLinkList.filter((function(t){return t.token!=e}));n.setState({uploadLinkList:r})})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){return n.getUploadLinksByPage(n.initPage)}))},n.state={loading:!0,errorMsg:"",uploadLinkList:[],perPage:25,currentPage:1,hasNextPage:!1},n.initPage=1,n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,r=n.currentPage,i=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||i),currentPage:parseInt(t.get("page")||r)},(function(){e.getUploadLinksByPage(e.state.currentPage)}))}},{key:"render",value:function(){var e=this.state,t=e.uploadLinkList,n=e.currentPage,i=e.perPage,s=e.hasNextPage;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)({},this.props)),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)(Ir,{currentItem:"uploadLinks"}),(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsx)(Mr,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:t,currentPage:n,perPage:i,hasNextPage:s,getUploadLinksByPage:this.getUploadLinksByPage,resetPerPage:this.resetPerPage,deleteUploadLink:this.deleteUploadLink})})]})})]})}}])}(l.Component),Lr=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).checkSubmitBtnActive=function(){var e=n.state,t=e.name,r=e.email,i=e.password,s=e.passwordAgain,a=!0;a=""!=t.trim()&&""!=r.trim()&&""!=i.trim()&&""!=s.trim(),n.setState({isSubmitBtnActive:a})},n.toggle=function(){n.props.toggleDialog()},n.inputPassword=function(e){var t=e.target.value;n.setState({password:t},n.checkSubmitBtnActive)},n.inputPasswordAgain=function(e){var t=e.target.value;n.setState({passwordAgain:t},n.checkSubmitBtnActive)},n.inputEmail=function(e){var t=e.target.value;n.setState({email:t},n.checkSubmitBtnActive)},n.inputName=function(e){var t=e.target.value;n.setState({name:t},n.checkSubmitBtnActive)},n.handleSubmit=function(){var e=n.state,t=e.name,r=e.email,i=e.password;if(i==e.passwordAgain){var s={orgName:t.trim(),ownerEmail:r.trim(),password:i.trim()};n.props.addOrg(s),n.toggle()}else n.setState({errorMsg:(0,m.AP)("Passwords do not match.")})},n.state={name:"",email:"",password:"",passwordAgain:"",errorMsg:"",isSubmitBtnActive:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.state,t=e.errorMsg,n=e.password,r=e.passwordAgain,i=e.email,s=e.name,a=e.isSubmitBtnActive;return(0,A.jsxs)(u.A,{isOpen:!0,toggle:this.toggle,children:[(0,A.jsx)(be.A,{toggle:this.toggle,children:(0,m.AP)("Add Organization")}),(0,A.jsxs)(je.A,{children:[(0,A.jsxs)(Ie.A,{autoComplete:"off",children:[(0,A.jsxs)(ke.A,{children:[(0,A.jsx)(_e.A,{children:(0,m.AP)("Name")}),(0,A.jsx)(W.A,{value:s,onChange:this.inputName})]}),(0,A.jsxs)(ke.A,{children:[(0,A.jsxs)(_e.A,{children:[(0,m.AP)("Owner"),(0,A.jsx)("span",{className:"small text-secondary ml-1 sf3-font sf3-font-tips",title:(0,m.AP)("Owner can use admin panel in an organization, must be a new account.")})]}),(0,A.jsx)(W.A,{value:i,onChange:this.inputEmail})]}),(0,A.jsxs)(ke.A,{children:[(0,A.jsx)(_e.A,{children:(0,m.AP)("Password")}),(0,A.jsx)(W.A,{type:"password",value:n,onChange:this.inputPassword})]}),(0,A.jsxs)(ke.A,{children:[(0,A.jsx)(_e.A,{children:(0,m.AP)("Password again")}),(0,A.jsx)(W.A,{type:"password",value:r,onChange:this.inputPasswordAgain})]})]}),t&&(0,A.jsx)(Se.A,{color:"danger",children:t})]}),(0,A.jsxs)(De.A,{children:[(0,A.jsx)(S.A,{color:"secondary",onClick:this.toggle,children:(0,m.AP)("Cancel")}),(0,A.jsx)(S.A,{color:"primary",onClick:this.handleSubmit,disabled:!a,children:(0,m.AP)("Submit")})]})]})}}])}(l.Component),Tr=window.sysadmin.pageOptions.availableRoles,Fr=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleItemFreezed=function(e){n.setState({isItemFreezed:e})},n.getPreviousPage=function(){n.props.getListByPage(n.props.currentPage-1)},n.getNextPage=function(){n.props.getListByPage(n.props.currentPage+1)},n.state={isItemFreezed:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,i=t.items;if(n)return(0,A.jsx)(I.A,{});if(r)return(0,A.jsx)("p",{className:"error text-center mt-4",children:r});var s=(0,A.jsx)(ie.A,{text:(0,m.AP)("No organizations")}),a=(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("table",{children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"20%",children:(0,m.AP)("Name")}),(0,A.jsx)("th",{width:"20%",children:(0,m.AP)("Creator")}),(0,A.jsx)("th",{width:"20%",children:(0,m.AP)("Role")}),(0,A.jsx)("th",{width:"15%",children:(0,m.AP)("Space Used")}),(0,A.jsx)("th",{width:"20%",children:(0,m.AP)("Created At")}),(0,A.jsx)("th",{width:"5%"})]})}),(0,A.jsx)("tbody",{children:i.map((function(t,n){return(0,A.jsx)(Rr,{item:t,updateRole:e.props.updateRole,deleteOrg:e.props.deleteOrg,isItemFreezed:e.state.isItemFreezed,toggleItemFreezed:e.toggleItemFreezed},n)}))})]}),this.props.currentPage&&(0,A.jsx)(X.A,{currentPage:this.props.currentPage,hasNextPage:this.props.hasNextPage,curPerPage:this.props.curPerPage,resetPerPage:this.props.resetPerPage,gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage})]});return i.length?a:s}}])}(l.Component),Rr=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleMouseEnter=function(){n.props.isItemFreezed||n.setState({highlighted:!0})},n.handleMouseLeave=function(){n.props.isItemFreezed||n.setState({highlighted:!1})},n.toggleDeleteDialog=function(e){e&&e.preventDefault(),n.setState({isDeleteDialogOpen:!n.state.isDeleteDialogOpen},(function(){n.state.isDeleteDialogOpen&&D.e.sysAdminGetOrg(n.props.item.org_id).then((function(e){var t='<span class="op-target">'+f.Aq.HTMLescape(e.data.org_name)+"</span>",r='<span class="op-target">'+f.Aq.HTMLescape(e.data.users_count)+"</span>",i='<span class="op-target">'+f.Aq.HTMLescape(e.data.repos_count)+"</span>",s=(0,m.AP)("Are you sure you want to delete {placeholder} ?").replace("{placeholder}",t)+"<br/>"+(0,m.AP)("{userCount} user(s) and {repoCount} libraries of this organization will also be deleted.").replace("{userCount}",r).replace("{repoCount}",i);n.setState({deleteDialogMsg:s})})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))}))},n.translateRole=function(e){switch(e){case"default":return(0,m.AP)("Default");case"guest":return(0,m.AP)("Guest");default:return e}},n.updateRole=function(e){n.props.updateRole(n.props.item.org_id,e.value)},n.deleteOrg=function(){w.A.notify((0,m.AP)("It may take some time, please wait.")),n.props.deleteOrg(n.props.item.org_id)},n.state={highlighted:!1,isDeleteDialogOpen:!1,deleteDialogMsg:""},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this,t=this.props.item,n=this.state,r=n.highlighted,i=n.isDeleteDialogOpen,s=n.deleteDialogMsg,a=t.role;this.roleOptions=Tr.map((function(t){return{value:t,text:e.translateRole(t),isSelected:t==a}}));var o=this.roleOptions.filter((function(e){return e.isSelected}))[0];return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("tr",{className:r?"tr-highlight":"",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,A.jsx)("td",{children:(0,A.jsx)(g.N_,{to:"".concat(m.Yc,"sys/organizations/").concat(t.org_id,"/info/"),children:t.org_name})}),(0,A.jsx)("td",{children:(0,A.jsx)(ue,{email:t.creator_email,name:t.creator_name})}),(0,A.jsx)("td",{children:(0,A.jsx)(Ve.A,{isDropdownToggleShown:r,currentSelectedOption:o,options:this.roleOptions,selectOption:this.updateRole,toggleItemFreezed:this.props.toggleItemFreezed})}),(0,A.jsx)("td",{children:"".concat(f.Aq.bytesToSize(t.quota_usage)," / ").concat(t.quota>0?f.Aq.bytesToSize(t.quota):"--")}),(0,A.jsx)("td",{children:C()(t.ctime).format("YYYY-MM-DD HH:mm:ss")}),(0,A.jsx)("td",{children:(0,A.jsx)("a",{href:"#",className:"action-icon sf3-font-delete1 sf3-font ".concat(r?"":"invisible"),title:(0,m.AP)("Delete"),onClick:this.toggleDeleteDialog})})]}),i&&(0,A.jsx)(Ee.A,{title:(0,m.AP)("Delete Organization"),message:s,executeOperation:this.deleteOrg,confirmBtnText:(0,m.AP)("Delete"),toggleDialog:this.toggleDeleteDialog})]})}}])}(l.Component),Er=Fr,Ur=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).getItemsByPage=function(e){var t=n.state.perPage;D.e.sysAdminListOrgs(e,t).then((function(r){n.setState({loading:!1,orgList:r.data.organizations,currentPage:e,hasNextPage:f.Aq.hasNextPage(e,t,r.data.total_count)})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){n.getItemsByPage(1)}))},n.toggleAddOrgDialog=function(){n.setState({isAddOrgDialogOpen:!n.state.isAddOrgDialogOpen})},n.updateRole=function(e,t){var r={};r.role=t,D.e.sysAdminUpdateOrg(e,r).then((function(r){var i=n.state.orgList.map((function(n){return n.org_id==e&&(n.role=t),n}));n.setState({orgList:i}),w.A.success((0,m.AP)("Edit succeeded"))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.addOrg=function(e){var t=e.orgName,r=e.ownerEmail,i=e.password;D.e.sysAdminAddOrg(t,r,i).then((function(e){var t=n.state.orgList;t.unshift(e.data),n.setState({orgList:t})})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.deleteOrg=function(e){D.e.sysAdminDeleteOrg(e).then((function(t){var r=n.state.orgList.filter((function(t){return t.org_id!=e}));n.setState({orgList:r}),w.A.success((0,m.AP)("Successfully deleted 1 item."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.getSearch=function(){return(0,A.jsx)(Be.A,{placeholder:(0,m.AP)("Search organizations"),submit:n.searchItems})},n.searchItems=function(e){(0,g.oo)("".concat(m.Yc,"sys/search-organizations/?query=").concat(encodeURIComponent(e)))},n.state={loading:!0,errorMsg:"",orgList:[],currentPage:1,perPage:25,hasNextPage:!1,isAddOrgDialogOpen:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,r=n.currentPage,i=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||i),currentPage:parseInt(t.get("page")||r)},(function(){e.getItemsByPage(e.state.currentPage)}))}},{key:"render",value:function(){var e=this.state.isAddOrgDialogOpen;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)((0,r.A)({search:this.getSearch()},this.props),{},{children:(0,A.jsx)(S.A,{className:"btn btn-secondary operation-item",onClick:this.toggleAddOrgDialog,children:(0,m.AP)("Add Organization")})})),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)("div",{className:"cur-view-path",children:(0,A.jsx)("h3",{className:"sf-heading",children:(0,m.AP)("Organizations")})}),(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsx)(Er,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.orgList,currentPage:this.state.currentPage,hasNextPage:this.state.hasNextPage,curPerPage:this.state.perPage,resetPerPage:this.resetPerPage,getListByPage:this.getItemsByPage,updateRole:this.updateRole,deleteOrg:this.deleteOrg})})]})}),e&&(0,A.jsx)(Lr,{addOrg:this.addOrg,toggleDialog:this.toggleAddOrgDialog})]})}}])}(l.Component),zr=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).getItems=function(){D.e.sysAdminSearchOrgs(n.state.query.trim()).then((function(e){n.setState({loading:!1,orgList:e.data.organization_list})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.updateRole=function(e,t){var r={};r.role=t,D.e.sysAdminUpdateOrg(e,r).then((function(r){var i=n.state.orgList.map((function(n){return n.org_id==e&&(n.role=t),n}));n.setState({orgList:i}),w.A.success((0,m.AP)("Edit succeeded"))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.deleteOrg=function(e){D.e.sysAdminDeleteOrg(e).then((function(t){var r=n.state.orgList.filter((function(t){return t.org_id!=e}));n.setState({orgList:r}),w.A.success((0,m.AP)("Successfully deleted 1 item."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.handleInputChange=function(e){n.setState({query:e.target.value},n.checkSubmitBtnActive)},n.checkSubmitBtnActive=function(){var e=n.state.query;n.setState({isSubmitBtnActive:e.trim()})},n.handleKeyDown=function(e){13===e.keyCode&&(n.state.isSubmitBtnActive&&n.getItems())},n.state={query:"",isSubmitBtnActive:!1,loading:!0,errorMsg:"",orgList:[]},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=new URL(document.location).searchParams;this.setState({query:e.get("query")||""},this.getItems)}},{key:"render",value:function(){var e=this.state,t=e.query,n=e.isSubmitBtnActive;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)({},this.props)),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)("div",{className:"cur-view-path",children:(0,A.jsx)("h3",{className:"sf-heading",children:(0,m.AP)("Organizations")})}),(0,A.jsxs)("div",{className:"cur-view-content",children:[(0,A.jsxs)("div",{className:"mt-4 mb-6",children:[(0,A.jsx)("h4",{className:"border-bottom font-weight-normal mb-2 pb-1",children:(0,m.AP)("Search Organizations")}),(0,A.jsx)("p",{className:"text-secondary small",children:(0,m.AP)("Tip: you can search by keyword in name.")}),(0,A.jsxs)(Ie.A,{tag:"div",children:[(0,A.jsxs)(ke.A,{row:!0,children:[(0,A.jsx)(_e.A,{for:"name",sm:1,children:(0,m.AP)("Name")}),(0,A.jsx)(ft.A,{sm:5,children:(0,A.jsx)(W.A,{type:"text",name:"query",id:"name",value:t,onChange:this.handleInputChange,onKeyDown:this.handleKeyDown})})]}),(0,A.jsx)(ke.A,{row:!0,children:(0,A.jsx)(ft.A,{sm:{size:5,offset:1},children:(0,A.jsx)("button",{className:"btn btn-outline-primary",disabled:!n,onClick:this.getItems,children:(0,m.AP)("Submit")})})})]})]}),(0,A.jsxs)("div",{className:"mt-4 mb-6",children:[(0,A.jsx)("h4",{className:"border-bottom font-weight-normal mb-2 pb-1",children:(0,m.AP)("Result")}),(0,A.jsx)(Er,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.orgList,updateRole:this.updateRole,deleteOrg:this.deleteOrg})]})]})]})})]})}}])}(l.Component),Br=n(70349),qr=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).toggle=function(){n.props.toggle()},n.handleInputChange=function(e){var t=e.target.value;n.setState({name:t,isSubmitBtnActive:""!=t.trim()})},n.handleKeyDown=function(e){"Enter"==e.key&&(n.handleSubmit(),e.preventDefault())},n.handleSubmit=function(){n.props.updateName(n.state.name.trim()),n.toggle()},n.state={name:n.props.name,isSubmitBtnActive:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.state,t=e.name,n=e.isSubmitBtnActive;return(0,A.jsxs)(u.A,{isOpen:!0,toggle:this.toggle,children:[(0,A.jsx)(be.A,{toggle:this.toggle,children:(0,m.AP)("Set Name")}),(0,A.jsx)(je.A,{children:(0,A.jsx)(Ie.A,{children:(0,A.jsx)(ke.A,{children:(0,A.jsx)(W.A,{type:"text",value:t,onKeyDown:this.handleKeyDown,onChange:this.handleInputChange})})})}),(0,A.jsxs)(De.A,{children:[(0,A.jsx)(S.A,{color:"secondary",onClick:this.toggle,children:(0,m.AP)("Cancel")}),(0,A.jsx)(S.A,{color:"primary",onClick:this.handleSubmit,disabled:!n,children:(0,m.AP)("Submit")})]})]})}}])}(l.Component),Yr=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).toggle=function(){n.props.toggle()},n.handleInputChange=function(e){var t=e.target.value;n.setState({value:t,isSubmitBtnActive:""!=t.trim()})},n.handleKeyDown=function(e){"Enter"==e.key&&(n.handleSubmit(),e.preventDefault())},n.handleSubmit=function(){n.props.updateValue(n.state.value.trim()),n.toggle()},n.state={value:n.props.value,isSubmitBtnActive:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.state,t=e.value,n=e.isSubmitBtnActive;return(0,A.jsxs)(u.A,{isOpen:!0,toggle:this.toggle,children:[(0,A.jsx)(be.A,{toggle:this.toggle,children:(0,m.AP)("Set max number of members")}),(0,A.jsx)(je.A,{children:(0,A.jsx)(Ie.A,{children:(0,A.jsx)(ke.A,{children:(0,A.jsx)(W.A,{type:"text",className:"form-control",value:t,onKeyDown:this.handleKeyDown,onChange:this.handleInputChange})})})}),(0,A.jsxs)(De.A,{children:[(0,A.jsx)(S.A,{color:"secondary",onClick:this.toggle,children:(0,m.AP)("Cancel")}),(0,A.jsx)(S.A,{color:"primary",onClick:this.handleSubmit,disabled:!n,children:(0,m.AP)("Submit")})]})]})}}])}(l.Component),Vr=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).navItems=[{name:"info",urlPart:"info",text:(0,m.AP)("Info")},{name:"users",urlPart:"users",text:(0,m.AP)("Members")},{name:"groups",urlPart:"groups",text:(0,m.AP)("Groups")},{name:"repos",urlPart:"libraries",text:(0,m.AP)("Libraries")}],n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props,t=e.currentItem,n=e.orgID,r=e.orgName;return(0,A.jsxs)("div",{children:[(0,A.jsx)("div",{className:"cur-view-path",children:(0,A.jsxs)("h3",{className:"sf-heading",children:[(0,A.jsx)(g.N_,{to:"".concat(m.Yc,"sys/organizations/"),children:(0,m.AP)("Organizations")})," / ",r]})}),(0,A.jsx)("ul",{className:"nav border-bottom mx-4",children:this.navItems.map((function(e,r){return(0,A.jsx)("li",{className:"nav-item mr-2",children:(0,A.jsx)(g.N_,{to:"".concat(m.Yc,"sys/organizations/").concat(n,"/").concat(e.urlPart,"/"),className:"nav-link ".concat(t==e.name?" active":""),children:e.text})},r)}))})]})}}])}(l.Component),Hr=Vr,Wr=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleSetQuotaDialog=function(){n.setState({isSetQuotaDialogOpen:!n.state.isSetQuotaDialogOpen})},n.toggleSetNameDialog=function(){n.setState({isSetNameDialogOpen:!n.state.isSetNameDialogOpen})},n.toggleSetMaxUserNumberDialog=function(){n.setState({isSetMaxUserNumberDialogOpen:!n.state.isSetMaxUserNumberDialogOpen})},n.showEditIcon=function(e){return(0,A.jsx)("span",{title:(0,m.AP)("Edit"),className:"sf3-font sf3-font-rename attr-action-icon",onClick:e})},n.state={isSetQuotaDialogOpen:!1,isSetNameDialogOpen:!1,isSetMaxUserNumberDialogOpen:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg;if(t)return(0,A.jsx)(I.A,{});if(n)return(0,A.jsx)("p",{className:"error text-center",children:n});var r=this.props.orgInfo,i=r.org_name,s=r.users_count,a=r.max_user_number,o=r.groups_count,c=r.quota,d=r.quota_usage,h=r.enable_saml_login,u=r.metadata_url,g=r.domain,p=this.state,x=p.isSetQuotaDialogOpen,v=p.isSetNameDialogOpen,P=p.isSetMaxUserNumberDialogOpen;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("dl",{className:"m-0",children:[(0,A.jsx)("dt",{className:"info-item-heading",children:(0,m.AP)("Name")}),(0,A.jsxs)("dd",{className:"info-item-content",children:[i,this.showEditIcon(this.toggleSetNameDialog)]}),(0,A.jsx)("dt",{className:"info-item-heading",children:(0,m.AP)("Number of members")}),(0,A.jsx)("dd",{className:"info-item-content",children:s}),a&&(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)("dt",{className:"info-item-heading",children:(0,m.AP)("Max number of members")}),(0,A.jsxs)("dd",{className:"info-item-content",children:[a,this.showEditIcon(this.toggleSetMaxUserNumberDialog)]})]}),(0,A.jsx)("dt",{className:"info-item-heading",children:(0,m.AP)("Number of groups")}),(0,A.jsx)("dd",{className:"info-item-content",children:o}),(0,A.jsx)("dt",{className:"info-item-heading",children:(0,m.AP)("Space Used")}),(0,A.jsxs)("dd",{className:"info-item-content",children:["".concat(f.Aq.bytesToSize(d)," / ").concat(c>0?f.Aq.bytesToSize(c):"--"),this.showEditIcon(this.toggleSetQuotaDialog)]}),h&&(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)("dt",{className:"info-item-heading",children:(0,m.AP)("SAML Config")}),(0,A.jsx)("dd",{className:"info-item-content",children:(0,A.jsxs)(Br.A,{className:"my-4",children:[(0,A.jsx)(ft.A,{md:"4",children:"Identifier (Entity ID)"}),(0,A.jsx)(ft.A,{md:"6",children:"".concat(m.xW,"/org/custom/").concat(this.props.orgID,"/saml2/metadata/")})]})}),(0,A.jsx)("dd",{className:"info-item-content",children:(0,A.jsxs)(Br.A,{className:"my-4",children:[(0,A.jsx)(ft.A,{md:"4",children:"Reply URL (Assertion Consumer Service URL)"}),(0,A.jsx)(ft.A,{md:"6",children:"".concat(m.xW,"/org/custom/").concat(this.props.orgID,"/saml2/acs/")})]})}),(0,A.jsx)("dd",{className:"info-item-content",children:(0,A.jsxs)(Br.A,{className:"my-4",children:[(0,A.jsx)(ft.A,{md:"4",children:"SAML App Federation Metadata URL"}),(0,A.jsx)(ft.A,{md:"6",children:u})]})}),(0,A.jsx)("dd",{className:"info-item-content",children:(0,A.jsxs)(Br.A,{className:"my-4",children:[(0,A.jsx)(ft.A,{md:"4",children:(0,m.AP)("Email Domain")}),(0,A.jsx)(ft.A,{md:"6",children:g})]})})]})]}),x&&(0,A.jsx)(ye.A,{updateQuota:this.props.updateQuota,toggle:this.toggleSetQuotaDialog}),v&&(0,A.jsx)(qr,{name:i,updateName:this.props.updateName,toggle:this.toggleSetNameDialog}),P&&(0,A.jsx)(Yr,{value:a,updateValue:this.props.updateMaxUserNumber,toggle:this.toggleSetMaxUserNumberDialog})]})}}])}(l.Component),Gr=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).updateQuota=function(e){var t={quota:e};D.e.sysAdminUpdateOrg(n.props.orgID,t).then((function(e){var t=Object.assign(n.state.orgInfo,{quota:e.data.quota});n.setState({orgInfo:t}),w.A.success((0,m.AP)("Successfully set quota."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.updateName=function(e){var t={orgName:e};D.e.sysAdminUpdateOrg(n.props.orgID,t).then((function(e){var t=Object.assign(n.state.orgInfo,{org_name:e.data.org_name});n.setState({orgInfo:t}),w.A.success((0,m.AP)("Successfully set name."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.updateMaxUserNumber=function(e){var t={maxUserNumber:e};D.e.sysAdminUpdateOrg(n.props.orgID,t).then((function(e){var t=Object.assign(n.state.orgInfo,{max_user_number:e.data.max_user_number});n.setState({orgInfo:t}),w.A.success((0,m.AP)("Successfully set max number of members."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.state={loading:!0,errorMsg:"",orgInfo:{}},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this;D.e.sysAdminGetOrg(this.props.orgID).then((function(t){e.setState({loading:!1,orgInfo:t.data})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this.state.orgInfo;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)({},this.props)),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)(Hr,{currentItem:"info",orgID:this.props.orgID,orgName:e.org_name}),(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsx)(Wr,{orgID:this.props.orgID,loading:this.state.loading,errorMsg:this.state.errorMsg,orgInfo:this.state.orgInfo,updateQuota:this.updateQuota,updateName:this.updateName,updateMaxUserNumber:this.updateMaxUserNumber})})]})})]})}}])}(l.Component),Qr=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleItemFreezed=function(e){n.setState({isItemFreezed:e})},n.onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.state={isItemFreezed:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,i=t.items;if(n)return(0,A.jsx)(I.A,{});if(r)return(0,A.jsx)("p",{className:"error text-center mt-4",children:r});var s=(0,A.jsx)(ie.A,{text:(0,m.AP)("No members")}),a=(0,A.jsx)(l.Fragment,{children:(0,A.jsxs)("table",{children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"25%",children:(0,m.AP)("Name")}),(0,A.jsx)("th",{width:"15%",children:(0,m.AP)("Status")}),(0,A.jsx)("th",{width:"15%",children:(0,m.AP)("Role")}),(0,A.jsx)("th",{width:"15%",children:(0,m.AP)("Space Used")}),(0,A.jsxs)("th",{width:"25%",children:[(0,m.AP)("Created At")," / ",(0,m.AP)("Last Login")]}),(0,A.jsx)("th",{width:"5%"})]})}),(0,A.jsx)("tbody",{children:i.map((function(t,n){return(0,A.jsx)(Kr,{item:t,isItemFreezed:e.state.isItemFreezed,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem,toggleItemFreezed:e.toggleItemFreezed,updateStatus:e.props.updateStatus,updateMembership:e.props.updateMembership,deleteUser:e.props.deleteUser},n)}))})]})});return i.length?a:s}}])}(l.Component),Kr=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleMouseEnter=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!0,highlight:!0})},n.handleMouseLeave=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!1,highlight:!1})},n.onUnfreezedItem=function(){n.setState({highlight:!1,isOpIconShow:!1}),n.props.onUnfreezedItem()},n.onMenuItemClick=function(e){switch(e){case"Delete":n.toggleDeleteDialog();break;case"Reset Password":n.toggleResetPasswordDialog()}},n.toggleDeleteDialog=function(e){e&&e.preventDefault(),n.setState({isDeleteDialogOpen:!n.state.isDeleteDialogOpen})},n.toggleResetPasswordDialog=function(e){e&&e.preventDefault(),n.setState({isResetPasswordDialogOpen:!n.state.isResetPasswordDialogOpen})},n.toggleConfirmInactiveDialog=function(){n.setState({isConfirmInactiveDialogOpen:!n.state.isConfirmInactiveDialogOpen})},n.updateStatus=function(e){n.props.updateStatus(n.props.item.email,e.value)},n.setUserInactive=function(){n.props.updateStatus(n.props.item.email,"inactive")},n.updateMembership=function(e){n.props.updateMembership(n.props.item.email,e.value)},n.deleteUser=function(){var e=n.props.item;n.props.deleteUser(e.org_id,e.email)},n.resetPassword=function(){D.e.sysAdminResetUserPassword(n.props.item.email).then((function(e){w.A.success(e.data.reset_tip)})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.translateOperations=function(e){var t="";switch(e){case"Delete":t=(0,m.AP)("Delete");break;case"Reset Password":t=(0,m.AP)("Reset Password")}return t},n.translateStatus=function(e){switch(e){case"active":return(0,m.AP)("Active");case"inactive":return(0,m.AP)("Inactive")}},n.translateMembership=function(e){switch(e){case"Admin":return(0,m.AP)("Admin");case"Member":return(0,m.AP)("Member")}},n.state={isOpIconShown:!1,highlight:!1,isDeleteDialogOpen:!1,isResetPasswordDialogOpen:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this,t=this.props.item,n=this.state,r=n.highlight,i=n.isOpIconShown,s=n.isDeleteDialogOpen,a=n.isResetPasswordDialogOpen,o=n.isConfirmInactiveDialogOpen,c='<span class="op-target">'+f.Aq.HTMLescape(t.name)+"</span>",d=(0,m.AP)("Are you sure you want to delete {placeholder} ?").replace("{placeholder}",c),h=(0,m.AP)("Are you sure you want to reset the password of {placeholder} ?").replace("{placeholder}",c),u=(0,m.AP)("Are you sure you want to set {user_placeholder} inactive?").replace("{user_placeholder}",c),g=t.active?"active":"inactive";this.statusOptions=["active","inactive"].map((function(t){return{value:t,text:e.translateStatus(t),isSelected:t==g}}));var p=this.statusOptions.filter((function(e){return e.isSelected}))[0],x=t.is_org_staff?"Admin":"Member";this.membershipOptions=["Admin","Member"].map((function(t){return{value:t,text:e.translateMembership(t),isSelected:t==x}}));var v=this.membershipOptions.filter((function(e){return e.isSelected}))[0];return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,A.jsx)("td",{children:(0,A.jsx)(ue,{email:t.email,name:t.name})}),(0,A.jsx)("td",{children:(0,A.jsx)(Ve.A,{isDropdownToggleShown:r,currentSelectedOption:p,options:this.statusOptions,selectOption:this.updateStatus,toggleItemFreezed:this.props.toggleItemFreezed,operationBeforeSelect:t.active?this.toggleConfirmInactiveDialog:void 0})}),(0,A.jsx)("td",{children:(0,A.jsx)(Ve.A,{isDropdownToggleShown:r,currentSelectedOption:v,options:this.membershipOptions,selectOption:this.updateMembership,toggleItemFreezed:this.props.toggleItemFreezed})}),(0,A.jsx)("td",{children:"".concat(f.Aq.bytesToSize(t.quota_usage)," / ").concat(t.quota_total>0?f.Aq.bytesToSize(t.quota_total):"--")}),(0,A.jsxs)("td",{children:[C()(t.create_time).format("YYYY-MM-DD HH:mm:ss")," / ",t.last_login?C()(t.last_login).fromNow():"--"]}),(0,A.jsx)("td",{children:i&&t.email!=m.Xh&&(0,A.jsx)(He.A,{operations:["Delete","Reset Password"],translateOperations:this.translateOperations,onMenuItemClick:this.onMenuItemClick,onFreezedItem:this.props.onFreezedItem,onUnfreezedItem:this.onUnfreezedItem})})]}),s&&(0,A.jsx)(Ee.A,{title:(0,m.AP)("Delete Member"),message:d,executeOperation:this.deleteUser,confirmBtnText:(0,m.AP)("Delete"),toggleDialog:this.toggleDeleteDialog}),a&&(0,A.jsx)(Ee.A,{title:(0,m.AP)("Reset Password"),message:h,executeOperation:this.resetPassword,confirmBtnText:(0,m.AP)("Reset"),toggleDialog:this.toggleResetPasswordDialog}),o&&(0,A.jsx)(Ee.A,{title:(0,m.AP)("Set user inactive"),message:u,executeOperation:this.setUserInactive,confirmBtnText:(0,m.AP)("Set"),toggleDialog:this.toggleConfirmInactiveDialog})]})}}])}(l.Component),Xr=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleAddUserDialog=function(){n.setState({isAddUserDialogOpen:!n.state.isAddUserDialogOpen})},n.addUser=function(e){var t=e.email,r=e.name,i=e.password;D.e.sysAdminAddOrgUser(n.props.orgID,t,r,i).then((function(e){var t=n.state.userList;t.unshift(e.data),n.setState({userList:t})})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.deleteUser=function(e,t){D.e.sysAdminDeleteOrgUser(e,t).then((function(e){var r=n.state.userList.filter((function(e){return e.email!=t}));n.setState({userList:r}),w.A.success((0,m.AP)("Successfully deleted 1 item."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.updateStatus=function(e,t){var r="active"==t;D.e.sysAdminUpdateOrgUser(n.props.orgID,e,"active",r).then((function(t){var r=n.state.userList.map((function(n){return n.email==e&&(n.active=t.data.active),n}));n.setState({userList:r})})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.updateMembership=function(e,t){var r="Admin"==t;D.e.sysAdminUpdateOrgUser(n.props.orgID,e,"is_org_staff",r).then((function(t){var r=n.state.userList.map((function(n){return n.email==e&&(n.is_org_staff=t.data.is_org_staff),n}));n.setState({userList:r})})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.state={loading:!0,errorMsg:"",orgName:"",userList:[],isAddUserDialogOpen:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this;D.e.sysAdminGetOrg(this.props.orgID).then((function(t){e.setState({orgName:t.data.org_name})})),D.e.sysAdminListOrgUsers(this.props.orgID).then((function(t){e.setState({loading:!1,userList:t.data.users})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this.state,t=e.isAddUserDialogOpen,n=e.orgName;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)((0,r.A)({},this.props),{},{children:(0,A.jsx)(S.A,{className:"btn btn-secondary operation-item",onClick:this.toggleAddUserDialog,children:(0,m.AP)("Add Member")})})),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)(Hr,{currentItem:"users",orgID:this.props.orgID,orgName:n}),(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsx)(Qr,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.userList,updateStatus:this.updateStatus,updateMembership:this.updateMembership,deleteUser:this.deleteUser})})]})}),t&&(0,A.jsx)(Te,{addUser:this.addUser,toggleDialog:this.toggleAddUserDialog})]})}}])}(l.Component),$r=function(e){function t(e){return(0,i.A)(this,t),(0,a.A)(this,t,[e])}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,i=t.items;if(n)return(0,A.jsx)(I.A,{});if(r)return(0,A.jsx)("p",{className:"error text-center mt-4",children:r});var s=(0,A.jsx)(ie.A,{text:(0,m.AP)("No groups")}),a=(0,A.jsx)(l.Fragment,{children:(0,A.jsxs)("table",{className:"table-hover",children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"30%",children:(0,m.AP)("Name")}),(0,A.jsx)("th",{width:"30%",children:(0,m.AP)("Creator")}),(0,A.jsx)("th",{width:"30%",children:(0,m.AP)("Created At")}),(0,A.jsx)("th",{width:"10%"})]})}),(0,A.jsx)("tbody",{children:i.map((function(t,n){return(0,A.jsx)(Zr,{item:t,deleteGroup:e.props.deleteGroup},n)}))})]})});return i.length?a:s}}])}(l.Component),Zr=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleMouseEnter=function(){n.setState({isOpIconShown:!0})},n.handleMouseLeave=function(){n.setState({isOpIconShown:!1})},n.toggleDeleteDialog=function(e){e&&e.preventDefault(),n.setState({isDeleteDialogOpen:!n.state.isDeleteDialogOpen})},n.deleteGroup=function(){n.toggleDeleteDialog(),n.props.deleteGroup(n.props.item.group_id)},n.state={isOpIconShown:!1,isDeleteDialogOpen:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.item,t=this.state,n=t.isOpIconShown,r=t.isDeleteDialogOpen,i='<span class="op-target">'+f.Aq.HTMLescape(e.group_name)+"</span>",s=(0,m.AP)("Are you sure you want to delete {placeholder} ?").replace("{placeholder}",i),a=0==e.parent_group_id?"".concat(m.Yc,"sys/groups/").concat(e.group_id,"/libraries/"):"".concat(m.Yc,"sys/departments/").concat(e.group_id,"/");return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("tr",{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,A.jsx)("td",{children:(0,A.jsx)("a",{href:a,children:e.group_name})}),(0,A.jsx)("td",{children:(0,A.jsx)(ue,{email:e.creator_email,name:e.creator_name})}),(0,A.jsx)("td",{children:C()(e.created_at).format("YYYY-MM-DD HH:mm:ss")}),(0,A.jsx)("td",{children:(0,A.jsx)("a",{href:"#",className:"action-icon sf3-font-delete1 sf3-font ".concat(n?"":"invisible"),title:(0,m.AP)("Delete"),onClick:this.toggleDeleteDialog})})]}),r&&(0,A.jsx)(Ee.A,{title:(0,m.AP)("Delete Group"),message:s,executeOperation:this.deleteGroup,confirmBtnText:(0,m.AP)("Delete"),toggleDialog:this.toggleDeleteDialog})]})}}])}(l.Component),Jr=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).deleteGroup=function(e){D.e.sysAdminDismissGroupByID(e).then((function(t){var r=n.state.groupList.filter((function(t){return t.group_id!=e}));n.setState({groupList:r}),w.A.success((0,m.AP)("Successfully deleted 1 item."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.state={loading:!0,errorMsg:"",orgName:"",groupList:[]},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this;D.e.sysAdminGetOrg(this.props.orgID).then((function(t){e.setState({orgName:t.data.org_name})})),D.e.sysAdminListOrgGroups(this.props.orgID).then((function(t){e.setState({loading:!1,groupList:t.data.group_list})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)({},this.props)),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)(Hr,{currentItem:"groups",orgID:this.props.orgID,orgName:this.state.orgName}),(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsx)($r,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.groupList,deleteGroup:this.deleteGroup})})]})})]})}}])}(l.Component),ei=function(e){function t(){return(0,i.A)(this,t),(0,a.A)(this,t,arguments)}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,i=t.items;if(n)return(0,A.jsx)(I.A,{});if(r)return(0,A.jsx)("p",{className:"error text-center mt-4",children:r});var s=(0,A.jsx)(ie.A,{text:(0,m.AP)("No libraries")}),a=(0,A.jsx)(l.Fragment,{children:(0,A.jsxs)("table",{className:"table-hover",children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"5%"}),(0,A.jsx)("th",{width:"30%",children:(0,m.AP)("Name")}),(0,A.jsx)("th",{width:"35%",children:"ID"}),(0,A.jsx)("th",{width:"20%",children:(0,m.AP)("Owner")}),(0,A.jsx)("th",{width:"10%"})]})}),(0,A.jsx)("tbody",{children:i.map((function(t,n){return(0,A.jsx)(ti,{item:t,deleteRepo:e.props.deleteRepo},n)}))})]})});return i.length?a:s}}])}(l.Component),ti=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleMouseEnter=function(){n.setState({isOpIconShown:!0})},n.handleMouseLeave=function(){n.setState({isOpIconShown:!1})},n.toggleDeleteDialog=function(e){e&&e.preventDefault(),n.setState({isDeleteDialogOpen:!n.state.isDeleteDialogOpen})},n.deleteRepo=function(){n.props.deleteRepo(n.props.item.repo_id)},n.state={isOpIconShown:!1,isDeleteDialogOpen:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.item,t=this.state,n=t.isOpIconShown,r=t.isDeleteDialogOpen,i=f.Aq.getLibIconUrl(e),s=f.Aq.getLibIconTitle(e),a='<span class="op-target">'+f.Aq.HTMLescape(e.repo_name)+"</span>",o=(0,m.AP)("Are you sure you want to delete {placeholder} ?").replace("{placeholder}",a);return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("tr",{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,A.jsx)("td",{children:(0,A.jsx)("img",{src:i,title:s,alt:s,width:"24"})}),(0,A.jsx)("td",{children:e.repo_name}),(0,A.jsx)("td",{children:e.repo_id}),(0,A.jsx)("td",{children:e.owner_email?-1==e.owner_email.indexOf("@seafile_group")?(0,A.jsx)(ue,{email:e.owner_email,name:e.owner_name}):e.owner_name:"--"}),(0,A.jsx)("td",{children:(0,A.jsx)("a",{href:"#",className:"action-icon sf3-font-delete1 sf3-font ".concat(n?"":"invisible"),title:(0,m.AP)("Delete"),onClick:this.toggleDeleteDialog})})]}),r&&(0,A.jsx)(Ee.A,{title:(0,m.AP)("Delete Library"),message:o,executeOperation:this.deleteRepo,confirmBtnText:(0,m.AP)("Delete"),toggleDialog:this.toggleDeleteDialog})]})}}])}(l.Component),ni=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).deleteRepo=function(e){D.e.sysAdminDeleteRepo(e).then((function(t){var r=n.state.repoList.filter((function(t){return t.repo_id!=e}));n.setState({repoList:r}),w.A.success((0,m.AP)("Successfully deleted 1 item."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.state={loading:!0,errorMsg:"",orgName:"",repoList:[]},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this;D.e.sysAdminGetOrg(this.props.orgID).then((function(t){e.setState({orgName:t.data.org_name})})),D.e.sysAdminListOrgRepos(this.props.orgID).then((function(t){e.setState({loading:!1,repoList:t.data.repo_list})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)({},this.props)),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)(Hr,{currentItem:"repos",orgID:this.props.orgID,orgName:this.state.orgName}),(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsx)(ei,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.repoList,deleteRepo:this.deleteRepo})})]})})]})}}])}(l.Component),ri=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleChange=function(e){var t=e.target.value;n.setState({value:t,isSubmitBtnActive:""!=t.trim()})},n.handleSubmit=function(){n.toggle(),n.props.addInstitution(n.state.value.trim())},n.toggle=function(){n.props.toggle()},n.state={value:"",isSubmitBtnActive:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){return(0,A.jsxs)(u.A,{isOpen:!0,toggle:this.toggle,children:[(0,A.jsx)(be.A,{toggle:this.toggle,children:(0,m.AP)("Add institution")}),(0,A.jsx)(je.A,{children:(0,A.jsxs)(Ie.A,{children:[(0,A.jsx)("p",{children:(0,m.AP)("Name")}),(0,A.jsx)(ke.A,{children:(0,A.jsx)(W.A,{value:this.state.value,onChange:this.handleChange})})]})}),(0,A.jsx)(De.A,{children:(0,A.jsx)(S.A,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive,children:(0,m.AP)("Submit")})})]})}}])}(l.Component),ii=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).getPreviousPage=function(){n.props.getInstitutionsByPage(n.props.currentPage-1)},n.getNextPage=function(){n.props.getInstitutionsByPage(n.props.currentPage+1)},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,i=t.items,s=t.perPage,a=t.currentPage,o=t.hasNextPage;if(n)return(0,A.jsx)(I.A,{});if(r)return(0,A.jsx)("p",{className:"error text-center mt-4",children:r});var c=(0,A.jsx)(ie.A,{text:(0,m.AP)("No institutions")}),d=(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("table",{className:"table-hover",children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"75%",children:(0,m.AP)("Name")}),(0,A.jsx)("th",{width:"20%",children:(0,m.AP)("Created At")}),(0,A.jsx)("th",{width:"5%"})]})}),(0,A.jsx)("tbody",{children:i.map((function(t,n){return(0,A.jsx)(si,{item:t,deleteInstitution:e.props.deleteInstitution},n)}))})]}),(0,A.jsx)(X.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:a,hasNextPage:o,curPerPage:s,resetPerPage:this.props.resetPerPage})]});return i.length?d:c}}])}(l.Component),si=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleMouseEnter=function(){n.setState({isOpIconShown:!0})},n.handleMouseLeave=function(){n.setState({isOpIconShown:!1})},n.toggleDeleteDialog=function(e){e&&e.preventDefault(),n.setState({isDeleteDialogOpen:!n.state.isDeleteDialogOpen})},n.deleteInstitution=function(){n.props.deleteInstitution(n.props.item.id)},n.state={isOpIconShown:!1,isDeleteDialogOpen:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.item,t=this.state,n=t.isOpIconShown,r=t.isDeleteDialogOpen,i='<span class="op-target">'+f.Aq.HTMLescape(e.name)+"</span>",s=(0,m.AP)("Are you sure you want to delete {placeholder} ?").replace("{placeholder}",i);return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("tr",{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,A.jsx)("td",{children:(0,A.jsx)(g.N_,{to:"".concat(m.Yc,"sys/institutions/").concat(e.id,"/info/"),children:e.name})}),(0,A.jsx)("td",{children:C()(e.ctime).fromNow()}),(0,A.jsx)("td",{children:(0,A.jsx)("a",{href:"#",className:"action-icon sf3-font-delete1 sf3-font ".concat(n?"":"invisible"),title:(0,m.AP)("Delete"),onClick:this.toggleDeleteDialog})})]}),r&&(0,A.jsx)(Ee.A,{title:(0,m.AP)("Delete Institution"),message:s,executeOperation:this.deleteInstitution,confirmBtnText:(0,m.AP)("Delete"),toggleDialog:this.toggleDeleteDialog})]})}}])}(l.Component),ai=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).getInstitutionsByPage=function(e){var t=n.state.perPage;D.e.sysAdminListInstitutions(e,t).then((function(r){n.setState({loading:!1,institutionList:r.data.institution_list,currentPage:e,hasNextPage:f.Aq.hasNextPage(e,t,r.data.total_count)})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){return n.getInstitutionsByPage(n.initPage)}))},n.toggleAddInstitutionDialog=function(){n.setState({isAddInstitutionDialogOpen:!n.state.isAddInstitutionDialogOpen})},n.addInstitution=function(e){D.e.sysAdminAddInstitution(e).then((function(e){var t=n.state.institutionList;t.push(e.data),n.setState({institutionList:t})})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.deleteInstitution=function(e){D.e.sysAdminDeleteInstitution(e).then((function(t){var r=n.state.institutionList.filter((function(t){return t.id!=e}));n.setState({institutionList:r}),w.A.success((0,m.AP)("Successfully deleted 1 item."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.state={loading:!0,errorMsg:"",institutionList:[],perPage:25,currentPage:1,hasNextPage:!1,isAddInstitutionDialogOpen:!1},n.initPage=1,n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,r=n.currentPage,i=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||i),currentPage:parseInt(t.get("page")||r)},(function(){e.getInstitutionsByPage(e.state.currentPage)}))}},{key:"render",value:function(){var e=this.state,t=e.isAddInstitutionDialogOpen,n=e.hasNextPage,i=e.currentPage,s=e.perPage;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)((0,r.A)({},this.props),{},{children:(0,A.jsx)(S.A,{className:"btn btn-secondary operation-item",onClick:this.toggleAddInstitutionDialog,children:(0,m.AP)("Add Institution")})})),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)("div",{className:"cur-view-path",children:(0,A.jsx)("h3",{className:"sf-heading",children:(0,m.AP)("Institutions")})}),(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsx)(ii,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.institutionList,deleteInstitution:this.deleteInstitution,currentPage:i,perPage:s,hasNextPage:n,getInstitutionsByPage:this.getInstitutionsByPage,resetPerPage:this.resetPerPage})})]})}),t&&(0,A.jsx)(ri,{addInstitution:this.addInstitution,toggle:this.toggleAddInstitutionDialog})]})}}])}(l.Component),oi=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).navItems=[{name:"info",urlPart:"info",text:(0,m.AP)("Info")},{name:"members",urlPart:"members",text:(0,m.AP)("Members")},{name:"admins",urlPart:"admins",text:(0,m.AP)("Admins")}],n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props,t=e.currentItem,n=e.institutionID,r=e.institutionName;return(0,A.jsxs)("div",{children:[(0,A.jsx)("div",{className:"cur-view-path",children:(0,A.jsxs)("h3",{className:"sf-heading",children:[(0,A.jsx)(g.N_,{to:"".concat(m.Yc,"sys/institutions/"),children:(0,m.AP)("Institutions")})," / ",r]})}),(0,A.jsx)("ul",{className:"nav border-bottom mx-4",children:this.navItems.map((function(e,r){return(0,A.jsx)("li",{className:"nav-item mr-2",children:(0,A.jsx)(g.N_,{to:"".concat(m.Yc,"sys/institutions/").concat(n,"/").concat(e.urlPart,"/"),className:"nav-link ".concat(t==e.name?" active":""),children:e.text})},r)}))})]})}}])}(l.Component),li=oi,ci=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleSetQuotaDialog=function(){n.setState({isSetQuotaDialogOpen:!n.state.isSetQuotaDialogOpen})},n.showEditIcon=function(e){return(0,A.jsx)("span",{title:(0,m.AP)("Edit"),className:"sf3-font sf3-font-rename attr-action-icon",onClick:e})},n.state={isSetQuotaDialogOpen:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg,r=e.institutionInfo;if(t)return(0,A.jsx)(I.A,{});if(n)return(0,A.jsx)("p",{className:"error text-center",children:n});var i=r.name,s=r.user_count,a=r.quota_total,o=r.quota_used,c=this.state.isSetQuotaDialogOpen;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("dl",{className:"m-0",children:[(0,A.jsx)("dt",{className:"info-item-heading",children:(0,m.AP)("Name")}),(0,A.jsx)("dd",{className:"info-item-content",children:i}),(0,A.jsx)("dt",{className:"info-item-heading",children:(0,m.AP)("Number of members")}),(0,A.jsx)("dd",{className:"info-item-content",children:s}),(0,A.jsx)("dt",{className:"info-item-heading",children:(0,m.AP)("Space Used")}),(0,A.jsxs)("dd",{className:"info-item-content",children:["".concat(f.Aq.bytesToSize(o)," / ").concat(a>0?f.Aq.bytesToSize(a):"--"),this.showEditIcon(this.toggleSetQuotaDialog)]})]}),c&&(0,A.jsx)(ye.A,{updateQuota:this.props.updateQuota,toggle:this.toggleSetQuotaDialog})]})}}])}(l.Component),di=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).updateQuota=function(e){D.e.sysAdminUpdateInstitution(n.props.institutionID,e).then((function(e){var t=Object.assign(n.state.institutionInfo,{quota_total:e.data.quota_total});n.setState({institutionInfo:t}),w.A.success((0,m.AP)("Successfully set quota."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.state={loading:!0,errorMsg:"",institutionInfo:{}},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this;D.e.sysAdminGetInstitution(this.props.institutionID).then((function(t){e.setState({loading:!1,institutionInfo:t.data})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this.state.institutionInfo;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)({},this.props)),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)(li,{currentItem:"info",institutionID:this.props.institutionID,institutionName:e.name}),(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsx)(ci,{loading:this.state.loading,errorMsg:this.state.errorMsg,institutionInfo:this.state.institutionInfo,updateQuota:this.updateQuota})})]})})]})}}])}(l.Component),hi=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleSelectChange=function(e){n.setState({selectedOption:e})},n.handleSubmit=function(){if(n.state.selectedOption){var e=n.state.selectedOption.map((function(e){return e.email}));n.props.addUser(e)}},n.state={selectedOption:[]},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){return(0,A.jsxs)(u.A,{isOpen:!0,toggle:this.props.toggle,children:[(0,A.jsx)(be.A,{toggle:this.props.toggle,children:(0,m.AP)("Add Member")}),(0,A.jsx)(je.A,{children:(0,A.jsx)(Fe.A,{placeholder:(0,m.AP)("Search users"),onSelectChange:this.handleSelectChange,isMulti:!0,className:"org-add-member-select"})}),(0,A.jsxs)(De.A,{children:[(0,A.jsx)(S.A,{color:"primary",onClick:this.handleSubmit,children:(0,m.AP)("Submit")}),(0,A.jsx)(S.A,{color:"secondary",onClick:this.props.toggle,children:(0,m.AP)("Cancel")})]})]})}}])}(l.Component),ui=hi,gi=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.getPreviousPage=function(){n.props.getInstitutionUsersByPage(n.props.currentPage-1)},n.getNextPage=function(){n.props.getInstitutionUsersByPage(n.props.currentPage+1)},n.state={isItemFreezed:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,i=t.items,s=t.perPage,a=t.currentPage,o=t.hasNextPage;if(n)return(0,A.jsx)(I.A,{});if(r)return(0,A.jsx)("p",{className:"error text-center mt-4",children:r});var c=(0,A.jsx)(ie.A,{text:(0,m.AP)("No members")}),d=(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("table",{children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"25%",children:(0,m.AP)("Name")}),(0,A.jsx)("th",{width:"10%",children:(0,m.AP)("Status")}),(0,A.jsx)("th",{width:"20%",children:(0,m.AP)("Space Used")}),(0,A.jsxs)("th",{width:"40%",children:[(0,m.AP)("Created At")," / ",(0,m.AP)("Last Login")]}),(0,A.jsx)("th",{width:"5%"})]})}),(0,A.jsx)("tbody",{children:i.map((function(t,n){return(0,A.jsx)(pi,{item:t,isItemFreezed:e.state.isItemFreezed,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem,setAdmin:e.props.setAdmin,deleteUser:e.props.deleteUser},n)}))})]}),(0,A.jsx)(X.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:a,hasNextPage:o,curPerPage:s,resetPerPage:this.props.resetPerPage})]});return i.length?d:c}}])}(l.Component),pi=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleMouseEnter=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!0,highlight:!0})},n.handleMouseLeave=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!1,highlight:!1})},n.onUnfreezedItem=function(){n.setState({highlight:!1,isOpIconShow:!1}),n.props.onUnfreezedItem()},n.toggleSetAdminDialog=function(e){e&&e.preventDefault(),n.setState({isSetAdminDialogOpen:!n.state.isSetAdminDialogOpen})},n.setAdmin=function(){n.props.setAdmin(n.props.item.email)},n.onMenuItemClick=function(e){switch(e){case"Delete":n.props.deleteUser(n.props.item.email);break;case"Set Admin":n.toggleSetAdminDialog()}},n.getOperations=function(){var e=[];return n.props.item.is_institution_admin||e.push("Set Admin"),e.push("Delete"),e},n.translateOperations=function(e){var t="";switch(e){case"Delete":t=(0,m.AP)("Delete");break;case"Set Admin":t=(0,m.AP)("Set Admin")}return t},n.state={isOpIconShown:!1,highlight:!1,isSetAdminDialogOpen:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.item,t=this.state,n=t.isOpIconShown,r=t.isSetAdminDialogOpen,i='<span class="op-target">'+f.Aq.HTMLescape(e.name)+"</span>",s=(0,m.AP)("Are you sure you want to set {placeholder} as Admin?").replace("{placeholder}",i);return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,A.jsx)("td",{children:(0,A.jsx)(ue,{email:e.email,name:e.name})}),(0,A.jsx)("td",{children:e.is_active?(0,m.AP)("Active"):(0,m.AP)("Inactive")}),(0,A.jsx)("td",{children:"".concat(f.Aq.bytesToSize(e.quota_usage)," / ").concat(e.quota_total>0?f.Aq.bytesToSize(e.quota_total):"--")}),(0,A.jsxs)("td",{children:[C()(e.create_time).format("YYYY-MM-DD HH:mm:ss")," / ",e.last_login?C()(e.last_login).fromNow():"--"]}),(0,A.jsx)("td",{children:n&&(0,A.jsx)(He.A,{operations:this.getOperations(),translateOperations:this.translateOperations,onMenuItemClick:this.onMenuItemClick,onFreezedItem:this.props.onFreezedItem,onUnfreezedItem:this.onUnfreezedItem})})]}),r&&(0,A.jsx)(Ee.A,{title:(0,m.AP)("Set Admin"),message:s,executeOperation:this.setAdmin,toggleDialog:this.toggleSetAdminDialog,confirmBtnText:(0,m.AP)("Set Admin")})]})}}])}(l.Component),mi=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).getInstitutionUsersByPage=function(e){var t=n.state.perPage;D.e.sysAdminListInstitutionUsers(n.props.institutionID,e,t).then((function(r){n.setState({loading:!1,userList:r.data.user_list,currentPage:e,hasNextPage:f.Aq.hasNextPage(e,t,r.data.total_count)})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.setAdmin=function(e){D.e.sysAdminUpdateInstitutionUser(n.props.institutionID,e,!0).then((function(t){var r=n.state.userList.map((function(t){return t.email==e&&(t.is_institution_admin=!0),t}));n.setState({userList:r}),w.A.success((0,m.AP)("Success"))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.toggleAddUserDialog=function(){n.setState({isAddUserDialogOpen:!n.state.isAddUserDialogOpen})},n.resetPerPage=function(e){n.setState({perPage:e},(function(){return n.getInstitutionUsersByPage(n.initPage)}))},n.addUser=function(e){D.e.sysAdminAddInstitutionUserBatch(n.props.institutionID,e).then((function(e){n.toggleAddUserDialog();var t=e.data.success,r=e.data.failed;if(t.length){var i=n.state.userList.concat(t);n.setState({userList:i})}r.forEach((function(e){w.A.danger(e.error_msg)}))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.deleteUser=function(e){D.e.sysAdminDeleteInstitutionUser(n.props.institutionID,e).then((function(t){var r=n.state.userList.filter((function(t){return t.email!=e}));n.setState({userList:r}),w.A.success("success")})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.state={loading:!0,errorMsg:"",institutionName:"",userList:[],perPage:25,currentPage:1,hasNextPage:!1,isAddUserDialogOpen:!1},n.initPage=1,n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this;D.e.sysAdminGetInstitution(this.props.institutionID).then((function(t){e.setState({institutionName:t.data.name})}));var t=new URL(window.location).searchParams,n=this.state,r=n.currentPage,i=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||i),currentPage:parseInt(t.get("page")||r)},(function(){e.getInstitutionUsersByPage(e.state.currentPage)}))}},{key:"render",value:function(){var e=this.state,t=e.isAddUserDialogOpen,n=e.institutionName,i=e.hasNextPage,s=e.currentPage,a=e.perPage;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)((0,r.A)({},this.props),{},{children:(0,A.jsx)(S.A,{className:"btn btn-secondary operation-item",onClick:this.toggleAddUserDialog,children:(0,m.AP)("Add Member")})})),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)(li,{currentItem:"members",institutionID:this.props.institutionID,institutionName:n}),(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsx)(gi,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.userList,setAdmin:this.setAdmin,deleteUser:this.deleteUser,currentPage:s,perPage:a,hasNextPage:i,getInstitutionUsersByPage:this.getInstitutionUsersByPage,resetPerPage:this.resetPerPage})})]})}),t&&(0,A.jsx)(ui,{addUser:this.addUser,toggle:this.toggleAddUserDialog})]})}}])}(l.Component),fi=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.state={isItemFreezed:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,i=t.items;if(n)return(0,A.jsx)(I.A,{});if(r)return(0,A.jsx)("p",{className:"error text-center mt-4",children:r});var s=(0,A.jsx)(ie.A,{text:(0,m.AP)("No admins")}),a=(0,A.jsx)(l.Fragment,{children:(0,A.jsxs)("table",{children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"25%",children:(0,m.AP)("Name")}),(0,A.jsx)("th",{width:"10%",children:(0,m.AP)("Status")}),(0,A.jsx)("th",{width:"20%",children:(0,m.AP)("Space Used")}),(0,A.jsxs)("th",{width:"40%",children:[(0,m.AP)("Created At")," / ",(0,m.AP)("Last Login")]}),(0,A.jsx)("th",{width:"5%"})]})}),(0,A.jsx)("tbody",{children:i.map((function(t,n){return(0,A.jsx)(xi,{item:t,isItemFreezed:e.state.isItemFreezed,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem,revokeAdmin:e.props.revokeAdmin,deleteUser:e.props.deleteUser},n)}))})]})});return i.length?a:s}}])}(l.Component),xi=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleMouseEnter=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!0,highlight:!0})},n.handleMouseLeave=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!1,highlight:!1})},n.onUnfreezedItem=function(){n.setState({highlight:!1,isOpIconShow:!1}),n.props.onUnfreezedItem()},n.toggleRevokeAdminDialog=function(e){e&&e.preventDefault(),n.setState({isRevokeAdminDialogOpen:!n.state.isRevokeAdminDialogOpen})},n.revokeAdmin=function(){n.props.revokeAdmin(n.props.item)},n.onMenuItemClick=function(e){if("Revoke Admin"===e)n.toggleRevokeAdminDialog()},n.translateOperations=function(e){var t="";if("Revoke Admin"===e)t=(0,m.AP)("Revoke Admin");return t},n.state={isOpIconShown:!1,highlight:!1,isRevokeAdminDialogOpen:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.item,t=this.state,n=t.isOpIconShown,r=t.isRevokeAdminDialogOpen,i='<span class="op-target">'+f.Aq.HTMLescape(e.name)+"</span>",s=(0,m.AP)("Are you sure you want to revoke the admin permission of {placeholder} ?").replace("{placeholder}",i);return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,A.jsx)("td",{children:(0,A.jsx)(ue,{email:e.email,name:e.name})}),(0,A.jsx)("td",{children:e.is_active?(0,m.AP)("Active"):(0,m.AP)("Inactive")}),(0,A.jsx)("td",{children:"".concat(f.Aq.bytesToSize(e.quota_usage)," / ").concat(e.quota_total>0?f.Aq.bytesToSize(e.quota_total):"--")}),(0,A.jsxs)("td",{children:[C()(e.create_time).format("YYYY-MM-DD HH:mm:ss")," / ",e.last_login?C()(e.last_login).fromNow():"--"]}),(0,A.jsx)("td",{children:n&&(0,A.jsx)(He.A,{operations:["Revoke Admin"],translateOperations:this.translateOperations,onMenuItemClick:this.onMenuItemClick,onFreezedItem:this.props.onFreezedItem,onUnfreezedItem:this.onUnfreezedItem})})]}),r&&(0,A.jsx)(Ee.A,{title:(0,m.AP)("Revoke Admin"),message:s,executeOperation:this.revokeAdmin,confirmBtnText:(0,m.AP)("Revoke"),toggleDialog:this.toggleRevokeAdminDialog})]})}}])}(l.Component),vi=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).revokeAdmin=function(e){var t=e.email,r=e.name;D.e.sysAdminUpdateInstitutionUser(n.props.institutionID,t,!1).then((function(e){var i=n.state.userList.filter((function(e){return e.email!=t}));n.setState({userList:i}),w.A.success((0,m.AP)("Successfully revoked the admin permission of {placeholder}.").replace("{placeholder}",r))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.deleteUser=function(e){D.e.sysAdminDeleteInstitutionUser(n.props.institutionID,e).then((function(t){var r=n.state.userList.filter((function(t){return t.email!=e}));n.setState({userList:r}),w.A.success("success")})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.state={loading:!0,errorMsg:"",institutionName:"",userList:[],isAddUserDialogOpen:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this;D.e.sysAdminGetInstitution(this.props.institutionID).then((function(t){e.setState({institutionName:t.data.name})})),D.e.sysAdminListInstitutionAdmins(this.props.institutionID).then((function(t){e.setState({loading:!1,userList:t.data.user_list})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this.state.institutionName;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)({},this.props)),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)(li,{currentItem:"admins",institutionID:this.props.institutionID,institutionName:e}),(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsx)(fi,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.userList,revokeAdmin:this.revokeAdmin,deleteUser:this.deleteUser})})]})})]})}}])}(l.Component),Ai=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).navItems=[{name:"loginLogs",urlPart:"logs/login",text:(0,m.AP)("Login")},{name:"fileAccessLogs",urlPart:"logs/file-access",text:(0,m.AP)("File Access")},{name:"fileUpdateLogs",urlPart:"logs/file-update",text:(0,m.AP)("File Update")},{name:"sharePermissionLogs",urlPart:"logs/share-permission",text:(0,m.AP)("Permission")}],n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.currentItem;return(0,A.jsx)("div",{className:"cur-view-path tab-nav-container",children:(0,A.jsx)("ul",{className:"nav",children:this.navItems.map((function(t,n){return(0,A.jsx)("li",{className:"nav-item",children:(0,A.jsx)(g.N_,{to:"".concat(m.Yc,"sys/").concat(t.urlPart,"/"),className:"nav-link".concat(e==t.name?" active":""),children:t.text})},n)}))})})}}])}(l.Component),Pi=Ai,yi=n(71361),bi=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).downloadExcel=function(){if(n.isValidDateStr())switch(n.props.logType){case"login":n.sysExportLogs("loginadmin");break;case"fileAccess":n.sysExportLogs("fileaudit");break;case"fileUpdate":n.sysExportLogs("fileupdate");break;case"sharePermission":n.sysExportLogs("permaudit")}},n.sysExportLogs=function(e){var t=n.state,r=t.startDateStr,i=t.endDateStr,s="";Ae.sysAdminExportLogsExcel(r,i,e).then((function(e){return s=e.data.task_id,n.setState({taskId:s}),n.props.toggle(),yi.E.queryIOStatus(s)})).then((function(t){!0===t.data.is_finished?location.href=m.Yc+"sys/log/export-excel/?task_id="+s+"&log_type="+e:n.timer=setInterval((function(){yi.E.queryIOStatus(s).then((function(t){!0===t.data.is_finished&&(clearInterval(n.timer),location.href=m.Yc+"sys/log/export-excel/?task_id="+s+"&log_type="+e)})).catch((function(e){clearInterval(n.timer),w.A.danger((0,m.AP)("Failed to export. Please check whether the size of table attachments exceeds the limit."))}))}),1e3)})).catch((function(e){if(n.props.toggle(),e.response&&500===e.response.status){var t=e.response.data?e.response.data.error_msg:null;t&&"Internal Server Error"!==t?w.A.danger(t):w.A.danger((0,m.AP)("Internal Server Error"))}else{var r=f.Aq.getErrorMsg(e);w.A.danger(r)}}))},n.isValidDateStr=function(){var e=n.state,t=e.startDateStr,r=e.endDateStr;return!!(C()(t,"YYYY-MM-DD",!0).isValid()&&C()(r,"YYYY-MM-DD",!0).isValid()&&C()(t).isBefore(r))||(n.setState({errMsg:(0,m.AP)("Date Invalid.")}),!1)},n.handleStartChange=function(e){var t=e.target.value.trim();n.setState({startDateStr:t,errMsg:""})},n.handleEndChange=function(e){var t=e.target.value.trim();n.setState({endDateStr:t,errMsg:""})},n.state={loading:!0,startDateStr:"",endDateStr:"",errMsg:"",taskId:""},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){return(0,A.jsxs)(u.A,{isOpen:!0,toggle:this.props.toggle,autoFocus:!1,children:[(0,A.jsx)(be.A,{toggle:this.props.toggle,children:(0,m.AP)("Choose date")}),(0,A.jsxs)(je.A,{children:[(0,A.jsxs)(ke.A,{children:[(0,A.jsx)(_e.A,{children:(0,m.AP)("Start date")}),(0,A.jsx)(W.A,{value:this.state.startDateStr,onChange:this.handleStartChange,placeholder:"yyyy-mm-dd",autoFocus:!0})]}),(0,A.jsxs)(ke.A,{children:[(0,A.jsx)(_e.A,{children:(0,m.AP)("End date")}),(0,A.jsx)(W.A,{value:this.state.endDateStr,onChange:this.handleEndChange,placeholder:"yyyy-mm-dd"})]}),this.state.errMsg&&(0,A.jsx)(Se.A,{className:"mt-2",color:"danger",children:(0,m.AP)(this.state.errMsg)})]}),(0,A.jsxs)(De.A,{children:[(0,A.jsx)(S.A,{color:"secondary",onClick:this.props.toggle,children:(0,m.AP)("Cancel")}),(0,A.jsx)(S.A,{color:"primary",onClick:this.downloadExcel,children:(0,m.AP)("Submit")})]})]})}}])}(l.Component),ji=function(e){function t(){var e;(0,i.A)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=(0,a.A)(this,t,[].concat(r))).getPreviousPage=function(){e.props.getLogsByPage(e.props.currentPage-1)},e.getNextPage=function(){e.props.getLogsByPage(e.props.currentPage+1)},e}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg,r=e.items,i=e.perPage,s=e.currentPage,a=e.hasNextPage;if(t)return(0,A.jsx)(I.A,{});if(n)return(0,A.jsx)("p",{className:"error text-center",children:n});var o=(0,A.jsx)(ie.A,{text:(0,m.AP)("No login logs")}),c=(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("table",{className:"table-hover",children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"25%",children:(0,m.AP)("Name")}),(0,A.jsx)("th",{width:"25%",children:(0,m.AP)("IP")}),(0,A.jsx)("th",{width:"25%",children:(0,m.AP)("Status")}),(0,A.jsx)("th",{width:"25%",children:(0,m.AP)("Time")})]})}),r&&(0,A.jsx)("tbody",{children:r.map((function(e,t){return(0,A.jsx)(Si,{item:e},t)}))})]}),(0,A.jsx)(X.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:s,hasNextPage:a,curPerPage:i,resetPerPage:this.props.resetPerPage})]});return r.length?c:o}}])}(l.Component),Si=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleMouseOver=function(){n.setState({isOpIconShown:!0})},n.handleMouseOut=function(){n.setState({isOpIconShown:!1})},n.state={isOpIconShown:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.item;return(0,A.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,children:[(0,A.jsx)("td",{children:(0,A.jsx)(ue,{email:e.email,name:e.name})}),(0,A.jsx)("td",{children:e.login_ip}),(0,A.jsx)("td",{children:e.log_success?(0,m.AP)("Success"):(0,m.AP)("Failed")}),(0,A.jsx)("td",{children:C()(e.login_time).fromNow()})]})}}])}(l.Component),Di=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleExportExcelDialog=function(){n.setState({isExportExcelDialogOpen:!n.state.isExportExcelDialogOpen})},n.getLogsByPage=function(e){var t=n.state.perPage;D.e.sysAdminListLoginLogs(e,t).then((function(r){n.setState({logList:r.data.login_log_list,loading:!1,currentPage:e,hasNextPage:f.Aq.hasNextPage(e,t,r.data.total_count)})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){return n.getLogsByPage(n.initPage)}))},n.state={loading:!0,errorMsg:"",logList:[],perPage:25,currentPage:1,hasNextPage:!1,isExportExcelDialogOpen:!1},n.initPage=1,n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,r=n.currentPage,i=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||i),currentPage:parseInt(t.get("page")||r)},(function(){e.getLogsByPage(e.state.currentPage)}))}},{key:"render",value:function(){var e=this.state,t=e.logList,n=e.currentPage,i=e.perPage,s=e.hasNextPage,a=e.isExportExcelDialogOpen;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)((0,r.A)({},this.props),{},{children:(0,A.jsx)(S.A,{className:"btn btn-secondary operation-item",onClick:this.toggleExportExcelDialog,children:(0,m.AP)("Export Excel")})})),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)(Pi,{currentItem:"loginLogs"}),(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsx)(ji,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:t,currentPage:n,perPage:i,hasNextPage:s,getLogsByPage:this.getLogsByPage,resetPerPage:this.resetPerPage})})]})}),a&&(0,A.jsx)(Kt.A,{children:(0,A.jsx)(bi,{logType:"login",toggle:this.toggleExportExcelDialog})})]})}}])}(l.Component),wi=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleMenu=function(){n.setState({isMenuShown:!n.state.isMenuShown},(function(){n.props.toggleFreezeItem(n.state.isMenuShown)}))},n.onItemClick=function(){n.props.filterItems(),n.props.toggleFreezeItem(!1)},n.state={isMenuShown:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.filterBy;return(0,A.jsxs)(We.A,{isOpen:this.state.isMenuShown,toggle:this.toggleMenu,children:[(0,A.jsx)(Ge.A,{tag:"i",className:"sf-dropdown-toggle sf2-icon-caret-down",title:(0,m.AP)("More operations"),"aria-label":(0,m.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isMenuShown}),(0,A.jsx)(Qe.A,{children:(0,A.jsx)(Ke.A,{onClick:this.onItemClick,children:(0,m.AP)("only show {placeholder}").replace("{placeholder}",e)})})]})}}])}(l.Component),Ii=function(e){function t(){return(0,i.A)(this,t),(0,a.A)(this,t,arguments)}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.filterBy;return(0,A.jsxs)(S.A,{color:"secondary",className:"my-2 mr-2",onClick:this.props.toggleFilter,children:[(0,A.jsx)("span",{className:"text-primary",children:e}),(0,A.jsx)("span",{className:"ml-2 close",style:{fontSize:"1.2rem"},children:"x"})]})}}])}(l.Component),ki=Ii,_i=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).getPreviousPage=function(){n.props.getLogsByPage(n.props.currentPage-1)},n.getNextPage=function(){n.props.getLogsByPage(n.props.currentPage+1)},n.toggleFilterByUser=function(){n.props.filterByUser(null)},n.toggleFilterByRepo=function(){n.props.filterByRepo(null)},n.toggleFreezeItem=function(e){n.setState({isItemFreezed:e})},n.state={isItemFreezed:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,i=t.items,s=t.userFilteredBy,a=t.repoFilteredBy,o=t.perPage,c=t.currentPage,d=t.hasNextPage;if(n)return(0,A.jsx)(I.A,{});if(r)return(0,A.jsx)("p",{className:"error text-center",children:r});var h=(0,A.jsx)(ie.A,{text:(0,m.AP)("No file access logs")}),u=(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("div",{children:[s&&(0,A.jsx)(ki,{filterBy:i[0].name,toggleFilter:this.toggleFilterByUser}),a&&(0,A.jsx)(ki,{filterBy:i[0].repo_name,toggleFilter:this.toggleFilterByRepo})]}),(0,A.jsxs)("table",{children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"20%",children:(0,m.AP)("Name")}),(0,A.jsx)("th",{width:"10%",children:(0,m.AP)("Type")}),(0,A.jsxs)("th",{width:"20%",children:[(0,m.AP)("IP")," / ",(0,m.AP)("Device")]}),(0,A.jsx)("th",{width:"20%",children:(0,m.AP)("Date")}),(0,A.jsx)("th",{width:"15%",children:(0,m.AP)("Library")}),(0,A.jsxs)("th",{width:"15%",children:[(0,m.AP)("File")," / ",(0,m.AP)("Folder")]})]})}),i&&(0,A.jsx)("tbody",{children:i.map((function(t,n){return(0,A.jsx)(Ni,{item:t,isFreezed:e.state.isItemFreezed,toggleFreezeItem:e.toggleFreezeItem,userFilteredBy:s,repoFilteredBy:a,filterByUser:e.props.filterByUser,filterByRepo:e.props.filterByRepo},n)}))})]}),(0,A.jsx)(X.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:c,hasNextPage:d,curPerPage:o,resetPerPage:this.props.resetPerPage})]});return i.length?u:h}}])}(l.Component),Ni=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleMouseEnter=function(){n.props.isFreezed||n.setState({isHighlighted:!0,isOpIconShown:!0})},n.handleMouseLeave=function(){n.props.isFreezed||n.setState({isHighlighted:!1,isOpIconShown:!1})},n.filterByUser=function(){var e=n.props.item;n.props.filterByUser(e.email)},n.filterByRepo=function(){var e=n.props.item;n.props.filterByRepo(e.repo_id)},n.toggleFreezeItem=function(e){n.props.toggleFreezeItem(e),e||n.setState({isHighlighted:!1,isOpIconShown:!1})},n.state={isHighlighted:!1,isOpIconShown:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.state,t=e.isHighlighted,n=e.isOpIconShown,r=this.props,i=r.item,s=r.userFilteredBy,a=r.repoFilteredBy;return(0,A.jsxs)("tr",{className:t?"tr-highlight":"",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,A.jsxs)("td",{children:[(0,A.jsx)(ue,{email:i.email,name:i.name}),n&&!s&&(0,A.jsx)(wi,{filterBy:i.name,filterItems:this.filterByUser,toggleFreezeItem:this.toggleFreezeItem})]}),(0,A.jsx)("td",{children:i.event_type}),(0,A.jsxs)("td",{children:[i.ip," / ",i.device||"--"]}),(0,A.jsx)("td",{children:C()(i.time).fromNow()}),(0,A.jsxs)("td",{children:[i.repo_name?i.repo_name:(0,m.AP)("Deleted"),n&&i.repo_name&&!a&&(0,A.jsx)(wi,{filterBy:i.repo_name,filterItems:this.filterByRepo,toggleFreezeItem:this.toggleFreezeItem})]}),(0,A.jsx)("td",{children:i.file_or_dir_name})]})}}])}(l.Component),Mi=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleExportExcelDialog=function(){n.setState({isExportExcelDialogOpen:!n.state.isExportExcelDialogOpen})},n.getLogsByPage=function(e){var t=n.state,r=t.perPage,i=t.userFilteredBy,s=t.repoFilteredBy;D.e.sysAdminListFileAccessLogs(e,r,i,s).then((function(t){n.setState({logList:t.data.file_access_log_list,loading:!1,currentPage:e,hasNextPage:t.data.has_next_page})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){return n.getLogsByPage(n.initPage)}))},n.updateURL=function(e){var t=new URL(location.href),n=new URLSearchParams(t.search);for(var r in e)null==e[r]?n.delete(r):n.set(r,e[r]);t.search=n.toString(),(0,g.oo)(t.toString())},n.filterByUser=function(e){n.setState({userFilteredBy:e},(function(){n.getLogsByPage(n.initPage),n.updateURL({email:e})}))},n.filterByRepo=function(e){n.setState({repoFilteredBy:e},(function(){n.getLogsByPage(n.initPage),n.updateURL({repo_id:e})}))},n.state={loading:!0,errorMsg:"",logList:[],perPage:25,currentPage:1,hasNextPage:!1,isExportExcelDialogOpen:!1},n.initPage=1,n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,r=n.currentPage,i=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||i),currentPage:parseInt(t.get("page")||r),userFilteredBy:t.get("email"),repoFilteredBy:t.get("repo_id")},(function(){e.getLogsByPage(e.state.currentPage)}))}},{key:"render",value:function(){var e=this.state,t=e.logList,n=e.userFilteredBy,i=e.repoFilteredBy,s=e.currentPage,a=e.perPage,o=e.hasNextPage,c=e.isExportExcelDialogOpen;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)((0,r.A)({},this.props),{},{children:(0,A.jsx)(S.A,{className:"btn btn-secondary operation-item",onClick:this.toggleExportExcelDialog,children:(0,m.AP)("Export Excel")})})),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)(Pi,{currentItem:"fileAccessLogs"}),(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsx)(_i,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:t,userFilteredBy:n,repoFilteredBy:i,filterByUser:this.filterByUser,filterByRepo:this.filterByRepo,currentPage:s,perPage:a,hasNextPage:o,getLogsByPage:this.getLogsByPage,resetPerPage:this.resetPerPage})})]})}),c&&(0,A.jsx)(Kt.A,{children:(0,A.jsx)(bi,{logType:"fileAccess",toggle:this.toggleExportExcelDialog})})]})}}])}(l.Component),Ci=n(33e3),Oi=function(e){function t(){var e;(0,i.A)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=(0,a.A)(this,t,[].concat(r))).getPreviousPage=function(){e.props.getLogsByPage(e.props.currentPage-1)},e.getNextPage=function(){e.props.getLogsByPage(e.props.currentPage+1)},e}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg,r=e.items,i=e.perPage,s=e.currentPage,a=e.hasNextPage;if(t)return(0,A.jsx)(I.A,{});if(n)return(0,A.jsx)("p",{className:"error text-center",children:n});var o=(0,A.jsx)(ie.A,{text:(0,m.AP)("No file update logs")}),c=(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("table",{className:"table-hover",children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"25%",children:(0,m.AP)("Name")}),(0,A.jsx)("th",{width:"25%",children:(0,m.AP)("Date")}),(0,A.jsx)("th",{width:"25%",children:(0,m.AP)("Library")}),(0,A.jsx)("th",{width:"25%",children:(0,m.AP)("Action")})]})}),r&&(0,A.jsx)("tbody",{children:r.map((function(e,t){return(0,A.jsx)(Li,{item:e},t)}))})]}),(0,A.jsx)(X.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:s,hasNextPage:a,curPerPage:i,resetPerPage:this.props.resetPerPage})]});return r.length?c:o}}])}(l.Component),Li=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleMouseOver=function(){n.setState({isOpIconShown:!0})},n.handleMouseOut=function(){n.setState({isOpIconShown:!1})},n.toggleCommitDetailsDialog=function(){n.setState({isCommitDetailsDialogOpen:!n.state.isCommitDetailsDialogOpen})},n.showCommitDetails=function(e){e.preventDefault(),n.setState({isCommitDetailsDialogOpen:!n.state.isCommitDetailsDialogOpen})},n.state={isOpIconShown:!1,isCommitDetailsDialogOpen:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.item;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,children:[(0,A.jsx)("td",{children:(0,A.jsx)(ue,{email:e.email,name:e.name})}),(0,A.jsx)("td",{children:C()(e.time).fromNow()}),(0,A.jsx)("td",{children:e.repo_name?e.repo_name:(0,m.AP)("Deleted")}),(0,A.jsxs)("td",{children:[e.file_operation,e.repo_name&&!e.repo_encrypted&&(0,A.jsx)("a",{className:"ml-1",href:"#",onClick:this.showCommitDetails,children:(0,m.AP)("Details")})]})]}),this.state.isCommitDetailsDialogOpen&&(0,A.jsx)(Kt.A,{children:(0,A.jsx)(Ci.A,{repoID:e.repo_id,commitID:e.commit_id,commitTime:e.time,toggleDialog:this.toggleCommitDetailsDialog})})]})}}])}(l.Component),Ti=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleExportExcelDialog=function(){n.setState({isExportExcelDialogOpen:!n.state.isExportExcelDialogOpen})},n.getLogsByPage=function(e){var t=n.state.perPage;D.e.sysAdminListFileUpdateLogs(e,t).then((function(t){n.setState({logList:t.data.file_update_log_list,loading:!1,currentPage:e,hasNextPage:t.data.has_next_page})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){return n.getLogsByPage(n.initPage)}))},n.state={loading:!0,errorMsg:"",logList:[],perPage:25,currentPage:1,hasNextPage:!1,isExportExcelDialogOpen:!1},n.initPage=1,n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,r=n.currentPage,i=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||i),currentPage:parseInt(t.get("page")||r)},(function(){e.getLogsByPage(e.state.currentPage)}))}},{key:"render",value:function(){var e=this.state,t=e.logList,n=e.currentPage,i=e.perPage,s=e.hasNextPage,a=e.isExportExcelDialogOpen;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)((0,r.A)({},this.props),{},{children:(0,A.jsx)(S.A,{className:"btn btn-secondary operation-item",onClick:this.toggleExportExcelDialog,children:(0,m.AP)("Export Excel")})})),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)(Pi,{currentItem:"fileUpdateLogs"}),(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsx)(Oi,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:t,currentPage:n,perPage:i,hasNextPage:s,getLogsByPage:this.getLogsByPage,resetPerPage:this.resetPerPage})})]})}),a&&(0,A.jsx)(Kt.A,{children:(0,A.jsx)(bi,{logType:"fileUpdate",toggle:this.toggleExportExcelDialog})})]})}}])}(l.Component),Fi=function(e){function t(){var e;(0,i.A)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=(0,a.A)(this,t,[].concat(r))).getPreviousPage=function(){e.props.getLogsByPage(e.props.currentPage-1)},e.getNextPage=function(){e.props.getLogsByPage(e.props.currentPage+1)},e}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg,r=e.items,i=e.perPage,s=e.currentPage,a=e.hasNextPage;if(t)return(0,A.jsx)(I.A,{});if(n)return(0,A.jsx)("p",{className:"error text-center",children:n});var o=(0,A.jsx)(ie.A,{text:(0,m.AP)("No permission logs")}),c=(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("table",{className:"table-hover",children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"15%",children:(0,m.AP)("Share From")}),(0,A.jsx)("th",{width:"15%",children:(0,m.AP)("Share To")}),(0,A.jsx)("th",{width:"10%",children:(0,m.AP)("Actions")}),(0,A.jsx)("th",{width:"13%",children:(0,m.AP)("Permission")}),(0,A.jsx)("th",{width:"20%",children:(0,m.AP)("Library")}),(0,A.jsx)("th",{width:"12%",children:(0,m.AP)("Folder")}),(0,A.jsx)("th",{width:"15%",children:(0,m.AP)("Date")})]})}),r&&(0,A.jsx)("tbody",{children:r.map((function(e,t){return(0,A.jsx)(Ri,{item:e},t)}))})]}),(0,A.jsx)(X.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:s,hasNextPage:a,curPerPage:i,resetPerPage:this.props.resetPerPage})]});return r.length?c:o}}])}(l.Component),Ri=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleMouseOver=function(){n.setState({isOpIconShown:!0})},n.handleMouseOut=function(){n.setState({isOpIconShown:!1})},n.getActionTextByEType=function(e){return-1!=e.indexOf("add")?(0,m.AP)("Add"):-1!=e.indexOf("modify")?(0,m.AP)("Modify"):-1!=e.indexOf("delete")?(0,m.AP)("Delete"):""},n.getShareTo=function(e){switch(e.share_type){case"user":return(0,A.jsx)(ue,{email:e.to_user_email,name:e.to_user_name});case"group":return(0,A.jsx)(g.N_,{to:"".concat(m.Yc,"sys/groups/").concat(e.to_group_id,"/libraries/"),children:e.to_group_name});case"department":return(0,A.jsx)(g.N_,{to:"".concat(m.Yc,"sys/departments/").concat(e.to_group_id,"/"),children:e.to_group_name});case"all":return(0,A.jsx)(g.N_,{to:"".concat(m.Yc,"org/"),children:(0,m.AP)("All")});default:return(0,m.AP)("Deleted")}},n.state={isOpIconShown:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.item;return(0,A.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,children:[(0,A.jsx)("td",{children:(0,A.jsx)(ue,{email:e.from_user_email,name:e.from_user_name})}),(0,A.jsx)("td",{children:this.getShareTo(e)}),(0,A.jsx)("td",{children:this.getActionTextByEType(e.etype)}),(0,A.jsx)("td",{children:f.Aq.sharePerms(e.permission)}),(0,A.jsx)("td",{children:e.repo_name?e.repo_name:(0,m.AP)("Deleted")}),(0,A.jsx)("td",{children:e.folder}),(0,A.jsx)("td",{children:C()(e.date).fromNow()})]})}}])}(l.Component),Ei=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleExportExcelDialog=function(){n.setState({isExportExcelDialogOpen:!n.state.isExportExcelDialogOpen})},n.getLogsByPage=function(e){var t=n.state.perPage;D.e.sysAdminListSharePermissionLogs(e,t).then((function(t){n.setState({logList:t.data.share_permission_log_list,loading:!1,currentPage:e,hasNextPage:t.data.has_next_page})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){return n.getLogsByPage(n.initPage)}))},n.state={loading:!0,errorMsg:"",logList:[],perPage:25,currentPage:1,hasNextPage:!1,isExportExcelDialogOpen:!1},n.initPage=1,n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,r=n.currentPage,i=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||i),currentPage:parseInt(t.get("page")||r)},(function(){e.getLogsByPage(e.state.currentPage)}))}},{key:"render",value:function(){var e=this.state,t=e.logList,n=e.currentPage,i=e.perPage,s=e.hasNextPage,a=e.isExportExcelDialogOpen;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)((0,r.A)({},this.props),{},{children:(0,A.jsx)(S.A,{className:"btn btn-secondary operation-item",onClick:this.toggleExportExcelDialog,children:(0,m.AP)("Export Excel")})})),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)(Pi,{currentItem:"sharePermissionLogs"}),(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsx)(Fi,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:t,currentPage:n,perPage:i,hasNextPage:s,getLogsByPage:this.getLogsByPage,resetPerPage:this.resetPerPage})})]})}),a&&(0,A.jsx)(Kt.A,{children:(0,A.jsx)(bi,{logType:"sharePermission",toggle:this.toggleExportExcelDialog})})]})}}])}(l.Component),Ui=function(e){function t(e){return(0,i.A)(this,t),(0,a.A)(this,t,[e])}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props,t=e.headingText,n=e.children;return(0,A.jsxs)("div",{className:"mb-4",children:[(0,A.jsx)("h4",{className:"border-bottom font-weight-normal mb-2 pb-1",children:t}),n]})}}])}(l.Component),zi=n(90441),Bi=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleBtns=function(){n.setState({isBtnsShown:!n.state.isBtnsShown})},n.hideBtns=function(e){n.state.isBtnsShown&&(n.props.value!=n.state.value&&n.setState({value:n.props.value}),n.toggleBtns())},n.onInputChange=function(e){n.setState({value:e.target.value})},n.onSubmit=function(e){var t=n.state.value.trim();t!=n.props.value&&n.props.saveSetting(n.props.keyText,t),n.toggleBtns()},n.state={isBtnsShown:!1,value:n.props.value},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.setState({value:e.value})}},{key:"render",value:function(){var e=this.state,t=e.isBtnsShown,n=e.value,r=this.props,i=r.helpTip,s=r.displayName,a=r.inputType;return(0,A.jsx)(zi.A,{displayName:s,helpTip:i,mainContent:(0,A.jsx)(W.A,{type:a||"text",className:"textarea"==a?"web-setting-textarea":"",onChange:this.onInputChange,onFocus:this.toggleBtns,onBlur:this.hideBtns,value:n}),extraContent:t?(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(S.A,{color:"primary",className:"sf2-icon-tick web-setting-icon-btn web-setting-icon-btn-submit",onMouseDown:this.onSubmit,title:(0,m.AP)("Submit")}),(0,A.jsx)(S.A,{className:"ml-1 sf2-icon-x2 web-setting-icon-btn web-setting-icon-btn-cancel",title:(0,m.AP)("Cancel")})]}):null})}}])}(l.Component),qi=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).uploadFile=function(){if(n.fileInput.current.files.length){var e=n.fileInput.current.files[0];n.props.postFile(e,n.props.keyText)}},n.openFileInput=function(){n.fileInput.current.click()},n.fileInput=l.createRef(),n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props,t=e.helpTip,n=e.filePath,r=e.fileWidth,i=e.fileHeight,s=e.displayName;return(0,A.jsx)(zi.A,{displayName:s,helpTip:t,mainContent:(0,A.jsx)("img",{src:n+"?t="+(new Date).getTime(),alt:s,width:r,height:i,className:"mb-1"}),extraContent:(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(S.A,{color:"secondary",onClick:this.openFileInput,children:(0,m.AP)("Change")}),(0,A.jsx)("input",{className:"d-none",type:"file",onChange:this.uploadFile,ref:this.fileInput})]})})}}])}(l.Component),Yi=n(30016),Vi=(n(37696),function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).saveSetting=function(e,t){D.e.sysAdminSetSysSettingInfo(e,t).then((function(e){n.setState({config_dict:e.data}),w.A.success((0,m.AP)("Success"))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.postFile=function(e,t){var r;"Logo"==t?r=D.e.sysAdminUpdateLogo(e):"Favicon"==t?r=D.e.sysAdminUpdateFavicon(e):"loginBGImage"==t&&(r=D.e.sysAdminUpdateLoginBG(e)),r.then((function(e){"Logo"==t?n.setState({logoPath:e.data.logo_path}):"Favicon"==t?n.setState({faviconPath:e.data.favicon_path}):"loginBGImage"==t&&n.setState({loginBGPath:e.data.login_bg_image_path}),w.A.success((0,m.AP)("Success"))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.state={loading:!0,errorMsg:"",config_dict:null,logoPath:m.SG+m.VI,faviconPath:m.SG+m.M$,loginBGPath:m.SG+m.sO},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this;D.e.sysAdminGetSysSettingInfo().then((function(t){e.setState({loading:!1,config_dict:t.data})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this.state,t=e.loading,n=e.errorMsg,i=e.config_dict,s=e.logoPath,a=e.faviconPath,o=e.loginBGPath;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)({},this.props)),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)("div",{className:"cur-view-path",children:(0,A.jsx)("h3",{className:"sf-heading",children:(0,m.AP)("Settings")})}),(0,A.jsxs)("div",{className:"cur-view-content container mw-100",children:[t&&(0,A.jsx)(I.A,{}),n&&(0,A.jsx)("p",{className:"error text-center mt-4",children:n}),!t&&!n&&i&&(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)("p",{className:"small text-secondary my-4",children:(0,m.AP)("Note: Settings via web interface are saved in database table (seahub-db/constance_config). They have a higher priority over the settings in config files.")}),(0,A.jsx)(Ui,{headingText:"URL",children:(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(Bi,{saveSetting:this.saveSetting,displayName:"SERVICE_URL",keyText:"SERVICE_URL",value:i.SERVICE_URL,helpTip:(0,m.AP)("The URL of the server, like https://seafile.example.com or http://192.168.1.2:8000")}),(0,A.jsx)(Bi,{saveSetting:this.saveSetting,displayName:"FILE_SERVER_ROOT",keyText:"FILE_SERVER_ROOT",value:i.FILE_SERVER_ROOT,helpTip:(0,m.AP)("The internal URL for downloading/uploading files. Users will not be able to download/upload files if this is not set correctly. If you config Seafile behind Nginx/Apache, it should be SERVICE_URL/seafhttp, like https://seafile.example.com/seafhttp .")})]})}),(0,A.jsx)(Ui,{headingText:(0,m.AP)("Branding"),children:(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(Bi,{saveSetting:this.saveSetting,displayName:"SITE_TITLE",keyText:"SITE_TITLE",value:i.SITE_TITLE,helpTip:(0,m.AP)("Site title shown in a browser tab")}),(0,A.jsx)(Bi,{saveSetting:this.saveSetting,displayName:"SITE_NAME",keyText:"SITE_NAME",value:i.SITE_NAME,helpTip:(0,m.AP)("Site name used in email sending")}),(0,A.jsx)(qi,{postFile:this.postFile,displayName:"Logo",keyText:"Logo",filePath:s,fileWidth:256,fileHeight:64,helpTip:"logo.png, 256px * 64px"}),(0,A.jsx)(qi,{postFile:this.postFile,displayName:"Favicon",keyText:"Favicon",filePath:a,fileWidth:32,fileHeight:32,helpTip:"favicon.ico, 32px * 32px"}),(0,A.jsx)(qi,{postFile:this.postFile,displayName:(0,m.AP)("Login Background Image"),keyText:"loginBGImage",filePath:o,fileWidth:240,fileHeight:160,helpTip:"login-bg.jpg, 2400px * 1600px"}),(0,A.jsx)(Yi.A,{saveSetting:this.saveSetting,displayName:"ENABLE_BRANDING_CSS",keyText:"ENABLE_BRANDING_CSS",value:i.ENABLE_BRANDING_CSS,helpTip:(0,m.AP)("Use custom CSS")}),(0,A.jsx)(Bi,{inputType:"textarea",saveSetting:this.saveSetting,displayName:(0,m.AP)("Custom CSS"),keyText:"CUSTOM_CSS",value:i.CUSTOM_CSS,helpTip:""})]})}),(0,A.jsx)(Ui,{headingText:(0,m.AP)("User"),children:(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(Yi.A,{saveSetting:this.saveSetting,displayName:(0,m.AP)("allow new registrations"),keyText:"ENABLE_SIGNUP",value:i.ENABLE_SIGNUP,helpTip:(0,m.AP)("Allow new user registrations. Uncheck this to prevent anyone from creating a new account.")}),(0,A.jsx)(Yi.A,{saveSetting:this.saveSetting,displayName:(0,m.AP)("activate after registration"),keyText:"ACTIVATE_AFTER_REGISTRATION",value:i.ACTIVATE_AFTER_REGISTRATION,helpTip:(0,m.AP)("Activate user immediately after registration. If unchecked, a user need to be activated by administrator or via activation email")}),(0,A.jsx)(Yi.A,{saveSetting:this.saveSetting,displayName:(0,m.AP)("send activation email"),keyText:"REGISTRATION_SEND_MAIL",value:i.REGISTRATION_SEND_MAIL,helpTip:(0,m.AP)("Send activation Email after user registration.")}),(0,A.jsx)(Bi,{saveSetting:this.saveSetting,displayName:(0,m.AP)("keep sign in"),keyText:"LOGIN_REMEMBER_DAYS",value:i.LOGIN_REMEMBER_DAYS,helpTip:(0,m.AP)("Number of days that keep user sign in.")}),(0,A.jsx)(Bi,{saveSetting:this.saveSetting,displayName:"LOGIN_ATTEMPT_LIMIT",keyText:"LOGIN_ATTEMPT_LIMIT",value:i.LOGIN_ATTEMPT_LIMIT,helpTip:(0,m.AP)("The maximum number of failed login attempts before showing CAPTCHA.")}),(0,A.jsx)(Yi.A,{saveSetting:this.saveSetting,displayName:"FREEZE_USER_ON_LOGIN_FAILED",keyText:"FREEZE_USER_ON_LOGIN_FAILED",value:i.FREEZE_USER_ON_LOGIN_FAILED,helpTip:(0,m.AP)("Freeze user account when failed login attempts exceed limit.")})]})}),(0,A.jsx)(Ui,{headingText:(0,m.AP)("Groups"),children:(0,A.jsx)(Yi.A,{saveSetting:this.saveSetting,displayName:"ENABLE_SHARE_TO_ALL_GROUPS",keyText:"ENABLE_SHARE_TO_ALL_GROUPS",value:i.ENABLE_SHARE_TO_ALL_GROUPS,helpTip:(0,m.AP)("Enable users to share libraries to any groups in the system.")})}),(0,A.jsx)(Ui,{headingText:(0,m.AP)("Password"),children:(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(Yi.A,{saveSetting:this.saveSetting,displayName:"strong password",keyText:"USER_STRONG_PASSWORD_REQUIRED",value:i.USER_STRONG_PASSWORD_REQUIRED,helpTip:(0,m.AP)("Force user to use a strong password when sign up or change password.")}),(0,A.jsx)(Yi.A,{saveSetting:this.saveSetting,displayName:"force password change",keyText:"FORCE_PASSWORD_CHANGE",value:i.FORCE_PASSWORD_CHANGE,helpTip:(0,m.AP)("Force user to change password when account is newly added or reset by admin")}),(0,A.jsx)(Yi.A,{saveSetting:this.saveSetting,displayName:"enable two factor authentication",keyText:"ENABLE_TWO_FACTOR_AUTH",value:i.ENABLE_TWO_FACTOR_AUTH,helpTip:(0,m.AP)("Enable two factor authentication")})]})}),(0,A.jsx)(Ui,{headingText:(0,m.AP)("Library"),children:(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(Yi.A,{saveSetting:this.saveSetting,displayName:"library history",keyText:"ENABLE_REPO_HISTORY_SETTING",value:i.ENABLE_REPO_HISTORY_SETTING,helpTip:(0,m.AP)("Allow user to change library history settings")}),(0,A.jsx)(Yi.A,{saveSetting:this.saveSetting,displayName:"encrypted library",keyText:"ENABLE_ENCRYPTED_LIBRARY",value:i.ENABLE_ENCRYPTED_LIBRARY,helpTip:(0,m.AP)("Allow user to create encrypted libraries")}),(0,A.jsx)(Bi,{saveSetting:this.saveSetting,displayName:(0,m.AP)("library password minimum length"),keyText:"REPO_PASSWORD_MIN_LENGTH",value:i.REPO_PASSWORD_MIN_LENGTH,helpTip:(0,m.AP)("The least number of characters an encrypted library password should include.")}),(0,A.jsx)(Yi.A,{saveSetting:this.saveSetting,displayName:(0,m.AP)("share/upload link force password"),keyText:"SHARE_LINK_FORCE_USE_PASSWORD",value:i.SHARE_LINK_FORCE_USE_PASSWORD,helpTip:(0,m.AP)("Force user use password when generating share/upload link.")}),(0,A.jsx)(Bi,{saveSetting:this.saveSetting,displayName:(0,m.AP)("share/upload link password minimum length"),keyText:"SHARE_LINK_PASSWORD_MIN_LENGTH",value:i.SHARE_LINK_PASSWORD_MIN_LENGTH,helpTip:(0,m.AP)("The least number of characters a share/upload link password should include.")}),(0,A.jsx)(Bi,{saveSetting:this.saveSetting,displayName:(0,m.AP)("share/upload link password strength level"),keyText:"SHARE_LINK_PASSWORD_STRENGTH_LEVEL",value:i.SHARE_LINK_PASSWORD_STRENGTH_LEVEL,helpTip:(0,m.AP)("The level(1-4) of a share/upload link password's strength. For example, '3' means password must have at least 3 of the following: num, upper letter, lower letter and other symbols")}),(0,A.jsx)(Yi.A,{saveSetting:this.saveSetting,displayName:"ENABLE_USER_CLEAN_TRASH",keyText:"ENABLE_USER_CLEAN_TRASH",value:i.ENABLE_USER_CLEAN_TRASH,helpTip:(0,m.AP)("Allow user to clean library trash")})]})}),(0,A.jsx)(Ui,{headingText:(0,m.AP)("Online Preview"),children:(0,A.jsx)(Bi,{inputType:"textarea",saveSetting:this.saveSetting,displayName:(0,m.AP)("text file extensions"),keyText:"TEXT_PREVIEW_EXT",value:i.TEXT_PREVIEW_EXT,helpTip:(0,m.AP)("Extensions of text files that can be online previewed, each suffix is separated by a comma.")})}),(0,A.jsx)(Ui,{headingText:(0,m.AP)("Sync"),children:(0,A.jsx)(Yi.A,{saveSetting:this.saveSetting,displayName:"DISABLE_SYNC_WITH_ANY_FOLDER",keyText:"DISABLE_SYNC_WITH_ANY_FOLDER",value:i.DISABLE_SYNC_WITH_ANY_FOLDER,helpTip:(0,m.AP)("If turn on, the desktop clients will not be able to sync a folder outside the default Seafile folder.")})}),m.am&&(0,A.jsx)(Ui,{headingText:(0,m.AP)("Terms"),children:(0,A.jsx)(Yi.A,{saveSetting:this.saveSetting,displayName:"ENABLE_TERMS_AND_CONDITIONS",keyText:"ENABLE_TERMS_AND_CONDITIONS",value:i.ENABLE_TERMS_AND_CONDITIONS,helpTip:(0,m.AP)("Enable system admin to add Terms and Conditions, and all users will have to accept the terms.")})})]})]})]})})]})}}])}(l.Component)),Hi=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleChange=function(e){var t=e.target.value;n.setState({value:t,isSubmitBtnActive:""!=t.trim()})},n.handleSubmit=function(){n.toggle(),n.props.addNotification(n.state.value.trim())},n.toggle=function(){n.props.toggle()},n.state={value:"",isSubmitBtnActive:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){return(0,A.jsxs)(u.A,{isOpen:!0,toggle:this.toggle,children:[(0,A.jsx)(be.A,{toggle:this.toggle,children:(0,m.AP)("Add new notification")}),(0,A.jsx)(je.A,{children:(0,A.jsx)(Ie.A,{children:(0,A.jsx)(ke.A,{children:(0,A.jsx)(W.A,{type:"textarea",value:this.state.value,onChange:this.handleChange})})})}),(0,A.jsxs)(De.A,{children:[(0,A.jsx)(S.A,{color:"secondary",onClick:this.toggle,children:(0,m.AP)("Cancel")}),(0,A.jsx)(S.A,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive,children:(0,m.AP)("Submit")})]})]})}}])}(l.Component),Wi=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.state={isItemFreezed:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,i=t.items;if(n)return(0,A.jsx)(I.A,{});if(r)return(0,A.jsx)("p",{className:"error text-center mt-4",children:r});var s=(0,A.jsx)(ie.A,{text:(0,m.AP)("No notifications")}),a=(0,A.jsxs)("table",{children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"95%",children:(0,m.AP)("Notification Detail")}),(0,A.jsx)("th",{width:"5%"})]})}),(0,A.jsx)("tbody",{children:i.map((function(t,n){return(0,A.jsx)(Gi,{item:t,isItemFreezed:e.state.isItemFreezed,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem,deleteNotification:e.props.deleteNotification,setToCurrent:e.props.setToCurrent},n)}))})]});return i.length?a:s}}])}(l.Component),Gi=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleMouseEnter=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!0,highlight:!0})},n.handleMouseLeave=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!1,highlight:!1})},n.onUnfreezedItem=function(){n.setState({highlight:!1,isOpIconShow:!1}),n.props.onUnfreezedItem()},n.toggleDeleteDialog=function(e){e&&e.preventDefault(),n.setState({isDeleteDialogOpen:!n.state.isDeleteDialogOpen})},n.deleteNotification=function(){n.props.deleteNotification(n.props.item.id),n.toggleDeleteDialog()},n.setToCurrent=function(){n.props.setToCurrent(n.props.item.id)},n.onMenuItemClick=function(e){switch(e){case"Set to current":n.setToCurrent();break;case"Delete":n.toggleDeleteDialog()}},n.translateOperations=function(e){var t="";switch(e){case"Set to current":t=(0,m.AP)("Set to current");break;case"Delete":t=(0,m.AP)("Delete")}return t},n.getOperations=function(){var e=[];return n.props.item.is_current||e.push("Set to current"),e.push("Delete"),e},n.state={isOpIconShown:!1,highlight:!1,isDeleteDialogOpen:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.item,t=this.state,n=t.isOpIconShown,r=t.isDeleteDialogOpen;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,A.jsxs)("td",{children:[e.msg,e.is_current&&(0,A.jsx)("span",{className:"small text-orange",children:(0,m.AP)("(current notification)")})]}),(0,A.jsx)("td",{children:n&&(0,A.jsx)(He.A,{operations:this.getOperations(),translateOperations:this.translateOperations,onMenuItemClick:this.onMenuItemClick,onFreezedItem:this.props.onFreezedItem,onUnfreezedItem:this.onUnfreezedItem})})]}),r&&(0,A.jsx)(Ee.A,{title:(0,m.AP)("Delete Notification"),message:(0,m.AP)("Are you sure you want to delete the notification ?"),toggleDialog:this.toggleDeleteDialog,executeOperation:this.deleteNotification,confirmBtnText:(0,m.AP)("Delete")})]})}}])}(l.Component),Qi=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleAddNotificationDialog=function(){n.setState({isAddNotificationDialogOpen:!n.state.isAddNotificationDialogOpen})},n.addNotification=function(e){D.e.sysAdminAddSysNotification(e).then((function(e){var t=n.state.notificationList;t.unshift(e.data.notification),n.setState({notificationList:t})})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.deleteNotification=function(e){D.e.sysAdminDeleteSysNotification(e).then((function(t){var r=n.state.notificationList.filter((function(t){return t.id!=e}));n.setState({notificationList:r}),w.A.success((0,m.AP)("Successfully deleted 1 item."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.setToCurrent=function(e){D.e.sysAdminSetSysNotificationToCurrent(e).then((function(t){var r=n.state.notificationList.map((function(t){return t.id==e?t.is_current=!0:t.is_current=!1,t}));n.setState({notificationList:r})})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.state={loading:!0,errorMsg:"",notificationList:[],isAddNotificationDialogOpen:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this;D.e.sysAdminListAllSysNotifications().then((function(t){e.setState({loading:!1,notificationList:t.data.notifications})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this.state.isAddNotificationDialogOpen;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)((0,r.A)({},this.props),{},{children:(0,A.jsx)(S.A,{className:"btn btn-secondary operation-item",onClick:this.toggleAddNotificationDialog,children:(0,m.AP)("Add new notification")})})),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)("div",{className:"cur-view-path",children:(0,A.jsx)("h3",{className:"sf-heading",children:(0,m.AP)("All Notifications")})}),(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsx)(Wi,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.notificationList,deleteNotification:this.deleteNotification,setToCurrent:this.setToCurrent})})]})}),e&&(0,A.jsx)(Hi,{addNotification:this.addNotification,toggle:this.toggleAddNotificationDialog})]})}}])}(l.Component),Ki=function(e){function t(){return(0,i.A)(this,t),(0,a.A)(this,t,arguments)}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg,r=e.records;return t?(0,A.jsx)("span",{className:"loading-icon loading-tip"}):n?(0,A.jsx)("p",{className:"error text-center",children:n}):(0,A.jsxs)("table",{width:"100%",className:"table table-hover table-vcenter",children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"16%",children:(0,m.AP)("Library")}),(0,A.jsx)("th",{width:"30%",children:"ID"}),(0,A.jsx)("th",{width:"30%",children:(0,m.AP)("Path")}),(0,A.jsx)("th",{width:"12%",children:(0,m.AP)("Label")}),(0,A.jsx)("th",{width:"12%",children:(0,m.AP)("Suggestion")})]})}),(0,A.jsx)("tbody",{children:r.map((function(e,t){return(0,A.jsx)(Xi,{record:e},t)}))})]})}}])}(l.Component),Xi=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).state={},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.record;return(0,A.jsxs)("tr",{children:[(0,A.jsx)("td",{children:e.repo_name}),(0,A.jsx)("td",{children:e.repo_id}),(0,A.jsx)("td",{children:e.path}),(0,A.jsx)("td",{children:e.detail.label}),(0,A.jsx)("td",{children:e.detail.suggestion})]})}}])}(l.Component),$i=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).state={loading:!0,errorMsg:"",records:[]},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this;D.e.listFileScanRecords().then((function(t){e.setState({loading:!1,records:t.data.record_list})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)({},this.props)),(0,A.jsx)("div",{className:"main-panel-center",children:(0,A.jsxs)("div",{className:"cur-view-container",id:"content-scan-records",children:[(0,A.jsx)("div",{className:"cur-view-path",children:(0,A.jsx)("h3",{className:"sf-heading",children:(0,m.AP)("Content Scan Records")})}),(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsx)(Ki,{loading:this.state.loading,errorMsg:this.state.errorMsg,records:this.state.records})})]})})]})}}])}(l.Component),Zi=n(55097),Ji=n.n(Zi),es=n(21205),ts=function(e){function t(e){return(0,i.A)(this,t),(0,a.A)(this,t,[e])}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.newUsersTempObj,r=t.checkedDepartmentId,i=t.isMembersListLoading,s=t.canCheckUserIds,a=this.props.membersList.map((function(t,i){var s=t.avatar;return s=t.avatar&&t.avatar.length>0?t.avatar.substring(0,t.avatar.length-1)+"100":m.Yc+"media/avatars/default.png",(0,A.jsxs)("tr",{children:[(0,A.jsx)("td",{children:!t.email&&(0,A.jsx)("input",{type:"checkbox",className:"vam",onChange:function(){return e.props.onUserChecked(t)},checked:t.userid in n?"checked":""})}),(0,A.jsx)("td",{children:(0,A.jsx)("img",{className:"avatar",src:s,alt:""})}),(0,A.jsx)("td",{children:t.name}),(0,A.jsx)("td",{children:t.mobile}),(0,A.jsx)("td",{children:t.contact_email}),(0,A.jsx)("td",{children:t.email&&(0,A.jsx)("i",{className:"sf2-icon-tick"})})]},r.toString()+t.userid)}));return(0,A.jsxs)("div",{className:"dir-content-main",children:[i&&(0,A.jsx)(I.A,{}),!i&&this.props.membersList.length>0&&(0,A.jsxs)(es.A,{hover:!0,children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"5%",children:s.length>0&&(0,A.jsx)("input",{type:"checkbox",className:"vam",checked:this.props.isCheckedAll,onChange:function(){return e.props.onAllUsersChecked()}})}),(0,A.jsx)("th",{width:"10%"}),(0,A.jsx)("th",{width:"20%",children:"\u540d\u79f0"}),(0,A.jsx)("th",{width:"20%",children:"\u624b\u673a\u53f7"}),(0,A.jsx)("th",{width:"30%",children:"\u90ae\u7bb1"}),(0,A.jsx)("th",{width:"15%",children:"\u5df2\u6dfb\u52a0"})]})}),(0,A.jsx)("tbody",{children:a})]}),!i&&0===this.props.membersList.length&&(0,A.jsxs)("div",{className:"message empty-tip text-center",children:[(0,A.jsx)("img",{src:"".concat(m.Yc,"media/img/member-list-empty-2x.png"),alt:""}),(0,A.jsx)("h4",{children:"\u6210\u5458\u5217\u8868\u4e3a\u7a7a"})]})]})}}])}(l.Component),ns=n(48738),rs=n.n(ns),is=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleChildren=function(e){e.preventDefault(),e.stopPropagation(),n.setState({isChildrenShow:!n.state.isChildrenShow})},n.dropdownToggle=function(e){e.stopPropagation(),n.setState({dropdownOpen:!n.state.dropdownOpen})},n.onMouseEnter=function(){n.setState({active:!0})},n.onMouseLeave=function(){n.state.dropdownOpen||n.setState({active:!1})},n.importDepartmentDialogToggle=function(e){n.setState({active:!1}),n.props.importDepartmentDialogToggle(e)},n.renderTreeNodes=function(e){if(e.length>0)return e.map((function(e){return(0,A.jsx)(t,{department:e,isChildrenShow:n.state.isChildrenShow,onChangeDepartment:n.props.onChangeDepartment,checkedDepartmentId:n.props.checkedDepartmentId,importDepartmentDialogToggle:n.importDepartmentDialogToggle},e.id)}))},n.changeDept=function(e){var t=n.props,r=t.department,i=t.checkedDepartmentId;n.props.onChangeDepartment(e),i!==r.id||n.state.isChildrenShow||n.setState({isChildrenShow:!0})},n.state={isChildrenShow:!1,dropdownOpen:!1,active:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){0===this.props.index&&(this.setState({isChildrenShow:!0}),this.props.onChangeDepartment(this.props.department.id))}},{key:"render",value:function(){var e=this,t=this.props,n=t.isChildrenShow,r=t.department,i=t.checkedDepartmentId,s=rs()({"folder-toggle-icon sf3-font sf3-font-down rotate-270":r.children&&this.state.isChildrenShow,"folder-toggle-icon sf3-font sf3-font-down":r.children&&!this.state.isChildrenShow}),a=rs()({"tree-node-inner":!0,"tree-node-inner-hover":this.state.active,"tree-node-hight-light":i===r.id});return(0,A.jsxs)(l.Fragment,{children:[n&&(0,A.jsxs)("div",{className:a,onClick:function(){return e.changeDept(r.id)},onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[(0,A.jsx)("span",{className:"tree-node-icon",onClick:function(t){return e.toggleChildren(t)},children:(0,A.jsx)("i",{className:s})}),(0,A.jsx)("span",{className:"tree-node-text",children:r.name}),m.am&&(0,A.jsxs)(We.A,{isOpen:this.state.dropdownOpen,toggle:function(t){return e.dropdownToggle(t)},direction:"down",style:this.state.active?{}:{opacity:0},children:[(0,A.jsx)(Ge.A,{tag:"i",className:"sf3-font sf3-font-more-vertical cursor-pointer attr-action-icon",title:(0,m.AP)("More operations"),"aria-label":(0,m.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.dropdownOpen}),(0,A.jsx)(Qe.A,{className:"drop-list",right:!0,children:(0,A.jsx)(Ke.A,{onClick:this.importDepartmentDialogToggle.bind(this,r),id:r.id,children:"\u5bfc\u5165\u90e8\u95e8"})})]})]}),this.state.isChildrenShow&&(0,A.jsx)("div",{className:"department-children",children:r.children&&this.renderTreeNodes(r.children)})]})}}])}(l.Component),ss=is,as=function(e){function t(e){return(0,i.A)(this,t),(0,a.A)(this,t,[e])}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this,t=this.props.departmentsTree;return(0,A.jsx)("div",{className:"dir-content-nav",children:(0,A.jsx)("div",{className:"tree-view tree",children:this.props.isTreeLoading?(0,A.jsx)(I.A,{}):(0,A.jsx)("div",{className:"tree-node",children:t.length>0&&t.map((function(t,n){return(0,A.jsx)(ss,{index:n,department:t,isChildrenShow:!0,onChangeDepartment:e.props.onChangeDepartment,checkedDepartmentId:e.props.checkedDepartmentId,importDepartmentDialogToggle:e.props.importDepartmentDialogToggle},t.id)}))})})})}}])}(l.Component),os=as,ls=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).toggle=function(){n.props.importDepartmentDialogToggle(null)},n.handleSubmit=function(){n.props.onImportDepartmentSubmit(),n.setState({isLoading:!0})},n.state={isLoading:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props,t=e.departmentsCount,n=e.membersCount,r=e.departmentName;return(0,A.jsxs)(u.A,{isOpen:!0,toggle:this.toggle,children:[(0,A.jsxs)(be.A,{toggle:this.toggle,children:[(0,A.jsx)("span",{children:"\u5bfc\u5165\u90e8\u95e8 "}),(0,A.jsx)("span",{className:"op-target",title:r,children:r})]}),(0,A.jsxs)(je.A,{children:[(0,A.jsxs)("p",{children:["\u5c06\u8981\u5bfc\u5165 ",(0,A.jsx)("strong",{children:t})," \u4e2a\u90e8\u95e8\uff0c\u5176\u4e2d\u5305\u62ec ",(0,A.jsx)("strong",{children:n})," \u4e2a\u6210\u5458"]}),this.state.isLoading&&(0,A.jsx)(I.A,{})]}),(0,A.jsxs)(De.A,{children:[(0,A.jsx)(S.A,{color:"secondary",onClick:this.toggle,children:"\u53d6\u6d88"}),(0,A.jsx)(S.A,{color:"primary",onClick:this.handleSubmit,children:"\u5bfc\u5165"})]})]})}}])}(l.Component),cs=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).getDepartmentsTree=function(e){for(var t=[],n=[],r=0;r<e.length;r++)-1===t.indexOf(e[r].id)&&t.push(e[r].id),-1===n.indexOf(e[r].parentid)&&n.push(e[r].parentid);var i=n.filter((function(e){return-1!==t.indexOf(e)})),s=n.concat(i).filter((function(e){return-1===n.indexOf(e)||-1===i.indexOf(e)})),a=Ji()(e);return a.filter((function(e){var t=a.filter((function(t){return e.id===t.parentid}));return t.length>0&&(e.children=t),-1!==s.indexOf(e.parentid)}))},n.getWorkWeixinDepartmentsList=function(e){D.e.adminListWorkWeixinDepartments(e).then((function(t){if(e)n.setState({importDepartmentChildrenCount:t.data.department.length,importDepartmentMembersCount:n.state.membersTempObj[e].length});else{var r=n.getDepartmentsTree(t.data.department);n.setState({isTreeLoading:!1,departmentsTree:r})}})).catch((function(e){n.handleError(e),n.setState({isTreeLoading:!1,isMembersListLoading:!1}),e.response&&403===e.response.status&&(window.location=m.Yc+"sys/useradmin/")}))},n.getWorkWeixinDepartmentMembersList=function(e){n.setState({isMembersListLoading:!0}),D.e.adminListWorkWeixinDepartmentMembers(e,{fetch_child:!0}).then((function(t){var r=n.state.membersTempObj;r[e]=t.data.userlist;var i=n.getCanCheckUserIds(t.data.userlist);n.setState({membersTempObj:r,membersList:t.data.userlist,isMembersListLoading:!1,canCheckUserIds:i})})).catch((function(e){n.setState({isMembersListLoading:!1}),n.handleError(e)}))},n.getCanCheckUserIds=function(e){var t=[];return e.forEach((function(e){e.email||t.push(e.userid)})),t},n.onChangeDepartment=function(e){if(n.setState({newUsersTempObj:{},isCheckedAll:!1,checkedDepartmentId:e}),e in n.state.membersTempObj){var t=n.getCanCheckUserIds(n.state.membersTempObj[e]);n.setState({membersList:n.state.membersTempObj[e],canCheckUserIds:t})}else n.getWorkWeixinDepartmentMembersList(e)},n.onUserChecked=function(e){if(-1!==n.state.canCheckUserIds.indexOf(e.userid)){var t=n.state.newUsersTempObj;e.userid in t?(delete t[e.userid],n.state.isCheckedAll&&n.setState({isCheckedAll:!1})):(t[e.userid]=e,Object.keys(t).length===n.state.canCheckUserIds.length&&n.setState({isCheckedAll:!0})),n.setState({newUsersTempObj:t})}},n.onAllUsersChecked=function(){n.setState({isCheckedAll:!n.state.isCheckedAll},(function(){if(n.state.isCheckedAll){for(var e={},t=n.state.membersList.filter((function(e){return-1!==n.state.canCheckUserIds.indexOf(e.userid)})),r=0;r<t.length;r++)e[t[r].userid]=t[r];n.setState({newUsersTempObj:e})}else n.setState({newUsersTempObj:{}})}))},n.onSubmit=function(){var e=n.state.newUsersTempObj;if("{}"!==JSON.stringify(e)){var t=[];for(var r in e)t.push(e[r]);0!==t.length?D.e.adminAddWorkWeixinUsersBatch(t).then((function(e){if(n.setState({newUsersTempObj:{},isCheckedAll:!1}),e.data.success&&n.handleSubmitSuccess(e.data.success),e.data.failed)for(var t=e.data.failed,r=0;r<t.length;r++)w.A.danger(t[r].name+" "+t[r].error_msg,{duration:3})})).catch((function(e){n.handleError(e)})):w.A.danger("\u672a\u9009\u62e9\u6210\u5458",{duration:3})}},n.handleSubmitSuccess=function(e){for(var t=n.state,r=t.membersTempObj,i=t.membersList,s=t.canCheckUserIds,a=0;a<e.length;a++){var o=e[a],l=o.userid,c=o.name,d=o.email;w.A.success(c+" \u6210\u529f\u5bfc\u5165",{duration:1}),-1!==s.indexOf(l)&&s.splice(s.indexOf(l),1);for(var h=0;h<i.length;h++)if(i[h].userid===l){i[h].email=d;break}for(var u in r)for(var g=0;g<r[u].length;g++)if(r[u][g].userid===l){r[u][g].email=d;break}}n.setState({membersTempObj:r,membersList:i,canCheckUserIds:s})},n.importDepartmentDialogToggle=function(e){n.setState({isImportDepartmentDialogShow:!n.state.isImportDepartmentDialogShow,importDepartment:e},(function(){e&&n.getWorkWeixinDepartmentsList(e.id)}))},n.onImportDepartmentSubmit=function(){var e=n.state.importDepartment;e&&D.e.adminImportWorkWeixinDepartment(e.id).then((function(t){n.setState({isMembersListLoading:!0,checkedDepartmentId:e.id,membersTempObj:{},membersList:[],newUsersTempObj:{},isCheckedAll:!1,canCheckUserIds:[]}),n.getWorkWeixinDepartmentMembersList(e.id),n.importDepartmentDialogToggle(null),t.data.success&&n.handleImportDepartmentSubmitSuccess(t.data.success),t.data.failed&&n.handleImportDepartmentSubmitFailed(t.data.failed)})).catch((function(e){n.handleError(e)}))},n.handleImportDepartmentSubmitSuccess=function(e){for(var t=0,n=e.length;t<n;t++){var r=e[t],i="department"===r.type?"\u90e8\u95e8 "+r.department_name+" \u5bfc\u5165\u6210\u529f":r.api_user_name+" \u5bfc\u5165\u6210\u529f";w.A.success(i,{duration:3})}},n.handleImportDepartmentSubmitFailed=function(e){for(var t=0,n=e.length;t<n;t++){var r=e[t],i="department"===r.type?r.department_name:r.api_user_name;w.A.danger(i+" "+r.msg,{duration:3})}},n.handleError=function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)},n.state={isTreeLoading:!0,isMembersListLoading:!0,departmentsTree:[],checkedDepartmentId:0,membersTempObj:{},membersList:[],newUsersTempObj:{},isCheckedAll:!1,canCheckUserIds:[],isImportDepartmentDialogShow:!1,importDepartment:null,importDepartmentChildrenCount:0,importDepartmentMembersCount:0},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){this.getWorkWeixinDepartmentsList(null)}},{key:"render",value:function(){var e=this.state,t=e.isImportDepartmentDialogShow,n=e.isTreeLoading,i=e.importDepartment,s=e.importDepartmentChildrenCount,a=e.importDepartmentMembersCount,o=!(!m.am||!t||n||!i);return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)((0,r.A)({},this.props),{},{children:(0,A.jsx)(S.A,{className:"operation-item",onClick:this.onSubmit,children:"\u5bfc\u5165\u7528\u6237"})})),(0,A.jsx)("div",{className:"main-panel-center",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)("div",{className:"cur-view-path",children:(0,A.jsx)("h3",{className:"sf-heading",children:"\u4f01\u4e1a\u5fae\u4fe1\u96c6\u6210"})}),(0,A.jsxs)("div",{className:"cur-view-content d-flex flex-row",children:[(0,A.jsx)(os,{departmentsTree:this.state.departmentsTree,isTreeLoading:this.state.isTreeLoading,onChangeDepartment:this.onChangeDepartment,checkedDepartmentId:this.state.checkedDepartmentId,importDepartmentDialogToggle:this.importDepartmentDialogToggle}),(0,A.jsx)("div",{className:"dir-content-resize"}),(0,A.jsx)(ts,{isMembersListLoading:this.state.isMembersListLoading,membersList:this.state.membersList,checkedDepartmentId:this.state.checkedDepartmentId,newUsersTempObj:this.state.newUsersTempObj,onUserChecked:this.onUserChecked,onAllUsersChecked:this.onAllUsersChecked,isCheckedAll:this.state.isCheckedAll,canCheckUserIds:this.state.canCheckUserIds})]})]})}),o&&(0,A.jsx)(ls,{importDepartmentDialogToggle:this.importDepartmentDialogToggle,onImportDepartmentSubmit:this.onImportDepartmentSubmit,departmentsCount:s,membersCount:a,departmentName:i.name})]})}}])}(l.Component),ds=function(e){function t(e){return(0,i.A)(this,t),(0,a.A)(this,t,[e])}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.newUsersTempObj,r=t.checkedDepartmentId,i=t.isMembersListLoading,s=t.canCheckUserIds,a=this.props.membersList.map((function(t,i){var s=t.avatar;return s=t.avatar&&t.avatar.length>0?t.avatar:m.Yc+"media/avatars/default.png",(0,A.jsxs)("tr",{children:[(0,A.jsx)("td",{children:!t.email&&(0,A.jsx)("input",{type:"checkbox",className:"vam",onChange:function(){return e.props.onUserChecked(t)},checked:t.userid in n?"checked":""})}),(0,A.jsx)("td",{children:(0,A.jsx)("img",{className:"avatar",src:s,alt:""})}),(0,A.jsx)("td",{children:t.name}),(0,A.jsx)("td",{children:t.mobile}),(0,A.jsx)("td",{children:t.contact_email}),(0,A.jsx)("td",{children:t.email&&(0,A.jsx)("i",{className:"sf2-icon-tick"})})]},r.toString()+t.userid)}));return(0,A.jsxs)("div",{className:"dir-content-main",children:[i&&(0,A.jsx)(I.A,{}),!i&&this.props.membersList.length>0&&(0,A.jsxs)(es.A,{hover:!0,children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"5%",children:s.length>0&&(0,A.jsx)("input",{type:"checkbox",className:"vam",checked:this.props.isCheckedAll,onChange:function(){return e.props.onAllUsersChecked()}})}),(0,A.jsx)("th",{width:"10%"}),(0,A.jsx)("th",{width:"20%",children:"\u540d\u79f0"}),(0,A.jsx)("th",{width:"20%",children:"\u624b\u673a\u53f7"}),(0,A.jsx)("th",{width:"30%",children:"\u90ae\u7bb1"}),(0,A.jsx)("th",{width:"15%",children:"\u5df2\u6dfb\u52a0"})]})}),(0,A.jsx)("tbody",{children:a})]}),!i&&0===this.props.membersList.length&&(0,A.jsxs)("div",{className:"message empty-tip text-center",children:[(0,A.jsx)("img",{src:"".concat(m.Yc,"media/img/member-list-empty-2x.png"),alt:""}),(0,A.jsx)("h4",{children:"\u6210\u5458\u5217\u8868\u4e3a\u7a7a"})]})]})}}])}(l.Component),hs=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleChildren=function(e){e.preventDefault(),e.stopPropagation(),n.setState({isChildrenShow:!n.state.isChildrenShow})},n.dropdownToggle=function(e){e.stopPropagation(),n.setState({dropdownOpen:!n.state.dropdownOpen})},n.onMouseEnter=function(){n.setState({active:!0})},n.onMouseLeave=function(){n.state.dropdownOpen||n.setState({active:!1})},n.importDepartmentDialogToggle=function(e){n.setState({active:!1}),n.props.importDepartmentDialogToggle(e)},n.renderTreeNodes=function(e){if(e.length>0)return e.map((function(e){return(0,A.jsx)(t,{department:e,isChildrenShow:n.state.isChildrenShow,onChangeDepartment:n.props.onChangeDepartment,checkedDepartmentId:n.props.checkedDepartmentId,importDepartmentDialogToggle:n.importDepartmentDialogToggle},e.id)}))},n.changeDept=function(e){var t=n.props,r=t.department,i=t.checkedDepartmentId;n.props.onChangeDepartment(e),i!==r.id||n.state.isChildrenShow||n.setState({isChildrenShow:!0})},n.state={isChildrenShow:!1,dropdownOpen:!1,active:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){0===this.props.index&&(this.setState({isChildrenShow:!0}),this.props.onChangeDepartment(this.props.department.id))}},{key:"render",value:function(){var e=this,t=this.props,n=t.isChildrenShow,r=t.department,i=t.checkedDepartmentId,s=rs()({"folder-toggle-icon sf3-font sf3-font-down rotate-270":r.children&&this.state.isChildrenShow,"folder-toggle-icon sf3-font sf3-font-down":r.children&&!this.state.isChildrenShow}),a=rs()({"tree-node-inner":!0,"tree-node-inner-hover":this.state.active,"tree-node-hight-light":i===r.id});return(0,A.jsxs)(l.Fragment,{children:[n&&(0,A.jsxs)("div",{className:a,onClick:function(){return e.changeDept(r.id)},onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[(0,A.jsx)("span",{className:"tree-node-icon",onClick:function(t){return e.toggleChildren(t)},children:(0,A.jsx)("i",{className:s})}),(0,A.jsx)("span",{className:"tree-node-text",children:r.name}),m.am&&(0,A.jsxs)(We.A,{isOpen:this.state.dropdownOpen,toggle:function(t){return e.dropdownToggle(t)},direction:"down",style:this.state.active?{}:{opacity:0},children:[(0,A.jsx)(Ge.A,{tag:"i",className:"sf3-font sf3-font-more-vertical cursor-pointer attr-action-icon",title:(0,m.AP)("More operations"),"aria-label":(0,m.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.dropdownOpen}),(0,A.jsx)(Qe.A,{className:"drop-list",right:!0,children:(0,A.jsx)(Ke.A,{onClick:this.importDepartmentDialogToggle.bind(this,r),id:r.id,children:"\u5bfc\u5165\u90e8\u95e8"})})]})]}),this.state.isChildrenShow&&(0,A.jsx)("div",{className:"department-children",children:r.children&&this.renderTreeNodes(r.children)})]})}}])}(l.Component),us=hs,gs=function(e){function t(e){return(0,i.A)(this,t),(0,a.A)(this,t,[e])}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this,t=this.props.departmentsTree;return(0,A.jsx)("div",{className:"dir-content-nav",children:(0,A.jsx)("div",{className:"tree-view tree",children:this.props.isTreeLoading?(0,A.jsx)(I.A,{}):(0,A.jsx)("div",{className:"tree-node",children:t.length>0&&t.map((function(t,n){return(0,A.jsx)(us,{index:n,department:t,isChildrenShow:!0,onChangeDepartment:e.props.onChangeDepartment,checkedDepartmentId:e.props.checkedDepartmentId,importDepartmentDialogToggle:e.props.importDepartmentDialogToggle},t.id)}))})})})}}])}(l.Component),ps=gs,ms=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).toggle=function(){n.props.importDepartmentDialogToggle(null)},n.handleSubmit=function(){n.props.onImportDepartmentSubmit(),n.setState({isLoading:!0})},n.state={isLoading:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props,t=e.departmentsCount,n=e.membersCount,r=e.departmentName;return(0,A.jsxs)(u.A,{isOpen:!0,toggle:this.toggle,children:[(0,A.jsxs)(be.A,{toggle:this.toggle,children:[(0,A.jsx)("span",{children:"\u5bfc\u5165\u90e8\u95e8 "}),(0,A.jsx)("span",{className:"op-target",title:r,children:r})]}),(0,A.jsxs)(je.A,{children:[(0,A.jsxs)("p",{children:["\u5c06\u8981\u5bfc\u5165 ",(0,A.jsx)("strong",{children:t})," \u4e2a\u90e8\u95e8\uff0c\u5176\u4e2d\u5305\u62ec ",(0,A.jsx)("strong",{children:n})," \u4e2a\u6210\u5458"]}),this.state.isLoading&&(0,A.jsx)(I.A,{})]}),(0,A.jsxs)(De.A,{children:[(0,A.jsx)(S.A,{color:"secondary",onClick:this.toggle,children:"\u53d6\u6d88"}),(0,A.jsx)(S.A,{color:"primary",onClick:this.handleSubmit,children:"\u5bfc\u5165"})]})]})}}])}(l.Component),fs=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).getDepartmentsTree=function(e){for(var t=[],n=[],r=0;r<e.length;r++)-1===t.indexOf(e[r].id)&&t.push(e[r].id),-1===n.indexOf(e[r].parentid)&&n.push(e[r].parentid);var i=n.filter((function(e){return-1!==t.indexOf(e)})),s=n.concat(i).filter((function(e){return-1===n.indexOf(e)||-1===i.indexOf(e)})),a=Ji()(e);return a.filter((function(e){var t=a.filter((function(t){return e.id===t.parentid}));return t.length>0&&(e.children=t),-1!==s.indexOf(e.parentid)}))},n.getDingtalkDepartmentsList=function(e){D.e.adminListDingtalkDepartments(e).then((function(t){if(e)n.setState({importDepartmentChildrenCount:t.data.department.length,importDepartmentMembersCount:n.state.membersTempObj[e].length});else{var r=n.getDepartmentsTree(t.data.department);n.setState({isTreeLoading:!1,departmentsTree:r})}})).catch((function(e){n.handleError(e),n.setState({isTreeLoading:!1,isMembersListLoading:!1}),e.response&&403===e.response.status&&(window.location=m.Yc+"sys/useradmin/")}))},n.getDingtalkDepartmentMembersList=function(e){n.setState({isMembersListLoading:!0}),D.e.adminListDingtalkDepartmentMembers(e).then((function(t){var r=n.state.membersTempObj;r[e]=t.data.userlist;var i=n.getCanCheckUserIds(t.data.userlist);n.setState({membersTempObj:r,membersList:t.data.userlist,isMembersListLoading:!1,canCheckUserIds:i})})).catch((function(e){n.setState({isMembersListLoading:!1}),n.handleError(e)}))},n.getCanCheckUserIds=function(e){var t=[];return e.forEach((function(e){e.email||t.push(e.userid)})),t},n.onChangeDepartment=function(e){if(n.setState({newUsersTempObj:{},isCheckedAll:!1,checkedDepartmentId:e}),e in n.state.membersTempObj){var t=n.getCanCheckUserIds(n.state.membersTempObj[e]);n.setState({membersList:n.state.membersTempObj[e],canCheckUserIds:t})}else n.getDingtalkDepartmentMembersList(e)},n.onUserChecked=function(e){if(-1!==n.state.canCheckUserIds.indexOf(e.userid)){var t=n.state.newUsersTempObj;e.userid in t?(delete t[e.userid],n.state.isCheckedAll&&n.setState({isCheckedAll:!1})):(t[e.userid]=e,Object.keys(t).length===n.state.canCheckUserIds.length&&n.setState({isCheckedAll:!0})),n.setState({newUsersTempObj:t})}},n.onAllUsersChecked=function(){n.setState({isCheckedAll:!n.state.isCheckedAll},(function(){if(n.state.isCheckedAll){for(var e={},t=n.state.membersList.filter((function(e){return-1!==n.state.canCheckUserIds.indexOf(e.userid)})),r=0;r<t.length;r++)e[t[r].userid]=t[r];n.setState({newUsersTempObj:e})}else n.setState({newUsersTempObj:{}})}))},n.onSubmit=function(){var e=n.state.newUsersTempObj;if("{}"!==JSON.stringify(e)){var t=[];for(var r in e)t.push(e[r]);0!==t.length?D.e.adminAddDingtalkUsersBatch(t).then((function(e){if(n.setState({newUsersTempObj:{},isCheckedAll:!1}),e.data.success&&n.handleSubmitSuccess(e.data.success),e.data.failed)for(var t=e.data.failed,r=0;r<t.length;r++)w.A.danger(t[r].name+" "+t[r].error_msg,{duration:3})})).catch((function(e){n.handleError(e)})):w.A.danger("\u672a\u9009\u62e9\u6210\u5458",{duration:3})}},n.handleSubmitSuccess=function(e){for(var t=n.state,r=t.membersTempObj,i=t.membersList,s=t.canCheckUserIds,a=0;a<e.length;a++){var o=e[a],l=o.userid,c=o.name,d=o.email;w.A.success(c+" \u6210\u529f\u5bfc\u5165",{duration:1}),-1!==s.indexOf(l)&&s.splice(s.indexOf(l),1);for(var h=0;h<i.length;h++)if(i[h].userid===l){i[h].email=d;break}for(var u in r)for(var g=0;g<r[u].length;g++)if(r[u][g].userid===l){r[u][g].email=d;break}}n.setState({membersTempObj:r,membersList:i,canCheckUserIds:s})},n.importDepartmentDialogToggle=function(e){n.setState({isImportDepartmentDialogShow:!n.state.isImportDepartmentDialogShow,importDepartment:e},(function(){e&&n.getDingtalkDepartmentsList(e.id)}))},n.onImportDepartmentSubmit=function(){var e=n.state.importDepartment;e&&D.e.adminImportDingtalkDepartment(e.id).then((function(t){n.setState({isMembersListLoading:!0,checkedDepartmentId:e.id,membersTempObj:{},membersList:[],newUsersTempObj:{},isCheckedAll:!1,canCheckUserIds:[]}),n.getDingtalkDepartmentMembersList(e.id),n.importDepartmentDialogToggle(null),t.data.success&&n.handleImportDepartmentSubmitSuccess(t.data.success),t.data.failed&&n.handleImportDepartmentSubmitFailed(t.data.failed)})).catch((function(e){n.handleError(e)}))},n.handleImportDepartmentSubmitSuccess=function(e){for(var t=0,n=e.length;t<n;t++){var r=e[t],i="department"===r.type?"\u90e8\u95e8 "+r.department_name+" \u5bfc\u5165\u6210\u529f":r.api_user_name+" \u5bfc\u5165\u6210\u529f";w.A.success(i,{duration:3})}},n.handleImportDepartmentSubmitFailed=function(e){for(var t=0,n=e.length;t<n;t++){var r=e[t],i="department"===r.type?r.department_name:r.api_user_name;w.A.danger(i+" "+r.msg,{duration:3})}},n.handleError=function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)},n.state={isTreeLoading:!0,isMembersListLoading:!0,departmentsTree:[],checkedDepartmentId:0,membersTempObj:{},membersList:[],newUsersTempObj:{},isCheckedAll:!1,canCheckUserIds:[],isImportDepartmentDialogShow:!1,importDepartment:null,importDepartmentChildrenCount:0,importDepartmentMembersCount:0},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){this.getDingtalkDepartmentsList(null)}},{key:"render",value:function(){var e=this.state,t=e.isImportDepartmentDialogShow,n=e.isTreeLoading,i=e.importDepartment,s=e.importDepartmentChildrenCount,a=e.importDepartmentMembersCount,o=!(!m.am||!t||n||!i);return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)((0,r.A)({},this.props),{},{children:(0,A.jsx)(S.A,{className:"operation-item",onClick:this.onSubmit,children:"\u5bfc\u5165\u7528\u6237"})})),(0,A.jsx)("div",{className:"main-panel-center",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)("div",{className:"cur-view-path",children:(0,A.jsx)("h3",{className:"sf-heading",children:"\u9489\u9489\u96c6\u6210"})}),(0,A.jsxs)("div",{className:"cur-view-content d-flex flex-row",children:[(0,A.jsx)(ps,{departmentsTree:this.state.departmentsTree,isTreeLoading:this.state.isTreeLoading,onChangeDepartment:this.onChangeDepartment,checkedDepartmentId:this.state.checkedDepartmentId,importDepartmentDialogToggle:this.importDepartmentDialogToggle}),(0,A.jsx)("div",{className:"dir-content-resize"}),(0,A.jsx)(ds,{isMembersListLoading:this.state.isMembersListLoading,membersList:this.state.membersList,checkedDepartmentId:this.state.checkedDepartmentId,newUsersTempObj:this.state.newUsersTempObj,onUserChecked:this.onUserChecked,onAllUsersChecked:this.onAllUsersChecked,isCheckedAll:this.state.isCheckedAll,canCheckUserIds:this.state.canCheckUserIds})]})]})}),o&&(0,A.jsx)(ms,{importDepartmentDialogToggle:this.importDepartmentDialogToggle,onImportDepartmentSubmit:this.onImportDepartmentSubmit,departmentsCount:s,membersCount:a,departmentName:i.name})]})}}])}(l.Component),xs=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.getPreviousPage=function(){n.props.getItemsByPage(n.props.currentPage-1)},n.getNextPage=function(){n.props.getItemsByPage(n.props.currentPage+1)},n.state={isItemFreezed:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,i=t.items,s=t.curPerPage,a=t.hasNextPage,o=t.currentPage;if(n)return(0,A.jsx)(I.A,{});if(r)return(0,A.jsx)("p",{className:"error text-center mt-4",children:r});var c=(0,A.jsx)(ie.A,{text:(0,m.AP)("No invitations")}),d=(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("table",{children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"20%",children:(0,m.AP)("Inviter")}),(0,A.jsx)("th",{width:"20%",children:(0,m.AP)("Accepter")}),(0,A.jsx)("th",{width:"9%",children:(0,m.AP)("Type")}),(0,A.jsx)("th",{width:"14%",children:(0,m.AP)("Invited at")}),(0,A.jsx)("th",{width:"14%",children:(0,m.AP)("Accepted at")}),(0,A.jsx)("th",{width:"18%",children:(0,m.AP)("Expired at")}),(0,A.jsx)("th",{width:"5%"})]})}),(0,A.jsx)("tbody",{children:i.map((function(t,n){return(0,A.jsx)(vs,{item:t,isItemFreezed:e.state.isItemFreezed,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem,deleteItem:e.props.deleteItem},n)}))})]}),(0,A.jsx)(X.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:o,hasNextPage:a,curPerPage:s,resetPerPage:this.props.resetPerPage})]});return i.length?d:c}}])}(l.Component),vs=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleMouseEnter=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!0,highlight:!0})},n.handleMouseLeave=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!1,highlight:!1})},n.onUnfreezedItem=function(){n.setState({highlight:!1,isOpIconShow:!1}),n.props.onUnfreezedItem()},n.deleteItem=function(){n.props.deleteItem(n.props.item)},n.translateOperations=function(e){var t="";if("Delete"===e)t=(0,m.AP)("Delete");return t},n.onMenuItemClick=function(e){if("Delete"===e)n.deleteItem()},n.getInviteTypeText=function(){var e="";switch(n.props.item.invite_type){case"Guest":case"guest":e=(0,m.AP)("Guest");break;case"Default":case"default":e=(0,m.AP)("Default")}return e},n.state={isOpIconShown:!1,highlight:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.item,t=this.state.isOpIconShown;return(0,A.jsx)(l.Fragment,{children:(0,A.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,A.jsx)("td",{children:(0,A.jsx)(ue,{email:e.inviter_email,name:e.inviter_name})}),(0,A.jsx)("td",{children:e.accept_time?(0,A.jsx)(ue,{email:e.accepter_email,name:e.accepter_name}):e.accepter_email}),(0,A.jsx)("td",{children:this.getInviteTypeText()}),(0,A.jsx)("td",{children:(0,A.jsx)("span",{title:C()(e.invite_time).format("llll"),children:C()(e.invite_time).fromNow()})}),(0,A.jsx)("td",{children:e.accept_time?(0,A.jsx)("span",{title:C()(e.accept_time).format("llll"),children:C()(e.accept_time).fromNow()}):"--"}),(0,A.jsx)("td",{children:e.is_expired?(0,A.jsx)("span",{className:"text-red",children:C()(e.expire_time).format("YYYY-MM-DD HH:mm")}):C()(e.expire_time).format("YYYY-MM-DD HH:mm")}),(0,A.jsx)("td",{children:t&&(0,A.jsx)(He.A,{operations:["Delete"],translateOperations:this.translateOperations,onMenuItemClick:this.onMenuItemClick,onFreezedItem:this.props.onFreezedItem,onUnfreezedItem:this.onUnfreezedItem})})]})})}}])}(l.Component),As=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).getItemsByPage=function(e){var t=n.state.perPage;D.e.sysAdminListInvitations(e,t).then((function(r){n.setState({loading:!1,items:r.data.invitation_list,hasNextPage:f.Aq.hasNextPage(e,t,r.data.total_count),currentPage:e})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.deleteItem=function(e){var t=e.token;D.e.sysAdminDeleteInvitation(t).then((function(e){var r=n.state.items.filter((function(e){return e.token!=t}));n.setState({items:r}),w.A.success((0,m.AP)("Successfully deleted 1 item."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.deleteItemInBatch=function(){D.e.sysAdminDeleteExpiredInvitations().then((function(e){var t=n.state.items,r=n.state.items.filter((function(e){return!e.is_expired||e.accept_time}));r.length<t.length&&(n.setState({items:r}),w.A.success((0,m.AP)("Operation succeeded.")))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){n.getItemsByPage(1)}))},n.state={loading:!0,errorMsg:"",items:[],totalItemCount:0,hasNextPage:!1,currentPage:1,perPage:25},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,r=n.currentPage,i=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||i),currentPage:parseInt(t.get("page")||r)},(function(){e.getItemsByPage(e.state.currentPage)}))}},{key:"render",value:function(){return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)((0,r.A)({},this.props),{},{children:(0,A.jsx)(S.A,{className:"btn btn-secondary operation-item",onClick:this.deleteItemInBatch,children:(0,m.AP)("Delete Expired Invitations")})})),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)("div",{className:"cur-view-path",children:(0,A.jsx)("h3",{className:"sf-heading",children:(0,m.AP)("Invitations")})}),(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsx)(xs,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.items,currentPage:this.state.currentPage,hasNextPage:this.state.hasNextPage,curPerPage:this.state.perPage,resetPerPage:this.resetPerPage,getItemsByPage:this.getItemsByPage,deleteItem:this.deleteItem})})]})})]})}}])}(l.Component),Ps=n(67604),ys=n(92203),bs=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).onKeyDown=function(e){e.stopPropagation()},n.toggle=function(){if(n.state.isValueChanged){var e=n.getCurrentContent();n.props.onCommit(e)}n.props.onCloseEditorDialog()},n.onContentChanged=function(){return n.setState({isValueChanged:!0})},n.getCurrentContent=function(){return n.editorRef.current.getValue()},n.setSimpleEditorRef=function(e){n.simpleEditor=e},n.state={isValueChanged:!1},n.editorRef=l.createRef(),n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props,t=e.content,n=e.title;return(0,A.jsxs)(u.A,{isOpen:!0,toggle:this.toggle,onKeyDown:this.onKeyDown,wrapClassName:"conditions-editor-dialog-wrapper",className:"conditions-editor-dialog",contentClassName:"conditions-editor-dialog-content",size:"lg",style:{width:770},children:[(0,A.jsx)(be.A,{className:"conditions-editor-dialog-title",toggle:this.toggle,children:n}),(0,A.jsx)(je.A,{className:"conditions-editor-dialog-main",children:(0,A.jsx)(ys.SimpleEditor,{ref:this.editorRef,value:t||"",onContentChanged:this.onContentChanged})})]})}}])}(l.Component);bs.defaultProps={title:(0,m.AP)("Terms")};var js=bs,Ss=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleNameChange=function(e){n.setState({name:e.target.value})},n.handleVersionNumberChange=function(e){n.setState({versionNumber:e.target.value.trim()})},n.handleTextChange=function(e){n.setState({text:e.target.value.trim()})},n.setActive=function(){n.setState({isActive:!0})},n.setInActive=function(){n.setState({isActive:!1})},n.addTerm=function(){var e=n.state,t=e.name,r=e.versionNumber,i=e.text,s=e.isActive;""!==t?""!==r?isNaN(r)?n.setState({errMsg:(0,m.AP)("Version Number must be a number.")}):""!==i?n.props.isUpdate?n.props.updateTerm(t,r,i,s):n.props.addTerm(t,r,i,s):n.setState({errMsg:(0,m.AP)("Text is required.")}):n.setState({errMsg:(0,m.AP)("Version Number is required.")}):n.setState({errMsg:(0,m.AP)("Name is required.")})},n.onContentClick=function(){n.setState({isConditionsEditorDialogShow:!n.state.isConditionsEditorDialogShow})},n.onCloseEditorDialog=function(){n.setState({isConditionsEditorDialogShow:!1})},n.onUpdateContent=function(e){n.setState({text:e})},n.state={name:"",versionNumber:"",text:"",isActive:!0,errorMsg:"",isConditionsEditorDialogShow:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this.props.oldTermObj;e&&this.setState({name:e.name,versionNumber:e.version_number,text:e.text,isActive:!(""===e.activate_time)})}},{key:"render",value:function(){var e=this.props.isUpdate?(0,m.AP)("Update Terms and Conditions"):(0,m.AP)("Add Terms and Conditions");return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)(u.A,{isOpen:!0,toggle:this.props.toggle,children:[(0,A.jsx)(be.A,{toggle:this.props.toggle,children:e}),(0,A.jsxs)(je.A,{children:[(0,A.jsxs)(ke.A,{children:[(0,A.jsx)(_e.A,{for:"name",children:(0,m.AP)("Name")}),(0,A.jsx)(W.A,{id:"name",value:this.state.name,onChange:this.handleNameChange})]}),(0,A.jsxs)(ke.A,{children:[(0,A.jsx)(_e.A,{children:(0,m.AP)("Version Number")}),(0,A.jsx)(W.A,{value:this.state.versionNumber,onChange:this.handleVersionNumberChange})]}),(0,A.jsxs)(ke.A,{className:"form-content",children:[(0,A.jsx)(_e.A,{children:(0,m.AP)("Text")}),(0,A.jsx)(Ps.A,{content:this.state.text,onContentClick:this.onContentClick})]}),(0,A.jsxs)(ke.A,{tag:"fieldset",children:[(0,A.jsx)(_e.A,{children:(0,m.AP)("Activated")}),(0,A.jsx)(ke.A,{check:!0,children:(0,A.jsxs)(_e.A,{check:!0,children:[(0,A.jsx)(W.A,{type:"radio",checked:this.state.isActive,onChange:this.setActive})," ",(0,m.AP)("On")]})}),(0,A.jsx)(ke.A,{check:!0,children:(0,A.jsxs)(_e.A,{check:!0,children:[(0,A.jsx)(W.A,{type:"radio",checked:!this.state.isActive,onChange:this.setInActive})," ",(0,m.AP)("Off")]})})]}),this.state.errMsg&&(0,A.jsx)(Se.A,{color:"danger",children:this.state.errMsg})]}),(0,A.jsx)(De.A,{children:(0,A.jsx)(S.A,{color:"primary",onClick:this.addTerm,children:(0,m.AP)("Submit")})})]}),this.state.isConditionsEditorDialogShow&&(0,A.jsx)(js,{content:this.state.text,onCommit:this.onUpdateContent,onCloseEditorDialog:this.onCloseEditorDialog})]})}}])}(l.Component),Ds=Ss,ws=/\[.+\]\(\S+\)|<img src=(\S+).+\/>|!\[\]\(\S+\)|<\S+>/g,Is=/^<img src="(\S+)" .+\/>/,ks=/^!\[\]\((\S+)\)/,_s=/^\[.+\]\(\S+\)/,Ns=/^<\S+>$/,Ms=function(e){for(var t="",n=e.replace(ws,""),r=0;r<n.length&&("#"===n[r]||("\n"===n[r]?t+=" ":t+=n[r],30!==t.length));r++);var i=e.match(ws);if(i){var s=function(e){var t={links:[],images:[]};return e.forEach((function(e){if(e.search(_s)>=0||e.search(Ns)>=0)t.links.push(e);else{var n=e.match(Is),r=e.match(ks);n?t.images.push(n[1]):r&&t.images.push(r[1])}})),t}(i);return{previewText:t,images:s.images,links:s.links}}return{previewText:t,images:[],links:[]}},Cs=function(e){function t(){var e;(0,i.A)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=(0,a.A)(this,t,[].concat(r))).toggle=function(){e.props.onClosePreviewDialog()},e}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props,t=e.title,n=e.content;return(0,A.jsxs)(u.A,{isOpen:!0,size:"lg",style:{width:600},wrapClassName:"conditions-perview-wrapper",toggle:this.toggle,children:[(0,A.jsx)(be.A,{toggle:this.toggle,children:t}),(0,A.jsx)(je.A,{children:(0,A.jsx)(Ps.A,{content:n})})]})}}])}(l.Component);Cs.defaultProps={title:(0,m.AP)("Terms")};var Os=Cs,Ls=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleMouseEnter=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!0,highlight:!0})},n.handleMouseLeave=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!1,highlight:!1})},n.toggleUpdateDialog=function(e){n.setState({isUpdateDialogOpen:!n.state.isUpdateDialogOpen})},n.toggleDeleteDialog=function(e){n.setState({isDeleteDialogOpen:!n.state.isDeleteDialogOpen})},n.toggleTermsContentDialog=function(e){n.setState({isTermsPerviewDialogOpen:!n.state.isTermsPerviewDialogOpen})},n.onMenuItemClick=function(e){switch(e){case"Update":n.toggleUpdateDialog();break;case"Delete":n.toggleDeleteDialog()}},n.onUnfreezedItem=function(){n.setState({highlight:!1,isOpIconShow:!1}),n.props.onUnfreezedItem()},n.deleteTerm=function(){n.props.deleteTerm(n.props.item.id),n.toggleDeleteDialog()},n.updateTerm=function(e,t,r,i){n.props.updateTerm(n.props.item.id,e,t,r,i),n.toggleUpdateDialog()},n.translateOperations=function(e){var t="";switch(e){case"Update":t=(0,m.AP)("Update");break;case"Delete":t=(0,m.AP)("Delete")}return t},n.state={itemContent:"...",isOpIconShown:!1,isUpdateDialogOpen:!1,isDeleteDialogOpen:!1,isTermsPerviewDialogOpen:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.item.text;ys.processor.process(t).then((function(t){var n=String(t);e.setState({itemContent:n})}))}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this;if(e.item.text!==this.props.item.text){var n=e.item.text;ys.processor.process(n).then((function(e){var n=String(e);t.setState({itemContent:n})}))}}},{key:"render",value:function(){var e=this.props.item,t=this.state,n=t.isDeleteDialogOpen,r=t.isUpdateDialogOpen,i=t.isTermsPerviewDialogOpen,s=Ms(e.text),a='<span class="op-target">'+f.Aq.HTMLescape(e.name)+"</span>",o=(0,m.AP)("Are you sure you want to delete {placeholder} ?").replace("{placeholder}",a);return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("tr",{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,A.jsx)("td",{children:e.name}),(0,A.jsx)("td",{children:e.version_number}),(0,A.jsx)("td",{className:"ellipsis",children:(0,A.jsx)("a",{href:"#",onClick:this.toggleTermsContentDialog,children:s.previewText})}),(0,A.jsx)("td",{children:C()(e.ctime).fromNow()}),(0,A.jsx)("td",{children:e.activate_time?C()(e.activate_time).fromNow():"--"}),(0,A.jsx)("td",{children:this.state.isOpIconShown&&(0,A.jsx)(He.A,{operations:["Update","Delete"],translateOperations:this.translateOperations,onMenuItemClick:this.onMenuItemClick,onFreezedItem:this.props.onFreezedItem,onUnfreezedItem:this.onUnfreezedItem})})]}),n&&(0,A.jsx)(Kt.A,{children:(0,A.jsx)(Ee.A,{title:(0,m.AP)("Delete T&C"),message:o,toggleDialog:this.toggleDeleteDialog,executeOperation:this.deleteTerm,confirmBtnText:(0,m.AP)("Delete")})}),r&&(0,A.jsx)(Kt.A,{children:(0,A.jsx)(Ds,{updateTerm:this.updateTerm,toggle:this.toggleUpdateDialog,isUpdate:!0,oldTermObj:e})}),i&&(0,A.jsx)(Kt.A,{children:(0,A.jsx)(Os,{content:e.text,onClosePreviewDialog:this.toggleTermsContentDialog})})]})}}])}(l.Component),Ts=Ls,Fs=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.state={isItemFreezed:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,i=t.items;if(n)return(0,A.jsx)(I.A,{});if(r)return(0,A.jsx)("p",{className:"error text-center",children:r});var s=(0,A.jsx)(ie.A,{text:(0,m.AP)("No terms and conditions")}),a=(0,A.jsx)(l.Fragment,{children:(0,A.jsxs)("table",{className:"table-hover",children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"20%",children:(0,m.AP)("Name")}),(0,A.jsx)("th",{width:"10%",children:(0,m.AP)("Version")}),(0,A.jsx)("th",{width:"25%",children:(0,m.AP)("Text")}),(0,A.jsx)("th",{width:"20%",children:(0,m.AP)("Created")}),(0,A.jsx)("th",{width:"20%",children:(0,m.AP)("Activated")}),(0,A.jsx)("th",{width:"5%"})]})}),i&&(0,A.jsx)("tbody",{children:i.map((function(t,n){return(0,A.jsx)(Ts,{item:t,isItemFreezed:e.state.isItemFreezed,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem,deleteTerm:e.props.deleteTerm,updateTerm:e.props.updateTerm},n)}))})]})});return i.length?a:s}}])}(l.Component),Rs=Fs,Es=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleAddTermDialog=function(){n.setState({isAddTermDialogOpen:!n.state.isAddTermDialogOpen})},n.addTerm=function(e,t,n,r){D.e.sysAdminAddTermAndCondition(e,t,n,r).then((function(e){location.reload()})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.updateTerm=function(e,t,r,i,s){D.e.sysAdminUpdateTermAndCondition(e,t,r,i,s).then((function(t){var r=n.state.termList.map((function(n){return n.id==e?t.data:n}));n.setState({termList:r}),w.A.success((0,m.AP)("Update succeeded."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.deleteTerm=function(e){D.e.sysAdminDeleteTermAndCondition(e).then((function(t){var r=n.state.termList.filter((function(t){return t.id!=e}));n.setState({termList:r}),w.A.success((0,m.AP)("Successfully deleted 1 item."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);w.A.danger(t)}))},n.state={loading:!0,errorMsg:"",termList:[],isAddTermDialogOpen:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this;D.e.sysAdminListTermsAndConditions().then((function(t){e.setState({termList:t.data.term_and_condition_list,loading:!1})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this.state,t=e.termList,n=e.isAddTermDialogOpen;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)((0,r.A)({},this.props),{},{children:(0,A.jsx)(S.A,{className:"btn btn-secondary operation-item",onClick:this.toggleAddTermDialog,children:(0,m.AP)("Add")})})),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)("div",{className:"cur-view-path",children:(0,A.jsx)("h3",{className:"sf-heading",children:(0,m.AP)("Terms and Conditions")})}),(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsx)(Rs,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:t,deleteTerm:this.deleteTerm,updateTerm:this.updateTerm})})]})}),n&&(0,A.jsx)(Kt.A,{children:(0,A.jsx)(Ds,{isUpdate:!1,addTerm:this.addTerm,toggle:this.toggleAddTermDialog})})]})}}])}(l.Component),Us=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).navItems=[{name:"all",urlPart:"all",text:(0,m.AP)("All")},{name:"unhandled",urlPart:"unhandled",text:(0,m.AP)("Unhandled")}],n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.currentItem;return(0,A.jsx)("div",{className:"cur-view-path tab-nav-container",children:(0,A.jsx)("ul",{className:"nav",children:this.navItems.map((function(t,n){return(0,A.jsx)("li",{className:"nav-item",children:(0,A.jsx)(g.N_,{to:"".concat(m.Yc,"sys/virus-files/").concat(t.urlPart,"/"),className:"nav-link".concat(e==t.name?" active":""),children:t.text})},n)}))})})}}])}(l.Component),zs=Us,Bs=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleMouseEnter=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!0,highlight:!0})},n.handleMouseLeave=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!1,highlight:!1})},n.onUnfreezedItem=function(){n.setState({highlight:!1,isOpIconShow:!1}),n.props.onUnfreezedItem()},n.onMenuItemClick=function(e){n.props.handleFile(n.props.virusFile.virus_id,e)},n.translateOperations=function(e){var t="";switch(e){case"delete":t=(0,m.AP)("Delete");break;case"ignore":t=(0,m.AP)("Ignore");break;case"do-not-ignore":t=(0,m.AP)("Don't ignore")}return t},n.state={highlight:!1,isOpIconShown:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.virusFile,t="",n=[];return e.has_deleted?t=(0,A.jsx)("span",{className:"text-green",children:(0,m.AP)("Deleted")}):e.has_ignored?(t=(0,A.jsx)("span",{className:"text-orange",children:(0,m.AP)("Ignored")}),n=["do-not-ignore"]):(t=(0,A.jsx)("span",{className:"text-red",children:(0,m.AP)("Unhandled")}),n=["delete","ignore"]),(0,A.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,A.jsx)("td",{children:e.repo_name}),(0,A.jsx)("td",{children:e.repo_owner}),(0,A.jsx)("td",{children:e.file_path}),(0,A.jsx)("td",{children:t}),(0,A.jsx)("td",{children:n.length>0&&this.state.isOpIconShown&&(0,A.jsx)(He.A,{operations:n,translateOperations:this.translateOperations,onMenuItemClick:this.onMenuItemClick,onFreezedItem:this.props.onFreezedItem,onUnfreezedItem:this.onUnfreezedItem})})]})}}])}(l.Component),qs=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.getPreviousPage=function(){n.props.getListByPage(n.props.currentPage-1)},n.getNextPage=function(){n.props.getListByPage(n.props.currentPage+1)},n.state={isItemFreezed:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,i=t.virusFiles,s=t.curPerPage,a=t.hasNextPage,o=t.currentPage;return n?(0,A.jsx)(I.A,{}):r?(0,A.jsx)("p",{className:"error text-center mt-4",children:r}):(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("table",{children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"27%",children:(0,m.AP)("Library")}),(0,A.jsx)("th",{width:"25%",children:(0,m.AP)("Owner")}),(0,A.jsx)("th",{width:"28%",children:(0,m.AP)("Virus File")}),(0,A.jsx)("th",{width:"15%",children:(0,m.AP)("Status")}),(0,A.jsx)("th",{width:"5%"})]})}),(0,A.jsx)("tbody",{children:i.map((function(t,n){return(0,A.jsx)(Bs,{virusFile:t,isItemFreezed:e.state.isItemFreezed,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem,handleFile:e.props.handleFile},n)}))})]}),i.length>0&&(0,A.jsx)(X.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:o,hasNextPage:a,curPerPage:s,resetPerPage:this.props.resetPerPage})]})}}])}(l.Component),Ys=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).getListByPage=function(e){var t=n.state.perPage;D.e.listVirusFiles(e,t).then((function(e){var t=e.data;n.setState({loading:!1,virusFiles:t.virus_file_list,hasNextPage:t.has_next_page})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){n.getListByPage(1)}))},n.handleFile=function(e,t){var r;switch(t){case"delete":r=D.e.deleteVirusFile(e);break;case"ignore":r=D.e.toggleIgnoreVirusFile(e,!0);break;case"do-not-ignore":r=D.e.toggleIgnoreVirusFile(e,!1)}r.then((function(r){n.setState({virusFiles:n.state.virusFiles.map((function(n){return n.virus_id==e&&("delete"==t?n.has_deleted=!0:n=r.data.virus_file),n}))})})).catch((function(e){w.A.danger(f.Aq.getErrorMsg(e))}))},n.state={loading:!0,errorMsg:"",virusFiles:[],currentPage:1,perPage:25,hasNextPage:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,r=n.currentPage,i=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||i),currentPage:parseInt(t.get("page")||r)},(function(){e.getListByPage(e.state.currentPage)}))}},{key:"render",value:function(){return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)({},this.props)),(0,A.jsx)("div",{className:"main-panel-center",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)(zs,{currentItem:"all"}),(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsx)(qs,{loading:this.state.loading,errorMsg:this.state.errorMsg,virusFiles:this.state.virusFiles,currentPage:this.state.currentPage,hasNextPage:this.state.hasNextPage,curPerPage:this.state.perPage,resetPerPage:this.resetPerPage,getListByPage:this.getListByPage,handleFile:this.handleFile})})]})})]})}}])}(l.Component),Vs=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).handleMouseEnter=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!0,highlight:!0})},n.handleMouseLeave=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!1,highlight:!1})},n.onUnfreezedItem=function(){n.setState({highlight:!1,isOpIconShow:!1}),n.props.onUnfreezedItem()},n.onMenuItemClick=function(e){n.props.handleFile(n.props.virusFile.virus_id,e)},n.translateOperations=function(e){var t="";switch(e){case"delete":t=(0,m.AP)("Delete");break;case"ignore":t=(0,m.AP)("Ignore");break;case"do-not-ignore":t=(0,m.AP)("Don't ignore")}return t},n.toggleItemSelected=function(e){n.props.toggleItemSelected(n.props.virusFile,e.target.checked)},n.state={highlight:!1,isOpIconShown:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.virusFile,t="",n=[];return e.has_deleted?t=(0,A.jsx)("span",{className:"text-green",children:(0,m.AP)("Deleted")}):e.has_ignored?(t=(0,A.jsx)("span",{className:"text-orange",children:(0,m.AP)("Ignored")}),n=["do-not-ignore"]):(t=(0,A.jsx)("span",{className:"text-red",children:(0,m.AP)("Unhandled")}),n=["delete","ignore"]),(0,A.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,A.jsx)("td",{className:"text-center",children:(0,A.jsx)("input",{type:"checkbox",checked:e.isSelected,onChange:this.toggleItemSelected})}),(0,A.jsx)("td",{children:e.repo_name}),(0,A.jsx)("td",{children:e.repo_owner}),(0,A.jsx)("td",{children:e.file_path}),(0,A.jsx)("td",{children:t}),(0,A.jsx)("td",{children:n.length>0&&this.state.isOpIconShown&&(0,A.jsx)(He.A,{operations:n,translateOperations:this.translateOperations,onMenuItemClick:this.onMenuItemClick,onFreezedItem:this.props.onFreezedItem,onUnfreezedItem:this.onUnfreezedItem})})]})}}])}(l.Component),Hs=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.getPreviousPage=function(){n.props.getListByPage(n.props.currentPage-1)},n.getNextPage=function(){n.props.getListByPage(n.props.currentPage+1)},n.state={isItemFreezed:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,i=t.virusFiles,s=t.curPerPage,a=t.hasNextPage,o=t.currentPage,c=t.isAllItemsSelected;return n?(0,A.jsx)(I.A,{}):r?(0,A.jsx)("p",{className:"error text-center mt-4",children:r}):(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("table",{children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"3%",className:"text-center",children:(0,A.jsx)("input",{type:"checkbox",checked:c,onChange:this.props.toggleAllSelected})}),(0,A.jsx)("th",{width:"24%",children:(0,m.AP)("Library")}),(0,A.jsx)("th",{width:"25%",children:(0,m.AP)("Owner")}),(0,A.jsx)("th",{width:"28%",children:(0,m.AP)("Virus File")}),(0,A.jsx)("th",{width:"15%",children:(0,m.AP)("Status")}),(0,A.jsx)("th",{width:"5%"})]})}),(0,A.jsx)("tbody",{children:i.map((function(t,n){return(0,A.jsx)(Vs,{virusFile:t,isItemFreezed:e.state.isItemFreezed,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem,handleFile:e.props.handleFile,toggleItemSelected:e.props.toggleItemSelected},n)}))})]}),i.length>0&&(0,A.jsx)(X.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:o,hasNextPage:a,curPerPage:s,resetPerPage:this.props.resetPerPage})]})}}])}(l.Component),Ws=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).getListByPage=function(e){var t=n.state.perPage;D.e.listVirusFiles(e,t,!1).then((function(e){var t=e.data,r=t.virus_file_list.map((function(e){return e.isSelected=!1,e}));n.setState({loading:!1,virusFiles:r,hasNextPage:t.has_next_page})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){n.getListByPage(1)}))},n.handleFile=function(e,t){var r;switch(t){case"delete":r=D.e.deleteVirusFile(e);break;case"ignore":r=D.e.toggleIgnoreVirusFile(e,!0);break;case"do-not-ignore":r=D.e.toggleIgnoreVirusFile(e,!1)}r.then((function(r){n.setState({virusFiles:n.state.virusFiles.map((function(n){return n.virus_id==e&&("delete"==t?n.has_deleted=!0:n=r.data.virus_file),n}))})})).catch((function(e){w.A.danger(f.Aq.getErrorMsg(e))}))},n.toggleAllSelected=function(){n.setState((function(e){return{isAllItemsSelected:!e.isAllItemsSelected,virusFiles:n.state.virusFiles.map((function(t){return t.isSelected=!e.isAllItemsSelected,t}))}}))},n.toggleItemSelected=function(e,t){n.setState({virusFiles:n.state.virusFiles.map((function(n){return n===e&&(n.isSelected=t),n}))},(function(){n.setState({isAllItemsSelected:!n.state.virusFiles.some((function(e){return!e.isSelected}))})}))},n.handleSelectedItems=function(e){var t=n.state.virusFiles.filter((function(t){return"delete-virus"==e?t.isSelected&&!t.has_deleted:t.isSelected&&!t.has_ignored})).map((function(e){return e.virus_id}));D.e.batchProcessVirusFiles(t,e).then((function(t){var r=n.state.virusFiles;t.data.success.forEach((function(t){var n=r.find((function(e){return e.virus_id==t.virus_id}));"delete-virus"==e?n.has_deleted=!0:n.has_ignored=!0})),n.setState({virusFiles:r}),t.data.failed.forEach((function(t){var n=r.find((function(e){return e.virus_id==t.virus_id})),i="delete-virus"==e?(0,m.AP)("Failed to delete %(virus_file) from library %(library): %(error_msg)"):(0,m.AP)("Failed to ignore %(virus_file) from library %(library): %(error_msg)");i=i.replace("%(virus_file)",n.file_path).replace("%(library)",n.repo_name).replace("%(error_msg)",t.error_msg),w.A.danger(i)}))})).catch((function(e){w.A.danger(f.Aq.getErrorMsg(e))}))},n.deleteSelectedItems=function(){n.handleSelectedItems("delete-virus")},n.ignoreSelectedItems=function(){n.handleSelectedItems("ignore-virus")},n.state={loading:!0,errorMsg:"",virusFiles:[],isAllItemsSelected:!1,selectedItems:[],currentPage:1,perPage:25,hasNextPage:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,r=n.currentPage,i=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||i),currentPage:parseInt(t.get("page")||r)},(function(){e.getListByPage(e.state.currentPage)}))}},{key:"render",value:function(){return(0,A.jsxs)(l.Fragment,{children:[this.state.virusFiles.some((function(e){return e.isSelected}))?(0,A.jsx)(k.A,(0,r.A)((0,r.A)({},this.props),{},{children:(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(S.A,{onClick:this.deleteSelectedItems,className:"operation-item",children:(0,m.AP)("Delete")}),(0,A.jsx)(S.A,{onClick:this.ignoreSelectedItems,className:"operation-item",children:(0,m.AP)("Ignore")})]})})):(0,A.jsx)(k.A,(0,r.A)({},this.props)),(0,A.jsx)("div",{className:"main-panel-center",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)(zs,{currentItem:"unhandled"}),(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsx)(Hs,{loading:this.state.loading,errorMsg:this.state.errorMsg,virusFiles:this.state.virusFiles,currentPage:this.state.currentPage,hasNextPage:this.state.hasNextPage,curPerPage:this.state.perPage,resetPerPage:this.resetPerPage,getListByPage:this.getListByPage,handleFile:this.handleFile,isAllItemsSelected:this.state.isAllItemsSelected,toggleAllSelected:this.toggleAllSelected,toggleItemSelected:this.toggleItemSelected})})]})})]})}}])}(l.Component),Gs=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).navItems=[{name:"adminOperationLogs",urlPart:"admin-logs/operation",text:(0,m.AP)("Admin Operation Logs")},{name:"adminLoginLogs",urlPart:"admin-logs/login",text:(0,m.AP)("Admin Login Logs")}],n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.currentItem;return(0,A.jsx)("div",{className:"cur-view-path tab-nav-container",children:(0,A.jsx)("ul",{className:"nav",children:this.navItems.map((function(t,n){return(0,A.jsx)("li",{className:"nav-item",children:(0,A.jsx)(g.N_,{to:"".concat(m.Yc,"sys/").concat(t.urlPart,"/"),className:"nav-link".concat(e==t.name?" active":""),children:t.text})},n)}))})})}}])}(l.Component),Qs=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).getPreviousPage=function(){n.props.getLogsByPage(n.props.currentPage-1)},n.getNextPage=function(){n.props.getLogsByPage(n.props.currentPage+1)},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg,r=e.items,i=e.perPage,s=e.currentPage,a=e.hasNextPage;if(t)return(0,A.jsx)(I.A,{});if(n)return(0,A.jsx)("p",{className:"error text-center",children:n});var o=(0,A.jsx)(ie.A,{text:(0,m.AP)("No Admin operation logs")}),c=(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("table",{className:"table-hover",children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"20%",children:(0,m.AP)("Name")}),(0,A.jsx)("th",{width:"15%",children:(0,m.AP)("Operation")}),(0,A.jsx)("th",{width:"50%",children:(0,m.AP)("Detail")}),(0,A.jsx)("th",{width:"15%",children:(0,m.AP)("Time")})]})}),r&&(0,A.jsx)("tbody",{children:r.map((function(e,t){return(0,A.jsx)(Ks,{item:e},t)}))})]}),(0,A.jsx)(X.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:s,hasNextPage:a,curPerPage:i,resetPerPage:this.props.resetPerPage})]});return r.length?c:o}}])}(l.Component),Ks=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).getOperationText=function(e){switch(e){case"repo_create":return(0,m.AP)("Create Library");case"repo_delete":return(0,m.AP)("Delete Library");case"repo_transfer":return(0,m.AP)("Transfer Library");case"group_create":return(0,m.AP)("Create Group");case"group_transfer":return(0,m.AP)("Transfer Group");case"group_delete":return(0,m.AP)("Delete Group");case"user_add":return(0,m.AP)("Add User");case"user_delete":return(0,m.AP)("Delete User");default:return""}},n.getOperationDetail=function(e){var t=e.detail,n="";t.owner&&(n=m.Yc+"sys/users/"+encodeURIComponent(t.owner)+"/");var r="";t.email&&(r=m.Yc+"sys/users/"+encodeURIComponent(t.email)+"/");var i="",s="",a="";switch("repo_create"!=e.operation&&"repo_delete"!=e.operation&&"repo_transfer"!=e.operation||(s=m.Yc+"sys/libraries/"+t.id+"/"+encodeURIComponent(t.name)+"/"),"group_create"!=e.operation&&"group_delete"!=e.operation&&"group_transfer"!=e.operation||(a=m.Yc+"sys/groups/"+t.id+"/libraries/"),e.operation){case"repo_create":return i=(0,m.AP)("Created library {library_name} with {owner} as its owner").replace("{owner}",'<a href="'+n+'">'+t.owner+"</a>"),i=m.am&&m.ZD?i.replace("{library_name}",'<a href="'+s+'">'+t.name+"</a>"):i.replace("{library_name}",'<span class="font-weight-bold">'+t.name+"</span>");case"repo_delete":return i=(0,m.AP)("Deleted library {library_name}").replace("{library_name}",'<span class="font-weight-bold">'+t.name+"</span>");case"repo_transfer":return i=(0,m.AP)("Transferred library {library_name} from {user_from} to {user_to}").replace("{user_from}",'<span class="font-weight-bold">'+t.from+"</span>").replace("{user_to}",'<span class="font-weight-bold">'+t.to+"</span>"),i=m.am&&m.ZD?i.replace("{library_name}",'<a href="'+s+'">'+t.name+"</a>"):i.replace("{library_name}",'<span class="font-weight-bold">'+t.name+"</span>");case"group_create":return i=(0,m.AP)("Created group {group_name}").replace("{group_name}",'<a href="'+a+'">'+t.name+"</a>");case"group_transfer":return i=(0,m.AP)("Transferred group {group_name} from {user_from} to {user_to}").replace("{user_from}",'<span class="font-weight-bold">'+t.from+"</span>").replace("{user_to}",'<span class="font-weight-bold">'+t.to+"</span>").replace("{group_name}",'<a href="'+a+'">'+t.name+"</a>");case"group_delete":return i=(0,m.AP)("Deleted group {group_name}").replace("{group_name}",'<span class="font-weight-bold">'+t.name+"</span>");case"user_add":return i=(0,m.AP)("Added user {user}").replace("{user}",'<a href="'+r+'">'+t.email+"</a>");case"user_delete":return i=(0,m.AP)("Deleted user {user}").replace("{user}",'<span class="font-weight-bold">'+t.email+"</span>");default:return""}},n.state={isOpIconShown:!1},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.item;return(0,A.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,children:[(0,A.jsx)("td",{children:(0,A.jsx)(ue,{email:e.email,name:e.name})}),(0,A.jsx)("td",{children:this.getOperationText(e.operation)}),(0,A.jsx)("td",{children:(0,A.jsx)("span",{dangerouslySetInnerHTML:{__html:this.getOperationDetail(e)}})}),(0,A.jsx)("td",{children:C()(e.datetime).fromNow()})]})}}])}(l.Component),Xs=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).getLogsByPage=function(e){var t=n.state.perPage;D.e.sysAdminListAdminLogs(e,t).then((function(r){n.setState({logList:r.data.data,loading:!1,currentPage:e,hasNextPage:f.Aq.hasNextPage(e,t,r.data.total_count)})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){return n.getLogsByPage(n.initPage)}))},n.state={loading:!0,errorMsg:"",logList:[],perPage:25,currentPage:1,hasNextPage:!1},n.initPage=1,n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,r=n.currentPage,i=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||i),currentPage:parseInt(t.get("page")||r)},(function(){e.getLogsByPage(e.state.currentPage)}))}},{key:"render",value:function(){var e=this.state,t=e.logList,n=e.currentPage,i=e.perPage,s=e.hasNextPage;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)({},this.props)),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)(Gs,{currentItem:"adminOperationLogs"}),(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsx)(Qs,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:t,currentPage:n,perPage:i,hasNextPage:s,getLogsByPage:this.getLogsByPage,resetPerPage:this.resetPerPage})})]})})]})}}])}(l.Component),$s=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).getPreviousPage=function(){n.props.getLogsByPage(n.props.currentPage-1)},n.getNextPage=function(){n.props.getLogsByPage(n.props.currentPage+1)},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg,r=e.items,i=e.perPage,s=e.currentPage,a=e.hasNextPage;if(t)return(0,A.jsx)(I.A,{});if(n)return(0,A.jsx)("p",{className:"error text-center",children:n});var o=(0,A.jsx)(ie.A,{text:(0,m.AP)("No Admin login logs")}),c=(0,A.jsxs)(l.Fragment,{children:[(0,A.jsxs)("table",{className:"table-hover",children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"25%",children:(0,m.AP)("Name")}),(0,A.jsx)("th",{width:"25%",children:(0,m.AP)("IP")}),(0,A.jsx)("th",{width:"25%",children:(0,m.AP)("Status")}),(0,A.jsx)("th",{width:"25%",children:(0,m.AP)("Time")})]})}),r&&(0,A.jsx)("tbody",{children:r.map((function(e,t){return(0,A.jsx)(Zs,{item:e},t)}))})]}),(0,A.jsx)(X.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:s,hasNextPage:a,curPerPage:i,resetPerPage:this.props.resetPerPage})]});return r.length?c:o}}])}(l.Component),Zs=function(e){function t(e){return(0,i.A)(this,t),(0,a.A)(this,t,[e])}return(0,o.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){var e=this.props.item;return(0,A.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,children:[(0,A.jsx)("td",{children:(0,A.jsx)(ue,{email:e.email,name:e.name})}),(0,A.jsx)("td",{children:e.login_ip}),(0,A.jsx)("td",{children:e.login_success?(0,m.AP)("Success"):(0,m.AP)("Failed")}),(0,A.jsx)("td",{children:C()(e.login_time).fromNow()})]})}}])}(l.Component),Js=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).getLogsByPage=function(e){var t=n.state.perPage;D.e.sysAdminListAdminLoginLogs(e,t).then((function(r){n.setState({logList:r.data.data,loading:!1,currentPage:e,hasNextPage:f.Aq.hasNextPage(e,t,r.data.total_count)})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){return n.getLogsByPage(n.initPage)}))},n.state={loading:!0,errorMsg:"",logList:[],perPage:25,currentPage:1,hasNextPage:!1},n.initPage=1,n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,r=n.currentPage,i=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||i),currentPage:parseInt(t.get("page")||r)},(function(){e.getLogsByPage(e.state.currentPage)}))}},{key:"render",value:function(){var e=this.state,t=e.logList,n=e.currentPage,i=e.perPage,s=e.hasNextPage;return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)({},this.props)),(0,A.jsx)("div",{className:"main-panel-center flex-row",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)(Gs,{currentItem:"adminLoginLogs"}),(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsx)($s,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:t,currentPage:n,perPage:i,hasNextPage:s,getLogsByPage:this.getLogsByPage,resetPerPage:this.resetPerPage})})]})})]})}}])}(l.Component),ea=function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).listAbuseReports=function(){D.e.sysAdminListAbuseReports().then((function(e){n.setState({abuseReportList:e.data.abuse_report_list})})).catch((function(e){n.handleError(e)}))},n.updateAbuseReport=function(e,t){D.e.sysAdminUpdateAbuseReport(e,t).then((function(e){var r=n.state.abuseReportList.map((function(n,r){return n.id===t&&(n.handled=e.data.handled),n}));n.setState({abuseReportList:r})})).catch((function(e){n.handleError(e)}))},n.handleError=function(e){e.response?w.A.danger(e.response.data.error_msg||e.response.data.detail||(0,m.AP)("Error"),{duration:3}):w.A.danger((0,m.AP)("Please check the network."),{duration:3})},n.state={abuseReportList:[]},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){this.listAbuseReports()}},{key:"render",value:function(){var e=this,t=this.state.abuseReportList.map((function(t,n){var r=(!t.handled).toString(),i=t.id,s=m.Yc+"lib/"+t.repo_id+"/file"+t.file_path;return(0,A.jsxs)("tr",{children:[(0,A.jsx)("td",{children:t.repo_name}),(0,A.jsx)("td",{children:(0,A.jsx)("a",{href:s,target:"_blank",rel:"noreferrer",children:t.file_path})}),(0,A.jsx)("td",{children:t.reporter}),(0,A.jsx)("td",{children:t.abuse_type}),(0,A.jsx)("td",{children:t.description}),(0,A.jsx)("td",{children:C()(t.time).format("YYYY-MM-DD")}),(0,A.jsx)("td",{children:(0,A.jsx)("p",{onClick:e.updateAbuseReport.bind(e,r,i),className:"op-target ellipsis ellipsis-op-target cursor-pointer",children:(0,m.AP)(t.handled.toString())})})]},n)}));return(0,A.jsxs)(l.Fragment,{children:[(0,A.jsx)(k.A,(0,r.A)({},this.props)),(0,A.jsx)("div",{className:"main-panel-center",children:(0,A.jsxs)("div",{className:"cur-view-container",children:[(0,A.jsx)("div",{className:"cur-view-path",children:(0,A.jsx)("h3",{className:"sf-heading",children:(0,m.AP)("Abuse Reports")})}),(0,A.jsx)("div",{className:"cur-view-content",children:(0,A.jsxs)("table",{className:"table-hover",children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"20%",children:(0,m.AP)("Library")}),(0,A.jsx)("th",{width:"20%",children:(0,m.AP)("File")}),(0,A.jsx)("th",{width:"10%",children:(0,m.AP)("Reporter")}),(0,A.jsx)("th",{width:"15%",children:(0,m.AP)("Abuse Type")}),(0,A.jsx)("th",{width:"20%",children:(0,m.AP)("Description")}),(0,A.jsx)("th",{width:"10%",children:(0,m.AP)("Time")}),(0,A.jsx)("th",{width:"5%",children:(0,m.AP)("Handled")})]})}),(0,A.jsx)("tbody",{children:t})]})})]})})]})}}])}(l.Component),ta=(n(16322),n(18291),function(e){function t(e){var n;return(0,i.A)(this,t),(n=(0,a.A)(this,t,[e])).getCurrentTabForPageList=function(e){for(var t,n,r="".concat(m.Yc,"sys/"),i=0,s=e.length;i<s;i++){t=e[i].urlPartList,n=e[i].tab;for(var a=0,o=t.length;a<o;a++)if(-1!=location.href.indexOf("".concat(r).concat(t[a])))return n}},n.onCloseSidePanel=function(){n.setState({isSidePanelClosed:!n.state.isSidePanelClosed})},n.tabItemClick=function(e){n.setState({currentTab:e}),f.Aq.isDesktop()||n.state.isSidePanelClosed||n.setState({isSidePanelClosed:!0})},n.toggleSidePanel=function(){n.setState({isSidePanelClosed:!n.state.isSidePanelClosed})},n.state={isSidePanelClosed:!1,currentTab:"file-scan"},n}return(0,o.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){var e=window.location.href.split("/"),t=e[e.length-2],n=this.getCurrentTabForPageList([{tab:"devices",urlPartList:["desktop-devices","mobile-devices","device-errors"]},{tab:"libraries",urlPartList:["all-libraries","search-libraries","system-library","trash-libraries","libraries/"]},{tab:"statistic",urlPartList:["statistics/file","statistics/storage","statistics/user","statistics/traffic","statistics/reports"]},{tab:"users",urlPartList:["users/","search-users/"]},{tab:"groups",urlPartList:["groups/","search-groups/"]},{tab:"organizations",urlPartList:["organizations/","search-organizations/"]},{tab:"links",urlPartList:["share-links/","upload-links/"]},{tab:"institutions",urlPartList:["institutions/"]},{tab:"termsandconditions",urlPartList:["terms-and-conditions/"]},{tab:"departments",urlPartList:["departments/"]},{tab:"logs",urlPartList:["logs/"]},{tab:"virus-files",urlPartList:["virus-files/"]},{tab:"adminLogs",urlPartList:["admin-logs/"]}]);t=n||t,this.setState({currentTab:t})}},{key:"UNSAFE_componentWillMount",value:function(){f.Aq.isDesktop()||this.setState({isSidePanelClosed:!0})}},{key:"render",value:function(){var e=this.state,t=e.currentTab,n=e.isSidePanelClosed,i={toggleSidePanel:this.toggleSidePanel};return(0,A.jsxs)("div",{id:"main",children:[(0,A.jsx)(y,{isSidePanelClosed:n,onCloseSidePanel:this.onCloseSidePanel,currentTab:t,tabItemClick:this.tabItemClick}),(0,A.jsx)(j,{children:(0,A.jsxs)(g.Ix,{className:"reach-router",children:[(0,A.jsx)(N,(0,r.A)({path:m.Yc+"sys/info"},i)),(0,A.jsx)(V,(0,r.A)({path:m.Yc+"sys/statistics/file"},i)),(0,A.jsx)(H,(0,r.A)({path:m.Yc+"sys/statistics/storage"},i)),(0,A.jsx)(ee,(0,r.A)({path:m.Yc+"sys/statistics/user"},i)),(0,A.jsx)(J,(0,r.A)({path:m.Yc+"sys/statistics/traffic"},i)),(0,A.jsx)(te,(0,r.A)({path:m.Yc+"sys/statistics/reports"},i)),(0,A.jsx)(ce,(0,r.A)({path:m.Yc+"sys/desktop-devices"},i)),(0,A.jsx)(de,(0,r.A)({path:m.Yc+"sys/mobile-devices"},i)),(0,A.jsx)(me,(0,r.A)({path:m.Yc+"sys/device-errors"},i)),(0,A.jsx)(An,(0,r.A)({path:m.Yc+"sys/all-libraries"},i)),(0,A.jsx)(bn,(0,r.A)({path:m.Yc+"sys/system-library"},i)),(0,A.jsx)(In,(0,r.A)({path:m.Yc+"sys/trash-libraries"},i)),(0,A.jsx)(kn,(0,r.A)({path:m.Yc+"sys/search-libraries"},i)),(0,A.jsx)(Fn,(0,r.A)({path:m.Yc+"sys/libraries/:repoID/*"},i)),(0,A.jsx)(Vi,(0,r.A)({path:m.Yc+"sys/web-settings"},i)),(0,A.jsx)(Qi,(0,r.A)({path:m.Yc+"sys/notifications"},i)),(0,A.jsx)(Vn,(0,r.A)({path:m.Yc+"sys/groups"},i)),(0,A.jsx)(Hn,(0,r.A)({path:m.Yc+"sys/search-groups"},i)),(0,A.jsx)($n,(0,r.A)({path:m.Yc+"sys/groups/:groupID/libraries"},i)),(0,A.jsx)(tr,(0,r.A)({path:m.Yc+"sys/groups/:groupID/members"},i)),(0,A.jsxs)(rr,{path:m.Yc+"sys/departments",children:[(0,A.jsx)(hr,(0,r.A)({path:"/"},i)),(0,A.jsx)(fr,(0,r.A)({path:"/:groupID"},i)),(0,A.jsx)(Pr,(0,r.A)({path:"/:groupID/members"},i)),(0,A.jsx)(Dr,(0,r.A)({path:"/:groupID/libraries"},i))]}),(0,A.jsx)(Nr,(0,r.A)({path:m.Yc+"sys/share-links"},i)),(0,A.jsx)(Or,(0,r.A)({path:m.Yc+"sys/upload-links"},i)),(0,A.jsx)(Ur,(0,r.A)({path:m.Yc+"sys/organizations"},i)),(0,A.jsx)(zr,(0,r.A)({path:m.Yc+"sys/search-organizations"},i)),(0,A.jsx)(Gr,(0,r.A)({path:m.Yc+"sys/organizations/:orgID/info"},i)),(0,A.jsx)(Xr,(0,r.A)({path:m.Yc+"sys/organizations/:orgID/users"},i)),(0,A.jsx)(Jr,(0,r.A)({path:m.Yc+"sys/organizations/:orgID/groups"},i)),(0,A.jsx)(ni,(0,r.A)({path:m.Yc+"sys/organizations/:orgID/libraries"},i)),(0,A.jsx)(ai,(0,r.A)({path:m.Yc+"sys/institutions"},i)),(0,A.jsx)(di,(0,r.A)({path:m.Yc+"sys/institutions/:institutionID/info"},i)),(0,A.jsx)(mi,(0,r.A)({path:m.Yc+"sys/institutions/:institutionID/members"},i)),(0,A.jsx)(vi,(0,r.A)({path:m.Yc+"sys/institutions/:institutionID/admins"},i)),(0,A.jsx)(Di,(0,r.A)({path:m.Yc+"sys/logs/login"},i)),(0,A.jsx)(Mi,(0,r.A)({path:m.Yc+"sys/logs/file-access"},i)),(0,A.jsx)(Ti,(0,r.A)({path:m.Yc+"sys/logs/file-update"},i)),(0,A.jsx)(Ei,(0,r.A)({path:m.Yc+"sys/logs/share-permission"},i)),(0,A.jsx)(Xs,(0,r.A)({path:m.Yc+"sys/admin-logs/operation"},i)),(0,A.jsx)(Js,(0,r.A)({path:m.Yc+"sys/admin-logs/login"},i)),(0,A.jsx)(ot,(0,r.A)({path:m.Yc+"sys/users"},i)),(0,A.jsx)(ct,(0,r.A)({path:m.Yc+"sys/users/admins"},i)),(0,A.jsx)(ht,(0,r.A)({path:m.Yc+"sys/users/ldap-imported"},i)),(0,A.jsx)(mt,(0,r.A)({path:m.Yc+"sys/users/ldap"},i)),(0,A.jsx)(vt,(0,r.A)({path:m.Yc+"sys/search-users"},i)),(0,A.jsx)(kt,(0,r.A)({path:m.Yc+"sys/users/:email"},i)),(0,A.jsx)(Ot,(0,r.A)({path:m.Yc+"sys/users/:email/owned-libraries"},i)),(0,A.jsx)(Et,(0,r.A)({path:m.Yc+"sys/users/:email/shared-libraries"},i)),(0,A.jsx)(qt,(0,r.A)({path:m.Yc+"sys/users/:email/shared-links"},i)),(0,A.jsx)(Ht,(0,r.A)({path:m.Yc+"sys/users/:email/groups"},i)),(0,A.jsx)(As,(0,r.A)({path:m.Yc+"sys/invitations"},i)),(0,A.jsx)(Es,(0,r.A)({path:m.Yc+"sys/terms-and-conditions/"},i)),(0,A.jsx)(Ys,(0,r.A)({path:m.Yc+"sys/virus-files/all"},i)),(0,A.jsx)(Ws,(0,r.A)({path:m.Yc+"sys/virus-files/unhandled"},i)),(0,A.jsx)($i,(0,r.A)({path:m.Yc+"sys/file-scan-records"},i)),(0,A.jsx)(cs,(0,r.A)({path:m.Yc+"sys/work-weixin"},i)),(0,A.jsx)(fs,(0,r.A)({path:m.Yc+"sys/dingtalk"},i)),(0,A.jsx)(ea,(0,r.A)({path:m.Yc+"sys/abuse-reports"},i))]})}),(0,A.jsx)(h(),{query:"(max-width: 767.8px)",children:(0,A.jsx)(u.A,{zIndex:"1030",isOpen:!n,toggle:this.toggleSidePanel,contentClassName:"d-none"})})]})}}])}(l.Component));c.render((0,A.jsx)(p.I18nextProvider,{value:x.A,children:(0,A.jsx)(ta,{})}),document.getElementById("wrapper"))},32043:function(e,t,n){"use strict";var r=n(23029),i=n(92901),s=n(39874),a=n(85501),o=n(9950),l=n(51925),c=n(40326),d=n(44414),h=function(e){function t(){return(0,r.A)(this,t),(0,s.A)(this,t,arguments)}return(0,a.A)(t,e),(0,i.A)(t,[{key:"render",value:function(){return(0,d.jsxs)("div",{className:"main-panel-north ".concat(this.props.children?"border-left-show":""),children:[(0,d.jsxs)("div",{className:"cur-view-toolbar",children:[(0,d.jsx)("span",{className:"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none",title:(0,c.AP)("Side Nav Menu"),onClick:this.props.toggleSidePanel}),(0,d.jsx)("div",{className:"operation",children:this.props.children})]}),(0,d.jsxs)("div",{className:"common-toolbar",children:[this.props.search&&this.props.search,(0,d.jsx)(l.A,{isAdminPanel:!0})]})]})}}])}(o.Component);t.A=h},33320:function(e,t,n){"use strict";var r=n(23029),i=n(92901),s=n(39874),a=n(85501),o=n(9950),l=n(44414),c=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,s.A)(this,t,[e])).handleInputChange=function(e){n.setState({value:e.target.value})},n.handleKeyDown=function(e){"Enter"==e.key&&(e.preventDefault(),n.handleSubmit())},n.handleSubmit=function(){var e=n.state.value.trim();if(!e)return!1;n.props.submit(e)},n.state={value:""},n}return(0,a.A)(t,e),(0,i.A)(t,[{key:"render",value:function(){return(0,l.jsxs)("div",{className:"input-icon",children:[(0,l.jsx)("i",{className:"d-flex input-icon-addon sf3-font sf3-font-search"}),(0,l.jsx)("input",{type:"text",className:"form-control search-input h-6 mr-1",style:{width:"17rem"},placeholder:this.props.placeholder,value:this.state.value,onChange:this.handleInputChange,onKeyDown:this.handleKeyDown,autoComplete:"off"})]})}}])}(o.Component);t.A=c},30016:function(e,t,n){"use strict";var r=n(23029),i=n(92901),s=n(39874),a=n(85501),o=n(9950),l=n(85077),c=n(90441),d=n(44414),h=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,s.A)(this,t,[e])).onInputChange=function(e){var t=e.target.checked,r=t?1:0;n.setState({inputChecked:t}),n.props.saveSetting(n.props.keyText,r)},n.state={inputChecked:n.props.value},n}return(0,a.A)(t,e),(0,i.A)(t,[{key:"render",value:function(){var e=this.state.inputChecked,t=this.props,n=t.helpTip,r=t.displayName;return(0,d.jsx)(c.A,{displayName:r,mainContent:(0,d.jsxs)(o.Fragment,{children:[(0,d.jsx)(l.A,{className:"ml-0",checked:e,type:"checkbox",onChange:this.onInputChange}),(0,d.jsx)("p",{className:"ml-4",children:n})]})})}}])}(o.Component);t.A=h},90441:function(e,t,n){"use strict";var r=n(23029),i=n(92901),s=n(39874),a=n(85501),o=n(9950),l=n(70349),c=n(23931),d=n(55627),h=n(44414),u=function(e){function t(e){return(0,r.A)(this,t),(0,s.A)(this,t,[e])}return(0,a.A)(t,e),(0,i.A)(t,[{key:"render",value:function(){var e=this.props,t=e.helpTip,n=e.displayName,r=e.mainContent,i=e.extraContent;return(0,h.jsx)(o.Fragment,{children:(0,h.jsxs)(l.A,{className:"my-4",children:[(0,h.jsx)(c.A,{md:"3",children:(0,h.jsx)(d.A,{className:"web-setting-label",children:n})}),(0,h.jsxs)(c.A,{md:"5",children:[r,t&&(0,h.jsx)("p",{className:"small text-secondary mt-1",children:t})]}),(0,h.jsx)(c.A,{md:"4",children:i})]})})}}])}(o.Component);t.A=u},48607:function(e,t,n){e.exports=function(e){"use strict";function t(e,t){return e(t={exports:{}},t.exports),t.exports}function n(e){return e&&e.default||e}e=e&&e.hasOwnProperty("default")?e.default:e;var r={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},i=t((function(e){var t={};for(var n in r)r.hasOwnProperty(n)&&(t[r[n]]=n);var i=e.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var s in i)if(i.hasOwnProperty(s)){if(!("channels"in i[s]))throw new Error("missing channels property: "+s);if(!("labels"in i[s]))throw new Error("missing channel labels property: "+s);if(i[s].labels.length!==i[s].channels)throw new Error("channel and label counts mismatch: "+s);var a=i[s].channels,o=i[s].labels;delete i[s].channels,delete i[s].labels,Object.defineProperty(i[s],"channels",{value:a}),Object.defineProperty(i[s],"labels",{value:o})}function l(e,t){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)+Math.pow(e[2]-t[2],2)}i.rgb.hsl=function(e){var t,n,r=e[0]/255,i=e[1]/255,s=e[2]/255,a=Math.min(r,i,s),o=Math.max(r,i,s),l=o-a;return o===a?t=0:r===o?t=(i-s)/l:i===o?t=2+(s-r)/l:s===o&&(t=4+(r-i)/l),(t=Math.min(60*t,360))<0&&(t+=360),n=(a+o)/2,[t,100*(o===a?0:n<=.5?l/(o+a):l/(2-o-a)),100*n]},i.rgb.hsv=function(e){var t,n,r,i,s,a=e[0]/255,o=e[1]/255,l=e[2]/255,c=Math.max(a,o,l),d=c-Math.min(a,o,l),h=function(e){return(c-e)/6/d+.5};return 0===d?i=s=0:(s=d/c,t=h(a),n=h(o),r=h(l),a===c?i=r-n:o===c?i=1/3+t-r:l===c&&(i=2/3+n-t),i<0?i+=1:i>1&&(i-=1)),[360*i,100*s,100*c]},i.rgb.hwb=function(e){var t=e[0],n=e[1],r=e[2];return[i.rgb.hsl(e)[0],1/255*Math.min(t,Math.min(n,r))*100,100*(r=1-1/255*Math.max(t,Math.max(n,r)))]},i.rgb.cmyk=function(e){var t,n=e[0]/255,r=e[1]/255,i=e[2]/255;return[100*((1-n-(t=Math.min(1-n,1-r,1-i)))/(1-t)||0),100*((1-r-t)/(1-t)||0),100*((1-i-t)/(1-t)||0),100*t]},i.rgb.keyword=function(e){var n=t[e];if(n)return n;var i,s=1/0;for(var a in r)if(r.hasOwnProperty(a)){var o=l(e,r[a]);o<s&&(s=o,i=a)}return i},i.keyword.rgb=function(e){return r[e]},i.rgb.xyz=function(e){var t=e[0]/255,n=e[1]/255,r=e[2]/255;return[100*(.4124*(t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92)+.3576*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)+.1805*(r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92)),100*(.2126*t+.7152*n+.0722*r),100*(.0193*t+.1192*n+.9505*r)]},i.rgb.lab=function(e){var t=i.rgb.xyz(e),n=t[0],r=t[1],s=t[2];return r/=100,s/=108.883,n=(n/=95.047)>.008856?Math.pow(n,1/3):7.787*n+16/116,[116*(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116)-16,500*(n-r),200*(r-(s=s>.008856?Math.pow(s,1/3):7.787*s+16/116))]},i.hsl.rgb=function(e){var t,n,r,i,s,a=e[0]/360,o=e[1]/100,l=e[2]/100;if(0===o)return[s=255*l,s,s];t=2*l-(n=l<.5?l*(1+o):l+o-l*o),i=[0,0,0];for(var c=0;c<3;c++)(r=a+1/3*-(c-1))<0&&r++,r>1&&r--,s=6*r<1?t+6*(n-t)*r:2*r<1?n:3*r<2?t+(n-t)*(2/3-r)*6:t,i[c]=255*s;return i},i.hsl.hsv=function(e){var t=e[0],n=e[1]/100,r=e[2]/100,i=n,s=Math.max(r,.01);return n*=(r*=2)<=1?r:2-r,i*=s<=1?s:2-s,[t,100*(0===r?2*i/(s+i):2*n/(r+n)),(r+n)/2*100]},i.hsv.rgb=function(e){var t=e[0]/60,n=e[1]/100,r=e[2]/100,i=Math.floor(t)%6,s=t-Math.floor(t),a=255*r*(1-n),o=255*r*(1-n*s),l=255*r*(1-n*(1-s));switch(r*=255,i){case 0:return[r,l,a];case 1:return[o,r,a];case 2:return[a,r,l];case 3:return[a,o,r];case 4:return[l,a,r];case 5:return[r,a,o]}},i.hsv.hsl=function(e){var t,n,r,i=e[0],s=e[1]/100,a=e[2]/100,o=Math.max(a,.01);return r=(2-s)*a,n=s*o,[i,100*(n=(n/=(t=(2-s)*o)<=1?t:2-t)||0),100*(r/=2)]},i.hwb.rgb=function(e){var t,n,r,i,s,a,o,l=e[0]/360,c=e[1]/100,d=e[2]/100,h=c+d;switch(h>1&&(c/=h,d/=h),r=6*l-(t=Math.floor(6*l)),0!==(1&t)&&(r=1-r),i=c+r*((n=1-d)-c),t){default:case 6:case 0:s=n,a=i,o=c;break;case 1:s=i,a=n,o=c;break;case 2:s=c,a=n,o=i;break;case 3:s=c,a=i,o=n;break;case 4:s=i,a=c,o=n;break;case 5:s=n,a=c,o=i}return[255*s,255*a,255*o]},i.cmyk.rgb=function(e){var t=e[0]/100,n=e[1]/100,r=e[2]/100,i=e[3]/100;return[255*(1-Math.min(1,t*(1-i)+i)),255*(1-Math.min(1,n*(1-i)+i)),255*(1-Math.min(1,r*(1-i)+i))]},i.xyz.rgb=function(e){var t,n,r,i=e[0]/100,s=e[1]/100,a=e[2]/100;return n=-.9689*i+1.8758*s+.0415*a,r=.0557*i+-.204*s+1.057*a,t=(t=3.2406*i+-1.5372*s+-.4986*a)>.0031308?1.055*Math.pow(t,1/2.4)-.055:12.92*t,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:12.92*n,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:12.92*r,[255*(t=Math.min(Math.max(0,t),1)),255*(n=Math.min(Math.max(0,n),1)),255*(r=Math.min(Math.max(0,r),1))]},i.xyz.lab=function(e){var t=e[0],n=e[1],r=e[2];return n/=100,r/=108.883,t=(t/=95.047)>.008856?Math.pow(t,1/3):7.787*t+16/116,[116*(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116)-16,500*(t-n),200*(n-(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116))]},i.lab.xyz=function(e){var t,n,r,i=e[0];t=e[1]/500+(n=(i+16)/116),r=n-e[2]/200;var s=Math.pow(n,3),a=Math.pow(t,3),o=Math.pow(r,3);return n=s>.008856?s:(n-16/116)/7.787,t=a>.008856?a:(t-16/116)/7.787,r=o>.008856?o:(r-16/116)/7.787,[t*=95.047,n*=100,r*=108.883]},i.lab.lch=function(e){var t,n=e[0],r=e[1],i=e[2];return(t=360*Math.atan2(i,r)/2/Math.PI)<0&&(t+=360),[n,Math.sqrt(r*r+i*i),t]},i.lch.lab=function(e){var t,n=e[0],r=e[1];return t=e[2]/360*2*Math.PI,[n,r*Math.cos(t),r*Math.sin(t)]},i.rgb.ansi16=function(e){var t=e[0],n=e[1],r=e[2],s=1 in arguments?arguments[1]:i.rgb.hsv(e)[2];if(0===(s=Math.round(s/50)))return 30;var a=30+(Math.round(r/255)<<2|Math.round(n/255)<<1|Math.round(t/255));return 2===s&&(a+=60),a},i.hsv.ansi16=function(e){return i.rgb.ansi16(i.hsv.rgb(e),e[2])},i.rgb.ansi256=function(e){var t=e[0],n=e[1],r=e[2];return t===n&&n===r?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(n/255*5)+Math.round(r/255*5)},i.ansi16.rgb=function(e){var t=e%10;if(0===t||7===t)return e>50&&(t+=3.5),[t=t/10.5*255,t,t];var n=.5*(1+~~(e>50));return[(1&t)*n*255,(t>>1&1)*n*255,(t>>2&1)*n*255]},i.ansi256.rgb=function(e){if(e>=232){var t=10*(e-232)+8;return[t,t,t]}var n;return e-=16,[Math.floor(e/36)/5*255,Math.floor((n=e%36)/6)/5*255,n%6/5*255]},i.rgb.hex=function(e){var t=(((255&Math.round(e[0]))<<16)+((255&Math.round(e[1]))<<8)+(255&Math.round(e[2]))).toString(16).toUpperCase();return"000000".substring(t.length)+t},i.hex.rgb=function(e){var t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];var n=t[0];3===t[0].length&&(n=n.split("").map((function(e){return e+e})).join(""));var r=parseInt(n,16);return[r>>16&255,r>>8&255,255&r]},i.rgb.hcg=function(e){var t,n=e[0]/255,r=e[1]/255,i=e[2]/255,s=Math.max(Math.max(n,r),i),a=Math.min(Math.min(n,r),i),o=s-a;return t=o<=0?0:s===n?(r-i)/o%6:s===r?2+(i-n)/o:4+(n-r)/o+4,t/=6,[360*(t%=1),100*o,100*(o<1?a/(1-o):0)]},i.hsl.hcg=function(e){var t=e[1]/100,n=e[2]/100,r=1,i=0;return(r=n<.5?2*t*n:2*t*(1-n))<1&&(i=(n-.5*r)/(1-r)),[e[0],100*r,100*i]},i.hsv.hcg=function(e){var t=e[1]/100,n=e[2]/100,r=t*n,i=0;return r<1&&(i=(n-r)/(1-r)),[e[0],100*r,100*i]},i.hcg.rgb=function(e){var t=e[0]/360,n=e[1]/100,r=e[2]/100;if(0===n)return[255*r,255*r,255*r];var i=[0,0,0],s=t%1*6,a=s%1,o=1-a,l=0;switch(Math.floor(s)){case 0:i[0]=1,i[1]=a,i[2]=0;break;case 1:i[0]=o,i[1]=1,i[2]=0;break;case 2:i[0]=0,i[1]=1,i[2]=a;break;case 3:i[0]=0,i[1]=o,i[2]=1;break;case 4:i[0]=a,i[1]=0,i[2]=1;break;default:i[0]=1,i[1]=0,i[2]=o}return l=(1-n)*r,[255*(n*i[0]+l),255*(n*i[1]+l),255*(n*i[2]+l)]},i.hcg.hsv=function(e){var t=e[1]/100,n=t+e[2]/100*(1-t),r=0;return n>0&&(r=t/n),[e[0],100*r,100*n]},i.hcg.hsl=function(e){var t=e[1]/100,n=e[2]/100*(1-t)+.5*t,r=0;return n>0&&n<.5?r=t/(2*n):n>=.5&&n<1&&(r=t/(2*(1-n))),[e[0],100*r,100*n]},i.hcg.hwb=function(e){var t=e[1]/100,n=t+e[2]/100*(1-t);return[e[0],100*(n-t),100*(1-n)]},i.hwb.hcg=function(e){var t=e[1]/100,n=1-e[2]/100,r=n-t,i=0;return r<1&&(i=(n-r)/(1-r)),[e[0],100*r,100*i]},i.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]},i.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]},i.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]},i.gray.hsl=i.gray.hsv=function(e){return[0,0,e[0]]},i.gray.hwb=function(e){return[0,100,e[0]]},i.gray.cmyk=function(e){return[0,0,0,e[0]]},i.gray.lab=function(e){return[e[0],0,0]},i.gray.hex=function(e){var t=255&Math.round(e[0]/100*255),n=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(n.length)+n},i.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]}}));function s(){for(var e={},t=Object.keys(i),n=t.length,r=0;r<n;r++)e[t[r]]={distance:-1,parent:null};return e}function a(e){var t=s(),n=[e];for(t[e].distance=0;n.length;)for(var r=n.pop(),a=Object.keys(i[r]),o=a.length,l=0;l<o;l++){var c=a[l],d=t[c];-1===d.distance&&(d.distance=t[r].distance+1,d.parent=r,n.unshift(c))}return t}function o(e,t){return function(n){return t(e(n))}}function l(e,t){for(var n=[t[e].parent,e],r=i[t[e].parent][e],s=t[e].parent;t[s].parent;)n.unshift(t[s].parent),r=o(i[t[s].parent][s],r),s=t[s].parent;return r.conversion=n,r}i.rgb,i.hsl,i.hsv,i.hwb,i.cmyk,i.xyz,i.lab,i.lch,i.hex,i.keyword,i.ansi16,i.ansi256,i.hcg,i.apple,i.gray;var c=function(e){for(var t=a(e),n={},r=Object.keys(t),i=r.length,s=0;s<i;s++){var o=r[s];null!==t[o].parent&&(n[o]=l(o,t))}return n},d={};function h(e){var t=function(t){return void 0===t||null===t?t:(arguments.length>1&&(t=Array.prototype.slice.call(arguments)),e(t))};return"conversion"in e&&(t.conversion=e.conversion),t}function u(e){var t=function(t){if(void 0===t||null===t)return t;arguments.length>1&&(t=Array.prototype.slice.call(arguments));var n=e(t);if("object"===typeof n)for(var r=n.length,i=0;i<r;i++)n[i]=Math.round(n[i]);return n};return"conversion"in e&&(t.conversion=e.conversion),t}Object.keys(i).forEach((function(e){d[e]={},Object.defineProperty(d[e],"channels",{value:i[e].channels}),Object.defineProperty(d[e],"labels",{value:i[e].labels});var t=c(e);Object.keys(t).forEach((function(n){var r=t[n];d[e][n]=u(r),d[e][n].raw=h(r)}))}));var g=d,p={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},m={getRgba:f,getHsla:x,getRgb:A,getHsl:P,getHwb:v,getAlpha:y,hexString:b,rgbString:j,rgbaString:S,percentString:D,percentaString:w,hslString:I,hslaString:k,hwbString:_,keyword:N};function f(e){if(e){var t=/^#([a-fA-F0-9]{3,4})$/i,n=/^#([a-fA-F0-9]{6}([a-fA-F0-9]{2})?)$/i,r=/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/i,i=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/i,s=/(\w+)/,a=[0,0,0],o=1,l=e.match(t),c="";if(l){c=(l=l[1])[3];for(var d=0;d<a.length;d++)a[d]=parseInt(l[d]+l[d],16);c&&(o=Math.round(parseInt(c+c,16)/255*100)/100)}else if(l=e.match(n)){for(c=l[2],l=l[1],d=0;d<a.length;d++)a[d]=parseInt(l.slice(2*d,2*d+2),16);c&&(o=Math.round(parseInt(c,16)/255*100)/100)}else if(l=e.match(r)){for(d=0;d<a.length;d++)a[d]=parseInt(l[d+1]);o=parseFloat(l[4])}else if(l=e.match(i)){for(d=0;d<a.length;d++)a[d]=Math.round(2.55*parseFloat(l[d+1]));o=parseFloat(l[4])}else if(l=e.match(s)){if("transparent"==l[1])return[0,0,0,0];if(!(a=p[l[1]]))return}for(d=0;d<a.length;d++)a[d]=M(a[d],0,255);return o=o||0==o?M(o,0,1):1,a[3]=o,a}}function x(e){if(e){var t=/^hsla?\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/,n=e.match(t);if(n){var r=parseFloat(n[4]);return[M(parseInt(n[1]),0,360),M(parseFloat(n[2]),0,100),M(parseFloat(n[3]),0,100),M(isNaN(r)?1:r,0,1)]}}}function v(e){if(e){var t=/^hwb\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/,n=e.match(t);if(n){var r=parseFloat(n[4]);return[M(parseInt(n[1]),0,360),M(parseFloat(n[2]),0,100),M(parseFloat(n[3]),0,100),M(isNaN(r)?1:r,0,1)]}}}function A(e){var t=f(e);return t&&t.slice(0,3)}function P(e){var t=x(e);return t&&t.slice(0,3)}function y(e){var t=f(e);return t||(t=x(e))||(t=v(e))?t[3]:void 0}function b(e,t){return t=void 0!==t&&3===e.length?t:e[3],"#"+C(e[0])+C(e[1])+C(e[2])+(t>=0&&t<1?C(Math.round(255*t)):"")}function j(e,t){return t<1||e[3]&&e[3]<1?S(e,t):"rgb("+e[0]+", "+e[1]+", "+e[2]+")"}function S(e,t){return void 0===t&&(t=void 0!==e[3]?e[3]:1),"rgba("+e[0]+", "+e[1]+", "+e[2]+", "+t+")"}function D(e,t){return t<1||e[3]&&e[3]<1?w(e,t):"rgb("+Math.round(e[0]/255*100)+"%, "+Math.round(e[1]/255*100)+"%, "+Math.round(e[2]/255*100)+"%)"}function w(e,t){return"rgba("+Math.round(e[0]/255*100)+"%, "+Math.round(e[1]/255*100)+"%, "+Math.round(e[2]/255*100)+"%, "+(t||e[3]||1)+")"}function I(e,t){return t<1||e[3]&&e[3]<1?k(e,t):"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)"}function k(e,t){return void 0===t&&(t=void 0!==e[3]?e[3]:1),"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+t+")"}function _(e,t){return void 0===t&&(t=void 0!==e[3]?e[3]:1),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+(void 0!==t&&1!==t?", "+t:"")+")"}function N(e){return O[e.slice(0,3)]}function M(e,t,n){return Math.min(Math.max(t,e),n)}function C(e){var t=e.toString(16).toUpperCase();return t.length<2?"0"+t:t}var O={};for(var L in p)O[p[L]]=L;var T=function(e){return e instanceof T?e:this instanceof T?(this.valid=!1,this.values={rgb:[0,0,0],hsl:[0,0,0],hsv:[0,0,0],hwb:[0,0,0],cmyk:[0,0,0,0],alpha:1},void("string"===typeof e?(t=m.getRgba(e))?this.setValues("rgb",t):(t=m.getHsla(e))?this.setValues("hsl",t):(t=m.getHwb(e))&&this.setValues("hwb",t):"object"===typeof e&&(void 0!==(t=e).r||void 0!==t.red?this.setValues("rgb",t):void 0!==t.l||void 0!==t.lightness?this.setValues("hsl",t):void 0!==t.v||void 0!==t.value?this.setValues("hsv",t):void 0!==t.w||void 0!==t.whiteness?this.setValues("hwb",t):void 0===t.c&&void 0===t.cyan||this.setValues("cmyk",t)))):new T(e);var t};T.prototype={isValid:function(){return this.valid},rgb:function(){return this.setSpace("rgb",arguments)},hsl:function(){return this.setSpace("hsl",arguments)},hsv:function(){return this.setSpace("hsv",arguments)},hwb:function(){return this.setSpace("hwb",arguments)},cmyk:function(){return this.setSpace("cmyk",arguments)},rgbArray:function(){return this.values.rgb},hslArray:function(){return this.values.hsl},hsvArray:function(){return this.values.hsv},hwbArray:function(){var e=this.values;return 1!==e.alpha?e.hwb.concat([e.alpha]):e.hwb},cmykArray:function(){return this.values.cmyk},rgbaArray:function(){var e=this.values;return e.rgb.concat([e.alpha])},hslaArray:function(){var e=this.values;return e.hsl.concat([e.alpha])},alpha:function(e){return void 0===e?this.values.alpha:(this.setValues("alpha",e),this)},red:function(e){return this.setChannel("rgb",0,e)},green:function(e){return this.setChannel("rgb",1,e)},blue:function(e){return this.setChannel("rgb",2,e)},hue:function(e){return e&&(e=(e%=360)<0?360+e:e),this.setChannel("hsl",0,e)},saturation:function(e){return this.setChannel("hsl",1,e)},lightness:function(e){return this.setChannel("hsl",2,e)},saturationv:function(e){return this.setChannel("hsv",1,e)},whiteness:function(e){return this.setChannel("hwb",1,e)},blackness:function(e){return this.setChannel("hwb",2,e)},value:function(e){return this.setChannel("hsv",2,e)},cyan:function(e){return this.setChannel("cmyk",0,e)},magenta:function(e){return this.setChannel("cmyk",1,e)},yellow:function(e){return this.setChannel("cmyk",2,e)},black:function(e){return this.setChannel("cmyk",3,e)},hexString:function(){return m.hexString(this.values.rgb)},rgbString:function(){return m.rgbString(this.values.rgb,this.values.alpha)},rgbaString:function(){return m.rgbaString(this.values.rgb,this.values.alpha)},percentString:function(){return m.percentString(this.values.rgb,this.values.alpha)},hslString:function(){return m.hslString(this.values.hsl,this.values.alpha)},hslaString:function(){return m.hslaString(this.values.hsl,this.values.alpha)},hwbString:function(){return m.hwbString(this.values.hwb,this.values.alpha)},keyword:function(){return m.keyword(this.values.rgb,this.values.alpha)},rgbNumber:function(){var e=this.values.rgb;return e[0]<<16|e[1]<<8|e[2]},luminosity:function(){for(var e=this.values.rgb,t=[],n=0;n<e.length;n++){var r=e[n]/255;t[n]=r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4)}return.2126*t[0]+.7152*t[1]+.0722*t[2]},contrast:function(e){var t=this.luminosity(),n=e.luminosity();return t>n?(t+.05)/(n+.05):(n+.05)/(t+.05)},level:function(e){var t=this.contrast(e);return t>=7.1?"AAA":t>=4.5?"AA":""},dark:function(){var e=this.values.rgb;return(299*e[0]+587*e[1]+114*e[2])/1e3<128},light:function(){return!this.dark()},negate:function(){for(var e=[],t=0;t<3;t++)e[t]=255-this.values.rgb[t];return this.setValues("rgb",e),this},lighten:function(e){var t=this.values.hsl;return t[2]+=t[2]*e,this.setValues("hsl",t),this},darken:function(e){var t=this.values.hsl;return t[2]-=t[2]*e,this.setValues("hsl",t),this},saturate:function(e){var t=this.values.hsl;return t[1]+=t[1]*e,this.setValues("hsl",t),this},desaturate:function(e){var t=this.values.hsl;return t[1]-=t[1]*e,this.setValues("hsl",t),this},whiten:function(e){var t=this.values.hwb;return t[1]+=t[1]*e,this.setValues("hwb",t),this},blacken:function(e){var t=this.values.hwb;return t[2]+=t[2]*e,this.setValues("hwb",t),this},greyscale:function(){var e=this.values.rgb,t=.3*e[0]+.59*e[1]+.11*e[2];return this.setValues("rgb",[t,t,t]),this},clearer:function(e){var t=this.values.alpha;return this.setValues("alpha",t-t*e),this},opaquer:function(e){var t=this.values.alpha;return this.setValues("alpha",t+t*e),this},rotate:function(e){var t=this.values.hsl,n=(t[0]+e)%360;return t[0]=n<0?360+n:n,this.setValues("hsl",t),this},mix:function(e,t){var n=this,r=e,i=void 0===t?.5:t,s=2*i-1,a=n.alpha()-r.alpha(),o=((s*a===-1?s:(s+a)/(1+s*a))+1)/2,l=1-o;return this.rgb(o*n.red()+l*r.red(),o*n.green()+l*r.green(),o*n.blue()+l*r.blue()).alpha(n.alpha()*i+r.alpha()*(1-i))},toJSON:function(){return this.rgb()},clone:function(){var e,t,n=new T,r=this.values,i=n.values;for(var s in r)r.hasOwnProperty(s)&&(e=r[s],"[object Array]"===(t={}.toString.call(e))?i[s]=e.slice(0):"[object Number]"===t?i[s]=e:console.error("unexpected color value:",e));return n}},T.prototype.spaces={rgb:["red","green","blue"],hsl:["hue","saturation","lightness"],hsv:["hue","saturation","value"],hwb:["hue","whiteness","blackness"],cmyk:["cyan","magenta","yellow","black"]},T.prototype.maxes={rgb:[255,255,255],hsl:[360,100,100],hsv:[360,100,100],hwb:[360,100,100],cmyk:[100,100,100,100]},T.prototype.getValues=function(e){for(var t=this.values,n={},r=0;r<e.length;r++)n[e.charAt(r)]=t[e][r];return 1!==t.alpha&&(n.a=t.alpha),n},T.prototype.setValues=function(e,t){var n,r,i=this.values,s=this.spaces,a=this.maxes,o=1;if(this.valid=!0,"alpha"===e)o=t;else if(t.length)i[e]=t.slice(0,e.length),o=t[e.length];else if(void 0!==t[e.charAt(0)]){for(n=0;n<e.length;n++)i[e][n]=t[e.charAt(n)];o=t.a}else if(void 0!==t[s[e][0]]){var l=s[e];for(n=0;n<e.length;n++)i[e][n]=t[l[n]];o=t.alpha}if(i.alpha=Math.max(0,Math.min(1,void 0===o?i.alpha:o)),"alpha"===e)return!1;for(n=0;n<e.length;n++)r=Math.max(0,Math.min(a[e][n],i[e][n])),i[e][n]=Math.round(r);for(var c in s)c!==e&&(i[c]=g[e][c](i[e]));return!0},T.prototype.setSpace=function(e,t){var n=t[0];return void 0===n?this.getValues(e):("number"===typeof n&&(n=Array.prototype.slice.call(t)),this.setValues(e,n),this)},T.prototype.setChannel=function(e,t,n){var r=this.values[e];return void 0===n?r[t]:(n===r[t]||(r[t]=n,this.setValues(e,r)),this)},"undefined"!==typeof window&&(window.Color=T);var F=T;function R(e){return-1===["__proto__","prototype","constructor"].indexOf(e)}var E={noop:function(){},uid:function(){var e=0;return function(){return e++}}(),isNullOrUndef:function(e){return null===e||"undefined"===typeof e},isArray:function(e){if(Array.isArray&&Array.isArray(e))return!0;var t=Object.prototype.toString.call(e);return"[object"===t.substr(0,7)&&"Array]"===t.substr(-6)},isObject:function(e){return null!==e&&"[object Object]"===Object.prototype.toString.call(e)},isFinite:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return("number"===typeof e||e instanceof Number)&&isFinite(e)})),valueOrDefault:function(e,t){return"undefined"===typeof e?t:e},valueAtIndexOrDefault:function(e,t,n){return E.valueOrDefault(E.isArray(e)?e[t]:e,n)},callback:function(e,t,n){if(e&&"function"===typeof e.call)return e.apply(n,t)},each:function(e,t,n,r){var i,s,a;if(E.isArray(e))if(s=e.length,r)for(i=s-1;i>=0;i--)t.call(n,e[i],i);else for(i=0;i<s;i++)t.call(n,e[i],i);else if(E.isObject(e))for(s=(a=Object.keys(e)).length,i=0;i<s;i++)t.call(n,e[a[i]],a[i])},arrayEquals:function(e,t){var n,r,i,s;if(!e||!t||e.length!==t.length)return!1;for(n=0,r=e.length;n<r;++n)if(i=e[n],s=t[n],i instanceof Array&&s instanceof Array){if(!E.arrayEquals(i,s))return!1}else if(i!==s)return!1;return!0},clone:function(e){if(E.isArray(e))return e.map(E.clone);if(E.isObject(e)){for(var t=Object.create(e),n=Object.keys(e),r=n.length,i=0;i<r;++i)t[n[i]]=E.clone(e[n[i]]);return t}return e},_merger:function(e,t,n,r){if(R(e)){var i=t[e],s=n[e];E.isObject(i)&&E.isObject(s)?E.merge(i,s,r):t[e]=E.clone(s)}},_mergerIf:function(e,t,n){if(R(e)){var r=t[e],i=n[e];E.isObject(r)&&E.isObject(i)?E.mergeIf(r,i):t.hasOwnProperty(e)||(t[e]=E.clone(i))}},merge:function(e,t,n){var r,i,s,a,o,l=E.isArray(t)?t:[t],c=l.length;if(!E.isObject(e))return e;for(r=(n=n||{}).merger||E._merger,i=0;i<c;++i)if(t=l[i],E.isObject(t))for(o=0,a=(s=Object.keys(t)).length;o<a;++o)r(s[o],e,t,n);return e},mergeIf:function(e,t){return E.merge(e,t,{merger:E._mergerIf})},extend:Object.assign||function(e){return E.merge(e,[].slice.call(arguments,1),{merger:function(e,t,n){t[e]=n[e]}})},inherits:function(e){var t=this,n=e&&e.hasOwnProperty("constructor")?e.constructor:function(){return t.apply(this,arguments)},r=function(){this.constructor=n};return r.prototype=t.prototype,n.prototype=new r,n.extend=E.inherits,e&&E.extend(n.prototype,e),n.__super__=t.prototype,n},_deprecated:function(e,t,n,r){void 0!==t&&console.warn(e+': "'+n+'" is deprecated. Please use "'+r+'" instead')}},U=E;E.callCallback=E.callback,E.indexOf=function(e,t,n){return Array.prototype.indexOf.call(e,t,n)},E.getValueOrDefault=E.valueOrDefault,E.getValueAtIndexOrDefault=E.valueAtIndexOrDefault;var z={linear:function(e){return e},easeInQuad:function(e){return e*e},easeOutQuad:function(e){return-e*(e-2)},easeInOutQuad:function(e){return(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1)},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return(e-=1)*e*e+1},easeInOutCubic:function(e){return(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return-((e-=1)*e*e*e-1)},easeInOutQuart:function(e){return(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},easeInQuint:function(e){return e*e*e*e*e},easeOutQuint:function(e){return(e-=1)*e*e*e*e+1},easeInOutQuint:function(e){return(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},easeInSine:function(e){return 1-Math.cos(e*(Math.PI/2))},easeOutSine:function(e){return Math.sin(e*(Math.PI/2))},easeInOutSine:function(e){return-.5*(Math.cos(Math.PI*e)-1)},easeInExpo:function(e){return 0===e?0:Math.pow(2,10*(e-1))},easeOutExpo:function(e){return 1===e?1:1-Math.pow(2,-10*e)},easeInOutExpo:function(e){return 0===e?0:1===e?1:(e/=.5)<1?.5*Math.pow(2,10*(e-1)):.5*(2-Math.pow(2,-10*--e))},easeInCirc:function(e){return e>=1?e:-(Math.sqrt(1-e*e)-1)},easeOutCirc:function(e){return Math.sqrt(1-(e-=1)*e)},easeInOutCirc:function(e){return(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},easeInElastic:function(e){var t=1.70158,n=0,r=1;return 0===e?0:1===e?1:(n||(n=.3),r<1?(r=1,t=n/4):t=n/(2*Math.PI)*Math.asin(1/r),-r*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/n))},easeOutElastic:function(e){var t=1.70158,n=0,r=1;return 0===e?0:1===e?1:(n||(n=.3),r<1?(r=1,t=n/4):t=n/(2*Math.PI)*Math.asin(1/r),r*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/n)+1)},easeInOutElastic:function(e){var t=1.70158,n=0,r=1;return 0===e?0:2===(e/=.5)?1:(n||(n=.45),r<1?(r=1,t=n/4):t=n/(2*Math.PI)*Math.asin(1/r),e<1?r*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/n)*-.5:r*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/n)*.5+1)},easeInBack:function(e){var t=1.70158;return e*e*((t+1)*e-t)},easeOutBack:function(e){var t=1.70158;return(e-=1)*e*((t+1)*e+t)+1},easeInOutBack:function(e){var t=1.70158;return(e/=.5)<1?e*e*((1+(t*=1.525))*e-t)*.5:.5*((e-=2)*e*((1+(t*=1.525))*e+t)+2)},easeInBounce:function(e){return 1-z.easeOutBounce(1-e)},easeOutBounce:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},easeInOutBounce:function(e){return e<.5?.5*z.easeInBounce(2*e):.5*z.easeOutBounce(2*e-1)+.5}},B={effects:z};U.easingEffects=z;var q=Math.PI,Y=q/180,V=2*q,H=q/2,W=q/4,G=2*q/3,Q={clear:function(e){e.ctx.clearRect(0,0,e.width,e.height)},roundedRect:function(e,t,n,r,i,s){if(s){var a=Math.min(s,i/2,r/2),o=t+a,l=n+a,c=t+r-a,d=n+i-a;e.moveTo(t,l),o<c&&l<d?(e.arc(o,l,a,-q,-H),e.arc(c,l,a,-H,0),e.arc(c,d,a,0,H),e.arc(o,d,a,H,q)):o<c?(e.moveTo(o,n),e.arc(c,l,a,-H,H),e.arc(o,l,a,H,q+H)):l<d?(e.arc(o,l,a,-q,0),e.arc(o,d,a,0,q)):e.arc(o,l,a,-q,q),e.closePath(),e.moveTo(t,n)}else e.rect(t,n,r,i)},drawPoint:function(e,t,n,r,i,s){var a,o,l,c,d,h=(s||0)*Y;if(t&&"object"===typeof t&&("[object HTMLImageElement]"===(a=t.toString())||"[object HTMLCanvasElement]"===a))return e.save(),e.translate(r,i),e.rotate(h),e.drawImage(t,-t.width/2,-t.height/2,t.width,t.height),void e.restore();if(!(isNaN(n)||n<=0)){switch(e.beginPath(),t){default:e.arc(r,i,n,0,V),e.closePath();break;case"triangle":e.moveTo(r+Math.sin(h)*n,i-Math.cos(h)*n),h+=G,e.lineTo(r+Math.sin(h)*n,i-Math.cos(h)*n),h+=G,e.lineTo(r+Math.sin(h)*n,i-Math.cos(h)*n),e.closePath();break;case"rectRounded":c=n-(d=.516*n),o=Math.cos(h+W)*c,l=Math.sin(h+W)*c,e.arc(r-o,i-l,d,h-q,h-H),e.arc(r+l,i-o,d,h-H,h),e.arc(r+o,i+l,d,h,h+H),e.arc(r-l,i+o,d,h+H,h+q),e.closePath();break;case"rect":if(!s){c=Math.SQRT1_2*n,e.rect(r-c,i-c,2*c,2*c);break}h+=W;case"rectRot":o=Math.cos(h)*n,l=Math.sin(h)*n,e.moveTo(r-o,i-l),e.lineTo(r+l,i-o),e.lineTo(r+o,i+l),e.lineTo(r-l,i+o),e.closePath();break;case"crossRot":h+=W;case"cross":o=Math.cos(h)*n,l=Math.sin(h)*n,e.moveTo(r-o,i-l),e.lineTo(r+o,i+l),e.moveTo(r+l,i-o),e.lineTo(r-l,i+o);break;case"star":o=Math.cos(h)*n,l=Math.sin(h)*n,e.moveTo(r-o,i-l),e.lineTo(r+o,i+l),e.moveTo(r+l,i-o),e.lineTo(r-l,i+o),h+=W,o=Math.cos(h)*n,l=Math.sin(h)*n,e.moveTo(r-o,i-l),e.lineTo(r+o,i+l),e.moveTo(r+l,i-o),e.lineTo(r-l,i+o);break;case"line":o=Math.cos(h)*n,l=Math.sin(h)*n,e.moveTo(r-o,i-l),e.lineTo(r+o,i+l);break;case"dash":e.moveTo(r,i),e.lineTo(r+Math.cos(h)*n,i+Math.sin(h)*n)}e.fill(),e.stroke()}},_isPointInArea:function(e,t){var n=1e-6;return e.x>t.left-n&&e.x<t.right+n&&e.y>t.top-n&&e.y<t.bottom+n},clipArea:function(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()},unclipArea:function(e){e.restore()},lineTo:function(e,t,n,r){var i=n.steppedLine;if(i){if("middle"===i){var s=(t.x+n.x)/2;e.lineTo(s,r?n.y:t.y),e.lineTo(s,r?t.y:n.y)}else"after"===i&&!r||"after"!==i&&r?e.lineTo(t.x,n.y):e.lineTo(n.x,t.y);e.lineTo(n.x,n.y)}else n.tension?e.bezierCurveTo(r?t.controlPointPreviousX:t.controlPointNextX,r?t.controlPointPreviousY:t.controlPointNextY,r?n.controlPointNextX:n.controlPointPreviousX,r?n.controlPointNextY:n.controlPointPreviousY,n.x,n.y):e.lineTo(n.x,n.y)}},K=Q;U.clear=Q.clear,U.drawRoundedRectangle=function(e){e.beginPath(),Q.roundedRect.apply(Q,arguments)};var X={_set:function(e,t){return U.merge(this[e]||(this[e]={}),t)}};X._set("global",{defaultColor:"rgba(0,0,0,0.1)",defaultFontColor:"#666",defaultFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",defaultFontSize:12,defaultFontStyle:"normal",defaultLineHeight:1.2,showLines:!0});var $=X,Z=U.valueOrDefault;function J(e){return!e||U.isNullOrUndef(e.size)||U.isNullOrUndef(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}var ee={toLineHeight:function(e,t){var n=(""+e).match(/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/);if(!n||"normal"===n[1])return 1.2*t;switch(e=+n[2],n[3]){case"px":return e;case"%":e/=100}return t*e},toPadding:function(e){var t,n,r,i;return U.isObject(e)?(t=+e.top||0,n=+e.right||0,r=+e.bottom||0,i=+e.left||0):t=n=r=i=+e||0,{top:t,right:n,bottom:r,left:i,height:t+r,width:i+n}},_parseFont:function(e){var t=$.global,n=Z(e.fontSize,t.defaultFontSize),r={family:Z(e.fontFamily,t.defaultFontFamily),lineHeight:U.options.toLineHeight(Z(e.lineHeight,t.defaultLineHeight),n),size:n,style:Z(e.fontStyle,t.defaultFontStyle),weight:null,string:""};return r.string=J(r),r},resolve:function(e,t,n,r){var i,s,a,o=!0;for(i=0,s=e.length;i<s;++i)if(void 0!==(a=e[i])&&(void 0!==t&&"function"===typeof a&&(a=a(t),o=!1),void 0!==n&&U.isArray(a)&&(a=a[n],o=!1),void 0!==a))return r&&!o&&(r.cacheable=!1),a}},te={_factorize:function(e){var t,n=[],r=Math.sqrt(e);for(t=1;t<r;t++)e%t===0&&(n.push(t),n.push(e/t));return r===(0|r)&&n.push(r),n.sort((function(e,t){return e-t})).pop(),n},log10:Math.log10||function(e){var t=Math.log(e)*Math.LOG10E,n=Math.round(t);return e===Math.pow(10,n)?n:t}},ne=te;U.log10=te.log10;var re=function(e,t){return{x:function(n){return e+e+t-n},setWidth:function(e){t=e},textAlign:function(e){return"center"===e?e:"right"===e?"left":"right"},xPlus:function(e,t){return e-t},leftForLtr:function(e,t){return e-t}}},ie=function(){return{x:function(e){return e},setWidth:function(e){},textAlign:function(e){return e},xPlus:function(e,t){return e+t},leftForLtr:function(e,t){return e}}},se=U,ae=B,oe=K,le=ee,ce=ne,de={getRtlAdapter:function(e,t,n){return e?re(t,n):ie()},overrideTextDirection:function(e,t){var n,r;"ltr"!==t&&"rtl"!==t||(r=[(n=e.canvas.style).getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",t,"important"),e.prevTextDirection=r)},restoreTextDirection:function(e){var t=e.prevTextDirection;void 0!==t&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}};function he(e,t,n,r){var i,s,a,o,l,c,d,h,u,g=Object.keys(n);for(i=0,s=g.length;i<s;++i)if(c=n[a=g[i]],t.hasOwnProperty(a)||(t[a]=c),(o=t[a])!==c&&"_"!==a[0]){if(e.hasOwnProperty(a)||(e[a]=o),(d=typeof c)===typeof(l=e[a]))if("string"===d){if((h=F(l)).valid&&(u=F(c)).valid){t[a]=u.mix(h,r).rgbString();continue}}else if(se.isFinite(l)&&se.isFinite(c)){t[a]=l+(c-l)*r;continue}t[a]=c}}se.easing=ae,se.canvas=oe,se.options=le,se.math=ce,se.rtl=de;var ue=function(e){se.extend(this,e),this.initialize.apply(this,arguments)};se.extend(ue.prototype,{_type:void 0,initialize:function(){this.hidden=!1},pivot:function(){var e=this;return e._view||(e._view=se.extend({},e._model)),e._start={},e},transition:function(e){var t=this,n=t._model,r=t._start,i=t._view;return n&&1!==e?(i||(i=t._view={}),r||(r=t._start={}),he(r,i,n,e),t):(t._view=se.extend({},n),t._start=null,t)},tooltipPosition:function(){return{x:this._model.x,y:this._model.y}},hasValue:function(){return se.isNumber(this._model.x)&&se.isNumber(this._model.y)}}),ue.extend=se.inherits;var ge=ue,pe=ge.extend({chart:null,currentStep:0,numSteps:60,easing:"",render:null,onAnimationProgress:null,onAnimationComplete:null}),me=pe;Object.defineProperty(pe.prototype,"animationObject",{get:function(){return this}}),Object.defineProperty(pe.prototype,"chartInstance",{get:function(){return this.chart},set:function(e){this.chart=e}}),$._set("global",{animation:{duration:1e3,easing:"easeOutQuart",onProgress:se.noop,onComplete:se.noop}});var fe={animations:[],request:null,addAnimation:function(e,t,n,r){var i,s,a=this.animations;for(t.chart=e,t.startTime=Date.now(),t.duration=n,r||(e.animating=!0),i=0,s=a.length;i<s;++i)if(a[i].chart===e)return void(a[i]=t);a.push(t),1===a.length&&this.requestAnimationFrame()},cancelAnimation:function(e){var t=se.findIndex(this.animations,(function(t){return t.chart===e}));-1!==t&&(this.animations.splice(t,1),e.animating=!1)},requestAnimationFrame:function(){var e=this;null===e.request&&(e.request=se.requestAnimFrame.call(window,(function(){e.request=null,e.startDigest()})))},startDigest:function(){var e=this;e.advance(),e.animations.length>0&&e.requestAnimationFrame()},advance:function(){for(var e,t,n,r,i=this.animations,s=0;s<i.length;)t=(e=i[s]).chart,n=e.numSteps,r=Math.floor((Date.now()-e.startTime)/e.duration*n)+1,e.currentStep=Math.min(r,n),se.callback(e.render,[t,e],t),se.callback(e.onAnimationProgress,[e],t),e.currentStep>=n?(se.callback(e.onAnimationComplete,[e],t),t.animating=!1,i.splice(s,1)):++s}},xe=se.options.resolve,ve=["push","pop","shift","splice","unshift"];function Ae(e,t){e._chartjs?e._chartjs.listeners.push(t):(Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),ve.forEach((function(t){var n="onData"+t.charAt(0).toUpperCase()+t.slice(1),r=e[t];Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:function(){var t=Array.prototype.slice.call(arguments),i=r.apply(this,t);return se.each(e._chartjs.listeners,(function(e){"function"===typeof e[n]&&e[n].apply(e,t)})),i}})})))}function Pe(e,t){var n=e._chartjs;if(n){var r=n.listeners,i=r.indexOf(t);-1!==i&&r.splice(i,1),r.length>0||(ve.forEach((function(t){delete e[t]})),delete e._chartjs)}}var ye=function(e,t){this.initialize(e,t)};se.extend(ye.prototype,{datasetElementType:null,dataElementType:null,_datasetElementOptions:["backgroundColor","borderCapStyle","borderColor","borderDash","borderDashOffset","borderJoinStyle","borderWidth"],_dataElementOptions:["backgroundColor","borderColor","borderWidth","pointStyle"],initialize:function(e,t){var n=this;n.chart=e,n.index=t,n.linkScales(),n.addElements(),n._type=n.getMeta().type},updateIndex:function(e){this.index=e},linkScales:function(){var e=this,t=e.getMeta(),n=e.chart,r=n.scales,i=e.getDataset(),s=n.options.scales;null!==t.xAxisID&&t.xAxisID in r&&!i.xAxisID||(t.xAxisID=i.xAxisID||s.xAxes[0].id),null!==t.yAxisID&&t.yAxisID in r&&!i.yAxisID||(t.yAxisID=i.yAxisID||s.yAxes[0].id)},getDataset:function(){return this.chart.data.datasets[this.index]},getMeta:function(){return this.chart.getDatasetMeta(this.index)},getScaleForId:function(e){return this.chart.scales[e]},_getValueScaleId:function(){return this.getMeta().yAxisID},_getIndexScaleId:function(){return this.getMeta().xAxisID},_getValueScale:function(){return this.getScaleForId(this._getValueScaleId())},_getIndexScale:function(){return this.getScaleForId(this._getIndexScaleId())},reset:function(){this._update(!0)},destroy:function(){this._data&&Pe(this._data,this)},createMetaDataset:function(){var e=this,t=e.datasetElementType;return t&&new t({_chart:e.chart,_datasetIndex:e.index})},createMetaData:function(e){var t=this,n=t.dataElementType;return n&&new n({_chart:t.chart,_datasetIndex:t.index,_index:e})},addElements:function(){var e,t,n=this,r=n.getMeta(),i=n.getDataset().data||[],s=r.data;for(e=0,t=i.length;e<t;++e)s[e]=s[e]||n.createMetaData(e);r.dataset=r.dataset||n.createMetaDataset()},addElementAndReset:function(e){var t=this.createMetaData(e);this.getMeta().data.splice(e,0,t),this.updateElement(t,e,!0)},buildOrUpdateElements:function(){var e=this,t=e.getDataset(),n=t.data||(t.data=[]);e._data!==n&&(e._data&&Pe(e._data,e),n&&Object.isExtensible(n)&&Ae(n,e),e._data=n),e.resyncElements()},_configure:function(){var e=this;e._config=se.merge(Object.create(null),[e.chart.options.datasets[e._type],e.getDataset()],{merger:function(e,t,n){"_meta"!==e&&"data"!==e&&se._merger(e,t,n)}})},_update:function(e){var t=this;t._configure(),t._cachedDataOpts=null,t.update(e)},update:se.noop,transition:function(e){for(var t=this.getMeta(),n=t.data||[],r=n.length,i=0;i<r;++i)n[i].transition(e);t.dataset&&t.dataset.transition(e)},draw:function(){var e=this.getMeta(),t=e.data||[],n=t.length,r=0;for(e.dataset&&e.dataset.draw();r<n;++r)t[r].draw()},getStyle:function(e){var t,n=this,r=n.getMeta(),i=r.dataset;return n._configure(),i&&void 0===e?t=n._resolveDatasetElementOptions(i||{}):(e=e||0,t=n._resolveDataElementOptions(r.data[e]||{},e)),!1!==t.fill&&null!==t.fill||(t.backgroundColor=t.borderColor),t},_resolveDatasetElementOptions:function(e,t){var n,r,i,s,a=this,o=a.chart,l=a._config,c=e.custom||{},d=o.options.elements[a.datasetElementType.prototype._type]||{},h=a._datasetElementOptions,u={},g={chart:o,dataset:a.getDataset(),datasetIndex:a.index,hover:t};for(n=0,r=h.length;n<r;++n)i=h[n],s=t?"hover"+i.charAt(0).toUpperCase()+i.slice(1):i,u[i]=xe([c[s],l[s],d[s]],g);return u},_resolveDataElementOptions:function(e,t){var n=this,r=e&&e.custom,i=n._cachedDataOpts;if(i&&!r)return i;var s,a,o,l,c=n.chart,d=n._config,h=c.options.elements[n.dataElementType.prototype._type]||{},u=n._dataElementOptions,g={},p={chart:c,dataIndex:t,dataset:n.getDataset(),datasetIndex:n.index},m={cacheable:!r};if(r=r||{},se.isArray(u))for(a=0,o=u.length;a<o;++a)g[l=u[a]]=xe([r[l],d[l],h[l]],p,t,m);else for(a=0,o=(s=Object.keys(u)).length;a<o;++a)g[l=s[a]]=xe([r[l],d[u[l]],d[l],h[l]],p,t,m);return m.cacheable&&(n._cachedDataOpts=Object.freeze(g)),g},removeHoverStyle:function(e){se.merge(e._model,e.$previousStyle||{}),delete e.$previousStyle},setHoverStyle:function(e){var t=this.chart.data.datasets[e._datasetIndex],n=e._index,r=e.custom||{},i=e._model,s=se.getHoverColor;e.$previousStyle={backgroundColor:i.backgroundColor,borderColor:i.borderColor,borderWidth:i.borderWidth},i.backgroundColor=xe([r.hoverBackgroundColor,t.hoverBackgroundColor,s(i.backgroundColor)],void 0,n),i.borderColor=xe([r.hoverBorderColor,t.hoverBorderColor,s(i.borderColor)],void 0,n),i.borderWidth=xe([r.hoverBorderWidth,t.hoverBorderWidth,i.borderWidth],void 0,n)},_removeDatasetHoverStyle:function(){var e=this.getMeta().dataset;e&&this.removeHoverStyle(e)},_setDatasetHoverStyle:function(){var e,t,n,r,i,s,a=this.getMeta().dataset,o={};if(a){for(s=a._model,i=this._resolveDatasetElementOptions(a,!0),e=0,t=(r=Object.keys(i)).length;e<t;++e)o[n=r[e]]=s[n],s[n]=i[n];a.$previousStyle=o}},resyncElements:function(){var e=this,t=e.getMeta(),n=e.getDataset().data,r=t.data.length,i=n.length;i<r?t.data.splice(i,r-i):i>r&&e.insertElements(r,i-r)},insertElements:function(e,t){for(var n=0;n<t;++n)this.addElementAndReset(e+n)},onDataPush:function(){var e=arguments.length;this.insertElements(this.getDataset().data.length-e,e)},onDataPop:function(){this.getMeta().data.pop()},onDataShift:function(){this.getMeta().data.shift()},onDataSplice:function(e,t){this.getMeta().data.splice(e,t),this.insertElements(e,arguments.length-2)},onDataUnshift:function(){this.insertElements(0,arguments.length)}}),ye.extend=se.inherits;var be=ye,je=2*Math.PI;function Se(e,t){var n=t.startAngle,r=t.endAngle,i=t.pixelMargin,s=i/t.outerRadius,a=t.x,o=t.y;e.beginPath(),e.arc(a,o,t.outerRadius,n-s,r+s),t.innerRadius>i?(s=i/t.innerRadius,e.arc(a,o,t.innerRadius-i,r+s,n-s,!0)):e.arc(a,o,i,r+Math.PI/2,n-Math.PI/2),e.closePath(),e.clip()}function De(e,t,n,r){var i,s=n.endAngle;for(r&&(n.endAngle=n.startAngle+je,Se(e,n),n.endAngle=s,n.endAngle===n.startAngle&&n.fullCircles&&(n.endAngle+=je,n.fullCircles--)),e.beginPath(),e.arc(n.x,n.y,n.innerRadius,n.startAngle+je,n.startAngle,!0),i=0;i<n.fullCircles;++i)e.stroke();for(e.beginPath(),e.arc(n.x,n.y,t.outerRadius,n.startAngle,n.startAngle+je),i=0;i<n.fullCircles;++i)e.stroke()}function we(e,t,n){var r="inner"===t.borderAlign;r?(e.lineWidth=2*t.borderWidth,e.lineJoin="round"):(e.lineWidth=t.borderWidth,e.lineJoin="bevel"),n.fullCircles&&De(e,t,n,r),r&&Se(e,n),e.beginPath(),e.arc(n.x,n.y,t.outerRadius,n.startAngle,n.endAngle),e.arc(n.x,n.y,n.innerRadius,n.endAngle,n.startAngle,!0),e.closePath(),e.stroke()}$._set("global",{elements:{arc:{backgroundColor:$.global.defaultColor,borderColor:"#fff",borderWidth:2,borderAlign:"center"}}});var Ie=ge.extend({_type:"arc",inLabelRange:function(e){var t=this._view;return!!t&&Math.pow(e-t.x,2)<Math.pow(t.radius+t.hoverRadius,2)},inRange:function(e,t){var n=this._view;if(n){for(var r=se.getAngleFromPoint(n,{x:e,y:t}),i=r.angle,s=r.distance,a=n.startAngle,o=n.endAngle;o<a;)o+=je;for(;i>o;)i-=je;for(;i<a;)i+=je;var l=i>=a&&i<=o,c=s>=n.innerRadius&&s<=n.outerRadius;return l&&c}return!1},getCenterPoint:function(){var e=this._view,t=(e.startAngle+e.endAngle)/2,n=(e.innerRadius+e.outerRadius)/2;return{x:e.x+Math.cos(t)*n,y:e.y+Math.sin(t)*n}},getArea:function(){var e=this._view;return Math.PI*((e.endAngle-e.startAngle)/(2*Math.PI))*(Math.pow(e.outerRadius,2)-Math.pow(e.innerRadius,2))},tooltipPosition:function(){var e=this._view,t=e.startAngle+(e.endAngle-e.startAngle)/2,n=(e.outerRadius-e.innerRadius)/2+e.innerRadius;return{x:e.x+Math.cos(t)*n,y:e.y+Math.sin(t)*n}},draw:function(){var e,t=this._chart.ctx,n=this._view,r="inner"===n.borderAlign?.33:0,i={x:n.x,y:n.y,innerRadius:n.innerRadius,outerRadius:Math.max(n.outerRadius-r,0),pixelMargin:r,startAngle:n.startAngle,endAngle:n.endAngle,fullCircles:Math.floor(n.circumference/je)};if(t.save(),t.fillStyle=n.backgroundColor,t.strokeStyle=n.borderColor,i.fullCircles){for(i.endAngle=i.startAngle+je,t.beginPath(),t.arc(i.x,i.y,i.outerRadius,i.startAngle,i.endAngle),t.arc(i.x,i.y,i.innerRadius,i.endAngle,i.startAngle,!0),t.closePath(),e=0;e<i.fullCircles;++e)t.fill();i.endAngle=i.startAngle+n.circumference%je}t.beginPath(),t.arc(i.x,i.y,i.outerRadius,i.startAngle,i.endAngle),t.arc(i.x,i.y,i.innerRadius,i.endAngle,i.startAngle,!0),t.closePath(),t.fill(),n.borderWidth&&we(t,n,i),t.restore()}}),ke=se.valueOrDefault,_e=$.global.defaultColor;$._set("global",{elements:{line:{tension:.4,backgroundColor:_e,borderWidth:3,borderColor:_e,borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",capBezierPoints:!0,fill:!0}}});var Ne=ge.extend({_type:"line",draw:function(){var e,t,n,r=this,i=r._view,s=r._chart.ctx,a=i.spanGaps,o=r._children.slice(),l=$.global,c=l.elements.line,d=-1,h=r._loop;if(o.length){if(r._loop){for(e=0;e<o.length;++e)if(t=se.previousItem(o,e),!o[e]._view.skip&&t._view.skip){o=o.slice(e).concat(o.slice(0,e)),h=a;break}h&&o.push(o[0])}for(s.save(),s.lineCap=i.borderCapStyle||c.borderCapStyle,s.setLineDash&&s.setLineDash(i.borderDash||c.borderDash),s.lineDashOffset=ke(i.borderDashOffset,c.borderDashOffset),s.lineJoin=i.borderJoinStyle||c.borderJoinStyle,s.lineWidth=ke(i.borderWidth,c.borderWidth),s.strokeStyle=i.borderColor||l.defaultColor,s.beginPath(),(n=o[0]._view).skip||(s.moveTo(n.x,n.y),d=0),e=1;e<o.length;++e)n=o[e]._view,t=-1===d?se.previousItem(o,e):o[d],n.skip||(d!==e-1&&!a||-1===d?s.moveTo(n.x,n.y):se.canvas.lineTo(s,t._view,n),d=e);h&&s.closePath(),s.stroke(),s.restore()}}}),Me=se.valueOrDefault,Ce=$.global.defaultColor;function Oe(e){var t=this._view;return!!t&&Math.abs(e-t.x)<t.radius+t.hitRadius}function Le(e){var t=this._view;return!!t&&Math.abs(e-t.y)<t.radius+t.hitRadius}$._set("global",{elements:{point:{radius:3,pointStyle:"circle",backgroundColor:Ce,borderColor:Ce,borderWidth:1,hitRadius:1,hoverRadius:4,hoverBorderWidth:1}}});var Te=ge.extend({_type:"point",inRange:function(e,t){var n=this._view;return!!n&&Math.pow(e-n.x,2)+Math.pow(t-n.y,2)<Math.pow(n.hitRadius+n.radius,2)},inLabelRange:Oe,inXRange:Oe,inYRange:Le,getCenterPoint:function(){var e=this._view;return{x:e.x,y:e.y}},getArea:function(){return Math.PI*Math.pow(this._view.radius,2)},tooltipPosition:function(){var e=this._view;return{x:e.x,y:e.y,padding:e.radius+e.borderWidth}},draw:function(e){var t=this._view,n=this._chart.ctx,r=t.pointStyle,i=t.rotation,s=t.radius,a=t.x,o=t.y,l=$.global,c=l.defaultColor;t.skip||(void 0===e||se.canvas._isPointInArea(t,e))&&(n.strokeStyle=t.borderColor||c,n.lineWidth=Me(t.borderWidth,l.elements.point.borderWidth),n.fillStyle=t.backgroundColor||c,se.canvas.drawPoint(n,r,s,a,o,i))}}),Fe=$.global.defaultColor;function Re(e){return e&&void 0!==e.width}function Ee(e){var t,n,r,i,s;return Re(e)?(s=e.width/2,t=e.x-s,n=e.x+s,r=Math.min(e.y,e.base),i=Math.max(e.y,e.base)):(s=e.height/2,t=Math.min(e.x,e.base),n=Math.max(e.x,e.base),r=e.y-s,i=e.y+s),{left:t,top:r,right:n,bottom:i}}function Ue(e,t,n){return e===t?n:e===n?t:e}function ze(e){var t=e.borderSkipped,n={};return t?(e.horizontal?e.base>e.x&&(t=Ue(t,"left","right")):e.base<e.y&&(t=Ue(t,"bottom","top")),n[t]=!0,n):n}function Be(e,t,n){var r,i,s,a,o=e.borderWidth,l=ze(e);return se.isObject(o)?(r=+o.top||0,i=+o.right||0,s=+o.bottom||0,a=+o.left||0):r=i=s=a=+o||0,{t:l.top||r<0?0:r>n?n:r,r:l.right||i<0?0:i>t?t:i,b:l.bottom||s<0?0:s>n?n:s,l:l.left||a<0?0:a>t?t:a}}function qe(e){var t=Ee(e),n=t.right-t.left,r=t.bottom-t.top,i=Be(e,n/2,r/2);return{outer:{x:t.left,y:t.top,w:n,h:r},inner:{x:t.left+i.l,y:t.top+i.t,w:n-i.l-i.r,h:r-i.t-i.b}}}function Ye(e,t,n){var r=null===t,i=null===n,s=!(!e||r&&i)&&Ee(e);return s&&(r||t>=s.left&&t<=s.right)&&(i||n>=s.top&&n<=s.bottom)}$._set("global",{elements:{rectangle:{backgroundColor:Fe,borderColor:Fe,borderSkipped:"bottom",borderWidth:0}}});var Ve=ge.extend({_type:"rectangle",draw:function(){var e=this._chart.ctx,t=this._view,n=qe(t),r=n.outer,i=n.inner;e.fillStyle=t.backgroundColor,e.fillRect(r.x,r.y,r.w,r.h),r.w===i.w&&r.h===i.h||(e.save(),e.beginPath(),e.rect(r.x,r.y,r.w,r.h),e.clip(),e.fillStyle=t.borderColor,e.rect(i.x,i.y,i.w,i.h),e.fill("evenodd"),e.restore())},height:function(){var e=this._view;return e.base-e.y},inRange:function(e,t){return Ye(this._view,e,t)},inLabelRange:function(e,t){var n=this._view;return Re(n)?Ye(n,e,null):Ye(n,null,t)},inXRange:function(e){return Ye(this._view,e,null)},inYRange:function(e){return Ye(this._view,null,e)},getCenterPoint:function(){var e,t,n=this._view;return Re(n)?(e=n.x,t=(n.y+n.base)/2):(e=(n.x+n.base)/2,t=n.y),{x:e,y:t}},getArea:function(){var e=this._view;return Re(e)?e.width*Math.abs(e.y-e.base):e.height*Math.abs(e.x-e.base)},tooltipPosition:function(){var e=this._view;return{x:e.x,y:e.y}}}),He={},We=Ie,Ge=Ne,Qe=Te,Ke=Ve;He.Arc=We,He.Line=Ge,He.Point=Qe,He.Rectangle=Ke;var Xe=se._deprecated,$e=se.valueOrDefault;function Ze(e,t){var n,r,i,s,a=e._length;for(i=1,s=t.length;i<s;++i)a=Math.min(a,Math.abs(t[i]-t[i-1]));for(i=0,s=e.getTicks().length;i<s;++i)r=e.getPixelForTick(i),a=i>0?Math.min(a,Math.abs(r-n)):a,n=r;return a}function Je(e,t,n){var r,i,s=n.barThickness,a=t.stackCount,o=t.pixels[e],l=se.isNullOrUndef(s)?Ze(t.scale,t.pixels):-1;return se.isNullOrUndef(s)?(r=l*n.categoryPercentage,i=n.barPercentage):(r=s*a,i=1),{chunk:r/a,ratio:i,start:o-r/2}}function et(e,t,n){var r,i=t.pixels,s=i[e],a=e>0?i[e-1]:null,o=e<i.length-1?i[e+1]:null,l=n.categoryPercentage;return null===a&&(a=s-(null===o?t.end-t.start:o-s)),null===o&&(o=s+s-a),r=s-(s-Math.min(a,o))/2*l,{chunk:Math.abs(o-a)/2*l/t.stackCount,ratio:n.barPercentage,start:r}}$._set("bar",{hover:{mode:"label"},scales:{xAxes:[{type:"category",offset:!0,gridLines:{offsetGridLines:!0}}],yAxes:[{type:"linear"}]}}),$._set("global",{datasets:{bar:{categoryPercentage:.8,barPercentage:.9}}});var tt=be.extend({dataElementType:He.Rectangle,_dataElementOptions:["backgroundColor","borderColor","borderSkipped","borderWidth","barPercentage","barThickness","categoryPercentage","maxBarThickness","minBarLength"],initialize:function(){var e,t,n=this;be.prototype.initialize.apply(n,arguments),(e=n.getMeta()).stack=n.getDataset().stack,e.bar=!0,t=n._getIndexScale().options,Xe("bar chart",t.barPercentage,"scales.[x/y]Axes.barPercentage","dataset.barPercentage"),Xe("bar chart",t.barThickness,"scales.[x/y]Axes.barThickness","dataset.barThickness"),Xe("bar chart",t.categoryPercentage,"scales.[x/y]Axes.categoryPercentage","dataset.categoryPercentage"),Xe("bar chart",n._getValueScale().options.minBarLength,"scales.[x/y]Axes.minBarLength","dataset.minBarLength"),Xe("bar chart",t.maxBarThickness,"scales.[x/y]Axes.maxBarThickness","dataset.maxBarThickness")},update:function(e){var t,n,r=this,i=r.getMeta().data;for(r._ruler=r.getRuler(),t=0,n=i.length;t<n;++t)r.updateElement(i[t],t,e)},updateElement:function(e,t,n){var r=this,i=r.getMeta(),s=r.getDataset(),a=r._resolveDataElementOptions(e,t);e._xScale=r.getScaleForId(i.xAxisID),e._yScale=r.getScaleForId(i.yAxisID),e._datasetIndex=r.index,e._index=t,e._model={backgroundColor:a.backgroundColor,borderColor:a.borderColor,borderSkipped:a.borderSkipped,borderWidth:a.borderWidth,datasetLabel:s.label,label:r.chart.data.labels[t]},se.isArray(s.data[t])&&(e._model.borderSkipped=null),r._updateElementGeometry(e,t,n,a),e.pivot()},_updateElementGeometry:function(e,t,n,r){var i=this,s=e._model,a=i._getValueScale(),o=a.getBasePixel(),l=a.isHorizontal(),c=i._ruler||i.getRuler(),d=i.calculateBarValuePixels(i.index,t,r),h=i.calculateBarIndexPixels(i.index,t,c,r);s.horizontal=l,s.base=n?o:d.base,s.x=l?n?o:d.head:h.center,s.y=l?h.center:n?o:d.head,s.height=l?h.size:void 0,s.width=l?void 0:h.size},_getStacks:function(e){var t,n,r=this,i=r._getIndexScale(),s=i._getMatchingVisibleMetas(r._type),a=i.options.stacked,o=s.length,l=[];for(t=0;t<o&&(n=s[t],(!1===a||-1===l.indexOf(n.stack)||void 0===a&&void 0===n.stack)&&l.push(n.stack),n.index!==e);++t);return l},getStackCount:function(){return this._getStacks().length},getStackIndex:function(e,t){var n=this._getStacks(e),r=void 0!==t?n.indexOf(t):-1;return-1===r?n.length-1:r},getRuler:function(){var e,t,n=this,r=n._getIndexScale(),i=[];for(e=0,t=n.getMeta().data.length;e<t;++e)i.push(r.getPixelForValue(null,e,n.index));return{pixels:i,start:r._startPixel,end:r._endPixel,stackCount:n.getStackCount(),scale:r}},calculateBarValuePixels:function(e,t,n){var r,i,s,a,o,l,c,d=this,h=d.chart,u=d._getValueScale(),g=u.isHorizontal(),p=h.data.datasets,m=u._getMatchingVisibleMetas(d._type),f=u._parseValue(p[e].data[t]),x=n.minBarLength,v=u.options.stacked,A=d.getMeta().stack,P=void 0===f.start?0:f.max>=0&&f.min>=0?f.min:f.max,y=void 0===f.start?f.end:f.max>=0&&f.min>=0?f.max-f.min:f.min-f.max,b=m.length;if(v||void 0===v&&void 0!==A)for(r=0;r<b&&(i=m[r]).index!==e;++r)i.stack===A&&(s=void 0===(c=u._parseValue(p[i.index].data[t])).start?c.end:c.min>=0&&c.max>=0?c.max:c.min,(f.min<0&&s<0||f.max>=0&&s>0)&&(P+=s));return a=u.getPixelForValue(P),l=(o=u.getPixelForValue(P+y))-a,void 0!==x&&Math.abs(l)<x&&(l=x,o=y>=0&&!g||y<0&&g?a-x:a+x),{size:l,base:a,head:o,center:o+l/2}},calculateBarIndexPixels:function(e,t,n,r){var i=this,s="flex"===r.barThickness?et(t,n,r):Je(t,n,r),a=i.getStackIndex(e,i.getMeta().stack),o=s.start+s.chunk*a+s.chunk/2,l=Math.min($e(r.maxBarThickness,1/0),s.chunk*s.ratio);return{base:o-l/2,head:o+l/2,center:o,size:l}},draw:function(){var e=this,t=e.chart,n=e._getValueScale(),r=e.getMeta().data,i=e.getDataset(),s=r.length,a=0;for(se.canvas.clipArea(t.ctx,t.chartArea);a<s;++a){var o=n._parseValue(i.data[a]);isNaN(o.min)||isNaN(o.max)||r[a].draw()}se.canvas.unclipArea(t.ctx)},_resolveDataElementOptions:function(){var e=this,t=se.extend({},be.prototype._resolveDataElementOptions.apply(e,arguments)),n=e._getIndexScale().options,r=e._getValueScale().options;return t.barPercentage=$e(n.barPercentage,t.barPercentage),t.barThickness=$e(n.barThickness,t.barThickness),t.categoryPercentage=$e(n.categoryPercentage,t.categoryPercentage),t.maxBarThickness=$e(n.maxBarThickness,t.maxBarThickness),t.minBarLength=$e(r.minBarLength,t.minBarLength),t}}),nt=se.valueOrDefault,rt=se.options.resolve;$._set("bubble",{hover:{mode:"single"},scales:{xAxes:[{type:"linear",position:"bottom",id:"x-axis-0"}],yAxes:[{type:"linear",position:"left",id:"y-axis-0"}]},tooltips:{callbacks:{title:function(){return""},label:function(e,t){var n=t.datasets[e.datasetIndex].label||"",r=t.datasets[e.datasetIndex].data[e.index];return n+": ("+e.xLabel+", "+e.yLabel+", "+r.r+")"}}}});var it=be.extend({dataElementType:He.Point,_dataElementOptions:["backgroundColor","borderColor","borderWidth","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth","hoverRadius","hitRadius","pointStyle","rotation"],update:function(e){var t=this,n=t.getMeta().data;se.each(n,(function(n,r){t.updateElement(n,r,e)}))},updateElement:function(e,t,n){var r=this,i=r.getMeta(),s=e.custom||{},a=r.getScaleForId(i.xAxisID),o=r.getScaleForId(i.yAxisID),l=r._resolveDataElementOptions(e,t),c=r.getDataset().data[t],d=r.index,h=n?a.getPixelForDecimal(.5):a.getPixelForValue("object"===typeof c?c:NaN,t,d),u=n?o.getBasePixel():o.getPixelForValue(c,t,d);e._xScale=a,e._yScale=o,e._options=l,e._datasetIndex=d,e._index=t,e._model={backgroundColor:l.backgroundColor,borderColor:l.borderColor,borderWidth:l.borderWidth,hitRadius:l.hitRadius,pointStyle:l.pointStyle,rotation:l.rotation,radius:n?0:l.radius,skip:s.skip||isNaN(h)||isNaN(u),x:h,y:u},e.pivot()},setHoverStyle:function(e){var t=e._model,n=e._options,r=se.getHoverColor;e.$previousStyle={backgroundColor:t.backgroundColor,borderColor:t.borderColor,borderWidth:t.borderWidth,radius:t.radius},t.backgroundColor=nt(n.hoverBackgroundColor,r(n.backgroundColor)),t.borderColor=nt(n.hoverBorderColor,r(n.borderColor)),t.borderWidth=nt(n.hoverBorderWidth,n.borderWidth),t.radius=n.radius+n.hoverRadius},_resolveDataElementOptions:function(e,t){var n=this,r=n.chart,i=n.getDataset(),s=e.custom||{},a=i.data[t]||{},o=be.prototype._resolveDataElementOptions.apply(n,arguments),l={chart:r,dataIndex:t,dataset:i,datasetIndex:n.index};return n._cachedDataOpts===o&&(o=se.extend({},o)),o.radius=rt([s.radius,a.r,n._config.radius,r.options.elements.point.radius],l,t),o}}),st=se.valueOrDefault,at=Math.PI,ot=2*at,lt=at/2;$._set("doughnut",{animation:{animateRotate:!0,animateScale:!1},hover:{mode:"single"},legendCallback:function(e){var t,n,r,i=document.createElement("ul"),s=e.data,a=s.datasets,o=s.labels;if(i.setAttribute("class",e.id+"-legend"),a.length)for(t=0,n=a[0].data.length;t<n;++t)(r=i.appendChild(document.createElement("li"))).appendChild(document.createElement("span")).style.backgroundColor=a[0].backgroundColor[t],o[t]&&r.appendChild(document.createTextNode(o[t]));return i.outerHTML},legend:{labels:{generateLabels:function(e){var t=e.data;return t.labels.length&&t.datasets.length?t.labels.map((function(n,r){var i=e.getDatasetMeta(0),s=i.controller.getStyle(r);return{text:n,fillStyle:s.backgroundColor,strokeStyle:s.borderColor,lineWidth:s.borderWidth,hidden:isNaN(t.datasets[0].data[r])||i.data[r].hidden,index:r}})):[]}},onClick:function(e,t){var n,r,i,s=t.index,a=this.chart;for(n=0,r=(a.data.datasets||[]).length;n<r;++n)(i=a.getDatasetMeta(n)).data[s]&&(i.data[s].hidden=!i.data[s].hidden);a.update()}},cutoutPercentage:50,rotation:-lt,circumference:ot,tooltips:{callbacks:{title:function(){return""},label:function(e,t){var n=t.labels[e.index],r=": "+t.datasets[e.datasetIndex].data[e.index];return se.isArray(n)?(n=n.slice())[0]+=r:n+=r,n}}}});var ct=be.extend({dataElementType:He.Arc,linkScales:se.noop,_dataElementOptions:["backgroundColor","borderColor","borderWidth","borderAlign","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth"],getRingIndex:function(e){for(var t=0,n=0;n<e;++n)this.chart.isDatasetVisible(n)&&++t;return t},update:function(e){var t,n,r,i,s=this,a=s.chart,o=a.chartArea,l=a.options,c=1,d=1,h=0,u=0,g=s.getMeta(),p=g.data,m=l.cutoutPercentage/100||0,f=l.circumference,x=s._getRingWeight(s.index);if(f<ot){var v=l.rotation%ot,A=(v+=v>=at?-ot:v<-at?ot:0)+f,P=Math.cos(v),y=Math.sin(v),b=Math.cos(A),j=Math.sin(A),S=v<=0&&A>=0||A>=ot,D=v<=lt&&A>=lt||A>=ot+lt,w=v<=-lt&&A>=-lt||A>=at+lt,I=v===-at||A>=at?-1:Math.min(P,P*m,b,b*m),k=w?-1:Math.min(y,y*m,j,j*m),_=S?1:Math.max(P,P*m,b,b*m),N=D?1:Math.max(y,y*m,j,j*m);c=(_-I)/2,d=(N-k)/2,h=-(_+I)/2,u=-(N+k)/2}for(r=0,i=p.length;r<i;++r)p[r]._options=s._resolveDataElementOptions(p[r],r);for(a.borderWidth=s.getMaxBorderWidth(),t=(o.right-o.left-a.borderWidth)/c,n=(o.bottom-o.top-a.borderWidth)/d,a.outerRadius=Math.max(Math.min(t,n)/2,0),a.innerRadius=Math.max(a.outerRadius*m,0),a.radiusLength=(a.outerRadius-a.innerRadius)/(s._getVisibleDatasetWeightTotal()||1),a.offsetX=h*a.outerRadius,a.offsetY=u*a.outerRadius,g.total=s.calculateTotal(),s.outerRadius=a.outerRadius-a.radiusLength*s._getRingWeightOffset(s.index),s.innerRadius=Math.max(s.outerRadius-a.radiusLength*x,0),r=0,i=p.length;r<i;++r)s.updateElement(p[r],r,e)},updateElement:function(e,t,n){var r=this,i=r.chart,s=i.chartArea,a=i.options,o=a.animation,l=(s.left+s.right)/2,c=(s.top+s.bottom)/2,d=a.rotation,h=a.rotation,u=r.getDataset(),g=n&&o.animateRotate||e.hidden?0:r.calculateCircumference(u.data[t])*(a.circumference/ot),p=n&&o.animateScale?0:r.innerRadius,m=n&&o.animateScale?0:r.outerRadius,f=e._options||{};se.extend(e,{_datasetIndex:r.index,_index:t,_model:{backgroundColor:f.backgroundColor,borderColor:f.borderColor,borderWidth:f.borderWidth,borderAlign:f.borderAlign,x:l+i.offsetX,y:c+i.offsetY,startAngle:d,endAngle:h,circumference:g,outerRadius:m,innerRadius:p,label:se.valueAtIndexOrDefault(u.label,t,i.data.labels[t])}});var x=e._model;n&&o.animateRotate||(x.startAngle=0===t?a.rotation:r.getMeta().data[t-1]._model.endAngle,x.endAngle=x.startAngle+x.circumference),e.pivot()},calculateTotal:function(){var e,t=this.getDataset(),n=this.getMeta(),r=0;return se.each(n.data,(function(n,i){e=t.data[i],isNaN(e)||n.hidden||(r+=Math.abs(e))})),r},calculateCircumference:function(e){var t=this.getMeta().total;return t>0&&!isNaN(e)?ot*(Math.abs(e)/t):0},getMaxBorderWidth:function(e){var t,n,r,i,s,a,o,l,c=this,d=0,h=c.chart;if(!e)for(t=0,n=h.data.datasets.length;t<n;++t)if(h.isDatasetVisible(t)){e=(r=h.getDatasetMeta(t)).data,t!==c.index&&(s=r.controller);break}if(!e)return 0;for(t=0,n=e.length;t<n;++t)i=e[t],s?(s._configure(),a=s._resolveDataElementOptions(i,t)):a=i._options,"inner"!==a.borderAlign&&(o=a.borderWidth,d=(l=a.hoverBorderWidth)>(d=o>d?o:d)?l:d);return d},setHoverStyle:function(e){var t=e._model,n=e._options,r=se.getHoverColor;e.$previousStyle={backgroundColor:t.backgroundColor,borderColor:t.borderColor,borderWidth:t.borderWidth},t.backgroundColor=st(n.hoverBackgroundColor,r(n.backgroundColor)),t.borderColor=st(n.hoverBorderColor,r(n.borderColor)),t.borderWidth=st(n.hoverBorderWidth,n.borderWidth)},_getRingWeightOffset:function(e){for(var t=0,n=0;n<e;++n)this.chart.isDatasetVisible(n)&&(t+=this._getRingWeight(n));return t},_getRingWeight:function(e){return Math.max(st(this.chart.data.datasets[e].weight,1),0)},_getVisibleDatasetWeightTotal:function(){return this._getRingWeightOffset(this.chart.data.datasets.length)}});$._set("horizontalBar",{hover:{mode:"index",axis:"y"},scales:{xAxes:[{type:"linear",position:"bottom"}],yAxes:[{type:"category",position:"left",offset:!0,gridLines:{offsetGridLines:!0}}]},elements:{rectangle:{borderSkipped:"left"}},tooltips:{mode:"index",axis:"y"}}),$._set("global",{datasets:{horizontalBar:{categoryPercentage:.8,barPercentage:.9}}});var dt=tt.extend({_getValueScaleId:function(){return this.getMeta().xAxisID},_getIndexScaleId:function(){return this.getMeta().yAxisID}}),ht=se.valueOrDefault,ut=se.options.resolve,gt=se.canvas._isPointInArea;function pt(e,t){var n=e&&e.options.ticks||{},r=n.reverse,i=void 0===n.min?t:0,s=void 0===n.max?t:0;return{start:r?s:i,end:r?i:s}}function mt(e,t,n){var r=n/2,i=pt(e,r),s=pt(t,r);return{top:s.end,right:i.end,bottom:s.start,left:i.start}}function ft(e){var t,n,r,i;return se.isObject(e)?(t=e.top,n=e.right,r=e.bottom,i=e.left):t=n=r=i=e,{top:t,right:n,bottom:r,left:i}}$._set("line",{showLines:!0,spanGaps:!1,hover:{mode:"label"},scales:{xAxes:[{type:"category",id:"x-axis-0"}],yAxes:[{type:"linear",id:"y-axis-0"}]}});var xt=be.extend({datasetElementType:He.Line,dataElementType:He.Point,_datasetElementOptions:["backgroundColor","borderCapStyle","borderColor","borderDash","borderDashOffset","borderJoinStyle","borderWidth","cubicInterpolationMode","fill"],_dataElementOptions:{backgroundColor:"pointBackgroundColor",borderColor:"pointBorderColor",borderWidth:"pointBorderWidth",hitRadius:"pointHitRadius",hoverBackgroundColor:"pointHoverBackgroundColor",hoverBorderColor:"pointHoverBorderColor",hoverBorderWidth:"pointHoverBorderWidth",hoverRadius:"pointHoverRadius",pointStyle:"pointStyle",radius:"pointRadius",rotation:"pointRotation"},update:function(e){var t,n,r=this,i=r.getMeta(),s=i.dataset,a=i.data||[],o=r.chart.options,l=r._config,c=r._showLine=ht(l.showLine,o.showLines);for(r._xScale=r.getScaleForId(i.xAxisID),r._yScale=r.getScaleForId(i.yAxisID),c&&(void 0!==l.tension&&void 0===l.lineTension&&(l.lineTension=l.tension),s._scale=r._yScale,s._datasetIndex=r.index,s._children=a,s._model=r._resolveDatasetElementOptions(s),s.pivot()),t=0,n=a.length;t<n;++t)r.updateElement(a[t],t,e);for(c&&0!==s._model.tension&&r.updateBezierControlPoints(),t=0,n=a.length;t<n;++t)a[t].pivot()},updateElement:function(e,t,n){var r,i,s=this,a=s.getMeta(),o=e.custom||{},l=s.getDataset(),c=s.index,d=l.data[t],h=s._xScale,u=s._yScale,g=a.dataset._model,p=s._resolveDataElementOptions(e,t);r=h.getPixelForValue("object"===typeof d?d:NaN,t,c),i=n?u.getBasePixel():s.calculatePointY(d,t,c),e._xScale=h,e._yScale=u,e._options=p,e._datasetIndex=c,e._index=t,e._model={x:r,y:i,skip:o.skip||isNaN(r)||isNaN(i),radius:p.radius,pointStyle:p.pointStyle,rotation:p.rotation,backgroundColor:p.backgroundColor,borderColor:p.borderColor,borderWidth:p.borderWidth,tension:ht(o.tension,g?g.tension:0),steppedLine:!!g&&g.steppedLine,hitRadius:p.hitRadius}},_resolveDatasetElementOptions:function(e){var t=this,n=t._config,r=e.custom||{},i=t.chart.options,s=i.elements.line,a=be.prototype._resolveDatasetElementOptions.apply(t,arguments);return a.spanGaps=ht(n.spanGaps,i.spanGaps),a.tension=ht(n.lineTension,s.tension),a.steppedLine=ut([r.steppedLine,n.steppedLine,s.stepped]),a.clip=ft(ht(n.clip,mt(t._xScale,t._yScale,a.borderWidth))),a},calculatePointY:function(e,t,n){var r,i,s,a,o,l,c,d=this,h=d.chart,u=d._yScale,g=0,p=0;if(u.options.stacked){for(o=+u.getRightValue(e),c=(l=h._getSortedVisibleDatasetMetas()).length,r=0;r<c&&(s=l[r]).index!==n;++r)i=h.data.datasets[s.index],"line"===s.type&&s.yAxisID===u.id&&((a=+u.getRightValue(i.data[t]))<0?p+=a||0:g+=a||0);return o<0?u.getPixelForValue(p+o):u.getPixelForValue(g+o)}return u.getPixelForValue(e)},updateBezierControlPoints:function(){var e,t,n,r,i=this,s=i.chart,a=i.getMeta(),o=a.dataset._model,l=s.chartArea,c=a.data||[];function d(e,t,n){return Math.max(Math.min(e,n),t)}if(o.spanGaps&&(c=c.filter((function(e){return!e._model.skip}))),"monotone"===o.cubicInterpolationMode)se.splineCurveMonotone(c);else for(e=0,t=c.length;e<t;++e)n=c[e]._model,r=se.splineCurve(se.previousItem(c,e)._model,n,se.nextItem(c,e)._model,o.tension),n.controlPointPreviousX=r.previous.x,n.controlPointPreviousY=r.previous.y,n.controlPointNextX=r.next.x,n.controlPointNextY=r.next.y;if(s.options.elements.line.capBezierPoints)for(e=0,t=c.length;e<t;++e)n=c[e]._model,gt(n,l)&&(e>0&&gt(c[e-1]._model,l)&&(n.controlPointPreviousX=d(n.controlPointPreviousX,l.left,l.right),n.controlPointPreviousY=d(n.controlPointPreviousY,l.top,l.bottom)),e<c.length-1&&gt(c[e+1]._model,l)&&(n.controlPointNextX=d(n.controlPointNextX,l.left,l.right),n.controlPointNextY=d(n.controlPointNextY,l.top,l.bottom)))},draw:function(){var e,t=this,n=t.chart,r=t.getMeta(),i=r.data||[],s=n.chartArea,a=n.canvas,o=0,l=i.length;for(t._showLine&&(e=r.dataset._model.clip,se.canvas.clipArea(n.ctx,{left:!1===e.left?0:s.left-e.left,right:!1===e.right?a.width:s.right+e.right,top:!1===e.top?0:s.top-e.top,bottom:!1===e.bottom?a.height:s.bottom+e.bottom}),r.dataset.draw(),se.canvas.unclipArea(n.ctx));o<l;++o)i[o].draw(s)},setHoverStyle:function(e){var t=e._model,n=e._options,r=se.getHoverColor;e.$previousStyle={backgroundColor:t.backgroundColor,borderColor:t.borderColor,borderWidth:t.borderWidth,radius:t.radius},t.backgroundColor=ht(n.hoverBackgroundColor,r(n.backgroundColor)),t.borderColor=ht(n.hoverBorderColor,r(n.borderColor)),t.borderWidth=ht(n.hoverBorderWidth,n.borderWidth),t.radius=ht(n.hoverRadius,n.radius)}}),vt=se.options.resolve;$._set("polarArea",{scale:{type:"radialLinear",angleLines:{display:!1},gridLines:{circular:!0},pointLabels:{display:!1},ticks:{beginAtZero:!0}},animation:{animateRotate:!0,animateScale:!0},startAngle:-.5*Math.PI,legendCallback:function(e){var t,n,r,i=document.createElement("ul"),s=e.data,a=s.datasets,o=s.labels;if(i.setAttribute("class",e.id+"-legend"),a.length)for(t=0,n=a[0].data.length;t<n;++t)(r=i.appendChild(document.createElement("li"))).appendChild(document.createElement("span")).style.backgroundColor=a[0].backgroundColor[t],o[t]&&r.appendChild(document.createTextNode(o[t]));return i.outerHTML},legend:{labels:{generateLabels:function(e){var t=e.data;return t.labels.length&&t.datasets.length?t.labels.map((function(n,r){var i=e.getDatasetMeta(0),s=i.controller.getStyle(r);return{text:n,fillStyle:s.backgroundColor,strokeStyle:s.borderColor,lineWidth:s.borderWidth,hidden:isNaN(t.datasets[0].data[r])||i.data[r].hidden,index:r}})):[]}},onClick:function(e,t){var n,r,i,s=t.index,a=this.chart;for(n=0,r=(a.data.datasets||[]).length;n<r;++n)(i=a.getDatasetMeta(n)).data[s].hidden=!i.data[s].hidden;a.update()}},tooltips:{callbacks:{title:function(){return""},label:function(e,t){return t.labels[e.index]+": "+e.yLabel}}}});var At=be.extend({dataElementType:He.Arc,linkScales:se.noop,_dataElementOptions:["backgroundColor","borderColor","borderWidth","borderAlign","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth"],_getIndexScaleId:function(){return this.chart.scale.id},_getValueScaleId:function(){return this.chart.scale.id},update:function(e){var t,n,r,i=this,s=i.getDataset(),a=i.getMeta(),o=i.chart.options.startAngle||0,l=i._starts=[],c=i._angles=[],d=a.data;for(i._updateRadius(),a.count=i.countVisibleElements(),t=0,n=s.data.length;t<n;t++)l[t]=o,r=i._computeAngle(t),c[t]=r,o+=r;for(t=0,n=d.length;t<n;++t)d[t]._options=i._resolveDataElementOptions(d[t],t),i.updateElement(d[t],t,e)},_updateRadius:function(){var e=this,t=e.chart,n=t.chartArea,r=t.options,i=Math.min(n.right-n.left,n.bottom-n.top);t.outerRadius=Math.max(i/2,0),t.innerRadius=Math.max(r.cutoutPercentage?t.outerRadius/100*r.cutoutPercentage:1,0),t.radiusLength=(t.outerRadius-t.innerRadius)/t.getVisibleDatasetCount(),e.outerRadius=t.outerRadius-t.radiusLength*e.index,e.innerRadius=e.outerRadius-t.radiusLength},updateElement:function(e,t,n){var r=this,i=r.chart,s=r.getDataset(),a=i.options,o=a.animation,l=i.scale,c=i.data.labels,d=l.xCenter,h=l.yCenter,u=a.startAngle,g=e.hidden?0:l.getDistanceFromCenterForValue(s.data[t]),p=r._starts[t],m=p+(e.hidden?0:r._angles[t]),f=o.animateScale?0:l.getDistanceFromCenterForValue(s.data[t]),x=e._options||{};se.extend(e,{_datasetIndex:r.index,_index:t,_scale:l,_model:{backgroundColor:x.backgroundColor,borderColor:x.borderColor,borderWidth:x.borderWidth,borderAlign:x.borderAlign,x:d,y:h,innerRadius:0,outerRadius:n?f:g,startAngle:n&&o.animateRotate?u:p,endAngle:n&&o.animateRotate?u:m,label:se.valueAtIndexOrDefault(c,t,c[t])}}),e.pivot()},countVisibleElements:function(){var e=this.getDataset(),t=this.getMeta(),n=0;return se.each(t.data,(function(t,r){isNaN(e.data[r])||t.hidden||n++})),n},setHoverStyle:function(e){var t=e._model,n=e._options,r=se.getHoverColor,i=se.valueOrDefault;e.$previousStyle={backgroundColor:t.backgroundColor,borderColor:t.borderColor,borderWidth:t.borderWidth},t.backgroundColor=i(n.hoverBackgroundColor,r(n.backgroundColor)),t.borderColor=i(n.hoverBorderColor,r(n.borderColor)),t.borderWidth=i(n.hoverBorderWidth,n.borderWidth)},_computeAngle:function(e){var t=this,n=this.getMeta().count,r=t.getDataset(),i=t.getMeta();if(isNaN(r.data[e])||i.data[e].hidden)return 0;var s={chart:t.chart,dataIndex:e,dataset:r,datasetIndex:t.index};return vt([t.chart.options.elements.arc.angle,2*Math.PI/n],s,e)}});$._set("pie",se.clone($.doughnut)),$._set("pie",{cutoutPercentage:0});var Pt=ct,yt=se.valueOrDefault;$._set("radar",{spanGaps:!1,scale:{type:"radialLinear"},elements:{line:{fill:"start",tension:0}}});var bt=be.extend({datasetElementType:He.Line,dataElementType:He.Point,linkScales:se.noop,_datasetElementOptions:["backgroundColor","borderWidth","borderColor","borderCapStyle","borderDash","borderDashOffset","borderJoinStyle","fill"],_dataElementOptions:{backgroundColor:"pointBackgroundColor",borderColor:"pointBorderColor",borderWidth:"pointBorderWidth",hitRadius:"pointHitRadius",hoverBackgroundColor:"pointHoverBackgroundColor",hoverBorderColor:"pointHoverBorderColor",hoverBorderWidth:"pointHoverBorderWidth",hoverRadius:"pointHoverRadius",pointStyle:"pointStyle",radius:"pointRadius",rotation:"pointRotation"},_getIndexScaleId:function(){return this.chart.scale.id},_getValueScaleId:function(){return this.chart.scale.id},update:function(e){var t,n,r=this,i=r.getMeta(),s=i.dataset,a=i.data||[],o=r.chart.scale,l=r._config;for(void 0!==l.tension&&void 0===l.lineTension&&(l.lineTension=l.tension),s._scale=o,s._datasetIndex=r.index,s._children=a,s._loop=!0,s._model=r._resolveDatasetElementOptions(s),s.pivot(),t=0,n=a.length;t<n;++t)r.updateElement(a[t],t,e);for(r.updateBezierControlPoints(),t=0,n=a.length;t<n;++t)a[t].pivot()},updateElement:function(e,t,n){var r=this,i=e.custom||{},s=r.getDataset(),a=r.chart.scale,o=a.getPointPositionForValue(t,s.data[t]),l=r._resolveDataElementOptions(e,t),c=r.getMeta().dataset._model,d=n?a.xCenter:o.x,h=n?a.yCenter:o.y;e._scale=a,e._options=l,e._datasetIndex=r.index,e._index=t,e._model={x:d,y:h,skip:i.skip||isNaN(d)||isNaN(h),radius:l.radius,pointStyle:l.pointStyle,rotation:l.rotation,backgroundColor:l.backgroundColor,borderColor:l.borderColor,borderWidth:l.borderWidth,tension:yt(i.tension,c?c.tension:0),hitRadius:l.hitRadius}},_resolveDatasetElementOptions:function(){var e=this,t=e._config,n=e.chart.options,r=be.prototype._resolveDatasetElementOptions.apply(e,arguments);return r.spanGaps=yt(t.spanGaps,n.spanGaps),r.tension=yt(t.lineTension,n.elements.line.tension),r},updateBezierControlPoints:function(){var e,t,n,r,i=this,s=i.getMeta(),a=i.chart.chartArea,o=s.data||[];function l(e,t,n){return Math.max(Math.min(e,n),t)}for(s.dataset._model.spanGaps&&(o=o.filter((function(e){return!e._model.skip}))),e=0,t=o.length;e<t;++e)n=o[e]._model,r=se.splineCurve(se.previousItem(o,e,!0)._model,n,se.nextItem(o,e,!0)._model,n.tension),n.controlPointPreviousX=l(r.previous.x,a.left,a.right),n.controlPointPreviousY=l(r.previous.y,a.top,a.bottom),n.controlPointNextX=l(r.next.x,a.left,a.right),n.controlPointNextY=l(r.next.y,a.top,a.bottom)},setHoverStyle:function(e){var t=e._model,n=e._options,r=se.getHoverColor;e.$previousStyle={backgroundColor:t.backgroundColor,borderColor:t.borderColor,borderWidth:t.borderWidth,radius:t.radius},t.backgroundColor=yt(n.hoverBackgroundColor,r(n.backgroundColor)),t.borderColor=yt(n.hoverBorderColor,r(n.borderColor)),t.borderWidth=yt(n.hoverBorderWidth,n.borderWidth),t.radius=yt(n.hoverRadius,n.radius)}});$._set("scatter",{hover:{mode:"single"},scales:{xAxes:[{id:"x-axis-1",type:"linear",position:"bottom"}],yAxes:[{id:"y-axis-1",type:"linear",position:"left"}]},tooltips:{callbacks:{title:function(){return""},label:function(e){return"("+e.xLabel+", "+e.yLabel+")"}}}}),$._set("global",{datasets:{scatter:{showLine:!1}}});var jt={bar:tt,bubble:it,doughnut:ct,horizontalBar:dt,line:xt,polarArea:At,pie:Pt,radar:bt,scatter:xt};function St(e,t){return e.native?{x:e.x,y:e.y}:se.getRelativePosition(e,t)}function Dt(e,t){var n,r,i,s,a,o,l=e._getSortedVisibleDatasetMetas();for(r=0,s=l.length;r<s;++r)for(i=0,a=(n=l[r].data).length;i<a;++i)(o=n[i])._view.skip||t(o)}function wt(e,t){var n=[];return Dt(e,(function(e){e.inRange(t.x,t.y)&&n.push(e)})),n}function It(e,t,n,r){var i=Number.POSITIVE_INFINITY,s=[];return Dt(e,(function(e){if(!n||e.inRange(t.x,t.y)){var a=e.getCenterPoint(),o=r(t,a);o<i?(s=[e],i=o):o===i&&s.push(e)}})),s}function kt(e){var t=-1!==e.indexOf("x"),n=-1!==e.indexOf("y");return function(e,r){var i=t?Math.abs(e.x-r.x):0,s=n?Math.abs(e.y-r.y):0;return Math.sqrt(Math.pow(i,2)+Math.pow(s,2))}}function _t(e,t,n){var r=St(t,e);n.axis=n.axis||"x";var i=kt(n.axis),s=n.intersect?wt(e,r):It(e,r,!1,i),a=[];return s.length?(e._getSortedVisibleDatasetMetas().forEach((function(e){var t=e.data[s[0]._index];t&&!t._view.skip&&a.push(t)})),a):[]}var Nt={modes:{single:function(e,t){var n=St(t,e),r=[];return Dt(e,(function(e){if(e.inRange(n.x,n.y))return r.push(e),r})),r.slice(0,1)},label:_t,index:_t,dataset:function(e,t,n){var r=St(t,e);n.axis=n.axis||"xy";var i=kt(n.axis),s=n.intersect?wt(e,r):It(e,r,!1,i);return s.length>0&&(s=e.getDatasetMeta(s[0]._datasetIndex).data),s},"x-axis":function(e,t){return _t(e,t,{intersect:!1})},point:function(e,t){return wt(e,St(t,e))},nearest:function(e,t,n){var r=St(t,e);n.axis=n.axis||"xy";var i=kt(n.axis);return It(e,r,n.intersect,i)},x:function(e,t,n){var r=St(t,e),i=[],s=!1;return Dt(e,(function(e){e.inXRange(r.x)&&i.push(e),e.inRange(r.x,r.y)&&(s=!0)})),n.intersect&&!s&&(i=[]),i},y:function(e,t,n){var r=St(t,e),i=[],s=!1;return Dt(e,(function(e){e.inYRange(r.y)&&i.push(e),e.inRange(r.x,r.y)&&(s=!0)})),n.intersect&&!s&&(i=[]),i}}},Mt=se.extend;function Ct(e,t){return se.where(e,(function(e){return e.pos===t}))}function Ot(e,t){return e.sort((function(e,n){var r=t?n:e,i=t?e:n;return r.weight===i.weight?r.index-i.index:r.weight-i.weight}))}function Lt(e){var t,n,r,i=[];for(t=0,n=(e||[]).length;t<n;++t)r=e[t],i.push({index:t,box:r,pos:r.position,horizontal:r.isHorizontal(),weight:r.weight});return i}function Tt(e,t){var n,r,i;for(n=0,r=e.length;n<r;++n)(i=e[n]).width=i.horizontal?i.box.fullWidth&&t.availableWidth:t.vBoxMaxWidth,i.height=i.horizontal&&t.hBoxMaxHeight}function Ft(e){var t=Lt(e),n=Ot(Ct(t,"left"),!0),r=Ot(Ct(t,"right")),i=Ot(Ct(t,"top"),!0),s=Ot(Ct(t,"bottom"));return{leftAndTop:n.concat(i),rightAndBottom:r.concat(s),chartArea:Ct(t,"chartArea"),vertical:n.concat(r),horizontal:i.concat(s)}}function Rt(e,t,n,r){return Math.max(e[n],t[n])+Math.max(e[r],t[r])}function Et(e,t,n){var r,i,s=n.box,a=e.maxPadding;if(n.size&&(e[n.pos]-=n.size),n.size=n.horizontal?s.height:s.width,e[n.pos]+=n.size,s.getPadding){var o=s.getPadding();a.top=Math.max(a.top,o.top),a.left=Math.max(a.left,o.left),a.bottom=Math.max(a.bottom,o.bottom),a.right=Math.max(a.right,o.right)}if(r=t.outerWidth-Rt(a,e,"left","right"),i=t.outerHeight-Rt(a,e,"top","bottom"),r!==e.w||i!==e.h){e.w=r,e.h=i;var l=n.horizontal?[r,e.w]:[i,e.h];return l[0]!==l[1]&&(!isNaN(l[0])||!isNaN(l[1]))}}function Ut(e){var t=e.maxPadding;function n(n){var r=Math.max(t[n]-e[n],0);return e[n]+=r,r}e.y+=n("top"),e.x+=n("left"),n("right"),n("bottom")}function zt(e,t){var n=t.maxPadding;function r(e){var r={left:0,top:0,right:0,bottom:0};return e.forEach((function(e){r[e]=Math.max(t[e],n[e])})),r}return r(e?["left","right"]:["top","bottom"])}function Bt(e,t,n){var r,i,s,a,o,l,c=[];for(r=0,i=e.length;r<i;++r)(a=(s=e[r]).box).update(s.width||t.w,s.height||t.h,zt(s.horizontal,t)),Et(t,n,s)&&(l=!0,c.length&&(o=!0)),a.fullWidth||c.push(s);return o&&Bt(c,t,n)||l}function qt(e,t,n){var r,i,s,a,o=n.padding,l=t.x,c=t.y;for(r=0,i=e.length;r<i;++r)a=(s=e[r]).box,s.horizontal?(a.left=a.fullWidth?o.left:t.left,a.right=a.fullWidth?n.outerWidth-o.right:t.left+t.w,a.top=c,a.bottom=c+a.height,a.width=a.right-a.left,c=a.bottom):(a.left=l,a.right=l+a.width,a.top=t.top,a.bottom=t.top+t.h,a.height=a.bottom-a.top,l=a.right);t.x=l,t.y=c}$._set("global",{layout:{padding:{top:0,right:0,bottom:0,left:0}}});var Yt={defaults:{},addBox:function(e,t){e.boxes||(e.boxes=[]),t.fullWidth=t.fullWidth||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw:function(){t.draw.apply(t,arguments)}}]},e.boxes.push(t)},removeBox:function(e,t){var n=e.boxes?e.boxes.indexOf(t):-1;-1!==n&&e.boxes.splice(n,1)},configure:function(e,t,n){for(var r,i=["fullWidth","position","weight"],s=i.length,a=0;a<s;++a)r=i[a],n.hasOwnProperty(r)&&(t[r]=n[r])},update:function(e,t,n){if(e){var r=e.options.layout||{},i=se.options.toPadding(r.padding),s=t-i.width,a=n-i.height,o=Ft(e.boxes),l=o.vertical,c=o.horizontal,d=Object.freeze({outerWidth:t,outerHeight:n,padding:i,availableWidth:s,vBoxMaxWidth:s/2/l.length,hBoxMaxHeight:a/2}),h=Mt({maxPadding:Mt({},i),w:s,h:a,x:i.left,y:i.top},i);Tt(l.concat(c),d),Bt(l,h,d),Bt(c,h,d)&&Bt(l,h,d),Ut(h),qt(o.leftAndTop,h,d),h.x+=h.w,h.y+=h.h,qt(o.rightAndBottom,h,d),e.chartArea={left:h.left,top:h.top,right:h.left+h.w,bottom:h.top+h.h},se.each(o.chartArea,(function(t){var n=t.box;Mt(n,e.chartArea),n.update(h.w,h.h)}))}}},Vt={acquireContext:function(e){return e&&e.canvas&&(e=e.canvas),e&&e.getContext("2d")||null}},Ht="/*\r\n * DOM element rendering detection\r\n * https://davidwalsh.name/detect-node-insertion\r\n */\r\n@keyframes chartjs-render-animation {\r\n\tfrom { opacity: 0.99; }\r\n\tto { opacity: 1; }\r\n}\r\n\r\n.chartjs-render-monitor {\r\n\tanimation: chartjs-render-animation 0.001s;\r\n}\r\n\r\n/*\r\n * DOM element resizing detection\r\n * https://github.com/marcj/css-element-queries\r\n */\r\n.chartjs-size-monitor,\r\n.chartjs-size-monitor-expand,\r\n.chartjs-size-monitor-shrink {\r\n\tposition: absolute;\r\n\tdirection: ltr;\r\n\tleft: 0;\r\n\ttop: 0;\r\n\tright: 0;\r\n\tbottom: 0;\r\n\toverflow: hidden;\r\n\tpointer-events: none;\r\n\tvisibility: hidden;\r\n\tz-index: -1;\r\n}\r\n\r\n.chartjs-size-monitor-expand > div {\r\n\tposition: absolute;\r\n\twidth: 1000000px;\r\n\theight: 1000000px;\r\n\tleft: 0;\r\n\ttop: 0;\r\n}\r\n\r\n.chartjs-size-monitor-shrink > div {\r\n\tposition: absolute;\r\n\twidth: 200%;\r\n\theight: 200%;\r\n\tleft: 0;\r\n\ttop: 0;\r\n}\r\n",Wt=n(Object.freeze({__proto__:null,default:Ht})),Gt="$chartjs",Qt="chartjs-",Kt=Qt+"size-monitor",Xt=Qt+"render-monitor",$t=Qt+"render-animation",Zt=["animationstart","webkitAnimationStart"],Jt={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"};function en(e,t){var n=se.getStyle(e,t),r=n&&n.match(/^(\d+)(\.\d+)?px$/);return r?Number(r[1]):void 0}function tn(e,t){var n=e.style,r=e.getAttribute("height"),i=e.getAttribute("width");if(e[Gt]={initial:{height:r,width:i,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",null===i||""===i){var s=en(e,"width");void 0!==s&&(e.width=s)}if(null===r||""===r)if(""===e.style.height)e.height=e.width/(t.options.aspectRatio||2);else{var a=en(e,"height");void 0!==s&&(e.height=a)}return e}var nn=!!function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("e",null,t)}catch(n){}return e}()&&{passive:!0};function rn(e,t,n){e.addEventListener(t,n,nn)}function sn(e,t,n){e.removeEventListener(t,n,nn)}function an(e,t,n,r,i){return{type:e,chart:t,native:i||null,x:void 0!==n?n:null,y:void 0!==r?r:null}}function on(e,t){var n=Jt[e.type]||e.type,r=se.getRelativePosition(e,t);return an(n,t,r.x,r.y,e)}function ln(e,t){var n=!1,r=[];return function(){r=Array.prototype.slice.call(arguments),t=t||this,n||(n=!0,se.requestAnimFrame.call(window,(function(){n=!1,e.apply(t,r)})))}}function cn(e){var t=document.createElement("div");return t.className=e||"",t}function dn(e){var t=1e6,n=cn(Kt),r=cn(Kt+"-expand"),i=cn(Kt+"-shrink");r.appendChild(cn()),i.appendChild(cn()),n.appendChild(r),n.appendChild(i),n._reset=function(){r.scrollLeft=t,r.scrollTop=t,i.scrollLeft=t,i.scrollTop=t};var s=function(){n._reset(),e()};return rn(r,"scroll",s.bind(r,"expand")),rn(i,"scroll",s.bind(i,"shrink")),n}function hn(e,t){var n=e[Gt]||(e[Gt]={}),r=n.renderProxy=function(e){e.animationName===$t&&t()};se.each(Zt,(function(t){rn(e,t,r)})),n.reflow=!!e.offsetParent,e.classList.add(Xt)}function un(e){var t=e[Gt]||{},n=t.renderProxy;n&&(se.each(Zt,(function(t){sn(e,t,n)})),delete t.renderProxy),e.classList.remove(Xt)}function gn(e,t,n){var r=e[Gt]||(e[Gt]={}),i=r.resizer=dn(ln((function(){if(r.resizer){var i=n.options.maintainAspectRatio&&e.parentNode,s=i?i.clientWidth:0;t(an("resize",n)),i&&i.clientWidth<s&&n.canvas&&t(an("resize",n))}})));hn(e,(function(){if(r.resizer){var t=e.parentNode;t&&t!==i.parentNode&&t.insertBefore(i,t.firstChild),i._reset()}}))}function pn(e){var t=e[Gt]||{},n=t.resizer;delete t.resizer,un(e),n&&n.parentNode&&n.parentNode.removeChild(n)}function mn(e,t){var n=e[Gt]||(e[Gt]={});if(!n.containsStyles){n.containsStyles=!0,t="/* Chart.js */\n"+t;var r=document.createElement("style");r.setAttribute("type","text/css"),r.appendChild(document.createTextNode(t)),e.appendChild(r)}}var fn={disableCSSInjection:!1,_enabled:"undefined"!==typeof window&&"undefined"!==typeof document,_ensureLoaded:function(e){if(!this.disableCSSInjection){var t=e.getRootNode?e.getRootNode():document;mn(t.host?t:document.head,Wt)}},acquireContext:function(e,t){"string"===typeof e?e=document.getElementById(e):e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas);var n=e&&e.getContext&&e.getContext("2d");return n&&n.canvas===e?(this._ensureLoaded(e),tn(e,t),n):null},releaseContext:function(e){var t=e.canvas;if(t[Gt]){var n=t[Gt].initial;["height","width"].forEach((function(e){var r=n[e];se.isNullOrUndef(r)?t.removeAttribute(e):t.setAttribute(e,r)})),se.each(n.style||{},(function(e,n){t.style[n]=e})),t.width=t.width,delete t[Gt]}},addEventListener:function(e,t,n){var r=e.canvas;if("resize"!==t){var i=n[Gt]||(n[Gt]={});rn(r,t,(i.proxies||(i.proxies={}))[e.id+"_"+t]=function(t){n(on(t,e))})}else gn(r,n,e)},removeEventListener:function(e,t,n){var r=e.canvas;if("resize"!==t){var i=((n[Gt]||{}).proxies||{})[e.id+"_"+t];i&&sn(r,t,i)}else pn(r)}};se.addEvent=rn,se.removeEvent=sn;var xn=fn._enabled?fn:Vt,vn=se.extend({initialize:function(){},acquireContext:function(){},releaseContext:function(){},addEventListener:function(){},removeEventListener:function(){}},xn);$._set("global",{plugins:{}});var An={_plugins:[],_cacheId:0,register:function(e){var t=this._plugins;[].concat(e).forEach((function(e){-1===t.indexOf(e)&&t.push(e)})),this._cacheId++},unregister:function(e){var t=this._plugins;[].concat(e).forEach((function(e){var n=t.indexOf(e);-1!==n&&t.splice(n,1)})),this._cacheId++},clear:function(){this._plugins=[],this._cacheId++},count:function(){return this._plugins.length},getAll:function(){return this._plugins},notify:function(e,t,n){var r,i,s,a,o,l=this.descriptors(e),c=l.length;for(r=0;r<c;++r)if("function"===typeof(o=(s=(i=l[r]).plugin)[t])&&((a=[e].concat(n||[])).push(i.options),!1===o.apply(s,a)))return!1;return!0},descriptors:function(e){var t=e.$plugins||(e.$plugins={});if(t.id===this._cacheId)return t.descriptors;var n=[],r=[],i=e&&e.config||{},s=i.options&&i.options.plugins||{};return this._plugins.concat(i.plugins||[]).forEach((function(e){if(-1===n.indexOf(e)){var t=e.id,i=s[t];!1!==i&&(!0===i&&(i=se.clone($.global.plugins[t])),n.push(e),r.push({plugin:e,options:i||{}}))}})),t.descriptors=r,t.id=this._cacheId,r},_invalidate:function(e){delete e.$plugins}},Pn={constructors:{},defaults:{},registerScaleType:function(e,t,n){this.constructors[e]=t,this.defaults[e]=se.clone(n)},getScaleConstructor:function(e){return this.constructors.hasOwnProperty(e)?this.constructors[e]:void 0},getScaleDefaults:function(e){return this.defaults.hasOwnProperty(e)?se.merge(Object.create(null),[$.scale,this.defaults[e]]):{}},updateScaleDefaults:function(e,t){var n=this;n.defaults.hasOwnProperty(e)&&(n.defaults[e]=se.extend(n.defaults[e],t))},addScalesToLayout:function(e){se.each(e.scales,(function(t){t.fullWidth=t.options.fullWidth,t.position=t.options.position,t.weight=t.options.weight,Yt.addBox(e,t)}))}},yn=se.valueOrDefault,bn=se.rtl.getRtlAdapter;$._set("global",{tooltips:{enabled:!0,custom:null,mode:"nearest",position:"average",intersect:!0,backgroundColor:"rgba(0,0,0,0.8)",titleFontStyle:"bold",titleSpacing:2,titleMarginBottom:6,titleFontColor:"#fff",titleAlign:"left",bodySpacing:2,bodyFontColor:"#fff",bodyAlign:"left",footerFontStyle:"bold",footerSpacing:2,footerMarginTop:6,footerFontColor:"#fff",footerAlign:"left",yPadding:6,xPadding:6,caretPadding:2,caretSize:5,cornerRadius:6,multiKeyBackground:"#fff",displayColors:!0,borderColor:"rgba(0,0,0,0)",borderWidth:0,callbacks:{beforeTitle:se.noop,title:function(e,t){var n="",r=t.labels,i=r?r.length:0;if(e.length>0){var s=e[0];s.label?n=s.label:s.xLabel?n=s.xLabel:i>0&&s.index<i&&(n=r[s.index])}return n},afterTitle:se.noop,beforeBody:se.noop,beforeLabel:se.noop,label:function(e,t){var n=t.datasets[e.datasetIndex].label||"";return n&&(n+=": "),se.isNullOrUndef(e.value)?n+=e.yLabel:n+=e.value,n},labelColor:function(e,t){var n=t.getDatasetMeta(e.datasetIndex).data[e.index]._view;return{borderColor:n.borderColor,backgroundColor:n.backgroundColor}},labelTextColor:function(){return this._options.bodyFontColor},afterLabel:se.noop,afterBody:se.noop,beforeFooter:se.noop,footer:se.noop,afterFooter:se.noop}}});var jn={average:function(e){if(!e.length)return!1;var t,n,r=0,i=0,s=0;for(t=0,n=e.length;t<n;++t){var a=e[t];if(a&&a.hasValue()){var o=a.tooltipPosition();r+=o.x,i+=o.y,++s}}return{x:r/s,y:i/s}},nearest:function(e,t){var n,r,i,s=t.x,a=t.y,o=Number.POSITIVE_INFINITY;for(n=0,r=e.length;n<r;++n){var l=e[n];if(l&&l.hasValue()){var c=l.getCenterPoint(),d=se.distanceBetweenPoints(t,c);d<o&&(o=d,i=l)}}if(i){var h=i.tooltipPosition();s=h.x,a=h.y}return{x:s,y:a}}};function Sn(e,t){return t&&(se.isArray(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function Dn(e){return("string"===typeof e||e instanceof String)&&e.indexOf("\n")>-1?e.split("\n"):e}function wn(e){var t=e._xScale,n=e._yScale||e._scale,r=e._index,i=e._datasetIndex,s=e._chart.getDatasetMeta(i).controller,a=s._getIndexScale(),o=s._getValueScale();return{xLabel:t?t.getLabelForIndex(r,i):"",yLabel:n?n.getLabelForIndex(r,i):"",label:a?""+a.getLabelForIndex(r,i):"",value:o?""+o.getLabelForIndex(r,i):"",index:r,datasetIndex:i,x:e._model.x,y:e._model.y}}function In(e){var t=$.global;return{xPadding:e.xPadding,yPadding:e.yPadding,xAlign:e.xAlign,yAlign:e.yAlign,rtl:e.rtl,textDirection:e.textDirection,bodyFontColor:e.bodyFontColor,_bodyFontFamily:yn(e.bodyFontFamily,t.defaultFontFamily),_bodyFontStyle:yn(e.bodyFontStyle,t.defaultFontStyle),_bodyAlign:e.bodyAlign,bodyFontSize:yn(e.bodyFontSize,t.defaultFontSize),bodySpacing:e.bodySpacing,titleFontColor:e.titleFontColor,_titleFontFamily:yn(e.titleFontFamily,t.defaultFontFamily),_titleFontStyle:yn(e.titleFontStyle,t.defaultFontStyle),titleFontSize:yn(e.titleFontSize,t.defaultFontSize),_titleAlign:e.titleAlign,titleSpacing:e.titleSpacing,titleMarginBottom:e.titleMarginBottom,footerFontColor:e.footerFontColor,_footerFontFamily:yn(e.footerFontFamily,t.defaultFontFamily),_footerFontStyle:yn(e.footerFontStyle,t.defaultFontStyle),footerFontSize:yn(e.footerFontSize,t.defaultFontSize),_footerAlign:e.footerAlign,footerSpacing:e.footerSpacing,footerMarginTop:e.footerMarginTop,caretSize:e.caretSize,cornerRadius:e.cornerRadius,backgroundColor:e.backgroundColor,opacity:0,legendColorBackground:e.multiKeyBackground,displayColors:e.displayColors,borderColor:e.borderColor,borderWidth:e.borderWidth}}function kn(e,t){var n=e._chart.ctx,r=2*t.yPadding,i=0,s=t.body,a=s.reduce((function(e,t){return e+t.before.length+t.lines.length+t.after.length}),0);a+=t.beforeBody.length+t.afterBody.length;var o=t.title.length,l=t.footer.length,c=t.titleFontSize,d=t.bodyFontSize,h=t.footerFontSize;r+=o*c,r+=o?(o-1)*t.titleSpacing:0,r+=o?t.titleMarginBottom:0,r+=a*d,r+=a?(a-1)*t.bodySpacing:0,r+=l?t.footerMarginTop:0,r+=l*h,r+=l?(l-1)*t.footerSpacing:0;var u=0,g=function(e){i=Math.max(i,n.measureText(e).width+u)};return n.font=se.fontString(c,t._titleFontStyle,t._titleFontFamily),se.each(t.title,g),n.font=se.fontString(d,t._bodyFontStyle,t._bodyFontFamily),se.each(t.beforeBody.concat(t.afterBody),g),u=t.displayColors?d+2:0,se.each(s,(function(e){se.each(e.before,g),se.each(e.lines,g),se.each(e.after,g)})),u=0,n.font=se.fontString(h,t._footerFontStyle,t._footerFontFamily),se.each(t.footer,g),{width:i+=2*t.xPadding,height:r}}function _n(e,t){var n,r,i,s,a,o=e._model,l=e._chart,c=e._chart.chartArea,d="center",h="center";o.y<t.height?h="top":o.y>l.height-t.height&&(h="bottom");var u=(c.left+c.right)/2,g=(c.top+c.bottom)/2;"center"===h?(n=function(e){return e<=u},r=function(e){return e>u}):(n=function(e){return e<=t.width/2},r=function(e){return e>=l.width-t.width/2}),i=function(e){return e+t.width+o.caretSize+o.caretPadding>l.width},s=function(e){return e-t.width-o.caretSize-o.caretPadding<0},a=function(e){return e<=g?"top":"bottom"},n(o.x)?(d="left",i(o.x)&&(d="center",h=a(o.y))):r(o.x)&&(d="right",s(o.x)&&(d="center",h=a(o.y)));var p=e._options;return{xAlign:p.xAlign?p.xAlign:d,yAlign:p.yAlign?p.yAlign:h}}function Nn(e,t,n,r){var i=e.x,s=e.y,a=e.caretSize,o=e.caretPadding,l=e.cornerRadius,c=n.xAlign,d=n.yAlign,h=a+o,u=l+o;return"right"===c?i-=t.width:"center"===c&&((i-=t.width/2)+t.width>r.width&&(i=r.width-t.width),i<0&&(i=0)),"top"===d?s+=h:s-="bottom"===d?t.height+h:t.height/2,"center"===d?"left"===c?i+=h:"right"===c&&(i-=h):"left"===c?i-=u:"right"===c&&(i+=u),{x:i,y:s}}function Mn(e,t){return"center"===t?e.x+e.width/2:"right"===t?e.x+e.width-e.xPadding:e.x+e.xPadding}function Cn(e){return Sn([],Dn(e))}var On=ge.extend({initialize:function(){this._model=In(this._options),this._lastActive=[]},getTitle:function(){var e=this,t=e._options.callbacks,n=t.beforeTitle.apply(e,arguments),r=t.title.apply(e,arguments),i=t.afterTitle.apply(e,arguments),s=[];return s=Sn(s,Dn(n)),s=Sn(s,Dn(r)),s=Sn(s,Dn(i))},getBeforeBody:function(){return Cn(this._options.callbacks.beforeBody.apply(this,arguments))},getBody:function(e,t){var n=this,r=n._options.callbacks,i=[];return se.each(e,(function(e){var s={before:[],lines:[],after:[]};Sn(s.before,Dn(r.beforeLabel.call(n,e,t))),Sn(s.lines,r.label.call(n,e,t)),Sn(s.after,Dn(r.afterLabel.call(n,e,t))),i.push(s)})),i},getAfterBody:function(){return Cn(this._options.callbacks.afterBody.apply(this,arguments))},getFooter:function(){var e=this,t=e._options.callbacks,n=t.beforeFooter.apply(e,arguments),r=t.footer.apply(e,arguments),i=t.afterFooter.apply(e,arguments),s=[];return s=Sn(s,Dn(n)),s=Sn(s,Dn(r)),s=Sn(s,Dn(i))},update:function(e){var t,n,r=this,i=r._options,s=r._model,a=r._model=In(i),o=r._active,l=r._data,c={xAlign:s.xAlign,yAlign:s.yAlign},d={x:s.x,y:s.y},h={width:s.width,height:s.height},u={x:s.caretX,y:s.caretY};if(o.length){a.opacity=1;var g=[],p=[];u=jn[i.position].call(r,o,r._eventPosition);var m=[];for(t=0,n=o.length;t<n;++t)m.push(wn(o[t]));i.filter&&(m=m.filter((function(e){return i.filter(e,l)}))),i.itemSort&&(m=m.sort((function(e,t){return i.itemSort(e,t,l)}))),se.each(m,(function(e){g.push(i.callbacks.labelColor.call(r,e,r._chart)),p.push(i.callbacks.labelTextColor.call(r,e,r._chart))})),a.title=r.getTitle(m,l),a.beforeBody=r.getBeforeBody(m,l),a.body=r.getBody(m,l),a.afterBody=r.getAfterBody(m,l),a.footer=r.getFooter(m,l),a.x=u.x,a.y=u.y,a.caretPadding=i.caretPadding,a.labelColors=g,a.labelTextColors=p,a.dataPoints=m,d=Nn(a,h=kn(this,a),c=_n(this,h),r._chart)}else a.opacity=0;return a.xAlign=c.xAlign,a.yAlign=c.yAlign,a.x=d.x,a.y=d.y,a.width=h.width,a.height=h.height,a.caretX=u.x,a.caretY=u.y,r._model=a,e&&i.custom&&i.custom.call(r,a),r},drawCaret:function(e,t){var n=this._chart.ctx,r=this._view,i=this.getCaretPosition(e,t,r);n.lineTo(i.x1,i.y1),n.lineTo(i.x2,i.y2),n.lineTo(i.x3,i.y3)},getCaretPosition:function(e,t,n){var r,i,s,a,o,l,c=n.caretSize,d=n.cornerRadius,h=n.xAlign,u=n.yAlign,g=e.x,p=e.y,m=t.width,f=t.height;if("center"===u)o=p+f/2,"left"===h?(i=(r=g)-c,s=r,a=o+c,l=o-c):(i=(r=g+m)+c,s=r,a=o-c,l=o+c);else if("left"===h?(r=(i=g+d+c)-c,s=i+c):"right"===h?(r=(i=g+m-d-c)-c,s=i+c):(r=(i=n.caretX)-c,s=i+c),"top"===u)o=(a=p)-c,l=a;else{o=(a=p+f)+c,l=a;var x=s;s=r,r=x}return{x1:r,x2:i,x3:s,y1:a,y2:o,y3:l}},drawTitle:function(e,t,n){var r,i,s,a=t.title,o=a.length;if(o){var l=bn(t.rtl,t.x,t.width);for(e.x=Mn(t,t._titleAlign),n.textAlign=l.textAlign(t._titleAlign),n.textBaseline="middle",r=t.titleFontSize,i=t.titleSpacing,n.fillStyle=t.titleFontColor,n.font=se.fontString(r,t._titleFontStyle,t._titleFontFamily),s=0;s<o;++s)n.fillText(a[s],l.x(e.x),e.y+r/2),e.y+=r+i,s+1===o&&(e.y+=t.titleMarginBottom-i)}},drawBody:function(e,t,n){var r,i,s,a,o,l,c,d,h=t.bodyFontSize,u=t.bodySpacing,g=t._bodyAlign,p=t.body,m=t.displayColors,f=0,x=m?Mn(t,"left"):0,v=bn(t.rtl,t.x,t.width),A=function(t){n.fillText(t,v.x(e.x+f),e.y+h/2),e.y+=h+u},P=v.textAlign(g);for(n.textAlign=g,n.textBaseline="middle",n.font=se.fontString(h,t._bodyFontStyle,t._bodyFontFamily),e.x=Mn(t,P),n.fillStyle=t.bodyFontColor,se.each(t.beforeBody,A),f=m&&"right"!==P?"center"===g?h/2+1:h+2:0,o=0,c=p.length;o<c;++o){for(r=p[o],i=t.labelTextColors[o],s=t.labelColors[o],n.fillStyle=i,se.each(r.before,A),l=0,d=(a=r.lines).length;l<d;++l){if(m){var y=v.x(x);n.fillStyle=t.legendColorBackground,n.fillRect(v.leftForLtr(y,h),e.y,h,h),n.lineWidth=1,n.strokeStyle=s.borderColor,n.strokeRect(v.leftForLtr(y,h),e.y,h,h),n.fillStyle=s.backgroundColor,n.fillRect(v.leftForLtr(v.xPlus(y,1),h-2),e.y+1,h-2,h-2),n.fillStyle=i}A(a[l])}se.each(r.after,A)}f=0,se.each(t.afterBody,A),e.y-=u},drawFooter:function(e,t,n){var r,i,s=t.footer,a=s.length;if(a){var o=bn(t.rtl,t.x,t.width);for(e.x=Mn(t,t._footerAlign),e.y+=t.footerMarginTop,n.textAlign=o.textAlign(t._footerAlign),n.textBaseline="middle",r=t.footerFontSize,n.fillStyle=t.footerFontColor,n.font=se.fontString(r,t._footerFontStyle,t._footerFontFamily),i=0;i<a;++i)n.fillText(s[i],o.x(e.x),e.y+r/2),e.y+=r+t.footerSpacing}},drawBackground:function(e,t,n,r){n.fillStyle=t.backgroundColor,n.strokeStyle=t.borderColor,n.lineWidth=t.borderWidth;var i=t.xAlign,s=t.yAlign,a=e.x,o=e.y,l=r.width,c=r.height,d=t.cornerRadius;n.beginPath(),n.moveTo(a+d,o),"top"===s&&this.drawCaret(e,r),n.lineTo(a+l-d,o),n.quadraticCurveTo(a+l,o,a+l,o+d),"center"===s&&"right"===i&&this.drawCaret(e,r),n.lineTo(a+l,o+c-d),n.quadraticCurveTo(a+l,o+c,a+l-d,o+c),"bottom"===s&&this.drawCaret(e,r),n.lineTo(a+d,o+c),n.quadraticCurveTo(a,o+c,a,o+c-d),"center"===s&&"left"===i&&this.drawCaret(e,r),n.lineTo(a,o+d),n.quadraticCurveTo(a,o,a+d,o),n.closePath(),n.fill(),t.borderWidth>0&&n.stroke()},draw:function(){var e=this._chart.ctx,t=this._view;if(0!==t.opacity){var n={width:t.width,height:t.height},r={x:t.x,y:t.y},i=Math.abs(t.opacity<.001)?0:t.opacity,s=t.title.length||t.beforeBody.length||t.body.length||t.afterBody.length||t.footer.length;this._options.enabled&&s&&(e.save(),e.globalAlpha=i,this.drawBackground(r,t,e,n),r.y+=t.yPadding,se.rtl.overrideTextDirection(e,t.textDirection),this.drawTitle(r,t,e),this.drawBody(r,t,e),this.drawFooter(r,t,e),se.rtl.restoreTextDirection(e,t.textDirection),e.restore())}},handleEvent:function(e){var t=this,n=t._options,r=!1;return t._lastActive=t._lastActive||[],"mouseout"===e.type?t._active=[]:(t._active=t._chart.getElementsAtEventForMode(e,n.mode,n),n.reverse&&t._active.reverse()),(r=!se.arrayEquals(t._active,t._lastActive))&&(t._lastActive=t._active,(n.enabled||n.custom)&&(t._eventPosition={x:e.x,y:e.y},t.update(!0),t.pivot())),r}}),Ln=jn,Tn=On;Tn.positioners=Ln;var Fn=se.valueOrDefault;function Rn(){return se.merge(Object.create(null),[].slice.call(arguments),{merger:function(e,t,n,r){if("xAxes"===e||"yAxes"===e){var i,s,a,o=n[e].length;for(t[e]||(t[e]=[]),i=0;i<o;++i)a=n[e][i],s=Fn(a.type,"xAxes"===e?"category":"linear"),i>=t[e].length&&t[e].push({}),!t[e][i].type||a.type&&a.type!==t[e][i].type?se.merge(t[e][i],[Pn.getScaleDefaults(s),a]):se.merge(t[e][i],a)}else se._merger(e,t,n,r)}})}function En(){return se.merge(Object.create(null),[].slice.call(arguments),{merger:function(e,t,n,r){var i=t[e]||Object.create(null),s=n[e];"scales"===e?t[e]=Rn(i,s):"scale"===e?t[e]=se.merge(i,[Pn.getScaleDefaults(s.type),s]):se._merger(e,t,n,r)}})}function Un(e){var t=(e=e||Object.create(null)).data=e.data||{};return t.datasets=t.datasets||[],t.labels=t.labels||[],e.options=En($.global,$[e.type],e.options||{}),e}function zn(e){var t=e.options;se.each(e.scales,(function(t){Yt.removeBox(e,t)})),t=En($.global,$[e.config.type],t),e.options=e.config.options=t,e.ensureScalesHaveIDs(),e.buildOrUpdateScales(),e.tooltip._options=t.tooltips,e.tooltip.initialize()}function Bn(e,t,n){var r,i=function(e){return e.id===r};do{r=t+n++}while(se.findIndex(e,i)>=0);return r}function qn(e){return"top"===e||"bottom"===e}function Yn(e,t){return function(n,r){return n[e]===r[e]?n[t]-r[t]:n[e]-r[e]}}$._set("global",{elements:{},events:["mousemove","mouseout","click","touchstart","touchmove"],hover:{onHover:null,mode:"nearest",intersect:!0,animationDuration:400},onClick:null,maintainAspectRatio:!0,responsive:!0,responsiveAnimationDuration:0});var Vn=function(e,t){return this.construct(e,t),this};se.extend(Vn.prototype,{construct:function(e,t){var n=this;t=Un(t);var r=vn.acquireContext(e,t),i=r&&r.canvas,s=i&&i.height,a=i&&i.width;n.id=se.uid(),n.ctx=r,n.canvas=i,n.config=t,n.width=a,n.height=s,n.aspectRatio=s?a/s:null,n.options=t.options,n._bufferedRender=!1,n._layers=[],n.chart=n,n.controller=n,Vn.instances[n.id]=n,Object.defineProperty(n,"data",{get:function(){return n.config.data},set:function(e){n.config.data=e}}),r&&i?(n.initialize(),n.update()):console.error("Failed to create chart: can't acquire context from the given item")},initialize:function(){var e=this;return An.notify(e,"beforeInit"),se.retinaScale(e,e.options.devicePixelRatio),e.bindEvents(),e.options.responsive&&e.resize(!0),e.initToolTip(),An.notify(e,"afterInit"),e},clear:function(){return se.canvas.clear(this),this},stop:function(){return fe.cancelAnimation(this),this},resize:function(e){var t=this,n=t.options,r=t.canvas,i=n.maintainAspectRatio&&t.aspectRatio||null,s=Math.max(0,Math.floor(se.getMaximumWidth(r))),a=Math.max(0,Math.floor(i?s/i:se.getMaximumHeight(r)));if((t.width!==s||t.height!==a)&&(r.width=t.width=s,r.height=t.height=a,r.style.width=s+"px",r.style.height=a+"px",se.retinaScale(t,n.devicePixelRatio),!e)){var o={width:s,height:a};An.notify(t,"resize",[o]),n.onResize&&n.onResize(t,o),t.stop(),t.update({duration:n.responsiveAnimationDuration})}},ensureScalesHaveIDs:function(){var e=this.options,t=e.scales||{},n=e.scale;se.each(t.xAxes,(function(e,n){e.id||(e.id=Bn(t.xAxes,"x-axis-",n))})),se.each(t.yAxes,(function(e,n){e.id||(e.id=Bn(t.yAxes,"y-axis-",n))})),n&&(n.id=n.id||"scale")},buildOrUpdateScales:function(){var e=this,t=e.options,n=e.scales||{},r=[],i=Object.keys(n).reduce((function(e,t){return e[t]=!1,e}),{});t.scales&&(r=r.concat((t.scales.xAxes||[]).map((function(e){return{options:e,dtype:"category",dposition:"bottom"}})),(t.scales.yAxes||[]).map((function(e){return{options:e,dtype:"linear",dposition:"left"}})))),t.scale&&r.push({options:t.scale,dtype:"radialLinear",isDefault:!0,dposition:"chartArea"}),se.each(r,(function(t){var r=t.options,s=r.id,a=Fn(r.type,t.dtype);qn(r.position)!==qn(t.dposition)&&(r.position=t.dposition),i[s]=!0;var o=null;if(s in n&&n[s].type===a)(o=n[s]).options=r,o.ctx=e.ctx,o.chart=e;else{var l=Pn.getScaleConstructor(a);if(!l)return;o=new l({id:s,type:a,options:r,ctx:e.ctx,chart:e}),n[o.id]=o}o.mergeTicksOptions(),t.isDefault&&(e.scale=o)})),se.each(i,(function(e,t){e||delete n[t]})),e.scales=n,Pn.addScalesToLayout(this)},buildOrUpdateControllers:function(){var e,t,n=this,r=[],i=n.data.datasets;for(e=0,t=i.length;e<t;e++){var s=i[e],a=n.getDatasetMeta(e),o=s.type||n.config.type;if(a.type&&a.type!==o&&(n.destroyDatasetMeta(e),a=n.getDatasetMeta(e)),a.type=o,a.order=s.order||0,a.index=e,a.controller)a.controller.updateIndex(e),a.controller.linkScales();else{var l=jt[a.type];if(void 0===l)throw new Error('"'+a.type+'" is not a chart type.');a.controller=new l(n,e),r.push(a.controller)}}return r},resetElements:function(){var e=this;se.each(e.data.datasets,(function(t,n){e.getDatasetMeta(n).controller.reset()}),e)},reset:function(){this.resetElements(),this.tooltip.initialize()},update:function(e){var t,n,r=this;if(e&&"object"===typeof e||(e={duration:e,lazy:arguments[1]}),zn(r),An._invalidate(r),!1!==An.notify(r,"beforeUpdate")){r.tooltip._data=r.data;var i=r.buildOrUpdateControllers();for(t=0,n=r.data.datasets.length;t<n;t++)r.getDatasetMeta(t).controller.buildOrUpdateElements();r.updateLayout(),r.options.animation&&r.options.animation.duration&&se.each(i,(function(e){e.reset()})),r.updateDatasets(),r.tooltip.initialize(),r.lastActive=[],An.notify(r,"afterUpdate"),r._layers.sort(Yn("z","_idx")),r._bufferedRender?r._bufferedRequest={duration:e.duration,easing:e.easing,lazy:e.lazy}:r.render(e)}},updateLayout:function(){var e=this;!1!==An.notify(e,"beforeLayout")&&(Yt.update(this,this.width,this.height),e._layers=[],se.each(e.boxes,(function(t){t._configure&&t._configure(),e._layers.push.apply(e._layers,t._layers())}),e),e._layers.forEach((function(e,t){e._idx=t})),An.notify(e,"afterScaleUpdate"),An.notify(e,"afterLayout"))},updateDatasets:function(){var e=this;if(!1!==An.notify(e,"beforeDatasetsUpdate")){for(var t=0,n=e.data.datasets.length;t<n;++t)e.updateDataset(t);An.notify(e,"afterDatasetsUpdate")}},updateDataset:function(e){var t=this,n=t.getDatasetMeta(e),r={meta:n,index:e};!1!==An.notify(t,"beforeDatasetUpdate",[r])&&(n.controller._update(),An.notify(t,"afterDatasetUpdate",[r]))},render:function(e){var t=this;e&&"object"===typeof e||(e={duration:e,lazy:arguments[1]});var n=t.options.animation,r=Fn(e.duration,n&&n.duration),i=e.lazy;if(!1!==An.notify(t,"beforeRender")){var s=function(e){An.notify(t,"afterRender"),se.callback(n&&n.onComplete,[e],t)};if(n&&r){var a=new me({numSteps:r/16.66,easing:e.easing||n.easing,render:function(e,t){var n=se.easing.effects[t.easing],r=t.currentStep,i=r/t.numSteps;e.draw(n(i),i,r)},onAnimationProgress:n.onProgress,onAnimationComplete:s});fe.addAnimation(t,a,r,i)}else t.draw(),s(new me({numSteps:0,chart:t}));return t}},draw:function(e){var t,n,r=this;if(r.clear(),se.isNullOrUndef(e)&&(e=1),r.transition(e),!(r.width<=0||r.height<=0)&&!1!==An.notify(r,"beforeDraw",[e])){for(n=r._layers,t=0;t<n.length&&n[t].z<=0;++t)n[t].draw(r.chartArea);for(r.drawDatasets(e);t<n.length;++t)n[t].draw(r.chartArea);r._drawTooltip(e),An.notify(r,"afterDraw",[e])}},transition:function(e){for(var t=this,n=0,r=(t.data.datasets||[]).length;n<r;++n)t.isDatasetVisible(n)&&t.getDatasetMeta(n).controller.transition(e);t.tooltip.transition(e)},_getSortedDatasetMetas:function(e){var t,n,r=this,i=[];for(t=0,n=(r.data.datasets||[]).length;t<n;++t)e&&!r.isDatasetVisible(t)||i.push(r.getDatasetMeta(t));return i.sort(Yn("order","index")),i},_getSortedVisibleDatasetMetas:function(){return this._getSortedDatasetMetas(!0)},drawDatasets:function(e){var t,n,r=this;if(!1!==An.notify(r,"beforeDatasetsDraw",[e])){for(n=(t=r._getSortedVisibleDatasetMetas()).length-1;n>=0;--n)r.drawDataset(t[n],e);An.notify(r,"afterDatasetsDraw",[e])}},drawDataset:function(e,t){var n=this,r={meta:e,index:e.index,easingValue:t};!1!==An.notify(n,"beforeDatasetDraw",[r])&&(e.controller.draw(t),An.notify(n,"afterDatasetDraw",[r]))},_drawTooltip:function(e){var t=this,n=t.tooltip,r={tooltip:n,easingValue:e};!1!==An.notify(t,"beforeTooltipDraw",[r])&&(n.draw(),An.notify(t,"afterTooltipDraw",[r]))},getElementAtEvent:function(e){return Nt.modes.single(this,e)},getElementsAtEvent:function(e){return Nt.modes.label(this,e,{intersect:!0})},getElementsAtXAxis:function(e){return Nt.modes["x-axis"](this,e,{intersect:!0})},getElementsAtEventForMode:function(e,t,n){var r=Nt.modes[t];return"function"===typeof r?r(this,e,n):[]},getDatasetAtEvent:function(e){return Nt.modes.dataset(this,e,{intersect:!0})},getDatasetMeta:function(e){var t=this,n=t.data.datasets[e];n._meta||(n._meta={});var r=n._meta[t.id];return r||(r=n._meta[t.id]={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n.order||0,index:e}),r},getVisibleDatasetCount:function(){for(var e=0,t=0,n=this.data.datasets.length;t<n;++t)this.isDatasetVisible(t)&&e++;return e},isDatasetVisible:function(e){var t=this.getDatasetMeta(e);return"boolean"===typeof t.hidden?!t.hidden:!this.data.datasets[e].hidden},generateLegend:function(){return this.options.legendCallback(this)},destroyDatasetMeta:function(e){var t=this.id,n=this.data.datasets[e],r=n._meta&&n._meta[t];r&&(r.controller.destroy(),delete n._meta[t])},destroy:function(){var e,t,n=this,r=n.canvas;for(n.stop(),e=0,t=n.data.datasets.length;e<t;++e)n.destroyDatasetMeta(e);r&&(n.unbindEvents(),se.canvas.clear(n),vn.releaseContext(n.ctx),n.canvas=null,n.ctx=null),An.notify(n,"destroy"),delete Vn.instances[n.id]},toBase64Image:function(){return this.canvas.toDataURL.apply(this.canvas,arguments)},initToolTip:function(){var e=this;e.tooltip=new Tn({_chart:e,_chartInstance:e,_data:e.data,_options:e.options.tooltips},e)},bindEvents:function(){var e=this,t=e._listeners={},n=function(){e.eventHandler.apply(e,arguments)};se.each(e.options.events,(function(r){vn.addEventListener(e,r,n),t[r]=n})),e.options.responsive&&(n=function(){e.resize()},vn.addEventListener(e,"resize",n),t.resize=n)},unbindEvents:function(){var e=this,t=e._listeners;t&&(delete e._listeners,se.each(t,(function(t,n){vn.removeEventListener(e,n,t)})))},updateHoverStyle:function(e,t,n){var r,i,s,a=n?"set":"remove";for(i=0,s=e.length;i<s;++i)(r=e[i])&&this.getDatasetMeta(r._datasetIndex).controller[a+"HoverStyle"](r);"dataset"===t&&this.getDatasetMeta(e[0]._datasetIndex).controller["_"+a+"DatasetHoverStyle"]()},eventHandler:function(e){var t=this,n=t.tooltip;if(!1!==An.notify(t,"beforeEvent",[e])){t._bufferedRender=!0,t._bufferedRequest=null;var r=t.handleEvent(e);n&&(r=n._start?n.handleEvent(e):r|n.handleEvent(e)),An.notify(t,"afterEvent",[e]);var i=t._bufferedRequest;return i?t.render(i):r&&!t.animating&&(t.stop(),t.render({duration:t.options.hover.animationDuration,lazy:!0})),t._bufferedRender=!1,t._bufferedRequest=null,t}},handleEvent:function(e){var t=this,n=t.options||{},r=n.hover,i=!1;return t.lastActive=t.lastActive||[],"mouseout"===e.type?t.active=[]:t.active=t.getElementsAtEventForMode(e,r.mode,r),se.callback(n.onHover||n.hover.onHover,[e.native,t.active],t),"mouseup"!==e.type&&"click"!==e.type||n.onClick&&n.onClick.call(t,e.native,t.active),t.lastActive.length&&t.updateHoverStyle(t.lastActive,r.mode,!1),t.active.length&&r.mode&&t.updateHoverStyle(t.active,r.mode,!0),i=!se.arrayEquals(t.active,t.lastActive),t.lastActive=t.active,i}}),Vn.instances={};var Hn=Vn;Vn.Controller=Vn,Vn.types={},se.configMerge=En,se.scaleMerge=Rn;var Wn=function(){function e(e,t,n){var r;return"string"===typeof e?(r=parseInt(e,10),-1!==e.indexOf("%")&&(r=r/100*t.parentNode[n])):r=e,r}function t(e){return void 0!==e&&null!==e&&"none"!==e}function n(n,r,i){var s=document.defaultView,a=se._getParentNode(n),o=s.getComputedStyle(n)[r],l=s.getComputedStyle(a)[r],c=t(o),d=t(l),h=Number.POSITIVE_INFINITY;return c||d?Math.min(c?e(o,n,i):h,d?e(l,a,i):h):"none"}se.where=function(e,t){if(se.isArray(e)&&Array.prototype.filter)return e.filter(t);var n=[];return se.each(e,(function(e){t(e)&&n.push(e)})),n},se.findIndex=Array.prototype.findIndex?function(e,t,n){return e.findIndex(t,n)}:function(e,t,n){n=void 0===n?e:n;for(var r=0,i=e.length;r<i;++r)if(t.call(n,e[r],r,e))return r;return-1},se.findNextWhere=function(e,t,n){se.isNullOrUndef(n)&&(n=-1);for(var r=n+1;r<e.length;r++){var i=e[r];if(t(i))return i}},se.findPreviousWhere=function(e,t,n){se.isNullOrUndef(n)&&(n=e.length);for(var r=n-1;r>=0;r--){var i=e[r];if(t(i))return i}},se.isNumber=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},se.almostEquals=function(e,t,n){return Math.abs(e-t)<n},se.almostWhole=function(e,t){var n=Math.round(e);return n-t<=e&&n+t>=e},se.max=function(e){return e.reduce((function(e,t){return isNaN(t)?e:Math.max(e,t)}),Number.NEGATIVE_INFINITY)},se.min=function(e){return e.reduce((function(e,t){return isNaN(t)?e:Math.min(e,t)}),Number.POSITIVE_INFINITY)},se.sign=Math.sign?function(e){return Math.sign(e)}:function(e){return 0===(e=+e)||isNaN(e)?e:e>0?1:-1},se.toRadians=function(e){return e*(Math.PI/180)},se.toDegrees=function(e){return e*(180/Math.PI)},se._decimalPlaces=function(e){if(se.isFinite(e)){for(var t=1,n=0;Math.round(e*t)/t!==e;)t*=10,n++;return n}},se.getAngleFromPoint=function(e,t){var n=t.x-e.x,r=t.y-e.y,i=Math.sqrt(n*n+r*r),s=Math.atan2(r,n);return s<-.5*Math.PI&&(s+=2*Math.PI),{angle:s,distance:i}},se.distanceBetweenPoints=function(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},se.aliasPixel=function(e){return e%2===0?0:.5},se._alignPixel=function(e,t,n){var r=e.currentDevicePixelRatio,i=n/2;return Math.round((t-i)*r)/r+i},se.splineCurve=function(e,t,n,r){var i=e.skip?t:e,s=t,a=n.skip?t:n,o=Math.sqrt(Math.pow(s.x-i.x,2)+Math.pow(s.y-i.y,2)),l=Math.sqrt(Math.pow(a.x-s.x,2)+Math.pow(a.y-s.y,2)),c=o/(o+l),d=l/(o+l),h=r*(c=isNaN(c)?0:c),u=r*(d=isNaN(d)?0:d);return{previous:{x:s.x-h*(a.x-i.x),y:s.y-h*(a.y-i.y)},next:{x:s.x+u*(a.x-i.x),y:s.y+u*(a.y-i.y)}}},se.EPSILON=Number.EPSILON||1e-14,se.splineCurveMonotone=function(e){var t,n,r,i,s,a,o,l,c,d=(e||[]).map((function(e){return{model:e._model,deltaK:0,mK:0}})),h=d.length;for(t=0;t<h;++t)if(!(r=d[t]).model.skip){if(n=t>0?d[t-1]:null,(i=t<h-1?d[t+1]:null)&&!i.model.skip){var u=i.model.x-r.model.x;r.deltaK=0!==u?(i.model.y-r.model.y)/u:0}!n||n.model.skip?r.mK=r.deltaK:!i||i.model.skip?r.mK=n.deltaK:this.sign(n.deltaK)!==this.sign(r.deltaK)?r.mK=0:r.mK=(n.deltaK+r.deltaK)/2}for(t=0;t<h-1;++t)r=d[t],i=d[t+1],r.model.skip||i.model.skip||(se.almostEquals(r.deltaK,0,this.EPSILON)?r.mK=i.mK=0:(s=r.mK/r.deltaK,a=i.mK/r.deltaK,(l=Math.pow(s,2)+Math.pow(a,2))<=9||(o=3/Math.sqrt(l),r.mK=s*o*r.deltaK,i.mK=a*o*r.deltaK)));for(t=0;t<h;++t)(r=d[t]).model.skip||(n=t>0?d[t-1]:null,i=t<h-1?d[t+1]:null,n&&!n.model.skip&&(c=(r.model.x-n.model.x)/3,r.model.controlPointPreviousX=r.model.x-c,r.model.controlPointPreviousY=r.model.y-c*r.mK),i&&!i.model.skip&&(c=(i.model.x-r.model.x)/3,r.model.controlPointNextX=r.model.x+c,r.model.controlPointNextY=r.model.y+c*r.mK))},se.nextItem=function(e,t,n){return n?t>=e.length-1?e[0]:e[t+1]:t>=e.length-1?e[e.length-1]:e[t+1]},se.previousItem=function(e,t,n){return n?t<=0?e[e.length-1]:e[t-1]:t<=0?e[0]:e[t-1]},se.niceNum=function(e,t){var n=Math.floor(se.log10(e)),r=e/Math.pow(10,n);return(t?r<1.5?1:r<3?2:r<7?5:10:r<=1?1:r<=2?2:r<=5?5:10)*Math.pow(10,n)},se.requestAnimFrame="undefined"===typeof window?function(e){e()}:window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return window.setTimeout(e,1e3/60)},se.getRelativePosition=function(e,t){var n,r,i=e.originalEvent||e,s=e.target||e.srcElement,a=s.getBoundingClientRect(),o=i.touches;o&&o.length>0?(n=o[0].clientX,r=o[0].clientY):(n=i.clientX,r=i.clientY);var l=parseFloat(se.getStyle(s,"padding-left")),c=parseFloat(se.getStyle(s,"padding-top")),d=parseFloat(se.getStyle(s,"padding-right")),h=parseFloat(se.getStyle(s,"padding-bottom")),u=a.right-a.left-l-d,g=a.bottom-a.top-c-h;return{x:n=Math.round((n-a.left-l)/u*s.width/t.currentDevicePixelRatio),y:r=Math.round((r-a.top-c)/g*s.height/t.currentDevicePixelRatio)}},se.getConstraintWidth=function(e){return n(e,"max-width","clientWidth")},se.getConstraintHeight=function(e){return n(e,"max-height","clientHeight")},se._calculatePadding=function(e,t,n){return(t=se.getStyle(e,t)).indexOf("%")>-1?n*parseInt(t,10)/100:parseInt(t,10)},se._getParentNode=function(e){var t=e.parentNode;return t&&"[object ShadowRoot]"===t.toString()&&(t=t.host),t},se.getMaximumWidth=function(e){var t=se._getParentNode(e);if(!t)return e.clientWidth;var n=t.clientWidth,r=n-se._calculatePadding(t,"padding-left",n)-se._calculatePadding(t,"padding-right",n),i=se.getConstraintWidth(e);return isNaN(i)?r:Math.min(r,i)},se.getMaximumHeight=function(e){var t=se._getParentNode(e);if(!t)return e.clientHeight;var n=t.clientHeight,r=n-se._calculatePadding(t,"padding-top",n)-se._calculatePadding(t,"padding-bottom",n),i=se.getConstraintHeight(e);return isNaN(i)?r:Math.min(r,i)},se.getStyle=function(e,t){return e.currentStyle?e.currentStyle[t]:document.defaultView.getComputedStyle(e,null).getPropertyValue(t)},se.retinaScale=function(e,t){var n=e.currentDevicePixelRatio=t||"undefined"!==typeof window&&window.devicePixelRatio||1;if(1!==n){var r=e.canvas,i=e.height,s=e.width;r.height=i*n,r.width=s*n,e.ctx.scale(n,n),r.style.height||r.style.width||(r.style.height=i+"px",r.style.width=s+"px")}},se.fontString=function(e,t,n){return t+" "+e+"px "+n},se.longestText=function(e,t,n,r){var i=(r=r||{}).data=r.data||{},s=r.garbageCollect=r.garbageCollect||[];r.font!==t&&(i=r.data={},s=r.garbageCollect=[],r.font=t),e.font=t;var a,o,l,c,d,h=0,u=n.length;for(a=0;a<u;a++)if(void 0!==(c=n[a])&&null!==c&&!0!==se.isArray(c))h=se.measureText(e,i,s,h,c);else if(se.isArray(c))for(o=0,l=c.length;o<l;o++)void 0===(d=c[o])||null===d||se.isArray(d)||(h=se.measureText(e,i,s,h,d));var g=s.length/2;if(g>n.length){for(a=0;a<g;a++)delete i[s[a]];s.splice(0,g)}return h},se.measureText=function(e,t,n,r,i){var s=t[i];return s||(s=t[i]=e.measureText(i).width,n.push(i)),s>r&&(r=s),r},se.numberOfLabelLines=function(e){var t=1;return se.each(e,(function(e){se.isArray(e)&&e.length>t&&(t=e.length)})),t},se.color=F?function(e){return e instanceof CanvasGradient&&(e=$.global.defaultColor),F(e)}:function(e){return console.error("Color.js not found!"),e},se.getHoverColor=function(e){return e instanceof CanvasPattern||e instanceof CanvasGradient?e:se.color(e).saturate(.5).darken(.1).rgbString()}};function Gn(){throw new Error("This method is not implemented: either no adapter can be found or an incomplete integration was provided.")}function Qn(e){this.options=e||{}}se.extend(Qn.prototype,{formats:Gn,parse:Gn,format:Gn,add:Gn,diff:Gn,startOf:Gn,endOf:Gn,_create:function(e){return e}}),Qn.override=function(e){se.extend(Qn.prototype,e)};var Kn={_date:Qn},Xn={formatters:{values:function(e){return se.isArray(e)?e:""+e},linear:function(e,t,n){var r=n.length>3?n[2]-n[1]:n[1]-n[0];Math.abs(r)>1&&e!==Math.floor(e)&&(r=e-Math.floor(e));var i=se.log10(Math.abs(r)),s="";if(0!==e)if(Math.max(Math.abs(n[0]),Math.abs(n[n.length-1]))<1e-4){var a=se.log10(Math.abs(e)),o=Math.floor(a)-Math.floor(i);o=Math.max(Math.min(o,20),0),s=e.toExponential(o)}else{var l=-1*Math.floor(i);l=Math.max(Math.min(l,20),0),s=e.toFixed(l)}else s="0";return s},logarithmic:function(e,t,n){var r=e/Math.pow(10,Math.floor(se.log10(e)));return 0===e?"0":1===r||2===r||5===r||0===t||t===n.length-1?e.toExponential():""}}},$n=se.isArray,Zn=se.isNullOrUndef,Jn=se.valueOrDefault,er=se.valueAtIndexOrDefault;function tr(e,t){for(var n=[],r=e.length/t,i=0,s=e.length;i<s;i+=r)n.push(e[Math.floor(i)]);return n}function nr(e,t,n){var r,i=e.getTicks().length,s=Math.min(t,i-1),a=e.getPixelForTick(s),o=e._startPixel,l=e._endPixel,c=1e-6;if(!(n&&(r=1===i?Math.max(a-o,l-a):0===t?(e.getPixelForTick(1)-a)/2:(a-e.getPixelForTick(s-1))/2,(a+=s<t?r:-r)<o-c||a>l+c)))return a}function rr(e,t){se.each(e,(function(e){var n,r=e.gc,i=r.length/2;if(i>t){for(n=0;n<i;++n)delete e.data[r[n]];r.splice(0,i)}}))}function ir(e,t,n,r){var i,s,a,o,l,c,d,h,u,g,p,m,f,x=n.length,v=[],A=[],P=[],y=0,b=0;for(i=0;i<x;++i){if(o=n[i].label,l=n[i].major?t.major:t.minor,e.font=c=l.string,d=r[c]=r[c]||{data:{},gc:[]},h=l.lineHeight,u=g=0,Zn(o)||$n(o)){if($n(o))for(s=0,a=o.length;s<a;++s)p=o[s],Zn(p)||$n(p)||(u=se.measureText(e,d.data,d.gc,u,p),g+=h)}else u=se.measureText(e,d.data,d.gc,u,o),g=h;v.push(u),A.push(g),P.push(h/2),y=Math.max(u,y),b=Math.max(g,b)}function j(e){return{width:v[e]||0,height:A[e]||0,offset:P[e]||0}}return rr(r,x),m=v.indexOf(y),f=A.indexOf(b),{first:j(0),last:j(x-1),widest:j(m),highest:j(f)}}function sr(e){return e.drawTicks?e.tickMarkLength:0}function ar(e){var t,n;return e.display?(t=se.options._parseFont(e),n=se.options.toPadding(e.padding),t.lineHeight+n.height):0}function or(e,t){return se.extend(se.options._parseFont({fontFamily:Jn(t.fontFamily,e.fontFamily),fontSize:Jn(t.fontSize,e.fontSize),fontStyle:Jn(t.fontStyle,e.fontStyle),lineHeight:Jn(t.lineHeight,e.lineHeight)}),{color:se.options.resolve([t.fontColor,e.fontColor,$.global.defaultFontColor])})}function lr(e){var t=or(e,e.minor);return{minor:t,major:e.major.enabled?or(e,e.major):t}}function cr(e){var t,n,r,i=[];for(n=0,r=e.length;n<r;++n)"undefined"!==typeof(t=e[n])._index&&i.push(t);return i}function dr(e){var t,n,r=e.length;if(r<2)return!1;for(n=e[0],t=1;t<r;++t)if(e[t]-e[t-1]!==n)return!1;return n}function hr(e,t,n,r){var i,s,a,o,l=dr(e),c=(t.length-1)/r;if(!l)return Math.max(c,1);for(a=0,o=(i=se.math._factorize(l)).length-1;a<o;a++)if((s=i[a])>c)return s;return Math.max(c,1)}function ur(e){var t,n,r=[];for(t=0,n=e.length;t<n;t++)e[t].major&&r.push(t);return r}function gr(e,t,n){var r,i,s=0,a=t[0];for(n=Math.ceil(n),r=0;r<e.length;r++)i=e[r],r===a?(i._index=r,a=t[++s*n]):delete i.label}function pr(e,t,n,r){var i,s,a,o,l=Jn(n,0),c=Math.min(Jn(r,e.length),e.length),d=0;for(t=Math.ceil(t),r&&(t=(i=r-n)/Math.floor(i/t)),o=l;o<0;)d++,o=Math.round(l+d*t);for(s=Math.max(l,0);s<c;s++)a=e[s],s===o?(a._index=s,d++,o=Math.round(l+d*t)):delete a.label}$._set("scale",{display:!0,position:"left",offset:!1,gridLines:{display:!0,color:"rgba(0,0,0,0.1)",lineWidth:1,drawBorder:!0,drawOnChartArea:!0,drawTicks:!0,tickMarkLength:10,zeroLineWidth:1,zeroLineColor:"rgba(0,0,0,0.25)",zeroLineBorderDash:[],zeroLineBorderDashOffset:0,offsetGridLines:!1,borderDash:[],borderDashOffset:0},scaleLabel:{display:!1,labelString:"",padding:{top:4,bottom:4}},ticks:{beginAtZero:!1,minRotation:0,maxRotation:50,mirror:!1,padding:0,reverse:!1,display:!0,autoSkip:!0,autoSkipPadding:0,labelOffset:0,callback:Xn.formatters.values,minor:{},major:{}}});var mr=ge.extend({zeroLineIndex:0,getPadding:function(){var e=this;return{left:e.paddingLeft||0,top:e.paddingTop||0,right:e.paddingRight||0,bottom:e.paddingBottom||0}},getTicks:function(){return this._ticks},_getLabels:function(){var e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]},mergeTicksOptions:function(){},beforeUpdate:function(){se.callback(this.options.beforeUpdate,[this])},update:function(e,t,n){var r,i,s,a,o,l=this,c=l.options.ticks,d=c.sampleSize;if(l.beforeUpdate(),l.maxWidth=e,l.maxHeight=t,l.margins=se.extend({left:0,right:0,top:0,bottom:0},n),l._ticks=null,l.ticks=null,l._labelSizes=null,l._maxLabelLines=0,l.longestLabelWidth=0,l.longestTextCache=l.longestTextCache||{},l._gridLineItems=null,l._labelItems=null,l.beforeSetDimensions(),l.setDimensions(),l.afterSetDimensions(),l.beforeDataLimits(),l.determineDataLimits(),l.afterDataLimits(),l.beforeBuildTicks(),a=l.buildTicks()||[],(!(a=l.afterBuildTicks(a)||a)||!a.length)&&l.ticks)for(a=[],r=0,i=l.ticks.length;r<i;++r)a.push({value:l.ticks[r],major:!1});return l._ticks=a,o=d<a.length,s=l._convertTicksToLabels(o?tr(a,d):a),l._configure(),l.beforeCalculateTickRotation(),l.calculateTickRotation(),l.afterCalculateTickRotation(),l.beforeFit(),l.fit(),l.afterFit(),l._ticksToDraw=c.display&&(c.autoSkip||"auto"===c.source)?l._autoSkip(a):a,o&&(s=l._convertTicksToLabels(l._ticksToDraw)),l.ticks=s,l.afterUpdate(),l.minSize},_configure:function(){var e,t,n=this,r=n.options.ticks.reverse;n.isHorizontal()?(e=n.left,t=n.right):(e=n.top,t=n.bottom,r=!r),n._startPixel=e,n._endPixel=t,n._reversePixels=r,n._length=t-e},afterUpdate:function(){se.callback(this.options.afterUpdate,[this])},beforeSetDimensions:function(){se.callback(this.options.beforeSetDimensions,[this])},setDimensions:function(){var e=this;e.isHorizontal()?(e.width=e.maxWidth,e.left=0,e.right=e.width):(e.height=e.maxHeight,e.top=0,e.bottom=e.height),e.paddingLeft=0,e.paddingTop=0,e.paddingRight=0,e.paddingBottom=0},afterSetDimensions:function(){se.callback(this.options.afterSetDimensions,[this])},beforeDataLimits:function(){se.callback(this.options.beforeDataLimits,[this])},determineDataLimits:se.noop,afterDataLimits:function(){se.callback(this.options.afterDataLimits,[this])},beforeBuildTicks:function(){se.callback(this.options.beforeBuildTicks,[this])},buildTicks:se.noop,afterBuildTicks:function(e){var t=this;return $n(e)&&e.length?se.callback(t.options.afterBuildTicks,[t,e]):(t.ticks=se.callback(t.options.afterBuildTicks,[t,t.ticks])||t.ticks,e)},beforeTickToLabelConversion:function(){se.callback(this.options.beforeTickToLabelConversion,[this])},convertTicksToLabels:function(){var e=this,t=e.options.ticks;e.ticks=e.ticks.map(t.userCallback||t.callback,this)},afterTickToLabelConversion:function(){se.callback(this.options.afterTickToLabelConversion,[this])},beforeCalculateTickRotation:function(){se.callback(this.options.beforeCalculateTickRotation,[this])},calculateTickRotation:function(){var e,t,n,r,i,s,a,o=this,l=o.options,c=l.ticks,d=o.getTicks().length,h=c.minRotation||0,u=c.maxRotation,g=h;!o._isVisible()||!c.display||h>=u||d<=1||!o.isHorizontal()?o.labelRotation=h:(t=(e=o._getLabelSizes()).widest.width,n=e.highest.height-e.highest.offset,r=Math.min(o.maxWidth,o.chart.width-t),t+6>(i=l.offset?o.maxWidth/d:r/(d-1))&&(i=r/(d-(l.offset?.5:1)),s=o.maxHeight-sr(l.gridLines)-c.padding-ar(l.scaleLabel),a=Math.sqrt(t*t+n*n),g=se.toDegrees(Math.min(Math.asin(Math.min((e.highest.height+6)/i,1)),Math.asin(Math.min(s/a,1))-Math.asin(n/a))),g=Math.max(h,Math.min(u,g))),o.labelRotation=g)},afterCalculateTickRotation:function(){se.callback(this.options.afterCalculateTickRotation,[this])},beforeFit:function(){se.callback(this.options.beforeFit,[this])},fit:function(){var e=this,t=e.minSize={width:0,height:0},n=e.chart,r=e.options,i=r.ticks,s=r.scaleLabel,a=r.gridLines,o=e._isVisible(),l="bottom"===r.position,c=e.isHorizontal();if(c?t.width=e.maxWidth:o&&(t.width=sr(a)+ar(s)),c?o&&(t.height=sr(a)+ar(s)):t.height=e.maxHeight,i.display&&o){var d=lr(i),h=e._getLabelSizes(),u=h.first,g=h.last,p=h.widest,m=h.highest,f=.4*d.minor.lineHeight,x=i.padding;if(c){var v=0!==e.labelRotation,A=se.toRadians(e.labelRotation),P=Math.cos(A),y=Math.sin(A),b=y*p.width+P*(m.height-(v?m.offset:0))+(v?0:f);t.height=Math.min(e.maxHeight,t.height+b+x);var j,S,D=e.getPixelForTick(0)-e.left,w=e.right-e.getPixelForTick(e.getTicks().length-1);v?(j=l?P*u.width+y*u.offset:y*(u.height-u.offset),S=l?y*(g.height-g.offset):P*g.width+y*g.offset):(j=u.width/2,S=g.width/2),e.paddingLeft=Math.max((j-D)*e.width/(e.width-D),0)+3,e.paddingRight=Math.max((S-w)*e.width/(e.width-w),0)+3}else{var I=i.mirror?0:p.width+x+f;t.width=Math.min(e.maxWidth,t.width+I),e.paddingTop=u.height/2,e.paddingBottom=g.height/2}}e.handleMargins(),c?(e.width=e._length=n.width-e.margins.left-e.margins.right,e.height=t.height):(e.width=t.width,e.height=e._length=n.height-e.margins.top-e.margins.bottom)},handleMargins:function(){var e=this;e.margins&&(e.margins.left=Math.max(e.paddingLeft,e.margins.left),e.margins.top=Math.max(e.paddingTop,e.margins.top),e.margins.right=Math.max(e.paddingRight,e.margins.right),e.margins.bottom=Math.max(e.paddingBottom,e.margins.bottom))},afterFit:function(){se.callback(this.options.afterFit,[this])},isHorizontal:function(){var e=this.options.position;return"top"===e||"bottom"===e},isFullWidth:function(){return this.options.fullWidth},getRightValue:function(e){if(Zn(e))return NaN;if(("number"===typeof e||e instanceof Number)&&!isFinite(e))return NaN;if(e)if(this.isHorizontal()){if(void 0!==e.x)return this.getRightValue(e.x)}else if(void 0!==e.y)return this.getRightValue(e.y);return e},_convertTicksToLabels:function(e){var t,n,r,i=this;for(i.ticks=e.map((function(e){return e.value})),i.beforeTickToLabelConversion(),t=i.convertTicksToLabels(e)||i.ticks,i.afterTickToLabelConversion(),n=0,r=e.length;n<r;++n)e[n].label=t[n];return t},_getLabelSizes:function(){var e=this,t=e._labelSizes;return t||(e._labelSizes=t=ir(e.ctx,lr(e.options.ticks),e.getTicks(),e.longestTextCache),e.longestLabelWidth=t.widest.width),t},_parseValue:function(e){var t,n,r,i;return $n(e)?(t=+this.getRightValue(e[0]),n=+this.getRightValue(e[1]),r=Math.min(t,n),i=Math.max(t,n)):(t=void 0,n=e=+this.getRightValue(e),r=e,i=e),{min:r,max:i,start:t,end:n}},_getScaleLabel:function(e){var t=this._parseValue(e);return void 0!==t.start?"["+t.start+", "+t.end+"]":+this.getRightValue(e)},getLabelForIndex:se.noop,getPixelForValue:se.noop,getValueForPixel:se.noop,getPixelForTick:function(e){var t=this,n=t.options.offset,r=t._ticks.length,i=1/Math.max(r-(n?0:1),1);return e<0||e>r-1?null:t.getPixelForDecimal(e*i+(n?i/2:0))},getPixelForDecimal:function(e){var t=this;return t._reversePixels&&(e=1-e),t._startPixel+e*t._length},getDecimalForPixel:function(e){var t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t},getBasePixel:function(){return this.getPixelForValue(this.getBaseValue())},getBaseValue:function(){var e=this,t=e.min,n=e.max;return e.beginAtZero?0:t<0&&n<0?n:t>0&&n>0?t:0},_autoSkip:function(e){var t,n,r,i,s=this,a=s.options.ticks,o=s._length,l=a.maxTicksLimit||o/s._tickSize()+1,c=a.major.enabled?ur(e):[],d=c.length,h=c[0],u=c[d-1];if(d>l)return gr(e,c,d/l),cr(e);if(r=hr(c,e,o,l),d>0){for(t=0,n=d-1;t<n;t++)pr(e,r,c[t],c[t+1]);return i=d>1?(u-h)/(d-1):null,pr(e,r,se.isNullOrUndef(i)?0:h-i,h),pr(e,r,u,se.isNullOrUndef(i)?e.length:u+i),cr(e)}return pr(e,r),cr(e)},_tickSize:function(){var e=this,t=e.options.ticks,n=se.toRadians(e.labelRotation),r=Math.abs(Math.cos(n)),i=Math.abs(Math.sin(n)),s=e._getLabelSizes(),a=t.autoSkipPadding||0,o=s?s.widest.width+a:0,l=s?s.highest.height+a:0;return e.isHorizontal()?l*r>o*i?o/r:l/i:l*i<o*r?l/r:o/i},_isVisible:function(){var e,t,n,r=this,i=r.chart,s=r.options.display;if("auto"!==s)return!!s;for(e=0,t=i.data.datasets.length;e<t;++e)if(i.isDatasetVisible(e)&&((n=i.getDatasetMeta(e)).xAxisID===r.id||n.yAxisID===r.id))return!0;return!1},_computeGridLineItems:function(e){var t,n,r,i,s,a,o,l,c,d,h,u,g,p,m,f,x,v=this,A=v.chart,P=v.options,y=P.gridLines,b=P.position,j=y.offsetGridLines,S=v.isHorizontal(),D=v._ticksToDraw,w=D.length+(j?1:0),I=sr(y),k=[],_=y.drawBorder?er(y.lineWidth,0,0):0,N=_/2,M=se._alignPixel,C=function(e){return M(A,e,_)};for("top"===b?(t=C(v.bottom),o=v.bottom-I,c=t-N,h=C(e.top)+N,g=e.bottom):"bottom"===b?(t=C(v.top),h=e.top,g=C(e.bottom)-N,o=t+N,c=v.top+I):"left"===b?(t=C(v.right),a=v.right-I,l=t-N,d=C(e.left)+N,u=e.right):(t=C(v.left),d=e.left,u=C(e.right)-N,a=t+N,l=v.left+I),n=0;n<w;++n)r=D[n]||{},Zn(r.label)&&n<D.length||(n===v.zeroLineIndex&&P.offset===j?(p=y.zeroLineWidth,m=y.zeroLineColor,f=y.zeroLineBorderDash||[],x=y.zeroLineBorderDashOffset||0):(p=er(y.lineWidth,n,1),m=er(y.color,n,"rgba(0,0,0,0.1)"),f=y.borderDash||[],x=y.borderDashOffset||0),void 0!==(i=nr(v,r._index||n,j))&&(s=M(A,i,p),S?a=l=d=u=s:o=c=h=g=s,k.push({tx1:a,ty1:o,tx2:l,ty2:c,x1:d,y1:h,x2:u,y2:g,width:p,color:m,borderDash:f,borderDashOffset:x})));return k.ticksLength=w,k.borderValue=t,k},_computeLabelItems:function(){var e,t,n,r,i,s,a,o,l,c,d,h,u=this,g=u.options,p=g.ticks,m=g.position,f=p.mirror,x=u.isHorizontal(),v=u._ticksToDraw,A=lr(p),P=p.padding,y=sr(g.gridLines),b=-se.toRadians(u.labelRotation),j=[];for("top"===m?(s=u.bottom-y-P,a=b?"left":"center"):"bottom"===m?(s=u.top+y+P,a=b?"right":"center"):"left"===m?(i=u.right-(f?0:y)-P,a=f?"left":"right"):(i=u.left+(f?0:y)+P,a=f?"right":"left"),e=0,t=v.length;e<t;++e)r=(n=v[e]).label,Zn(r)||(o=u.getPixelForTick(n._index||e)+p.labelOffset,c=(l=n.major?A.major:A.minor).lineHeight,d=$n(r)?r.length:1,x?(i=o,h="top"===m?((b?1:.5)-d)*c:(b?0:.5)*c):(s=o,h=(1-d)*c/2),j.push({x:i,y:s,rotation:b,label:r,font:l,textOffset:h,textAlign:a}));return j},_drawGrid:function(e){var t=this,n=t.options.gridLines;if(n.display){var r,i,s,a,o,l=t.ctx,c=t.chart,d=se._alignPixel,h=n.drawBorder?er(n.lineWidth,0,0):0,u=t._gridLineItems||(t._gridLineItems=t._computeGridLineItems(e));for(s=0,a=u.length;s<a;++s)r=(o=u[s]).width,i=o.color,r&&i&&(l.save(),l.lineWidth=r,l.strokeStyle=i,l.setLineDash&&(l.setLineDash(o.borderDash),l.lineDashOffset=o.borderDashOffset),l.beginPath(),n.drawTicks&&(l.moveTo(o.tx1,o.ty1),l.lineTo(o.tx2,o.ty2)),n.drawOnChartArea&&(l.moveTo(o.x1,o.y1),l.lineTo(o.x2,o.y2)),l.stroke(),l.restore());if(h){var g,p,m,f,x=h,v=er(n.lineWidth,u.ticksLength-1,1),A=u.borderValue;t.isHorizontal()?(g=d(c,t.left,x)-x/2,p=d(c,t.right,v)+v/2,m=f=A):(m=d(c,t.top,x)-x/2,f=d(c,t.bottom,v)+v/2,g=p=A),l.lineWidth=h,l.strokeStyle=er(n.color,0),l.beginPath(),l.moveTo(g,m),l.lineTo(p,f),l.stroke()}}},_drawLabels:function(){var e=this;if(e.options.ticks.display){var t,n,r,i,s,a,o,l,c=e.ctx,d=e._labelItems||(e._labelItems=e._computeLabelItems());for(t=0,r=d.length;t<r;++t){if(a=(s=d[t]).font,c.save(),c.translate(s.x,s.y),c.rotate(s.rotation),c.font=a.string,c.fillStyle=a.color,c.textBaseline="middle",c.textAlign=s.textAlign,o=s.label,l=s.textOffset,$n(o))for(n=0,i=o.length;n<i;++n)c.fillText(""+o[n],0,l),l+=a.lineHeight;else c.fillText(o,0,l);c.restore()}}},_drawTitle:function(){var e=this,t=e.ctx,n=e.options,r=n.scaleLabel;if(r.display){var i,s,a=Jn(r.fontColor,$.global.defaultFontColor),o=se.options._parseFont(r),l=se.options.toPadding(r.padding),c=o.lineHeight/2,d=n.position,h=0;if(e.isHorizontal())i=e.left+e.width/2,s="bottom"===d?e.bottom-c-l.bottom:e.top+c+l.top;else{var u="left"===d;i=u?e.left+c+l.top:e.right-c-l.top,s=e.top+e.height/2,h=u?-.5*Math.PI:.5*Math.PI}t.save(),t.translate(i,s),t.rotate(h),t.textAlign="center",t.textBaseline="middle",t.fillStyle=a,t.font=o.string,t.fillText(r.labelString,0,0),t.restore()}},draw:function(e){var t=this;t._isVisible()&&(t._drawGrid(e),t._drawTitle(),t._drawLabels())},_layers:function(){var e=this,t=e.options,n=t.ticks&&t.ticks.z||0,r=t.gridLines&&t.gridLines.z||0;return e._isVisible()&&n!==r&&e.draw===e._draw?[{z:r,draw:function(){e._drawGrid.apply(e,arguments),e._drawTitle.apply(e,arguments)}},{z:n,draw:function(){e._drawLabels.apply(e,arguments)}}]:[{z:n,draw:function(){e.draw.apply(e,arguments)}}]},_getMatchingVisibleMetas:function(e){var t=this,n=t.isHorizontal();return t.chart._getSortedVisibleDatasetMetas().filter((function(r){return(!e||r.type===e)&&(n?r.xAxisID===t.id:r.yAxisID===t.id)}))}});mr.prototype._draw=mr.prototype.draw;var fr=mr,xr=se.isNullOrUndef,vr={position:"bottom"},Ar=fr.extend({determineDataLimits:function(){var e,t=this,n=t._getLabels(),r=t.options.ticks,i=r.min,s=r.max,a=0,o=n.length-1;void 0!==i&&(e=n.indexOf(i))>=0&&(a=e),void 0!==s&&(e=n.indexOf(s))>=0&&(o=e),t.minIndex=a,t.maxIndex=o,t.min=n[a],t.max=n[o]},buildTicks:function(){var e=this,t=e._getLabels(),n=e.minIndex,r=e.maxIndex;e.ticks=0===n&&r===t.length-1?t:t.slice(n,r+1)},getLabelForIndex:function(e,t){var n=this,r=n.chart;return r.getDatasetMeta(t).controller._getValueScaleId()===n.id?n.getRightValue(r.data.datasets[t].data[e]):n._getLabels()[e]},_configure:function(){var e=this,t=e.options.offset,n=e.ticks;fr.prototype._configure.call(e),e.isHorizontal()||(e._reversePixels=!e._reversePixels),n&&(e._startValue=e.minIndex-(t?.5:0),e._valueRange=Math.max(n.length-(t?0:1),1))},getPixelForValue:function(e,t,n){var r,i,s,a=this;return xr(t)||xr(n)||(e=a.chart.data.datasets[n].data[t]),xr(e)||(r=a.isHorizontal()?e.x:e.y),(void 0!==r||void 0!==e&&isNaN(t))&&(i=a._getLabels(),e=se.valueOrDefault(r,e),t=-1!==(s=i.indexOf(e))?s:t,isNaN(t)&&(t=e)),a.getPixelForDecimal((t-a._startValue)/a._valueRange)},getPixelForTick:function(e){var t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e],e+this.minIndex)},getValueForPixel:function(e){var t=this,n=Math.round(t._startValue+t.getDecimalForPixel(e)*t._valueRange);return Math.min(Math.max(n,0),t.ticks.length-1)},getBasePixel:function(){return this.bottom}}),Pr=vr;Ar._defaults=Pr;var yr=se.noop,br=se.isNullOrUndef;function jr(e,t){var n,r,i,s,a=[],o=1e-14,l=e.stepSize,c=l||1,d=e.maxTicks-1,h=e.min,u=e.max,g=e.precision,p=t.min,m=t.max,f=se.niceNum((m-p)/d/c)*c;if(f<o&&br(h)&&br(u))return[p,m];(s=Math.ceil(m/f)-Math.floor(p/f))>d&&(f=se.niceNum(s*f/d/c)*c),l||br(g)?n=Math.pow(10,se._decimalPlaces(f)):(n=Math.pow(10,g),f=Math.ceil(f*n)/n),r=Math.floor(p/f)*f,i=Math.ceil(m/f)*f,l&&(!br(h)&&se.almostWhole(h/f,f/1e3)&&(r=h),!br(u)&&se.almostWhole(u/f,f/1e3)&&(i=u)),s=(i-r)/f,s=se.almostEquals(s,Math.round(s),f/1e3)?Math.round(s):Math.ceil(s),r=Math.round(r*n)/n,i=Math.round(i*n)/n,a.push(br(h)?r:h);for(var x=1;x<s;++x)a.push(Math.round((r+x*f)*n)/n);return a.push(br(u)?i:u),a}var Sr=fr.extend({getRightValue:function(e){return"string"===typeof e?+e:fr.prototype.getRightValue.call(this,e)},handleTickRangeOptions:function(){var e=this,t=e.options.ticks;if(t.beginAtZero){var n=se.sign(e.min),r=se.sign(e.max);n<0&&r<0?e.max=0:n>0&&r>0&&(e.min=0)}var i=void 0!==t.min||void 0!==t.suggestedMin,s=void 0!==t.max||void 0!==t.suggestedMax;void 0!==t.min?e.min=t.min:void 0!==t.suggestedMin&&(null===e.min?e.min=t.suggestedMin:e.min=Math.min(e.min,t.suggestedMin)),void 0!==t.max?e.max=t.max:void 0!==t.suggestedMax&&(null===e.max?e.max=t.suggestedMax:e.max=Math.max(e.max,t.suggestedMax)),i!==s&&e.min>=e.max&&(i?e.max=e.min+1:e.min=e.max-1),e.min===e.max&&(e.max++,t.beginAtZero||e.min--)},getTickLimit:function(){var e,t=this,n=t.options.ticks,r=n.stepSize,i=n.maxTicksLimit;return r?e=Math.ceil(t.max/r)-Math.floor(t.min/r)+1:(e=t._computeTickLimit(),i=i||11),i&&(e=Math.min(i,e)),e},_computeTickLimit:function(){return Number.POSITIVE_INFINITY},handleDirectionalChanges:yr,buildTicks:function(){var e=this,t=e.options.ticks,n=e.getTickLimit(),r={maxTicks:n=Math.max(2,n),min:t.min,max:t.max,precision:t.precision,stepSize:se.valueOrDefault(t.fixedStepSize,t.stepSize)},i=e.ticks=jr(r,e);e.handleDirectionalChanges(),e.max=se.max(i),e.min=se.min(i),t.reverse?(i.reverse(),e.start=e.max,e.end=e.min):(e.start=e.min,e.end=e.max)},convertTicksToLabels:function(){var e=this;e.ticksAsNumbers=e.ticks.slice(),e.zeroLineIndex=e.ticks.indexOf(0),fr.prototype.convertTicksToLabels.call(e)},_configure:function(){var e,t=this,n=t.getTicks(),r=t.min,i=t.max;fr.prototype._configure.call(t),t.options.offset&&n.length&&(r-=e=(i-r)/Math.max(n.length-1,1)/2,i+=e),t._startValue=r,t._endValue=i,t._valueRange=i-r}}),Dr={position:"left",ticks:{callback:Xn.formatters.linear}},wr=0,Ir=1;function kr(e,t,n){var r=[n.type,void 0===t&&void 0===n.stack?n.index:"",n.stack].join(".");return void 0===e[r]&&(e[r]={pos:[],neg:[]}),e[r]}function _r(e,t,n,r){var i,s,a=e.options,o=kr(t,a.stacked,n),l=o.pos,c=o.neg,d=r.length;for(i=0;i<d;++i)s=e._parseValue(r[i]),isNaN(s.min)||isNaN(s.max)||n.data[i].hidden||(l[i]=l[i]||0,c[i]=c[i]||0,a.relativePoints?l[i]=100:s.min<0||s.max<0?c[i]+=s.min:l[i]+=s.max)}function Nr(e,t,n){var r,i,s=n.length;for(r=0;r<s;++r)i=e._parseValue(n[r]),isNaN(i.min)||isNaN(i.max)||t.data[r].hidden||(e.min=Math.min(e.min,i.min),e.max=Math.max(e.max,i.max))}var Mr=Sr.extend({determineDataLimits:function(){var e,t,n,r,i=this,s=i.options,a=i.chart.data.datasets,o=i._getMatchingVisibleMetas(),l=s.stacked,c={},d=o.length;if(i.min=Number.POSITIVE_INFINITY,i.max=Number.NEGATIVE_INFINITY,void 0===l)for(e=0;!l&&e<d;++e)l=void 0!==(t=o[e]).stack;for(e=0;e<d;++e)n=a[(t=o[e]).index].data,l?_r(i,c,t,n):Nr(i,t,n);se.each(c,(function(e){r=e.pos.concat(e.neg),i.min=Math.min(i.min,se.min(r)),i.max=Math.max(i.max,se.max(r))})),i.min=se.isFinite(i.min)&&!isNaN(i.min)?i.min:wr,i.max=se.isFinite(i.max)&&!isNaN(i.max)?i.max:Ir,i.handleTickRangeOptions()},_computeTickLimit:function(){var e,t=this;return t.isHorizontal()?Math.ceil(t.width/40):(e=se.options._parseFont(t.options.ticks),Math.ceil(t.height/e.lineHeight))},handleDirectionalChanges:function(){this.isHorizontal()||this.ticks.reverse()},getLabelForIndex:function(e,t){return this._getScaleLabel(this.chart.data.datasets[t].data[e])},getPixelForValue:function(e){var t=this;return t.getPixelForDecimal((+t.getRightValue(e)-t._startValue)/t._valueRange)},getValueForPixel:function(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange},getPixelForTick:function(e){var t=this.ticksAsNumbers;return e<0||e>t.length-1?null:this.getPixelForValue(t[e])}}),Cr=Dr;Mr._defaults=Cr;var Or=se.valueOrDefault,Lr=se.math.log10;function Tr(e,t){var n,r,i=[],s=Or(e.min,Math.pow(10,Math.floor(Lr(t.min)))),a=Math.floor(Lr(t.max)),o=Math.ceil(t.max/Math.pow(10,a));0===s?(n=Math.floor(Lr(t.minNotZero)),r=Math.floor(t.minNotZero/Math.pow(10,n)),i.push(s),s=r*Math.pow(10,n)):(n=Math.floor(Lr(s)),r=Math.floor(s/Math.pow(10,n)));var l=n<0?Math.pow(10,Math.abs(n)):1;do{i.push(s),10===++r&&(r=1,l=++n>=0?1:l),s=Math.round(r*Math.pow(10,n)*l)/l}while(n<a||n===a&&r<o);var c=Or(e.max,s);return i.push(c),i}var Fr={position:"left",ticks:{callback:Xn.formatters.logarithmic}};function Rr(e,t){return se.isFinite(e)&&e>=0?e:t}var Er=fr.extend({determineDataLimits:function(){var e,t,n,r,i,s,a=this,o=a.options,l=a.chart,c=l.data.datasets,d=a.isHorizontal();function h(e){return d?e.xAxisID===a.id:e.yAxisID===a.id}a.min=Number.POSITIVE_INFINITY,a.max=Number.NEGATIVE_INFINITY,a.minNotZero=Number.POSITIVE_INFINITY;var u=o.stacked;if(void 0===u)for(e=0;e<c.length;e++)if(t=l.getDatasetMeta(e),l.isDatasetVisible(e)&&h(t)&&void 0!==t.stack){u=!0;break}if(o.stacked||u){var g={};for(e=0;e<c.length;e++){var p=[(t=l.getDatasetMeta(e)).type,void 0===o.stacked&&void 0===t.stack?e:"",t.stack].join(".");if(l.isDatasetVisible(e)&&h(t))for(void 0===g[p]&&(g[p]=[]),i=0,s=(r=c[e].data).length;i<s;i++){var m=g[p];n=a._parseValue(r[i]),isNaN(n.min)||isNaN(n.max)||t.data[i].hidden||n.min<0||n.max<0||(m[i]=m[i]||0,m[i]+=n.max)}}se.each(g,(function(e){if(e.length>0){var t=se.min(e),n=se.max(e);a.min=Math.min(a.min,t),a.max=Math.max(a.max,n)}}))}else for(e=0;e<c.length;e++)if(t=l.getDatasetMeta(e),l.isDatasetVisible(e)&&h(t))for(i=0,s=(r=c[e].data).length;i<s;i++)n=a._parseValue(r[i]),isNaN(n.min)||isNaN(n.max)||t.data[i].hidden||n.min<0||n.max<0||(a.min=Math.min(n.min,a.min),a.max=Math.max(n.max,a.max),0!==n.min&&(a.minNotZero=Math.min(n.min,a.minNotZero)));a.min=se.isFinite(a.min)?a.min:null,a.max=se.isFinite(a.max)?a.max:null,a.minNotZero=se.isFinite(a.minNotZero)?a.minNotZero:null,this.handleTickRangeOptions()},handleTickRangeOptions:function(){var e=this,t=e.options.ticks,n=1,r=10;e.min=Rr(t.min,e.min),e.max=Rr(t.max,e.max),e.min===e.max&&(0!==e.min&&null!==e.min?(e.min=Math.pow(10,Math.floor(Lr(e.min))-1),e.max=Math.pow(10,Math.floor(Lr(e.max))+1)):(e.min=n,e.max=r)),null===e.min&&(e.min=Math.pow(10,Math.floor(Lr(e.max))-1)),null===e.max&&(e.max=0!==e.min?Math.pow(10,Math.floor(Lr(e.min))+1):r),null===e.minNotZero&&(e.min>0?e.minNotZero=e.min:e.max<1?e.minNotZero=Math.pow(10,Math.floor(Lr(e.max))):e.minNotZero=n)},buildTicks:function(){var e=this,t=e.options.ticks,n=!e.isHorizontal(),r={min:Rr(t.min),max:Rr(t.max)},i=e.ticks=Tr(r,e);e.max=se.max(i),e.min=se.min(i),t.reverse?(n=!n,e.start=e.max,e.end=e.min):(e.start=e.min,e.end=e.max),n&&i.reverse()},convertTicksToLabels:function(){this.tickValues=this.ticks.slice(),fr.prototype.convertTicksToLabels.call(this)},getLabelForIndex:function(e,t){return this._getScaleLabel(this.chart.data.datasets[t].data[e])},getPixelForTick:function(e){var t=this.tickValues;return e<0||e>t.length-1?null:this.getPixelForValue(t[e])},_getFirstTickValue:function(e){var t=Math.floor(Lr(e));return Math.floor(e/Math.pow(10,t))*Math.pow(10,t)},_configure:function(){var e=this,t=e.min,n=0;fr.prototype._configure.call(e),0===t&&(t=e._getFirstTickValue(e.minNotZero),n=Or(e.options.ticks.fontSize,$.global.defaultFontSize)/e._length),e._startValue=Lr(t),e._valueOffset=n,e._valueRange=(Lr(e.max)-Lr(t))/(1-n)},getPixelForValue:function(e){var t=this,n=0;return(e=+t.getRightValue(e))>t.min&&e>0&&(n=(Lr(e)-t._startValue)/t._valueRange+t._valueOffset),t.getPixelForDecimal(n)},getValueForPixel:function(e){var t=this,n=t.getDecimalForPixel(e);return 0===n&&0===t.min?0:Math.pow(10,t._startValue+(n-t._valueOffset)*t._valueRange)}}),Ur=Fr;Er._defaults=Ur;var zr=se.valueOrDefault,Br=se.valueAtIndexOrDefault,qr=se.options.resolve,Yr={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,color:"rgba(0,0,0,0.1)",lineWidth:1,borderDash:[],borderDashOffset:0},gridLines:{circular:!1},ticks:{showLabelBackdrop:!0,backdropColor:"rgba(255,255,255,0.75)",backdropPaddingY:2,backdropPaddingX:2,callback:Xn.formatters.linear},pointLabels:{display:!0,fontSize:10,callback:function(e){return e}}};function Vr(e){var t=e.ticks;return t.display&&e.display?zr(t.fontSize,$.global.defaultFontSize)+2*t.backdropPaddingY:0}function Hr(e,t,n){return se.isArray(n)?{w:se.longestText(e,e.font,n),h:n.length*t}:{w:e.measureText(n).width,h:t}}function Wr(e,t,n,r,i){return e===r||e===i?{start:t-n/2,end:t+n/2}:e<r||e>i?{start:t-n,end:t}:{start:t,end:t+n}}function Gr(e){var t,n,r,i=se.options._parseFont(e.options.pointLabels),s={l:0,r:e.width,t:0,b:e.height-e.paddingTop},a={};e.ctx.font=i.string,e._pointLabelSizes=[];var o=e.chart.data.labels.length;for(t=0;t<o;t++){r=e.getPointPosition(t,e.drawingArea+5),n=Hr(e.ctx,i.lineHeight,e.pointLabels[t]),e._pointLabelSizes[t]=n;var l=e.getIndexAngle(t),c=se.toDegrees(l)%360,d=Wr(c,r.x,n.w,0,180),h=Wr(c,r.y,n.h,90,270);d.start<s.l&&(s.l=d.start,a.l=l),d.end>s.r&&(s.r=d.end,a.r=l),h.start<s.t&&(s.t=h.start,a.t=l),h.end>s.b&&(s.b=h.end,a.b=l)}e.setReductions(e.drawingArea,s,a)}function Qr(e){return 0===e||180===e?"center":e<180?"left":"right"}function Kr(e,t,n,r){var i,s,a=n.y+r/2;if(se.isArray(t))for(i=0,s=t.length;i<s;++i)e.fillText(t[i],n.x,a),a+=r;else e.fillText(t,n.x,a)}function Xr(e,t,n){90===e||270===e?n.y-=t.h/2:(e>270||e<90)&&(n.y-=t.h)}function $r(e){var t=e.ctx,n=e.options,r=n.pointLabels,i=Vr(n),s=e.getDistanceFromCenterForValue(n.ticks.reverse?e.min:e.max),a=se.options._parseFont(r);t.save(),t.font=a.string,t.textBaseline="middle";for(var o=e.chart.data.labels.length-1;o>=0;o--){var l=0===o?i/2:0,c=e.getPointPosition(o,s+l+5),d=Br(r.fontColor,o,$.global.defaultFontColor);t.fillStyle=d;var h=e.getIndexAngle(o),u=se.toDegrees(h);t.textAlign=Qr(u),Xr(u,e._pointLabelSizes[o],c),Kr(t,e.pointLabels[o],c,a.lineHeight)}t.restore()}function Zr(e,t,n,r){var i,s=e.ctx,a=t.circular,o=e.chart.data.labels.length,l=Br(t.color,r-1),c=Br(t.lineWidth,r-1);if((a||o)&&l&&c){if(s.save(),s.strokeStyle=l,s.lineWidth=c,s.setLineDash&&(s.setLineDash(t.borderDash||[]),s.lineDashOffset=t.borderDashOffset||0),s.beginPath(),a)s.arc(e.xCenter,e.yCenter,n,0,2*Math.PI);else{i=e.getPointPosition(0,n),s.moveTo(i.x,i.y);for(var d=1;d<o;d++)i=e.getPointPosition(d,n),s.lineTo(i.x,i.y)}s.closePath(),s.stroke(),s.restore()}}function Jr(e){return se.isNumber(e)?e:0}var ei=Sr.extend({setDimensions:function(){var e=this;e.width=e.maxWidth,e.height=e.maxHeight,e.paddingTop=Vr(e.options)/2,e.xCenter=Math.floor(e.width/2),e.yCenter=Math.floor((e.height-e.paddingTop)/2),e.drawingArea=Math.min(e.height-e.paddingTop,e.width)/2},determineDataLimits:function(){var e=this,t=e.chart,n=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;se.each(t.data.datasets,(function(i,s){if(t.isDatasetVisible(s)){var a=t.getDatasetMeta(s);se.each(i.data,(function(t,i){var s=+e.getRightValue(t);isNaN(s)||a.data[i].hidden||(n=Math.min(s,n),r=Math.max(s,r))}))}})),e.min=n===Number.POSITIVE_INFINITY?0:n,e.max=r===Number.NEGATIVE_INFINITY?0:r,e.handleTickRangeOptions()},_computeTickLimit:function(){return Math.ceil(this.drawingArea/Vr(this.options))},convertTicksToLabels:function(){var e=this;Sr.prototype.convertTicksToLabels.call(e),e.pointLabels=e.chart.data.labels.map((function(){var t=se.callback(e.options.pointLabels.callback,arguments,e);return t||0===t?t:""}))},getLabelForIndex:function(e,t){return+this.getRightValue(this.chart.data.datasets[t].data[e])},fit:function(){var e=this,t=e.options;t.display&&t.pointLabels.display?Gr(e):e.setCenterPoint(0,0,0,0)},setReductions:function(e,t,n){var r=this,i=t.l/Math.sin(n.l),s=Math.max(t.r-r.width,0)/Math.sin(n.r),a=-t.t/Math.cos(n.t),o=-Math.max(t.b-(r.height-r.paddingTop),0)/Math.cos(n.b);i=Jr(i),s=Jr(s),a=Jr(a),o=Jr(o),r.drawingArea=Math.min(Math.floor(e-(i+s)/2),Math.floor(e-(a+o)/2)),r.setCenterPoint(i,s,a,o)},setCenterPoint:function(e,t,n,r){var i=this,s=i.width-t-i.drawingArea,a=e+i.drawingArea,o=n+i.drawingArea,l=i.height-i.paddingTop-r-i.drawingArea;i.xCenter=Math.floor((a+s)/2+i.left),i.yCenter=Math.floor((o+l)/2+i.top+i.paddingTop)},getIndexAngle:function(e){var t=this.chart,n=(e*(360/t.data.labels.length)+((t.options||{}).startAngle||0))%360;return(n<0?n+360:n)*Math.PI*2/360},getDistanceFromCenterForValue:function(e){var t=this;if(se.isNullOrUndef(e))return NaN;var n=t.drawingArea/(t.max-t.min);return t.options.ticks.reverse?(t.max-e)*n:(e-t.min)*n},getPointPosition:function(e,t){var n=this,r=n.getIndexAngle(e)-Math.PI/2;return{x:Math.cos(r)*t+n.xCenter,y:Math.sin(r)*t+n.yCenter}},getPointPositionForValue:function(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))},getBasePosition:function(e){var t=this,n=t.min,r=t.max;return t.getPointPositionForValue(e||0,t.beginAtZero?0:n<0&&r<0?r:n>0&&r>0?n:0)},_drawGrid:function(){var e,t,n,r=this,i=r.ctx,s=r.options,a=s.gridLines,o=s.angleLines,l=zr(o.lineWidth,a.lineWidth),c=zr(o.color,a.color);if(s.pointLabels.display&&$r(r),a.display&&se.each(r.ticks,(function(e,n){0!==n&&(t=r.getDistanceFromCenterForValue(r.ticksAsNumbers[n]),Zr(r,a,t,n))})),o.display&&l&&c){for(i.save(),i.lineWidth=l,i.strokeStyle=c,i.setLineDash&&(i.setLineDash(qr([o.borderDash,a.borderDash,[]])),i.lineDashOffset=qr([o.borderDashOffset,a.borderDashOffset,0])),e=r.chart.data.labels.length-1;e>=0;e--)t=r.getDistanceFromCenterForValue(s.ticks.reverse?r.min:r.max),n=r.getPointPosition(e,t),i.beginPath(),i.moveTo(r.xCenter,r.yCenter),i.lineTo(n.x,n.y),i.stroke();i.restore()}},_drawLabels:function(){var e=this,t=e.ctx,n=e.options.ticks;if(n.display){var r,i,s=e.getIndexAngle(0),a=se.options._parseFont(n),o=zr(n.fontColor,$.global.defaultFontColor);t.save(),t.font=a.string,t.translate(e.xCenter,e.yCenter),t.rotate(s),t.textAlign="center",t.textBaseline="middle",se.each(e.ticks,(function(s,l){(0!==l||n.reverse)&&(r=e.getDistanceFromCenterForValue(e.ticksAsNumbers[l]),n.showLabelBackdrop&&(i=t.measureText(s).width,t.fillStyle=n.backdropColor,t.fillRect(-i/2-n.backdropPaddingX,-r-a.size/2-n.backdropPaddingY,i+2*n.backdropPaddingX,a.size+2*n.backdropPaddingY)),t.fillStyle=o,t.fillText(s,0,-r))})),t.restore()}},_drawTitle:se.noop}),ti=Yr;ei._defaults=ti;var ni=se._deprecated,ri=se.options.resolve,ii=se.valueOrDefault,si=Number.MIN_SAFE_INTEGER||-9007199254740991,ai=Number.MAX_SAFE_INTEGER||9007199254740991,oi={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},li=Object.keys(oi);function ci(e,t){return e-t}function di(e){var t,n,r,i={},s=[];for(t=0,n=e.length;t<n;++t)i[r=e[t]]||(i[r]=!0,s.push(r));return s}function hi(e){return se.valueOrDefault(e.time.min,e.ticks.min)}function ui(e){return se.valueOrDefault(e.time.max,e.ticks.max)}function gi(e,t,n,r){if("linear"===r||!e.length)return[{time:t,pos:0},{time:n,pos:1}];var i,s,a,o,l,c=[],d=[t];for(i=0,s=e.length;i<s;++i)(o=e[i])>t&&o<n&&d.push(o);for(d.push(n),i=0,s=d.length;i<s;++i)l=d[i+1],a=d[i-1],o=d[i],void 0!==a&&void 0!==l&&Math.round((l+a)/2)===o||c.push({time:o,pos:i/(s-1)});return c}function pi(e,t,n){for(var r,i,s,a=0,o=e.length-1;a>=0&&a<=o;){if(i=e[(r=a+o>>1)-1]||null,s=e[r],!i)return{lo:null,hi:s};if(s[t]<n)a=r+1;else{if(!(i[t]>n))return{lo:i,hi:s};o=r-1}}return{lo:s,hi:null}}function mi(e,t,n,r){var i=pi(e,t,n),s=i.lo?i.hi?i.lo:e[e.length-2]:e[0],a=i.lo?i.hi?i.hi:e[e.length-1]:e[1],o=a[t]-s[t],l=o?(n-s[t])/o:0,c=(a[r]-s[r])*l;return s[r]+c}function fi(e,t){var n=e._adapter,r=e.options.time,i=r.parser,s=i||r.format,a=t;return"function"===typeof i&&(a=i(a)),se.isFinite(a)||(a="string"===typeof s?n.parse(a,s):n.parse(a)),null!==a?+a:(i||"function"!==typeof s||(a=s(t),se.isFinite(a)||(a=n.parse(a))),a)}function xi(e,t){if(se.isNullOrUndef(t))return null;var n=e.options.time,r=fi(e,e.getRightValue(t));return null===r||n.round&&(r=+e._adapter.startOf(r,n.round)),r}function vi(e,t,n,r){var i,s,a,o=li.length;for(i=li.indexOf(e);i<o-1;++i)if(a=(s=oi[li[i]]).steps?s.steps:ai,s.common&&Math.ceil((n-t)/(a*s.size))<=r)return li[i];return li[o-1]}function Ai(e,t,n,r,i){var s,a;for(s=li.length-1;s>=li.indexOf(n);s--)if(a=li[s],oi[a].common&&e._adapter.diff(i,r,a)>=t-1)return a;return li[n?li.indexOf(n):0]}function Pi(e){for(var t=li.indexOf(e)+1,n=li.length;t<n;++t)if(oi[li[t]].common)return li[t]}function yi(e,t,n,r){var i,s=e._adapter,a=e.options,o=a.time,l=o.unit||vi(o.minUnit,t,n,r),c=ri([o.stepSize,o.unitStepSize,1]),d="week"===l&&o.isoWeekday,h=t,u=[];if(d&&(h=+s.startOf(h,"isoWeek",d)),h=+s.startOf(h,d?"day":l),s.diff(n,t,l)>1e5*c)throw t+" and "+n+" are too far apart with stepSize of "+c+" "+l;for(i=h;i<n;i=+s.add(i,c,l))u.push(i);return i!==n&&"ticks"!==a.bounds||u.push(i),u}function bi(e,t,n,r,i){var s,a,o=0,l=0;return i.offset&&t.length&&(s=mi(e,"time",t[0],"pos"),o=1===t.length?1-s:(mi(e,"time",t[1],"pos")-s)/2,a=mi(e,"time",t[t.length-1],"pos"),l=1===t.length?a:(a-mi(e,"time",t[t.length-2],"pos"))/2),{start:o,end:l,factor:1/(o+1+l)}}function ji(e,t,n,r){var i,s,a=e._adapter,o=+a.startOf(t[0].value,r),l=t[t.length-1].value;for(i=o;i<=l;i=+a.add(i,1,r))(s=n[i])>=0&&(t[s].major=!0);return t}function Si(e,t,n){var r,i,s=[],a={},o=t.length;for(r=0;r<o;++r)a[i=t[r]]=r,s.push({value:i,major:!1});return 0!==o&&n?ji(e,s,a,n):s}var Di={position:"bottom",distribution:"linear",bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,displayFormat:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{autoSkip:!1,source:"auto",major:{enabled:!1}}},wi=fr.extend({initialize:function(){this.mergeTicksOptions(),fr.prototype.initialize.call(this)},update:function(){var e=this,t=e.options,n=t.time||(t.time={}),r=e._adapter=new Kn._date(t.adapters.date);return ni("time scale",n.format,"time.format","time.parser"),ni("time scale",n.min,"time.min","ticks.min"),ni("time scale",n.max,"time.max","ticks.max"),se.mergeIf(n.displayFormats,r.formats()),fr.prototype.update.apply(e,arguments)},getRightValue:function(e){return e&&void 0!==e.t&&(e=e.t),fr.prototype.getRightValue.call(this,e)},determineDataLimits:function(){var e,t,n,r,i,s,a,o=this,l=o.chart,c=o._adapter,d=o.options,h=d.time.unit||"day",u=ai,g=si,p=[],m=[],f=[],x=o._getLabels();for(e=0,n=x.length;e<n;++e)f.push(xi(o,x[e]));for(e=0,n=(l.data.datasets||[]).length;e<n;++e)if(l.isDatasetVisible(e))if(i=l.data.datasets[e].data,se.isObject(i[0]))for(m[e]=[],t=0,r=i.length;t<r;++t)s=xi(o,i[t]),p.push(s),m[e][t]=s;else m[e]=f.slice(0),a||(p=p.concat(f),a=!0);else m[e]=[];f.length&&(u=Math.min(u,f[0]),g=Math.max(g,f[f.length-1])),p.length&&(p=n>1?di(p).sort(ci):p.sort(ci),u=Math.min(u,p[0]),g=Math.max(g,p[p.length-1])),u=xi(o,hi(d))||u,g=xi(o,ui(d))||g,u=u===ai?+c.startOf(Date.now(),h):u,g=g===si?+c.endOf(Date.now(),h)+1:g,o.min=Math.min(u,g),o.max=Math.max(u+1,g),o._table=[],o._timestamps={data:p,datasets:m,labels:f}},buildTicks:function(){var e,t,n,r=this,i=r.min,s=r.max,a=r.options,o=a.ticks,l=a.time,c=r._timestamps,d=[],h=r.getLabelCapacity(i),u=o.source,g=a.distribution;for(c="data"===u||"auto"===u&&"series"===g?c.data:"labels"===u?c.labels:yi(r,i,s,h),"ticks"===a.bounds&&c.length&&(i=c[0],s=c[c.length-1]),i=xi(r,hi(a))||i,s=xi(r,ui(a))||s,e=0,t=c.length;e<t;++e)(n=c[e])>=i&&n<=s&&d.push(n);return r.min=i,r.max=s,r._unit=l.unit||(o.autoSkip?vi(l.minUnit,r.min,r.max,h):Ai(r,d.length,l.minUnit,r.min,r.max)),r._majorUnit=o.major.enabled&&"year"!==r._unit?Pi(r._unit):void 0,r._table=gi(r._timestamps.data,i,s,g),r._offsets=bi(r._table,d,i,s,a),o.reverse&&d.reverse(),Si(r,d,r._majorUnit)},getLabelForIndex:function(e,t){var n=this,r=n._adapter,i=n.chart.data,s=n.options.time,a=i.labels&&e<i.labels.length?i.labels[e]:"",o=i.datasets[t].data[e];return se.isObject(o)&&(a=n.getRightValue(o)),s.tooltipFormat?r.format(fi(n,a),s.tooltipFormat):"string"===typeof a?a:r.format(fi(n,a),s.displayFormats.datetime)},tickFormatFunction:function(e,t,n,r){var i=this,s=i._adapter,a=i.options,o=a.time.displayFormats,l=o[i._unit],c=i._majorUnit,d=o[c],h=n[t],u=a.ticks,g=c&&d&&h&&h.major,p=s.format(e,r||(g?d:l)),m=g?u.major:u.minor,f=ri([m.callback,m.userCallback,u.callback,u.userCallback]);return f?f(p,t,n):p},convertTicksToLabels:function(e){var t,n,r=[];for(t=0,n=e.length;t<n;++t)r.push(this.tickFormatFunction(e[t].value,t,e));return r},getPixelForOffset:function(e){var t=this,n=t._offsets,r=mi(t._table,"time",e,"pos");return t.getPixelForDecimal((n.start+r)*n.factor)},getPixelForValue:function(e,t,n){var r=this,i=null;if(void 0!==t&&void 0!==n&&(i=r._timestamps.datasets[n][t]),null===i&&(i=xi(r,e)),null!==i)return r.getPixelForOffset(i)},getPixelForTick:function(e){var t=this.getTicks();return e>=0&&e<t.length?this.getPixelForOffset(t[e].value):null},getValueForPixel:function(e){var t=this,n=t._offsets,r=t.getDecimalForPixel(e)/n.factor-n.end,i=mi(t._table,"pos",r,"time");return t._adapter._create(i)},_getLabelSize:function(e){var t=this,n=t.options.ticks,r=t.ctx.measureText(e).width,i=se.toRadians(t.isHorizontal()?n.maxRotation:n.minRotation),s=Math.cos(i),a=Math.sin(i),o=ii(n.fontSize,$.global.defaultFontSize);return{w:r*s+o*a,h:r*a+o*s}},getLabelWidth:function(e){return this._getLabelSize(e).w},getLabelCapacity:function(e){var t=this,n=t.options.time,r=n.displayFormats,i=r[n.unit]||r.millisecond,s=t.tickFormatFunction(e,0,Si(t,[e],t._majorUnit),i),a=t._getLabelSize(s),o=Math.floor(t.isHorizontal()?t.width/a.w:t.height/a.h);return t.options.offset&&o--,o>0?o:1}}),Ii=Di;wi._defaults=Ii;var ki={category:Ar,linear:Mr,logarithmic:Er,radialLinear:ei,time:wi},_i={datetime:"MMM D, YYYY, h:mm:ss a",millisecond:"h:mm:ss.SSS a",second:"h:mm:ss a",minute:"h:mm a",hour:"hA",day:"MMM D",week:"ll",month:"MMM YYYY",quarter:"[Q]Q - YYYY",year:"YYYY"};Kn._date.override("function"===typeof e?{_id:"moment",formats:function(){return _i},parse:function(t,n){return"string"===typeof t&&"string"===typeof n?t=e(t,n):t instanceof e||(t=e(t)),t.isValid()?t.valueOf():null},format:function(t,n){return e(t).format(n)},add:function(t,n,r){return e(t).add(n,r).valueOf()},diff:function(t,n,r){return e(t).diff(e(n),r)},startOf:function(t,n,r){return t=e(t),"isoWeek"===n?t.isoWeekday(r).valueOf():t.startOf(n).valueOf()},endOf:function(t,n){return e(t).endOf(n).valueOf()},_create:function(t){return e(t)}}:{}),$._set("global",{plugins:{filler:{propagate:!0}}});var Ni={dataset:function(e){var t=e.fill,n=e.chart,r=n.getDatasetMeta(t),i=r&&n.isDatasetVisible(t)&&r.dataset._children||[],s=i.length||0;return s?function(e,t){return t<s&&i[t]._view||null}:null},boundary:function(e){var t=e.boundary,n=t?t.x:null,r=t?t.y:null;return se.isArray(t)?function(e,n){return t[n]}:function(e){return{x:null===n?e.x:n,y:null===r?e.y:r}}}};function Mi(e,t,n){var r,i=e._model||{},s=i.fill;if(void 0===s&&(s=!!i.backgroundColor),!1===s||null===s)return!1;if(!0===s)return"origin";if(r=parseFloat(s,10),isFinite(r)&&Math.floor(r)===r)return"-"!==s[0]&&"+"!==s[0]||(r=t+r),!(r===t||r<0||r>=n)&&r;switch(s){case"bottom":return"start";case"top":return"end";case"zero":return"origin";case"origin":case"start":case"end":return s;default:return!1}}function Ci(e){var t,n=e.el._model||{},r=e.el._scale||{},i=e.fill,s=null;if(isFinite(i))return null;if("start"===i?s=void 0===n.scaleBottom?r.bottom:n.scaleBottom:"end"===i?s=void 0===n.scaleTop?r.top:n.scaleTop:void 0!==n.scaleZero?s=n.scaleZero:r.getBasePixel&&(s=r.getBasePixel()),void 0!==s&&null!==s){if(void 0!==s.x&&void 0!==s.y)return s;if(se.isFinite(s))return{x:(t=r.isHorizontal())?s:null,y:t?null:s}}return null}function Oi(e){var t,n,r,i,s,a=e.el._scale,o=a.options,l=a.chart.data.labels.length,c=e.fill,d=[];if(!l)return null;for(t=o.ticks.reverse?a.max:a.min,n=o.ticks.reverse?a.min:a.max,r=a.getPointPositionForValue(0,t),i=0;i<l;++i)s="start"===c||"end"===c?a.getPointPositionForValue(i,"start"===c?t:n):a.getBasePosition(i),o.gridLines.circular&&(s.cx=r.x,s.cy=r.y,s.angle=a.getIndexAngle(i)-Math.PI/2),d.push(s);return d}function Li(e){return(e.el._scale||{}).getPointPositionForValue?Oi(e):Ci(e)}function Ti(e,t,n){var r,i=e[t].fill,s=[t];if(!n)return i;for(;!1!==i&&-1===s.indexOf(i);){if(!isFinite(i))return i;if(!(r=e[i]))return!1;if(r.visible)return i;s.push(i),i=r.fill}return!1}function Fi(e){var t=e.fill,n="dataset";return!1===t?null:(isFinite(t)||(n="boundary"),Ni[n](e))}function Ri(e){return e&&!e.skip}function Ei(e,t,n,r,i){var s,a,o,l;if(r&&i){for(e.moveTo(t[0].x,t[0].y),s=1;s<r;++s)se.canvas.lineTo(e,t[s-1],t[s]);if(void 0===n[0].angle)for(e.lineTo(n[i-1].x,n[i-1].y),s=i-1;s>0;--s)se.canvas.lineTo(e,n[s],n[s-1],!0);else for(a=n[0].cx,o=n[0].cy,l=Math.sqrt(Math.pow(n[0].x-a,2)+Math.pow(n[0].y-o,2)),s=i-1;s>0;--s)e.arc(a,o,l,n[s].angle,n[s-1].angle,!0)}}function Ui(e,t,n,r,i,s){var a,o,l,c,d,h,u,g,p=t.length,m=r.spanGaps,f=[],x=[],v=0,A=0;for(e.beginPath(),a=0,o=p;a<o;++a)d=n(c=t[l=a%p]._view,l,r),h=Ri(c),u=Ri(d),s&&void 0===g&&h&&(o=p+(g=a+1)),h&&u?(v=f.push(c),A=x.push(d)):v&&A&&(m?(h&&f.push(c),u&&x.push(d)):(Ei(e,f,x,v,A),v=A=0,f=[],x=[]));Ei(e,f,x,v,A),e.closePath(),e.fillStyle=i,e.fill()}var zi={id:"filler",afterDatasetsUpdate:function(e,t){var n,r,i,s,a=(e.data.datasets||[]).length,o=t.propagate,l=[];for(r=0;r<a;++r)s=null,(i=(n=e.getDatasetMeta(r)).dataset)&&i._model&&i instanceof He.Line&&(s={visible:e.isDatasetVisible(r),fill:Mi(i,r,a),chart:e,el:i}),n.$filler=s,l.push(s);for(r=0;r<a;++r)(s=l[r])&&(s.fill=Ti(l,r,o),s.boundary=Li(s),s.mapper=Fi(s))},beforeDatasetsDraw:function(e){var t,n,r,i,s,a,o,l=e._getSortedVisibleDatasetMetas(),c=e.ctx;for(n=l.length-1;n>=0;--n)(t=l[n].$filler)&&t.visible&&(i=(r=t.el)._view,s=r._children||[],a=t.mapper,o=i.backgroundColor||$.global.defaultColor,a&&o&&s.length&&(se.canvas.clipArea(c,e.chartArea),Ui(c,s,a,i,o,r._loop),se.canvas.unclipArea(c)))}},Bi=se.rtl.getRtlAdapter,qi=se.noop,Yi=se.valueOrDefault;function Vi(e,t){return e.usePointStyle&&e.boxWidth>t?t:e.boxWidth}$._set("global",{legend:{display:!0,position:"top",align:"center",fullWidth:!0,reverse:!1,weight:1e3,onClick:function(e,t){var n=t.datasetIndex,r=this.chart,i=r.getDatasetMeta(n);i.hidden=null===i.hidden?!r.data.datasets[n].hidden:null,r.update()},onHover:null,onLeave:null,labels:{boxWidth:40,padding:10,generateLabels:function(e){var t=e.data.datasets,n=e.options.legend||{},r=n.labels&&n.labels.usePointStyle;return e._getSortedDatasetMetas().map((function(n){var i=n.controller.getStyle(r?0:void 0);return{text:t[n.index].label,fillStyle:i.backgroundColor,hidden:!e.isDatasetVisible(n.index),lineCap:i.borderCapStyle,lineDash:i.borderDash,lineDashOffset:i.borderDashOffset,lineJoin:i.borderJoinStyle,lineWidth:i.borderWidth,strokeStyle:i.borderColor,pointStyle:i.pointStyle,rotation:i.rotation,datasetIndex:n.index}}),this)}}},legendCallback:function(e){var t,n,r,i=document.createElement("ul"),s=e.data.datasets;for(i.setAttribute("class",e.id+"-legend"),t=0,n=s.length;t<n;t++)(r=i.appendChild(document.createElement("li"))).appendChild(document.createElement("span")).style.backgroundColor=s[t].backgroundColor,s[t].label&&r.appendChild(document.createTextNode(s[t].label));return i.outerHTML}});var Hi=ge.extend({initialize:function(e){var t=this;se.extend(t,e),t.legendHitBoxes=[],t._hoveredItem=null,t.doughnutMode=!1},beforeUpdate:qi,update:function(e,t,n){var r=this;return r.beforeUpdate(),r.maxWidth=e,r.maxHeight=t,r.margins=n,r.beforeSetDimensions(),r.setDimensions(),r.afterSetDimensions(),r.beforeBuildLabels(),r.buildLabels(),r.afterBuildLabels(),r.beforeFit(),r.fit(),r.afterFit(),r.afterUpdate(),r.minSize},afterUpdate:qi,beforeSetDimensions:qi,setDimensions:function(){var e=this;e.isHorizontal()?(e.width=e.maxWidth,e.left=0,e.right=e.width):(e.height=e.maxHeight,e.top=0,e.bottom=e.height),e.paddingLeft=0,e.paddingTop=0,e.paddingRight=0,e.paddingBottom=0,e.minSize={width:0,height:0}},afterSetDimensions:qi,beforeBuildLabels:qi,buildLabels:function(){var e=this,t=e.options.labels||{},n=se.callback(t.generateLabels,[e.chart],e)||[];t.filter&&(n=n.filter((function(n){return t.filter(n,e.chart.data)}))),e.options.reverse&&n.reverse(),e.legendItems=n},afterBuildLabels:qi,beforeFit:qi,fit:function(){var e=this,t=e.options,n=t.labels,r=t.display,i=e.ctx,s=se.options._parseFont(n),a=s.size,o=e.legendHitBoxes=[],l=e.minSize,c=e.isHorizontal();if(c?(l.width=e.maxWidth,l.height=r?10:0):(l.width=r?10:0,l.height=e.maxHeight),r){if(i.font=s.string,c){var d=e.lineWidths=[0],h=0;i.textAlign="left",i.textBaseline="middle",se.each(e.legendItems,(function(e,t){var r=Vi(n,a)+a/2+i.measureText(e.text).width;(0===t||d[d.length-1]+r+2*n.padding>l.width)&&(h+=a+n.padding,d[d.length-(t>0?0:1)]=0),o[t]={left:0,top:0,width:r,height:a},d[d.length-1]+=r+n.padding})),l.height+=h}else{var u=n.padding,g=e.columnWidths=[],p=e.columnHeights=[],m=n.padding,f=0,x=0;se.each(e.legendItems,(function(e,t){var r=Vi(n,a)+a/2+i.measureText(e.text).width;t>0&&x+a+2*u>l.height&&(m+=f+n.padding,g.push(f),p.push(x),f=0,x=0),f=Math.max(f,r),x+=a+u,o[t]={left:0,top:0,width:r,height:a}})),m+=f,g.push(f),p.push(x),l.width+=m}e.width=l.width,e.height=l.height}else e.width=l.width=e.height=l.height=0},afterFit:qi,isHorizontal:function(){return"top"===this.options.position||"bottom"===this.options.position},draw:function(){var e=this,t=e.options,n=t.labels,r=$.global,i=r.defaultColor,s=r.elements.line,a=e.height,o=e.columnHeights,l=e.width,c=e.lineWidths;if(t.display){var d,h=Bi(t.rtl,e.left,e.minSize.width),u=e.ctx,g=Yi(n.fontColor,r.defaultFontColor),p=se.options._parseFont(n),m=p.size;u.textAlign=h.textAlign("left"),u.textBaseline="middle",u.lineWidth=.5,u.strokeStyle=g,u.fillStyle=g,u.font=p.string;var f=Vi(n,m),x=e.legendHitBoxes,v=function(e,t,r){if(!(isNaN(f)||f<=0)){u.save();var a=Yi(r.lineWidth,s.borderWidth);if(u.fillStyle=Yi(r.fillStyle,i),u.lineCap=Yi(r.lineCap,s.borderCapStyle),u.lineDashOffset=Yi(r.lineDashOffset,s.borderDashOffset),u.lineJoin=Yi(r.lineJoin,s.borderJoinStyle),u.lineWidth=a,u.strokeStyle=Yi(r.strokeStyle,i),u.setLineDash&&u.setLineDash(Yi(r.lineDash,s.borderDash)),n&&n.usePointStyle){var o=f*Math.SQRT2/2,l=h.xPlus(e,f/2),c=t+m/2;se.canvas.drawPoint(u,r.pointStyle,o,l,c,r.rotation)}else u.fillRect(h.leftForLtr(e,f),t,f,m),0!==a&&u.strokeRect(h.leftForLtr(e,f),t,f,m);u.restore()}},A=function(e,t,n,r){var i=m/2,s=h.xPlus(e,f+i),a=t+i;u.fillText(n.text,s,a),n.hidden&&(u.beginPath(),u.lineWidth=2,u.moveTo(s,a),u.lineTo(h.xPlus(s,r),a),u.stroke())},P=function(e,r){switch(t.align){case"start":return n.padding;case"end":return e-r;default:return(e-r+n.padding)/2}},y=e.isHorizontal();d=y?{x:e.left+P(l,c[0]),y:e.top+n.padding,line:0}:{x:e.left+n.padding,y:e.top+P(a,o[0]),line:0},se.rtl.overrideTextDirection(e.ctx,t.textDirection);var b=m+n.padding;se.each(e.legendItems,(function(t,r){var i=u.measureText(t.text).width,s=f+m/2+i,g=d.x,p=d.y;h.setWidth(e.minSize.width),y?r>0&&g+s+n.padding>e.left+e.minSize.width&&(p=d.y+=b,d.line++,g=d.x=e.left+P(l,c[d.line])):r>0&&p+b>e.top+e.minSize.height&&(g=d.x=g+e.columnWidths[d.line]+n.padding,d.line++,p=d.y=e.top+P(a,o[d.line]));var j=h.x(g);v(j,p,t),x[r].left=h.leftForLtr(j,x[r].width),x[r].top=p,A(j,p,t,i),y?d.x+=s+n.padding:d.y+=b})),se.rtl.restoreTextDirection(e.ctx,t.textDirection)}},_getLegendItemAt:function(e,t){var n,r,i,s=this;if(e>=s.left&&e<=s.right&&t>=s.top&&t<=s.bottom)for(i=s.legendHitBoxes,n=0;n<i.length;++n)if(e>=(r=i[n]).left&&e<=r.left+r.width&&t>=r.top&&t<=r.top+r.height)return s.legendItems[n];return null},handleEvent:function(e){var t,n=this,r=n.options,i="mouseup"===e.type?"click":e.type;if("mousemove"===i){if(!r.onHover&&!r.onLeave)return}else{if("click"!==i)return;if(!r.onClick)return}t=n._getLegendItemAt(e.x,e.y),"click"===i?t&&r.onClick&&r.onClick.call(n,e.native,t):(r.onLeave&&t!==n._hoveredItem&&(n._hoveredItem&&r.onLeave.call(n,e.native,n._hoveredItem),n._hoveredItem=t),r.onHover&&t&&r.onHover.call(n,e.native,t))}});function Wi(e,t){var n=new Hi({ctx:e.ctx,options:t,chart:e});Yt.configure(e,n,t),Yt.addBox(e,n),e.legend=n}var Gi={id:"legend",_element:Hi,beforeInit:function(e){var t=e.options.legend;t&&Wi(e,t)},beforeUpdate:function(e){var t=e.options.legend,n=e.legend;t?(se.mergeIf(t,$.global.legend),n?(Yt.configure(e,n,t),n.options=t):Wi(e,t)):n&&(Yt.removeBox(e,n),delete e.legend)},afterEvent:function(e,t){var n=e.legend;n&&n.handleEvent(t)}},Qi=se.noop;$._set("global",{title:{display:!1,fontStyle:"bold",fullWidth:!0,padding:10,position:"top",text:"",weight:2e3}});var Ki=ge.extend({initialize:function(e){var t=this;se.extend(t,e),t.legendHitBoxes=[]},beforeUpdate:Qi,update:function(e,t,n){var r=this;return r.beforeUpdate(),r.maxWidth=e,r.maxHeight=t,r.margins=n,r.beforeSetDimensions(),r.setDimensions(),r.afterSetDimensions(),r.beforeBuildLabels(),r.buildLabels(),r.afterBuildLabels(),r.beforeFit(),r.fit(),r.afterFit(),r.afterUpdate(),r.minSize},afterUpdate:Qi,beforeSetDimensions:Qi,setDimensions:function(){var e=this;e.isHorizontal()?(e.width=e.maxWidth,e.left=0,e.right=e.width):(e.height=e.maxHeight,e.top=0,e.bottom=e.height),e.paddingLeft=0,e.paddingTop=0,e.paddingRight=0,e.paddingBottom=0,e.minSize={width:0,height:0}},afterSetDimensions:Qi,beforeBuildLabels:Qi,buildLabels:Qi,afterBuildLabels:Qi,beforeFit:Qi,fit:function(){var e,t=this,n=t.options,r=t.minSize={},i=t.isHorizontal();n.display?(e=(se.isArray(n.text)?n.text.length:1)*se.options._parseFont(n).lineHeight+2*n.padding,t.width=r.width=i?t.maxWidth:e,t.height=r.height=i?e:t.maxHeight):t.width=r.width=t.height=r.height=0},afterFit:Qi,isHorizontal:function(){var e=this.options.position;return"top"===e||"bottom"===e},draw:function(){var e=this,t=e.ctx,n=e.options;if(n.display){var r,i,s,a=se.options._parseFont(n),o=a.lineHeight,l=o/2+n.padding,c=0,d=e.top,h=e.left,u=e.bottom,g=e.right;t.fillStyle=se.valueOrDefault(n.fontColor,$.global.defaultFontColor),t.font=a.string,e.isHorizontal()?(i=h+(g-h)/2,s=d+l,r=g-h):(i="left"===n.position?h+l:g-l,s=d+(u-d)/2,r=u-d,c=Math.PI*("left"===n.position?-.5:.5)),t.save(),t.translate(i,s),t.rotate(c),t.textAlign="center",t.textBaseline="middle";var p=n.text;if(se.isArray(p))for(var m=0,f=0;f<p.length;++f)t.fillText(p[f],0,m,r),m+=o;else t.fillText(p,0,0,r);t.restore()}}});function Xi(e,t){var n=new Ki({ctx:e.ctx,options:t,chart:e});Yt.configure(e,n,t),Yt.addBox(e,n),e.titleBlock=n}var $i={},Zi=zi,Ji=Gi,es={id:"title",_element:Ki,beforeInit:function(e){var t=e.options.title;t&&Xi(e,t)},beforeUpdate:function(e){var t=e.options.title,n=e.titleBlock;t?(se.mergeIf(t,$.global.title),n?(Yt.configure(e,n,t),n.options=t):Xi(e,t)):n&&(Yt.removeBox(e,n),delete e.titleBlock)}};for(var ts in $i.filler=Zi,$i.legend=Ji,$i.title=es,Hn.helpers=se,Wn(),Hn._adapters=Kn,Hn.Animation=me,Hn.animationService=fe,Hn.controllers=jt,Hn.DatasetController=be,Hn.defaults=$,Hn.Element=ge,Hn.elements=He,Hn.Interaction=Nt,Hn.layouts=Yt,Hn.platform=vn,Hn.plugins=An,Hn.Scale=fr,Hn.scaleService=Pn,Hn.Ticks=Xn,Hn.Tooltip=Tn,Hn.helpers.each(ki,(function(e,t){Hn.scaleService.registerScaleType(t,e,e._defaults)})),$i)$i.hasOwnProperty(ts)&&Hn.plugins.register($i[ts]);Hn.platform.initialize();var ns=Hn;return"undefined"!==typeof window&&(window.Chart=Hn),Hn.Chart=Hn,Hn.Legend=$i.legend._element,Hn.Title=$i.title._element,Hn.pluginService=Hn.plugins,Hn.PluginBase=Hn.Element.extend({}),Hn.canvasHelpers=Hn.helpers.canvas,Hn.layoutService=Hn.layouts,Hn.LinearScaleBase=Sr,Hn.helpers.each(["Bar","Bubble","Doughnut","Line","PolarArea","Radar","Scatter"],(function(e){Hn[e]=function(t,n){return new Hn(t,Hn.helpers.merge(n||{},{type:e.charAt(0).toLowerCase()+e.slice(1)}))}})),ns}(function(){try{return n(59051)}catch(e){}}())},60299:function(e){e.exports=function(e,t,n,r){for(var i=-1,s=null==e?0:e.length;++i<s;){var a=e[i];t(r,a,n(a),e)}return r}},41971:function(e,t,n){var r=n(20927);e.exports=function(e,t,n,i){return r(e,(function(e,r,s){t(i,e,n(e),s)})),i}},86942:function(e,t,n){var r=n(60299),i=n(41971),s=n(15127),a=n(12279);e.exports=function(e,t){return function(n,o){var l=a(n)?r:i,c=t?t():{};return l(n,e,s(o,2),c)}}},59418:function(e,t,n){var r=n(1404);e.exports=function(e,t){return r(e,t)}},49076:function(e,t,n){var r=n(10366),i=n(86942)((function(e,t,n){r(e,n,t)}));e.exports=i},60780:function(e,t,n){"use strict";var r=n(85224);t.N1=void 0;var i=c(n(9950)),s=c(n(11942)),a=c(n(48607)),o=c(n(59418)),l=c(n(49076));function c(e){return e&&e.__esModule?e:{default:e}}function d(){return d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},d.apply(this,arguments)}function h(e){return h="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function u(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){j(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function x(e,t,n){return t&&f(e.prototype,t),n&&f(e,n),e}function v(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&A(e,t)}function A(e,t){return A=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},A(e,t)}function P(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b(e);if(t){var i=b(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===h(t)||"function"===typeof t))return t;return y(e)}(this,n)}}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e){return b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},b(e)}function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var S="undefined"!==typeof r&&{NODE_ENV:"production",PUBLIC_URL:"http://0.0.0.0:3000/assets/bundles",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}&&"production",D=function(e){v(n,e);var t=P(n);function n(){var e;return m(this,n),j(y(e=t.call(this)),"handleOnClick",(function(t){var n=e.chartInstance,r=e.props,i=r.getDatasetAtEvent,s=r.getElementAtEvent,a=r.getElementsAtEvent,o=r.onElementsClick;i&&i(n.getDatasetAtEvent(t),t),s&&s(n.getElementAtEvent(t),t),a&&a(n.getElementsAtEvent(t),t),o&&o(n.getElementsAtEvent(t),t)})),j(y(e),"ref",(function(t){e.element=t})),e.chartInstance=void 0,e}return x(n,[{key:"componentDidMount",value:function(){this.renderChart()}},{key:"componentDidUpdate",value:function(){if(this.props.redraw)return this.destroyChart(),void this.renderChart();this.updateChart()}},{key:"shouldComponentUpdate",value:function(e){var t=this.props,n=(t.redraw,t.type),r=t.options,i=t.plugins,s=t.legend,a=t.height,l=t.width;if(!0===e.redraw)return!0;if(a!==e.height||l!==e.width)return!0;if(n!==e.type)return!0;if(!(0,o.default)(s,e.legend))return!0;if(!(0,o.default)(r,e.options))return!0;var c=this.transformDataProp(e);return!(0,o.default)(this.shadowDataProp,c)||!(0,o.default)(i,e.plugins)}},{key:"componentWillUnmount",value:function(){this.destroyChart()}},{key:"transformDataProp",value:function(e){var t=e.data;return"function"==typeof t?t(this.element):t}},{key:"memoizeDataProps",value:function(){if(this.props.data){var e=this.transformDataProp(this.props);return this.shadowDataProp=p(p({},e),{},{datasets:e.datasets&&e.datasets.map((function(e){return p({},e)}))}),this.saveCurrentDatasets(),e}}},{key:"checkDatasets",value:function(e){var t="production"!==S&&"prod"!==S,r=this.props.datasetKeyProvider!==n.getLabelAsKey,i=e.length>1;if(t&&i&&!r){var s=!1;e.forEach((function(e){e.label||(s=!0)})),s&&console.error('[react-chartjs-2] Warning: Each dataset needs a unique key. By default, the "label" property on each dataset is used. Alternatively, you may provide a "datasetKeyProvider" as a prop that returns a unique key.')}}},{key:"getCurrentDatasets",value:function(){return this.chartInstance&&this.chartInstance.config.data&&this.chartInstance.config.data.datasets||[]}},{key:"saveCurrentDatasets",value:function(){var e=this;this.datasets=this.datasets||{},this.getCurrentDatasets().forEach((function(t){e.datasets[e.props.datasetKeyProvider(t)]=t}))}},{key:"updateChart",value:function(){var e=this,t=this.props.options,n=this.memoizeDataProps(this.props);if(this.chartInstance){t&&(this.chartInstance.options=a.default.helpers.configMerge(this.chartInstance.options,t));var r=this.getCurrentDatasets(),i=n.datasets||[];this.checkDatasets(r);var s=(0,l.default)(r,this.props.datasetKeyProvider);this.chartInstance.config.data.datasets=i.map((function(t){var n=s[e.props.datasetKeyProvider(t)];if(n&&n.type===t.type&&t.data){n.data.splice(t.data.length),t.data.forEach((function(e,r){n.data[r]=t.data[r]}));t.data;var r=u(t,["data"]);return p(p({},n),r)}return t}));n.datasets;var o=u(n,["datasets"]);this.chartInstance.config.data=p(p({},this.chartInstance.config.data),o),this.chartInstance.update()}}},{key:"renderChart",value:function(){var e=this.props,t=e.options,r=e.legend,i=e.type,s=e.plugins,l=this.element,c=this.memoizeDataProps();"undefined"===typeof r||(0,o.default)(n.defaultProps.legend,r)||(t.legend=r),this.chartInstance=new a.default(l,{type:i,data:c,options:t,plugins:s})}},{key:"destroyChart",value:function(){if(this.chartInstance){this.saveCurrentDatasets();var e=Object.values(this.datasets);this.chartInstance.config.data.datasets=e,this.chartInstance.destroy()}}},{key:"render",value:function(){var e=this.props,t=e.height,n=e.width,r=e.id;return i.default.createElement("canvas",{ref:this.ref,height:t,width:n,id:r,onClick:this.handleOnClick})}}]),n}(i.default.Component);j(D,"getLabelAsKey",(function(e){return e.label})),j(D,"propTypes",{data:s.default.oneOfType([s.default.object,s.default.func]).isRequired,getDatasetAtEvent:s.default.func,getElementAtEvent:s.default.func,getElementsAtEvent:s.default.func,height:s.default.number,legend:s.default.object,onElementsClick:s.default.func,options:s.default.object,plugins:s.default.arrayOf(s.default.object),redraw:s.default.bool,type:function(e,t,n){if(!a.default.controllers[e[t]])return new Error("Invalid chart type `"+e[t]+"` supplied to `"+n+"`.")},width:s.default.number,datasetKeyProvider:s.default.func}),j(D,"defaultProps",{legend:{display:!0,position:"bottom"},type:"doughnut",height:150,width:300,redraw:!1,options:{},datasetKeyProvider:D.getLabelAsKey});var w=function(e){v(n,e);var t=P(n);function n(){return m(this,n),t.apply(this,arguments)}return x(n,[{key:"render",value:function(){var e=this;return i.default.createElement(D,d({},this.props,{ref:function(t){return e.chartInstance=t&&t.chartInstance},type:"doughnut"}))}}]),n}(i.default.Component);var I=function(e){v(n,e);var t=P(n);function n(){return m(this,n),t.apply(this,arguments)}return x(n,[{key:"render",value:function(){var e=this;return i.default.createElement(D,d({},this.props,{ref:function(t){return e.chartInstance=t&&t.chartInstance},type:"pie"}))}}]),n}(i.default.Component);var k=function(e){v(n,e);var t=P(n);function n(){return m(this,n),t.apply(this,arguments)}return x(n,[{key:"render",value:function(){var e=this;return i.default.createElement(D,d({},this.props,{ref:function(t){return e.chartInstance=t&&t.chartInstance},type:"line"}))}}]),n}(i.default.Component);t.N1=k;var _=function(e){v(n,e);var t=P(n);function n(){return m(this,n),t.apply(this,arguments)}return x(n,[{key:"render",value:function(){var e=this;return i.default.createElement(D,d({},this.props,{ref:function(t){return e.chartInstance=t&&t.chartInstance},type:"bar"}))}}]),n}(i.default.Component);var N=function(e){v(n,e);var t=P(n);function n(){return m(this,n),t.apply(this,arguments)}return x(n,[{key:"render",value:function(){var e=this;return i.default.createElement(D,d({},this.props,{ref:function(t){return e.chartInstance=t&&t.chartInstance},type:"horizontalBar"}))}}]),n}(i.default.Component);var M=function(e){v(n,e);var t=P(n);function n(){return m(this,n),t.apply(this,arguments)}return x(n,[{key:"render",value:function(){var e=this;return i.default.createElement(D,d({},this.props,{ref:function(t){return e.chartInstance=t&&t.chartInstance},type:"radar"}))}}]),n}(i.default.Component);var C=function(e){v(n,e);var t=P(n);function n(){return m(this,n),t.apply(this,arguments)}return x(n,[{key:"render",value:function(){var e=this;return i.default.createElement(D,d({},this.props,{ref:function(t){return e.chartInstance=t&&t.chartInstance},type:"polarArea"}))}}]),n}(i.default.Component);var O=function(e){v(n,e);var t=P(n);function n(){return m(this,n),t.apply(this,arguments)}return x(n,[{key:"render",value:function(){var e=this;return i.default.createElement(D,d({},this.props,{ref:function(t){return e.chartInstance=t&&t.chartInstance},type:"bubble"}))}}]),n}(i.default.Component);var L=function(e){v(n,e);var t=P(n);function n(){return m(this,n),t.apply(this,arguments)}return x(n,[{key:"render",value:function(){var e=this;return i.default.createElement(D,d({},this.props,{ref:function(t){return e.chartInstance=t&&t.chartInstance},type:"scatter"}))}}]),n}(i.default.Component);a.default.defaults},13669:function(){},37696:function(){},63864:function(){}},function(e){e.O(0,[4223],(function(){return t=61655,e(e.s=t);var t}));e.O()}]);