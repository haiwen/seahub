(this["webpackJsonpseahub-frontend"]=this["webpackJsonpseahub-frontend"]||[]).push([[15],{1295:function(e,t,a){e.exports=a(1310)},1310:function(e,t,a){"use strict";a.r(t);var n=a(5),s=a(6),r=a(8),l=a(7),i=a(0),c=a.n(i),o=a(23),m=a.n(o),p=a(42),h=a(70),u=a(12),d=a.n(u),f=a(1),b=a(9),g=a(4),y=function(e){Object(r.a)(a,e);var t=Object(l.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).handlerFileURL=function(e){return e.is_dir?f.jc+"library/"+e.repo_id+"/"+e.repo_name+e.fullpath:f.jc+"lib/"+e.repo_id+"/file"+g.a.encodePath(e.fullpath)},s.handlerParentDirPath=function(e){var t=e.is_dir?e.fullpath.length-e.name.length-1:e.fullpath.length-e.name.length;return e.fullpath.substring(0,t)},s.handlerParentDirURL=function(e){return f.jc+"library/"+e.repo_id+"/"+e.repo_name+s.handlerParentDirPath(e)},s}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props.item,t=decodeURI(e.fullpath).substring(1),a=t?g.a.getFolderIconUrl(!1,192):g.a.getDefaultLibIconUrl(!0),n=e.is_dir?a:g.a.getFileIconUrl(e.name,192);return c.a.createElement("li",{className:"search-result-item"},c.a.createElement("img",{className:t?"item-img":"lib-item-img",src:n,alt:""}),c.a.createElement("div",{className:"item-content"},c.a.createElement("div",{className:"item-name ellipsis"},c.a.createElement("a",{href:this.handlerFileURL(e),target:"_blank",title:e.name},e.name)),c.a.createElement("div",{className:"item-link ellipsis"},c.a.createElement("a",{href:this.handlerParentDirURL(e),target:"_blank"},e.repo_name,this.handlerParentDirPath(e))),c.a.createElement("div",{className:"item-link ellipsis"},g.a.bytesToSize(e.size)+" "+d()(1e3*e.last_modified).format("YYYY-MM-DD")),c.a.createElement("div",{className:"item-text ellipsis",dangerouslySetInnerHTML:{__html:e.content_highlight}})))}}]),a}(c.a.Component),E=function(e){Object(r.a)(a,e);var t=Object(l.a)(a);function a(e){return Object(n.a)(this,a),t.call(this,e)}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props.resultItems,t=e.length;return c.a.createElement("div",{className:"search-result-container position-static"},c.a.createElement("ul",{className:"search-result-list"},c.a.createElement("p",{className:"tip"},t>0?t+" "+(1===t?Object(f.nb)("result"):Object(f.nb)("results")):Object(f.nb)("No result")),e.map((function(e,t){return c.a.createElement(y,{key:t,item:e})}))))}}]),a}(c.a.Component),S=a(57),_=a.n(S),v=a(3),k=a(166),O=window.search.pageOptions,T=O.repo_name,j=O.search_repo,C=function(e){Object(r.a)(a,e);var t=Object(l.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).getFileTypesList=function(e){for(var t=[Object(f.nb)("Text"),Object(f.nb)("Document"),Object(f.nb)("Image"),Object(f.nb)("Video"),Object(f.nb)("Audio"),"PDF","Markdown"],a=[],n=0,s=e.length;n<s;n++)e[n]&&a.push(t[n]);return a},s.disabledStartDate=function(e){if(!e)return!1;var t=e.isAfter(d()(),"day"),a=s.props.stateAndValues.time_to;return a&&e.isAfter(a)||t},s.disabledEndDate=function(e){if(!e)return!1;var t=e.isAfter(d()(),"day"),a=s.props.stateAndValues.time_from;return a&&e.isBefore(a)||t},s}return Object(s.a)(a,[{key:"render",value:function(){var e=this,t=this.props.stateAndValues,a=t.errorDateMsg,n=t.errorSizeMsg;if(t.isShowSearchFilter){var s=t.size_from,r=t.size_to,l=t.time_from,o=t.time_to,m=t.search_repo,p=t.fileTypeItemsStatus,h=this.getFileTypesList(p),u=h.length;return c.a.createElement("div",{className:"search-filters"},m&&c.a.createElement("span",{className:"mr-4"},Object(f.nb)("Libraries"),": ","all"==m?Object(f.nb)("All"):T),u>0&&c.a.createElement("span",{className:"mr-4"},Object(f.nb)("File Types"),": ",h.map((function(e,t){return c.a.createElement("span",{key:t},e,t!==u-1&&","," ")}))),l&&o&&c.a.createElement("span",{className:"mr-4"},Object(f.nb)("Last Update"),": ",l.format("YYYY-MM-DD")," ",Object(f.nb)("to")," ",o.format("YYYY-MM-DD")),s&&r&&c.a.createElement("span",{className:"mr-4"},Object(f.nb)("Size"),": ",s,"MB - ",r,"MB"))}return c.a.createElement("div",{className:"advanced-search"},c.a.createElement(v.j,{isOpen:t.isCollapseOpen},"all"!==j&&c.a.createElement("div",{className:"search-repo search-catalog"},c.a.createElement(v.G,null,c.a.createElement(v.i,{md:"2",lg:"2"},Object(f.nb)("Libraries"),": "),c.a.createElement(v.i,{md:"4",lg:"4"},c.a.createElement(v.q,{check:!0},c.a.createElement(v.w,{check:!0},c.a.createElement(v.s,{type:"radio",name:"repo",checked:t.isAllRepoCheck,onChange:function(){return e.props.handlerRepo(!0)}}),Object(f.nb)("In all libraries")))),c.a.createElement(v.i,{md:"4",lg:"4"},c.a.createElement(v.q,{check:!0},c.a.createElement(v.w,{check:!0},c.a.createElement(v.s,{type:"radio",name:"repo",checked:!t.isAllRepoCheck,onChange:function(){return e.props.handlerRepo(!1)}}),T))))),c.a.createElement("div",{className:"search-file-types search-catalog"},c.a.createElement(v.G,null,c.a.createElement(v.i,{md:"2",lg:"2"},Object(f.nb)("File Types"),": "),c.a.createElement(v.i,{md:"4",lg:"4"},c.a.createElement(v.q,{check:!0},c.a.createElement(v.w,{check:!0},c.a.createElement(v.s,{type:"radio",name:"types",checked:!t.isFileTypeCollapseOpen,onChange:this.props.closeFileTypeCollapse}),Object(f.nb)("All file types")))),c.a.createElement(v.i,{md:"4",lg:"4"},c.a.createElement(v.q,{check:!0},c.a.createElement(v.w,{check:!0},c.a.createElement(v.s,{type:"radio",name:"types",checked:t.isFileTypeCollapseOpen,onChange:this.props.openFileTypeCollapse}),Object(f.nb)("Custom file types"))))),c.a.createElement(v.G,null,c.a.createElement(v.i,{md:"2",lg:"2"}),c.a.createElement(v.i,{md:"10",lg:"10"},c.a.createElement(v.j,{isOpen:t.isFileTypeCollapseOpen},c.a.createElement(v.q,{className:"search-file-types-form"},c.a.createElement(i.Fragment,null,c.a.createElement(v.k,{type:"checkbox",id:"checkTextFiles",label:Object(f.nb)("Text files"),inline:!0,onChange:function(){return e.props.handlerFileTypes(0)},checked:t.fileTypeItemsStatus[0]}),c.a.createElement(v.k,{type:"checkbox",id:"checkDocuments",label:Object(f.nb)("Documents"),inline:!0,onChange:function(){return e.props.handlerFileTypes(1)},checked:t.fileTypeItemsStatus[1]}),c.a.createElement(v.k,{type:"checkbox",id:"checkImages",label:Object(f.nb)("Images"),inline:!0,onChange:function(){return e.props.handlerFileTypes(2)},checked:t.fileTypeItemsStatus[2]}),c.a.createElement(v.k,{type:"checkbox",id:"checkVideo",label:Object(f.nb)("Video"),inline:!0,onChange:function(){return e.props.handlerFileTypes(3)},checked:t.fileTypeItemsStatus[3]}),c.a.createElement(v.k,{type:"checkbox",id:"checkAudio",label:Object(f.nb)("Audio"),inline:!0,onChange:function(){return e.props.handlerFileTypes(4)},checked:t.fileTypeItemsStatus[4]}),c.a.createElement(v.k,{type:"checkbox",id:"checkPdf",label:"PDF",inline:!0,onChange:function(){return e.props.handlerFileTypes(5)},checked:t.fileTypeItemsStatus[5]}),c.a.createElement(v.k,{type:"checkbox",id:"checkMarkdown",label:"Markdown",inline:!0,onChange:function(){return e.props.handlerFileTypes(6)},checked:t.fileTypeItemsStatus[6]}))),c.a.createElement("input",{type:"text",className:"form-control search-input",name:"query",autoComplete:"off",placeholder:Object(f.nb)("Input file extensions here, separate with ','"),onChange:this.props.handlerFileTypesInput,value:t.input_fexts,onKeyDown:this.props.handleKeyDown}))))),c.a.createElement("div",{className:"search-date search-catalog"},c.a.createElement(v.G,null,c.a.createElement(v.i,{md:"2",lg:"2",className:"mt-2"},Object(f.nb)("Last Update"),": "),c.a.createElement(v.i,{md:"4",lg:"4",sm:"4",xs:"5",className:"position-relative"},c.a.createElement(k.a,{inputWidth:"100%",disabledDate:this.disabledStartDate,value:t.time_from,onChange:this.props.handleTimeFromInput,showHourAndMinute:!1}),c.a.createElement("span",{className:"select-data-icon"},c.a.createElement("i",{className:"fa fa-calendar-alt"}))),c.a.createElement("div",{className:"mt-2"},"-"),c.a.createElement(v.i,{md:"4",lg:"4",sm:"4",xs:"5",className:"position-relative"},c.a.createElement(k.a,{inputWidth:"100%",disabledDate:this.disabledEndDate,value:t.time_to,onChange:this.props.handleTimeToInput,showHourAndMinute:!1}),c.a.createElement("span",{className:"select-data-icon"},c.a.createElement("i",{className:"fa fa-calendar-alt"})))),a&&c.a.createElement(v.G,null,c.a.createElement(v.i,{md:"2",lg:"2"}),c.a.createElement(v.i,{md:"8",className:"error mt-2"},a))),c.a.createElement("div",{className:"search-size search-catalog"},c.a.createElement(v.G,null,c.a.createElement(v.i,{md:"2",lg:"2",className:"mt-2"},Object(f.nb)("Size"),": "),c.a.createElement(v.i,{md:"4",lg:"4",sm:"4",xs:"5"},c.a.createElement(v.q,null,c.a.createElement(v.t,null,c.a.createElement(v.s,{type:"tel",name:"size_from",onKeyDown:this.props.handleKeyDown,onChange:this.props.handleSizeFromInput,value:t.size_from}),c.a.createElement(v.u,{addonType:"append"},"MB"))),c.a.createElement(_.a,{query:"(min-width: 768px)"},n&&c.a.createElement("div",{className:"error mb-4"},n),c.a.createElement(v.c,{color:"primary",onClick:this.props.handleSubmit},Object(f.nb)("Submit")),c.a.createElement(v.c,{className:"ml-2",onClick:this.props.handleReset},Object(f.nb)("Reset")))),c.a.createElement("div",{className:"mt-2"},"-"),c.a.createElement(v.i,{md:"4",lg:"4",sm:"4",xs:"5"},c.a.createElement(v.q,null,c.a.createElement(v.t,null,c.a.createElement(v.s,{type:"tel",name:"size_to",onKeyDown:this.props.handleKeyDown,onChange:this.props.handleSizeToInput,value:t.size_to}),c.a.createElement(v.u,{addonType:"append"},"MB")))))),c.a.createElement(_.a,{query:"(max-width: 767.8px)"},n&&c.a.createElement("div",{className:"error mb-4"},n),c.a.createElement(v.c,{color:"primary",onClick:this.props.handleSubmit},Object(f.nb)("Submit")),c.a.createElement(v.c,{className:"ml-2",onClick:this.props.handleReset},Object(f.nb)("Reset")))))}}]),a}(c.a.Component),I=a(10),F=a(15),N=(a(107),a(81)),M=window.search.pageOptions,D=M.q,z=M.search_repo,w=M.search_ftypes,x=function(e){Object(r.a)(a,e);var t=Object(l.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).handleSearchParams=function(e){var t={q:s.state.q.trim(),page:e},a=s.getFileTypesList();s.state.search_repo&&(t.search_repo=s.state.search_repo),s.state.search_ftypes&&(t.search_ftypes=s.state.search_ftypes),s.state.per_page&&(t.per_page=s.state.per_page),s.state.input_fexts&&(t.input_fexts=s.state.input_fexts);var n=s.state,r=n.time_from,l=n.time_to;return r&&(t.time_from=parseInt(r.valueOf()/1e3)),l&&(t.time_to=parseInt(l.valueOf()/1e3)),s.state.size_from&&(t.size_from=1e3*s.state.size_from*1e3),s.state.size_to&&(t.size_to=1e3*s.state.size_to*1e3),0!==a.length&&(t.ftype=a),t},s.handleSubmit=function(){if(s.compareNumber(s.state.size_from,s.state.size_to))s.setState({errorSizeMsg:Object(f.nb)("Invalid file size range.")});else{if(s.getValueLength(s.state.q.trim())<3)0===s.state.q.trim().length?s.setState({errorMsg:Object(f.nb)("It is required.")}):s.setState({errorMsg:Object(f.nb)("Required at least three letters.")}),s.state.isLoading&&s.setState({isLoading:!1});else{var e=s.handleSearchParams(1);s.getSearchResults(e)}s.state.isCollapseOpen&&s.setState({isCollapseOpen:!1})}},s.compareNumber=function(e,t){return!(!e||!t)&&parseInt(e.replace(/\-/g,""))>=parseInt(t.replace(/\-/g,""))},s.showSearchFilter=function(){s.setState({isShowSearchFilter:!0})},s.hideSearchFilter=function(){s.setState({isShowSearchFilter:!1})},s.handleReset=function(){s.setState({q:D.trim(),search_repo:z,search_ftypes:w,fileTypeItemsStatus:[!1,!1,!1,!1,!1,!1,!1],input_fexts:"",time_from:null,time_to:null,size_from:"",size_to:"",errorMsg:"",errorDateMsg:"",errorSizeMsg:""})},s.handlePrevious=function(){s.stateHistory&&s.state.page>1?s.setState(s.stateHistory,(function(){var e=s.handleSearchParams(s.state.page-1);s.getSearchResults(e)})):I.a.danger(Object(f.nb)("Error"),{duration:3})},s.handleNext=function(){s.stateHistory&&s.state.hasMore?s.setState(s.stateHistory,(function(){var e=s.handleSearchParams(s.state.page+1);s.getSearchResults(e)})):I.a.danger(Object(f.nb)("Error"),{duration:3})},s.toggleCollapse=function(){s.setState({isCollapseOpen:!s.state.isCollapseOpen}),s.hideSearchFilter()},s.openFileTypeCollapse=function(){s.setState({isFileTypeCollapseOpen:!0,search_ftypes:"custom"})},s.closeFileTypeCollapse=function(){s.setState({isFileTypeCollapseOpen:!1,fileTypeItemsStatus:Array(7).fill(!1),search_ftypes:"all",input_fexts:""})},s.handleSearchInput=function(e){s.setState({q:e.target.value}),s.state.errorMsg&&s.setState({errorMsg:""}),s.state.errorSizeMsg&&s.setState({errorSizeMsg:""}),s.state.errorDateMsg&&s.setState({errorDateMsg:""})},s.handleKeyDown=function(e){13===e.keyCode&&(e.preventDefault(),s.handleSubmit())},s.handlerRepo=function(e){e?s.setState({isAllRepoCheck:!0,search_repo:"all"}):s.setState({isAllRepoCheck:!1,search_repo:"all"!==z?z:""})},s.handlerFileTypes=function(e){var t=s.state.fileTypeItemsStatus;t[e]=!s.state.fileTypeItemsStatus[e],s.setState({fileTypeItemsStatus:t})},s.getFileTypesList=function(){for(var e=["Text","Document","Image","Video","Audio","PDF","Markdown"],t=[],a=0,n=s.state.fileTypeItemsStatus.length;a<n;a++)s.state.fileTypeItemsStatus[a]&&t.push(e[a]);return t},s.handlerFileTypesInput=function(e){s.setState({input_fexts:e.target.value.trim()})},s.handleTimeFromInput=function(e){s.setState({time_from:e?e.hours(0).minutes(0).seconds(0):e}),s.state.errorDateMsg&&s.setState({errorDateMsg:""})},s.handleTimeToInput=function(e){s.setState({time_to:e?e.hours(23).minutes(59).seconds(59):e}),s.state.errorDateMsg&&s.setState({errorDateMsg:""})},s.handleSizeFromInput=function(e){s.setState({size_from:e.target.value>=0?e.target.value:0}),s.state.errorSizeMsg&&s.setState({errorSizeMsg:""})},s.handleSizeToInput=function(e){s.setState({size_to:e.target.value>=0?e.target.value:0}),s.state.errorSizeMsg&&s.setState({errorSizeMsg:""})},s.stateHistory=null,s.state={isCollapseOpen:"all"!==z,isFileTypeCollapseOpen:!1,isResultGot:!1,isLoading:!0,isAllRepoCheck:"all"===z,isShowSearchFilter:!1,q:D.trim(),search_repo:z,search_ftypes:w,fileTypeItemsStatus:[!1,!1,!1,!1,!1,!1,!1],input_fexts:"",time_from:null,time_to:null,size_from:"",size_to:"",hasMore:!1,resultItems:[],page:1,per_page:20,errorMsg:"",errorDateMsg:"",errorSizeMsg:""},s}return Object(s.a)(a,[{key:"getSearchResults",value:function(e){var t=this;this.setState({isLoading:!0,isResultGot:!1});var a=N.cloneDeep(this.state);b.a.searchFiles(e,null).then((function(n){t.setState({isLoading:!1,isResultGot:!0,resultItems:n.data.results,hasMore:n.data.has_more,page:e.page,isShowSearchFilter:!0}),t.stateHistory=a,t.stateHistory.resultItems=n.data.results,t.stateHistory.hasMore=n.data.has_more,t.stateHistory.page=e.page})).catch((function(e){t.setState({isLoading:!1}),e.response?I.a.danger(e.response.data.detail||e.response.data.error_msg||Object(f.nb)("Error"),{duration:3}):I.a.danger(Object(f.nb)("Please check the network."),{duration:3})}))}},{key:"getValueLength",value:function(e){for(var t,a=0,n=0,s=e.length;n<s;n++)10===(t=e.charCodeAt(n))?a+=2:t<127?a+=1:t>=128&&t<=2047?a+=2:t>=2048&&t<=65535&&(a+=3);return a}},{key:"componentDidMount",value:function(){this.state.q?this.handleSubmit():this.setState({isLoading:!1})}},{key:"render",value:function(){var e=this,t=this.state.isCollapseOpen;return c.a.createElement("div",{className:"search-page"},c.a.createElement("div",{className:"search-page-container"},c.a.createElement("div",{className:"input-icon align-items-center d-flex"},c.a.createElement("input",{type:"text",className:"form-control search-input",name:"query",autoComplete:"off",value:this.state.q,placeholder:Object(f.nb)("Search Files"),onChange:this.handleSearchInput,onKeyDown:this.handleKeyDown}),c.a.createElement("i",{className:"search-icon-right input-icon-addon fas fa-search",onClick:this.handleSubmit}),c.a.createElement("i",{className:"fas action-icon fa-angle-double-".concat(t?"up":"down"),onClick:this.toggleCollapse})),this.state.errorMsg&&c.a.createElement("div",{className:"error"},this.state.errorMsg),c.a.createElement(C,{openFileTypeCollapse:this.openFileTypeCollapse,closeFileTypeCollapse:this.closeFileTypeCollapse,handlerFileTypes:this.handlerFileTypes,handlerFileTypesInput:this.handlerFileTypesInput,handleSubmit:this.handleSubmit,handleReset:this.handleReset,handlerRepo:this.handlerRepo,handleKeyDown:this.handleKeyDown,handleTimeFromInput:this.handleTimeFromInput,handleTimeToInput:this.handleTimeToInput,handleSizeFromInput:this.handleSizeFromInput,handleSizeToInput:this.handleSizeToInput,stateAndValues:this.state})),this.state.isLoading&&c.a.createElement(F.a,null),!this.state.isLoading&&this.state.isResultGot&&c.a.createElement(E,{resultItems:this.state.resultItems}),!this.state.isLoading&&this.state.isResultGot&&c.a.createElement("div",{className:"paginator"},1!==this.state.page&&c.a.createElement("a",{href:"#",onClick:function(){return e.handlePrevious()}},Object(f.nb)("Previous")),1!==this.state.page&&this.state.hasMore&&c.a.createElement("span",null," | "),this.state.hasMore&&c.a.createElement("a",{href:"#",onClick:function(){return e.handleNext()}},Object(f.nb)("Next"))))}}]),a}(c.a.Component),R=(a(136),a(94),function(e){Object(r.a)(a,e);var t=Object(l.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).onSearchedClick=function(e){var t=e.is_dir?f.jc+"library/"+e.repo_id+"/"+e.repo_name+e.path:f.jc+"lib/"+e.repo_id+"/file"+g.a.encodePath(e.path);window.open("about:blank").location.href=t},s}return Object(s.a)(a,[{key:"render",value:function(){return c.a.createElement("div",{className:"w-100 h-100"},c.a.createElement("div",{className:"main-panel-north border-left-show"},c.a.createElement(h.a,null),c.a.createElement(p.a,{onSearchedClick:this.onSearchedClick})),c.a.createElement("div",{className:"main-panel-south"},c.a.createElement(x,null)))}}]),a}(c.a.Component));m.a.render(c.a.createElement(R,null),document.getElementById("wrapper"))}},[[1295,1,0]]]);
//# sourceMappingURL=search.chunk.js.map