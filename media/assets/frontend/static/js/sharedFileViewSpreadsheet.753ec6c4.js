"use strict";(self.webpackChunkseahub_frontend=self.webpackChunkseahub_frontend||[]).push([[14],{98593:function(e,t,n){var r=n(15671),o=n(43144),i=n(60136),s=n(29388),a=n(47313),c=n(1168),u=n(4514),f=n(61805),h=n(37434),d=n(52340),l=n(51282),g=(n(5850),n(46417)),m=window.shared.pageOptions,p=m.repoID,v=m.filePath,k=m.err,Z=m.commitID,w=m.fileType,x=m.fileName,y=m.sharedToken,L=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"render",value:function(){return(0,g.jsx)(h.Z,{content:(0,g.jsx)(b,{})})}}]),n}(a.Component),b=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).setIframeHeight=function(e){var t=e.currentTarget;t.height=t.contentDocument.body.scrollHeight},o.state={isLoading:!k,errorMsg:""},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var e=this;if(!k){!function t(){u.I.queryOfficeFileConvertStatus(p,Z,v,w.toLowerCase(),y).then((function(n){switch(n.data.status){case"QUEUED":case"PROCESSING":e.setState({isLoading:!0}),setTimeout(t,2e3);break;case"ERROR":e.setState({isLoading:!1,errorMsg:(0,f.ih)("Document convertion failed.")});break;case"DONE":e.setState({isLoading:!1,errorMsg:""})}})).catch((function(t){t.response?e.setState({isLoading:!1,errorMsg:(0,f.ih)("Document convertion failed.")}):e.setState({isLoading:!1,errorMsg:(0,f.ih)("Please check the network.")})}))}()}}},{key:"render",value:function(){var e=this.state,t=e.isLoading,n=e.errorMsg;return k?(0,g.jsx)(d.Z,{}):t?(0,g.jsx)(l.Z,{}):n?(0,g.jsx)(d.Z,{errorMsg:n}):(0,g.jsx)("div",{className:"shared-file-view-body spreadsheet-file-view",children:(0,g.jsx)("iframe",{id:"spreadsheet-container",title:x,src:"".concat(f.ze,"office-convert/static/").concat(p,"/").concat(Z).concat(encodeURIComponent(v),"/index.html?token=").concat(y),onLoad:this.setIframeHeight})})}}]),n}(a.Component);c.render((0,g.jsx)(L,{}),document.getElementById("wrapper"))},5850:function(){}},function(e){e.O(0,[351],(function(){return t=98593,e(e.s=t);var t}));e.O()}]);