"use strict";(self.webpackChunkseahub_frontend=self.webpackChunkseahub_frontend||[]).push([[623],{938:function(e,t,n){var r=n(15671),i=n(43144),o=n(60136),s=n(29388),a=n(72791),c=n(54164),u=n(98015),f=n(53585),h=n(88585),d=n(13523),l=n(63446),g=(n(84403),n(80184)),p=window.app.pageOptions,m=p.repoID,v=p.filePath,Z=p.err,k=p.commitID,w=p.fileType,x=p.fileName,L=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,i.Z)(n,[{key:"render",value:function(){return(0,g.jsx)(h.Z,{content:(0,g.jsx)(j,{})})}}]),n}(a.Component),j=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(e){var i;return(0,r.Z)(this,n),(i=t.call(this,e)).setIframeHeight=function(e){var t=e.currentTarget;t.height=t.contentDocument.body.scrollHeight},i.state={isLoading:!Z,errorMsg:""},i}return(0,i.Z)(n,[{key:"componentDidMount",value:function(){var e=this;if(!Z){!function t(){u.I.queryOfficeFileConvertStatus(m,k,v,w.toLowerCase()).then((function(n){switch(n.data.status){case"QUEUED":case"PROCESSING":e.setState({isLoading:!0}),setTimeout(t,2e3);break;case"ERROR":e.setState({isLoading:!1,errorMsg:(0,f.ih)("Document convertion failed.")});break;case"DONE":e.setState({isLoading:!1,errorMsg:""})}})).catch((function(t){t.response?e.setState({isLoading:!1,errorMsg:(0,f.ih)("Document convertion failed.")}):e.setState({isLoading:!1,errorMsg:(0,f.ih)("Please check the network.")})}))}()}}},{key:"render",value:function(){var e=this.state,t=e.isLoading,n=e.errorMsg;return Z?(0,g.jsx)(d.Z,{}):t?(0,g.jsx)(l.Z,{}):n?(0,g.jsx)(d.Z,{errorMsg:n}):(0,g.jsx)("div",{className:"file-view-content flex-1 spreadsheet-file-view",children:(0,g.jsx)("iframe",{id:"spreadsheet-container",title:x,src:"".concat(f.ze,"office-convert/static/").concat(m,"/").concat(k).concat(encodeURIComponent(v),"/index.html"),onLoad:this.setIframeHeight})})}}]),n}(a.Component);c.render((0,g.jsx)(L,{}),document.getElementById("wrapper"))},84403:function(){}},function(e){e.O(0,[351],(function(){return t=938,e(e.s=t);var t}));e.O()}]);
//# sourceMappingURL=viewFileSpreadsheet.c47c1c99.js.map