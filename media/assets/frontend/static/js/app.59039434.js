/*! For license information please see app.59039434.js.LICENSE.txt */
(self.webpackChunkseahub_frontend=self.webpackChunkseahub_frontend||[]).push([[3524],{52074:function(e,t,n){"use strict";var r=n(23029),o=n(92901),a=n(39874),i=n(85501),s=n(9950),l=n(17119),c=n(13690),u=n(70446),d=n.n(u),p=n(58195),f=n(40326),h=n(65604),m=n(44414),g=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).close=function(){if(n.setState({isClosed:!0}),navigator.cookieEnabled){var e=new Date,t=document.cookie.split("; "),r=!1,o=f.Qv+"_";e.setTime(e.getTime()+12096e5),o+="; expires="+e.toGMTString()+"; path="+f.Yc;for(var a=0,i=t.length;a<i;a++)if("info_id"==t[a].split("=")[0]){r=!0,document.cookie="info_id="+t[a].split("=")[1]+o;break}r||(document.cookie="info_id="+o)}},n.state={isClosed:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return!f.M8||this.state.isClosed?null:(0,m.jsxs)("div",{id:"info-bar",className:"d-flex justify-content-between",children:[(0,m.jsx)("p",{id:"info-bar-info",className:"m-0",dangerouslySetInnerHTML:{__html:f.M8}}),(0,m.jsx)("button",{className:"close sf2-icon-x1",title:(0,f.AP)("Close"),"aria-label":(0,f.AP)("Close"),onClick:this.close})]})}}])}(s.Component),v=g,y=n(72249),C=n(49403),A=n(27288),x=function(e){function t(){var e;(0,r.A)(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(e=(0,a.A)(this,t,[].concat(o))).onMouseEnter=function(){e.props.isSidePanelFolded&&e.props.eventBus.dispatch("top-header-mouse-enter")},e}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.onShowSidePanel,n=e.onSearchedClick,r=e.showSearch,o=e.children;return(0,m.jsxs)("div",{id:"header",className:"top-header d-flex justify-content-between flex-shrink-0",onMouseEnter:this.onMouseEnter,children:[(0,m.jsx)("div",{className:"flex-shrink-0 d-none d-md-flex",children:(0,m.jsx)(C.A,{onCloseSidePanel:this.props.onCloseSidePanel})}),(0,m.jsxs)("div",{className:"flex-shrink-0 d-flex flex-fill ".concat(o?"border-left-show":""),children:[(0,m.jsxs)("div",{className:"cur-view-toolbar",children:[(0,m.jsx)("span",{title:"Side Nav Menu",onClick:t,className:"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none"}),o]}),(0,m.jsx)(A.A,{showSearch:r,searchPlaceholder:this.props.searchPlaceholder,onSearchedClick:n,eventBus:this.props.eventBus})]})]})}}])}(s.Component),b=x,_=n(48738),w=n.n(_),S=n(97011),D=(0,o.A)((function e(t){(0,r.A)(this,e),this.id=t.id,this.name=t.name,this.owner=t.owner,this.admins=t.admins||[],this.avatar_url=t.avatar_url,this.created_at=t.created_at,this.parent_group_id=t.parent_group_id,this.wiki_enabled=t.wiki_enabled,this.repos=t.repos||[],this.group_quota=t.group_quota,this.group_quota_usage=t.group_quota_usage})),E=n(4086),k=n(14113),M=n(99308),I=n(85077),N=n(85907),P=n(18849),T=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).handleGroupChange=function(e){var t=e.target.value;t.trim()?n.setState({isSubmitBtnActive:!0}):n.setState({isSubmitBtnActive:!1}),n.setState({groupName:t}),n.state.errorMsg&&n.setState({errorMsg:""})},n.handleSubmitGroup=function(){var e=n.state.groupName.trim();if(e){var t=n;S.e.createGroup(e).then((function(e){t.props.onCreateGroup(e.data),n.props.toggleDialog()})).catch((function(e){var t=h.Aq.getErrorMsg(e);n.setState({errorMsg:t})}))}else n.setState({errorMsg:(0,f.AP)("Name is required")});n.setState({groupName:""})},n.handleKeyDown=function(e){13===e.keyCode&&(n.handleSubmitGroup(),e.preventDefault())},n.state={groupName:"",errorMsg:"",isSubmitBtnActive:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.props.toggleDialog,autoFocus:!1,children:[(0,m.jsx)(k.A,{toggle:this.props.toggleDialog,children:(0,f.AP)("New Group")}),(0,m.jsxs)(M.A,{children:[(0,m.jsx)("label",{htmlFor:"groupName",children:(0,f.AP)("Name")}),(0,m.jsx)(I.A,{type:"text",id:"groupName",value:this.state.groupName,onChange:this.handleGroupChange,onKeyDown:this.handleKeyDown,autoFocus:!0}),(0,m.jsx)("span",{className:"error",children:this.state.errorMsg})]}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(P.A,{color:"secondary",onClick:this.props.toggleDialog,children:(0,f.AP)("Cancel")}),(0,m.jsx)(P.A,{color:"primary",onClick:this.handleSubmitGroup,disabled:!this.state.isSubmitBtnActive,children:(0,f.AP)("Submit")})]})]})}}])}(s.Component),O=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).tabItemClick=function(e,t,r){n.props.tabItemClick(e,t,r)},n.getActiveClass=function(e){return n.props.currentTab===e?"active":""},n.state={groupItems:[]},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"renderSharedGroups",value:function(){var e=this;return(0,m.jsx)(m.Fragment,{children:this.props.groupItems.map((function(t){return(0,m.jsx)("li",{className:"nav-item ".concat(e.getActiveClass(t.name)),children:(0,m.jsxs)(c.N_,{to:f.Yc+"group/"+t.id+"/",className:"nav-link ellipsis ".concat(e.getActiveClass(t.name)),onClick:function(n){return e.tabItemClick(n,t.name,t.id)},children:[(0,m.jsx)("span",{className:"".concat(0==t.parent_group_id?"sf3-font-group":"sf3-font-department"," sf3-font nav-icon"),"aria-hidden":"true"}),(0,m.jsx)("span",{className:"nav-text",children:t.name})]})},t.id)}))})}},{key:"render",value:function(){var e=this;return(0,m.jsxs)(m.Fragment,{children:[f._s&&(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("my-libs")||this.getActiveClass("deleted")),children:(0,m.jsxs)(c.N_,{to:f.Yc+"my-libs/",className:"nav-link ellipsis ".concat(this.getActiveClass("my-libs")||this.getActiveClass("deleted")),title:(0,f.AP)("My Libraries"),onClick:function(t){return e.tabItemClick(t,"my-libs")},children:[(0,m.jsx)("span",{className:"sf3-font-mine sf3-font nav-icon","aria-hidden":"true"}),(0,m.jsx)("span",{className:"nav-text",children:(0,f.AP)("My Libraries")})]})}),(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("shared-libs")),children:(0,m.jsxs)(c.N_,{to:f.Yc+"shared-libs/",className:"nav-link ellipsis ".concat(this.getActiveClass("shared-libs")),title:(0,f.AP)("Shared with me"),onClick:function(t){return e.tabItemClick(t,"shared-libs")},children:[(0,m.jsx)("span",{className:"sf3-font-share-with-me sf3-font nav-icon","aria-hidden":"true"}),(0,m.jsx)("span",{className:"nav-text",children:(0,f.AP)("Shared with me")})]})}),f.Yi&&(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("org")),onClick:function(t){return e.tabItemClick(t,"org")},children:(0,m.jsxs)(c.N_,{to:f.Yc+"org/",className:"nav-link ellipsis ".concat(this.getActiveClass("org")),title:(0,f.AP)("Shared with all"),children:[(0,m.jsx)("span",{className:"sf3-font-share-with-all sf3-font nav-icon","aria-hidden":"true"}),(0,m.jsx)("span",{className:"nav-text",children:(0,f.AP)("Shared with all")})]})}),this.renderSharedGroups()]})}}])}(s.Component),j=n(13042),R=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).shExtend=function(){n.setState({sharedExtended:!n.state.sharedExtended})},n.loadGroups=function(){S.e.listGroups().then((function(e){var t=e.data.map((function(e){return new D(e)}));n.filesNavHeight=(t.length+(f.pP?1:0)+(f._s?1:0)+(f.Yi?1:0)+1)*j.R5,n.setState({groupItems:t.sort((function(e,t){return e.name.toLowerCase()<t.name.toLowerCase()?-1:1}))})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.tabItemClick=function(e,t,r){if(window.uploader&&window.uploader.isUploadProgressDialogShow&&100!==window.uploader.totalProgress){if(!window.confirm((0,f.AP)("A file is being uploaded. Are you sure you want to leave this page?")))return e.preventDefault(),!1;window.uploader.isUploadProgressDialogShow=!1}n.props.tabItemClick(t,r)},n.getActiveClass=function(e){return n.props.currentTab===e?"active":""},n.onCreateGroup=function(e){var t=new D(e),r=n.state.groupItems;r.push(t),n.filesNavHeight+=j.R5,n.setState({groupItems:r})},n.toggleCreateGroupDialog=function(){n.setState({isCreateGroupDialogOpen:!n.state.isCreateGroupDialogOpen})},n.toggleFilesNav=function(e){e.preventDefault(),e.stopPropagation(),n.setState({filesNavUnfolded:!n.state.filesNavUnfolded},(function(){n.state.filesNavUnfolded&&n.loadGroups()}))},n.state={filesNavUnfolded:!1,sharedExtended:!1,groupItems:[],isCreateGroupDialogOpen:!1},n.adminHeight=0,n.filesNavHeight=0,n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"renderAddGroup",value:function(){return(0,m.jsx)(m.Fragment,{children:f.pP&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("li",{className:"nav-item",onClick:this.toggleCreateGroupDialog,children:(0,m.jsxs)("span",{className:"nav-link",role:"button",children:[(0,m.jsx)("i",{className:"sf2-icon-plus nav-icon","aria-hidden":"true"}),(0,f.AP)("New Group")]})}),this.state.isCreateGroupDialogOpen&&(0,m.jsx)(T,{toggleDialog:this.toggleCreateGroupDialog,onCreateGroup:this.onCreateGroup})]})})}},{key:"renderSharedAdmin",value:function(){var e=this,t=0;this.state.sharedExtended&&(this.adminHeight||(this.adminHeight=3*j.R5),t=this.adminHeight);var n={height:t,opacity:0===t?0:1},r=null;return f.zn?r=(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("share-admin-share-links")),children:(0,m.jsxs)(c.N_,{to:f.Yc+"share-admin-share-links/",className:"nav-link ellipsis ".concat(this.getActiveClass("share-admin-share-links")),title:(0,f.AP)("Links"),onClick:function(t){return e.tabItemClick(t,"share-admin-share-links")},children:[(0,m.jsx)("span",{"aria-hidden":"true",className:"sharp",children:"#"}),(0,m.jsx)("span",{className:"nav-text",children:(0,f.AP)("Links")})]})}):f.fY&&(r=(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("share-admin-upload-links")),children:(0,m.jsxs)(c.N_,{to:f.Yc+"share-admin-upload-links/",className:"nav-link ellipsis ".concat(this.getActiveClass("share-admin-upload-links")),title:(0,f.AP)("Links"),onClick:function(t){return e.tabItemClick(t,"share-admin-upload-links")},children:[(0,m.jsx)("span",{"aria-hidden":"true",className:"sharp",children:"#"}),(0,m.jsx)("span",{className:"nav-text",children:(0,f.AP)("Links")})]})})),(0,m.jsxs)("ul",{id:"share-admin-sub-nav",className:"nav sub-nav nav-pills flex-column ".concat(this.state.sharedExtended?"side-panel-slide-share-admin":"side-panel-slide-up-share-admin"),style:n,children:[f._s&&f.Ih&&0!==t&&(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("share-admin-libs")),children:(0,m.jsxs)(c.N_,{to:f.Yc+"share-admin-libs/",className:"nav-link ellipsis ".concat(this.getActiveClass("share-admin-libs")),title:(0,f.AP)("Libraries"),onClick:function(t){return e.tabItemClick(t,"share-admin-libs")},children:[(0,m.jsx)("span",{"aria-hidden":"true",className:"sharp",children:"#"}),(0,m.jsx)("span",{className:"nav-text",children:(0,f.AP)("Libraries")})]})}),f.Ih&&0!==t&&(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("share-admin-folders")),children:(0,m.jsxs)(c.N_,{to:f.Yc+"share-admin-folders/",className:"nav-link ellipsis ".concat(this.getActiveClass("share-admin-folders")),title:(0,f.AP)("Folders"),onClick:function(t){return e.tabItemClick(t,"share-admin-folders")},children:[(0,m.jsx)("span",{"aria-hidden":"true",className:"sharp",children:"#"}),(0,m.jsx)("span",{className:"nav-text",children:(0,f.AP)("Folders")})]})}),0!==t&&r]})}},{key:"renderCustomNavItems",value:function(){return f.vn.map((function(e,t){return(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsxs)("a",{href:e.link,className:"nav-link ellipsis",title:e.desc,children:[(0,m.jsx)("span",{className:e.icon,"aria-hidden":"true"}),(0,m.jsx)("span",{className:"nav-text",children:e.desc})]})},t)}))}},{key:"render",value:function(){var e=this,t=f.q5||f.am||!f.Ez,n=this.state,r=n.filesNavUnfolded,o=n.groupItems;return(0,m.jsx)("div",{className:"side-nav",children:(0,m.jsxs)("div",{className:"side-nav-con d-flex flex-column",children:[(0,m.jsx)("h2",{className:"mb-2 px-2 font-weight-normal heading",children:(0,f.AP)("Workspace")}),(0,m.jsxs)("ul",{className:"nav nav-pills flex-column nav-container",children:[(0,m.jsxs)("li",{id:"files",className:"nav-item flex-column ".concat(this.getActiveClass("libraries")),children:[(0,m.jsxs)(c.N_,{to:f.Yc+"libraries/",className:"nav-link ellipsis ".concat(this.getActiveClass("libraries")),title:(0,f.AP)("Files"),onClick:function(t){return e.tabItemClick(t,"libraries")},children:[(0,m.jsx)("span",{className:"sf3-font-files sf3-font","aria-hidden":"true"}),(0,m.jsx)("span",{className:"nav-text",children:(0,f.AP)("Files")}),(0,m.jsx)("span",{className:"toggle-icon sf3-font sf3-font-down ".concat(r?"":"rotate-90"),"aria-hidden":"true",onClick:this.toggleFilesNav})]}),(0,m.jsxs)("ul",{id:"files-sub-nav",className:"nav sub-nav nav-pills flex-column ".concat(r?"side-panel-slide":"side-panel-slide-up"),style:{height:r?this.filesNavHeight:0,opacity:r?1:0},children:[(0,m.jsx)(O,{groupItems:o,tabItemClick:this.tabItemClick,currentTab:this.props.currentTab}),this.renderAddGroup()]})]}),(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("starred")),children:(0,m.jsxs)(c.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("starred")),to:f.Yc+"starred/",title:(0,f.AP)("Favorites"),onClick:function(t){return e.tabItemClick(t,"starred")},children:[(0,m.jsx)("span",{className:"sf3-font-starred sf3-font","aria-hidden":"true"}),(0,m.jsx)("span",{className:"nav-text",children:(0,f.AP)("Favorites")})]})}),t&&(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("dashboard")),children:(0,m.jsxs)(c.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("dashboard")),to:f.Yc+"dashboard/",title:(0,f.AP)("Activities"),onClick:function(t){return e.tabItemClick(t,"dashboard")},children:[(0,m.jsx)("span",{className:"sf3-font-activities sf3-font","aria-hidden":"true"}),(0,m.jsx)("span",{className:"nav-text",children:(0,f.AP)("Activities")})]})}),(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("published")),children:(0,m.jsxs)(c.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("published")),to:f.Yc+"published/",title:(0,f.AP)("Wikis"),onClick:function(t){return e.tabItemClick(t,"published")},children:[(0,m.jsx)("span",{className:"sf3-font-wiki sf3-font","aria-hidden":"true"}),(0,m.jsx)("span",{className:"nav-text",children:(0,f.AP)("Wikis")})]})}),f.Rf&&(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("invitations")),children:(0,m.jsxs)(c.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("invitations")),to:f.Yc+"invitations/",title:(0,f.AP)("Invite Guest"),onClick:function(t){return e.tabItemClick(t,"invitations")},children:[(0,m.jsx)("span",{className:"sf3-font-invite-visitors sf3-font","aria-hidden":"true"}),(0,m.jsx)("span",{className:"nav-text",children:(0,f.AP)("Invite Guest")})]})}),(0,m.jsxs)("li",{id:"share-admin-nav",className:"nav-item flex-column",children:[(0,m.jsxs)("a",{className:"nav-link ellipsis",title:(0,f.AP)("Share Admin"),onClick:this.shExtend,children:[(0,m.jsx)("span",{className:"sf3-font-wrench sf3-font","aria-hidden":"true"}),(0,m.jsx)("span",{className:"nav-text",children:(0,f.AP)("Share Admin")}),(0,m.jsx)("span",{className:"toggle-icon sf3-font sf3-font-down ".concat(this.state.sharedExtended?"":"rotate-90"),"aria-hidden":"true"})]}),this.renderSharedAdmin()]}),f.vn&&this.renderCustomNavItems()]}),(0,m.jsx)("h2",{className:"mb-2 pt-1 px-2 font-weight-normal heading",children:(0,f.AP)("Help and resources")}),f.QU?(0,m.jsx)("div",{className:"side-nav-footer",dangerouslySetInnerHTML:{__html:f.QU}}):(0,m.jsxs)("ul",{className:"nav nav-pills flex-column nav-container",children:[(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsxs)("a",{className:"nav-link",href:f.Yc+"help/",title:(0,f.AP)("Help"),children:[(0,m.jsx)("span",{className:"sf3-font-help sf3-font","aria-hidden":"true"}),(0,m.jsx)("span",{className:"nav-text",children:(0,f.AP)("Help")})]})}),f.jk&&(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsxs)("a",{href:"".concat(f.Yc,"terms/"),className:"nav-link",children:[(0,m.jsx)("span",{className:"sf3-font-terms sf3-font","aria-hidden":"true"}),(0,m.jsx)("span",{className:"nav-text",children:(0,f.AP)("Terms")})]})}),f.Vk&&(0,m.jsx)(m.Fragment,{children:Object.keys(f.Vk).map((function(e,t){return(0,m.jsxs)("a",{className:"nav-link",href:f.Vk[e],children:[(0,m.jsx)("span",{className:"sf3-font-terms sf3-font","aria-hidden":"true"}),(0,m.jsx)("span",{className:"nav-text",children:e})]})}))}),(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsxs)("a",{href:f.Yc+"download_client_program/",className:"nav-link",children:[(0,m.jsx)("span",{className:"sf3-font-devices sf3-font","aria-hidden":"true"}),(0,m.jsx)("span",{className:"nav-text",children:(0,f.AP)("Clients")})]})})]}),(0,m.jsxs)("div",{className:"side-nav-bottom-toolbar d-none d-md-flex mt-auto px-2 rounded flex-shrink-0 align-items-center",onClick:this.props.toggleFoldSideNav,children:[(0,m.jsx)("img",{className:"mr-2",src:"".concat(f.SG,"img/close-sidebar.svg"),width:"20",alt:""}),(0,m.jsx)("span",{children:(0,f.AP)("Fold the sidebar")})]})]})})}}])}(s.Component),L=n(5544),F=n(81718);var U=function(e){var t=(0,s.useState)(!1),n=(0,L.A)(t,2),r=n[0],o=n[1],a=(0,s.useState)(!1),i=(0,L.A)(a,2),l=i[0],c=i[1],u=(0,s.useCallback)((function(){r?(o(!1),c(!1)):(o(!0),setTimeout((function(){c(!0)}),10))}),[r]);return(0,m.jsx)(F.A,{popperClassName:"side-nav-icon-tip-popover",innerClassName:l?"side-nav-icon-tip side-nav-icon-tip-animation":"side-nav-icon-tip",toggle:u,hideArrow:!0,delay:{show:0,hide:0},target:e.target,placement:"right",isOpen:r,children:e.text})},Y=n(47089),B=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).handleOutsideClick=function(e){n.state.isFilesSubNavShown&&!n.filesSubNav.contains(e.target)&&n.closeSubNav()},n.openSubNav=function(){if(!n.state.isFilesSubNavShown){if(f.M8){var e=document.getElementById("info-bar"),t=60+(e?e.clientHeight:0)+"px";n.filesSubNav.style.top=t}n.setState({isFilesSubNavShown:!0})}},n.closeSubNav=function(){n.state.isFilesSubNavShown&&n.setState({isFilesSubNavShown:!1})},n.tabItemClick=function(e,t,r){if(window.uploader&&window.uploader.isUploadProgressDialogShow&&100!==window.uploader.totalProgress){if(!window.confirm((0,f.AP)("A file is being uploaded. Are you sure you want to leave this page?")))return e.preventDefault(),!1;window.uploader.isUploadProgressDialogShow=!1}n.props.tabItemClick(t,r),n.setState({isFilesSubNavShown:!1})},n.getActiveClass=function(e){return n.props.currentTab===e?"active":""},n.state={groupItems:[],isFilesSubNavShown:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("click",this.handleOutsideClick),this.unsubscribeHeaderEvent=this.props.eventBus.subscribe("top-header-mouse-enter",this.closeSubNav),S.e.listGroups().then((function(t){e.setState({groupItems:t.data.map((function(e){return new D(e)})).sort((function(e,t){return e.name.toLowerCase()<t.name.toLowerCase()?-1:1}))})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.handleOutsideClick),this.unsubscribeHeaderEvent()}},{key:"render",value:function(){var e=this,t=f.q5||f.am||!f.Ez,n=this.state,r=n.groupItems,o=n.isFilesSubNavShown;return(0,m.jsxs)("div",{className:"side-nav-folded-container h-100 position-relative",children:[(0,m.jsx)("div",{className:"side-nav side-nav-folded position-relative",style:{zIndex:Y.bV},children:(0,m.jsx)("div",{className:"side-nav-con p-0",children:(0,m.jsx)("div",{className:"nav nav-pills nav-container",children:(0,m.jsx)("ul",{id:"files-sub-nav",className:"sub-nav position-fixed rounded border shadow p-4 o-auto",style:{left:o?j.xQ+4:"-240px",maxHeight:10*j.R5+32,opacity:o?1:0},ref:function(t){return e.filesSubNav=t},onMouseLeave:this.closeSubNav,children:(0,m.jsx)(O,{groupItems:r,tabItemClick:this.tabItemClick,currentTab:this.props.currentTab})})})})}),(0,m.jsx)("div",{className:"side-nav side-nav-folded h-100 position-relative",style:{zIndex:Y.V0},children:(0,m.jsxs)("div",{className:"side-nav-con d-flex flex-column",children:[(0,m.jsxs)("ul",{className:"nav nav-pills flex-column nav-container",children:[(0,m.jsx)("li",{className:"nav-item flex-column ".concat(this.getActiveClass("libraries")),children:(0,m.jsx)(c.N_,{to:f.Yc+"libraries/",className:"nav-link ellipsis ".concat(this.getActiveClass("libraries")),onClick:function(t){return e.tabItemClick(t,"libraries")},onMouseEnter:this.openSubNav,children:(0,m.jsx)("span",{className:"sf3-font-files sf3-font mr-0","aria-hidden":"true"})})}),(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("starred")),onMouseEnter:this.closeSubNav,children:(0,m.jsxs)(c.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("starred")),to:f.Yc+"starred/",onClick:function(t){return e.tabItemClick(t,"starred")},children:[(0,m.jsx)("span",{className:"sf3-font-starred sf3-font mr-0","aria-hidden":"true",id:"main-side-nav-folded-starred"}),(0,m.jsx)(U,{target:"main-side-nav-folded-starred",text:(0,f.AP)("Favorites")})]})}),t&&(0,m.jsx)(m.Fragment,{children:(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("dashboard")),onMouseEnter:this.closeSubNav,children:(0,m.jsxs)(c.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("dashboard")),to:f.Yc+"dashboard/",onClick:function(t){return e.tabItemClick(t,"dashboard")},children:[(0,m.jsx)("span",{className:"sf3-font-activities sf3-font mr-0","aria-hidden":"true",id:"main-side-nav-folded-dashboard"}),(0,m.jsx)(U,{target:"main-side-nav-folded-dashboard",text:(0,f.AP)("Activities")})]})})}),(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("published")),onMouseEnter:this.closeSubNav,children:(0,m.jsxs)(c.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("published")),to:f.Yc+"published/",onClick:function(t){return e.tabItemClick(t,"published")},children:[(0,m.jsx)("span",{className:"sf3-font-wiki sf3-font mr-0","aria-hidden":"true",id:"main-side-nav-folded-wikis"}),(0,m.jsx)(U,{target:"main-side-nav-folded-wikis",text:(0,f.AP)("Wikis")})]})}),f.Rf&&(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("invitations")),onMouseEnter:this.closeSubNav,children:(0,m.jsxs)(c.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("invitations")),to:f.Yc+"invitations/",onClick:function(t){return e.tabItemClick(t,"invitations")},children:[(0,m.jsx)("span",{className:"sf3-font-invite-visitors sf3-font mr-0","aria-hidden":"true",id:"main-side-nav-folded-invitations"}),(0,m.jsx)(U,{target:"main-side-nav-folded-invitations",text:(0,f.AP)("Invite Guest")})]})}),f.vn&&f.vn.map((function(e,t){return(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsx)("a",{href:e.link,className:"nav-link ellipsis",title:e.desc,children:(0,m.jsx)("span",{className:e.icon,"aria-hidden":"true",title:e.desc})})},t)}))]}),f.QU?(0,m.jsx)("div",{className:"side-nav-footer",dangerouslySetInnerHTML:{__html:f.QU}}):(0,m.jsxs)("ul",{className:"nav nav-pills flex-column nav-container",children:[(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsxs)("a",{className:"nav-link",href:f.Yc+"help/",title:(0,f.AP)("Help"),children:[(0,m.jsx)("span",{className:"sf3-font-help sf3-font mr-0","aria-hidden":"true",id:"main-side-nav-folded-help"}),(0,m.jsx)(U,{target:"main-side-nav-folded-help",text:(0,f.AP)("Help")})]})}),f.jk&&(0,m.jsx)(m.Fragment,{children:(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsxs)("a",{href:"".concat(f.Yc,"terms/"),className:"nav-link",children:[(0,m.jsx)("span",{className:"sf3-font-terms sf3-font mr-0","aria-hidden":"true",id:"main-side-nav-folded-terms"}),(0,m.jsx)(U,{target:"main-side-nav-folded-terms",text:(0,f.AP)("Terms")})]})})}),f.Vk&&(0,m.jsx)(m.Fragment,{children:Object.keys(f.Vk).map((function(e,t){return(0,m.jsx)("a",{className:"nav-link",href:f.Vk[e],children:(0,m.jsx)("span",{className:"sf3-font-terms sf3-font mr-0","aria-hidden":"true"})})}))}),(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsxs)("a",{href:f.Yc+"download_client_program/",className:"nav-link",children:[(0,m.jsx)("span",{className:"sf3-font-devices sf3-font mr-0","aria-hidden":"true",id:"main-side-nav-folded-clients"}),(0,m.jsx)(U,{target:"main-side-nav-folded-clients",text:(0,f.AP)("Clients")})]})})]}),(0,m.jsx)("div",{className:"side-nav-bottom-toolbar d-none d-md-flex mt-auto px-2 rounded flex-shrink-0 align-items-center",onClick:this.props.toggleFoldSideNav,children:(0,m.jsx)("img",{src:"".concat(f.SG,"img/open-sidebar.svg"),width:"20",alt:"",title:(0,f.AP)("Unfold the sidebar")})})]})})]})}}])}(s.Component),H=function(e){function t(){return(0,r.A)(this,t),(0,a.A)(this,t,arguments)}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.isSidePanelFolded,r=e.style,o=e.eventBus;return(0,m.jsxs)("div",{className:w()("side-panel",{"side-panel-folded":n,"left-zero":!this.props.isSidePanelClosed}),style:n?{flexBasis:j.xQ}:r,children:[(0,m.jsx)(d(),{query:"(max-width: 767.8px)",children:(0,m.jsx)("div",{className:"side-panel-north",children:(0,m.jsx)(C.A,{onCloseSidePanel:this.props.onCloseSidePanel})})}),(0,m.jsxs)("div",{className:"side-panel-center",children:[t||null,!t&&!n&&(0,m.jsx)(R,{tabItemClick:this.props.tabItemClick,currentTab:this.props.currentTab,isSidePanelFolded:n,toggleFoldSideNav:this.props.toggleFoldSideNav}),!t&&n&&(0,m.jsx)(B,{tabItemClick:this.props.tabItemClick,currentTab:this.props.currentTab,toggleFoldSideNav:this.props.toggleFoldSideNav,eventBus:o})]})]})}}])}(s.Component),V=H,G=n(91447),q=n(14522),z=n(60436),W=n(59051),K=n.n(W),Z=n(81446),X=(0,o.A)((function e(t){(0,r.A)(this,e),this.repo_id=t.repo_id,this.repo_name=t.repo_name,this.obj_type=t.obj_type,this.commit_id=t.commit_id,this.path=t.path,this.name=t.name,this.author_email=t.author_email,this.author_name=t.author_name,this.author_contact_email=t.author_contact_email,this.avatar_url=t.avatar_url,this.time=t.time,this.op_type=t.op_type,this.createdFilesCount=0,this.createdFilesList=[],"clean-up-trash"===t.op_type?this.days=t.days:"rename"===t.op_type&&"repo"===t.obj_type?this.old_repo_name=t.old_repo_name:"move"===t.op_type&&["dir","file"].includes(t.obj_type)?this.old_path=t.old_path:"rename"===t.op_type&&["dir","file"].includes(t.obj_type)?(this.old_path=t.old_path,this.old_name=t.old_name):"publish"===t.op_type&&(this.old_path=t.old_path)})),$=n(43066),J=n(21205),Q=function(e){function t(){var e;(0,r.A)(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(e=(0,a.A)(this,t,[].concat(o))).toggle=function(t){e.props.toggleCancel(t)},e}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.activity;return(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.toggle,children:[(0,m.jsx)(k.A,{toggle:this.toggle,children:(0,f.AP)("Created Files")}),(0,m.jsx)(M.A,{children:(0,m.jsxs)(J.A,{children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"75%",children:(0,f.AP)("Name")}),(0,m.jsx)("th",{width:"25%",children:(0,f.AP)("Time")})]})}),(0,m.jsx)("tbody",{children:e.createdFilesList.map((function(e,t){var n="".concat(f.Yc,"lib/").concat(e.repo_id,"/file").concat(h.Aq.encodePath(e.path)),r=(0,m.jsx)("a",{href:n,target:"_blank",rel:"noreferrer",children:e.name});return e.name.endsWith("(draft).md")&&(r=e.name),(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{children:r}),(0,m.jsx)("td",{children:K()(e.time).fromNow()})]},t)}))})]})}),(0,m.jsx)(N.A,{children:(0,m.jsx)(P.A,{color:"secondary",onClick:this.toggle.bind(this,e),children:(0,f.AP)("Close")})})]})}}])}(s.Component),ee=Q,te=n(40866);K().locale(window.app.config.lang);var ne=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onListCreatedFilesToggle=function(){n.setState({isListCreatedFiles:!n.state.isListCreatedFiles})},n.onMouseEnter=function(){n.setState({isHighlighted:!0})},n.onMouseLeave=function(){n.setState({isHighlighted:!1})},n.state={isListCreatedFiles:!1,isHighlighted:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e,t,n=this.state.isHighlighted,r=this.props.isDesktop,o=this.props,a=o.item,i=o.index,l=o.items,c=!1,u="".concat(f.Yc,"profile/").concat(encodeURIComponent(a.author_email),"/"),d=f.Yc+"library/"+a.repo_id+"/"+encodeURIComponent(a.repo_name)+"/",p=(0,m.jsx)("a",{href:d,children:a.repo_name}),g=(0,m.jsx)("a",{className:"small text-secondary",href:d,children:a.repo_name});if("repo"==a.obj_type)switch(a.op_type){case"create":e=(0,f.AP)("Created library"),t=p;break;case"rename":e=(0,f.AP)("Renamed library"),t=(0,m.jsxs)("span",{children:[a.old_repo_name," => ",p]});break;case"delete":e=(0,f.AP)("Deleted library"),t=a.repo_name;break;case"recover":e=(0,f.AP)("Restored library"),t=p;break;case"clean-up-trash":e=(0,f.AP)("Cleaned trash"),t=0==a.days?(0,f.AP)("Removed all items from trash."):(0,f.AP)("Removed items older than {n} days from trash.").replace("{n}",a.days),c=!0}else if("files"==a.obj_type){var v="".concat(f.Yc,"lib/").concat(a.repo_id,"/file").concat(h.Aq.encodePath(a.path)),y="<a href=".concat(v,' target="_blank">').concat(a.name,"</a>"),C=a.createdFilesCount-1,A=(0,f.AP)("{file} and {n} other files").replace("{file}",y).replace("{n}",C);e=(0,f.AP)("Created {n} files").replace("{n}",a.createdFilesCount),t=(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("p",{className:"m-0 d-inline",dangerouslySetInnerHTML:{__html:A}}),r&&(0,m.jsx)("button",{type:"button",onClick:this.onListCreatedFilesToggle,className:"activity-details text-secondary ml-2 border-0 p-0 bg-transparent",children:(0,f.AP)("details")})]}),c=!0}else if("file"==a.obj_type){var x=a.name.endsWith("(draft).md"),b=x?"":"".concat(f.Yc,"lib/").concat(a.repo_id,"/file").concat(h.Aq.encodePath(a.path)),_=(0,m.jsx)("a",{href:b,target:"_blank",rel:"noreferrer",children:a.name});switch(x&&(_=a.name),a.op_type){case"create":e=x?(0,f.AP)("Created draft"):(0,f.AP)("Created file"),t=_,c=!0;break;case"delete":e=x?(0,f.AP)("Deleted draft"):(0,f.AP)("Deleted file"),t=a.name,c=!0;break;case"recover":e=(0,f.AP)("Restored file"),t=_,c=!0;break;case"rename":e=(0,f.AP)("Renamed file"),t=(0,m.jsxs)("span",{children:[a.old_name," => ",_]}),c=!0;break;case"move":var w=(0,m.jsx)("a",{href:b,children:a.path});e=(0,f.AP)("Moved file"),t=(0,m.jsxs)("span",{children:[a.old_path," => ",w]}),c=!0;break;case"edit":e=x?(0,f.AP)("Updated draft"):(0,f.AP)("Updated file"),t=_,c=!0}}else{var S=f.Yc+"library/"+a.repo_id+"/"+encodeURIComponent(a.repo_name)+h.Aq.encodePath(a.path),D=(0,m.jsx)("a",{href:S,target:"_blank",rel:"noreferrer",children:a.name});switch(a.op_type){case"create":e=(0,f.AP)("Created folder"),t=D,c=!0;break;case"delete":e=(0,f.AP)("Deleted folder"),t=a.name,c=!0;break;case"recover":e=(0,f.AP)("Restored folder"),t=D,c=!0;break;case"rename":e=(0,f.AP)("Renamed folder"),t=(0,m.jsxs)("span",{children:[a.old_name," => ",D]}),c=!0;break;case"move":var E=(0,m.jsx)("a",{href:S,children:a.path});e=(0,f.AP)("Moved folder"),t=(0,m.jsxs)("span",{children:[a.old_path," => ",E]}),c=!0}}var k=!0;if(i>0){var M=l[i-1].time;k=!K()(a.time).isSame(M,"day")}return(0,m.jsxs)(s.Fragment,{children:[k&&(0,m.jsx)("tr",{children:(0,m.jsx)("td",{colSpan:r?5:3,className:"border-top-0",children:K()(a.time).format("YYYY-MM-DD")})}),r?(0,m.jsxs)("tr",{className:n?"tr-highlight":"",onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[(0,m.jsx)("td",{className:"text-center",children:(0,m.jsx)("img",{src:a.avatar_url,alt:"",width:"32",height:"32",className:"avatar"})}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:u,children:a.author_name})}),(0,m.jsx)("td",{children:e}),(0,m.jsxs)("td",{children:[t,c&&(0,m.jsx)("br",{}),c&&g]}),(0,m.jsx)("td",{className:"text-secondary",children:(0,m.jsx)("time",{datetime:a.time,is:"relative-time",title:K()(a.time).format("llll"),children:K()(a.time).fromNow()})})]}):(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{className:"text-center align-top",children:(0,m.jsx)("img",{src:a.avatar_url,alt:"",width:"32",height:"32",className:"avatar"})}),(0,m.jsxs)("td",{children:[(0,m.jsx)("a",{href:u,children:a.author_name}),(0,m.jsx)("p",{className:"m-0 text-secondary",children:e}),t]}),(0,m.jsxs)("td",{className:"text-right align-top",children:[(0,m.jsx)("span",{className:"text-secondary mobile-activity-time",children:(0,m.jsx)("time",{datetime:a.time,is:"relative-time",title:K()(a.time).format("llll"),children:K()(a.time).fromNow()})}),c&&(0,m.jsx)("br",{}),c&&p]})]}),this.state.isListCreatedFiles&&(0,m.jsx)(te.A,{children:(0,m.jsx)(ee,{activity:a,toggleCancel:this.onListCreatedFilesToggle})})]})}}])}(s.Component);K().locale(window.app.config.lang);var re=function(e){function t(){return(0,r.A)(this,t),(0,a.A)(this,t,arguments)}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=h.Aq.isDesktop(),t=this.props,n=t.items,r=t.isLoadingMore;if(!n.length)return(0,m.jsx)($.A,{text:(0,f.AP)("No more activities")});var o=(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"8%"}),(0,m.jsx)("th",{width:"15%",children:(0,f.AP)("User")}),(0,m.jsx)("th",{width:"20%",children:(0,f.AP)("Operation")}),(0,m.jsxs)("th",{width:"37%",children:[(0,f.AP)("File")," / ",(0,f.AP)("Library")]}),(0,m.jsx)("th",{width:"20%",children:(0,f.AP)("Time")})]})}),a=(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"15%"}),(0,m.jsx)("th",{width:"53%"}),(0,m.jsx)("th",{width:"32%"})]})});return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsxs)("table",{className:"table-thead-hidden",children:[e?o:a,(0,m.jsx)("tbody",{children:n.map((function(t,r){return(0,m.jsx)(ne,{isDesktop:e,item:t,index:r,items:n},r)}))})]}),r?(0,m.jsx)("span",{className:"loading-icon loading-tip"}):""]})}}])}(s.Component),oe=re,ae=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).handleOutsideClick=function(e){n.state.isPopoverOpen&&!n.userSelector.contains(e.target)&&n.togglePopover()},n.togglePopover=function(){n.setState({isPopoverOpen:!n.state.isPopoverOpen},(function(){if(!n.state.isPopoverOpen){var e=n.props.availableUsers.filter((function(e){return e.isSelected}));n.props.setTargetUsers(e)}}))},n.onToggleClick=function(e){e.stopPropagation(),n.togglePopover()},n.onQueryChange=function(e){n.setState({query:e.target.value})},n.toggleSelectItem=function(e,t){e.stopPropagation(),n.props.toggleSelectUser(t)},n.state={isPopoverOpen:!1,query:""},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.handleOutsideClick)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.handleOutsideClick)}},{key:"render",value:function(){var e=this,t=this.state,n=t.isPopoverOpen,r=t.query,o=this.props,a=o.currentSelectedUsers,i=o.availableUsers,s=i.filter((function(e){return e.isSelected})),l=r.trim()?i.filter((function(e){return-1!=e.contact_email.indexOf(r.trim())||-1!=e.name.indexOf(r.trim())})):i;return(0,m.jsxs)("div",{className:"mt-4 position-relative",children:[(0,m.jsxs)("span",{className:"cur-activity-modifiers d-inline-block p-2 rounded",onClick:this.onToggleClick,children:[a.length>0?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("span",{children:(0,f.AP)("Modified by:")}),(0,m.jsx)("span",{className:"d-inline-block ml-1",children:a.map((function(e){return e.name})).join(", ")})]}):(0,f.AP)("Modified by"),(0,m.jsx)("i",{className:"sf3-font sf3-font-down ml-2 toggle-icon"})]}),n&&(0,m.jsxs)("div",{className:"position-absolute activity-modifier-selector-container rounded shadow",ref:function(t){return e.userSelector=t},children:[(0,m.jsx)("ul",{className:"activity-selected-modifiers px-3 py-1 list-unstyled",children:s.map((function(t,n){return(0,m.jsxs)("li",{className:"activity-selected-modifier",children:[(0,m.jsx)("img",{src:t.avatar_url,className:"avatar w-5 h-5",alt:""}),(0,m.jsx)("span",{className:"activity-user-name ml-2",children:t.name}),(0,m.jsx)("i",{className:"sf2-icon-close unselect-activity-user ml-2",onClick:function(n){e.toggleSelectItem(n,t)}})]},n)}))}),(0,m.jsx)("div",{className:"px-3 pt-3",children:(0,m.jsx)(I.A,{type:"text",placeholder:(0,f.AP)("Find modifiers"),value:r,onChange:this.onQueryChange})}),(0,m.jsx)("ul",{className:"activity-user-list list-unstyled p-3 o-auto",children:l.map((function(t,n){return(0,m.jsxs)("li",{className:"activity-user-item h-6 p-1 rounded d-flex justify-content-between align-items-center",onClick:function(n){e.toggleSelectItem(n,t)},children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("img",{src:t.avatar_url,className:"avatar w-5 h-5",alt:""}),(0,m.jsx)("span",{className:"activity-user-name ml-2",children:t.name})]}),t.isSelected&&(0,m.jsx)("i",{className:"sf2-icon-tick text-gray font-weight-bold"})]},n)}))})]})]})}}])}(s.Component);K().locale(window.app.config.lang);var ie=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).mergePublishEvents=function(e){e.forEach((function(e){"publish"===e.op_type&&(n.curPathList.push(e.path),n.oldPathList.push(e.old_path))}));for(var t=[],r=0;r<e.length;r++)"file"===e[r].obj_type?"delete"===e[r].op_type&&n.oldPathList.includes(e[r].path)?n.oldPathList.splice(n.oldPathList.indexOf(e[r].path),1):"edit"===e[r].op_type&&n.curPathList.includes(e[r].path)?n.curPathList.splice(n.curPathList.indexOf(e[r].path),1):"rename"===e[r].op_type&&n.oldPathList.includes(e[r].old_path)?n.oldPathList.splice(n.oldPathList.indexOf(e[r].old_path),1):t.push(e[r]):t.push(e[r]);return t},n.mergeFileCreateEvents=function(e){for(var t=[],n=null,r=0;r<e.length;r++){var o="file"===e[r].obj_type&&"create"===e[r].op_type&&e[r+1]&&"file"===e[r+1].obj_type&&"create"===e[r+1].op_type&&e[r+1].repo_name===e[r].repo_name&&e[r+1].author_email===e[r].author_email;if(null!=n){if(n.createdFilesCount++,n.createdFilesList.push(e[r]),o)continue;t.push(n),n=null}else o?((n=new X(e[r])).obj_type="files",n.createdFilesCount++,n.createdFilesList.push(e[r])):t.push(e[r])}return t},n.filterEvents=function(e){var t=n.props.onlyMine,r=n.state.targetUsers;return t?e.filter((function(e){return e.author_email==f.Xh})):r.length?e.filter((function(e){return-1!=r.map((function(e){return e.email})).indexOf(e.author_email)})):e},n.setTargetUsers=function(e){n.setState({targetUsers:e},(function(){var e=n.filterEvents(n.state.allItems);n.setState({items:e},(function(){e.length<25&&n.state.hasMore&&n.getMore()}))}))},n.toggleSelectUser=function(e){var t=n.state.availableUsers;n.setState({availableUsers:t.map((function(t){return t.email==e.email&&(t.isSelected=!e.isSelected),t}))})},n.handleScroll=function(e){if(!n.state.isLoadingMore&&n.state.hasMore){var t=e.target.clientHeight,r=e.target.scrollHeight;t+e.target.scrollTop+1>=r&&n.setState({isLoadingMore:!0},(function(){n.getMore()}))}},n.state={errorMsg:"",isFirstLoading:!0,isLoadingMore:!1,currentPage:1,hasMore:!0,allItems:[],items:[],availableUsers:[],targetUsers:[]},n.avatarSize=72,n.curPathList=[],n.oldPathList=[],n.availableUserEmails=new Set,n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.state,n=t.currentPage,r=t.availableUsers;S.e.listActivities(n,this.avatarSize).then((function(t){var o=e.mergePublishEvents(t.data.events);(o=e.mergeFileCreateEvents(o)).forEach((function(t){e.availableUserEmails.has(t.author_email)||(e.availableUserEmails.add(t.author_email),r.push({email:t.author_email,name:t.author_name,contact_email:t.author_contact_email,avatar_url:t.avatar_url,isSelected:!1}))}));var a=e.filterEvents(o);e.setState({allItems:o,items:a,availableUsers:r,currentPage:n+1,isFirstLoading:0==a.length,hasMore:!0}),e.state.items.length<25&&e.getMore()})).catch((function(t){e.setState({isFirstLoading:!1,errorMsg:h.Aq.getErrorMsg(t,!0)})}))}},{key:"getMore",value:function(){var e=this,t=this.state,n=t.currentPage,r=t.availableUsers,o=t.targetUsers;S.e.listActivities(n,this.avatarSize).then((function(t){var a=e.mergePublishEvents(t.data.events);(a=e.mergeFileCreateEvents(a)).forEach((function(t){e.availableUserEmails.has(t.author_email)||(e.availableUserEmails.add(t.author_email),r.push({email:t.author_email,name:t.author_name,contact_email:t.author_contact_email,avatar_url:t.avatar_url,isSelected:!1}))}));var i=e.filterEvents(a),s=[].concat((0,z.A)(e.state.items),(0,z.A)(i));e.setState({allItems:[].concat((0,z.A)(e.state.allItems),(0,z.A)(a)),items:s,availableUsers:r,currentPage:n+1,isFirstLoading:0==s.length,isLoadingMore:!1,hasMore:0!==t.data.events.length}),e.state.items.length<25&&e.state.hasMore&&(o.length&&100==n||e.getMore())})).catch((function(t){e.setState({isFirstLoading:!1,isLoadingMore:!1,errorMsg:h.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this.props.onlyMine,t=this.state,n=t.targetUsers,r=t.availableUsers;return(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",id:"activities",children:[(0,m.jsx)("div",{className:"cur-view-path",children:(0,m.jsxs)("ul",{className:"nav",children:[(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsx)(c.N_,{to:"".concat(f.Yc,"dashboard/"),className:"nav-link".concat(e?"":" active"),children:(0,f.AP)("All Activities")})}),(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsx)(c.N_,{to:"".concat(f.Yc,"my-activities/"),className:"nav-link".concat(e?" active":""),children:(0,f.AP)("My Activities")})})]})}),(0,m.jsxs)("div",{className:"cur-view-content d-block",onScroll:this.handleScroll,children:[this.state.isFirstLoading&&(0,m.jsx)(Z.A,{}),!this.state.isFirstLoading&&this.state.errorMsg&&(0,m.jsx)("p",{className:"error text-center",children:this.state.errorMsg}),!this.state.isFirstLoading&&(0,m.jsxs)(s.Fragment,{children:[!e&&(0,m.jsx)(ae,{availableUsers:r,currentSelectedUsers:n,setTargetUsers:this.setTargetUsers,toggleSelectUser:this.toggleSelectUser}),(0,m.jsx)(oe,{items:this.state.items,isLoadingMore:this.state.isLoadingMore})]})]})]})})}}])}(s.Component),se=ie,le=function(e){function t(){return(0,r.A)(this,t),(0,a.A)(this,t,arguments)}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return(0,m.jsx)(se,{onlyMine:!0})}}])}(s.Component),ce=le,ue=n(19260),de=n(6030),pe=n(68879),fe=function(e){function t(){return(0,r.A)(this,t),(0,a.A)(this,t,arguments)}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.data,t=e.loading,n=e.errorMsg,r=e.items;if(t)return(0,m.jsx)(Z.A,{});if(n)return(0,m.jsx)("p",{className:"error text-center",children:n});if(0===r.length)return(0,m.jsx)($.A,{title:(0,f.AP)("No favorites"),text:(0,f.AP)("You have not added any libraries, folders or files to your favorites yet. A favorite gives you quick access to your most frequently used objects. You can add a library, folder or file to your favorites by clicking the star to the left of its name.")});var o=h.Aq.isDesktop();return(0,m.jsxs)("table",{className:"table-hover ".concat(o?"":"table-thead-hidden"),children:[o?(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"4%"}),(0,m.jsx)("th",{width:"40%",children:(0,f.AP)("Name")}),(0,m.jsx)("th",{width:"32%",children:(0,f.AP)("Library")}),(0,m.jsx)("th",{width:"18%",children:(0,f.AP)("Last Update")}),(0,m.jsx)("th",{width:"6%"})]})}):(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"12%"}),(0,m.jsx)("th",{width:"80%"}),(0,m.jsx)("th",{width:"8%"})]})}),(0,m.jsx)(he,{items:r,isDesktop:o})]})}}])}(s.Component),he=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).state={items:n.props.items},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.getThumbnails()}},{key:"getThumbnails",value:function(){var e=this.state.items.filter((function(e){return(h.Aq.imageCheck(e.obj_name)||f.Nz&&h.Aq.videoCheck(e.obj_name)||f.E7&&h.Aq.pdfCheck(e.obj_name))&&!e.repo_encrypted&&!e.encoded_thumbnail_src&&!e.deleted}));if(0!=e.length){var t=e.length,n=this,r=function(o){var a=e[o];S.e.createThumbnail(a.repo_id,a.path,f.dq).then((function(e){a.encoded_thumbnail_src=e.data.encoded_thumbnail_src})).catch((function(e){})).then((function(){o<t-1?r(++o):n.setState({items:n.state.items})}))};r(0)}}},{key:"render",value:function(){var e=this.state.items.map((function(e,t){return"/"===e.path?e.item_icon_url=h.Aq.getDefaultLibIconUrl(!1):e.item_icon_url=e.is_dir?h.Aq.getFolderIconUrl(!1):h.Aq.getFileIconUrl(e.obj_name),e.encoded_path=h.Aq.encodePath(e.path),e.thumbnail_url=e.encoded_thumbnail_src?"".concat(f.Yc).concat(e.encoded_thumbnail_src):"",e.dirent_view_url=e.is_dir?"".concat(f.Yc,"library/").concat(e.repo_id,"/").concat(e.repo_name).concat(e.encoded_path):"".concat(f.Yc,"lib/").concat(e.repo_id,"/file").concat(e.encoded_path),"/"!==e.encoded_path&&(e.dirent_view_url=e.dirent_view_url.replace(/\/+$/,"")),e.mtime_relative=K()(e.mtime).fromNow(),(0,m.jsx)(me,{data:e,isDesktop:this.props.isDesktop},t)}),this);return(0,m.jsx)("tbody",{children:e})}}])}(s.Component),me=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleOpMenu=function(){n.setState({isOpMenuOpen:!n.state.isOpMenuOpen})},n.handleMouseOver=function(){n.setState({showOpIcon:!0})},n.handleMouseOut=function(){n.setState({showOpIcon:!1})},n.unstar=function(e){e.preventDefault();var t=n.props.data;S.e.unstarItem(t.repo_id,t.path).then((function(e){n.setState({unstarred:!0})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.visitItem=function(){var e=n.props.data;e.is_dir?(0,c.oo)(e.dirent_view_url):window.open(e.dirent_view_url)},n.renderMobile=function(){var e=n.props.data,t=e.dirent_view_url;return(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{className:"text-center",onClick:n.visitItem,children:e.thumbnail_url?(0,m.jsx)("img",{className:"thumbnail",src:e.thumbnail_url,alt:""}):(0,m.jsx)("img",{src:e.item_icon_url,alt:(0,f.AP)("icon"),width:"24"})}),(0,m.jsxs)("td",{onClick:n.visitItem,children:[e.is_dir?(0,m.jsx)(c.N_,{to:t,children:e.obj_name}):(0,m.jsx)("a",{className:"normal",href:e.dirent_view_url,target:"_blank",rel:"noreferrer",children:e.obj_name}),(0,m.jsx)("br",{}),(0,m.jsx)("span",{className:"item-meta-info",children:e.repo_name}),(0,m.jsx)("span",{className:"item-meta-info",dangerouslySetInnerHTML:{__html:e.mtime_relative}})]}),(0,m.jsx)("td",{children:(0,m.jsxs)(ue.A,{isOpen:n.state.isOpMenuOpen,toggle:n.toggleOpMenu,children:[(0,m.jsx)(de.A,{tag:"i",className:"sf-dropdown-toggle sf3-font sf3-font-more-vertical ml-0",title:(0,f.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":n.state.isOpMenuOpen}),(0,m.jsxs)("div",{className:n.state.isOpMenuOpen?"":"d-none",onClick:n.toggleOpMenu,children:[(0,m.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),(0,m.jsx)("div",{className:"mobile-operation-menu",children:(0,m.jsx)(pe.A,{className:"mobile-menu-item",onClick:n.unstar,children:(0,f.AP)("Unstar")})})]})]})})]})},n.renderDesktop=function(){var e=n.props.data,t="sf2-icon-x3 unstar action-icon";t+=n.state.showOpIcon?"":" invisible";var r=e.dirent_view_url;return(0,m.jsxs)("tr",{onMouseOver:n.handleMouseOver,onMouseOut:n.handleMouseOut,onFocus:n.handleMouseOver,children:[(0,m.jsx)("td",{className:"text-center",children:e.thumbnail_url?(0,m.jsx)("img",{className:"thumbnail",src:e.thumbnail_url,alt:""}):(0,m.jsx)("img",{src:e.item_icon_url,alt:(0,f.AP)("icon"),width:"24"})}),(0,m.jsx)(s.Fragment,{children:e.deleted?(0,m.jsxs)("td",{children:[e.obj_name," ",(0,m.jsx)("span",{style:{color:"red"},children:(0,f.AP)("deleted")})]}):(0,m.jsx)("td",{children:e.is_dir?(0,m.jsx)(c.N_,{to:r,children:e.obj_name}):(0,m.jsx)("a",{className:"normal",href:r,target:"_blank",rel:"noreferrer",children:e.obj_name})})}),(0,m.jsx)("td",{children:e.repo_name}),(0,m.jsx)("td",{dangerouslySetInnerHTML:{__html:e.mtime_relative}}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"#",role:"button",className:t,title:(0,f.AP)("Unstar"),"aria-label":(0,f.AP)("Unstar"),onClick:n.unstar})})]})},n.state={showOpIcon:!1,unstarred:!1,isOpMenuOpen:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return this.state.unstarred?null:this.props.isDesktop?this.renderDesktop():this.renderMobile()}}])}(s.Component),ge=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).state={loading:!0,errorMsg:"",items:[]},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;S.e.listStarredItems().then((function(t){e.setState({loading:!1,items:t.data.starred_item_list})})).catch((function(t){e.setState({loading:!1,errorMsg:h.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",id:"starred",children:[(0,m.jsx)("div",{className:"cur-view-path",children:(0,m.jsx)("h3",{className:"sf-heading",children:(0,f.AP)("Favorites")})}),(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsx)(fe,{data:this.state})})]})})}}])}(s.Component),ve=n(21870),ye=function(e){function t(){return(0,r.A)(this,t),(0,a.A)(this,t,arguments)}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.data,t=e.loading,n=e.errorMsg,r=e.items;if(t)return(0,m.jsx)("span",{className:"loading-icon loading-tip"});if(n)return(0,m.jsx)("p",{className:"error text-center",children:n});var o=(0,m.jsx)($.A,{title:(0,f.AP)("No linked devices"),text:(0,f.AP)("You have not accessed your files with any client (desktop or mobile) yet. Configure clients on your devices to access your data more comfortably.")}),a=(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"13%",children:(0,f.AP)("Platform")}),(0,m.jsx)("th",{width:"30%",children:(0,f.AP)("Device Name")}),(0,m.jsx)("th",{width:"30%",children:(0,f.AP)("IP")}),(0,m.jsx)("th",{width:"17%",children:(0,f.AP)("Last Access")}),(0,m.jsx)("th",{width:"10%"})]})}),i=(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"92%"}),(0,m.jsx)("th",{width:"8%"})]})}),s=h.Aq.isDesktop();return r.length?(0,m.jsxs)("table",{className:"table-hover ".concat(s?"":"table-thead-hidden"),children:[s?a:i,(0,m.jsx)("tbody",{children:r.map((function(e,t){return(0,m.jsx)(Ce,{data:e,isDesktop:s},t)}))})]}):o}}])}(s.Component),Ce=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleOpMenu=function(){n.setState({isOpMenuOpen:!n.state.isOpMenuOpen})},n.handleMouseOver=function(){n.setState({isOpIconShown:!0})},n.handleMouseOut=function(){n.setState({isOpIconShown:!1})},n.toggleDialog=function(){n.setState({isConfirmUnlinkDialogOpen:!n.state.isConfirmUnlinkDialogOpen})},n.handleClick=function(e){if(e.preventDefault(),n.props.data.is_desktop_client)n.toggleDialog();else{n.unlinkDevice(!0)}},n.unlinkDevice=function(e){var t=n.props.data;S.e.unlinkDevice(t.platform,t.device_id,e).then((function(e){n.setState({unlinked:!0});var r=(0,f.AP)("Successfully unlinked %(name)s.");r=r.replace("%(name)s",t.device_name),E.A.success(r)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.renderDesktopItem=function(){var e=n.props.data,t="sf3-font-delete1 sf3-font unlink-device action-icon";return t+=n.state.isOpIconShown?"":" invisible",(0,m.jsxs)("tr",{onMouseOver:n.handleMouseOver,onMouseOut:n.handleMouseOut,onFocus:n.handleMouseOver,children:[(0,m.jsx)("td",{children:e.platform}),(0,m.jsx)("td",{children:e.device_name}),(0,m.jsx)("td",{children:e.last_login_ip}),(0,m.jsx)("td",{children:K()(e.last_accessed).fromNow()}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"#",className:t,title:(0,f.AP)("Unlink"),role:"button","aria-label":(0,f.AP)("Unlink"),onClick:n.handleClick})})]})},n.renderMobileItem=function(){var e=n.props.data;return(0,m.jsxs)("tr",{children:[(0,m.jsxs)("td",{children:[e.device_name,(0,m.jsx)("br",{}),(0,m.jsx)("span",{className:"item-meta-info",children:e.last_login_ip}),(0,m.jsx)("span",{className:"item-meta-info",children:K()(e.last_accessed).fromNow()}),(0,m.jsx)("span",{className:"item-meta-info",children:e.platform})]}),(0,m.jsx)("td",{children:(0,m.jsxs)(ue.A,{isOpen:n.state.isOpMenuOpen,toggle:n.toggleOpMenu,children:[(0,m.jsx)(de.A,{tag:"i",className:"sf-dropdown-toggle sf3-font sf3-font-more-vertical ml-0",title:(0,f.AP)("More operations"),"aria-label":(0,f.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":n.state.isOpMenuOpen}),(0,m.jsxs)("div",{className:n.state.isOpMenuOpen?"":"d-none",onClick:n.toggleOpMenu,children:[(0,m.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),(0,m.jsx)("div",{className:"mobile-operation-menu",children:(0,m.jsx)(pe.A,{className:"mobile-menu-item",onClick:n.handleClick,children:(0,f.AP)("Unlink")})})]})]})})]})},n.state={isOpMenuOpen:!1,isOpIconShown:!1,unlinked:!1,isConfirmUnlinkDialogOpen:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return this.state.unlinked?null:(0,m.jsxs)(s.Fragment,{children:[this.props.isDesktop?this.renderDesktopItem():this.renderMobileItem(),this.state.isConfirmUnlinkDialogOpen&&(0,m.jsx)(ve.A,{executeOperation:this.unlinkDevice,toggleDialog:this.toggleDialog})]})}}])}(s.Component),Ae=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).state={loading:!0,errorMsg:"",items:[]},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;S.e.listLinkedDevices().then((function(t){e.setState({loading:!1,items:t.data})})).catch((function(t){e.setState({loading:!1,errorMsg:h.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",id:"linked-devices",children:[(0,m.jsx)("div",{className:"cur-view-path",children:(0,m.jsx)("h3",{className:"sf-heading",children:(0,f.AP)("Linked Devices")})}),(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsx)(ye,{data:this.state})})]})})}}])}(s.Component),xe=n(89470),be=(0,o.A)((function e(t){(0,r.A)(this,e),this.repo_id=t.repo_id,this.repo_name=t.repo_name,this.share_type=t.share_type,this.share_permission=t.share_permission,this.share_permission_name=t.share_permission_name,this.modifier_name=t.modifier_name,this.modifier_email=t.modifier_email,this.modifier_contact_email=t.modifier_contact_email,this.encrypted=t.encrypted,"personal"===this.share_type?(this.is_admin=t.is_admin,this.user_name=t.user_name,this.user_email=t.user_email,this.contact_email=t.contact_email):"group"===this.share_type&&(this.is_admin=t.is_admin,this.group_id=t.group_id,this.group_name=t.group_name)})),_e=n(17437),we=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).listCustomPermissions=function(){var e=n.props.repoID;S.e.listCustomPermissions(e).then((function(e){var t=e.data.permission_list.map((function(e){return new _e.A(e)}));n.setState({isLoading:!1,customPermissions:t})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t),n.setState({isLoading:!1})}))},n.switchOption=function(e){if(e.target.checked){var t=e.target.value;n.setState({currentOption:t}),n.props.changePerm(t),n.props.toggleDialog()}},n.translatePermission=function(e){var t=h.Aq.sharePerms(e);if(!t){var r=n.state.customPermissions.find((function(t){return t.id+""===e}));t=r&&r.name}return t},n.translateExplanation=function(e){var t=h.Aq.sharePermsExplanation(e);if(!t){var r=n.state.customPermissions.find((function(t){return t.id+""===e}));t=r&&r.description}return t},n.getPermissions=function(){var e=n.props.permissions.slice(),t=n.state.customPermissions;return n.customPermissions||(t.length>0&&t.forEach((function(t){e.push(t.id+"")})),n.customPermissions=e),n.customPermissions},n.state={isLoading:!0,currentOption:n.props.currentPerm,customPermissions:[]},n.customPermissions=null,n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.props.repoID?this.listCustomPermissions():this.setState({isLoading:!1})}},{key:"render",value:function(){var e=this,t=this.state,n=t.isLoading,r=t.currentOption,o=[];return n||(o=this.getPermissions()),(0,m.jsx)(p.A,{isOpen:!0,toggle:this.props.toggleDialog,children:(0,m.jsxs)(M.A,{style:{maxHeight:"400px",overflow:"auto"},children:[n&&(0,m.jsx)(Z.A,{}),!n&&o.map((function(t,n){return(0,m.jsxs)("div",{className:"d-flex",children:[(0,m.jsx)("input",{id:"option-".concat(n),className:"mt-1",type:"radio",name:"permission",value:t,checked:r==t,onChange:e.switchOption}),(0,m.jsxs)("label",{htmlFor:"option-".concat(n),className:"ml-2",children:[e.translatePermission(t),(0,m.jsx)("p",{className:"text-secondary small m-0",children:e.translateExplanation(t)})]})]},n)}))]})})}}])}(s.Component),Se=function(e){function t(){var e;(0,r.A)(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(e=(0,a.A)(this,t,[].concat(o))).sortByName=function(t){t.preventDefault();var n="asc"==e.props.sortOrder?"desc":"asc";e.props.sortItems("name",n)},e}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg,r=e.items,o=e.sortBy,a=e.sortOrder;if(t)return(0,m.jsx)("span",{className:"loading-icon loading-tip"});if(n)return(0,m.jsx)("p",{className:"error text-center",children:n});var i=(0,m.jsx)($.A,{title:(0,f.AP)("No libraries shared"),text:(0,f.AP)('You have not shared any libraries with other users yet. You can share a library with other users by clicking the share icon to the right of a library\'s name in "My Libraries".')}),s="name"==o,l="asc"==a?(0,m.jsx)("span",{className:"sf3-font sf3-font-down rotate-180 d-inline-block"}):(0,m.jsx)("span",{className:"sf3-font sf3-font-down"}),c=h.Aq.isDesktop(),u=(0,m.jsxs)("table",{className:"table-hover ".concat(c?"":"table-thead-hidden"),children:[(0,m.jsx)("thead",{children:c?(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"4%"}),(0,m.jsx)("th",{width:"34%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByName,children:[(0,f.AP)("Name")," ",s&&l]})}),(0,m.jsx)("th",{width:"30%",children:(0,f.AP)("Share To")}),(0,m.jsx)("th",{width:"24%",children:(0,f.AP)("Permission")}),(0,m.jsx)("th",{width:"8%"})]}):(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"12%"}),(0,m.jsx)("th",{width:"80%"}),(0,m.jsx)("th",{width:"8%"})]})}),(0,m.jsx)("tbody",{children:r.map((function(e,t){return(0,m.jsx)(De,{isDesktop:c,item:e},t)}))})]});return r.length?u:i}}])}(s.Component),De=function(e){function t(e){var n;(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleOpMenu=function(){n.setState({isOpMenuOpen:!n.state.isOpMenuOpen})},n.togglePermSelectDialog=function(){n.setState({isPermSelectDialogOpen:!n.state.isPermSelectDialogOpen})},n.onMouseEnter=function(){n.setState({isOpIconShown:!0})},n.onMouseLeave=function(){n.setState({isOpIconShown:!1})},n.changePerm=function(e){var t=n.props.item,r=t.share_type,o={share_type:r,permission:e};"personal"==r?o.user=t.user_email:"group"==r&&(o.group_id=t.group_id),S.e.updateRepoSharePerm(t.repo_id,o).then((function(){n.setState({share_permission:"admin"==e?"rw":e,is_admin:"admin"==e}),E.A.success((0,f.AP)("Successfully modified permission."))})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.unshare=function(e){e.preventDefault();var t=n.props.item,r=t.share_type,o={share_type:r};"personal"==r?o.user=t.user_email:"group"==r&&(o.group_id=t.group_id),S.e.unshareRepo(t.repo_id,o).then((function(e){n.setState({unshared:!0});var r=(0,f.AP)("Successfully unshared {name}").replace("{name}",t.repo_name);E.A.success(r)})).catch((function(e){var t=h.Aq.getErrorMsg(e);(0,E.A)(t)}))},n.onEditPermission=function(e){e.nativeEvent.stopImmediatePropagation(),n.setState({isShowPermEditor:!0})};var o=n.props.item;n.state={share_permission:o.share_permission,share_permission_name:o.share_permission_name,is_admin:o.is_admin,isOpIconShown:!1,isOpMenuOpen:!1,isPermSelectDialogOpen:!1,unshared:!1,isShowPermEditor:!1};var i=["rw","r"];return n.permissions=i,n.showAdmin=f.am&&"public"!==o.share_type,n.showAdmin&&i.push("admin"),f.am&&i.push("cloud-edit","preview"),n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){if(this.state.unshared)return null;var e=this.state,t=e.share_permission,n=e.share_permission_name,r=e.is_admin,o=e.isOpIconShown,a=e.isPermSelectDialogOpen,i=e.isShowPermEditor,l=this.props.item;Object.assign(l,{share_permission:t,is_admin:r});var u,d=h.Aq.getLibIconUrl(l),p=h.Aq.getLibIconTitle(l),g="".concat(f.Yc,"library/").concat(l.repo_id,"/").concat(encodeURIComponent(l.repo_name),"/"),v=l.share_type;return"personal"==v?u=l.user_name:"group"==v?u=l.group_name:"public"==v&&(u=(0,f.AP)("all members")),this.showAdmin&&r&&(t="admin"),t.startsWith("custom-")&&(t=t.slice(7)),this.props.isDesktop?(0,m.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onFocus:this.onMouseEnter,children:[(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:d,title:p,alt:p,width:"24"})}),(0,m.jsx)("td",{children:(0,m.jsx)(c.N_,{to:g,children:l.repo_name})}),(0,m.jsx)("td",{children:"personal"==l.share_type?(0,m.jsx)("span",{title:l.contact_email,children:u}):u}),(0,m.jsxs)("td",{children:[!i&&(0,m.jsxs)("div",{children:[(0,m.jsx)("span",{children:h.Aq.sharePerms(t)||n}),o&&(0,m.jsx)("a",{href:"#",role:"button","aria-label":(0,f.AP)("Edit"),title:(0,f.AP)("Edit"),className:"sf3-font sf3-font-rename attr-action-icon",onClick:this.onEditPermission})]}),i&&(0,m.jsx)(xe.A,{repoID:l.repo_id,isTextMode:!0,isEditing:!0,autoFocus:!0,isEditIconShow:this.state.isOpIconShown,currentPermission:t,permissions:this.permissions,onPermissionChanged:this.changePerm})]}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"#",role:"button","aria-label":(0,f.AP)("Unshare"),className:"action-icon sf2-icon-x3 ".concat(o?"":"invisible"),title:(0,f.AP)("Unshare"),onClick:this.unshare})})]}):(0,m.jsxs)(s.Fragment,{children:[(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:d,title:p,alt:p,width:"24"})}),(0,m.jsxs)("td",{children:[(0,m.jsx)(c.N_,{to:g,children:l.repo_name}),(0,m.jsx)("span",{className:"item-meta-info-highlighted",children:h.Aq.sharePerms(t)}),(0,m.jsx)("br",{}),(0,m.jsx)("span",{className:"item-meta-info",children:"".concat((0,f.AP)("Share To:")," ").concat(u)})]}),(0,m.jsx)("td",{children:(0,m.jsxs)(ue.A,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu,children:[(0,m.jsx)(de.A,{tag:"i",className:"sf-dropdown-toggle sf3-font sf3-font-more-vertical ml-0",title:(0,f.AP)("More operations"),"aria-label":(0,f.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),(0,m.jsxs)("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu,children:[(0,m.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),(0,m.jsxs)("div",{className:"mobile-operation-menu",children:[(0,m.jsx)(pe.A,{className:"mobile-menu-item",onClick:this.togglePermSelectDialog,children:(0,f.AP)("Permission")}),(0,m.jsx)(pe.A,{className:"mobile-menu-item",onClick:this.unshare,children:(0,f.AP)("Unshare")})]})]})]})})]}),a&&(0,m.jsx)(we,{repoID:l.repo_id,currentPerm:t,permissions:this.permissions,changePerm:this.changePerm,toggleDialog:this.togglePermSelectDialog})]})}}])}(s.Component),Ee=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).sortItems=function(e,t){n.setState({sortBy:e,sortOrder:t,items:h.Aq.sortRepos(n.state.items,e,t)})},n.state={loading:!0,errorMsg:"",items:[],sortBy:"name",sortOrder:"asc"},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;S.e.listSharedRepos().then((function(t){var n=t.data.map((function(e){return new be(e)}));e.setState({loading:!1,items:h.Aq.sortRepos(n,e.state.sortBy,e.state.sortOrder)})})).catch((function(t){e.setState({loading:!1,errorMsg:h.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",id:"share-admin-libs",children:[(0,m.jsx)("div",{className:"cur-view-path",children:(0,m.jsx)("h3",{className:"sf-heading",children:(0,f.AP)("Libraries")})}),(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsx)(Se,{errorMsg:this.state.errorMsg,loading:this.state.loading,items:this.state.items,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems})})]})})}}])}(s.Component),ke=(0,o.A)((function e(t){(0,r.A)(this,e),this.path=t.path,this.folder_name=t.folder_name,this.repo_id=t.repo_id,this.repo_name=t.repo_name,this.share_type=t.share_type,this.share_permission=t.share_permission,this.share_permission_name=t.share_permission_name,"group"===t.share_type?(this.group_id=t.group_id,this.group_name=t.group_name):(this.user_name=t.user_name,this.user_email=t.user_email,this.contact_email=t.contact_email)})),Me=function(e){function t(){var e;(0,r.A)(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(e=(0,a.A)(this,t,[].concat(o))).sortByName=function(t){t.preventDefault();var n="asc"==e.props.sortOrder?"desc":"asc";e.props.sortItems("name",n)},e}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg,r=e.items,o=e.sortBy,a=e.sortOrder;if(t)return(0,m.jsx)(Z.A,{});if(n)return(0,m.jsx)("p",{className:"error text-center",children:n});var i=(0,m.jsx)($.A,{title:(0,f.AP)("No folders shared"),text:(0,f.AP)("You have not shared any folders with other users yet. You can share a folder with other users by clicking the share icon to the right of a folder's name.")}),s="name"==o,l="asc"==a?(0,m.jsx)("span",{className:"sf3-font sf3-font-down rotate-180 d-inline-block"}):(0,m.jsx)("span",{className:"sf3-font sf3-font-down"}),c=h.Aq.isDesktop(),u=(0,m.jsxs)("table",{className:"table-hover ".concat(c?"":"table-thead-hidden"),children:[(0,m.jsx)("thead",{children:c?(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"4%"}),(0,m.jsx)("th",{width:"34%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByName,children:[(0,f.AP)("Name")," ",s&&l]})}),(0,m.jsx)("th",{width:"30%",children:(0,f.AP)("Share To")}),(0,m.jsx)("th",{width:"24%",children:(0,f.AP)("Permission")}),(0,m.jsx)("th",{width:"8%"})]}):(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"12%"}),(0,m.jsx)("th",{width:"80%"}),(0,m.jsx)("th",{width:"8%"})]})}),(0,m.jsx)("tbody",{children:r.map((function(e,t){return(0,m.jsx)(Ie,{isDesktop:c,item:e},t)}))})]});return r.length?u:i}}])}(s.Component),Ie=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleOpMenu=function(){n.setState({isOpMenuOpen:!n.state.isOpMenuOpen})},n.togglePermSelectDialog=function(){n.setState({isPermSelectDialogOpen:!n.state.isPermSelectDialogOpen})},n.onMouseEnter=function(){n.setState({isOpIconShown:!0})},n.onMouseLeave=function(){n.setState({isOpIconShown:!1})},n.unshare=function(e){e.preventDefault();var t=n.props.item,r={p:t.path};"personal"==t.share_type?Object.assign(r,{share_type:"user",username:t.user_email}):Object.assign(r,{share_type:t.share_type,group_id:t.group_id}),S.e.unshareFolder(t.repo_id,r).then((function(e){n.setState({unshared:!0});var r=(0,f.AP)("Successfully unshared {name}").replace("{name}",t.folder_name);E.A.success(r)})).catch((function(e){var t=h.Aq.getErrorMsg(e);(0,E.A)(t)}))},n.changePerm=function(e){var t=n.props.item,r={permission:e},o={p:t.path};"personal"==t.share_type?Object.assign(o,{share_type:"user",username:t.user_email}):Object.assign(o,{share_type:t.share_type,group_id:t.group_id}),S.e.updateFolderSharePerm(t.repo_id,r,o).then((function(t){n.setState({share_permission:e}),E.A.success((0,f.AP)("Successfully modified permission."))})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.onEditPermission=function(e){e.nativeEvent.stopImmediatePropagation(),n.setState({isShowPermEditor:!0})},n.state={share_permission:n.props.item.share_permission,share_permission_name:n.props.item.share_permission_name,isOpIconShown:!1,isOpMenuOpen:!1,isPermSelectDialogOpen:!1,unshared:!1,isShowPermEditor:!1},n.permissions=["rw","r"],f.am&&n.permissions.push("cloud-edit","preview"),n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){if(this.state.unshared)return null;var e=this.props.item,t=this.state,n=t.share_permission,r=t.share_permission_name,o=t.isOpIconShown,a=t.isPermSelectDialogOpen,i=t.isShowPermEditor,l=!1;"r"!=n&&"preview"!=n||(l=!0);var u=h.Aq.getFolderIconUrl(l),d=h.Aq.getFolderIconTitle({permission:n}),p="".concat(f.Yc,"library/").concat(e.repo_id,"/").concat(encodeURIComponent(e.repo_name)).concat(h.Aq.encodePath(e.path));return n.startsWith("custom-")&&(n=n.slice(7)),this.props.isDesktop?(0,m.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onFocus:this.onMouseEnter,children:[(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:u,title:d,alt:d,width:"24"})}),(0,m.jsx)("td",{children:(0,m.jsx)(c.N_,{to:p,children:e.folder_name})}),(0,m.jsx)("td",{children:"personal"==e.share_type?(0,m.jsx)("span",{title:e.contact_email,children:e.user_name}):e.group_name}),(0,m.jsxs)("td",{children:[!i&&(0,m.jsxs)("div",{children:[(0,m.jsx)("span",{children:h.Aq.sharePerms(n)||r}),o&&(0,m.jsx)("a",{href:"#",role:"button","aria-label":(0,f.AP)("Edit"),title:(0,f.AP)("Edit"),className:"sf3-font sf3-font-rename attr-action-icon",onClick:this.onEditPermission})]}),i&&(0,m.jsx)(xe.A,{repoID:e.repo_id,isTextMode:!0,isEditIconShow:o,isEditing:!0,autoFocus:!0,currentPermission:n,permissions:this.permissions,onPermissionChanged:this.changePerm})]}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"#",role:"button","aria-label":(0,f.AP)("Unshare"),className:"action-icon sf2-icon-x3 ".concat(o?"":"invisible"),title:(0,f.AP)("Unshare"),onClick:this.unshare})})]}):(0,m.jsxs)(s.Fragment,{children:[(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:u,title:d,alt:d,width:"24"})}),(0,m.jsxs)("td",{children:[(0,m.jsx)(c.N_,{to:p,children:e.folder_name}),(0,m.jsx)("span",{className:"item-meta-info-highlighted",children:h.Aq.sharePerms(n)}),(0,m.jsx)("br",{}),(0,m.jsx)("span",{className:"item-meta-info",children:"".concat((0,f.AP)("Share To:")," ").concat("personal"==e.share_type?e.user_name:e.group_name)})]}),(0,m.jsx)("td",{children:(0,m.jsxs)(ue.A,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu,children:[(0,m.jsx)(de.A,{tag:"i",className:"sf-dropdown-toggle sf3-font sf3-font-more-vertical ml-0",title:(0,f.AP)("More operations"),"aria-label":(0,f.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),(0,m.jsxs)("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu,children:[(0,m.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),(0,m.jsxs)("div",{className:"mobile-operation-menu",children:[(0,m.jsx)(pe.A,{className:"mobile-menu-item",onClick:this.togglePermSelectDialog,children:(0,f.AP)("Permission")}),(0,m.jsx)(pe.A,{className:"mobile-menu-item",onClick:this.unshare,children:(0,f.AP)("Unshare")})]})]})]})})]}),a&&(0,m.jsx)(we,{repoID:e.repo_id,currentPerm:n,permissions:this.permissions,changePerm:this.changePerm,toggleDialog:this.togglePermSelectDialog})]})}}])}(s.Component),Ne=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e]))._sortItems=function(e,t,n){var r;switch("".concat(t,"-").concat(n)){case"name-asc":r=function(e,t){return h.Aq.compareTwoWord(e.folder_name,t.folder_name)};break;case"name-desc":r=function(e,t){return-h.Aq.compareTwoWord(e.folder_name,t.folder_name)}}return e.sort(r),e},n.sortItems=function(e,t){n.setState({sortBy:e,sortOrder:t,items:n._sortItems(n.state.items,e,t)})},n.state={loading:!0,errorMsg:"",items:[],sortBy:"name",sortOrder:"asc"},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;S.e.listSharedFolders().then((function(t){var n=t.data.map((function(e){return new ke(e)}));e.setState({loading:!1,items:e._sortItems(n,e.state.sortBy,e.state.sortOrder)})})).catch((function(t){e.setState({loading:!1,errorMsg:h.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",id:"share-admin-libs",children:[(0,m.jsx)("div",{className:"cur-view-path",children:(0,m.jsx)("h3",{className:"sf-heading",children:(0,f.AP)("Folders")})}),(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsx)(Me,{errorMsg:this.state.errorMsg,loading:this.state.loading,items:this.state.items,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems})})]})})}}])}(s.Component),Pe=n(26548),Te=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).switchOption=function(e){if(e.target.checked){var t=e.target.value;n.setState({currentOption:t}),n.props.changePerm(t),n.props.toggleDialog()}},n.state={currentOption:n.props.currentPerm},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props.permissions,n=this.state.currentOption;return(0,m.jsx)(p.A,{isOpen:!0,toggle:this.props.toggleDialog,children:(0,m.jsx)(M.A,{children:t.map((function(t,r){return(0,m.jsxs)("div",{className:"d-flex",children:[(0,m.jsx)("input",{id:"option-".concat(r),className:"mt-1",type:"radio",name:"permission",value:t,checked:n==t,onChange:e.switchOption}),(0,m.jsx)("label",{htmlFor:"option-".concat(r),className:"ml-2",children:h.Aq.getShareLinkPermissionObject(t).text})]},r)}))})})}}])}(s.Component),Oe=n(91611),je=function(e){function t(e){var n;(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).switchOption=function(e){if(e.target.checked){n.setState({currentOption:e.target.value});var t=e.target.value.split("-"),r=(0,L.A)(t,2),o=r[0],a=r[1];n.props.sortItems(o,a),n.props.toggleDialog()}},n.sortOptions=n.props.sortOptions||[{value:"name-asc",text:(0,f.AP)("By name ascending")},{value:"name-desc",text:(0,f.AP)("By name descending")},{value:"size-asc",text:(0,f.AP)("By size ascending")},{value:"size-desc",text:(0,f.AP)("By size descending")},{value:"time-asc",text:(0,f.AP)("By time ascending")},{value:"time-desc",text:(0,f.AP)("By time descending")}];var o=n.props,i=o.sortBy,s=o.sortOrder;return n.state={currentOption:"".concat(i,"-").concat(s)},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this;return(0,m.jsx)(p.A,{isOpen:!0,toggle:this.props.toggleDialog,children:(0,m.jsx)(M.A,{children:this.sortOptions.map((function(t,n){return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("input",{id:"option-".concat(n),className:"align-middle",type:"radio",name:"sort-option",value:t.value,checked:e.state.currentOption==t.value,onChange:e.switchOption}),(0,m.jsx)("label",{htmlFor:"option-".concat(n),className:"align-middle m-2",children:t.text}),(0,m.jsx)("br",{})]},n)}))})})}}])}(s.Component),Re=n(82487),Le=n(66149),Fe=n(33151),Ue=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleDropdownMenu=function(){n.setState({isDropdownMenuOpen:!n.state.isDropdownMenuOpen})},n.onDropdownToggleKeyDown=function(e){"Enter"!=e.key&&"Space"!=e.key||n.toggleDropdownMenu()},n.onMenuItemKeyDown=function(e,t){"Enter"!=t.key&&"Space"!=t.key||e.onClick()},n.state={isDropdownMenuOpen:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props.opList;return(0,m.jsx)(s.Fragment,{children:(0,m.jsxs)(ue.A,{isOpen:this.state.isDropdownMenuOpen,toggle:this.toggleDropdownMenu,children:[(0,m.jsx)(de.A,{tag:"i",role:"button",className:"sf3-font-down sf3-font ml-1 sf-dropdown-toggle",onClick:this.toggleDropdownMenu,onKeyDown:this.onDropdownToggleKeyDown,"data-toggle":"dropdown"}),(0,m.jsx)(Fe.A,{children:t.map((function(t,n){return"Divider"==t?(0,m.jsx)(pe.A,{divider:!0},n):(0,m.jsx)(pe.A,{onClick:t.onClick,onKeyDown:e.onMenuItemKeyDown.bind(e,t),children:t.text},n)}))})]})})}}])}(s.Component),Ye=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleItemFreezed=function(e){n.setState({isItemFreezed:e})},n.sortByName=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortItems("name",t)},n.sortByTime=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortItems("time",t)},n.state={isItemFreezed:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,o=t.items,a=t.sortBy,i=t.sortOrder;if(n)return(0,m.jsx)(Z.A,{});if(r)return(0,m.jsx)("p",{className:"error text-center",children:r});var s=(0,m.jsx)($.A,{title:(0,f.AP)("No share links"),text:(0,f.AP)("You have not created any share links yet. A share link can be used to share files and folders with anyone. You can create a share link for a file or folder by clicking the share icon to the right of its name.")}),l="name"==a,c="time"==a,u="asc"==i?(0,m.jsx)("span",{className:"sf3-font sf3-font-down rotate-180 d-inline-block"}):(0,m.jsx)("span",{className:"sf3-font sf3-font-down"}),d=h.Aq.isDesktop(),p=f.am?["14%","7%","14%"]:["21%","14%","20%"],g=(0,m.jsxs)("table",{className:"".concat(d?"":"table-thead-hidden"),children:[(0,m.jsx)("thead",{children:d?(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"4%"}),(0,m.jsx)("th",{width:"31%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByName,children:[(0,f.AP)("Name")," ",l&&u]})}),(0,m.jsx)("th",{width:p[0],children:(0,f.AP)("Library")}),f.am&&(0,m.jsx)("th",{width:"20%",children:(0,f.AP)("Permission")}),(0,m.jsx)("th",{width:p[1],children:(0,f.AP)("Visits")}),(0,m.jsx)("th",{width:p[2],children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByTime,children:[(0,f.AP)("Expiration")," ",c&&u]})}),(0,m.jsx)("th",{width:"10%"})]}):(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"12%"}),(0,m.jsx)("th",{width:"80%"}),(0,m.jsx)("th",{width:"8%"})]})}),(0,m.jsx)("tbody",{children:o.map((function(t,n){return(0,m.jsx)(Be,{isDesktop:d,item:t,onRemoveLink:e.props.onRemoveLink,isItemFreezed:e.state.isItemFreezed,toggleItemFreezed:e.toggleItemFreezed},n)}))})]});return o.length?(0,m.jsxs)(m.Fragment,{children:[g,this.props.isLoadingMore&&(0,m.jsx)("div",{className:"flex-shrink-0",children:(0,m.jsx)(Z.A,{})})]}):s}}])}(s.Component),Be=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).updatePermissionOptions=function(){var e=n.props.item,t=e.is_dir?"/"===e.path?"library":"dir":"file",r=e.repo_folder_permission,o=h.Aq.getShareLinkPermissionList(t,r,e.path,e.can_edit),a=h.Aq.getShareLinkPermissionStr(n.props.item.permissions);n.setState({permissionOptions:o,currentPermission:a})},n.toggleOpMenu=function(){n.setState({isOpMenuOpen:!n.state.isOpMenuOpen})},n.togglePermSelectDialog=function(){n.setState({isPermSelectDialogOpen:!n.state.isPermSelectDialogOpen})},n.toggleLinkDialog=function(){n.setState({isLinkDialogOpen:!n.state.isLinkDialogOpen})},n.handleMouseEnter=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!0,highlight:!0})},n.handleMouseLeave=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!1,highlight:!1})},n.viewLink=function(e){e.preventDefault(),n.toggleLinkDialog()},n.removeLink=function(e){e.preventDefault(),n.props.onRemoveLink(n.props.item)},n.renderExpiration=function(){var e=n.props.item;if(!e.expire_date)return"--";var t=K()(e.expire_date).format("YYYY-MM-DD"),r=K()(e.expire_date).format("YYYY-MM-DD HH:mm:ss");return(0,m.jsx)("span",{className:e.is_expired?"error":"",title:r,children:t})},n.changePermission=function(e){n.changePerm(e.value)},n.changePerm=function(e){var t=n.props.item,r=h.Aq.getShareLinkPermissionObject(e).permissionDetails;S.e.updateShareLink(t.token,JSON.stringify(r)).then((function(){n.setState({currentPermission:e});var t=(0,f.AP)("Successfully modified permission.");E.A.success(t)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.state={highlight:!1,isOpIconShown:!1,isOpMenuOpen:!1,isPermSelectDialogOpen:!1,isLinkDialogOpen:!1,permissionOptions:[],currentPermission:""},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){f.am&&this.updatePermissionOptions()}},{key:"render",value:function(){var e=this.props.item,t=this.state,n=t.currentPermission,r=t.permissionOptions,o=t.isOpIconShown,a=t.isPermSelectDialogOpen,i=t.isLinkDialogOpen;this.permOptions=r.map((function(e){return{value:e,text:h.Aq.getShareLinkPermissionObject(e).text,isSelected:e==n}}));var l,u,d=this.permOptions.filter((function(e){return e.isSelected}))[0]||{};if(e.is_dir){var p="/"===e.path?"/":e.path.slice(0,e.path.length-1);l=h.Aq.getFolderIconUrl(!1),u="".concat(f.Yc,"library/").concat(e.repo_id,"/").concat(encodeURIComponent(e.repo_name)).concat(h.Aq.encodePath(p))}else l=h.Aq.getFileIconUrl(e.obj_name),u="".concat(f.Yc,"lib/").concat(e.repo_id,"/file").concat(h.Aq.encodePath(e.path));return(0,m.jsxs)(s.Fragment,{children:[this.props.isDesktop?(0,m.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onFocus:this.handleMouseEnter,children:[(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:l,width:"24",alt:""})}),(0,m.jsxs)("td",{children:[e.is_dir?(0,m.jsx)(c.N_,{to:u,children:e.obj_name}):(0,m.jsx)("a",{href:u,target:"_blank",rel:"noreferrer",children:e.obj_name}),""===e.obj_id?(0,m.jsx)("span",{style:{color:"red"},children:(0,f.AP)("(deleted)")}):null]}),(0,m.jsx)("td",{children:(0,m.jsx)(c.N_,{to:"".concat(f.Yc,"library/").concat(e.repo_id,"/").concat(encodeURIComponent(e.repo_name),"/"),children:e.repo_name})}),f.am&&(0,m.jsx)("td",{children:(0,m.jsx)(Le.A,{isDropdownToggleShown:o&&!e.is_expired,currentSelectedOption:d,options:this.permOptions,selectOption:this.changePermission,toggleItemFreezed:this.props.toggleItemFreezed})}),(0,m.jsx)("td",{children:e.view_cnt}),(0,m.jsx)("td",{children:this.renderExpiration()}),(0,m.jsxs)("td",{children:[!e.is_expired&&(0,m.jsx)("a",{href:"#",className:"sf2-icon-link action-icon op-icon ".concat(o?"":"invisible"),title:(0,f.AP)("View"),"aria-label":(0,f.AP)("View"),role:"button",onClick:this.viewLink}),(0,m.jsx)("a",{href:"#",className:"sf3-font-delete1 sf3-font action-icon op-icon ".concat(o?"":"invisible"),title:(0,f.AP)("Remove"),"aria-label":(0,f.AP)("Remove"),role:"button",onClick:this.removeLink})]})]}):(0,m.jsxs)(s.Fragment,{children:[(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:l,alt:"",width:"24"})}),(0,m.jsxs)("td",{children:[e.is_dir?(0,m.jsx)(c.N_,{to:u,children:e.obj_name}):(0,m.jsx)("a",{href:u,target:"_blank",rel:"noreferrer",children:e.obj_name}),f.am&&(0,m.jsx)("span",{className:"item-meta-info-highlighted",children:h.Aq.getShareLinkPermissionObject(n).text}),(0,m.jsx)("br",{}),(0,m.jsx)("span",{children:e.repo_name}),(0,m.jsx)("br",{}),(0,m.jsxs)("span",{className:"item-meta-info",children:[(0,f.AP)("Visits"),": ",e.view_cnt]}),(0,m.jsxs)("span",{className:"item-meta-info",children:[(0,f.AP)("Expiration"),": ",this.renderExpiration()]})]}),(0,m.jsx)("td",{children:(0,m.jsxs)(ue.A,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu,children:[(0,m.jsx)(de.A,{tag:"i",className:"sf-dropdown-toggle sf3-font sf3-font-more-vertical ml-0",title:(0,f.AP)("More operations"),"aria-label":(0,f.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),(0,m.jsxs)("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu,children:[(0,m.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),(0,m.jsxs)("div",{className:"mobile-operation-menu",children:[f.am&&!e.is_expired&&(0,m.jsx)(pe.A,{className:"mobile-menu-item",onClick:this.togglePermSelectDialog,children:(0,f.AP)("Permission")}),!e.is_expired&&(0,m.jsx)(pe.A,{className:"mobile-menu-item",onClick:this.viewLink,children:(0,f.AP)("View")}),(0,m.jsx)(pe.A,{className:"mobile-menu-item",onClick:this.removeLink,children:(0,f.AP)("Remove")})]})]})]})})]}),a&&(0,m.jsx)(Te,{currentPerm:n,permissions:r,changePerm:this.changePerm,toggleDialog:this.togglePermSelectDialog})]}),i&&(0,m.jsx)(Oe.A,{link:e.link,toggleDialog:this.toggleLinkDialog})]})}}])}(s.Component),He=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e]))._sortItems=function(e,t,n){var r;switch("".concat(t,"-").concat(n)){case"name-asc":r=function(e,t){return h.Aq.compareTwoWord(e.obj_name,t.obj_name)};break;case"name-desc":r=function(e,t){return-h.Aq.compareTwoWord(e.obj_name,t.obj_name)};break;case"time-asc":r=function(e,t){return e.expire_date<t.expire_date?-1:1};break;case"time-desc":r=function(e,t){return e.expire_date<t.expire_date?1:-1}}return e.sort((function(e,t){return e.is_dir&&!t.is_dir?-1:!e.is_dir&&t.is_dir?1:r(e,t)})),e},n.sortItems=function(e,t){n.setState({sortBy:e,sortOrder:t,items:n._sortItems(n.state.items,e,t)})},n.handleScroll=function(e){if(!n.state.isLoadingMore&&n.state.hasMore){var t=e.target.clientHeight,r=e.target.scrollHeight;t+e.target.scrollTop+1>=r&&n.setState({isLoadingMore:!0},(function(){n.getMore()}))}},n.getMore=function(){var e=n.state.page;S.e.listShareLinks({page:e+1}).then((function(t){var r=t.data.map((function(e){return new Pe.A(e)}));n.setState({isLoadingMore:!1,hasMore:25==t.data.length,page:e+1,items:n._sortItems(n.state.items.concat(r),n.state.sortBy,n.state.sortOrder)})})).catch((function(e){n.setState({isLoadingMore:!1,errorMsg:h.Aq.getErrorMsg(e,!0)})}))},n.onRemoveLink=function(e){S.e.deleteShareLink(e.token).then((function(){var t=n.state.items.filter((function(t){return t.token!==e.token}));n.setState({items:t});var r=(0,f.AP)("Successfully deleted 1 item.");E.A.success(r)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.toggleSortOptionsDialog=function(){n.setState({isSortOptionsDialogOpen:!n.state.isSortOptionsDialogOpen})},n.toggleCleanInvalidShareLinksDialog=function(){n.setState({isCleanInvalidShareLinksDialogOpen:!n.state.isCleanInvalidShareLinksDialogOpen})},n.cleanInvalidShareLinks=function(){S.e.cleanInvalidShareLinks().then((function(e){var t=n.state.items.filter((function(e){return""!==e.obj_id})).filter((function(e){return!e.is_expired}));n.setState({items:t}),E.A.success((0,f.AP)("Successfully cleaned invalid share links."))})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.state={isCleanInvalidShareLinksDialogOpen:!1,loading:!0,hasMore:!1,isLoadingMore:!1,page:1,errorMsg:"",items:[],sortBy:"name",sortOrder:"asc"},n.sortOptions=[{value:"name-asc",text:(0,f.AP)("By name ascending")},{value:"name-desc",text:(0,f.AP)("By name descending")},{value:"time-asc",text:(0,f.AP)("By expiration ascending")},{value:"time-desc",text:(0,f.AP)("By expiration descending")}],n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.listUserShareLinks()}},{key:"listUserShareLinks",value:function(){var e=this,t=this.state.page;S.e.listShareLinks({page:t}).then((function(t){var n=t.data.map((function(e){return new Pe.A(e)}));e.setState({loading:!1,hasMore:25==t.data.length,items:e._sortItems(n,e.state.sortBy,e.state.sortOrder)})})).catch((function(t){e.setState({loading:!1,errorMsg:h.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsxs)("div",{className:"cur-view-path share-upload-nav",children:[(0,m.jsxs)("ul",{className:"nav",children:[(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsxs)(c.N_,{to:"".concat(f.Yc,"share-admin-share-links/"),className:"nav-link active",children:[(0,f.AP)("Share Links"),(0,m.jsx)(Ue,{opList:[{text:(0,f.AP)("Clean invalid share links"),onClick:this.toggleCleanInvalidShareLinksDialog}]})]})}),f.fY&&(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsx)(c.N_,{to:"".concat(f.Yc,"share-admin-upload-links/"),className:"nav-link",children:(0,f.AP)("Upload Links")})})]}),!h.Aq.isDesktop()&&this.state.items.length>0&&(0,m.jsx)("span",{className:"sf3-font sf3-font-sort action-icon",onClick:this.toggleSortOptionsDialog})]}),(0,m.jsx)("div",{className:"cur-view-content",onScroll:this.handleScroll,children:(0,m.jsx)(Ye,{loading:this.state.loading,isLoadingMore:this.state.isLoadingMore,errorMsg:this.state.errorMsg,items:this.state.items,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems,onRemoveLink:this.onRemoveLink})})]})}),this.state.isSortOptionsDialogOpen&&(0,m.jsx)(je,{toggleDialog:this.toggleSortOptionsDialog,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortOptions:this.sortOptions,sortItems:this.sortItems}),this.state.isCleanInvalidShareLinksDialogOpen&&(0,m.jsx)(Re.A,{title:(0,f.AP)("Clean invalid share links"),message:(0,f.AP)("Are you sure you want to clean invalid share links?"),executeOperation:this.cleanInvalidShareLinks,confirmBtnText:(0,f.AP)("Clean"),toggleDialog:this.toggleCleanInvalidShareLinksDialog})]})}}])}(s.Component),Ve=n(8576),Ge=function(e){function t(){return(0,r.A)(this,t),(0,a.A)(this,t,arguments)}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,o=t.items;if(n)return(0,m.jsx)(Z.A,{});if(r)return(0,m.jsx)("p",{className:"error text-center",children:r});var a=(0,m.jsx)($.A,{title:(0,f.AP)("No upload links"),text:(0,f.AP)("You have not created any upload links yet. An upload link allows anyone to upload files to a folder or library. You can create an upload link for a folder or library by clicking the share icon to the right of its name.")}),i=h.Aq.isDesktop(),s=(0,m.jsxs)("table",{className:"table-hover ".concat(i?"":"table-thead-hidden"),children:[(0,m.jsx)("thead",{children:i?(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"4%"}),(0,m.jsx)("th",{width:"30%",children:(0,f.AP)("Name")}),(0,m.jsx)("th",{width:"24%",children:(0,f.AP)("Library")}),(0,m.jsx)("th",{width:"16%",children:(0,f.AP)("Visits")}),(0,m.jsx)("th",{width:"16%",children:(0,f.AP)("Expiration")}),(0,m.jsx)("th",{width:"10%"})]}):(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"12%"}),(0,m.jsx)("th",{width:"80%"}),(0,m.jsx)("th",{width:"8%"})]})}),(0,m.jsx)("tbody",{children:o.map((function(t,n){return(0,m.jsx)(qe,{isDesktop:i,item:t,onRemoveLink:e.props.onRemoveLink},n)}))})]});return o.length?s:a}}])}(s.Component),qe=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleOpMenu=function(){n.setState({isOpMenuOpen:!n.state.isOpMenuOpen})},n.toggleLinkDialog=function(){n.setState({isLinkDialogOpen:!n.state.isLinkDialogOpen})},n.handleMouseOver=function(){n.setState({isOpIconShown:!0})},n.handleMouseOut=function(){n.setState({isOpIconShown:!1})},n.viewLink=function(e){e.preventDefault(),n.toggleLinkDialog()},n.removeLink=function(e){e.preventDefault(),n.props.onRemoveLink(n.props.item)},n.renderExpiration=function(){var e=n.props.item;if(!e.expire_date)return"--";var t=K()(e.expire_date).format("YYYY-MM-DD"),r=K()(e.expire_date).format("YYYY-MM-DD HH:mm:ss");return(0,m.jsx)("span",{className:e.is_expired?"error":"",title:r,children:t})},n.state={isOpIconShown:!1,isOpMenuOpen:!1,isLinkDialogOpen:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.item,t=this.state,n=t.isOpIconShown,r=t.isLinkDialogOpen,o=h.Aq.getFolderIconUrl(!1),a="".concat(f.Yc,"library/").concat(e.repo_id,"/").concat(encodeURIComponent(e.repo_name)),i="".concat(a).concat(h.Aq.encodePath(e.path));return(0,m.jsxs)(s.Fragment,{children:[this.props.isDesktop?(0,m.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:o,alt:"",width:"24"})}),(0,m.jsxs)("td",{children:[(0,m.jsx)(c.N_,{to:i,children:e.obj_name}),""===e.obj_id?(0,m.jsx)("span",{style:{color:"red"},children:(0,f.AP)("(deleted)")}):null]}),(0,m.jsx)("td",{children:(0,m.jsx)(c.N_,{to:a,children:e.repo_name})}),(0,m.jsx)("td",{children:e.view_cnt}),(0,m.jsx)("td",{children:this.renderExpiration()}),(0,m.jsxs)("td",{children:[!e.is_expired&&(0,m.jsx)("a",{href:"#",className:"sf2-icon-link action-icon op-icon ".concat(n?"":"invisible"),title:(0,f.AP)("View"),"aria-label":(0,f.AP)("View"),role:"button",onClick:this.viewLink}),(0,m.jsx)("a",{href:"#",className:"sf3-font-delete1 sf3-font action-icon op-icon ".concat(n?"":"invisible"),title:(0,f.AP)("Remove"),"aria-label":(0,f.AP)("Remove"),role:"button",onClick:this.removeLink})]})]}):(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:o,alt:"",width:"24"})}),(0,m.jsxs)("td",{children:[(0,m.jsx)(c.N_,{to:i,children:e.obj_name}),(0,m.jsx)("br",{}),(0,m.jsx)("span",{children:e.repo_name}),(0,m.jsx)("br",{}),(0,m.jsxs)("span",{className:"item-meta-info",children:[(0,f.AP)("Visits"),": ",e.view_cnt]}),(0,m.jsxs)("span",{className:"item-meta-info",children:[(0,f.AP)("Expiration"),": ",this.renderExpiration()]})]}),(0,m.jsx)("td",{children:(0,m.jsxs)(ue.A,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu,children:[(0,m.jsx)(de.A,{tag:"i",className:"sf-dropdown-toggle sf3-font sf3-font-more-vertical ml-0",title:(0,f.AP)("More operations"),"aria-label":(0,f.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),(0,m.jsxs)("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu,children:[(0,m.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),(0,m.jsxs)("div",{className:"mobile-operation-menu",children:[!e.is_expired&&(0,m.jsx)(pe.A,{className:"mobile-menu-item",onClick:this.viewLink,children:(0,f.AP)("View")}),(0,m.jsx)(pe.A,{className:"mobile-menu-item",onClick:this.removeLink,children:(0,f.AP)("Remove")})]})]})]})})]}),r&&(0,m.jsx)(Oe.A,{link:e.link,toggleDialog:this.toggleLinkDialog})]})}}])}(s.Component),ze=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onRemoveLink=function(e){S.e.deleteUploadLink(e.token).then((function(){var t=n.state.items.filter((function(t){return t.token!==e.token}));n.setState({items:t});var r=(0,f.AP)("Successfully deleted 1 item.");E.A.success(r)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.toggleCleanInvalidUploadLinksDialog=function(){n.setState({isCleanInvalidUploadLinksDialogOpen:!n.state.isCleanInvalidUploadLinksDialogOpen})},n.cleanInvalidUploadLinks=function(){S.e.cleanInvalidUploadLinks().then((function(e){var t=n.state.items.filter((function(e){return""!==e.obj_id})).filter((function(e){return!e.is_expired}));n.setState({items:t}),E.A.success((0,f.AP)("Successfully cleaned invalid upload links."))})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.state={isCleanInvalidUploadLinksDialogOpen:!1,loading:!0,errorMsg:"",items:[]},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.listUserUploadLinks()}},{key:"listUserUploadLinks",value:function(){var e=this;S.e.listUserUploadLinks().then((function(t){var n=t.data.map((function(e){return new Ve.A(e)}));e.setState({loading:!1,items:n})})).catch((function(t){e.setState({loading:!1,errorMsg:h.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)("div",{className:"cur-view-path share-upload-nav",children:(0,m.jsxs)("ul",{className:"nav",children:[f.zn&&(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsx)(c.N_,{to:"".concat(f.Yc,"share-admin-share-links/"),className:"nav-link",children:(0,f.AP)("Share Links")})}),(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsxs)(c.N_,{to:"".concat(f.Yc,"share-admin-upload-links/"),className:"nav-link active",children:[(0,f.AP)("Upload Links"),(0,m.jsx)(Ue,{opList:[{text:(0,f.AP)("Clean invalid upload links"),onClick:this.toggleCleanInvalidUploadLinksDialog}]})]})})]})}),(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsx)(Ge,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.items,onRemoveLink:this.onRemoveLink})})]})}),this.state.isCleanInvalidUploadLinksDialogOpen&&(0,m.jsx)(Re.A,{title:(0,f.AP)("Clean invalid upload links"),message:(0,f.AP)("Are you sure you want to clean invalid upload links?"),executeOperation:this.cleanInvalidUploadLinks,confirmBtnText:(0,f.AP)("Clean"),toggleDialog:this.toggleCleanInvalidUploadLinksDialog})]})}}])}(s.Component),We=n(58801),Ke=(0,o.A)((function e(t){(0,r.A)(this,e),this.repo_id=t.repo_id,this.repo_name=t.repo_name,this.repo_type=t.repo_type,this.permission=t.permission,this.size_original=t.size,this.size=h.Aq.bytesToSize(t.size),this.owner_name=t.owner_name,this.owner_email=t.owner_email,this.owner_contact_email=t.owner_contact_email,this.owner_avatar=t.owner_avatar||"",this.encrypted=t.encrypted,this.last_modified=t.last_modified,this.modifier_contact_email=t.modifier_contact_email,this.modifier_email=t.modifier_email,this.modifier_name=t.modifier_name,this.modifier_avatar=t.modifier_avatar,this.type=t.type,this.starred=t.starred,this.monitored=t.monitored,this.status=t.status,this.storage_name=t.storage_name,void 0!=t.is_admin&&(this.is_admin=t.is_admin),this.file_count=t.file_count||0,this.has_been_shared_out=t.has_been_shared_out,this.is_virtual=t.is_virtual,this.lib_need_decrypt=t.lib_need_decrypt,this.no_quota=t.no_quota})),Ze=function(e){function t(){return(0,r.A)(this,t),(0,a.A)(this,t,arguments)}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.inAllLibs,t=void 0!==e&&e?["14%","78%","8%"]:["12%","80%","8%"];return(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:t[0],children:(0,m.jsx)("span",{className:"sr-only",children:(0,f.AP)("Library Type")})}),(0,m.jsx)("th",{width:t[1]}),(0,m.jsx)("th",{width:t[2],children:(0,m.jsx)("span",{className:"sr-only",children:(0,f.AP)("Actions")})})]})})}}])}(s.Component),Xe=Ze,$e=n(88134),Je=n(78297),Qe=function(e){function t(){return(0,r.A)(this,t),(0,a.A)(this,t,arguments)}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.repoID,n=e.className;return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("i",{id:"watching-".concat(t),className:"sf3-font-monitor sf3-font ".concat(n||"")}),(0,m.jsx)(Je.A,{placement:"bottom",target:"#watching-".concat(t),children:(0,f.AP)("You are watching file changes of this library.")})]})}}])}(s.Component),et=Qe,tt=n(2949),nt=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).freezeItem=function(e){n.setState({isItemFreezed:e})},n.sortByName=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortItems("name",t)},n.sortByTime=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortItems("time",t)},n.sortBySize=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortItems("size",t)},n.state={isItemFreezed:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,o=t.items,a=t.sortBy,i=t.sortOrder,s=t.theadHidden,l=t.inAllLibs,c=t.currentViewMode,u=l?(0,m.jsx)("p",{className:"libraries-empty-tip-in-".concat(c,"-mode"),children:(0,f.AP)("No shared libraries")}):(0,m.jsx)($.A,{title:(0,f.AP)("No shared libraries"),text:(0,f.AP)("No libraries have been shared directly with you. A shared library can be shared with full or restricted permission. If you need access to a library owned by another user, ask the user to share the library with you.")});if(n)return(0,m.jsx)(Z.A,{});if(r)return(0,m.jsx)("p",{className:"error text-center",children:r});var d="name"==a,p="time"==a,g="size"==a,v="asc"==i?(0,m.jsx)("span",{className:"sf3-font sf3-font-down rotate-180 d-inline-block"}):(0,m.jsx)("span",{className:"sf3-font sf3-font-down"}),y=(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"4%"}),(0,m.jsx)("th",{width:"3%",children:(0,m.jsx)("span",{className:"sr-only",children:(0,f.AP)("Library Type")})}),(0,m.jsx)("th",{width:"35%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByName,children:[(0,f.AP)("Name")," ",d&&v]})}),(0,m.jsx)("th",{width:"10%",children:(0,m.jsx)("span",{className:"sr-only",children:(0,f.AP)("Actions")})}),(0,m.jsx)("th",{width:"14%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortBySize,children:[(0,f.AP)("Size")," ",g&&v]})}),(0,m.jsx)("th",{width:"17%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByTime,children:[(0,f.AP)("Last Update")," ",p&&v]})}),(0,m.jsx)("th",{width:"17%",children:(0,f.AP)("Owner")})]})}),C=h.Aq.isDesktop(),A=(0,m.jsx)(m.Fragment,{children:o.map((function(t,n){return(0,m.jsx)(rt,{data:t,isDesktop:C,isItemFreezed:e.state.isItemFreezed,freezeItem:e.freezeItem,onMonitorRepo:e.props.onMonitorRepo,currentViewMode:c},n)}))}),x=c==tt.Tb?(0,m.jsxs)("table",{className:C&&!s?"":"table-thead-hidden",children:[C?y:(0,m.jsx)(Xe,{inAllLibs:l}),(0,m.jsx)("tbody",{children:A})]}):(0,m.jsx)("div",{className:"d-flex justify-content-between flex-wrap",children:A});return o.length?x:u}}])}(s.Component),rt=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleOpMenu=function(){n.setState({isOpMenuOpen:!n.state.isOpMenuOpen},(function(){n.props.freezeItem(n.state.isOpMenuOpen)}))},n.handleMouseOver=function(){n.props.isItemFreezed||n.setState({highlight:!0,showOpIcon:!0})},n.handleMouseOut=function(){n.props.isItemFreezed||n.setState({highlight:!1,showOpIcon:!1})},n.share=function(e){e.preventDefault(),n.setState({isShowSharedDialog:!0})},n.leaveShare=function(e){e.preventDefault();var t,r=n.props.data;if(-1==r.owner_email.indexOf("@seafile_group")){var o={share_type:"personal",from:r.owner_email};t=S.e.leaveShareRepo(r.repo_id,o)}else t=S.e.leaveShareGroupOwnedRepo(r.repo_id);t.then((function(e){n.setState({unshared:!0});var t=(0,f.AP)("Successfully unshared {name}").replace("{name}",r.repo_name);E.A.success(t)})).catch((function(e){var t=h.Aq.getErrorMsg(e);t===(0,f.AP)("Error")&&(t=(0,f.AP)("Failed to unshare {name}").replace("{name}",r.repo_name)),(0,E.A)(t)}))},n.toggleShareDialog=function(){n.setState({isShowSharedDialog:!1})},n.onToggleStarRepo=function(e){e.preventDefault();var t=n.props.data.repo_name;n.state.isStarred?S.e.unstarItem(n.props.data.repo_id,"/").then((function(){n.setState({isStarred:!n.state.isStarred});var e=(0,f.AP)("Successfully unstarred {library_name_placeholder}.").replace("{library_name_placeholder}",t);E.A.success(e)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)})):S.e.starItem(n.props.data.repo_id,"/").then((function(){n.setState({isStarred:!n.state.isStarred});var e=(0,f.AP)("Successfully starred {library_name_placeholder}.").replace("{library_name_placeholder}",t);E.A.success(e)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.visitRepo=function(){(0,c.oo)(n.repoURL)},n.watchFileChanges=function(){var e=n.props.data;S.e.monitorRepo(e.repo_id).then((function(){n.props.onMonitorRepo(e,!0)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.unwatchFileChanges=function(){var e=n.props.data;S.e.unMonitorRepo(e.repo_id).then((function(){n.props.onMonitorRepo(e,!1)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.state={highlight:!1,showOpIcon:!1,unshared:!1,isShowSharedDialog:!1,isStarred:n.props.data.starred,isOpMenuOpen:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){if(this.state.unshared)return null;var e=this.state.isStarred,t=this.props,n=t.data,r=t.currentViewMode,o=void 0===r?tt.Tb:r,a=o==tt.nj;n.icon_url=h.Aq.getLibIconUrl(n,a),n.icon_title=h.Aq.getLibIconTitle(n);var i=this.state.showOpIcon?"":" invisible",l="op-icon sf3-font-share sf3-font repo-share-btn"+i,u="op-icon sf2-icon-x3"+i,d=this.repoURL="".concat(f.Yc,"library/").concat(n.repo_id,"/").concat(h.Aq.encodePath(n.repo_name),"/"),p=f.am&&("r"==n.permission||"rw"==n.permission);return this.props.isDesktop?(0,m.jsxs)(s.Fragment,{children:[o==tt.Tb?(0,m.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[(0,m.jsx)("td",{className:"text-center",children:(0,m.jsx)("i",{role:"button",title:this.state.isStarred?(0,f.AP)("Unstar"):(0,f.AP)("Star"),"aria-label":this.state.isStarred?(0,f.AP)("Unstar"):(0,f.AP)("Star"),onClick:this.onToggleStarRepo,className:"op-icon m-0 ".concat(this.state.isStarred?"sf3-font-star":"sf3-font-star-empty"," sf3-font")})}),(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:n.icon_url,title:n.icon_title,alt:n.icon_title,width:"24"})}),(0,m.jsx)("td",{children:(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)(c.N_,{to:d,children:n.repo_name}),n.monitored&&(0,m.jsx)(et,{repoID:n.repo_id,className:"ml-1 op-icon"})]})}),(0,m.jsxs)("td",{children:[f.am&&n.is_admin&&(0,m.jsx)("a",{href:"#",className:l,title:(0,f.AP)("Share"),role:"button","aria-label":(0,f.AP)("Share"),onClick:this.share}),(0,m.jsx)("a",{href:"#",className:u,title:(0,f.AP)("Leave Share"),role:"button","aria-label":(0,f.AP)("Leave Share"),onClick:this.leaveShare}),p&&(0,m.jsxs)(ue.A,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu,children:[(0,m.jsx)(de.A,{tag:"i",role:"button",tabIndex:"0",className:"sf-dropdown-toggle sf3-font-more sf3-font ".concat(i),title:(0,f.AP)("More operations"),"aria-label":(0,f.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),(0,m.jsx)(Fe.A,{children:(0,m.jsx)(pe.A,{onClick:n.monitored?this.unwatchFileChanges:this.watchFileChanges,children:n.monitored?(0,f.AP)("Unwatch File Changes"):(0,f.AP)("Watch File Changes")})})]})]}),(0,m.jsx)("td",{children:n.size}),(0,m.jsx)("td",{title:K()(n.last_modified).format("llll"),children:K()(n.last_modified).fromNow()}),(0,m.jsx)("td",{title:n.owner_contact_email,children:n.owner_name})]}):(0,m.jsxs)("div",{className:"library-grid-item px-3 d-flex justify-content-between align-items-center",onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[(0,m.jsxs)("div",{className:"d-flex align-items-center text-truncate",children:[(0,m.jsx)("img",{src:n.icon_url,title:n.icon_title,alt:n.icon_title,width:"36",className:"mr-2"}),(0,m.jsx)(c.N_,{to:d,className:"text-truncate library-name",title:n.repo_name,children:n.repo_name}),e&&(0,m.jsx)("i",{role:"button",title:(0,f.AP)("Unstar"),"aria-label":(0,f.AP)("Unstar"),onClick:this.onToggleStarRepo,className:"op-icon library-grid-item-icon sf3-font-star sf3-font"}),n.monitored&&(0,m.jsx)(et,{repoID:n.repo_id,className:"op-icon library-grid-item-icon"})]}),(0,m.jsxs)("div",{className:"flex-shrink-0",children:[f.am&&n.is_admin&&(0,m.jsx)("a",{href:"#",className:l,title:(0,f.AP)("Share"),role:"button","aria-label":(0,f.AP)("Share"),onClick:this.share}),(0,m.jsx)("a",{href:"#",className:u,title:(0,f.AP)("Leave Share"),role:"button","aria-label":(0,f.AP)("Leave Share"),onClick:this.leaveShare}),p&&(0,m.jsxs)(ue.A,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu,children:[(0,m.jsx)(de.A,{tag:"i",role:"button",tabIndex:"0",className:"sf-dropdown-toggle sf3-font-more sf3-font ".concat(i),title:(0,f.AP)("More operations"),"aria-label":(0,f.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),(0,m.jsx)(Fe.A,{children:(0,m.jsx)(pe.A,{onClick:n.monitored?this.unwatchFileChanges:this.watchFileChanges,children:n.monitored?(0,f.AP)("Unwatch File Changes"):(0,f.AP)("Watch File Changes")})})]})]})]}),this.state.isShowSharedDialog&&(0,m.jsx)(te.A,{children:(0,m.jsx)($e.A,{itemType:"library",itemName:n.repo_name,itemPath:"/",repoID:n.repo_id,repoEncrypted:n.encrypted,enableDirPrivateShare:!0,userPerm:n.permission,isAdmin:!0,toggleDialog:this.toggleShareDialog})})]}):(0,m.jsxs)(s.Fragment,{children:[(0,m.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,children:[(0,m.jsx)("td",{onClick:this.visitRepo,children:(0,m.jsx)("img",{src:n.icon_url,title:n.icon_title,alt:n.icon_title,width:"24"})}),(0,m.jsxs)("td",{onClick:this.visitRepo,children:[(0,m.jsx)(c.N_,{to:d,children:n.repo_name}),n.monitored&&(0,m.jsx)(et,{repoID:n.repo_id,className:"ml-1 op-icon"}),(0,m.jsx)("br",{}),(0,m.jsx)("span",{className:"item-meta-info",title:n.owner_contact_email,children:n.owner_name}),(0,m.jsx)("span",{className:"item-meta-info",children:n.size}),(0,m.jsx)("span",{className:"item-meta-info",title:K()(n.last_modified).format("llll"),children:K()(n.last_modified).fromNow()})]}),(0,m.jsx)("td",{children:(0,m.jsxs)(ue.A,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu,children:[(0,m.jsx)(de.A,{tag:"i",className:"sf-dropdown-toggle sf3-font sf3-font-more-vertical ml-0",title:(0,f.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),(0,m.jsxs)("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu,children:[(0,m.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),(0,m.jsxs)("div",{className:"mobile-operation-menu",children:[(0,m.jsx)(pe.A,{className:"mobile-menu-item",onClick:this.onToggleStarRepo,children:this.state.isStarred?(0,f.AP)("Unstar"):(0,f.AP)("Star")}),f.am&&n.is_admin&&(0,m.jsx)(pe.A,{className:"mobile-menu-item",onClick:this.share,children:(0,f.AP)("Share")}),(0,m.jsx)(pe.A,{className:"mobile-menu-item",onClick:this.leaveShare,children:(0,f.AP)("Leave Share")}),p&&(0,m.jsx)(pe.A,{className:"mobile-menu-item",onClick:n.monitored?this.unwatchFileChanges:this.watchFileChanges,children:n.monitored?(0,f.AP)("Unwatch File Changes"):(0,f.AP)("Watch File Changes")})]})]})]})})]}),this.state.isShowSharedDialog&&(0,m.jsx)(te.A,{children:(0,m.jsx)($e.A,{itemType:"library",itemName:n.repo_name,itemPath:"/",repoID:n.repo_id,repoEncrypted:n.encrypted,enableDirPrivateShare:!0,userPerm:n.permission,isAdmin:!0,toggleDialog:this.toggleShareDialog})})]})}}])}(s.Component),ot=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).sortItems=function(e,t){We.Ay.save("seafile-repo-dir-sort-by",e),We.Ay.save("seafile-repo-dir-sort-order",t),n.setState({sortBy:e,sortOrder:t,items:h.Aq.sortRepos(n.state.items,e,t)})},n.toggleSortOptionsDialog=function(){n.setState({isSortOptionsDialogOpen:!n.state.isSortOptionsDialogOpen})},n.onMonitorRepo=function(e,t){var r=n.state.items.map((function(n){return n.repo_id===e.repo_id&&(n.monitored=t),n}));n.setState({items:r})},n.renderContent=function(){var e=n.props,t=e.inAllLibs,r=void 0!==t&&t,o=e.currentViewMode,a=void 0===o?tt.Tb:o,i=e.repoList,s=n.state.items;return(0,m.jsx)(nt,{loading:n.state.loading,errorMsg:n.state.errorMsg,items:r?i:s,sortBy:n.state.sortBy,sortOrder:n.state.sortOrder,sortItems:n.sortItems,onMonitorRepo:n.onMonitorRepo,theadHidden:r,inAllLibs:r,currentViewMode:a})},n.renderSortIconInMobile=function(){return(0,m.jsx)(m.Fragment,{children:!h.Aq.isDesktop()&&n.state.items.length>0&&(0,m.jsx)("span",{className:"sf3-font sf3-font-sort action-icon",onClick:n.toggleSortOptionsDialog})})},n.state={loading:!0,errorMsg:"",items:[],sortBy:We.Ay.load("seafile-repo-dir-sort-by")||"name",sortOrder:We.Ay.load("seafile-repo-dir-sort-order")||"asc",isSortOptionsDialogOpen:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.repoList?this.setState({loading:!1,items:this.props.repoList}):S.e.listRepos({type:"shared"}).then((function(t){var n=t.data.repos.map((function(e){return new Ke(e)}));e.setState({loading:!1,items:h.Aq.sortRepos(n,e.state.sortBy,e.state.sortOrder)})})).catch((function(t){e.setState({loading:!1,errorMsg:h.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this.props,t=e.inAllLibs,n=void 0!==t&&t,r=e.currentViewMode,o=void 0===r?tt.Tb:r;return(0,m.jsxs)(s.Fragment,{children:[n?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{className:"d-flex justify-content-between mt-3 py-1 ".concat(o==tt.Tb?"sf-border-bottom":""),children:[(0,m.jsxs)("h4",{className:"sf-heading m-0",children:[(0,m.jsx)("span",{className:"sf3-font-share-with-me sf3-font nav-icon","aria-hidden":"true"}),(0,f.AP)("Shared with me")]}),this.renderSortIconInMobile()]}),this.renderContent()]}):(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsxs)("div",{className:"cur-view-path",children:[(0,m.jsx)("h3",{className:"sf-heading m-0",children:(0,f.AP)("Shared with me")}),this.renderSortIconInMobile()]}),(0,m.jsx)("div",{className:"cur-view-content",children:this.renderContent()})]})}),this.state.isSortOptionsDialogOpen&&(0,m.jsx)(je,{toggleDialog:this.toggleSortOptionsDialog,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems})]})}}])}(s.Component),at=function(e){function t(){return(0,r.A)(this,t),(0,a.A)(this,t,arguments)}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,o=t.items,a=(0,m.jsx)($.A,{title:(0,f.AP)("No libraries have been shared with you"),text:(0,f.AP)("No libraries have been shared with you from other servers.")});if(n)return(0,m.jsx)(Z.A,{});if(r)return(0,m.jsx)("p",{className:"error text-center",children:r});var i=(0,m.jsxs)("table",{children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"4%"}),(0,m.jsx)("th",{width:"20%",children:(0,f.AP)("Name")}),(0,m.jsx)("th",{width:"20%",children:(0,f.AP)("Shared by")}),(0,m.jsx)("th",{width:"26%",children:(0,f.AP)("At server")}),(0,m.jsx)("th",{width:"20%",children:(0,f.AP)("Time")}),(0,m.jsx)("th",{width:"10%"})]})}),(0,m.jsx)("tbody",{children:o.map((function(t,n){return(0,m.jsx)(it,{item:t,leaveShare:e.props.leaveShare},n)}))})]});return o.length?i:a}}])}(s.Component),it=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).handleMouseOver=function(){n.setState({isOpIconShown:!0})},n.handleMouseOut=function(){n.setState({isOpIconShown:!1})},n.leaveShare=function(e){e.preventDefault(),n.props.leaveShare(n.props.item)},n.state={isOpIconShown:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.item,t=this.state.isOpIconShown;e.icon_url=h.Aq.getLibIconUrl(e),e.icon_title=h.Aq.getLibIconTitle(e);var n="".concat(f.Yc,"remote-library/").concat(this.props.item.provider_id,"/").concat(this.props.item.repo_id,"/").concat(h.Aq.encodePath(this.props.item.repo_name),"/");return(0,m.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:e.icon_url,title:e.icon_title,alt:e.icon_title,width:"24"})}),(0,m.jsx)("td",{children:(0,m.jsx)(c.N_,{to:n,children:e.repo_name})}),(0,m.jsx)("td",{children:e.from_user}),(0,m.jsx)("td",{children:e.from_server_url}),(0,m.jsx)("td",{title:K()(e.last_modified).format("llll"),children:K()(e.ctime).fromNow()}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"#",role:"button",className:"action-icon sf2-icon-x3 ".concat(t?"":"invisible"),title:(0,f.AP)("Leave Share"),"aria-label":(0,f.AP)("Leave Share"),onClick:this.leaveShare})})]})}}])}(s.Component),st=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).leaveShare=function(e){var t=e.id,r=e.repo_name;S.e.deleteOCMShareReceived(t).then((function(e){var o=n.state.items.filter((function(e){return e.id!=t}));n.setState({items:o}),E.A.success((0,f.AP)("Successfully unshared {name}").replace("{name}",r))})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.state={loading:!0,errorMsg:"",items:[]},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;S.e.listOCMSharesReceived().then((function(t){e.setState({loading:!1,items:t.data.ocm_share_received_list})})).catch((function(t){e.setState({loading:!1,errorMsg:h.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,m.jsx)(s.Fragment,{children:(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)("div",{className:"cur-view-path",children:(0,m.jsx)("h3",{className:"sf-heading m-0",children:(0,f.AP)("Shared from other servers")})}),(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsx)(at,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.items,leaveShare:this.leaveShare})})]})})})}}])}(s.Component),lt=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).getAllReceivedShares=function(){var e=S.e.server+"/ocm-via-webdav/received-shares/";S.e.req.get(e).then((function(e){n.setState({loading:!1,shareID:"",path:"",items:e.data.received_share_list})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.leaveShare=function(e){var t=e.id,r=e.name,o=S.e.server+"/ocm-via-webdav/received-shares/"+t+"/";S.e.req.delete(o).then((function(e){var o=n.state.items.filter((function(e){return e.id!=t}));n.setState({items:o}),E.A.success((0,f.AP)("Successfully unshared {name}").replace("{name}",r))})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.openFolder=function(e){n.setState({loading:!0});var t=S.e.server+"/ocm-via-webdav/received-shares/"+e.id+"/?path="+e.path;S.e.req.get(t).then((function(t){n.setState({loading:!1,shareID:e.id,path:t.data.parent_dir,items:t.data.received_share_list})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.onPathClick=function(e){n.setState({loading:!0});var t=S.e.server+"/ocm-via-webdav/received-shares/"+n.state.shareID+"/?path="+e;S.e.req.get(t).then((function(e){n.setState({loading:!1,items:e.data.received_share_list,path:e.data.parent_dir})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.state={loading:!0,shareID:"",path:"",items:[],errorMsg:""},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.getAllReceivedShares()}},{key:"render",value:function(){return(0,m.jsx)(s.Fragment,{children:(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)("div",{className:"cur-view-path align-items-center",children:(0,m.jsx)(dt,{shareID:this.state.shareID,currentPath:this.state.path,onPathClick:this.onPathClick,getAllReceivedShares:this.getAllReceivedShares})}),(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsx)(ct,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.items,path:this.state.path,leaveShare:this.leaveShare,openFolder:this.openFolder})})]})})})}}])}(s.Component),ct=function(e){function t(e){return(0,r.A)(this,t),(0,a.A)(this,t,[e])}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,o=t.items,a=t.path,i=(0,m.jsx)($.A,{title:(0,f.AP)("No libraries have been shared with you"),text:(0,f.AP)("No libraries have been shared with you from other servers.")});if(n)return(0,m.jsx)(Z.A,{});if(r)return(0,m.jsx)("p",{className:"error text-center",children:r});var s=(0,m.jsxs)("table",{children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"5%"}),(0,m.jsx)("th",{width:"30%",children:(0,f.AP)("Name")}),(0,m.jsx)("th",{width:"35%",children:(0,f.AP)("Shared By")}),(0,m.jsx)("th",{width:"20%",children:(0,f.AP)("Time")}),(0,m.jsx)("th",{width:"5%"}),(0,m.jsx)("th",{width:"5%"})]})}),(0,m.jsx)("tbody",{children:o.map((function(t,n){return(0,m.jsx)(ut,{item:t,path:a,leaveShare:e.props.leaveShare,openFolder:e.props.openFolder},n)}))})]});return o.length?s:i}}])}(s.Component),ut=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).handleMouseOver=function(){n.setState({isOpIconShown:!0})},n.handleMouseOut=function(){n.setState({isOpIconShown:!1})},n.downloadFile=function(){var e=f.Yc+"ocm-via-webdav/download-received-file/?share_id="+n.props.item.id+"&path="+n.props.item.path;window.location.href=e},n.leaveShare=function(e){e.preventDefault(),n.props.leaveShare(n.props.item)},n.openFolder=function(e){e.preventDefault(),n.props.openFolder(n.props.item)},n.state={isOpIconShown:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.item,t=this.state.isOpIconShown;return e.is_dir?e.icon_url=h.Aq.getFolderIconUrl():e.icon_url=h.Aq.getFileIconUrl(e.name),(0,m.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,children:[(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:e.icon_url,width:"24",alt:""})}),(0,m.jsx)("td",{children:e.is_dir?(0,m.jsx)("a",{href:"#",onClick:this.openFolder,children:e.name}):e.name}),(0,m.jsx)("td",{children:e.shared_by}),(0,m.jsx)("td",{title:K()(e.last_modified).format("llll"),children:K()(e.ctime).fromNow()}),(0,m.jsx)("td",{children:e.is_dir?"":(0,m.jsx)("a",{href:"#",className:"action-icon sf2-icon-download ".concat(t?"":"invisible"),title:(0,f.AP)("Download"),onClick:this.downloadFile})}),(0,m.jsx)("td",{children:this.props.path?"":(0,m.jsx)("a",{href:"#",className:"action-icon sf2-icon-x3 ".concat(t?"":"invisible"),title:(0,f.AP)("Leave Share"),onClick:this.leaveShare})})]})}}])}(s.Component),dt=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onPathClick=function(e){var t=h.Aq.getEventData(e,"path");n.props.onPathClick(t)},n.turnPathToLink=function(e){var t=(e=e.slice(1,e.length-1)).split("/"),r="";return t.map((function(e,o){return o===t.length-1?(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("span",{className:"path-split",children:"/"}),(0,m.jsx)("span",{className:"path-file-name",children:e})]},o):(0===o?r="/":r+=e+"/",(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("span",{className:"path-split",children:"/"}),(0,m.jsx)("a",{className:"path-link","data-path":r,onClick:n.onPathClick,children:e})]},o))}))},n.state={},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.turnPathToLink(this.props.currentPath);return(0,m.jsxs)("div",{className:"path-container",children:[(0,m.jsx)("a",{href:"#",onClick:this.props.getAllReceivedShares,children:(0,f.AP)("All")}),e]})}}])}(s.Component),pt=lt,ft=n(26910),ht=function(e){function t(){var e;(0,r.A)(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(e=(0,a.A)(this,t,[].concat(o))).onPathClick=function(t){var n=h.Aq.getEventData(t,"path");e.props.onPathClick(n)},e.turnPathToLink=function(t){var n=(t="/"===t[t.length-1]?t.slice(0,t.length-1):t).split("/"),r="";return n.map((function(t,o){return""===t?null:o===n.length-1?(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("span",{className:"path-split",children:"/"}),(0,m.jsx)("span",{className:"path-file-name",children:t})]},o):(r+="/"+t,(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("span",{className:"path-split",children:"/"}),(0,m.jsx)("a",{className:"path-link","data-path":r,onClick:e.onPathClick,children:t})]},o))}))},e}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.currentPath,r=t.repoName,o=this.turnPathToLink(n);return(0,m.jsxs)("div",{className:"path-container",children:[(0,m.jsx)(c.N_,{to:f.Yc+"shared-with-ocm/",className:"normal",onClick:function(t){return e.props.onTabNavClick("shared-with-ocm")},children:(0,f.AP)("All")}),(0,m.jsx)("span",{className:"path-split",children:"/"}),"/"===n||""===n?(0,m.jsx)("span",{className:"path-repo-name",children:r}):(0,m.jsx)("a",{className:"path-link","data-path":"/",onClick:this.onPathClick,children:r}),o]})}}])}(s.Component),mt=ht,gt=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).handleMouseOver=function(){n.setState({isOpIconShown:!0})},n.handleMouseOut=function(){n.setState({isOpIconShown:!1})},n.openFolder=function(){n.props.openFolder(n.props.dirent)},n.downloadDirent=function(e){e.preventDefault(),n.props.downloadDirent(n.props.dirent)},n.state={isOpIconShown:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.state.isOpIconShown,t=this.props.dirent,n=h.Aq.getDirentIcon(t);return(0,m.jsx)(s.Fragment,{children:(0,m.jsxs)("tr",{onMouseEnter:this.handleMouseOver,onMouseLeave:this.handleMouseOut,children:[(0,m.jsx)("td",{className:"text-center",children:(0,m.jsx)("img",{src:n,width:"24",alt:""})}),(0,m.jsx)("td",{children:t.is_file?t.name:(0,m.jsx)(c.N_,{to:"#",onClick:this.openFolder,children:t.name})}),(0,m.jsx)("td",{children:e&&t.is_file&&(0,m.jsx)("a",{href:"#",className:"op-icon sf3-font sf3-font-download1",title:(0,f.AP)("Download"),onClick:this.downloadDirent})}),(0,m.jsx)("td",{children:h.Aq.bytesToSize(t.size)}),(0,m.jsx)("td",{children:K()(t.mtime).fromNow()})]})})}}])}(s.Component),vt=function(e){function t(e){return(0,r.A)(this,t),(0,a.A)(this,t,[e])}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,o=t.direntList;return n?(0,m.jsx)(Z.A,{}):r?(0,m.jsx)("p",{className:"error text-center mt-4",children:r}):(0,m.jsx)(s.Fragment,{children:(0,m.jsxs)("table",{className:"table-hover",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"5%"}),(0,m.jsx)("th",{width:"55%",children:(0,f.AP)("Name")}),(0,m.jsx)("th",{width:"10%"}),(0,m.jsx)("th",{width:"15%",children:(0,f.AP)("Size")}),(0,m.jsx)("th",{width:"15%",children:(0,f.AP)("Last Update")})]})}),(0,m.jsx)("tbody",{children:o.map((function(t,n){return(0,m.jsx)(gt,{dirent:t,openFolder:e.props.openFolder,deleteDirent:e.props.deleteDirent,downloadDirent:e.props.downloadDirent},n)}))})]})})}}])}(s.Component),yt=function(){return(0,o.A)((function e(t){(0,r.A)(this,e),this.name=t.name,this.mtime=t.mtime,this.size=t.size,this.is_file="file"===t.type}),[{key:"isDir",value:function(){return!this.is_file}}])}(),Ct=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onPathClick=function(e){n.loadDirentList(e)},n.openFolder=function(e){var t=h.Aq.joinPath(n.state.path,e.name);e.is_file||n.loadDirentList(t)},n.loadDirentList=function(e){var t=n.props,r=t.providerID,o=t.repoID;S.e.listOCMRepoDir(r,o,e).then((function(t){var a=t.data,i=a.repo_name,s=a.dirent_list,l=a.user_perm,c=[];s.forEach((function(e){var t=new yt(e);c.push(t)})),n.setState({loading:!1,repoName:i,direntList:c,path:e,userPerm:l},(function(){var t="".concat(f.Yc,"remote-library/").concat(r,"/").concat(o,"/").concat(i).concat(h.Aq.encodePath(e));window.history.replaceState({url:t,path:e},e,t)}))})).catch((function(e){n.setState({loading:!1,errorMsg:h.Aq.getErrorMsg(e,!0)})}))},n.downloadDirent=function(e){var t=h.Aq.joinPath(n.state.path,e.name);S.e.getOCMRepoDownloadURL(n.props.providerID,n.props.repoID,t).then((function(e){location.href=e.data})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.openFileInput=function(){n.fileInput.current.click()},n.onFileInputChange=function(){if(n.fileInput.current.files.length){var e=n.fileInput.current.files[0],t=n.state.path,r=n.props,o=r.providerID,a=r.repoID;S.e.getOCMRepoUploadURL(o,a,t).then((function(r){var o=new FormData;o.append("parent_dir",t),o.append("file",e),ft.A.post(r.data,o).then((function(e){var t=e.data[0],r=new yt({type:"file",name:t.name,size:t.size,mtime:(new Date).getTime()}),o=n.state.direntList,a=o.filter((function(e){return!e.is_file}));o.splice(a.length,0,r),n.setState({direntList:o})}))})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))}},n.state={loading:!0,errorMsg:"",repoName:"",path:"",direntList:[],isNewFolderDialogOpen:!1,userPerm:""},n.fileInput=s.createRef(),n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.loadDirentList("/")}},{key:"render",value:function(){var e=this.state,t=e.loading,n=e.errorMsg,r=e.repoName,o=e.direntList,a=e.path,i=this.props.repoID;return(0,m.jsx)(s.Fragment,{children:(0,m.jsx)("div",{className:"main-panel-center flex-row",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)("div",{className:"cur-view-path align-items-center",children:(0,m.jsx)(mt,{repoID:i,repoName:r,currentPath:a,onPathClick:this.onPathClick,onTabNavClick:this.props.onTabNavClick})}),(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsx)(vt,{loading:t,errorMsg:n,direntList:o,openFolder:this.openFolder,deleteDirent:this.deleteDirent,downloadDirent:this.downloadDirent})})]})})})}}])}(s.Component),At=n(73606),xt=n(85267),bt=n(19247),_t=n(76152),wt=n(55627),St=n(76115),Dt=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).submit=function(){var e=n.state.keepDays;n.state.autoHistory&&(e=n.state.expireDays);var t=n.props.repoID;if(/^-?\d+$/.test(e)){var r=(0,f.AP)("Successfully set library history.");S.e.setRepoHistoryLimit(t,e).then((function(e){E.A.success(r),n.setState({keepDays:e.data.keep_days}),n.props.toggleDialog()})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))}else n.setState({errorInfo:(0,f.AP)("Please enter a non-negative integer")})},n.handleKeyDown=function(e){"Enter"===e.key&&(n.submit(),e.preventDefault())},n.onChange=function(e){var t=e.target.value;n.setState({keepDays:t,expireDays:t})},n.setLimitDays=function(e){"allHistory"===e?n.setState({keepDays:-1,disabled:!0}):"noHistory"===e?n.setState({keepDays:0,disabled:!0}):n.setState({disabled:!1}),n.setState({allHistory:"allHistory"===e,noHistory:"noHistory"===e,autoHistory:"autoHistory"===e})},n.state={keepDays:-1,expireDays:30,disabled:!0,allHistory:!0,noHistory:!1,autoHistory:!1,errorInfo:""},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;S.e.getRepoHistoryLimit(this.props.repoID).then((function(t){e.setState({keepDays:t.data.keep_days,allHistory:t.data.keep_days<0,noHistory:0===t.data.keep_days,autoHistory:t.data.keep_days>0,disabled:!(t.data.keep_days>0),expireDays:t.data.keep_days>0?t.data.keep_days:30})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))}},{key:"render",value:function(){var e=this,t=this.props.itemName,n=(0,f.AP)("{placeholder} History Setting");return n=n.replace("{placeholder}",'<span class="op-target text-truncate mx-1">'+h.Aq.HTMLescape(t)+"</span>"),(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.props.toggleDialog,children:[(0,m.jsx)(k.A,{toggle:this.props.toggleDialog,children:(0,m.jsx)("span",{dangerouslySetInnerHTML:{__html:n},className:"d-flex mw-100"})}),(0,m.jsx)(M.A,{children:(0,m.jsxs)(bt.A,{children:[!f.GF&&(0,m.jsx)(_t.A,{children:(0,m.jsx)(wt.A,{className:"error",children:(0,f.AP)("Setting library history is disabled by Admin.")})}),(0,m.jsxs)(_t.A,{check:!0,children:[(0,m.jsx)(I.A,{type:"radio",name:"radio1",checked:this.state.allHistory,disabled:!f.GF,onChange:function(){e.setLimitDays("allHistory")}})," ",(0,m.jsx)(wt.A,{children:(0,f.AP)("Keep full history")})]}),(0,m.jsxs)(_t.A,{check:!0,children:[(0,m.jsx)(I.A,{type:"radio",name:"radio1",checked:this.state.noHistory,disabled:!f.GF,onChange:function(){e.setLimitDays("noHistory")}})," ",(0,m.jsx)(wt.A,{children:(0,f.AP)("Don't keep history")})]}),(0,m.jsxs)(_t.A,{check:!0,children:[(0,m.jsx)(I.A,{type:"radio",name:"radio1",checked:this.state.autoHistory,disabled:!f.GF,onChange:function(){e.setLimitDays("autoHistory")}})," ",(0,m.jsx)(wt.A,{children:(0,f.AP)("Only keep a period of history:")}),(0,m.jsx)(I.A,{type:"text",className:"expire-input",value:this.state.expireDays,onChange:this.onChange,disabled:this.state.disabled,onKeyDown:this.handleKeyDown})," ",(0,m.jsx)(wt.A,{children:(0,m.jsx)("span",{children:(0,f.AP)("days")})})]}),this.state.errorInfo&&(0,m.jsx)(St.A,{color:"danger",children:this.state.errorInfo})]})}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(P.A,{color:"secondary",onClick:this.props.toggleDialog,children:(0,f.AP)("Cancel")}),(0,m.jsx)(P.A,{color:"primary",onClick:this.submit,children:(0,f.AP)("Submit")})]})]})}}])}(s.Component),Et=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).handleOldPasswordInputChange=function(e){n.setState({oldPassword:e.target.value})},n.handleNewPasswordInputChange=function(e){n.setState({newPassword:e.target.value})},n.handleNewPasswordAgainInputChange=function(e){n.setState({newPasswordAgain:e.target.value})},n.formSubmit=function(e){var t=n.state,r=t.oldPassword,o=t.newPassword,a=t.newPasswordAgain;return r?o?o.length<f.cT?(n.setState({errorMsg:(0,f.AP)("New password is too short")}),!1):a?o!=a?(n.setState({errorMsg:(0,f.AP)("New passwords don't match")}),!1):(n.setState({submitBtnDisabled:!0}),void S.e.changeEncryptedRepoPassword(n.props.repoID,r,o).then((function(){n.props.toggleDialog(),E.A.success((0,f.AP)("Successfully changed library password."))})).catch((function(e){var t=h.Aq.getErrorMsg(e);n.setState({errorMsg:t,submitBtnDisabled:!1})}))):(n.setState({errorMsg:(0,f.AP)("Please enter the new password again")}),!1):(n.setState({errorMsg:(0,f.AP)("Please enter a new password")}),!1):(n.setState({errorMsg:(0,f.AP)("Please enter the old password")}),!1)},n.state={oldPassword:"",newPassword:"",newPasswordAgain:"",submitBtnDisabled:!1,errorMsg:""},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.repoName,n=e.toggleDialog,r=(0,f.AP)("Change Password of Library {placeholder}");return r=r.replace("{placeholder}",'<span class="op-target text-truncate mx-1">'+h.Aq.HTMLescape(t)+"</span>"),(0,m.jsxs)(p.A,{isOpen:!0,style:{height:"auto"},toggle:n,children:[(0,m.jsx)(k.A,{toggle:n,children:(0,m.jsx)("span",{dangerouslySetInnerHTML:{__html:r},className:"d-flex mw-100"})}),(0,m.jsx)(M.A,{children:(0,m.jsxs)("form",{id:"repo-change-passwd-form",action:"",method:"post",children:[(0,m.jsx)("label",{htmlFor:"passwd",children:(0,f.AP)("Old Password")}),(0,m.jsx)("br",{}),(0,m.jsx)("input",{type:"password",name:"old_passwd",className:"form-control",id:"passwd",value:this.state.oldPassword,onChange:this.handleOldPasswordInputChange}),(0,m.jsx)("br",{}),(0,m.jsx)("label",{htmlFor:"new-passwd",children:(0,f.AP)("New Password")}),(0,m.jsx)("span",{className:"tip",children:(0,f.AP)("(at least {placeholder} characters)").replace("{placeholder}",f.cT)}),(0,m.jsx)("br",{}),(0,m.jsx)("input",{type:"password",name:"new_passwd",className:"form-control",id:"new-passwd",value:this.state.newPassword,onChange:this.handleNewPasswordInputChange}),(0,m.jsx)("br",{}),(0,m.jsx)("label",{htmlFor:"new-passwd-again",children:(0,f.AP)("New Password Again")}),(0,m.jsx)("br",{}),(0,m.jsx)("input",{type:"password",name:"new_passwd_again",className:"form-control",id:"new-passwd-again",value:this.state.newPasswordAgain,onChange:this.handleNewPasswordAgainInputChange}),(0,m.jsx)("br",{}),this.state.errorMsg&&(0,m.jsx)(St.A,{color:"danger",children:this.state.errorMsg})]})}),(0,m.jsx)(N.A,{children:(0,m.jsx)("button",{className:"btn btn-primary",disabled:this.state.submitBtnDisabled,onClick:this.formSubmit,children:(0,f.AP)("Submit")})})]})}}])}(s.Component),kt=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).state={errMessage:"",showLoading:!0,showSuccess:!1,showError:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;S.e.resetAndSendEncryptedRepoPassword(this.props.repoID).then((function(t){e.setState({showLoading:!1}),e.setState({showSuccess:!0})})).catch((function(t){t.response&&(e.setState({errMessage:t.response.data.error_msg}),e.setState({showLoading:!1}),e.setState({showError:!0}))}))}},{key:"render",value:function(){var e="<strong>"+f.bd+"</strong>",t=(0,f.AP)("New password has been sent to your email {mail}. Please check your mailbox. If you don\u2019t receive the password, please check if your email address is properly configured.").replace("{mail}",e);return(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.props.toggleDialog,children:[(0,m.jsx)(k.A,{toggle:this.props.toggleDialog,children:(0,f.AP)("Reset library password")}),(0,m.jsxs)(M.A,{children:[this.state.showLoading&&(0,m.jsx)("span",{children:(0,f.AP)("Sending new password...")}),this.state.showSuccess&&(0,m.jsx)("div",{dangerouslySetInnerHTML:{__html:t}}),this.state.showError&&(0,m.jsx)("span",{className:"err-message",children:this.state.errMessage})]})]})}}])}(s.Component),Mt=n(20015),It=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).handleInputChange=function(e){n.setState({inputValue:e})},n.formSubmit=function(){var e=n.state.inputValue;if(e&&e.length){n.setState({submitBtnDisabled:!0});var t=n.props,r=t.repoID,o=t.repoName,a=e.map((function(e,t){return e.value})).join(",");S.e.addNewRepoLabels(r,a).then((function(e){var t=(0,f.AP)("Successfully added label(s) for library {placeholder}").replace("{placeholder}",o);E.A.success(t),n.props.toggleDialog()})).catch((function(e){var t=h.Aq.getErrorMsg(e);n.setState({formErrorMsg:t,submitBtnDisabled:!1})}))}else n.setState({formErrorMsg:(0,f.AP)("It is required.")})},n.state={isLoading:!0,existingLabels:null,errorMsg:"",submitBtnDisabled:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;S.e.getAllRepoSnapshotLabels().then((function(t){e.setState({isLoading:!1,existingLabels:t.data,errorMsg:""})})).catch((function(t){var n=h.Aq.getErrorMsg(t);e.setState({isLoading:!1,errorMsg:n})}))}},{key:"render",value:function(){return(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.props.toggleDialog,children:[(0,m.jsx)(k.A,{toggle:this.props.toggleDialog,children:(0,f.AP)("Label Current State")}),(0,m.jsx)(M.A,{children:(0,m.jsx)(Nt,{data:this.state,handleChange:this.handleInputChange})}),this.state.existingLabels&&(0,m.jsxs)(N.A,{children:[(0,m.jsx)("button",{className:"btn btn-secondary",onClick:this.props.toggleDialog,children:(0,f.AP)("Cancel")}),(0,m.jsx)("button",{className:"btn btn-primary",disabled:this.state.submitBtnDisabled,onClick:this.formSubmit,children:(0,f.AP)("Submit")})]})]})}}])}(s.Component),Nt=function(e){function t(){return(0,r.A)(this,t),(0,a.A)(this,t,arguments)}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.data,t=e.isLoading,n=e.errorMsg,r=e.existingLabels,o=e.formErrorMsg;return t?(0,m.jsx)(Z.A,{}):n?(0,m.jsx)("p",{className:"error mt-4 text-center",children:n}):(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)(Mt.A,{isMulti:!0,onChange:this.props.handleChange,placeholder:"",options:r.map((function(e,t){return{label:e,value:e}}))}),o&&(0,m.jsx)("p",{className:"error m-0 mt-2",children:o})]})}}])}(s.Component),Pt=It,Tt=n(52308),Ot=n(8743),jt=n(36640),Rt=n(51445),Lt=n(52088),Ft=n(48918),Ut=n(30038),Yt=n(94988),Bt=n(50022),Ht=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onMouseEnter=function(){n.setState({isOperationShow:!0})},n.onMouseLeave=function(){n.setState({isOperationShow:!1})},n.deleteUserFolderPermission=function(){var e=n.props.item;n.props.deleteUserFolderPermission(e)},n.onChangeUserFolderPerm=function(e){var t=n.props.item;n.props.onChangeUserFolderPerm(t.repo_id,e,t.folder_path,t.user_email)},n.state={isOperationShow:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.item,t=e.permission;return(0,m.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onFocus:this.onMouseEnter,children:[(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"".concat(f.Yc,"profile/").concat(encodeURIComponent(e.user_email),"/"),target:"_blank",rel:"noreferrer",children:e.user_name})}),this.props.showPath&&(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"".concat(f.Yc,"library/").concat(e.repo_id,"/").concat(h.Aq.encodePath(this.props.repoName+e.folder_path)),children:e.folder_name})}),(0,m.jsx)("td",{children:(0,m.jsx)(xe.A,{isTextMode:!0,autoFocus:!0,isEditIconShow:this.state.isOperationShow,currentPermission:t,permissions:this.props.permissions,onPermissionChanged:this.onChangeUserFolderPerm})}),(0,m.jsx)("td",{children:(0,m.jsx)("span",{tabIndex:"0",role:"button",className:"sf2-icon-x3 action-icon ".concat(this.state.isOperationShow?"":"hide"),onClick:this.deleteUserFolderPermission,onKeyDown:h.Aq.onKeyDown,title:(0,f.AP)("Delete"),"aria-label":(0,f.AP)("Delete")})})]})}}])}(s.Component),Vt=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).handleUserSelectChange=function(e){n.setState({selectedUsers:e})},n.setPermission=function(e){n.setState({permission:e})},n.addUserFolderPerm=function(){var e=n.state.selectedUsers,t=n.props.folderPath||n.state.folderPath;if(!e||!e.length||!t)return!1;var r=e.map((function(e,t){return e.email}));(n.props.isDepartmentRepo?S.e.addDepartmentRepoUserFolderPerm(n.props.repoID,n.state.permission,t,r):S.e.addUserFolderPerm(n.props.repoID,n.state.permission,t,r)).then((function(e){var t=[];if(e.data.failed.length>0)for(var r=0;r<e.data.failed.length;r++)t[r]=e.data.failed[r];n.setState({errorMsg:t,userFolderPermItems:n.state.userFolderPermItems.concat(e.data.success),selectedUsers:null,permission:"rw",folderPath:""}),n.refs.userSelect.clearSelect()})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.deleteUserFolderPermItem=function(e){(n.props.isDepartmentRepo?S.e.deleteDepartmentRepoUserFolderPerm(e.repo_id,e.permission,e.folder_path,e.user_email):S.e.deleteUserFolderPerm(e.repo_id,e.permission,e.folder_path,e.user_email)).then((function(t){n.setState({userFolderPermItems:n.state.userFolderPermItems.filter((function(t){return t!=e}))})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.onChangeUserFolderPerm=function(e,t,r,o){(n.props.isDepartmentRepo?S.e.updateDepartmentRepoUserFolderPerm(e,t,r,o):S.e.updateUserFolderPerm(e,t,r,o)).then((function(e){var a=n.state.userFolderPermItems.map((function(e){return e.user_email===o&&e.folder_path===r&&(e.permission=t),e}));n.setState({userFolderPermItems:a})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.onSetSubFolder=function(e){n.setState({folderPath:e.target.value})},n.toggleFileChooser=function(){n.setState({showFileChooser:!n.state.showFileChooser,folderPath:""})},n.toggleSubFolder=function(e,t,r){n.setState({folderPath:t})},n.handleFileChooserSubmit=function(){n.setState({folderPath:n.state.folderPath||"/",showFileChooser:!n.state.showFileChooser})},n.onRepoItemClick=function(){n.setState({folderPath:"/"})},n.state={selectedUsers:null,errorMsg:[],permission:"rw",userFolderPermItems:[],folderPath:"",showFileChooser:!1},f.am?n.permissions=["r","rw","cloud-edit","preview","invisible"]:n.permissions=["r","rw"],n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.repoID,r=t.folderPath;(t.isDepartmentRepo?S.e.listDepartmentRepoUserFolderPerm(n,r):S.e.listUserFolderPerm(n,r)).then((function(t){0!==t.data.length&&e.setState({userFolderPermItems:t.data})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))}},{key:"render",value:function(){var e=this,t=!this.props.folderPath,n=this.state.userFolderPermItems;if(this.state.showFileChooser)return(0,m.jsxs)("div",{children:[(0,m.jsx)(Bt.A,{repoID:this.props.repoID,mode:"only_current_library",onDirentItemClick:this.toggleSubFolder,onRepoItemClick:this.onRepoItemClick}),(0,m.jsxs)("div",{className:"modal-footer",children:[(0,m.jsx)(P.A,{color:"secondary",onClick:this.toggleFileChooser,children:(0,f.AP)("Cancel")}),(0,m.jsx)(P.A,{color:"primary",onClick:this.handleFileChooserSubmit,children:(0,f.AP)("Submit")})]})]});var r=(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:t?"32%":"55%",children:(0,f.AP)("User")}),t&&(0,m.jsx)("th",{width:"32%",children:(0,f.AP)("Folder")}),(0,m.jsx)("th",{width:t?"24%":"30%",children:(0,f.AP)("Permission")}),(0,m.jsx)("th",{width:t?"12%":"15%"})]})});return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsxs)("table",{className:"w-xs-250",children:[r,(0,m.jsxs)("tbody",{children:[(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{children:(0,m.jsx)(Yt.A,{ref:"userSelect",isMulti:!0,placeholder:(0,f.AP)("Search users"),onSelectChange:this.handleUserSelectChange,value:this.state.selectedUsers})}),t&&(0,m.jsx)("td",{children:(0,m.jsxs)(Ft.A,{children:[(0,m.jsx)(I.A,{value:this.state.folderPath,onChange:this.onSetSubFolder}),(0,m.jsx)(Ut.A,{addonType:"append",children:(0,m.jsx)(P.A,{className:"sf2-icon-plus",onClick:this.toggleFileChooser})})]})}),(0,m.jsx)("td",{children:(0,m.jsx)(xe.A,{isTextMode:!1,isEditIconShow:!1,currentPermission:this.state.permission,permissions:this.permissions,onPermissionChanged:this.setPermission})}),(0,m.jsx)("td",{children:(0,m.jsx)(P.A,{color:"primary",onClick:this.addUserFolderPerm,children:(0,f.AP)("Submit")})})]}),this.state.errorMsg.length>0&&this.state.errorMsg.map((function(e,t){var n="";return n=e.user_email?e.user_email+": "+e.error_msg:e,(0,m.jsx)("tr",{children:(0,m.jsx)("td",{colSpan:3,children:(0,m.jsx)("p",{className:"error",children:n})})},t)}))]})]}),(0,m.jsx)("div",{className:"share-list-container",children:(0,m.jsxs)("table",{className:"table-thead-hidden w-xs-250",children:[r,(0,m.jsx)("tbody",{children:n.map((function(n,r){return(0,m.jsx)(Ht,{item:n,permissions:e.permissions,deleteUserFolderPermission:e.deleteUserFolderPermItem,onChangeUserFolderPerm:e.onChangeUserFolderPerm,showPath:t,repoName:e.props.repoName},r)}))})]})})]})}}])}(s.Component),Gt=Vt,qt=n(76229),zt=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onMouseEnter=function(){n.setState({isOperationShow:!0})},n.onMouseLeave=function(){n.setState({isOperationShow:!1})},n.deleteGroupPermissionItem=function(){var e=n.props.item;n.props.deleteGroupPermissionItem(e)},n.onChangeGroupPermission=function(e){var t=n.props.item;n.props.onChangeGroupPermission(t,e)},n.state={isOperationShow:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.item;return(0,m.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onFocus:this.onMouseEnter,children:[(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"".concat(f.Yc,"group/").concat(e.group_id,"/"),target:"_blank",rel:"noreferrer",children:e.group_name})}),this.props.showPath&&(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"".concat(f.Yc,"library/").concat(e.repo_id,"/").concat(h.Aq.encodePath(this.props.repoName+e.folder_path)),children:e.folder_name})}),(0,m.jsx)("td",{children:(0,m.jsx)(xe.A,{isTextMode:!0,autoFocus:!0,isEditIconShow:this.state.isOperationShow,currentPermission:e.permission,permissions:this.props.permissions,onPermissionChanged:this.onChangeGroupPermission})}),(0,m.jsx)("td",{children:(0,m.jsx)("span",{tabIndex:"0",role:"button",className:"sf2-icon-x3 action-icon ".concat(this.state.isOperationShow?"":"hide"),onClick:this.deleteGroupPermissionItem,onKeyDown:h.Aq.onKeyDown,title:(0,f.AP)("Delete"),"aria-label":(0,f.AP)("Delete")})})]})}}])}(s.Component),Wt=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).handleSelectChange=function(e){n.setState({selectedOption:e})},n.loadOptions=function(){S.e.shareableGroups().then((function(e){n.options=e.data.map((function(e,t){return{id:e.id,label:e.name,value:e.name}}))})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.listGroupPermissionItems=function(){var e=n.props,t=e.isDepartmentRepo,r=e.repoID,o=e.folderPath;(t?S.e.listDepartmentRepoGroupFolderPerm(r,o):S.e.listGroupFolderPerm(r,o)).then((function(e){0!==e.data.length&&n.setState({groupPermissionItems:e.data})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.setPermission=function(e){n.setState({permission:e})},n.addGroupFolderPerm=function(){var e=n.state.selectedOption,t=n.props.folderPath||n.state.folderPath;if(!e||!t)return!1;(n.props.isDepartmentRepo?S.e.addDepartmentRepoGroupFolderPerm(n.props.repoID,n.state.permission,t,e.id):S.e.addGroupFolderPerm(n.props.repoID,n.state.permission,t,e.id)).then((function(e){var t=[];if(e.data.failed.length>0)for(var r=0;r<e.data.failed.length;r++)t[r]=e.data.failed[r];n.setState({errorMsg:t,groupPermissionItems:n.state.groupPermissionItems.concat(e.data.success),selectedOption:null,permission:"rw",folderPath:""})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.deleteGroupPermissionItem=function(e){(n.props.isDepartmentRepo?S.e.deleteDepartmentRepoGroupFolderPerm(e.repo_id,e.permission,e.folder_path,e.group_id):S.e.deleteGroupFolderPerm(e.repo_id,e.permission,e.folder_path,e.group_id)).then((function(){n.setState({groupPermissionItems:n.state.groupPermissionItems.filter((function(t){return t!=e}))})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.onChangeGroupPermission=function(e,t){(n.props.isDepartmentRepo?S.e.updateDepartmentRepoGroupFolderPerm(e.repo_id,t,e.folder_path,e.group_id):S.e.updateGroupFolderPerm(e.repo_id,t,e.folder_path,e.group_id)).then((function(){n.updateGroupPermission(e,t)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.updateGroupPermission=function(e,t){var r=e.group_id,o=n.state.groupPermissionItems.map((function(n){var o=n.group_id;return r===o&&e.folder_path===n.folder_path&&(n.permission=t),n}));n.setState({groupPermissionItems:o})},n.onSetSubFolder=function(e){n.setState({folderPath:e.target.value})},n.toggleFileChooser=function(){n.setState({showFileChooser:!n.state.showFileChooser,folderPath:""})},n.toggleSubFolder=function(e,t,r){n.setState({folderPath:t})},n.handleSubmit=function(){n.setState({folderPath:n.state.folderPath||"/",showFileChooser:!n.state.showFileChooser})},n.onRepoItemClick=function(){n.setState({folderPath:"/"})},n.state={selectedOption:null,errorMsg:[],permission:"rw",groupPermissionItems:[],folderPath:"",showFileChooser:!1},n.options=[],f.am?n.permissions=["r","rw","cloud-edit","preview","invisible"]:n.permissions=["r","rw"],n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.loadOptions(),this.listGroupPermissionItems()}},{key:"render",value:function(){var e=this,t=!this.props.folderPath;if(this.state.showFileChooser)return(0,m.jsxs)("div",{children:[(0,m.jsx)(Bt.A,{repoID:this.props.repoID,mode:"only_current_library",onDirentItemClick:this.toggleSubFolder,onRepoItemClick:this.onRepoItemClick}),(0,m.jsxs)("div",{className:"modal-footer",children:[(0,m.jsx)(P.A,{color:"secondary",onClick:this.toggleFileChooser,children:(0,f.AP)("Cancel")}),(0,m.jsx)(P.A,{color:"primary",onClick:this.handleSubmit,children:(0,f.AP)("Submit")})]})]});var n=(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:t?"32%":"55%",children:(0,f.AP)("Group")}),t&&(0,m.jsx)("th",{width:"32%",children:(0,f.AP)("Folder")}),(0,m.jsx)("th",{width:t?"24%":"30%",children:(0,f.AP)("Permission")}),(0,m.jsx)("th",{width:t?"12%":"15%"})]})});return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsxs)("table",{className:"w-xs-250",children:[n,(0,m.jsxs)("tbody",{children:[(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{children:(0,m.jsx)(qt.by,{onChange:this.handleSelectChange,options:this.options,placeholder:(0,f.AP)("Select a group"),maxMenuHeight:200,value:this.state.selectedOption,components:{NoOptionsMessage:qt.iI}})}),t&&(0,m.jsx)("td",{children:(0,m.jsxs)(Ft.A,{children:[(0,m.jsx)(I.A,{value:this.state.folderPath,onChange:this.onSetSubFolder}),(0,m.jsx)(Ut.A,{addonType:"append",children:(0,m.jsx)(P.A,{className:"sf2-icon-plus",onClick:this.toggleFileChooser})})]})}),(0,m.jsx)("td",{children:(0,m.jsx)(xe.A,{isTextMode:!1,isEditIconShow:!1,currentPermission:this.state.permission,permissions:this.permissions,onPermissionChanged:this.setPermission})}),(0,m.jsx)("td",{children:(0,m.jsx)(P.A,{color:"primary",onClick:this.addGroupFolderPerm,children:(0,f.AP)("Submit")})})]}),this.state.errorMsg.length>0&&this.state.errorMsg.map((function(e,t){var n=e.group_id+": "+e.error_msg;return(0,m.jsx)("tr",{children:(0,m.jsx)("td",{colSpan:3,children:(0,m.jsx)("p",{className:"error",children:n})})},t)}))]})]}),(0,m.jsx)("div",{className:"share-list-container",children:(0,m.jsxs)("table",{className:"table-thead-hidden w-xs-250",children:[n,(0,m.jsx)("tbody",{children:this.state.groupPermissionItems.map((function(n,r){return(0,m.jsx)(zt,{item:n,permissions:e.permissions,deleteGroupPermissionItem:e.deleteGroupPermissionItem,onChangeGroupPermission:e.onChangeGroupPermission,showPath:t,repoName:e.props.repoName},r)}))})]})})]})}}])}(s.Component),Kt=Wt,Zt=(n(59625),function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).toggle=function(e){n.state.activeTab!==e&&n.setState({activeTab:e})},n.renderContent=function(){var e=n.state.activeTab;return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("div",{className:"share-dialog-side",children:(0,m.jsxs)(Tt.A,{pills:!0,children:[(0,m.jsx)(Ot.A,{role:"tab","aria-selected":"userPermission"===e,"aria-controls":"user-perm-panel",children:(0,m.jsx)(jt.A,{className:"userPermission"===e?"active":"",onClick:n.toggle.bind(n,"userPermission"),tabIndex:"0",onKeyDown:h.Aq.onKeyDown,children:(0,f.AP)("User Permission")})}),(0,m.jsx)(Ot.A,{role:"tab","aria-selected":"groupPermission"===e,"aria-controls":"group-perm-panel",children:(0,m.jsx)(jt.A,{className:"groupPermission"===e?"active":"",onClick:n.toggle.bind(n,"groupPermission"),tabIndex:"0",onKeyDown:h.Aq.onKeyDown,children:(0,f.AP)("Group Permission")})})]})}),(0,m.jsx)("div",{className:"share-dialog-main",children:(0,m.jsxs)(Rt.A,{activeTab:n.state.activeTab,children:[(0,m.jsx)(Lt.A,{tabId:"userPermission",role:"tabpanel",id:"user-perm-panel",children:(0,m.jsx)(Gt,{repoID:n.props.repoID,repoName:n.props.repoName,folderPath:n.props.folderPath,isDepartmentRepo:n.props.isDepartmentRepo})}),(0,m.jsx)(Lt.A,{tabId:"groupPermission",role:"tabpanel",id:"group-perm-panel",children:(0,m.jsx)(Kt,{repoID:n.props.repoID,repoName:n.props.repoName,folderPath:n.props.folderPath,isDepartmentRepo:n.props.isDepartmentRepo})})]})})]})},n.state={activeTab:"userPermission"},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.repoName,n=e.folderName,r=t?(0,f.AP)("{placeholder} Folder Permission"):(0,f.AP)("Set permission of {placeholder}");return r=r.replace("{placeholder}",'<span class="op-target text-truncate mx-1">'+h.Aq.HTMLescape(t||n)+"</span>"),(0,m.jsx)("div",{children:(0,m.jsxs)(p.A,{isOpen:!0,style:{maxWidth:"980px"},className:"share-dialog",toggle:this.props.toggleDialog,children:[(0,m.jsx)(k.A,{toggle:this.props.toggleDialog,children:(0,m.jsx)("span",{dangerouslySetInnerHTML:{__html:r},className:"d-flex mw-100"})}),(0,m.jsx)(M.A,{className:"dialog-list-container share-dialog-content",role:"tablist",children:this.renderContent()})]})})}}])}(s.Component)),Xt=n(86274),$t=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onMenuItemClick=function(e){var t=h.Aq.getEventData(e,"toggle");n.props.onMenuItemClick(t)},n.onMenuItemKeyDown=function(e){"Enter"!=e.key&&"Space"!=e.key||n.onMenuItemClick(e)},n.onDropdownToggleClick=function(e){n.toggleOperationMenu(e)},n.onDropdownToggleKeyDown=function(e){"Enter"!=e.key&&"Space"!=e.key||n.onDropdownToggleClick(e)},n.toggleOperationMenu=function(e){var t=e.target?e.target.dataset:null;t&&t.toggle&&"Rename"===t.toggle?n.setState({isItemMenuShow:!n.state.isItemMenuShow}):n.setState({isItemMenuShow:!n.state.isItemMenuShow},(function(){n.state.isItemMenuShow?n.props.onFreezedItem():n.props.onUnfreezedItem()}))},n.toggleAdvancedMenuShown=function(e){n.setState({isAdvancedMenuShown:!0})},n.toggleAdvancedMenu=function(e){e.stopPropagation(),n.setState({isAdvancedMenuShown:!n.state.isAdvancedMenuShown},(function(){n.toggleOperationMenu(e)}))},n.onDropDownMouseMove=function(e){n.state.isAdvancedMenuShown&&e.target&&"dropdown-item"===e.target.className&&n.setState({isAdvancedMenuShown:!1})},n.generatorOperations=function(){var e=n.props.repo,t=f.am&&e.encrypted&&f.ez&&f.bw,r=["Rename","Transfer"];if(f.wR&&r.push("Folder Permission"),r.push("Share Admin","Divider"),e.encrypted&&r.push("Change Password"),t&&r.push("Reset Password"),f.am){var o=e.monitored?"Unwatch File Changes":"Watch File Changes";r.push(o)}r.push("Divider","History Setting","Advanced");for(var a=0;a<r.length;a++)"Divider"===r[a]&&"Divider"===r[a+1]&&(r.splice(a,1),a--);return r},n.getAdvancedOperations=function(){var e=[];return e.push("API Token"),n.props.isPC&&f.gj&&e.push("Label Current State"),f.if&&e.push("Old Files Auto Delete"),e},n.translateOperations=function(e){var t="";switch(e){case"Star":t=(0,f.AP)("Star");break;case"Unstar":t=(0,f.AP)("Unstar");break;case"Share":t=(0,f.AP)("Share");break;case"Delete":t=(0,f.AP)("Delete");break;case"Rename":t=(0,f.AP)("Rename");break;case"Transfer":t=(0,f.AP)("Transfer");break;case"History Setting":t=(0,f.AP)("History Setting");break;case"Change Password":t=(0,f.AP)("Change Password");break;case"Reset Password":t=(0,f.AP)("Reset Password");break;case"Watch File Changes":t=(0,f.AP)("Watch File Changes");break;case"Unwatch File Changes":t=(0,f.AP)("Unwatch File Changes");break;case"Folder Permission":t=(0,f.AP)("Folder Permission");break;case"Label Current State":t=(0,f.AP)("Label Current State");break;case"API Token":t="API Token";break;case"Share Admin":t=(0,f.AP)("Share Admin");break;case"Old Files Auto Delete":t=(0,f.AP)("Auto Deletion Setting");break;case"Advanced":t=(0,f.AP)("Advanced");break;case"SeaTable integration":t=(0,f.AP)("SeaTable integration")}return t},n.state={isItemMenuShow:!1,isAdvancedMenuShown:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.generatorOperations(),n=this.getAdvancedOperations();return this.props.isPC?(0,m.jsxs)(ue.A,{isOpen:this.state.isItemMenuShow,toggle:this.toggleOperationMenu,children:[(0,m.jsx)(de.A,{tag:"i",role:"button",tabIndex:"0",className:"sf-dropdown-toggle sf3-font-more sf3-font",title:(0,f.AP)("More operations"),"aria-label":(0,f.AP)("More operations"),onClick:this.onDropdownToggleClick,onKeyDown:this.onDropdownToggleKeyDown,"data-toggle":"dropdown"}),(0,m.jsx)(Fe.A,{onMouseMove:this.onDropDownMouseMove,children:t.map((function(t,r){return"Divider"==t?(0,m.jsx)(pe.A,{divider:!0},r):"Advanced"==t?(0,m.jsxs)(ue.A,{direction:"right",className:"w-100",isOpen:e.state.isAdvancedMenuShown,toggle:e.toggleAdvancedMenu,onMouseMove:function(e){e.stopPropagation()},children:[(0,m.jsxs)(de.A,{className:"dropdown-item font-weight-normal rounded-0 d-flex justify-content-between align-items-center pr-2",onMouseEnter:e.toggleAdvancedMenuShown,children:[e.translateOperations(t),(0,m.jsx)("i",{className:"sf3-font-down sf3-font rotate-270"})]}),(0,m.jsx)(Fe.A,{children:n.map((function(t,n){return(0,m.jsx)(pe.A,{"data-toggle":t,onClick:e.onMenuItemClick,onKeyDown:e.onMenuItemKeyDown,children:e.translateOperations(t)},n)}))})]},r):(0,m.jsx)(pe.A,{"data-toggle":t,onClick:e.onMenuItemClick,onKeyDown:e.onMenuItemKeyDown,children:e.translateOperations(t)},r)}))})]}):(t.pop(),t.unshift("Delete"),t.unshift("Share"),this.props.isStarred?t.unshift("Unstar"):t.unshift("Star"),(0,m.jsxs)(ue.A,{isOpen:this.state.isItemMenuShow,toggle:this.toggleOperationMenu,children:[(0,m.jsx)(de.A,{tag:"i",className:"sf-dropdown-toggle sf3-font sf3-font-more-vertical ml-0",title:(0,f.AP)("More operations"),"aria-label":(0,f.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isItemMenuShow}),(0,m.jsxs)("div",{className:"".concat(this.state.isItemMenuShow?"":"d-none"),onClick:this.toggleOperationMenu,children:[(0,m.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),(0,m.jsx)("div",{className:"mobile-operation-menu",children:t.map((function(t,n){return"Divider"!=t?(0,m.jsx)(pe.A,{className:"mobile-menu-item","data-toggle":t,onClick:e.onMenuItemClick,children:e.translateOperations(t)},n):null}))})]})]}))}}])}(s.Component),Jt=$t,Qt=n(45613),en=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onHideSelect=function(){n.setState({isEditing:!1})},n.onEditPermission=function(e){e.nativeEvent.stopImmediatePropagation(),n.setState({isEditing:!0})},n.onPermissionChanged=function(e){e.value!==n.props.currentPermission&&n.props.onPermissionChanged(e.value),n.setState({isEditing:!1})},n.onSelectHandler=function(e){e.nativeEvent.stopImmediatePropagation()},n.state={isEditing:!1},n.options=[{value:"rw",label:(0,m.jsx)("div",{children:(0,f.AP)("Read-Write")})},{value:"r",label:(0,m.jsx)("div",{children:(0,f.AP)("Read-Only")})}],n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.onHideSelect)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.onHideSelect)}},{key:"render",value:function(){var e=this.props,t=e.currentPermission,n=e.isTextMode,r="rw"===t?(0,f.AP)("Read-Write"):(0,f.AP)("Read-Only");return(0,m.jsx)("div",{onClick:this.onSelectHandler,children:n&&!this.state.isEditing?(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("span",{children:r}),this.props.isEditIconShow&&(0,m.jsx)(Qt.A,{title:(0,f.AP)("Edit"),className:"sf3-font sf3-font-rename attr-action-icon",op:this.onEditPermission})]}):(0,m.jsx)(qt.by,{options:this.options,placeholder:r,onChange:this.onPermissionChanged,captureMenuScroll:!1,value:this.options.find((function(e){return e.value===t}))||null})})}}])}(s.Component),tn=n(67243),nn=n.n(tn),rn=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onMouseEnter=function(){n.setState({isOperationShow:!0})},n.onMouseLeave=function(){n.setState({isOperationShow:!1})},n.onDeleteAPIToken=function(){n.props.deleteAPIToken(n.props.item.app_name)},n.onUpdateAPIToken=function(e){n.props.updateAPIToken(n.props.item.app_name,e)},n.onCopyAPIToken=function(){var e=n.props.item.api_token;nn()(e),E.A.success((0,f.AP)("API token is copied to the clipboard."))},n.state={isOperationShow:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.item;return(0,m.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,tabIndex:"0",onFocus:this.onMouseEnter,children:[(0,m.jsx)("td",{className:"name",children:e.app_name}),(0,m.jsx)("td",{children:(0,m.jsx)(en,{isTextMode:!0,isEditIconShow:this.state.isOperationShow,currentPermission:e.permission,onPermissionChanged:this.onUpdateAPIToken})}),(0,m.jsxs)("td",{children:[(0,m.jsx)("span",{children:e.api_token}),this.state.isOperationShow&&(0,m.jsx)(Qt.A,{className:"action-icon sf3-font sf3-font-copy1",op:this.onCopyAPIToken,title:(0,f.AP)("Copy")})]}),(0,m.jsx)("td",{children:(0,m.jsx)(Qt.A,{className:"sf2-icon-x3 action-icon ".concat(this.state.isOperationShow?"":"hide"),op:this.onDeleteAPIToken,title:(0,f.AP)("Delete")})})]})}}])}(s.Component),on=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).listAPITokens=function(){S.e.listRepoAPITokens(n.repo.repo_id).then((function(e){n.setState({apiTokenList:e.data.repo_api_tokens,loading:!1})})).catch((function(e){403===e.response.status?n.setState({errorMsg:(0,f.AP)("Permission denied")}):n.handleError(e)}))},n.onInputChange=function(e){var t=e.target.value;n.setState({appName:t})},n.onKeyDown=function(e){13===e.keyCode&&(e.preventDefault(),n.addAPIToken())},n.setPermission=function(e){n.setState({permission:e})},n.addAPIToken=function(){if(n.state.appName){n.setState({isSubmitBtnActive:!1});var e=n.state,t=e.appName,r=e.permission,o=e.apiTokenList;S.e.addRepoAPIToken(n.repo.repo_id,t,r).then((function(e){o.push(e.data),n.setState({apiTokenList:o,isSubmitBtnActive:!0})})).catch((function(e){n.handleError(e),n.setState({isSubmitBtnActive:!0})}))}},n.deleteAPIToken=function(e){S.e.deleteRepoAPIToken(n.repo.repo_id,e).then((function(t){var r=n.state.apiTokenList.filter((function(t){return t.app_name!==e}));n.setState({apiTokenList:r})})).catch((function(e){n.handleError(e)}))},n.updateAPIToken=function(e,t){S.e.updateRepoAPIToken(n.repo.repo_id,e,t).then((function(r){var o=n.state.apiTokenList.filter((function(n){return n.app_name===e&&(n.permission=t),n}));n.setState({apiTokenList:o})})).catch((function(e){n.handleError(e)}))},n.handleError=function(e){e.response?E.A.danger(e.response.data.error_msg||e.response.data.detail||(0,f.AP)("Error"),{duration:3}):E.A.danger((0,f.AP)("Please check the network."),{duration:3})},n.renderContent=function(){var e=n.state.apiTokenList.map((function(e,t){return(0,m.jsx)(rn,{item:e,deleteAPIToken:n.deleteAPIToken,updateAPIToken:n.updateAPIToken},t)})),t=(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"20%",children:(0,f.AP)("App Name")}),(0,m.jsx)("th",{width:"20%",children:(0,f.AP)("Permission")}),(0,m.jsx)("th",{width:"48%",children:"API Token"}),(0,m.jsx)("th",{width:"12%"})]})});return(0,m.jsxs)(s.Fragment,{children:[n.state.errorMsg&&(0,m.jsx)("p",{className:"error text-center",children:n.state.errorMsg}),!n.state.errorMsg&&(0,m.jsxs)(s.Fragment,{children:[(0,m.jsxs)("table",{className:"w-xs-250",children:[t,(0,m.jsx)("tbody",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{children:(0,m.jsx)(I.A,{type:"text",id:"appName",value:n.state.appName,onChange:n.onInputChange,onKeyDown:n.onKeyDown})}),(0,m.jsx)("td",{children:(0,m.jsx)(en,{isTextMode:!1,isEditIconShow:!1,currentPermission:n.state.permission,onPermissionChanged:n.setPermission})}),(0,m.jsx)("td",{children:(0,m.jsx)("span",{className:"text-secondary",children:"--"})}),(0,m.jsx)("td",{children:(0,m.jsx)(P.A,{color:"primary",onClick:n.addAPIToken,disabled:!n.state.isSubmitBtnActive,children:(0,f.AP)("Submit")})})]})})]}),(0,m.jsx)("div",{style:{minHeight:"10rem",maxHeight:"18rem"},children:0!==n.state.apiTokenList.length&&(0,m.jsxs)("table",{className:"table-thead-hidden w-xs-250",children:[t,(0,m.jsx)("tbody",{children:e})]})}),n.state.loading&&(0,m.jsx)(Z.A,{})]})]})},n.state={apiTokenList:[],permission:"rw",appName:"",errorMsg:"",loading:!0,isSubmitBtnActive:!0},n.repo=n.props.repo,n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.listAPITokens()}},{key:"render",value:function(){var e=this.repo,t='<span class="op-target text-truncate mr-1">'+h.Aq.HTMLescape(e.repo_name)+"</span>",n=(0,f.AP)("{placeholder} API Token").replace("{placeholder}",t);return(0,m.jsxs)(p.A,{isOpen:!0,style:{maxWidth:"800px"},toggle:this.props.onRepoAPITokenToggle,children:[(0,m.jsx)(k.A,{toggle:this.props.onRepoAPITokenToggle,children:(0,m.jsx)("span",{dangerouslySetInnerHTML:{__html:n},className:"d-flex mw-100"})}),(0,m.jsx)(M.A,{children:(0,m.jsx)("div",{className:"o-auto",children:this.renderContent()})})]})}}])}(s.Component),an=function(){return(0,o.A)((function e(){(0,r.A)(this,e)}),[{key:"init",value:function(e){var t=e.server,n=e.username,r=e.password,o=e.token;return this.server=t,this.username=n,this.password=r,this.token=o,this.token&&this.server&&(this.req=ft.A.create({baseURL:this.server,headers:{Authorization:"Token "+this.token}})),this}},{key:"initForSeahubUsage",value:function(e){var t=e.siteRoot,n=e.xcsrfHeaders;if(t&&"/"===t.charAt(t.length-1)){var r=t.substring(0,t.length-1);this.server=r}else this.server=t;return this.req=ft.A.create({headers:{"X-CSRFToken":n}}),this}},{key:"_sendPostRequest",value:function(e,t){return t.getHeaders?this.req.post(e,t,{headers:t.getHeaders()}):this.req.post(e,t)}},{key:"listRepoShareLinks",value:function(e,t,n){var r=this.server+"/api/v2.1/repos/"+e+"/share-links/",o={page:t||1,per_page:n||25};return this.req.get(r,{params:o})}},{key:"listRepoUploadLinks",value:function(e,t,n){var r=this.server+"/api/v2.1/repos/"+e+"/upload-links/",o={page:t||1,per_page:n||25};return this.req.get(r,{params:o})}},{key:"deleteUploadLinks",value:function(e){var t=this.server+"/api/v2.1/upload-links/",n={tokens:e};return this.req.delete(t,{data:n})}}])}(),sn=new an,ln=We.Ay.load("sfcsrftoken");sn.initForSeahubUsage({siteRoot:f.Yc,xcsrfHeaders:ln});var cn=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onMouseEnter=function(){n.setState({isOperationShow:!0})},n.onMouseLeave=function(){n.setState({isOperationShow:!1})},n.onDeleteLink=function(){n.props.deleteItem(n.props.item)},n.cutLink=function(e){var t=e.length;return e.slice(0,9)+"..."+e.slice(t-5)},n.toggleSelectLink=function(e){var t=n.props.item;n.props.toggleSelectLink(t,e.target.checked)},n.state={isOperationShow:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e,t=this.props.item,n="/"===t.path?"/":t.path.slice(0,t.path.length-1);return e=t.is_dir?"".concat(f.Yc,"library/").concat(t.repo_id,"/").concat(encodeURIComponent(t.repo_name)).concat(h.Aq.encodePath(n)):"".concat(f.Yc,"lib/").concat(t.repo_id,"/file").concat(h.Aq.encodePath(t.path)),(0,m.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onFocus:this.onMouseEnter,className:w()({"tr-highlight":t.isSelected}),children:[(0,m.jsx)("td",{className:"text-center",children:(0,m.jsx)("input",{type:"checkbox",checked:t.isSelected||!1,className:"vam",onChange:this.toggleSelectLink})}),(0,m.jsxs)("td",{children:[(0,m.jsx)("img",{src:t.creator_avatar,alt:t.creator_name,width:"24",className:"rounded-circle mr-2"}),(0,m.jsx)("a",{href:"".concat(f.Yc,"profile/").concat(encodeURIComponent(t.creator_email),"/"),target:"_blank",className:"align-middle",rel:"noreferrer",children:t.creator_name})]}),(0,m.jsx)("td",{children:t.is_dir?(0,m.jsx)(c.N_,{to:e,children:t.obj_name}):(0,m.jsx)("a",{href:e,target:"_blank",rel:"noreferrer",children:t.obj_name})}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:t.link,target:"_blank",rel:"noreferrer",children:this.cutLink(t.link)})}),(0,m.jsx)("td",{children:t.expire_date?K()(t.expire_date).format("YYYY-MM-DD HH:mm"):"--"}),(0,m.jsx)("td",{children:t.view_cnt}),(0,m.jsx)("td",{children:(0,m.jsx)("i",{tabIndex:"0",role:"button",className:"sf3-font-delete1 sf3-font op-icon ".concat(this.state.isOperationShow?"":"invisible"),onClick:this.onDeleteLink,onKeyDown:h.Aq.onKeyDown,title:(0,f.AP)("Delete"),"aria-label":(0,f.AP)("Delete")})})]})}}])}(s.Component),un=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).deleteItem=function(e){S.e.deleteRepoShareLink(n.props.repo.repo_id,e.token).then((function(){var t=n.state.items.filter((function(t){return t.token!==e.token}));n.setState({items:t});var r=(0,f.AP)("Successfully deleted 1 item");E.A.success(r)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.toggleDeleteShareLinksDialog=function(){n.setState({isDeleteShareLinksDialogOpen:!n.state.isDeleteShareLinksDialogOpen})},n.toggleSelectAllLinks=function(e){n._toggleSelectAllLinks(e.target.checked)},n.cancelSelectAllLinks=function(){n._toggleSelectAllLinks(!1)},n._toggleSelectAllLinks=function(e){var t=n.state.items;n.setState({items:t.map((function(t){return t.isSelected=e,t}))})},n.toggleSelectLink=function(e,t){var r=n.state.items;n.setState({items:r.map((function(n){return n.token==e.token&&(n.isSelected=t),n}))})},n.deleteShareLinks=function(){var e=n.state.items,t=e.filter((function(e){return e.isSelected})).map((function(e){return e.token}));S.e.deleteShareLinks(t).then((function(t){var r=t.data,o=r.success,a=r.failed;if(o.length){var i=e.filter((function(e){return!o.some((function(t){return t.token==e.token}))}));n.setState({items:i});var s=o.length,l=1==s?(0,f.AP)("Successfully deleted 1 share link"):(0,f.AP)("Successfully deleted {number_placeholder} share links").replace("{number_placeholder}",s);E.A.success(l)}a.forEach((function(e){var t="".concat(e.token,": ").concat(e.error_msg);E.A.danger(t)}))})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.getTheadContent=function(e,t){return(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"5%",className:"text-center",children:e&&(0,m.jsx)("input",{type:"checkbox",checked:t,className:"vam",onChange:n.toggleSelectAllLinks})}),(0,m.jsx)("th",{width:"20%",children:(0,f.AP)("Creator")}),(0,m.jsx)("th",{width:"24%",children:(0,f.AP)("Name")}),(0,m.jsx)("th",{width:"19%",children:(0,f.AP)("Link")}),(0,m.jsx)("th",{width:"17%",children:(0,f.AP)("Expiration")}),(0,m.jsx)("th",{width:"8%",children:(0,f.AP)("Visits")}),(0,m.jsx)("th",{width:"7%"})]})},n.handleScroll=function(e){if(!n.state.isLoadingMore&&n.state.hasMore){var t=e.target.clientHeight,r=e.target.scrollHeight;t+e.target.scrollTop+1>=r&&n.setState({isLoadingMore:!0},(function(){n.getMore()}))}},n.getMore=function(){var e=n.state,t=e.page,r=e.items,o=n.props.repo;sn.listRepoShareLinks(o.repo_id,t+1).then((function(e){n.setState({isLoadingMore:!1,hasMore:25==e.data.length,page:t+1,items:r.concat(e.data)})})).catch((function(e){n.setState({isLoadingMore:!1});var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.state={loading:!0,hasMore:!1,isLoadingMore:!1,page:1,errorMsg:"",items:[],isDeleteShareLinksDialogOpen:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.repo,n=this.state.page;sn.listRepoShareLinks(t.repo_id,n).then((function(t){e.setState({loading:!1,hasMore:25==t.data.length,items:t.data})})).catch((function(t){e.setState({loading:!1,errorMsg:h.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.loading,r=t.isLoadingMore,o=t.errorMsg,a=t.items,i=t.isDeleteShareLinksDialogOpen,l=a.filter((function(e){return e.isSelected})),c=a.length==l.length;return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsxs)("div",{className:"d-flex justify-content-between align-items-center pb-2 mt-1 pr-1 border-bottom",children:[(0,m.jsx)("h6",{className:"font-weight-normal m-0",children:(0,f.AP)("Share Links")}),(0,m.jsx)("div",{className:"d-flex",children:l.length>0&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("button",{className:"btn btn-sm btn-secondary mr-2",onClick:this.cancelSelectAllLinks,children:(0,f.AP)("Cancel")}),(0,m.jsx)("button",{className:"btn btn-sm btn-secondary mr-2",onClick:this.toggleDeleteShareLinksDialog,children:(0,f.AP)("Delete")})]})})]}),n&&(0,m.jsx)(Z.A,{}),!n&&o&&(0,m.jsx)("p",{className:"error text-center mt-8",children:o}),!n&&!o&&!a.length&&(0,m.jsx)($.A,{text:(0,f.AP)("No share links")}),!n&&!o&&a.length>0&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("table",{children:[(0,m.jsx)("thead",{children:this.getTheadContent(!0,c)}),(0,m.jsx)("tbody",{})]}),(0,m.jsxs)("div",{className:"table-real-container",onScroll:this.handleScroll,children:[(0,m.jsxs)("table",{className:"table-hover table-thead-hidden",children:[(0,m.jsx)("thead",{children:this.getTheadContent(!1)}),(0,m.jsx)("tbody",{children:a.map((function(t,n){return(0,m.jsx)(cn,{item:t,deleteItem:e.deleteItem,toggleSelectLink:e.toggleSelectLink},n)}))})]}),r&&(0,m.jsx)(Z.A,{})]})]}),i&&(0,m.jsx)(Re.A,{title:(0,f.AP)("Delete share links"),message:(0,f.AP)("Are you sure you want to delete the selected share link(s) ?"),executeOperation:this.deleteShareLinks,confirmBtnText:(0,f.AP)("Delete"),toggleDialog:this.toggleDeleteShareLinksDialog})]})}}])}(s.Component),dn=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onMouseEnter=function(){n.setState({isOperationShow:!0})},n.onMouseLeave=function(){n.setState({isOperationShow:!1})},n.onDeleteLink=function(){n.props.deleteItem(n.props.item)},n.cutLink=function(e){var t=e.length;return e.slice(0,9)+"..."+e.slice(t-5)},n.toggleSelectLink=function(e){var t=n.props.item;n.props.toggleSelectLink(t,e.target.checked)},n.state={isOperationShow:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.item,t="/"===e.path?"/":e.path.slice(0,e.path.length-1),n="".concat(f.Yc,"library/").concat(e.repo_id,"/").concat(encodeURIComponent(e.repo_name)).concat(h.Aq.encodePath(t));return(0,m.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onFocus:this.onMouseEnter,className:w()({"tr-highlight":e.isSelected}),children:[(0,m.jsx)("td",{className:"text-center",children:(0,m.jsx)("input",{type:"checkbox",checked:e.isSelected||!1,className:"vam",onChange:this.toggleSelectLink})}),(0,m.jsxs)("td",{children:[(0,m.jsx)("img",{src:e.creator_avatar,alt:e.creator_name,width:"24",className:"rounded-circle mr-2"}),(0,m.jsx)("a",{href:"".concat(f.Yc,"profile/").concat(encodeURIComponent(e.creator_email),"/"),target:"_blank",className:"align-middle",rel:"noreferrer",children:e.creator_name})]}),(0,m.jsx)("td",{children:(0,m.jsx)(c.N_,{to:n,children:e.obj_name})}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:e.link,target:"_blank",rel:"noreferrer",children:this.cutLink(e.link)})}),(0,m.jsx)("td",{children:e.expire_date?K()(e.expire_date).format("YYYY-MM-DD HH:mm"):"--"}),(0,m.jsx)("td",{children:e.view_cnt}),(0,m.jsx)("td",{children:(0,m.jsx)("i",{tabIndex:"0",role:"button",className:"sf3-font-delete1 sf3-font op-icon ".concat(this.state.isOperationShow?"":"invisible"),onClick:this.onDeleteLink,onKeyDown:h.Aq.onKeyDown,title:(0,f.AP)("Delete"),"aria-label":(0,f.AP)("Delete")})})]})}}])}(s.Component),pn=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).deleteItem=function(e){S.e.deleteRepoUploadLink(n.props.repo.repo_id,e.token).then((function(){var t=n.state.items.filter((function(t){return t.token!==e.token}));n.setState({items:t});var r=(0,f.AP)("Successfully deleted 1 item");E.A.success(r)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.toggleDeleteUploadLinksDialog=function(){n.setState({isDeleteUploadLinksDialogOpen:!n.state.isDeleteUploadLinksDialogOpen})},n.toggleSelectAllLinks=function(e){n._toggleSelectAllLinks(e.target.checked)},n.cancelSelectAllLinks=function(){n._toggleSelectAllLinks(!1)},n._toggleSelectAllLinks=function(e){var t=n.state.items;n.setState({items:t.map((function(t){return t.isSelected=e,t}))})},n.toggleSelectLink=function(e,t){var r=n.state.items;n.setState({items:r.map((function(n){return n.token==e.token&&(n.isSelected=t),n}))})},n.deleteUploadLinks=function(){var e=n.state.items,t=e.filter((function(e){return e.isSelected})).map((function(e){return e.token}));sn.deleteUploadLinks(t).then((function(t){var r=t.data,o=r.success,a=r.failed;if(o.length){var i=e.filter((function(e){return!o.some((function(t){return t.token==e.token}))}));n.setState({items:i});var s=o.length,l=1==s?(0,f.AP)("Successfully deleted 1 upload link"):(0,f.AP)("Successfully deleted {number_placeholder} upload links").replace("{number_placeholder}",s);E.A.success(l)}a.forEach((function(e){var t="".concat(e.token,": ").concat(e.error_msg);E.A.danger(t)}))})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.getTheadContent=function(e,t){return(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"5%",className:"text-center",children:e&&(0,m.jsx)("input",{type:"checkbox",checked:t,className:"vam",onChange:n.toggleSelectAllLinks})}),(0,m.jsx)("th",{width:"20%",children:(0,f.AP)("Creator")}),(0,m.jsx)("th",{width:"24%",children:(0,f.AP)("Name")}),(0,m.jsx)("th",{width:"19%",children:(0,f.AP)("Link")}),(0,m.jsx)("th",{width:"17%",children:(0,f.AP)("Expiration")}),(0,m.jsx)("th",{width:"8%",children:(0,f.AP)("Visits")}),(0,m.jsx)("th",{width:"7%"})]})},n.handleScroll=function(e){if(!n.state.isLoadingMore&&n.state.hasMore){var t=e.target.clientHeight,r=e.target.scrollHeight;t+e.target.scrollTop+1>=r&&n.setState({isLoadingMore:!0},(function(){n.getMore()}))}},n.getMore=function(){var e=n.state,t=e.page,r=e.items,o=n.props.repo;sn.listRepoUploadLinks(o.repo_id,t+1).then((function(e){n.setState({isLoadingMore:!1,hasMore:25==e.data.length,page:t+1,items:r.concat(e.data)})})).catch((function(e){n.setState({isLoadingMore:!1});var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.state={loading:!0,hasMore:!1,isLoadingMore:!1,page:1,errorMsg:"",items:[],isDeleteUploadLinksDialogOpen:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.repo,n=this.state.page;sn.listRepoUploadLinks(t.repo_id,n).then((function(t){e.setState({loading:!1,hasMore:25==t.data.length,items:t.data})})).catch((function(t){e.setState({loading:!1,errorMsg:h.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.loading,r=t.isLoadingMore,o=t.errorMsg,a=t.items,i=t.isDeleteUploadLinksDialogOpen,l=a.filter((function(e){return e.isSelected})),c=a.length==l.length;return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsxs)("div",{className:"d-flex justify-content-between align-items-center pb-2 mt-1 pr-1 border-bottom",children:[(0,m.jsx)("h6",{className:"font-weight-normal m-0",children:(0,f.AP)("Upload Links")}),(0,m.jsx)("div",{className:"d-flex",children:l.length>0&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("button",{className:"btn btn-sm btn-secondary mr-2",onClick:this.cancelSelectAllLinks,children:(0,f.AP)("Cancel")}),(0,m.jsx)("button",{className:"btn btn-sm btn-secondary mr-2",onClick:this.toggleDeleteUploadLinksDialog,children:(0,f.AP)("Delete")})]})})]}),n&&(0,m.jsx)(Z.A,{}),!n&&o&&(0,m.jsx)("p",{className:"error text-center mt-8",children:o}),!n&&!o&&!a.length&&(0,m.jsx)($.A,{text:(0,f.AP)("No upload links")}),!n&&!o&&a.length>0&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("table",{children:[(0,m.jsx)("thead",{children:this.getTheadContent(!0,c)}),(0,m.jsx)("tbody",{})]}),(0,m.jsxs)("div",{className:"table-real-container",onScroll:this.handleScroll,children:[(0,m.jsxs)("table",{className:"table-hover table-thead-hidden",children:[(0,m.jsx)("thead",{children:this.getTheadContent(!1)}),(0,m.jsx)("tbody",{children:a.map((function(t,n){return(0,m.jsx)(dn,{item:t,deleteItem:e.deleteItem,toggleSelectLink:e.toggleSelectLink},n)}))})]}),r&&(0,m.jsx)(Z.A,{})]})]}),i&&(0,m.jsx)(Re.A,{title:(0,f.AP)("Delete upload links"),message:(0,f.AP)("Are you sure you want to delete the selected upload link(s) ?"),executeOperation:this.deleteUploadLinks,confirmBtnText:(0,f.AP)("Delete"),toggleDialog:this.toggleDeleteUploadLinksDialog})]})}}])}(s.Component),fn=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onMouseEnter=function(){n.setState({isOperationShow:!0})},n.onMouseLeave=function(){n.setState({isOperationShow:!1})},n.onDeleteLink=function(e){e.preventDefault(),n.props.deleteItem(n.props.item)},n.changePerm=function(e){var t=n.props.item;S.e.updateShareToUserItemPermission(t.repo_id,t.path,"user",t.share_to,e).then((function(){n.setState({permission:e})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.onEditPermission=function(e){e.nativeEvent.stopImmediatePropagation(),n.setState({isShowPermEditor:!0})},n.state={permission:n.props.item.permission,isOperationShow:!1,isShowPermEditor:!1},n.permissions=["rw","r"],f.am&&("/"===n.props.item.path&&n.props.isRepoOwner&&n.permissions.push("admin"),n.permissions.push("cloud-edit","preview")),n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e,t=this.props.item,n="/"===t.path?"/":t.path.slice(0,t.path.length-1);return e="".concat(f.Yc,"library/").concat(t.repo_id,"/").concat(encodeURIComponent(t.repo_name)).concat(h.Aq.encodePath(n)),(0,m.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onFocus:this.onMouseEnter,children:[(0,m.jsx)("td",{children:(0,m.jsx)(c.N_,{to:e,children:h.Aq.getFolderName(t.path)})}),(0,m.jsx)("td",{className:"name",children:t.share_to_name}),(0,m.jsxs)("td",{children:[!this.state.isShowPermEditor&&(0,m.jsxs)("div",{children:[(0,m.jsx)("span",{children:t.permission_name||h.Aq.sharePerms(this.state.permission)}),this.state.isOperationShow&&(0,m.jsx)("a",{href:"#",role:"button","aria-label":(0,f.AP)("Edit"),title:(0,f.AP)("Edit"),className:"sf3-font sf3-font-rename attr-action-icon",onClick:this.onEditPermission})]}),this.state.isShowPermEditor&&(0,m.jsx)(xe.A,{repoID:t.repo_id,isTextMode:!0,isEditIconShow:this.state.isOperationShow,isEditing:!0,currentPermission:this.state.permission,permissions:this.permissions,onPermissionChanged:this.changePerm})]}),(0,m.jsx)("td",{children:(0,m.jsx)("span",{tabIndex:"0",role:"button",className:"sf2-icon-x3 action-icon ".concat(this.state.isOperationShow?"":"invisible"),onClick:this.onDeleteLink,onKeyDown:h.Aq.onKeyDown,title:(0,f.AP)("Delete"),"aria-label":(0,f.AP)("Delete")})})]})}}])}(s.Component),hn=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).deleteItem=function(e){S.e.deleteShareToUserItem(e.repo_id,e.path,"user",e.share_to).then((function(t){var r=n.state.items.filter((function(t){return t.path+t.share_to!==e.path+e.share_to}));n.setState({items:r});var o=(0,f.AP)("Successfully deleted 1 item");E.A.success(o)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.state={loading:!0,errorMsg:"",items:[]},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;S.e.getAllRepoFolderShareInfo(this.props.repo.repo_id,"user").then((function(t){e.setState({loading:!1,items:t.data.share_info_list})})).catch((function(t){e.setState({loading:!1,errorMsg:h.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.loading,r=t.errorMsg,o=t.items,a=this.props.repo.owner_email===f.Xh;return(0,m.jsxs)(s.Fragment,{children:[n&&(0,m.jsx)(Z.A,{}),!n&&r&&(0,m.jsx)("p",{className:"error text-center mt-8",children:r}),!n&&!r&&!o.length&&(0,m.jsx)($.A,{text:(0,f.AP)("No user shares")}),!n&&!r&&o.length>0&&(0,m.jsxs)("table",{className:"table-hover",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"30%",children:(0,f.AP)("Name")}),(0,m.jsx)("th",{width:"30%",children:(0,f.AP)("User")}),(0,m.jsx)("th",{width:"30%",children:(0,f.AP)("Permission")}),(0,m.jsx)("th",{width:"10%"})]})}),(0,m.jsx)("tbody",{children:o.map((function(t,n){return(0,m.jsx)(fn,{item:t,deleteItem:e.deleteItem,isRepoOwner:a},n)}))})]})]})}}])}(s.Component),mn=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onMouseEnter=function(){n.setState({isOperationShow:!0})},n.onMouseLeave=function(){n.setState({isOperationShow:!1})},n.onDeleteLink=function(e){e.preventDefault(),n.props.deleteItem(n.props.item)},n.changePerm=function(e){var t=n.props.item;S.e.updateShareToGroupItemPermission(t.repo_id,t.path,"group",t.share_to,e).then((function(){n.setState({permission:e})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.onEditPermission=function(e){e.nativeEvent.stopImmediatePropagation(),n.setState({isShowPermEditor:!0})},n.state={permission:n.props.item.permission,isOperationShow:!1,isShowPermEditor:!1},n.permissions=["rw","r"],f.am&&("/"===n.props.item.path&&n.props.isRepoOwner&&n.permissions.push("admin"),n.permissions.push("cloud-edit","preview")),n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e,t=this.props.item,n="/"===t.path?"/":t.path.slice(0,t.path.length-1);return e="".concat(f.Yc,"library/").concat(t.repo_id,"/").concat(encodeURIComponent(t.repo_name)).concat(h.Aq.encodePath(n)),(0,m.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onFocus:this.onMouseEnter,children:[(0,m.jsx)("td",{children:(0,m.jsx)(c.N_,{to:e,children:h.Aq.getFolderName(t.path)})}),(0,m.jsx)("td",{className:"name",children:t.share_to_name}),(0,m.jsxs)("td",{children:[!this.state.isShowPermEditor&&(0,m.jsxs)("div",{children:[(0,m.jsx)("span",{children:t.permission_name||h.Aq.sharePerms(this.state.permission)}),this.state.isOperationShow&&(0,m.jsx)("a",{href:"#",role:"button","aria-label":(0,f.AP)("Edit"),title:(0,f.AP)("Edit"),className:"sf3-font sf3-font-rename attr-action-icon",onClick:this.onEditPermission})]}),this.state.isShowPermEditor&&(0,m.jsx)(xe.A,{repoID:t.repo_id,isTextMode:!0,isEditIconShow:this.state.isOperationShow,isEditing:!0,currentPermission:this.state.permission,permissions:this.permissions,onPermissionChanged:this.changePerm})]}),(0,m.jsx)("td",{children:(0,m.jsx)("span",{tabIndex:"0",role:"button",className:"sf2-icon-x3 action-icon ".concat(this.state.isOperationShow?"":"invisible"),onClick:this.onDeleteLink,onKeyDown:h.Aq.onKeyDown,title:(0,f.AP)("Delete"),"aria-label":(0,f.AP)("Delete")})})]})}}])}(s.Component),gn=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).deleteItem=function(e){S.e.deleteShareToGroupItem(e.repo_id,e.path,"group",e.share_to).then((function(t){var r=n.state.items.filter((function(t){return t.path+t.share_to!==e.path+e.share_to}));n.setState({items:r});var o=(0,f.AP)("Successfully deleted 1 item");E.A.success(o)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.state={loading:!0,errorMsg:"",items:[]},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;S.e.getAllRepoFolderShareInfo(this.props.repo.repo_id,"group").then((function(t){e.setState({loading:!1,items:t.data.share_info_list})})).catch((function(t){e.setState({loading:!1,errorMsg:h.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.loading,r=t.errorMsg,o=t.items,a=this.props.repo.owner_email===f.Xh;return(0,m.jsxs)(s.Fragment,{children:[n&&(0,m.jsx)(Z.A,{}),!n&&r&&(0,m.jsx)("p",{className:"error text-center mt-8",children:r}),!n&&!r&&!o.length&&(0,m.jsx)($.A,{text:(0,f.AP)("No group shares")}),!n&&!r&&o.length>0&&(0,m.jsxs)("table",{className:"table-hover",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"30%",children:(0,f.AP)("Name")}),(0,m.jsx)("th",{width:"30%",children:(0,f.AP)("Group")}),(0,m.jsx)("th",{width:"30%",children:(0,f.AP)("Permission")}),(0,m.jsx)("th",{width:"10%"})]})}),(0,m.jsx)("tbody",{children:o.map((function(t,n){return(0,m.jsx)(mn,{item:t,deleteItem:e.deleteItem,isRepoOwner:a},n)}))})]})]})}}])}(s.Component),vn=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).getInitialActiveTab=function(){return n.enableShareLink?"shareLink":n.enableUploadLink?"uploadLink":"shareToUser"},n.toggle=function(e){n.state.activeTab!==e&&n.setState({activeTab:e})},n.onTabKeyDown=function(e){"Enter"!=e.key&&"Space"!=e.key||e.target.click()},n.enableShareLink=!n.props.repo.encrypted&&f.zn,n.enableUploadLink=!n.props.repo.encrypted&&f.fY,n.state={activeTab:n.getInitialActiveTab()},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.state.activeTab,t=this.props.repo.repo_name,n=(0,f.AP)("{placeholder} Share Admin");return n=n.replace("{placeholder}",'<span class="op-target text-truncate mx-1">'+h.Aq.HTMLescape(t)+"</span>"),(0,m.jsx)("div",{children:(0,m.jsxs)(p.A,{isOpen:!0,className:"repo-share-admin-container share-dialog",toggle:this.props.toggleDialog,children:[(0,m.jsx)(k.A,{toggle:this.props.toggleDialog,children:(0,m.jsx)("span",{dangerouslySetInnerHTML:{__html:n},className:"d-flex mw-100"})}),(0,m.jsx)(M.A,{className:"repo-share-admin-content-container share-dialog-content",role:"tablist",children:(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("div",{className:"share-dialog-side",children:(0,m.jsxs)(Tt.A,{pills:!0,children:[this.enableShareLink&&(0,m.jsx)(Ot.A,{role:"tab","aria-selected":"shareLink"===e,"aria-controls":"share-link-panel",children:(0,m.jsx)(jt.A,{className:"shareLink"===e?"active":"",onClick:this.toggle.bind(this,"shareLink"),tabIndex:"0",onKeyDown:this.onTabKeyDown,children:(0,f.AP)("Share Links")})}),this.enableUploadLink&&(0,m.jsx)(Ot.A,{role:"tab","aria-selected":"uploadLink"===e,"aria-controls":"upload-link-panel",children:(0,m.jsx)(jt.A,{className:"uploadLink"===e?"active":"",onClick:this.toggle.bind(this,"uploadLink"),tabIndex:"0",onKeyDown:this.onTabKeyDown,children:(0,f.AP)("Upload Links")})}),(0,m.jsx)(Ot.A,{role:"tab","aria-selected":"shareToUser"===e,"aria-controls":"share-to-user-panel",children:(0,m.jsx)(jt.A,{className:"shareToUser"===e?"active":"",onClick:this.toggle.bind(this,"shareToUser"),tabIndex:"0",onKeyDown:this.onTabKeyDown,children:(0,f.AP)("User Shares")})}),(0,m.jsx)(Ot.A,{role:"tab","aria-selected":"shareToGroup"===e,"aria-controls":"share-to-group-panel",children:(0,m.jsx)(jt.A,{className:"shareToGroup"===e?"active":"",onClick:this.toggle.bind(this,"shareToGroup"),tabIndex:"0",onKeyDown:this.onTabKeyDown,children:(0,f.AP)("Group Shares")})})]})}),(0,m.jsx)("div",{className:"share-dialog-main",children:(0,m.jsxs)(Rt.A,{activeTab:this.state.activeTab,children:[this.enableShareLink&&"shareLink"===e&&(0,m.jsx)(Lt.A,{tabId:"shareLink",role:"tabpanel",id:"share-link-panel",children:(0,m.jsx)(un,{repo:this.props.repo})}),this.enableUploadLink&&"uploadLink"===e&&(0,m.jsx)(Lt.A,{tabId:"uploadLink",role:"tabpanel",id:"upload-link-panel",children:(0,m.jsx)(pn,{repo:this.props.repo})}),"shareToUser"===e&&(0,m.jsx)(Lt.A,{tabId:"shareToUser",role:"tabpanel",id:"share-to-user-panel",children:(0,m.jsx)(hn,{repo:this.props.repo})}),"shareToGroup"===e&&(0,m.jsx)(Lt.A,{tabId:"shareToGroup",role:"tabpanel",id:"share-to-group-panel",children:(0,m.jsx)(gn,{repo:this.props.repo})})]})})]})})]})})}}])}(s.Component),yn=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).submit=function(){var e;if(n.state.isAutoDel){e=n.state.autoDelDays;if(!/^-?\d+$/.test(e)||e<=0)return void n.setState({errorInfo:(0,f.AP)("Please enter a positive integer")})}else e=0;var t=n.props.repoID;S.e.setRepoOldFilesAutoDelDays(t,e).then((function(e){n.props.toggleDialog(),E.A.success((0,f.AP)("Successfully set it."))})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.handleKeyDown=function(e){"Enter"===e.key&&(n.submit(),e.preventDefault())},n.onChange=function(e){var t=e.target.value;n.setState({autoDelDays:t})},n.updateRadioCheck=function(e){"noAutoDel"===e?n.setState({isAutoDel:!1}):"autoDel"===e&&n.setState({isAutoDel:!0})},n.state={autoDelDays:0,isAutoDel:!1,errorInfo:""},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;S.e.getRepoOldFilesAutoDelDays(this.props.repoID).then((function(t){e.setState({autoDelDays:t.data.auto_delete_days,isAutoDel:t.data.auto_delete_days>0})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))}},{key:"render",value:function(){var e=this;return(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.props.toggleDialog,children:[(0,m.jsx)(k.A,{toggle:this.props.toggleDialog,children:(0,f.AP)("Auto deletion")}),(0,m.jsx)(M.A,{children:(0,m.jsxs)(bt.A,{children:[(0,m.jsxs)(_t.A,{check:!0,children:[(0,m.jsx)(I.A,{type:"radio",name:"radio1",checked:!this.state.isAutoDel,onChange:function(){e.updateRadioCheck("noAutoDel")}})," ",(0,m.jsx)(wt.A,{children:(0,f.AP)("Do not automatically delete files")})]}),(0,m.jsxs)(_t.A,{check:!0,children:[(0,m.jsx)(I.A,{type:"radio",name:"radio1",checked:this.state.isAutoDel,onChange:function(){e.updateRadioCheck("autoDel")}})," ",(0,m.jsx)(wt.A,{children:(0,f.AP)("Automatically delete files that are not modified within certain days:")}),(0,m.jsx)(I.A,{type:"text",className:"expire-input",value:this.state.autoDelDays,disabled:!this.state.isAutoDel,onChange:this.onChange,onKeyDown:this.handleKeyDown})," ",(0,m.jsx)(wt.A,{children:(0,m.jsx)("span",{children:(0,f.AP)("days")})})]}),this.state.errorInfo&&(0,m.jsx)(St.A,{color:"danger",children:this.state.errorInfo})]})}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(P.A,{color:"secondary",onClick:this.props.toggleDialog,children:(0,f.AP)("Cancel")}),(0,m.jsx)(P.A,{color:"primary",onClick:this.submit,children:(0,f.AP)("Submit")})]})]})}}])}(s.Component),Cn=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onFocus=function(){n.props.isItemFreezed||n.setState({isOpIconShow:!0})},n.onMouseEnter=function(){n.props.isItemFreezed||n.setState({isOpIconShow:!0,highlight:!0})},n.onMouseLeave=function(){n.props.isItemFreezed||n.setState({isOpIconShow:!1,highlight:!1})},n.onMenuItemClick=function(e){switch(e){case"Star":case"Unstar":n.onToggleStarRepo();break;case"Share":n.onShareToggle();break;case"Delete":n.onDeleteToggle();break;case"Rename":n.onRenameToggle();break;case"Transfer":n.onTransferToggle();break;case"History Setting":n.onHistorySettingToggle();break;case"Change Password":n.onChangePasswordToggle();break;case"Reset Password":n.onResetPasswordToggle();break;case"Watch File Changes":n.watchFileChanges();break;case"Unwatch File Changes":n.unwatchFileChanges();break;case"Folder Permission":n.onFolderPermissionToggle();break;case"Label Current State":n.onLabelToggle();break;case"API Token":n.onAPITokenToggle();break;case"Share Admin":n.toggleRepoShareAdminDialog();break;case"Old Files Auto Delete":n.toggleOldFilesAutoDelDialog()}},n.visitRepo=function(){!n.state.isRenaming&&n.props.repo.repo_name&&(0,c.oo)(n.repoURL)},n.onToggleStarRepo=function(){var e=n.props.repo.repo_name;n.state.isStarred?S.e.unstarItem(n.props.repo.repo_id,"/").then((function(){n.setState({isStarred:!n.state.isStarred});var t=(0,f.AP)("Successfully unstarred {library_name_placeholder}.").replace("{library_name_placeholder}",e);E.A.success(t)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)})):S.e.starItem(n.props.repo.repo_id,"/").then((function(){n.setState({isStarred:!n.state.isStarred});var t=(0,f.AP)("Successfully starred {library_name_placeholder}.").replace("{library_name_placeholder}",e);E.A.success(t)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.watchFileChanges=function(){var e=n.props.repo;S.e.monitorRepo(e.repo_id).then((function(){n.props.onMonitorRepo(e,!0)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.unwatchFileChanges=function(){var e=n.props.repo;S.e.unMonitorRepo(e.repo_id).then((function(){n.props.onMonitorRepo(e,!1)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.onShareToggle=function(){n.setState({isShareDialogShow:!n.state.isShareDialogShow})},n.onDeleteToggle=function(){n.setState({isDeleteDialogShow:!n.state.isDeleteDialogShow})},n.onRenameToggle=function(){n.props.onFreezedItem(),n.setState({isRenaming:!n.state.isRenaming})},n.onTransferToggle=function(){n.setState({isTransferDialogShow:!n.state.isTransferDialogShow})},n.onHistorySettingToggle=function(){n.setState({isHistorySettingDialogShow:!n.state.isHistorySettingDialogShow})},n.onChangePasswordToggle=function(){n.setState({isChangePasswordDialogShow:!n.state.isChangePasswordDialogShow})},n.onResetPasswordToggle=function(){n.setState({isResetPasswordDialogShow:!n.state.isResetPasswordDialogShow})},n.onLabelToggle=function(){n.setState({isLabelRepoStateDialogOpen:!n.state.isLabelRepoStateDialogOpen})},n.onFolderPermissionToggle=function(){n.setState({isFolderPermissionDialogShow:!n.state.isFolderPermissionDialogShow})},n.onAPITokenToggle=function(){n.setState({isAPITokenDialogShow:!n.state.isAPITokenDialogShow})},n.toggleRepoShareAdminDialog=function(){n.setState({isRepoShareAdminDialogOpen:!n.state.isRepoShareAdminDialogOpen})},n.toggleOldFilesAutoDelDialog=function(){n.setState({isOldFilesAutoDelDialogOpen:!n.state.isOldFilesAutoDelDialogOpen})},n.onUnfreezedItem=function(){n.setState({highlight:!1,isOpIconShow:!1}),n.props.onUnfreezedItem()},n.onRenameConfirm=function(e){var t=n.props.repo,r=t.repo_id;S.e.renameRepo(r,e).then((function(){n.props.onRenameRepo(t,e),n.onRenameCancel()})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.onRenameCancel=function(){n.props.onUnfreezedItem(),n.setState({isRenaming:!n.state.isRenaming})},n.onTransferRepo=function(e){var t=n.props.repo.repo_id;S.e.transferRepo(t,e.email).then((function(e){n.props.onTransferRepo(t);var r=(0,f.AP)("Successfully transferred the library.");E.A.success(r)})).catch((function(e){e.response?E.A.danger(e.response.data.error_msg||(0,f.AP)("Error"),{duration:3}):E.A.danger((0,f.AP)("Failed. Please check the network."),{duration:3})})),n.onTransferToggle()},n.onDeleteRepo=function(e){S.e.deleteRepo(e.repo_id).then((function(t){n.setState({isRepoDeleted:!0,isDeleteDialogShow:!1}),n.props.onDeleteRepo(e);var r=e.repo_name,o=(0,f.AP)("Successfully deleted {name}.").replace("{name}",r);E.A.success(o)})).catch((function(t){var r=h.Aq.getErrorMsg(t);if(r===(0,f.AP)("Error")){var o=e.repo_name;r=(0,f.AP)("Failed to delete {name}.").replace("{name}",o)}E.A.danger(r),n.setState({isRepoDeleted:!1})}))},n.renderPCUI=function(){var e=n.state.isStarred,t=n.props,r=t.repo,o=t.currentViewMode,a=void 0===o?tt.Tb:o,i=a==tt.nj,l=h.Aq.getLibIconUrl(r,i),u=h.Aq.getLibIconTitle(r),d="".concat(f.Yc,"library/").concat(r.repo_id,"/").concat(h.Aq.encodePath(r.repo_name),"/");return a==tt.Tb?(0,m.jsxs)("tr",{className:n.state.highlight?"tr-highlight":"",onMouseEnter:n.onMouseEnter,onMouseLeave:n.onMouseLeave,onFocus:n.onFocus,children:[(0,m.jsx)("td",{className:"text-center",children:(0,m.jsx)("i",{role:"button",title:n.state.isStarred?(0,f.AP)("Unstar"):(0,f.AP)("Star"),"aria-label":n.state.isStarred?(0,f.AP)("Unstar"):(0,f.AP)("Star"),onClick:n.onToggleStarRepo,className:"op-icon m-0 ".concat(n.state.isStarred?"sf3-font-star":"sf3-font-star-empty"," sf3-font")})}),(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:l,title:u,alt:u,width:"24"})}),(0,m.jsxs)("td",{children:[n.state.isRenaming&&(0,m.jsx)(Xt.A,{name:r.repo_name,onRenameConfirm:n.onRenameConfirm,onRenameCancel:n.onRenameCancel}),!n.state.isRenaming&&r.repo_name&&(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)(c.N_,{to:d,children:r.repo_name}),r.monitored&&(0,m.jsx)(et,{repoID:r.repo_id,className:"ml-1 op-icon"})]}),!n.state.isRenaming&&!r.repo_name&&(0,f.AP)("Broken (please contact your administrator to fix this library)")]}),(0,m.jsx)("td",{children:r.repo_name&&n.state.isOpIconShow&&(0,m.jsxs)("div",{children:[(0,m.jsx)("i",{className:"op-icon sf3-font-share sf3-font",title:(0,f.AP)("Share"),role:"button","aria-label":(0,f.AP)("Share"),onClick:n.onShareToggle}),(0,m.jsx)("i",{className:"op-icon sf3-font-delete1 sf3-font",title:(0,f.AP)("Delete"),role:"button","aria-label":(0,f.AP)("Delete"),onClick:n.onDeleteToggle}),(0,m.jsx)(Jt,{isPC:!0,repo:n.props.repo,onMenuItemClick:n.onMenuItemClick,onFreezedItem:n.props.onFreezedItem,onUnfreezedItem:n.onUnfreezedItem})]})}),(0,m.jsx)("td",{children:r.size}),f.$0.length>0&&(0,m.jsx)("td",{children:r.storage_name}),(0,m.jsx)("td",{title:K()(r.last_modified).format("llll"),children:K()(r.last_modified).fromNow()})]}):(0,m.jsxs)("div",{className:"library-grid-item px-3 d-flex justify-content-between align-items-center",onMouseEnter:n.onMouseEnter,onMouseLeave:n.onMouseLeave,onFocus:n.onFocus,children:[(0,m.jsxs)("div",{className:"d-flex align-items-center text-truncate",children:[(0,m.jsx)("img",{src:l,title:u,alt:u,width:"36",className:"mr-2"}),n.state.isRenaming&&(0,m.jsx)(Xt.A,{name:r.repo_name,onRenameConfirm:n.onRenameConfirm,onRenameCancel:n.onRenameCancel}),!n.state.isRenaming&&r.repo_name&&(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)(c.N_,{to:d,className:"library-name text-truncate",title:r.repo_name,children:r.repo_name}),e&&(0,m.jsx)("i",{role:"button",title:(0,f.AP)("Unstar"),"aria-label":(0,f.AP)("Unstar"),className:"op-icon library-grid-item-icon sf3-font-star sf3-font",onClick:n.onToggleStarRepo}),r.monitored&&(0,m.jsx)(et,{repoID:r.repo_id,className:"op-icon library-grid-item-icon"})]}),!n.state.isRenaming&&!r.repo_name&&(0,m.jsx)("span",{children:(0,f.AP)("Broken (please contact your administrator to fix this library)")})]}),r.repo_name&&n.state.isOpIconShow&&(0,m.jsxs)("div",{className:"flex-shrink-0",children:[(0,m.jsx)("i",{className:"op-icon sf3-font-share sf3-font",title:(0,f.AP)("Share"),role:"button","aria-label":(0,f.AP)("Share"),onClick:n.onShareToggle}),(0,m.jsx)("i",{className:"op-icon sf3-font-delete1 sf3-font",title:(0,f.AP)("Delete"),role:"button","aria-label":(0,f.AP)("Delete"),onClick:n.onDeleteToggle}),(0,m.jsx)(Jt,{isPC:!0,repo:n.props.repo,onMenuItemClick:n.onMenuItemClick,onFreezedItem:n.props.onFreezedItem,onUnfreezedItem:n.onUnfreezedItem})]})]})},n.renderMobileUI=function(){var e=n.props.repo,t=h.Aq.getLibIconUrl(e),r=h.Aq.getLibIconTitle(e),o=n.repoURL="".concat(f.Yc,"library/").concat(e.repo_id,"/").concat(h.Aq.encodePath(e.repo_name),"/");return(0,m.jsxs)("tr",{className:n.state.highlight?"tr-highlight":"",onMouseEnter:n.onMouseEnter,onMouseLeave:n.onMouseLeave,children:[(0,m.jsx)("td",{onClick:n.visitRepo,children:(0,m.jsx)("img",{src:t,title:r,alt:r,width:"24"})}),(0,m.jsxs)("td",{onClick:n.visitRepo,children:[n.state.isRenaming&&(0,m.jsx)(Xt.A,{name:e.repo_name,onRenameConfirm:n.onRenameConfirm,onRenameCancel:n.onRenameCancel}),!n.state.isRenaming&&e.repo_name&&(0,m.jsxs)("div",{children:[(0,m.jsx)(c.N_,{to:o,children:e.repo_name}),e.monitored&&(0,m.jsx)(et,{repoID:e.repo_id,className:"ml-1 op-icon"})]}),!n.state.isRenaming&&!e.repo_name&&(0,m.jsx)("div",{children:"(gettext('Broken (please contact your administrator to fix this library)'))"}),(0,m.jsx)("span",{className:"item-meta-info",children:e.size}),(0,m.jsx)("span",{className:"item-meta-info",title:K()(e.last_modified).format("llll"),children:K()(e.last_modified).fromNow()})]}),(0,m.jsx)("td",{children:e.repo_name&&(0,m.jsx)(Jt,{repo:n.props.repo,isStarred:n.state.isStarred,onMenuItemClick:n.onMenuItemClick,onFreezedItem:n.props.onFreezedItem,onUnfreezedItem:n.onUnfreezedItem})})]})},n.state={isOpIconShow:!1,isStarred:n.props.repo.starred,isRenaming:!1,isShareDialogShow:!1,isDeleteDialogShow:!1,isTransferDialogShow:!1,isHistorySettingDialogShow:!1,isChangePasswordDialogShow:!1,isResetPasswordDialogShow:!1,isLabelRepoStateDialogOpen:!1,isFolderPermissionDialogShow:!1,isAPITokenDialogShow:!1,isRepoShareAdminDialogOpen:!1,isRepoDeleted:!1,isOldFilesAutoDelDialogOpen:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.repo;return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)(d(),{query:"(min-width: 768px)",children:this.renderPCUI()}),(0,m.jsx)(d(),{query:"(max-width: 767.8px)",children:this.renderMobileUI()}),this.state.isShareDialogShow&&(0,m.jsx)(te.A,{children:(0,m.jsx)($e.A,{itemType:"library",itemName:e.repo_name,itemPath:"/",repoID:e.repo_id,repoEncrypted:e.encrypted,enableDirPrivateShare:!0,userPerm:e.permission,toggleDialog:this.onShareToggle})}),this.state.isDeleteDialogShow&&(0,m.jsx)(te.A,{children:(0,m.jsx)(At.A,{repo:e,isRepoDeleted:this.state.isRepoDeleted,onDeleteRepo:this.onDeleteRepo,toggle:this.onDeleteToggle})}),this.state.isTransferDialogShow&&(0,m.jsx)(te.A,{children:(0,m.jsx)(xt.A,{itemName:e.repo_name,submit:this.onTransferRepo,toggleDialog:this.onTransferToggle})}),this.state.isHistorySettingDialogShow&&(0,m.jsx)(te.A,{children:(0,m.jsx)(Dt,{repoID:e.repo_id,itemName:e.repo_name,toggleDialog:this.onHistorySettingToggle})}),this.state.isChangePasswordDialogShow&&(0,m.jsx)(te.A,{children:(0,m.jsx)(Et,{repoID:e.repo_id,repoName:e.repo_name,toggleDialog:this.onChangePasswordToggle})}),this.state.isResetPasswordDialogShow&&(0,m.jsx)(te.A,{children:(0,m.jsx)(kt,{repoID:e.repo_id,toggleDialog:this.onResetPasswordToggle})}),this.state.isLabelRepoStateDialogOpen&&(0,m.jsx)(te.A,{children:(0,m.jsx)(Pt,{repoID:e.repo_id,repoName:e.repo_name,toggleDialog:this.onLabelToggle})}),this.state.isFolderPermissionDialogShow&&(0,m.jsx)(te.A,{children:(0,m.jsx)(Zt,{toggleDialog:this.onFolderPermissionToggle,repoID:e.repo_id,repoName:e.repo_name})}),this.state.isAPITokenDialogShow&&(0,m.jsx)(te.A,{children:(0,m.jsx)(on,{repo:e,onRepoAPITokenToggle:this.onAPITokenToggle})}),this.state.isRepoShareAdminDialogOpen&&(0,m.jsx)(te.A,{children:(0,m.jsx)(vn,{repo:e,toggleDialog:this.toggleRepoShareAdminDialog})}),this.state.isOldFilesAutoDelDialogOpen&&(0,m.jsx)(te.A,{children:(0,m.jsx)(yn,{repoID:e.repo_id,toggleDialog:this.toggleOldFilesAutoDelDialog})})]})}}])}(s.Component),An=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.sortByName=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortRepoList("name",t)},n.sortByTime=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortRepoList("time",t)},n.sortBySize=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortRepoList("size",t)},n.renderRepoListView=function(){return(0,m.jsx)(s.Fragment,{children:n.props.repoList.map((function(e){return(0,m.jsx)(Cn,{repo:e,isItemFreezed:n.state.isItemFreezed,onFreezedItem:n.onFreezedItem,onUnfreezedItem:n.onUnfreezedItem,onRenameRepo:n.props.onRenameRepo,onDeleteRepo:n.props.onDeleteRepo,onTransferRepo:n.props.onTransferRepo,onMonitorRepo:n.props.onMonitorRepo,currentViewMode:n.props.currentViewMode},e.repo_id)}))})},n.renderPCUI=function(){var e=n.props,t=e.inAllLibs,r=e.currentViewMode,o=void 0===r?tt.Tb:r,a=!t&&f.$0.length>0,i="asc"===n.props.sortOrder?(0,m.jsx)("span",{className:"sf3-font sf3-font-down rotate-180 d-inline-block"}):(0,m.jsx)("span",{className:"sf3-font sf3-font-down"});return o==tt.Tb?(0,m.jsxs)("table",{className:t?"table-thead-hidden":"",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"4%"}),(0,m.jsx)("th",{width:"3%",children:(0,m.jsx)("span",{className:"sr-only",children:(0,f.AP)("Library Type")})}),(0,m.jsx)("th",{width:a?"36%":"35%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:n.sortByName,children:[(0,f.AP)("Name")," ","name"===n.props.sortBy&&i]})}),(0,m.jsx)("th",{width:"10%",children:(0,m.jsx)("span",{className:"sr-only",children:(0,f.AP)("Actions")})}),(0,m.jsx)("th",{width:a?"15%":"14%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:n.sortBySize,children:[(0,f.AP)("Size")," ","size"===n.props.sortBy&&i]})}),a?(0,m.jsx)("th",{width:"17%",children:(0,f.AP)("Storage Backend")}):null,(0,m.jsx)("th",{width:a?"15%":"34%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:n.sortByTime,children:[(0,f.AP)("Last Update")," ","time"===n.props.sortBy&&i]})})]})}),(0,m.jsx)("tbody",{children:n.renderRepoListView()})]}):(0,m.jsx)("div",{className:"d-flex justify-content-between flex-wrap",children:n.renderRepoListView()})},n.renderMobileUI=function(){var e=n.props.inAllLibs;return(0,m.jsxs)("table",{className:"table-thead-hidden",children:[(0,m.jsx)(Xe,{inAllLibs:e}),(0,m.jsx)("tbody",{children:n.renderRepoListView()})]})},n.state={isItemFreezed:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)(d(),{query:"(min-width: 768px)",children:this.renderPCUI()}),(0,m.jsx)(d(),{query:"(max-width: 767.8px)",children:this.renderMobileUI()})]})}}])}(s.Component),xn=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).handleRepoNameChange=function(e){e.target.value.trim()?n.setState({isSubmitBtnActive:!0}):n.setState({isSubmitBtnActive:!1}),n.setState({repoName:e.target.value})},n.handlePassword1Change=function(e){n.setState({password1:e.target.value})},n.handlePassword2Change=function(e){n.setState({password2:e.target.value})},n.handleSubmit=function(){if(n.validateInputParams()){var e=n.prepareRepoData();if("department"===n.props.libraryType)return void n.props.onCreateRepo(e,"department");n.props.onCreateRepo(e)}},n.handleKeyDown=function(e){"Enter"===e.key&&(n.handleSubmit(),e.preventDefault())},n.toggle=function(){n.props.onCreateToggle()},n.onPermissionChange=function(e){var t=e.target.value;n.setState({permission:t})},n.handleStorageInputChange=function(e){n.setState({storage_id:e.value})},n.handlelibraryTemplatesInputChange=function(e){n.setState({library_template:e.value})},n.onEncrypted=function(e){var t=e.target.checked;n.setState({encrypt:t,disabled:!t})},n.prepareRepoData=function(){var e=n.props.libraryType,t=n.state.repoName.trim(),r=n.state.encrypt?n.state.password1:"",o=n.state.permission,a=null;"mine"!==e&&"public"!==e||(a={name:t,passwd:r}),"group"===e&&(a={repo_name:t,password:r,permission:o}),"department"===e&&(a={repo_name:t,passwd:r});var i=n.state.storage_id;i&&(a.storage_id=i);var s=n.state.library_template;return s&&(a.library_template=s),a},n.state={repoName:"",disabled:!0,encrypt:!1,password1:"",password2:"",errMessage:"",permission:"rw",storage_id:f.$0.length?f.$0[0].id:"",library_template:f.xF.length?f.xF[0]:"",isSubmitBtnActive:!1},n.templateOptions=[],n.storageOptions=[],Array.isArray(f.xF)&&f.xF.length&&(n.templateOptions=f.xF.map((function(e){return{value:e,label:e}}))),Array.isArray(f.$0)&&f.$0.length&&(n.storageOptions=f.$0.map((function(e){return{value:e.id,label:e.name}}))),n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"validateInputParams",value:function(){var e="",t=this.state.repoName.trim();if(!t.length)return e=(0,f.AP)("Name is required"),this.setState({errMessage:e}),!1;if(t.indexOf("/")>-1)return e=(0,f.AP)("Name should not include '/'."),this.setState({errMessage:e}),!1;if(this.state.encrypt){var n=this.state.password1.trim(),r=this.state.password2.trim();if(!n.length)return e=(0,f.AP)("Please enter password"),this.setState({errMessage:e}),!1;if(!r.length)return e=(0,f.AP)("Please enter the password again"),this.setState({errMessage:e}),!1;if(n.length<f.cT)return e=(0,f.AP)("Password is too short"),this.setState({errMessage:e}),!1;if(n!==r)return e=(0,f.AP)("Passwords don't match"),this.setState({errMessage:e}),!1}return!0}},{key:"render",value:function(){var e=this;return(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.toggle,autoFocus:!1,children:[(0,m.jsx)(k.A,{toggle:this.toggle,children:(0,f.AP)("New Library")}),(0,m.jsxs)(M.A,{children:[(0,m.jsxs)(bt.A,{children:[(0,m.jsxs)(_t.A,{children:[(0,m.jsx)(wt.A,{for:"repoName",children:(0,f.AP)("Name")}),(0,m.jsx)(I.A,{id:"repoName",onKeyDown:this.handleKeyDown,value:this.state.repoName,onChange:this.handleRepoNameChange,autoFocus:!0})]}),f.xF.length>0&&(0,m.jsxs)(_t.A,{children:[(0,m.jsx)(wt.A,{children:(0,f.AP)("Template")}),(0,m.jsx)(qt.by,{defaultValue:this.templateOptions[0],options:this.templateOptions,onChange:this.handlelibraryTemplatesInputChange,value:this.templateOptions.find((function(t){return t.value===e.state.library_template}))||null})]}),f.$0.length>0&&(0,m.jsxs)(_t.A,{children:[(0,m.jsx)(wt.A,{children:(0,f.AP)("Storage Backend")}),(0,m.jsx)(qt.by,{defaultValue:this.storageOptions[0],options:this.storageOptions,onChange:this.handleStorageInputChange,value:this.storageOptions.find((function(t){return t.value===e.state.storage_id}))||null})]}),"group"===this.props.libraryType&&(0,m.jsxs)(_t.A,{children:[(0,m.jsx)(wt.A,{for:"exampleSelect",children:(0,f.AP)("Permission")}),(0,m.jsxs)(I.A,{type:"select",name:"select",id:"exampleSelect",onChange:this.onPermissionChange,value:this.state.permission,children:[(0,m.jsx)("option",{value:"rw",children:(0,f.AP)("Read-Write")}),(0,m.jsx)("option",{value:"r",children:(0,f.AP)("Read-Only")})]})]}),f.L5&&(0,m.jsxs)("div",{children:[(0,m.jsxs)(_t.A,{check:!0,children:[(0,m.jsx)(I.A,{type:"checkbox",id:"encrypt",onChange:this.onEncrypted}),(0,m.jsx)(wt.A,{for:"encrypt",children:(0,f.AP)("Encrypt")})]}),!this.state.disabled&&(0,m.jsxs)(_t.A,{children:[(0,m.jsx)(wt.A,{for:"passwd1",children:(0,f.AP)("Password")}),(0,m.jsxs)("span",{className:"tip",children:[" ",(0,f.AP)("(at least {placeholder} characters)").replace("{placeholder}",f.cT)]}),(0,m.jsx)(I.A,{id:"passwd1",type:"password",disabled:this.state.disabled,value:this.state.password1,onChange:this.handlePassword1Change,autoComplete:"new-password"})]}),!this.state.disabled&&(0,m.jsxs)(_t.A,{children:[(0,m.jsx)(wt.A,{for:"passwd2",children:(0,f.AP)("Password again")}),(0,m.jsx)(I.A,{id:"passwd2",type:"password",disabled:this.state.disabled,value:this.state.password2,onChange:this.handlePassword2Change,autoComplete:"new-password"})]})]})]}),this.state.errMessage&&(0,m.jsx)(St.A,{color:"danger",children:this.state.errMessage})]}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(P.A,{color:"secondary",onClick:this.toggle,children:(0,f.AP)("Cancel")}),(0,m.jsx)(P.A,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive,children:(0,f.AP)("Submit")})]})]})}}])}(s.Component);K().locale(f.vV);var bn=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).refreshDeletedRepoList=function(e){var t=n.state.deletedRepoList.filter((function(t){return t.repo_id!==e}));n.setState({deletedRepoList:t})},n.state={deletedRepoList:[],isLoading:!0},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;S.e.listDeletedRepo().then((function(t){e.setState({deletedRepoList:t.data,isLoading:!1})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))}},{key:"render",value:function(){var e=this,t=this.state.deletedRepoList;return(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.props.toggleDialog,className:"my-deleted-repos-dialog",children:[(0,m.jsx)(k.A,{toggle:this.props.toggleDialog,children:(0,f.AP)("Deleted Libraries")}),(0,m.jsxs)(M.A,{className:"my-deleted-repos-container",children:[this.state.isLoading&&(0,m.jsx)(Z.A,{}),!this.state.isLoading&&0===t.length&&(0,m.jsx)($.A,{className:"my-deleted-repos-empty-tip",title:(0,f.AP)("No deleted libraries"),text:(0,f.AP)("You have not deleted any libraries in the last {placeholder} days. A deleted library will be cleaned automatically after this period.").replace("{placeholder}",f._R)}),0!==t.length&&(0,m.jsxs)("div",{children:[(0,m.jsx)("p",{className:"tip my-deleted-repos-tip",children:(0,f.AP)("Tip: libraries deleted {placeholder} days ago will be cleaned automatically.").replace("{placeholder}",f._R)}),(0,m.jsxs)("table",{children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"10%"}),(0,m.jsx)("th",{width:"50%",children:(0,f.AP)("Name")}),(0,m.jsx)("th",{width:"28%",children:(0,f.AP)("Deleted Time")}),(0,m.jsx)("th",{width:"12%"})]})}),(0,m.jsx)("tbody",{children:t.map((function(t){return(0,m.jsx)(_n,{repo:t,refreshDeletedRepoList:e.refreshDeletedRepoList},t.repo_id)}))})]})]})]})]})}}])}(s.Component),_n=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onMouseEnter=function(){n.setState({hideRestoreMenu:!1,highlight:!0})},n.onMouseLeave=function(){n.setState({hideRestoreMenu:!0,highlight:!1})},n.restoreDeletedRepo=function(e){e.preventDefault();var t=n.props.repo.repo_id,r=n.props.repo.repo_name;S.e.restoreDeletedRepo(t).then((function(e){var o=(0,f.AP)("Successfully restored the library {library_name}.").replace("{library_name}",r);E.A.success(o),n.props.refreshDeletedRepoList(t)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.state={hideRestoreMenu:!0,highlight:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=K().utc(this.props.repo.del_time).toDate();e=K()(e).fromNow();var t=h.Aq.getLibIconUrl(this.props.repo);return(0,m.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,tabIndex:"0",onFocus:this.onMouseEnter,children:[(0,m.jsx)("td",{className:"text-center",children:(0,m.jsx)("img",{src:t,alt:"",width:"24"})}),(0,m.jsx)("td",{className:"name",children:this.props.repo.repo_name}),(0,m.jsx)("td",{className:"update",children:e}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"#",onClick:this.restoreDeletedRepo,title:(0,f.AP)("Restore"),role:"button","aria-label":(0,f.AP)("Restore"),className:"sf2-icon-reply action-icon ".concat(this.state.highlight?"":"vh")})})]})}}])}(s.Component),wn=bn,Sn=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleSortOptionsDialog=function(){n.setState({isSortOptionsDialogOpen:!n.state.isSortOptionsDialogOpen})},n.onCreateRepo=function(e){n.toggleCreateRepoDialog(),S.e.createMineRepo(e).then((function(e){var t=new Ke({repo_id:e.data.repo_id,repo_name:e.data.repo_name,size:e.data.repo_size,mtime:e.data.mtime,owner_email:e.data.email,encrypted:e.data.encrypted,permission:e.data.permission,storage_name:e.data.storage_name});n.state.repoList.unshift(t),n.setState({repoList:n.state.repoList})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.sortRepoList=function(e,t){We.Ay.save("seafile-repo-dir-sort-by",e),We.Ay.save("seafile-repo-dir-sort-order",t),n.setState({sortBy:e,sortOrder:t,repoList:h.Aq.sortRepos(n.state.repoList,e,t)})},n.onTransferRepo=function(e){var t=n.state.repoList.filter((function(t){return t.repo_id!==e}));n.setState({repoList:t})},n.onRenameRepo=function(e,t){var r=n.state.repoList.map((function(n){return n.repo_id===e.repo_id&&(n.repo_name=t),n}));n.setState({repoList:r})},n.onMonitorRepo=function(e,t){var r=n.state.repoList.map((function(n){return n.repo_id===e.repo_id&&(n.monitored=t),n}));n.setState({repoList:r})},n.onDeleteRepo=function(e){var t=n.state.repoList.filter((function(t){return t.repo_id!==e.repo_id}));n.setState({repoList:t})},n.toggleCreateRepoDialog=function(){n.setState({isCreateRepoDialogOpen:!n.state.isCreateRepoDialogOpen})},n.toggleDeletedReposDialog=function(){n.setState({isDeletedReposDialogOpen:!n.state.isDeletedReposDialogOpen})},n.state={errorMsg:"",isLoading:!0,repoList:[],isDeletedReposDialogOpen:!1,isCreateRepoDialogOpen:!1,isSortOptionsDialogOpen:!1,sortBy:We.Ay.load("seafile-repo-dir-sort-by")||"name",sortOrder:We.Ay.load("seafile-repo-dir-sort-order")||"asc"},n.emptyTip=(0,m.jsx)($.A,{title:(0,f.AP)("No libraries"),text:(0,f.AP)('You have not created any libraries yet. A library is a container to organize your files and folders. A library can also be shared with others and synced to your connected devices. You can create a library by clicking the "New Library" button in the menu bar.')}),n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;S.e.listRepos({type:"mine"}).then((function(t){var n=t.data.repos.map((function(e){return new Ke(e)}));e.setState({isLoading:!1,repoList:h.Aq.sortRepos(n,e.state.sortBy,e.state.sortOrder)})})).catch((function(t){e.setState({isLoading:!1,errorMsg:h.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,m.jsx)(s.Fragment,{children:(0,m.jsxs)("div",{className:"main-panel-center flex-row",children:[(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsxs)("div",{className:"cur-view-path",children:[(0,m.jsxs)("h3",{className:"sf-heading m-0",children:[(0,f.AP)("My Libraries"),(0,m.jsx)(Ue,{opList:[{text:(0,f.AP)("New Library"),onClick:this.toggleCreateRepoDialog},{text:(0,f.AP)("Deleted Libraries"),onClick:this.toggleDeletedReposDialog}]})]}),(0,m.jsx)("div",{children:!h.Aq.isDesktop()&&this.state.repoList.length>0&&(0,m.jsx)("span",{className:"sf3-font sf3-font-sort action-icon",onClick:this.toggleSortOptionsDialog})})]}),(0,m.jsxs)("div",{className:"cur-view-content",children:[this.state.isLoading&&(0,m.jsx)(Z.A,{}),!this.state.isLoading&&this.state.errorMsg&&(0,m.jsx)("p",{className:"error text-center mt-8",children:this.state.errorMsg}),!this.state.isLoading&&!this.state.errorMsg&&0===this.state.repoList.length&&this.emptyTip,!this.state.isLoading&&!this.state.errorMsg&&this.state.repoList.length>0&&(0,m.jsx)(An,{sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,repoList:this.state.repoList,onRenameRepo:this.onRenameRepo,onDeleteRepo:this.onDeleteRepo,onTransferRepo:this.onTransferRepo,onMonitorRepo:this.onMonitorRepo,sortRepoList:this.sortRepoList})]})]}),this.state.isSortOptionsDialogOpen&&(0,m.jsx)(je,{toggleDialog:this.toggleSortOptionsDialog,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortRepoList}),this.state.isCreateRepoDialogOpen&&(0,m.jsx)(te.A,{children:(0,m.jsx)(xn,{libraryType:"mine",onCreateRepo:this.onCreateRepo,onCreateToggle:this.toggleCreateRepoDialog})}),this.state.isDeletedReposDialogOpen&&(0,m.jsx)(te.A,{children:(0,m.jsx)(wn,{toggleDialog:this.toggleDeletedReposDialog})})]})})}}])}(s.Component);K().locale(f.vV);var Dn=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).refreshDeletedRepoList=function(e){var t=n.state.deletedRepoList.filter((function(t){return t.repo_id!==e}));n.setState({deletedRepoList:t})},n.state={deletedRepoList:[],isLoading:!0},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;S.e.listDeletedRepo().then((function(t){e.setState({deletedRepoList:t.data,isLoading:!1})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))}},{key:"render",value:function(){return(0,m.jsx)(s.Fragment,{children:(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)("div",{className:"cur-view-path",children:(0,m.jsxs)("div",{className:"path-container",children:[(0,m.jsx)(c.N_,{to:f.Yc+"my-libs/",children:(0,f.AP)("My Libraries")}),(0,m.jsx)("span",{className:"path-split",children:"/"}),(0,m.jsx)("span",{children:(0,f.AP)("Deleted Libraries")})]})}),(0,m.jsxs)("div",{className:"cur-view-content",children:[this.state.isLoading&&(0,m.jsx)(Z.A,{}),!this.state.isLoading&&0===this.state.deletedRepoList.length&&(0,m.jsx)($.A,{title:(0,f.AP)("No deleted libraries"),text:(0,f.AP)("You have not deleted any libraries in the last {placeholder} days. A deleted library will be cleaned automatically after this period.").replace("{placeholder}",f._R)}),0!==this.state.deletedRepoList.length&&(0,m.jsxs)("div",{children:[(0,m.jsx)("p",{className:"tip mt-2",children:(0,f.AP)("Tip: libraries deleted {placeholder} days ago will be cleaned automatically.").replace("{placeholder}",f._R)}),(0,m.jsx)(En,{deletedRepoList:this.state.deletedRepoList,refreshDeletedRepoList:this.refreshDeletedRepoList})]})]})]})})})}}])}(s.Component),En=function(e){function t(){return(0,r.A)(this,t),(0,a.A)(this,t,arguments)}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props.deletedRepoList;return(0,m.jsxs)("table",{children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{style:{width:"4%"}}),(0,m.jsx)("th",{style:{width:"52%"},children:(0,f.AP)("Name")}),(0,m.jsx)("th",{style:{width:"30%"},children:(0,f.AP)("Deleted Time")}),(0,m.jsx)("th",{style:{width:"14%"}})]})}),(0,m.jsx)("tbody",{children:t&&t.map((function(t){return(0,m.jsx)(kn,{repo:t,refreshDeletedRepoList:e.props.refreshDeletedRepoList},t.repo_id)}))})]})}}])}(s.Component),kn=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onMouseEnter=function(){n.setState({hideRestoreMenu:!1,highlight:!0})},n.onMouseLeave=function(){n.setState({hideRestoreMenu:!0,highlight:!1})},n.restoreDeletedRepo=function(e){e.preventDefault();var t=n.props.repo.repo_id,r=n.props.repo.repo_name;S.e.restoreDeletedRepo(t).then((function(e){var o=(0,f.AP)("Successfully restored the library.")+"  "+r;E.A.success(o),n.props.refreshDeletedRepoList(t)})).catch((function(e){var t=h.Aq.getErrorMsg(e);t===(0,f.AP)("Error")&&(t=(0,f.AP)("Failed. Please check the network.")),E.A.danger(t)}))},n.state={hideRestoreMenu:!0,highlight:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=K().utc(this.props.repo.del_time).toDate();e=K()(e).fromNow();var t=h.Aq.getLibIconUrl(this.props.repo);return(0,m.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,tabIndex:"0",onFocus:this.onMouseEnter,children:[(0,m.jsx)("td",{className:"text-center",children:(0,m.jsx)("img",{src:t,alt:"",width:"24"})}),(0,m.jsx)("td",{className:"name",children:this.props.repo.repo_name}),(0,m.jsx)("td",{className:"update",children:e}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"#",onClick:this.restoreDeletedRepo,title:(0,f.AP)("Restore"),role:"button","aria-label":(0,f.AP)("Restore"),className:"sf2-icon-reply action-icon ".concat(this.state.highlight?"":"vh")})})]})}}])}(s.Component),Mn=Dn,In=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onMouseEnter=function(){n.props.isItemFreezed||n.setState({highlight:!0,isOperationShow:!0})},n.onMouseOver=function(){n.props.isItemFreezed||n.setState({highlight:!0,isOperationShow:!0})},n.onMouseLeave=function(){n.props.isItemFreezed||n.setState({highlight:!1,isOperationShow:!1})},n.clickOperationMenuToggle=function(e){n.toggleOperationMenu(e)},n.onDropdownToggleKeyDown=function(e){"Enter"!=e.key&&"Space"!=e.key||n.clickOperationMenuToggle(e)},n.toggleOperationMenu=function(e){var t=e.target?e.target.dataset:null;t&&t.toggle&&"Rename"===t.toggle?n.setState({isItemMenuShow:!n.state.isItemMenuShow}):n.setState({isItemMenuShow:!n.state.isItemMenuShow},(function(){n.state.isItemMenuShow?n.props.onFreezedItem():(n.props.onUnfreezedItem(),n.setState({highlight:!1,isOperationShow:!1}))}))},n.toggleAdvancedMenuShown=function(e){n.setState({isAdvancedMenuShown:!0})},n.toggleAdvancedMenu=function(e){e.stopPropagation(),n.setState({isAdvancedMenuShown:!n.state.isAdvancedMenuShown},(function(){n.toggleOperationMenu(e)}))},n.onDropDownMouseMove=function(e){n.state.isAdvancedMenuShown&&e.target&&"dropdown-item"===e.target.className&&n.setState({isAdvancedMenuShown:!1})},n.getRepoComputeParams=function(){var e=n.props,t=e.repo,r=e.currentViewMode==tt.nj;return{iconUrl:h.Aq.getLibIconUrl(t,r),iconTitle:h.Aq.getLibIconTitle(t),libPath:"".concat(f.Yc,"library/").concat(t.repo_id,"/").concat(h.Aq.encodePath(t.repo_name),"/")}},n.onMenuItemKeyDown=function(e){"Enter"!=e.key&&"Space"!=e.key||n.onMenuItemClick(e)},n.onMenuItemClick=function(e){switch(e.target.dataset.toggle){case"Rename":n.onItemRenameToggle();break;case"Folder Permission":n.onItemFolderPermissionToggle();break;case"Share":n.onItemShare();break;case"Unshare":n.onItemUnshare();break;case"History Setting":n.onHistorySettingToggle();break;case"API Token":n.onAPITokenToggle();break;case"Share Admin":n.toggleRepoShareAdminDialog();break;case"Change Password":n.onChangePasswordToggle();break;case"Reset Password":n.onResetPasswordToggle();break;case"Watch File Changes":n.watchFileChanges();break;case"Unwatch File Changes":n.unwatchFileChanges();break;case"Old Files Auto Delete":n.toggleOldFilesAutoDelDialog()}},n.watchFileChanges=function(){var e=n.props.repo;S.e.monitorRepo(e.repo_id).then((function(){n.props.onMonitorRepo(e,!0)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.unwatchFileChanges=function(){var e=n.props.repo;S.e.unMonitorRepo(e.repo_id).then((function(){n.props.onMonitorRepo(e,!1)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.onItemRenameToggle=function(){n.props.onFreezedItem(),n.setState({isRenaming:!n.state.isRenaming,isOperationShow:!n.state.isOperationShow})},n.onRenameConfirm=function(e){n.props.onItemRename(n.props.repo,e),n.onRenameCancel()},n.onRenameCancel=function(){n.props.onUnfreezedItem(),n.setState({isRenaming:!n.state.isRenaming})},n.onItemFolderPermissionToggle=function(){n.setState({isFolderPermissionDialogOpen:!n.state.isFolderPermissionDialogOpen})},n.onHistorySettingToggle=function(){n.setState({isHistorySettingDialogShow:!n.state.isHistorySettingDialogShow})},n.onItemShare=function(){n.setState({isShowSharedDialog:!0})},n.onItemUnshare=function(){n.props.onItemUnshare(n.props.repo)},n.onItemDeleteToggle=function(){n.setState({isDeleteDialogShow:!n.state.isDeleteDialogShow})},n.onItemDelete=function(){var e=n.props,t=e.currentGroup,r=e.repo;if(t){var o=t.id;S.e.deleteGroupOwnedLibrary(o,r.repo_id).then((function(){n.setState({isRepoDeleted:!0,isDeleteDialogShow:!1}),n.props.onItemDelete(r);var e=r.repo_name,t=(0,f.AP)("Successfully deleted {name}.").replace("{name}",e);E.A.success(t)})).catch((function(e){var t=h.Aq.getErrorMsg(e);if(t===(0,f.AP)("Error")){var o=r.repo_name;t=(0,f.AP)("Failed to delete {name}.").replace("{name}",o)}E.A.danger(t),n.setState({isRepoDeleted:!1})}))}},n.toggleShareDialog=function(){n.setState({isShowSharedDialog:!1})},n.toggleRepoShareAdminDialog=function(){n.setState({isRepoShareAdminDialogOpen:!n.state.isRepoShareAdminDialogOpen})},n.toggleOldFilesAutoDelDialog=function(){n.setState({isOldFilesAutoDelDialogOpen:!n.state.isOldFilesAutoDelDialogOpen})},n.onAPITokenToggle=function(){n.setState({isAPITokenDialogShow:!n.state.isAPITokenDialogShow})},n.onChangePasswordToggle=function(){n.setState({isChangePasswordDialogShow:!n.state.isChangePasswordDialogShow})},n.onResetPasswordToggle=function(){n.setState({isResetPasswordDialogShow:!n.state.isResetPasswordDialogShow})},n.translateMenuItem=function(e){var t="";switch(e){case"Rename":t=(0,f.AP)("Rename");break;case"Folder Permission":t=(0,f.AP)("Folder Permission");break;case"Unshare":t=(0,f.AP)("Unshare");break;case"Share":t=(0,f.AP)("Share");break;case"History Setting":t=(0,f.AP)("History Setting");break;case"Share Admin":t=(0,f.AP)("Share Admin");break;case"Change Password":t=(0,f.AP)("Change Password");break;case"Reset Password":t=(0,f.AP)("Reset Password");break;case"Watch File Changes":t=(0,f.AP)("Watch File Changes");break;case"Unwatch File Changes":t=(0,f.AP)("Unwatch File Changes");break;case"Old Files Auto Delete":t=(0,f.AP)("Auto Deletion Setting");break;case"API Token":t="API Token";break;case"Advanced":t=(0,f.AP)("Advanced");break;case"SeaTable integration":t=(0,f.AP)("SeaTable integration")}return t},n.getAdvancedOperations=function(){var e=[];return e.push("API Token"),f.if&&e.push("Old Files Auto Delete"),e},n.generatorOperations=function(){var e=n.props,t=e.repo,r=e.currentGroup,o=r&&r.admins&&r.admins.indexOf(f.Xh)>-1,a=t.owner_email===f.Xh,i=t.is_admin,s=[];if(f.am){if(-1!=t.owner_email.indexOf("@seafile_group")){if(o){if(t.owner_email==r.id+"@seafile_group"){if(n.isDeparementOnwerGroupMember=!0,s=["Rename"],f.wR&&s.push("Folder Permission"),s.push("Share Admin","Divider"),t.encrypted&&s.push("Change Password"),t.encrypted&&f.ez&&f.bw&&s.push("Reset Password"),"r"==t.permission||"rw"==t.permission){var l=t.monitored?"Unwatch File Changes":"Watch File Changes";s.push(l)}return s.push("Divider","History Setting"),h.Aq.isDesktop()&&s.push("Advanced"),s}s.push("Unshare")}}else(a||i)&&s.push("Share"),(o||a||i)&&s.push("Unshare");if("r"==t.permission||"rw"==t.permission){var c=t.monitored?"Unwatch File Changes":"Watch File Changes";s.push(c)}}else a&&s.push("Share"),(o||a)&&s.push("Unshare");return s},n.generatorMobileMenu=function(){var e=[];if(n.props.libraryType&&"public"===n.props.libraryType){var t=n.props.repo.owner_email===f.Xh;(f.Gn||t)&&e.push("Unshare")}else e=n.generatorOperations().filter((function(e){return"Divider"!=e})),n.isDeparementOnwerGroupMember&&(e.unshift("Unshare"),e.unshift("Share"));return e.length?(0,m.jsxs)(ue.A,{isOpen:n.state.isItemMenuShow,toggle:n.toggleOperationMenu,children:[(0,m.jsx)(de.A,{tag:"i",className:"sf-dropdown-toggle sf3-font sf3-font-more-vertical ml-0",title:(0,f.AP)("More operations"),"aria-label":(0,f.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":n.state.isItemMenuShow,onClick:n.clickOperationMenuToggle}),(0,m.jsxs)("div",{className:"".concat(n.state.isItemMenuShow?"":"d-none"),onClick:n.toggleOperationMenu,children:[(0,m.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),(0,m.jsx)("div",{className:"mobile-operation-menu",children:e.map((function(e,t){return(0,m.jsx)(pe.A,{"data-toggle":e,onClick:n.onMenuItemClick,children:n.translateMenuItem(e)},t)}))})]})]}):null},n.generatorPCMenu=function(){var e=[];if(n.props.libraryType&&"public"===n.props.libraryType){var t=n.props.repo.owner_email===f.Xh;(f.Gn||t)&&e.push("Unshare")}else e=n.generatorOperations();var r=(0,m.jsx)("i",{className:"op-icon sf3-font-share sf3-font",title:(0,f.AP)("Share"),role:"button","aria-label":(0,f.AP)("Share"),onClick:n.onItemShare}),o=(0,m.jsx)("i",{className:"op-icon sf2-icon-x3",title:(0,f.AP)("Unshare"),role:"button","aria-label":(0,f.AP)("Unshare"),onClick:n.onItemUnshare}),a=(0,m.jsx)("i",{className:"op-icon sf3-font-delete1 sf3-font",title:(0,f.AP)("Delete"),role:"button","aria-label":(0,f.AP)("Delete"),onClick:n.onItemDeleteToggle});if(n.isDeparementOnwerGroupMember){var i=n.getAdvancedOperations();return(0,m.jsxs)(s.Fragment,{children:[r,a,(0,m.jsxs)(ue.A,{isOpen:n.state.isItemMenuShow,toggle:n.toggleOperationMenu,children:[(0,m.jsx)(de.A,{tag:"i",role:"button",tabIndex:"0",className:"sf-dropdown-toggle sf3-font-more sf3-font",title:(0,f.AP)("More operations"),"aria-label":(0,f.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":n.state.isItemMenuShow,"aria-haspopup":!0,style:{minWidth:"0"},onClick:n.clickOperationMenuToggle,onKeyDown:n.onDropdownToggleKeyDown}),(0,m.jsx)(Fe.A,{onMouseMove:n.onDropDownMouseMove,children:e.map((function(e,t){return"Divider"==e?(0,m.jsx)(pe.A,{divider:!0},t):"Advanced"==e?(0,m.jsxs)(ue.A,{direction:"right",className:"w-100",isOpen:n.state.isAdvancedMenuShown,toggle:n.toggleAdvancedMenu,onMouseMove:function(e){e.stopPropagation()},children:[(0,m.jsxs)(de.A,{className:"dropdown-item font-weight-normal rounded-0 d-flex justify-content-between align-items-center pr-2",onMouseEnter:n.toggleAdvancedMenuShown,children:[n.translateMenuItem(e),(0,m.jsx)("i",{className:"sf3-font-down sf3-font rotate-270"})]}),(0,m.jsx)(Fe.A,{children:i.map((function(e,t){return(0,m.jsx)(pe.A,{"data-toggle":e,onClick:n.onMenuItemClick,onKeyDown:n.onMenuItemKeyDown,children:n.translateMenuItem(e)},t)}))})]},t):(0,m.jsx)(pe.A,{"data-toggle":e,onClick:n.onMenuItemClick,onKeyDown:n.onMenuItemKeyDown,children:n.translateMenuItem(e)},t)}))})]})]})}return(0,m.jsx)(s.Fragment,{children:e.map((function(e){switch(e){case"Share":return(0,m.jsx)(s.Fragment,{children:r},e);case"Unshare":return(0,m.jsx)(s.Fragment,{children:o},e);case"Watch File Changes":case"Unwatch File Changes":return(0,m.jsxs)(ue.A,{isOpen:n.state.isItemMenuShow,toggle:n.toggleOperationMenu,children:[(0,m.jsx)(de.A,{tag:"i",role:"button",tabIndex:"0",className:"sf-dropdown-toggle sf3-font-more sf3-font",title:(0,f.AP)("More operations"),"aria-label":(0,f.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":n.state.isItemMenuShow,"aria-haspopup":!0,style:{minWidth:"0"},onClick:n.clickOperationMenuToggle,onKeyDown:n.onDropdownToggleKeyDown}),(0,m.jsx)(Fe.A,{children:[e].map((function(e,t){return(0,m.jsx)(pe.A,{"data-toggle":e,onClick:n.onMenuItemClick,onKeyDown:n.onMenuItemKeyDown,children:n.translateMenuItem(e)},t)}))})]},e);default:return null}}))})},n.onToggleStarRepo=function(e){e.preventDefault();var t=n.props.repo.repo_name;n.state.isStarred?S.e.unstarItem(n.props.repo.repo_id,"/").then((function(){n.setState({isStarred:!n.state.isStarred});var e=(0,f.AP)("Successfully unstarred {library_name_placeholder}.").replace("{library_name_placeholder}",t);E.A.success(e)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)})):S.e.starItem(n.props.repo.repo_id,"/").then((function(){n.setState({isStarred:!n.state.isStarred});var e=(0,f.AP)("Successfully starred {library_name_placeholder}.").replace("{library_name_placeholder}",t);E.A.success(e)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.renderPCUI=function(){var e=n.state.isStarred,t=n.getRepoComputeParams(),r=t.iconUrl,o=t.iconTitle,a=t.libPath,i=n.props,l=i.repo;return i.currentViewMode==tt.Tb?(0,m.jsxs)("tr",{className:n.state.highlight?"tr-highlight":"",onMouseEnter:n.onMouseEnter,onMouseOver:n.onMouseOver,onMouseLeave:n.onMouseLeave,onFocus:n.onMouseEnter,children:[(0,m.jsx)("td",{className:"text-center",children:(0,m.jsx)("i",{role:"button",title:n.state.isStarred?(0,f.AP)("Unstar"):(0,f.AP)("Star"),"aria-label":n.state.isStarred?(0,f.AP)("Unstar"):(0,f.AP)("Star"),onClick:n.onToggleStarRepo,className:"op-icon m-0 ".concat(n.state.isStarred?"sf3-font-star":"sf3-font-star-empty"," sf3-font")})}),(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:r,title:o,alt:o,width:"24"})}),(0,m.jsx)("td",{children:n.state.isRenaming?(0,m.jsx)(Xt.A,{name:l.repo_name,onRenameConfirm:n.onRenameConfirm,onRenameCancel:n.onRenameCancel}):(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)(c.N_,{to:a,children:l.repo_name}),l.monitored&&(0,m.jsx)(et,{repoID:l.repo_id,className:"ml-1 op-icon"})]})}),(0,m.jsx)("td",{children:n.state.isOperationShow&&n.generatorPCMenu()}),(0,m.jsx)("td",{children:l.size}),(0,m.jsx)("td",{title:K()(l.last_modified).format("llll"),children:K()(l.last_modified).fromNow()}),(0,m.jsx)("td",{title:l.owner_contact_email,children:l.owner_name})]}):(0,m.jsxs)("div",{className:"library-grid-item px-3 d-flex justify-content-between align-items-center",onMouseEnter:n.onMouseEnter,onMouseLeave:n.onMouseLeave,onFocus:n.onMouseEnter,children:[(0,m.jsxs)("div",{className:"d-flex align-items-center text-truncate",children:[(0,m.jsx)("img",{src:r,title:o,alt:o,width:"36",className:"mr-2"}),n.state.isRenaming?(0,m.jsx)(Xt.A,{name:l.repo_name,onRenameConfirm:n.onRenameConfirm,onRenameCancel:n.onRenameCancel}):(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)(c.N_,{to:a,className:"library-name text-truncate",title:l.repo_name,children:l.repo_name}),e&&(0,m.jsx)("i",{role:"button",title:(0,f.AP)("Unstar"),"aria-label":(0,f.AP)("Unstar"),onClick:n.onToggleStarRepo,className:"op-icon library-grid-item-icon sf3-font-star sf3-font"}),l.monitored&&(0,m.jsx)(et,{repoID:l.repo_id,className:"op-icon library-grid-item-icon"})]})]}),(0,m.jsx)("div",{className:"flex-shrink-0",children:n.state.isOperationShow&&n.generatorPCMenu()})]})},n.visitRepo=function(){n.state.isRenaming||(0,c.oo)(n.repoURL)},n.renderMobileUI=function(){var e=n.getRepoComputeParams(),t=e.iconUrl,r=e.iconTitle,o=e.libPath,a=n.props.repo;return n.repoURL=o,(0,m.jsx)(s.Fragment,{children:(0,m.jsxs)("tr",{className:n.state.highlight?"tr-highlight":"",onMouseEnter:n.onMouseEnter,onMouseOver:n.onMouseOver,onMouseLeave:n.onMouseLeave,children:[(0,m.jsx)("td",{onClick:n.visitRepo,children:(0,m.jsx)("img",{src:t,title:r,width:"24",alt:r})}),(0,m.jsxs)("td",{onClick:n.visitRepo,children:[n.state.isRenaming?(0,m.jsx)(Xt.A,{name:a.repo_name,onRenameConfirm:n.onRenameConfirm,onRenameCancel:n.onRenameCancel}):(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)(c.N_,{to:o,children:a.repo_name}),a.monitored&&(0,m.jsx)(et,{repoID:a.repo_id,className:"ml-1 op-icon"})]}),(0,m.jsx)("br",{}),(0,m.jsx)("span",{className:"item-meta-info",title:a.owner_contact_email,children:a.owner_name}),(0,m.jsx)("span",{className:"item-meta-info",children:a.size}),(0,m.jsx)("span",{className:"item-meta-info",title:K()(a.last_modified).format("llll"),children:K()(a.last_modified).fromNow()})]}),(0,m.jsx)("td",{children:n.generatorMobileMenu()})]})})},n.state={highlight:!1,isOperationShow:!1,isItemMenuShow:!1,isAdvancedMenuShown:!1,isShowSharedDialog:!1,isRenaming:!1,isStarred:n.props.repo.starred,isFolderPermissionDialogOpen:!1,isHistorySettingDialogShow:!1,isDeleteDialogShow:!1,isAPITokenDialogShow:!1,isRepoShareAdminDialogOpen:!1,isRepoDeleted:!1,isChangePasswordDialogShow:!1,isResetPasswordDialogShow:!1,isOldFilesAutoDelDialogOpen:!1},n.isDeparementOnwerGroupMember=!1,n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.repo,t=e.owner_email.indexOf("@seafile_group")>-1;return(0,m.jsxs)(s.Fragment,{children:[h.Aq.isDesktop()?this.renderPCUI():this.renderMobileUI(),this.state.isShowSharedDialog&&(0,m.jsx)(te.A,{children:(0,m.jsx)($e.A,{itemType:"library",itemName:e.repo_name,itemPath:"/",repoID:e.repo_id,repoEncrypted:e.encrypted,enableDirPrivateShare:!0,userPerm:e.permission,isAdmin:e.is_admin,isGroupOwnedRepo:t,toggleDialog:this.toggleShareDialog})}),this.state.isFolderPermissionDialogOpen&&(0,m.jsx)(te.A,{children:(0,m.jsx)(Zt,{toggleDialog:this.onItemFolderPermissionToggle,repoID:e.repo_id,repoName:e.repo_name,isDepartmentRepo:!0})}),this.state.isDeleteDialogShow&&(0,m.jsx)(te.A,{children:(0,m.jsx)(At.A,{repo:this.props.repo,isRepoDeleted:this.state.isRepoDeleted,onDeleteRepo:this.onItemDelete,toggle:this.onItemDeleteToggle})}),this.state.isHistorySettingDialogShow&&(0,m.jsx)(te.A,{children:(0,m.jsx)(Dt,{repoID:e.repo_id,itemName:e.repo_name,toggleDialog:this.onHistorySettingToggle})}),this.state.isAPITokenDialogShow&&(0,m.jsx)(te.A,{children:(0,m.jsx)(on,{repo:e,onRepoAPITokenToggle:this.onAPITokenToggle})}),this.state.isRepoShareAdminDialogOpen&&(0,m.jsx)(te.A,{children:(0,m.jsx)(vn,{repo:e,toggleDialog:this.toggleRepoShareAdminDialog})}),this.state.isChangePasswordDialogShow&&(0,m.jsx)(te.A,{children:(0,m.jsx)(Et,{repoID:e.repo_id,repoName:e.repo_name,toggleDialog:this.onChangePasswordToggle})}),this.state.isResetPasswordDialogShow&&(0,m.jsx)(te.A,{children:(0,m.jsx)(kt,{repoID:e.repo_id,toggleDialog:this.onResetPasswordToggle})}),this.state.isOldFilesAutoDelDialogOpen&&(0,m.jsx)(te.A,{children:(0,m.jsx)(yn,{repoID:e.repo_id,toggleDialog:this.toggleOldFilesAutoDelDialog})})]})}}])}(s.Component),Nn=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).sortByName=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortItems("name",t)},n.sortByTime=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortItems("time",t)},n.sortBySize=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortItems("size",t)},n.getSortMetaData=function(){return{sortByName:"name"==n.props.sortBy,sortByTime:"time"==n.props.sortBy,sortBySize:"size"==n.props.sortBy,sortIcon:"asc"==n.props.sortOrder?(0,m.jsx)("span",{className:"sf3-font sf3-font-down rotate-180 d-inline-block"}):(0,m.jsx)("span",{className:"sf3-font sf3-font-down"})}},n.onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.onItemRename=function(e,t){if(n.props.repoList.some((function(e){return e.name===t}))){var r=(0,f.AP)('The name "{name}" is already taken. Please choose a different name.');return r=r.replace("{name}",h.Aq.HTMLescape(t)),E.A.danger(r),!1}n.props.onItemRename(e,t)},n.renderRepoListView=function(){var e=n.props.currentViewMode,t=void 0===e?tt.Tb:e;return(0,m.jsx)(s.Fragment,{children:n.props.repoList.map((function(e){return(0,m.jsx)(In,{repo:e,libraryType:n.props.libraryType,currentGroup:n.props.currentGroup,isItemFreezed:n.state.isItemFreezed,onFreezedItem:n.onFreezedItem,onUnfreezedItem:n.onUnfreezedItem,onItemUnshare:n.props.onItemUnshare,onItemDelete:n.props.onItemDelete,onItemRename:n.props.onItemRename,onMonitorRepo:n.props.onMonitorRepo,currentViewMode:t},e.repo_id)}))})},n.renderPCUI=function(){var e=n.props,t=e.theadHidden,r=void 0!==t&&t,o=e.currentViewMode,a=void 0===o?tt.Tb:o,i=n.getSortMetaData(),s=i.sortByName,l=i.sortByTime,c=i.sortBySize,u=i.sortIcon;return a==tt.Tb?(0,m.jsxs)("table",{className:r?"table-thead-hidden":"",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"4%"}),(0,m.jsx)("th",{width:"3%",children:(0,m.jsx)("span",{className:"sr-only",children:(0,f.AP)("Library Type")})}),(0,m.jsx)("th",{width:"35%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:n.sortByName,children:[(0,f.AP)("Name")," ",s&&u]})}),(0,m.jsx)("th",{width:"10%",children:(0,m.jsx)("span",{className:"sr-only",children:(0,f.AP)("Actions")})}),(0,m.jsx)("th",{width:"14%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:n.sortBySize,children:[(0,f.AP)("Size")," ",c&&u]})}),(0,m.jsx)("th",{width:"17%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:n.sortByTime,children:[(0,f.AP)("Last Update")," ",l&&u]})}),(0,m.jsx)("th",{width:"17%",children:(0,f.AP)("Owner")})]})}),(0,m.jsx)("tbody",{children:n.renderRepoListView()})]}):(0,m.jsx)("div",{className:"d-flex justify-content-between flex-wrap",children:n.renderRepoListView()})},n.renderMobileUI=function(){var e=n.props.inAllLibs,t=void 0!==e&&e;return(0,m.jsxs)("table",{className:"table-thead-hidden",children:[(0,m.jsx)(Xe,{inAllLibs:t}),(0,m.jsx)("tbody",{children:n.renderRepoListView()})]})},n.state={isItemFreezed:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=h.Aq.isDesktop()?this.renderPCUI():this.renderMobileUI();return this.props.hasNextPage?(0,m.jsxs)(s.Fragment,{children:[e,(0,m.jsx)(Z.A,{})]}):e}}])}(s.Component),Pn=function(e){function t(){var e;(0,r.A)(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(e=(0,a.A)(this,t,[].concat(o))).onRepoSelect=function(t){var n=t.target.checked;e.props.onRepoSelect(e.props.repo,n)},e.onPermissionChange=function(t){var n=t.target.value,r=e.props.repo;e.props.onPermissionChange(r,n)},e}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.repo,t=h.Aq.getLibIconUrl(e);return(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{className:"text-center",children:(0,m.jsx)("input",{type:"checkbox",className:"vam",name:"repo",onChange:this.onRepoSelect})}),(0,m.jsx)("td",{className:"text-center",children:(0,m.jsx)("img",{src:t,width:"24",alt:(0,f.AP)("icon")})}),(0,m.jsx)("td",{className:"name",children:e.repo_name}),(0,m.jsx)("td",{children:K()(e.last_modified).fromNow()}),(0,m.jsx)("td",{children:(0,m.jsxs)(I.A,{style:{height:"1.5rem",padding:0},type:"select",name:"select",onChange:this.onPermissionChange,value:e.sharePermission,children:[(0,m.jsx)("option",{value:"rw",children:(0,f.AP)("Read-Write")}),(0,m.jsx)("option",{value:"r",children:(0,f.AP)("Read-Only")})]})})]})}}])}(s.Component),Tn=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onRepoSelect=function(e,t){var r=[];t?(n.state.selectedRepoList.push(e),r=n.state.selectedRepoList):r=n.state.selectedRepoList.filter((function(t){return t.repo_id!==e.repo_id})),n.setState({selectedRepoList:r})},n.onPermissionChange=function(e,t){var r=n.state.repoList.map((function(n){return n.repo_id===e.repo_id&&(n.sharePermission=t),n}));n.setState({repoList:r})},n.handleSubmit=function(){if(0!==n.state.selectedRepoList.length)n.props.onRepoSelectedHandler(n.state.selectedRepoList),n.toggle();else{var e=(0,f.AP)("Please select a library to share.");n.setState({errMessage:e})}},n.toggle=function(){n.props.onShareRepoDialogClose()},n.state={repoList:[],currentRepo:null,permission:"rw",selectedRepoList:[],errMessage:""},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;S.e.listRepos({type:"mine"}).then((function(t){var n=t.data.repos.map((function(e){var t=new Ke(e);return t.sharePermission="rw",t}));e.setState({repoList:n})}))}},{key:"render",value:function(){var e=this;return(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.toggle,children:[(0,m.jsx)(k.A,{toggle:this.toggle,children:(0,f.AP)("Select libraries to share")}),(0,m.jsx)(M.A,{className:"dialog-list-container",children:(0,m.jsxs)("table",{children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"4%"}),(0,m.jsx)("th",{width:"6%"}),(0,m.jsx)("th",{width:"35%",children:(0,f.AP)("Name")}),(0,m.jsx)("th",{width:"25%",children:(0,f.AP)("Last Update")}),(0,m.jsx)("th",{width:"30%",children:(0,f.AP)("Permission")})]})}),(0,m.jsx)("tbody",{children:this.state.repoList.map((function(t,n){return(0,m.jsx)(Pn,{repo:t,onRepoSelect:e.onRepoSelect,onPermissionChange:e.onPermissionChange},n)}))})]})}),this.state.errMessage&&(0,m.jsx)(St.A,{color:"danger",className:"mt-2",children:this.state.errMessage}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(P.A,{color:"secondary",onClick:this.toggle,children:(0,f.AP)("Close")}),(0,m.jsx)(P.A,{color:"primary",onClick:this.handleSubmit,children:(0,f.AP)("Submit")})]})]})}}])}(s.Component),On=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onItemUnshare=function(e){S.e.unshareRepo(e.repo_id,{share_type:"public"}).then((function(){var t=n.state.repoList.filter((function(t){return t.repo_id!==e.repo_id}));n.setState({repoList:t});var r=(0,f.AP)("Successfully unshared {name}").replace("{name}",e.repo_name);E.A.success(r)})).catch((function(t){var n=h.Aq.getErrorMsg(t);n===(0,f.AP)("Error")&&(n=(0,f.AP)("Failed to unshare {name}").replace("{name}",e.repo_name)),(0,E.A)(n)}))},n.onItemDelete=function(){},n.addRepoItem=function(e){for(var t=!1,r=0,o=n.state.repoList,a=0;a<o.length;a++)if(e.repo_id===o[a].repo_id){t=!0,r=a;break}t&&n.state.repoList.splice(r,1);var i=n.state.repoList.map((function(e){return e}));i.unshift(e),n.setState({repoList:i})},n.sortItems=function(e,t){We.Ay.save("seafile-repo-dir-sort-by",e),We.Ay.save("seafile-repo-dir-sort-order",t),n.setState({sortBy:e,sortOrder:t,repoList:h.Aq.sortRepos(n.state.repoList,e,t)})},n.toggleSortOptionsDialog=function(){n.setState({isSortOptionsDialogOpen:!n.state.isSortOptionsDialogOpen})},n.renderContent=function(){var e=n.props,t=e.inAllLibs,r=void 0!==t&&t,o=e.currentViewMode,a=void 0===o?tt.Tb:o,i=n.state.errMessage,s=r?(0,m.jsx)("p",{className:"libraries-empty-tip-in-".concat(a,"-mode"),children:(0,f.AP)("No public libraries")}):(0,m.jsx)($.A,{title:(0,f.AP)("No public libraries"),text:(0,f.AP)('No public libraries have been created yet. A public library is accessible by all users. You can create a public library by clicking the "Add Library" button in the menu bar.')});return(0,m.jsxs)(m.Fragment,{children:[n.state.isLoading&&(0,m.jsx)(Z.A,{}),!n.state.isLoading&&i&&i,!n.state.isLoading&&0===n.state.repoList.length&&s,!n.state.isLoading&&n.state.repoList.length>0&&(0,m.jsx)(Nn,{libraryType:n.state.libraryType,repoList:n.state.repoList,sortBy:n.state.sortBy,sortOrder:n.state.sortOrder,sortItems:n.sortItems,onItemUnshare:n.onItemUnshare,onItemDelete:n.onItemDelete,theadHidden:r,currentViewMode:a,inAllLibs:r})]})},n.renderSortIconInMobile=function(){return(0,m.jsx)(m.Fragment,{children:!h.Aq.isDesktop()&&n.state.repoList.length>0&&(0,m.jsx)("span",{className:"sf3-font sf3-font-sort action-icon",onClick:n.toggleSortOptionsDialog})})},n.onCreateRepoToggle=function(){n.setState({isCreateRepoDialogOpen:!n.state.isCreateRepoDialogOpen})},n.onSelectRepoToggle=function(){n.setState({isSelectRepoDialogOpen:!n.state.isSelectRepoDialogOpen})},n.onCreateRepo=function(e){n.onCreateRepoToggle(),S.e.createPublicRepo(e).then((function(e){var t={repo_id:e.data.id,repo_name:e.data.name,permission:e.data.permission,size:e.data.size,owner_name:e.data.owner_name,owner_email:e.data.owner,mtime:e.data.mtime,encrypted:e.data.encrypted},r=new Ke(t);n.addRepoItem(r)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.onRepoSelectedHandler=function(e){e.forEach((function(e){S.e.selectOwnedRepoToPublic(e.repo_id,{share_type:"public",permission:e.sharePermission}).then((function(){n.addRepoItem(e)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))}))},n.state={isLoading:!0,errMessage:"",repoList:[],isCreateRepoDialogOpen:!1,isSelectRepoDialogOpen:!1,sortBy:We.Ay.load("seafile-repo-dir-sort-by")||"name",sortOrder:We.Ay.load("seafile-repo-dir-sort-order")||"asc",isSortOptionsDialogOpen:!1,libraryType:"public"},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.repoList?this.setState({isLoading:!1,repoList:h.Aq.sortRepos(this.props.repoList,this.state.sortBy,this.state.sortOrder)}):S.e.listRepos({type:"public"}).then((function(t){var n=t.data.repos.map((function(e){return new Ke(e)}));e.setState({isLoading:!1,repoList:h.Aq.sortRepos(n,e.state.sortBy,e.state.sortOrder)})})).catch((function(t){e.setState({isLoading:!1,errMessage:h.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this.props,t=e.inAllLibs,n=void 0!==t&&t,r=e.currentViewMode,o=void 0===r?tt.Tb:r;return n?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{className:"d-flex justify-content-between mt-3 py-1 ".concat(o==tt.Tb?"sf-border-bottom":""),children:[(0,m.jsxs)("h4",{className:"sf-heading m-0",children:[(0,m.jsx)("span",{className:"sf3-font-share-with-all sf3-font nav-icon","aria-hidden":"true"}),(0,f.AP)("Shared with all")]}),this.renderSortIconInMobile()]}),this.renderContent()]}):(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsxs)("div",{className:"cur-view-path",children:[(0,m.jsxs)("h3",{className:"sf-heading m-0",children:[(0,f.AP)("Shared with all"),f.P9&&(0,m.jsx)(Ue,{opList:[{text:(0,f.AP)("Share existing libraries"),onClick:this.onSelectRepoToggle},{text:(0,f.AP)("New Library"),onClick:this.onCreateRepoToggle}]})]}),this.renderSortIconInMobile()]}),(0,m.jsx)("div",{className:"cur-view-content",children:this.renderContent()})]})}),this.state.isSortOptionsDialogOpen&&(0,m.jsx)(je,{toggleDialog:this.toggleSortOptionsDialog,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems}),this.state.isCreateRepoDialogOpen&&(0,m.jsx)(te.A,{children:(0,m.jsx)(xn,{libraryType:this.state.libraryType,onCreateToggle:this.onCreateRepoToggle,onCreateRepo:this.onCreateRepo})}),this.state.isSelectRepoDialogOpen&&(0,m.jsx)(te.A,{children:(0,m.jsx)(Tn,{onRepoSelectedHandler:this.onRepoSelectedHandler,onShareRepoDialogClose:this.onSelectRepoToggle})})]})}}])}(s.Component),jn=On,Rn=n(90675),Ln=n(10467),Fn=n(46256),Un=n.n(Fn),Yn=""!==f.Wg?Un()(f.Wg):void 0,Bn=new(function(){return(0,o.A)((function e(){(0,r.A)(this,e)}),[{key:"watchRepo",value:function(e,t){Yn&&(Yn.emit("repo_update",{request:"watch_update",repo_id:e,user:{name:f.UU,username:f.Xh,contact_email:f.bd}}),Yn.on("repo_update",t))}},{key:"unwatchRepo",value:function(e,t){Yn&&(Yn.emit("repo_update",{request:"unwatch_update",repo_id:e,user:{name:f.UU,username:f.Xh,contact_email:f.bd}}),Yn.off("repo_update",t))}}])}()),Hn=n(84878),Vn=n(67665),Gn=n(25531),qn=n(89615),zn=n(56044),Wn=n(25547),Kn=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).handleSubmit=function(e){var t=n.props.repoID,r=n.state.password;S.e.setRepoDecryptPassword(t,r).then((function(e){n.props.onLibDecryptDialog()})).catch((function(e){n.setState({showError:!0})})),e.preventDefault()},n.handleKeyDown=function(e){"Enter"==e.key&&n.handleSubmit(e)},n.handleChange=function(e){n.setState({password:e.target.value,showError:!1})},n.toggle=function(){window.location.href=f.Yc},n.state={password:"",showError:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return(0,m.jsx)(p.A,{isOpen:!0,toggle:this.toggle,children:(0,m.jsxs)(M.A,{children:[(0,m.jsx)("button",{type:"button",className:"close",onClick:this.toggle,children:(0,m.jsx)("span",{"aria-hidden":"true",children:"\xd7"})}),(0,m.jsxs)(bt.A,{className:"lib-decrypt-form text-center",children:[(0,m.jsx)("img",{src:"".concat(f.SG,"img/lock.png"),alt:"","aria-hidden":"true"}),(0,m.jsx)("p",{className:"intro",children:(0,f.AP)("This library is password protected")}),this.state.showError&&(0,m.jsx)("p",{className:"error",children:(0,f.AP)("Wrong password")}),(0,m.jsx)("input",{type:"password",name:"password",className:"form-control password-input",autoComplete:"off",onKeyDown:this.handleKeyDown,placeholder:(0,f.AP)("Password"),onChange:this.handleChange}),(0,m.jsx)("button",{type:"submit",className:"btn btn-primary submit",onClick:this.handleSubmit,children:(0,f.AP)("Submit")}),(0,m.jsxs)("p",{className:"tip",children:["* ",(0,f.AP)("The password will be kept in the server for only 1 hour.")]})]})]})})}}])}(s.Component),Zn=n(81617),Xn=n(56999),$n=n(44110);var Jn=function(e){var t=e.modalTitle,n=e.modalTip;return(0,m.jsxs)(p.A,{isOpen:!0,children:[(0,m.jsx)(k.A,{children:t}),(0,m.jsxs)(M.A,{className:"d-flex flex-column justify-content-center align-terms-center",style:{height:"180px"},children:[(0,m.jsx)($n.Rh,{}),(0,m.jsx)("div",{className:"d-flex justify-content-center mt-6",children:n})]})]})},Qn=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleDesktopOpMenu=function(){n.setState({isDesktopMenuOpen:!n.state.isDesktopMenuOpen})},n.toggleMobileOpMenu=function(){n.setState({isMobileOpMenuOpen:!n.state.isMobileOpMenuOpen})},n.onUploadFile=function(e){n.props.onUploadFile(e)},n.onUploadFolder=function(e){n.props.onUploadFolder(e)},n.onShareClick=function(){n.setState({isShareDialogShow:!n.state.isShareDialogShow})},n.onCreateFolderToggle=function(){n.setState({isCreateFolderDialogShow:!n.state.isCreateFolderDialogShow})},n.onCreateFileToggle=function(){n.setState({isCreateFileDialogShow:!n.state.isCreateFileDialogShow,fileType:""})},n.onCreateMarkdownToggle=function(){n.setState({isCreateFileDialogShow:!n.state.isCreateFileDialogShow,fileType:".md"})},n.onCreateExcelToggle=function(){n.setState({isCreateFileDialogShow:!n.state.isCreateFileDialogShow,fileType:".xlsx"})},n.onCreatePPTToggle=function(){n.setState({isCreateFileDialogShow:!n.state.isCreateFileDialogShow,fileType:".pptx"})},n.onCreateWordToggle=function(){n.setState({isCreateFileDialogShow:!n.state.isCreateFileDialogShow,fileType:".docx"})},n.onCreateSeaDocToggle=function(){n.setState({isCreateFileDialogShow:!n.state.isCreateFileDialogShow,fileType:".sdoc"})},n.onAddFolder=function(e){n.setState({isCreateFolderDialogShow:!1}),n.props.onAddFolder(e)},n.checkDuplicatedName=function(e){return n.props.direntList.some((function(t){return t.name===e}))},n.onDropdownToggleKeyDown=function(e){"Enter"!=e.key&&"Space"!=e.key||n.toggleDesktopOpMenu()},n.onDropDownMouseMove=function(e){n.state.isSubMenuShown&&e.target&&"dropdown-item"===e.target.className&&n.setState({isSubMenuShown:!1})},n.toggleSubMenu=function(e){e.stopPropagation(),n.setState({isSubMenuShown:!n.state.isSubMenuShown})},n.toggleSubMenuShown=function(e){n.setState({isSubMenuShown:!0,currentItem:e.text})},n.onMenuItemKeyDown=function(e,t){"Enter"!=t.key&&"Space"!=t.key||e.onClick()},n.onUploadSdoc=function(e){n.fileInputRef.current.click()},n.uploadSdoc=function(e){if(n.fileInputRef.current.files.length){var t=n.fileInputRef.current.files[0].name;if("sdoczip"==t.substr(t.lastIndexOf(".")+1)){n.setState({isImportingSdoc:!0});var r=n.fileInputRef.current.files[0],o=n.props,a=o.repoID,i=o.path;S.e.importSdoc(r,a,i).then((function(e){n.props.loadDirentList(i)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)})).finally((function(){n.fileInputRef.current.value="",setTimeout((function(){n.setState({isImportingSdoc:!1})}),500)}))}else E.A.warning((0,f.AP)("Please choose a .sdoczip file."),{hasCloseButton:!0,duration:null})}},n.state={fileType:".md",isCreateFileDialogShow:!1,isCreateFolderDialogShow:!1,isShareDialogShow:!1,operationMenuStyle:"",isDesktopMenuOpen:!1,isSubMenuShown:!1,isMobileOpMenuOpen:!1,isImportingSdoc:!1},n.fileInputRef=s.createRef(),n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.path,r=t.repoName,o=t.userPerm,a="/"===n?"library":"dir",i="/"==n?r:h.Aq.getFolderName(n),l=h.Aq.getUserPermission(o),c=l.isCustomPermission,u=l.customPermission,d=!0,p=!0;if(c){var g=u.permission;d=g.upload,p=g.create}var v=null;if(h.Aq.isDesktop()){var y=this.props,C=y.showShareBtn,A=y.repoEncrypted,x=[];if(d&&(h.Aq.isSupportUploadFolder()?x.push({icon:"upload-files",text:(0,f.AP)("Upload Files"),onClick:this.onUploadFile},{icon:"upload-files",text:(0,f.AP)("Upload Folder"),onClick:this.onUploadFolder},{icon:"import-sdoc",text:(0,f.AP)("Import sdoc"),onClick:this.onUploadSdoc}):x.push({icon:"upload-files",text:(0,f.AP)("Upload"),onClick:this.onUploadFile})),p){var b=[{text:(0,f.AP)("New Folder"),onClick:this.onCreateFolderToggle},{text:(0,f.AP)("New File"),onClick:this.onCreateFileToggle},"Divider"];f.lU&&!A&&b.push({text:(0,f.AP)("New SeaDoc File"),onClick:this.onCreateSeaDocToggle}),b.push({text:(0,f.AP)("New Markdown File"),onClick:this.onCreateMarkdownToggle},{text:(0,f.AP)("New Excel File"),onClick:this.onCreateExcelToggle},{text:(0,f.AP)("New PowerPoint File"),onClick:this.onCreatePPTToggle},{text:(0,f.AP)("New Word File"),onClick:this.onCreateWordToggle}),x.push({icon:"new",text:(0,f.AP)("New"),subOpList:b})}C&&x.push({icon:"share",text:(0,f.AP)("Share"),onClick:this.onShareClick}),v=(0,m.jsx)(s.Fragment,{children:(0,m.jsxs)(ue.A,{isOpen:this.state.isDesktopMenuOpen,toggle:this.toggleDesktopOpMenu,children:[(0,m.jsxs)(de.A,{tag:"div",role:"button",className:"path-item",onClick:this.toggleDesktopOpMenu,onKeyDown:this.onDropdownToggleKeyDown,"data-toggle":"dropdown",children:[this.props.children,(0,m.jsx)("i",{className:"sf3-font-down sf3-font ml-1 path-item-dropdown-toggle"})]}),(0,m.jsx)(Fe.A,{onMouseMove:this.onDropDownMouseMove,positionFixed:!0,children:x.map((function(t,n){return"Divider"==t?(0,m.jsx)(pe.A,{divider:!0},n):t.subOpList?(0,m.jsxs)(ue.A,{direction:"right",className:"w-100",isOpen:e.state.isSubMenuShown&&e.state.currentItem==t.text,toggle:e.toggleSubMenu,onMouseMove:function(e){e.stopPropagation()},children:[(0,m.jsxs)(de.A,{tag:"div",className:"dropdown-item font-weight-normal rounded-0 d-flex align-items-center",onMouseEnter:e.toggleSubMenuShown.bind(e,t),children:[(0,m.jsx)("i",{className:"sf3-font-".concat(t.icon," sf3-font mr-2 dropdown-item-icon")}),(0,m.jsx)("span",{className:"mr-auto",children:t.text}),(0,m.jsx)("i",{className:"sf3-font-down sf3-font rotate-270"})]}),(0,m.jsx)(Fe.A,{children:t.subOpList.map((function(t,n){return"Divider"==t?(0,m.jsx)(pe.A,{divider:!0},n):(0,m.jsx)(pe.A,{onClick:t.onClick,onKeyDown:e.onMenuItemKeyDown.bind(e,t),children:t.text},n)}))})]},n):(0,m.jsxs)(pe.A,{onClick:t.onClick,onKeyDown:e.onMenuItemKeyDown.bind(e,t),children:[(0,m.jsx)("i",{className:"sf3-font-".concat(t.icon," sf3-font mr-2 dropdown-item-icon")}),t.text]},n)}))})]})})}else v=(0,m.jsxs)(ue.A,{isOpen:this.state.isMobileOpMenuOpen,toggle:this.toggleMobileOpMenu,children:[(0,m.jsxs)(de.A,{tag:"div",role:"button",className:"path-item",children:[this.props.children,(0,m.jsx)("i",{className:"sf3-font-down sf3-font ml-1 path-item-dropdown-toggle"})]}),(0,m.jsxs)(Fe.A,{positionFixed:!0,children:[d&&(0,m.jsx)(pe.A,{onClick:this.onUploadFile,children:(0,f.AP)("Upload")}),p&&(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)(pe.A,{onClick:this.onCreateFolderToggle,children:(0,f.AP)("New Folder")}),(0,m.jsx)(pe.A,{onClick:this.onCreateFileToggle,children:(0,f.AP)("New File")})]})]})]});return(0,m.jsxs)(s.Fragment,{children:[("rw"===o||"admin"===o||"cloud-edit"===o||c)&&(0,m.jsx)("div",{className:"dir-operation",children:v}),this.state.isCreateFileDialogShow&&(0,m.jsx)(te.A,{children:(0,m.jsx)(Xn.A,{parentPath:this.props.path,fileType:this.state.fileType,onAddFile:this.props.onAddFile,checkDuplicatedName:this.checkDuplicatedName,toggleDialog:this.onCreateFileToggle})}),this.state.isCreateFolderDialogShow&&(0,m.jsx)(te.A,{children:(0,m.jsx)(Zn.A,{parentPath:this.props.path,onAddFolder:this.onAddFolder,checkDuplicatedName:this.checkDuplicatedName,addFolderCancel:this.onCreateFolderToggle})}),this.state.isShareDialogShow&&(0,m.jsx)(te.A,{children:(0,m.jsx)($e.A,{itemType:a,itemName:i,itemPath:this.props.path,repoID:this.props.repoID,repoEncrypted:this.props.repoEncrypted,enableDirPrivateShare:this.props.enableDirPrivateShare,userPerm:this.props.userPerm,isGroupOwnedRepo:this.props.isGroupOwnedRepo,toggleDialog:this.onShareClick})}),this.state.isImportingSdoc&&(0,m.jsx)(Jn,{modalTitle:(0,f.AP)("Import sdoc"),modalTip:(0,f.AP)("Importing sdoc, please wait...")}),(0,m.jsx)("div",{children:(0,m.jsx)("input",{className:"d-none",type:"file",onChange:this.uploadSdoc,ref:this.fileInputRef})})]})}}])}(s.Component),er=Qn,tr=n(11942),nr=n.n(tr),rr=n(44),or=function(e){var t=e.id,n=(0,rr.p_)().viewsMap;if(!t)return null;var r=n[t];return r?(0,m.jsx)(m.Fragment,{children:r.name}):null};or.propTypes={id:nr().string};var ar,ir=or,sr=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onPathClick=function(e){var t=h.Aq.getEventData(e,"path");n.props.onPathClick(t)},n.onTabNavClick=function(e,t,r){if(window.uploader&&window.uploader.isUploadProgressDialogShow&&100!==window.uploader.totalProgress){if(!window.confirm((0,f.AP)("A file is being uploaded. Are you sure you want to leave this page?")))return e.preventDefault(),!1;window.uploader.isUploadProgressDialogShow=!1}n.props.onTabNavClick(t,r)},n.onDragEnter=function(e){if(e.preventDefault(),h.Aq.isIEBrowser())return!1;n.setState({dropTargetPath:e.target.dataset.path})},n.onDragLeave=function(e){if(e.preventDefault(),h.Aq.isIEBrowser())return!1;n.setState({dropTargetPath:""})},n.onDragOver=function(e){if(h.Aq.isIEBrowser())return!1;e.preventDefault(),e.dataTransfer.dropEffect="move"},n.onDrop=function(e){if(h.Aq.isIEBrowser())return!1;if(!e.dataTransfer.files.length){var t=h.Aq.getEventData(e,"path"),r=e.dataTransfer.getData("application/drag-item-info");if(r=JSON.parse(r),Array.isArray(r))n.props.onItemsMove(n.props.currentRepoInfo,t);else{var o=r,a=o.nodeDirent,i=o.nodeParentPath;n.props.onItemMove(n.props.currentRepoInfo,a,t,i)}n.setState({dropTargetPath:""})}},n.turnPathToLink=function(e){var t=(e="/"===e[e.length-1]?e.slice(0,e.length-1):e).split("/"),r="";return 2!==t.length||t[0]||t[1]!==j.AT.FILE_EXTENDED_PROPERTIES?t.map((function(e,o){return""===e?null:o===t.length-2&&e===j.AT.FILE_EXTENDED_PROPERTIES?(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("span",{className:"path-split",children:"/"}),(0,m.jsx)("span",{className:"path-item",children:(0,f.AP)("Views")})]},o):o===t.length-1&&t[t.length-2]===j.AT.FILE_EXTENDED_PROPERTIES?(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("span",{className:"path-split",children:"/"}),(0,m.jsx)("span",{className:"path-item",children:(0,m.jsx)(ir,{id:e})})]},o):o===t.length-1?(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("span",{className:"path-split",children:"/"}),(0,m.jsx)(er,{path:n.props.currentPath,repoID:n.props.repoID,repoName:n.props.repoName,repoEncrypted:n.props.repoEncrypted,direntList:n.props.direntList,showShareBtn:n.props.showShareBtn,enableDirPrivateShare:n.props.enableDirPrivateShare,userPerm:n.props.userPerm,isGroupOwnedRepo:n.props.isGroupOwnedRepo,onAddFile:n.props.onAddFile,onAddFolder:n.props.onAddFolder,onUploadFile:n.props.onUploadFile,onUploadFolder:n.props.onUploadFolder,loadDirentList:n.props.loadDirentList,children:(0,m.jsx)("span",{className:"path-file-name",children:e})})]},o):(r+="/"+e,(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("span",{className:"path-split",children:"/"}),(0,m.jsx)("span",{className:"path-item ".concat(r===n.state.dropTargetPath?"path-item-drop":""),"data-path":r,onClick:n.onPathClick,onDragEnter:n.onDragEnter,onDragLeave:n.onDragLeave,onDragOver:n.onDragOver,onDrop:n.onDrop,role:"button",children:e})]},o))})):null},n.isViewMetadata=function(){var e=n.props.currentPath,t=("/"===e[e.length-1]?e.slice(0,e.length-1):e).split("/");return t[t.length-2]===j.AT.FILE_EXTENDED_PROPERTIES},n.state={dropTargetPath:""},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.currentPath,r=t.repoName,o=this.turnPathToLink(n);return(0,m.jsxs)("div",{className:"path-container dir-view-path",children:[(0,m.jsx)("span",{className:"cur-view-path-btn mr-1",onClick:this.props.toggleTreePanel,children:(0,m.jsx)("span",{className:"sf3-font-side-bar sf3-font"})}),this.props.pathPrefix&&this.props.pathPrefix.map((function(t,n){return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)(c.N_,{to:t.url,className:"path-item normal",onClick:function(n){return e.onTabNavClick(n,t.name,t.id)},children:(0,f.AP)(t.showName)}),(0,m.jsx)("span",{className:"path-split",children:"/"})]},n)})),this.props.pathPrefix&&0===this.props.pathPrefix.length&&(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)(c.N_,{to:f.Yc+"libraries/",className:"path-item normal",onClick:function(t){return e.onTabNavClick(t,"libraries")},children:(0,f.AP)("Files")}),(0,m.jsx)("span",{className:"path-split",children:"/"})]}),!this.props.pathPrefix&&(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)(c.N_,{to:f.Yc+"libraries/",className:"path-item normal",onClick:function(t){return e.onTabNavClick(t,"libraries")},children:(0,f.AP)("Files")}),(0,m.jsx)("span",{className:"path-split",children:"/"})]}),"/"===n||""===n?(0,m.jsx)(er,{path:this.props.currentPath,repoID:this.props.repoID,repoName:this.props.repoName,repoEncrypted:this.props.repoEncrypted,direntList:this.props.direntList,showShareBtn:this.props.showShareBtn,enableDirPrivateShare:this.props.enableDirPrivateShare,userPerm:this.props.userPerm,isGroupOwnedRepo:this.props.isGroupOwnedRepo,onAddFile:this.props.onAddFile,onAddFolder:this.props.onAddFolder,onUploadFile:this.props.onUploadFile,onUploadFolder:this.props.onUploadFolder,loadDirentList:this.props.loadDirentList,children:(0,m.jsx)("span",{className:"path-repo-name",children:r})}):(0,m.jsx)("span",{className:"path-item","data-path":"/",onClick:this.onPathClick,role:"button",children:r}),o]})}}])}(s.Component),lr=sr,cr=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleSortOptionsDialog=function(){n.setState({isSortOptionsDialogOpen:!n.state.isSortOptionsDialogOpen})},n.state={isSortOptionsDialogOpen:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return(0,m.jsxs)("div",{className:"cur-dir-path d-flex justify-content-between align-items-center",children:[(0,m.jsx)(lr,{currentRepoInfo:this.props.currentRepoInfo,repoID:this.props.repoID,repoName:this.props.repoName,repoEncrypted:this.props.repoEncrypted,isGroupOwnedRepo:this.props.isGroupOwnedRepo,pathPrefix:this.props.pathPrefix,currentPath:this.props.currentPath,userPerm:this.props.userPerm,onPathClick:this.props.onPathClick,onTabNavClick:this.props.onTabNavClick,fileTags:this.props.fileTags,toggleTreePanel:this.props.toggleTreePanel,enableDirPrivateShare:this.props.enableDirPrivateShare,showShareBtn:this.props.showShareBtn,onAddFolder:this.props.onAddFolder,onAddFile:this.props.onAddFile,onUploadFile:this.props.onUploadFile,onUploadFolder:this.props.onUploadFolder,direntList:this.props.fullDirentList,filePermission:this.props.filePermission,onFileTagChanged:this.props.onFileTagChanged,repoTags:this.props.repoTags,onItemMove:this.props.onItemMove,loadDirentList:this.props.loadDirentList}),!this.props.isDesktop&&this.props.direntList.length>0&&(0,m.jsx)("span",{className:"sf3-font sf3-font-sort action-icon",onClick:this.toggleSortOptionsDialog}),this.state.isSortOptionsDialogOpen&&(0,m.jsx)(je,{toggleDialog:this.toggleSortOptionsDialog,sortBy:this.props.sortBy,sortOrder:this.props.sortOrder,sortItems:this.props.sortItems})]})}}])}(s.Component),ur=n(89379),dr=n(94634),pr=n(4966),fr={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},hr=new Uint8Array(16);function mr(){if(!ar&&!(ar="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ar(hr)}for(var gr=[],vr=0;vr<256;++vr)gr.push((vr+256).toString(16).slice(1));function yr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return gr[e[t+0]]+gr[e[t+1]]+gr[e[t+2]]+gr[e[t+3]]+"-"+gr[e[t+4]]+gr[e[t+5]]+"-"+gr[e[t+6]]+gr[e[t+7]]+"-"+gr[e[t+8]]+gr[e[t+9]]+"-"+gr[e[t+10]]+gr[e[t+11]]+gr[e[t+12]]+gr[e[t+13]]+gr[e[t+14]]+gr[e[t+15]]}var Cr=function(e,t,n){if(fr.randomUUID&&!t&&!e)return fr.randomUUID();var r=(e=e||{}).random||(e.rng||mr)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var o=0;o<16;++o)t[n+o]=r[o];return t}return yr(r)},Ar=n(9772),xr=n(26100),br=(n(79627),function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).togglePopover=function(){n.setState({isPopoverOpen:!n.state.isPopoverOpen})},n.selectTagColor=function(e){var t=e.target.value,r=n.props,o=r.repoID,a=r.tag,i=a.id,s=a.name;S.e.updateRepoTag(o,i,s,t).then((function(){n.setState({tagColor:t,isPopoverOpen:!n.state.isPopoverOpen})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.state={tagColor:n.props.tag.color,isPopoverOpen:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.tag.color!==this.props.tag.color&&this.setState({tagColor:e.tag.color})}},{key:"render",value:function(){var e=this,t=this.state,n=t.isPopoverOpen,r=t.tagColor,o=this.props.tag,a=o.id,i=o.color,s=(0,z.A)(j.cj);return-1==s.indexOf(i)&&s.unshift(i),(0,m.jsxs)("div",{children:[(0,m.jsx)("span",{id:"tag-".concat(a,"-color"),className:"tag-color cursor-pointer rounded-circle d-flex align-items-center justify-content-center",style:{backgroundColor:r},onClick:this.togglePopover,children:(0,m.jsx)("i",{className:"sf3-font sf3-font-down text-white"})}),(0,m.jsx)(Ar.A,{target:"tag-".concat(a,"-color"),isOpen:n,placement:"bottom",toggle:this.togglePopover,className:"tag-color-popover mw-100",children:(0,m.jsx)(xr.A,{className:"p-2",children:(0,m.jsx)("div",{className:"d-flex justify-content-between",children:s.map((function(t,n){return(0,m.jsx)("div",{className:"tag-color-option mx-1",children:(0,m.jsxs)("label",{className:"colorinput",children:[(0,m.jsx)("input",{name:"color",type:"radio",value:t,className:"colorinput-input",defaultChecked:t==r,onClick:e.selectTagColor}),(0,m.jsx)("span",{className:"colorinput-color rounded-circle d-flex align-items-center justify-content-center",style:{backgroundColor:t},children:(0,m.jsx)("i",{className:"sf2-icon-tick color-selected"})})]})},n)}))})})})]})}}])}(s.Component)),_r=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleMode=function(){n.setState({isEditing:!n.state.isEditing},(function(){n.state.isEditing&&n.input.current.focus()}))},n.updateTagName=function(e){var t=e.target.value,r=n.props,o=r.repoID,a=r.tag,i=a.id,s=a.color;S.e.updateRepoTag(o,i,t,s).then((function(){n.setState({tagName:t})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.onInputKeyDown=function(e){"Enter"==e.key?(n.toggleMode(),n.updateTagName(e)):"Escape"==e.key&&(e.nativeEvent.stopImmediatePropagation(),n.toggleMode())},n.onInputBlur=function(e){n.toggleMode(),n.updateTagName(e)},n.state={tagName:n.props.tag.name,isEditing:!1},n.input=s.createRef(),n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.tag.name!==this.props.tag.name&&this.setState({tagName:e.tag.name})}},{key:"render",value:function(){var e=this.state,t=e.isEditing,n=e.tagName;return(0,m.jsx)("div",{className:"mx-2 flex-fill d-flex",children:t?(0,m.jsx)("input",{type:"text",ref:this.input,defaultValue:n,onBlur:this.onInputBlur,onKeyDown:this.onInputKeyDown,className:"flex-fill form-control-sm form-control"}):(0,m.jsx)("span",{onClick:this.toggleMode,className:"cursor-pointer flex-fill",children:n})})}}])}(s.Component),wr=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onMouseOver=function(){n.setState({isTagHighlighted:!0})},n.onMouseOut=function(){n.setState({isTagHighlighted:!1})},n.deleteTag=function(){n.props.onDeleteTag(n.props.item)},n.state={isTagHighlighted:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.state.isTagHighlighted,t=this.props,n=t.item,r=t.repoID;return(0,m.jsxs)("li",{className:"tag-list-item px-4 d-flex justify-content-between align-items-center ".concat(e?"hl":""),onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut,children:[(0,m.jsx)(br,{repoID:r,tag:n}),(0,m.jsx)(_r,{repoID:r,tag:n}),(0,m.jsx)("button",{className:"tag-delete-icon sf3-font-delete1 sf3-font border-0 px-0 bg-transparent cursor-pointer ".concat(e?"":"invisible"),onClick:this.deleteTag,"aria-label":(0,f.AP)("Delete"),title:(0,f.AP)("Delete")})]})}}])}(s.Component),Sr=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).togglePopover=function(){n.setState({isPopoverOpen:!n.state.isPopoverOpen})},n.selectTagColor=function(e){var t=e.target.value;n.props.updateVirtualTag(n.props.tag,{color:t}),n.setState({tagColor:t,isPopoverOpen:!n.state.isPopoverOpen})},n.state={tagColor:n.props.tag.color,isPopoverOpen:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.tag.color!==this.props.tag.color&&this.setState({tagColor:e.tag.color})}},{key:"render",value:function(){var e=this,t=this.state,n=t.isPopoverOpen,r=t.tagColor,o=this.props.tag,a=o.id,i=o.color,s=(0,z.A)(j.cj);return-1==s.indexOf(i)&&s.unshift(i),(0,m.jsxs)("div",{children:[(0,m.jsx)("span",{id:"tag-".concat(a,"-color"),className:"tag-color cursor-pointer rounded-circle d-flex align-items-center justify-content-center",style:{backgroundColor:r},onClick:this.togglePopover,children:(0,m.jsx)("i",{className:"sf3-font sf3-font-down text-white"})}),(0,m.jsx)(Ar.A,{target:"tag-".concat(a,"-color"),isOpen:n,placement:"bottom",toggle:this.togglePopover,className:"tag-color-popover mw-100",children:(0,m.jsx)(xr.A,{className:"p-2",children:(0,m.jsx)("div",{className:"d-flex justify-content-between",children:s.map((function(t,n){return(0,m.jsx)("div",{className:"tag-color-option mx-1",children:(0,m.jsxs)("label",{className:"colorinput",children:[(0,m.jsx)("input",{name:"color",type:"radio",value:t,className:"colorinput-input",defaultChecked:t==r,onClick:e.selectTagColor}),(0,m.jsx)("span",{className:"colorinput-color rounded-circle d-flex align-items-center justify-content-center",style:{backgroundColor:t},children:(0,m.jsx)("i",{className:"sf2-icon-tick color-selected"})})]})},n)}))})})})]})}}])}(s.Component),Dr=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleMode=function(){n.setState({isEditing:!n.state.isEditing})},n.updateTagName=function(e){var t=e.target.value;n.props.updateVirtualTag(n.props.tag,{name:t}),n.setState({tagName:t})},n.onInputKeyDown=function(e){"Enter"==e.key?(n.toggleMode(),n.updateTagName(e)):"Escape"==e.key&&(e.nativeEvent.stopImmediatePropagation(),n.toggleMode())},n.onInputBlur=function(e){n.toggleMode(),n.updateTagName(e)},n.state={tagName:n.props.tag.name,isEditing:!0},n.input=s.createRef(),n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.tag.name!==this.props.tag.name&&this.setState({tagName:e.tag.name})}},{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){e.input.current.focus()}),1)}},{key:"render",value:function(){var e=this.state,t=e.isEditing,n=e.tagName;return(0,m.jsx)("div",{className:"mx-2 flex-fill d-flex",children:t?(0,m.jsx)("input",{type:"text",ref:this.input,defaultValue:n,onBlur:this.onInputBlur,onKeyDown:this.onInputKeyDown,className:"flex-fill form-control-sm form-control"}):(0,m.jsx)("span",{onClick:this.toggleMode,className:"cursor-pointer flex-fill",style:{width:100,height:20},children:n})})}}])}(s.Component),Er=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onMouseOver=function(){n.setState({isTagHighlighted:!0})},n.onMouseOut=function(){n.setState({isTagHighlighted:!1})},n.deleteVirtualTag=function(){n.props.deleteVirtualTag(n.props.item)},n.state={isTagHighlighted:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.state.isTagHighlighted,t=this.props,n=t.item,r=t.repoID;return(0,m.jsxs)("li",{className:"tag-list-item px-4 d-flex justify-content-between align-items-center ".concat(e?"hl":""),onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut,children:[(0,m.jsx)(Sr,{repoID:r,tag:n,updateVirtualTag:this.props.updateVirtualTag}),(0,m.jsx)(Dr,{repoID:r,tag:n,updateVirtualTag:this.props.updateVirtualTag}),(0,m.jsx)("button",{className:"tag-delete-icon sf3-font-delete1 sf3-font border-0 px-0 bg-transparent cursor-pointer ".concat(e?"":"invisible"),onClick:this.deleteVirtualTag,"aria-label":(0,f.AP)("Delete"),title:(0,f.AP)("Delete")})]})}}])}(s.Component),kr=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleTooltip=function(){n.setState({showTooltip:!n.state.showTooltip})},n.onClickImport=function(){n.importOptionsInput.click()},n.importTagsInputChange=function(){if(n.importOptionsInput.files&&n.importOptionsInput.files.length){var e=new FileReader;e.onload=n.onImportTags.bind(n),e.onerror=n.onImportTagsError.bind(n),e.readAsText(n.importOptionsInput.files[0])}else E.A.warning((0,f.AP)("Please select a file"))},n.getValidTags=function(e){var t=[],r={};n.props.repotagList.forEach((function(e){return r[e.name]=!0}));for(var o=0;o<e.length;o++)e[o]&&"object"===typeof e[o]&&e[o].name&&e[o].color&&(r[e[o].name]||(t.push({name:e[o].name,color:e[o].color}),r[e[o].name]=!0));return t},n.onImportTags=function(e){var t=[];try{t=JSON.parse(e.target.result)}catch(o){return void E.A.danger((0,f.AP)("The imported tags are invalid"))}if(Array.isArray(t)&&0!==t.length){var r=n.getValidTags(t);0!==r.length?(S.e.createRepoTags(n.props.repoID,r).then((function(e){E.A.success((0,f.AP)("Tags imported"));var t=[];e.data.repo_tags.forEach((function(e){var n=new Gn.A(e);t.push(n)})),n.props.updateTags(t)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)})),n.importOptionsInput.value=null):E.A.warning((0,f.AP)("The imported tag already exists"))}else E.A.danger((0,f.AP)("The imported tags are invalid"))},n.onImportTagsError=function(){E.A.success((0,f.AP)("Failed to import tags. Please reupload."))},n.getDownloadUrl=function(){var e=n.props.repotagList.map((function(e){return{name:e.name,color:e.color}}));return"data:text/json;charset=utf-8,".concat(encodeURIComponent(JSON.stringify(e)))},n.state={showTooltip:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this;return(0,m.jsxs)("div",{className:"tag-list-footer",children:[(0,m.jsx)("span",{className:"sf3-font sf3-font-tips mr-2",style:{color:"#999"},id:"import-export-tags-tip"}),(0,m.jsx)(F.A,{toggle:this.toggleTooltip,delay:{show:0,hide:0},target:"import-export-tags-tip",placement:"bottom",isOpen:this.state.showTooltip,children:(0,f.AP)("Use the import/export function to transfer tags quickly to another library. (The export is in JSON format.)")}),(0,m.jsx)("input",{type:"file",ref:function(t){return e.importOptionsInput=t},accept:".json",className:"d-none",onChange:this.importTagsInputChange}),(0,m.jsx)("span",{className:"item-text",onClick:this.onClickImport,children:(0,f.AP)("Import tags")}),(0,m.jsx)("span",{className:"mx-2",children:"|"}),(0,m.jsx)("a",{href:this.getDownloadUrl(),download:"tags.json",onClick:this.props.toggle,children:(0,m.jsx)("span",{className:"item-text",children:(0,f.AP)("Export tags")})})]})}}])}(s.Component),Mr=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).loadTags=function(){S.e.listRepoTags(n.props.repoID).then((function(e){var t=[];e.data.repo_tags.forEach((function(e){var n=new Gn.A(e);t.push(n)})),n.setState({repotagList:t})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.updateTags=function(e){n.setState({repotagList:[].concat((0,z.A)(n.state.repotagList),(0,z.A)(e))})},n.onDeleteTag=function(e){var t=n.props.repoID,r=e.id;S.e.deleteRepoTag(t,r).then((function(e){n.setState({repotagList:n.state.repotagList.filter((function(e){return e.id!=r}))})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.createVirtualTag=function(e){e.preventDefault();var t=n.state.repotagList,r={name:"",color:j.cj[Math.floor(Math.random()*j.cj.length)],id:"virtual-tag-".concat(Cr()),is_virtual:!0};t.push(r),n.setState({repotagList:t})},n.deleteVirtualTag=function(e){var t=n.state.repotagList,r=t.findIndex((function(t){return t.id===e.id}));t.splice(r,1),n.setState({repotagList:t})},n.updateVirtualTag=function(e,t){var r=n.props.repoID,o=n.state.repotagList,a=o.findIndex((function(t){return t.id===e.id}));if(a<0)return null;if(t.color)return e.color=t.color,o[a]=e,void n.setState({repotagList:o});if(t.name&&t.name.length>0){var i=e.color,s=t.name;S.e.createRepoTag(r,s,i).then((function(e){o[a]=new Gn.A(e.data.repo_tag),n.setState({repotagList:o})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))}},n.state={repotagList:[]},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.loadTags()}},{key:"render",value:function(){var e=this;return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("ul",{className:"tag-list tag-list-container my-2",children:this.state.repotagList.map((function(t,n){return t.is_virtual?(0,m.jsx)(Er,{item:t,repoID:e.props.repoID,deleteVirtualTag:e.deleteVirtualTag,updateVirtualTag:e.updateVirtualTag},n):(0,m.jsx)(wr,{item:t,repoID:e.props.repoID,onDeleteTag:e.onDeleteTag},n)}))}),(0,m.jsxs)("div",{className:"add-tag-link px-4 py-2 d-flex align-items-center",onClick:this.createVirtualTag,children:[(0,m.jsx)("span",{className:"sf2-icon-plus mr-2"}),(0,f.AP)("Create a new tag")]}),(0,m.jsx)(kr,{toggle:this.props.onListTagCancel,repotagList:this.state.repotagList,updateTags:this.updateTags,repoID:this.props.repoID})]})}}])}(s.Component),Ir=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onKeyDown=function(e){e.shiftKey&&49===e.keyCode?n.props.switchViewMode(tt.Tb):e.shiftKey&&50===e.keyCode&&n.props.switchViewMode(tt.nj)},n.toggleDropdownMenu=function(){n.setState({isDropdownMenuOpen:!n.state.isDropdownMenuOpen})},n.state={isDropdownMenuOpen:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.onKeyDown)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.onKeyDown)}},{key:"render",value:function(){var e=this,t=this.state.isDropdownMenuOpen,n=this.props.currentViewMode,r=[{icon:"list-view",text:(0,f.AP)("List view"),value:tt.Tb,shortcut:"Shift 1"},{icon:"grid-view",text:(0,f.AP)("Grid view"),value:tt.nj,shortcut:"Shift 2"}];return(0,m.jsxs)(ue.A,{isOpen:t,toggle:this.toggleDropdownMenu,id:"cur-view-change-mode-dropdown",children:[(0,m.jsx)(de.A,{tag:"div","data-toggle":"dropdown",title:(0,f.AP)("Switch view mode"),"aria-label":(0,f.AP)("Switch view mode"),"aria-expanded":t,children:(0,m.jsxs)("span",{className:"cur-view-path-btn px-1",children:[(0,m.jsx)("span",{className:"sf3-font sf3-font-".concat(n,"-view")}),(0,m.jsx)("span",{className:"sf3-font sf3-font-down"})]})}),(0,m.jsx)(Fe.A,{right:!0,className:"mt-1",children:r.map((function(t,r){return(0,m.jsx)(pe.A,{className:"p-0",onClick:e.props.switchViewMode.bind(e,t.value),children:(0,m.jsxs)("div",{className:"view-modes-dropdown-wrapper",children:[(0,m.jsx)("span",{className:"view-modes-dropdown-tick",children:n===t.value&&(0,m.jsx)("i",{className:"sf2-icon-tick"})}),(0,m.jsxs)("span",{className:"view-modes-dropdown-content",children:[(0,m.jsx)("span",{className:"sf3-font-".concat(t.icon," sf3-font mr-2")}),(0,m.jsx)("span",{children:t.text})]}),(0,m.jsx)("span",{className:"view-modes-dropdown-shortcut",children:(0,m.jsx)("span",{children:t.shortcut})})]})},r)}))})]})}}])}(s.Component),Nr=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleDropdownMenu=function(){n.setState({isDropdownMenuOpen:!n.state.isDropdownMenuOpen})},n.state={isDropdownMenuOpen:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.state.isDropdownMenuOpen,n=this.props.sortOptions;return(0,m.jsxs)(ue.A,{isOpen:t,toggle:this.toggleDropdownMenu,children:[(0,m.jsx)(de.A,{tag:"div","data-toggle":"dropdown",title:(0,f.AP)("Switch sort mode"),"aria-label":(0,f.AP)("Switch sort mode"),"aria-expanded":t,children:(0,m.jsxs)("span",{className:"cur-view-path-btn px-1",role:"button",children:[(0,m.jsx)("i",{className:"sf3-font-sort2 sf3-font"}),(0,m.jsx)("i",{className:"sf3-font-down sf3-font"})]})}),(0,m.jsx)(Fe.A,{right:!0,className:"mt-1",children:n.map((function(t,n){return(0,m.jsx)(pe.A,{onClick:e.props.onSelectSortOption.bind(e,t),children:(0,m.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,m.jsx)("span",{className:"mr-8",children:t.text}),(0,m.jsx)("span",{children:t.isSelected&&(0,m.jsx)("i",{className:"sf2-icon-tick"})})]})},n)}))})]})}}])}(s.Component),Pr=n(73575),Tr=n(95754),Or=function(e){var t=e.view,n=(0,s.useState)((function(){return window.sfMetadataContext.localStorage.getItem("zoom-gear",0)||0})),r=(0,L.A)(n,2),o=r[0],a=r[1];(0,s.useEffect)((function(){var e=window.sfMetadataContext.localStorage.getItem("zoom-gear",0);a(e||0)}),[null===t||void 0===t?void 0:t._id]);var i=(0,s.useCallback)((function(e){var t=parseInt(e.target.value,10);a(t),window.sfMetadataContext.eventBus.dispatch(Pr.Tw.MODIFY_GALLERY_ZOOM_GEAR,t)}),[]),l=(0,s.useCallback)((function(){var e=Math.min(o+1,2);a(e),window.sfMetadataContext.eventBus.dispatch(Pr.Tw.MODIFY_GALLERY_ZOOM_GEAR,e)}),[o]),c=(0,s.useCallback)((function(){var e=Math.max(o-1,-2);a(e),window.sfMetadataContext.eventBus.dispatch(Pr.Tw.MODIFY_GALLERY_ZOOM_GEAR,e)}),[o]);return(0,m.jsxs)("div",{className:"metadata-slider-container",children:[(0,m.jsx)(P.A,{className:"metadata-slider-icon-button",onClick:c,children:(0,m.jsx)(Tr.A,{symbol:"minus_sign",className:"metadata-slider-icon"})}),(0,m.jsx)(I.A,{type:"range",min:"-2",max:"2",step:"1",value:o,onChange:i,className:"metadata-slider"}),(0,m.jsx)(P.A,{className:"metadata-slider-icon-button",onClick:l,children:(0,m.jsx)(Tr.A,{symbol:"plus_sign",className:"metadata-slider-icon"})})]})},jr=n(55097),Rr=n.n(jr),Lr=n(71791),Fr=n(3563),Ur=n(99153),Yr=function(e){var t=e.readOnly,n=e.columns,r=e.wrapperClass,o=e.filters,a=e.isNeedSubmit,i=e.isPre,l=e.collaborators,c=e.filtersClassName,u=e.target,d=e.filterConjunction,p=e.basicFilters,h=e.modifyFilters,g=(0,s.useState)(!1),v=(0,L.A)(g,2),y=v[0],C=v[1],A=(0,s.useMemo)((function(){return Rr()((0,Fr.a1m)(o||[],n))}),[o,n]),x=(0,s.useMemo)((function(){return A.length+p.length}),[A,p]),b=(0,s.useMemo)((function(){return 1===x?a?(0,f.AP)("1 preset filter"):(0,f.AP)("1 filter"):x>1?x+" "+(a?(0,f.AP)("Preset filters"):(0,f.AP)("Filters")):a?(0,f.AP)("Preset filter"):(0,f.AP)("Filter")}),[a,x]),_=(0,s.useCallback)((function(){C(!y)}),[y]),S=(0,s.useCallback)((function(e){e.stopPropagation(),(Fr.sR0.isEnter(e)||Fr.sR0.isSpace(e))&&_()}),[_]),D=(0,s.useCallback)((function(e){var t=e||{},r=t.filters,o=t.filter_conjunction,a=t.basic_filters,i=(0,Fr.a1m)(r,n);h(i,o,a)}),[n,h]);if(!n)return null;var E=w()(r,{active:x>0});return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(Lr.Oi,{iconName:"filter",size:24,className:E,onClick:_,role:"button",onKeyDown:S,title:b,"aria-label":b,tabIndex:0,id:u}),y&&(0,m.jsx)(Ur.Iz,{placement:"bottom-end",filtersClassName:c,target:u,readOnly:t,isNeedSubmit:a,columns:n,collaborators:l,filterConjunction:d,filters:A,basicFilters:p,hidePopover:_,update:D,isPre:i})]})};Yr.defaultProps={target:"sf-metadata-filter-popover",isNeedSubmit:!1,basicFilters:[]};var Br=Yr,Hr=n(58419),Vr=function(e){var t=e.target,n=e.type,r=e.sorts,o=e.readOnly,a=e.columns,i=e.isNeedSubmit,l=e.wrapperClass,c=e.modifySorts,u=(0,s.useState)(!1),d=(0,L.A)(u,2),p=d[0],f=d[1],h=(0,s.useMemo)((function(){return(0,Fr.iWx)(r||[],a)}),[r,a]),g=(0,s.useMemo)((function(){var e=h.length;return 1===e?i?(0,Hr.AP)("1 preset sort"):(0,Hr.AP)("1 sort"):e>1?e+" "+(i?(0,Hr.AP)("preset sorts"):(0,Hr.AP)("sorts")):i?(0,Hr.AP)("Preset sort"):(0,Hr.AP)("Sort")}),[i,h]),v=(0,s.useCallback)((function(){f(!0)}),[]);(0,s.useEffect)((function(){var e=window.sfMetadataContext.eventBus.subscribe(Pr.Tw.DISPLAY_SORTS,v);return function(){e()}}),[]);var y=(0,s.useCallback)((function(){f(!p)}),[p]),C=(0,s.useCallback)((function(e){e.stopPropagation(),(Fr.sR0.isEnter(e)||Fr.sR0.isSpace(e))&&y()}),[y]),A=(0,s.useCallback)((function(e){var t=(e||{}).sorts;c(t)}),[c]);if(!a)return null;var x=w()(l,{active:h.length>0});return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(Lr.Oi,{iconName:"sort",size:24,className:x,onClick:y,role:"button",onKeyDown:C,title:g,"aria-label":g,tabIndex:0,id:t}),p&&(0,m.jsx)(Ur.cu,{isNeedSubmit:i,readOnly:o,type:n,target:t,columns:a,sorts:h,onSortComponentToggle:y,update:A})]})};Vr.defaultProps={target:"sf-metadata-sort-popover",isNeedSubmit:!1};var Gr=Vr,qr=function(e){var t=e.columns,n=e.readOnly,r=e.isNeedSubmit,o=e.groupbys,a=e.wrapperClass,i=e.target,l=e.modifyGroupbys,c=(0,s.useState)(!1),u=(0,L.A)(c,2),d=u[0],p=u[1],f=(0,s.useMemo)((function(){return t.filter((function(e){return Fr.LlW.includes(e.type)}))}),[t]),h=(0,s.useMemo)((function(){return(0,Fr.YD9)(o,f)||[]}),[f,o]),g=(0,s.useMemo)((function(){var e=h?h.length:0;return 1===e?(0,Hr.AP)("Grouped by 1 property"):e>1?(0,Hr.AP)("Grouped by xxx properties").replace("xxx",e):(0,Hr.AP)("Group by")}),[h]),v=(0,s.useCallback)((function(){p(!d)}),[d]),y=(0,s.useCallback)((function(e){e.stopPropagation(),(Fr.sR0.isEnter(e)||Fr.sR0.isSpace(e))&&v()}),[v]),C=(0,s.useCallback)((function(e){var t=(0,Fr.YD9)(e,f);l(t)}),[f,l]),A=w()(a,{active:h.length>0});return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(Lr.Oi,{iconName:"group",size:24,className:A,onClick:v,role:"button",onKeyDown:y,title:g,"aria-label":g,tabIndex:0,id:i}),d&&(0,m.jsx)(Ur.D0,{isNeedSubmit:r,readOnly:n,groupbys:h,target:i,placement:"bottom-end",columns:f,hidePopover:v,onChange:C})]})};qr.defaultProps={target:"sf-metadata-groupby-popover",isNeedSubmit:!1};var zr=qr,Wr=(s.Component,function(e){var t=e.readOnly,n=e.columns,r=e.wrapperClass,o=e.target,a=e.hiddenColumns,i=e.modifyHiddenColumns,l=e.modifyColumnOrder,c=(0,s.useState)(!1),u=(0,L.A)(c,2),d=u[0],p=u[1],f=(0,s.useMemo)((function(){return a.filter((function(e){return n.find((function(t){return t.key===e}))}))}),[n,a]),h=(0,s.useMemo)((function(){var e=f.length;return 1===e?(0,Hr.AP)("1 hidden property"):e>1?(0,Hr.AP)("xxx hidden properties").replace("xxx",e):(0,Hr.AP)("Hide properties")}),[f]),g=(0,s.useCallback)((function(){p(!d)}),[d]),v=(0,s.useCallback)((function(e){e.stopPropagation(),(Fr.sR0.isEnter(e)||Fr.sR0.isSpace(e))&&g()}),[g]),y=(0,s.useCallback)((function(e){i(e)}),[i]),C=w()(r,{active:f.length>0});return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(Lr.Oi,{iconName:"hide",size:24,className:C,onClick:g,role:"button",onKeyDown:v,title:h,"aria-label":h,tabIndex:0,id:o}),d&&(0,m.jsx)(Ur.Oe,{readOnly:t,hiddenColumns:f,target:o,placement:"bottom-end",columns:n,hidePopover:g,onChange:y,modifyColumnOrder:l})]})}),Kr=function(e){var t=e.viewId,n=(0,s.useState)(null),r=(0,L.A)(n,2),o=r[0],a=r[1],i=(0,s.useState)([]),l=(0,L.A)(i,2),c=l[0],u=l[1],d=(0,s.useMemo)((function(){return o?o.columns:[]}),[o]),p=(0,s.useCallback)((function(){window.sfMetadataContext.eventBus.dispatch(Pr.Tw.SELECT_NONE)}),[]),f=(0,s.useCallback)((function(e,t,n){window.sfMetadataContext.eventBus.dispatch(Pr.Tw.MODIFY_FILTERS,e,t,n)}),[]),h=(0,s.useCallback)((function(e){window.sfMetadataContext.eventBus.dispatch(Pr.Tw.MODIFY_SORTS,e)}),[]),g=(0,s.useCallback)((function(e){window.sfMetadataContext.eventBus.dispatch(Pr.Tw.MODIFY_GROUPBYS,e)}),[]),v=(0,s.useCallback)((function(e){window.sfMetadataContext.eventBus.dispatch(Pr.Tw.MODIFY_HIDDEN_COLUMNS,e)}),[]),y=(0,s.useCallback)((function(e,t){window.sfMetadataContext.eventBus.dispatch(Pr.Tw.MODIFY_COLUMN_ORDER,e,t)}),[]),C=(0,s.useCallback)((function(e){a(e)}),[]);if((0,s.useEffect)((function(){var e,t=setInterval((function(){var n;window.sfMetadataContext&&window.sfMetadataStore.data&&(t&&clearInterval(t),t=null,a(window.sfMetadataStore.data.view),u((null===(n=window.sfMetadataStore)||void 0===n?void 0:n.collaborators)||[]),e=window.sfMetadataContext.eventBus.subscribe(Pr.Tw.VIEW_CHANGED,C))}),300);return function(){t&&clearInterval(t),e&&e()}}),[t]),!o)return null;var A=o.type,x=!window.sfMetadataContext.canModifyView(o);return(0,m.jsxs)("div",{className:"sf-metadata-tool",onClick:p,children:[(0,m.jsxs)("div",{className:"sf-metadata-tool-left-operations",children:[o.type===Fr.rX9.GALLERY&&(0,m.jsx)(Or,{view:o}),(0,m.jsx)(Br,{isNeedSubmit:!0,wrapperClass:"sf-metadata-view-tool-operation-btn sf-metadata-view-tool-filter",filtersClassName:"sf-metadata-filters",target:"sf-metadata-filter-popover",readOnly:x,filterConjunction:o.filter_conjunction,basicFilters:o.basic_filters,filters:o.filters,columns:d,modifyFilters:f,collaborators:c}),(0,m.jsx)(Gr,{isNeedSubmit:!0,wrapperClass:"sf-metadata-view-tool-operation-btn sf-metadata-view-tool-sort",target:"sf-metadata-sort-popover",readOnly:x,sorts:o.sorts,type:A,columns:d,modifySorts:h}),A!==Fr.rX9.GALLERY&&(0,m.jsx)(zr,{isNeedSubmit:!0,wrapperClass:"sf-metadata-view-tool-operation-btn sf-metadata-view-tool-groupby",target:"sf-metadata-groupby-popover",readOnly:x,columns:d,groupbys:o.groupbys,modifyGroupbys:g}),A!==Fr.rX9.GALLERY&&(0,m.jsx)(Wr,{wrapperClass:"sf-metadata-view-tool-operation-btn sf-metadata-view-tool-hide-column",target:"sf-metadata-hide-column-popover",readOnly:x,columns:d.slice(1),hiddenColumns:o.hidden_columns||[],modifyHiddenColumns:v,modifyColumnOrder:y})]}),(0,m.jsx)("div",{className:"sf-metadata-tool-right-operations"})]})},Zr=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleDropdownMenu=function(){n.setState({isDropdownMenuOpen:!n.state.isDropdownMenuOpen})},n.hidePopover=function(e){if(e)for(var t=e.target;t;){if("string"===typeof t.className&&t.className.includes("tag-color-popover"))return;t=t.parentNode}n.setState({isRepoTagDialogOpen:!1})},n.toggleCancel=function(){n.setState({isRepoTagDialogOpen:!1})},n.getMenu=function(){var e=[],t=n.props,r=t.userPerm,o=t.currentPath;if("rw"!==r||h.Aq.isMarkdownFile(o))return e;var a=dr.A.TAGS;return f.DX&&e.push(a),e},n.onMenuItemClick=function(e){if("Tags"===e.key)n.setState({isRepoTagDialogOpen:!n.state.isRepoTagDialogOpen})},n.onMenuItemKeyDown=function(e,t){"Enter"!=e.key&&"Space"!=e.key||n.onMenuItemClick(t)},n.onSelectSortOption=function(e){var t=e.value.split("-"),r=(0,L.A)(t,2),o=r[0],a=r[1];n.props.sortItems(o,a)},n.state={isRepoTagDialogOpen:!1,isDropdownMenuOpen:!1},n.sortOptions=[{value:"name-asc",text:(0,f.AP)("By name ascending")},{value:"name-desc",text:(0,f.AP)("By name descending")},{value:"time-asc",text:(0,f.AP)("By time ascending")},{value:"time-desc",text:(0,f.AP)("By time descending")}],n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.getMenu(),n=this.state.isDropdownMenuOpen,r=this.props,o=r.repoID,a=r.currentMode,i=r.currentPath,l=r.sortBy,c=r.sortOrder,u=r.viewId,d=dr.A.PROPERTIES.value,p=i.startsWith("/"+j.AT.FILE_EXTENDED_PROPERTIES+"/"),h=this.sortOptions.map((function(e){return(0,ur.A)((0,ur.A)({},e),{},{isSelected:e.value==="".concat(l,"-").concat(c)})}));return p?(0,m.jsx)("div",{className:"dir-tool",children:(0,m.jsx)(Kr,{viewId:u})}):(0,m.jsxs)(s.Fragment,{children:[(0,m.jsxs)("div",{className:"dir-tool d-flex",children:[(0,m.jsx)(Ir,{currentViewMode:a,switchViewMode:this.props.switchViewMode}),(0,m.jsx)(Nr,{sortOptions:h,onSelectSortOption:this.onSelectSortOption}),!this.props.isCustomPermission&&(0,m.jsx)("div",{className:"cur-view-path-btn",onClick:function(){return e.props.switchViewMode("detail")},children:(0,m.jsx)("span",{className:"sf3-font sf3-font-info","aria-label":d,title:d})}),t.length>0&&(0,m.jsxs)(ue.A,{isOpen:n,toggle:this.toggleDropdownMenu,children:[(0,m.jsx)(de.A,{tag:"i",id:"cur-folder-more-op-toggle",className:"cur-view-path-btn sf3-font-more sf3-font","data-toggle":"dropdown",title:(0,f.AP)("More operations"),"aria-label":(0,f.AP)("More operations"),"aria-expanded":n}),(0,m.jsx)(Fe.A,{right:!0,children:t.map((function(t,n){return"Divider"===t?(0,m.jsx)(pe.A,{divider:!0},n):(0,m.jsx)(pe.A,{onClick:e.onMenuItemClick.bind(e,t),onKeyDown:e.onMenuItemKeyDown.bind(e,t),children:t.value},n)}))})]})]}),this.state.isRepoTagDialogOpen&&(0,m.jsx)(pr.A,{popoverClassName:"list-tag-popover",target:"cur-folder-more-op-toggle",hideSeahubPopover:this.hidePopover,hideSeahubPopoverWithEsc:this.hidePopover,canHideSeahubPopover:!0,boundariesElement:document.body,placement:"bottom-end",children:(0,m.jsx)(Mr,{repoID:o,onListTagCancel:this.toggleCancel})})]})}}])}(s.Component),Xr=n(7266),$r=n(92811),Jr=s.memo((function(e){var t=e.currentRepoInfo,n=e.onClose,r=(0,s.useState)(!0),o=(0,L.A)(r,2),a=o[0],i=o[1],l=(0,s.useState)({}),c=(0,L.A)(l,2),u=c[0],d=c[1],p=(0,s.useMemo)((function(){return h.Aq.getLibIconUrl(t)}),[t]),g=(0,s.useMemo)((function(){return{type:Fr.vZe.NUMBER,name:(0,f.AP)("Files")}}),[]),v=(0,s.useMemo)((function(){return{type:"size",name:(0,f.AP)("Size")}}),[]),y=(0,s.useMemo)((function(){return{type:Fr.vZe.CREATOR,name:(0,f.AP)("Creator")}}),[]),C=(0,s.useMemo)((function(){return{type:Fr.vZe.MTIME,name:(0,f.AP)("Last modified time")}}),[]);return(0,s.useEffect)((function(){i(!0),S.e.getRepoInfo(t.repo_id).then((function(e){var t=new Ke(e.data);d(t),i(!1)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))}),[t.repo_id]),(0,m.jsxs)(Xr.kZ,{children:[(0,m.jsx)(Xr.Y9,{title:t.repo_name,icon:p,onClose:n}),(0,m.jsx)(Xr.nB,{children:a?(0,m.jsx)("div",{className:"w-100 h-100 d-flex algin-items-center justify-content-center",children:(0,m.jsx)(Z.A,{})}):(0,m.jsxs)("div",{className:"detail-content",children:[(0,m.jsx)($r.A,{field:g,value:u.file_count||0,className:"sf-metadata-property-detail-formatter",children:(0,m.jsx)(Lr.ZA,{field:g,value:u.file_count||0})}),(0,m.jsx)($r.A,{field:v,value:u.size,className:"sf-metadata-property-detail-formatter",children:(0,m.jsx)(Lr.ZA,{field:v,value:u.size})}),(0,m.jsx)($r.A,{field:y,className:"sf-metadata-property-detail-formatter",children:(0,m.jsx)(Lr.ZA,{field:y,value:u.owner_email,collaborators:[{name:u.owner_name,contact_email:u.owner_contact_email,email:u.owner_email,avatar_url:u.owner_avatar}]})}),(0,m.jsx)($r.A,{field:C,className:"sf-metadata-property-detail-formatter",children:(0,m.jsx)(Lr.ZA,{field:C,value:u.last_modified})})]})})]})}),(function(e,t){return e.currentRepo.repo_id===t.currentRepo.repo_id})),Qr=function(e,t){return h.Aq.isMarkdownFile(t)?t:h.Aq.joinPath(t,e.name)},eo=n(53264),to=function(e){var t=e.repoID,n=e.repoInfo,r=e.dirent,o=e.path,a=e.direntDetail,i=(0,s.useMemo)((function(){return Qr(r,o)}),[r,o]),l=(0,eo.p_)().enableMetadata,c=(0,s.useMemo)((function(){return{type:Fr.vZe.MTIME,name:(0,f.AP)("Last modified time")}}),[]);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)($r.A,{field:c,className:"sf-metadata-property-detail-formatter",children:(0,m.jsx)(Lr.ZA,{field:c,value:a.mtime})}),window.app.pageOptions.enableMetadataManagement&&l&&(0,m.jsx)(eo.iF,{repoID:t,repoInfo:n,filePath:i,direntType:"dir"})]})},no=n(54033),ro=n(50224),oo=n(51528),ao=s.memo((function(e){var t=e.repoID,n=e.repoInfo,r=e.dirent,o=e.path,a=e.direntDetail,i=e.onFileTagChanged,l=e.repoTags,c=e.fileTagList,u=(0,s.useState)(!1),d=(0,L.A)(u,2),p=d[0],g=d[1],v=(0,eo.p_)().enableMetadata,y=(0,s.useMemo)((function(){return Qr(r,o)}),[r,o]),C=(0,s.useMemo)((function(){return"detail-list-view-tags-".concat(Cr())}),[]),A=(0,s.useMemo)((function(){return{type:"size",name:(0,f.AP)("Size")}}),[]),x=(0,s.useMemo)((function(){return{type:Fr.vZe.LAST_MODIFIER,name:(0,f.AP)("Last modifier")}}),[]),b=(0,s.useMemo)((function(){return{type:Fr.vZe.MTIME,name:(0,f.AP)("Last modified time")}}),[]),_=(0,s.useMemo)((function(){return{type:Fr.vZe.SINGLE_SELECT,name:(0,f.AP)("Tags")}}),[]),S=(0,s.useCallback)((function(){g(!p)}),[p]),D=(0,s.useCallback)((function(){i(r,y)}),[r,y,i]);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)($r.A,{field:A,className:"sf-metadata-property-detail-formatter",children:(0,m.jsx)(Lr.ZA,{field:A,value:h.Aq.bytesToSize(a.size)})}),(0,m.jsx)($r.A,{field:x,className:"sf-metadata-property-detail-formatter",children:(0,m.jsx)(Lr.ZA,{field:x,value:a.last_modifier_email,collaborators:[{name:a.last_modifier_name,contact_email:a.last_modifier_contact_email,email:a.last_modifier_email,avatar_url:a.last_modifier_avatar}]})}),(0,m.jsx)($r.A,{field:b,className:"sf-metadata-property-detail-formatter",children:(0,m.jsx)(Lr.ZA,{field:b,value:a.last_modified})}),window.app.pageOptions.enableFileTags&&!v&&(0,m.jsx)($r.A,{field:_,className:"sf-metadata-property-detail-formatter",children:(0,m.jsx)("div",{className:w()("sf-metadata-property-detail-tags",{"tags-empty":!Array.isArray(c)||0===c.length}),id:C,onClick:S,children:Array.isArray(c)&&c.length>0?(0,m.jsx)(ro.A,{fileTagList:c}):(0,m.jsx)("span",{className:"empty-tip-text",children:(0,f.AP)("Empty")})})}),window.app.pageOptions.enableMetadataManagement&&v&&(0,m.jsx)(eo.iF,{repoID:t,filePath:y,repoInfo:n,direntType:"file"}),p&&(0,m.jsx)(no.A,{repoID:t,repoTags:l,filePath:y,fileTagList:c,toggleCancel:S,onFileTagChanged:D,target:C})]})}),(function(e,t){var n=e.repoID,r=e.repoInfo,o=e.dirent,a=e.path,i=e.direntDetail,s=e.repoTags,l=e.fileTagList;return!(n!==t.repoID||a!==t.path||!oo.A.isSameObject(r,t.repoInfo)||!oo.A.isSameObject(o,t.dirent)||!oo.A.isSameObject(i,t.direntDetail)||s!==t.repoTags||l!==t.fileTagList)})),io=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).updateDetail=function(e,t,r){var o="file"===t.type?"getFileInfo":"getDirInfo";S.e[o](e,r).then((function(e){n.setState({direntDetail:e.data,dirent:t})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.loadDetail=function(e,t,r){if(t){var o=h.Aq.joinPath(r,t.name);n.updateDetail(e,t,o)}else{var a=h.Aq.getDirName(r);S.e.listDir(e,a).then((function(t){var o=t.data.dirent_list.find((function(e){return e.parent_dir+e.name===r}))||null;o&&(o=new Hn.A(o)),n.updateDetail(e,o,r)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))}},n.renderImage=function(){var e=n.state.dirent;if(!e)return null;if(!h.Aq.imageCheck(e.name))return null;var t=n.props,r=t.repoID,o=t.path,a="".concat(f.Yc,"thumbnail/").concat(r,"/").concat(f.HJ)+h.Aq.encodePath("".concat("/"===o?"":o,"/").concat(e.name));return(0,m.jsx)("div",{className:"detail-image-thumbnail",children:(0,m.jsx)("img",{src:a,alt:"",className:"thumbnail"})})},n.state={direntDetail:"",dirent:null},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.loadDetail(this.props.repoID,this.props.dirent,this.props.path)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this,n=this.props,r=n.dirent,o=n.path,a=n.repoID,i=n.currentRepoInfo,s=n.repoTags,l=n.fileTags;oo.A.isSameObject(i,e.currentRepoInfo)&&oo.A.isSameObject(r,e.dirent)&&JSON.stringify(s||[])===JSON.stringify(e.repoTags||[])&&JSON.stringify(l||[])===JSON.stringify(e.fileTags||[])&&o===e.path&&a===e.repoID||this.setState({dirent:null},(function(){t.loadDetail(e.repoID,e.dirent,e.path)}))}},{key:"render",value:function(){var e=this.state,t=e.dirent,n=e.direntDetail,r=this.props,o=r.repoID,a=r.path,i=r.fileTags,s=(null===t||void 0===t?void 0:t.name)||"",l=h.Aq.getDirentIcon(t);return(0,m.jsxs)(Xr.kZ,{children:[(0,m.jsx)(Xr.Y9,{title:s,icon:l,onClose:this.props.onClose}),(0,m.jsxs)(Xr.nB,{children:[this.renderImage(),t&&n&&(0,m.jsx)("div",{className:"detail-content",children:"file"!==t.type?(0,m.jsx)(to,{repoID:o,repoInfo:this.props.currentRepoInfo,dirent:t,direntDetail:n,path:this.props.dirent?a+"/"+t.name:a}):(0,m.jsx)(ao,{repoID:o,repoInfo:this.props.currentRepoInfo,dirent:t,path:a,direntDetail:n,repoTags:this.props.repoTags,fileTagList:t?t.file_tags:i,onFileTagChanged:this.props.onFileTagChanged})})]})]})}}])}(s.Component),so=s.memo((function(e){var t=e.repoID,n=e.path,r=e.dirent,o=e.currentRepoInfo,a=e.repoTags,i=e.fileTags,l=e.onClose,c=e.onFileTagChanged;return(0,s.useEffect)((function(){var e=new eo.BT;return window.sfMetadataContext=e,window.sfMetadataContext.init({repoID:t,repoInfo:o}),function(){window.sfMetadataContext.destroy(),delete window.sfMetadataContext}}),[t,o]),"/"!==n||r?(0,m.jsx)(io,{repoID:t,path:n,dirent:r,currentRepoInfo:o,repoTags:a,fileTags:i,onFileTagChanged:c,onClose:l}):(0,m.jsx)(Jr,{currentRepoInfo:o,onClose:l})}),(function(e,t){return!(e.repoID!==t.repoID||e.path!==t.path||!oo.A.isSameObject(e.dirent,t.dirent)||!oo.A.isSameObject(e.currentRepoInfo,t.currentRepoInfo)||JSON.stringify(e.repoTags||[])!==JSON.stringify(t.repoTags||[])||JSON.stringify(e.fileTags||[])!==JSON.stringify(t.fileTags||[]))})),lo=n(79837),co=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).handleChange=function(e){e.target.value.trim()?n.setState({isSubmitBtnActive:!0}):n.setState({isSubmitBtnActive:!1}),n.setState({newName:e.target.value})},n.handleSubmit=function(){var e=n.state.newName.trim(),t=(0,h.yS)(e),r=t.isValid,o=t.errMessage;if(r){if(n.props.checkDuplicatedName(e)){var a=(0,f.AP)('The name "{name}" is already taken. Please choose a different name.');return a=a.replace("{name}",h.Aq.HTMLescape(e)),void n.setState({errMessage:a})}n.props.onRename(e)}else n.setState({errMessage:o})},n.handleKeyDown=function(e){"Enter"===e.key&&n.handleSubmit()},n.toggle=function(){n.props.toggleCancel()},n.changeState=function(e){var t=e.object.name;n.setState({newName:t})},n.onAfterModelOpened=function(){if(n.newInput.current){var e=n.props.currentNode,t=e.object.type;if(n.newInput.current.focus(),"file"===t){var r=e.object.name.lastIndexOf(".md");n.newInput.current.setSelectionRange(0,r,"forward")}else n.newInput.current.setSelectionRange(0,-1)}},n.state={newName:"",errMessage:"",isSubmitBtnActive:!1},n.newInput=s.createRef(),n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"UNSAFE_componentWillMount",value:function(){this.setState({newName:this.props.currentNode.object.name})}},{key:"componentDidMount",value:function(){var e=this.props.currentNode;this.changeState(e)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.changeState(e.currentNode)}},{key:"render",value:function(){var e=this.props.currentNode.object.type;return(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.toggle,onOpened:this.onAfterModelOpened,children:[(0,m.jsx)(k.A,{toggle:this.toggle,children:"file"===e?(0,f.AP)("Rename File"):(0,f.AP)("Rename Folder")}),(0,m.jsxs)(M.A,{children:[(0,m.jsx)("p",{children:"file"===e?(0,f.AP)("New file name"):(0,f.AP)("New folder name")}),(0,m.jsx)(I.A,{onKeyDown:this.handleKeyDown,innerRef:this.newInput,placeholder:"newName",value:this.state.newName,onChange:this.handleChange}),this.state.errMessage&&(0,m.jsx)(St.A,{color:"danger",className:"mt-2",children:this.state.errMessage})]}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(P.A,{color:"secondary",onClick:this.toggle,children:(0,f.AP)("Cancel")}),(0,m.jsx)(P.A,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive,children:(0,f.AP)("Submit")})]})]})}}])}(s.Component),uo=n(70349),po=n(23931),fo=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).handleSubmit=function(){n.props.isMultipleOperation?n.copyItems():n.copyItem()},n.copyItems=function(){var e=n.state,t=e.repo,r=e.selectedPath,o=(0,f.AP)("Invalid destination path");if(t&&""!==r){var a=n.props.selectedDirentList,i=[];if(a.forEach((function(e){var t=h.Aq.joinPath(n.props.path,e.name);i.push(t)})),i.some((function(e){return e===r})))n.setState({errMessage:o});else{var s="";if(i.some((function(e){var t=r.length>e.length&&r.indexOf(e)>-1;return t&&(s=e),t})))return o=(o=(o=(0,f.AP)("Can not move folder %(src)s to its subfolder %(des)s")).replace("%(src)s",s)).replace("%(des)s",r),void n.setState({errMessage:o});n.props.onItemsCopy(t,r),n.toggle()}}else n.setState({errMessage:o})},n.copyItem=function(){var e=n.state,t=e.repo,r=e.repoID,o=e.selectedPath,a=h.Aq.joinPath(n.props.path,n.props.dirent.name),i=(0,f.AP)("Invalid destination path");if(!t||t.repo_id===r&&""===o)n.setState({errMessage:i});else if(o&&a===o)n.setState({errMessage:i});else{if(o&&o.length>a.length&&o.indexOf(a)>-1)return i=(i=(i=(0,f.AP)("Can not copy folder %(src)s to its subfolder %(des)s")).replace("%(src)s",a)).replace("%(des)s",o),void n.setState({errMessage:i});n.props.onItemCopy(t,n.props.dirent,o,n.props.path),n.toggle()}},n.toggle=function(){n.props.onCancelCopy()},n.onDirentItemClick=function(e,t){n.setState({repo:e,selectedPath:t,errMessage:""})},n.onRepoItemClick=function(e){n.setState({repo:e,selectedPath:"/",errMessage:""})},n.onSelectedMode=function(e){n.setState({mode:e})},n.renderTitle=function(){var e=n.props,t=e.dirent,r=e.isMultipleOperation,o=(0,f.AP)("Copy {placeholder} to");return r?(0,f.AP)("Copy selected item(s) to:"):o.replace("{placeholder}",'<span class="op-target text-truncate mx-1">'.concat(h.Aq.HTMLescape(t.name),"</span>"))},n.state={repo:{repo_id:n.props.repoID},selectedPath:n.props.path,errMessage:"",mode:"only_current_library"},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.dirent,r=t.selectedDirentList,o=t.isMultipleOperation,a=t.repoID,i=t.path,s=this.state,l=s.mode,c=s.errMessage,u=(n||r[0]).permission,d=h.Aq.getUserPermission(u).isCustomPermission,g=function(t){var n=t.mode,r=t.label;return(0,m.jsx)("div",{className:"repo-list-item ".concat(e.state.mode===n?"active":""),onClick:function(){return e.onSelectedMode(n)},children:(0,m.jsx)("span",{className:"library",children:r})})};return(0,m.jsxs)(p.A,{className:"custom-modal",isOpen:!0,toggle:this.toggle,children:[(0,m.jsx)(k.A,{toggle:this.toggle,children:o?this.renderTitle():(0,m.jsx)("div",{dangerouslySetInnerHTML:{__html:this.renderTitle()},className:"d-flex mw-100"})}),(0,m.jsxs)(uo.A,{children:[(0,m.jsxs)(po.A,{className:"repo-list-col border-right",children:[(0,m.jsx)(g,{mode:"only_current_library",label:(0,f.AP)("Current Library")}),!d&&(0,m.jsx)(g,{mode:"only_other_libraries",label:(0,f.AP)("Other Libraries")}),(0,m.jsx)(g,{mode:"recently_used",label:(0,f.AP)("Recently Used")})]}),(0,m.jsxs)(po.A,{className:"file-list-col",children:[(0,m.jsxs)(M.A,{children:[(0,m.jsx)(Bt.A,{repoID:a,currentPath:i,onDirentItemClick:this.onDirentItemClick,onRepoItemClick:this.onRepoItemClick,mode:l,hideLibraryName:!1}),c&&(0,m.jsx)(St.A,{color:"danger",className:"mt-2",children:c})]}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(P.A,{color:"secondary",onClick:this.toggle,children:(0,f.AP)("Cancel")}),(0,m.jsx)(P.A,{color:"primary",onClick:this.handleSubmit,children:(0,f.AP)("Submit")})]})]})]})]})}}])}(s.Component),ho=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).handleSubmit=function(){n.props.isMultipleOperation?n.moveItems():n.moveItem()},n.moveItems=function(){var e=n.props.repoID,t=n.state,r=t.repo,o=t.selectedPath,a=(0,f.AP)("Invalid destination path");if(r&&""!==o){var i=n.props.selectedDirentList,s=[];if(i.forEach((function(e){var t=h.Aq.joinPath(n.props.path,e.name);s.push(t)})),s.some((function(e){return e===o})))n.setState({errMessage:a});else if(o&&o===n.props.path&&r.repo_id===e)n.setState({errMessage:a});else{var l="";if(s.some((function(e){var t=o.length>e.length&&o.indexOf(e)>-1;return t&&(l=e),t})))return a=(a=(a=(0,f.AP)("Can not move folder %(src)s to its subfolder %(des)s")).replace("%(src)s",l)).replace("%(des)s",o),void n.setState({errMessage:a});n.props.onItemsMove(r,o),n.toggle()}}else n.setState({errMessage:a})},n.moveItem=function(){var e=n.props.repoID,t=n.state,r=t.repo,o=t.selectedPath,a=h.Aq.joinPath(n.props.path,n.props.dirent.name),i=(0,f.AP)("Invalid destination path");if(!r||r.repo_id===e&&""===o)n.setState({errMessage:i});else if(o&&a===o)n.setState({errMessage:i});else if(o&&n.props.path===o&&r.repo_id===e)n.setState({errMessage:i});else{if(o&&o.length>a.length&&o.indexOf(a)>-1)return i=(i=(i=(0,f.AP)("Can not move folder %(src)s to its subfolder %(des)s")).replace("%(src)s",a)).replace("%(des)s",o),void n.setState({errMessage:i});n.props.onItemMove(r,n.props.dirent,o,n.props.path),n.toggle()}},n.toggle=function(){n.props.onCancelMove()},n.onDirentItemClick=function(e,t){n.setState({repo:e,selectedPath:t,errMessage:""})},n.onRepoItemClick=function(e){n.setState({repo:e,selectedPath:"/",errMessage:""})},n.onSelectedMode=function(e){n.setState({mode:e})},n.renderTitle=function(){var e=n.props,t=e.dirent,r=e.isMultipleOperation,o=(0,f.AP)("Move {placeholder} to");return r?(0,f.AP)("Move selected item(s) to:"):o.replace("{placeholder}",'<span class="op-target text-truncate mx-1">'.concat(h.Aq.HTMLescape(t.name),"</span>"))},n.state={repo:{repo_id:n.props.repoID},selectedPath:n.props.path,errMessage:"",mode:"only_current_library"},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.dirent,r=t.selectedDirentList,o=t.isMultipleOperation,a=t.repoID,i=t.path,s=this.state,l=s.mode,c=s.errMessage,u=(n||r[0]).permission,d=h.Aq.getUserPermission(u).isCustomPermission,g=function(t){var n=t.mode,r=t.label;return(0,m.jsx)("div",{className:"repo-list-item ".concat(e.state.mode===n?"active":""),onClick:function(){return e.onSelectedMode(n)},children:(0,m.jsx)("span",{className:"library",children:r})})};return(0,m.jsxs)(p.A,{className:"custom-modal",isOpen:!0,toggle:this.toggle,children:[(0,m.jsx)(k.A,{toggle:this.toggle,children:o?this.renderTitle():(0,m.jsx)("div",{dangerouslySetInnerHTML:{__html:this.renderTitle()},className:"d-flex mw-100"})}),(0,m.jsxs)(uo.A,{children:[(0,m.jsxs)(po.A,{className:"repo-list-col border-right",children:[(0,m.jsx)(g,{mode:"only_current_library",label:(0,f.AP)("Current Library")}),!d&&(0,m.jsx)(g,{mode:"only_other_libraries",label:(0,f.AP)("Other Libraries")}),(0,m.jsx)(g,{mode:"recently_used",label:(0,f.AP)("Recently Used")})]}),(0,m.jsxs)(po.A,{className:"file-list-col",children:[(0,m.jsxs)(M.A,{children:[(0,m.jsx)(Bt.A,{repoID:a,currentPath:i,onDirentItemClick:this.onDirentItemClick,onRepoItemClick:this.onRepoItemClick,mode:l,hideLibraryName:!1}),c&&(0,m.jsx)(St.A,{color:"danger",className:"alert-message",children:c})]}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(P.A,{color:"secondary",onClick:this.toggle,children:(0,f.AP)("Cancel")}),(0,m.jsx)(P.A,{color:"primary",onClick:this.handleSubmit,children:(0,f.AP)("Submit")})]})]})]})]})}}])}(s.Component),mo=n(60472),go=n(64467),vo=n(36402),yo=function(e){var t=e.title,n=e.children,r=e.moreKey,o=e.moreOperations,a=e.moreOperationClick,i=e.className,l=e.isDisplayFiles,c=(0,s.useState)(!0),u=(0,L.A)(c,2),d=u[0],p=u[1],f=(0,s.useState)(!1),g=(0,L.A)(f,2),v=g[0],y=g[1],C=(0,s.useState)(!1),A=(0,L.A)(C,2),x=A[0],b=A[1],_=(0,s.useMemo)((function(){return Array.isArray(o)&&0!==o.length?o.filter((function(e){return e.key&&e.value})):[]}),[o]),S=(0,s.useCallback)((function(){p(!d)}),[d]),D=(0,s.useCallback)((function(){x||y(!0)}),[x]),E=(0,s.useCallback)((function(){x||y(!0)}),[x]),k=(0,s.useCallback)((function(){x||y(!1)}),[x]),M=(0,s.useCallback)((function(){b(!0)}),[]),I=(0,s.useCallback)((function(){b(!1),y(!1)}),[]);return(0,m.jsxs)("div",{className:w()("tree-section",(0,go.default)({},i,i)),children:[(0,m.jsxs)("div",{className:w()("tree-section-header",{"tree-section-header-hover":v}),onMouseEnter:D,onMouseOver:E,onMouseLeave:k,children:[(0,m.jsx)("div",{className:"tree-section-header-title",children:t}),(0,m.jsxs)("div",{className:"tree-section-header-operations",children:[_.length>0&&(0,m.jsx)(m.Fragment,{children:(0,m.jsx)("div",{className:"tree-section-header-operation tree-section-more-operation",children:(0,m.jsx)(vo.A,{item:r,toggleClass:"sf3-font sf3-font-more",freezeItem:M,unfreezeItem:I,getMenuList:function(){return _},onMenuItemClick:a,menuStyle:h.Fr?{zIndex:1050}:{},isDisplayFiles:l})})}),(0,m.jsx)("div",{className:"tree-section-header-operation",onClick:S,children:(0,m.jsx)("i",{className:"sf3-font sf3-font-down ".concat(d?"":"rotate-90")})})]})]}),d&&(0,m.jsx)("div",{className:"tree-section-body",children:n})]})},Co=function(e){var t=e.userPerm,n=e.repoID,r=e.currentPath,o=e.currentRepoInfo,a=(0,s.useMemo)((function(){return window.app.pageOptions.enableMetadataManagement}),[window.app.pageOptions.enableMetadataManagement]),i=(0,s.useState)(!1),l=(0,L.A)(i,2),c=l[0],u=l[1],d=(0,eo.p_)(),p=d.enableMetadata,h=d.updateEnableMetadata,g=d.navigation,v=(0,s.useMemo)((function(){return a&&o.is_admin?[{key:"extended-properties",value:(0,f.AP)("Extended properties")}]:[]}),[a,o]),y=(0,s.useCallback)((function(e){"extended-properties"!==e||u(!0)}),[]),C=(0,s.useCallback)((function(){u(!1)}),[]),A=(0,s.useCallback)((function(e){h(e)}),[h]);return a?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(yo,{title:(0,f.AP)("Views"),moreKey:{name:"views"},moreOperations:v,moreOperationClick:y,children:p&&Array.isArray(g)&&g.length>0&&(0,m.jsx)(eo.Lr,{userPerm:t,currentPath:r})}),c&&(0,m.jsx)(eo.nx,{value:p,repoID:n,toggle:C,submit:A})]}):null},Ao=function(){return(0,o.A)((function e(){(0,r.A)(this,e)}),[{key:"init",value:function(e){var t=e.server,n=e.username,r=e.password,o=e.token;return this.server=t,this.username=n,this.password=r,this.token=o,this.token&&this.server&&(this.req=ft.A.create({baseURL:this.server,headers:{Authorization:"Token "+this.token}})),this}},{key:"initForSeahubUsage",value:function(e){var t=e.siteRoot,n=e.xcsrfHeaders;if(t&&"/"===t.charAt(t.length-1)){var r=t.substring(0,t.length-1);this.server=r}else this.server=t;return this.req=ft.A.create({headers:{"X-CSRFToken":n}}),this}},{key:"getRepoFolderTrash2",value:function(e,t,n){var r=this.server+"/api/v2.1/repos/"+e+"/trash2/",o={page:t||1,per_page:n};return this.req.get(r,{params:o})}}])}(),xo=new Ao,bo=We.Ay.load("sfcsrftoken");xo.initForSeahubUsage({siteRoot:f.Yc,xcsrfHeaders:bo});var _o=n(68849),wo=n(62376),So=(n(18291),n(81848),function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).getItems2=function(e){xo.getRepoFolderTrash2(n.props.repoID,e,n.state.perPage).then((function(t){var r=t.data,o=r.items,a=r.total_count;e||(e=1),n.setState({currentPage:e,hasNextPage:a-e*n.state.perPage>0,isLoading:!1,items:o,more:!1})}))},n.onSearchedClick=function(e){if(!0===e.is_dir){var t=f.Yc+"library/"+e.repo_id+"/"+e.repo_name+e.path;(0,c.oo)(t,{repalce:!0})}else{var n=f.Yc+"lib/"+e.repo_id+"/file"+h.Aq.encodePath(e.path);window.open("about:blank").location.href=n}},n.resetPerPage=function(e){n.setState({perPage:e},(function(){n.getItems2(1)}))},n.cleanTrash=function(){n.toggleCleanTrashDialog()},n.toggleCleanTrashDialog=function(){n.setState({isCleanTrashDialogOpen:!n.state.isCleanTrashDialogOpen})},n.refreshTrash2=function(){n.setState({isLoading:!0,errorMsg:"",items:[],scanStat:null,more:!1,showFolder:!1}),n.getItems2()},n.renderFolder=function(e,t,r){n.setState({showFolder:!0,commitID:e,baseDir:t,folderPath:r,folderItems:[],isLoading:!0}),S.e.listCommitDir(n.props.repoID,e,"".concat(t.substr(0,t.length-1)).concat(r)).then((function(e){n.setState({isLoading:!1,folderItems:e.data.dirent_list})})).catch((function(e){e.response?403==e.response.status?n.setState({isLoading:!1,errorMsg:(0,f.AP)("Permission denied")}):n.setState({isLoading:!1,errorMsg:(0,f.AP)("Error")}):n.setState({isLoading:!1,errorMsg:(0,f.AP)("Please check the network.")})}))},n.state={isLoading:!0,errorMsg:"",items:[],scanStat:null,more:!1,isCleanTrashDialogOpen:!1,trashType:0,isOldTrashDialogOpen:!1,currentPage:1,perPage:100,hasNextPage:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.getItems2()}},{key:"render",value:function(){var e=this.props,t=e.showTrashDialog,n=e.toggleTrashDialog,r=this.state,o=r.isCleanTrashDialogOpen,a=r.showFolder,i=r.isLoading,s=r.items,l=this.props.currentRepoInfo.owner_email===f.Xh||this.props.currentRepoInfo.is_admin,c=this.props.currentRepoInfo.repo_name,u=f.Yc+"repo/"+this.props.repoID+"/trash/",d=(0,f.AP)("{placeholder} Trash");return d=d.replace("{placeholder}",'<span class="op-target text-truncate mx-1">'+h.Aq.HTMLescape(c)+"</span>"),(0,m.jsxs)(p.A,{className:"trash-dialog",isOpen:t,toggle:n,children:[(0,m.jsx)(k.A,{close:(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("a",{className:"trash-dialog-old-page",href:u,children:(0,f.AP)("Visit old version page")}),f.Et&&!a&&l&&(0,m.jsx)("button",{className:"btn btn-secondary clean flex-shrink-0 ml-4",onClick:this.cleanTrash,children:(0,f.AP)("Clean")}),(0,m.jsx)("span",{"aria-hidden":"true",className:"trash-dialog-close-icon sf3-font sf3-font-x-01 ml-4",onClick:n})]}),children:(0,m.jsx)("div",{dangerouslySetInnerHTML:{__html:d}})}),(0,m.jsxs)(M.A,{children:[i&&(0,m.jsx)(Z.A,{}),!i&&0===s.length&&(0,m.jsx)($.A,{text:(0,f.AP)("No file"),className:"m-0"}),!i&&s.length>0&&(0,m.jsx)(Do,{data:this.state,repoID:this.props.repoID,getMore:this.getMore,currentPage:this.state.currentPage,curPerPage:this.state.perPage,hasNextPage:this.state.hasNextPage,renderFolder:this.renderFolder,getListByPage:this.getItems2,resetPerPage:this.resetPerPage}),o&&(0,m.jsx)(te.A,{children:(0,m.jsx)(_o.A,{repoID:this.props.repoID,refreshTrash:this.refreshTrash2,toggleDialog:this.toggleCleanTrashDialog})})]})]})}}])}(s.Component)),Do=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).getPreviousPage=function(){n.props.getListByPage(n.props.currentPage-1)},n.getNextPage=function(){n.props.getListByPage(n.props.currentPage+1)},n.theadData=[{width:"5%",text:(0,f.AP)("Name")},{width:"20%",text:""},{width:"40%",text:(0,f.AP)("Original path")},{width:"12%",text:(0,f.AP)("Delete Time")},{width:"13%",text:(0,f.AP)("Size")},{width:"10%",text:""}],n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props.data,n=t.items,r=t.showFolder,o=t.commitID,a=t.baseDir,i=t.folderPath,l=t.folderItems,c=this.props,u=c.curPerPage,d=c.currentPage,p=c.hasNextPage;return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsxs)("table",{className:"table-hover",children:[(0,m.jsx)("thead",{children:(0,m.jsx)("tr",{children:this.theadData.map((function(e,t){return(0,m.jsx)("th",{className:0===t?"pl10":"",width:e.width,children:e.text},t)}))})}),(0,m.jsx)("tbody",{children:r?l.map((function(t,n){return(0,m.jsx)(ko,{item:t,repoID:e.props.repoID,commitID:o,baseDir:a,folderPath:i,renderFolder:e.props.renderFolder},n)})):n.map((function(t,n){return(0,m.jsx)(Eo,{repoID:e.props.repoID,item:t,renderFolder:e.props.renderFolder},n)}))})]}),(0,m.jsx)(wo.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:d,hasNextPage:p,curPerPage:u,resetPerPage:this.props.resetPerPage})]})}}])}(s.Component),Eo=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).handleMouseOver=function(){n.setState({isIconShown:!0})},n.handleMouseOut=function(){n.setState({isIconShown:!1})},n.restoreItem=function(e){e.preventDefault();var t=n.props.item,r=t.commit_id,o=t.parent_dir+t.obj_name;(t.is_dir?S.e.restoreFolder(n.props.repoID,r,o):S.e.restoreFile(n.props.repoID,r,o)).then((function(e){n.setState({restored:!0}),E.A.success((0,f.AP)("Successfully restored 1 item."))})).catch((function(e){var t="";t=e.response?e.response.data.error_msg||(0,f.AP)("Error"):(0,f.AP)("Please check the network."),E.A.danger(t)}))},n.renderFolder=function(e){e.preventDefault();var t=n.props.item;n.props.renderFolder(t.commit_id,t.parent_dir,h.Aq.joinPath("/",t.obj_name))},n.state={restored:!1,isIconShown:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.item,t=this.state,n=t.restored,r=t.isIconShown;return n?null:e.is_dir?(0,m.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[(0,m.jsx)("td",{className:"pl10",children:(0,m.jsx)("img",{src:h.Aq.getFolderIconUrl(),alt:(0,f.AP)("Folder"),width:"24"})}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"#",onClick:this.renderFolder,children:e.obj_name})}),(0,m.jsx)("td",{children:e.parent_dir}),(0,m.jsx)("td",{title:K()(e.deleted_time).format("LLLL"),children:K()(e.deleted_time).format("YYYY-MM-DD")}),(0,m.jsx)("td",{}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"#",className:r||h.Fr?"":"invisible",onClick:this.restoreItem,role:"button",children:(0,f.AP)("Restore")})})]}):(0,m.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[(0,m.jsx)("td",{className:"pl10",children:(0,m.jsx)("img",{src:h.Aq.getFileIconUrl(e.obj_name),alt:(0,f.AP)("File"),width:"24"})}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"".concat(f.Yc,"repo/").concat(this.props.repoID,"/trash/files/?obj_id=").concat(e.obj_id,"&commit_id=").concat(e.commit_id,"&base=").concat(encodeURIComponent(e.parent_dir),"&p=").concat(encodeURIComponent("/"+e.obj_name)),target:"_blank",rel:"noreferrer",children:e.obj_name})}),(0,m.jsx)("td",{children:e.parent_dir}),(0,m.jsx)("td",{title:K()(e.deleted_time).format("LLLL"),children:K()(e.deleted_time).format("YYYY-MM-DD")}),(0,m.jsx)("td",{children:h.Aq.bytesToSize(e.size)}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"#",className:r||h.Fr?"":"invisible",onClick:this.restoreItem,role:"button",children:(0,f.AP)("Restore")})})]})}}])}(s.Component),ko=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).handleMouseOver=function(){n.setState({isIconShown:!0})},n.handleMouseOut=function(){n.setState({isIconShown:!1})},n.renderFolder=function(e){e.preventDefault();var t=n.props.item,r=n.props,o=r.commitID,a=r.baseDir,i=r.folderPath;n.props.renderFolder(o,a,h.Aq.joinPath(i,t.name))},n.state={isIconShown:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.item,t=this.props,n=t.commitID,r=t.baseDir,o=t.folderPath;return"dir"==e.type?(0,m.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,children:[(0,m.jsx)("td",{className:"pl10",children:(0,m.jsx)("img",{src:h.Aq.getFolderIconUrl(),alt:(0,f.AP)("Folder"),width:"24"})}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"#",onClick:this.renderFolder,children:e.name})}),(0,m.jsx)("td",{children:e.parent_dir}),(0,m.jsx)("td",{}),(0,m.jsx)("td",{}),(0,m.jsx)("td",{})]}):(0,m.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,children:[(0,m.jsx)("td",{className:"pl10",children:(0,m.jsx)("img",{src:h.Aq.getFileIconUrl(e.name),alt:(0,f.AP)("File"),width:"24"})}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"".concat(f.Yc,"repo/").concat(this.props.repoID,"/trash/files/?obj_id=").concat(e.obj_id,"&commit_id=").concat(n,"&base=").concat(encodeURIComponent(r),"&p=").concat(encodeURIComponent(h.Aq.joinPath(o,e.name))),target:"_blank",rel:"noreferrer",children:e.name})}),(0,m.jsx)("td",{children:e.parent_dir}),(0,m.jsx)("td",{}),(0,m.jsx)("td",{children:h.Aq.bytesToSize(e.size)}),(0,m.jsx)("td",{})]})}}])}(s.Component),Mo=So,Io=function(e){var t=e.userPerm,n=e.repoID,r=e.currentRepoInfo,o=(0,s.useState)(!1),a=(0,L.A)(o,2),i=a[0],l=a[1],c=null,u=f.Yc+"repo/history/"+n+"/";"rw"===t&&(c=f.Yc+"repo/"+n+"/trash/");var d=function(){l(!i)};return(0,m.jsxs)(yo,{title:(0,f.AP)("Others"),className:"dir-others",children:[c&&(0,m.jsxs)("div",{className:"dir-others-item text-nowrap",title:(0,f.AP)("Trash"),onClick:d,children:[(0,m.jsx)("span",{className:"sf3-font-trash sf3-font"}),(0,m.jsx)("span",{className:"dir-others-item-text",children:(0,f.AP)("Trash")})]}),h.Aq.isDesktop()&&(0,m.jsxs)("div",{className:"dir-others-item text-nowrap",title:(0,f.AP)("History"),onClick:function(){return location.href=u},children:[(0,m.jsx)("span",{className:"sf3-font-history sf3-font"}),(0,m.jsx)("span",{className:"dir-others-item-text",children:(0,f.AP)("History")})]}),i&&(0,m.jsx)(Mo,{repoID:n,currentRepoInfo:r,showTrashDialog:i,toggleTrashDialog:d})]})},No=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).initMenuList=function(){var e=n.getMenuList();n.setState({operationList:e})},n.getMenuList=function(){var e=[];return e.push(dr.A.NEW_FOLDER),e.push(dr.A.NEW_FILE),e.push(dr.A.DISPLAY_FILES),e},n.onNodeClick=function(e){var t;n.setState({opNode:e}),h.Aq.imageCheck((null===e||void 0===e||null===(t=e.object)||void 0===t?void 0:t.name)||"")?n.showNodeImagePopup(e):n.props.onNodeClick(e)},n.onMoreOperationClick=function(e){n.onMenuItemClick(e)},n.onMenuItemClick=function(e,t){switch(n.setState({opNode:t}),e){case"New Folder":t?n.onAddFolderToggle():n.onAddFolderToggle("root");break;case"New File":t?n.onAddFileToggle():n.onAddFileToggle("root");break;case"Rename":n.onRenameToggle();break;case"Delete":n.onDeleteNode(t);break;case"Copy":n.onCopyToggle();break;case"Move":n.onMoveToggle();break;case"Open in New Tab":n.onOpenFile(t);break;case"Display files":n.onDisplayFilesToggle()}},n.onAddFileToggle=function(e){if("root"===e){var t=n.props.treeData.root;n.setState({isAddFileDialogShow:!n.state.isAddFileDialogShow,opNode:t})}else n.setState({isAddFileDialogShow:!n.state.isAddFileDialogShow})},n.onAddFolderToggle=function(e){if("root"===e){var t=n.props.treeData.root;n.setState({isAddFolderDialogShow:!n.state.isAddFolderDialogShow,opNode:t})}else n.setState({isAddFolderDialogShow:!n.state.isAddFolderDialogShow})},n.onRenameToggle=function(){n.setState({isRenameDialogShow:!n.state.isRenameDialogShow})},n.onCopyToggle=function(){n.setState({isCopyDialogShow:!n.state.isCopyDialogShow})},n.onMoveToggle=function(){n.setState({isMoveDialogShow:!n.state.isMoveDialogShow})},n.onAddFolderNode=function(e){n.setState({isAddFolderDialogShow:!n.state.isAddFolderDialogShow}),n.props.onAddFolderNode(e)},n.onRenameNode=function(e){n.setState({isRenameDialogShow:!n.state.isRenameDialogShow});var t=n.state.opNode;n.props.onRenameNode(t,e)},n.onDeleteNode=function(e){n.props.onDeleteNode(e)},n.onOpenFile=function(e){var t=f.Yc+"lib/"+n.props.repoID+"/file"+h.Aq.encodePath(e.path);window.open(t,"_blank")},n.onDisplayFilesToggle=function(){n.setState({isDisplayFiles:!n.state.isDisplayFiles})},n.checkDuplicatedName=function(e){var t=n.state.opNode;return(t.parentNode?t.parentNode:t).children.map((function(e){return e.object})).some((function(t){return t.name===e}))},n.showNodeImagePopup=function(e){var t=e.parentNode.children.filter((function(e){return h.Aq.imageCheck(e.object.name)})).map((function(e){return e.object.name}));n.setState({isNodeImagePopupOpen:!0,imageNodeItems:n.prepareImageItems(e),imageIndex:t.indexOf(e.object.name)})},n.prepareImageItems=function(e){var t=e.parentNode.children.filter((function(e){return h.Aq.imageCheck(e.object.name)})),r=!n.props.currentRepoInfo.encrypted;return t.map((function(o){return function(o){var a=o.object.name,i=h.Aq.encodePath(h.Aq.joinPath(e.parentNode.path,a)),s="gif"===a.substr(a.lastIndexOf(".")+1).toLowerCase(),l=n.props.repoID,c="";return c=r&&!s?"".concat(f.Yc,"thumbnail/").concat(l,"/").concat(f.oC).concat(i):"".concat(f.Yc,"repo/").concat(l,"/raw").concat(i),{name:a,url:"".concat(f.Yc,"lib/").concat(l,"/file").concat(i),src:c,thumbnail:"".concat(f.Yc,"thumbnail/").concat(l,"/").concat(f.oC).concat(i),node:t.find((function(e){return e.path.split("/").pop()===a}))}}(o)}))},n.closeNodeImagePopup=function(){n.setState({isNodeImagePopupOpen:!1})},n.moveToPrevImage=function(){var e=n.state.imageNodeItems.length;n.setState((function(t){return{imageIndex:(t.imageIndex+e-1)%e}}))},n.moveToNextImage=function(){var e=n.state.imageNodeItems.length;n.setState((function(t){return{imageIndex:(t.imageIndex+1)%e}}))},n.deleteImage=function(){n.imageItemsSnapshot=n.state.imageNodeItems,n.imageIndexSnapshot=n.state.imageIndex,n.state.imageNodeItems.length>n.state.imageIndex&&n.props.onDeleteNode(n.state.imageNodeItems[n.state.imageIndex].node);var e=n.state.imageNodeItems.filter((function(e,t){return t!==n.state.imageIndex}));e.length?n.setState((function(t){return{imageNodeItems:e,imageIndex:(t.imageIndex+1)%e.length}})):n.setState({isNodeImagePopupOpen:!1,imageNodeItems:[],imageIndex:0})},n.stopTreeScrollPropagation=function(e){e.stopPropagation()},n.renderContent=function(){var e=n.props,t=e.isTreeDataLoading,r=e.userPerm,o=e.treeData,a=e.currentPath,i=e.onNodeExpanded,s=e.onNodeCollapse,l=e.onItemMove,c=e.onItemsMove,u=e.currentRepoInfo,d=e.selectedDirentList,p=e.repoID,h=e.getMenuContainerSize;return(0,m.jsx)(m.Fragment,{children:t?(0,m.jsx)(Z.A,{}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(yo,{title:(0,f.AP)("Files"),moreKey:{name:"files"},moreOperations:n.state.operationList,moreOperationClick:n.onMoreOperationClick,isDisplayFiles:n.state.isDisplayFiles,children:(0,m.jsx)(lo.A,{userPerm:r,isNodeMenuShow:n.isNodeMenuShow,treeData:o,currentPath:a,onNodeClick:n.onNodeClick,onNodeExpanded:i,onNodeCollapse:s,onMenuItemClick:n.onMenuItemClick,onFreezedItem:n.onFreezedItem,onUnFreezedItem:n.onUnFreezedItem,onItemMove:l,currentRepoInfo:u,selectedDirentList:d,onItemsMove:c,repoID:p,getMenuContainerSize:h,isDisplayFiles:n.state.isDisplayFiles})}),(0,m.jsx)(Co,{repoID:p,currentPath:a,userPerm:r,currentRepoInfo:u}),(0,m.jsx)(Io,{repoID:p,userPerm:r,currentRepoInfo:u})]})})},n.state={opNode:null,isAddFileDialogShow:!1,isAddFolderDialogShow:!1,isRenameDialogShow:!1,isNodeImagePopupOpen:!1,imageNodeItems:[],imageIndex:0,isCopyDialogShow:!1,isMoveDialogShow:!1,isMultipleOperation:!1,operationList:[],isDisplayFiles:!1},n.isNodeMenuShow=!0,n.imageItemsSnapshot=[],n.imageIndexSnapshot=0,n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.initMenuList()}},{key:"componentDidUpdate",value:function(e){e.direntList.length<this.props.direntList.length&&this.state.isNodeImagePopupOpen&&(0===this.state.imageNodeItems.length?this.setState({isNodeImagePopupOpen:!1}):this.setState({imageNodeItems:this.imageItemsSnapshot,imageIndex:this.imageIndexSnapshot}))}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.setState({opNode:e.currentNode})}},{key:"render",value:function(){var e=this.props.navRate?"0 0 "+100*this.props.navRate+"%":"0 0 25%",t=this.props.inResizing?"none":"";return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("div",{className:"dir-content-nav",role:"navigation",style:{flex:e,userSelect:t},onScroll:this.stopTreeScrollPropagation,children:this.renderContent()}),this.state.isAddFolderDialogShow&&(0,m.jsx)(te.A,{children:(0,m.jsx)(Zn.A,{parentPath:this.state.opNode.path,onAddFolder:this.onAddFolderNode,checkDuplicatedName:this.checkDuplicatedName,addFolderCancel:this.onAddFolderToggle})}),this.state.isAddFileDialogShow&&(0,m.jsx)(te.A,{children:(0,m.jsx)(Xn.A,{parentPath:this.state.opNode.path,onAddFile:this.props.onAddFileNode,checkDuplicatedName:this.checkDuplicatedName,toggleDialog:this.onAddFileToggle})}),this.state.isRenameDialogShow&&(0,m.jsx)(te.A,{children:(0,m.jsx)(co,{currentNode:this.state.opNode,onRename:this.onRenameNode,checkDuplicatedName:this.checkDuplicatedName,toggleCancel:this.onRenameToggle})}),this.state.isCopyDialogShow&&(0,m.jsx)(te.A,{children:(0,m.jsx)(fo,{path:this.state.opNode.parentNode.path,repoID:this.props.repoID,dirent:this.state.opNode.object,onItemCopy:this.props.onItemCopy,repoEncrypted:this.props.currentRepoInfo.encrypted,onCancelCopy:this.onCopyToggle,isMultipleOperation:this.state.isMultipleOperation})}),this.state.isMoveDialogShow&&(0,m.jsx)(te.A,{children:(0,m.jsx)(ho,{path:this.state.opNode.parentNode.path,repoID:this.props.repoID,dirent:this.state.opNode.object,onItemMove:this.props.onItemMove,repoEncrypted:this.props.currentRepoInfo.encrypted,onCancelMove:this.onMoveToggle,isMultipleOperation:this.state.isMultipleOperation})}),this.state.isNodeImagePopupOpen&&(0,m.jsx)(te.A,{children:(0,m.jsx)(mo.A,{imageItems:this.state.imageNodeItems,imageIndex:this.state.imageIndex,closeImagePopup:this.closeNodeImagePopup,moveToPrevImage:this.moveToPrevImage,moveToNextImage:this.moveToNextImage,onDeleteImage:this.deleteImage})})]})}}])}(s.Component);No.defaultProps={navRate:.25};var Po=No,To=n(84295),Oo=function(e){function t(){return(0,r.A)(this,t),(0,a.A)(this,t,arguments)}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return(0,m.jsxs)(p.A,{isOpen:!0,className:"seafile-markdown-viewer-modal",toggle:this.props.onCloseMarkdownViewDialog,contentClassName:"seafile-markdown-viewer-modal-content",zIndex:1046,children:[(0,m.jsxs)("div",{className:"seafile-markdown-viewer-modal-header",children:[(0,m.jsxs)("div",{className:"seafile-markdown-viewer-modal-header-left-name",children:[(0,m.jsx)("span",{children:(0,m.jsx)("img",{src:"".concat(f.SG,"img/file/256/md.png"),width:"24",alt:""})}),(0,m.jsx)("span",{children:this.props.fileName})]}),(0,m.jsxs)("div",{className:"seafile-markdown-viewer-modal-header-right-tool",children:[(0,m.jsx)("span",{className:"sf3-font sf3-font-open",onClick:this.props.openMarkdownFile}),(0,m.jsx)("span",{className:"sf3-font sf3-font-x-01",onClick:this.props.onCloseMarkdownViewDialog})]})]}),(0,m.jsx)(M.A,{className:"seafile-markdown-viewer-modal-body",children:(0,m.jsx)(To.A,{isTOCShow:!1,isFileLoading:this.props.isFileLoading,markdownContent:this.props.content,lastModified:this.props.lastModified,latestContributor:this.props.latestContributor,onLinkClick:this.props.onLinkClick,repoID:this.props.repoID,path:this.props.filePath})})]})}}])}(s.Component),jo=Oo,Ro=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onCreateNewFile=function(e){n.setState({fileType:e,isCreateFileDialogShow:!n.state.isCreateFileDialogShow})},n.onCreateFileToggle=function(){n.setState({fileType:"",isCreateFileDialogShow:!n.state.isCreateFileDialogShow})},n.checkDuplicatedName=function(){return!1},n.state={fileType:"",isCreateFileDialogShow:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){if(this.props.isDirentListLoading)return(0,m.jsx)(Z.A,{});var e=this.props.currentRepoInfo;return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsxs)("div",{className:"tip-for-new-file",children:[(0,m.jsx)("p",{className:"text-secondary text-center",children:(0,f.AP)("This folder has no content at this time.")}),(0,m.jsxs)("p",{className:"text-secondary text-center",children:[(0,f.AP)("You can create files quickly")," +"]}),(0,m.jsx)("button",{className:"big-new-file-button",onClick:this.onCreateNewFile.bind(this,".md"),children:"+ Markdown"}),(0,m.jsx)("button",{className:"big-new-file-button",onClick:this.onCreateNewFile.bind(this,".pptx"),children:"+ PPT"}),(0,m.jsx)("br",{}),(0,m.jsx)("button",{className:"big-new-file-button",onClick:this.onCreateNewFile.bind(this,".docx"),children:"+ Word"}),(0,m.jsx)("button",{className:"big-new-file-button",onClick:this.onCreateNewFile.bind(this,".xlsx"),children:"+ Excel"}),(0,m.jsx)("br",{}),f.lU&&!e.encrypted&&(0,m.jsx)("button",{className:"big-new-file-button",onClick:this.onCreateNewFile.bind(this,".sdoc"),children:"+ SeaDoc"})]}),this.state.isCreateFileDialogShow&&(0,m.jsx)(te.A,{children:(0,m.jsx)(Xn.A,{parentPath:this.props.path,fileType:this.state.fileType,onAddFile:this.props.onAddFile,toggleDialog:this.onCreateFileToggle,checkDuplicatedName:this.checkDuplicatedName})})]})}}])}(s.Component),Lo=n(39143),Fo=n(57354),Uo=n(16670),Yo=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).inputNewName=function(e){n.setState({tagName:e.target.value}),n.state.errorMsg&&n.setState({errorMsg:""})},n.selectTagcolor=function(e){n.setState({tagColor:e.target.value})},n.createTag=function(){var e=n.state.tagName,t=n.state.tagColor,r=n.props.repoID;S.e.createRepoTag(r,e,t).then((function(e){var t=e.data.repo_tag.repo_tag_id;n.props.onRepoTagCreated&&n.props.onRepoTagCreated(t),n.props.toggleCancel()})).catch((function(t){var r;500===t.response.status?r=(0,f.AP)("Internal Server Error"):400===t.response.status&&(r=(r=(0,f.AP)('Tag "{name}" already exists.')).replace("{name}",h.Aq.HTMLescape(e))),n.setState({errorMsg:r})}))},n.handleKeyDown=function(e){"Enter"===e.key&&n.createTag()},n.state={tagName:"",tagColor:j.cj[0],newTag:{},errorMsg:""},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=!!this.state.tagName.trim();return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsxs)(k.A,{toggle:this.props.onClose,children:[(0,m.jsx)("span",{className:"tag-dialog-back sf3-font sf3-font-arrow rotate-180 d-inline-block",onClick:this.props.toggleCancel,"aria-label":(0,f.AP)("Back")}),(0,f.AP)("New Tag")]}),(0,m.jsx)(M.A,{children:(0,m.jsxs)("div",{role:"form",className:"tag-create",children:[(0,m.jsxs)("div",{className:"form-group",children:[(0,m.jsx)("label",{className:"form-label",children:(0,f.AP)("Name")}),(0,m.jsx)(I.A,{onKeyDown:this.handleKeyDown,autoFocus:!0,value:this.state.tagName,onChange:this.inputNewName}),(0,m.jsx)("div",{className:"mt-2",children:(0,m.jsx)("span",{className:"error",children:this.state.errorMsg})})]}),(0,m.jsxs)("div",{className:"form-group",children:[(0,m.jsx)("label",{className:"form-label",children:(0,f.AP)("Select a color")}),(0,m.jsx)("div",{className:"d-flex justify-content-between",children:j.cj.map((function(t,n){return(0,m.jsx)("div",{className:"tag-color-option",onChange:e.selectTagcolor,children:(0,m.jsxs)("label",{className:"colorinput",children:[0===n?(0,m.jsx)("input",{name:"color",type:"radio",value:t,className:"colorinput-input",defaultChecked:!0,onClick:e.selectTagcolor}):(0,m.jsx)("input",{name:"color",type:"radio",value:t,className:"colorinput-input",onClick:e.selectTagcolor}),(0,m.jsx)("span",{className:"colorinput-color rounded-circle d-flex align-items-center justify-content-center",style:{backgroundColor:t},children:(0,m.jsx)("i",{className:"sf2-icon-tick color-selected"})})]})},n)}))})]})]})}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(P.A,{color:"secondary",onClick:this.props.toggleCancel,children:(0,f.AP)("Cancel")}),t?(0,m.jsx)(P.A,{color:"primary",onClick:this.createTag,children:(0,f.AP)("Save")}):(0,m.jsx)(P.A,{color:"primary",disabled:!0,children:(0,f.AP)("Save")})]})]})}}])}(s.Component);n(79627);var Bo=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onMouseEnter=function(){n.setState({isTagHighlighted:!0})},n.onMouseLeave=function(){n.setState({isTagHighlighted:!1})},n.getRepoTagIdList=function(){return(n.props.fileTagList||[]).map((function(e){return e.repo_tag_id}))},n.onEditFileTag=function(){var e=n.props,t=e.repoID,r=e.repoTag,o=e.filePath,a=n.getRepoTagIdList();if(-1===a.indexOf(r.id)){var i=r.id;S.e.addFileTag(t,o,i).then((function(){a=n.getRepoTagIdList(),n.props.onFileTagChanged()})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))}else{for(var s=null,l=n.props.fileTagList,c=0;c<l.length;c++)if(l[c].repo_tag_id===r.id){s=l[c];break}S.e.deleteFileTag(t,s.id).then((function(){a=n.getRepoTagIdList(),n.props.onFileTagChanged()})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))}},n.state={isTagHighlighted:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.state.isTagHighlighted,t=this.props.repoTag,n=-1!=this.getRepoTagIdList().indexOf(t.id);return(0,m.jsxs)("li",{className:"tag-list-item cursor-pointer px-4 d-flex justify-content-between align-items-center ".concat(e?"hl":""),onClick:this.onEditFileTag,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[(0,m.jsxs)("div",{className:"d-flex align-items-center",children:[(0,m.jsx)("span",{className:"tag-color w-4 h-4 rounded-circle",style:{backgroundColor:t.color}}),(0,m.jsx)("span",{className:"tag-name mx-2",children:t.name})]}),n&&(0,m.jsx)("i",{className:"sf2-icon-tick tag-selected-icon"})]})}}])}(s.Component),Ho=function(e){function t(){return(0,r.A)(this,t),(0,a.A)(this,t,arguments)}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props.repoTags;return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)(k.A,{toggle:this.props.toggleCancel,children:(0,f.AP)("Select Tags")}),(0,m.jsxs)(M.A,{className:"px-0",children:[(0,m.jsx)("ul",{className:"tag-list tag-list-container",children:t.map((function(t){return(0,m.jsx)(Bo,{repoTag:t,repoID:e.props.repoID,filePath:e.props.filePath,fileTagList:e.props.fileTagList,onFileTagChanged:e.props.onFileTagChanged},t.id)}))}),(0,m.jsxs)("a",{href:"#",className:"add-tag-link px-4 py-2 d-flex align-items-center",onClick:this.props.createNewTag,children:[(0,m.jsx)("span",{className:"sf2-icon-plus mr-2"}),(0,f.AP)("Create a new tag")]})]}),(0,m.jsx)(N.A,{children:(0,m.jsx)(P.A,{onClick:this.props.toggleCancel,children:(0,f.AP)("Close")})})]})}}])}(s.Component),Vo=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).createNewTag=function(){n.setState({isCreateRepoTagShow:!n.state.isCreateRepoTagShow,isListRepoTagShow:!n.state.isListRepoTagShow})},n.onRepoTagCreated=function(e){var t=n.props,r=t.repoID,o=t.filePath;S.e.addFileTag(r,o,e).then((function(){n.props.onFileTagChanged()})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.state={isCreateRepoTagShow:!1,isListRepoTagShow:!0},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.props.toggleCancel,autoFocus:!1,children:[this.state.isListRepoTagShow&&(0,m.jsx)(Ho,{repoID:this.props.repoID,repoTags:this.props.repoTags,filePath:this.props.filePath,fileTagList:this.props.fileTagList,onFileTagChanged:this.props.onFileTagChanged,toggleCancel:this.props.toggleCancel,createNewTag:this.createNewTag}),this.state.isCreateRepoTagShow&&(0,m.jsx)(Yo,{repoID:this.props.repoID,onClose:this.props.toggleCancel,toggleCancel:this.createNewTag,onRepoTagCreated:this.onRepoTagCreated})]})}}])}(s.Component),Go=function(){return(0,o.A)((function e(){(0,r.A)(this,e)}),[{key:"init",value:function(e){var t=e.server,n=e.username,r=e.password,o=e.token;return this.server=t,this.username=n,this.password=r,this.token=o,this.token&&this.server&&(this.req=ft.A.create({baseURL:this.server,headers:{Authorization:"Token "+this.token}})),this}},{key:"initForSeahubUsage",value:function(e){var t=e.siteRoot,n=e.xcsrfHeaders;if(t&&"/"===t.charAt(t.length-1)){var r=t.substring(0,t.length-1);this.server=r}else this.server=t;return this.req=ft.A.create({headers:{"X-CSRFToken":n}}),this}},{key:"listFileAccessLog",value:function(e,t,n,r,o){var a=this.server+"/api/v2.1/repos/"+e+"/file/access-log/",i={path:t,page:n||1,per_page:r||100,avatar_size:o||64};return this.req.get(a,{params:i})}}])}(),qo=new Go,zo=We.Ay.load("sfcsrftoken");qo.initForSeahubUsage({siteRoot:f.Yc,xcsrfHeaders:zo}),K().locale(window.app.config.lang);var Wo=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).listFileAccessLog=function(e){var t=n.props,r=t.repoID,o=t.filePath,a=n.state,i=a.perPage,s=a.items;qo.listFileAccessLog(r,o,e,i,48).then((function(t){var r=t.data.data;n.setState({isLoading:!1,isLoadingMore:!1,page:e,hasNextPage:!(r.length<i),items:s.concat(r)})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t),n.setState({isLoading:!1,isLoadingMore:!1,hasNextPage:!1})}))},n.handleScroll=function(e){var t=n.state,r=t.page,o=t.hasNextPage,a=t.isLoadingMore;if(o&&!a){var i=e.target.clientHeight,s=e.target.scrollHeight;i+e.target.scrollTop+1>=s&&n.setState({isLoadingMore:!0},(function(){n.listFileAccessLog(r+1)}))}},n.state={isLoading:!0,isLoadingMore:!1,items:[],page:1,perPage:100,hasNextPage:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.listFileAccessLog(this.state.page)}},{key:"render",value:function(){var e=this.state,t=e.isLoading,n=e.hasNextPage,r=e.items,o=this.props.fileName,a=(0,f.AP)("{placeholder} Access Log");return a=a.replace("{placeholder}",'<span class="op-target text-truncate mx-1">'+h.Aq.HTMLescape(o)+"</span>"),(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.props.toggleDialog,className:"file-access-log-container",children:[(0,m.jsx)(k.A,{toggle:this.props.toggleDialog,children:(0,m.jsx)("span",{dangerouslySetInnerHTML:{__html:a},className:"d-flex mw-100"})}),(0,m.jsx)(M.A,{className:"file-access-log-content-container",onScroll:this.handleScroll,children:t?(0,m.jsx)(Z.A,{}):(0,m.jsx)(m.Fragment,{children:r.length>0?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("table",{className:"table-hover",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"25%",className:"pl10",children:(0,f.AP)("User")}),(0,m.jsx)("th",{width:"15%",children:(0,f.AP)("Type")}),(0,m.jsxs)("th",{width:"40%",children:[(0,f.AP)("IP")," / ",(0,f.AP)("Device Name")]}),(0,m.jsx)("th",{width:"20%",children:(0,f.AP)("Date")})]})}),(0,m.jsx)("tbody",{children:r.map((function(e,t){return(0,m.jsxs)("tr",{children:[(0,m.jsxs)("td",{className:"pl10",children:[(0,m.jsx)("img",{src:e.avatar_url,alt:"",width:"24",className:"rounded-circle mr-2"}),e.email?(0,m.jsx)("a",{href:"".concat(f.Yc,"profile/").concat(encodeURIComponent(e.email),"/"),target:"_blank",rel:"noreferrer",className:"align-middle",children:e.name}):(0,m.jsx)("span",{children:(0,f.AP)("Anonymous User")})]}),(0,m.jsx)("td",{children:e.etype}),(0,m.jsx)("td",{className:"pr-4",children:"".concat(e.ip).concat(e.device?"/"+e.device:"")}),(0,m.jsx)("td",{children:K()(e.time).format("YYYY-MM-DD HH:mm:ss")})]},t)}))})]}),n&&(0,m.jsx)(Z.A,{})]}):(0,m.jsx)($.A,{text:(0,f.AP)("This file has (apparently) not been accessed yet")})})})]})}}])}(s.Component),Ko=function(e){function t(){return(0,r.A)(this,t),(0,a.A)(this,t,arguments)}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fileTag,n=e.length,r=e.index,o="file-tag-".concat(t.id,"-").concat(Cr());return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("span",{className:"file-tag",id:o,style:{zIndex:n-r,backgroundColor:t.color}},t.id),(0,m.jsx)(Je.A,{target:o,placement:"bottom",children:t.name})]})}}])}(s.PureComponent),Zo=function(e){function t(e){var n;(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleOpMenu=function(){n.setState({isOpMenuOpen:!n.state.isOpMenuOpen})},n.onMouseEnter=function(){n.props.isItemFreezed||n.setState({highlight:!0,isOperationShow:!0}),n.state.canDrag&&n.setState({isDragTipShow:!0})},n.onMouseOver=function(){n.props.isItemFreezed||n.setState({highlight:!0,isOperationShow:!0}),n.state.canDrag&&n.setState({isDragTipShow:!0})},n.onMouseLeave=function(){n.props.isItemFreezed||n.setState({highlight:!1,isOperationShow:!1}),n.setState({isDragTipShow:!1})},n.unfreezeItem=function(){n.setState({highlight:!1,isOperationShow:!1}),n.props.unfreezeItem()},n.onItemSelected=function(){n.props.onItemSelected(n.props.dirent)},n.onItemStarred=function(e){var t=n.props.dirent,r=n.props.repoID,o=n.getDirentPath(t);t.starred?S.e.unstarItem(r,o).then((function(){n.props.updateDirent(n.props.dirent,"starred",!1)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)})):S.e.starItem(r,o).then((function(){n.props.updateDirent(n.props.dirent,"starred",!0)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.onDirentClick=function(e){e.stopPropagation(),"TD"==e.target.tagName&&n.props.onDirentClick(n.props.dirent,e)},n.onItemClick=function(e){e.preventDefault();var t=n.props.dirent;n.state.isRenameing||(t.isDir()?n.props.onItemClick(t):n.canPreview&&(h.Aq.imageCheck(t.name)?n.props.showImagePopup(t):n.props.onItemClick(t)))},n.onItemDelete=function(e){e.preventDefault(),e.nativeEvent.stopImmediatePropagation(),n.props.onItemDelete(n.props.dirent)},n.onItemShare=function(e){e.preventDefault(),e.nativeEvent.stopImmediatePropagation(),n.setState({isShareDialogShow:!n.state.isShareDialogShow})},n.exportDocx=function(){var e=window.app.config.serviceURL+"/repo/sdoc_export_to_docx/"+n.props.repoID+"/?file_path="+n.getDirentPath(n.props.dirent);window.location.href=e},n.exportSdoc=function(){var e=window.app.config.serviceURL+"/lib/"+n.props.repoID+"/file/"+n.getDirentPath(n.props.dirent)+"?dl=1";window.location.href=e},n.closeSharedDialog=function(){n.setState({isShareDialogShow:!n.state.isShareDialogShow})},n.onMobileMenuItemClick=function(e){var t=e.target.getAttribute("data-op");n.onMenuItemClick(t,e)},n.onMenuItemClick=function(e,t){switch(e){case"Download":n.onItemDownload(t);break;case"Share":n.onItemShare(t);break;case"Delete":n.onItemDelete(t);break;case"Rename":n.onItemRenameToggle();break;case"Move":n.onItemMoveToggle();break;case"Copy":n.onItemCopyToggle();break;case"Tags":n.onEditFileTagToggle();break;case"Permission":n.onPermissionItem();break;case"Unlock":case"Unfreeze Document":n.onUnlockItem();break;case"Lock":n.onLockItem();break;case"Freeze Document":n.onFreezeDocument();break;case"Convert to Markdown":n.onItemConvert(t,"markdown");break;case"Convert to docx":n.onItemConvert(t,"docx");break;case"Export docx":n.exportDocx();break;case"Export sdoc":n.exportSdoc();break;case"Convert to sdoc":n.onItemConvert(t,"sdoc");break;case"History":n.onHistory();break;case"Access Log":n.toggleFileAccessLogDialog();break;case"Properties":n.props.onDirentClick(n.props.dirent),n.props.showDirentDetail("info");break;case"Open via Client":n.onOpenViaClient();break;case"Convert with ONLYOFFICE":n.onConvertWithONLYOFFICE()}},n.onItemConvert=function(e,t){e.preventDefault(),e.nativeEvent.stopImmediatePropagation(),n.props.onItemConvert(n.props.dirent,t)},n.onEditFileTagToggle=function(){n.setState({isEditFileTagShow:!n.state.isEditFileTagShow})},n.onFileTagChanged=function(){var e=n.getDirentPath(n.props.dirent);n.props.onFileTagChanged(n.props.dirent,e)},n.onItemRenameToggle=function(){n.props.onItemRenameToggle(n.props.dirent),n.setState({isOperationShow:!1,isRenameing:!0,canDrag:!1})},n.onRenameConfirm=function(e){n.props.onItemRename(n.props.dirent,e),n.onRenameCancel()},n.onRenameCancel=function(){n.setState({isRenameing:!1,canDrag:n.canDrag}),n.unfreezeItem()},n.onItemMoveToggle=function(){n.setState({isMoveDialogShow:!n.state.isMoveDialogShow})},n.onItemCopyToggle=function(){n.setState({isCopyDialogShow:!n.state.isCopyDialogShow})},n.onPermissionItem=function(){n.setState({isPermissionDialogOpen:!n.state.isPermissionDialogOpen})},n.onLockItem=function(){var e=n.props.repoID,t=n.getDirentPath(n.props.dirent);S.e.lockfile(e,t).then((function(){n.props.updateDirent(n.props.dirent,"is_locked",!0),n.props.updateDirent(n.props.dirent,"locked_by_me",!0);var e=f.Xh.split("@");n.props.updateDirent(n.props.dirent,"lock_owner_name",e[0])})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.onFreezeDocument=function(){var e=n.props.repoID,t=n.getDirentPath(n.props.dirent);S.e.lockfile(e,t,-1).then((function(){n.props.updateDirent(n.props.dirent,"is_freezed",!0),n.props.updateDirent(n.props.dirent,"is_locked",!0),n.props.updateDirent(n.props.dirent,"locked_by_me",!0);var e=f.Xh.split("@");n.props.updateDirent(n.props.dirent,"lock_owner_name",e[0])})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.onUnlockItem=function(){var e=n.props.repoID,t=n.getDirentPath(n.props.dirent);S.e.unlockfile(e,t).then((function(){n.props.updateDirent(n.props.dirent,"is_locked",!1),n.props.updateDirent(n.props.dirent,"locked_by_me",!1),n.props.updateDirent(n.props.dirent,"lock_owner_name","")})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.onHistory=function(){var e=n.props.repoID,t=n.getDirentPath(n.props.dirent),r=Fo.A.getUrl({type:"file_revisions",repoID:e,filePath:t});location.href=r},n.toggleFileAccessLogDialog=function(){n.setState({isFileAccessLogDialogOpen:!n.state.isFileAccessLogDialogOpen})},n.onOpenViaClient=function(){var e=n.props.repoID,t=n.getDirentPath(n.props.dirent),r=Fo.A.getUrl({type:"open_via_client",repoID:e,filePath:t});location.href=r},n.onConvertWithONLYOFFICE=function(){var e=n.props.repoID,t=n.getDirentPath(n.props.dirent);S.e.onlyofficeConvert(e,t).then((function(e){n.props.loadDirentList(e.data.parent_dir)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.onItemDownload=function(e){e.preventDefault(),e.nativeEvent.stopImmediatePropagation();var t=n.props.dirent,r=n.props.repoID,o=n.getDirentPath(t);if("dir"===t.type)f.B$?S.e.zipDownload(r,n.props.path,n.props.dirent.name).then((function(e){var t=e.data.zip_token;location.href="".concat(f.IX,"zip/").concat(t)})).catch((function(e){var t=h.Aq.getErrorMsg(e);n.setState({isLoading:!1,errorMsg:t})})):n.setState({isZipDialogOpen:!0});else{var a=Fo.A.getUrl({type:"download_file_url",repoID:r,filePath:o});location.href=a}},n.closeZipDialog=function(){n.setState({isZipDialogOpen:!1})},n.getDirentPath=function(e){var t=n.props.path;return"/"===t?t+e.name:t+"/"+e.name},n.onTagTooltipToggle=function(e){e.stopPropagation(),n.setState({isShowTagTooltip:!n.state.isShowTagTooltip})},n.onItemMove=function(e,t,r,o){n.props.onItemMove(e,t,r,o)},n.onItemDragStart=function(e){if(h.Aq.isIEBrowser()||!n.state.canDrag)return!1;e.dataTransfer.effectAllowed="move";var t=n.props.selectedDirentList;if(t.length>0&&t.includes(n.props.dirent)){n.props.onShowDirentsDraggablePreview(),e.dataTransfer.setDragImage(n.refs.empty_content,0,0);var r=t.map((function(e){var t=n.getDirentPath(e);return{nodeDirent:e,nodeParentPath:n.props.path,nodeRootPath:t}}));return r=JSON.stringify(r),void e.dataTransfer.setData("application/drag-item-info",r)}e.dataTransfer&&e.dataTransfer.setDragImage&&e.dataTransfer.setDragImage(n.refs.drag_icon,15,15);var o=n.getDirentPath(n.props.dirent),a={nodeDirent:n.props.dirent,nodeParentPath:n.props.path,nodeRootPath:o};a=JSON.stringify(a),e.dataTransfer.setData("application/drag-item-info",a)},n.onItemDragEnter=function(e){if(h.Aq.isIEBrowser()||!n.state.canDrag)return!1;"dir"===n.props.dirent.type&&(e.stopPropagation(),n.setState({isDropTipshow:!0}))},n.onItemDragOver=function(e){if(h.Aq.isIEBrowser()||!n.state.canDrag)return!1;"copy"!==e.dataTransfer.dropEffect&&(e.preventDefault(),e.dataTransfer.dropEffect="move")},n.onItemDragLeave=function(e){if(h.Aq.isIEBrowser()||!n.state.canDrag)return!1;"dir"===n.props.dirent.type&&e.stopPropagation(),n.setState({isDropTipshow:!1})},n.onItemDragDrop=function(e){if(h.Aq.isIEBrowser()||!n.state.canDrag)return!1;if(n.setState({isDropTipshow:!1}),!e.dataTransfer.files.length&&"dir"===n.props.dirent.type){e.stopPropagation();var t=e.dataTransfer.getData("application/drag-item-info");if(t=JSON.parse(t),Array.isArray(t)){var r=t.map((function(e){return e.nodeRootPath})),o=h.Aq.joinPath(n.props.path,n.props.dirent.name);if(r.some((function(e){return e===o})))return;n.props.onItemsMove(n.props.currentRepoInfo,o)}else{var a=t,i=a.nodeDirent,s=a.nodeParentPath,l=a.nodeRootPath,c=n.props.dirent;if(i.name!==c.name&&("dir"!==c.type||"dir"!==i.type||s===n.props.path||-1===n.props.path.indexOf(l))){var u=h.Aq.joinPath(n.props.path,n.props.dirent.name);n.onItemMove(n.props.currentRepoInfo,i,u,s)}}}},n.onItemMouseDown=function(e){n.props.onItemMouseDown(e)},n.onItemContextMenu=function(e){var t=n.props.dirent;n.props.onItemContextMenu(e,t)},n.renderItemOperation=function(){var e=n.props,t=e.dirent,r=e.currentRepoInfo,o=e.selectedDirentList,a=!0,i=!0,l=n,c=l.isCustomPermission,u=l.customPermission;if(c){var d=u.permission;a=d.download,i=d.delete}var p=h.Aq.isHasPermissionToShare(r,t.permission,t);return(0,m.jsx)(s.Fragment,{children:o.length>1?(0,m.jsx)(s.Fragment,{children:n.state.isOperationShow&&!t.isSelected&&(0,m.jsxs)("div",{className:"operations",children:[("rw"===t.permission||"r"===t.permission||c&&a)&&(0,m.jsx)("a",{href:"#",className:"op-icon sf3-font sf3-font-download1",title:(0,f.AP)("Download"),role:"button","aria-label":(0,f.AP)("Download"),onClick:n.onItemDownload}),p&&(0,m.jsx)("a",{href:"#",className:"op-icon sf3-font-share sf3-font",title:(0,f.AP)("Share"),role:"button","aria-label":(0,f.AP)("Share"),onClick:n.onItemShare}),("rw"===t.permission||"cloud-edit"===t.permission||c&&i)&&(0,m.jsx)("a",{href:"#",className:"op-icon sf3-font-delete1 sf3-font",title:(0,f.AP)("Delete"),role:"button","aria-label":(0,f.AP)("Delete"),onClick:n.onItemDelete}),(0,m.jsx)(vo.A,{item:n.props.dirent,isHandleContextMenuEvent:!0,getMenuList:n.props.getDirentItemMenuList,onMenuItemClick:n.onMenuItemClick,unfreezeItem:n.unfreezeItem,freezeItem:n.props.freezeItem})]})}):(0,m.jsx)(s.Fragment,{children:n.state.isOperationShow&&(0,m.jsxs)("div",{className:"operations",children:[("rw"===t.permission||"r"===t.permission||c&&a)&&(0,m.jsx)("a",{href:"#",className:"op-icon sf3-font sf3-font-download1",title:(0,f.AP)("Download"),role:"button","aria-label":(0,f.AP)("Download"),onClick:n.onItemDownload}),p&&(0,m.jsx)("a",{href:"#",className:"op-icon sf3-font-share sf3-font",title:(0,f.AP)("Share"),role:"button","aria-label":(0,f.AP)("Share"),onClick:n.onItemShare}),("rw"===t.permission||"cloud-edit"===t.permission||c&&i)&&(0,m.jsx)("a",{href:"#",className:"op-icon sf3-font-delete1 sf3-font",title:(0,f.AP)("Delete"),role:"button","aria-label":(0,f.AP)("Delete"),onClick:n.onItemDelete}),(0,m.jsx)(vo.A,{item:n.props.dirent,isHandleContextMenuEvent:!0,getMenuList:n.props.getDirentItemMenuList,onMenuItemClick:n.onMenuItemClick,unfreezeItem:n.unfreezeItem,freezeItem:n.props.freezeItem})]})})})};var o=n.props.dirent,i=h.Aq.getUserPermission(o.permission),l=i.isCustomPermission,c=i.customPermission;if(n.isCustomPermission=l,n.customPermission=c,n.canPreview=!0,n.canDrag="rw"===o.permission,l){var u=c.permission,d=u.preview,p=u.modify;n.canPreview=d||p,n.canDrag=p}return n.state={isOperationShow:!1,highlight:!1,isZipDialogOpen:!1,isFileAccessLogDialogOpen:!1,isMoveDialogShow:!1,isCopyDialogShow:!1,isShareDialogShow:!1,isMultipleOperation:!1,canDrag:n.canDrag,isShowTagTooltip:!1,isDragTipShow:!1,isDropTipshow:!1,isEditFileTagShow:!1,isPermissionDialogOpen:!1,isOpMenuOpen:!1},n.tagListTitleID="tag-list-title-".concat(Cr()),n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.isItemFreezed,r=t.activeDirent,o=t.dirent;e.isItemFreezed===n||n||this.setState({highlight:!1,isOperationShow:r&&r.name===o.name})}},{key:"render",value:function(){var e=this,t=this.props,n=t.path,r=t.dirent,o=t.repoID,a=h.Aq.joinPath(n,r.name),i="";this.props.currentRepoInfo&&(i=f.Yc+"library/"+o+"/"+this.props.currentRepoInfo.repo_name+h.Aq.encodePath(a));var l=f.Yc+"lib/"+o+"/file"+h.Aq.encodePath(a);r.is_sdoc_revision&&r.revision_id&&(l=f.Yc+"lib/"+o+"/revisions/"+r.revision_id+"/");var c=h.Aq.getDirentIcon(r),u=r.isSelected,p=this.state.highlight?"tr-highlight ":"";p+=this.state.isDropTipshow?"tr-drop-effect":"",p+=u?"tr-active":"";var g=r.is_freezed?(0,f.AP)("Frozen by {name}"):(0,f.AP)("locked by {name}");g=g.replace("{name}",r.lock_owner_name);var v=h.Aq.isDesktop(),y=this.state.canDrag,C="".concat(f.SG,"img/file-").concat(r.is_freezed?"freezed-32.svg":"locked-32.png"),A=r.is_freezed?(0,f.AP)("freezed"):(0,f.AP)("locked");return(0,m.jsxs)(s.Fragment,{children:[v?(0,m.jsxs)("tr",{className:p,draggable:y,onFocus:this.onMouseEnter,onMouseEnter:this.onMouseEnter,onMouseOver:this.onMouseOver,onMouseLeave:this.onMouseLeave,onClick:this.onDirentClick,onDragStart:this.onItemDragStart,onDragEnter:this.onItemDragEnter,onDragOver:this.onItemDragOver,onDragLeave:this.onItemDragLeave,onDrop:this.onItemDragDrop,onMouseDown:this.onItemMouseDown,onContextMenu:this.onItemContextMenu,children:[(0,m.jsx)("td",{className:"pl10 ".concat(this.state.isDragTipShow?"tr-drag-effect":""),children:(0,m.jsx)("input",{type:"checkbox",className:"vam",onChange:this.onItemSelected,checked:u,"aria-label":u?(0,f.AP)("Unselect this item"):(0,f.AP)("Select this item")})}),(0,m.jsx)("td",{className:"pl10",children:void 0!==r.starred&&(0,m.jsx)("i",{role:"button","aria-label":r.starred?(0,f.AP)("Unstar"):(0,f.AP)("Star"),onClick:this.onItemStarred,className:"sf3-font ".concat(r.starred?"sf3-font-star":"sf3-font-star-empty")})}),(0,m.jsx)("td",{className:"pl10",children:(0,m.jsxs)("div",{className:"dir-icon",children:[this.canPreview&&r.encoded_thumbnail_src?(0,m.jsx)("img",{ref:"drag_icon",src:"".concat(f.Yc).concat(r.encoded_thumbnail_src),className:"thumbnail cursor-pointer",onClick:this.onItemClick,alt:""}):(0,m.jsx)("img",{ref:"drag_icon",src:c,width:"24",alt:""}),r.is_locked&&(0,m.jsx)("img",{className:"locked",src:C,alt:A,title:g}),(0,m.jsx)("div",{ref:"empty_content",style:{position:"absolute",width:"1px",height:"1px"}})]})}),(0,m.jsxs)("td",{className:"name",children:[this.state.isRenameing&&(0,m.jsx)(Xt.A,{hasSuffix:"dir"!==r.type,name:r.name,onRenameConfirm:this.onRenameConfirm,onRenameCancel:this.onRenameCancel}),!this.state.isRenameing&&(0,m.jsx)(s.Fragment,{children:r.isDir()||this.canPreview?(0,m.jsx)("a",{href:"dir"===r.type?i:l,onClick:this.onItemClick,children:r.name}):(0,m.jsx)("a",{className:"sf-link",onClick:this.onItemClick,children:r.name})})]}),(0,m.jsxs)("td",{className:"tag-list-title",children:["dir"!==r.type&&r.file_tags&&r.file_tags.length>0&&(0,m.jsx)("div",{id:this.tagListTitleID,className:"dirent-item tag-list tag-list-stacked",children:r.file_tags.map((function(e,t){return(0,m.jsx)(Ko,{fileTag:e,length:r.file_tags.length,index:t},t)}))}),"dir"!==r.type&&(!r.file_tags||0==r.file_tags.length)&&(0,m.jsx)("div",{id:this.tagListTitleID,className:"dirent-item tag-list tag-list-stacked"})]}),(0,m.jsx)("td",{className:"operation",children:this.renderItemOperation()}),(0,m.jsx)("td",{className:"file-size",children:r.size&&r.size}),(0,m.jsx)("td",{className:"last-update",title:K().unix(r.mtime).format("llll"),children:r.mtime_relative})]}):(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{onClick:this.onItemClick,children:(0,m.jsxs)("div",{className:"dir-icon",children:[this.canPreview&&r.encoded_thumbnail_src?(0,m.jsx)("img",{src:"".concat(f.Yc).concat(r.encoded_thumbnail_src),className:"thumbnail cursor-pointer",alt:""}):(0,m.jsx)("img",{src:c,width:"24",alt:""}),r.is_locked&&(0,m.jsx)("img",{className:"locked",src:C,alt:A,title:g})]})}),(0,m.jsxs)("td",{onClick:this.onItemClick,children:[this.state.isRenameing&&(0,m.jsx)(Xt.A,{hasSuffix:"dir"!==r.type,name:r.name,onRenameConfirm:this.onRenameConfirm,onRenameCancel:this.onRenameCancel}),!this.state.isRenameing&&(0,m.jsx)(s.Fragment,{children:r.isDir()||this.canPreview?(0,m.jsx)("a",{href:"dir"===r.type?i:l,children:r.name}):(0,m.jsx)("a",{className:"sf-link",children:r.name})}),(0,m.jsx)("br",{}),r.size&&(0,m.jsx)("span",{className:"item-meta-info",children:r.size}),(0,m.jsx)("span",{className:"item-meta-info",children:r.mtime_relative})]}),(0,m.jsx)("td",{children:(0,m.jsxs)(ue.A,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu,children:[(0,m.jsx)(de.A,{tag:"i",className:"sf-dropdown-toggle sf3-font sf3-font-more-vertical ml-0",title:(0,f.AP)("More operations"),"aria-label":(0,f.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),(0,m.jsxs)("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu,children:[(0,m.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),(0,m.jsxs)("div",{className:"mobile-operation-menu",children:[void 0!==r.starred&&(0,m.jsx)(pe.A,{className:"mobile-menu-item",onClick:this.onItemStarred,children:r.starred?(0,f.AP)("Unstar"):(0,f.AP)("Star")}),this.props.getDirentItemMenuList(r,!0).map((function(t,n){return"Divider"!=t&&"Open via Client"!=t.key?(0,m.jsx)(pe.A,{className:"mobile-menu-item","data-op":t.key,onClick:e.onMobileMenuItemClick,children:t.value},n):null}))]})]})]})})]}),this.state.isMoveDialogShow&&(0,m.jsx)(te.A,{children:(0,m.jsx)(ho,{path:this.props.path,repoID:this.props.repoID,dirent:this.props.dirent,isMultipleOperation:this.state.isMultipleOperation,onItemMove:this.props.onItemMove,onCancelMove:this.onItemMoveToggle,repoEncrypted:this.props.repoEncrypted})}),this.state.isCopyDialogShow&&(0,m.jsx)(te.A,{children:(0,m.jsx)(fo,{path:this.props.path,repoID:this.props.repoID,dirent:this.props.dirent,isMultipleOperation:this.state.isMultipleOperation,onItemCopy:this.props.onItemCopy,onCancelCopy:this.onItemCopyToggle,repoEncrypted:this.props.repoEncrypted})}),(0,m.jsx)(d(),{query:"(min-width: 768px)",children:this.state.isEditFileTagShow&&(0,m.jsx)(no.A,{repoID:this.props.repoID,repoTags:this.props.repoTags,fileTagList:r.file_tags,filePath:a,toggleCancel:this.onEditFileTagToggle,onFileTagChanged:this.onFileTagChanged,target:this.tagListTitleID,isEditFileTagShow:this.state.isEditFileTagShow})}),(0,m.jsx)(d(),{query:"(max-width: 767.8px)",children:this.state.isEditFileTagShow&&(0,m.jsx)(Vo,{repoID:this.props.repoID,repoTags:this.props.repoTags,fileTagList:r.file_tags,filePath:a,toggleCancel:this.onEditFileTagToggle,onFileTagChanged:this.onFileTagChanged})}),this.state.isZipDialogOpen&&(0,m.jsx)(te.A,{children:(0,m.jsx)(Uo.A,{repoID:this.props.repoID,path:this.props.path,target:this.props.dirent.name,toggleDialog:this.closeZipDialog})}),this.state.isShareDialogShow&&(0,m.jsx)(te.A,{children:(0,m.jsx)($e.A,{itemType:r.type,itemName:r.name,itemPath:a,userPerm:r.permission,repoID:this.props.repoID,repoEncrypted:this.props.repoEncrypted,enableDirPrivateShare:this.props.enableDirPrivateShare,isGroupOwnedRepo:this.props.isGroupOwnedRepo,toggleDialog:this.closeSharedDialog})}),this.state.isPermissionDialogOpen&&(0,m.jsx)(te.A,{children:(0,m.jsx)(Zt,{toggleDialog:this.onPermissionItem,repoID:this.props.repoID,folderPath:a,folderName:r.name,isDepartmentRepo:this.props.isGroupOwnedRepo})}),this.state.isFileAccessLogDialogOpen&&(0,m.jsx)(te.A,{children:(0,m.jsx)(Wo,{repoID:this.props.repoID,filePath:a,fileName:r.name,toggleDialog:this.toggleFileAccessLogDialog})})]})}}])}(s.Component),Xo=n(29009),$o=n(46757),Jo=function(e){function t(){var e;(0,r.A)(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(e=(0,a.A)(this,t,[].concat(o))).handleDragEnd=function(){e.element.style.opacity=0,e.props.onHideDirentsDraggablePreview()},e.handleDragOver=function(t){if(h.Aq.isIEBrowser())return!1;t.preventDefault(),t.dataTransfer.dropEffect="move",e.element.style.top=t.clientY+"px",e.element.style.left=t.clientX+"px"},e.handleDrop=function(t){e.element.style.opacity=0,e.props.onHideDirentsDraggablePreview()},e}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){document.addEventListener("dragover",this.handleDragOver),document.addEventListener("drop",this.handleDrop),document.addEventListener("dragend",this.handleDragEnd)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("dragover",this.handleDragOver),document.removeEventListener("drop",this.handleDrop),document.removeEventListener("dragend",this.handleDragEnd)}},{key:"render",value:function(){var e=this,t=this.props.selectedDirentList,n={position:"absolute",opacity:1,pointerEvents:"none",display:"block",left:"-9999px",top:"-9999px",zIndex:101,maxHeight:document.documentElement.clientHeight,overflow:"hidden"};return(0,m.jsx)("div",{style:n,ref:function(t){return e.element=t},children:t.map((function(e,t){var n=h.Aq.getDirentIcon(e);return(0,m.jsx)("div",{children:e.encoded_thumbnail_src?(0,m.jsx)("img",{src:"".concat(f.Yc).concat(e.encoded_thumbnail_src),className:"thumbnail cursor-pointer",alt:""}):(0,m.jsx)("img",{src:n,width:"24",alt:""})},t)}))})}}])}(s.Component),Qo=Jo,ea=n(3866),ta=function(e){function t(e){var n;(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).recalculateImageItems=function(){if(n.state.isImagePopupOpen){var e=n.props.direntList.filter((function(e){return h.Aq.imageCheck(e.name)})).map((function(e){return n.prepareImageItem(e)}));n.setState({imageItems:e,imageIndex:n.state.imageIndex%e.length})}},n.freezeItem=function(){n.setState({isItemFreezed:!0})},n.unfreezeItem=function(){n.setState({isItemFreezed:!1})},n.onItemRename=function(e,t){if(n.props.direntList.some((function(e){return e.name===t}))){var r=(0,f.AP)('The name "{name}" is already taken. Please choose a different name.');return r=r.replace("{name}",h.Aq.HTMLescape(t)),E.A.danger(r),!1}n.props.onItemRename(e,t)},n.onItemRenameToggle=function(){n.freezeItem()},n.onItemSelected=function(e){n.setState({activeDirent:null}),n.props.onItemSelected(e)},n.onDirentClick=function(e,t){(0,$o.ks)(),n.props.onDirentClick(e,t)},n.sortByName=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortItems("name",t)},n.sortByTime=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortItems("time",t)},n.sortBySize=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortItems("size",t)},n.prepareImageItem=function(e){var t=e.name,r=n.props.repoID,o=h.Aq.encodePath(h.Aq.joinPath(n.props.path,t));return{name:t,url:"".concat(f.Yc,"lib/").concat(r,"/file").concat(o),thumbnail:"".concat(f.Yc,"thumbnail/").concat(r,"/").concat(f.oC).concat(o),src:"".concat(f.Yc,"repo/").concat(r,"/raw").concat(o)}},n.showImagePopup=function(e){var t=n.props.fullDirentList.filter((function(e){return h.Aq.imageCheck(e.name)})),r=t.map((function(e){return n.prepareImageItem(e)}));n.setState({isImagePopupOpen:!0,imageItems:r,imageIndex:t.indexOf(e)})},n.moveToPrevImage=function(){var e=n.state.imageItems.length;n.setState((function(t){return{imageIndex:(t.imageIndex+e-1)%e}}))},n.moveToNextImage=function(){var e=n.state.imageItems.length;n.setState((function(t){return{imageIndex:(t.imageIndex+1)%e}}))},n.deleteImage=function(e){var t=n.props.fullDirentList.find((function(t){return t.name===e}));n.props.onItemDelete(t);var r=n.props.fullDirentList.filter((function(t){return t.name!==e&&h.Aq.imageCheck(t.name)})).map((function(e){return n.prepareImageItem(e)}));n.setState((function(e){return{isImagePopupOpen:r.length>0,imageItems:r,imageIndex:e.imageIndex%r.length}}))},n.closeImagePopup=function(){n.setState({isImagePopupOpen:!1})},n.onCreateFileToggle=function(e){n.setState({isCreateFileDialogShow:!n.state.isCreateFileDialogShow,fileType:e||""})},n.onCreateFolderToggle=function(){n.setState({isCreateFolderDialogShow:!n.state.isCreateFolderDialogShow})},n.onAddFolder=function(e){n.setState({isCreateFolderDialogShow:!1}),n.props.onAddFolder(e)},n.checkDuplicatedName=function(e){return n.props.direntList.some((function(t){return t.name===e}))},n.onMoveToggle=function(){n.setState({isMoveDialogShow:!n.state.isMoveDialogShow})},n.onCopyToggle=function(){n.setState({isCopyDialogShow:!n.state.isCopyDialogShow})},n.onItemsDownload=function(){var e=n.props,t=e.path,r=e.repoID,o=e.selectedDirentList;if(o.length){if(1===o.length&&!o[0].isDir()){var a=h.Aq.joinPath(t,o[0].name),i=Fo.A.getUrl({type:"download_file_url",repoID:r,filePath:a});return void(location.href=i)}var s=o.map((function(e){return e.name}));n.setState({isProgressDialogShow:!0,downloadItems:s})}},n.onCloseZipDownloadDialog=function(){n.setState({isProgressDialogShow:!1})},n.onMouseDown=function(e){2!==e.button||e.stopPropagation()},n.handleContextClick=function(e,t,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e.preventDefault(),e.stopPropagation();var a=e.clientX||e.touches&&e.touches[0].pageX,i=e.clientY||e.touches&&e.touches[0].pageY;n.props.posX&&(a-=n.props.posX),n.props.posY&&(i-=n.props.posY),(0,$o.ks)();var s={id:t,position:{x:a,y:i},target:e.target,currentObject:o,menuList:r};0!==r.length&&(0,$o.db)(s)},n.onContainerClick=function(){(0,$o.ks)(),n.props.selectedDirentList.length>0&&n.onDirentClick(null)},n.onContainerMouseDown=function(e){n.onMouseDown(e)},n.onContainerContextMenu=function(e){e.preventDefault();var t=n.props.userPerm,r=h.Aq.getUserPermission(n.props.userPerm),o=r.isCustomPermission,a=r.customPermission;if("admin"===t||"rw"===t||o){var i=dr.A.NEW_FOLDER,s=dr.A.NEW_FILE,l=dr.A.NEW_MARKDOWN_FILE,c=dr.A.NEW_EXCEL_FILE,u=dr.A.NEW_POWERPOINT_FILE,d=dr.A.NEW_WORD_FILE,p=dr.A.NEW_SEADOC_FILE,m=[i,s,"Divider"],g=n.props.currentRepoInfo;if(f.lU&&!g.encrypted&&m.push(p),m.push(l,c,u,d),0===n.props.selectedDirentList.length){if(o)if(!a.permission.create)return;var v=m;n.handleContextClick(e,"dirent-container-menu",v)}else if(1===n.props.selectedDirentList.length)if(n.state.activeDirent){if(n.onDirentClick(null),e.preventDefault(),e.persist(),o)if(!a.permission.modify)return;setTimeout((function(){var t=m;n.handleContextClick(e,"dirent-container-menu",t)}),0)}else{var y=n.props.selectedDirentList[0],C=n.getDirentItemMenuList(y,!0);n.handleContextClick(e,"dirent-item-menu",C,y)}else{var A=[];if(o){var x=a.permission,b=x.modify,_=x.copy,w=x.download,S=x.delete;b&&A.push(dr.A.MOVE),_&&A.push(dr.A.COPY),w&&A.push(dr.A.DOWNLOAD),S&&A.push(dr.A.DELETE)}else A=[dr.A.MOVE,dr.A.COPY,dr.A.DOWNLOAD,dr.A.DELETE];n.handleContextClick(e,"dirents-menu",A)}}},n.onContainerMenuItemClick=function(e){switch(e){case"New Folder":n.onCreateFolderToggle();break;case"New File":n.onCreateFileToggle();break;case"New Markdown File":n.onCreateFileToggle(".md");break;case"New Excel File":n.onCreateFileToggle(".xlsx");break;case"New PowerPoint File":n.onCreateFileToggle(".pptx");break;case"New Word File":n.onCreateFileToggle(".docx");break;case"New SeaDoc File":n.onCreateFileToggle(".sdoc")}(0,$o.ks)()},n.onDirentsMenuItemClick=function(e){switch(e){case"Move":n.onMoveToggle();break;case"Copy":n.onCopyToggle();break;case"Download":n.onItemsDownload();break;case"Delete":n.props.onItemsDelete()}(0,$o.ks)()},n.onThreadMouseDown=function(e){n.onMouseDown(e)},n.onThreadContextMenu=function(e){e.stopPropagation()},n.onItemMouseDown=function(e){n.onMouseDown(e)},n.onItemContextMenu=function(e,t){if(!(n.props.selectedDirentList.length>1)){n.onDirentClick(t);var r=n.getDirentItemMenuList(t,!0);n.handleContextClick(e,"dirent-item-menu",r,t)}},n.setDirentItemRef=function(e){return function(t){n.direntItems[e]=t}},n.onMenuItemClick=function(e,t,r){var o=n.getDirentIndex(t);n.direntItems[o].onMenuItemClick(e,r),(0,$o.ks)()},n.onShowMenu=function(e){n.freezeItem()},n.onHideMenu=function(e){n.unfreezeItem()},n.getDirentIndex=function(e){for(var t=n.props.direntList,r=0,o=0;o<t.length;o++)if(t[o].name===e.name){r=o;break}return r},n.getDirentItemMenuList=function(e,t){var r=n.isRepoOwner,o=n.props.currentRepoInfo;return h.Aq.getDirentOperationList(r,o,e,t)},n.onTableDragEnter=function(e){if(h.Aq.isIEBrowser()||!n.canDrop)return!1;if(n.enteredCounter++,0!==n.enteredCounter){if(n.state.isListDropTipShow)return;n.setState({isListDropTipShow:!0})}},n.onTableDragOver=function(e){if(h.Aq.isIEBrowser()||!n.canDrop)return!1;"copy"!==e.dataTransfer.dropEffect&&(e.preventDefault(),e.dataTransfer.dropEffect="move")},n.onTableDragLeave=function(e){if(h.Aq.isIEBrowser()||!n.canDrop)return!1;n.enteredCounter--,0===n.enteredCounter&&n.setState({isListDropTipShow:!1})},n.tableDrop=function(e){if(h.Aq.isIEBrowser()||!n.canDrop)return!1;if(e.persist(),n.enteredCounter=0,n.setState({isListDropTipShow:!1}),!e.dataTransfer.files.length){var t=e.dataTransfer.getData("application/drag-item-info"),r=t=JSON.parse(t),o=r.nodeDirent,a=r.nodeParentPath,i=r.nodeRootPath;Array.isArray(t)||i!==n.props.path&&a!==n.props.path&&-1===n.props.path.indexOf(i)&&n.props.onItemMove(n.props.currentRepoInfo,o,n.props.path,a)}},n.onShowDirentsDraggablePreview=function(){n.setState({isShowDirentsDraggablePreview:!0})},n.onHideDirentsDraggablePreview=function(){n.setState({isShowDirentsDraggablePreview:!1})},n.state={isItemFreezed:!1,isImagePopupOpen:!1,imageItems:[],imageIndex:0,fileType:"",isCreateFileDialogShow:!1,isCreateFolderDialogShow:!1,isMoveDialogShow:!1,isCopyDialogShow:!1,isProgressDialogShow:!1,downloadItems:[],isMultipleOperation:!0,activeDirent:null,isListDropTipShow:!1,isShowDirentsDraggablePreview:!1},n.enteredCounter=0,n.isRepoOwner=e.currentRepoInfo.owner_email===f.Xh,n.isAdmin=e.currentRepoInfo.is_admin,n.repoEncrypted=e.currentRepoInfo.encrypted,n.clickedDirent=null,n.direntItems=[],n.currentItemRef=null,n.zipToken=null;var o=e.userPerm;n.canDrop="rw"===o;var i=h.Aq.getUserPermission(o),s=i.isCustomPermission,l=i.customPermission;if(s){var c=l.permission.modify;n.canDrop=c}return n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.unsubscribeEvent=this.props.eventBus.subscribe(ea.T.RESTORE_IMAGE,this.recalculateImageItems)}},{key:"componentWillUnmount",value:function(){this.unsubscribeEvent()}},{key:"render",value:function(){var e=this,t=this.props,n=t.direntList,r=t.sortBy,o=t.sortOrder;if(this.props.isDirentListLoading)return(0,m.jsx)(Z.A,{});var a="name"==r,i="time"==r,l="size"==r,c="asc"==o?(0,m.jsx)("span",{className:"sf3-font sf3-font-down rotate-180 d-inline-block"}):(0,m.jsx)("span",{className:"sf3-font sf3-font-down"}),u=h.Aq.isDesktop();return(0,m.jsxs)("div",{className:"table-container ".concat(this.state.isListDropTipShow&&this.canDrop?"table-drop-active":""),onMouseDown:this.onContainerMouseDown,onContextMenu:this.onContainerContextMenu,onClick:this.onContainerClick,onDragEnter:this.onTableDragEnter,onDragOver:this.onTableDragOver,onDragLeave:this.onTableDragLeave,onDrop:this.tableDrop,children:[n.length>0&&(0,m.jsxs)("table",{className:"table-hover ".concat(u?"":"table-thead-hidden"),children:[u?(0,m.jsx)("thead",{onMouseDown:this.onThreadMouseDown,onContextMenu:this.onThreadContextMenu,children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"3%",className:"pl10",children:(0,m.jsx)("input",{type:"checkbox",className:"vam",onChange:this.props.onAllItemSelected,checked:this.props.isAllItemSelected,title:this.props.isAllItemSelected?(0,f.AP)("Unselect all items"):(0,f.AP)("Select all items"),"aria-label":this.props.isAllItemSelected?(0,f.AP)("Unselect all items"):(0,f.AP)("Select all items"),disabled:0===n.length})}),(0,m.jsx)("th",{width:"3%",className:"pl10"}),(0,m.jsx)("th",{width:"5%",className:"pl10"}),(0,m.jsx)("th",{width:"39%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByName,children:[(0,f.AP)("Name")," ",a&&c]})}),(0,m.jsx)("th",{width:"6%"}),(0,m.jsx)("th",{width:"18%"}),(0,m.jsx)("th",{width:"11%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortBySize,children:[(0,f.AP)("Size")," ",l&&c]})}),(0,m.jsx)("th",{width:"15%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByTime,children:[(0,f.AP)("Last Update")," ",i&&c]})})]})}):(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"12%"}),(0,m.jsx)("th",{width:"80%"}),(0,m.jsx)("th",{width:"8%"})]})}),(0,m.jsx)("tbody",{children:n.map((function(t,n){return(0,m.jsx)(Zo,{ref:e.setDirentItemRef(n),dirent:t,path:e.props.path,repoID:e.props.repoID,currentRepoInfo:e.props.currentRepoInfo,isAdmin:e.isAdmin,isRepoOwner:e.isRepoOwner,repoEncrypted:e.repoEncrypted,enableDirPrivateShare:e.props.enableDirPrivateShare,isGroupOwnedRepo:e.props.isGroupOwnedRepo,onItemClick:e.props.onItemClick,onItemRenameToggle:e.onItemRenameToggle,onItemSelected:e.onItemSelected,onItemDelete:e.props.onItemDelete,onItemRename:e.onItemRename,onItemMove:e.props.onItemMove,onItemCopy:e.props.onItemCopy,onItemConvert:e.props.onItemConvert,updateDirent:e.props.updateDirent,isItemFreezed:e.state.isItemFreezed,freezeItem:e.freezeItem,unfreezeItem:e.unfreezeItem,onDirentClick:e.onDirentClick,showImagePopup:e.showImagePopup,onItemMouseDown:e.onItemMouseDown,onItemContextMenu:e.onItemContextMenu,selectedDirentList:e.props.selectedDirentList,activeDirent:e.state.activeDirent,repoTags:e.props.repoTags,onFileTagChanged:e.props.onFileTagChanged,getDirentItemMenuList:e.getDirentItemMenuList,showDirentDetail:e.props.showDirentDetail,onItemsMove:e.props.onItemsMove,onShowDirentsDraggablePreview:e.onShowDirentsDraggablePreview,loadDirentList:e.props.loadDirentList},t.name)}))})]}),0===n.length&&(0,m.jsx)($.A,{text:(0,f.AP)("No file")}),(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)(Xo.A,{id:"dirent-container-menu",onMenuItemClick:this.onContainerMenuItemClick,getMenuContainerSize:this.props.getMenuContainerSize}),(0,m.jsx)(Xo.A,{id:"dirent-item-menu",onMenuItemClick:this.onMenuItemClick,onShowMenu:this.onShowMenu,onHideMenu:this.onHideMenu,getMenuContainerSize:this.props.getMenuContainerSize}),(0,m.jsx)(Xo.A,{id:"dirents-menu",onMenuItemClick:this.onDirentsMenuItemClick,getMenuContainerSize:this.props.getMenuContainerSize}),this.state.isShowDirentsDraggablePreview&&(0,m.jsx)(te.A,{children:(0,m.jsx)(Qo,{selectedDirentList:this.props.selectedDirentList,onHideDirentsDraggablePreview:this.onHideDirentsDraggablePreview,dragStartPosition:this.state.dragStartPosition})}),this.state.isImagePopupOpen&&(0,m.jsx)(te.A,{children:(0,m.jsx)(mo.A,{imageItems:this.state.imageItems,imageIndex:this.state.imageIndex,closeImagePopup:this.closeImagePopup,moveToPrevImage:this.moveToPrevImage,moveToNextImage:this.moveToNextImage,onDeleteImage:this.deleteImage})}),this.state.isCreateFolderDialogShow&&(0,m.jsx)(te.A,{children:(0,m.jsx)(Zn.A,{parentPath:this.props.path,onAddFolder:this.onAddFolder,checkDuplicatedName:this.checkDuplicatedName,addFolderCancel:this.onCreateFolderToggle})}),this.state.isCreateFileDialogShow&&(0,m.jsx)(te.A,{children:(0,m.jsx)(Xn.A,{parentPath:this.props.path,fileType:this.state.fileType,onAddFile:this.props.onAddFile,checkDuplicatedName:this.checkDuplicatedName,toggleDialog:this.onCreateFileToggle})}),this.state.isMoveDialogShow&&(0,m.jsx)(ho,{path:this.props.path,repoID:this.props.repoID,repoEncrypted:this.props.currentRepoInfo.encrypted,isMultipleOperation:this.state.isMultipleOperation,selectedDirentList:this.props.selectedDirentList,onItemsMove:this.props.onItemsMove,onCancelMove:this.onMoveToggle}),this.state.isCopyDialogShow&&(0,m.jsx)(fo,{path:this.props.path,repoID:this.props.repoID,repoEncrypted:this.props.currentRepoInfo.encrypted,selectedDirentList:this.props.selectedDirentList,isMultipleOperation:this.state.isMultipleOperation,onItemsCopy:this.props.onItemsCopy,onCancelCopy:this.onCopyToggle}),this.state.isProgressDialogShow&&(0,m.jsx)(Uo.A,{repoID:this.props.repoID,path:this.props.path,target:this.state.downloadItems,toggleDialog:this.onCloseZipDownloadDialog})]})]})}}])}(s.Component),na=ta,ra=function(e){function t(){return(0,r.A)(this,t),(0,a.A)(this,t,arguments)}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return"/"===this.props.path&&0===this.props.direntList.length?(0,m.jsx)(Ro,{path:this.props.path,isDirentListLoading:this.props.isDirentListLoading,onAddFile:this.props.onAddFile,currentRepoInfo:this.props.currentRepoInfo}):(0,m.jsxs)(s.Fragment,{children:[this.props.isRepoInfoBarShow&&(0,m.jsx)(Lo.A,{repoID:this.props.repoID,currentPath:this.props.path,usedRepoTags:this.props.usedRepoTags,updateUsedRepoTags:this.props.updateUsedRepoTags,onFileTagChanged:this.props.onFileTagChanged}),(0,m.jsx)(na,{path:this.props.path,currentRepoInfo:this.props.currentRepoInfo,repoID:this.props.repoID,isGroupOwnedRepo:this.props.isGroupOwnedRepo,userPerm:this.props.userPerm,enableDirPrivateShare:this.props.enableDirPrivateShare,direntList:this.props.direntList,fullDirentList:this.props.fullDirentList,sortBy:this.props.sortBy,sortOrder:this.props.sortOrder,sortItems:this.props.sortItems,onItemClick:this.props.onItemClick,onItemSelected:this.props.onItemSelected,onItemDelete:this.props.onItemDelete,onItemRename:this.props.onItemRename,onItemMove:this.props.onItemMove,onItemCopy:this.props.onItemCopy,onDirentClick:this.props.onDirentClick,isDirentListLoading:this.props.isDirentListLoading,updateDirent:this.props.updateDirent,isAllItemSelected:this.props.isAllItemSelected,onAllItemSelected:this.props.onAllItemSelected,selectedDirentList:this.props.selectedDirentList,onItemsMove:this.props.onItemsMove,onItemsCopy:this.props.onItemsCopy,onItemConvert:this.props.onItemConvert,onItemsDelete:this.props.onItemsDelete,onAddFile:this.props.onAddFile,onAddFolder:this.props.onAddFolder,repoTags:this.props.repoTags,onFileTagChanged:this.props.onFileTagChanged,showDirentDetail:this.props.showDirentDetail,loadDirentList:this.props.loadDirentList,getMenuContainerSize:this.props.getMenuContainerSize,eventBus:this.props.eventBus})]})}}])}(s.Component),oa=ra,aa=n(72517),ia=n.n(aa),sa=function(e){function t(e){var n;(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onItemClick=function(e){e.preventDefault(),e.stopPropagation();var t=n.props.dirent;if(n.clickTimeout)return clearTimeout(n.clickTimeout),n.clickTimeout=null,void n.handleSingleClick(t,e);n.clickTimeout=setTimeout((function(){n.clickTimeout=null,n.handleSingleClick(t,e)}),100)},n.handleSingleClick=function(e,t){n.canPreview&&(!e.isSelected||t.metaKey||t.ctrlKey?n.props.onGridItemClick(e,t):n.handleDoubleClick(e,t))},n.handleDoubleClick=function(e,t){h.Aq.imageCheck(e.name)?n.props.showImagePopup(e):n.props.onItemClick(e)},n.onItemLinkClick=function(e){e.preventDefault();var t=n.props.dirent;t.isDir()?n.props.onItemClick(t):n.canPreview&&n.handleDoubleClick(t,e)},n.onGridItemDragStart=function(e){if(h.Aq.isIEBrowser()||!n.canDrag)return!1;var t=n.props,r=t.selectedDirentList,o=t.path,a=r.length>0?r.map((function(e){return{nodeDirent:e,nodeParentPath:o}})):{nodeDirent:n.props.dirent,nodeParentPath:n.props.path},i=JSON.stringify(a);e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("application/drag-item-info",i)},n.onGridItemDragEnter=function(e){if(h.Aq.isIEBrowser()||!n.canDrag)return!1;"dir"===n.props.dirent.type&&n.setState({isGridDropTipShow:!0})},n.onGridItemDragOver=function(e){if(h.Aq.isIEBrowser()||!n.canDrag)return!1;e.preventDefault(),e.dataTransfer.dropEffect="move"},n.onGridItemDragLeave=function(e){if(h.Aq.isIEBrowser()||!n.canDrag)return!1;n.setState({isGridDropTipShow:!1})},n.onGridItemDragDrop=function(e){if(h.Aq.isIEBrowser()||!n.canDrag)return!1;if(n.setState({isGridDropTipShow:!1}),!e.dataTransfer.files.length){var t=h.Aq.joinPath(n.props.path,n.props.dirent.name),r=e.dataTransfer.getData("application/drag-item-info");if(r=JSON.parse(r),Array.isArray(r)){if(r.some((function(e){return e.nodeDirent.name===n.props.dirent.name})))return;n.props.onItemsMove(n.props.currentRepoInfo,t)}else{var o=r,a=o.nodeDirent,i=o.nodeParentPath,s=n.props.dirent;if(a.name===s.name)return;if("dir"!==s.type)return;n.props.onItemMove(n.props.currentRepoInfo,a,t,i)}}},n.onGridItemMouseDown=function(e){n.props.onGridItemMouseDown(e)},n.getFileUrl=function(e){var t=e.split("/");return-1!==t.indexOf("48")&&t.splice(t.indexOf("48"),1,"192"),t.join("/")},n.onGridItemContextMenu=function(e){var t=n.props.dirent;n.props.onGridItemContextMenu(e,t)},n.getTextRenderWidth=function(e,t){var n=document.createElement("canvas").getContext("2d");return n.font=t||"14px Arial",n.measureText(e).width},n.getRenderedText=function(e){var t=0;e.file_tags&&e.file_tags.length>0&&(t=1===e.file_tags.length?16:16+8*(e.file_tags.length-1));var r=230-t,o="";if(n.getTextRenderWidth(e.name)>r){for(var a=e.name.lastIndexOf("."),i=e.name.slice(0,a-2),s=e.name.slice(a-2),l=0,c=0;c<i.length;c++)if(i.charCodeAt(c)>127?l+=2:l+=1,l>20){i=i.slice(0,c)+"...";break}o=i+s}else o=e.name;return o},n.state={isGridDropTipShow:!1};var o=n.props.dirent,i=h.Aq.getUserPermission(o.permission),s=i.isCustomPermission,l=i.customPermission;if(n.isCustomPermission=s,n.customPermission=l,n.canPreview=!0,n.canDrag="rw"===o.permission,s){var c=l.permission,u=c.preview,d=c.modify;n.canPreview=u||d,n.canDrag=d}return n.clickTimeout=null,n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentWillUnmount",value:function(){this.clickTimeout&&clearTimeout(this.clickTimeout)}},{key:"render",value:function(){var e=this.props,t=e.dirent,n=e.path,r=e.repoID,o=h.Aq.joinPath(n,t.name),a=h.Aq.getDirentIcon(t,!0),i=t.encoded_thumbnail_src?this.getFileUrl(t.encoded_thumbnail_src):"",l="",c="";t.file_tags&&t.file_tags.length>0&&(l=ia()(t.name).slice(0,7),c=t.file_tags.map((function(e){return e.name})).join(" "));var u="";this.props.currentRepoInfo&&(u=f.Yc+"library/"+r+"/"+this.props.currentRepoInfo.repo_name+h.Aq.encodePath(o));var d=f.Yc+"lib/"+r+"/file"+h.Aq.encodePath(o);t.is_sdoc_revision&&t.revision_id&&(d=f.Yc+"lib/"+r+"/revisions/"+t.revision_id+"/");var p="grid-file-img-link cursor-pointer";p+=this.state.isGridDropTipShow?" grid-drop-show":" ";var g=t.is_freezed?(0,f.AP)("Frozen by {name}"):(0,f.AP)("locked by {name}");g=g.replace("{name}",t.lock_owner_name);var v="".concat(f.SG,"img/file-").concat(t.is_freezed?"freezed-32.svg":"locked-32.png"),y=t.is_freezed?(0,f.AP)("freezed"):(0,f.AP)("locked"),C=this.getRenderedText(t);return(0,m.jsx)(s.Fragment,{children:(0,m.jsxs)("li",{className:"grid-item ".concat(t.isSelected?"grid-selected-active":""),onContextMenu:this.onGridItemContextMenu,onMouseDown:this.onGridItemMouseDown,children:[(0,m.jsxs)("div",{className:p,draggable:this.canDrag,onClick:this.onItemClick,onDragStart:this.onGridItemDragStart,onDragEnter:this.onGridItemDragEnter,onDragOver:this.onGridItemDragOver,onDragLeave:this.onGridItemDragLeave,onDrop:this.onGridItemDragDrop,children:[this.canPreview&&t.encoded_thumbnail_src?(0,m.jsx)("img",{src:"".concat(f.Yc).concat(i),className:"thumbnail",onClick:this.onItemClick,alt:""}):(0,m.jsx)("img",{src:a,width:"96",alt:""}),t.is_locked&&(0,m.jsx)("img",{className:"grid-file-locked-icon",src:v,alt:y,title:g})]}),(0,m.jsxs)("div",{className:"grid-file-name",onDragStart:this.onGridItemDragStart,draggable:this.canDrag,children:["dir"!==t.type&&t.file_tags&&t.file_tags.length>0&&(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("div",{id:"tag-list-title-".concat(l),className:"dirent-item tag-list tag-list-stacked d-inline-block align-middle",children:t.file_tags.map((function(e,n){var r=t.file_tags.length;return(0,m.jsx)("span",{className:"file-tag",style:{zIndex:r-n,backgroundColor:e.color}},e.id)}))}),(0,m.jsx)(Je.A,{target:"tag-list-title-".concat(l),placement:"bottom",children:c})]}),t.isDir()||this.canPreview?(0,m.jsx)("a",{className:"grid-file-name-link",href:"dir"===t.type?u:d,onClick:this.onItemClick,title:t.name,children:C}):(0,m.jsx)("a",{className:"sf-link grid-file-name-link",onClick:this.onItemClick,title:t.name,children:C})]})]})})}}])}(s.Component),la=sa,ca=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).handleChange=function(e){e.target.value.trim()?n.setState({isSubmitBtnActive:!0}):n.setState({isSubmitBtnActive:!1}),n.setState({newName:e.target.value})},n.handleSubmit=function(){var e=n.state.newName.trim(),t=(0,h.yS)(e),r=t.isValid,o=t.errMessage;if(r){if(n.props.checkDuplicatedName(e)){var a=(0,f.AP)('The name "{name}" is already taken. Please choose a different name.');return a=a.replace("{name}",h.Aq.HTMLescape(e)),void n.setState({errMessage:a})}n.props.onRename(e),n.props.toggleCancel()}else n.setState({errMessage:o})},n.handleKeyDown=function(e){"Enter"===e.key&&(e.preventDefault(),n.handleSubmit())},n.toggle=function(){n.props.toggleCancel()},n.changeState=function(e){var t=e.name;n.setState({newName:t})},n.onAfterModelOpened=function(){var e=n.newInput.current;if(e){e.focus();var t=n.state.newName.lastIndexOf(".");t>0?e.setSelectionRange(0,t):e.select()}},n.state={newName:"",errMessage:"",isSubmitBtnActive:!1},n.newInput=s.createRef(),n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"UNSAFE_componentWillMount",value:function(){this.setState({newName:this.props.dirent.name})}},{key:"componentDidMount",value:function(){var e=this.props.dirent;this.changeState(e)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.changeState(e.dirent)}},{key:"render",value:function(){var e=this.props.dirent.type;return(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.toggle,onOpened:this.onAfterModelOpened,children:[(0,m.jsx)(k.A,{toggle:this.toggle,children:"file"===e?(0,f.AP)("Rename File"):(0,f.AP)("Rename Folder")}),(0,m.jsxs)(M.A,{children:[(0,m.jsx)("p",{children:"file"===e?(0,f.AP)("New file name"):(0,f.AP)("New folder name")}),(0,m.jsx)(I.A,{onKeyDown:this.handleKeyDown,innerRef:this.newInput,value:this.state.newName,onChange:this.handleChange}),this.state.errMessage&&(0,m.jsx)(St.A,{color:"danger",className:"mt-2",children:this.state.errMessage})]}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(P.A,{color:"secondary",onClick:this.toggle,children:(0,f.AP)("Cancel")}),(0,m.jsx)(P.A,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive,children:(0,f.AP)("Submit")})]})]})}}])}(s.Component),ua=ca,da=function(){return(0,o.A)((function e(){(0,r.A)(this,e)}),[{key:"init",value:function(e){var t=e.server,n=e.username,r=e.password,o=e.token;return this.server=t,this.username=n,this.password=r,this.token=o,this.token&&this.server&&(this.req=ft.A.create({baseURL:this.server,headers:{Authorization:"Token "+this.token}})),this}},{key:"initForSeahubUsage",value:function(e){var t=e.siteRoot,n=e.xcsrfHeaders;if(t&&"/"===t.charAt(t.length-1)){var r=t.substring(0,t.length-1);this.server=r}else this.server=t;return this.req=ft.A.create({headers:{"X-CSRFToken":n}}),this}},{key:"_sendPostRequest",value:function(e,t){return t.getHeaders?this.req.post(e,t,{headers:t.getHeaders()}):this.req.post(e,t)}},{key:"rotateImage",value:function(e,t,n){var r="".concat(this.server,"/api/v2.1/repos/").concat(e,"/image-rotate/"),o=new FormData;return o.append("path",t),o.append("angle",n),this._sendPostRequest(r,o)}}])}(),pa=new da,fa=We.Ay.load("sfcsrftoken");pa.initForSeahubUsage({siteRoot:f.Yc,xcsrfHeaders:fa});var ha=pa,ma=(n(47100),"dirent-grid-container-menu"),ga="grid-item-contextmenu",va="dirents-menu",ya=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).recalculateImageItems=function(){if(n.state.isImagePopupOpen){var e=n.props.direntList.filter((function(e){return h.Aq.imageCheck(e.name)})).map((function(e){return n.prepareImageItem(e)}));n.setState({imageItems:e,imageIndex:n.state.imageIndex%e.length})}},n.onGridContainerMouseDown=function(e){if(2!==e.button&&0===e.button){if((0,$o.ks)(),n.props.onGridItemClick(null),e.target.closest("img")||e.target.closest("div.grid-file-name"))return;var t=n.containerRef.current.getBoundingClientRect();n.setState({startPoint:{x:e.clientX-t.left,y:e.clientY-t.top},endPoint:{x:e.clientX-t.left,y:e.clientY-t.top},selectedItemsList:[],isSelecting:!1,isMouseDown:!0})}},n.onSelectMouseMove=function(e){if(n.state.isMouseDown){var t=n.containerRef.current.getBoundingClientRect(),r={x:e.clientX-t.left,y:e.clientY-t.top};r.x=Math.max(0,Math.min(r.x,t.width)),r.y=Math.max(0,Math.min(r.y,t.height)),Math.sqrt(Math.pow(r.x-n.state.startPoint.x,2)+Math.pow(r.y-n.state.startPoint.y,2))>5&&n.setState({isSelecting:!0,endPoint:r},(function(){n.determineSelectedItems(),n.autoScroll(e.clientY);var t=new Set(n.state.selectedItemsList.map((function(e){return e.lastChild.lastChild.title}))),r=n.props.direntList.filter((function(e){return t.has(e.name)})).map((function(e){return(0,ur.A)((0,ur.A)({},e),{},{isSelected:!0})}));n.props.onSelectedDirentListUpdate(r)}))}},n.onGlobalMouseUp=function(){n.state.isMouseDown&&(clearInterval(n.state.autoScrollInterval),n.setState({isSelecting:!1,isMouseDown:!1,autoScrollInterval:null}))},n.determineSelectedItems=function(){var e=n.state,t=e.startPoint,r=e.endPoint,o=n.containerRef.current,a=o.querySelectorAll(".grid-item"),i=Math.min(t.x,r.x),s=Math.min(t.y,r.y),l=Math.max(t.x,r.x),c=Math.max(t.y,r.y),u=[];a.forEach((function(e){var t=e.getBoundingClientRect(),n=t.left-o.getBoundingClientRect().left,r=t.top-o.getBoundingClientRect().top,a=t.right-o.getBoundingClientRect().left,d=t.bottom-o.getBoundingClientRect().top;n<l&&a>i&&r<c&&d>s&&u.push(e)})),n.setState({selectedItemsList:u})},n.autoScroll=function(e){var t=n.containerRef.current,r=t.getBoundingClientRect(),o=function(){var o={x:n.state.endPoint.x,y:e-r.top+t.scrollTop};n.setState({endPoint:o},(function(){n.determineSelectedItems()}))};if(e<r.top+20){if(!n.state.autoScrollInterval){var a=setInterval((function(){t.scrollTop-=10,o()}),50);n.setState({autoScrollInterval:a})}}else if(e>r.bottom-20){if(!n.state.autoScrollInterval){var i=setInterval((function(){t.scrollTop+=10,o()}),50);n.setState({autoScrollInterval:i})}}else clearInterval(n.state.autoScrollInterval),n.setState({autoScrollInterval:null})},n.onCreateFileToggle=function(e){n.setState({isCreateFileDialogShow:!n.state.isCreateFileDialogShow,fileType:e||""})},n.onGridItemClick=function(e,t){(0,$o.ks)(),n.state.activeDirent!==e&&n.setState({activeDirent:e}),n.props.onGridItemClick(e,t)},n.onMoveToggle=function(){n.setState({isMoveDialogShow:!n.state.isMoveDialogShow})},n.onCopyToggle=function(){n.setState({isCopyDialogShow:!n.state.isCopyDialogShow})},n.onAddFolder=function(e){n.setState({isCreateFolderDialogShow:!1}),n.props.onAddFolder(e)},n.onItemShare=function(e){e.nativeEvent.stopImmediatePropagation(),n.setState({isShareDialogShow:!n.state.isShareDialogShow})},n.closeSharedDialog=function(){n.setState({isShareDialogShow:!n.state.isShareDialogShow})},n.onItemDelete=function(e,t){t.nativeEvent.stopImmediatePropagation(),1!==n.props.selectedDirentList.length?n.props.onItemsDelete():n.props.onItemDelete(e)},n.onItemConvert=function(e,t,r){t.nativeEvent.stopImmediatePropagation(),n.props.onItemConvert(e,r)},n.exportDocx=function(){var e=window.app.config.serviceURL,t=n.state.activeDirent?n.state.activeDirent:"";if(t){var r=n.props.repoID,o=n.getDirentPath(t);window.location.href=e+"/repo/sdoc_export_to_docx/"+r+"/?file_path="+o}},n.exportSdoc=function(){var e=window.app.config.serviceURL,t=n.state.activeDirent?n.state.activeDirent:"";if(t){var r=n.props.repoID,o=n.getDirentPath(t);window.location.href=e+"/lib/"+r+"/file/"+o+"?dl=1"}},n.onMenuItemClick=function(e,t,r){switch((0,$o.ks)(),e){case"Download":n.onItemsDownload();break;case"Share":n.onItemShare(r);break;case"Delete":n.onItemDelete(t,r);break;case"Rename":n.onItemRenameToggle();break;case"Move":n.onItemMoveToggle();break;case"Copy":n.onItemCopyToggle();break;case"Unfreeze Document":case"Unlock":n.onUnlockItem(t);break;case"Freeze Document":n.onFreezeDocument(t);break;case"Convert to Markdown":n.onItemConvert(t,r,"markdown");break;case"Convert to docx":n.onItemConvert(t,r,"docx");break;case"Export docx":n.exportDocx();break;case"Export sdoc":n.exportSdoc();break;case"Convert to sdoc":n.onItemConvert(t,r,"sdoc");break;case"Tags":n.onEditFileTagToggle();break;case"Permission":n.onPermissionItem();break;case"Lock":n.onLockItem(t);break;case"History":n.onHistory(t);break;case"New Folder":n.onCreateFolderToggle(t);break;case"New File":n.onCreateFileToggle("");break;case"New Markdown File":n.onCreateFileToggle(".md");break;case"New Excel File":n.onCreateFileToggle(".xlsx");break;case"New PowerPoint File":n.onCreateFileToggle(".pptx");break;case"New Word File":n.onCreateFileToggle(".docx");break;case"New SeaDoc File":n.onCreateFileToggle(".sdoc");break;case"Access Log":n.toggleFileAccessLogDialog();break;case"Properties":n.props.showDirentDetail("info");break;case"Open via Client":n.onOpenViaClient(t)}},n.onDirentsMenuItemClick=function(e){switch(e){case"Move":n.onMoveToggle();break;case"Copy":n.onCopyToggle();break;case"Download":n.onItemsDownload();break;case"Delete":n.props.onItemsDelete()}(0,$o.ks)()},n.onEditFileTagToggle=function(){n.setState({isEditFileTagShow:!n.state.isEditFileTagShow})},n.onFileTagChanged=function(){var e=n.state.activeDirent?n.state.activeDirent:"",t=h.Aq.joinPath(n.props.path,e.name);n.props.onFileTagChanged(e,t)},n.getDirentPath=function(e){var t=n.props.path;return"/"===t?t+e.name:t+"/"+e.name},n.closeZipDialog=function(){n.setState({isZipDialogOpen:!1})},n.onItemsDownload=function(){var e=n.props,t=e.path,r=e.repoID,o=e.selectedDirentList;if(1!==o.length||o[0].isDir()){var a=o.map((function(e){return e.name}));n.setState({isZipDialogOpen:!0,downloadItems:a})}else{var i=h.Aq.joinPath(t,o[0].name),s=Fo.A.getUrl({type:"download_file_url",repoID:r,filePath:i});location.href=s}},n.onCreateFolderToggle=function(){n.setState({isCreateFolderDialogShow:!n.state.isCreateFolderDialogShow})},n.onItemRenameToggle=function(){n.setState({isRenameDialogShow:!n.state.isRenameDialogShow})},n.onItemMoveToggle=function(){n.setState({isMoveDialogShow:!n.state.isMoveDialogShow})},n.onItemCopyToggle=function(){n.setState({isCopyDialogShow:!n.state.isCopyDialogShow})},n.onPermissionItem=function(){n.setState({isPermissionDialogOpen:!n.state.isPermissionDialogOpen})},n.onLockItem=function(e){var t=n.props.repoID,r=n.getDirentPath(e);S.e.lockfile(t,r).then((function(){n.props.updateDirent(e,"is_locked",!0),n.props.updateDirent(e,"locked_by_me",!0);var t=f.Xh.split("@");n.props.updateDirent(e,"lock_owner_name",t[0])})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.onFreezeDocument=function(e){var t=n.props.repoID,r=n.getDirentPath(e);S.e.lockfile(t,r,-1).then((function(){n.props.updateDirent(e,"is_freezed",!0),n.props.updateDirent(e,"is_locked",!0),n.props.updateDirent(e,"locked_by_me",!0);var t=f.Xh.split("@");n.props.updateDirent(e,"lock_owner_name",t[0])})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.onUnlockItem=function(e){var t=n.props.repoID,r=n.getDirentPath(e);S.e.unlockfile(t,r).then((function(){n.props.updateDirent(e,"is_locked",!1),n.props.updateDirent(e,"locked_by_me",!1),n.props.updateDirent(e,"lock_owner_name","")})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.onHistory=function(e){var t=n.props.repoID,r=n.getDirentPath(e),o=Fo.A.getUrl({type:"file_revisions",repoID:t,filePath:r});location.href=o},n.toggleFileAccessLogDialog=function(){n.setState({isFileAccessLogDialogOpen:!n.state.isFileAccessLogDialogOpen})},n.onOpenViaClient=function(e){var t=n.props.repoID,r=n.getDirentPath(e),o=Fo.A.getUrl({type:"open_via_client",repoID:t,filePath:r});location.href=o},n.onItemRename=function(e){n.props.onItemRename(n.state.activeDirent,e)},n.prepareImageItem=function(e){var t=e.name,r=n.props.repoID,o=h.Aq.encodePath(h.Aq.joinPath(n.props.path,t)),a=(new Date).getTime();return{name:t,url:"".concat(f.Yc,"lib/").concat(r,"/file").concat(o),thumbnail:"".concat(f.Yc,"thumbnail/").concat(r,"/").concat(f.oC).concat(o),src:"".concat(f.Yc,"repo/").concat(r,"/raw").concat(o,"?t=").concat(a)}},n.showImagePopup=function(e){var t=n.props.fullDirentList.filter((function(e){return h.Aq.imageCheck(e.name)})),r=t.map((function(e){return n.prepareImageItem(e)}));n.setState({isImagePopupOpen:!0,imageItems:r,imageIndex:t.indexOf(e)})},n.closeImagePopup=function(){n.setState({isImagePopupOpen:!1})},n.moveToPrevImage=function(){var e=n.state.imageItems.length;n.setState((function(t){return{imageIndex:(t.imageIndex+e-1)%e}}))},n.moveToNextImage=function(){var e=n.state.imageItems.length;n.setState((function(t){return{imageIndex:(t.imageIndex+1)%e}}))},n.deleteImage=function(e){var t=n.props.fullDirentList.find((function(t){return t.name===e}));n.props.onItemDelete(t);var r=n.props.fullDirentList.filter((function(t){return t.name!==e&&h.Aq.imageCheck(t.name)})).map((function(e){return n.prepareImageItem(e)}));n.setState((function(e){return{isImagePopupOpen:r.length>0,imageItems:r,imageIndex:e.imageIndex%r.length}}))},n.rotateImage=function(e,t){if(e>=0&&0!==t){var r="/"===n.state.path?n.props.path+n.state.imageItems[e].name:n.props.path+"/"+n.state.imageItems[e].name;ha.rotateImage(n.props.repoID,r,360-t).then((function(t){S.e.createThumbnail(n.props.repoID,r,f.dq).then((function(t){var r=(new Date).getTime(),o="".concat(t.data.encoded_thumbnail_src,"?t=").concat(r);n.setState((function(t){var n=(0,z.A)(t.imageItems);return n[e].src=o,{imageItems:n}}));var a=n.props.direntList.find((function(t){return t.name===n.state.imageItems[e].name}));n.props.updateDirent(a,"encoded_thumbnail_src",o)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))}},n.checkDuplicatedName=function(e){return h.Aq.checkDuplicatedNameInList(n.props.direntList,e)},n.onGridItemMouseDown=function(e){e.stopPropagation(),e.button},n.gridContainerClick=function(e){e.stopPropagation(),(0,$o.ks)()},n.onGridContainerContextMenu=function(e){e.preventDefault();var t=function(e){var t=h.Aq.getUserPermission(n.props.userPerm),r=t.isCustomPermission,o=t.customPermission;return!r||o.permission[e]};if(["admin","rw"].includes(n.props.userPerm)){var r=dr.A.NEW_FOLDER,o=dr.A.NEW_FILE,a=dr.A.NEW_MARKDOWN_FILE,i=dr.A.NEW_EXCEL_FILE,s=dr.A.NEW_POWERPOINT_FILE,l=dr.A.NEW_WORD_FILE,c=dr.A.NEW_SEADOC_FILE,u=[r,o,"Divider"],d=n.props,p=d.currentRepoInfo,m=d.selectedDirentList;if(f.lU&&!p.encrypted&&u.push(c),u.push(a,i,s,l),0===m.length){if(!t("create"))return;n.handleContextClick(e,ma,u)}else if(1===m.length)if(n.state.activeDirent){if(n.props.onGridItemClick(null),e.persist(),!t("modify"))return;setTimeout((function(){n.handleContextClick(e,ma,u)}),0)}else{var g=h.Aq.getDirentOperationList(n.isRepoOwner,p,m[0],!0);n.handleContextClick(e,ga,g,m[0])}else{var v=[];if(!t("modify")&&!t("copy")&&!t("download")&&!t("delete"))return;["move","copy","download","delete"].forEach((function(e){t(e)&&v.push(dr.A[e.toUpperCase()])})),n.handleContextClick(e,va,v)}}},n.onGridItemContextMenu=function(e,t){if(!(n.props.selectedDirentList.length>1)){var r=n.getDirentItemMenuList(t,!0);n.handleContextClick(e,"grid-item-contextmenu",r,t),n.props.direntList.filter((function(e){return e.isSelected})).length>1||n.props.onGridItemClick&&n.props.onGridItemClick(t)}},n.handleContextClick=function(e,t,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e.preventDefault(),e.stopPropagation();var a=e.clientX||e.touches&&e.touches[0].pageX,i=e.clientY||e.touches&&e.touches[0].pageY;n.props.posX&&(a-=n.props.posX),n.props.posY&&(i-=n.props.posY),(0,$o.ks)(),n.setState({activeDirent:o});var s={id:t,position:{x:a,y:i},target:e.target,currentObject:o,menuList:r};0!==r.length&&(0,$o.db)(s)},n.getDirentItemMenuList=function(e,t){var r=n.isRepoOwner,o=n.props.currentRepoInfo;return h.Aq.getDirentOperationList(r,o,e,t)},n.renderSelectionBox=function(){var e=n.state,t=e.startPoint,r=e.endPoint;if(!n.state.isSelecting)return null;var o=Math.min(t.x,r.x),a=Math.min(t.y,r.y),i=Math.abs(t.x-r.x),s=Math.abs(t.y-r.y);return(0,m.jsx)("div",{className:"selection-box",style:{left:o,top:a,width:i,height:s}})},n.state={isImagePopupOpen:!1,imageItems:[],imageIndex:0,isFileAccessLogDialogOpen:!1,isShareDialogShow:!1,isMoveDialogShow:!1,isCopyDialogShow:!1,isEditFileTagShow:!1,isZipDialogOpen:!1,isRenameDialogShow:!1,isCreateFolderDialogShow:!1,isCreateFileDialogShow:!1,fileType:"",isPermissionDialogOpen:!1,isMultipleOperation:!0,isGridItemFreezed:!1,activeDirent:null,downloadItems:[],startPoint:{x:0,y:0},endPoint:{x:0,y:0},selectedItemsList:[],isSelecting:!1,isMouseDown:!1,autoScrollInterval:null},n.containerRef=s.createRef(),n.isRepoOwner=e.currentRepoInfo.owner_email===f.Xh,n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){window.addEventListener("mouseup",this.onGlobalMouseUp),this.unsubscribeEvent=this.props.eventBus.subscribe(ea.T.RESTORE_IMAGE,this.recalculateImageItems)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("mouseup",this.onGlobalMouseUp),this.unsubscribeEvent()}},{key:"render",value:function(){var e=this,t=this.props,n=t.direntList,r=t.selectedDirentList,o=t.path,a=this.state.activeDirent?this.state.activeDirent:"",i=h.Aq.joinPath(o,a.name);return this.props.isDirentListLoading?(0,m.jsx)(Z.A,{}):(0,m.jsxs)(s.Fragment,{children:[n.length>0?(0,m.jsxs)("ul",{className:"grid-view",onClick:this.gridContainerClick,onContextMenu:this.onGridContainerContextMenu,onMouseDown:this.onGridContainerMouseDown,onMouseMove:this.onSelectMouseMove,ref:this.containerRef,children:[n.map((function(t,n){return(0,m.jsx)(la,{dirent:t,repoID:e.props.repoID,path:e.props.path,onItemClick:e.props.onItemClick,currentRepoInfo:e.props.currentRepoInfo,showImagePopup:e.showImagePopup,onGridItemContextMenu:e.onGridItemContextMenu,onItemMove:e.props.onItemMove,onItemsMove:e.props.onItemsMove,onGridItemMouseDown:e.onGridItemMouseDown,onGridItemClick:e.onGridItemClick,activeDirent:e.state.activeDirent,selectedDirentList:r},t.name)})),this.renderSelectionBox()]}):(0,m.jsx)("ul",{className:"grid-view",onClick:this.gridContainerClick,onContextMenu:this.onGridContainerContextMenu,onMouseDown:this.onGridContainerMouseDown,onMouseMove:this.onSelectMouseMove,ref:this.containerRef,children:(0,m.jsx)($.A,{text:(0,f.AP)("No file"),className:"w-100"})}),(0,m.jsx)(Xo.A,{id:ga,onMenuItemClick:this.onMenuItemClick,getMenuContainerSize:this.props.getMenuContainerSize}),(0,m.jsx)(Xo.A,{id:ma,onMenuItemClick:this.onMenuItemClick,getMenuContainerSize:this.props.getMenuContainerSize}),(0,m.jsx)(Xo.A,{id:va,onMenuItemClick:this.onDirentsMenuItemClick,getMenuContainerSize:this.props.getMenuContainerSize}),this.state.isCreateFolderDialogShow&&(0,m.jsx)(te.A,{children:(0,m.jsx)(Zn.A,{parentPath:this.props.path,onAddFolder:this.onAddFolder,checkDuplicatedName:this.checkDuplicatedName,addFolderCancel:this.onCreateFolderToggle})}),this.state.isCreateFileDialogShow&&(0,m.jsx)(te.A,{children:(0,m.jsx)(Xn.A,{parentPath:this.props.path,fileType:this.state.fileType,onAddFile:this.props.onAddFile,checkDuplicatedName:this.checkDuplicatedName,toggleDialog:this.onCreateFileToggle})}),this.state.isMoveDialogShow&&(0,m.jsx)(ho,{path:this.props.path,repoID:this.props.repoID,repoEncrypted:this.props.currentRepoInfo.encrypted,isMultipleOperation:this.state.isMultipleOperation,selectedDirentList:r,onItemMove:this.props.onItemMove,onItemsMove:this.props.onItemsMove,onCancelMove:this.onMoveToggle,dirent:this.state.activeDirent}),this.state.isZipDialogOpen&&(0,m.jsx)(te.A,{children:(0,m.jsx)(Uo.A,{repoID:this.props.repoID,path:this.props.path,target:this.state.downloadItems,toggleDialog:this.closeZipDialog})}),this.state.isCopyDialogShow&&(0,m.jsx)(fo,{path:this.props.path,repoID:this.props.repoID,repoEncrypted:this.props.currentRepoInfo.encrypted,isMultipleOperation:this.state.isMultipleOperation,selectedDirentList:r,onItemsCopy:this.props.onItemsCopy,onCancelCopy:this.onCopyToggle}),this.state.isEditFileTagShow&&(0,m.jsx)(Vo,{repoID:this.props.repoID,fileTagList:a.file_tags,filePath:i,toggleCancel:this.onEditFileTagToggle,repoTags:this.props.repoTags,onFileTagChanged:this.onFileTagChanged}),this.state.isShareDialogShow&&(0,m.jsx)(te.A,{children:(0,m.jsx)($e.A,{itemType:a.type,itemName:a.name,itemPath:i,userPerm:a.permission,repoID:this.props.repoID,repoEncrypted:!1,enableDirPrivateShare:this.props.enableDirPrivateShare,isGroupOwnedRepo:this.props.isGroupOwnedRepo,toggleDialog:this.closeSharedDialog})}),this.state.isRenameDialogShow&&(0,m.jsx)(te.A,{children:(0,m.jsx)(ua,{dirent:r.length>1?r[r.length-1]:this.state.activeDirent,onRename:this.onItemRename,checkDuplicatedName:this.checkDuplicatedName,toggleCancel:this.onItemRenameToggle})}),this.state.isPermissionDialogOpen&&(0,m.jsx)(te.A,{children:(0,m.jsx)(Zt,{toggleDialog:this.onPermissionItem,repoID:this.props.repoID,folderPath:i,folderName:a.name,isDepartmentRepo:this.props.isGroupOwnedRepo})}),this.state.isImagePopupOpen&&this.state.imageItems.length&&(0,m.jsx)(te.A,{children:(0,m.jsx)(mo.A,{imageItems:this.state.imageItems,imageIndex:this.state.imageIndex,closeImagePopup:this.closeImagePopup,moveToPrevImage:this.moveToPrevImage,moveToNextImage:this.moveToNextImage,onDeleteImage:this.deleteImage,onRotateImage:this.rotateImage})}),this.state.isFileAccessLogDialogOpen&&(0,m.jsx)(te.A,{children:(0,m.jsx)(Wo,{repoID:this.props.repoID,filePath:i,fileName:a.name,toggleDialog:this.toggleFileAccessLogDialog})})]})}}])}(s.Component),Ca=ya,Aa=function(e){function t(){return(0,r.A)(this,t),(0,a.A)(this,t,arguments)}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return"/"===this.props.path&&0===this.props.direntList.length?(0,m.jsx)(Ro,{path:this.props.path,isDirentListLoading:this.props.isDirentListLoading,onAddFile:this.props.onAddFile,currentRepoInfo:this.props.currentRepoInfo}):(0,m.jsxs)(s.Fragment,{children:[this.props.isRepoInfoBarShow&&(0,m.jsx)(Lo.A,{repoID:this.props.repoID,currentPath:this.props.path,usedRepoTags:this.props.usedRepoTags,updateUsedRepoTags:this.props.updateUsedRepoTags,onFileTagChanged:this.props.onFileTagChanged}),(0,m.jsx)(Ca,{path:this.props.path,repoID:this.props.repoID,currentRepoInfo:this.props.currentRepoInfo,isGroupOwnedRepo:this.props.isGroupOwnedRepo,userPerm:this.props.userPerm,enableDirPrivateShare:this.props.enableDirPrivateShare,direntList:this.props.direntList,fullDirentList:this.props.fullDirentList,selectedDirentList:this.props.selectedDirentList,onSelectedDirentListUpdate:this.props.onSelectedDirentListUpdate,onAddFile:this.props.onAddFile,onItemClick:this.props.onItemClick,onItemDelete:this.props.onItemDelete,onItemMove:this.props.onItemMove,onItemCopy:this.props.onItemCopy,onItemConvert:this.props.onItemConvert,onItemsMove:this.props.onItemsMove,onItemsCopy:this.props.onItemsCopy,onItemsDelete:this.props.onItemsDelete,isDirentListLoading:this.props.isDirentListLoading,updateDirent:this.props.updateDirent,onRenameNode:this.props.onRenameNode,showDirentDetail:this.props.showDirentDetail,onGridItemClick:this.props.onGridItemClick,isDirentDetailShow:this.props.isDirentDetailShow,onItemRename:this.props.onItemRename,onAddFolder:this.props.onAddFolder,repoTags:this.props.repoTags,onFileTagChanged:this.props.onFileTagChanged,getMenuContainerSize:this.props.getMenuContainerSize,eventBus:this.props.eventBus})]})}}])}(s.Component),xa=Aa,ba=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onResizeMouseUp=function(){n.state.inResizing&&n.setState({inResizing:!1}),localStorage.setItem("sf_dir_content_nav_rate",n.state.navRate)},n.onResizeMouseDown=function(){n.containerWidth=n.viewModeContainer.current.clientWidth,n.setState({inResizing:!0})},n.onResizeMouseMove=function(e){var t=n.props.isSidePanelFolded?j.xQ+3:window.innerWidth-n.containerWidth,r=(e.nativeEvent.clientX-t)/n.containerWidth;n.setState({navRate:Math.max(Math.min(r,q.Rx),q.Pf)})},n.onResizeMouseOver=function(e){if(n.dragHandlerRef.current){var t=n.resizeBarRef.current.getBoundingClientRect().top,r=e.pageY-t-q.gO/2;n.setDragHandlerTop(r)}},n.setDragHandlerTop=function(e){n.dragHandlerRef.current.style.top=e+"px"},n.getMenuContainerSize=function(){var e=window;return{width:e.innerWidth,height:e.innerHeight}},n.state={inResizing:!1,navRate:parseFloat(localStorage.getItem("sf_dir_content_nav_rate")||.25)},n.containerWidth=null,n.resizeBarRef=s.createRef(),n.dragHandlerRef=s.createRef(),n.viewModeContainer=s.createRef(),n.dirContentMain=s.createRef(),n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.currentMode,n=e.isTreePanelShown,r=this.state,o=r.navRate,a=r.inResizing,i={userSelect:a?"none":"",flex:"1 0 "+100*(1-o)+"%"};return(0,m.jsxs)("div",{className:"dir-column-view",onMouseMove:a?this.onResizeMouseMove:null,onMouseUp:this.onResizeMouseUp,ref:this.viewModeContainer,children:[n&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(Po,{currentPath:this.props.path,userPerm:this.props.userPerm,isTreeDataLoading:this.props.isTreeDataLoading,treeData:this.props.treeData,currentNode:this.props.currentNode,onNodeClick:this.props.onNodeClick,onNodeCollapse:this.props.onNodeCollapse,onNodeExpanded:this.props.onNodeExpanded,onAddFolderNode:this.props.onAddFolderNode,onAddFileNode:this.props.onAddFileNode,onRenameNode:this.props.onRenameNode,onDeleteNode:this.props.onDeleteNode,repoID:this.props.repoID,navRate:o,inResizing:a,currentRepoInfo:this.props.currentRepoInfo,onItemMove:this.props.onItemMove,onItemCopy:this.props.onItemCopy,selectedDirentList:this.props.selectedDirentList,onItemsMove:this.props.onItemsMove,getMenuContainerSize:this.getMenuContainerSize,direntList:this.props.direntList}),(0,m.jsx)(G.A,{resizeBarRef:this.resizeBarRef,dragHandlerRef:this.dragHandlerRef,resizeBarStyle:{left:"calc(".concat(o?100*o+"%":"25%"," - 1px)")},dragHandlerStyle:{height:q.gO},onResizeMouseDown:this.onResizeMouseDown,onResizeMouseOver:this.onResizeMouseOver})]}),(0,m.jsxs)("div",{className:"dir-content-main",style:i,onScroll:this.props.isViewFile?function(){}:this.props.onItemsScroll,ref:this.dirContentMain,children:[t===tt.Ys&&(0,m.jsx)(eo.Bd,{mediaUrl:f.SG,repoID:this.props.repoID,repoInfo:this.props.currentRepoInfo,viewID:this.props.viewId}),t===tt.Tb&&(0,m.jsx)(oa,{path:this.props.path,repoID:this.props.repoID,currentRepoInfo:this.props.currentRepoInfo,isGroupOwnedRepo:this.props.isGroupOwnedRepo,userPerm:this.props.userPerm,enableDirPrivateShare:this.props.enableDirPrivateShare,isRepoInfoBarShow:this.props.isRepoInfoBarShow,usedRepoTags:this.props.usedRepoTags,updateUsedRepoTags:this.props.updateUsedRepoTags,isDirentListLoading:this.props.isDirentListLoading,direntList:this.props.direntList,fullDirentList:this.props.fullDirentList,sortBy:this.props.sortBy,sortOrder:this.props.sortOrder,sortItems:this.props.sortItems,onAddFolder:this.props.onAddFolder,onAddFile:this.props.onAddFile,onItemClick:this.props.onItemClick,onItemSelected:this.props.onItemSelected,onItemDelete:this.props.onItemDelete,onItemRename:this.props.onItemRename,onItemMove:this.props.onItemMove,onItemCopy:this.props.onItemCopy,onItemConvert:this.props.onItemConvert,onDirentClick:this.props.onDirentClick,updateDirent:this.props.updateDirent,isAllItemSelected:this.props.isAllItemSelected,onAllItemSelected:this.props.onAllItemSelected,selectedDirentList:this.props.selectedDirentList,onItemsMove:this.props.onItemsMove,onItemsCopy:this.props.onItemsCopy,onItemsDelete:this.props.onItemsDelete,repoTags:this.props.repoTags,onFileTagChanged:this.props.onFileTagChanged,showDirentDetail:this.props.showDirentDetail,getMenuContainerSize:this.getMenuContainerSize,eventBus:this.props.eventBus}),t===tt.nj&&(0,m.jsx)(xa,{path:this.props.path,repoID:this.props.repoID,currentRepoInfo:this.props.currentRepoInfo,isGroupOwnedRepo:this.props.isGroupOwnedRepo,userPerm:this.props.userPerm,enableDirPrivateShare:this.props.enableDirPrivateShare,onRenameNode:this.props.onRenameNode,isRepoInfoBarShow:this.props.isRepoInfoBarShow,repoTags:this.props.repoTags,usedRepoTags:this.props.usedRepoTags,updateUsedRepoTags:this.props.updateUsedRepoTags,isDirentListLoading:this.props.isDirentListLoading,direntList:this.props.direntList,fullDirentList:this.props.fullDirentList,selectedDirentList:this.props.selectedDirentList,onSelectedDirentListUpdate:this.props.onSelectedDirentListUpdate,onAddFile:this.props.onAddFile,onItemClick:this.props.onItemClick,onItemDelete:this.props.onItemDelete,onItemMove:this.props.onItemMove,onItemCopy:this.props.onItemCopy,onItemConvert:this.props.onItemConvert,onItemsMove:this.props.onItemsMove,onItemsCopy:this.props.onItemsCopy,onItemsDelete:this.props.onItemsDelete,updateDirent:this.props.updateDirent,onAddFolder:this.props.onAddFolder,showDirentDetail:this.props.showDirentDetail,onGridItemClick:this.props.onDirentClick,isDirentDetailShow:this.props.isDirentDetailShow,onItemRename:this.props.onItemRename,onFileTagChanged:this.props.onFileTagChanged,getMenuContainerSize:this.getMenuContainerSize,eventBus:this.props.eventBus}),this.props.isViewFile&&(0,m.jsx)(jo,{repoID:this.props.repoID,filePath:this.props.getMarkDownFilePath(),fileName:this.props.getMarkDownFileName(),openMarkdownFile:this.props.openMarkdownFile,isFileLoading:this.props.isFileLoading,content:this.props.content,lastModified:this.props.lastModified,latestContributor:this.props.latestContributor,onLinkClick:this.props.onLinkClick,onCloseMarkdownViewDialog:this.props.onCloseMarkdownViewDialog})]})]})}}])}(s.Component),_a=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onMoveToggle=function(){n.setState({isMoveDialogShow:!n.state.isMoveDialogShow})},n.onCopyToggle=function(){n.setState({isCopyDialogShow:!n.state.isCopyDialogShow})},n.onItemsDelete=function(){n.props.onItemsDelete()},n.onItemsDownload=function(){var e=n.props,t=e.path,r=e.repoID,o=e.selectedDirentList;if(o.length){if(1===o.length&&!o[0].isDir()){var a=h.Aq.joinPath(t,o[0].name),i=Fo.A.getUrl({type:"download_file_url",repoID:r,filePath:a});return void(location.href=i)}if(f.B$){var s=n.props.selectedDirentList.map((function(e){return e.name}));S.e.zipDownload(r,t,s).then((function(e){var t=e.data.zip_token;location.href="".concat(f.IX,"zip/").concat(t)})).catch((function(e){var t=h.Aq.getErrorMsg(e);n.setState({isLoading:!1,errorMsg:t})}))}else n.setState({isZipDialogOpen:!0})}},n.closeZipDialog=function(){n.setState({isZipDialogOpen:!1})},n.checkDuplicatedName=function(e){return h.Aq.checkDuplicatedNameInList(n.props.direntList,e)},n.onItemRename=function(e){var t=n.props.selectedDirentList[0];n.props.onItemRename(t,e)},n.onPermissionItem=function(){n.setState({showLibContentViewDialogs:!n.state.showLibContentViewDialogs,isPermissionDialogOpen:!n.state.isPermissionDialogOpen})},n.onStartRevise=function(e){var t=n.props.repoID,r=n.getDirentPath(e);S.e.sdocStartRevise(t,r).then((function(e){var n=f.Yc+"lib/"+t+"/file"+h.Aq.encodePath(e.data.file_path);window.open(n)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.getDirentMenuList=function(e){var t=n.props.isRepoOwner,r=n.props.currentRepoInfo,o=h.Aq.getDirentOperationList(t,r,e,!0),a=["Move","Copy","Delete","Download"];return o="dir"==e.type?o.filter((function(e,t){return-1==a.indexOf(e.key)&&"Divider"!=e})):o.filter((function(e,t){return-1==a.indexOf(e.key)}))},n.onMenuItemClick=function(e){var t=n.props.selectedDirentList[0];switch(e){case"Share":n.setState({showLibContentViewDialogs:!0,showShareDialog:!0});break;case"Rename":n.setState({showLibContentViewDialogs:!0,isRenameDialogOpen:!0});break;case"Permission":n.onPermissionItem();break;case"Tags":n.listFileTags(t);break;case"Lock":n.lockFile(t);break;case"Unlock":n.unlockFile(t);break;case"History":n.onHistory(t);break;case"Access Log":n.toggleFileAccessLogDialog();break;case"Properties":n.props.showDirentDetail("info");break;case"Open via Client":n.onOpenViaClient(t)}},n.lockFile=function(e){var t=n.getDirentPath(e);S.e.lockfile(n.props.repoID,t).then((function(t){t.data.is_locked&&(n.props.updateDirent(e,"is_locked",!0),n.props.updateDirent(e,"locked_by_me",!0),n.props.updateDirent(e,"lock_owner_name",f.UU),n.props.unSelectDirent())})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.unlockFile=function(e){var t=n.getDirentPath(e);S.e.unlockfile(n.props.repoID,t).then((function(t){t.data.is_locked||(n.props.updateDirent(e,"is_locked",!1),n.props.updateDirent(e,"locked_by_me",!1),n.props.updateDirent(e,"lock_owner_name",""),n.props.unSelectDirent())})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.onOpenViaClient=function(e){var t=n.getDirentPath(e),r=Fo.A.getUrl({type:"open_via_client",repoID:n.props.repoID,filePath:t});location.href=r},n.onHistory=function(e){var t=n.getDirentPath(e),r=Fo.A.getUrl({type:"file_revisions",repoID:n.props.repoID,filePath:t});location.href=r},n.toggleFileAccessLogDialog=function(){n.setState({isFileAccessLogDialogOpen:!n.state.isFileAccessLogDialogOpen,showLibContentViewDialogs:!n.state.isFileAccessLogDialogOpen})},n.toggleCancel=function(){n.setState({showLibContentViewDialogs:!1,showShareDialog:!1,showEditFileTagDialog:!1,isRenameDialogOpen:!1,isPermissionDialogOpen:!1})},n.listFileTags=function(e){var t=n.getDirentPath(e);S.e.listFileTags(n.props.repoID,t).then((function(e){for(var t=e.data.file_tags,r=0,o=t.length;r<o;r++)t[r].id=t[r].file_tag_id;n.setState({fileTagList:t,showLibContentViewDialogs:!0,showEditFileTagDialog:!0})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.onMenuFileTagChanged=function(){n.listFileTags(n.props.selectedDirentList[0]);for(var e=n.props.selectedDirentList.length,t=0;t<e;t++){var r=n.props.selectedDirentList[t],o=n.getDirentPath(r);n.props.onFilesTagChanged(r,o)}},n.getDirentPath=function(e){if(e)return h.Aq.joinPath(n.props.path,e.name)},n.state={isZipDialogOpen:!1,isFileAccessLogDialogOpen:!1,isMoveDialogShow:!1,isCopyDialogShow:!1,isMultipleOperation:!0,showLibContentViewDialogs:!1,showShareDialog:!1,showEditFileTagDialog:!1,fileTagList:[],multiFileTagList:[],isRenameDialogOpen:!1,isPermissionDialogOpen:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.repoID,n=e.repoTags,r=e.userPerm,o=e.selectedDirentList,a=o[0],i=o.length,l=this.getDirentPath(a),c=h.Aq.getUserPermission(r),u=c.isCustomPermission,d=c.customPermission,p=!1,g=!1,v=!1,y=!1;switch(r){case"rw":case"admin":p=!0,g=!0,v=!0,y=!0;break;case"cloud-edit":p=!0,g=!0,v=!0;break;case"r":g=!0,y=!0}if(u){var C=d.permission;p=C.modify,g=C.copy,y=C.download,v=C.delete}return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsxs)("div",{className:"selected-dirents-toolbar",children:[(0,m.jsxs)("span",{className:"cur-view-path-btn px-2",onClick:this.props.unSelectDirent,children:[(0,m.jsx)("span",{className:"sf3-font-x-01 sf3-font mr-2","aria-label":(0,f.AP)("Unselect"),title:(0,f.AP)("Unselect")}),(0,m.jsxs)("span",{children:[i," ",(0,f.AP)("selected")]})]}),p&&(0,m.jsx)("span",{className:"cur-view-path-btn",onClick:this.onMoveToggle,children:(0,m.jsx)("span",{className:"sf3-font-move1 sf3-font","aria-label":(0,f.AP)("Move"),title:(0,f.AP)("Move")})}),g&&(0,m.jsx)("span",{className:"cur-view-path-btn",onClick:this.onCopyToggle,children:(0,m.jsx)("span",{className:"sf3-font-copy1 sf3-font","aria-label":(0,f.AP)("Copy"),title:(0,f.AP)("Copy")})}),v&&(0,m.jsx)("span",{className:"cur-view-path-btn",onClick:this.onItemsDelete,children:(0,m.jsx)("span",{className:"sf3-font-delete1 sf3-font","aria-label":(0,f.AP)("Delete"),title:(0,f.AP)("Delete")})}),y&&(0,m.jsx)("span",{className:"cur-view-path-btn",onClick:this.onItemsDownload,children:(0,m.jsx)("span",{className:"sf3-font-download1 sf3-font","aria-label":(0,f.AP)("Download"),title:(0,f.AP)("Download")})}),1===i&&(0,m.jsx)(vo.A,{item:this.props.selectedDirentList[0],toggleClass:"cur-view-path-btn sf3-font-more-vertical sf3-font",onMenuItemClick:this.onMenuItemClick,getMenuList:this.getDirentMenuList})]}),this.state.isMoveDialogShow&&(0,m.jsx)(ho,{path:this.props.path,repoID:this.props.repoID,repoEncrypted:this.props.repoEncrypted,isMultipleOperation:this.state.isMultipleOperation,selectedDirentList:this.props.selectedDirentList,onItemsMove:this.props.onItemsMove,onCancelMove:this.onMoveToggle}),this.state.isCopyDialogShow&&(0,m.jsx)(fo,{path:this.props.path,repoID:this.props.repoID,repoEncrypted:this.props.repoEncrypted,selectedDirentList:this.props.selectedDirentList,isMultipleOperation:this.state.isMultipleOperation,onItemsCopy:this.props.onItemsCopy,onCancelCopy:this.onCopyToggle}),this.state.isZipDialogOpen&&(0,m.jsx)(te.A,{children:(0,m.jsx)(Uo.A,{repoID:this.props.repoID,path:this.props.path,target:this.props.selectedDirentList.map((function(e){return e.name})),toggleDialog:this.closeZipDialog})}),this.state.showLibContentViewDialogs&&(0,m.jsxs)(s.Fragment,{children:[this.state.showShareDialog&&(0,m.jsx)(te.A,{children:(0,m.jsx)($e.A,{itemType:a.type,itemName:a.name,itemPath:l,userPerm:a.permission,repoID:t,repoEncrypted:this.props.repoEncrypted,enableDirPrivateShare:this.props.enableDirPrivateShare,isGroupOwnedRepo:this.props.isGroupOwnedRepo,toggleDialog:this.toggleCancel})}),this.state.isRenameDialogOpen&&(0,m.jsx)(te.A,{children:(0,m.jsx)(ua,{dirent:a,onRename:this.onItemRename,checkDuplicatedName:this.checkDuplicatedName,toggleCancel:this.toggleCancel})}),this.state.isPermissionDialogOpen&&(0,m.jsx)(te.A,{children:(0,m.jsx)(Zt,{toggleDialog:this.toggleCancel,repoID:t,folderPath:l,folderName:a.name,isDepartmentRepo:this.props.isGroupOwnedRepo})}),this.state.showEditFileTagDialog&&(0,m.jsx)(te.A,{children:(0,m.jsx)(Vo,{repoID:t,repoTags:n,filePath:l,fileTagList:this.state.fileTagList,toggleCancel:this.toggleCancel,onFileTagChanged:this.onMenuFileTagChanged})}),this.state.isFileAccessLogDialogOpen&&(0,m.jsx)(te.A,{children:(0,m.jsx)(Wo,{repoID:this.props.repoID,filePath:l,fileName:a.name,toggleDialog:this.toggleFileAccessLogDialog})})]})]})}}])}(s.Component),wa=_a,Sa=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onPathClick=function(e){n.props.onMainNavBarClick(e)},n.onItemClick=function(e){n.props.onItemClick(e)},n.onDirentClick=function(e,t){n.setState({currentDirent:e&&e.isActive?null:e}),n.props.onDirentClick(e,t)},n.onItemSelected=function(e){n.setState({currentDirent:e&&e.isActive?null:e}),n.props.onItemSelected(e)},n.onItemDelete=function(e){n.checkCurrentDirent(e),n.props.onItemDelete(e)},n.onItemMove=function(e,t,r,o){n.checkCurrentDirent(t),n.props.onItemMove(e,t,r,o)},n.checkCurrentDirent=function(e){var t=n.state.currentDirent;t&&e.name===t.name&&n.setState({currentDirent:null})},n.onItemsScroll=function(e){var t=e.target;0!==t.scrollTop&&t.scrollTop+t.clientHeight+1>=t.scrollHeight&&n.props.onListContainerScroll()},n.state={currentDirent:null,hasSelectedFile:!1},n.errMessage=(0,m.jsx)("div",{className:"message err-tip",children:(0,f.AP)("Folder does not exist.")}),n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){(e.path===this.props.path&&e.updateDetail===this.props.updateDetail||this.setState({currentDirent:null}),this.state.hasSelectedFile)||e.isDirentSelected&&this.setState({hasSelectedFile:!0})}},{key:"render",value:function(){var e=h.Aq.isDesktop(),t=this.props,n=t.path,r=t.repoID,o=t.usedRepoTags,a=t.isDirentSelected,i=this.state.hasSelectedFile,s=!1;return"/"===n&&e&&0!==o.length&&(s=!0),(0,m.jsxs)("div",{className:"cur-view-container",children:["read-only"===this.props.currentRepoInfo.status&&(0,m.jsx)("div",{className:"readonly-tip-message",children:(0,f.AP)("This library has been set to read-only by admin and cannot be updated.")}),(0,m.jsxs)("div",{className:"cur-view-path lib-cur-view-path",children:[(0,m.jsx)("div",{className:w()("cur-view-path-left",{"w-100":!e,"animation-children":i}),children:a?(0,m.jsx)(wa,{repoID:this.props.repoID,path:this.props.path,userPerm:this.props.userPerm,repoEncrypted:this.props.repoEncrypted,repoTags:this.props.repoTags,selectedDirentList:this.props.selectedDirentList,direntList:this.props.direntList,onItemsMove:this.props.onItemsMove,onItemsCopy:this.props.onItemsCopy,onItemsDelete:this.props.onItemsDelete,onItemRename:this.props.onItemRename,isRepoOwner:this.props.isRepoOwner,currentRepoInfo:this.props.currentRepoInfo,enableDirPrivateShare:this.props.enableDirPrivateShare,updateDirent:this.props.updateDirent,unSelectDirent:this.props.unSelectDirent,onFilesTagChanged:this.props.onFilesTagChanged,showShareBtn:this.props.showShareBtn,isGroupOwnedRepo:this.props.isGroupOwnedRepo,showDirentDetail:this.props.showDirentDetail,currentMode:this.props.currentMode,switchViewMode:this.props.switchViewMode}):(0,m.jsx)(cr,{currentRepoInfo:this.props.currentRepoInfo,repoID:r,repoName:this.props.currentRepoInfo.repo_name,repoEncrypted:this.props.repoEncrypted,isGroupOwnedRepo:this.props.isGroupOwnedRepo,pathPrefix:this.props.pathPrefix,currentPath:this.props.path,userPerm:this.props.userPerm,onTabNavClick:this.props.onTabNavClick,onPathClick:this.onPathClick,fileTags:this.props.fileTags,direntList:this.props.direntList,sortBy:this.props.sortBy,sortOrder:this.props.sortOrder,sortItems:this.props.sortItems,toggleTreePanel:this.props.toggleTreePanel,enableDirPrivateShare:this.props.enableDirPrivateShare,showShareBtn:this.props.showShareBtn,onAddFolder:this.props.onAddFolder,onAddFile:this.props.onAddFile,onUploadFile:this.props.onUploadFile,onUploadFolder:this.props.onUploadFolder,fullDirentList:this.props.fullDirentList,filePermission:this.props.filePermission,onFileTagChanged:this.props.onToolbarFileTagChanged,repoTags:this.props.repoTags,onItemMove:this.props.onItemMove,isDesktop:e,loadDirentList:this.props.loadDirentList})}),e&&(0,m.jsx)("div",{className:"cur-view-path-right py-1",children:(0,m.jsx)(Zr,{repoID:r,repoName:this.props.currentRepoInfo.repo_name,userPerm:this.props.userPerm,currentPath:n,updateUsedRepoTags:this.props.updateUsedRepoTags,onDeleteRepoTag:this.props.onDeleteRepoTag,currentMode:this.props.currentMode,switchViewMode:this.props.switchViewMode,isCustomPermission:this.props.isCustomPermission,sortBy:this.props.sortBy,sortOrder:this.props.sortOrder,sortItems:this.props.sortItems,viewId:this.props.viewId,viewType:this.props.viewType})})]}),(0,m.jsxs)("div",{className:"cur-view-content lib-content-container",onScroll:this.onItemsScroll,children:[!this.props.pathExist&&this.errMessage,this.props.pathExist&&(0,m.jsx)(ba,{isSidePanelFolded:this.props.isSidePanelFolded,isTreePanelShown:this.props.isTreePanelShown,currentMode:this.props.currentMode,currentDirent:this.props.currentDirent,path:this.props.path,repoID:r,currentRepoInfo:this.props.currentRepoInfo,isGroupOwnedRepo:this.props.isGroupOwnedRepo,userPerm:this.props.userPerm,enableDirPrivateShare:this.props.enableDirPrivateShare,isTreeDataLoading:this.props.isTreeDataLoading,treeData:this.props.treeData,currentNode:this.props.currentNode,onNodeClick:this.props.onNodeClick,onNodeCollapse:this.props.onNodeCollapse,onNodeExpanded:this.props.onNodeExpanded,onAddFolderNode:this.props.onAddFolder,onAddFileNode:this.props.onAddFile,onRenameNode:this.props.onRenameNode,onDeleteNode:this.props.onDeleteNode,isViewFile:this.props.isViewFile,isFileLoading:this.props.isFileLoading,filePermission:this.props.filePermission,content:this.props.content,viewId:this.props.viewId,lastModified:this.props.lastModified,latestContributor:this.props.latestContributor,onLinkClick:this.props.onLinkClick,isRepoInfoBarShow:s,repoTags:this.props.repoTags,usedRepoTags:this.props.usedRepoTags,updateUsedRepoTags:this.props.updateUsedRepoTags,isDirentListLoading:this.props.isDirentListLoading,direntList:this.props.direntList,fullDirentList:this.props.fullDirentList,sortBy:this.props.sortBy,sortOrder:this.props.sortOrder,sortItems:this.props.sortItems,onAddFolder:this.props.onAddFolder,onAddFile:this.props.onAddFile,onItemClick:this.onItemClick,onItemSelected:this.onItemSelected,onItemDelete:this.onItemDelete,onItemRename:this.props.onItemRename,onItemMove:this.onItemMove,onItemCopy:this.props.onItemCopy,onItemConvert:this.props.onItemConvert,onDirentClick:this.onDirentClick,updateDirent:this.props.updateDirent,isAllItemSelected:this.props.isAllDirentSelected,onAllItemSelected:this.props.onAllDirentSelected,selectedDirentList:this.props.selectedDirentList,onSelectedDirentListUpdate:this.props.onSelectedDirentListUpdate,onItemsMove:this.props.onItemsMove,onItemsCopy:this.props.onItemsCopy,onItemsDelete:this.props.onItemsDelete,onFileTagChanged:this.props.onFileTagChanged,showDirentDetail:this.props.showDirentDetail,onItemsScroll:this.onItemsScroll,isDirentDetailShow:this.props.isDirentDetailShow,eventBus:this.props.eventBus,onCloseMarkdownViewDialog:this.props.onCloseMarkdownViewDialog,getMarkDownFilePath:this.props.getMarkDownFilePath,getMarkDownFileName:this.props.getMarkDownFileName,openMarkdownFile:this.props.openMarkdownFile}),this.props.isDirentDetailShow&&(0,m.jsx)(so,{path:n,repoID:r,currentRepoInfo:this.props.currentRepoInfo,dirent:this.state.currentDirent,repoTags:this.props.repoTags,fileTags:this.props.isViewFile?this.props.fileTags:[],onFileTagChanged:this.props.onFileTagChanged,onClose:this.props.closeDirentDetail})]})]})}}])}(s.Component),Da=n(68238),Ea=n.n(Da),ka="uploading",Ma="error",Ia="isSaving",Na="uploaded",Pa=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onUploadCancel=function(e){e.preventDefault(),n.props.onUploadCancel(n.props.resumableFile)},n.onUploadRetry=function(e){e.preventDefault(),n.props.onUploadRetry(n.props.resumableFile)},n.formatFileSize=function(e){return"number"!==typeof e?"":e>=1e9?(e/1e9).toFixed(1)+" G":e>=1e6?(e/1e6).toFixed(1)+" M":e>=1e3?(e/1e3).toFixed(1)+" K":e.toFixed(1)+" B"},n.state={uploadState:ka},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.resumableFile,n=ka;t.error?n=Ma:(0!==t.remainingTime||t.isSaved||(n=Ia),t.isSaved&&(n=Na)),this.setState({uploadState:n})}},{key:"render",value:function(){var e=this.props.resumableFile,t=Math.round(100*e.progress()),n=e.error;return(0,m.jsxs)("tr",{className:"file-upload-item",children:[(0,m.jsx)("td",{className:"upload-name",children:(0,m.jsx)("div",{className:"ellipsis",children:e.newFileName})}),(0,m.jsx)("td",{children:(0,m.jsx)("span",{className:"file-size",children:this.formatFileSize(e.size)})}),(0,m.jsxs)("td",{className:"upload-progress",children:[(this.state.uploadState===ka||this.state.uploadState===Ia)&&(0,m.jsxs)(s.Fragment,{children:[e.size>=1e8&&(0,m.jsxs)(s.Fragment,{children:[e.isUploading()&&(0,m.jsxs)("div",{className:"progress-container",children:[(0,m.jsx)("div",{className:"progress",children:(0,m.jsx)("div",{className:"progress-bar",role:"progressbar",style:{width:"".concat(t,"%")},"aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"100"})}),-1===e.remainingTime&&(0,m.jsx)("div",{className:"progress-text",children:(0,f.AP)("Preparing to upload...")}),e.remainingTime>0&&(0,m.jsxs)("div",{className:"progress-text",children:[(0,f.AP)("Remaining")," ",h.Aq.formatTime(e.remainingTime)]}),0===e.remainingTime&&(0,m.jsx)("div",{className:"progress-text",children:(0,f.AP)("Saving...")})]}),!e.isUploading()&&(0,m.jsx)("div",{className:"progress-container d-flex align-items-center",children:(0,m.jsx)("div",{className:"progress",children:(0,m.jsx)("div",{className:"progress-bar",role:"progressbar",style:{width:"".concat(t,"%")},"aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"100"})})})]}),e.size<1e8&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:"progress-container d-flex align-items-center",children:(0,m.jsx)("div",{className:"progress",children:(0,m.jsx)("div",{className:"progress-bar",role:"progressbar",style:{width:"".concat(t,"%")},"aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"100"})})}),this.state.uploadState===ka&&(0,m.jsxs)(m.Fragment,{children:[0==t&&(0,m.jsx)("p",{className:"progress-text mb-0",children:(0,f.AP)("Waiting...")}),t>0&&(0,m.jsx)("p",{className:"progress-text mb-0",children:"".concat((0,f.AP)("Uploading...")," ").concat(t,"%")})]}),this.state.uploadState===Ia&&(0,m.jsx)("p",{className:"progress-text mb-0",children:(0,f.AP)("Saving...")})]})]}),this.state.uploadState===Na&&(0,m.jsxs)("div",{className:"d-flex align-items-center",children:[(0,m.jsx)("span",{className:"upload-success-icon sf2-icon-tick mr-2"}),(0,m.jsx)("span",{className:"upload-success-msg",children:(0,f.AP)("Uploaded")})]}),this.state.uploadState===Ma&&(0,m.jsxs)("div",{className:"d-flex align-items-center",children:[(0,m.jsx)("span",{className:"upload-failure-icon sf3-font sf3-font-info mr-2"}),(0,m.jsx)("span",{className:"upload-failure-msg",dangerouslySetInnerHTML:{__html:n}})]})]}),(0,m.jsx)("td",{className:"upload-operation",children:(0,m.jsxs)(s.Fragment,{children:[this.state.uploadState===ka&&(0,m.jsx)("a",{href:"#",onClick:this.onUploadCancel,role:"button",children:(0,f.AP)("Cancel")}),this.state.uploadState===Ma&&(0,m.jsx)("a",{href:"#",onClick:this.onUploadRetry,role:"button",children:(0,f.AP)("Retry")})]})})]})}}])}(s.Component),Ta=function(e){function t(){return(0,r.A)(this,t),(0,a.A)(this,t,arguments)}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.file;return(0,m.jsxs)("tr",{className:"file-upload-item",children:[(0,m.jsx)("td",{className:"upload-name",children:(0,m.jsx)("div",{className:"ellipsis",title:e.name,children:e.name})}),(0,m.jsx)("td",{children:h.Aq.bytesToSize(e.size)}),(0,m.jsx)("td",{children:(0,m.jsxs)("div",{className:"d-flex align-items-center",children:[(0,m.jsx)("span",{className:"upload-failure-icon sf3-font sf3-font-info mr-2"}),(0,m.jsx)("span",{className:"upload-failure-msg",children:(0,f.AP)("File too large")})]})}),(0,m.jsx)("td",{})]})}}])}(s.Component),Oa=Ta,ja=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onCancelAllUploading=function(){n.props.onCancelAllUploading()},n.onMinimizeUpload=function(e){e.nativeEvent.stopImmediatePropagation(),n.setState({isMinimized:!n.state.isMinimized})},n.onCloseUpload=function(e){e.nativeEvent.stopImmediatePropagation(),n.props.onCloseUploadDialog()},n.state={isMinimized:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e,t=this,n=this.props,r=n.totalProgress,o=n.retryFileList,a=n.uploadBitrate,i=n.uploadFileList,s=n.forbidUploadFileList,l=n.isUploading,c=(0,f.AP)("{uploaded_files_num}/{all_files_num} Files").replace("{uploaded_files_num}",i.filter((function(e){return e.isSaved})).length).replace("{all_files_num}",i.length);if(!l){var u=i.filter((function(e){return e.error})).length+s.length;u>0&&(e=(0,f.AP)("{failed_files_num} file(s) failed to upload").replace("{failed_files_num}",u))}return(0,m.jsxs)("div",{className:"uploader-list-view mw-100",style:{height:this.state.isMinimized?document.querySelector(".uploader-list-header").offsetHeight:"20rem"},children:[(0,m.jsxs)("div",{className:"uploader-list-header flex-shrink-0",children:[(0,m.jsx)("div",{children:l?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("span",{children:(0,f.AP)("File Uploading...")}),(0,m.jsx)("span",{className:"ml-2",children:"".concat(r,"% (").concat(h.Aq.formatBitRate(a),")")}),(0,m.jsx)("div",{className:"progress",children:(0,m.jsx)("div",{className:"progress-bar",role:"progressbar",style:{width:"".concat(r,"%")},"aria-valuenow":r,"aria-valuemin":"0","aria-valuemax":"100"})})]}):(0,m.jsx)(m.Fragment,{children:e?(0,m.jsx)("p",{className:"m-0 error",children:e}):(0,m.jsx)("p",{className:"m-0",children:(0,f.AP)("All files uploaded")})})}),(0,m.jsxs)("div",{className:"upload-dialog-op-container",children:[(0,m.jsx)("span",{className:"sf2-icon-minus upload-dialog-op",onClick:this.onMinimizeUpload}),!l&&(0,m.jsx)("span",{className:"sf2-icon-x1 upload-dialog-op",onClick:this.onCloseUpload})]})]}),(0,m.jsxs)("div",{className:"uploader-list-content",children:[(0,m.jsxs)("div",{className:"d-flex justify-content-between align-items-center border-bottom uploader-content-bar",children:[i.length>0&&(0,m.jsx)("span",{children:c}),(0,m.jsxs)("div",{className:"ml-auto",children:[(0,m.jsx)("button",{className:"btn btn-lg border-0 background-transparent px-0",onClick:this.props.onUploadRetryAll,disabled:0==o.length,children:(0,f.AP)("Retry All")}),(0,m.jsx)("button",{className:"btn btn-lg border-0 background-transparent px-0 ml-3",onClick:this.props.onCancelAllUploading,disabled:!l,children:(0,f.AP)("Cancel All")})]})]}),(0,m.jsxs)("table",{className:"table-thead-hidden",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"40%",children:(0,f.AP)("name")}),(0,m.jsx)("th",{width:"15%",children:(0,f.AP)("size")}),(0,m.jsx)("th",{width:"30%",children:(0,f.AP)("progress")}),(0,m.jsx)("th",{width:"15%",children:(0,f.AP)("state")})]})}),(0,m.jsxs)("tbody",{children:[this.props.forbidUploadFileList.map((function(e,t){return(0,m.jsx)(Oa,{file:e},t)})),this.props.uploadFileList.map((function(e,n){return(0,m.jsx)(Pa,{resumableFile:e,onUploadCancel:t.props.onUploadCancel,onUploadRetry:t.props.onUploadRetry},n)}))]})]})]})]})}}])}(s.Component),Ra=function(e){function t(){var e;(0,r.A)(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(e=(0,a.A)(this,t,[].concat(o))).toggle=function(t){t.nativeEvent.stopImmediatePropagation(),e.props.cancelFileUpload()},e.replaceRepetitionFile=function(t){t.nativeEvent.stopImmediatePropagation(),e.props.replaceRepetitionFile()},e.uploadFile=function(t){t.nativeEvent.stopImmediatePropagation(),e.props.uploadFile()},e}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.currentResumableFile.fileName;return(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.toggle,children:[(0,m.jsx)(k.A,{toggle:this.toggle,children:(0,m.jsx)("span",{children:(0,f.AP)("Replace file {filename}?").replace("{filename}",e)})}),(0,m.jsxs)(M.A,{children:[(0,m.jsx)("p",{children:(0,f.AP)("A file with the same name already exists in this folder.")}),(0,m.jsx)("p",{children:(0,f.AP)("Replacing it will overwrite its content.")})]}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(P.A,{color:"primary",onClick:this.replaceRepetitionFile,children:(0,f.AP)("Replace")}),(0,m.jsx)(P.A,{color:"primary",onClick:this.uploadFile,children:(0,f.AP)("Don't replace")}),(0,m.jsx)(P.A,{color:"secondary",onClick:this.toggle,children:(0,f.AP)("Cancel")})]})]})}}])}(s.Component),La=Ra,Fa=(n(89183),function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).componentWillUnmount=function(){window.onbeforeunload=null,!0===n.props.dragAndDrop&&n.resumable.disableDropOnDocument()},n.onbeforeunload=function(){if(window.uploader&&window.uploader.isUploadProgressDialogShow&&100!==window.uploader.totalProgress)return""},n.bindCallbackHandler=function(){var e=n.props,t=e.minFileSizeErrorCallback,r=e.fileTypeErrorCallback;n.maxFilesErrorCallback&&(n.resumable.opts.maxFilesErrorCallback=n.maxFilesErrorCallback),t&&(n.resumable.opts.minFileSizeErrorCallback=n.props.minFileSizeErrorCallback),n.maxFileSizeErrorCallback&&(n.resumable.opts.maxFileSizeErrorCallback=n.maxFileSizeErrorCallback),r&&(n.resumable.opts.fileTypeErrorCallback=n.props.fileTypeErrorCallback)},n.bindEventHandler=function(){n.resumable.on("chunkingComplete",n.onChunkingComplete.bind(n)),n.resumable.on("fileAdded",n.onFileAdded.bind(n)),n.resumable.on("filesAddedComplete",n.filesAddedComplete.bind(n)),n.resumable.on("fileProgress",n.onFileProgress.bind(n)),n.resumable.on("fileSuccess",n.onFileUploadSuccess.bind(n)),n.resumable.on("progress",n.onProgress.bind(n)),n.resumable.on("complete",n.onComplete.bind(n)),n.resumable.on("pause",n.onPause.bind(n)),n.resumable.on("fileRetry",n.onFileRetry.bind(n)),n.resumable.on("fileError",n.onFileError.bind(n)),n.resumable.on("error",n.onError.bind(n)),n.resumable.on("beforeCancel",n.onBeforeCancel.bind(n)),n.resumable.on("cancel",n.onCancel.bind(n)),n.resumable.on("dragstart",n.onDragStart.bind(n))},n.maxFilesErrorCallback=function(e,t){var n=f.YX,r=(0,f.AP)("Please upload no more than {maxFiles} files at a time.");r=r.replace("{maxFiles}",n),E.A.danger(r)},n.maxFileSizeErrorCallback=function(e){var t=n.state.forbidUploadFileList;t.push(e),n.setState({forbidUploadFileList:t})},n.onChunkingComplete=function(e){var t="/"===n.props.path?"/":n.props.path+"/",r=e.fileName,o=e.relativePath,a=r===o;if(e.formData={},a)e.formData={parent_dir:t};else{var i=o.slice(0,o.lastIndexOf("/")+1);e.formData={parent_dir:t,relative_path:i}}},n.onFileAdded=function(e,t){var r=n.props.isCustomPermission;if(e.fileName===e.relativePath&&1===t.length){var o=!1;if(!r)for(var a=n.props.direntList,i=0;i<a.length;i++)if("file"===a[i].type&&a[i].name===e.fileName){o=!0;break}if(o)n.setState({isUploadRemindDialogShow:!0,currentResumableFile:e});else{n.setUploadFileList(n.resumable.files);var s=n.props,l=s.repoID,c=s.path;S.e.getFileServerUploadLink(l,c).then((function(t){n.resumable.opts.target=t.data+"?ret-json=1",n.resumableUpload(e)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))}}else if(n.setUploadFileList(n.resumable.files),!n.isUploadLinkLoaded){n.isUploadLinkLoaded=!0;var u=n.props,d=u.repoID,p=u.path;S.e.getFileServerUploadLink(d,p).then((function(e){n.resumable.opts.target=e.data+"?ret-json=1",n.resumable.upload()})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))}},n.resumableUpload=function(e){var t=n.props,r=t.repoID,o=t.path;S.e.getFileUploadedBytes(r,o,e.fileName).then((function(t){var r=t.data.uploadedBytes,o=1024*parseInt(f.QV)*1024||1048576,a=Math.floor(r/o);e.markChunksCompleted(a),n.resumable.upload()})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.filesAddedComplete=function(e,t){n.state.forbidUploadFileList.length>0&&0===t.length&&n.setState({isUploadProgressDialogShow:!0,totalProgress:100})},n.setUploadFileList=function(){var e=n.resumable.files;n.setState({uploadFileList:e,isUploadProgressDialogShow:!0}),h.Aq.registerGlobalVariable("uploader","isUploadProgressDialogShow",!0)},n.onFileProgress=function(e){var t=n.getBitrate(),r=n.state.uploadFileList.map((function(n){if(n.uniqueIdentifier===e.uniqueIdentifier&&t){var r=8*(n.size-n.size*n.progress()),o=Math.floor(r/t);n.remainingTime=o}return n}));n.setState({uploadBitrate:t,uploadFileList:r})},n.getBitrate=function(){var e=0,t=0,r=(new Date).getTime();if(n.resumable.files.forEach((function(t){e+=t.progress()*t.size})),n.timestamp){var o=r-n.timestamp;if(o<n.bitrateInterval)return n.state.uploadBitrate;(e<n.loaded||0===n.loaded)&&(n.loaded=e),t=(e-n.loaded)*(1e3/o)*8}return n.timestamp=r,n.loaded=e,t},n.onProgress=function(){var e=Math.round(100*n.resumable.progress());n.setState({totalProgress:e}),h.Aq.registerGlobalVariable("uploader","totalProgress",e)},n.onFileUploadSuccess=function(e,t){var r=e.formData,o=(new Date).getTime()/1e3;if(t=r.replace?t:JSON.parse(t)[0],r.relative_path){var a=r.relative_path,i=a.slice(0,a.indexOf("/")),s={id:t.id,name:i,type:"dir",mtime:o};n.notifiedFolders.some((function(e){return e.name===s.name}))||(n.notifiedFolders.push(s),n.props.onFileUploadSuccess(s));var l=n.state.uploadFileList.map((function(n){return n.uniqueIdentifier===e.uniqueIdentifier&&(n.newFileName=a+t.name,n.isSaved=!0),n}));n.setState({uploadFileList:l})}else if(r.replace){var c=e.fileName,u={id:t,name:c,type:"file",mtime:o};n.props.onFileUploadSuccess(u);var d=n.state.uploadFileList.map((function(t){return t.uniqueIdentifier===e.uniqueIdentifier&&(t.newFileName=c,t.isSaved=!0),t}));n.setState({uploadFileList:d})}else{var p={id:t.id,type:"file",name:t.name,size:t.size,mtime:o};n.props.onFileUploadSuccess(p);var f=n.state.uploadFileList.map((function(n){return n.uniqueIdentifier===e.uniqueIdentifier&&(n.newFileName=t.name,n.isSaved=!0),n}));n.setState({uploadFileList:f})}},n.getFileServerErrorMessage=function(e){return{"File locked by others.":(0,f.AP)("File is locked by others."),"Invalid filename.":(0,f.AP)("Invalid filename."),"File already exists.":(0,f.AP)("File already exists."),"File size is too large.":(0,f.AP)("File size is too large."),"Out of quota.":(0,f.AP)("Out of quota."),"Internal error.":(0,f.AP)("Internal Server Error")}[e]||e},n.onFileError=function(e,t){var r="";if(t){var o=t.replace(/\n/g,"");o=JSON.parse(o),r=n.getFileServerErrorMessage(o.error)}else r=(0,f.AP)("Network error");var a=n.state.uploadFileList.map((function(t){return t.uniqueIdentifier===e.uniqueIdentifier&&(n.state.retryFileList.push(t),t.error=r),t}));n.loaded=0,n.setState({retryFileList:n.state.retryFileList,uploadFileList:a})},n.onComplete=function(){n.notifiedFolders=[],n.isUploadLinkLoaded=!1},n.onPause=function(){},n.onError=function(e){n.isUploadLinkLoaded=!1,h.Aq.registerGlobalVariable("uploader","totalProgress",100)},n.onFileRetry=function(){},n.onBeforeCancel=function(){},n.onCancel=function(){},n.setHeaders=function(e,t){var n=t.offset,r=t.getOpt("chunkSize"),o=0===e.size?1:e.size,a=0!==n?n*r:0,i=Math.min(o,(n+1)*r)-1;return o-t.endByte<r&&!t.getOpt("forceChunkSize")&&(i=o),{Accept:"application/json; text/javascript, */*; q=0.01","Content-Disposition":'attachment; filename="'+encodeURI(e.fileName)+'"',"Content-Range":"bytes "+a+"-"+i+"/"+o}},n.setQuery=function(e){return e.formData},n.generateUniqueIdentifier=function(e){var t=e.webkitRelativePath||e.relativePath||e.fileName||e.name;return ia()(t+new Date)+t},n.onClick=function(e){e.nativeEvent.stopImmediatePropagation(),e.stopPropagation()},n.onFileUpload=function(){n.uploadInput.current.removeAttribute("webkitdirectory"),n.uploadInput.current.click()},n.onFolderUpload=function(){n.uploadInput.current.setAttribute("webkitdirectory","webkitdirectory"),n.uploadInput.current.click()},n.onDragStart=function(){n.uploadInput.current.setAttribute("webkitdirectory","webkitdirectory")},n.onCloseUploadDialog=function(){n.loaded=0,n.resumable.files=[],n.isUploadLinkLoaded=!1,n.setState({isUploadProgressDialogShow:!1,uploadFileList:[],forbidUploadFileList:[]}),h.Aq.registerGlobalVariable("uploader","isUploadProgressDialogShow",!1)},n.onUploadCancel=function(e){var t=n.state.uploadFileList.filter((function(t){return t.uniqueIdentifier!==e.uniqueIdentifier||(t.cancel(),!1)}));n.resumable.isUploading()||(n.setState({totalProgress:100}),n.loaded=0),n.setState({uploadFileList:t})},n.onCancelAllUploading=function(){var e=n.state.uploadFileList.filter((function(e){return!Math.round(1!==e.progress())||(e.cancel(),!1)}));n.loaded=0,n.setState({totalProgress:100,uploadFileList:e}),n.isUploadLinkLoaded=!1},n.onUploadRetry=function(e){S.e.getFileServerUploadLink(n.props.repoID,n.props.path).then((function(t){n.resumable.opts.target=t.data+"?ret-json=1";var r=n.state.retryFileList.filter((function(t){return t.uniqueIdentifier!==e.uniqueIdentifier})),o=n.state.uploadFileList.map((function(t){return t.uniqueIdentifier===e.uniqueIdentifier&&(t.error=null,n.retryUploadFile(t)),t}));n.setState({retryFileList:r,uploadFileList:o})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.onUploadRetryAll=function(){S.e.getFileServerUploadLink(n.props.repoID,n.props.path).then((function(e){n.resumable.opts.target=e.data+"?ret-json=1",n.state.retryFileList.forEach((function(e){e.error=!1,n.retryUploadFile(e)}));var t=n.state.uploadFileList.slice(0);n.setState({retryFileList:[],uploadFileList:t})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.retryUploadFile=function(e){var t=n.props,r=t.repoID,o=t.path,a=e.fileName;if(!(e.fileName===e.relativePath)){var i=e.formData.relative_path;a=("/"===o?o+i:o+"/"+i)+a}e.bootstrap();var s=!1;e.resumableObj.on("chunkingComplete",(function(){s||S.e.getFileUploadedBytes(r,o,a).then((function(t){var n=t.data.uploadedBytes,r=1024*parseInt(f.QV)*1024||1048576,o=Math.floor(n/r);e.markChunksCompleted(o),e.resumableObj.upload()})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)})),s=!0}))},n.replaceRepetitionFile=function(){var e=n.props,t=e.repoID,r=e.path;S.e.getUpdateLink(t,r).then((function(e){n.resumable.opts.target=e.data;var t=n.resumable.files[n.resumable.files.length-1];t.formData.replace=1,t.formData.target_file=t.formData.parent_dir+t.fileName,n.setState({isUploadRemindDialogShow:!1}),n.setUploadFileList(n.resumable.files),n.resumable.upload()})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.uploadFile=function(){var e=n.resumable.files[n.resumable.files.length-1],t=n.props,r=t.repoID,o=t.path;S.e.getFileServerUploadLink(r,o).then((function(t){n.resumable.opts.target=t.data+"?ret-json=1",n.setState({isUploadRemindDialogShow:!1,isUploadProgressDialogShow:!0,uploadFileList:[].concat((0,z.A)(n.state.uploadFileList),[e])},(function(){n.resumable.upload()})),h.Aq.registerGlobalVariable("uploader","isUploadProgressDialogShow",!0)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.cancelFileUpload=function(){n.resumable.files.pop(),n.setState({isUploadRemindDialogShow:!1})},n.state={retryFileList:[],uploadFileList:[],forbidUploadFileList:[],totalProgress:0,isUploadProgressDialogShow:!1,isUploadRemindDialogShow:!1,currentResumableFile:null,uploadBitrate:0},n.uploadInput=s.createRef(),n.notifiedFolders=[],n.timestamp=null,n.loaded=0,n.bitrateInterval=500,window.onbeforeunload=n.onbeforeunload,n.isUploadLinkLoaded=!1,n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.resumable=new(Ea())({target:"",query:this.setQuery||{},fileType:this.props.filetypes,maxFiles:f.YX||void 0,maxFileSize:1e3*f.hn*1e3||void 0,testMethod:this.props.testMethod||"post",testChunks:this.props.testChunks||!1,headers:this.setHeaders||{},withCredentials:this.props.withCredentials||!1,chunkSize:1024*parseInt(f.QV)*1024||1048576,simultaneousUploads:this.props.simultaneousUploads||1,fileParameterName:this.props.fileParameterName,generateUniqueIdentifier:this.generateUniqueIdentifier,forceChunkSize:!0,maxChunkRetries:3,minFileSize:0}),this.resumable.assignBrowse(this.uploadInput.current,!0),!0===this.props.dragAndDrop&&this.resumable.enableDropOnDocument(),this.bindCallbackHandler(),this.bindEventHandler()}},{key:"render",value:function(){return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("div",{className:"file-uploader-container",children:(0,m.jsx)("div",{className:"file-uploader",children:(0,m.jsx)("input",{className:"upload-input",type:"file",ref:this.uploadInput,onClick:this.onClick,"aria-label":(0,f.AP)("Upload")})})}),this.state.isUploadRemindDialogShow&&(0,m.jsx)(La,{currentResumableFile:this.state.currentResumableFile,replaceRepetitionFile:this.replaceRepetitionFile,uploadFile:this.uploadFile,cancelFileUpload:this.cancelFileUpload}),this.state.isUploadProgressDialogShow&&(0,m.jsx)(ja,{retryFileList:this.state.retryFileList,uploadFileList:this.state.uploadFileList,forbidUploadFileList:this.state.forbidUploadFileList,totalProgress:this.state.totalProgress,uploadBitrate:this.state.uploadBitrate,onCloseUploadDialog:this.onCloseUploadDialog,onCancelAllUploading:this.onCancelAllUploading,onUploadCancel:this.onUploadCancel,onUploadRetry:this.onUploadRetry,onUploadRetryAll:this.onUploadRetryAll,isUploading:this.resumable.isUploading()})]})}}])}(s.Component));Fa.defaultProps={isCustomPermission:!1};var Ua=Fa,Ya=n(88002),Ba=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).deleteFolder=function(){n.props.deleteFolder(),n.props.toggleDialog()},n.state={sharedToUserCount:0,sharedToGroupCount:0},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.repoID,r=t.path;S.e.getRepoFolderShareInfo(n,r).then((function(t){e.setState({sharedToUserCount:t.data.shared_user_emails.length,sharedToGroupCount:t.data.shared_group_ids.length})}))}},{key:"render",value:function(){var e=this.state,t=e.sharedToUserCount,n=e.sharedToGroupCount,r=this.props,o=r.path,a=r.toggleDialog,i=h.Aq.getFileName(o),s='<span class="op-target">'+h.Aq.HTMLescape(i)+"</span>",l=(0,f.AP)("Are you sure you want to delete %s ?").replace("%s",s),c="";return(t>0||n>0)&&(c=(0,f.AP)("This folder has been shared to {user_amount} user(s) and {group_amount} group(s).").replace("{user_amount}",t).replace("{group_amount}",n)),(0,m.jsxs)(p.A,{isOpen:!0,toggle:a,children:[(0,m.jsx)(k.A,{toggle:a,children:(0,f.AP)("Delete Folder")}),(0,m.jsxs)(M.A,{children:[(0,m.jsx)("p",{dangerouslySetInnerHTML:{__html:l}}),c&&(0,m.jsx)("p",{className:"error",children:c})]}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(P.A,{color:"secondary",onClick:a,children:(0,f.AP)("Cancel")}),(0,m.jsx)(P.A,{color:"primary",onClick:this.deleteFolder,children:(0,f.AP)("Delete")})]})]})}}])}(s.Component),Ha=function(e){function t(e){var n;(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).showDirentDetail=function(e){e?n.setState({direntDetailPanelTab:e},(function(){n.setState({isDirentDetailShow:!0})})):n.setState({direntDetailPanelTab:"",isDirentDetailShow:!0})},n.toggleDirentDetail=function(){n.setState({direntDetailPanelTab:"",isDirentDetailShow:!n.state.isDirentDetailShow})},n.closeDirentDetail=function(){n.setState({isDirentDetailShow:!1,direntDetailPanelTab:""})},n.calculatePara=function(){var e=(0,Ln.A)((0,Rn.A)().mark((function e(t){var r,o,a,i;return(0,Rn.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.repoID,o=n.getPathFromLocation(r),e.prev=2,e.next=5,n.fetchRepoInfo(r);case 5:if(a=e.sent,i=a.owner_email.includes("@seafile_group"),n.setState({treeData:Wn.A.buildTree(),currentRepoInfo:a,repoName:a.repo_name,libNeedDecrypt:a.lib_need_decrypt,repoEncrypted:a.encrypted,isGroupOwnedRepo:i,path:o}),n.state.isTreePanelShown&&n.loadSidePanel(o),!a.permission.startsWith("custom-")){e.next=12;break}return e.next=12,n.setCustomPermission(r,a.permission);case 12:n.isNeedUpdateHistoryState=!1,a.lib_need_decrypt||n.loadDirData(o),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(2),n.handleError(e.t0);case 19:case"end":return e.stop()}}),e,null,[[2,16]])})));return function(t){return e.apply(this,arguments)}}(),n.getPathFromLocation=function(e){if(new URLSearchParams(window.location.search).get("view"))return"/".concat(j.AT.FILE_EXTENDED_PROPERTIES);var t=window.location.href.split("?")[0],n=(t=decodeURIComponent(t)).slice(t.indexOf(e)+e.length+1);return(n=n.slice(n.indexOf("/"))).length>1&&n.endsWith("/")&&(n=n.slice(0,-1)),n},n.fetchRepoInfo=function(){var e=(0,Ln.A)((0,Rn.A)().mark((function e(t){var n;return(0,Rn.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.e.getRepoInfo(t);case 2:return n=e.sent,e.abrupt("return",new qn.A(n.data));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.setCustomPermission=function(){var e=(0,Ln.A)((0,Rn.A)().mark((function e(t,n){var r,o;return(0,Rn.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.split("-")[1],e.next=3,S.e.getCustomPermission(t,r);case 3:o=e.sent,window.custom_permission=o.data.permission;case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),n.handleError=function(e){var t=(0,f.AP)("Please check the network.");if(e.response)switch(e.response.status){case 403:t=(0,f.AP)("Permission denied");break;case 404:t=(0,f.AP)("Library share permission not found.");break;default:t=(0,f.AP)("Error")}n.setState({isDirentListLoading:!1,errorMsg:t}),E.A.danger(t)},n.onpopstate=function(e){if(e.state&&e.state.key){if("/"===n.state.path)return;n.loadDirentList("/"),n.setState({path:"/",isViewFile:!1})}else if(e.state&&e.state.path){var t=e.state.path;if(n.state.isTreePanelShown&&h.Aq.isMarkdownFile(t))return void n.showFile(t);n.loadDirentList(t),n.setState({path:t,isViewFile:!1})}},n.onRepoUpdateEvent=function(){var e=new Date;if(!(parseFloat(e-n.lastModifyTime)/1e3<=5)){var t=n.props.repoID,r=n.state,o=r.path,a=r.dirID;n.state.isTreePanelShown?n.state.isViewFile?n.updateColumnMarkdownData(o):S.e.dirMetaData(t,o).then((function(e){e.data.id!==a&&n.loadDirentList(o)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)})):S.e.dirMetaData(t,o).then((function(e){e.data.id!==a&&n.loadDirentList(o)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))}},n.updateUsedRepoTags=function(){var e=n.props.repoID;S.e.listRepoTags(e).then((function(e){var t=[],r=[];e.data.repo_tags.forEach((function(e){var n=new Gn.A(e);t.push(n),n.fileCount>0&&r.push(n)})),n.setState({repoTags:t,usedRepoTags:r})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.updateColumnMarkdownData=function(e){var t=n.props.repoID;n.setState({path:e,isViewFile:!0}),S.e.getFileInfo(t,e).then((function(r){var o=r.data,a=o.mtime,i=o.permission,s=o.last_modifier_name;S.e.getFileDownloadLink(t,e).then((function(e){S.e.getFileContent(e.data).then((function(e){n.state.content!==e.data&&n.setState({isFileLoading:!0}),n.setState({content:e.data,filePermission:i,latestContributor:s,lastModified:K().unix(a).fromNow(),isFileLoading:!1})}))}))})).catch((function(){n.setState({isFileLoading:!1})}))},n.loadDirData=function(e){var t=n.props.repoID;Bn.watchRepo(t,n.onRepoUpdateEvent),n.updateUsedRepoTags(),h.Aq.isMarkdownFile(e)?n.handleMarkdownFile(e):n.handleNonMarkdownFile(e)},n.handleMarkdownFile=function(e){S.e.getFileInfo(n.props.repoID,e).then((function(){n.loadSidePanel(e),n.showFile(e)})).catch((function(){n.state.isTreePanelShown&&n.loadSidePanel(e),n.showDir(e)}))},n.handleNonMarkdownFile=function(e){n.state.isTreePanelShown&&n.loadSidePanel(e),e.includes(j.AT.FILE_EXTENDED_PROPERTIES)||n.showDir(e)},n.loadSidePanel=function(e){var t=n.props.repoID;"/"===e||e.includes(j.AT.FILE_EXTENDED_PROPERTIES)?S.e.listDir(t,"/").then((function(e){var t=e.data,r=t.dirent_list,o=t.user_perm,a=n.state.treeData;n.addResponseListToNode(r,a.root),n.setState({isTreeDataLoading:!1,treeData:a,userPerm:o})})).catch((function(){n.setState({isTreeDataLoading:!1})})):n.loadNodeAndParentsByPath(e)},n.showDir=function(e){var t=n.props.repoID;if(n.state.isSessionExpired||n.setState({isDirentListLoading:!0,isViewFile:!1,selectedDirentList:[]}),n.loadDirentList(e),n.resetShowLength(),n.isNeedUpdateHistoryState){var r=n.state.currentRepoInfo,o=f.Yc+"library/"+t+"/"+encodeURIComponent(r.repo_name)+h.Aq.encodePath(e);window.history.pushState({url:o,path:e},e,o)}else n.isNeedUpdateHistoryState=!0},n.openMarkDownDialog=function(e,t){n.markdownFileParentDir=e,n.markdownFileName=t;var r=h.Aq.joinPath(e,t);n.showFile(r,!0)},n.showFile=function(e,t){var r=n.props.repoID;if(n.state.isTreePanelShown&&S.e.listFileTags(r,e).then((function(e){var t=e.data.file_tags.map((function(e){return new Vn.A(e)}));n.setState({fileTags:t})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)})),n.setState({isFileLoading:!0,path:t?n.state.path:e,isViewFile:!0}),S.e.getFileInfo(r,e).then((function(t){var o=t.data,a=o.mtime,i=o.permission,s=o.last_modifier_name;S.e.getFileDownloadLink(r,e).then((function(e){S.e.getFileContent(e.data).then((function(e){n.setState({content:e.data,filePermission:i,latestContributor:s,lastModified:K().unix(a).fromNow(),isFileLoading:!1})}))}))})).catch((function(e){var t=h.Aq.getErrorMsg(e,!0);e.response&&403===e.response.status||E.A.danger(t),n.setState({isFileLoading:!1})})),!t){var o=n.state.currentRepoInfo,a=f.Yc+"library/"+r+"/"+encodeURIComponent(o.repo_name)+h.Aq.encodePath(e);window.history.pushState({url:a,path:e},e,a)}},n.showFileMetadata=function(e,t){var r=n.props.repoID,o=n.state.currentRepoInfo;n.setState({currentMode:tt.Ys,path:e,viewId:t,isDirentDetailShow:!1},(function(){setTimeout((function(){n.unsubscribeEventBus=window.sfMetadataContext.eventBus.subscribe(ea.T.OPEN_MARKDOWN_DIALOG,n.openMarkDownDialog)}),1)}));var a="".concat(f.Yc,"library/").concat(r,"/").concat(encodeURIComponent(o.repo_name),"/?view=").concat(encodeURIComponent(t));window.history.pushState({url:a,path:""},"",a)},n.hideFileMetadata=function(){n.setState({currentMode:tt.Tb,path:"",viewId:"",isDirentDetailShow:!1},(function(){n.showDir("/")}))},n.loadDirentList=function(e){n.setState({isDirentListLoading:!0,direntList:[]});var t=n.props.repoID;S.e.listDir(t,e,{with_thumbnail:!0}).then((function(r){var o=[];r.data.dirent_list.forEach((function(e){var t=new Hn.A(e);o.push(t)})),n.setState({pathExist:!0,userPerm:r.data.user_perm,isDirentListLoading:!1,direntList:h.Aq.sortDirents(o,n.state.sortBy,n.state.sortOrder),dirID:r.data.dir_id,path:e,isSessionExpired:!1}),!n.state.repoEncrypted&&o.length&&n.getThumbnails(t,e,n.state.direntList),n.state.currentRepoInfo.is_admin&&(n.foldersSharedOut?n.identifyFoldersSharedOut():(n.foldersSharedOut=[],S.e.getAllRepoFolderShareInfo(t).then((function(e){e.data.share_info_list.forEach((function(e){-1===n.foldersSharedOut.indexOf(e.path)&&n.foldersSharedOut.push(e.path)})),n.identifyFoldersSharedOut()}))))})).catch((function(e){h.Aq.getErrorMsg(e,!0),e.response&&403===e.response.status?n.setState({isDirentListLoading:!1}):n.setState({isDirentListLoading:!1,pathExist:!1})}))},n.identifyFoldersSharedOut=function(){var e=n.state,t=e.path,r=e.direntList;0!=n.foldersSharedOut.length&&(r.forEach((function(e){"dir"==e.type&&-1!==n.foldersSharedOut.indexOf(h.Aq.joinPath(t,e.name)+"/")&&(e.has_been_shared_out=!0)})),n.setState({direntList:r}))},n.onListContainerScroll=function(){var e=n.state.itemsShowLength+100;n.setState({itemsShowLength:e})},n.resetShowLength=function(){n.setState({itemsShowLength:100})},n.shouldDisplayThumbnail=function(e){return(h.Aq.imageCheck(e.name)||f.Nz&&h.Aq.videoCheck(e.name)||f.E7&&h.Aq.pdfCheck(e.name))&&!e.encoded_thumbnail_src},n.getThumbnails=function(e,t,r){var o=r.filter((function(e){return n.shouldDisplayThumbnail(e)}));if(0!=o.length){var a=n,i=o.length,s=function(n){var l=o[n],c=[t,l.name].join("/");S.e.createThumbnail(e,c,f.dq).then((function(e){l.encoded_thumbnail_src=e.data.encoded_thumbnail_src})).catch((function(e){})).then((function(){n<i-1?s(++n):a.setState({direntList:r})}))};s(0)}},n.updateMoveCopyTreeNode=function(e){var t=n.props.repoID,r=n.state.treeData.clone().getNodeByPath(e);if(!r)return!1;var o=r.children.map((function(e){return e.object})).map((function(e){return e.name}));S.e.listDir(t,e).then((function(t){t.data.dirent_list.filter((function(e){return!o.includes(e.name)})).forEach((function(t){n.addNodeToTree(t.name,e,t.type)}))})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.cancelCopyMoveDirent=function(){var e=n.state.asyncCopyMoveTaskId;S.e.cancelCopyMoveOperation(e),n.currentMoveItemName="",n.currentMoveItemPath="";var t=n.state.direntList;n.setState({direntList:t.slice(0)})},n.onMoveProgressDialogToggle=function(){100!==n.state.asyncOperationProgress&&n.cancelCopyMoveDirent(),n.setState({asyncOperationProgress:0,isCopyMoveProgressDialogShow:!1})},n.updateRecentlyUsedRepos=function(e,t){var n=JSON.parse(localStorage.getItem("recently-used-list"))||[],r=[{repo:e,path:t}].concat((0,z.A)(n.filter((function(e){return e.path!==t})))),o=new Set,a=r.filter((function(e){return!o.has(e.path)&&(o.add(e.path),!0)}));a.length>10&&r.pop(),localStorage.setItem("recently-used-list",JSON.stringify(a))},n.onMoveItems=function(e,t){var r=n.props.repoID,o=n.state.selectedDirentList,a=n.getSelectedDirentNames(),i=n.getSelectedDirentPaths();S.e.moveDir(r,e.repo_id,t,n.state.path,a).then((function(s){if(r!==e.repo_id&&n.setState({asyncCopyMoveTaskId:s.data.task_id,asyncOperatedFilesLength:o.length,asyncOperationProgress:0,asyncOperationType:"move",isCopyMoveProgressDialogShow:!0},(function(){n.getAsyncCopyMoveProgress()})),r===e.repo_id){n.state.isTreePanelShown&&n.deleteTreeNodes(i),n.moveDirents(a),n.state.isTreePanelShown&&n.updateMoveCopyTreeNode(t);var l=h.Aq.getMoveSuccessMessage(a);E.A.success(l)}n.updateRecentlyUsedRepos(e,t)})).catch((function(r){if(r.response.data.lib_need_decrypt)n.setState({libNeedDecryptWhenMove:!0,destRepoWhenCopyMove:e,destDirentPathWhenCopyMove:t});else{var o=h.Aq.getErrorMsg(r);o===(0,f.AP)("Error")&&(o=h.Aq.getCopyFailedMessage(a)),E.A.danger(o)}}))},n.onCopyItems=function(e,t){var r=n.props.repoID,o=n.state.selectedDirentList,a=n.getSelectedDirentNames();S.e.copyDir(r,e.repo_id,t,n.state.path,a).then((function(i){if(r!==e.repo_id&&n.setState({asyncCopyMoveTaskId:i.data.task_id,asyncOperatedFilesLength:o.length,asyncOperationProgress:0,asyncOperationType:"copy",isCopyMoveProgressDialogShow:!0},(function(){n.getAsyncCopyMoveProgress()})),r===e.repo_id){n.state.isTreePanelShown&&n.updateMoveCopyTreeNode(t),t===n.state.path&&n.loadDirentList(n.state.path);var s=h.Aq.getCopySuccessfulMessage(a);E.A.success(s)}})).catch((function(r){if(r.response.data.lib_need_decrypt)n.setState({libNeedDecryptWhenCopy:!0,destRepoWhenCopyMove:e,destDirentPathWhenCopyMove:t});else{var o=h.Aq.getErrorMsg(r);o===(0,f.AP)("Error")&&(o=h.Aq.getCopyFailedMessage(a)),E.A.danger(o)}}))},n.restoreDeletedDirents=function(e,t,r){var o=n.props.repoID;r.preventDefault(),E.A.closeAll(),S.e.restoreDirents(o,e,t).then((function(e){var t=e.data,r=t.success,o=t.failed;if(r.forEach((function(e){var t=h.Aq.getFileName(e.path),r=h.Aq.getDirName(e.path);e.is_dir?(n.state.isTreePanelShown&&n.addNodeToTree(t,r,"dir"),r!==n.state.path||n.state.isViewFile||n.addDirent(t,"dir")):(n.state.isTreePanelShown&&n.addNodeToTree(t,r,"file"),r!==n.state.path||n.state.isViewFile||(n.addDirent(t,"file"),h.Aq.imageCheck(t)&&n.props.eventBus.dispatch(ea.T.RESTORE_IMAGE)))})),r.length){var a=r.length>1?(0,f.AP)("Restored {name} and {n} other items"):(0,f.AP)("Restored {name}");a=a.replace("{name}",r[0].path.split("/").pop()).replace("{n}",r.length-1),E.A.success(a)}if(o.length){var i=o.length>1?(0,f.AP)("Failed to restore {name} and {n} other items"):(0,f.AP)("Failed to restore {name}");i=i.replace("{name}",o[0].path.split("/").pop()).replace("{n}",o.length-1),E.A.danger(i)}})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.onDeleteItems=function(){var e=n.props.repoID,t=n.getSelectedDirentPaths(),r=n.getSelectedDirentNames();n.setState({updateDetail:!n.state.updateDetail}),S.e.deleteMutipleDirents(e,n.state.path,r).then((function(e){n.state.isTreePanelShown&&n.deleteTreeNodes(t),n.deleteDirents(r);var o="";o=t.length>1?(o=(o=(0,f.AP)("Successfully deleted {name} and {n} other items.")).replace("{name}",r[0])).replace("{n}",r.length-1):(o=(0,f.AP)("Successfully deleted {name}.")).replace("{name}",r[0]);var a=(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("span",{children:o}),(0,m.jsx)("a",{className:"action-link p-0 ml-1",href:"#",onClick:n.restoreDeletedDirents.bind(n,e.data.commit_id,t),children:(0,f.AP)("Undo")})]});E.A.success(a,{duration:5})})).catch((function(e){var t=h.Aq.getErrorMsg(e);t===(0,f.AP)("Error")&&(t=(t=(t=(0,f.AP)("Failed to delete {name} and {n} other items.")).replace("{name}",r[0])).replace("{n}",r.length-1)),E.A.danger(t)}))},n.onAddFolder=function(e){var t=n.props.repoID;S.e.createDir(t,e).then((function(){var t=h.Aq.getFileName(e),r=h.Aq.getDirName(e);n.state.isTreePanelShown&&n.addNodeToTree(t,r,"dir"),r!==n.state.path||n.state.isViewFile||n.addDirent(t,"dir")})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.onAddFile=function(e){var t=n.props.repoID;S.e.createFile(t,e).then((function(t){var r=h.Aq.getFileName(e),o=h.Aq.getDirName(e);n.state.isTreePanelShown&&n.addNodeToTree(r,o,"file"),o!==n.state.path||n.state.isViewFile||n.addDirent(r,"file",t.data.size)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.switchViewMode=function(e){if(e!==n.state.currentMode)if("detail"!==e){We.Ay.save("seafile_view_mode",e);var t=n.state.path;if(n.state.isTreePanelShown&&n.state.isViewFile){t=h.Aq.getDirName(t),n.setState({path:t,isViewFile:!1});var r=n.state.currentRepoInfo,o=f.Yc+"library/"+r.repo_id+"/"+encodeURIComponent(r.repo_name)+h.Aq.encodePath(t);window.history.pushState({url:o,path:t},t,o)}n.state.isTreePanelShown&&n.loadSidePanel(n.state.path),n.isNeedUpdateHistoryState=!1,n.setState({currentMode:e}),n.showDir(t)}else n.toggleDirentDetail()},n.onSearchedClick=function(e){e.repo_id!==n.props.repoID&&n.openSearchedNewTab(e);var t=e.is_dir?e.path.slice(0,e.path.length-1):e.path;if(n.state.currentPath!==t)if(n.state.isTreePanelShown){for(var r=-1,o=h.Aq.getPaths(t),a=0;a<o.length;a++){var i=n.state.treeData.getNodeByPath(i);if(!i){r=a;break}}if(-1===r){var s=n.state.treeData.getNodeByPath(t);n.setState({currentNode:s})}else n.loadNodeAndParentsByPath(t);e.is_dir?n.showDir(t):h.Aq.isMarkdownFile(t)?n.showFile(t):n.openSearchedNewTab(e)}else e.is_dir?n.showDir(t):n.openSearchedNewTab(e)},n.openSearchedNewTab=function(e){var t=e.is_dir?e.path.slice(0,e.path.length-1):e.path,n=f.Yc+"lib/"+e.repo_id+"/file"+h.Aq.encodePath(t);h.Aq.isWeChat()?location.href=n:window.open("about:blank").location.href=n},n.onMainNavBarClick=function(e){if(n.resetSelected(),n.state.isTreePanelShown){var t=n.state.treeData.clone(),r=t.getNodeByPath(e);t.expandNode(r),n.setState({treeData:t,currentNode:r})}n.showDir(e)},n.onLinkClick=function(e){var t=e,r=n.props.repoID;if(h.Aq.isInternalMarkdownLink(t,r)){var o=h.Aq.getPathFromInternalMarkdownLink(t,r);n.showFile(o)}else if(h.Aq.isInternalDirLink(t,r)){var a=h.Aq.getPathFromInternalDirLink(t,r);n.showDir(a)}else window.open(t)},n.onMainPanelItemRename=function(e,t){var r=h.Aq.joinPath(n.state.path,e.name);n.renameItem(r,e.isDir(),t)},n.onMainPanelItemDelete=function(e){var t=h.Aq.joinPath(n.state.path,e.name);n.deleteItem(t,e.isDir())},n.onRenameTreeNode=function(e,t){n.renameItem(e.path,e.object.isDir(),t)},n.onDeleteTreeNode=function(e){n.deleteItem(e.path,e.object.isDir())},n.renameItem=function(e,t,r){var o=n.props.repoID;t?S.e.renameDir(o,e,r).then((function(){n.renameItemAjaxCallback(e,r)})).catch((function(t){var n=h.Aq.getErrorMsg(t);if(n===(0,f.AP)("Error")){var r=h.Aq.getFileName(e);n=(0,f.AP)("Renaming {name} failed").replace("{name}",r)}E.A.danger(n)})):S.e.renameFile(o,e,r).then((function(){n.renameItemAjaxCallback(e,r)})).catch((function(t){var n="";if((n=403==t.response.status&&t.response.data&&t.response.data.error_msg?t.response.data.error_msg:h.Aq.getErrorMsg(t))===(0,f.AP)("Error")){var r=h.Aq.getFileName(e);n=(0,f.AP)("Renaming {name} failed").replace("{name}",r)}E.A.danger(n)}))},n.toggleDeleteFolderDialog=function(){n.setState({isDeleteFolderDialogOpen:!n.state.isDeleteFolderDialogOpen})},n.deleteFolder=function(){var e=n.props.repoID,t=n.state.folderToDelete;S.e.deleteDir(e,t).then((function(e){n.deleteItemAjaxCallback(t,!0);var r=h.Aq.getFileName(t),o=(0,f.AP)("Successfully deleted {name}").replace("{name}",r),a=(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("span",{children:o}),(0,m.jsx)("a",{className:"action-link p-0 ml-1",href:"#",onClick:n.restoreDeletedDirents.bind(n,e.data.commit_id,[t]),children:(0,f.AP)("Undo")})]});E.A.success(a,{duration:5})})).catch((function(e){var n=h.Aq.getErrorMsg(e);if(n===(0,f.AP)("Error")){var r=h.Aq.getFileName(t);n=(0,f.AP)("Failed to delete {name}").replace("{name}",r)}E.A.danger(n)}))},n.onMoveItem=function(e,t,r,o){var a=n.props.repoID,i=t.name;o||(o=n.state.path);var s=h.Aq.joinPath(o,i);S.e.moveDir(a,e.repo_id,r,o,i).then((function(t){if(a!==e.repo_id&&n.setState({asyncCopyMoveTaskId:t.data.task_id,asyncOperatedFilesLength:1,asyncOperationProgress:0,asyncOperationType:"move",isCopyMoveProgressDialogShow:!0},(function(){n.currentMoveItemName=i,n.currentMoveItemPath=s,n.getAsyncCopyMoveProgress(i,s)})),n.state.isTreePanelShown&&n.deleteTreeNode(s),a===e.repo_id&&n.state.isTreePanelShown&&n.updateMoveCopyTreeNode(r),n.moveDirent(s,r),a===e.repo_id){var o=(0,f.AP)("Successfully moved {name}.");o=o.replace("{name}",i),E.A.success(o)}n.updateRecentlyUsedRepos(e,r)})).catch((function(a){if(a.response.data.lib_need_decrypt)n.setState({libNeedDecryptWhenMove:!0,destRepoWhenCopyMove:e,destDirentPathWhenCopyMove:r,copyMoveSingleItem:!0,srcDirentWhenCopyMove:t,srcNodeParentPathWhenCopyMove:o});else{var s=h.Aq.getErrorMsg(a);s===(0,f.AP)("Error")&&(s=(s=(0,f.AP)("Failed to move {name}.")).replace("{name}",i)),E.A.danger(s)}}))},n.onCopyItem=function(e,t,r,o){var a=n.props.repoID,i=t.name;o||(o=n.state.path),S.e.copyDir(a,e.repo_id,r,o,i).then((function(t){if(a!==e.repo_id&&n.setState({asyncCopyMoveTaskId:t.data.task_id,asyncOperatedFilesLength:1,asyncOperationProgress:0,asyncOperationType:"copy",isCopyMoveProgressDialogShow:!0},(function(){n.getAsyncCopyMoveProgress()})),a===e.repo_id){n.state.isTreePanelShown&&n.updateMoveCopyTreeNode(r),r===o&&n.loadDirentList(n.state.path);var s=(0,f.AP)("Successfully copied %(name)s.");s=s.replace("%(name)s",i),E.A.success(s)}})).catch((function(a){if(a.response.data.lib_need_decrypt)n.setState({libNeedDecryptWhenCopy:!0,destRepoWhenCopyMove:e,destDirentPathWhenCopyMove:r,copyMoveSingleItem:!0,srcDirentWhenCopyMove:t,srcNodeParentPathWhenCopyMove:o});else{var s=h.Aq.getErrorMsg(a);s===(0,f.AP)("Error")&&(s=(s=(0,f.AP)("Failed to copy %(name)s")).replace("%(name)s",i)),E.A.danger(s)}}))},n.onConvertItem=function(e,t){var r=h.Aq.joinPath(n.state.path,e.name),o=n.props.repoID;E.A.notifyInProgress((0,f.AP)("Converting, please wait..."),{id:"conversion"}),S.e.convertFile(o,r,t).then((function(e){var t=e.data.obj_name,r=e.data.parent_dir+"/"+t,o=h.Aq.getDirName(r);n.state.isTreePanelShown&&n.addNodeToTree(t,o,"file"),n.addDirent(t,"file",e.data.size);var a=(0,f.AP)("Successfully converted the file.");E.A.success(a,{id:"conversion"})})).catch((function(e){var t=h.Aq.getErrorMsg(e);if(t===(0,f.AP)("Error")){var n=h.Aq.getFileName(r);t=(0,f.AP)("Failed to convert {name}.").replace("{name}",n)}E.A.danger(t,{id:"conversion"})}))},n.onDirentClick=function(e,t){var r=n.state,o=r.direntList,a=r.selectedDirentList,i=r.lastSelectedIndex;if(e){var s=o.findIndex((function(t){return t.name===e.name})),l=(0,z.A)(a),c=t&&(t.ctrlKey||t.metaKey),u=t&&t.shiftKey;if(c)l.some((function(t){return t.name===e.name}))?l=l.filter((function(t){return t.name!==e.name})):l.push(e);else if(u&&null!==i){var d=o.findIndex((function(e){return e.name===l[0].name}));if(s<d){var p=o.slice(s,d+1),f=new Set(p.map((function(e){return e.name})));l=[].concat((0,z.A)(l.filter((function(e){return f.has(e.name)}))),(0,z.A)(p))}else if(s>=d&&s<i){var h=o.slice(d,s+1),m=new Set(h.map((function(e){return e.name})));l=l.filter((function(e){return m.has(e.name)}))}else{var g=Math.min(d,s),v=Math.max(d,s),y=o.slice(g,v+1),C=new Set(y.map((function(e){return e.name})));l=[].concat((0,z.A)(l.filter((function(e){return!C.has(e.name)}))),(0,z.A)(y))}}else l=[e];n.setState({direntList:o.map((function(e){return e.isSelected=l.some((function(t){return t.name===e.name})),e})),isDirentSelected:l.length>0,isAllDirentSelected:l.length===o.length,selectedDirentList:l,lastSelectedIndex:s})}else n.setState({direntList:o.map((function(e){return e.isSelected=!1,e})),isDirentSelected:!1,isAllDirentSelected:!1,selectedDirentList:[],lastSelectedIndex:null})},n.onSelectedDirentListUpdate=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;n.setState({direntList:n.state.direntList.map((function(t){return t.isSelected=e.some((function(e){return e.name===t.name})),t})),isDirentSelected:e.length>0,selectedDirentList:e,lastSelectedIndex:t})},n.onItemClick=function(e){n.resetSelected();var t=n.props.repoID,r=h.Aq.joinPath(n.state.path,e.name);if(e.isDir())n.state.isTreePanelShown&&n.loadTreeNodeByPath(r),n.showDir(r);else if(n.state.isTreePanelShown&&h.Aq.isMarkdownFile(r))n.setState({currentDirent:e}),n.showColumnMarkdownFile(r);else{var o=f.Yc+"lib/"+t+"/file"+h.Aq.encodePath(r);e.is_sdoc_revision&&e.revision_id&&(o=f.Yc+"lib/"+t+"/revisions/"+e.revision_id+"/"),h.Aq.isWeChat()?location.href=o:window.open(o)}},n.onDirentSelected=function(e){var t=n.state.direntList.map((function(t){return t.name===e.name&&(t.isSelected=!t.isSelected),t})),r=t.filter((function(e){return e.isSelected}));r.length?(n.setState({isDirentSelected:!0}),r.length===t.length?n.setState({isAllDirentSelected:!0,direntList:t,selectedDirentList:r}):n.setState({isAllDirentSelected:!1,direntList:t,selectedDirentList:r})):n.setState({isDirentSelected:!1,isAllDirentSelected:!1,direntList:t,selectedDirentList:[]})},n.onAllDirentSelected=function(){n.setState((function(e){var t=!e.isAllDirentSelected,n=e.direntList.map((function(e){return e.isSelected=t,e}));return{isDirentSelected:t,isAllDirentSelected:t,direntList:n,selectedDirentList:t?(0,z.A)(n):[]}}))},n.onFileTagChanged=function(e,t){var r=n.props.repoID;S.e.listFileTags(r,t).then((function(t){var r=t.data.file_tags.map((function(e){return new Vn.A(e)}));n.state.isViewFile?n.setState({fileTags:r}):n.updateDirent(e,"file_tags",r)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)})),n.updateUsedRepoTags()},n.onFileUploadSuccess=function(e){if(n.state.direntList.some((function(t){return t.name===e.name&&t.type===e.type}))){var t=n.state.direntList.find((function(t){return t.name===e.name&&t.type===e.type})),r=K().unix(e.mtime).fromNow();t&&n.updateDirent(t,"mtime",r)}else{e.permission=n.state.userPerm;var o=new Hn.A(e);n.setState((function(t){return{direntList:"dir"===e.type?[o].concat((0,z.A)(t.direntList)):[].concat((0,z.A)(t.direntList),[o])}})),n.state.isTreePanelShown&&n.addNodeToTree(o.name,n.state.path,o.type),"dir"!==e.type&&n.loadDirentList(n.state.path)}},n.addDirent=function(e,t,r){var o=n.createDirent(e,t,r),a=n.state.direntList;if("dir"===t)a.unshift(o);else{var i=a.length;if(0===i||"dir"===a[i-1].type)a.push(o);else{for(var s=0,l=0;l<=i;l++)if("file"===a[l].type){s=l;break}a.splice(s,0,o)}}n.setState({direntList:a})},n.renameDirent=function(e,t){var r=n.props.repoID,o=h.Aq.getDirName(e),a=h.Aq.joinPath(o,t);if(e===n.state.path){n.setState({path:a});var i=n.state.currentRepoInfo,s=f.Yc+"library/"+r+"/"+encodeURIComponent(i.repo_name)+a;window.history.replaceState({url:s,path:a},a,s)}else if(h.Aq.isChildPath(e,n.state.path)){var l=h.Aq.getFileName(e),c=n.state.direntList.map((function(e){return e.name===l&&(e.name=t),e}));n.setState({direntList:c})}else if(h.Aq.isAncestorPath(e,n.state.path)){var u=h.Aq.renameAncestorPath(n.state.path,e,a);n.setState({path:u});var d=n.state.currentRepoInfo,p=f.Yc+"library/"+r+"/"+encodeURIComponent(d.repo_name)+u;window.history.replaceState({url:p,path:u},u,p)}},n.deleteDirents=function(e){var t=n.state.direntList.filter((function(t){return-1===e.indexOf(t.name)}));n.recalculateSelectedDirents(e,t),n.setState({direntList:t})},n.moveDirent=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=h.Aq.getFileName(e);if(t!==n.state.path){var o=n.state.direntList.filter((function(e){return e.name!==r}));n.recalculateSelectedDirents([r],o),n.setState({direntList:o})}else n.loadDirentList(n.state.path)},n.moveDirents=function(e){var t=n.state.direntList.filter((function(t){return-1===e.indexOf(t.name)}));n.recalculateSelectedDirents(e,t),n.setState({direntList:t,selectedDirentList:[],isDirentSelected:!1,isAllDirentSelected:!1})},n.updateDirent=function(e,t,r){var o=n.state.direntList.map((function(n){return n.name===e.name&&(n[t]=r),n}));n.setState({direntList:o})},n.loadTreeNodeByPath=function(e){var t=n.props.repoID,r=n.state.treeData.clone(),o=r.getNodeByPath(e);o.isLoaded?(r.getNodeByPath(o.parentNode.path).isExpanded=!0,n.setState({treeData:r,currentNode:o})):S.e.listDir(t,o.path).then((function(e){n.addResponseListToNode(e.data.dirent_list,o),r.getNodeByPath(o.parentNode.path).isExpanded=!0,n.setState({treeData:r,currentNode:o})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.loadNodeAndParentsByPath=function(e){var t=n.props.repoID,r=n.state.treeData.clone();h.Aq.isMarkdownFile(e)&&(e=h.Aq.getDirName(e)),S.e.listDir(t,e,{with_parents:!0}).then((function(e){for(var t=e.data,o=t.dirent_list,a=t.user_perm,i={},s=0;s<o.length;s++){var l=o[s],c=l.parent_dir,u="/"===c?"/":c.slice(0,c.length-1);i[u]||(i[u]=[]),i[u].push(l)}for(var d in i){var p=r.getNodeByPath(d);p.isLoaded||n.addResponseListToNode(i[d],p)}n.setState({isTreeDataLoading:!1,treeData:r,userPerm:a})})).catch((function(){n.setState({isLoadFailed:!0})}))},n.onTreeNodeClick=function(e){n.resetSelected();var t,r,o=n.props.repoID;if(n.state.pathExist||n.setState({pathExist:!0}),e.object.isDir()){var a=e.isLoaded;if(!e.isLoaded){var i=n.state.treeData.clone();e=i.getNodeByPath(e.path),S.e.listDir(o,e.path).then((function(t){n.addResponseListToNode(t.data.dirent_list,e),i.collapseNode(e),n.setState({treeData:i})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))}if(a&&e.path===n.state.path)if(e.isExpanded){var s=Wn.A.collapseNode(n.state.treeData,e);n.setState({treeData:s})}else{var l=n.state.treeData.clone();e=l.getNodeByPath(e.path),l.expandNode(e),n.setState({treeData:l})}}if(e.path!==n.state.path)if(e.object.isDir())n.state.path.includes(j.AT.FILE_EXTENDED_PROPERTIES)&&(n.isNeedUpdateHistoryState=!0),n.showDir(e.path);else if(h.Aq.isMarkdownFile(e.path))e.path!==n.state.path&&n.showColumnMarkdownFile(e.path);else if(h.Aq.isFileMetadata(null===(t=e)||void 0===t||null===(r=t.object)||void 0===r?void 0:r.type))e.path!==n.state.path&&n.showFileMetadata(e.path,e.view_id||"0000");else{var c=f.Yc+"lib/"+o+"/file"+h.Aq.encodePath(e.path),u=e.object;u.is_sdoc_revision&&u.revision_id&&(c=f.Yc+"lib/"+o+"/revisions/"+u.revision_id+"/"),window.open(c)}},n.showColumnMarkdownFile=function(e){var t=n.props.repoID;S.e.getFileInfo(t,e).then((function(r){if(0===r.data.size){var o=window.open("about:blank"),a=f.Yc+"lib/"+t+"/file"+h.Aq.encodePath(e);o.location.href=a}else n.showFile(e,!0)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.onCloseMarkdownViewDialog=function(){n.setState({isViewFile:!1,currentDirent:{}})},n.onTreeNodeCollapse=function(e){var t=Wn.A.collapseNode(n.state.treeData,e);n.setState({treeData:t})},n.onTreeNodeExpanded=function(e){var t=n.props.repoID,r=n.state.treeData.clone();(e=r.getNodeByPath(e.path)).isLoaded?(r.expandNode(e),n.setState({treeData:r})):S.e.listDir(t,e.path).then((function(t){n.addResponseListToNode(t.data.dirent_list,e),n.setState({treeData:r})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.addNodeToTree=function(e,t,r){var o=n.createTreeNode(e,r),a=Wn.A.addNodeToParentByPath(n.state.treeData,o,t);n.setState({treeData:a})},n.renameTreeNode=function(e,t){var r=Wn.A.renameNodeByPath(n.state.treeData,e,t);n.setState({treeData:r})},n.deleteTreeNode=function(e){var t=Wn.A.deleteNodeByPath(n.state.treeData,e);n.setState({treeData:t})},n.deleteTreeNodes=function(e){var t=Wn.A.deleteNodeListByPaths(n.state.treeData,e);n.setState({treeData:t})},n.moveTreeNode=function(e,t,r,o){if(n.props.repoID===r.repo_id){var a=Wn.A.moveNodeByPath(n.state.treeData,e,t,o);n.setState({treeData:a})}else{var i=Wn.A.deleteNodeByPath(n.state.treeData,e);n.setState({treeData:i})}},n.copyTreeNode=function(e,t,r,o){if(n.props.repoID===r.repo_id){var a=Wn.A.copyNodeByPath(n.state.treeData,e,t,o);n.setState({treeData:a})}},n.addResponseListToNode=function(e,t){t.isLoaded=!0,t.isExpanded=!0;var n=e.map((function(e){return new Hn.A(e)})),r=(n=h.Aq.sortDirents(n,"name","asc")).map((function(e){return new zn.A({object:e})}));t.addChildren(r)},n.getSelectedDirentPaths=function(){var e=[];return n.state.selectedDirentList.forEach((function(t){e.push(h.Aq.joinPath(n.state.path,t.name))})),e},n.getSelectedDirentNames=function(){var e=[];return n.state.selectedDirentList.forEach((function(t){e.push(t.name)})),e},n.resetSelected=function(){n.setState({isDirentSelected:!1,isAllDirentSelected:!1}),n.state.currentMode===tt.Ys&&(n.setState({currentMode:We.Ay.load("seafile_view_mode")||tt.Tb}),n.markdownFileName="",n.markdownFileParentDir="")},n.getMarkDownFilePath=function(){return n.markdownFileParentDir||n.state.path||""},n.getMarkDownFileName=function(){return n.markdownFileName||n.state.currentDirent.name||""},n.openMarkdownFile=function(){var e=n.props.repoID,t=n.getMarkDownFilePath(),r=n.getMarkDownFileName(),o=f.Yc+"lib/"+e+"/file"+h.Aq.encodePath(t)+(t.endsWith("/")?"":"/")+r;window.open(o,"_blank")},n.recalculateSelectedDirents=function(e,t){var r=n.state.selectedDirentList.slice(0);r.length>0&&(r=r.filter((function(t){return!e.includes(t.name)}))),n.setState({selectedDirentList:r,isDirentSelected:r.length>0,isAllDirentSelected:!!t.length&&r.length===t.length})},n.onLibDecryptDialog=function(){n.setState({libNeedDecrypt:!1}),n.loadDirData(n.state.path)},n.onLibDecryptWhenCopyMove=function(){n.state.libNeedDecryptWhenCopy&&(n.state.copyMoveSingleItem?n.onCopyItem(n.state.destRepoWhenCopyMove,n.state.srcDirentWhenCopyMove,n.state.destDirentPathWhenCopyMove,n.state.srcNodeParentPathWhenCopyMove):n.onCopyItems(n.state.destRepoWhenCopyMove,n.state.destDirentPathWhenCopyMove),n.setState({libNeedDecryptWhenCopy:!1,copyMoveSingleItem:!1})),n.state.libNeedDecryptWhenMove&&(n.state.copyMoveSingleItem?n.onMoveItem(n.state.destRepoWhenCopyMove,n.state.srcDirentWhenCopyMove,n.state.destDirentPathWhenCopyMove,n.state.srcNodeParentPathWhenCopyMove):n.onMoveItems(n.state.destRepoWhenCopyMove,n.state.destDirentPathWhenCopyMove),n.setState({libNeedDecryptWhenMove:!1,copyMoveSingleItem:!1}))},n.sortItems=function(e,t){We.Ay.save("seafile-repo-dir-sort-by",e),We.Ay.save("seafile-repo-dir-sort-order",t),n.setState({sortBy:e,sortOrder:t,items:h.Aq.sortDirents(n.state.direntList,e,t)})},n.onUploadFile=function(e){e.nativeEvent.stopImmediatePropagation(),n.uploader.onFileUpload()},n.onUploadFolder=function(e){e.nativeEvent.stopImmediatePropagation(),n.uploader.onFolderUpload()},n.onToolbarFileTagChanged=function(){var e=n.props.repoID,t=n.state.path;S.e.listFileTags(e,t).then((function(e){var t=e.data.file_tags.map((function(e){return new Vn.A(e)}));n.setState({fileTags:t})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.unSelectDirent=function(){var e=n.state.direntList.map((function(e){return e.isSelected=!1,e}));n.setState({isDirentSelected:!1,direntList:e,selectedDirentList:[]});n.onDirentSelected({})},n.onDeleteRepoTag=function(e){var t=n.state.direntList.map((function(t){if(t.file_tags){var n=t.file_tags.filter((function(t){return t.repo_tag_id!==e}));t.file_tags=n}return t}));n.setState({direntList:t}),n.updateUsedRepoTags()},n.handleSubmit=function(e){var t={share_type:"personal",from:n.state.currentRepoInfo.owner_email};S.e.leaveShareRepo(n.props.repoID,t).then((function(e){(0,c.oo)(f.Yc+"shared-libs/")})).catch((function(e){var t=h.Aq.getErrorMsg(e,!0);E.A.danger(t)})),e.preventDefault()},n.toggleTreePanel=function(){n.setState({isTreePanelShown:!n.state.isTreePanelShown},(function(){n.state.isTreePanelShown&&n.loadSidePanel(n.state.path),localStorage.setItem("sf_dir_view_tree_panel_open",String(n.state.isTreePanelShown))}))};var o=!0,i=localStorage.getItem("sf_dir_view_tree_panel_open");return void 0!=i&&(o="true"==i),n.state={currentMode:We.Ay.load("seafile_view_mode")||tt.Tb,isTreePanelShown:o,path:"",pathExist:!0,isViewFile:!1,currentRepoInfo:null,repoName:"",repoEncrypted:!1,libNeedDecrypt:!1,isGroupOwnedRepo:!1,userPerm:"",selectedDirentList:[],lastSelectedIndex:null,fileTags:[],repoTags:[],usedRepoTags:[],isTreeDataLoading:!0,treeData:Wn.A.buildTree(),currentNode:null,isFileLoading:!0,filePermission:"",content:"",lastModified:"",latestContributor:"",isDirentListLoading:!0,direntList:[],isDirentSelected:!1,sortBy:We.Ay.load("seafile-repo-dir-sort-by")||"name",sortOrder:We.Ay.load("seafile-repo-dir-sort-order")||"asc",isAllDirentSelected:!1,dirID:"",errorMsg:"",isDirentDetailShow:!1,direntDetailPanelTab:"",updateDetail:!1,itemsShowLength:100,isSessionExpired:!1,isCopyMoveProgressDialogShow:!1,isDeleteFolderDialogOpen:!1,asyncCopyMoveTaskId:"",asyncOperationType:"move",asyncOperationProgress:0,asyncOperatedFilesLength:0,viewId:"0000",currentDirent:{}},n.oldonpopstate=window.onpopstate,window.onpopstate=n.onpopstate,n.lastModifyTime=new Date,n.isNeedUpdateHistoryState=!0,n.currentMoveItemName="",n.currentMoveItemPath="",n.markdownFileName="",n.markdownFileParentDir="",n.unsubscribeEventBus=null,n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.unsubscribeEvent=this.props.eventBus.subscribe(ea.T.SEARCH_LIBRARY_CONTENT,this.onSearchedClick),this.calculatePara(this.props)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.repoID!==this.props.repoID&&this.calculatePara(e)}},{key:"componentWillUnmount",value:function(){window.onpopstate=this.oldonpopstate,Bn.unwatchRepo(this.props.repoID,this.onRepoUpdateEvent),this.unsubscribeEvent(),this.unsubscribeEventBus&&this.unsubscribeEventBus(),this.props.eventBus.dispatch(ea.T.CURRENT_LIBRARY_CHANGED,{repoID:"",repoName:"",path:"",isViewFile:!1,isLibView:!1,currentRepoInfo:null})}},{key:"componentDidUpdate",value:function(){this.lastModifyTime=new Date,this.props.eventBus.dispatch(ea.T.CURRENT_LIBRARY_CHANGED,{repoID:this.props.repoID,repoName:this.state.repoName,currentRepoInfo:this.state.currentRepoInfo,path:this.state.path,isViewFile:this.state.isViewFile,isLibView:!0})}},{key:"getAsyncCopyMoveProgress",value:function(){var e=(0,Ln.A)((0,Rn.A)().mark((function e(){var t,n,r,o,a,i,s,l,c,u;return(0,Rn.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state,n=t.asyncOperationType,r=t.asyncCopyMoveTaskId,e.prev=1,e.next=4,S.e.queryAsyncOperationProgress(r);case 4:if(o=e.sent,!(a=o.data).failed){e.next=12;break}return i=(0,f.AP)("Failed to move files to another library."),"copy"===n&&(i=(0,f.AP)("Failed to copy files to another library.")),E.A.danger(i),this.setState({asyncOperationProgress:0,isCopyMoveProgressDialogShow:!1}),e.abrupt("return");case 12:if(!a.successful){e.next=19;break}return"move"===n&&(this.currentMoveItemName&&this.currentMoveItemPath?(this.state.isTreePanelShown&&this.deleteTreeNode(this.currentMoveItemPath),this.moveDirent(this.currentMoveItemName),this.currentMoveItemName="",this.currentMoveItemPath=""):(this.state.isTreePanelShown&&(s=this.getSelectedDirentPaths(),this.deleteTreeNodes(s)),l=this.getSelectedDirentNames(),this.moveDirents(l))),this.setState({isCopyMoveProgressDialogShow:!1}),c=(0,f.AP)("Successfully moved files to another library."),"copy"===n&&(c=(0,f.AP)("Successfully copied files to another library.")),E.A.success(c),e.abrupt("return");case 19:u=a.total?parseInt((a.done/a.total*100).toFixed(2)):0,this.getAsyncCopyMoveProgress(),this.setState({asyncOperationProgress:u}),e.next=27;break;case 24:e.prev=24,e.t0=e.catch(1),this.setState({asyncOperationProgress:0,isCopyMoveProgressDialogShow:!1});case 27:case"end":return e.stop()}}),e,this,[[1,24]])})));return function(){return e.apply(this,arguments)}}()},{key:"renameItemAjaxCallback",value:function(e,t){this.state.isTreePanelShown&&this.renameTreeNode(e,t),this.renameDirent(e,t)}},{key:"deleteItem",value:function(e,t){var n=this,r=this.props.repoID;t?this.setState({folderToDelete:e},(function(){n.toggleDeleteFolderDialog()})):S.e.deleteFile(r,e).then((function(r){n.deleteItemAjaxCallback(e,t);var o=h.Aq.getFileName(e),a=(0,f.AP)("Successfully deleted {name}").replace("{name}",o),i=(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("span",{children:a}),(0,m.jsx)("a",{className:"action-link p-0 ml-1",href:"#",onClick:n.restoreDeletedDirents.bind(n,r.data.commit_id,[e]),children:(0,f.AP)("Undo")})]});E.A.success(i,{duration:5})})).catch((function(t){var n=h.Aq.getErrorMsg(t);if(n===(0,f.AP)("Error")){var r=h.Aq.getFileName(e);n=(0,f.AP)("Failed to delete {name}").replace("{name}",r)}E.A.danger(n)}))}},{key:"deleteItemAjaxCallback",value:function(e){this.state.isTreePanelShown&&this.deleteTreeNode(e),this.deleteDirent(e)}},{key:"deleteDirent",value:function(e){if(e===this.state.path){var t=h.Aq.getDirName(e);this.showDir(t)}else if(h.Aq.isChildPath(e,this.state.path)){var n=h.Aq.getFileName(e),r=this.state.direntList.filter((function(e){return e.name!==n}));this.recalculateSelectedDirents([n],r),this.setState({direntList:r})}else if(h.Aq.isAncestorPath(e,this.state.path)){var o=h.Aq.getDirName(e);this.showDir(o)}}},{key:"createTreeNode",value:function(e,t){var n=this.createDirent(e,t);return new zn.A({object:n})}},{key:"createDirent",value:function(e,t,n){var r=this.state.userPerm,o={name:e,type:t,mtime:(new Date).getTime()/1e3,size:n,permission:r};return new Hn.A(o)}},{key:"render",value:function(){var e=this;if(this.state.libNeedDecrypt)return(0,m.jsx)(te.A,{children:(0,m.jsx)(Kn,{repoID:this.props.repoID,onLibDecryptDialog:this.onLibDecryptDialog})});if(this.state.libNeedDecryptWhenCopy||this.state.libNeedDecryptWhenMove)return(0,m.jsx)(te.A,{children:(0,m.jsx)(Kn,{repoID:this.state.destRepoWhenCopyMove.repo_id,onLibDecryptDialog:this.onLibDecryptWhenCopyMove})});if(this.state.errorMsg)return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("p",{className:"error mt-6 text-center",children:this.state.errorMsg}),(0,m.jsx)("button",{type:"submit",className:"btn btn-primary submit",onClick:this.handleSubmit,children:(0,f.AP)("Leave Share")})]});if(!this.state.currentRepoInfo)return"";var t=!1,n=this.state,r=n.currentRepoInfo,o=n.userPerm,a=n.isCopyMoveProgressDialogShow,i=n.isDeleteFolderDialogOpen,l=n.currentDirent,c=h.Aq.isHasPermissionToShare(r,o),u=r.owner_email===f.Xh,g=r.is_virtual,v=r.is_admin;g||!u&&!v||(t=!0);var y=this.state.direntList.filter((function(t,n){return n<e.state.itemsShowLength})),C=!0,A=h.Aq.getUserPermission(o),x=A.isCustomPermission,b=A.customPermission;x&&(C=b.permission.upload);return(0,m.jsx)(rr.Xj,{repoID:this.props.repoID,selectMetadataView:this.onTreeNodeClick,hideMetadataView:this.hideFileMetadata,children:(0,m.jsxs)(rr.lN,{repoID:this.props.repoID,children:[(0,m.jsxs)("div",{className:"main-panel-center flex-row",children:[(0,m.jsx)(Sa,{isSidePanelFolded:this.props.isSidePanelFolded,repoEncrypted:this.state.repoEncrypted,isRepoOwner:u,onFilesTagChanged:this.onFileTagChanged,unSelectDirent:this.unSelectDirent,pathPrefix:this.props.pathPrefix,isTreePanelShown:this.state.isTreePanelShown,toggleTreePanel:this.toggleTreePanel,currentMode:this.state.currentMode,switchViewMode:this.switchViewMode,isCustomPermission:x,path:this.state.path,pathExist:this.state.pathExist,currentRepoInfo:this.state.currentRepoInfo,repoID:this.props.repoID,enableDirPrivateShare:t,userPerm:o,isGroupOwnedRepo:this.state.isGroupOwnedRepo,onTabNavClick:this.props.onTabNavClick,onMainNavBarClick:this.onMainNavBarClick,isViewFile:this.state.isViewFile,fileTags:this.state.fileTags,isFileLoading:this.state.isFileLoading,filePermission:this.state.filePermission,content:this.state.content,viewId:this.state.viewId,lastModified:this.state.lastModified,latestContributor:this.state.latestContributor,onLinkClick:this.onLinkClick,isTreeDataLoading:this.state.isTreeDataLoading,treeData:this.state.treeData,currentNode:this.state.currentNode,onNodeClick:this.onTreeNodeClick,onNodeCollapse:this.onTreeNodeCollapse,onNodeExpanded:this.onTreeNodeExpanded,onAddFolderNode:this.onAddFolder,onAddFileNode:this.onAddFile,onRenameNode:this.onRenameTreeNode,onDeleteNode:this.onDeleteTreeNode,repoTags:this.state.repoTags,usedRepoTags:this.state.usedRepoTags,updateUsedRepoTags:this.updateUsedRepoTags,isDirentListLoading:this.state.isDirentListLoading,direntList:y,fullDirentList:this.state.direntList,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,currentDirent:l,sortItems:this.sortItems,updateDirent:this.updateDirent,onDirentClick:this.onDirentClick,onItemClick:this.onItemClick,onItemSelected:this.onDirentSelected,onItemDelete:this.onMainPanelItemDelete,onItemRename:this.onMainPanelItemRename,onItemMove:this.onMoveItem,onItemCopy:this.onCopyItem,onItemConvert:this.onConvertItem,onAddFolder:this.onAddFolder,onAddFile:this.onAddFile,onFileTagChanged:this.onFileTagChanged,isDirentSelected:this.state.isDirentSelected,isAllDirentSelected:this.state.isAllDirentSelected,onAllDirentSelected:this.onAllDirentSelected,isDirentDetailShow:this.state.isDirentDetailShow,selectedDirent:this.state.selectedDirentList&&this.state.selectedDirentList[0],selectedDirentList:this.state.selectedDirentList,onSelectedDirentListUpdate:this.onSelectedDirentListUpdate,onItemsMove:this.onMoveItems,onItemsCopy:this.onCopyItems,onItemsDelete:this.onDeleteItems,closeDirentDetail:this.closeDirentDetail,showDirentDetail:this.showDirentDetail,direntDetailPanelTab:this.state.direntDetailPanelTab,onDeleteRepoTag:this.onDeleteRepoTag,onToolbarFileTagChanged:this.onToolbarFileTagChanged,updateDetail:this.state.updateDetail,onListContainerScroll:this.onListContainerScroll,loadDirentList:this.loadDirentList,showShareBtn:c,onUploadFile:this.onUploadFile,onUploadFolder:this.onUploadFolder,eventBus:this.props.eventBus,onCloseMarkdownViewDialog:this.onCloseMarkdownViewDialog,getMarkDownFilePath:this.getMarkDownFilePath,getMarkDownFileName:this.getMarkDownFileName,openMarkdownFile:this.openMarkdownFile}),C&&this.state.pathExist&&!this.state.isViewFile&&this.state.currentMode!==tt.Ys&&(0,m.jsx)(Ua,{ref:function(t){return e.uploader=t},dragAndDrop:!0,path:this.state.path,repoID:this.props.repoID,direntList:this.state.direntList,onFileUploadSuccess:this.onFileUploadSuccess,isCustomPermission:x})]}),a&&(0,m.jsx)(Ya.A,{type:this.state.asyncOperationType,asyncOperatedFilesLength:this.state.asyncOperatedFilesLength,asyncOperationProgress:this.state.asyncOperationProgress,toggleDialog:this.onMoveProgressDialogToggle}),i&&(0,m.jsx)(Ba,{repoID:this.props.repoID,path:this.state.folderToDelete,deleteFolder:this.deleteFolder,toggleDialog:this.toggleDeleteFolderDialog}),(0,m.jsx)(d(),{query:"(max-width: 767.8px)",children:(0,m.jsx)(p.A,{zIndex:"1030",isOpen:!h.Aq.isDesktop()&&this.state.isTreePanelShown,toggle:this.toggleTreePanel,contentClassName:"d-none"})})]})})}}])}(s.Component),Va=Ha,Ga=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).listGroupMembers=function(e){var t=n.props.groupID,r=n.state,o=r.perPage,a=r.groupMembers;S.e.listGroupMembers(t,e,o).then((function(t){var r=t.data;n.setState({isLoading:!1,isLoadingMore:!1,page:e,hasNextPage:!(r.length<o),groupMembers:a.concat(r)})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t),n.setState({isLoading:!1,isLoadingMore:!1,hasNextPage:!1})}))},n.handleScroll=function(e){var t=n.state,r=t.page,o=t.hasNextPage,a=t.isLoadingMore;if(o&&!a){var i=e.target.clientHeight,s=e.target.scrollHeight;i+e.target.scrollTop+1>=s&&n.setState({isLoadingMore:!0},(function(){n.listGroupMembers(r+1)}))}},n.state={isLoading:!0,isLoadingMore:!1,groupMembers:[],page:1,perPage:100,hasNextPage:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.listGroupMembers(this.state.page)}},{key:"render",value:function(){var e,t=this.state,n=t.isLoading,r=t.hasNextPage,o=t.groupMembers,a=t.perPage;return e=o.length<a?o.length:"".concat(a,"+"),(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.props.toggleDialog,children:[(0,m.jsx)(k.A,{toggle:this.props.toggleDialog,children:"".concat((0,f.AP)("Group members")," (").concat(e,")")}),(0,m.jsx)(M.A,{className:"px-0 group-members-container",onScroll:this.handleScroll,children:n?(0,m.jsx)(Z.A,{}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("ul",{className:"list-unstyled",children:o.map((function(e,t){return(0,m.jsxs)("li",{className:"group-member px-4 py-2 d-flex align-items-center",children:[(0,m.jsx)("img",{src:e.avatar_url,alt:e.name,className:"avatar"}),(0,m.jsx)("span",{className:"ml-2 text-truncate",title:e.name,children:e.name})]},t)}))}),r&&(0,m.jsx)(Z.A,{})]})})]})}}])}(s.Component),qa=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).dismissGroup=function(){var e=n;S.e.deleteGroup(n.props.groupID).then((function(t){e.props.onGroupChanged()})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return(0,m.jsxs)(p.A,{isOpen:this.props.showDismissGroupDialog,toggle:this.props.toggleDismissGroupDialog,children:[(0,m.jsx)(k.A,{children:(0,f.AP)("Delete Group")}),(0,m.jsx)(M.A,{children:(0,m.jsx)("span",{children:(0,f.AP)("Really want to delete this group?")})}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(P.A,{color:"secondary",onClick:this.props.toggleDismissGroupDialog,children:(0,f.AP)("Cancel")}),(0,m.jsx)(P.A,{color:"primary",onClick:this.dismissGroup,children:(0,f.AP)("Delete")})]})]})}}])}(s.Component),za=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).handleGroupNameChange=function(e){e.target.value.trim()?n.setState({isSubmitBtnActive:!0}):n.setState({isSubmitBtnActive:!1});var t=e.target.value;n.setState({newGroupName:t})},n.renameGroup=function(){var e=n.state.newGroupName.trim();if(e){var t=n;S.e.renameGroup(n.props.groupID,e).then((function(e){t.props.loadGroup(n.props.groupID),t.props.onGroupChanged(e.data.id)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))}n.setState({newGroupName:""}),n.props.toggleRenameGroupDialog()},n.handleKeyDown=function(e){13===e.keyCode&&n.renameGroup()},n.state={newGroupName:n.props.currentGroupName,isSubmitBtnActive:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return(0,m.jsxs)(p.A,{isOpen:this.props.showRenameGroupDialog,toggle:this.props.toggleRenameGroupDialog,children:[(0,m.jsx)(k.A,{children:(0,f.AP)("Rename Group")}),(0,m.jsxs)(M.A,{children:[(0,m.jsx)("label",{htmlFor:"newGroupName",children:(0,f.AP)("Rename group to")}),(0,m.jsx)(I.A,{type:"text",id:"newGroupName",value:this.state.newGroupName,onChange:this.handleGroupNameChange,onKeyDown:this.handleKeyDown})]}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(P.A,{color:"secondary",onClick:this.props.toggleRenameGroupDialog,children:(0,f.AP)("Cancel")}),(0,m.jsx)(P.A,{color:"primary",onClick:this.renameGroup,disabled:!this.state.isSubmitBtnActive,children:(0,f.AP)("Submit")})]})]})}}])}(s.Component),Wa=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).handleSelectChange=function(e){n.setState({selectedOption:e,errMessage:""}),n.options=[]},n.transferGroup=function(){var e=n.state.selectedOption&&n.state.selectedOption.email;e&&S.e.transferGroup(n.props.groupID,e).then((function(e){n.props.toggleTransferGroupDialog()})).catch((function(e){var t=h.Aq.getErrorMsg(e);n.setState({errMessage:t})}))},n.toggle=function(){n.props.toggleTransferGroupDialog()},n.state={selectedOption:null,errMessage:""},n.options=[],n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.toggle,children:[(0,m.jsx)(k.A,{toggle:this.toggle,children:(0,f.AP)("Transfer Group")}),(0,m.jsxs)(M.A,{children:[(0,m.jsx)("p",{children:(0,f.AP)("Transfer group to")}),(0,m.jsx)(Yt.A,{ref:"userSelect",isMulti:!1,placeholder:(0,f.AP)("Please enter 1 or more character"),onSelectChange:this.handleSelectChange}),(0,m.jsx)("div",{className:"error",children:this.state.errMessage})]}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(P.A,{color:"secondary",onClick:this.toggle,children:(0,f.AP)("Close")}),(0,m.jsx)(P.A,{color:"primary",onClick:this.transferGroup,children:(0,f.AP)("Submit")})]})]})}}])}(s.Component),Ka=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).toggle=function(){n.props.toggleImportMembersDialog()},n.openFileInput=function(){n.fileInputRef.current.click()},n.uploadFile=function(e){if(n.fileInputRef.current.files.length){var t=n.fileInputRef.current.files[0].name;if("xlsx"==t.substr(t.lastIndexOf(".")+1)){var r=n.fileInputRef.current.files[0];n.props.importMembersInBatch(r),n.toggle()}else n.setState({errorMsg:(0,f.AP)("Please choose a .xlsx file.")})}},n.state={errorMsg:""},n.fileInputRef=s.createRef(),n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.state.errorMsg;return(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.toggle,children:[(0,m.jsx)(k.A,{toggle:this.toggle,children:(0,f.AP)("Import members from a .xlsx file")}),(0,m.jsxs)(M.A,{children:[(0,m.jsx)("p",{children:f.Vb}),(0,m.jsx)("p",{children:(0,m.jsx)("a",{className:"text-secondary small",href:"".concat(f.Yc,"api/v2.1/group-members-import-example/"),children:(0,f.AP)("Download an example file")})}),(0,m.jsx)("button",{className:"btn btn-outline-primary",onClick:this.openFileInput,children:(0,f.AP)("Upload file")}),(0,m.jsx)("input",{className:"d-none",type:"file",onChange:this.uploadFile,ref:this.fileInputRef}),e&&(0,m.jsx)(St.A,{color:"danger",children:e})]}),(0,m.jsx)(N.A,{children:(0,m.jsx)(P.A,{color:"secondary",onClick:this.toggle,children:(0,f.AP)("Cancel")})})]})}}])}(s.Component),Za=n(99121),Xa=function(e){function t(){return(0,r.A)(this,t),(0,a.A)(this,t,arguments)}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.groupMembers,n=e.changeMember,r=e.deleteMember,o=e.groupID,a=e.isOwner,i=e.isItemFreezed,s=e.toggleItemFreezed;return(0,m.jsxs)(J.A,{size:"sm",className:"manage-members-table",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"10%"}),(0,m.jsx)("th",{width:"45%",children:(0,f.AP)("Name")}),(0,m.jsx)("th",{width:"35%",children:(0,f.AP)("Role")}),(0,m.jsx)("th",{width:"10%"})]})}),(0,m.jsx)("tbody",{children:t.map((function(e,t){return(0,m.jsx)($a,{item:e,changeMember:n,deleteMember:r,groupID:o,isOwner:a,isItemFreezed:i,toggleItemFreezed:s},t)}))})]})}}])}(s.Component),$a=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onChangeUserRole=function(e){var t="Admin"===e.value?"True":"False";S.e.setGroupAdmin(n.props.groupID,n.props.item.email,t).then((function(e){n.props.changeMember(e.data)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.deleteMember=function(){var e=n.props.item;S.e.deleteGroupMember(n.props.groupID,e.email).then((function(t){n.props.deleteMember(e),E.A.success((0,f.AP)("Successfully deleted {name}.").replace("{name}",e.name))})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.handleMouseOver=function(){n.props.isItemFreezed||n.setState({highlight:!0})},n.handleMouseLeave=function(){n.props.isItemFreezed||n.setState({highlight:!1})},n.translateRole=function(e){return"Admin"===e?(0,f.AP)("Admin"):"Member"===e?(0,f.AP)("Member"):"Owner"===e?(0,f.AP)("Owner"):void 0},n.roleOptions=[{value:"Admin",text:(0,f.AP)("Admin"),isSelected:!1},{value:"Member",text:(0,f.AP)("Member"),isSelected:!1}],n.state={highlight:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.state.highlight,t=this.props,n=t.item,r=t.isOwner,o="Owner"!==n.role&&!0===r||"Member"===n.role&&!1===r,a=n.role;this.roleOptions=this.roleOptions.map((function(e){return e.isSelected=e.value==a,e}));var i=this.roleOptions.filter((function(e){return e.isSelected}))[0];return(0,m.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseLeave:this.handleMouseLeave,className:this.state.highlight?"tr-highlight":"",tabIndex:"0",onFocus:this.handleMouseOver,children:[(0,m.jsx)("th",{scope:"row",children:(0,m.jsx)("img",{className:"avatar",src:n.avatar_url,alt:""})}),(0,m.jsx)("td",{children:n.name}),(0,m.jsxs)("td",{children:[(!1===r||!0===r&&"Owner"===n.role)&&(0,m.jsx)("span",{className:"group-admin",children:this.translateRole(n.role)}),!0===r&&"Owner"!==n.role&&(0,m.jsx)(Le.A,{isDropdownToggleShown:e,currentSelectedOption:i,options:this.roleOptions,selectOption:this.onChangeUserRole,toggleItemFreezed:this.props.toggleItemFreezed})]}),(0,m.jsx)("td",{children:o&&this.state.highlight&&(0,m.jsx)(Qt.A,{className:"action-icon sf2-icon-x3",title:(0,f.AP)("Delete"),op:this.deleteMember})})]})}}])}(s.PureComponent),Ja=Xa,Qa=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).listGroupMembers=function(e){var t=n.props.groupID,r=n.state,o=r.perPage,a=r.groupMembers;S.e.listGroupMembers(t,e,o).then((function(t){var r=t.data;n.setState({isLoading:!1,isLoadingMore:!1,page:e,hasNextPage:!(r.length<o),groupMembers:a.concat(r)})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t),n.setState({isLoading:!1,isLoadingMore:!1,hasNextPage:!1})}))},n.onSelectChange=function(e){n.setState({selectedOption:e,errMessage:[]})},n.addGroupMember=function(){for(var e=[],t=0;t<n.state.selectedOption.length;t++)e.push(n.state.selectedOption[t].email);S.e.addGroupMembers(n.props.groupID,e).then((function(e){var t=e.data.success;n.setState({groupMembers:[].concat(t,n.state.groupMembers),selectedOption:null}),n.refs.userSelect.clearSelect(),e.data.failed.length>0&&n.setState({errMessage:e.data.failed})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.toggleItemFreezed=function(e){n.setState({isItemFreezed:e})},n.handleScroll=function(e){var t=n.state,r=t.page,o=t.hasNextPage,a=t.isLoadingMore;if(o&&!a){var i=e.target.clientHeight,s=e.target.scrollHeight;i+e.target.scrollTop+1>=s&&n.setState({isLoadingMore:!0},(function(){n.listGroupMembers(r+1)}))}},n.changeMember=function(e){n.setState({groupMembers:n.state.groupMembers.map((function(t){return t.email==e.email&&(t=e),t}))})},n.deleteMember=function(e){var t=n.state.groupMembers;t.splice(t.indexOf(e),1),n.setState({groupMembers:t})},n.searchMembers=function(e){var t=n.state.groupMembers,r=e.target.value,o=r.trim().toLowerCase(),a=t.filter((function(e){return e.name.toLowerCase().indexOf(o)>-1}));n.setState({keyword:r,membersFound:a})},n.clearSearch=function(){n.setState({keyword:"",membersFound:[]})},n.onSearchInputFocus=function(){n.setState({searchActive:!0})},n.onSearchInputBlur=function(){n.setState({searchActive:!1})},n.state={isLoading:!0,isLoadingMore:!1,groupMembers:[],page:1,perPage:100,hasNextPage:!1,selectedOption:null,errMessage:[],isItemFreezed:!1,searchActive:!1,keyword:"",membersFound:[]},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.listGroupMembers(this.state.page)}},{key:"render",value:function(){var e=this.state,t=e.isLoading,n=e.hasNextPage,r=e.groupMembers,o=e.keyword,a=e.membersFound,i=e.searchActive;return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("p",{className:"mb-2",children:(0,f.AP)("Add group member")}),(0,m.jsxs)("div",{className:"add-members",children:[(0,m.jsx)(Yt.A,{placeholder:(0,f.AP)("Search users"),onSelectChange:this.onSelectChange,ref:"userSelect",isMulti:!0,className:"add-members-select"}),this.state.selectedOption?(0,m.jsx)(P.A,{color:"primary",onClick:this.addGroupMember,children:(0,f.AP)("Submit")}):(0,m.jsx)(P.A,{color:"primary",disabled:!0,children:(0,f.AP)("Submit")})]}),this.state.errMessage.length>0&&this.state.errMessage.map((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(0,m.jsx)("div",{className:"group-error error",children:e.error_msg},t)})),r.length>10&&(0,m.jsxs)(Ft.A,{className:"search-group-members rounded ".concat(i?"active":""),children:[(0,m.jsx)(Za.A,{children:(0,m.jsx)("i",{className:"sf3-font sf3-font-search","aria-hidden":!0})}),(0,m.jsx)(I.A,{type:"text",className:"input-group-input px-0",placeholder:(0,f.AP)("Search group members"),value:o,onChange:this.searchMembers,onFocus:this.onSearchInputFocus,onBlur:this.onSearchInputBlur}),o&&(0,m.jsx)(Za.A,{children:(0,m.jsx)("i",{className:"sf2-icon-x1","aria-hidden":!0,onClick:this.clearSearch})})]}),(0,m.jsx)("div",{className:"manage-members",onScroll:o.trim()?function(){}:this.handleScroll,children:t?(0,m.jsx)(Z.A,{}):(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)(Ja,{groupMembers:o.trim()?a:r,changeMember:this.changeMember,deleteMember:this.deleteMember,groupID:this.props.groupID,isOwner:this.props.isOwner,isItemFreezed:this.state.isItemFreezed,toggleItemFreezed:this.toggleItemFreezed}),!o.trim()&&n&&(0,m.jsx)(Z.A,{})]})})]})}}])}(s.Component),ei=Qa,ti=function(e){function t(){return(0,r.A)(this,t),(0,a.A)(this,t,arguments)}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.groupID,n=e.isOwner,r=e.toggleManageMembersDialog;return(0,m.jsxs)(p.A,{isOpen:!0,toggle:r,className:"group-manage-members-dialog",children:[(0,m.jsx)(k.A,{toggle:r,children:(0,f.AP)("Manage group members")}),(0,m.jsx)(M.A,{className:"pb-0",children:(0,m.jsx)(ei,{groupID:t,isOwner:n})})]})}}])}(s.Component),ni=ti,ri=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).leaveGroup=function(){S.e.quitGroup(n.props.groupID,f.Xh).then((function(e){n.props.onGroupChanged()})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.props.toggleLeaveGroupDialog,children:[(0,m.jsx)(k.A,{toggle:this.props.toggleLeaveGroupDialog,children:(0,f.AP)("Leave Group")}),(0,m.jsx)(M.A,{children:(0,m.jsx)("p",{children:(0,f.AP)("Really want to leave this group?")})}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(P.A,{color:"secondary",onClick:this.props.toggleLeaveGroupDialog,children:(0,f.AP)("Cancel")}),(0,m.jsx)(P.A,{color:"primary",onClick:this.leaveGroup,children:(0,f.AP)("Leave")})]})]})}}])}(s.Component),oi=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).loadGroup=function(e){S.e.getGroup(e).then((function(e){var t=new D(e.data),r=n.getEmptyTip(t),o=t.admins.indexOf(f.Xh)>-1,a=t.owner===f.Xh,i=0!==t.parent_group_id;n.setState({emptyTip:r,currentGroup:t,isStaff:o,isDepartmentGroup:i,isOwner:a,currentPage:1,repoList:[]},(function(){n.loadRepos(n.state.currentPage)}))})).catch((function(e){n.setState({isLoading:!1,errMessage:h.Aq.getErrorMsg(e,!0)})}))},n.loadRepos=function(e){var t=n.state.perPage;S.e.listGroupRepos(n.props.groupID,e,t).then((function(r){var o=!0;r.data.length<t&&(o=!1);var a=n.state.repoList,i=r.data.map((function(e){return new Ke(e)}));i.length&&(a=a.concat(i)),n.setState({isLoading:!1,isLoadingMore:!1,currentPage:e,hasNextPage:o,repoList:h.Aq.sortRepos(a,n.state.sortBy,n.state.sortOrder)})})).catch((function(e){n.setState({isLoading:!1,isLoadingMore:!1,errMessage:h.Aq.getErrorMsg(e,!0)})}))},n.getEmptyTip=function(e){var t=null;return e&&(t=0===e.parent_group_id?(0,m.jsx)($.A,{title:(0,f.AP)("No libraries shared with this group"),text:(0,f.AP)('No libraries have been shared with this group yet. A library shared with a group can be accessed by all group members. You can share a library with a group in "My Libraries". You can also create a new library to be shared with this group by clicking the "New Library" button in the menu bar.')}):-1==e.admins.indexOf(f.Xh)?(0,m.jsx)($.A,{title:(0,f.AP)("No libraries")}):(0,m.jsx)($.A,{title:(0,f.AP)("No libraries"),text:(0,f.AP)('You can create libraries by clicking the "New Library" button above.')})),t},n.onCreateRepoToggle=function(){n.setState({isCreateRepoDialogShow:!n.state.isCreateRepoDialogShow})},n.onCreateRepo=function(e,t){var r=n.props.groupID;t&&"department"===t?S.e.createGroupOwnedLibrary(r,e).then((function(e){var t={repo_id:e.data.id,repo_name:e.data.name,owner_name:e.data.group_name,owner_email:e.data.owner,permission:e.data.permission,mtime:e.data.mtime,size:e.data.size,encrypted:e.data.encrypted},r=new Ke(t),o=n.addRepoItem(r);n.setState({repoList:o})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)})):S.e.createGroupRepo(r,e).then((function(e){var t=new Ke(e.data),r=n.addRepoItem(t);n.setState({repoList:r})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)})),n.onCreateRepoToggle()},n.onItemDelete=function(e){var t=n.props.groupID,r=n.state.repoList.filter((function(t){return t.repo_id!==e.repo_id}));n.setState({repoList:r}),n.loadGroup(t)},n.addRepoItem=function(e){var t=n.state.repoList.map((function(e){return e}));return t.unshift(e),t},n.onItemUnshare=function(e){var t=n.state.currentGroup;S.e.unshareRepoToGroup(e.repo_id,t.id).then((function(){var r=n.state.repoList.filter((function(t){return t.repo_id!==e.repo_id}));n.setState({repoList:r}),n.loadGroup(t.id)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.onItemRename=function(e,t){S.e.renameGroupOwnedLibrary(n.props.groupID,e.repo_id,t).then((function(r){var o=n.state.repoList.map((function(n){return n.repo_id===e.repo_id&&(n.repo_name=t),n}));n.setState({repoList:o})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.onMonitorRepo=function(e,t){var r=n.state.repoList.map((function(n){return n.repo_id===e.repo_id&&(n.monitored=t),n}));n.setState({repoList:r})},n.toggleDismissGroupDialog=function(){n.setState({showDismissGroupDialog:!n.state.showDismissGroupDialog,showGroupDropdown:!1})},n.toggleRenameGroupDialog=function(){n.setState({showRenameGroupDialog:!n.state.showRenameGroupDialog,showGroupDropdown:!1})},n.toggleTransferGroupDialog=function(){n.setState({showTransferGroupDialog:!n.state.showTransferGroupDialog,showGroupDropdown:!1})},n.toggleImportMembersDialog=function(){n.setState({showImportMembersDialog:!n.state.showImportMembersDialog})},n.importMembersInBatch=function(e){E.A.notify((0,f.AP)("It may take some time, please wait.")),S.e.importGroupMembersViaFile(n.state.currentGroup.id,e).then((function(e){e.data.failed.forEach((function(e){var t="".concat(e.email,": ").concat(e.error_msg);E.A.danger(t)}))})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.toggleManageMembersDialog=function(){n.setState({showManageMembersDialog:!n.state.showManageMembersDialog,showGroupDropdown:!1})},n.toggleLeaveGroupDialog=function(){n.setState({isLeaveGroupDialogOpen:!n.state.isLeaveGroupDialogOpen,showGroupDropdown:!1})},n.sortItems=function(e,t){We.Ay.save("seafile-repo-dir-sort-by",e),We.Ay.save("seafile-repo-dir-sort-order",t),n.setState({sortBy:e,sortOrder:t,repoList:h.Aq.sortRepos(n.state.repoList,e,t)})},n.translateRole=function(e){return"Admin"===e?(0,f.AP)("Admin"):"Member"===e?(0,f.AP)("Member"):"Owner"===e?(0,f.AP)("Owner"):void 0},n.toggleSortOptionsDialog=function(){n.setState({isSortOptionsDialogOpen:!n.state.isSortOptionsDialogOpen})},n.handleScroll=function(e){var t=n.state,r=t.currentPage,o=t.hasNextPage,a=t.isLoadingMore;if(o&&!a){var i=e.target.clientHeight,s=e.target.scrollHeight;i+e.target.scrollTop+1>=s&&n.setState({isLoadingMore:!0},(function(){n.loadRepos(r+1)}))}},n.toggleMembersDialog=function(){n.setState({isMembersDialogOpen:!n.state.isMembersDialogOpen})},n.getOpList=function(){var e=n.state,t=e.currentGroup,r=e.isDepartmentGroup,o=e.isStaff,a=e.isOwner,i=[];return(!r&&f._s||r&&o)&&i.push({text:(0,f.AP)("New Library"),onClick:n.onCreateRepoToggle}),i.push({text:(0,f.AP)("Members"),onClick:n.toggleMembersDialog}),t&&((o||a)&&(i.push({text:(0,f.AP)("Rename"),onClick:n.toggleRenameGroupDialog}),a&&i.push({text:(0,f.AP)("Transfer"),onClick:n.toggleTransferGroupDialog}),i.push({text:(0,f.AP)("Import members"),onClick:n.toggleImportMembersDialog}),i.push({text:(0,f.AP)("Manage members"),onClick:n.toggleManageMembersDialog}),a&&i.push({text:(0,f.AP)("Delete group"),onClick:n.toggleDismissGroupDialog})),a||r||i.push({text:(0,f.AP)("Leave group"),onClick:n.toggleLeaveGroupDialog})),i},n.state={isLoading:!0,isLoadingMore:!1,errMessage:"",emptyTip:null,currentGroup:null,currentRepo:null,isStaff:!1,isOwner:!1,sortBy:We.Ay.load("seafile-repo-dir-sort-by")||"name",sortOrder:We.Ay.load("seafile-repo-dir-sort-order")||"asc",isSortOptionsDialogOpen:!1,repoList:[],currentPage:1,perPage:300,hasNextPage:!1,libraryType:"group",isCreateRepoDialogShow:!1,isDepartmentGroup:!1,showGroupDropdown:!1,showGroupMembersPopover:!1,showRenameGroupDialog:!1,showDismissGroupDialog:!1,showTransferGroupDialog:!1,showImportMembersDialog:!1,showManageMembersDialog:!1,isLeaveGroupDialogOpen:!1,isMembersDialogOpen:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this.props.groupID;this.loadGroup(e)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.groupID!==this.props.groupID&&this.loadGroup(e.groupID)}},{key:"render",value:function(){var e=this.state,t=e.errMessage,n=e.emptyTip,r=e.currentGroup,o=e.isDepartmentGroup,a=e.isMembersDialogOpen,i=0;o&&r.group_quota&&(i=r.group_quota_usage/r.group_quota*100+"%");var l=this.getOpList();return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("div",{className:"main-panel-center flex-row",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)("div",{className:"cur-view-path",children:r&&(0,m.jsxs)(s.Fragment,{children:[(0,m.jsxs)("div",{className:"sf-heading d-flex align-items-center",children:[o&&(0,m.jsx)("span",{className:"sf3-font-department sf3-font nav-icon",title:(0,f.AP)("This is a special group representing a department.")}),(0,m.jsx)("span",{children:r.name}),(0,m.jsx)(Ue,{opList:l})]}),(0,m.jsxs)("div",{className:"path-tool",children:[o&&(0,m.jsx)(m.Fragment,{children:r.group_quota>0&&(0,m.jsx)("div",{className:"department-usage-container",children:(0,m.jsxs)("div",{className:"department-usage",children:[(0,m.jsx)("span",{id:"quota-bar",className:"department-quota-bar",children:(0,m.jsx)("span",{id:"quota-usage",className:"usage",style:{width:i}})}),(0,m.jsxs)("span",{className:"department-quota-info",children:[h.Aq.bytesToSize(r.group_quota_usage)," / ",h.Aq.bytesToSize(r.group_quota)]})]})})}),!h.Aq.isDesktop()&&this.state.repoList.length>0&&(0,m.jsx)("span",{className:"sf3-font sf3-font-sort action-icon",onClick:this.toggleSortOptionsDialog}),this.state.isSortOptionsDialogOpen&&(0,m.jsx)(je,{toggleDialog:this.toggleSortOptionsDialog,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems})]})]})}),(0,m.jsxs)("div",{className:"cur-view-content d-block",onScroll:this.handleScroll,children:[this.state.isLoading&&(0,m.jsx)(Z.A,{}),!this.state.isLoading&&t&&(0,m.jsx)("div",{className:"error text-center mt-2",children:t}),!this.state.isLoading&&0===this.state.repoList.length&&n,!this.state.isLoading&&this.state.repoList.length>0&&(0,m.jsx)(Nn,{repoList:this.state.repoList,hasNextPage:this.state.hasNextPage,currentGroup:this.state.currentGroup,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems,onItemUnshare:this.onItemUnshare,onItemDelete:this.onItemDelete,onItemRename:this.onItemRename,onMonitorRepo:this.onMonitorRepo})]})]})}),this.state.isCreateRepoDialogShow&&!this.state.isDepartmentGroup&&(0,m.jsx)(te.A,{children:(0,m.jsx)(xn,{libraryType:this.state.libraryType,onCreateToggle:this.onCreateRepoToggle,onCreateRepo:this.onCreateRepo})}),this.state.isCreateRepoDialogShow&&this.state.isDepartmentGroup&&(0,m.jsx)(xn,{onCreateToggle:this.onCreateRepoToggle,onCreateRepo:this.onCreateRepo,libraryType:"department"}),a&&(0,m.jsx)(Ga,{groupID:this.props.groupID,toggleDialog:this.toggleMembersDialog}),this.state.showRenameGroupDialog&&(0,m.jsx)(za,{showRenameGroupDialog:this.state.showRenameGroupDialog,toggleRenameGroupDialog:this.toggleRenameGroupDialog,loadGroup:this.loadGroup,groupID:this.props.groupID,onGroupChanged:this.props.onGroupChanged,currentGroupName:r.name}),this.state.showDismissGroupDialog&&(0,m.jsx)(qa,{showDismissGroupDialog:this.state.showDismissGroupDialog,toggleDismissGroupDialog:this.toggleDismissGroupDialog,loadGroup:this.loadGroup,groupID:this.props.groupID,onGroupChanged:this.props.onGroupChanged}),this.state.showTransferGroupDialog&&(0,m.jsx)(Wa,{toggleTransferGroupDialog:this.toggleTransferGroupDialog,groupID:this.props.groupID,onGroupChanged:this.props.onGroupChanged}),this.state.showImportMembersDialog&&(0,m.jsx)(Ka,{toggleImportMembersDialog:this.toggleImportMembersDialog,importMembersInBatch:this.importMembersInBatch}),this.state.showManageMembersDialog&&(0,m.jsx)(ni,{toggleManageMembersDialog:this.toggleManageMembersDialog,groupID:this.props.groupID,onGroupChanged:this.props.onGroupChanged,isOwner:this.state.isOwner}),this.state.isLeaveGroupDialogOpen&&(0,m.jsx)(ri,{toggleLeaveGroupDialog:this.toggleLeaveGroupDialog,groupID:this.props.groupID,onGroupChanged:this.props.onGroupChanged})]})}}])}(s.Component),ai=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).handleInputChange=function(e){var t=e.target.value;n.setState({emails:t}),n.state.errorMsg&&n.setState({errorMsg:""})},n.handleKeyDown=function(e){13===e.keyCode&&(e.preventDefault(),n.handleSubmitInvite())},n.handleSubmitInvite=function(){var e=n.state.emails.trim();if(!e)return n.setState({errorMsg:(0,f.AP)("It is required.")}),!1;for(var t=[],r=0,o=(e=e.split(",")).length;r<o;r++){var a=e[r].trim();a&&t.push(a)}if(!t.length)return n.setState({errorMsg:(0,f.AP)("Email is invalid.")}),!1;n.setState({isSubmitting:!0}),S.e.invitePeople(t).then((function(e){n.props.toggleDialog();var t=e.data.success;if(t.length){var r="";r=1==t.length?(0,f.AP)("Successfully invited %(email).").replace("%(email)",t[0].accepter):(0,f.AP)("Successfully invited %(email) and %(num) other people.").replace("%(email)",t[0].accepter).replace("%(num)",t.length-1),E.A.success(r),n.props.onInvitePeople(t)}var o=e.data.failed;if(o.length)for(var a=0,i=o.length;a<i;a++){var s=o[a].email+": "+o[a].error_msg;E.A.danger(s)}})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t),n.props.toggleDialog()}))},n.state={emails:"",errorMsg:"",isSubmitting:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.state.isSubmitting;return(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.props.toggleDialog,children:[(0,m.jsx)(k.A,{toggle:this.props.toggleDialog,children:(0,f.AP)("Invite Guest")}),(0,m.jsxs)(M.A,{children:[(0,m.jsx)("label",{htmlFor:"emails",children:(0,f.AP)("Emails")}),(0,m.jsx)(I.A,{type:"text",id:"emails",placeholder:(0,f.AP)("Emails, separated by ','"),value:this.state.emails,onChange:this.handleInputChange,onKeyDown:this.handleKeyDown}),(0,m.jsx)("p",{className:"error mt-2",children:this.state.errorMsg})]}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(P.A,{color:"secondary",onClick:this.props.toggleDialog,children:(0,f.AP)("Cancel")}),(0,m.jsx)(P.A,{className:"submit-btn",color:"primary",onClick:this.handleSubmitInvite,disabled:e,children:e?(0,m.jsx)(Z.A,{}):(0,f.AP)("Submit")})]})]})}}])}(s.Component),ii=ai,si=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onRevokeInvitation=function(){n.setState({isSubmitting:!0}),S.e.revokeInvitation(n.props.token).then((function(e){n.props.revokeInvitation(),n.props.toggleDialog();var t=(0,f.AP)("Successfully revoked access of user {placeholder}.").replace("{placeholder}",n.props.accepter);E.A.success(t)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t),n.props.toggleDialog()}))},n.state={isSubmitting:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.toggleDialog,t=this.state.isSubmitting,n='<span class="op-target">'+h.Aq.HTMLescape(this.props.accepter)+"</span>",r=(0,f.AP)("Are you sure to revoke access of user {placeholder} ?").replace("{placeholder}",n);return(0,m.jsxs)(p.A,{isOpen:!0,toggle:e,children:[(0,m.jsx)(k.A,{toggle:e,children:(0,f.AP)("Revoke Access")}),(0,m.jsx)(M.A,{children:(0,m.jsx)("p",{dangerouslySetInnerHTML:{__html:r}})}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(P.A,{color:"secondary",onClick:e,children:(0,f.AP)("Cancel")}),(0,m.jsx)(P.A,{className:"submit-btn",color:"primary",onClick:this.onRevokeInvitation,disabled:t,children:t?(0,m.jsx)(Z.A,{}):(0,f.AP)("Submit")})]})]})}}])}(s.Component),li=si,ci=(n(82106),function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).toggleOpMenu=function(){n.setState({isOpMenuOpen:!n.state.isOpMenuOpen})},n.onMouseEnter=function(){n.setState({isOpIconShown:!0})},n.onMouseLeave=function(){n.setState({isOpIconShown:!1})},n.deleteItem=function(){n.setState({isOpIconShown:!1});var e=n.props.invitation.token;S.e.deleteInvitation(e).then((function(t){n.props.deleteItem(e),E.A.success((0,f.AP)("Successfully deleted 1 item."))})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t),n.setState({isOpIconShown:!0})}))},n.revokeItem=function(){var e=n.props.invitation.token;n.props.deleteItem(e)},n.toggleRevokeDialog=function(){n.setState({isRevokeDialogOpen:!n.state.isRevokeDialogOpen})},n.state={isOpIconShown:!1,isOpMenuOpen:!1,isRevokeDialogOpen:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.state,t=e.isOpIconShown,n=e.isRevokeDialogOpen,r=this.props.invitation;return(0,m.jsxs)(s.Fragment,{children:[this.props.isDesktop?(0,m.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onFocus:this.onMouseEnter,tabIndex:"0",children:[(0,m.jsx)("td",{children:r.accepter}),(0,m.jsx)("td",{children:K()(r.invite_time).format("YYYY-MM-DD")}),(0,m.jsx)("td",{children:K()(r.expire_time).format("YYYY-MM-DD")}),(0,m.jsx)("td",{children:r.accept_time&&(0,m.jsx)("i",{className:"sf2-icon-tick invite-accept-icon"})}),(0,m.jsx)("td",{children:t&&(r.accept_time?(0,m.jsx)("i",{role:"button",className:"action-icon sf3-font sf3-font-cancel-invitation",title:(0,f.AP)("Revoke Access"),"aria-label":(0,f.AP)("Revoke Access"),onClick:this.toggleRevokeDialog}):(0,m.jsx)("i",{role:"button",className:"action-icon sf2-icon-x3",title:(0,f.AP)("Delete"),"aria-label":(0,f.AP)("Delete"),onClick:this.deleteItem}))})]}):(0,m.jsxs)("tr",{children:[(0,m.jsxs)("td",{children:[r.accepter,(0,m.jsx)("br",{}),(0,m.jsxs)("span",{className:"item-meta-info",children:[K()(r.invite_time).format("YYYY-MM-DD"),(0,m.jsxs)("span",{className:"small",children:["(",(0,f.AP)("Invite Time"),")"]})]}),(0,m.jsxs)("span",{className:"item-meta-info",children:[K()(r.expire_time).format("YYYY-MM-DD"),(0,m.jsxs)("span",{className:"small",children:["(",(0,f.AP)("Expiration"),")"]})]}),(0,m.jsx)("span",{className:"item-meta-info",children:r.accept_time&&(0,f.AP)("Accepted")})]}),(0,m.jsx)("td",{children:(0,m.jsxs)(ue.A,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu,children:[(0,m.jsx)(de.A,{tag:"i",className:"sf-dropdown-toggle sf3-font sf3-font-more-vertical ml-0",title:(0,f.AP)("More operations"),"aria-label":(0,f.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),(0,m.jsxs)("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu,children:[(0,m.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),(0,m.jsx)("div",{className:"mobile-operation-menu",children:r.accept_time?(0,m.jsx)(pe.A,{className:"mobile-menu-item",onClick:this.toggleRevokeDialog,children:(0,f.AP)("Revoke Access")}):(0,m.jsx)(pe.A,{className:"mobile-menu-item",onClick:this.deleteItem,children:(0,f.AP)("Delete")})})]})]})})]}),n&&(0,m.jsx)(li,{accepter:r.accepter,token:r.token,revokeInvitation:this.revokeItem,toggleDialog:this.toggleRevokeDialog})]})}}])}(s.Component)),ui=function(e){function t(e){return(0,r.A)(this,t),(0,a.A)(this,t,[e])}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props.data,n=t.loading,r=t.errorMsg,o=t.invitationsList;if(n)return(0,m.jsx)(Z.A,{});if(r)return(0,m.jsx)("p",{className:"error text-center mt-2",children:r});if(!o.length)return(0,m.jsx)($.A,{title:(0,f.AP)("No guest invitations"),text:(0,f.AP)('You have not invited any guests yet. A guest can access shared libraries through the web interface allowing more efficient ways to collaborate than through links. You can invite a guest by clicking the "Invite Guest" button in the menu bar.')});var a=h.Aq.isDesktop();return(0,m.jsxs)("table",{className:"table-hover".concat(a?"":" table-thead-hidden"),children:[(0,m.jsx)("thead",{children:a?(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"25%",children:(0,f.AP)("Email")}),(0,m.jsx)("th",{width:"20%",children:(0,f.AP)("Invite Time")}),(0,m.jsx)("th",{width:"20%",children:(0,f.AP)("Expiration")}),(0,m.jsx)("th",{width:"18%",children:(0,f.AP)("Accepted")}),(0,m.jsx)("th",{width:"7%"})]}):(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"92%"}),(0,m.jsx)("th",{width:"8%"})]})}),(0,m.jsx)("tbody",{children:o.map((function(t,n){return(0,m.jsx)(ci,{isDesktop:a,invitation:t,deleteItem:e.props.deleteItem},n)}))})]})}}])}(s.Component),di=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onInvitePeople=function(e){e.push.apply(e,n.state.invitationsList),n.setState({invitationsList:e})},n.deleteItem=function(e){n.setState({invitationsList:n.state.invitationsList.filter((function(t){return t.token!=e}))})},n.toggleInvitePeopleDialog=function(){n.setState({isInvitePeopleDialogOpen:!n.state.isInvitePeopleDialogOpen})},n.state={loading:!0,errorMsg:"",invitationsList:[],isInvitePeopleDialogOpen:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;S.e.listInvitations().then((function(t){e.setState({invitationsList:t.data,loading:!1})})).catch((function(t){e.setState({loading:!1,errorMsg:h.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("div",{className:"main-panel-center flex-row",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)("div",{className:"cur-view-path",children:(0,m.jsxs)("div",{className:"d-flex",children:[(0,m.jsx)("h3",{className:"sf-heading",children:(0,f.AP)("Invite Guest")}),(0,m.jsx)(Ue,{opList:[{text:(0,f.AP)("Invite Guest"),onClick:this.toggleInvitePeopleDialog}]})]})}),(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsx)(ui,{data:this.state,deleteItem:this.deleteItem})})]})}),this.state.isInvitePeopleDialogOpen&&(0,m.jsx)(ii,{onInvitePeople:this.onInvitePeople,toggleDialog:this.toggleInvitePeopleDialog})]})}}])}(s.Component),pi=n(76154),fi=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).inputNewName=function(e){n.setState({name:e.target.value})},n.handleKeyDown=function(e){"Enter"===e.key&&n.handleSubmit()},n.handleSubmit=function(){var e=n.state.name.trim(),t=n.state.selectedOption?n.state.selectedOption.id:null;e&&(n.props.addWiki(e,t),n.props.toggleCancel())},n.toggle=function(){n.props.toggleCancel()},n.handleSelectChange=function(e){n.setState({selectedOption:e})},n.state={name:"",isSubmitBtnActive:!1,selectedOption:null,options:[]},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;f.am&&pi.A.listWikiDepartments().then((function(t){for(var n=t.data.sort((function(e,t){return e.name.toLowerCase()<t.name.toLowerCase()?-1:1})),r=[],o=0;o<n.length;o++){var a={};a.value=n[o].name,a.id=n[o].id,a.email=n[o].email,a.label=n[o].name,r.push(a)}if(e.setState({options:r}),e.props.currentDeptEmail){var i=r.find((function(t){return t.email==e.props.currentDeptEmail}));e.setState({selectedOption:i})}})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))}},{key:"render",value:function(){return(0,m.jsxs)(p.A,{isOpen:!0,autoFocus:!1,toggle:this.toggle,children:[(0,m.jsx)(k.A,{toggle:this.toggle,children:(0,f.AP)("Add Wiki")}),(0,m.jsxs)(M.A,{children:[(0,m.jsx)(wt.A,{children:(0,f.AP)("Name")}),(0,m.jsx)(I.A,{onKeyDown:this.handleKeyDown,autoFocus:!0,value:this.state.name,onChange:this.inputNewName}),f.am&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(wt.A,{className:"mt-4",children:[(0,f.AP)("Wiki owner")," (",(0,f.AP)("Optional"),")"]}),(0,m.jsx)(qt.by,{onChange:this.handleSelectChange,options:this.state.options,hideSelectedOptions:!0,placeholder:(0,f.AP)("Select a department"),maxMenuHeight:200,value:this.state.selectedOption,components:{NoOptionsMessage:(0,m.jsx)("div",{style:{margin:"6px 10px",textAlign:"center",color:"hsl(0,0%,50%)"},children:(0,f.AP)("No department")})},noOptionsMessage:function(){return(0,f.AP)("No options available")}})]})]}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(P.A,{color:"secondary",onClick:this.toggle,children:(0,f.AP)("Cancel")}),(0,m.jsx)(P.A,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.name.trim(),children:(0,f.AP)("Submit")})]})]})}}])}(s.Component),hi=fi;var mi=function(e){var t=e.handleSubmit,n=e.toggleCancel,r=e.title,o=e.content,a=e.footer;return(0,m.jsxs)(p.A,{isOpen:!0,toggle:n,children:[(0,m.jsx)(k.A,{toggle:n,children:r}),(0,m.jsx)(M.A,{children:o}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(P.A,{color:"secondary",onClick:n,children:(0,f.AP)("Cancel")}),(0,m.jsx)(P.A,{color:"primary",onClick:t,children:a})]})]})},gi=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).handleChange=function(e){n.setState({isSubmitBtnActive:!!e.target.value.trim(),newName:e.target.value})},n.handleSubmit=function(){var e=n.validateInput(),t=e.isValid,r=e.errMessage;t?n.props.onRename(n.state.newName.trim()):n.setState({errMessage:r})},n.handleKeyDown=function(e){"Enter"===e.key&&n.handleSubmit()},n.toggle=function(){n.props.toggleCancel()},n.validateInput=function(){var e=n.state.newName.trim(),t=!0,r="";return e?e.indexOf("/")>-1?{isValid:t=!1,errMessage:r=(0,f.AP)("Name should not include '/'.")}:{isValid:t,errMessage:r}:{isValid:t=!1,errMessage:r=(0,f.AP)("Name is required.")}},n.state={newName:e.wiki.name,errMessage:"",isSubmitBtnActive:!1},n.newInput=s.createRef(),n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.toggle,children:[(0,m.jsx)(k.A,{toggle:this.toggle,children:(0,f.AP)("Rename Wiki")}),(0,m.jsxs)(M.A,{children:[(0,m.jsx)("p",{children:(0,f.AP)("New Wiki name")}),(0,m.jsx)(I.A,{onKeyDown:this.handleKeyDown,innerRef:this.newInput,placeholder:"newName",value:this.state.newName,onChange:this.handleChange}),this.state.errMessage&&(0,m.jsx)(St.A,{color:"danger",className:"mt-2",children:this.state.errMessage})]}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(P.A,{color:"secondary",onClick:this.toggle,children:(0,f.AP)("Cancel")}),(0,m.jsx)(P.A,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive,children:(0,f.AP)("Submit")})]})]})}}])}(s.Component),vi=n(88438),yi=n(72170),Ci=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).toggle=function(e){n.state.activeTab!==e&&n.setState({activeTab:e})},n.onAddCustomPermissionToggle=function(){n.toggle("customSharePermission")},n.renderDirContent=function(){if(!n.state.isRepoJudgemented)return(0,m.jsx)(Z.A,{});var e=n.state.activeTab,t=n.props,r=t.repoEncrypted,o=t.enableDirPrivateShare,a=t.itemType;return r&&(o="library"==a),(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("div",{className:"share-dialog-side",children:(0,m.jsx)(Tt.A,{pills:!0,children:o&&(0,m.jsxs)(s.Fragment,{children:[f.Ih&&(0,m.jsx)(Ot.A,{role:"tab","aria-selected":"shareToUser"===e,"aria-controls":"share-to-user-panel",children:(0,m.jsx)(jt.A,{className:"shareToUser"===e?"active":"",onClick:n.toggle.bind(n,"shareToUser"),tabIndex:"0",onKeyDown:n.onTabKeyDown,children:(0,f.AP)("Share to user")})}),f.Ih&&(0,m.jsx)(Ot.A,{role:"tab","aria-selected":"shareToGroup"===e,"aria-controls":"share-to-group-panel",children:(0,m.jsx)(jt.A,{className:"shareToGroup"===e?"active":"",onClick:n.toggle.bind(n,"shareToGroup"),tabIndex:"0",onKeyDown:n.onTabKeyDown,children:(0,f.AP)("Share to group")})})]})})}),(0,m.jsx)("div",{className:"share-dialog-main",children:(0,m.jsx)(Rt.A,{activeTab:n.state.activeTab,children:o&&(0,m.jsxs)(s.Fragment,{children:["shareToUser"===e&&f.Ih&&(0,m.jsx)(Lt.A,{tabId:"shareToUser",role:"tabpanel",id:"share-to-user-panel",children:(0,m.jsx)(vi.A,{itemType:n.props.itemType,isGroupOwnedRepo:n.state.isGroupOwnedRepo,itemPath:n.props.itemPath,repoID:n.props.repoID,isRepoOwner:n.state.isRepoOwner,repoType:n.state.repoType,onAddCustomPermissionToggle:n.onAddCustomPermissionToggle})}),"shareToGroup"===e&&f.Ih&&(0,m.jsx)(Lt.A,{tabId:"shareToGroup",role:"tabpanel",id:"share-to-group-panel",children:(0,m.jsx)(yi.A,{itemType:n.props.itemType,isGroupOwnedRepo:n.state.isGroupOwnedRepo,itemPath:n.props.itemPath,repoID:n.props.repoID,isRepoOwner:n.state.isRepoOwner,repoType:n.state.repoType,onAddCustomPermissionToggle:n.onAddCustomPermissionToggle})})]})})})]})},n.onTabKeyDown=function(e){"Enter"!=e.key&&"Space"!=e.key||e.target.click()},n.renderExternalShareMessage=function(){return f.Ts&&"object"===typeof f.Ts?(0,m.jsxs)("div",{className:"external-share-message mt-2",children:[(0,m.jsx)("h6",{children:f.Ts.title}),(0,m.jsx)("p",{style:{fontSize:"14px",color:"#666"},className:"text-wrap m-0",children:f.Ts.content})]}):null},n.state={activeTab:"shareToUser",isRepoJudgemented:!1,isRepoOwner:!1,isGroupOwnedRepo:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.repoID;S.e.getRepoInfo(t).then((function(t){var n=t.data.owner_email.indexOf("@seafile_group")>-1,r=t.data.owner_email===f.Xh;e.setState({isRepoJudgemented:!0,isRepoOwner:r,repoType:t.data.repo_type,isGroupOwnedRepo:n})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))}},{key:"render",value:function(){var e=this.props,t=e.itemType,n=e.itemName;return(0,m.jsx)("div",{children:(0,m.jsxs)(p.A,{isOpen:!0,style:{maxWidth:"760px"},className:"share-dialog",toggle:this.props.toggleDialog,children:[(0,m.jsxs)(k.A,{toggle:this.props.toggleDialog,tag:"div",children:[(0,m.jsxs)("h5",{className:"text-truncate",children:[(0,f.AP)("Share")," ",(0,m.jsx)("span",{className:"op-target",title:n,children:n})]}),this.renderExternalShareMessage()]}),(0,m.jsx)(M.A,{className:"share-dialog-content",role:"tablist",children:"library"===t&&this.renderDirContent()})]})})}}])}(s.Component),Ai=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).handleChange=function(e){n.setState({isSubmitBtnActive:!!e.target.value.trim(),url:e.target.value})},n.handleSubmit=function(){var e=n.validateInput(),t=e.isValid,r=e.errMessage;t?n.props.onPublish(n.state.url.trim()):n.setState({errMessage:r,url:f.xW+"/wiki/publish/"})},n.deleteCustomUrl=function(){var e=n.props.wiki.id;pi.A.deletePublishWikiLink(e).then((function(e){n.setState({url:f.xW+"/wiki/publish/"}),E.A.success((0,f.AP)("Successfully."))})).catch((function(e){if(e.response){var t=e.response.data.error_msg;E.A.danger(t)}}))},n.handleKeyDown=function(e){"Enter"===e.key&&n.handleSubmit()},n.toggle=function(){n.props.toggleCancel()},n.validateInput=function(){var e=n.state.url.trim(),t=!0,r="";return e?e.includes(f.xW+"/wiki/publish/")?{isValid:t,errMessage:r}:{isValid:t=!1,errMessage:r=(0,f.AP)("url  need include specific prefix.")}:{isValid:t=!1,errMessage:r=(0,f.AP)("url is required.")}},n.copyLink=function(){nn()(n.state.url),E.A.success((0,f.AP)("URL is copied to the clipboard"))},n.state={url:f.xW+"/wiki/publish/"+n.props.customUrl,errMessage:"",isSubmitBtnActive:!1},n.newInput=s.createRef(),n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.toggle,children:[(0,m.jsx)(k.A,{toggle:this.toggle,children:(0,f.AP)("Publish Wiki")}),(0,m.jsxs)(M.A,{children:[(0,m.jsx)("p",{children:(0,f.AP)("Customize URL")}),(0,m.jsxs)(Ft.A,{children:[(0,m.jsx)(I.A,{onKeyDown:this.handleKeyDown,innerRef:this.newInput,placeholder:"customize url",value:this.state.url,onChange:this.handleChange}),(0,m.jsx)(Ut.A,{addonType:"append",children:(0,m.jsx)(P.A,{color:"primary",onClick:this.copyLink,className:"border-0",children:(0,f.AP)("Copy")})})]}),(0,m.jsx)("span",{className:"tip mb-1",style:{fontSize:"14px"},children:(0,f.AP)("The custom part of the URL must be between 5 and 30 characters long and may only contain letters (a-z), numbers, and hyphens.")}),this.state.errMessage&&(0,m.jsx)(St.A,{color:"danger",className:"mt-2",children:this.state.errMessage})]}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(P.A,{color:"secondary",onClick:this.deleteCustomUrl,disabled:""===this.props.customUrl,children:(0,f.AP)("Delete")}),(0,m.jsx)(P.A,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive,children:(0,f.AP)("Submit")})]})]})}}])}(s.Component),xi=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onRenameToggle=function(e){n.setState({isShowRenameDialog:!n.state.isShowRenameDialog})},n.onShareToggle=function(e){n.setState({isShowShareDialog:!n.state.isShowShareDialog})},n.onDeleteToggle=function(e){e.preventDefault(),n.setState({isShowDeleteDialog:!n.state.isShowDeleteDialog})},n.onPublishToggle=function(e){n.getPublishWikiLink()},n.onDeleteCancel=function(){n.setState({isShowDeleteDialog:!n.state.isShowDeleteDialog})},n.deleteWiki=function(){var e=n.props.wiki;n.props.deleteWiki(e),n.setState({isShowDeleteDialog:!n.state.isShowDeleteDialog})},n.onItemUnshare=function(){var e=n.props.wiki;n.props.unshareGroupWiki(e,n.props.group.group_id),n.setState({isShowDeleteDialog:!n.state.isShowDeleteDialog})},n.renameWiki=function(e){n.props.wiki.name!==e&&n.props.renameWiki(n.props.wiki,e),n.setState({isShowRenameDialog:!1})},n.publishWiki=function(e){var t=e.indexOf("/publish/"),r=e.substring(t+9);pi.A.publishWiki(n.props.wiki.id,r).then((function(e){var t=e.data.publish_url;n.setState({customUrl:t}),E.A.success((0,f.AP)("Successfully."))})).catch((function(e){if(e.response){var t=e.response.data.error_msg;E.A.danger(t)}}))},n.getPublishWikiLink=function(){pi.A.getPublishWikiLink(n.props.wiki.id).then((function(e){var t=e.data.publish_url;n.setState({customUrl:t,isShowPublishDialog:!n.state.isShowPublishDialog})})).catch((function(e){if(n.setState({isShowPublishDialog:!n.state.isShowPublishDialog}),e.response){var t=e.response.data.error_msg;E.A.danger(t)}}))},n.clickWikiCard=function(e){window.open(e)},n.toggleDropDownMenu=function(){n.setState({isItemMenuShow:!n.state.isItemMenuShow})},n.onClickDropdown=function(e){e.preventDefault(),e.stopPropagation()},n.renderAvatar=function(){var e=n.props.wiki,t=e.owner_nickname,r=e.owner_avatar_url;return(0,m.jsxs)("div",{className:"wiki-card-item-avatar-container",children:[(0,m.jsx)("img",{className:"wiki-card-item-avatar",src:r,alt:t}),(0,m.jsx)("span",{className:"wiki-card-item-owner text-truncate",title:t,children:t})]})},n.renderDept=function(){var e=n.props.wiki;return(0,m.jsxs)("div",{className:"wiki-card-item-avatar-container",children:[(0,m.jsx)("span",{className:"sf3-font-department sf3-font nav-icon"}),(0,m.jsx)("span",{className:"wiki-card-item-owner text-truncate",title:e.owner_nickname,children:e.owner_nickname})]})},n.state={isShowDeleteDialog:!1,isShowRenameDialog:!1,isItemMenuShow:!1,isShowShareDialog:!1,isShowPublishDialog:!1,customUrl:""},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.wiki,n=e.isDepartment,r=e.isShowAvatar,o=!1;t.admins&&(o=t.admins.includes(f.Xh));var a=!1;this.props.group&&(a=t.owner.split("@")[0]===this.props.group.group_id.toString());var i=f.Xh===t.owner,s="v2"!==t.version,l="".concat(f.Yc,"published/").concat(encodeURIComponent(t.slug),"/"),c="".concat(f.Yc,"wikis/").concat(t.id,"/"),u=s?"".concat(t.name," (old version)"):t.name,d=!1,p=!1,h=!1,g=!1,v=!1,y=!1;return n?o&&(a?(h=!0,p=!0,d=!0,y=!0):g=!0):o||i?(p=!0,h=!0,d=!0,y=!0):g=!0,(s||d||p||h||g)&&(v=!0),(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{className:"wiki-card-item ".concat(this.state.isItemMenuShow?"wiki-card-item-menu-open":""),onClick:this.clickWikiCard.bind(this,s?l:c),children:[(0,m.jsxs)("div",{className:"wiki-card-item-top",children:[(0,m.jsx)("span",{className:"sf3-font-wiki sf3-font","aria-hidden":"true"}),v&&(0,m.jsxs)(ue.A,{isOpen:this.state.isItemMenuShow,toggle:this.toggleDropDownMenu,onClick:this.onClickDropdown,children:[(0,m.jsx)(de.A,{tag:"i",role:"button",tabIndex:"0",className:"sf-dropdown-toggle sf3-font-more sf3-font",title:(0,f.AP)("More operations"),"aria-label":(0,f.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isItemMenuShow,"aria-haspopup":!0,style:{minWidth:"0"}}),(0,m.jsxs)(Fe.A,{right:!0,className:"dtable-dropdown-menu",children:[d&&(0,m.jsx)(pe.A,{onClick:this.onRenameToggle,children:(0,f.AP)("Rename")}),y&&(0,m.jsx)(pe.A,{onClick:this.onPublishToggle,children:(0,f.AP)("Publish")}),p&&(0,m.jsx)(pe.A,{onClick:this.onShareToggle,children:(0,f.AP)("Share")}),s&&(0,m.jsx)(pe.A,{onClick:this.onDeleteToggle,children:(0,f.AP)("Unpublish")}),h&&(0,m.jsx)(pe.A,{onClick:this.onDeleteToggle,children:(0,f.AP)("Delete")}),g&&(0,m.jsx)(pe.A,{onClick:this.onDeleteToggle,children:(0,f.AP)("Leave")})]})]})]}),(0,m.jsx)("div",{className:"wiki-item-name text-truncate",title:u,"aria-label":u,children:u}),(0,m.jsx)("div",{className:"wiki-item-owner",children:r&&(n?this.renderDept():this.renderAvatar())}),(0,m.jsxs)("div",{className:"wiki-item-updated-time",children:[K()(t.updated_at).fromNow(),t.is_published&&(0,m.jsx)("span",{style:{marginLeft:"25%"},children:"published"})]})]}),this.state.isShowDeleteDialog&&(0,m.jsxs)(te.A,{children:[s&&(0,m.jsx)(mi,{toggleCancel:this.onDeleteCancel,handleSubmit:this.deleteWiki,title:(0,f.AP)("Unpublish Wiki"),content:(0,m.jsxs)("p",{children:[(0,f.AP)("Are you sure you want to unpublish Wiki")," ",(0,m.jsx)("b",{children:t.name})," ?"]}),footer:(0,f.AP)("Unpublish")}),n&&a?(0,m.jsx)(mi,{toggleCancel:this.onDeleteCancel,handleSubmit:this.deleteWiki,title:(0,f.AP)("Delete Wiki"),content:(0,m.jsxs)("p",{children:[(0,f.AP)("Are you sure you want to delete Wiki")," ",(0,m.jsx)("b",{children:t.name})," ?"]}),footer:(0,f.AP)("Delete")}):n?(0,m.jsx)(mi,{toggleCancel:this.onDeleteCancel,handleSubmit:this.onItemUnshare,title:(0,f.AP)("Leave Share Wiki"),content:(0,m.jsxs)("p",{children:[(0,f.AP)("Are you sure you want to leave share Wiki")," ",(0,m.jsx)("b",{children:t.name})," ?"]}),footer:(0,f.AP)("Leave")}):i?(0,m.jsx)(mi,{toggleCancel:this.onDeleteCancel,handleSubmit:this.deleteWiki,title:(0,f.AP)("Delete Wiki"),content:(0,m.jsxs)("p",{children:[(0,f.AP)("Are you sure you want to delete Wiki")," ",(0,m.jsx)("b",{children:t.name})," ?"]}),footer:(0,f.AP)("Delete")}):(0,m.jsx)(mi,{toggleCancel:this.onDeleteCancel,handleSubmit:this.deleteWiki,title:(0,f.AP)("Leave Share Wiki"),content:(0,m.jsxs)("p",{children:[(0,f.AP)("Are you sure you want to leave share Wiki")," ",(0,m.jsx)("b",{children:t.name})," ?"]}),footer:(0,f.AP)("Leave")})]}),this.state.isShowRenameDialog&&(0,m.jsx)(te.A,{children:(0,m.jsx)(gi,{toggleCancel:this.onRenameToggle,onRename:this.renameWiki,wiki:t})}),this.state.isShowShareDialog&&(0,m.jsx)(te.A,{children:(0,m.jsx)(Ci,{itemType:"library",itemName:t.name,itemPath:"/",repoID:t.repo_id,repoEncrypted:!1,enableDirPrivateShare:!0,toggleDialog:this.onShareToggle})}),this.state.isShowPublishDialog&&(0,m.jsx)(te.A,{children:(0,m.jsx)(Ai,{toggleCancel:this.onPublishToggle,onPublish:this.publishWiki,wiki:t,customUrl:this.state.customUrl})})]})}}])}(s.Component);var bi=function(e){return(0,m.jsxs)("div",{className:"wiki-card-item wiki-card-item-add d-flex flex-column align-items-center justify-content-center",onClick:e.toggelAddWikiDialog,children:[(0,m.jsx)("span",{children:"+"}),(0,m.jsx)("span",{children:(0,f.AP)("Add Wiki")})]})},_i=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).getContainerWidth=function(){var e=n.props,t=e.sidePanelRate;return e.isSidePanelFolded?window.innerWidth-j.xQ:window.innerWidth*(1-t)},n.onResize=function(){if(!h.Fr){var e=n.getContainerWidth(),t=Math.floor(e/180),r=(Math.floor((e-16*(t+1))/t)+"px ").repeat(t);n.groupItemsRef.current&&(n.groupItemsRef.current.style.gridTemplateColumns=r)}},n.groupItemsRef=s.createRef(),n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.onResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onResize)}},{key:"render",value:function(){var e=this,t=this.props,n=t.wikis,r=t.title,o=t.isDepartment,a=t.toggelAddWikiDialog,i=t.group,s=this.getContainerWidth(),l=Math.floor(s/180),c=(Math.floor((s-16*(l+1))/l)+"px ").repeat(l),u=!1,d=!1;return i&&(u=!0,d="system admin"===i.owner),(0,m.jsxs)("div",{className:"wiki-card-group mb-4",children:[(0,m.jsxs)("h4",{className:"sf-heading",children:[(0,m.jsx)("span",{className:"sf3-font nav-icon sf3-font-".concat(o&&d?"department":o?"group":"mine"),"aria-hidden":"true"}),r]}),(0,m.jsxs)("div",{className:"wiki-card-group-items",style:{gridTemplateColumns:h.Fr?"48% 48%":c},ref:this.groupItemsRef,children:[n.map((function(t,n){return u?(0,m.jsx)(xi,{group:i,wiki:t,deleteWiki:e.props.deleteWiki,unshareGroupWiki:e.props.unshareGroupWiki,isDepartment:o,isShowAvatar:e.props.isShowAvatar,renameWiki:e.props.renameWiki},n+t.id+t.name):(0,m.jsx)(xi,{wiki:t,deleteWiki:e.props.deleteWiki,unshareGroupWiki:e.props.unshareGroupWiki,isDepartment:o,isShowAvatar:e.props.isShowAvatar,renameWiki:e.props.renameWiki},n+t.id+t.name)})),a&&(0,m.jsx)(bi,{toggelAddWikiDialog:a})]})]})}}])}(s.Component),wi=_i,Si=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).classifyWikis=function(e){for(var t=[],n=[],r=[],o={},a=0;a<e.length;a++)"v1"===e[a].version?t.push(e[a]):e[a].owner===f.Xh?n.push(e[a]):"shared"===e[a].type?r.push(e[a]):(o[e[a].owner]||(o[e[a].owner]=[]),o[e[a].owner].push(e[a]));return{department2WikisMap:o,myWikis:n,v1Wikis:t,sharedWikis:r}},n.state={departmentMap:{}},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;if(f.EL&&f.am){var t={};pi.A.listWikiDepartments().then((function(n){n.data.forEach((function(e){return t[e.id]=!0})),e.setState({departmentMap:t})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))}}},{key:"render",value:function(){var e=this.props.data,t=e.loading,n=e.errorMsg,r=e.wikis,o=e.groupWikis,a=this.props,i=a.toggelAddWikiDialog,s=a.sidePanelRate,l=a.isSidePanelFolded;if(t)return(0,m.jsx)("span",{className:"loading-icon loading-tip"});if(n)return(0,m.jsx)("p",{className:"error text-center",children:n});var c=this.classifyWikis(r),u=c.v1Wikis,d=c.myWikis,p=c.sharedWikis,h=[];for(var g in h.push((0,m.jsx)(wi,{deleteWiki:this.props.deleteWiki,renameWiki:this.props.renameWiki,unshareGroupWiki:this.props.unshareGroupWiki,sidePanelRate:s,isSidePanelFolded:l,wikis:d,title:(0,f.AP)("My Wikis"),isDepartment:!1,isShowAvatar:!1,toggelAddWikiDialog:f.EL?i.bind(this,null):null},"my-Wikis")),h.push((0,m.jsx)(wi,{deleteWiki:this.props.leaveSharedWiki,renameWiki:this.props.renameWiki,unshareGroupWiki:this.props.unshareGroupWiki,wikis:p,title:(0,f.AP)("Shared with me"),isDepartment:!1,isShowAvatar:!1,sidePanelRate:s,isSidePanelFolded:l,toggelAddWikiDialog:null},"shared-Wikis")),o)0!==o[g].wiki_info.length&&h.push((0,m.jsx)(wi,{deleteWiki:this.props.deleteWiki,unshareGroupWiki:this.props.unshareGroupWiki,renameWiki:this.props.renameWiki,sidePanelRate:s,isSidePanelFolded:l,group:o[g],wikis:o[g].wiki_info,title:o[g].group_name,isDepartment:!0,isShowAvatar:!1,toggelAddWikiDialog:f.EL&&this.state.departmentMap[o[g].group_id]?i.bind(this,g):null},"group-Wikis-"+g));return h.push((0,m.jsx)(wi,{deleteWiki:this.props.deleteWiki,renameWiki:this.props.renameWiki,unshareGroupWiki:this.props.unshareGroupWiki,isSidePanelFolded:l,sidePanelRate:s,wikis:u,title:(0,f.AP)("Old Wikis"),isDepartment:!1,isShowAvatar:!0},"old-Wikis")),h}}])}(s.Component),Di=Si,Ei=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).getWikis=function(){var e=[],t=[];pi.A.listWikis().then((function(r){(e=e.concat(r.data.data)).map((function(e){return e.version="v1"})),pi.A.listWikis2().then((function(r){var o=r.data.wikis;(t=r.data.group_wikis).forEach((function(e){e.wiki_info.forEach((function(t){t.version="v2",t.admins=e.group_admins}))})),o.map((function(e){return e.version="v2"})),n.setState({loading:!1,wikis:e.concat(o),groupWikis:t})})).catch((function(e){n.setState({loading:!1,errorMsg:h.Aq.getErrorMsg(e,!0)})}))})).catch((function(e){n.setState({loading:!1,errorMsg:h.Aq.getErrorMsg(e,!0)})}))},n.clickMenuToggle=function(e){e.preventDefault(),n.onMenuToggle()},n.onMenuToggle=function(){n.setState({isShowAddWikiMenu:!n.state.isShowAddWikiMenu})},n.toggelAddWikiDialog=function(e){n.state.isShowAddDialog?n.setState({isShowAddDialog:!1,currentDeptEmail:""}):n.setState({isShowAddDialog:!0,currentDeptEmail:e})},n.addWiki=function(e,t){pi.A.addWiki2(e,t).then((function(e){var r=n.state.wikis.slice(0),o=n.state.groupWikis,a=e.data;a.version="v2",t?o.filter((function(e){return e.group_id===t&&e.wiki_info.push(a),e})):r.push(a),n.setState({wikis:r,currentDeptEmail:"",groupWikis:o,currentDeptID:""})})).catch((function(e){if(e.response){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}}))},n.deleteWiki=function(e){"v1"===e.version?pi.A.deleteWiki(e.id).then((function(){var t=n.state.wikis.filter((function(t){return t.id!==e.id})),r=n.state.groupWikis.filter((function(t){return t.wiki_info=t.wiki_info.filter((function(t){return t.name!==e.name})),t}));n.setState({wikis:t,groupWikis:r})})).catch((function(e){if(e.response){var t=e.response.data.error_msg;E.A.danger(t)}})):pi.A.deleteWiki2(e.id).then((function(){var t=n.state.wikis.filter((function(t){return t.id!==e.id})),r=n.state.groupWikis.filter((function(t){return t.wiki_info=t.wiki_info.filter((function(t){return t.name!==e.name})),t}));n.setState({wikis:t,groupWikis:r})})).catch((function(e){if(e.response){var t=e.response.data.error_msg;E.A.danger(t)}}))},n.leaveSharedWiki=function(e){if(e.owner.includes("@seafile_group"))S.e.leaveShareGroupOwnedRepo(e.repo_id).then((function(t){var r=n.state.wikis.filter((function(t){return t.name!==e.name}));n.setState({wikis:r})})).catch((function(e){var t=h.Aq.getErrorMsg(e,!0);E.A.danger(t)}));else{var t={share_type:"personal",from:e.owner};S.e.leaveShareRepo(e.repo_id,t).then((function(t){var r=n.state.wikis.filter((function(t){return t.name!==e.name}));n.setState({wikis:r})})).catch((function(e){var t=h.Aq.getErrorMsg(e,!0);E.A.danger(t)}))}},n.unshareGroupWiki=function(e,t){S.e.unshareRepoToGroup(e.repo_id,t).then((function(){var r=n.state.groupWikis.map((function(n){return n.group_id===t?(0,ur.A)((0,ur.A)({},n),{},{wiki_info:n.wiki_info.filter((function(t){return t.name!==e.name}))}):n}));n.setState({groupWikis:r})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.renameWiki=function(e,t){"v1"===e.version?pi.A.renameWiki(e.id,t).then((function(){var r=n.state.wikis.map((function(n){return n.id===e.id&&"v1"===n.version&&(n.name=t),n}));n.setState({wikis:r})})).catch((function(e){if(e.response){var t=e.response.data.error_msg;E.A.danger(t)}})):pi.A.renameWiki2(e.id,t).then((function(){n.getWikis()})).catch((function(e){if(e.response){var t=e.response.data.error_msg;E.A.danger(t)}}))},n.toggleDropdownMenu=function(e){e.stopPropagation(),n.setState({isDropdownMenuShown:!n.state.isDropdownMenuShown})},n.state={loading:!0,errorMsg:"",currentDeptEmail:"",wikis:[],groupWikis:[],isShowAddWikiMenu:!1,isShowAddDialog:!1,isDropdownMenuShown:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.getWikis()}},{key:"render",value:function(){var e=this;return(0,m.jsxs)(s.Fragment,{children:[this.state.isShowAddDialog&&(0,m.jsx)(te.A,{children:(0,m.jsx)(hi,{toggleCancel:this.toggelAddWikiDialog,addWiki:this.addWiki,currentDeptEmail:this.state.currentDeptEmail})}),(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",id:"wikis",children:[(0,m.jsx)("div",{className:"cur-view-path",children:(0,m.jsxs)("div",{className:"path-container",children:[(0,m.jsx)("h3",{className:"sf-heading m-0",children:(0,f.AP)("Wikis")}),f.EL&&(0,m.jsxs)(ue.A,{direction:"down",className:"add-wiki-dropdown",isOpen:this.state.isDropdownMenuShown,toggle:this.toggleDropdownMenu,onMouseMove:function(e){e.stopPropagation()},children:[(0,m.jsx)(de.A,{tag:"i",className:"px-1",children:(0,m.jsx)("span",{className:"sf3-font sf3-font-down","aria-hidden":"true"})}),(0,m.jsx)(Fe.A,{positionFixed:!0,children:(0,m.jsx)(pe.A,{onClick:function(){e.toggelAddWikiDialog()},children:(0,f.AP)("Add Wiki")})})]})]})}),(this.state.loading||0!==this.state.wikis.length||0!==this.state.groupWikis.length)&&(0,m.jsx)("div",{className:"cur-view-content pb-4",children:(0,m.jsx)(Di,{data:this.state,deleteWiki:this.deleteWiki,leaveSharedWiki:this.leaveSharedWiki,unshareGroupWiki:this.unshareGroupWiki,renameWiki:this.renameWiki,toggelAddWikiDialog:this.toggelAddWikiDialog,sidePanelRate:this.props.sidePanelRate,isSidePanelFolded:this.props.isSidePanelFolded})}),!this.state.loading&&0===this.state.wikis.length&&0===this.state.groupWikis.length&&(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsxs)($.A,{title:(0,f.AP)("No Wikis"),children:[(0,m.jsx)("p",{className:"empty-tip-text",children:(0,f.AP)("You do not have any wikis yet.")}),(0,m.jsx)("p",{className:"empty-tip-text",children:(0,f.AP)('You can add a wiki by clicking the "Add Wiki" button in the menu.')})]})})]})})]})}}])}(s.Component),ki=Ei,Mi=function(e){function t(){var e;(0,r.A)(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(e=(0,a.A)(this,t,[].concat(o))).toggle=function(){e.props.toggleDialog()},e}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return(0,m.jsx)(p.A,{isOpen:!0,toggle:this.toggle,children:(0,m.jsxs)(M.A,{children:[(0,m.jsx)("button",{type:"button",className:"close text-gray",onClick:this.toggle,children:(0,m.jsx)("span",{"aria-hidden":"true",children:"\xd7"})}),(0,m.jsxs)("div",{className:"p-2 text-center",children:[(0,m.jsx)("img",{src:"".concat(f.SG,"img/welcome.png"),width:"408",alt:""}),(0,m.jsx)("h3",{id:"dialogTitle",className:"mt-6 mb-4",children:(0,f.AP)("Welcome to {site_name_placeholder}").replace("{site_name_placeholder}",f.pu)}),f._s?(0,m.jsx)("p",{children:(0,f.AP)("{site_name_placeholder} organizes files into libraries. Each library can be synced and shared separately. We have created a personal library for you. You can create more libraries later.").replace("{site_name_placeholder}",f.pu)}):(0,m.jsx)("p",{children:(0,f.AP)("{site_name_placeholder} organizes files into libraries. Each library can be synced and shared separately. However, since you are a guest user now, you can not create libraries.").replace("{site_name_placeholder}",f.pu)})]})]})})}}])}(s.Component),Ii=Mi,Ni=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onItemUnshare=function(e){var t=n.props.group;S.e.unshareRepoToGroup(e.repo_id,t.id).then((function(){t.repos=t.repos.filter((function(t){return t.repo_id!==e.repo_id})),n.props.updateGroup(t)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.onItemDelete=function(e){var t=n.props.group;t.repos=t.repos.filter((function(t){return t.repo_id!==e.repo_id})),n.props.updateGroup(t)},n.onItemRename=function(e,t){var r=n.props.group;S.e.renameGroupOwnedLibrary(r.id,e.repo_id,t).then((function(r){var o=n.props.group;o.repos=o.repos.map((function(n){return n.repo_id===e.repo_id&&(n.repo_name=t),n})),n.props.updateGroup(o)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.onMonitorRepo=function(e,t){var r=n.props.group;r.repos=r.repos.map((function(n){return n.repo_id===e.repo_id&&(n.monitored=t),n})),n.props.updateGroup(r)},n.toggleCreateRepoDialog=function(){n.setState({isCreateRepoDialogOpen:!n.state.isCreateRepoDialogOpen})},n.onCreateRepo=function(e){var t=n.props.group,r=t.id,o=t.repos;S.e.createGroupOwnedLibrary(r,e).then((function(e){var r={repo_id:e.data.id,repo_name:e.data.name,owner_name:e.data.group_name,owner_email:e.data.owner,permission:e.data.permission,mtime:e.data.mtime,size:e.data.size,encrypted:e.data.encrypted},a=new Ke(r);o.unshift(a),n.props.updateGroup(t)})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)})),n.toggleCreateRepoDialog()},n.state={isCreateRepoDialogOpen:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.inAllLibs,n=void 0!==t&&t,r=e.group,o=e.currentViewMode,a=void 0===o?tt.Tb:o,i=r.parent_group_id,s=r.admins,l=(0,m.jsx)("p",{className:"libraries-empty-tip-in-".concat(a,"-mode"),children:(0,f.AP)("No libraries")}),c=0!=i&&s.indexOf(f.Xh)>-1;return(0,m.jsxs)("div",{className:"pb-3",children:[(0,m.jsx)("div",{className:"d-flex justify-content-between mt-3 py-1 ".concat(a==tt.Tb?"sf-border-bottom":""),children:(0,m.jsxs)("h4",{className:"sf-heading m-0 d-flex align-items-center",children:[(0,m.jsx)("span",{className:"".concat(0==r.parent_group_id?"sf3-font-group":"sf3-font-department"," sf3-font nav-icon"),"aria-hidden":"true"}),(0,m.jsx)("a",{href:"".concat(f.Yc,"group/").concat(r.id,"/"),title:r.name,className:"ellipsis",children:r.name}),c&&(0,m.jsx)(Ue,{opList:[{text:(0,f.AP)("New Library"),onClick:this.toggleCreateRepoDialog}]})]})}),0===r.repos.length?l:(0,m.jsx)(Nn,{inAllLibs:n,theadHidden:!0,isShowRepoOwner:!1,currentGroup:this.props.group,repoList:r.repos,onItemUnshare:this.onItemUnshare,onItemDelete:this.onItemDelete,onItemRename:this.onItemRename,onMonitorRepo:this.onMonitorRepo,currentViewMode:a}),this.state.isCreateRepoDialogOpen&&(0,m.jsx)(xn,{onCreateToggle:this.toggleCreateRepoDialog,onCreateRepo:this.onCreateRepo,libraryType:"department"})]})}}])}(s.Component),Pi=Ni,Ti=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).sortRepos=function(e,t){var r=h.Aq.sortRepos(e,n.state.sortBy,n.state.sortOrder),o=r.filter((function(e){return"mine"===e.type})),a=r.filter((function(e){return"shared"===e.type})),i=r.filter((function(e){return"public"===e.type}));return{allRepoList:r,myRepoList:o,sharedRepoList:a,publicRepoList:i,groupList:t.map((function(e){return e.repos=h.Aq.sortRepos(e.repos,n.state.sortBy,n.state.sortOrder),e}))}},n.toggleSortOptionsDialog=function(){n.setState({isSortOptionsDialogOpen:!n.state.isSortOptionsDialogOpen})},n.onCreateRepo=function(e){n.toggleCreateRepoDialog(),S.e.createMineRepo(e).then((function(e){var t=new Ke({repo_id:e.data.repo_id,repo_name:e.data.repo_name,size:e.data.repo_size,mtime:e.data.mtime,owner_email:e.data.email,encrypted:e.data.encrypted,permission:e.data.permission,storage_name:e.data.storage_name});n.state.repoList.unshift(t),n.setState({repoList:n.state.repoList})})).catch((function(e){var t=h.Aq.getErrorMsg(e);E.A.danger(t)}))},n.onSelectSortOption=function(e){var t=e.value.split("-"),r=(0,L.A)(t,2),o=r[0],a=r[1];n.setState({sortBy:o,sortOrder:a},(function(){localStorage.setItem("sf_repos_sort_by",o),localStorage.setItem("sf_repos_sort_order",a);var e=n.state,t=e.allRepoList,r=e.groupList,i=n.sortRepos(t,r),s=i.allRepoList,l=i.myRepoList,c=i.sharedRepoList,u=i.publicRepoList,d=i.groupList;n.setState({allRepoList:s,groupList:d,sharedRepoList:c,publicRepoList:u,repoList:l})}))},n.sortRepoList=function(e,t){We.Ay.save("seafile-repo-dir-sort-by",e),We.Ay.save("seafile-repo-dir-sort-order",t),n.setState({sortBy:e,sortOrder:t,repoList:h.Aq.sortRepos(n.state.repoList,e,t)})},n.onTransferRepo=function(e){var t=n.state.repoList.filter((function(t){return t.repo_id!==e}));n.setState({repoList:t})},n.onRenameRepo=function(e,t){var r=n.state.repoList.map((function(n){return n.repo_id===e.repo_id&&(n.repo_name=t),n}));n.setState({repoList:r})},n.onMonitorRepo=function(e,t){var r=n.state.repoList.map((function(n){return n.repo_id===e.repo_id&&(n.monitored=t),n}));n.setState({repoList:r})},n.onDeleteRepo=function(e){var t=n.state.repoList.filter((function(t){return t.repo_id!==e.repo_id}));n.setState({repoList:t})},n.toggleGuideForNewDialog=function(){window.app.pageOptions.guideEnabled=!1,n.setState({isGuideForNewDialogOpen:!1})},n.updateGroup=function(e){var t=n.state.groupList;n.setState({groupList:t.map((function(t){return t.id==e.id&&(t=e),t}))})},n.toggleCreateRepoDialog=function(){n.setState({isCreateRepoDialogOpen:!n.state.isCreateRepoDialogOpen})},n.switchViewMode=function(e){n.setState({currentViewMode:e},(function(){localStorage.setItem("sf_repo_list_view_mode",e)}))},n.sortOptions=[{value:"name-asc",text:(0,f.AP)("By name ascending")},{value:"name-desc",text:(0,f.AP)("By name descending")},{value:"time-asc",text:(0,f.AP)("By time ascending")},{value:"time-desc",text:(0,f.AP)("By time descending")}],n.state={errorMsg:"",isLoading:!0,repoList:[],isSortOptionsDialogOpen:!1,isGuideForNewDialogOpen:window.app.pageOptions.guideEnabled,groupList:[],sharedRepoList:[],publicRepoList:[],isCreateRepoDialogOpen:!1,currentViewMode:localStorage.getItem("sf_repo_list_view_mode")||tt.Tb,sortBy:localStorage.getItem("sf_repos_sort_by")||"name",sortOrder:localStorage.getItem("sf_repos_sort_order")||"asc"},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=S.e.listRepos({type:["mine","shared","public"]}),n=S.e.listGroups(!0);Promise.all([t,n]).then((function(t){var n=(0,L.A)(t,2),r=n[0],o=n[1],a=r.data.repos.map((function(e){return new Ke(e)})),i=o.data.map((function(e){var t=new D(e);return t.repos=e.repos.map((function(e){return new Ke(e)})),t})).sort((function(e,t){return e.name.toLowerCase()<t.name.toLowerCase()?-1:1})),s=e.sortRepos(a,i),l=s.allRepoList,c=s.myRepoList,u=s.sharedRepoList,d=s.publicRepoList,p=s.groupList;e.setState({isLoading:!1,allRepoList:l,groupList:p,sharedRepoList:u,publicRepoList:d,repoList:c})})).catch((function(t){e.setState({isLoading:!1,errorMsg:h.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.isLoading,r=t.currentViewMode,o=t.sortBy,a=t.sortOrder,i=h.Aq.isDesktop(),s=this.sortOptions.map((function(e){return(0,ur.A)((0,ur.A)({},e),{},{isSelected:e.value=="".concat(o,"-").concat(a)})}));return(0,m.jsx)(m.Fragment,{children:(0,m.jsxs)("div",{className:"main-panel-center flex-row",children:[(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsxs)("div",{className:"cur-view-path",children:[(0,m.jsx)("h3",{className:"sf-heading m-0",children:(0,f.AP)("Files")}),i&&(0,m.jsxs)("div",{className:"d-flex align-items-center",children:[(0,m.jsx)("div",{className:"mr-2",children:(0,m.jsx)(Ir,{currentViewMode:r,switchViewMode:this.switchViewMode})}),(0,m.jsx)(Nr,{sortOptions:s,onSelectSortOption:this.onSelectSortOption})]})]}),n?(0,m.jsx)(Z.A,{}):(0,m.jsxs)("div",{className:"cur-view-content",id:"files-content-container",children:[h.Aq.isDesktop()&&r==tt.Tb&&(0,m.jsx)("table",{"aria-hidden":!0,className:"my-3",children:(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"4%"}),(0,m.jsx)("th",{width:"3%",children:(0,m.jsx)("span",{className:"sr-only",children:(0,f.AP)("Library Type")})}),(0,m.jsx)("th",{width:"35%",children:(0,f.AP)("Name")}),(0,m.jsx)("th",{width:"10%",children:(0,m.jsx)("span",{className:"sr-only",children:(0,f.AP)("Actions")})}),(0,m.jsx)("th",{width:"14%",children:(0,f.AP)("Size")}),(0,m.jsx)("th",{width:"17%",children:(0,f.AP)("Last Update")}),(0,m.jsx)("th",{width:"17%",children:(0,f.AP)("Owner")})]})})}),f._s&&(0,m.jsxs)("div",{className:"pb-3",children:[(0,m.jsxs)("div",{className:"d-flex justify-content-between mt-3 py-1 ".concat(r==tt.Tb?"sf-border-bottom":""),children:[(0,m.jsxs)("h4",{className:"sf-heading m-0 d-flex align-items-center",children:[(0,m.jsx)("span",{className:"sf3-font-mine sf3-font nav-icon","aria-hidden":"true"}),(0,f.AP)("My Libraries"),(0,m.jsx)(Ue,{opList:[{text:(0,f.AP)("New Library"),onClick:this.toggleCreateRepoDialog}]})]}),!h.Aq.isDesktop()&&this.state.repoList.length>0&&(0,m.jsx)("span",{className:"sf3-font sf3-font-sort action-icon",onClick:this.toggleSortOptionsDialog})]}),this.state.errorMsg?(0,m.jsx)("p",{className:"error text-center mt-8",children:this.state.errorMsg}):0===this.state.repoList.length?(0,m.jsx)("p",{className:"libraries-empty-tip-in-".concat(r,"-mode"),children:(0,f.AP)("No libraries")}):(0,m.jsx)(An,{sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,repoList:this.state.repoList,onRenameRepo:this.onRenameRepo,onDeleteRepo:this.onDeleteRepo,onTransferRepo:this.onTransferRepo,onMonitorRepo:this.onMonitorRepo,onRepoClick:this.onRepoClick,sortRepoList:this.sortRepoList,inAllLibs:!0,currentViewMode:r})]}),(0,m.jsx)("div",{className:"pb-3",children:(0,m.jsx)(ot,{repoList:this.state.sharedRepoList,inAllLibs:!0,currentViewMode:r})}),f.Yi&&(0,m.jsx)("div",{className:"pb-3",children:(0,m.jsx)(jn,{repoList:this.state.publicRepoList,inAllLibs:!0,currentViewMode:r})}),(0,m.jsx)("div",{className:"group-list-panel",children:this.state.groupList.length>0&&this.state.groupList.map((function(t,n){return(0,m.jsx)(Pi,{inAllLibs:!0,group:t,updateGroup:e.updateGroup,currentViewMode:r},n)}))})]})]}),!n&&!this.state.errorMsg&&this.state.isGuideForNewDialogOpen&&(0,m.jsx)(Ii,{toggleDialog:this.toggleGuideForNewDialog}),this.state.isSortOptionsDialogOpen&&(0,m.jsx)(je,{toggleDialog:this.toggleSortOptionsDialog,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortRepoList}),this.state.isCreateRepoDialogOpen&&(0,m.jsx)(xn,{libraryType:"mine",onCreateRepo:this.onCreateRepo,onCreateToggle:this.toggleCreateRepoDialog})]})})}}])}(s.Component),Oi=(n(16322),function(e){function t(e){var n;(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onpopstate=function(e){if(e.state&&e.state.currentTab&&e.state.pathPrefix){var t=e.state,r=t.currentTab,o=t.pathPrefix;n.setState({currentTab:r,pathPrefix:o})}},n.navigateClientUrlToLib=function(){if(window.location.hash&&-1!=window.location.hash.indexOf("common/lib")){var e=window.location.hash.split("/"),t=e[e.length-2],n=f.Yc+"library/"+t+"/";(0,c.oo)(n,{repalce:!0})}},n.onCloseSidePanel=function(){n.setState({isSidePanelClosed:!n.state.isSidePanelClosed})},n.onShowSidePanel=function(){n.setState({isSidePanelClosed:!n.state.isSidePanelClosed})},n.onSearchedClick=function(e){if(!0===e.is_dir){n.setState({currentTab:"",pathPrefix:[]});var t=f.Yc+"library/"+e.repo_id+"/"+e.repo_name+e.path;(0,c.oo)(t,{repalce:!0})}else{var r=f.Yc+"lib/"+e.repo_id+"/file"+h.Aq.encodePath(e.path);if(h.Aq.isWeChat())location.href=r;else window.open("about:blank").location.href=r}},n.onGroupChanged=function(e){setTimeout((function(){var t;t=e?f.Yc+"group/"+e+"/":f.Yc+"libraries/",window.location=t.toString()}),1)},n.tabItemClick=function(e,t){var r=[];(t||n.dirViewPanels.indexOf(e)>-1)&&(r=n.generatorPrefix(e,t)),n.setState({currentTab:e,pathPrefix:r},(function(){var e=n.state,t=e.currentTab,r=e.pathPrefix;window.history.replaceState({currentTab:t,pathPrefix:r},null)})),h.Aq.isDesktop()||n.state.isSidePanelClosed||n.setState({isSidePanelClosed:!0})},n.generatorPrefix=function(e,t){var r=[];if(t){var o={url:f.Yc+"group/"+t+"/",showName:e,name:e,id:t};r.push(o)}else{var a={url:f.Yc+e+"/",showName:n.getTabShowName(e),name:e,id:null};r.push(a)}return r},n.getTabShowName=function(e){switch(e){case"libraries":return"Files";case"my-libs":return"My Libraries";case"shared-libs":return"Shared with me";case"org":return"Shared with all"}},n.toggleSidePanel=function(){n.setState({isSidePanelClosed:!n.state.isSidePanelClosed})},n.toggleFoldSideNav=function(){n.setState({isSidePanelFolded:!n.state.isSidePanelFolded},(function(){localStorage.setItem("sf_user_side_nav_folded",n.state.isSidePanelFolded)}))},n.onResizeMouseUp=function(){n.state.inResizing&&n.setState({inResizing:!1}),localStorage.setItem("sf_side_panel_rate",n.state.sidePanelRate)},n.onResizeMouseDown=function(){n.setState({inResizing:!0})},n.onResizeMouseMove=function(e){var t=e.nativeEvent.clientX/window.innerWidth;n.setState({sidePanelRate:Math.max(Math.min(t,q.Rx),q.Pf)})},n.onResizeMouseOver=function(e){if(n.dragHandlerRef.current){var t=n.resizeBarRef.current.getBoundingClientRect().top,r=e.pageY-t-q.gO/2;n.setDragHandlerTop(r)}},n.setDragHandlerTop=function(e){n.dragHandlerRef.current.style.top=e+"px"},"/groups/"===window.location.pathname&&(window.location.href=window.location.origin+"/libraries/"),n.state={isSidePanelClosed:!1,isSidePanelFolded:!h.Fr&&("true"==localStorage.getItem("sf_user_side_nav_folded")||!1),currentTab:"",pathPrefix:[],inResizing:!1,sidePanelRate:parseFloat(localStorage.getItem("sf_side_panel_rate")||q.nT)},n.dirViewPanels=["libraries","my-libs","shared-libs","org"],window.onpopstate=n.onpopstate;var o=new y.A;return n.eventBus=o,n.resizeBarRef=s.createRef(),n.dragHandlerRef=s.createRef(),n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"UNSAFE_componentWillMount",value:function(){h.Aq.isDesktop()||this.setState({isSidePanelClosed:!0})}},{key:"componentDidMount",value:function(){var e;if(this.navigateClientUrlToLib(),location.pathname==f.Yc)e="libraries";else{var t=window.location.href.split("/");e=t[t.length-2]}this.setState({currentTab:e})}},{key:"render",value:function(){var e=this.state,t=e.currentTab,n=e.isSidePanelClosed,r=e.isSidePanelFolded,o=e.sidePanelRate,a=e.inResizing,i={},l={};return r||(i={userSelect:a?"none":"",flex:o?"1 0 ".concat(100*(1-o),"%"):"0 0 ".concat(100-100*q.nT,"%")},l={userSelect:a?"none":"",flex:"0 0 ".concat(o?100*o:100*q.nT,"%")}),(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)(v,{}),(0,m.jsx)(b,{isSidePanelClosed:n,onCloseSidePanel:this.onCloseSidePanel,onShowSidePanel:this.onShowSidePanel,onSearchedClick:this.onSearchedClick,eventBus:this.eventBus,isSidePanelFolded:r}),(0,m.jsxs)("div",{id:"main",className:"user-panel",onMouseMove:a?this.onResizeMouseMove:null,onMouseUp:this.onResizeMouseUp,children:[(0,m.jsx)(V,{isSidePanelClosed:n,isSidePanelFolded:r,onCloseSidePanel:this.onCloseSidePanel,currentTab:t,tabItemClick:this.tabItemClick,toggleFoldSideNav:this.toggleFoldSideNav,style:l,eventBus:this.eventBus}),h.Aq.isDesktop()&&!r&&(0,m.jsx)(G.A,{resizeBarRef:this.resizeBarRef,dragHandlerRef:this.dragHandlerRef,resizeBarStyle:{left:"calc(".concat(o?100*o+"%":"".concat(100*q.nT,"%")," - 1px)")},dragHandlerStyle:{height:q.gO},onResizeMouseDown:this.onResizeMouseDown,onResizeMouseOver:this.onResizeMouseOver}),(0,m.jsx)("div",{className:"main-panel",style:i,children:(0,m.jsxs)(c.Ix,{className:"reach-router",children:[(0,m.jsx)(Ti,{path:f.Yc}),(0,m.jsx)(Ti,{path:f.Yc+"libraries"}),(0,m.jsx)(Sn,{path:f.Yc+"my-libs"}),(0,m.jsx)(Mn,{path:f.Yc+"my-libs/deleted/"}),(0,m.jsx)(He,{path:f.Yc+"share-admin-share-links"}),(0,m.jsx)(ze,{path:f.Yc+"share-admin-upload-links"}),(0,m.jsx)(jn,{path:f.Yc+"org/"}),(0,m.jsx)(ki,{path:f.Yc+"published",sidePanelRate:o,isSidePanelFolded:r}),(0,m.jsx)(ge,{path:f.Yc+"starred"}),(0,m.jsx)(di,{path:f.Yc+"invitations/"}),(0,m.jsx)(se,{path:f.Yc+"dashboard"}),(0,m.jsx)(ce,{path:f.Yc+"my-activities"}),(0,m.jsx)(oi,{path:f.Yc+"group/:groupID",onGroupChanged:this.onGroupChanged}),(0,m.jsx)(Ae,{path:f.Yc+"linked-devices"}),(0,m.jsx)(Ee,{path:f.Yc+"share-admin-libs"}),(0,m.jsx)(Ne,{path:f.Yc+"share-admin-folders"}),(0,m.jsx)(ot,{path:f.Yc+"shared-libs"}),(0,m.jsx)(st,{path:f.Yc+"shared-with-ocm"}),(0,m.jsx)(pt,{path:f.Yc+"ocm-via-webdav"}),(0,m.jsx)(Ct,{path:f.Yc+"remote-library/:providerID/:repoID/*",pathPrefix:this.state.pathPrefix,onTabNavClick:this.tabItemClick}),(0,m.jsx)(Va,{path:f.Yc+"library/:repoID/*",pathPrefix:this.state.pathPrefix,isSidePanelFolded:r,onTabNavClick:this.tabItemClick,eventBus:this.eventBus})]})}),(0,m.jsx)(d(),{query:"(max-width: 767.8px)",children:(0,m.jsx)(p.A,{zIndex:"1030",isOpen:!n,toggle:this.toggleSidePanel,contentClassName:"d-none"})})]})]})}}])}(s.Component));l.render((0,m.jsx)(Oi,{}),document.getElementById("wrapper"))},72249:function(e,t,n){"use strict";var r=n(23029),o=n(92901),a=function(){return(0,o.A)((function e(){(0,r.A)(this,e),this.subscribers={}}),[{key:"subscribe",value:function(e,t){this.subscribers[e]||(this.subscribers[e]=[]);var n=this.subscribers[e];return n.push(t),function(){var e=n.indexOf(t);e>-1&&n.splice(e,1)}}},{key:"dispatch",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=this.subscribers[e];Array.isArray(o)&&o.forEach((function(e){return e.apply(void 0,n)}))}}])}();t.A=a},29009:function(e,t,n){"use strict";var r=n(23029),o=n(92901),a=n(39874),i=n(85501),s=n(9950),l=n(19260),c=n(6030),u=n(33151),d=n(68879),p=n(92795),f=n(46757),h=n(31095),m=n(65604),g=n(44414),v=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).registerHandlers=function(){document.addEventListener("mousedown",n.handleOutsideClick),document.addEventListener("touchstart",n.handleOutsideClick),document.addEventListener("scroll",n.handleHide),document.addEventListener("contextmenu",n.handleHide),document.addEventListener("keydown",n.handleKeyNavigation),window.addEventListener("resize",n.handleHide)},n.unregisterHandlers=function(){document.removeEventListener("mousedown",n.handleOutsideClick),document.removeEventListener("touchstart",n.handleOutsideClick),document.removeEventListener("scroll",n.handleHide),document.removeEventListener("contextmenu",n.handleHide),document.removeEventListener("keydown",n.handleKeyNavigation),window.removeEventListener("resize",n.handleHide)},n.handleShow=function(e){if(e.detail.id===n.props.id){var t=e.detail.position,r=t.x,o=t.y;if(n.props.getMenuContainerSize){var a=n.props.getMenuContainerSize(),i=r-(window.innerWidth-parseFloat(a.width)),s=o-(window.innerHeight-parseFloat(a.height));n.setState({x:i,y:s})}else n.setState({x:r,y:o});var l=e.detail,c=l.currentObject,u=l.menuList;n.setState({isVisible:!0,currentObject:c,menuList:u}),n.registerHandlers(),(0,h._$)(n.props.onShowMenu,e)}},n.handleHide=function(e){!n.state.isVisible||e.detail&&e.detail.id&&e.detail.id!==n.props.id||(n.unregisterHandlers(),n.setState({isVisible:!1}),(0,h._$)(n.props.onHideMenu,e))},n.handleOutsideClick=function(e){n.menu.contains(e.target)||(0,f.ks)()},n.handleMouseLeave=function(e){e.preventDefault()},n.handleContextMenu=function(e){n.handleHide(e)},n.handleKeyNavigation=function(e){!1!==n.state.isVisible&&(e.preventDefault(),n.hideMenu(e))},n.hideMenu=function(e){27!==e.keyCode&&13!==e.keyCode||(0,f.ks)()},n.getMenuPosition=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r={top:t,left:e};if(!n.menu)return r;var o=window,a=o.innerWidth,i=o.innerHeight,s=n.menu.getBoundingClientRect();if(n.props.getMenuContainerSize){var l=n.props.getMenuContainerSize();a=parseFloat(l.width),i=parseFloat(l.height)}return t+s.height>i-10&&(r.top=i-s.height-10),e+s.width>a-10&&(r.left=a-s.width-10),r.left<0&&(r.left=s.width<a?(a-s.width)/2:0),r.top<0&&(r.top=s.height<i?(i-s.height)/2:0),r},n.onMenuItemClick=function(e){e.stopPropagation();var t=m.Aq.getEventData(e,"operation"),r=n.state.currentObject;n.props.onMenuItemClick(t,r,e)},n.onContextMenu=function(e){e.stopPropagation()},n.onDropDownMouseMove=function(e){n.state.isSubMenuShown&&n.setState({isSubMenuShown:!1})},n.toggleSubMenu=function(e){e.stopPropagation(),n.setState({isSubMenuShown:!n.state.isSubMenuShown})},n.toggleSubMenuShown=function(e){n.setState({isSubMenuShown:!0,currentItem:e.key})},n.state={x:0,y:0,isVisible:!1,currentObject:null,menuList:[],isSubMenuShown:!1,currentItem:""},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.listenId=p.A.register(this.handleShow,this.handleHide)}},{key:"componentDidUpdate",value:function(){var e=this;if(this.state.isVisible){var t=window.requestAnimationFrame||setTimeout;t((function(){var n=e.state,r=n.x,o=n.y,a=e.getMenuPosition(r,o),i=a.top,s=a.left;t((function(){e.menu&&(e.menu.style.top="".concat(i,"px"),e.menu.style.left="".concat(s,"px"),e.menu.style.opacity=1,e.menu.style.pointerEvents="auto")}))}))}else{if(!this.menu)return;this.menu.style.opacity=0,this.menu.style.pointerEvents="none"}}},{key:"componentWillUnmount",value:function(){this.listenId&&p.A.unregister(this.listenId),this.unregisterHandlers()}},{key:"render",value:function(){var e=this;return(0,g.jsx)("div",{role:"menu",className:"seafile-contextmenu dropdown-menu",style:{position:"fixed",opacity:0,pointerEvents:"none",display:"block"},ref:function(t){e.menu=t},children:this.state.menuList.map((function(t,n){return"Divider"===t?(0,g.jsx)("div",{className:"seafile-divider dropdown-divider"},n):t.subOpList?(0,g.jsxs)(l.A,{direction:"right",className:"w-100",isOpen:e.state.isSubMenuShown&&e.state.currentItem==t.key,toggle:e.toggleSubMenu,onMouseMove:function(e){e.stopPropagation()},children:[(0,g.jsxs)(c.A,{tag:"div",className:"dropdown-item font-weight-normal rounded-0 d-flex align-items-center",onMouseEnter:e.toggleSubMenuShown.bind(e,t),children:[(0,g.jsx)("span",{className:"mr-auto",children:t.value}),(0,g.jsx)("i",{className:"sf3-font-down sf3-font rotate-270"})]}),(0,g.jsx)(u.A,{children:t.subOpList.map((function(t,n){return"Divider"==t?(0,g.jsx)(d.A,{divider:!0},n):(0,g.jsx)(d.A,{"data-operation":t.key,onClick:e.onMenuItemClick,onContextMenu:e.onContextMenu,children:t.value},n)}))})]},n):(0,g.jsx)("button",{className:"seafile-contextmenu-item dropdown-item","data-operation":t.key,onClick:e.onMenuItemClick,onContextMenu:e.onContextMenu,onMouseMove:e.onDropDownMouseMove,children:t.value},n)}))})}}])}(s.Component);t.A=v},68849:function(e,t,n){"use strict";var r=n(23029),o=n(92901),a=n(39874),i=n(85501),s=n(9950),l=n(58195),c=n(14113),u=n(99308),d=n(85907),p=n(20015),f=n(40326),h=n(97011),m=n(65604),g=n(4086),v=n(44414),y=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).handleInputChange=function(e){n.setState({inputValue:e})},n.formSubmit=function(){var e=n.state.inputValue,t=n.props.repoID;n.setState({submitBtnDisabled:!0}),h.e.deleteRepoTrash(t,e.value).then((function(e){g.A.success((0,f.AP)("Clean succeeded.")),n.props.refreshTrash(),n.props.toggleDialog()})).catch((function(e){var t=m.Aq.getErrorMsg(e);n.setState({formErrorMsg:t,submitBtnDisabled:!1})}))},n.options=[{label:(0,f.AP)("3 days ago"),value:3},{label:(0,f.AP)("1 week ago"),value:7},{label:(0,f.AP)("1 month ago"),value:30},{label:(0,f.AP)("all"),value:0}],n.state={inputValue:n.options[0],submitBtnDisabled:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.state.formErrorMsg;return(0,v.jsxs)(l.A,{isOpen:!0,centered:!0,toggle:this.props.toggleDialog,children:[(0,v.jsx)(c.A,{toggle:this.props.toggleDialog,children:(0,f.AP)("Clean")}),(0,v.jsx)(u.A,{children:(0,v.jsxs)(s.Fragment,{children:[(0,v.jsx)("p",{children:(0,f.AP)("Clear files in trash and history\uff1a")}),(0,v.jsx)(p.A,{defaultValue:this.options[0],options:this.options,autoFocus:!1,onChange:this.handleInputChange,placeholder:""}),e&&(0,v.jsx)("p",{className:"error m-0 mt-2",children:e})]})}),(0,v.jsx)(d.A,{children:(0,v.jsx)("button",{className:"btn btn-primary",disabled:this.state.submitBtnDisabled,onClick:this.formSubmit,children:(0,f.AP)("Submit")})})]})}}])}(s.Component);t.A=y},21870:function(e,t,n){"use strict";var r=n(23029),o=n(92901),a=n(39874),i=n(85501),s=n(9950),l=n(58195),c=n(14113),u=n(99308),d=n(76152),p=n(55627),f=n(85077),h=n(85907),m=n(18849),g=n(40326),v=n(44414),y=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).toggle=function(){n.props.toggleDialog()},n.executeOperation=function(){n.toggle(),n.props.executeOperation(n.state.isChecked)},n.onInputChange=function(e){n.setState({isChecked:e.target.checked})},n.state={isChecked:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return(0,v.jsxs)(l.A,{isOpen:!0,toggle:this.toggle,children:[(0,v.jsx)(c.A,{toggle:this.toggle,children:(0,g.AP)("Unlink device")}),(0,v.jsxs)(u.A,{children:[(0,v.jsx)("p",{children:(0,g.AP)("Are you sure you want to unlink this device?")}),(0,v.jsx)(d.A,{check:!0,children:(0,v.jsxs)(p.A,{check:!0,children:[(0,v.jsx)(f.A,{type:"checkbox",checked:this.state.isChecked,onChange:this.onInputChange}),(0,v.jsx)("span",{children:(0,g.AP)("Delete files from this device the next time it comes online.")})]})})]}),(0,v.jsxs)(h.A,{children:[(0,v.jsx)(m.A,{color:"secondary",onClick:this.toggle,children:(0,g.AP)("Cancel")}),(0,v.jsx)(m.A,{color:"primary",onClick:this.executeOperation,children:(0,g.AP)("Unlink")})]})]})}}])}(s.Component);t.A=y},88002:function(e,t,n){"use strict";n.d(t,{A:function(){return h}});var r=n(23029),o=n(92901),a=n(39874),i=n(85501),s=n(9950),l=n(58195),c=n(14113),u=n(99308),d=n(40326),p=n(44414),f=function(e){function t(){return(0,r.A)(this,t),(0,a.A)(this,t,arguments)}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.type,n=e.asyncOperationProgress,r=e.asyncOperatedFilesLength,o="move"===t?(0,d.AP)("Move {num} items"):(0,d.AP)("Copy {num} items");o=o.replace("{num}",r);var a={width:n+"%",lineHeight:"40px",textAlign:"left"};return(0,p.jsxs)(l.A,{isOpen:!0,toggle:this.props.toggleDialog,className:"copy-move-dirent-progress-dialog",children:[(0,p.jsx)(c.A,{toggle:this.props.toggleDialog,children:o}),(0,p.jsx)(u.A,{children:(0,p.jsx)("div",{className:"progress",children:(0,p.jsx)("div",{className:"progress-bar pl-2",role:"progressbar",style:a,"aria-valuenow":n,"aria-valuemin":"0","aria-valuemax":"100",children:n+"%"})})})]})}}])}(s.Component),h=f},56999:function(e,t,n){"use strict";var r=n(23029),o=n(92901),a=n(39874),i=n(85501),s=n(9950),l=n(58195),c=n(14113),u=n(99308),d=n(19247),p=n(76152),f=n(55627),h=n(85077),m=n(76115),g=n(85907),v=n(18849),y=n(40326),C=n(65604),A=n(44414),x=function(e){function t(e){var n;(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).isSdocSuffix=function(e){return e.endsWith(".sdoc")},n.handleChange=function(e){e.target.value.trim()?n.setState({isSubmitBtnActive:!0}):n.setState({isSubmitBtnActive:!1}),n.setState({childName:e.target.value})},n.handleSubmit=function(){if(n.state.isSubmitBtnActive){var e=n.state.childName.trim(),t=(0,C.yS)(e),r=t.isValid,o=t.errMessage;if(r){if(n.props.checkDuplicatedName(e)){var a=(0,y.AP)('The name "{name}" is already taken. Please choose a different name.');return a=a.replace("{name}",C.Aq.HTMLescape(e)),void n.setState({errMessage:a})}n.props.onAddFile(n.state.parentPath+e),n.props.toggleDialog()}else n.setState({errMessage:o})}},n.handleKeyDown=function(e){"Enter"===e.key&&(n.handleSubmit(),e.preventDefault())},n.onAfterModelOpened=function(){n.newInput.current&&(n.newInput.current.focus(),n.newInput.current.setSelectionRange(0,0))};var o=e.fileType,i=void 0===o?"":o;return n.state={parentPath:"",childName:i,errMessage:"",isSubmitBtnActive:!!n.isSdocSuffix(i)},n.newInput=s.createRef(),n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this.props.parentPath;"/"===e[e.length-1]?this.setState({parentPath:e}):this.setState({parentPath:e+"/"})}},{key:"render",value:function(){var e=this.props.toggleDialog;return(0,A.jsxs)(l.A,{isOpen:!0,toggle:e,onOpened:this.onAfterModelOpened,children:[(0,A.jsx)(c.A,{toggle:e,children:(0,y.AP)("New File")}),(0,A.jsxs)(u.A,{children:[(0,A.jsx)(d.A,{children:(0,A.jsxs)(p.A,{children:[(0,A.jsx)(f.A,{for:"fileName",children:(0,y.AP)("Name")}),(0,A.jsx)(h.A,{id:"fileName",onKeyDown:this.handleKeyDown,innerRef:this.newInput,value:this.state.childName,onChange:this.handleChange})]})}),this.state.errMessage&&(0,A.jsx)(m.A,{color:"danger",className:"mt-2",children:this.state.errMessage})]}),(0,A.jsxs)(g.A,{children:[(0,A.jsx)(v.A,{color:"secondary",onClick:e,children:(0,y.AP)("Cancel")}),(0,A.jsx)(v.A,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive,children:(0,y.AP)("Submit")})]})]})}}])}(s.Component);t.A=x},81617:function(e,t,n){"use strict";var r=n(23029),o=n(92901),a=n(39874),i=n(85501),s=n(9950),l=n(58195),c=n(14113),u=n(99308),d=n(19247),p=n(76152),f=n(55627),h=n(85077),m=n(76115),g=n(85907),v=n(18849),y=n(40326),C=n(65604),A=n(44414),x=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).handleChange=function(e){e.target.value.trim()?n.setState({isSubmitBtnActive:!0}):n.setState({isSubmitBtnActive:!1}),n.setState({childName:e.target.value})},n.handleSubmit=function(){if(n.state.isSubmitBtnActive){var e=n.state.childName,t=(0,C.yS)(e),r=t.isValid,o=t.errMessage;if(r){if(n.props.checkDuplicatedName(e)){var a=(0,y.AP)('The name "{name}" is already taken. Please choose a different name.');return a=a.replace("{name}",C.Aq.HTMLescape(e)),void n.setState({errMessage:a})}n.props.onAddFolder(n.state.parentPath+e)}else n.setState({errMessage:o})}},n.handleKeyDown=function(e){"Enter"===e.key&&(n.handleSubmit(),e.preventDefault())},n.toggle=function(){n.props.addFolderCancel()},n.state={parentPath:"",childName:"",errMessage:"",isSubmitBtnActive:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this.props.parentPath;"/"===e[e.length-1]?this.setState({parentPath:e}):this.setState({parentPath:e+"/"})}},{key:"render",value:function(){return(0,A.jsxs)(l.A,{isOpen:!0,toggle:this.toggle,autoFocus:!1,children:[(0,A.jsx)(c.A,{toggle:this.toggle,children:(0,y.AP)("New Folder")}),(0,A.jsxs)(u.A,{children:[(0,A.jsx)(d.A,{children:(0,A.jsxs)(p.A,{children:[(0,A.jsx)(f.A,{for:"folderName",children:(0,y.AP)("Name")}),(0,A.jsx)(h.A,{id:"folderName",value:this.state.childName,onKeyDown:this.handleKeyDown,onChange:this.handleChange,autoFocus:!0})]})}),this.state.errMessage&&(0,A.jsx)(m.A,{color:"danger",className:"mt-2",children:this.state.errMessage})]}),(0,A.jsxs)(g.A,{children:[(0,A.jsx)(v.A,{color:"secondary",onClick:this.toggle,children:(0,y.AP)("Cancel")}),(0,A.jsx)(v.A,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive,children:(0,y.AP)("Submit")})]})]})}}])}(s.Component);t.A=x},91611:function(e,t,n){"use strict";var r=n(23029),o=n(92901),a=n(39874),i=n(85501),s=n(9950),l=n(58195),c=n(14113),u=n(99308),d=n(85907),p=n(18849),f=n(25328),h=n(40326),m=n(4086),g=n(44414),v=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).copyToClipboard=function(){(0,f.A)(n.props.link),n.props.toggleDialog(),m.A.success((0,h.AP)("The link is copied to the clipboard."),{duration:2})},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.link,n=e.toggleDialog;return(0,g.jsxs)(l.A,{isOpen:!0,toggle:n,children:[(0,g.jsx)(c.A,{toggle:n,children:(0,h.AP)("Link")}),(0,g.jsx)(u.A,{children:(0,g.jsx)("a",{href:t,children:t})}),(0,g.jsxs)(d.A,{children:[(0,g.jsx)(p.A,{color:"primary",onClick:this.copyToClipboard,children:(0,h.AP)("Copy")}),(0,g.jsx)(p.A,{color:"secondary",onClick:n,children:(0,h.AP)("Close")})]})]})}}])}(s.Component);t.A=v},16670:function(e,t,n){"use strict";var r,o=n(23029),a=n(92901),i=n(39874),s=n(85501),l=n(9950),c=n(58195),u=n(14113),d=n(99308),p=n(40326),f=n(97011),h=n(65604),m=n(81446),g=n(44414),v=function(e){function t(e){var n;return(0,o.A)(this,t),(n=(0,i.A)(this,t,[e])).queryZipProgress=function(){var e=n.state.zipToken;f.e.queryZipProgress(e).then((function(t){var o=t.data;if(1==o.failed){var a;switch(clearInterval(r),o.failed_reason){case"size too large":a=(0,p.AP)("Failed to download. The total size of the files exceeded the limit.");break;case"internal error":a=(0,p.AP)("Internal Server Error");break;default:a=(0,p.AP)("Error")}n.setState({isLoading:!1,errorMsg:a})}else n.setState({zipProgress:0==o.total?"100%":(o.zipped/o.total*100).toFixed(2)+"%"}),o.total==o.zipped&&(clearInterval(r),n.props.toggleDialog(),location.href="".concat(p.IX,"zip/").concat(e))})).catch((function(e){clearInterval(r);var t=h.Aq.getErrorMsg(e);n.setState({isLoading:!1,errorMsg:t})}))},n.cancelZipTask=function(){var e=n.state.zipToken;f.e.cancelZipTask(e).then((function(e){})).catch((function(e){}))},n.toggleDialog=function(){var e=n.state.zipProgress;e&&"100%"!=e&&(clearInterval(r),n.cancelZipTask()),n.props.toggleDialog()},n.state={isLoading:!0,errorMsg:"",zipProgress:null},n}return(0,s.A)(t,e),(0,a.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.token,o=t.path,a=t.repoID,i=t.target;(n?i.length?f.e.getShareLinkDirentsZipTask(n,o,i):f.e.getShareLinkZipTask(n,o):f.e.zipDownload(a,o,i)).then((function(t){var n=t.data.zip_token;e.setState({isLoading:!1,errorMsg:"",zipToken:n}),e.queryZipProgress(),r=setInterval(e.queryZipProgress,1e3)})).catch((function(t){var n=h.Aq.getErrorMsg(t);e.setState({isLoading:!1,errorMsg:n})}))}},{key:"render",value:function(){return(0,g.jsxs)(c.A,{isOpen:!0,toggle:this.toggleDialog,children:[(0,g.jsx)(u.A,{toggle:this.toggleDialog,children:(0,p.AP)("Download")}),(0,g.jsx)(d.A,{children:(0,g.jsx)(y,{data:this.state})})]})}}])}(l.Component),y=function(e){function t(){return(0,o.A)(this,t),(0,i.A)(this,t,arguments)}return(0,s.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props.data,t=e.isLoading,n=e.errorMsg,r=e.zipProgress;return t?(0,g.jsx)(m.A,{}):n?(0,g.jsxs)("div",{className:"text-center mt-7 mb-8",children:[(0,g.jsx)("img",{src:"".concat(p.SG,"img/error-tip.png"),alt:"",width:"100"}),(0,g.jsx)("p",{className:"mt-3",children:n})]}):(0,g.jsx)("p",{className:"mt-4 text-center",children:"".concat((0,p.AP)("Packaging...")," ").concat(r)})}}])}(l.Component);t.A=v},2949:function(e,t,n){"use strict";n.d(t,{Tb:function(){return r},Ys:function(){return a},nj:function(){return o}});var r="list",o="grid",a="metadata"},92811:function(e,t,n){"use strict";n.d(t,{A:function(){return u}});var r=n(9950),o=n(48738),a=n.n(o),i=n(71791),s=n(3563),l=n(44414),c=function(e){var t=e.readonly,n=e.field,o=e.className,c=e.children,u=(0,r.useMemo)((function(){return"size"===n.type?s.ZPL[s.vZe.NUMBER]:s.ZPL[n.type]}),[n]);return(0,l.jsxs)("div",{className:a()("dirent-detail-item",o),children:[(0,l.jsxs)("div",{className:"dirent-detail-item-name",children:[(0,l.jsx)(i.In,{iconName:u}),(0,l.jsx)("span",{className:"dirent-detail-item-name-value",children:n.name})]}),(0,l.jsx)("div",{className:a()("dirent-detail-item-value",{editable:!t}),children:c})]})};c.defaultProps={readonly:!0};var u=c},7266:function(e,t,n){"use strict";n.d(t,{nB:function(){return p},kZ:function(){return u},Y9:function(){return d.A}});var r=n(5544),o=n(9950),a=n(48738),i=n.n(a),s=n(91447),l=n(14522),c=n(44414),u=function(e){var t=e.children,n=e.className,a=(0,o.useState)(300),u=(0,r.A)(a,2),d=u[0],p=u[1],f=(0,o.useState)(!1),h=(0,r.A)(f,2),m=h[0],g=h[1],v=(0,o.useRef)(null),y=(0,o.useRef)(null),C=(0,o.useCallback)((function(e){var t=Math.max(Math.min(window.innerWidth-e.clientX,600),300);d!==t&&(localStorage.setItem("sf_cur_view_detail_width",t),p(t))}),[d]),A=(0,o.useCallback)((function(){window.removeEventListener("mousemove",C),window.removeEventListener("mouseup",A),m&&g(!1)}),[m,C]),x=(0,o.useCallback)((function(){window.addEventListener("mouseup",A),window.addEventListener("mousemove",C),g(!0)}),[A,C]),b=(0,o.useCallback)((function(e){y.current.style.top=e+"px"}),[]),_=(0,o.useCallback)((function(e){if(y.current){var t=v.current.getBoundingClientRect().top,n=e.pageY-t-l.gO/2;b(n)}}),[b]);return(0,o.useEffect)((function(){var e=localStorage.getItem("sf_cur_view_detail_width"),t=e?parseInt(e):300;p(t)}),[]),(0,c.jsxs)("div",{className:i()("cur-view-detail",n,{"cur-view-detail-small":d<400,"cur-view-detail-large":d>400}),style:{width:d},children:[t,(0,c.jsx)(s.A,{resizeBarRef:v,dragHandlerRef:y,resizeBarStyle:{left:-1},dragHandlerStyle:{height:l.gO},onResizeMouseDown:x,onResizeMouseOver:_})]})},d=n(7439),p=function(e){var t=e.className,n=e.children;return(0,c.jsx)("div",{className:i()("detail-body dirent-info",t),children:n})}},50224:function(e,t,n){"use strict";n.d(t,{A:function(){return o}});n(9950);var r=n(44414);var o=function(e){return(0,r.jsx)("ul",{className:"file-tag-list",children:Array.isArray(e.fileTagList)&&e.fileTagList.map((function(e){var t=e.tag_color||e.color,n=e.tag_name||e.name||"";return(0,r.jsx)("li",{style:{backgroundColor:t},className:"file-tag-item",children:(0,r.jsx)("span",{className:"tag-name",title:n,children:n})},e.id)}))})}},54033:function(e,t,n){"use strict";n.d(t,{A:function(){return b}});var r=n(23029),o=n(92901),a=n(39874),i=n(85501),s=n(9950),l=n(40326),c=n(97011),u=n(65604),d=n(4086),p=n(44414);var f=function(e){var t=e.callBack,n=e.footerName,r=e.className,o=e.addIconClassName;return(0,p.jsxs)("div",{className:"add-item-btn ".concat(r||""),onClick:function(e){t(e)},children:[(0,p.jsx)("span",{className:"sf3-font sf3-font-enlarge mr-2 ".concat(o||"")}),(0,p.jsx)("span",{className:"add-new-option",title:n,children:n})]})},h=n(48738),m=n.n(h),g=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onCompositionStart=function(){n.isInputtingChinese=!0},n.onChange=function(e){n.timer&&clearTimeout(n.timer);var t=n.props,r=t.onChange,o=t.wait,a=e.target.value;n.setState({searchValue:a||""},(function(){n.isInputtingChinese||(n.timer=setTimeout((function(){r&&r(n.state.searchValue.trim())}),o))}))},n.onCompositionEnd=function(e){n.isInputtingChinese=!1,n.onChange(e)},n.clearSearch=function(){var e=n.props.clearValue;n.setState({searchValue:""},(function(){e&&e()}))},n.setFocus=function(e){if(n.inputRef!==document.activeElement&&(n.inputRef.focus(),e)){var t=n.state.searchValue.length;n.inputRef.setSelectionRange(0,t)}},n.isFunction=function(e){return e&&"[object Function]"==={}.toString.call(e)},n.renderClear=function(){var e=n.props,t=e.isClearable,r=e.clearClassName,o=e.components,a=void 0===o?{}:o,i=n.state.searchValue;if(!t||!i)return null;var l=a.ClearIndicator;return s.isValidElement(l)?s.cloneElement(l,{clearValue:n.clearSearch}):n.isFunction(l)?(0,p.jsx)(l,{clearValue:n.clearSearch}):(0,p.jsx)("i",{className:m()("search-text-clear input-icon-addon",r),onClick:n.clearSearch,children:"\xd7"})},n.state={searchValue:e.value},n.isInputtingChinese=!1,n.timer=null,n.inputRef=null,n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.autoFocus&&this.inputRef&&this.inputRef!==document.activeElement&&setTimeout((function(){e.inputRef.focus()}),0)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.value!==this.props.value&&this.setState({searchValue:e.value})}},{key:"componentWillUnmount",value:function(){this.timer&&clearTimeout(this.timer),this.timer=null,this.inputRef=null}},{key:"render",value:function(){var e=this,t=this.props,n=t.placeholder,r=t.autoFocus,o=t.className,a=t.onKeyDown,i=t.disabled,l=t.style,c=this.state.searchValue;return(0,p.jsxs)(s.Fragment,{children:[(0,p.jsx)("input",{type:"text",value:c,className:m()("form-control",o),onChange:this.onChange,autoFocus:r,placeholder:n,onCompositionStart:this.onCompositionStart,onCompositionEnd:this.onCompositionEnd,onKeyDown:a,disabled:i,style:l,ref:function(t){return e.inputRef=t}}),this.renderClear()]})}}])}(s.Component);g.defaultProps={wait:100,disabled:!1,value:""};var v=g,y=n(4966),C=function(e){function t(){var e;(0,r.A)(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(e=(0,a.A)(this,t,[].concat(o))).onMouseEnter=function(){e.props.setHighlightIndex(e.props.index)},e.onMouseLeave=function(){e.props.setHighlightIndex(-1)},e.getRepoTagIdList=function(){return(e.props.fileTagList||[]).map((function(e){return e.repo_tag_id}))},e.onEditFileTag=function(){var t=e.props,n=t.repoID,r=t.repoTag,o=t.filePath,a=e.getRepoTagIdList();if(-1===a.indexOf(r.id)){var i=r.id;c.e.addFileTag(n,o,i).then((function(){a=e.getRepoTagIdList(),e.props.onFileTagChanged()})).catch((function(e){var t=u.Aq.getErrorMsg(e);d.A.danger(t)}))}else{for(var s=null,l=e.props.fileTagList,p=0;p<l.length;p++)if(l[p].repo_tag_id===r.id){s=l[p];break}c.e.deleteFileTag(n,s.id).then((function(){a=e.getRepoTagIdList(),e.props.onFileTagChanged()})).catch((function(e){var t=u.Aq.getErrorMsg(e);d.A.danger(t)}))}},e}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.repoTag,n=e.highlightIndex,r=e.index,o=-1!=this.getRepoTagIdList().indexOf(t.id);return(0,p.jsxs)("li",{className:"tag-list-item cursor-pointer px-3 d-flex justify-content-between align-items-center ".concat(n===r?"hl":""),onClick:this.onEditFileTag,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[(0,p.jsx)("div",{className:"tag-item d-flex align-items-center",style:{backgroundColor:t.color},children:(0,p.jsx)("span",{className:"tag-name",children:t.name})}),o&&(0,p.jsx)("i",{className:"sf2-icon-tick tag-selected-icon"})]})}}])}(s.Component),A=C,x=n(13042),b=(n(79627),function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).setHighlightIndex=function(e){n.setState({highlightIndex:e})},n.generateRandomColor=function(){return x.cj[Math.floor(Math.random()*x.cj.length)]},n.createNewTag=function(){var e=n.state.searchVal.trim();if(e){var t=n.generateRandomColor(),r=n.props.repoID;c.e.createRepoTag(r,e,t).then((function(e){var t=e.data.repo_tag;n.onRepoTagCreated(t),n.setState({searchVal:"",highlightIndex:-1})})).catch((function(e){var t=u.Aq.getErrorMsg(e);d.A.danger(t)}))}},n.onRepoTagCreated=function(e){var t=n.props,r=t.repoID,o=t.filePath,a=e.repo_tag_id;c.e.addFileTag(r,o,a).then((function(){n.props.onFileTagChanged(),n.props.onNewRepoTagAdded&&n.props.onNewRepoTagAdded(e)})).catch((function(e){var t=u.Aq.getErrorMsg(e);d.A.danger(t)}))},n.getRepoTagIdList=function(){return(n.props.fileTagList||[]).map((function(e){return e.repo_tag_id}))},n.onEditFileTag=function(e){var t=n.props,r=t.repoID,o=t.filePath,a=n.getRepoTagIdList();if(-1===a.indexOf(e.id))c.e.addFileTag(r,o,e.id).then((function(){a=n.getRepoTagIdList(),n.props.onFileTagChanged()})).catch((function(e){var t=u.Aq.getErrorMsg(e);d.A.danger(t)}));else{for(var i=null,s=n.props.fileTagList,l=0;l<s.length;l++)if(s[l].repo_tag_id===e.id){i=s[l];break}c.e.deleteFileTag(r,i.id).then((function(){a=n.getRepoTagIdList(),n.props.onFileTagChanged()})).catch((function(e){var t=u.Aq.getErrorMsg(e);d.A.danger(t)}))}},n.onKeyDown=function(e){var t=n.props.repoTags;if(e.keyCode===x.cK.ChineseInputMethod||e.keyCode===x.cK.LeftArrow||e.keyCode===x.cK.RightArrow)e.stopPropagation();else if(e.keyCode===x.cK.Enter){var r=n.state.searchVal.trim(),o=t.filter((function(e){return e.name.includes(r)}))[n.state.highlightIndex];o&&n.onEditFileTag(o)}else if(e.keyCode===x.cK.UpArrow)n.state.highlightIndex>-1&&n.setHighlightIndex(n.state.highlightIndex-1);else if(e.keyCode===x.cK.DownArrow){var a=n.state.searchVal.trim(),i=t.filter((function(e){return e.name.includes(a)}));n.state.highlightIndex<i.length&&n.setHighlightIndex(n.state.highlightIndex+1)}},n.onChangeSearch=function(e){n.setState({searchVal:e}),n.setHighlightIndex(-1)},n.state={searchVal:"",highlightIndex:-1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.state.searchVal.trim(),n=this.props.repoTags,r=n.filter((function(e){return e.name.includes(t)})),o=t&&!n.find((function(e){return e.name===t})),a="";return t?0==r.length&&(a=(0,l.AP)("Tag not found")):0==n.length&&(a=(0,l.AP)("No tags")),(0,p.jsxs)(y.A,{popoverClassName:"edit-filetag-popover",target:this.props.target,hideSeahubPopover:this.props.toggleCancel,hideSeahubPopoverWithEsc:this.props.toggleCancel,canHideSeahubPopover:!0,children:[(0,p.jsx)(v,{className:"edit-filetag-popover-input",placeholder:(0,l.AP)("Find a tag"),onKeyDown:this.onKeyDown,onChange:this.onChangeSearch,autoFocus:!0}),a?(0,p.jsx)("div",{className:"tag-not-found my-4 mx-1",children:a}):(0,p.jsx)("ul",{className:"tag-list-container",children:r.map((function(t,n){return(0,p.jsx)(A,{index:n,highlightIndex:e.state.highlightIndex,setHighlightIndex:e.setHighlightIndex,repoTag:t,repoID:e.props.repoID,filePath:e.props.filePath,fileTagList:e.props.fileTagList,onFileTagChanged:e.props.onFileTagChanged},t.id)}))}),o&&(0,p.jsx)(f,{callBack:this.createNewTag,footerName:"".concat((0,l.AP)("Create a new tag")," '").concat(t,"'")})]})}}])}(s.Component))},86274:function(e,t,n){"use strict";var r=n(23029),o=n(92901),a=n(39874),i=n(85501),s=n(9950),l=n(40326),c=n(65604),u=n(4086),d=n(44414),p=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onClick=function(e){n.inputRef.current.contains(e.target)||n.onRenameConfirm()},n.onChange=function(e){n.setState({name:e.target.value})},n.onKeyDown=function(e){e.keyCode===c.Aq.keyCodes.enter?n.onRenameConfirm(e):e.keyCode===c.Aq.keyCodes.esc&&n.onRenameCancel(e),e.nativeEvent.stopImmediatePropagation()},n.onRenameConfirm=function(e){e&&e.nativeEvent.stopImmediatePropagation();var t=n.state.name.trim();if(t!==n.props.name){var r=n.validateInput(),o=r.isValid,a=r.errMessage;o?n.props.onRenameConfirm(t):(u.A.danger(a),n.props.onRenameCancel())}else n.props.onRenameCancel()},n.onRenameCancel=function(e){e.nativeEvent.stopImmediatePropagation(),n.props.onRenameCancel()},n.validateInput=function(){var e=n.state.name.trim(),t=!0,r="";return e?e.indexOf("/")>-1?{isValid:t=!1,errMessage:r=(0,l.AP)("Name should not include '/'.")}:{isValid:t,errMessage:r}:{isValid:t=!1,errMessage:r=(0,l.AP)("Name is required.")}},n.state={name:e.name},n.inputRef=s.createRef(),n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;if(this.inputRef.current.focus(),this.props.hasSuffix){var t=this.props.name.lastIndexOf(".");this.inputRef.current.setSelectionRange(0,t,"forward")}else this.inputRef.current.setSelectionRange(0,-1);setTimeout((function(){document.addEventListener("click",e.onClick)}),1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.onClick)}},{key:"render",value:function(){return(0,d.jsx)("div",{className:"rename-container",children:(0,d.jsx)("input",{ref:this.inputRef,value:this.state.name,onChange:this.onChange,onKeyDown:this.onKeyDown})})}}])}(s.Component);t.A=p},39143:function(e,t,n){"use strict";n.d(t,{A:function(){return _}});var r=n(23029),o=n(92901),a=n(39874),i=n(85501),s=n(9950),l=n(40866),c=n(58195),u=n(14113),d=n(99308),p=n(85907),f=n(18849),h=n(59051),m=n.n(h),g=n(40326),v=n(97011),y=n(65604),C=n(4086),A=n(44414),x=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onFileTagChanged=function(e){var t=e.parent_path,r={name:e.filename},o="/"===t?t+e.filename:t+"/"+e.filename;n.props.onFileTagChanged(r,o)},n.onDeleteTaggedFile=function(e){var t=n.props.repoID,r=e.file_tag_id;v.e.deleteFileTag(t,r).then((function(t){n.getTaggedFiles(),n.props.updateUsedRepoTags(),n.props.onFileTagChanged&&!e.file_deleted&&n.onFileTagChanged(e)})).catch((function(e){var t=y.Aq.getErrorMsg(e);C.A.danger(t)}))},n.getTaggedFiles=function(){var e=n.props,t=e.repoID,r=e.currentTag,o=e.shareLinkToken;(o?v.e.getShareLinkTaggedFiles(o,r.id):v.e.listTaggedFiles(t,r.id)).then((function(e){var t=[];void 0!==e.data.tagged_files&&e.data.tagged_files.forEach((function(e){var n=e;t.push(n)})),n.setState({taggedFileList:t})})).catch((function(e){var t=y.Aq.getErrorMsg(e);C.A.danger(t)}))},n.state={taggedFileList:[]},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.getTaggedFiles()}},{key:"render",value:function(){var e=this,t=this.state.taggedFileList;return(0,A.jsxs)(c.A,{isOpen:!0,style:{maxWidth:"678px"},children:[(0,A.jsx)(u.A,{toggle:this.props.onClose,children:(0,g.AP)("Tagged Files")}),(0,A.jsx)(d.A,{className:"dialog-list-container",children:(0,A.jsxs)("table",{children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"50%",className:"ellipsis",children:(0,g.AP)("Name")}),(0,A.jsx)("th",{width:"20%",children:(0,g.AP)("Size")}),(0,A.jsx)("th",{width:"22%",children:(0,g.AP)("Last Update")}),(0,A.jsx)("th",{width:"8%"})]})}),(0,A.jsx)("tbody",{children:t.map((function(t,n){return(0,A.jsx)(b,{repoID:e.props.repoID,taggedFile:t,onDeleteTaggedFile:e.onDeleteTaggedFile,shareLinkToken:e.props.shareLinkToken,enableFileDownload:e.props.enableFileDownload},n)}))})]})}),(0,A.jsx)(p.A,{children:(0,A.jsx)(f.A,{color:"secondary",onClick:this.props.toggleCancel,children:(0,g.AP)("Close")})})]})}}])}(s.Component),b=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onMouseEnter=function(){n.setState({active:!0})},n.onMouseLeave=function(){n.setState({active:!1})},n.deleteFile=function(e){e.preventDefault(),n.props.onDeleteTaggedFile(n.props.taggedFile)},n.state={active:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.taggedFile,n=e.shareLinkToken,r=e.enableFileDownload,o=t.parent_path?y.Aq.joinPath(t.parent_path,t.filename):"",a=n?g.Yc+"d/"+n+"/files/?p="+y.Aq.encodePath(o):g.Yc+"lib/"+this.props.repoID+"/file"+y.Aq.encodePath(o);return(0,A.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onFocus:this.onMouseEnter,children:[t.file_deleted?(0,A.jsx)(s.Fragment,{children:(0,A.jsxs)("td",{colSpan:"3",className:"name",children:[t.filename," ",(0,A.jsx)("span",{style:{color:"red"},children:(0,g.AP)("deleted")})]})}):(0,A.jsxs)(s.Fragment,{children:[(0,A.jsx)("td",{children:(0,A.jsx)("a",{href:a,target:"_blank",className:"d-inline-block w-100 ellipsis",title:t.filename,rel:"noreferrer",children:t.filename})}),(0,A.jsx)("td",{children:y.Aq.bytesToSize(t.size)}),(0,A.jsx)("td",{children:m().unix(t.mtime).fromNow()})]}),(0,A.jsxs)("td",{children:[!n&&(0,A.jsx)("a",{href:"#",role:"button","aria-label":(0,g.AP)("Delete"),title:(0,g.AP)("Delete"),className:"action-icon sf2-icon-x3".concat(this.state.active?"":" invisible"),onClick:this.deleteFile}),n&&r&&(0,A.jsx)("a",{className:"action-icon sf2-icon-download".concat(this.state.active?"":" invisible"),href:"".concat(a,"&dl=1"),title:(0,g.AP)("Download"),"aria-label":(0,g.AP)("Download")})]})]})}}])}(s.Component),_=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onListTaggedFiles=function(e){n.setState({currentTag:e,isListTaggedFileShow:!n.state.isListTaggedFileShow})},n.onCloseDialog=function(){n.setState({isListTaggedFileShow:!1})},n.state={currentTag:null,isListTaggedFileShow:!1},n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.repoID,r=t.usedRepoTags,o=t.className;return(0,A.jsxs)("div",{className:"repo-info-bar ".concat(o||""),children:[r.length>0&&(0,A.jsx)("ul",{className:"used-tag-list",children:r.map((function(t){return(0,A.jsxs)("li",{className:"used-tag-item",children:[(0,A.jsx)("span",{className:"used-tag",style:{backgroundColor:t.color}}),(0,A.jsx)("span",{className:"used-tag-name",title:t.name,children:t.name}),(0,A.jsx)("button",{type:"button",className:"used-tag-files border-0 bg-transparent",onClick:e.onListTaggedFiles.bind(e,t),children:t.fileCount>1?t.fileCount+" files":t.fileCount+" file"})]},t.id)}))}),this.state.isListTaggedFileShow&&(0,A.jsx)(l.A,{children:(0,A.jsx)(x,{repoID:n,currentTag:this.state.currentTag,onClose:this.onCloseDialog,toggleCancel:this.onListTaggedFiles,updateUsedRepoTags:this.props.updateUsedRepoTags,onFileTagChanged:this.props.onFileTagChanged,shareLinkToken:this.props.shareLinkToken,enableFileDownload:this.props.enableFileDownload})})]})}}])}(s.Component)},14522:function(e,t,n){"use strict";n.d(t,{Pf:function(){return i},Rx:function(){return a},gO:function(){return r},nT:function(){return o}});var r=26,o=.22,a=.4,i=.15},91447:function(e,t,n){"use strict";n.d(t,{A:function(){return a}});n(9950);var r=n(47089),o=n(44414);var a=function(e){return(0,o.jsxs)("div",{className:"resize-bar",ref:e.resizeBarRef,style:Object.assign({zIndex:r.r},e.resizeBarStyle),onMouseDown:e.onResizeMouseDown,onMouseOver:e.onResizeMouseOver,children:[(0,o.jsx)("div",{className:"resize-bar-line"}),(0,o.jsx)("div",{className:"resize-bar-drag-handler",ref:e.dragHandlerRef,style:e.dragHandlerStyle})]})}},84295:function(e,t,n){"use strict";n.d(t,{A:function(){return v}});var r=n(89379),o=n(23029),a=n(92901),i=n(39874),s=n(85501),l=n(9950),c=n(92203),u=n(28321),d=n(66945),p=n(40326),f=n(65604),h=n(81446),m=n(44414),g=function(e){function t(e){var n;return(0,o.A)(this,t),(n=(0,i.A)(this,t,[e])).checkMarkdownEditorRenderCompleted=function(){n.seafileMarkdownViewerRef&&("empty-loading-page"!==n.seafileMarkdownViewerRef.firstElementChild.className&&(n.setState({isMarkdownEditorRenderCompleted:!0}),n.timer&&clearInterval(n.timer)))},n.onLinkClick=function(e){n.props.onLinkClick(e)},n.changeInlineNode=function(e){var t,r,o=n.props.repoID;if("image"==e.type){if(t=e.data.src,new RegExp(p.xW+"/lib/"+o+"/file.*raw=1").test(t)){var a=t.indexOf("/file"),i=t.indexOf("?");r=t.substring(a+5,i)}else{if(!/^\.\.\/*/.test(t)&&!/^\.\/*/.test(t))return;var s=n.props.path,l=s.slice(0,s.lastIndexOf("/"))+"/"+t;r=f.Aq.pathNormalize(l)}e.data.src=p.xW+"/view-image-via-public-wiki/?slug="+p.yR+"&path="+r}else if("link"==e.type)if(t=e.url,f.Aq.isInternalFileLink(t,o))if(f.Aq.isInternalMarkdownLink(t,o)){var c=f.Aq.getPathFromInternalMarkdownLink(t,o);e.url=p.xW+"/published/"+p.yR+c}else e.url=t.replace(/(.*)lib\/([-0-9a-f]{36})\/file(.*)/g,(function(e,t,n,r){return"".concat(t,"d/").concat(p.Ji,"/files/?p=").concat(r,"&dl=1")}));else if(f.Aq.isInternalDirLink(t,o)){var u=f.Aq.getPathFromInternalDirLink(t,o);e.url=p.xW+"/published/"+p.yR+u}return e},n.modifyValueBeforeRender=function(e){return f.Aq.changeMarkdownNodes(e,n.changeInlineNode)},n.renderMarkdown=function(){var e=n.props,t=e.isTOCShow,o=void 0===t||t,a=e.isWiki,i=e.markdownContent,s=(0,r.A)({isShowOutline:o,mathJaxSource:"".concat(p.SG,"js/mathjax/tex-svg.js"),value:i,scrollRef:n.scrollRef,onLinkClick:n.onLinkClick},a&&{beforeRenderCallback:n.modifyValueBeforeRender});return(0,m.jsx)(u.I18nextProvider,{i18n:d.A,children:(0,m.jsx)(l.Suspense,{fallback:(0,m.jsx)(h.A,{}),children:(0,m.jsx)(c.MarkdownViewer,(0,r.A)({},s))})})},n.scrollRef=l.createRef(),n.seafileMarkdownViewerRef=null,n.timer=null,n.state={isMarkdownEditorRenderCompleted:!1},n}return(0,s.A)(t,e),(0,a.A)(t,[{key:"componentDidMount",value:function(){var e=this;this.timer=setInterval((function(){e.checkMarkdownEditorRenderCompleted()}),100)}},{key:"componentWillUnmount",value:function(){this.timer&&clearInterval(this.timer)}},{key:"render",value:function(){var e=this,t=this.state.isMarkdownEditorRenderCompleted,n=this.props,r=n.isFileLoading,o=n.isWiki,a=n.containerClassName,i=void 0===a?"":a;if(r)return(0,m.jsx)(h.A,{});var s="wiki-page-container ".concat(i),l="wiki-page-content ".concat(o?"":"w-100");return(0,m.jsx)("div",{ref:this.scrollRef,className:s,children:(0,m.jsxs)("div",{className:l,ref:function(t){return e.seafileMarkdownViewerRef=t},children:[this.props.children,this.renderMarkdown(),t&&(0,m.jsxs)("p",{id:"wiki-page-last-modified",children:[(0,p.AP)("Last modified by")," ",this.props.latestContributor,", ",(0,m.jsx)("span",{children:this.props.lastModified})]}),!t&&(0,m.jsx)(h.A,{})]})})}}])}(l.Component);g.defaultProps={isWiki:!1};var v=g},79837:function(e,t,n){"use strict";n.d(t,{A:function(){return g}});var r=n(23029),o=n(92901),a=n(39874),i=n(85501),s=n(9950),l=n(94634),c=n(40326),u=n(36402),d=n(65604),p=n(44414),f=function(e){function t(e){var n;(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onMouseEnter=function(){n.props.isItemFreezed||n.setState({isShowOperationMenu:!0,isHighlight:!0})},n.onMouseOver=function(){n.props.isItemFreezed||n.setState({isShowOperationMenu:!0,isHighlight:!0})},n.onMouseLeave=function(){n.props.isItemFreezed||n.setState({isShowOperationMenu:!1,isHighlight:!1})},n.onNodeClick=function(){var e=n.props.node.object;if(e.isDir())n.props.onNodeClick(n.props.node);else{var t=d.Aq.getUserPermission(e.permission),r=t.isCustomPermission,o=t.customPermission;if(r){var a=o.permission,i=a.preview,s=a.modify;if(!i&&!s)return}n.props.onNodeClick(n.props.node)}},n.onLoadToggle=function(e){e.stopPropagation();var t=n.props.node;t.isExpanded?n.props.onNodeCollapse(t):n.props.onNodeExpanded(t)},n.onNodeDragStart=function(e){if(d.Aq.isIEBrowser()||!n.canDrag)return!1;n.props.onNodeDragStart(e,n.props.node)},n.onNodeDragEnter=function(e){if(d.Aq.isIEBrowser()||!n.canDrag)return!1;"dir"===n.props.node.object.type&&n.setState({isNodeDropShow:!0}),n.props.onNodeDragEnter(e,n.props.node)},n.onNodeDragMove=function(e){if(d.Aq.isIEBrowser()||!n.canDrag)return!1;n.props.onNodeDragMove(e)},n.onNodeDragLeave=function(e){if(d.Aq.isIEBrowser()||!n.canDrag)return!1;n.setState({isNodeDropShow:!1}),n.props.onNodeDragLeave(e,n.props.node)},n.onNodeDrop=function(e){if(d.Aq.isIEBrowser()||!n.canDrag)return!1;e.stopPropagation(),n.setState({isNodeDropShow:!1}),n.props.onNodeDrop(e,n.props.node)},n.unfreezeItem=function(){n.setState({isShowOperationMenu:!1}),n.props.unfreezeItem()},n.onMenuItemClick=function(e,t,r){n.props.onMenuItemClick(e,r)},n.onItemMouseDown=function(e){e.stopPropagation(),e.button},n.onItemContextMenu=function(e){n.handleContextClick(e)},n.handleContextClick=function(e){n.props.handleContextClick(e,n.props.node),n.setState({isShowOperationMenu:!1})},n.getNodeTypeAndIcon=function(){var e=n.props.node,t="",r="";if("dir"===e.object.type)t=(0,p.jsx)("i",{className:"sf3-font sf3-font-folder"}),r="dir";else{var o=e.object.name.lastIndexOf(".");if(-1===o)t=(0,p.jsx)("i",{className:"sf3-font sf3-font-file"}),r="file";else{var a=e.object.name.slice(o).toLowerCase();".png"===a||".jpg"===a||".jpeg"===a||".gif"===a||".bmp"===a?(t=(0,p.jsx)("i",{className:"sf3-font sf3-font-image"}),r="image"):".md"===a||".markdown"===a?(t=(0,p.jsx)("i",{className:"sf3-font sf3-font-files2"}),r="file"):(t=(0,p.jsx)("i",{className:"sf3-font sf3-font-file"}),r="file")}}return{icon:t,type:r}},n.calculateMenuList=function(e){var t=l.A.NEW_FOLDER,r=l.A.NEW_FILE,o=l.A.COPY,a=l.A.MOVE,i=l.A.RENAME,s=l.A.DELETE,c=l.A.OPEN_VIA_CLIENT,u=[i,s,o,a,c];"dir"===e.object.type&&(u=[t,r,o,a,i,s]);var p=n.props.userPerm,f=d.Aq.getUserPermission(p),h=f.isCustomPermission,m=f.customPermission;if(!h)return u;u=[];var g=m.permission,v=g.create,y=g.modify,C=g.delete,A=g.copy;return"dir"===e.object.type&&v&&u.push(t,r),A&&u.push(o),y&&u.push(a,i),C&&u.push(s),"dir"!==e.object.type&&u.push(c),u},n.renderChildren=function(){var e=n.props.node;return e.hasChildren()?(0,p.jsx)("div",{className:"children",children:e.children.map((function(e){return(0,p.jsx)(t,{node:e,leftIndent:n.props.leftIndent+20,userPerm:n.props.userPerm,currentPath:n.props.currentPath,isNodeMenuShow:n.props.isNodeMenuShow,isItemFreezed:n.props.isItemFreezed,onNodeClick:n.props.onNodeClick,onNodeCollapse:n.props.onNodeCollapse,onNodeExpanded:n.props.onNodeExpanded,freezeItem:n.props.freezeItem,onMenuItemClick:n.props.onMenuItemClick,unfreezeItem:n.unfreezeItem,onNodeDragStart:n.props.onNodeDragStart,onNodeDragMove:n.props.onNodeDragMove,onNodeDrop:n.props.onNodeDrop,onNodeDragEnter:n.props.onNodeDragEnter,onNodeDragLeave:n.props.onNodeDragLeave,handleContextClick:n.props.handleContextClick,isDisplayFiles:n.props.isDisplayFiles},e.path)}))}):""},n.state={isHighlight:!1,isShowOperationMenu:!1,isNodeDropShow:!1};var o=e.userPerm;n.canDrag="rw"===o;var i=d.Aq.getUserPermission(o),s=i.isCustomPermission,c=i.customPermission;if(s){var u=c.permission.modify;n.canDrag=u}return n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.isItemFreezed||this.setState({isShowOperationMenu:!1,isHighlight:!1})}},{key:"render",value:function(){var e=this.props,t=e.currentPath,n=e.node,r=e.isNodeMenuShow,o=e.userPerm,a=e.leftIndent,i=this.getNodeTypeAndIcon(),s=i.type,l=i.icon,f=this.state.isHighlight?"tree-node-inner-hover ":"";if(n.path===t&&(f="tree-node-hight-light"),"/"!==n.path&&"dir"!==s&&!this.props.isDisplayFiles)return"";var h=d.Aq.getUserPermission(o).isCustomPermission;return(0,p.jsxs)("div",{className:"tree-node",children:[(0,p.jsxs)("div",{type:s,className:"tree-node-inner text-nowrap ".concat(f," ").concat("/"===n.path?"hide":""," ").concat(this.state.isNodeDropShow?"tree-node-drop":""),title:n.object.name,onMouseEnter:this.onMouseEnter,onMouseOver:this.onMouseOver,onMouseLeave:this.onMouseLeave,onMouseDown:this.onItemMouseDown,onContextMenu:this.onItemContextMenu,onClick:this.onNodeClick,children:[(0,p.jsx)("div",{className:"tree-node-text",draggable:this.canDrag,onDragStart:this.onNodeDragStart,onDragEnter:this.onNodeDragEnter,onDragLeave:this.onNodeDragLeave,onDragOver:this.onNodeDragMove,onDrop:this.onNodeDrop,style:{paddingLeft:a+5},children:n.object.name}),(0,p.jsxs)("div",{className:"left-icon",style:{left:a-40},children:["dir"===s&&(!n.isLoaded||n.isLoaded&&n.hasChildren())&&(0,p.jsx)("i",{className:"folder-toggle-icon sf3-font sf3-font-down ".concat(n.isExpanded?"":"rotate-270"),onMouseDown:function(e){return e.stopPropagation()},onClick:this.onLoadToggle}),(0,p.jsx)("i",{className:"tree-node-icon",children:l})]}),r&&(0,p.jsx)("div",{className:"right-icon",children:("rw"===o||c.ln||h)&&this.state.isShowOperationMenu&&(0,p.jsx)(u.A,{item:this.props.node,toggleClass:"sf3-font sf3-font-more-vertical",getMenuList:this.calculateMenuList,onMenuItemClick:this.onMenuItemClick,freezeItem:this.props.freezeItem,unfreezeItem:this.unfreezeItem,menuStyle:d.Fr?{zIndex:1050}:{}})})]}),n.isExpanded&&this.renderChildren()]})}}])}(s.Component),h=n(29009),m=n(46757),g=function(e){function t(e){var n;(0,r.A)(this,t),(n=(0,a.A)(this,t,[e])).onItemMove=function(e,t,r,o){n.props.onItemMove(e,t,r,o)},n.onNodeDragStart=function(e,t){if(d.Aq.isIEBrowser())return!1;var n={nodeDirent:t.object,nodeParentPath:t.parentNode.path,nodeRootPath:t.path};n=JSON.stringify(n),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("application/drag-item-info",n)},n.onNodeDragEnter=function(e,t){if(d.Aq.isIEBrowser()||!n.canDrop)return!1;e.persist(),"tree-view tree "===e.target.className&&n.setState({isTreeViewDropTipShow:!0})},n.onNodeDragMove=function(e){if(d.Aq.isIEBrowser()||!n.canDrop)return!1;e.preventDefault(),e.dataTransfer.dropEffect="move"},n.onNodeDragLeave=function(e,t){if(d.Aq.isIEBrowser()||!n.canDrop)return!1;"tree-view tree tree-view-drop"===e.target.className&&n.setState({isTreeViewDropTipShow:!1})},n.onContainerClick=function(e){(0,m.ks)()},n.onNodeClick=function(e){(0,m.ks)(),n.props.onNodeClick(e)},n.onNodeDrop=function(e,t){if(d.Aq.isIEBrowser()||!n.canDrop)return!1;if(!e.dataTransfer.files.length){var r=e.dataTransfer.getData("application/drag-item-info");if(r){var o=r=JSON.parse(r),a=o.nodeDirent,i=o.nodeParentPath,s=o.nodeRootPath,l=t;if(Array.isArray(r))return l?void n.onMoveItems(r,l,n.props.currentRepoInfo,l.path):("/"===r[0].nodeParentPath||n.props.onItemsMove(n.props.currentRepoInfo,"/"),void n.setState({isTreeViewDropTipShow:!1}));if(!l)return"/"===i||n.onItemMove(n.props.currentRepoInfo,a,"/",i),void n.setState({isTreeViewDropTipShow:!1});if("dir"===l.object.type&&i!==l.path&&(i!==l.parentNode.path||l.object.name!==a.name)){if("dir"===l.object.type&&"dir"===a.type)if(l.parentNode.path!==i)if(d.Aq.getPaths(l.path).includes(s))return;n.onItemMove(n.props.currentRepoInfo,a,l.path,i)}}}},n.onMoveItems=function(e,t,r,o){var a=[],i=d.Aq.getPaths(o);(e.forEach((function(e){var t=e.nodeRootPath;a.push(t)})),"dir"===t.object.type)&&(a.some((function(e){return e===o}))||e[0].nodeParentPath&&e[0].nodeParentPath===t.path||a.some((function(e){return i.includes(e)}))||n.props.onItemsMove(r,o))},n.freezeItem=function(){n.setState({isItemFreezed:!0})},n.unfreezeItem=function(){n.setState({isItemFreezed:!1})},n.onMenuItemClick=function(e,t){n.props.onMenuItemClick(e,t),(0,m.ks)()},n.onMouseDown=function(e){e.stopPropagation(),e.button},n.onContextMenu=function(e){e.preventDefault();var t=n.props.currentRepoInfo;if("admin"!==t.permission&&"rw"!==t.permission)return"";n.handleContextClick(e)},n.handleContextClick=function(e,t){if(e.preventDefault(),e.stopPropagation(),n.props.isNodeMenuShow){var r=e.clientX||e.touches&&e.touches[0].pageX,o=e.clientY||e.touches&&e.touches[0].pageY;n.props.posX&&(r-=n.props.posX),n.props.posY&&(o-=n.props.posY),(0,m.ks)();var a=n.getMenuList(t),i={id:"tree-node-contextmenu",position:{x:r,y:o},target:e.target,currentObject:t,menuList:a};(0,m.db)(i)}},n.getMenuList=function(e){var t=[],r=l.A.NEW_FOLDER,o=l.A.NEW_FILE,a=l.A.COPY,i=l.A.MOVE,s=l.A.RENAME,c=l.A.DELETE,u=l.A.OPEN_VIA_CLIENT;if(!e)return[r,o];t="dir"===e.object.type?[r,o,a,i,s,c]:[s,c,a,i,u];var p=n.props.userPerm,f=d.Aq.getUserPermission(p),h=f.isCustomPermission,m=f.customPermission;if(!h)return t;t=[];var g=m.permission,v=g.create,y=g.modify,C=g.delete,A=g.copy;return e?("dir"===e.object.type&&v&&t.push(r,o),A&&t.push(a),y&&t.push(i,s),C&&t.push(c),"dir"!==e.object.type&&t.push(u),t):(v&&t.push(r,o),t)},n.onShowMenu=function(){n.freezeItem()},n.onHideMenu=function(){n.unfreezeItem()},n.state={isItemFreezed:!1,isTreeViewDropTipShow:!1};var o=e.userPerm;n.canDrop="rw"===o;var i=d.Aq.getUserPermission(o),s=i.isCustomPermission,c=i.customPermission;if(s){var u=c.permission.modify;n.canDrop=u}return n}return(0,i.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return(0,p.jsxs)("div",{className:"tree-view tree ".concat(this.state.isTreeViewDropTipShow&&this.canDrop?"tree-view-drop":""),onDrop:this.onNodeDrop,onDragEnter:this.onNodeDragEnter,onDragLeave:this.onNodeDragLeave,onMouseDown:this.onMouseDown,onContextMenu:this.onContextMenu,onClick:this.onContainerClick,children:[(0,p.jsx)(f,{userPerm:this.props.userPerm,node:this.props.treeData.root,currentPath:this.props.currentPath,leftIndent:20,isNodeMenuShow:this.props.isNodeMenuShow,isItemFreezed:this.state.isItemFreezed,onNodeClick:this.onNodeClick,onMenuItemClick:this.props.onMenuItemClick,onNodeExpanded:this.props.onNodeExpanded,onNodeCollapse:this.props.onNodeCollapse,onNodeDragStart:this.onNodeDragStart,freezeItem:this.freezeItem,unfreezeItem:this.unfreezeItem,onNodeDragMove:this.onNodeDragMove,onNodeDrop:this.onNodeDrop,onNodeDragEnter:this.onNodeDragEnter,onNodeDragLeave:this.onNodeDragLeave,handleContextClick:this.handleContextClick,isDisplayFiles:this.props.isDisplayFiles}),(0,p.jsx)(h.A,{id:"tree-node-contextmenu",onMenuItemClick:this.onMenuItemClick,onHideMenu:this.onHideMenu,onShowMenu:this.onShowMenu,getMenuContainerSize:this.props.getMenuContainerSize})]})}}])}(s.Component)},47089:function(e,t,n){"use strict";n.d(t,{V0:function(){return a},bV:function(){return o},r:function(){return r}});var r=2,o=2,a=3},19175:function(e,t,n){"use strict";var r=n(23029),o=n(92901),a=n(26910),i=n(58801),s=n(40326),l=n(3563),c=function(){return(0,o.A)((function e(){var t=this;(0,r.A)(this,e),this.getCollaborators=function(e){var n=t.server+"/api/v2.1/repos/"+e+"/related-users/";return t.req.get(n)},this.modifyRecord=function(e,n,r,o){var a=t.server+"/api/v2.1/repos/"+e+"/metadata/records/",i={records_data:[{record_id:n,record:r,obj_id:o}]};return t.req.put(a,i)},this.modifyRecords=function(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=t.server+"/api/v2.1/repos/"+e+"/metadata/records/",a={records_data:n};return r&&(a.is_copy_paste="true"),t.req.put(o,a)},this.listUserInfo=function(e){var n=t.server+"/api/v2.1/user-list/",r={user_id_list:e};return t._sendPostRequest(n,r,{headers:{"Content-type":"application/json"}})},this.listViews=function(e){var n=t.server+"/api/v2.1/repos/"+e+"/metadata/views/";return t.req.get(n)},this.getView=function(e,n){var r=t.server+"/api/v2.1/repos/"+e+"/metadata/views/"+n+"/";return t.req.get(r)},this.addView=function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"table",o=t.server+"/api/v2.1/repos/"+e+"/metadata/views/",a={name:n,type:r,data:{basic_filters:l.pkt[r],sorts:l.hcH[r]}};return t._sendPostRequest(o,a,{headers:{"Content-type":"application/json"}})},this.duplicateView=function(e,n){var r=t.server+"/api/v2.1/repos/"+e+"/metadata/duplicate-view/",o={view_id:n};return t._sendPostRequest(r,o,{headers:{"Content-type":"application/json"}})},this.modifyView=function(e,n,r){var o=t.server+"/api/v2.1/repos/"+e+"/metadata/views/",a={view_id:n,view_data:r};return t.req.put(o,a)},this.deleteView=function(e,n){var r=t.server+"/api/v2.1/repos/"+e+"/metadata/views/",o={view_id:n};return t.req.delete(r,{data:o})},this.moveView=function(e,n,r){var o=t.server+"/api/v2.1/repos/"+e+"/metadata/move-views/",a={view_id:n,target_view_id:r};return t._sendPostRequest(o,a,{headers:{"Content-type":"application/json"}})},this.insertColumn=function(e,n,r,o){var a=o.key,i=o.data,s=t.server+"/api/v2.1/repos/"+e+"/metadata/columns/",l={column_name:n,column_type:r};return a&&(l.column_key=a),i&&(l.column_data=i),t.req.post(s,l)},this.deleteColumn=function(e,n){var r=t.server+"/api/v2.1/repos/"+e+"/metadata/columns/",o={column_key:n};return t.req.delete(r,{data:o})},this.renameColumn=function(e,n,r){var o=t.server+"/api/v2.1/repos/"+e+"/metadata/columns/",a={column_key:n,name:r};return t.req.put(o,a)},this.modifyColumnData=function(e,n,r){var o=t.server+"/api/v2.1/repos/"+e+"/metadata/columns/",a={column_key:n,data:r};return t.req.put(o,a)},this.generateDescription=function(e,n){var r=t.server+"/api/v2.1/ai/generate-summary/",o={path:n,repo_id:e};return t.req.post(r,o)},this.imageCaption=function(e,n,r){var o=t.server+"/api/v2.1/ai/image-caption/",a={path:n,repo_id:e,lang:r};return t.req.post(o,a)}}),[{key:"init",value:function(e){var t=e.server,n=e.username,r=e.password,o=e.token;return this.server=t,this.username=n,this.password=r,this.token=o,this.token&&this.server&&(this.req=a.A.create({baseURL:this.server,headers:{Authorization:"Token "+this.token}})),this}},{key:"initForSeahubUsage",value:function(e){var t=e.siteRoot,n=e.xcsrfHeaders;if(t&&"/"===t.charAt(t.length-1)){var r=t.substring(0,t.length-1);this.server=r}else this.server=t;return this.req=a.A.create({headers:{"X-CSRFToken":n}}),this}},{key:"_sendPostRequest",value:function(e,t){return t.getHeaders?this.req.post(e,t,{headers:t.getHeaders()}):this.req.post(e,t)}},{key:"getMetadataStatus",value:function(e){var t=this.server+"/api/v2.1/repos/"+e+"/metadata/";return this.req.get(t)}},{key:"createMetadata",value:function(e){var t=this.server+"/api/v2.1/repos/"+e+"/metadata/";return this.req.put(t)}},{key:"deleteMetadata",value:function(e){var t=this.server+"/api/v2.1/repos/"+e+"/metadata/";return this.req.delete(t)}},{key:"getMetadata",value:function(e,t){var n=this.server+"/api/v2.1/repos/"+e+"/metadata/records/";return this.req.get(n,{params:t})}},{key:"getMetadataRecordInfo",value:function(e,t,n){var r=this.server+"/api/v2.1/repos/"+e+"/metadata/record/",o={};return t&&(o.parent_dir=t),n&&(o.name=n),this.req.get(r,{params:o})}}])}(),u=new c,d=i.Ay.load("sfcsrftoken");u.initForSeahubUsage({siteRoot:s.Yc,xcsrfHeaders:d}),t.A=u},44:function(e,t,n){"use strict";n.d(t,{lN:function(){return S},M8:function(){return g},Xj:function(){return f},D1:function(){return D},Sv:function(){return v},p_:function(){return h}});var r=n(89379),o=n(5544),a=n(9950),i=n(19175),s=n(65604),l=n(4086),c=n(40326),u=n(13042),d=n(44414),p=a.createContext(null),f=function(e){var t=e.repoID,n=e.hideMetadataView,f=e.selectMetadataView,h=e.children,m=(0,a.useMemo)((function(){return window.app.pageOptions.enableMetadataManagement}),[window.app.pageOptions.enableMetadataManagement]),g=(0,a.useState)(!1),v=(0,o.A)(g,2),y=v[0],C=v[1],A=(0,a.useState)(!1),x=(0,o.A)(A,2),b=x[0],_=x[1],w=(0,a.useState)([]),S=(0,o.A)(w,2),D=S[0],E=S[1],k=(0,a.useState)(0),M=(0,o.A)(k,2)[1],I=(0,a.useRef)({}),N=(0,a.useCallback)((function(){var e=window.location,t=e.origin,n=e.pathname,r=e.search;if(new URLSearchParams(r).get("view")){var o="".concat(t).concat(n);window.history.pushState({url:o,path:""},"",o)}}),[]);(0,a.useEffect)((function(){m?i.A.getMetadataStatus(t).then((function(e){var t=e.data.enabled;t||N(),C(t)})).catch((function(e){var t=s.Aq.getErrorMsg(e,!0);l.A.danger(t),C(!1)})):N()}),[t,m]);var P=(0,a.useCallback)((function(e){e!==y&&(e?_(!0):(n&&n(),N()),C(e))}),[y,n,N]);(0,a.useEffect)((function(){y?i.A.listViews(t).then((function(e){var t=e.data,n=t.navigation,r=t.views;Array.isArray(r)&&r.forEach((function(e){I.current[e._id]=e})),E(n)})).catch((function(e){var t=s.Aq.getErrorMsg(e);l.A.danger(t)})):(I.current={},E([]))}),[t,y]);var T=(0,a.useCallback)((function(e,n){if(!n){var r={children:[],path:"/"+u.AT.FILE_EXTENDED_PROPERTIES+"/"+e._id,isExpanded:!1,isLoaded:!0,isPreload:!0,object:{file_tags:[],id:u.AT.FILE_EXTENDED_PROPERTIES,name:(0,c.AP)("File extended properties"),type:u.AT.FILE_EXTENDED_PROPERTIES,isDir:function(){return!1}},parentNode:{},key:t,view_id:e._id};f(r)}}),[t,f]),O=(0,a.useCallback)((function(e,n,r,o){i.A.addView(t,e,n).then((function(e){var t=e.data.view,n=D.slice(0);n.push({_id:t._id,type:"view"}),I.current[t._id]=t,E(n),T(t),r&&r()})).catch((function(e){o&&o(e)}))}),[D,t,I,T]),j=(0,a.useCallback)((function(e){i.A.duplicateView(t,e).then((function(e){var t=e.data.view,n=D.slice(0);n.push({_id:t._id,type:"view"}),I.current[t._id]=t,E(n),T(t)})).catch((function(e){var t=s.Aq.getErrorMsg(e);l.A.danger(t)}))}),[D,t,I,T]),R=(0,a.useCallback)((function(e,n){i.A.deleteView(t,e).then((function(t){var r=D.filter((function(t){return t._id!==e}));if(delete I.current[e],E(r),n){var o=D.findIndex((function(t){return t._id===e})),a=D[o-1]._id,i=I.current[a];T(i)}})).catch((function(e){var t=s.Aq.getErrorMsg(e);l.A.danger(t)}))}),[t,D,T,I]),L=(0,a.useCallback)((function(e,n,o,a){i.A.modifyView(t,e,n).then((function(t){var a=I.current[e];I.current[e]=(0,r.A)((0,r.A)({},a),n),M((function(e){return e+1})),o&&o()})).catch((function(e){a&&a(e)}))}),[t,I]),F=(0,a.useCallback)((function(e,n){i.A.moveView(t,e,n).then((function(e){var t=e.data.navigation;E(t)})).catch((function(e){var t=s.Aq.getErrorMsg(e);l.A.danger(t)}))}),[t]);return(0,d.jsx)(p.Provider,{value:{enableMetadata:y,updateEnableMetadata:P,showFirstView:b,setShowFirstView:_,navigation:D,viewsMap:I.current,selectView:T,addView:O,duplicateView:j,deleteView:R,updateView:L,moveView:F},children:h})},h=function(){var e=(0,a.useContext)(p);if(!e)throw new Error("'MetadataContext' is null");return e},m=a.createContext(null),g=function(e){var t=e.repoID,n=e.children,r=(0,a.useMemo)((function(){return window.app.pageOptions.enableMetadataManagement}),[window.app.pageOptions.enableMetadataManagement]),c=(0,a.useState)(!1),u=(0,o.A)(c,2),p=u[0],f=u[1];return(0,a.useEffect)((function(){r&&i.A.getMetadataStatus(t).then((function(e){var t=e.data.enabled;f(t)})).catch((function(e){var t=s.Aq.getErrorMsg(e,!0);l.A.danger(t),f(!1)}))}),[t,r]),(0,d.jsx)(m.Provider,{value:{enableMetadata:p},children:n})},v=function(){var e=(0,a.useContext)(m);if(!e)throw new Error("'EnableMetadataContext' is null");return e},y=n(64467),C=n(60436),A=n(3563),x=n(92901),b=n(23029),_=(0,x.A)((function e(t){(0,b.A)(this,e),this.avatar_url=t.avatar_url||"",this.contact_email=t.contact_email||"",this.username=t.email||t.username||"",this.email=this.username,this.name=t.name||"",this.name_pinyin=t.name_pinyin||"",this.id=t.id_in_org||""})),w=a.createContext(null),S=function(e){var t=e.repoID,n=e.children,s=(0,a.useState)({}),l=(0,o.A)(s,2),u=l[0],p=l[1],f=(0,a.useState)([]),h=(0,o.A)(f,2),m=h[0],g=h[1],v=(0,a.useMemo)((function(){var e=new A.DLc({mediaUrl:c.SG,api:i.A.listUserInfo}).queryUser;return window.queryUser=e,e}),[]);(0,a.useEffect)((function(){i.A.getCollaborators(t).then((function(e){var t,n=Array.isArray(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.user_list)?e.data.user_list.map((function(e){return new _(e)})):[];g(n)}))}),[t]),(0,a.useEffect)((function(){window.sfMetadata||(window.sfMetadata={},window.sfMetadata.getCollaboratorsFromCache=function(){return Object.values(window.sfMetadata.collaboratorsCache||{})||[]},window.sfMetadata.getCollaborators=function(){return[].concat((0,C.A)(window.sfMetadata.collaborators),(0,C.A)(Object.values(window.sfMetadata.collaboratorsCache||{})||[]))}),window.sfMetadata.collaborators=m,window.sfMetadata.collaboratorsCache=u}),[m,u]);var x=(0,a.useCallback)((function(e){var t=(0,r.A)((0,r.A)({},u),{},(0,y.default)({},e.email,e));p(t)}),[u]),b=(0,a.useCallback)((function(e){var t=m&&m.find((function(t){return t.email===e}));if(t)return t;var n="".concat(c.SG,"/avatars/default.png");return"anonymous"===e||"seafevents"===e?t={email:e,name:e,avatar_url:n}:(t=u[e])||((0,A.B9Y)(e)?null:{email:e,name:e,avatar_url:n})}),[m,u]);return(0,d.jsx)(w.Provider,{value:{collaborators:m,collaboratorsCache:u,updateCollaboratorsCache:x,getCollaborator:b,queryUser:v},children:n})},D=function(){var e=(0,a.useContext)(w);if(!e)throw new Error("'CollaboratorsContext' is null");return{collaborators:e.collaborators,collaboratorsCache:e.collaboratorsCache,updateCollaboratorsCache:e.updateCollaboratorsCache,getCollaborator:e.getCollaborator,queryUser:e.queryUser}}},53264:function(e,t,n){"use strict";n.d(t,{lN:function(){return oe.lN},M8:function(){return oe.M8},BT:function(){return mr.A},iF:function(){return Hr},nx:function(){return Sr},Lr:function(){return Rr},Bd:function(){return gr},D1:function(){return oe.D1},Sv:function(){return oe.Sv},p_:function(){return oe.p_}});var r=n(89379);var o=n(9950),a=n(47127),i=n(58419),s=n(44414),l=n(71791),c=n(64467),u=n(90675),d=n(10467),p=n(5544),f=n(4086),h=n(73575),m=n(3563),g=n(80045),v=n(48738),y=n.n(v),C=n(23029),A=n(92901),x=n(39874),b=n(85501),_=n(89857),w=n(78297),S=function(e){function t(){var e;(0,C.A)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=(0,x.A)(this,t,[].concat(r))).cleanUp=function(){window.removeEventListener("mouseup",e.onMouseUp),window.removeEventListener("mousemove",e.onMouseMove),window.removeEventListener("touchend",e.onMouseUp),window.removeEventListener("touchmove",e.onMouseMove)},e.onMouseDown=function(t){t.preventDefault&&t.preventDefault(),window.addEventListener("mouseup",e.onMouseUp),window.addEventListener("mousemove",e.onMouseMove),window.addEventListener("touchend",e.onMouseUp),window.addEventListener("touchmove",e.onMouseMove)},e.onMouseUp=function(t){e.props.onDragEnd&&e.props.onDragEnd(t),e.cleanUp()},e.onMouseMove=function(t){t.preventDefault&&t.preventDefault(),(0,m.sg1)(e.props.onDrag(t),100)},e}return(0,b.A)(t,e),(0,A.A)(t,[{key:"componentWillUnmount",value:function(){this.cleanUp()}},{key:"render",value:function(){return(0,s.jsx)("div",{className:"record-HeaderCell__draggable",onClick:function(e){return e.stopPropagation()},onDrag:this.props.onDrag,onMouseDown:this.onMouseDown,onTouchStart:this.onMouseDown})}}])}(o.Component),D=S,E=n(19260),k=n(6030),M=n(33151),I=n(68879),N=function(e){var t=e.disabled,n=e.iconName,r=e.target,a=e.title,i=e.tip,c=e.className,u=e.onChange,d=e.onMouseEnter,f=(0,o.useState)(!1),h=(0,p.A)(f,2),m=h[0],g=h[1];(0,o.useEffect)((function(){t&&g(!0)}),[]);var v=(0,o.useCallback)((function(e){e.preventDefault(),e.nativeEvent.stopImmediatePropagation(),e.stopPropagation()}),[]);return t?(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(I.A,{className:y()("disabled",c),toggle:!0,onClick:v,onMouseEnter:d,id:r,children:[(0,s.jsx)(l.In,{iconName:n}),(0,s.jsx)("span",{className:"item-text",children:a}),m&&(0,s.jsx)(w.A,{placement:"right",target:r,fade:!1,delay:{show:0,hide:0},className:"sf-metadata-tooltip",children:i})]})}):(0,s.jsxs)(I.A,{id:r,onClick:u,onMouseEnter:d,className:c,children:[(0,s.jsx)(l.In,{iconName:n}),(0,s.jsx)("span",{className:"item-text",children:a})]})};N.defaultProps={onChange:function(){},onMouseEnter:function(){},disabled:!1,className:""};var P=N,T=n(99153),O=function(e){var t=e.column,n=e.view,r=e.renameColumn,a=e.modifyColumnData,c=e.deleteColumn,u=(0,o.createRef)(),d=(0,o.createRef)(),f=(0,o.useState)(!1),g=(0,p.A)(f,2),v=g[0],C=g[1],A=(0,o.useState)(!1),x=(0,p.A)(A,2),b=x[0],_=x[1],w=(0,o.useState)(!1),S=(0,p.A)(w,2),D=S[0],N=S[1],O=(0,o.useState)(!1),j=(0,p.A)(O,2),R=j[0],L=j[1],F=(0,o.useMemo)((function(){var e=new Date,t=e.getFullYear(),n=e.getMonth()+1,r=e.getDate(),o=e.getHours(),a=e.getMinutes();return n=n>9?n:"0".concat(n),r=r>9?r:"0".concat(r),o=o>9?o:"0".concat(o),a=a>9?a:"0".concat(a),"".concat(t,"-").concat(n,"-").concat(r," ").concat(o,":").concat(a)}),[]),U=(0,o.useCallback)((function(e){e&&e.preventDefault(),e&&e.stopPropagation();var t=e.target;"string"===t.className&&t.className.includes("disabled")||C(!v)}),[v]),Y=(0,o.useCallback)((function(){_(!0)}),[]),B=(0,o.useCallback)((function(){_(!1)}),[]),H=(0,o.useCallback)((function(){L(!0)}),[]),V=(0,o.useCallback)((function(){L(!1)}),[]),G=(0,o.useCallback)((function(e){var n=t.data||{};C(!1),a(t.key,{options:e},{options:n.options||[]})}),[t,a]),q=(0,o.useCallback)((function(e,n){e&&e.stopPropagation();var r=t.data?t.data.format:"";_(!1),C(!1),r!==n&&a(t.key,{format:n},{format:r})}),[t,a]),z=(0,o.useCallback)((function(){c(t.key,t)}),[t,c]),W=(0,o.useCallback)((function(){N(!0)}),[]),K=(0,o.useCallback)((function(){N(!1)}),[]),Z=(0,o.useCallback)((function(e){e!==t.name?(r(t.key,e,t.name),N(!1)):N(!1)}),[t,r]),X=(0,o.useCallback)((function(e){if(!e)return(0,s.jsx)(P,{disabled:!0,target:"sf-metadata-edit-column-format",title:(0,i.AP)("Edit format settings"),tip:(0,i.AP)("You do not have permission"),iconName:"set-up"});var n=t.data,r=(void 0===n?{}:n).format,o=(void 0===r?m.D23:r).indexOf("HH:mm")>-1,a=[{label:"".concat((0,i.AP)("ISO")," (").concat((0,m.u1Q)(F,y()("YYYY-MM-DD",{"HH:mm":o})),")"),value:y()("YYYY-MM-DD",{"HH:mm":o})},{label:"".concat((0,i.AP)("US")," (").concat((0,m.u1Q)(F,y()("M/D/YYYY",{"HH:mm":o})),")"),value:y()("M/D/YYYY",{"HH:mm":o})},{label:"".concat((0,i.AP)("European")," (").concat((0,m.u1Q)(F,y()("DD/MM/YYYY",{"HH:mm":o})),")"),value:y()("DD/MM/YYYY",{"HH:mm":o})},{label:"".concat((0,i.AP)("Germany Russia etc")," (").concat((0,m.u1Q)(F,y()("DD.MM.YYYY",{"HH:mm":o})),")"),value:y()("DD.MM.YYYY",{"HH:mm":o})}];return(0,s.jsxs)(E.A,{className:"sf-metadata-dropdown-menu w-100",isOpen:b,direction:"right",children:[(0,s.jsxs)(k.A,{tag:"span",role:"button","data-toggle":"dropdown","aria-expanded":v,className:"dropdown-item sf-metadata-column-dropdown-item d-flex align-items-center",onMouseOver:Y,disabled:!0,caret:!0,children:[(0,s.jsx)(l.In,{iconName:"set-up"}),(0,s.jsx)("span",{className:"item-text",children:(0,i.AP)("Edit format settings")})]}),(0,s.jsx)(M.A,{style:{marginLeft:"-16px",transform:"none"},children:a.map((function(e){return(0,s.jsx)(I.A,{className:"sf-metadata-column-dropdown-item",toggle:!1,onClick:function(t){return q(t,e.value)},children:(0,s.jsx)("span",{children:e.label})},e.value)}))})]})}),[F,t,v,b,q,Y]),$=(0,o.useCallback)((function(e,r){if(window.sfMetadataContext.canModifyView()){var o=n.sorts.slice(0),a=t.key,i=o.findIndex((function(e){return e.column_key===a})),s=o[i],l={column_key:t.key,sort_type:e},c=window.sfMetadataContext.eventBus;return s?s&&s.sort_type!==e?(o.splice(i,1,l),void c.dispatch(h.Tw.MODIFY_SORTS,o,!0)):void c.dispatch(h.Tw.DISPLAY_SORTS):(o.push(l),void c.dispatch(h.Tw.MODIFY_SORTS,o,!0))}r.stopPropagation()}),[n,t]),J=(0,o.useCallback)((function(){var e=t.type,n=window.sfMetadataContext.canModifyColumnData(t),r=window.sfMetadataContext.canDeleteColumn(t),o=window.sfMetadataContext.canRenameColumn(t),a=window.sfMetadataContext.canModifyView();return(0,s.jsx)(M.A,{ref:u,className:"sf-metadata-column-dropdown-menu",children:(0,s.jsxs)("div",{ref:d,children:[e===m.vZe.SINGLE_SELECT&&(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(P,{disabled:!n,target:"sf-metadata-edit-column-options",iconName:"single-select",title:(0,i.AP)("Edit single select"),tip:(0,i.AP)("You do not have permission"),onChange:H})}),e===m.vZe.MULTIPLE_SELECT&&(0,s.jsx)(P,{disabled:!n,target:"sf-metadata-edit-column-options",iconName:"multiple-select",title:(0,i.AP)("Edit multiple select"),tip:(0,i.AP)("You do not have permission"),onChange:H}),e===m.vZe.NUMBER&&(0,s.jsx)(P,{disabled:!n,target:"sf-metadata-edit-column-format",iconName:"set-up",title:(0,i.AP)("Edit format settings"),tip:(0,i.AP)("You do not have permission"),onChange:H}),e===m.vZe.DATE&&(0,s.jsx)(s.Fragment,{children:X(n)}),[m.vZe.DATE,m.vZe.SINGLE_SELECT,m.vZe.NUMBER,m.vZe.MULTIPLE_SELECT].includes(t.type)&&(0,s.jsx)(I.A,{divider:!0},"divider-item"),(0,s.jsx)(P,{disabled:!o,target:"sf-metadata-rename-column",iconName:"rename",title:(0,i.AP)("Rename property"),tip:(0,i.AP)("You do not have permission"),onChange:W,onMouseEnter:B}),(m.dc.includes(t.type)||m.oCN.includes(t.type))&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(P,{disabled:!a||m.oCN.includes(t.type),target:"sf-metadata-sort-ascending-column",iconName:"sort-ascending",title:(0,i.AP)("Sort ascending"),tip:a?(0,i.AP)("This property does not support sorting"):(0,i.AP)("You do not have permission"),onChange:function(){return $(m.ClR.UP)},onMouseEnter:B}),(0,s.jsx)(P,{disabled:!a||m.oCN.includes(t.type),target:"sf-metadata-sort-descending-column",iconName:"sort-descending",title:(0,i.AP)("Sort descending"),tip:a?(0,i.AP)("This property does not support sorting"):(0,i.AP)("You do not have permission"),onChange:function(){return $(m.ClR.DOWN)},onMouseEnter:B})]}),(0,s.jsx)(P,{disabled:!r,target:"sf-metadata-delete-column",iconName:"delete",title:(0,i.AP)("Delete property"),tip:(0,i.AP)("You do not have permission"),onChange:z,onMouseEnter:B})]})})}),[t,W,B,X,H,u,d,$,z]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(E.A,{className:"sf-metadata-dropdown-menu",isOpen:v,toggle:U,children:[(0,s.jsx)(k.A,{tag:"span",role:"button","data-toggle":"dropdown","aria-expanded":v,title:(0,i.AP)("More operations"),"aria-label":(0,i.AP)("More operations"),tabIndex:0,children:(0,s.jsx)(l.In,{iconName:"drop-down"})}),v&&!i.Fr&&(0,s.jsx)(l.Q$,{children:(0,s.jsx)("div",{className:"sf-metadata-dropdown-menu large",children:J()})})]}),D&&(0,s.jsx)(l.Q$,{children:(0,s.jsx)(T.Yt,{target:"sf-metadata-column-".concat(t.key),value:t.name,onToggle:K,onSubmit:Z})}),R&&(0,s.jsx)(l.Q$,{children:(0,s.jsx)(T.wm,{target:"sf-metadata-column-".concat(t.key),column:t,onToggle:V,onSubmit:G})})]})},j={hover:function(e,t,n){var r;if(window.sfMetadataBody){var o=200,a=t.getClientOffset().x,i=null===(r=document.querySelector(".sf-metadata-wrapper"))||void 0===r?void 0:r.clientWidth,s=window.innerWidth-i;i<=800&&(o=20),a>window.innerWidth-o?window.sfMetadataBody.scrollToRight():a<e.frozenColumnsWidth+o+s?window.sfMetadataBody.scrollToLeft():window.sfMetadataBody.clearHorizontalScroll()}},drop:function(e,t){var n=t.getItem(),r=e.column;if(r.key!==n.key&&n.column.frozen===r.frozen){var o={key:r.key};e.onMove(n,o),window.sfMetadataBody.clearHorizontalScroll()}}},R=function(e){var t=e.isOver,n=e.isDragging,r=e.canDrop,a=e.connectDragSource,c=e.connectDragPreview,u=e.connectDropTarget,d=e.frozen,p=e.groupOffsetLeft,f=e.isLastFrozenCell,g=e.height,v=e.isHideTriangle,C=e.column,A=e.style,x=e.view,b=e.renameColumn,_=e.deleteColumn,S=e.modifyColumnData,E=e.modifyLocalColumnWidth,k=e.modifyColumnWidth,M=(0,o.useRef)(null),I=(0,o.useMemo)((function(){return!v&&window.sfMetadataContext.canModify()}),[v]),N=(0,o.useMemo)((function(){var e=C.left,t=C.width,n=Object.assign({width:t,maxWidth:t,minWidth:t,height:g},A);return d||(n.left=e+p),n}),[d,p,C,g,A]),P=(0,o.useCallback)((function(e){var t=e.pageX||e.touches&&e.touches[0]&&e.touches[0].pageX||e.changedTouches&&e.changedTouches[e.changedTouches.length-1].pageX;return 0===e.pageX&&(t=0),t-M.current.getBoundingClientRect().left}),[]),T=(0,o.useCallback)((function(e){var t=P(e);t>0&&E(C,t)}),[C,P,E]),j=(0,o.useCallback)((function(e){var t=P(e);t>0&&k(C,Math.max(t,50))}),[C,P,k]),R=(0,o.useCallback)((function(e){window.sfMetadataContext.eventBus.dispatch(h.Tw.SELECT_COLUMN,e)}),[]),L=(0,o.useCallback)((function(e){e.preventDefault(),e.stopPropagation()}),[]),F=C.key,U=C.name,Y=C.type,B=m.gmg[Y],H=window.sfMetadataContext.canModifyColumnOrder(),V=(0,s.jsxs)("div",{className:y()("sf-metadata-result-table-cell column",{"table-last--frozen":f}),ref:M,style:N,id:"sf-metadata-column-".concat(F),onClick:function(){return R(C,d)},onContextMenu:L,children:[(0,s.jsxs)("div",{className:"sf-metadata-result-column-content sf-metadata-record-header-cell-left d-flex align-items-center text-truncate",children:[(0,s.jsx)("span",{className:"mr-2",id:"header-icon-".concat(F),children:(0,s.jsx)(l.In,{iconName:m.ZPL[Y],className:"sf-metadata-column-icon"})}),(0,s.jsx)(w.A,{placement:"bottom",target:"header-icon-".concat(F),fade:!1,trigger:"hover",className:"sf-metadata-tooltip",children:(0,i.AP)(B)}),(0,s.jsx)("div",{className:"header-name d-flex",children:(0,s.jsx)("span",{title:U,className:y()("header-name-text",{double:56===g}),children:U})})]}),I&&(0,s.jsx)(O,{column:C,view:x,renameColumn:b,deleteColumn:_,modifyColumnData:S}),(0,s.jsx)(D,{onDrag:T,onDragEnd:j})]});return H?(0,s.jsx)("div",{className:"sf-metadata-record-header-cell",children:u(c(a((0,s.jsx)("div",{style:{opacity:n?.2:1},className:y()("rdg-can-drop",{"rdg-dropping":t&&r}),children:V}))))},F):(0,s.jsx)("div",{className:"sf-metadata-record-header-cell",children:V},F)};R.defaultProps={style:null};var L=(0,_.Tl)("sfMetadataRecordHeaderCell",j,(function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver(),canDrop:t.canDrop(),dragged:t.getItem()}}))((0,_.I4)("sfMetadataRecordHeaderCell",{beginDrag:function(e){return{key:e.column.key,column:e.column}},endDrag:function(e,t){var n=t.getItem();if(!t.didDrop())return{source:n,target:{}}},isDragging:function(e){var t=e.column;return e.dragged.key===t.key}},(function(e,t){return{connectDragSource:e.dragSource(),connectDragPreview:e.dragPreview(),isDragging:t.isDragging()}}))(R)),F=n(40326),U=function(e){function t(e){var n;return(0,C.A)(this,t),(n=(0,x.A)(this,t,[e])).onToggleSelectAll=function(e){var t=n.props,r=t.isMobile,o=t.hasSelectedRecord,a=n.state.isSelectedAll;if(r&&e.preventDefault(),o||a)return n.setState({isSelectedAll:!1}),void n.props.selectNoneRecords();n.setState({isSelectedAll:!0}),n.props.selectAllRecords()},n.state={isSelectedAll:e.isSelectedAll},n}return(0,b.A)(t,e),(0,A.A)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props.isSelectedAll;t!==e.isSelectedAll&&this.setState({isSelectedAll:t})}},{key:"render",value:function(){var e=this.props,t=e.isMobile,n=e.hasSelectedRecord,r=this.state.isSelectedAll,o=n&&!r;return(0,s.jsxs)("div",{className:"select-all-checkbox-container",onClick:this.onToggleSelectAll,children:[t?(0,s.jsx)("label",{className:"mobile-select-all-container",children:o?(0,s.jsx)(l.In,{iconName:"partially-selected"}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("input",{className:"mobile-select-all-checkbox",name:"mobile-select-all-checkbox",type:"checkbox",checked:r,readOnly:!0}),(0,s.jsx)("div",{className:"select-all-checkbox-show"})]})}):(0,s.jsx)(s.Fragment,{children:o?(0,s.jsx)(l.In,{iconName:"partially-selected"}):(0,s.jsx)("input",{id:"select-all-checkbox",className:"select-all-checkbox",type:"checkbox",name:(0,F.AP)("Select all"),title:(0,F.AP)("Select all"),"aria-label":(0,F.AP)("Select all"),checked:r,readOnly:!0})}),(0,s.jsx)("label",{htmlFor:"select-all-checkbox",name:(0,F.AP)("Select all"),title:(0,F.AP)("Select all"),"aria-label":(0,F.AP)("Select all")})]})}}])}(o.Component),Y=U,B=function(e){function t(){return(0,C.A)(this,t),(0,x.A)(this,t,arguments)}return(0,b.A)(t,e),(0,A.A)(t,[{key:"render",value:function(){var e=this.props,t=e.isMobile,n=e.hasSelectedRecord,o=e.isSelectedAll,a=e.isLastFrozenCell,i=e.groupOffsetLeft,l={height:e.height,width:h.sN+i,minWidth:h.sN+i};return(0,s.jsx)("div",{className:y()("sf-metadata-result-table-cell column",{"table-last--frozen":a}),style:(0,r.A)((0,r.A)({},l),{},{backgroundColor:"#f9f9f9"}),children:(0,s.jsx)(Y,{isMobile:t,hasSelectedRecord:n,isSelectedAll:o,selectNoneRecords:this.props.selectNoneRecords,selectAllRecords:this.props.selectAllRecords})})}}])}(o.Component),H=B,V=function(e){return e.filter((function(e){return e.frozen}))},G=n(31425),q=n(46971),z=function(e){var t=e.lastColumn,n=e.height,r=e.groupOffsetLeft,i=(0,o.useMemo)((function(){return"sf-metadata-add-column"}),[]),c=(0,o.useRef)(null),u=(0,o.useMemo)((function(){return{height:n,width:44,minWidth:44,maxWidth:44,left:t.left+t.width+r,position:"absolute"}}),[t,n,r]),d=(0,a.p)().store,p=(0,o.useCallback)((function(){var e;null===c||void 0===c||null===(e=c.current)||void 0===e||e.click()}),[c]),f=(0,o.useCallback)((function(e,t,n){var r=n.key,o=n.data;d.insertColumn(e,t,{key:r,data:o})}),[d]),h=(0,o.useCallback)((function(e){m.sR0.isEnter(e)&&document.activeElement&&document.activeElement.id===i&&p()}),[i,p]);return(0,o.useEffect)((function(){return document.addEventListener("keydown",h),function(){document.removeEventListener("keydown",h)}}),[]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"sf-metadata-record-header-cell",children:(0,s.jsx)("div",{className:"sf-metadata-result-table-cell column insert-column",style:u,id:i,ref:c,children:(0,s.jsx)(l.In,{iconName:"add-table"})})}),(0,s.jsx)(q.A,{target:i,onChange:f})]})},W=n(72784),K=["isGroupView","containerWidth","hasSelectedRecord","isSelectedAll","lastFrozenColumnKey","groupOffsetLeft","table","columnMetrics","onRef","colOverScanStartIdx","colOverScanEndIdx","selectNoneRecords","selectAllRecords","modifyColumnWidth","modifyColumnOrder"],Z=(0,_.Tl)("sfMetadataRecordHeaderCell",{},(function(e){return{connectDropTarget:e.dropTarget()}}))((function(e){var t=e.isGroupView,n=e.containerWidth,a=e.hasSelectedRecord,l=e.isSelectedAll,c=e.lastFrozenColumnKey,u=e.groupOffsetLeft,d=e.table,f=e.columnMetrics,v=e.onRef,y=e.colOverScanStartIdx,C=e.colOverScanEndIdx,A=e.selectNoneRecords,x=e.selectAllRecords,b=e.modifyColumnWidth,_=e.modifyColumnOrder,w=(0,g.A)(e,K),S=(0,o.useState)(null),D=(0,p.A)(S,2),E=D[0],k=D[1],M=(0,o.useMemo)((function(){return d.header_settings||{}}),[d]),I=(0,o.useMemo)((function(){return M&&M.is_hide_triangle}),[M]),N=(0,o.useMemo)((function(){return((0,m.RIy)(M)?m.JlJ.DEFAULT:M.header_height)===m.JlJ.DOUBLE?h.L9:h.jN}),[M]),P=(0,o.useMemo)((function(){return{width:n,minWidth:"100%",zIndex:m.Mue.HK,height:N}}),[n,N]),T=(0,o.useMemo)((function(){return E||f}),[E,f]),O=(0,o.useMemo)((function(){var e=T.columns,n={position:i.Fr?"absolute":"fixed",marginLeft:"0px",height:N,zIndex:m.Mue.NT};return(t&&!(0,G.Zz)(e[0])||i.Fr)&&(n.position="absolute"),n}),[t,T,N]),j=(0,o.useCallback)((function(e,t){k((0,G.s9)(f,e.key,Math.max(t,50)))}),[f]),R=(0,o.useCallback)((function(e,t){k(null),b&&b(e,t)}),[b]),F=(0,o.useCallback)((function(e,t){_&&_(e.key,t.key)}),[_]),U=V(T.columns),Y=T.columns.slice(y,C),B=U.reduce((function(e,t){return e+t.width}),u+h.sN);return(0,s.jsx)("div",{className:"static-sf-metadata-result-content grid-header",style:{height:N+1},children:(0,s.jsxs)("div",{className:"sf-metadata-result-table-row",style:P,children:[(0,s.jsxs)("div",{className:"frozen-columns d-flex",style:O,ref:function(e){return v(e)},children:[(0,s.jsx)(H,{isMobile:i.Fr,height:N,hasSelectedRecord:a,isSelectedAll:l,isLastFrozenCell:!c,groupOffsetLeft:u,selectNoneRecords:A,selectAllRecords:x}),U.map((function(e){var t=e.key,n=t===c;return(0,s.jsx)(L,(0,r.A)({frozen:!0,height:N,column:e,style:{backgroundColor:"#f9f9f9"},isLastFrozenCell:n,frozenColumnsWidth:B,isHideTriangle:I,view:d.view,modifyLocalColumnWidth:j,modifyColumnWidth:R,onMove:F},w),t)}))]}),Y.map((function(e){return(0,s.jsx)(L,(0,r.A)({isHideTriangle:I,groupOffsetLeft:u,height:N,column:e,view:d.view,frozenColumnsWidth:B,modifyLocalColumnWidth:j,modifyColumnWidth:R,onMove:F},w),e.key)})),(0,s.jsx)(z,{lastColumn:T.columns[T.columns.length-1],groupOffsetLeft:u,height:N})]})})})),X=(0,W.A)(Z),$=function(e){function t(){var e;(0,C.A)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=(0,x.A)(this,t,[].concat(r))).isSelfScroll=!0,e.setScrollTop=function(t){e.isSelfScroll=!1,e.rightScrollContainer.scrollTop=t},e.onScroll=function(t){if(t.stopPropagation(),e.isSelfScroll){var n=t.target.scrollTop;e.props.onScrollbarScroll(n)}else e.isSelfScroll=!0},e.onMouseUp=function(t){e.props.onScrollbarMouseUp&&e.props.onScrollbarMouseUp(t)},e.getScrollbarStyle=function(){var e=window.sfMetadataBody;return e&&e.resultRef?{height:e.resultRef.scrollHeight}:{}},e.getContainerStyle=function(){var e={},t=window.sfMetadataBody;return t&&t.resultContentRef&&(e.height=t.resultContentRef.clientHeight,e.zIndex=m.Mue.gA),e.top=33,e.right=0,e},e.setScrollbarRef=function(t){e.scrollbar=t},e.setContainerRef=function(t){e.rightScrollContainer=t},e}return(0,b.A)(t,e),(0,A.A)(t,[{key:"render",value:function(){var e=this.getContainerStyle(),t=this.getScrollbarStyle();return(0,s.jsx)("div",{className:"right-scrollbar-container",style:e,ref:this.setContainerRef,onScroll:this.onScroll,onMouseUp:this.onMouseUp,children:(0,s.jsx)("div",{ref:this.setScrollbarRef,className:"right-scrollbar-inner",style:t})})}}])}(o.Component),J=$,Q=function(e){function t(){var e;(0,C.A)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=(0,x.A)(this,t,[].concat(r))).isSelfScroll=!0,e.setScrollLeft=function(t){e.isSelfScroll=!1,e.container.scrollLeft=t},e.onScroll=function(t){if(t.stopPropagation(),e.isSelfScroll){var n=t.target.scrollLeft;e.props.onScrollbarScroll(n)}else e.isSelfScroll=!0},e.getScrollbarStyle=function(){return{width:e.props.innerWidth}},e.getContainerStyle=function(){return{zIndex:m.Mue.gA}},e.setScrollbarRef=function(t){e.scrollbar=t},e.setContainerRef=function(t){e.container=t},e}return(0,b.A)(t,e),(0,A.A)(t,[{key:"render",value:function(){if(!this.props.innerWidth)return null;var e=this.getContainerStyle(),t=this.getScrollbarStyle();return(0,s.jsx)("div",{className:"horizontal-scrollbar-container",ref:this.setContainerRef,style:e,onScroll:this.onScroll,onMouseUp:this.props.onScrollbarMouseUp,children:(0,s.jsx)("div",{className:"horizontal-scrollbar-inner",ref:this.setScrollbarRef,style:t})})}}])}(o.Component),ee=Q,te=n(51528),ne=function(e,t,n){return e!==t&&(void 0===e||null===e?(n!==m.vZe.GEOLOCATION||!(0,m.RIy)(t))&&((n!==m.vZe.DATE&&n!==m.vZe.NUMBER||null!==t)&&(Array.isArray(t)?0!==t.length:!1!==t&&""!==t)):Array.isArray(e)&&Array.isArray(t)?JSON.stringify(e)!==JSON.stringify(t):"object"===typeof e&&"object"===typeof t&&null!==t?!te.A.isSameObject(e,t):e!==t)},re=function(e){var t=e.isDir,n=e.column,r=e.value,a=(0,o.useCallback)((function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),window.sfMetadataContext.eventBus.dispatch(h.Tw.OPEN_EDITOR,h.rr.PREVIEWER)}),[]);return r&&n.type===m.vZe.FILE_NAME?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.Oi,{id:"sf-metadata-cell-open-file-btn",className:"sf-metadata-cell-operation-btn",size:20,iconName:"open-file",onClick:a}),(0,s.jsx)(w.A,{hideArrow:!0,target:"sf-metadata-cell-open-file-btn",placement:"bottom",fade:!1,delay:{show:0,hide:0},modifiers:{preventOverflow:{boundariesElement:document.body}},className:"sf-metadata-tooltip",children:t?(0,i.AP)("Open folder"):(0,i.AP)("Open file")})]}):null},oe=n(44),ae=n(65604),ie=["readonly","value","field"],se=function(e){var t=e.readonly,n=e.value,a=e.field,i=(0,g.A)(e,ie),c=(0,oe.D1)(),u=c.collaborators,d=c.collaboratorsCache,p=c.updateCollaboratorsCache,f=c.queryUser,h=(0,o.useMemo)((function(){return{collaborators:u,collaboratorsCache:d,updateCollaboratorsCache:p,readonly:t,value:n,field:a,queryUserAPI:f,getFileIconUrl:ae.Aq.getFileIconUrl,getFolderIconUrl:ae.Aq.getFolderIconUrl}}),[t,n,a,u,d,p,f]);return(0,s.jsx)(l.ZA,(0,r.A)((0,r.A)({},h),i))},le=function(e){var t=e.isCellSelected,n=e.field,r=e.value,a=e.onChange,i=(0,o.useState)(!1),u=(0,p.A)(i,2),d=u[0],f=u[1];(0,o.useEffect)((function(){t||f(!1)}),[t]);var h=(0,o.useCallback)((function(e){e&&e.stopPropagation(),a((0,c.default)({},n.key,!r))}),[r,n,a]),m=(0,o.useCallback)((function(){d?h():f(!0)}),[d,h]);return(0,s.jsx)("div",{className:"sf-metadata-checkbox-editor",onClick:m,children:(0,s.jsx)("div",{className:"sf-metadata-checkbox-editor-content",onClick:h,children:r&&(0,s.jsx)(l.In,{iconName:"check-mark"})})})},ce=n(82622),ue=function(e){var t=e.isCellSelected,n=e.field,r=e.value,a=e.onChange,i=(0,o.useState)(r||0),l=(0,p.A)(i,2),u=l[0],d=l[1],f=(0,o.useState)(-1),h=(0,p.A)(f,2),m=h[0],g=h[1];(0,o.useEffect)((function(){d(r||0)}),[r]);var v=(0,o.useCallback)((function(e){g(e)}),[]),y=(0,o.useCallback)((function(){g(-1)}),[]),C=(0,o.useCallback)((function(e){var t=u===e?0:e;d(t),a((0,c.default)({},n.key,t))}),[u,n,a]),A=(0,o.useCallback)((function(){var e=(n.data||{}).max,r=void 0===e?5:e,o=[];if(u||t)for(var a=0;a<r;a++){var i=(0,s.jsx)(ce.A,{index:a+1,enterIndex:m,value:u,field:n,isShowRateItem:t,onMouseEnter:v,onMouseLeave:y,onChange:C},a);o.push(i)}return o}),[n,u,t,m,C,v,y]);return(0,s.jsx)("div",{className:"sf-metadata-rate-editor d-flex",children:A()})},de=function(e){var t=e.isCellSelected,n=e.isDir,r=e.field,o=e.value,a=e.onChange,i=e.record,l=r.type,c=(0,G.dK)(r,i,!0);return l===m.vZe.CHECKBOX&&c?(0,s.jsx)(le,{isCellSelected:t,value:o,field:r,onChange:a}):l===m.vZe.RATE&&c?(0,s.jsx)(ue,{isCellSelected:t,value:o,field:r,onChange:a}):(0,s.jsx)(se,{readonly:!0,value:o,field:r,isDir:n})},pe=o.memo((function(e){var t=e.needBindEvents,n=e.column,a=e.record,i=e.groupRecordIndex,l=e.recordIndex,u=e.cellMetaData,d=e.highlightClassName,p=e.isLastCell,f=e.isLastFrozenCell,g=e.isCellSelected,v=e.bgColor,C=e.frozen,A=e.height,x=(0,o.useMemo)((function(){var e=n.type,t=window.sfMetadataContext.canModifyColumn(n);return y()("sf-metadata-result-table-cell","sf-metadata-result-table-".concat(e,"-cell"),d,{"table-cell-uneditable":!t||!h.W6[e],"last-cell":p,"table-last--frozen":f,"cell-selected":g})}),[n,d,p,f,g]),b=(0,o.useMemo)((function(){var e=a[m.L2D.IS_DIR];return"string"===typeof e?"TRUE"===e.toUpperCase():e}),[a]),_=(0,o.useMemo)((function(){var e=n.left,t={width:n.width,height:A};return C||(t.left=e),v&&(t.backgroundColor=v),t}),[C,A,n,v]),w=(0,o.useCallback)((function(e){var t={idx:n.idx,groupRecordIndex:i,rowIdx:l};(0,m.Tnt)(u.onCellClick)&&u.onCellClick(t,e)}),[n,i,l,u]),S=(0,o.useCallback)((function(e){if((0,m.Tnt)(u.onCellDoubleClick)){var t={idx:n.idx,groupRecordIndex:i,rowIdx:l};u.onCellDoubleClick(t,e)}}),[n,i,l,u]),D=(0,o.useCallback)((function(e){if(2!==e.button&&(0,m.Tnt)(u.onCellMouseDown)){var t={idx:n.idx,groupRecordIndex:i,rowIdx:l};u.onCellMouseDown(t,e)}}),[n,i,l,u]),E=(0,o.useCallback)((function(e){if((0,m.Tnt)(u.onCellMouseEnter)){var t={idx:n.idx,groupRecordIndex:i,rowIdx:l},o={x:e.clientX,y:e.clientY};u.onCellMouseEnter((0,r.A)((0,r.A)({},t),{},{mousePosition:o}),e)}}),[n,i,l,u]),k=(0,o.useCallback)((function(e){if((0,m.Tnt)(u.onCellMouseMove)){var t={idx:n.idx,groupRecordIndex:i,rowIdx:l},o={x:e.clientX,y:e.clientY};u.onCellMouseMove((0,r.A)((0,r.A)({},t),{},{mousePosition:o}),e)}}),[n,i,l,u]),M=(0,o.useCallback)((function(){}),[]),I=(0,o.useCallback)((function(e){e.stopPropagation(),e.preventDefault()}),[]),N=(0,o.useCallback)((function(e){e.preventDefault();var t={idx:n.idx,groupRecordIndex:i,rowIdx:l};(0,m.Tnt)(u.onCellContextMenu)&&u.onCellContextMenu(t)}),[u,n,i,l]),P=(0,o.useCallback)((function(){return{onClick:w,onDoubleClick:S,onMouseDown:D,onMouseEnter:E,onMouseMove:k,onMouseLeave:M,onDragOver:I,onContextMenu:N}}),[w,S,D,E,k,M,I,N]),T=(0,o.useCallback)((function(e){var t=n.key,r=n.name;return{oldRowData:m.Ajs.includes(t)?(0,c.default)({},t,e):(0,c.default)({},r,e),originalOldRowData:(0,c.default)({},t,e)}}),[n]),O=(0,o.useCallback)((function(e){if((0,m.Tnt)(u.modifyRecord)){var t=n.key,r=n.type,o=n.name,i=(0,m.Teq)(a,n);if(ne(i,e[t],r)){var s=a._id,l=Object.keys(e)[0],d=m.Ajs.includes(t)?e:(0,c.default)({},o,e[l]),p=T(i),f=p.oldRowData,h=p.originalOldRowData;u.modifyRecord({rowId:s,cellKey:t,updates:d,originalUpdates:e,oldRowData:f,originalOldRowData:h})}}}),[u,a,n,T]),j=(0,m.Teq)(a,n),R=t&&P(),L=(0,r.A)({className:x,style:_},R);return(0,s.jsxs)("div",(0,r.A)((0,r.A)({},L),{},{children:[(0,s.jsx)(de,{isCellSelected:g,isDir:b,value:j,field:n,onChange:O,record:a}),g&&(0,s.jsx)(re,{value:j,column:n,isDir:b})]}),"".concat(a._id,"-").concat(n.key))}),(function(e,t){var n=e.record,r=e.column,o=e.isCellSelected,a=e.isLastCell,i=e.highlightClassName,s=e.height,l=e.bgColor,c=t.record,u=t.highlightClassName,d=t.height,p=t.column,f=t.bgColor,h=n[r.name]||n[r.key],m=c[r.name]||c[r.key];return!(ne(h,m,r.type)||n._last_modifier!==c._last_modifier||o!==t.isCellSelected||a!==t.isLastCell||i!==u||s!==d||r.left!==p.left||r.width!==p.width||l!==f||!te.A.isSameObject(r.data,p.data)||e.groupRecordIndex!==t.groupRecordIndex||e.recordIndex!==t.recordIndex)}));pe.defaultProps={needBindEvents:!0};var fe=pe,he=n(81718),me=function(e){function t(e){var n;return(0,C.A)(this,t),(n=(0,x.A)(this,t,[e])).onCellMouseEnter=function(){n.props.isLocked&&!i.Fr&&(n.timer=setTimeout((function(){n.setState({isLockedRowTooltipShow:!0})}),500))},n.onCellMouseLeave=function(){n.props.isLocked&&!i.Fr&&(n.timer&&(clearTimeout(n.timer),n.timer=null),n.setState({isLockedRowTooltipShow:!1}))},n.getLockedRowTooltip=function(){var e=n.props.recordId;return(0,s.jsx)(he.A,{target:"action-cell-".concat(e),placement:"bottom",isOpen:n.state.isLockedRowTooltipShow,fade:!1,hideArrow:!0,className:"readonly-cell-tooltip",children:(0,i.AP)("The row is locked and cannot be modified")})},n.state={isLockedRowTooltipShow:!1},n}return(0,b.A)(t,e),(0,A.A)(t,[{key:"render",value:function(){var e=this.props,t=e.isSelected,n=e.isLastFrozenCell,o=e.index,a=e.height,l=e.recordId,c={height:a,width:h.sN,minWidth:h.sN};return(0,s.jsxs)("div",{className:y()("sf-metadata-result-table-cell column actions-cell",{"table-last--frozen":n}),id:"action-cell-".concat(l),style:(0,r.A)({},c),onMouseEnter:this.onCellMouseEnter,onMouseLeave:this.onCellMouseLeave,children:[!t&&(0,s.jsx)("div",{className:"sf-metadata-result-column-content row-index text-truncate",children:o+1}),(0,s.jsx)("div",{className:"sf-metadata-result-column-content actions-checkbox",children:(0,s.jsxs)("div",{className:"select-cell-checkbox-container",onClick:this.props.onSelectRecord,children:[(0,s.jsx)("input",{id:"select-cell-checkbox-".concat(l),className:"select-cell-checkbox",type:"checkbox",name:"row-selection",checked:t||!1,readOnly:!0}),(0,s.jsx)("label",{htmlFor:"select-cell-checkbox-".concat(l),name:(0,i.AP)("Select"),title:(0,i.AP)("Select"),"aria-label":(0,i.AP)("Select")})]})})]})}}])}(o.Component),ge=me,ve=function(e){function t(){var e;(0,C.A)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=(0,x.A)(this,t,[].concat(r))).checkScroll=function(){e.cancelFixFrozenDOMs(e.props.scrollLeft)},e.cancelFixFrozenDOMs=function(t){var n=e.props.isGroupView,r=e.frozenColumns.childElementCount;!e.frozenColumns||r<1||n&&r<2||(e.frozenColumns.style.position="absolute",e.frozenColumns.style.marginLeft=t+"px",e.frozenColumns.style.marginTop="0px")},e.onSelectRecord=function(t){var n=e.props,r=n.groupRecordIndex,o=n.index;e.props.selectNoneCells(),e.props.onSelectRecord({groupRecordIndex:r,recordIndex:o},t)},e.isCellSelected=function(t){var n=e.props,r=n.hasSelectedCell,o=n.selectedPosition;return!!o&&(r&&o.idx===t)},e.reloadCurrentRecord=function(){e.props.reloadRecords([e.props.record._id])},e.getFrozenCells=function(){var t=e.props,n=t.columns,r=t.lastFrozenColumnKey,o=t.groupRecordIndex,a=t.index,i=t.record,l=t.cellMetaData,c=t.isGroupView,u=t.height,d=t.columnColor,p=V(n);if(0===p.length)return null;var f=i._id;return p.map((function(t,p){var h=t.key,m=e.isCellHighlight(h,f),g=e.isCurrentCellHighlight(h,f)?"cell-current-highlight":m?"cell-highlight":null,v=e.isCellSelected(p),y=e.isLastCell(n,h),C=h===r,A=d&&d[h];return(0,s.jsx)(fe,{frozen:!0,record:i,groupRecordIndex:o,recordIndex:a,isCellSelected:v,isLastCell:y,isLastFrozenCell:C,height:c?u:u-1,column:t,cellMetaData:l,modifyRecord:e.props.modifyRecord,lockRecordViaButton:e.props.lockRecordViaButton,modifyRecordViaButton:e.props.modifyRecordViaButton,reloadCurrentRecord:e.reloadCurrentRecord,highlightClassName:g,bgColor:A},t.key)}))},e.isCellHighlight=function(t,n){var r=e.props.searchResult;if(r){var o=r.matchedRows[n];if(o&&o.includes(t))return!0}return!1},e.isCurrentCellHighlight=function(t,n){var r=e.props.searchResult;if(r){var o=r.currentSelectIndex;if("number"!==typeof o)return!1;var a=r.matchedCells[o];if(!a)return!1;if(a.row===n&&a.column===t)return!0}return!1},e.getColumnCells=function(){var t=e.props,n=t.columns,r=t.colOverScanStartIdx,o=t.colOverScanEndIdx,a=t.groupRecordIndex,i=t.index,l=t.record,c=t.cellMetaData,u=t.isGroupView,d=t.height,p=t.columnColor,f=l._id;return n.slice(r,o).map((function(t){var r=t.key,o=!t.frozen,h=e.isCellSelected(n.findIndex((function(e){return e.key===t.key}))),m=e.isCellHighlight(r,f),g=e.isCurrentCellHighlight(r,f)?"cell-current-highlight":m?"cell-highlight":null,v=e.isLastCell(n,r),y=p&&p[r];return(0,s.jsx)(fe,{record:l,groupRecordIndex:a,recordIndex:i,isCellSelected:h,isLastCell:v,height:u?d:d-1,column:t,needBindEvents:o,cellMetaData:c,modifyRecord:e.props.modifyRecord,lockRecordViaButton:e.props.lockRecordViaButton,modifyRecordViaButton:e.props.modifyRecordViaButton,reloadCurrentRecord:e.reloadCurrentRecord,highlightClassName:g,bgColor:y},t.key)}))},e.getRecordStyle=function(){var t=e.props,n=t.isGroupView,r=t.height,o=t.isLastRecord,a={height:o?r-1:r};if(n){var i=e.props,s=i.top,l=i.left;a.top=s,a.left=l,o&&(a.height=r+1)}return a},e.getFrozenColumnsStyle=function(){var t=e.props,n=t.isGroupView,r=t.lastFrozenColumnKey,o=t.height,a={zIndex:m.Mue.NT,height:o-1};return n&&(a.height=o,a.zIndex=m.Mue.WA,r||(a.marginLeft="0px")),a},e.handleDragEnter=function(t){t.preventDefault();var n=e.props,r=n.index,o=n.groupRecordIndex;(0,n.cellMetaData.onDragEnter)({overRecordIdx:r,overGroupRecordIndex:o})},e.handleDragOver=function(e){e.preventDefault(),e.dataTransfer.dropEffect="copy"},e.handleDrop=function(e){e.preventDefault()},e}return(0,b.A)(t,e),(0,A.A)(t,[{key:"componentDidMount",value:function(){this.checkScroll()}},{key:"shouldComponentUpdate",value:function(e){return e.isGroupView!==this.props.isGroupView||e.hasSelectedCell!==this.props.hasSelectedCell||e.hasSelectedCell&&this.props.selectedPosition.idx!==e.selectedPosition.idx||e.isSelected!==this.props.isSelected||e.groupRecordIndex!==this.props.groupRecordIndex||e.index!==this.props.index||e.isLastRecord!==this.props.isLastRecord||e.lastFrozenColumnKey!==this.props.lastFrozenColumnKey||e.columns!==this.props.columns||e.colOverScanStartIdx!==this.props.colOverScanStartIdx||e.colOverScanEndIdx!==this.props.colOverScanEndIdx||e.record!==this.props.record||e.top!==this.props.top||e.left!==this.props.left||e.height!==this.props.height||e.searchResult!==this.props.searchResult||e.columnColor!==this.props.columnColor}},{key:"isLastCell",value:function(e,t){return e[e.length-1].key===t}},{key:"render",value:function(){var e=this,t=this.props,n=t.isSelected,r=t.isGroupView,o=t.index,a=t.isLastRecord,i=t.lastFrozenColumnKey,l=t.height,c=t.record,u=!!c._locked,d=r?l:l-1,p=this.getFrozenCells(),f=this.getColumnCells();return(0,s.jsxs)("div",{className:y()("sf-metadata-result-table-row",{"sf-metadata-last-table-row":a,"row-selected":n,"row-locked":u}),style:this.getRecordStyle(),onDragEnter:this.handleDragEnter,onDragOver:this.handleDragOver,onDrop:this.handleDrop,children:[(0,s.jsxs)("div",{className:"frozen-columns d-flex",style:this.getFrozenColumnsStyle(),ref:function(t){return e.frozenColumns=t},children:[(0,s.jsx)(ge,{isLocked:u,isSelected:n,recordId:c._id,index:o,onSelectRecord:this.onSelectRecord,isLastFrozenCell:!i,height:d}),p]}),f]})}}])}(o.Component),ye=ve,Ce=n(55097),Ae=n.n(Ce),xe=n(60436),be=function(e,t,n,r,o,a){var i={};t.forEach((function(e){var t=e.column_key,n=(0,m.rm3)(r,t);i[t]=n}));var s=t.length,l=_e(e,i,n,a,o,s,{parentGroupPath:[],currentLevel:s,isParentGroupVisible:!0}),c=we(l,s),u=c.computedGroupRows,d=c.groupRowsHeight;return{groupRows:u,idGroupRowMap:c.idGroupRowMap,groupRowsHeight:d,maxLevel:s}},_e=function(e,t,n,r,o,a,i){var s=i.parentGroupPath,l=i.parentGroupKey,c=i.currentLevel,u=i.isParentGroupVisible,d=[];return e.forEach((function(e,i){var p=[];s.length>0&&p.push.apply(p,(0,xe.A)(s)),p.push(i);var f=e.cell_value,m=e.subgroups,g=e.row_ids,v=e.column_key,y=e.summaries,C=e.original_cell_value,A=p.join("-"),x=Se(A,n),b=(a-c+1)*h.ax,_="".concat(l||v,"_").concat(f),w={type:h.Gi.GROUP_CONTAINER,level:c,left:b,key:_,cell_value:f,column_key:v,isExpanded:x,summaries:y,groupPath:p,groupPathString:A,column:t[v],visible:u,original_cell_value:C};if(Array.isArray(m)&&m.length>0){var S,D=_e(m,t,n,r,o,a,{parentGroupPath:p,parentGroupKey:_,currentLevel:c-1,isParentGroupVisible:u&&x}),E=0,k=0;D.forEach((function(e){e.type===h.Gi.GROUP_CONTAINER&&e.level+1===c&&(E+=e.count||0,k+=(e.height||0)+h.ax,S||(S=e.first_row_id))})),w.first_row_id=S,w.count=E,w.height=(x?k:0)+h.q$,d.push(w),d.push.apply(d,(0,xe.A)(D))}else if(Array.isArray(g)&&g.length>0){var M=g.length,I=M-1,N=u&&x,P=N?M*o+1:0,T=N&&r?h.J3:0,O=g.map((function(e,t){return{type:h.Gi.ROW,key:"row-".concat(e),rowIdx:t,isLastRow:t===I,visible:N,height:t===I?o+1:o,level:c,rowsLength:M,left:b,rowId:e,groupPath:p,groupPathString:A}}));w.first_row_id=O[0].rowId,w.count=M,w.height=P+T+h.q$,d.push(w),d.push.apply(d,(0,xe.A)(O))}})),d},we=function(e,t){var n,o=h.ax,a=h.ax,i={};return{computedGroupRows:e.map((function(s,l){var c=s.type,u=s.level,d=s.height,p=s.visible,f=(0,r.A)((0,r.A)({},s),{},{top:a,groupRecordIndex:l});if(c===h.Gi.GROUP_CONTAINER)p&&(u===t&&(o+=d+h.ax),a+=h.q$,n=u);else if(c===h.Gi.ROW){var m=s.rowId;i[m]=f,p&&(a+=d)}else c===h.Gi.BTN_INSERT_ROW&&p&&(a+=d);var g=e[l+1];if(g&&g.visible&&g.type===h.Gi.GROUP_CONTAINER){var v=g.groupPath,y=g.level;v[v.length-1]>0&&(a+=h.ax),y>n&&(a+=(y-n)*h.ax)}return f})),groupRowsHeight:o,idGroupRowMap:i}},Se=function(e,t){return!t||!t[e]},De=function(e,t){var n=e.groupPath,r=e.groupPathString,o=e.level,a=e.type,i=t.groupPath,s=t.groupPathString,l=t.level;return r===s&&a!==h.Gi.GROUP_CONTAINER||o<l&&n[0]===i[0]},Ee=function(e,t){return(t.groupRows||[])[e]||{}},ke="upwards",Me="downwards",Ie=function(e){var t=e.selectedPosition,n=e.isGroupView;return(0,e.recordGetterByIndex)({isGroupView:n,groupRecordIndex:t.groupRecordIndex,recordIndex:t.rowIdx})},Ne=function(e){var t=e.selectedPosition,n=e.columns,r=t.idx;return(0,G.wV)(r,n)},Pe=function(e){var t=e.selectedPosition,n=e.columns,r=e.isGroupView,o=e.recordGetterByIndex,a=Ne({selectedPosition:t,columns:n}),i=Ie({selectedPosition:t,isGroupView:r,recordGetterByIndex:o});return(0,m.Teq)(i,a)},Te=function(e,t,n,r){var o=e.idx,a=e.groupRecordIndex,i=e.rowIdx,s=t[o];return!!s&&(!!h.$p.includes(s.type)||!!r({isGroupView:n,groupRecordIndex:a,recordIndex:i}))};var Oe=function(e){for(var t=e.selectedRange,n=e.isGroupView,r=e.recordGetterByIndex,o=t.topLeft,a=t.bottomRight,i=o.rowIdx,s=o.groupRecordIndex,l=[],c=i,u=a.rowIdx+1;c<u;c++){var d=r({isGroupView:n,groupRecordIndex:s,recordIndex:c});n&&s++,d&&l.push(d)}return l};function je(e){return e>47&&e<58||32===e||13===e||e>64&&e<91||e>95&&e<112||e>185&&e<193||e>218&&e<223}function Re(e){return(!0===e.ctrlKey||!0===e.metaKey)&&"Control"!==e.key}function Le(e){return e&&e.shiftKey}var Fe=n(17119),Ue=["width","height","top","left","zIndex","children","innerRef"],Ye=function(e){function t(){var e;(0,C.A)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=(0,x.A)(this,t,[].concat(r))).getMaskStyle=function(){var t=e.props,n=t.width,r=t.height,o=t.top,a=t.left;return{height:r-1,width:n,zIndex:t.zIndex,position:"absolute",pointerEvents:"none",transform:"translate(".concat(a,"px, ").concat(o,"px)"),outline:0}},e}return(0,b.A)(t,e),(0,A.A)(t,[{key:"componentDidUpdate",value:function(){var e=Fe.findDOMNode(this);"fixed"===e.style.position&&(e.style.transform="none")}},{key:"render",value:function(){var e=this.props,t=(e.width,e.height,e.top,e.left,e.zIndex,e.children),n=e.innerRef,o=(0,g.A)(e,Ue),a=this.getMaskStyle();return(0,s.jsx)("div",(0,r.A)((0,r.A)({style:a,"data-test":"cell-mask",ref:n},o),{},{children:t}))}}])}(o.PureComponent),Be=Ye;var He=function(e){var t=e.selectedRange,n=e.innerRef,o=e.getSelectedRangeDimensions,a=e.children,i=o(t);return(0,s.jsx)(Be,(0,r.A)((0,r.A)({},i),{},{className:"rdg-selected-range",innerRef:n,children:a}))};var Ve=function(e){var t=e.innerRef,n=e.selectedPosition,o=e.getSelectedDimensions,a=e.children,i=o(n);return(0,s.jsx)(Be,(0,r.A)((0,r.A)({className:"rdg-selected",tabIndex:"0",innerRef:t},i),{},{children:a}))},Ge=n(4159),qe=n.n(Ge),ze=function(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).collaborators,r=void 0===n?[]:n,o=(0,m.Teq)(e,t),a=t.type;return a===m.vZe.CTIME||a===m.vZe.MTIME?function(e){if(!e)return null;var t=qe()(e);return t.isValid()?t.format("YYYY-MM-DD HH:mm:ss"):e}(o):(0,m.$i0)(e,t,{collaborators:r})},We=function(e,t){var n={};return e.forEach((function(e){n[e.key]=e})),Ke(t,n)};function Ke(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(!e||!t)return{};var r={};return Object.keys(e).forEach((function(o){var a=t[o];if(a){var i=a.type,s=(0,G.KO)(a);if(!n||!n.includes(i)){var l=e[o];if(r[s]=l,i===m.vZe.TEXT)r[s]="string"===typeof l?l.trim():""}}})),r}function Ze(e,t){Xe(e,t)||(t.idSelectedRecordMap[e]=!0)}function Xe(e,t){return t.idSelectedRecordMap[e]}function $e(e){return Object.keys(e.idSelectedRecordMap)}var Je={selectRecord:Ze,selectRecordsById:function(e,t){e.forEach((function(e){Ze(e,t)}))},deselectRecord:function(e,t){Xe(e,t)&&delete t.idSelectedRecordMap[e]},deselectAllRecords:function(e){e.idSelectedRecordMap={}},isRecordSelected:Xe,getSelectedIds:$e,hasSelectedRecords:function(e){return $e(e).length>0},isSelectedAll:function(e,t){return 0!==$e(t).length&&e.every((function(e){return Xe(e,t)}))}};var Qe=h.aG.TEXT,et=h.aG.FRAGMENT;function tt(e,t){var n=window.sfMetadata.getCollaborators(),r=e.length-1,o=t.length-1,a="";return e.forEach((function(e,i){t.forEach((function(t,r){a+=e&&ze(e,t,{collaborators:n})||"",r<o&&(a+="\t")})),i<r&&(a+="\n")})),a}function nt(e,t){var n,r,o,a;try{if(n=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,n=[],r=0;r<e.rangeCount;r++)n.push(e.getRangeAt(r));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||n.forEach((function(t){e.addRange(t)})),t&&t.focus()}}(),r=document.createRange(),o=document.getSelection(),(a=document.createElement("span")).textContent=e,a.addEventListener("copy",(function(n){n.stopPropagation(),n.preventDefault();var r=n.dataTransfer||n.clipboardData;r.clearData(),r.setData(Qe,e),r.setData(et,t)})),document.body.appendChild(a),r.selectNodeContents(a),o.addRange(r),!document.execCommand("copy"))return!1}catch(i){return!1}finally{a&&document.body.removeChild(a),n()}}var rt=function(e){var t=e.type,n=e.selectedRecordIds,r=e.copiedRange,o=e.copiedColumns,a=e.copiedRecords,i=e.copiedTableId,s=e.tableData,l=e.copiedText,c=e.recordGetterById,u=e.isGroupView,d=e.recordGetterByIndex,p=e.event,f=void 0===p?{}:p,m=f.dataTransfer||f.clipboardData;if(t===h.aG.DTABLE_FRAGMENT){var g=Array.isArray(n)&&n.length>0?function(e,t,n){var r=e.map((function(e){return n(e)}));return tt(r,t.columns)}(n,s,c):function(e,t,n,r){for(var o=e.topLeft,a=e.bottomRight,i=o.rowIdx,s=o.idx,l=o.groupRecordIndex,c=a.rowIdx,u=a.idx,d=t.columns,p=l,f=[],h=[],m=i;m<=c;m++)f.push(r({isGroupView:n,groupRecordIndex:p,recordIndex:m})),n&&p++;for(var g=s;g<=u;g++)h.push((0,G.wV)(g,d));return tt(f,h)}(r,s,u,d),v={selectedRecordIds:n,copiedRange:r,copiedColumns:o,copiedRecords:a,copiedTableId:i},y=JSON.stringify(v);m?(m.setData(Qe,g),m.setData(et,y)):nt(g,y)}else{var C=h.aG[t.toUpperCase()];m?m.setData(C,l):nt(l,{format:C})}},ot=n(42996);var at=function(e){var t=e.draggedRange,n=e.getSelectedRangeDimensions,o=e.getSelectedDimensions,a=t.overRecordIdx,i=t.bottomRight,l=i.idx,c=i.rowIdx,u=i.groupRecordIndex;if(null!==a&&c<a){for(var d=n(t),p=c+1;p<=a;p++){var f=o({idx:l,rowIdx:p,groupRecordIndex:u}).height;d.height+=f}return(0,s.jsx)(Be,(0,r.A)((0,r.A)({},d),{},{className:"react-grid-cell-dragged-over-down"}))}return null};var it=function(e){var t=e.onDragStart,n=e.onDragEnd;return(0,s.jsx)("div",{className:"drag-handle",draggable:"true",onDragStart:t,onDragEnd:n})},st=function(e){function t(){var e;(0,C.A)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=(0,x.A)(this,t,[].concat(r))).state={isMounted:!1},e.el=document.createElement("div"),e}return(0,b.A)(t,e),(0,A.A)(t,[{key:"componentDidMount",value:function(){this.props.target.appendChild(this.el),this.setState({isMounted:!0})}},{key:"componentWillUnmount",value:function(){this.props.target.removeChild(this.el)}},{key:"render",value:function(){return this.state.isMounted?Fe.createPortal(this.props.children,this.el):null}}])}(o.Component),lt=st,ct=n(60472),ut=n(3866),dt=function(e){var t=e.column,n=e.record,r=e.table,a=e.onCommitCancel,i=(0,o.useState)(0),c=(0,p.A)(i,2),u=c[0],d=c[1],f=(0,o.useMemo)((function(){var e=window.sfMetadataContext.getSetting("repoID");return r.rows.filter((function(e){return ae.Aq.imageCheck(e[m.L2D.FILE_NAME])})).map((function(t){var n,r=t[m.L2D.FILE_NAME],o=t[m.L2D.PARENT_DIR],a=ae.Aq.encodePath(ae.Aq.joinPath(o,r)),i="gif"===r.substr(r.lastIndexOf(".")+1).toLowerCase(),s=null===(n=window.sfMetadataContext.getSetting("repoInfo"))||void 0===n?void 0:n.encrypted,l="".concat(F.Yc).concat(s&&!i?"thumbnail":"repo","/").concat(e),c="".concat(l,"/").concat(s&&!i?F.oC:"raw").concat(a);return{name:r,url:"".concat(F.Yc,"lib/").concat(e,"/file").concat(a),thumbnail:"".concat(F.Yc,"thumbnail/").concat(e,"/").concat(F.oC).concat(a),src:c}}))}),[r]);(0,o.useEffect)((function(){if(f.length>0){var e=f.findIndex((function(e){return e.name===n[m.L2D.FILE_NAME]}));e>-1&&d(e)}}),[f,n]);var h=(0,o.useMemo)((function(){var e=n[m.L2D.IS_DIR];return"string"===typeof e?"TRUE"===e.toUpperCase():e}),[n]),g=(0,o.useMemo)((function(){var e=t.key;return n[e]}),[t,n]),v=(0,o.useMemo)((function(){if(h)return"folder";if(!g)return"";var e=g.lastIndexOf(".");return-1===e||g.slice(e).toLowerCase().indexOf(" ")>-1?"":ae.Aq.imageCheck(g)?"image":ae.Aq.isMarkdownFile(g)?"markdown":ae.Aq.isSdocFile(g)?"sdoc":""}),[h,g]),y=(0,o.useMemo)((function(){var e=n[m.L2D.PARENT_DIR];return"/"===e?"":e}),[n]),C=(0,o.useMemo)((function(){return window.sfMetadataContext.getSetting("repoID")}),[]),A=(0,o.useMemo)((function(){return ae.Aq.encodePath(ae.Aq.joinPath(y,g))}),[y,g]),x=(0,o.useMemo)((function(){return"".concat(F.Yc,"lib/").concat(C,"/file").concat(A)}),[A,C]);if((0,o.useEffect)((function(){if("markdown"===v){var e=n[m.L2D.FILE_NAME],t=n[m.L2D.PARENT_DIR];window.sfMetadataContext.eventBus.dispatch(ut.T.OPEN_MARKDOWN_DIALOG,t,e)}return function(){}}),[n,v]),"markdown"===v)return null;if("image"===v)return(0,s.jsx)(l.Q$,{children:(0,s.jsx)(ct.A,{imageItems:f,imageIndex:u,closeImagePopup:a,moveToPrevImage:function(){var e=f.length;d((function(t){return(t+e-1)%e}))},moveToNextImage:function(){var e=f.length;d((function(t){return(t+1)%e}))}})});if(v&&"sdoc"!==v){var b=window.location.pathname;b.endsWith("/")&&(b=b.slice(0,-1)),window.open(window.location.origin+b+ae.Aq.encodePath(ae.Aq.joinPath(y,g)))}else window.open(x);return null},pt=n(13042),ft=n(11942),ht=n.n(ft),mt=(ht().string,ht().number,ht().bool,ht().object,ht().array,function(e){function t(e){var n;return(0,C.A)(this,t),(n=(0,x.A)(this,t,[e])).getValue=function(){var e=n.props.column,t=n.state.value,r=(0,i.yD)(t)||null;return(0,c.default)({},e.key,r)},n.updateValue=function(e,t){e!==n.state.value&&n.setState({value:e},(function(){t&&t()}))},n.focusInput=function(){n.input&&n.input.focus()},n.blurInput=function(){n.input&&n.input.blur()},n.onBlur=function(){n.props.onCommit()},n.onPaste=function(e){e.stopPropagation()},n.onCut=function(e){e.stopPropagation()},n.onChange=function(e){e.persist();var t=e.target.value;n.setState({value:t},(function(){n.props.onChange&&n.props.onChange(e)}))},n.onInputKeyDown=function(e){var t=e.currentTarget,r=t.selectionStart,o=t.selectionEnd,a=t.value;e.keyCode===pt.cK.Enter?(e.preventDefault(),n.onBlur()):(e.keyCode===pt.cK.ChineseInputMethod||e.keyCode===pt.cK.LeftArrow&&0===r||e.keyCode===pt.cK.RightArrow&&o===a.length)&&e.stopPropagation(),n.props.onKeyDown&&n.props.onKeyDown(e)},n.onClick=function(e){n.props.onInputClick&&n.props.onInputClick(e)},n.onCompositionStart=function(e){n.props.onCompositionStart&&n.props.onCompositionStart(e)},n.onCompositionEnd=function(e){n.props.onCompositionEnd&&n.props.onCompositionEnd(e),n.onChange(e)},n.getInputNode=function(){var e=Fe.findDOMNode(n.input);return"INPUT"===e.tagName?e:e.querySelector("input:not([type=hidden])")},n.setInputRef=function(e){return n.input=e,n.input},n.onSaveQRCodeValue=function(e){n.setState({value:e}),n.props.onCommit()},n.state={value:e.value||""},n}return(0,b.A)(t,e),(0,A.A)(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.props,n=t.value,r=t.column,o=e.value;ne(n,o,r.type)&&this.setState({value:o||""})}},{key:"render",value:function(){var e=this.props,t=e.column,n=e.readOnly,r=e.className,o=e.placeholder,a=this.state.value;return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("input",{type:"text",className:y()("sf-metadata-text-editor form-control",r),ref:this.setInputRef,placeholder:o||"",disabled:n,onBlur:this.onBlur,onCut:this.onCut,onPaste:this.onPaste,value:a,name:t.name,title:t.name,"aria-label":t.name,onChange:this.onChange,onKeyDown:this.onInputKeyDown,onClick:this.onClick,onCompositionStart:this.onCompositionStart,onCompositionEnd:this.onCompositionEnd})})}}])}(o.Component)),gt=mt,vt=(0,o.forwardRef)((function(e,t){var n=e.readOnly,r=e.column,a=e.value,i=e.onCommit,l=e.onChange,u=e.selectDownCell,d=(0,o.useMemo)((function(){return r.data||{format:m.KYu}}),[r]),f=(0,o.useState)(""),h=(0,p.A)(f,2),g=h[0],v=h[1],y=(0,o.useRef)(null);(0,o.useEffect)((function(){var e=a||0===a?a:"",t=(null===r||void 0===r?void 0:r.data)||{},n=(0,m.HLJ)(e,t)||"";v(n)}),[]);var C=(0,o.useCallback)((function(e){var t=(null===d||void 0===d?void 0:d.format)||m.KYu,n="custom_currency"===t?d.currency_symbol:null,r=e.target.value.trim();if((0,m.cX8)()||!(r.indexOf(".\u3002")>-1)){var o=(0,m.yAg)(r,t,n);o!==g&&(v(o),l&&l(e,o))}}),[d,g,l]),A=(0,o.useCallback)((function(){(0,m.Tnt)(i)&&i()}),[i]),x=(0,o.useCallback)((function(e){var t=e.currentTarget,n=t.selectionStart,r=t.selectionEnd,o=t.value;e.keyCode===pt.cK.Enter||e.keyCode===pt.cK.Esc?(e.preventDefault(),A(),(0,m.Tnt)(u)&&u()):(e.keyCode===pt.cK.LeftArrow&&0===n||e.keyCode===pt.cK.RightArrow&&r===o.length)&&e.stopPropagation()}),[A,u]),b=(0,o.useCallback)((function(e){e.stopPropagation()}),[]),_=(0,o.useCallback)((function(e){e.stopPropagation()}),[]);return(0,o.useImperativeHandle)(t,(function(){return{getValue:function(){var e=r.key;return(0,c.default)({},e,(0,m.nYS)(g,d))},getInputNode:function(){var e=Fe.findDOMNode(y.current);return"INPUT"===e.tagName?e:e.querySelector("input:not([type=hidden])")}}}),[r,g,d]),(0,s.jsx)("input",{ref:y,type:"text",className:"form-control",value:g,onBlur:A,onPaste:b,onCut:_,onKeyDown:x,onChange:C,style:{textAlign:"right"},disabled:n})})),yt=vt,Ct=n(35975),At=(0,o.forwardRef)((function(e,t){var n=e.height,r=e.column,a=e.columns,i=e.record,u=e.value,d=e.editorPosition,f=void 0===d?{left:0,top:0}:d,h=e.onCommit,g=e.onPressTab,v=e.modifyColumnData,C=(0,o.useState)(u||""),A=(0,p.A)(C,2),x=A[0],b=A[1],_=(0,o.useState)(""),w=(0,p.A)(_,2),S=w[0],D=w[1],E=(0,o.useState)(-1),k=(0,p.A)(E,2),M=k[0],I=k[1],N=(0,o.useState)(0),P=(0,p.A)(N,2),T=P[0],O=P[1],j=(0,o.useRef)(null),R=(0,o.useRef)(null),L=(0,o.useRef)(null),U=window.sfMetadataContext.canModifyColumnData(r),Y=(0,o.useMemo)((function(){var e=(0,m.FiT)(r),t=r.data||{},n=t.cascade_column_key,o=t.cascade_settings;if(n){var s=(0,m.rm3)(a,n);if(s){var l=(0,m.Teq)(i,s);if(!l)return[];var c=o[l];return c&&Array.isArray(c)&&0!==c.length?e.filter((function(e){return c.includes(e.id)})):[]}}return e}),[i,r,a]),B=(0,o.useMemo)((function(){if(!S)return Y;var e=S.toLowerCase().trim();return e?Y.filter((function(t){return t.name&&t.name.toLowerCase().indexOf(e)>-1})):Y}),[S,Y]),H=(0,o.useMemo)((function(){return!(!U||!S)&&-1===B.findIndex((function(e){return e.name===S}))}),[U,B,S]),V=(0,o.useMemo)((function(){return{width:r.width,top:n-2}}),[r,n]),G=(0,o.useCallback)((function(){h&&h(x)}),[x,h]),q=(0,o.useCallback)((function(e){S!==e&&D(e)}),[S]),z=(0,o.useCallback)((function(e){e!==x&&(b(e),setTimeout((function(){h&&h(e)}),1))}),[x,h]),W=(0,o.useCallback)((function(e){I(e)}),[]),K=(0,o.useCallback)((function(e){I(-1)}),[]),Z=(0,o.useCallback)((function(e){e&&e.stopPropagation(),e&&e.nativeEvent.stopImmediatePropagation();var t=(0,Ct.r)(Y,(null===S||void 0===S?void 0:S.trim())||""),n=Y.slice(0);n.push(t),v(r.key,{options:n},{options:r.data.options||[]}),z(t.id)}),[r,S,Y,z,v]),X=(0,o.useCallback)((function(){var e=getComputedStyle(j.current,null),t=getComputedStyle(L.current,null);return Math.floor(parseInt(e.maxHeight)/parseInt(t.height))-1}),[j,L]),$=(0,o.useCallback)((function(e){var t;if(e.preventDefault(),1===B.length?t=B[0]:M>-1&&(t=B[M]),t){var n=t.id;return x===t.id&&(n=null),void z(n)}var r=!1;S&&(r=!(!U||-1!==B.findIndex((function(e){return e.name===S})))),r&&0!==B.length&&Z()}),[U,B,M,x,S,z,Z]),J=(0,o.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),0!==M&&(I(M-1),M>B.length-T&&(j.current.scrollTop-=30))}),[j,M,T,B,30]),Q=(0,o.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),M!==B.length-1&&(I(M+1),M>=T&&(j.current.scrollTop+=30))}),[j,M,T,B,30]),ee=(0,o.useCallback)((function(e){e.keyCode===pt.cK.Enter?$(e):e.keyCode===pt.cK.UpArrow?J(e):e.keyCode===pt.cK.DownArrow?Q(e):e.keyCode===pt.cK.Tab&&(0,m.Tnt)(g)&&g(e)}),[$,J,Q,g]),te=(0,o.useCallback)((function(e){e.keyCode!==pt.cK.ChineseInputMethod&&e.keyCode!==pt.cK.Enter&&e.keyCode!==pt.cK.LeftArrow&&e.keyCode!==pt.cK.RightArrow||e.stopPropagation()}),[]);(0,o.useEffect)((function(){R.current&&(R.current.getBoundingClientRect().bottom>window.innerHeight&&(R.current.style.top="unset",R.current.style.bottom=f.top+n-window.innerHeight+"px"));return j.current&&L.current&&O(X()),document.addEventListener("keydown",ee,!0),function(){document.removeEventListener("keydown",ee,!0)}}),[ee]),(0,o.useEffect)((function(){var e=0===B.length?-1:0;I(e)}),[B]),(0,o.useImperativeHandle)(t,(function(){return{getValue:function(){var e=r.key;return(0,c.default)({},e,x)},onBlur:function(){return G()}}}),[r,x,G]);var ne=(0,o.useCallback)((function(){if(0===B.length){var e=S?(0,F.AP)("No options available"):(0,F.AP)("No option");return(0,s.jsx)("span",{className:"none-search-result",children:e})}return B.map((function(e,t){var n=x===e.id||x===e.name;return(0,s.jsx)("div",{className:"sf-metadata-single-select-item",ref:L,children:(0,s.jsxs)("div",{className:y()("single-select-container",{"single-select-container-highlight":t===M}),onMouseDown:function(){return z(n?null:e.id)},onMouseEnter:function(){return W(t)},onMouseLeave:function(){return K(t)},children:[(0,s.jsx)("div",{className:"single-select",children:(0,s.jsx)("span",{className:"single-select-name",style:{backgroundColor:e.color,color:e.textColor||null},title:e.name,"aria-label":e.name,children:e.name})}),(0,s.jsx)("div",{className:"single-select-check-icon",children:n&&(0,s.jsx)(l.In,{iconName:"check-mark"})})]})},e.id)}))}),[B,S,x,M,W,K,z]);return(0,s.jsxs)("div",{className:"sf-metadata-single-select-editor",style:V,ref:R,children:[(0,s.jsx)("div",{className:"sf-metadata-search-single-select-options",children:(0,s.jsx)(l.DO,{placeholder:(0,F.AP)("Search option"),onKeyDown:te,onChange:q,autoFocus:!0,className:"sf-metadata-search-options"})}),(0,s.jsx)("div",{className:"sf-metadata-single-select-editor-container",ref:j,children:ne()}),H&&(0,s.jsx)(l.NC,{callBack:Z,footerName:"".concat((0,F.AP)("Add option")," ").concat(S),className:"add-search-result"})]})})),xt=At,bt=function(e){var t=e.value,n=e.options,r=e.onDelete,a=(0,o.useMemo)((function(){if(!Array.isArray(t)||0===t.length)return[];var e=n.filter((function(e){return t.includes(e.id)||t.includes(e.name)})),r=t.filter((function(e){return e&&!n.find((function(t){return t.id===e||t.name===e}))})).map((function(e){return{id:e,name:(0,i.AP)(h.fT),color:h.lX}}));return[].concat((0,xe.A)(e),(0,xe.A)(r))}),[n,t]);return(0,s.jsx)("div",{className:"sf-metadata-delete-select-options",children:a.map((function(e){if(!e)return null;var t=e.id,n=e.name,o={display:"inline-flex",padding:"0px 10px",height:"20px",lineHeight:"20px",textAlign:"center",borderRadius:"10px",maxWidth:"250px",fontSize:13,backgroundColor:e.color,color:e.textColor||null,fill:e.textColor||"#666"};return(0,s.jsxs)("div",{className:"sf-metadata-delete-select-option",style:o,children:[(0,s.jsx)("span",{className:"sf-metadata-delete-select-option-name text-truncate",title:n,"aria-label":n,children:n}),(0,s.jsx)(l.Oi,{className:"sf-metadata-delete-select-remove",onClick:function(e){return r(t,e)},iconName:"x-01"})]},t)}))})},_t=(0,o.forwardRef)((function(e,t){var n=e.height,r=e.saveImmediately,a=e.column,i=e.value,u=e.editorPosition,d=void 0===u?{left:0,top:0}:u,f=e.onCommit,h=e.onPressTab,g=e.modifyColumnData,v=(0,o.useState)((0,m.bLM)(a,i)),C=(0,p.A)(v,2),A=C[0],x=C[1],b=(0,o.useState)(""),_=(0,p.A)(b,2),w=_[0],S=_[1],D=(0,o.useState)(-1),E=(0,p.A)(D,2),k=E[0],M=E[1],I=(0,o.useState)(0),N=(0,p.A)(I,2),P=N[0],T=N[1],O=(0,o.useRef)(null),j=(0,o.useRef)(null),R=(0,o.useRef)(null),L=window.sfMetadataContext.canModifyColumnData(a),U=(0,o.useMemo)((function(){return(0,m.FiT)(a)}),[a]),Y=(0,o.useMemo)((function(){if(!w)return U;var e=w.toLowerCase().trim();return e?U.filter((function(t){return t.name&&t.name.toLowerCase().indexOf(e)>-1})):U}),[w,U]),B=(0,o.useMemo)((function(){return!(!L||!w)&&-1===Y.findIndex((function(e){return e.name===w}))}),[L,Y,w]),H=(0,o.useMemo)((function(){return{width:a.width}}),[a]),V=(0,o.useCallback)((function(){f&&f(A)}),[A,f]),G=(0,o.useCallback)((function(e){w!==e&&S(e)}),[w]),q=(0,o.useCallback)((function(e){var t=A.slice(0),n=A.indexOf(e);n>-1?t.splice(n,1):t.push(e),x(t),r&&f&&f(t)}),[r,A,f]),z=(0,o.useCallback)((function(e){M(e)}),[]),W=(0,o.useCallback)((function(e){M(-1)}),[]),K=(0,o.useCallback)((function(e){e&&e.stopPropagation(),e&&e.nativeEvent.stopImmediatePropagation();var t=(0,Ct.r)(U,(null===w||void 0===w?void 0:w.trim())||""),n=U.slice(0);n.push(t),g(a.key,{options:n},{options:a.data.options||[]}),q(t.id)}),[a,w,U,q,g]),Z=(0,o.useCallback)((function(e){var t=A.slice(0),n=t.indexOf(e);n>-1&&t.splice(n,1),x(t),r&&f&&f(t)}),[r,A,f]),X=(0,o.useCallback)((function(){var e=getComputedStyle(O.current,null),t=getComputedStyle(R.current,null);return Math.floor(parseInt(e.maxHeight)/parseInt(t.height))-1}),[O,R]),$=(0,o.useCallback)((function(e){var t;if(e.preventDefault(),1===Y.length?t=Y[0]:k>-1&&(t=Y[k]),t){var n=t.id;return A===t.id&&(n=null),void q(n)}var r=!1;w&&(r=!(!L||-1!==Y.findIndex((function(e){return e.name===w})))),r&&0!==Y.length&&K()}),[L,Y,k,A,w,q,K]),J=(0,o.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),0!==k&&(M(k-1),k>Y.length-P&&(O.current.scrollTop-=30))}),[O,k,P,Y,30]),Q=(0,o.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),k!==Y.length-1&&(M(k+1),k>=P&&(O.current.scrollTop+=30))}),[O,k,P,Y,30]),ee=(0,o.useCallback)((function(e){e.keyCode===pt.cK.Enter?$(e):e.keyCode===pt.cK.UpArrow?J(e):e.keyCode===pt.cK.DownArrow?Q(e):e.keyCode===pt.cK.Tab&&(0,m.Tnt)(h)&&h(e)}),[$,J,Q,h]),te=(0,o.useCallback)((function(e){e.keyCode!==pt.cK.ChineseInputMethod&&e.keyCode!==pt.cK.Enter&&e.keyCode!==pt.cK.LeftArrow&&e.keyCode!==pt.cK.RightArrow||e.stopPropagation()}),[]);(0,o.useEffect)((function(){j.current&&(j.current.getBoundingClientRect().bottom>window.innerHeight&&(j.current.style.top="unset",j.current.style.bottom=d.top+n-window.innerHeight+"px"));return O.current&&R.current&&T(X()),document.addEventListener("keydown",ee,!0),function(){document.removeEventListener("keydown",ee,!0)}}),[ee]),(0,o.useEffect)((function(){var e=0===Y.length?-1:0;M(e)}),[Y]),(0,o.useImperativeHandle)(t,(function(){return{getValue:function(){var e=a.key;return(0,c.default)({},e,A)},onBlur:function(){return V()}}}),[a,A,V]);var ne=(0,o.useCallback)((function(){if(0===Y.length){var e=w?(0,F.AP)("No options available"):(0,F.AP)("No option");return(0,s.jsx)("span",{className:"none-search-result",children:e})}return Y.map((function(e,t){var n=A.includes(e.id);return(0,s.jsx)("div",{className:"sf-metadata-single-select-item",ref:R,children:(0,s.jsxs)("div",{className:y()("single-select-container",{"single-select-container-highlight":t===k}),onMouseDown:function(){return q(e.id)},onMouseEnter:function(){return z(t)},onMouseLeave:function(){return W(t)},children:[(0,s.jsx)("div",{className:"single-select",children:(0,s.jsx)("span",{className:"single-select-name",style:{backgroundColor:e.color,color:e.textColor||null},title:e.name,"aria-label":e.name,children:e.name})}),(0,s.jsx)("div",{className:"single-select-check-icon",children:n&&(0,s.jsx)(l.In,{iconName:"check-mark"})})]})},e.id)}))}),[Y,w,A,k,z,W,q]);return(0,s.jsxs)("div",{className:"sf-metadata-single-select-editor sf-metadata-multiple-select-editor",style:H,ref:j,children:[(0,s.jsx)(bt,{value:A,options:U,onDelete:Z}),(0,s.jsx)("div",{className:"sf-metadata-search-single-select-options",children:(0,s.jsx)(l.DO,{placeholder:(0,F.AP)("Search option"),onKeyDown:te,onChange:G,autoFocus:!0,className:"sf-metadata-search-options"})}),(0,s.jsx)("div",{className:"sf-metadata-single-select-editor-container",ref:O,children:ne()}),B&&(0,s.jsx)(l.NC,{callBack:K,footerName:"".concat((0,F.AP)("Add option")," ").concat(w),className:"add-search-result"})]})})),wt=_t,St=function(e){var t=e.value,n=e.onDelete,r=(0,oe.D1)().getCollaborator;return(0,s.jsx)("div",{className:"sf-metadata-delete-collaborator",children:Array.isArray(t)&&t.map((function(e){var t=r(e);if(!t)return null;var o=t.name,a=t.avatar_url;return(0,s.jsxs)("div",{className:"collaborator",children:[(0,s.jsx)("span",{className:"collaborator-avatar-container",children:(0,s.jsx)("img",{className:"collaborator-avatar m-0",alt:o,src:a})}),(0,s.jsx)("span",{className:"collaborator-name text-truncate",title:o,"aria-label":o,children:o}),(0,s.jsx)(l.Oi,{className:"collaborator-remove",onClick:function(t){return n(e,t)},iconName:"x-01"})]},e)}))})},Dt=(0,o.forwardRef)((function(e,t){var n=e.height,r=e.saveImmediately,a=void 0!==r&&r,i=e.column,u=e.value,d=e.editorPosition,f=void 0===d?{left:0,top:0}:d,h=e.onCommit,g=e.onPressTab,v=e.onClose,C=(0,o.useState)(u||[]),A=(0,p.A)(C,2),x=A[0],b=A[1],_=(0,o.useState)(""),w=(0,p.A)(_,2),S=w[0],D=w[1],E=(0,o.useState)(-1),k=(0,p.A)(E,2),M=k[0],I=k[1],N=(0,o.useState)(0),P=(0,p.A)(N,2),T=P[0],O=P[1],j=(0,o.useState)(0),R=(0,p.A)(j,2),L=R[0],U=R[1],Y=(0,o.useRef)(null),B=(0,o.useRef)(null),H=(0,o.useRef)(null),V=(0,oe.D1)().collaborators,G=(0,o.useMemo)((function(){var e=S?S.trim().toLowerCase():"",t=Array.isArray(V)&&V.length>0?V:[];return e?t.filter((function(t){var n=t.name,r=t.name_pinyin,o=void 0===r?"":r;if(n.toString().toLowerCase().indexOf(e)>-1)return!0;if(!o)return!1;var a=o.toString().toLowerCase(),i=e.replace(/ |'/g,"");return a.indexOf(i)>-1||(a.replace(/'/g,"").indexOf(i)>-1||a.split("'").map((function(e){return e&&e.trim()?e.trim().slice(0,1):""})).join("").indexOf(i)>-1)})):t}),[S,V]),q=(0,o.useCallback)((function(){h&&h()}),[h]),z=(0,o.useCallback)((function(e){S!==e&&D(e)}),[S]),W=(0,o.useCallback)((function(e){var t=x.slice(0),n=t.indexOf(e);n>-1?t.splice(n,1):t.push(e),b(t),a&&h&&h(t)}),[a,x,h]),K=(0,o.useCallback)((function(e){var t=x.slice(0),n=t.indexOf(e);n>-1&&t.splice(n,1),b(t),a&&h&&h(t)}),[a,x,h]),Z=(0,o.useCallback)((function(e){I(e)}),[]),X=(0,o.useCallback)((function(e){I(-1)}),[]),$=(0,o.useCallback)((function(){var e=getComputedStyle(Y.current,null),t=getComputedStyle(H.current,null);return Math.floor(parseInt(e.maxHeight)/parseInt(t.height))-1}),[Y,H]),J=(0,o.useCallback)((function(e){var t;e.preventDefault(),1===G.length?t=G[0]:M>-1&&(t=G[M]),t&&W(t.email)}),[G,M,W]),Q=(0,o.useCallback)((function(e){if(e.preventDefault(),e.stopPropagation(),0===M)return I(G.length-1),void(Y.current.scrollTop=0);I(M-1),M>G.length-T&&(Y.current.scrollTop-=L)}),[Y,M,T,G,L]),ee=(0,o.useCallback)((function(e){if(e.preventDefault(),e.stopPropagation(),M===G.length-1)return I(0),void(Y.current.scrollTop=0);I(M+1),M>=T&&(Y.current.scrollTop+=L)}),[Y,M,T,G,L]),te=(0,o.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),q()}),[q]),ne=(0,o.useCallback)((function(e){e.keyCode===pt.cK.Enter?J(e):e.keyCode===pt.cK.UpArrow?Q(e):e.keyCode===pt.cK.DownArrow?ee(e):e.keyCode===pt.cK.Tab?(0,m.Tnt)(g)&&g(e):e.keyCode===pt.cK.Esc&&te(e)}),[J,Q,ee,g,te]),re=(0,o.useCallback)((function(e){e.keyCode!==pt.cK.ChineseInputMethod&&e.keyCode!==pt.cK.LeftArrow&&e.keyCode!==pt.cK.RightArrow||e.stopPropagation()}),[]);(0,o.useEffect)((function(){B.current&&(B.current.getBoundingClientRect().bottom>window.innerHeight&&(B.current.style.top="unset",B.current.style.bottom=f.top+n-window.innerHeight+"px"));return Y.current&&H.current&&(O($()),U(parseInt(getComputedStyle(H.current,null).height))),document.addEventListener("keydown",ne,!0),function(){document.removeEventListener("keydown",ne,!0)}}),[ne]),(0,o.useEffect)((function(){var e=0===G.length?-1:0;I(e)}),[G]),(0,o.useImperativeHandle)(t,(function(){return{getValue:function(){var e=i.key;return(0,c.default)({},e,x)},onBlur:function(){return q()},onClose:function(){return v()}}}),[i,x,q,v]);var ae=(0,o.useCallback)((function(){if(0===G.length){var e=S?(0,F.AP)("No collaborators available"):(0,F.AP)("No collaborators");return(0,s.jsx)("span",{className:"none-search-result",children:e})}return G.map((function(e,t){var n=x.includes(e.email);return(0,s.jsx)("div",{className:"sf-metadata-collaborator-item",ref:H,children:(0,s.jsxs)("div",{className:y()("collaborator-container",{"collaborator-container-highlight":t===M}),onMouseDown:function(){return W(e.email)},onMouseEnter:function(){return Z(t)},onMouseLeave:function(){return X(t)},children:[(0,s.jsxs)("div",{className:"collaborator",children:[(0,s.jsx)("img",{className:"collaborator-avatar",alt:e.name,src:e.avatar_url}),(0,s.jsx)("span",{className:"collaborator-name",title:e.name,"aria-label":e.name,children:e.name})]}),(0,s.jsx)("div",{className:"collaborator-check-icon",children:n&&(0,s.jsx)(l.In,{iconName:"check-mark"})})]})},e.email)}))}),[G,S,x,M,Z,X,W]),ie=f.left+300>window.innerWidth;return(0,s.jsxs)("div",{className:"sf-metadata-collaborator-editor",style:{top:-38,left:ie?"unset":0,right:ie?-i.width:"unset"},ref:B,children:[(0,s.jsx)(St,{value:x,onDelete:K}),(0,s.jsx)("div",{className:"sf-metadata-search-collaborator-options",children:(0,s.jsx)(l.DO,{placeholder:(0,F.AP)("Search collaborators"),onKeyDown:re,onChange:z,autoFocus:!0,className:"sf-metadata-search-collaborators"})}),(0,s.jsx)("div",{className:"sf-metadata-collaborator-editor-container",ref:Y,children:ae()})]})})),Et=Dt,kt=n(92203),Mt=n(59051),It=n.n(Mt),Nt=n(97011),Pt=function(){return(0,A.A)((function e(t){var n=this,r=t.repoID,o=t.repoName,a=t.server;(0,C.A)(this,e),this.uploadLocalImage=function(e){var t=It()().format("YYYY-MM"),r="images/".concat(n.relativePath,"/").concat(t);return Nt.e.getFileServerUploadLink(n.repoID,"/").then((function(t){var n=t.data+"?ret-json=1",o="image-"+Date.now().toString()+".png",a=new File([e],o,{type:e.type}),i=new FormData;return i.append("parent_dir","/"),i.append("relative_path",r),i.append("file",a),Nt.e.uploadImage(n,i)})).then((function(e){return n._getImageURL(r,e.data[0].name)}))};var i=window.app.pageOptions,s=i.name,l=i.username,c=i.contactEmail;this.repoID=r,this.repoName=o,this.server=a,this.name=s,this.contact_email=c,this.userName=l,this.relativePath="metadata"}),[{key:"_getImageURL",value:function(e,t){return"".concat(this.server,"/lib/").concat(this.repoID,"/file/").concat(e,"/").concat(t,"?raw=1")}},{key:"getFileURL",value:function(e){return"file"!==e.type?this.server+"/library/"+this.repoID+"/"+encodeURIComponent(this.repoName)+ae.Aq.encodePath(e.path()):e.isImage()?this.server+"/lib/"+this.repoID+"/file"+ae.Aq.encodePath(e.path())+"?raw=1":this.server+"/lib/"+this.repoID+"/file"+ae.Aq.encodePath(e.path())}},{key:"isInternalFileLink",value:function(e){return new RegExp(this.serviceUrl+"/lib/[0-9a-f-]{36}/file.*").test(e)}},{key:"isInternalDirLink",value:function(e){return new RegExp(this.serviceUrl+"/library/[0-9a-f-]{36}.*").test(e)}},{key:"markdownLint",value:function(e){return Nt.e.markdownLint(e)}}])}(),Tt=function(e){function t(e){var n;(0,C.A)(this,t),(n=(0,x.A)(this,t,[e])).initEditorValue=function(){var e=n.props.value;if(e){if("object"===typeof e)return e;if("string"===typeof e){1===e.length&&(n.isLongTextValueChanged=!0);var t=(0,kt.getPreviewContent)(e),r=t.previewText,o=t.images,a=t.links,i=t.checklist;return Object.assign({},{text:e,preview:r,images:o,links:a,checklist:i})}if("string"===typeof e&&1===e.length)return n.isLongTextValueChanged=!0,{text:e,preview:e,links:[],images:[]}}return{text:"",preview:"",links:[],images:[],checklist:{completed:0,count:0}}},n.getOldValue=function(){var e=n.props.value;return e?"object"===typeof e?e.text:"string"===typeof e?e:"":""},n.getValue=function(){var e={};return e[n.props.column.key]=n.value.text,e},n.onEditorValueChanged=function(e){n.value=e,n.isLongTextValueChanged=!0},n.onSaveEditorValue=function(e){if((0,m.EDs)(e))return f.A.closeAll(),void f.A.danger(m.Ar4,{duration:null});n.props.onCommit(null===e||void 0===e?void 0:e.text),n.isLongTextValueChanged=!1},n.onCloseEditorDialog=function(){var e;!n.props.readOnly&&n.isLongTextValueChanged&&((0,m.EDs)(n.value)&&(f.A.closeAll(),f.A.warning(m.Zu0,{duration:null}),n.value=(0,m.ZRJ)(n.value)),n.props.onCommit(null===(e=n.value)||void 0===e?void 0:e.text),n.isLongTextValueChanged=!1);n.props.onCommitCancel()},n.isLongTextValueChanged=!1,n.repoID=window.sfMetadataContext.getSetting("repoID"),n.filePath="/";var r=window.sfMetadataContext.getSetting("repoInfo").repo_name;return n.api=new Pt({repoID:n.repoID,repoName:r,server:F.xW}),n.value=n.initEditorValue(),n}return(0,b.A)(t,e),(0,A.A)(t,[{key:"render",value:function(){var e=this.props,t=e.column,n=e.readOnly,r=t.name;return(0,s.jsx)(kt.LongTextEditorDialog,{className:"sf-metadata-long-text-editor-dialog",lang:F.vV,readOnly:n,headerName:r,value:this.value.text,autoSave:!0,saveDelay:2e4,isCheckBrowser:!0,editorApi:this.api,onSaveEditorValue:this.onSaveEditorValue,onEditorValueChanged:this.onEditorValueChanged,onCloseEditorDialog:this.onCloseEditorDialog})}}])}(o.PureComponent),Ot=Tt,jt=o.forwardRef((function(e,t){switch(e.column.type){case m.vZe.FILE_NAME:return(0,s.jsx)(dt,(0,r.A)({ref:t},e));case m.vZe.TEXT:return(0,s.jsx)(gt,(0,r.A)({ref:t},e));case m.vZe.DATE:return(0,s.jsx)(l.US,(0,r.A)((0,r.A)({ref:t},e),{},{lang:F.vV}));case m.vZe.NUMBER:return(0,s.jsx)(yt,(0,r.A)({ref:t},e));case m.vZe.SINGLE_SELECT:return(0,s.jsx)(xt,(0,r.A)({ref:t},e));case m.vZe.MULTIPLE_SELECT:return(0,s.jsx)(wt,(0,r.A)({ref:t},e));case m.vZe.COLLABORATOR:return(0,s.jsx)(Et,(0,r.A)({ref:t},e));case m.vZe.LONG_TEXT:return(0,s.jsx)(Ot,(0,r.A)((0,r.A)({ref:t},e),{},{lang:F.vV}));default:return null}})),Rt=function(e){function t(){var e;(0,C.A)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=(0,x.A)(this,t,[].concat(o))).state={isInvalid:!1},e.changeCommitted=!1,e.changeCanceled=!1,e.isKeyExplicitlyHandled=function(t){return(0,m.Tnt)(e["onPress"+t])},e.checkAndCall=function(t,n){(0,m.Tnt)(e[t])&&e[t](n)},e.onKeyDown=function(t){if(Re(t))e.checkAndCall("onPressKeyWithCtrl",t);else if(e.isKeyExplicitlyHandled(t.key)){var n="onPress"+t.key;e.checkAndCall(n,t)}else je(t.keyCode)&&(t.stopPropagation(),e.checkAndCall("onPressChar",t));e._keysDown=e._keysDown||{},e._keysDown[t.keyCode]=!0,(0,m.Tnt)(e.props.onGridKeyDown)&&e.props.onGridKeyDown(t)},e.onScroll=function(e){e.stopPropagation()},e.setEditorRef=function(t){e.editor=t},e.createEditor=function(){var t=e.props,n=t.column,o=t.record,a=t.openEditorMode,i=t.columns,l=t.modifyColumnData,c={ref:e.setEditorRef,readOnly:!(0,G.dK)(n,o,!0),columns:i,column:e.props.column,value:e.getInitialValue(),mode:a,onCommit:e.commit,onCommitData:e.commitData,onCommitCancel:e.commitCancel,recordMetaData:e.getRecordMetaData(),record:e.props.record,height:e.props.height,onBlur:e.commit,onOverrideKeyDown:e.onKeyDown,modifyColumnData:l};return(0,s.jsx)(jt,(0,r.A)({},c))},e.onPressEnter=function(){},e.onPressTab=function(){e.commit({key:"Tab"})},e.onPressEscape=function(t){e.editorIsSelectOpen()?t.stopPropagation():e.commitCancel()},e.onPressArrowDown=function(t){e.editorHasResults()?t.stopPropagation():e.commit(t)},e.onPressArrowUp=function(t){e.editorHasResults()?t.stopPropagation():e.commit(t)},e.onPressArrowLeft=function(t){e.isCaretAtBeginningOfInput()?e.commit(t):t.stopPropagation()},e.onPressArrowRight=function(t){e.isCaretAtEndOfInput()?e.commit(t):t.stopPropagation()},e.editorHasResults=function(){return!!(0,m.Tnt)(e.getEditor().hasResults)&&e.getEditor().hasResults()},e.editorIsSelectOpen=function(){return!!(0,m.Tnt)(e.getEditor().isSelectOpen)&&e.getEditor().isSelectOpen()},e.getRecordMetaData=function(){if("function"===typeof e.props.column.getRecordMetaData)return e.props.column.getRecordMetaData(e.props.record,e.props.column)},e.getEditor=function(){return e.editor},e.getInputNode=function(){if(e.getEditor().getInputNode)return e.getEditor().getInputNode()},e.getInitialValue=function(){var t=e.props,n=t.firstEditorKeyDown,r=t.value;return"Enter"===n?r:n||r},e.getContainerClass=function(){return y()({"rdg-editor-container":!0,"table-cell-editor":!0,"has-error":!0===e.state.isInvalid})},e.getOldRowData=function(t){var n=e.props.column,r=n.key,o=n.name,a=t;if(e.getEditor().getOldValue){var i=e.getEditor().getOldValue();a=i[Object.keys(i)[0]]}return{oldRowData:(m.Ajs.includes(r),(0,c.default)({},o,a)),originalOldRowData:(0,c.default)({},r,t)}},e.commit=function(t){var n=e.props,r=n.record,o=n.column,a=o.key,i=o.type,s=(0,m.Teq)(r,o),l=e.getEditor().getValue();ne(s,l[a],i)?e.commitData(l,!0):e.props.onCommitCancel()},e.commitData=function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.isNewValueValid(t)){var r=e.props,o=r.onCommit,a=r.record,i=r.column,s=i.key,l=i.name;e.changeCommitted=!0;var u=a._id,d=(0,m.Teq)(a,i),p=t[Object.keys(t)[0]],f=m.Ajs.includes(s)?(0,c.default)({},s,p):(0,c.default)({},l,p),h=e.getOldRowData(d);o({rowId:u,cellKey:s,updates:f,originalUpdates:t,oldRowData:h.oldRowData,originalOldRowData:h.originalOldRowData},n)}},e.commitCancel=function(){e.changeCanceled=!0,e.props.onCommitCancel()},e.isNewValueValid=function(t){if((0,m.Tnt)(e.getEditor().validate)){var n=e.getEditor().validate(t);return e.setState({isInvalid:!n}),n}return!0},e.setCaretAtEndOfInput=function(){var t=e.getInputNode(),n=t.value.length;if(t.setSelectionRange)t.setSelectionRange(n,n);else if(t.createTextRange){var r=t.createTextRange();r.moveStart("character",n),r.collapse(),r.select()}},e.isCaretAtBeginningOfInput=function(){var t=e.getInputNode();return t.selectionStart===t.selectionEnd&&0===t.selectionStart},e.isCaretAtEndOfInput=function(){var t=e.getInputNode();return t.selectionStart===t.value.length},e.handleRightClick=function(e){e.stopPropagation()},e.setTextInputFocus=function(){var t=e.props.firstEditorKeyDown,n=e.getInputNode();n.focus(),"INPUT"===n.tagName&&(je(t)||n.focus(),n.select())},e.onClickOutside=function(t){var n=(0,i.wD)(t);n&&n.includes("drag-handle")||(e.commit(),e.props.onCommitCancel(),window.sfMetadataContext.eventBus.dispatch(h.Tw.SELECT_NONE))},e}return(0,b.A)(t,e),(0,A.A)(t,[{key:"componentDidMount",value:function(){var e=this.getInputNode();void 0!==e&&(this.setTextInputFocus(),this.getEditor().disableContainerStyles||(e.className+=" editor-main",e.style.height=this.props.height-1+"px"))}},{key:"componentDidUpdate",value:function(e){e.scrollLeft===this.props.scrollLeft&&e.scrollTop===this.props.scrollTop||this.commitCancel()}},{key:"componentWillUnmount",value:function(){this.changeCommitted||this.changeCanceled||this.commit()}},{key:"render",value:function(){var e=this.props,t=e.width,n={position:"absolute",height:e.height,width:t,left:e.left,top:e.top,zIndex:m.Mue.wt};return(0,s.jsx)(l.ij,{onClickOutside:this.onClickOutside,children:(0,s.jsx)("div",{style:n,className:this.getContainerClass(),onKeyDown:this.onKeyDown,onScroll:this.onScroll,onContextMenu:this.handleRightClick,children:this.createEditor()})})}}])}(o.Component);Rt.displayName="EditorContainer";var Lt=Rt,Ft=[m.vZe.CTIME,m.vZe.MTIME,m.vZe.CREATOR,m.vZe.LAST_MODIFIER,m.vZe.FILE_NAME],Ut=function(e){function t(e){var n;(0,C.A)(this,t),(n=(0,x.A)(this,t,[e])).changeCommitted=!1,n.changeCanceled=!1,n.editingRowId=n.props.record._id,n.setEditorRef=function(e){n.editor=e},n.createEditor=function(){var e,t=n.props,o=t.column,a=t.record,i=t.height,l=t.onPressTab,c=t.editorPosition,u=t.columns,d=t.modifyColumnData,p=!(0,G.dK)(o,a,!0)||Ft.includes(o.type),f=n.getInitialValue(p),h={ref:n.setEditorRef,value:f,recordMetaData:n.getRecordMetaData(),onBlur:n.commit,onCommit:n.commit,onCommitData:n.commitData,onCommitCancel:n.commitCancel,onClose:n.closeEditor,onEscape:n.closeEditor,editorContainer:n.getEditorContainer(),modifyColumnData:d,editorPosition:c,record:a,height:i,columns:u,column:o,readOnly:p,onPressTab:l};o.type===m.vZe.DATE&&(h.format=null===o||void 0===o||null===(e=o.data)||void 0===e?void 0:e.format);return(0,s.jsx)(jt,(0,r.A)({},h))},n.getEditorContainer=function(){return n.props.column.type===m.vZe.DATE?document.body:null},n.getRecordMetaData=function(){if("function"===typeof n.props.column.getRecordMetaData){var e=n.props,t=e.record,r=e.column;return n.props.column.getRecordMetaData(t,r)}},n.getEditor=function(){return n.editor},n.getInitialValue=function(e){var t=n.props,r=t.firstEditorKeyDown,o=t.value;return"Enter"===r?o:n.props.column.type===m.vZe.LONG_TEXT?" "===r||e?o:r||o:o},n.getOldRowData=function(e){var t=n.props.column,r=(0,G.KO)(t),o=t.key,a=e;if(n.getEditor().getOldValue){var i=n.getEditor().getOldValue();a=i[Object.keys(i)[0]]}return{oldRowData:(0,c.default)({},r,a),originalOldRowData:(0,c.default)({},o,e)}},n.commit=function(){var e=n.props,t=e.column;if(e.record._id){var r=t.key,o=t.type,a=n.getEditor().getValue(),i=o===m.vZe.DATE?(0,c.default)({},r,a):a;o===m.vZe.SINGLE_SELECT?i[r]=a[r]?(0,m.xnw)(t,a[r]):"":o===m.vZe.MULTIPLE_SELECT&&(i[r]=a[r]?(0,m.zXq)(t,a[r]):[]),n.commitData(i,o!==m.vZe.LONG_TEXT)}},n.commitData=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=n.props,a=o.onCommit,i=o.column,s=o.record,l=i.key,u=i.type,d=i.name,p=(0,m.Teq)(s,i),f=(0,r.A)({},e);if(ne(p,f[l],u)&&n.isNewValueValid(e)){n.changeCommitted=!0;var h=s._id,g=e[Object.keys(e)[0]],v=m.Ajs.includes(l)?(0,c.default)({},l,g):(0,c.default)({},d,g),y=n.getOldRowData(p);a({rowId:h,cellKey:l,updates:v,originalUpdates:f,oldRowData:y.oldRowData,originalOldRowData:y.originalOldRowData},t)}else t&&"function"===typeof n.editor.onClose&&n.editor.onClose()},n.commitCancel=function(){n.changeCanceled=!0,n.props.onCommitCancel()},n.isNewValueValid=function(e){if((0,m.Tnt)(n.getEditor().validate)){var t=n.getEditor().validate(e);return n.setState({isInvalid:!t}),t}return!0},n.handleRightClick=function(e){e.stopPropagation()},n.closeEditor=function(e){return n.props.column.type!==m.vZe.DATE||e?function(){return n.onClickOutside(e)}:null},n.onClickOutside=function(e){n.commit(),n.props.onCommitCancel(),!e&&window.sfMetadataContext.eventBus.dispatch(h.Tw.SELECT_NONE)};var o=n.props,a=o.column,i=o.width,l=o.height,u=o.left,d=o.top,p={};return a.type!==m.vZe.SINGLE_SELECT&&a.type!==m.vZe.MULTIPLE_SELECT||(p={width:i,height:l}),n.state={isInvalid:!1,style:(0,r.A)({position:"absolute",zIndex:m.Mue.wt,left:u,top:d},p)},n}return(0,b.A)(t,e),(0,A.A)(t,[{key:"componentDidUpdate",value:function(e){e.scrollLeft===this.props.scrollLeft&&e.scrollTop===this.props.scrollTop||this.commitCancel()}},{key:"componentWillUnmount",value:function(){this.changeCommitted||this.changeCanceled||this.commit()}},{key:"render",value:function(){return(0,s.jsx)(l.ij,{onClickOutside:this.onClickOutside,children:(0,s.jsx)("div",{style:this.state.style,className:y()({"has-error":!0===this.state.isInvalid}),onContextMenu:this.handleRightClick,ref:this.props.innerRef,children:this.createEditor()})})}}])}(o.Component);Ut.displayName="PopupEditorContainer";var Yt=Ut,Bt=function(e){return(0,s.jsx)(jt,(0,r.A)({},e))},Ht=[m.vZe.DATE,m.vZe.COLLABORATOR,m.vZe.SINGLE_SELECT,m.vZe.MULTIPLE_SELECT,m.vZe.LONG_TEXT],Vt=[m.vZe.FILE_NAME],Gt=function(e){var t=e.column;if(!t)return null;var n=t.type;return Ht.includes(n)?(0,s.jsx)(Yt,(0,r.A)({},e)):Vt.includes(n)?(0,s.jsx)(Bt,(0,r.A)({},e)):(0,s.jsx)(Lt,(0,r.A)({},e))},qt=[m.vZe.FILE_NAME],zt=[m.vZe.CHECKBOX,m.vZe.RATE],Wt=function(e){function t(e){var n;(0,C.A)(this,t),(n=(0,x.A)(this,t,[e])).throttle=null,n.onColumnSelect=function(e){var t=n.props,o=t.columns,a=t.isGroupView,i=t.recordsCount;if(!a){for(var s=0,l=0;l<o.length;l++)if(e.key===o[l].key){s=l;break}n.setState({selectedPosition:(0,r.A)((0,r.A)({},n.state.selectedPosition),{},{idx:s,rowIdx:0}),selectedRange:{startCell:{idx:s,rowIdx:0},topLeft:{idx:s,rowIdx:0},bottomRight:{idx:s,rowIdx:i-1},isDragging:!1}})}},n.onOpenEditorEvent=function(e){n.setState({openEditorMode:e},(function(){n.openEditor()}))},n.onCloseEditorEvent=function(){n.state.isEditorEnabled&&n.closeEditor()},n.onSelectCell=function(e,t){var o=n.state,a=o.selectedPosition,i=o.isEditorEnabled,s=t?n.openEditor:function(){return null};i&&n.closeEditor(),n.setState((function(t){var o=(0,r.A)((0,r.A)({},a),e);return n.isCellWithinBounds(o)?{selectedPosition:o,selectedRange:{topLeft:o,bottomRight:o,startCell:o,cursorCell:o,isDragging:!1}}:t}),s)},n.selectNone=function(){var e={idx:-1,rowIdx:-1,groupRecordIndex:-1};n.setState({selectedPosition:e,selectedRange:{topLeft:e,bottomRight:e,startCell:null,cursorCell:null}}),n.props.selectNone()},n.getSelectedPosition=function(){var e=n.state.selectedRange,t=e.topLeft,r=e.bottomRight;return{top:t.rowIdx,bottom:r.rowIdx,left:t.idx,right:r.idx}},n.getSelectedRange=function(){return n.state.selectedRange},n.selectCell=function(e,t,r){var o={idx:r,groupRecordIndex:e,rowIdx:t};n.setState({selectedPosition:o,selectedRange:{topLeft:o,bottomRight:o,startCell:o,cursorCell:o}})},n.openEditor=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;n.isSelectedCellIsLongText()&&(e&&e.stopPropagation(),e&&e.preventDefault());var t=(e||{}).key,r=n.state,o=r.selectedPosition,a=r.openEditorMode,i=n.props.columns,s=Ne({selectedPosition:o,columns:i}).type;if(zt.includes(s))return null;(n.isSelectedCellEditable()||a===h.rr.PREVIEWER&&qt.includes(s))&&!n.state.isEditorEnabled&&n.setState({isEditorEnabled:!0,firstEditorKeyDown:t,editorPosition:n.getEditorPosition()})},n.closeEditor=function(){n.setState({isEditorEnabled:!1,firstEditorKeyDown:null,editorPosition:null,openEditorMode:""})},n.onSelectCellRangeStarted=function(e){if(n.isCellWithinBounds(e)){var t=n.createSingleCellSelectedRange(e,!0);n.setState({selectedRange:t},(function(){(0,m.Tnt)(n.props.onCellRangeSelectionStarted)&&n.props.onCellRangeSelectionStarted(n.state.selectedRange)}))}},n.onSelectCellRangeUpdated=function(e,t,o){if((n.state.selectedRange.isDragging||t)&&n.isCellWithinBounds(e)){var a=function(e,t){var n=e.idx,r=e.rowIdx,o=e.groupRecordIndex,a=t.idx,i=t.rowIdx,s=t.groupRecordIndex,l=[n,a].sort((function(e,t){return e-t})),c=[r,i].sort((function(e,t){return e-t})),u=[o,s].sort((function(e,t){return e-t}));return{topLeft:{idx:l[0],rowIdx:c[0],groupRecordIndex:u[0]},bottomRight:{idx:l[1],rowIdx:c[1],groupRecordIndex:u[1]}}}(n.state.selectedRange.startCell||n.state.selectedPosition,e),i=a.topLeft,s=a.bottomRight,l=(0,r.A)((0,r.A)({startCell:n.state.selectedPosition},n.state.selectedRange),{},{topLeft:i,bottomRight:s,cursorCell:e});n.setState({selectedRange:l},(function(){(0,m.Tnt)(n.props.onCellRangeSelectionUpdated)&&n.props.onCellRangeSelectionUpdated(n.state.selectedRange),(0,m.Tnt)(o)&&o(n.state.selectedRange)}))}},n.onSelectCellRangeEnded=function(){var e=(0,r.A)((0,r.A)({},n.state.selectedRange),{},{isDragging:!1});n.setState({selectedRange:e},(function(){(0,m.Tnt)(n.props.onCellRangeSelectionCompleted)&&n.props.onCellRangeSelectionCompleted(n.state.selectedRange)}))},n.focus=function(){n.selectionMask&&!n.isFocused()&&n.selectionMask.focus()},n.isFocused=function(){return document.activeElement===n.selectionMask},n.isCellSelected=function(){var e=n.state.selectedPosition;return-1!==e.idx&&-1!==e.rowIdx},n.isCellWithinBounds=function(e){var t=e.idx,r=e.rowIdx,o=n.props,a=o.columns,i=o.recordsCount;return r>=0&&r<i&&t>=0&&t<a.length},n.isSelectedCellEditable=function(){var e=n.props,t=e.enableCellSelect,o=e.columns,a=e.isGroupView,i=e.recordGetterByIndex,s=e.onCheckCellIsEditable,l=function(e){var t=e.enableCellSelect,n=e.selectedPosition,o=e.columns,a=e.isGroupView,i=e.recordGetterByIndex,s=e.onCheckCellIsEditable,l=Ne({selectedPosition:n,columns:o}),c=Ie({selectedPosition:n,isGroupView:a,recordGetterByIndex:i});return!!window.sfMetadataContext.canModifyRow(c)&&(!(0,m.Tnt)(s)||s((0,r.A)({row:c,column:l},n)))&&(0,G.dK)(l,c,t)}({enableCellSelect:t,columns:o,isGroupView:a,recordGetterByIndex:i,selectedPosition:n.state.selectedPosition,onCheckCellIsEditable:s});return l},n.isSelectedCellIsLongText=function(){var e=n.props.columns,t=n.state.selectedPosition,r=Ne({selectedPosition:t,columns:e});return r&&r.type===m.vZe.LONG_TEXT},n.isGridSelected=function(){return n.isCellWithinBounds(n.state.selectedPosition)},n.getSelectedDimensions=function(e){var t=n.props,o=t.columns,a=t.rowHeight,i=t.isGroupView,s=t.groupOffsetLeft,l=t.getRowTop,c=n.props.getScrollLeft();return(0,r.A)({},function(e){var t=e.selectedPosition,n=e.columns,r=e.rowHeight,o=e.scrollLeft,a=e.isGroupView,i=e.groupOffsetLeft,s=e.getRecordTopFromRecordsBody,l=t.idx,c=t.rowIdx,u=t.groupRecordIndex,d={width:0,left:0,top:0,height:r,zIndex:1};if(l>=0){var p=n&&n[l];if(!p)return d;var f,h=p.frozen,g=p.width,v=h?o+p.left:p.left;return a?(v+=i,f=s(u)+1):f=s(c),{width:g,left:v,top:f,height:r,zIndex:h?m.Mue.dC:m.Mue.OB}}return d}({selectedPosition:e,columns:o,scrollLeft:c,rowHeight:a,isGroupView:i,groupOffsetLeft:s,getRecordTopFromRecordsBody:l}))},n.getSelectedRangeDimensions=function(e){var t=n.props,o=t.columns,a=t.rowHeight,i=t.isGroupView,s=t.groups,l=t.groupMetrics,c=t.groupOffsetLeft,u=t.getRowTop;return(0,r.A)({},function(e){var t=e.selectedRange,n=e.columns,r=e.rowHeight,o=e.isGroupView,a=e.groups,i=e.groupMetrics,s=e.groupOffsetLeft,l=e.getRecordTopFromRecordsBody,c=t.topLeft,u=t.bottomRight,d=t.startCell,p=t.cursorCell;if(c.idx<0)return{width:0,left:0,top:0,height:r,zIndex:m.Mue.OB};var f,h,g=function(e,t,n){for(var r=0,o=!1,a=e;a<=t;a++){var i=n[a];i&&(r+=i.width,o=o||i.frozen)}return{totalWidth:r,anyColFrozen:o,left:n[e].left}}(c.idx,u.idx,n),v=g.totalWidth,y=g.anyColFrozen,C=g.left;if(o){var A,x,b=d.groupRecordIndex,_=p.groupRecordIndex,w=Ee(b,i),S=Ee(_,i),D=w.groupPathString,E=S.groupPathString;if(b<_?(A=b,x=Me):(A=_,x=ke),D===E)f=(Math.abs(_-b)+1)*r;else if(x===Me){var k=w.groupPath;f=(((0,m.qaV)(k,a).row_ids||[]).length-w.rowIdx||0)*r}else if(x===ke){var M=w.rowIdx||0;A=b-M,f=(M+1)*r}f+=1,C+=s,h=l(A)}else f=(u.rowIdx-c.rowIdx+1)*r,h=l(c.rowIdx);return{width:v,left:C,top:h,height:f,zIndex:y?m.Mue.dC:m.Mue.OB}}({selectedRange:e,columns:o,rowHeight:a,isGroupView:i,groups:s,groupMetrics:l,groupOffsetLeft:c,getRecordTopFromRecordsBody:u}))},n.setScrollLeft=function(e,t){var r=n,o=r.selectionMask,a=r.state.selectedPosition;n.setMaskScrollLeft(o,a,e,t)},n.geHeaderHeight=function(){var e=n.props.table.header_settings||{};return(((0,m.RIy)(e)?m.JlJ.DEFAULT:e.header_height)===m.JlJ.DOUBLE?h.L9:h.jN)+1},n.setMaskScrollLeft=function(e,t,r,o){var a=n.geHeaderHeight();if(e){var i=t.idx,s=t.rowIdx,l=t.groupRecordIndex;if(i>=0&&s>=0){var c=n.props,u=c.columns,d=c.getRowTop,p=c.isGroupView,f=c.groupOffsetLeft,h=u[i];if(!!h.frozen){var m=-o+d(p?l:s)+a,g=h.left;p&&(m+=1,g+=f),e.style.position="fixed",e.style.top=m+"px",e.style.left=g+"px",e.style.transform="none"}}}},n.cancelSetScrollLeft=function(){n.selectionMask&&n.cancelSetMaskScrollLeft(n.selectionMask,n.state.selectedPosition)},n.cancelSetMaskScrollLeft=function(e,t){var r=n.getSelectedDimensions(t),o=r.left,a=r.top;e.style.position="absolute",e.style.top=0,e.style.left=0,e.style.transform="translate(".concat(o,"px, ").concat(a,"px)")},n.getEditorPosition=function(){if(n.selectionMask){var e=n.props.editorPortalTarget,t=n.selectionMask.getBoundingClientRect(),r=t.left,o=t.top;if(e===document.body){var a=document.scrollingElement||document.documentElement;return{left:r+a.scrollLeft,top:o+a.scrollTop}}var i=e.getBoundingClientRect(),s=i.left,l=i.top;return{left:r-s+e.scrollLeft,top:o-l+e.scrollTop}}},n.onCommit=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];n.props.modifyRecord(e),t&&n.closeEditor()},n.onCommitCancel=function(){n.closeEditor()},n.onKeyDown=function(e){var t=e.keyCode;if(Re(e))n.onPressKeyWithCtrl(e);else if(t===m.cKb.Escape)n.onPressEscape(e);else if(t===m.cKb.Tab)n.onPressTab(e);else if(n.isKeyboardNavigationEvent(e))n.changeCellFromEvent(e);else if(je(t)||t===m.cKb.Enter)n.openEditor(e);else if(t===m.cKb.Backspace||t===m.cKb.Delete){"rdg-selected"===e.target.className&&(e.preventDefault(),n.handleSelectCellsDelete())}},n.handleSelectCellsDelete=function(){var e=n.props,t=e.isGroupView,r=e.recordGetterByIndex,o=e.columns,a=n.state.selectedRange,i=a.topLeft,s=a.bottomRight,l=Oe({selectedRange:a,isGroupView:t,recordGetterByIndex:r}).filter((function(e){return window.sfMetadataContext.canModifyRow(e)}));if(0!==l.length){for(var c=i.idx,u=s.idx,d=[],p=[],f=c;f<=u;f++){var h=o[f];if(!h||m.CJP[h.type]||!window.sfMetadataContext.canModifyColumn(h))break;var g=h.type,v=h.data;d.push(h),g===m.vZe.LINK&&v&&p.push(h)}if(0!==d.length){var y=[],C={},A={},x={},b={},_={},w={};if(l.forEach((function(e){var t=e._id,n={},r={},o={};if(d.forEach((function(t){var o=t.key,a=(0,m.Teq)(e,t);(a||0===a||Array.isArray(a)&&a.length>0)&&(r[o]=a,n[o]=null)})),Object.keys(o).length>0&&(_[t]=o,w[t]={}),Object.keys(n).length>0){y.push(t);var a=We(d,n),i=We(d,r);C[t]=a,A[t]=n,x[t]=i,b[t]=r}})),y.length>0){n.props.updateRecords({recordIds:y,idRecordUpdates:C,idOriginalRecordUpdates:A,idOldRecordData:x,idOriginalOldRecordData:b,isCopyPaste:!0})}}}},n.onCopySelected=function(){n.onCopyCells()},n.onCopy=function(e){e.preventDefault();var t=n.props.recordMetrics,r=Je.getSelectedIds(t);if(r.length>0)n.copyRows(e,r);else{var o=window.getSelection().toString();if(!o&&e.target.value){var a=e.target,i=a.selectionStart,s=a.selectionEnd;o=e.target.value.substring(i,s)}o?n.copyText(e,o):n.isCellMaskActive()&&n.onCopyCells(e)}},n.onPaste=function(e){if(n.isCellMaskActive()&&"r"!==window.sfMetadataContext.getPermission()){var t=n.props,r=t.columns,o=t.isGroupView,a=n.state,i=a.selectedPosition,s=a.selectedRange,l=i.idx,c=i.rowIdx;if(-1!==l&&-1!==c){var u=(0,ot.A)(e);if(u){var d=u.type,p=u[h.aG.DTABLE_FRAGMENT],f=0,m=0;if(d===h.aG.DTABLE_FRAGMENT){var g=p.selectedRecordIds,v=p.copiedRange;if(Array.isArray(g)&&g.length>0)f=g.length,m=r.length;else{var y=v.topLeft,C=v.bottomRight,A=y.idx,x=y.rowIdx,b=C.idx;f=C.rowIdx-x+1,m=b-A+1}}else{var _=p.copiedRecords,w=p.copiedColumns;f=_.length,m=w.length}var S=n.isMultiplePaste(f,m);n.props.paste({copied:p,multiplePaste:S,type:d,pasteRange:s,isGroupView:o}),S||n.setPasteRange(f,m)}}}},n.copyText=function(e,t){rt({type:"text",event:e,copiedText:t})},n.copyRows=function(e,t){var r=n.props,o=r.table,a=r.columns,i=r.recordGetterById,s=r.isGroupView,l=r.getCopiedRecordsAndColumnsFromRange,c=t.length;f.A.success(c>1?(0,F.AP)("xxx rows are copied.").replace("xxx",c):(0,F.AP)("1 row is copied."));var u=h.aG.DTABLE_FRAGMENT,d=l({type:u,copied:{selectedRecordIds:t},isGroupView:s}),p=d.copiedRecords,m=d.copiedColumns,g=o._id;rt({type:u,event:e,selectedRecordIds:t,copiedRecords:p,copiedColumns:m,copiedTableId:g,tableData:{columns:a},recordGetterById:i})},n.onCopyCells=function(e){var t=n.props,o=t.table,a=t.columns,i=t.isGroupView,s=t.recordGetterByIndex,l=t.getCopiedRecordsAndColumnsFromRange,c=n.state,u=c.selectedPosition,d=c.selectedRange,p=o._id,m=u.rowIdx,g=u.idx;if(!(m<0||g<0)){var v=d.topLeft,y=d.bottomRight,C=h.aG.DTABLE_FRAGMENT,A=(y.rowIdx-v.rowIdx+1)*(y.idx-v.idx+1);f.A.success(A>1?(0,F.AP)("xxx cells copied").replace("xxx",A):(0,F.AP)("1 cell copied"));var x=l({type:C,copied:{copiedRange:d},isGroupView:i}),b=x.copiedRecords,_=x.copiedColumns;rt({type:C,event:e,copiedRange:(0,r.A)({},d),copiedRecords:b,copiedColumns:_,copiedTableId:p,tableData:{columns:a},isGroupView:i,recordGetterByIndex:s})}},n.isMultiplePaste=function(e,t){var r=n.state.selectedRange,o=r.topLeft,a=r.bottomRight,i=o.idx,s=o.rowIdx,l=a.idx,c=a.rowIdx;return Number.isInteger((l-i+1)/t)&&Number.isInteger((c-s+1)/e)},n.setPasteRange=function(e,t){var o=n.props,a=o.recordsCount,i=o.columns,s=n.state,l=s.selectedPosition,c=s.selectedRange,u=c.topLeft,d=u.idx,p=u.rowIdx,f=i.length,h=l.groupRecordIndex,m=d+t-1,g=p+e-1;m>=f&&(m=f-1),g>=a&&(g=a-1);var v={topLeft:u,startCell:l,bottomRight:{idx:m,rowIdx:g,groupRecordIndex:h},cursorCell:{idx:l.idx,rowIdx:l.rowIdx,groupRecordIndex:h}};return n.setState({selectedRange:(0,r.A)((0,r.A)({},c),v)},(function(){n.focus()})),v},n.onPressKeyWithCtrl=function(){},n.onPressEscape=function(){},n.onPressTab=function(e){n.changeCellFromEvent(e)},n.getLeftInterval=function(){var e=n.props,t=e.isGroupView,r=e.columns,o=e.groupOffsetLeft,a=e.frozenColumnsWidth,i=0;return!!r[0]&&r[0].frozen?(i=o+a,t&&(i+=o)):i=0,i},n.handleVerticalArrowAction=function(e,t){var o=n.props,a=o.isGroupView,i=o.groupMetrics,s=o.rowHeight,l="ArrowDown"===t?1:-1;if(a){for(var c,u=(i.groupRows||[]).length,d=e.groupRecordIndex+l;d>0&&d<u&&(c=Ee(d,i)).type!==h.Gi.ROW;)d+=l;if(!c||c.type!==h.Gi.ROW)return;var p,f=n.props.getGroupCanvasScrollTop()||0,m=c,g=m.rowIdx,v=m.top;return v<=f+16?p=v-16:v+150-f>=window.innerHeight-32-16&&(p=v+150-window.innerHeight+32+s+16),void 0!==p&&n.props.setGroupCanvasScrollTop(p),(0,r.A)((0,r.A)({},e),{},{rowIdx:g,groupRecordIndex:d})}return(0,r.A)((0,r.A)({},e),{},{rowIdx:e.rowIdx+l})},n.handleLeftArrowAction=function(e){var t=n.selectionMask;if(t){var o=n.props.columns,a=t.getBoundingClientRect(),i=n.getLeftInterval(),s=o[e.idx-1]?o[e.idx-1].width:0,l=n.props.getTableContentRect(),c=l.left,u=l.right,d=c+130;if(a.x<0||a.x>u)n.props.scrollToColumn(e.idx-1);else if(s>a.x-i-d){var p=s-(a.x-i-d);n.props.setRecordsScrollLeft(n.props.getScrollLeft()-p)}return(0,r.A)((0,r.A)({},e),{},{idx:0===e.idx?0:e.idx-1})}},n.handleRightArrowAction=function(e){var t=n.selectionMask;if(t){var o=n.props.columns,a=t.getBoundingClientRect(),i=e.idx,s=o[i];if(1===i&&!0===s.frozen)n.props.scrollToColumn(1);else{var l=n.props.getTableContentRect().right,c=o[i+1]?o[i+1].width:0;if(a.x<0||a.x>l)n.props.scrollToColumn(i+1);else if(a.x+a.width+c>l){var u=c-(l-a.x-a.width);n.props.setRecordsScrollLeft(n.props.getScrollLeft()+u)}}return(0,r.A)((0,r.A)({},e),{},{idx:e.idx+1})}},n.getKeyNavActionFromEvent=function(e){var t=n.props,r=t.getVisibleIndex,o=t.onHitBottomBoundary,a=t.onHitTopBoundary,i=r(),s=i.rowVisibleStartIdx,l=i.rowVisibleEndIdx,c={ArrowDown:{getNext:function(e){return n.handleVerticalArrowAction(e,"ArrowDown")},isCellAtBoundary:function(e){return e.rowIdx>=l-1},onHitBoundary:o},ArrowUp:{getNext:function(e){return n.handleVerticalArrowAction(e,"ArrowUp")},isCellAtBoundary:function(e){return 0!==e.rowIdx&&e.rowIdx<=s},onHitBoundary:a},ArrowRight:{getNext:function(e){return n.handleRightArrowAction(e)},isCellAtBoundary:function(){return!1}},ArrowLeft:{getNext:function(e){return n.handleLeftArrowAction(e)},isCellAtBoundary:function(){return!1}}};return e.keyCode===m.cKb.Tab?!0===e.shiftKey?c.ArrowLeft:c.ArrowRight:c[e.key]},n.changeCellFromEvent=function(e){if(e.preventDefault(),(e.keyCode!==m.cKb.ChineseInputMethod||!n.state.isEditorEnabled)&&!n.throttle){var t=n.state.selectedPosition,o=n.getKeyNavActionFromEvent(e),a=o.getNext(t);a&&(n.checkIsAtGridBoundary(o,a),n.props.onCellClick(a),n.onSelectCell((0,r.A)({},a)),n.throttle=!0,setTimeout((function(){n.throttle=!1}),30))}},n.onFocus=function(){},n.onScroll=function(e){e.stopPropagation()},n.setSelectionMaskRef=function(e){n.selectionMask=e},n.setSelectionRangeMaskRef=function(e){n.selectedRangeMask=e},n.setContainerRef=function(e){n.container=e},n.isCellMaskActive=function(){var e=document.activeElement;return e&&("cell-mask"===e.getAttribute("data-test")||"active-editor"===e.getAttribute("data-test"))},n.handleDragCopy=function(e){var t=n.props,o=t.columns,a=t.groupMetrics,i=t.table,s=i.rows,l=i.id_row_map,c=t.gridUtils,u=t.updateRecords,d=c.getUpdateDraggedRecords(e,o,s,l,a);u((0,r.A)((0,r.A)({},d),{},{isCopyPaste:!0}))},n.handleDragStart=function(e){var t=n.state.selectedRange,r=t.topLeft,o=t.bottomRight,a=t.startCell,i=t.cursorCell,s=e&&e.target&&e.target.className;if(r.idx>-1&&s){try{e.dataTransfer.setData("text/plain","")}catch(l){e.dataTransfer.setData("text","")}n.setState({draggedRange:{topLeft:r,bottomRight:o,startCell:a,cursorCell:i}})}},n.handleDragEnter=function(e){var t=e.overRecordIdx,o=e.overGroupRecordIndex;null!=n.state.draggedRange&&n.setState((function(e){var n=e.draggedRange;return{draggedRange:(0,r.A)((0,r.A)({},n),{},{overRecordIdx:t,overGroupRecordIndex:o})}}))},n.handleDragEnd=function(){var e=n.state,t=e.draggedRange,r=e.selectedRange,o=Ae()(r);if(null!==t){var a=t.overRecordIdx,i=t.overGroupRecordIndex,s=t.bottomRight;null!==a&&s.rowIdx<a&&(n.handleDragCopy(t),o.bottomRight.rowIdx=a,o.cursorCell.rowIdx=a,o.bottomRight.groupRecordIndex=i,o.cursorCell.groupRecordIndex=i),n.setState({draggedRange:null,selectedRange:o})}},n.renderSingleCellSelectView=function(){var e=n.props.columns,t=n.state,o=t.isEditorEnabled,a=t.selectedPosition,i=n.isSelectedCellEditable(),l=window.sfMetadataContext.canModifyRows(),c=i&&l,u=(Ne({selectedPosition:a,columns:e})||{}).type;if(o&&u!==m.vZe.RATE&&u!==m.vZe.CHECKBOX&&u!==m.vZe.FILE_NAME)return null;if(!n.isGridSelected())return null;var d={innerRef:n.setSelectionMaskRef,selectedPosition:a,getSelectedDimensions:n.getSelectedDimensions};return(0,s.jsx)(Ve,(0,r.A)((0,r.A)({},d),{},{children:c&&(0,s.jsx)(it,{onDragStart:n.handleDragStart,onDragEnd:n.handleDragEnd})}))},n.renderCellRangeSelectView=function(){var e=n.state.selectedRange,t=n.props,r=t.columns,o=t.rowHeight,a=n.isSelectedCellEditable(),i=window.sfMetadataContext.canModifyRows(),l=a&&i;return[(0,s.jsx)(He,{innerRef:n.setSelectionRangeMaskRef,selectedRange:e,columns:r,rowHeight:o,getSelectedRangeDimensions:n.getSelectedRangeDimensions,children:l&&(0,s.jsx)(it,{onDragStart:n.handleDragStart,onDragEnd:n.handleDragEnd})},"range-mask"),(0,s.jsx)(Ve,{innerRef:n.setSelectionMaskRef,selectedPosition:e.startCell,getSelectedDimensions:n.getSelectedDimensions},"selection-mask")]};var o={idx:-1,rowIdx:-1,groupRecordIndex:-1};return n.state={selectedPosition:o,selectedRange:{topLeft:o,bottomRight:o,startCell:null,cursorCell:null,isDragging:!1},draggedRange:null,isEditorEnabled:!1,openEditorMode:""},n.selectionMask=null,n}return(0,b.A)(t,e),(0,A.A)(t,[{key:"componentDidMount",value:function(){var e=window.sfMetadataContext.eventBus;this.unsubscribeSelectColumn=e.subscribe(h.Tw.SELECT_COLUMN,this.onColumnSelect),this.unsubscribeDragEnter=e.subscribe(h.Tw.DRAG_ENTER,this.handleDragEnter),this.unsubscribeSelectCell=e.subscribe(h.Tw.SELECT_CELL,this.onSelectCell),this.unsubscribeSelectNone=e.subscribe(h.Tw.SELECT_NONE,this.selectNone),this.unsubscribeSelectStart=e.subscribe(h.Tw.SELECT_START,this.onSelectCellRangeStarted),this.unsubscribeSelectUpdate=e.subscribe(h.Tw.SELECT_UPDATE,this.onSelectCellRangeUpdated),this.unsubscribeSelectEnd=e.subscribe(h.Tw.SELECT_END,this.onSelectCellRangeEnded),this.unsubscribeOpenEditorEvent=e.subscribe(h.Tw.OPEN_EDITOR,this.onOpenEditorEvent),this.unsubscribeCloseEditorEvent=e.subscribe(h.Tw.CLOSE_EDITOR,this.onCloseEditorEvent),this.unsubscribeCopy=e.subscribe(h.Tw.COPY_CELLS,this.onCopy),this.unsubscribePaste=e.subscribe(h.Tw.PASTE_CELLS,this.onPaste)}},{key:"componentDidUpdate",value:function(e,t){var n=this.state,r=n.selectedRange,o=n.isEditorEnabled,a=t.selectedRange,i=o!==t.isEditorEnabled&&!o;(r!==a&&(r.topLeft!==a.topLeft||r.bottomRight!==a.bottomRight)||i)&&this.focus()}},{key:"componentWillUnmount",value:function(){this.unsubscribeSelectColumn(),this.unsubscribeSelectCell(),this.unsubscribeSelectStart(),this.unsubscribeSelectUpdate(),this.unsubscribeSelectEnd(),this.unsubscribeOpenEditorEvent(),this.unsubscribeCloseEditorEvent(),this.unsubscribeCopy(),this.unsubscribePaste(),this.setState=function(e,t){}}},{key:"createSingleCellSelectedRange",value:function(e,t){return{topLeft:e,bottomRight:e,startCell:e,cursorCell:e,isDragging:t}}},{key:"isKeyboardNavigationEvent",value:function(e){return null!=this.getKeyNavActionFromEvent(e)}},{key:"checkIsAtGridBoundary",value:function(e,t){var n=e.isCellAtBoundary,r=e.onHitBoundary;n(t)&&r(t)}},{key:"render",value:function(){var e=this.state,t=e.selectedRange,n=e.isEditorEnabled,a=e.draggedRange,i=e.selectedPosition,l=e.firstEditorKeyDown,c=e.openEditorMode,u=e.editorPosition,d=this.props,p=d.table,f=d.columns,h=d.isGroupView,m=d.recordGetterByIndex,g=d.scrollTop,v=d.getScrollLeft,y=d.editorPortalTarget,C=d.contextMenu,A=d.recordMetrics,x=function(e){var t=e.topLeft,n=e.bottomRight;return t.idx===n.idx&&t.rowIdx===n.rowIdx}(t);return(0,s.jsxs)("div",{className:"interaction-mask",ref:this.setContainerRef,onKeyDown:this.onKeyDown,onFocus:this.onFocus,onScroll:this.onScroll,tabIndex:0,"aria-hidden":"true",children:[a&&(0,s.jsx)(at,{draggedRange:a,getSelectedDimensions:this.getSelectedDimensions,getSelectedRangeDimensions:this.getSelectedRangeDimensions}),x?this.renderSingleCellSelectView():this.renderCellRangeSelectView(),n&&(0,s.jsx)(lt,{target:y,children:(0,s.jsx)(Gt,(0,r.A)({table:p,columns:f,scrollTop:g,firstEditorKeyDown:l,openEditorMode:c,portalTarget:y,scrollLeft:v(),record:Ie({selectedPosition:i,isGroupView:h,recordGetterByIndex:m}),column:Ne({selectedPosition:i,columns:f}),value:Pe({selectedPosition:i,columns:f,isGroupView:h,recordGetterByIndex:m}),onCommit:this.onCommit,onCommitCancel:this.onCommitCancel,modifyColumnData:this.props.modifyColumnData,editorPosition:u},(0,r.A)((0,r.A)({},this.getSelectedDimensions(i)),this.state.editorPosition)))}),(0,o.isValidElement)(C)&&(0,o.cloneElement)(C,{recordMetrics:A,selectedPosition:x?i:null,selectedRange:x?null:t,onClearSelected:this.handleSelectCellsDelete,onCopySelected:this.onCopySelected,getTableContentRect:this.props.getTableContentRect,getTableCanvasContainerRect:this.props.getTableCanvasContainerRect})]})}}])}(o.Component);Wt.defaultProps={enableCellSelect:!0,isGroupView:!1,groupOffsetLeft:0};var Kt=Wt,Zt=function(e,t,n){var r=0,o=0,a=Xt(e,t);if(!a)return null;for(var s=0;s<t;s++){var l=Xt(e,s);l&&(l.width&&(r+=l.width),(0,G.Zz)(l)&&(o+=l.width))}return i.Fr?r-(n-a.width)/2:r-o},Xt=function(e,t){return Array.isArray(e)?e[t]:"undefined"!==typeof Immutable?e.get(t):void 0},$t=function(e,t){for(var n=t,r=0;r<e.length;r++){if((n-=e[r].width)<0)return r}},Jt=function(e,t,n){for(var r=t+n,o=0;o<e.length;o++){if((r-=e[o].width)<0)return o-1-1}return e.length-1},Qt=33,en=window.innerHeight-174,tn=Math.max,nn=Math.min,rn=Math.ceil,on=Math.round,an=function(e){function t(e){var n;return(0,C.A)(this,t),(n=(0,x.A)(this,t,[e])).getVisibleIndex=function(){return{rowVisibleStartIdx:n.rowVisibleStart,rowVisibleEndIdx:n.rowVisibleEnd}},n.getShownRecords=function(){return n.getShownRecordIds().map((function(e){return n.props.recordGetterById(e)}))},n.setRecordVisibleEnd=function(){return tn(rn(en/Qt),0)},n.setColumnVisibleEnd=function(){for(var e=n.props,t=e.columns,r=e.getScrollLeft,o=0,a=(0,e.getTableContentRect)().width+r(),i=0;i<t.length;i++){if((a-=t[i].width)<0)return i}return o},n.recalculateRenderIndex=function(e){var t=n.state,r=t.startRenderIndex,o=t.endRenderIndex,a=n.resultContentRef.scrollTop,i=Math.max(0,Math.floor(a/Qt)-10),s=n.props.getTableContentRect().height,l=Math.min(Math.ceil((a+s)/Qt)+10,e.length);i!==r&&n.setState({startRenderIndex:i}),l!==o&&n.setState({endRenderIndex:l})},n.getInitEndIndex=function(e){return Math.min(Math.ceil(window.innerHeight/Qt)+10,e.recordsCount)},n.getShownRecordIds=function(){var e=n.props.recordIds,t=n.state,r=t.startRenderIndex,o=t.endRenderIndex;return e.slice(r,o)},n.getRowTop=function(e){return Qt*e},n.getRowHeight=function(){return Qt},n.jumpToRow=function(e){var t=n.props.recordsCount,r=n.getRowHeight(),o=n.resultContentRef.offsetHeight,a=Math.min(e*r,t*r-o);n.setScrollTop(a)},n.scrollToColumn=function(e){var t=n.props,r=t.columns,o=(0,t.getTableContentRect)().width,a=Zt(r,e,o);null!==a&&n.props.setRecordsScrollLeft(a),n.updateColVisibleIndex(a)},n.updateColVisibleIndex=function(e){var t=n.props.columns,r=$t(t,e),o=Jt(t,window.innerWidth,e);n.columnVisibleStart=r,n.columnVisibleEnd=o},n.setScrollTop=function(e){n.resultContentRef.scrollTop=e},n.setScrollLeft=function(e,t){var r=n.interactionMask;r&&r.setScrollLeft(e,t)},n.cancelSetScrollLeft=function(){var e=n.interactionMask;e&&e.cancelSetScrollLeft()},n.getClientScrollTopOffset=function(e){var t=n.getRowHeight(),r=e.scrollTop%t;return r>0?t-r:0},n.onHitBottomCanvas=function(){var e=n.getRowHeight(),t=n.resultContentRef;t.scrollTop+=e+n.getClientScrollTopOffset(t)},n.onHitTopCanvas=function(){var e=n.getRowHeight(),t=n.resultContentRef;t.scrollTop-=e-n.getClientScrollTopOffset(t)},n.getScrollTop=function(){return n.resultContentRef?n.resultContentRef.scrollTop:0},n.getRecordBodyHeight=function(){return n.resultContentRef?n.resultContentRef.offsetHeight:0},n.onScroll=function(){var e=n.props.recordsCount,t=n.state,r=t.startRenderIndex,o=t.endRenderIndex,a=n.resultContentRef,i=a.offsetHeight,s=a.scrollTop,l=Math.max(0,Math.floor(s/Qt)-10),c=Math.min(Math.ceil((s+n.resultContentRef.offsetHeight)/Qt)+10,e);n.oldScrollTop=s;var u=rn(n.resultContentRef.offsetHeight/Qt),d=tn(0,on(s/Qt)),p=nn(d+u,e);n.rowVisibleStart=d,n.rowVisibleEnd=p,n.props.cacheScrollTop(s),(Math.abs(l-r)>5||l<5)&&n.setState({startRenderIndex:l}),(Math.abs(c-o)>5||c>e-5)&&n.setState({endRenderIndex:c}),i+s>=n.resultContentRef.scrollHeight&&n.props.scrollToLoadMore(),n.isScrollingRightScrollbar||n.setRightScrollbarScrollTop(n.oldScrollTop),n.clearScrollbarTimer(),n.scrollbarTimer=setTimeout((function(){n.setState({isScrollingRightScrollbar:!1})}),300)},n.onScrollbarScroll=function(e){n.oldScrollTop!==e&&n.setState({isScrollingRightScrollbar:!0},(function(){n.setScrollTop(e)}))},n.onScrollbarMouseUp=function(){n.setState({isScrollingRightScrollbar:!1})},n.setRightScrollbarScrollTop=function(e){n.rightScrollbar&&n.rightScrollbar.setScrollTop(e)},n.selectNoneCells=function(){n.interactionMask&&n.interactionMask.selectNone();var e=n.state.selectedPosition;!e||e.idx<0||e.rowIdx<0||n.selectNone()},n.selectNone=function(){n.setState({selectedPosition:{idx:-1,rowIdx:-1}})},n.selectCell=function(e,t){window.sfMetadataContext.eventBus.dispatch(h.Tw.SELECT_CELL,e,t)},n.selectStart=function(e){window.sfMetadataContext.eventBus.dispatch(h.Tw.SELECT_START,e)},n.selectUpdate=function(e,t,n){window.sfMetadataContext.eventBus.dispatch(h.Tw.SELECT_UPDATE,e,t,n)},n.selectEnd=function(){window.sfMetadataContext.eventBus.dispatch(h.Tw.SELECT_END)},n.onCellClick=function(e,t){var r=n.state.selectedPosition;if(Le(t)){if(!r||-1===r.idx)return void n.selectCell(e,!1);n.selectUpdate(e,!0)}else{var o=n.props.columns,a=(0,G.Hs)(e,o),i=Te(e,o,!1,n.props.recordGetterByIndex);n.selectCell(e,a&&i)}n.props.onCellClick(e),n.setState({selectedPosition:e})},n.onCellDoubleClick=function(e,t){var r=n.props.columns,o=(0,G.wo)(e,r),a=Te(e,r,!1,n.props.recordGetterByIndex);n.selectCell(e,o&&a)},n.onCellMouseDown=function(e,t){Le(t)||(n.selectCell(e),n.selectStart(e),window.addEventListener("mouseup",n.onWindowMouseUp))},n.onCellMouseEnter=function(e){n.selectUpdate(e,!1,n.updateViewableArea)},n.onCellMouseMove=function(e){n.selectUpdate(e,!1,n.updateViewableArea)},n.onWindowMouseUp=function(e){window.removeEventListener("mouseup",n.onWindowMouseUp),Le(e)||(n.selectEnd(),n.clearHorizontalScroll())},n.onCellRangeSelectionUpdated=function(e){n.props.onCellRangeSelectionUpdated(e)},n.onCellContextMenu=function(e){n.props.onCellContextMenu(e)},n.updateViewableArea=function(e){var t=e.cursorCell.mousePosition,r=t.x,o=t.y,a=100;if(r+a>window.innerWidth)n.scrollToRight();else if(r-a<h.sN+n.props.frozenColumnsWidth)n.scrollToLeft();else if(o+a>window.innerHeight-130){var i=n.getScrollTop();n.resultContentRef.scrollTop=i+8,n.clearHorizontalScroll()}else if(o-a<130){var s=n.getScrollTop();s-16>=0&&(n.resultContentRef.scrollTop=s-8),n.clearHorizontalScroll()}else n.clearHorizontalScroll()},n.scrollToRight=function(){n.timer||(n.timer=setInterval((function(){var e=n.props.getScrollLeft();n.props.setRecordsScrollLeft(e+20)}),10))},n.scrollToLeft=function(){n.timer||(n.timer=setInterval((function(){var e=n.props.getScrollLeft();e<=0?n.clearHorizontalScroll():n.props.setRecordsScrollLeft(e-20)}),10))},n.clearHorizontalScroll=function(){n.timer&&(clearInterval(n.timer),n.timer=null)},n.clearScrollbarTimer=function(){n.scrollbarTimer&&(clearTimeout(n.scrollbarTimer),n.scrollbarTimer=null)},n.getCellMetaData=function(){return n.cellMetaData||(n.cellMetaData={onCellClick:n.onCellClick,onCellDoubleClick:n.onCellDoubleClick,onCellMouseDown:n.onCellMouseDown,onCellMouseEnter:n.onCellMouseEnter,onCellMouseMove:n.onCellMouseMove,onDragEnter:n.handleDragEnter,modifyRecord:n.props.modifyRecord,onCellContextMenu:n.onCellContextMenu}),n.cellMetaData},n.handleDragEnter=function(e){var t=e.overRecordIdx,n=e.overGroupRecordIndex;window.sfMetadataContext.eventBus.dispatch(h.Tw.DRAG_ENTER,{overRecordIdx:t,overGroupRecordIndex:n})},n.setRightScrollbar=function(e){n.rightScrollbar=e},n.setInteractionMaskRef=function(e){n.interactionMask=e},n.setResultRef=function(e){n.resultRef=e},n.setResultContentRef=function(e){n.resultContentRef=e},n.renderRecords=function(){n.recordFrozenRefs=[];var e=n.props,t=e.recordsCount,r=e.columns,o=e.colOverScanStartIdx,a=e.colOverScanEndIdx,i=e.lastFrozenColumnKey,c=e.recordMetrics,u=e.showCellColoring,d=e.columnColors,p=n.state,f=p.startRenderIndex,h=p.endRenderIndex,m=p.selectedPosition,g=n.getCellMetaData(),v=t-1,y=n.getShownRecordIds(),C=n.props.getScrollLeft(),A=n.getRowHeight(),x=y.map((function(e,t){var l=n.props.recordGetterById(e),p=Je.isRecordSelected(e,c),h=f+t,y=v===h,x=n.props.hasSelectedCell({recordIndex:h},m),b=u?d[e]:{};return(0,s.jsx)(ye,{ref:function(e){n.recordFrozenRefs.push(e)},isSelected:p,index:h,isLastRecord:y,record:l,columns:r,colOverScanStartIdx:o,colOverScanEndIdx:a,lastFrozenColumnKey:i,scrollLeft:C,height:A,cellMetaData:g,hasSelectedCell:x,selectedPosition:n.state.selectedPosition,selectNoneCells:n.selectNoneCells,onSelectRecord:n.props.onSelectRecord,modifyRecord:n.props.modifyRecord,searchResult:n.props.searchResult,columnColor:b},e||h)})),b=f*Qt,_=(t-h)*Qt;if(b>0){var w={height:b,width:"100%"},S=(0,s.jsx)("div",{className:"d-flex align-items-end",style:w,children:(0,s.jsx)(l.Rh,{})},"upper-placeholder");x.unshift(S)}if(_>0){var D={height:_,width:"100%"},E=(0,s.jsx)("div",{style:D,children:(0,s.jsx)(l.Rh,{})},"below-placeholder");x.push(E)}return x},n.state={startRenderIndex:0,endRenderIndex:n.getInitEndIndex(e),activeRecords:[],menuPosition:null,selectedPosition:null,isScrollingRightScrollbar:!1},n.resultContentRef=null,n.resultRef=null,n.recordFrozenRefs=[],n.rowVisibleStart=0,n.rowVisibleEnd=n.setRecordVisibleEnd(),n.columnVisibleStart=0,n.columnVisibleEnd=n.setColumnVisibleEnd(),n.timer=null,n}return(0,b.A)(t,e),(0,A.A)(t,[{key:"componentDidMount",value:function(){this.props.onRef(this),window.sfMetadataBody=this}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.recordsCount,n=e.recordIds;t===this.props.recordsCount&&n===this.props.recordIds||this.recalculateRenderIndex(n)}},{key:"componentWillUnmount",value:function(){this.clearHorizontalScroll(),this.clearScrollbarTimer(),this.setState=function(e,t){}}},{key:"render",value:function(){return(0,s.jsxs)(o.Fragment,{children:[(0,s.jsxs)("div",{id:"canvas",className:"sf-metadata-result-table-content",ref:this.setResultContentRef,onScroll:this.onScroll,children:[(0,s.jsx)(Kt,{ref:this.setInteractionMaskRef,contextMenu:this.props.contextMenu,canAddRow:this.props.canAddRow,table:this.props.table,columns:this.props.columns,recordsCount:this.props.recordsCount,recordMetrics:this.props.recordMetrics,rowHeight:this.getRowHeight(),getRowTop:this.getRowTop,scrollTop:this.oldScrollTop,getScrollLeft:this.props.getScrollLeft,getTableContentRect:this.props.getTableContentRect,getMobileFloatIconStyle:this.props.getMobileFloatIconStyle,onToggleMobileMoreOperations:this.props.onToggleMobileMoreOperations,editorPortalTarget:this.props.editorPortalTarget,onCellRangeSelectionUpdated:this.onCellRangeSelectionUpdated,modifyRecord:this.props.modifyRecord,recordGetterByIndex:this.props.recordGetterByIndex,recordGetterById:this.props.recordGetterById,updateRecords:this.props.updateRecords,paste:this.props.paste,editMobileCell:this.props.editMobileCell,frozenColumnsWidth:this.props.frozenColumnsWidth,selectNone:this.selectNone,getVisibleIndex:this.getVisibleIndex,onHitBottomBoundary:this.onHitBottomCanvas,onHitTopBoundary:this.onHitTopCanvas,onCellClick:this.onCellClick,scrollToColumn:this.scrollToColumn,setRecordsScrollLeft:this.props.setRecordsScrollLeft,gridUtils:this.props.gridUtils,getCopiedRecordsAndColumnsFromRange:this.props.getCopiedRecordsAndColumnsFromRange,modifyColumnData:this.props.modifyColumnData,getTableCanvasContainerRect:this.props.getTableCanvasContainerRect}),(0,s.jsx)("div",{className:"sf-metadata-result-table",style:{width:this.props.totalWidth+h.sN},ref:this.setResultRef,children:this.renderRecords()})]}),(0,s.jsx)(J,{table:this.props.table,ref:this.setRightScrollbar,onScrollbarScroll:this.onScrollbarScroll,onScrollbarMouseUp:this.onScrollbarMouseUp})]})}}])}(o.Component);an.defaultProps={editorPortalTarget:document.body,scrollToRowIndex:0};var sn=an,ln=function(e){var t=e.column,n=e.cellValue,r=e.originalCellValue,a=(0,o.useMemo)((function(){return"(".concat((0,i.AP)("Empty"),")")}),[]),c=(0,o.useMemo)((function(){return(0,i.AP)("Deleted option")}),[]),u=(0,o.useCallback)((function(){switch(t.type){case m.vZe.CREATOR:case m.vZe.LAST_MODIFIER:return r?(0,s.jsx)(se,{value:r,field:t}):a;case m.vZe.NUMBER:return n||0===n?n:a;case m.vZe.COLLABORATOR:return Array.isArray(n)&&0!==n.length?(0,s.jsx)(se,{value:n,field:t}):a;case m.vZe.CHECKBOX:return(0,s.jsx)("input",{className:"checkbox",type:"checkbox",readOnly:!0,checked:n});case m.vZe.SINGLE_SELECT:var e=(0,m.FiT)(t);if(0===e.length||!r)return a;var o=(0,m.om8)(e,r),i=o?{backgroundColor:o.color,color:o.textColor}:{backgroundColor:h.lX},u=o?o.name:c;return(0,s.jsx)("div",{className:"sf-metadata-single-select-option",style:i,title:u,children:u},n);case m.vZe.MULTIPLE_SELECT:var d=(0,m.FiT)(t);if(0===d.length||!Array.isArray(r)||0===r.length)return a;var p=d.filter((function(e){return r.includes(e.id)||r.includes(e.name)})),f=r.filter((function(e){return e&&!d.find((function(t){return t.id===e||t.name===e}))})).map((function(e){return{id:e,name:c,color:h.lX}}));return(0,s.jsxs)(s.Fragment,{children:[p.map((function(e){var t={backgroundColor:e.color,color:e.textColor};return(0,s.jsx)("div",{className:"sf-metadata-multiple-select-option",style:t,title:e.name,children:e.name},e.id)})),f.map((function(e){var t={backgroundColor:e.color};return(0,s.jsx)("div",{className:"sf-metadata-multiple-select-option",style:t,title:e.name,children:e.name},e.id)}))]});case m.vZe.RATE:var g=t.data||{},v=g.color,y=g.type||"rate";if(!n||!v)return a;for(var C=[],A=0;A<n;A++)C.push((0,s.jsx)(l.Oi,{style:{fill:v,height:16,width:16},iconName:y,className:"sf-metadata-group-title-rate-item"},A));return C;default:return n||a}}),[t,n,r,a,c]);return(0,s.jsxs)("div",{className:"group-title",children:[(0,s.jsx)("div",{className:"group-column-name",children:t.name}),(0,s.jsx)("div",{className:"group-cell-value",children:u()})]})},cn=function(e){function t(){return(0,C.A)(this,t),(0,x.A)(this,t,arguments)}return(0,b.A)(t,e),(0,A.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.isExpanded,r=t.firstColumnFrozen,o=t.lastColumnFrozen,a=t.firstColumnKey,c=t.maxLevel,u=t.group,d=t.width,p=u.column,f=u.count,g=u.level,v=u.cell_value,C=u.original_cell_value,A={zIndex:r&&m.Mue.dg,height:h.q$,width:d};return(0,s.jsxs)("div",{ref:function(t){return e.groupHeaderLeft=t},className:y()("group-header-left group-header-cell",{"table-last--frozen":o}),style:A,"data-column_key":a,children:[(0,s.jsx)(l.Oi,{className:y()("group-toggle-btn",{hide:!n}),iconName:"drop-down",onClick:this.props.onExpandGroupToggle}),(0,s.jsx)(ln,{column:p||{},originalCellValue:C,cellValue:v}),(0,s.jsx)("div",{className:"group-rows-count",children:(0,s.jsxs)("div",{className:"group-rows-count-content",children:[g===c&&(0,s.jsx)("span",{className:"count-title",children:(0,i.AP)("Count")}),(0,s.jsx)("span",{className:"count-num",children:f})]})})]})}}])}(o.Component),un=cn,dn=function(e){function t(){var e;(0,C.A)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=(0,x.A)(this,t,[].concat(r))).fixedFrozenDOMs=function(t,n){e.leftContainer&&(e.leftContainer.style.position="fixed",e.leftContainer.style.marginLeft="0px",e.leftContainer.style.marginTop=-n+"px")},e.setContainerRef=function(t){e.leftContainer=t},e.cancelFixFrozenDOMs=function(t){e.leftContainer&&(e.leftContainer.style.position="absolute",e.leftContainer.style.marginLeft=t+"px",e.leftContainer.style.marginTop="0px")},e}return(0,b.A)(t,e),(0,A.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.isExpanded,r=t.maxLevel,o=t.group,a=t.formulaRow,i=t.leftPaneWidth,l=t.height,c=t.firstColumnFrozen,u=t.lastColumnFrozen,d=t.firstColumnKey,p={zIndex:c?m.Mue.dg:0,width:i,height:l};return(0,s.jsx)("div",{className:"group-container group-container-left",style:p,ref:this.setContainerRef,children:(0,s.jsx)(un,{ref:function(t){return e.leftHeader=t},isExpanded:n,firstColumnFrozen:c,lastColumnFrozen:u,firstColumnKey:d,width:i,maxLevel:r,group:o,formulaRow:a,onExpandGroupToggle:this.props.onExpandGroupToggle})})}}])}(o.Component),pn=dn,fn=function(e){function t(){var e;(0,C.A)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=(0,x.A)(this,t,[].concat(r))).fixedFrozenDOMs=function(t,n){if(e.headerCell){var r=e.props,o=r.firstColumnWidth,a=r.groupOffsetLeft;e.headerCell.style.position="fixed",e.headerCell.style.marginLeft=h.sN+o+a+"px",e.headerCell.style.marginTop=-n+"px"}},e.cancelFixFrozenDOMs=function(t){e.headerCell&&(e.headerCell.style.position="absolute",e.headerCell.style.marginLeft=t+"px",e.headerCell.style.marginTop=0)},e.getStyle=function(){var t=e.props,n=t.offsetLeft,r=t.column,o=t.isExpanded,a={position:"absolute",width:r.width,height:h.q$-(o?1:2),left:n};return(0,G.Zz)(r)&&(a.zIndex=m.Mue.dg),a},e}return(0,b.A)(t,e),(0,A.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.column,r=t.isLastFrozenColumn;return(0,s.jsx)("div",{ref:function(t){return e.headerCell=t},className:y()("summary-item group-header-cell",{"table-last--frozen":r}),style:this.getStyle(),"data-column_key":n.key})}}])}(o.PureComponent),hn=fn,mn=function(e){function t(){var e;(0,C.A)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=(0,x.A)(this,t,[].concat(r))).headerCells={},e.setHeaderCellRef=function(t){return function(n){e.headerCells[t]=n}},e.fixedFrozenDOMs=function(t,n){e.props.columns.forEach((function(r){var o=e.headerCells[r.key];(0,G.Zz)(r)&&o&&o.fixedFrozenDOMs(t,n)}))},e.cancelFixFrozenDOMs=function(t){e.props.columns.forEach((function(n){var r=e.headerCells[n.key];(0,G.Zz)(n)&&r&&r.cancelFixFrozenDOMs(t)}))},e.getGroupSummaries=function(){var t=e.props,n=t.group,r=t.isExpanded,o=t.columns,a=t.groupOffsetLeft,i=t.lastFrozenColumnKey,l=t.summaryConfigs,c=o.slice(1),u=o[0]?o[0].width:0,d=0;return c.map((function(t,o){var p=t.key,f=l&&l[p]?l[p]:"Sum",h=n.summaries[p];return 0!==o&&(d+=c[o-1].width),(0,s.jsx)(hn,{ref:e.setHeaderCellRef(p),firstColumnWidth:u,groupOffsetLeft:a,isLastFrozenColumn:p===i,offsetLeft:d,column:t,isExpanded:r,summary:h,summaryMethod:f},p)}))},e}return(0,b.A)(t,e),(0,A.A)(t,[{key:"render",value:function(){return(0,s.jsx)("div",{className:"group-header-right",style:{height:h.q$},children:this.getGroupSummaries()})}}])}(o.Component),gn=mn,vn=function(e){function t(){var e;(0,C.A)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=(0,x.A)(this,t,[].concat(r))).fixedFrozenDOMs=function(t,n){e.rightHeader&&e.rightHeader.fixedFrozenDOMs(t,n)},e.cancelFixFrozenDOMs=function(t){e.rightHeader&&e.rightHeader.cancelFixFrozenDOMs(t)},e}return(0,b.A)(t,e),(0,A.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.group,r=t.isExpanded,o=t.columns,a=t.summaryConfigs,i=t.rightPaneWidth,l=t.leftPaneWidth,c=t.height,u=t.groupOffsetLeft,d=t.lastFrozenColumnKey,p={left:l,width:i,height:c};return(0,s.jsx)("div",{className:"group-container group-container-right",style:p,children:(0,s.jsx)(gn,{ref:function(t){return e.rightHeader=t},groupOffsetLeft:u,lastFrozenColumnKey:d,group:n,isExpanded:r,columns:o,summaryConfigs:a})})}}])}(o.Component),yn=vn,Cn=function(e){function t(){var e;(0,C.A)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=(0,x.A)(this,t,[].concat(r))).fixedFrozenDOMs=function(t,n){e.backDrop&&(e.backDrop.style.position="fixed",e.backDrop.style.marginLeft="0px",e.backDrop.style.marginTop=-n+"px"),e.leftContainer&&e.leftContainer.fixedFrozenDOMs(t,n),e.rightContainer&&e.rightContainer.fixedFrozenDOMs(t,n)},e.cancelFixFrozenDOMs=function(t){e.backDrop&&(e.backDrop.style.position="absolute",e.backDrop.style.marginLeft=t-h.ax+"px",e.backDrop.style.marginTop="0px"),e.leftContainer&&e.leftContainer.cancelFixFrozenDOMs(t),e.rightContainer&&e.rightContainer.cancelFixFrozenDOMs(t)},e.setContainer=function(t){e.group=t},e.setBackDrop=function(t){e.backDrop=t},e.onExpandGroupToggle=function(){var t=e.props.groupPathString;e.props.onExpandGroupToggle(t)},e}return(0,b.A)(t,e),(0,A.A)(t,[{key:"shouldComponentUpdate",value:function(e){return e.groupPathString!==this.props.groupPathString||e.group!==this.props.group||e.width!==this.props.width||e.height!==this.props.height||e.top!==this.props.top||e.columns!==this.props.columns||e.rowHeight!==this.props.rowHeight||e.isExpanded!==this.props.isExpanded||e.scrollLeft!==this.props.scrollLeft||e.lastFrozenColumnKey!==this.props.lastFrozenColumnKey||e.summaryConfigs!==this.props.summaryConfigs}},{key:"componentDidMount",value:function(){this.props.lastFrozenColumnKey&&!i.Fr&&this.checkScroll()}},{key:"checkScroll",value:function(){var e=this.props.scrollLeft;this.cancelFixFrozenDOMs(e)}},{key:"render",value:function(){var e=this,t=this.props,n=t.group,r=t.columns,o=t.width,a=t.isExpanded,i=t.folding,l=t.summaryConfigs,c=t.height,u=t.backdropHeight,d=t.top,p=t.groupOffsetLeft,f=t.lastFrozenColumnKey,g=t.maxLevel,v=n.left,C=n.level,A=1===C,x=y()("group-item","group-level-".concat(C),a?"expanded-group":"folded-group",i?"folding":""),b=r[0]||{},_=(0,G.Zz)(b),w=b.width||0,S=h.sN+w+(A?0:(C-1)*h.ax-1),D=o-S,E={height:c,width:o,top:d,left:v},k={height:u,width:S+h.ax,zIndex:m.Mue.rW};return(0,s.jsxs)("div",{className:x,ref:this.setContainer,style:E,children:[C===g&&_&&(0,s.jsx)("div",{className:"group-backdrop",ref:this.setBackDrop,style:k}),(0,s.jsx)(pn,{ref:function(t){return e.leftContainer=t},group:n,firstColumnFrozen:_,lastColumnFrozen:b.key===f,leftPaneWidth:S,height:c,isExpanded:a,firstColumnKey:b.key,maxLevel:g,onExpandGroupToggle:this.onExpandGroupToggle}),(0,s.jsx)(yn,{ref:function(t){return e.rightContainer=t},group:n,isExpanded:a,leftPaneWidth:S,rightPaneWidth:D,height:c,groupOffsetLeft:p,lastFrozenColumnKey:f,columns:r,summaryConfigs:l})]})}}])}(o.Component),An=Cn,xn=["startRenderIndex","endRenderIndex"],bn="path_folded_group",_n=Math.max,wn=Math.min,Sn=function(e){function t(e){var n;(0,C.A)(this,t),(n=(0,x.A)(this,t,[e])).getShownRecords=function(){var e=n.state,t=e.startRenderIndex,r=e.endRenderIndex,o=e.groupMetrics;return n.getVisibleGroupRecords(t,r,o.groupRows).map((function(e){return n.props.recordGetterById(e.rowId)})).filter((function(e){return!!e}))},n.getGroupVisibleBoundaries=function(e,t,n,r){var o=n.groupRows,a=n.groupRowsHeight,i=n.maxLevel;if(!Array.isArray(o)||0===o.length)return{startRenderIndex:0,endRenderIndex:0};for(var s=0,l=0,c=h.q$*i+10*r,u=h.q$*i+10*r,d=_n(0,t-c),p=wn(a,t+e+u),f=o.length,m=0;m<f;m++){var g=o[m].top;g<=d&&s++,g<=p&&l++}return{startRenderIndex:s,endRenderIndex:l}},n.setGroupNode=function(e){return function(t){n.groupsNode[e]=t}},n.setResultContentRef=function(e){n.resultContentRef=e},n.setInteractionMaskRef=function(e){n.interactionMask=e},n.setResultRef=function(e){n.resultRef=e},n.setScrollTop=function(e){n.resultContentRef.scrollTop=e},n.setScrollLeft=function(e,t){n.interactionMask&&n.interactionMask.setScrollLeft(e,t)},n.cancelSetScrollLeft=function(){n.interactionMask&&n.interactionMask.cancelSetScrollLeft()},n.setRightScrollbar=function(e){n.rightScrollbar=e},n.setColumnVisibleEnd=function(){for(var e=n.props,t=e.columns,r=e.getScrollLeft,o=0,a=(0,e.getTableContentRect)().width+r(),i=0;i<t.length;i++){if((a-=t[i].width)<0)return i}return o},n.getScrollTop=function(){return n.resultContentRef?n.resultContentRef.scrollTop:0},n.getRowHeight=function(){return 33},n.getRowTop=function(e){var t=n.state.groupMetrics,r=Ee(e,t);return r&&r.top||0},n.jumpToRow=function(e){var t=n.state.groupMetrics,r=n.resultContentRef.offsetHeight,o=n.getRowTop(e),a=Math.min(o,t.groupRowsHeight-r);n.setScrollTop(a)},n.scrollToColumn=function(e){var t=n.props,r=t.columns,o=(0,t.getTableContentRect)().width,a=Zt(r,e,o);null!==a&&n.props.setRecordsScrollLeft(a),n.updateColVisibleIndex(a)},n.updateColVisibleIndex=function(e){var t=n.props.columns,r=$t(t,e),o=Jt(t,window.innerWidth,e);n.columnVisibleStart=r,n.columnVisibleEnd=o},n.getRecordBodyHeight=function(){return n.resultContentRef?n.resultContentRef.offsetHeight:0},n.updateViewableArea=function(e){var t=e.cursorCell.mousePosition,r=t.x,o=t.y,a=100;if(r+a>window.innerWidth)n.scrollToRight();else if(r-a<h.sN+n.props.frozenColumnsWidth)n.scrollToLeft();else if(o+a>window.innerHeight-130){var i=n.getScrollTop();n.resultContentRef.scrollTop=i+8,n.clearHorizontalScroll()}else if(o-a<130){var s=n.getScrollTop();s-16>=0&&(n.resultContentRef.scrollTop=s-8),n.clearHorizontalScroll()}else n.clearHorizontalScroll()},n.scrollToRight=function(){n.scrollTimer||(n.scrollTimer=setInterval((function(){var e=n.props.getScrollLeft();n.props.setRecordsScrollLeft(e+20)}),10))},n.scrollToLeft=function(){n.scrollTimer||(n.scrollTimer=setInterval((function(){var e=n.props.getScrollLeft();e<=0?n.clearHorizontalScroll():n.props.setRecordsScrollLeft(e-20)}),10))},n.clearHorizontalScroll=function(){n.scrollTimer&&(clearInterval(n.scrollTimer),n.scrollTimer=null)},n.clearScrollbarTimer=function(){n.scrollbarTimer&&(clearTimeout(n.scrollbarTimer),n.scrollbarTimer=null)},n.getCellMetaData=function(){return n.cellMetaData||(n.cellMetaData={onCellClick:n.onCellClick,onCellDoubleClick:n.onCellDoubleClick,onCellMouseDown:n.onCellMouseDown,onCellMouseEnter:n.onCellMouseEnter,onCellMouseMove:n.onCellMouseMove,onDragEnter:n.handleDragEnter,modifyRecord:n.props.modifyRecord,onCellContextMenu:n.onCellContextMenu}),n.cellMetaData},n.handleDragEnter=function(e){var t=e.overRecordIdx,n=e.overGroupRecordIndex;window.sfMetadataContext.eventBus.dispatch(h.Tw.DRAG_ENTER,{overRecordIdx:t,overGroupRecordIndex:n})},n.getGroupMetrics=function(){return n.state.groupMetrics},n.getGroupRecordByIndex=function(e){var t=n.getGroupMetrics();return Ee(e,t)},n.fixFrozenDoms=function(e,t){((0,G.Zz)(n.props.columns[0])||0!==e)&&Object.keys(n.groupsNode).forEach((function(r){var o=n.groupsNode[r];o&&o.fixedFrozenDOMs(e,t)}))},n.cancelFixFrozenDOMs=function(e){((0,G.Zz)(n.props.columns[0])||0!==e)&&n.groupsNode&&Object.keys(n.groupsNode).forEach((function(t){var r=n.groupsNode[t];r&&r.cancelFixFrozenDOMs(e)}))},n.onResize=function(){var e=window.innerHeight;if(e){var t=n.resultContentRef.scrollTop,r=n.getRowHeight();n.updateScroll({gridHeight:e,scrollTop:t,rowHeight:r})}},n.onScroll=function(){var e=n.resultContentRef,t=e.offsetHeight,r=e.scrollTop;n.oldScrollTop=r,n.props.cacheScrollTop(r),n.updateScroll({scrollTop:r}),t+r>=n.resultContentRef.scrollHeight&&n.props.scrollToLoadMore(),n.isScrollingRightScrollbar||n.setRightScrollbarScrollTop(n.oldScrollTop),n.clearScrollbarTimer(),n.scrollbarTimer=setTimeout((function(){n.setState({isScrollingRightScrollbar:!1})}),300)},n.setRightScrollbarScrollTop=function(e){n.rightScrollbar&&n.rightScrollbar.setScrollTop(e)},n.onScrollbarScroll=function(e){n.oldScrollTop!==e&&n.setState({isScrollingRightScrollbar:!0},(function(){n.setScrollTop(e)}))},n.onScrollbarMouseUp=function(){n.setState({isScrollingRightScrollbar:!1})},n.onCellClick=function(e,t){var r=n.state.selectedPosition;if(Le(t)){if(!r||-1===r.idx)return void n.selectCell(e,!1);n.selectUpdate(e,!0)}else{var o=n.props.columns,a=(0,G.Hs)(e,o),i=Te(e,o,!0,n.props.recordGetterByIndex);n.selectCell(e,a&&i)}n.props.onCellClick(e),n.setState({selectedPosition:e})},n.onCellDoubleClick=function(e,t){var r=n.props.columns,o=(0,G.wo)(e,r),a=Te(e,r,!0,n.props.recordGetterByIndex);n.selectCell(e,o&&a)},n.onCellMouseDown=function(e,t){Le(t)||(n.selectCell(e),n.selectStart(e),window.addEventListener("mouseup",n.onWindowMouseUp))},n.onCellMouseEnter=function(e){n.selectUpdate(e,!1,n.updateViewableArea)},n.onCellMouseMove=function(e){n.selectUpdate(e,!1,n.updateViewableArea)},n.onCellContextMenu=function(e){n.props.onCellContextMenu(e)},n.onWindowMouseUp=function(e){window.removeEventListener("mouseup",n.onWindowMouseUp),Le(e)||(n.selectEnd(),n.clearHorizontalScroll())},n.onCellRangeSelectionUpdated=function(e){n.props.onCellRangeSelectionUpdated(e)},n.selectNoneCells=function(){n.interactionMask&&n.interactionMask.selectNone();var e=n.state.selectedPosition;!e||e.idx<0||e.rowIdx<0||n.selectNone()},n.selectNone=function(){n.setState({selectedPosition:{idx:-1,rowIdx:-1,groupRecordIndex:-1}})},n.selectCell=function(e,t){window.sfMetadataContext.eventBus.dispatch(h.Tw.SELECT_CELL,e,t)},n.selectStart=function(e){window.sfMetadataContext.eventBus.dispatch(h.Tw.SELECT_START,e)},n.selectUpdate=function(e,t,n){window.sfMetadataContext.eventBus.dispatch(h.Tw.SELECT_UPDATE,e,t,n)},n.selectEnd=function(){window.sfMetadataContext.eventBus.dispatch(h.Tw.SELECT_END)},n.onCloseContextMenu=function(){n.setState({isContextMenuShow:!1,menuPosition:null,activeRecords:[]})},n.getNextScrollState=function(e){var t=e.gridHeight,r=e.scrollTop,o=e.rowHeight,a=e.groupMetrics,i=e.pathFoldedGroupMap,s=t||window.innerHeight,l=o||n.getRowHeight(),c=a||n.state.groupMetrics,u=i||n.state.pathFoldedGroupMap,d=n.getGroupVisibleBoundaries(s,r,c,l);return{startRenderIndex:d.startRenderIndex,endRenderIndex:d.endRenderIndex,groupMetrics:c,pathFoldedGroupMap:u}},n.updateScroll=function(e){var t=e.startRenderIndex,r=e.endRenderIndex,o=(0,g.A)(e,xn),a=n.getNextScrollState(o);return t&&r&&(a.startRenderIndex=t,a.endRenderIndex=r),n.setState(a),a},n.isParentGroupContainer=function(e,t){var n=e.groupPath,r=e.level,o=e.type,a=t.groupPath,i=t.level;return o===h.Gi.GROUP_CONTAINER&&r>i&&n[0]===a[0]},n.getPrevGroupContainers=function(e,t,r){if(!e)return[];var o=e.level,a=e.groupRecordIndex,i=e.type;if(0===a||o===r&&i===h.Gi.GROUP_CONTAINER)return[];for(var s=[],l=a-1;l>-1;){var c=t[l],u=c.type,d=c.level;if(u===h.Gi.GROUP_CONTAINER){if(o===r){s.push(c);break}if(n.isParentGroupContainer(c,e)&&s.unshift(c),d===r)break}l--}return s},n.getVisibleGroupRecords=function(e,t,r){var o=[],a=r[e],i=n.props.groupbys.length,s=n.getPrevGroupContainers(a,r,i);o.push.apply(o,(0,xe.A)(s));for(var l=e,c=[];l<=t;){var u=r[l];u&&u.visible&&(o.push(u),u.type===h.Gi.ROW&&c.push(u)),l++}return o},n.getFoldedGroups=function(){var e=window.sfMetadataContext.localStorage.getItem(bn);return e||{}},n.getVisibleIndex=function(){return{rowVisibleStartIdx:n.rowVisibleStart,rowVisibleEndIdx:n.rowVisibleEnd}},n.updateFoldedGroups=function(e){window.sfMetadataContext.localStorage.setItem(bn,e),n.selectNoneCells()},n.collapseAllGroups=function(){var e=n.state.groupMetrics.groupRows,t={};e.forEach((function(e){var n=e.type,r=e.groupPathString;n===h.Gi.GROUP_CONTAINER&&(t[r]=!0)})),n.updateFoldedGroups(t);var r=n.props,o=r.groups,a=r.groupbys,i=r.allColumns,s=n.getRowHeight(),l=n.resultContentRef.scrollTop,c=be(o,a,t,i,s,!1);n.updateScroll({scrollTop:l,rowHeight:s,groupMetrics:c})},n.expandAllGroups=function(){var e={};n.updateFoldedGroups(e);var t=n.props,r=t.groups,o=t.groupbys,a=t.allColumns,i=n.resultContentRef.scrollTop,s=n.getRowHeight(),l=be(r,o,e,a,s,!1);n.updateScroll({scrollTop:i,rowHeight:s,groupMetrics:l})},n.onExpandGroupToggle=function(e){var t=n.state,o=t.groupMetrics,a=t.pathFoldedGroupMap,i=o.groupRows,s=o.maxLevel,l=i.find((function(t){return t.groupPathString===e&&t.type===h.Gi.GROUP_CONTAINER}));if(l){var c=l.groupRecordIndex,u=l.groupPath,d=l.height,p=l.isExpanded,f=(0,r.A)({},a);p?f[e]=!0:delete f[e];var m=n.props,g=m.groups,v=m.groupbys,y=m.allColumns,C=n.resultContentRef.scrollTop,A=n.getRowHeight(),x=be(g,v,f,y,A,!1);if(l.count>=50)return n.forbidRecordsAnimation(),n.updateFoldedGroups(f),void n.updateScroll({scrollTop:C,rowHeight:A,groupMetrics:x,pathFoldedGroupMap:f});var b,_=n.getGroupVisibleBoundaries(window.innerHeight,C,x,A),w=_.startRenderIndex,S=_.endRenderIndex;if(p){var D=(b=o).groupRows;if(s>1)for(var E=-(d-h.q$),k=c-1;k>-1;k--){var M=D[k],I=M.groupPath;if(n.isParentGroupContainer(M,l)&&(M.height=M.height+E),I[0]!==u[0])break}for(var N=c+1;N<D.length;N++){var P=D[N],T=P.groupPath;if(De(P,l)&&(P.visible=!1),T[0]!==u[0])break}D[c]=(0,r.A)((0,r.A)({},D[c]),{},{isExpanded:!1,height:h.q$})}else for(var O=(b=x).groupRows,j=l.top+h.q$,R=c+1;R<O.length;R++){var L=O[R],F=L.groupPath;if(De(L,l)&&(L.height=0,L.top=j),F[0]!==u[0])break}n.expandingGroupPathString=e,n.nextPathFoldedGroupMap=f,n.setState({groupMetrics:b,startRenderIndex:w,endRenderIndex:S}),n.updateFoldedGroups(f)}},n.forbidRecordsAnimation=function(){n.disabledAnimation=!0;var e=n.groupRows.className,t=(0,i.SW)(e,"animation");t!==e&&(n.groupRows.className=t)},n.ableRecordsAnimation=function(){n.disabledAnimation=!1;var e=n.groupRows.className,t=(0,i.B$)(e,"animation");t!==e&&(n.groupRows.className=t)},n.openDownloadFilesDialog=function(){var e=n.state,t=e.column,r=e.activeRecords;n.props.cacheDownloadFilesProps(t,r),n.props.openDownloadFilesDialog()},n.checkSupportDownloadFiles=function(){var e=n.state.column,t=n.interactionMask.getSelectedPosition(),r=t.left;return!(t.right>r)&&(e.type===m.vZe.FILE||e.type===m.vZe.IMAGE)},n.renderGroups=function(){var e=n.props,t=e.totalWidth,r=e.containerWidth,o=e.columns,a=e.colOverScanStartIdx,i=e.colOverScanEndIdx,l=e.groupOffsetLeft,c=e.recordMetrics,u=e.summaryConfigs,d=e.lastFrozenColumnKey,p=e.showCellColoring,f=e.columnColors;n.recordFrozenRefs=[];var m=t+h.sN,g=n.state,v=g.startRenderIndex,C=g.endRenderIndex,A=g.groupMetrics,x=g.selectedPosition,b=A.groupRows,_=A.maxLevel,w=n.props.getScrollLeft(),S=n.getCellMetaData(),D=n.getVisibleGroupRecords(v,C,b),E=[],k=o.length,M=o[k-1],I=A.groupRowsHeight;D.forEach((function(e){var t=e.type,r=e.level,g=e.key,v=e.left,y=e.top,C=e.isExpanded,A=e.height,b=e.groupPathString,D=e.groupRecordIndex;if(t===h.Gi.GROUP_CONTAINER){var k=m+2*(r-1)*h.ax,M=n.expandingGroupPathString===b&&!C,I=A+h.ax;E.push((0,s.jsx)(An,{ref:n.setGroupNode(b),groupPathString:b,group:e,height:A,backdropHeight:I,width:k,top:y,maxLevel:_,groupOffsetLeft:l,scrollLeft:w,columns:o,summaryConfigs:u,isExpanded:C,folding:M,lastFrozenColumnKey:d,onExpandGroupToggle:n.onExpandGroupToggle},g))}else if(t===h.Gi.ROW){var N=e.rowId,P=e.rowIdx,T=e.isLastRow,O=N&&n.props.recordGetterById(N),j=Je.isRecordSelected(N,c),R=n.props.hasSelectedCell({groupRecordIndex:D},x),L=p?f[N]:{};if(!O)return;E.push((0,s.jsx)(ye,{isGroupView:!0,ref:function(e){n.recordFrozenRefs.push(e)},isSelected:j,groupRecordIndex:D,index:P,isLastRecord:T,lastFrozenColumnKey:d,record:O,columns:o,colOverScanStartIdx:a,colOverScanEndIdx:i,left:v,top:y,height:A,scrollLeft:w,cellMetaData:S,searchResult:n.props.searchResult,hasSelectedCell:R,selectedPosition:n.state.selectedPosition,selectNoneCells:n.selectNoneCells,onSelectRecord:n.props.onSelectRecord,modifyRecord:n.props.modifyRecord,lockRecordViaButton:n.props.lockRecordViaButton,modifyRecordViaButton:n.props.modifyRecordViaButton,reloadRecords:n.props.reloadRecords,columnColor:L},N||P))}}));var N=d===M.key,P=y()("canvas-groups-rows","animation",{"single-column":(0,G.Ax)(M),"disabled-add-record":!0,"all-columns-frozen":N,frozen:N||!!d}),T={height:I,width:r+(2*(_-1)+1)*h.ax};return(0,s.jsx)("div",{className:P,style:T,ref:function(e){return n.groupRows=e},children:E})};var o=e.groups,a=e.groupbys,l=e.allColumns,c=n.getRowHeight(),u=n.getFoldedGroups(),d=be(o,a,u,l,c,!1),p=n.getGroupVisibleBoundaries(window.innerHeight,0,d,c),f=p.startRenderIndex,v=p.endRenderIndex;return n.state={isContextMenuShow:!1,activeRecords:[],menuPosition:null,groupMetrics:d,startRenderIndex:f,endRenderIndex:v,pathFoldedGroupMap:u,isScrollingRightScrollbar:!1,selectedPosition:null},n.groupsNode={},n.recordFrozenRefs=[],n.rowVisibleStart=f,n.rowVisibleEnd=v,n.columnVisibleStart=0,n.columnVisibleEnd=n.setColumnVisibleEnd(),n.disabledAnimation=!1,n.nextPathFoldedGroupMap=null,n}return(0,b.A)(t,e),(0,A.A)(t,[{key:"componentDidMount",value:function(){window.sfMetadataBody=this,window.addEventListener("resize",this.onResize),this.props.onRef(this),this.unSubscribeCollapseAllGroups=window.sfMetadataContext.eventBus.subscribe(h.Tw.COLLAPSE_ALL_GROUPS,this.collapseAllGroups),this.unSubscribeExpandAllGroups=window.sfMetadataContext.eventBus.subscribe(h.Tw.EXPAND_ALL_GROUPS,this.expandAllGroups)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.groupbys,r=t.groups,o=t.allColumns,a=t.searchResult,i=this.resultContentRef.scrollTop,s=this.getRowHeight();if(n!==e.groupbys||r!==e.groups||a!==e.searchResult){var l=window.innerHeight,c=(a||{}).matchedCells,u=Array.isArray(c)&&c.length>0?{}:this.getFoldedGroups(),d=be(r,n,u,o,s,!1);this.updateScroll({gridHeight:l,scrollTop:i,groupMetrics:d,rowHeight:s})}if(this.disabledAnimation&&this.ableRecordsAnimation(),this.expandingGroupPathString){var p=be(r,n,this.nextPathFoldedGroupMap,o,s,!1);this.updateScroll({scrollTop:i,groupMetrics:p,pathFoldedGroupMap:this.nextPathFoldedGroupMap}),this.expandingGroupPathString=null,this.nextPathFoldedGroupMap=null}}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onResize),this.unSubscribeCollapseAllGroups(),this.unSubscribeExpandAllGroups(),this.clearHorizontalScroll(),this.clearScrollbarTimer(),this.setState=function(e,t){}}},{key:"render",value:function(){return(0,s.jsxs)(o.Fragment,{children:[(0,s.jsxs)("div",{id:"group-canvas",className:"sf-metadata-result-table-content",ref:this.setResultContentRef,onScroll:this.onScroll,children:[(0,s.jsx)(Kt,{isGroupView:!0,ref:this.setInteractionMaskRef,contextMenu:this.props.contextMenu,table:this.props.table,columns:this.props.columns,recordsCount:this.props.recordsCount,recordMetrics:this.props.recordMetrics,groups:this.props.groups,groupMetrics:this.state.groupMetrics,rowHeight:this.getRowHeight(),groupOffsetLeft:this.props.groupOffsetLeft,scrollTop:this.oldScrollTop,getRowTop:this.getRowTop,getScrollLeft:this.props.getScrollLeft,getTableContentRect:this.props.getTableContentRect,getMobileFloatIconStyle:this.props.getMobileFloatIconStyle,onToggleMobileMoreOperations:this.props.onToggleMobileMoreOperations,onToggleInsertRecordDialog:this.props.onToggleInsertRecordDialog,editorPortalTarget:this.props.editorPortalTarget,onCellRangeSelectionUpdated:this.onCellRangeSelectionUpdated,modifyRecord:this.props.modifyRecord,recordGetterByIndex:this.props.recordGetterByIndex,recordGetterById:this.props.recordGetterById,updateRecords:this.props.updateRecords,paste:this.props.paste,editMobileCell:this.props.editMobileCell,frozenColumnsWidth:this.props.frozenColumnsWidth,selectNone:this.selectNone,onCellClick:this.onCellClick,getVisibleIndex:this.getVisibleIndex,getGroupCanvasScrollTop:this.getScrollTop,setGroupCanvasScrollTop:this.setScrollTop,scrollToColumn:this.scrollToColumn,setRecordsScrollLeft:this.props.setRecordsScrollLeft,gridUtils:this.props.gridUtils,getCopiedRecordsAndColumnsFromRange:this.props.getCopiedRecordsAndColumnsFromRange,modifyColumnData:this.props.modifyColumnData,getTableCanvasContainerRect:this.props.getTableCanvasContainerRect}),(0,s.jsx)("div",{className:"sf-metadata-result-table",ref:this.setResultRef,children:this.renderGroups()})]}),(0,s.jsx)(J,{table:this.props.table,ref:this.setRightScrollbar,onScrollbarScroll:this.onScrollbarScroll,onScrollbarMouseUp:this.onScrollbarMouseUp})]})}}])}(o.Component);Sn.defaultProps={editorPortalTarget:document.body,scrollToRowIndex:0};var Dn=Sn,En=function(e){function t(){var e;(0,C.A)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=(0,x.A)(this,t,[].concat(r))).onClick=function(){f.A.closeAll(),e.props.load(1e5)},e}return(0,b.A)(t,e),(0,A.A)(t,[{key:"render",value:function(){return(0,s.jsxs)("div",{className:"load-all-tip",children:[(0,s.jsx)("span",{children:(0,F.AP)("Loaded 50,000 records.")}),(0,s.jsx)("div",{className:"load-all ml-2",onClick:this.onClick,children:(0,F.AP)("Click to load more")})]})}}])}(o.Component),kn=En,Mn=function(e){function t(){var e;(0,C.A)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=(0,x.A)(this,t,[].concat(r))).ref=null,e.calculateAtBorder=function(){var t,n=e.ref.getBoundingClientRect().bottom,r=e.ref?e.ref.className:"";(t=n>=window.innerHeight?(0,i.B$)(r,"at-border"):(0,i.SW)(r,"at-border"))!==r&&e.ref&&(e.ref.className=t)},e.onClick=function(){if(!e.props.isLoadingMore){var t=e.props.recordsCount<5e4?5e4:1e5;e.props.loadAll(t,(function(t){t?f.A.success((0,s.jsx)(kn,{load:e.props.loadAll}),{duration:5}):f.A.success((0,F.AP)("All records loaded"))}))}},e.setSummaryScrollLeft=function(t){e.summaryItemsRef.scrollLeft=t},e.getSelectedCellsCount=function(e){var t=e.topLeft,n=e.bottomRight;return-1===t.rowIdx?0:(n.idx-t.idx+1)*(n.rowIdx-t.rowIdx+1)},e.getSummaries=function(){var t=e.props,n=t.isGroupView,r=t.hasSelectedRecord,o=t.recordMetrics,a=t.selectedRange,i=t.summaries,s=t.recordGetterByIndex;if(r){var l=Je.getSelectedIds(o),c=l&&l.map((function(t){return e.props.recordGetterById(t)})).filter(Boolean);return e.props.getRecordsSummaries(c)}if(e.getSelectedCellsCount(a)>1){var u=Oe({selectedRange:a,isGroupView:n,recordGetterByIndex:s});return e.props.getRecordsSummaries(u)}return i},e.getSummaryItems=function(){var t=e.props,n=t.columns,r=t.hasMore,o=t.isLoadingMore||r?n.slice(1,n.length):n,a=h.sN,i=Array.isArray(o)&&o.map((function(e,t){var n=e.width,r=e.key;return a+=n,(0,s.jsx)("div",{className:"summary-item",style:{width:n}},r)}));return{summaryItems:i,totalWidth:a}},e.getRecord=function(){var t=e.props,n=t.hasMore,r=t.hasSelectedRecord,o=t.recordMetrics,a=t.selectedRange,i=t.recordsCount;if(r){var s=Je.getSelectedIds(o).length;return s>1?(0,F.AP)("xxx records selected").replace("xxx",s):(0,F.AP)("1 record selected")}var l,c=e.getSelectedCellsCount(a);return c>1?(0,F.AP)("xxx cells selected").replace("xxx",c):(i>1?l=(0,F.AP)("xxx records").replace("xxx",i):1===i&&(l=(0,F.AP)("1 record")),n&&(l+=" +"),l)},e}return(0,b.A)(t,e),(0,A.A)(t,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.calculateAtBorder)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.calculateAtBorder)}},{key:"componentDidUpdate",value:function(){this.calculateAtBorder()}},{key:"render",value:function(){var e=this,t=this.props,n=t.hasMore,r=t.isLoadingMore,o=t.columns,a=t.groupOffsetLeft,i=this.getSummaryItems(),c=i.summaryItems,u=i.totalWidth,d=(r||n?h.sN+o[0].width:h.sN)+a;return(0,s.jsxs)("div",{className:"sf-metadata-result-footer",style:{zIndex:m.Mue.Rc},ref:function(t){return e.ref=t},children:[(0,s.jsxs)("div",{className:"rows-record d-flex text-nowrap",style:{width:d},children:[(0,s.jsx)("span",{children:this.getRecord()}),!r&&n&&(0,s.jsx)("span",{className:"load-all ml-4",onClick:this.onClick,children:(0,F.AP)("Load all")}),r&&(0,s.jsxs)("span",{className:"loading-message ml-4",children:[(0,s.jsx)("span",{className:"mr-2",children:(0,F.AP)("Loading")}),(0,s.jsx)(l.Rh,{})]})]}),(0,s.jsx)("div",{className:"summaries-pane",children:(0,s.jsx)("div",{className:"summaries-scroll",ref:function(t){return e.summaryItemsRef=t},children:(0,s.jsx)("div",{style:{width:u+h.AD},children:c||""})})})]})}}])}(o.Component),In=Mn,Nn=n(43066),Pn="clear-selected",Tn="copy-selected",On="open-parent-folder",jn="open-new-tab",Rn="generate-description",Ln="image-caption",Fn=function(e){var t=e.isGroupView,n=e.selectedRange,r=e.selectedPosition,l=e.recordMetrics,u=e.recordGetterByIndex,d=e.onClearSelected,h=e.onCopySelected,g=e.updateRecords,v=e.getTableContentRect,y=e.getTableCanvasContainerRect,C=(0,o.useRef)(null),A=(0,o.useState)(!1),x=(0,p.A)(A,2),b=x[0],_=x[1],w=(0,o.useState)({top:0,left:0}),S=(0,p.A)(w,2),D=S[0],E=S[1],k=(0,a.p)().metadata,M=(0,o.useMemo)((function(){if(!b)return[];var e="r"===window.sfMetadataContext.getPermission(),o=k.columns,a=(0,m.rm3)(o,m.L2D.FILE_DESCRIPTION),s=window.sfMetadataContext.canModifyRow,c=[];if(n){if(!e&&c.push({value:Pn,label:(0,i.AP)("Clear selected")}),c.push({value:Tn,label:(0,i.AP)("Copy selected")}),a)for(var d=n.topLeft,p=n.bottomRight,f=d.rowIdx;f<=p.rowIdx;f++){var h=u({isGroupView:t,groupRecordIndex:d.groupRecordIndex,recordIndex:f}),g=h[m.L2D.FILE_NAME];if(ae.Aq.isDescriptionSupportedFile(g)&&s(h)){c.push({value:Rn,label:(0,i.AP)("Generate description")});break}}return c}var v=Object.keys(l.idSelectedRecordMap);if(v.length>1){if(a){var y=v.filter((function(e){var t=k.id_row_map[e];if(t){var n=t[m.L2D.FILE_NAME];return ae.Aq.isDescriptionSupportedFile(n)&&s(t)}return!1}));y.length>0&&c.push({value:Rn,label:(0,i.AP)("Generate description")})}return c}if(!r)return c;var C=r.groupRecordIndex,A=r.rowIdx,x=u({isGroupView:t,groupRecordIndex:C,recordIndex:A});if(!x)return c;var _=x[m.L2D.IS_DIR];if(c.push({value:jn,label:_?(0,i.AP)("Open folder in new tab"):(0,i.AP)("Open file in new tab")}),c.push({value:On,label:(0,i.AP)("Open parent folder")}),a){var w=x[m.L2D.FILE_NAME];ae.Aq.isDescriptionSupportedFile(w)&&s(x)?c.push({value:Rn,label:(0,i.AP)("Generate description")}):ae.Aq.imageCheck(w)&&s(x)&&c.push({value:Ln,label:(0,i.AP)("Generate image description")})}return c}),[b,t,r,l,n,k,u]),I=(0,o.useCallback)((function(e){C.current&&!C.current.contains(e.target)&&_(!1)}),[C]),N=(0,o.useCallback)((function(){var e=r.groupRecordIndex,n=r.rowIdx,o=u({isGroupView:t,groupRecordIndex:e,recordIndex:n});if(o){var a,i=window.sfMetadataStore.repoId,s=o[m.L2D.IS_DIR],l=o[m.L2D.PARENT_DIR],c=o[m.L2D.FILE_NAME];a=s?window.location.origin+window.location.pathname+ae.Aq.encodePath(ae.Aq.joinPath(l,c)):"".concat(F.Yc,"lib/").concat(i,"/file").concat(ae.Aq.encodePath(ae.Aq.joinPath(l,c))),window.open(a,"_blank")}}),[t,u,r]),P=(0,o.useCallback)((function(e){e.preventDefault(),e.stopPropagation();var n=r.groupRecordIndex,o=r.rowIdx,a=u({isGroupView:t,groupRecordIndex:n,recordIndex:o});if(a){var i=a[m.L2D.PARENT_DIR];window.location.pathname.endsWith("/")&&(i=i.slice(1));var s=window.location.origin+window.location.pathname+ae.Aq.encodePath(i);window.open(s,"_blank")}}),[t,u,r]),T=(0,o.useCallback)((function(){var e=window.sfMetadataContext.canModifyRow,n=m.L2D.FILE_DESCRIPTION,o="",a={},s={},l=r.groupRecordIndex,d=r.rowIdx,p=u({isGroupView:t,groupRecordIndex:l,recordIndex:d}),h=p[m.L2D.FILE_NAME];if(ae.Aq.isDescriptionSupportedFile(h)&&e(p)){var v=p[m.L2D.PARENT_DIR];o=ae.Aq.joinPath(v,h),a[p[m.L2D.ID]]=(0,c.default)({},n,p[n]),s[p[m.L2D.ID]]=(0,c.default)({},n,p[n])}""!==o&&window.sfMetadataContext.generateDescription(o).then((function(e){var t=e.data.summary,r=p[m.L2D.ID],o=[r],i={},l={};i[r]=(0,c.default)({},n,t),l[r]=(0,c.default)({},n,t),g({recordIds:o,idRecordUpdates:i,idOriginalRecordUpdates:l,idOldRecordData:a,idOriginalOldRecordData:s})})).catch((function(e){var t=(0,i.AP)("Failed to generate description");f.A.danger(t)}))}),[t,r,u,g]),O=(0,o.useCallback)((function(){var e=window.sfMetadataContext.canModifyRow,n=m.L2D.FILE_DESCRIPTION,o="",a={},s={},l=r.groupRecordIndex,d=r.rowIdx,p=u({isGroupView:t,groupRecordIndex:l,recordIndex:d}),h=p[m.L2D.FILE_NAME];if(ae.Aq.imageCheck(h)&&e(p)){var v=p[m.L2D.PARENT_DIR];o=ae.Aq.joinPath(v,h),a[p[m.L2D.ID]]=(0,c.default)({},n,p[n]),s[p[m.L2D.ID]]=(0,c.default)({},n,p[n])}""!==o&&window.sfMetadataContext.imageCaption(o).then((function(e){var t=e.data.desc,r=p[m.L2D.ID],o=[r],i={},l={};i[r]=(0,c.default)({},n,t),l[r]=(0,c.default)({},n,t),g({recordIds:o,idRecordUpdates:i,idOriginalRecordUpdates:l,idOldRecordData:a,idOriginalOldRecordData:s})})).catch((function(e){var t=(0,i.AP)("Failed to generate image description");f.A.danger(t)}))}),[t,r,u,g]),j=(0,o.useCallback)((function(e,t){switch(e.stopPropagation(),t.value){case jn:N();break;case On:P(e);break;case Tn:h&&h();break;case Pn:d&&d();break;case Rn:T&&T();break;case Ln:O&&O()}_(!1)}),[N,P,h,d,T,O]),R=(0,o.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n={top:t,left:e};if(!C.current)return n;var r=C.current.getBoundingClientRect(),o=y(),a=v(),i=a.right,s=a.bottom;return n.top=n.top-o.top,n.left=n.left-o.left,t+r.height>s-10&&(n.top-=r.height),e+r.width>i&&(n.left-=r.width),n.top<0&&(n.top=r.bottom>s?(s-10-r.height)/2:0),n.left<0&&(n.left=r.width<i?(i-r.width)/2:0),n}),[v,y]);return(0,o.useEffect)((function(){var e=function(e){if(e.preventDefault(),!C.current||!C.current.contains(e.target)){_(!0);var t=R(e.clientX,e.clientY);E(t)}};return document.addEventListener("contextmenu",e),function(){document.removeEventListener("contextmenu",e)}}),[]),(0,o.useEffect)((function(){return b?document.addEventListener("mousedown",I):document.removeEventListener("mousedown",I),function(){document.removeEventListener("mousedown",I)}}),[b,I]),b?0===M.length?null:(0,s.jsx)("div",{ref:C,className:"dropdown-menu sf-metadata-contextmenu",style:D,children:M.map((function(e,t){return(0,s.jsx)("button",{className:"dropdown-item sf-metadata-contextmenu-item",onClick:function(t){return j(t,e)},children:e.label},t)}))}):null},Un=function(e){function t(e){var n;(0,C.A)(this,t),(n=(0,x.A)(this,t,[e])).createColumnMetrics=function(e){var t=e.columns,n=e.table;return(0,G.iM)(t,n.columns,n._id)},n.createRowMetrics=function(){arguments.length>0&&void 0!==arguments[0]||n.props;return{idSelectedRecordMap:{}}},n.setScrollLeft=function(e){n.resultContainerRef.scrollLeft=e},n.modifyColumnWidth=function(e,t){n.props.modifyColumnWidth(e.key,t)},n.getScrollPosition=function(){var e=window.sfMetadataContext.localStorage.getItem("scroll_left")+"",t=window.sfMetadataContext.localStorage.getItem("scroll_top")+"";e&&t&&n.bodyRef&&(e=Number(e),t=Number(t),n.bodyRef.setScrollTop(t),n.setScrollLeft(e),n.handleHorizontalScroll(e,t))},n.storeScrollPosition=function(){var e=n.bodyRef.getScrollTop(),t=n.getScrollLeft();window.sfMetadataContext.localStorage.setItem("scroll_left",t),n.storeScrollTop(e)},n.storeScrollTop=function(e){window.sfMetadataContext.localStorage.setItem("scroll_top",e)},n.onContentScroll=function(e){var t=e.target.scrollLeft,r=n.bodyRef.getScrollTop(),o=n.scrollLeft-t,a=n.scrollTop-r;n.scrollLeft=t,0!==a&&(n.scrollTop=r),0!==a||0===o&&0!==t||n.handleHorizontalScroll(t,r),n.storeScrollPosition(),window.sfMetadataContext.eventBus.dispatch(h.Tw.CLOSE_EDITOR)},n.handleHorizontalScroll=function(e,t){var r=n.props.getTableContentRect().width;if(i.Fr)n.updateHorizontalScrollState({scrollLeft:e,columnMetrics:n.state.columnMetrics,gridWidth:r});else{var o,a=n.resultContainerRef?n.resultContainerRef.className:"";(o=e>0?(0,i.B$)(a,"horizontal-scroll"):(0,i.SW)(a,"horizontal-scroll"))!==a&&n.resultContainerRef&&(n.resultContainerRef.className=o),n.lastScrollLeft=e,n.handleFrozenDOMsPosition(e,t),n.recordsFooterRef.setSummaryScrollLeft(e),n.isScrollByScrollbar||n.handleScrollbarScroll(e),n.bodyRef&&n.bodyRef.interactionMask&&n.bodyRef.setScrollLeft(e,t),n.updateHorizontalScrollState({scrollLeft:e,columnMetrics:n.state.columnMetrics,gridWidth:r})}},n.handleFrozenDOMsPosition=function(e,t){var r=n.state.columnMetrics.lastFrozenColumnKey;n.props.isGroupView&&!r||(n.clearSetAbsoluteTimer(),n.setFixed(e,t),n.timer=setTimeout((function(){n.setAbsolute(e,t)}),100))},n.handleScrollbarScroll=function(e){n.horizontalScrollbar&&(n.isScrollByScrollbar?n.isScrollByScrollbar=!1:n.setHorizontalScrollbarScrollLeft(e))},n.onHorizontalScrollbarScroll=function(e){n.isScrollByScrollbar=!0,n.setScrollLeft(e)},n.onHorizontalScrollbarMouseUp=function(){n.isScrollByScrollbar=!1},n.setHorizontalScrollbarScrollLeft=function(e){n.horizontalScrollbar&&n.horizontalScrollbar.setScrollLeft(e)},n.setFixed=function(e,t){n.bodyRef.recordFrozenRefs.forEach((function(e){e&&(e.frozenColumns.style.position="fixed",e.frozenColumns.style.marginLeft="0px",e.frozenColumns.style.marginTop="-"+t+"px")})),n.bodyRef.fixFrozenDoms&&n.bodyRef.fixFrozenDoms(e,t)},n.setAbsolute=function(e){var t=n.props.isGroupView,r=n.state.columnMetrics.lastFrozenColumnKey;t&&!r||(n.bodyRef.recordFrozenRefs.forEach((function(t){t&&(t.frozenColumns.style.position="absolute",t.frozenColumns.style.marginLeft=e+"px",t.frozenColumns.style.marginTop="0px")})),n.bodyRef.cancelFixFrozenDOMs&&n.bodyRef.cancelFixFrozenDOMs(e),n.bodyRef&&n.bodyRef.interactionMask&&n.bodyRef.cancelSetScrollLeft())},n.clearSetAbsoluteTimer=function(){n.timer&&(clearTimeout(n.timer),n.timer=null)},n.getScrollLeft=function(){return i.Fr?0:n.scrollLeft||0},n.getScrollTop=function(){return i.Fr?0:n.scrollTop||0},n.setHorizontalScrollbarRef=function(e){n.horizontalScrollbar=e},n.setResultContainerRef=function(e){n.resultContainerRef=e},n.updateSelectedRange=function(e){n.setState({selectedRange:e})},n.onClickContainer=function(e){var t=(0,i.wD)(e);(t.includes("sf-metadata-result-content")||t.includes("sf-metadata-result-table-content"))&&window.sfMetadataContext.eventBus.dispatch(h.Tw.CLOSE_EDITOR)},n.onCellClick=function(e){e&&n.updateSelectedRange({topLeft:n.initPosition,bottomRight:n.initPosition}),n.onDeselectAllRecords()},n.onCellRangeSelectionUpdated=function(e){n.onCellClick(),n.updateSelectedRange(e)},n.onCopyCells=function(e){window.sfMetadataContext.eventBus.dispatch(h.Tw.COPY_CELLS,e)},n.onPasteCells=function(e){window.sfMetadataContext.eventBus.dispatch(h.Tw.PASTE_CELLS,e)},n.onTouchStart=function(e){if(e.target&&["canvas","group-canvas"].includes(e.target.id)){var t={startX:e.changedTouches[0].clientX,startY:e.changedTouches[0].clientY};n.setState({touchStartPosition:t})}},n.onTouchEnd=function(e){if(e.target&&["canvas","group-canvas"].includes(e.target.id)){var t=e.changedTouches[0],r=t.clientX,o=t.clientY,a=n.state.touchStartPosition;Math.abs(a.startX-r)<5&&Math.abs(a.startY-o)<5&&window.sfMetadataContext.eventBus.dispatch(h.Tw.SELECT_NONE)}},n.onMouseDown=function(e){var t=(0,i.wD)(e);if(!(t.indexOf("sf-metadata-result-table-cell")>-1)){(["canvas","group-canvas"].includes(e.target.id)||t.includes("sf-metadata-result-content"))&&window.sfMetadataContext.eventBus.dispatch(h.Tw.SELECT_NONE)}},n.selectNone=function(){n.setState({selectedRange:{topLeft:n.initPosition,bottomRight:n.initPosition}}),n.onDeselectAllRecords()},n.selectCell=function(e){n.setState({selectedPosition:e})},n.onSelectRecord=function(e,t){var r=e.groupRecordIndex,o=e.recordIndex;if(t.stopPropagation(),Le(t))n.selectRecordWithShift({groupRecordIndex:r,recordIndex:o});else{var a=n.props.isGroupView,i=n.state.recordMetrics,s=n.props.recordGetterByIndex({isGroupView:a,groupRecordIndex:r,recordIndex:o});if(s){var l=s._id;if(Je.isRecordSelected(l,i))return n.deselectRecord(l),void n.setState({lastRowIdxUiSelected:{groupRecordIndex:-1,recordIndex:-1}});n.selectRecord(l),n.setState({lastRowIdxUiSelected:{groupRecordIndex:r,recordIndex:o}})}}},n.selectRecordWithShift=function(e){var t=e.groupRecordIndex,r=e.recordIndex,o=n.props,a=o.recordIds,i=o.isGroupView,s=n.state,l=s.lastRowIdxUiSelected,c=s.recordMetrics,u=[];if(i){if(!window.sfMetadataBody||!window.sfMetadataBody.getGroupMetrics)return;for(var d=window.sfMetadataBody.getGroupMetrics().groupRows,p=[t,l.groupRecordIndex].sort((function(e,t){return e-t})),f=p[0];f<=p[1];f++){var m=d[f];m.type===h.Gi.ROW&&u.push(m.rowId)}}else{var g=a[r];if(!g)return;var v=l.recordIndex;if(v<0)return n.selectRecord(g),void n.setState({lastRowIdxUiSelected:{groupRecordIndex:-1,recordIndex:r}});if(r===v||Je.isRecordSelected(g,c))return n.deselectRecord(g),void n.setState({lastRowIdxUiSelected:{groupRecordIndex:-1,recordIndex:-1}});u=n.getRecordIdsBetweenRange({start:v,end:r})}0!==u.length&&(n.selectRecordsById(u),n.setState({lastRowIdxUiSelected:{groupRecordIndex:t,recordIndex:r}}))},n.getRecordIdsBetweenRange=function(e){for(var t=e.start,r=e.end,o=n.props.recordIds,a=Math.min(t,r),i=Math.max(t,r),s=[],l=a;l<=i;l++){var c=o[l];c&&s.push(c)}return s},n.selectRecord=function(e){var t=n.state.recordMetrics;if(!Je.isRecordSelected(e,t)){var o=(0,r.A)({},t);Je.selectRecord(e,o),n.setState({recordMetrics:o})}},n.selectRecordsById=function(e){var t=n.state.recordMetrics;if(0!==e.filter((function(e){return!Je.isRecordSelected(e,t)})).length){var o=(0,r.A)({},t);Je.selectRecordsById(e,o),n.setState({recordMetrics:o})}},n.deselectRecord=function(e){var t=n.state.recordMetrics;if(Je.isRecordSelected(e,t)){var o=(0,r.A)({},t);Je.deselectRecord(e,o),n.setState({recordMetrics:o})}},n.selectAllRecords=function(){var e=n.props,t=e.recordIds,o=e.isGroupView,a=n.state.recordMetrics,i=(0,r.A)({},a),s=[];if(o){if(!window.sfMetadataBody||!window.sfMetadataBody.getGroupMetrics)return;window.sfMetadataBody.getGroupMetrics().groupRows.forEach((function(e){e.type===h.Gi.ROW&&s.push(e.rowId)}))}else s=t;Je.selectRecordsById(s,i),n.setState({recordMetrics:i})},n.onDeselectAllRecords=function(){var e=n.state.recordMetrics;if(Je.hasSelectedRecords(e)){var t=(0,r.A)({},e);Je.deselectAllRecords(t),n.setState({recordMetrics:t,lastRowIdxUiSelected:{groupRecordIndex:-1,recordIndex:-1}})}},n.hasSelectedCell=function(e,t){var r=e.groupRecordIndex,o=e.recordIndex;if(!t)return!1;var a=n.props.isGroupView,i=t.groupRecordIndex,s=t.rowIdx;return a?r===i:o===s},n.hasSelectedRecord=function(){var e=n.state.recordMetrics;if(!Je.hasSelectedRecords(e))return!1;var t=Je.getSelectedIds(e),r=t&&t.map((function(e){return n.props.recordGetterById(e)})).filter(Boolean);return r&&r.length>0},n.getHorizontalScrollState=function(e){var t=e.gridWidth,n=e.columnMetrics,r=e.scrollLeft,o=n.columns,a=o.length,i=function(e,t,n){var r=function(e,t){for(var n=t,r=e.slice(0),o=0;o<r.length;o++)if((n-=e[o].width)<0)return o}(e,t),o=function(e,t,n){for(var r=t+n,o=0;o<e.length;o++)if((r-=e[o].width)<0)return o-1;return e.length-1}(e,n,t);return{colVisibleStartIdx:r,colVisibleEndIdx:o}}(o,r,t),s=i.colVisibleStartIdx,l=i.colVisibleEndIdx,c=function(e){return Math.max(0,10*Math.floor(e/10)-h.hw)}(s),u=function(e,t){return Math.min(10*Math.ceil(e/10)+h.hw,t)}(l,a);return{colOverScanStartIdx:c,colOverScanEndIdx:u}},n.updateHorizontalScrollState=function(e){var t=e.columnMetrics,r=e.gridWidth,o=e.scrollLeft,a=n.getHorizontalScrollState({columnMetrics:t,gridWidth:r,scrollLeft:o});n.setState(a)},n.isOutSelectedRange=function(e){var t=e.recordIndex,r=e.idx,o=n.state.selectedRange,a=o.topLeft,i=o.bottomRight,s=a.idx,l=a.rowIdx,c=i.idx,u=i.rowIdx;return r<s||r>c||t<l||t>u},n.onCellContextMenu=function(e){var t=e.rowIdx,r=e.idx,o=e.groupRecordIndex,a=n.props,i=a.isGroupView,s=(0,a.recordGetterByIndex)({isGroupView:i,groupRecordIndex:o,recordIndex:t});if(s){var l=n.state.recordMetrics,c=s._id;Je.isRecordSelected(c,l)||n.setState({recordMetrics:n.createRowMetrics()}),n.isOutSelectedRange({recordIndex:t,idx:r})&&window.sfMetadataContext.eventBus.dispatch(h.Tw.SELECT_CELL,e,!1)}},n.getTableCanvasContainerRect=function(){return n.resultContainerRef.getBoundingClientRect()},n.renderRecordsBody=function(e){var t=e.containerWidth,o=n.props,a=o.isGroupView,i=o.recordGetterByIndex,l=o.updateRecords,c=n.state,u=c.recordMetrics,d=c.columnMetrics,p=c.colOverScanStartIdx,f=c.colOverScanEndIdx,h=d.columns,m=d.allColumns,g=d.totalWidth,v=d.lastFrozenColumnKey,y=d.frozenColumnsWidth,C=(0,r.A)((0,r.A)({},n.props),{},{columns:h,allColumns:m,totalWidth:g,lastFrozenColumnKey:v,frozenColumnsWidth:y,recordMetrics:u,colOverScanStartIdx:p,colOverScanEndIdx:f,contextMenu:(0,s.jsx)(Fn,{isGroupView:a,recordGetterByIndex:i,updateRecords:l}),hasSelectedRecord:n.hasSelectedRecord(),getScrollLeft:n.getScrollLeft,getScrollTop:n.getScrollTop,selectNone:n.selectNone,onCellClick:n.onCellClick,onCellRangeSelectionUpdated:n.onCellRangeSelectionUpdated,onSelectRecord:n.onSelectRecord,setRecordsScrollLeft:n.setScrollLeft,hasSelectedCell:n.hasSelectedCell,cacheScrollTop:n.storeScrollTop,onCellContextMenu:n.onCellContextMenu,getTableCanvasContainerRect:n.getTableCanvasContainerRect});return n.props.isGroupView?(0,s.jsx)(Dn,(0,r.A)((0,r.A)({onRef:function(e){return n.bodyRef=e}},C),{},{containerWidth:t,groups:n.props.groups,groupbys:n.props.groupbys,groupOffsetLeft:n.props.groupOffsetLeft})):(0,s.jsx)(sn,(0,r.A)((0,r.A)({onRef:function(e){return n.bodyRef=e}},C),{},{recordIds:n.props.recordIds}))},n.scrollTop=0,n.isScrollByScrollbar=!1;var o=window.sfMetadataContext.localStorage.getItem("scroll_left");n.scrollLeft=o?Number(o):0,n.lastScrollLeft=n.scrollLeft,n.initPosition={idx:-1,rowIdx:-1,groupRecordIndex:-1};var a=n.createColumnMetrics(e),l=e.getTableContentRect().width,c=n.getHorizontalScrollState({gridWidth:l,columnMetrics:a,scrollLeft:0});return n.state=(0,r.A)({columnMetrics:a,recordMetrics:n.createRowMetrics(),lastRowIdxUiSelected:{groupRecordIndex:-1,recordIndex:-1},touchStartPosition:{},selectedRange:{topLeft:n.initPosition,bottomRight:n.initPosition},selectedPosition:n.initPosition},c),n.isWindows=(0,i.eP)(),n.isWebkit=(0,i.zR)(),n}return(0,b.A)(t,e),(0,A.A)(t,[{key:"componentDidMount",value:function(){document.addEventListener("copy",this.onCopyCells),document.addEventListener("paste",this.onPasteCells),window.isMobile?(window.addEventListener("touchstart",this.onTouchStart),window.addEventListener("touchend",this.onTouchEnd)):document.addEventListener("mousedown",this.onMouseDown),this.unsubscribeSelectNone=window.sfMetadataContext.eventBus.subscribe(h.Tw.SELECT_NONE,this.selectNone),this.unsubscribeSelectCell=window.sfMetadataContext.eventBus.subscribe(h.Tw.SELECT_CELL,this.selectCell),this.getScrollPosition()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t,n=e.columns,r=(0,e.getTableContentRect)().width;if(this.props.columns!==n){var o=this.createColumnMetrics(e);this.updateHorizontalScrollState({columnMetrics:o,scrollLeft:this.lastScrollLeft,gridWidth:r}),this.setState({columnMetrics:o})}else(null===(t=this.props.getTableContentRect())||void 0===t?void 0:t.width)!==r&&this.updateHorizontalScrollState({columnMetrics:this.state.columnMetrics,scrollLeft:this.lastScrollLeft,gridWidth:r})}},{key:"componentWillUnmount",value:function(){document.removeEventListener("copy",this.onCopyCells),document.removeEventListener("paste",this.onPasteCells),window.isMobile?(window.removeEventListener("touchstart",this.onTouchStart),window.removeEventListener("touchend",this.onTouchEnd)):document.removeEventListener("mousedown",this.onMouseDown),this.clearSetAbsoluteTimer(),this.unsubscribeSelectNone(),this.unsubscribeSelectCell(),this.setState=function(e,t){}}},{key:"render",value:function(){var e=this,t=this.props,n=t.recordIds,r=t.recordsCount,o=t.table,a=t.isGroupView,l=t.groupOffsetLeft,c=t.renameColumn,u=t.modifyColumnData,d=t.deleteColumn,p=t.modifyColumnOrder,f=this.state,m=f.recordMetrics,g=f.columnMetrics,v=f.selectedRange,y=f.colOverScanStartIdx,C=f.colOverScanEndIdx,A=g.columns,x=g.totalWidth,b=g.lastFrozenColumnKey,_=x+h.sN+h.AD+l,w=this.hasSelectedRecord(),S=Je.isSelectedAll(n,m);return 0===r?(0,s.jsx)(Nn.A,{text:(0,i.AP)("No record")}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"sf-metadata-result-container ".concat(this.isWindows?"windows-browser":""),ref:this.setResultContainerRef,onScroll:this.onContentScroll,onClick:this.onClickContainer,children:(0,s.jsxs)("div",{className:"sf-metadata-result-content",style:{width:_},children:[(0,s.jsx)(X,{onRef:function(t){return e.headerFrozenRef=t},containerWidth:_,table:o,columnMetrics:g,colOverScanStartIdx:y,colOverScanEndIdx:C,hasSelectedRecord:w,isSelectedAll:S,isGroupView:a,groupOffsetLeft:l,lastFrozenColumnKey:b,modifyColumnWidth:this.modifyColumnWidth,selectNoneRecords:this.selectNone,selectAllRecords:this.selectAllRecords,renameColumn:c,deleteColumn:d,modifyColumnData:u,modifyColumnOrder:p}),this.renderRecordsBody({containerWidth:_})]})}),this.isWindows&&this.isWebkit&&(0,s.jsx)(ee,{ref:this.setHorizontalScrollbarRef,innerWidth:x+h.AD,onScrollbarScroll:this.onHorizontalScrollbarScroll,onScrollbarMouseUp:this.onHorizontalScrollbarMouseUp}),(0,s.jsx)(In,{ref:function(t){return e.recordsFooterRef=t},recordsCount:r,hasMore:this.props.hasMore,columns:A,groupOffsetLeft:l,recordMetrics:m,selectedRange:v,isGroupView:a,hasSelectedRecord:w,isLoadingMore:this.props.isLoadingMore,recordGetterById:this.props.recordGetterById,recordGetterByIndex:this.props.recordGetterByIndex,getRecordsSummaries:function(){},loadAll:this.props.loadAll})]})}}])}(o.Component),Yn=Un,Bn=n(91210),Hn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD";if("string"!==typeof e||!e.trim())return null;var n={};return n=/^[0-9]+$/.test(e)?new Date((0,Bn.WH)(e)):m.EmK.parseDateWithFormat(e,t),t.indexOf("HH:mm")<0?m.EmK.format(n,"YYYY-MM-DD")||null:m.EmK.format(n,"YYYY-MM-DD HH:MM")||null},Vn=(0,c.default)((0,c.default)({},m.vZe.MULTIPLE_SELECT,[m.vZe.MULTIPLE_SELECT,m.vZe.TEXT,m.vZe.SINGLE_SELECT]),m.vZe.NUMBER,[m.vZe.TEXT,m.vZe.NUMBER]),Gn=/(\d{4})\u5e74(\d{1,2})\u6708(\d{1,2})\u65e5$/;var qn=function(e,t,n,r,o){var a=function(e,t,n,r){var o=n.type;if(!e||Array.isArray(e)&&0===e.length||!Vn[m.vZe.MULTIPLE_SELECT].includes(o))return{selectedOptionIds:t};var a=[];if(o===m.vZe.MULTIPLE_SELECT)a=(0,m.FiT)(n).filter((function(t){return e.includes(t.id)||e.includes(t.name)})).map((function(e){return e.name}));else if(o===m.vZe.TEXT){var i=String(e);1===(a=i.split("\n")).length&&(a=i.split(",")),a=a.map((function(e){return e.trim()})).filter((function(e){return""!==e}))}else o===m.vZe.SINGLE_SELECT&&(a=(0,m.FiT)(n).filter((function(t){return t.id===e})).map((function(e){return e.name})));if(0===a.length)return{selectedOptionIds:t};var s=(0,m.FiT)(r),l=(0,m.oHI)(s,a);return{pasteOptions:s,newCellOptions:l.cellOptions,selectedOptionIds:l.selectedOptionIds}}(e,t,n,r),i=a.newCellOptions,s=a.pasteOptions,l=a.selectedOptionIds,c=r;if(i){if(!window.sfMetadataContext.canModifyColumnData(r))return null;var u=[].concat((0,xe.A)(s),(0,xe.A)(i));c.data||(c.data={}),c.data.options=u,o.modifyColumnData(r.key,{options:u},r.data)}return(0,m.zXq)(c,l)};function zn(e,t,n,r,o){var a=r.type,i=r.data,s=n.type,l=n.data;switch(s){case m.vZe.CHECKBOX:return function(e,t,n){switch(n){case m.vZe.CHECKBOX:return"boolean"===typeof e?e:null;case m.vZe.TEXT:return!(!e||"string"!==typeof e||"true"!==e.toLocaleLowerCase());case m.vZe.NUMBER:return e>0;default:return t}}(e,t,a);case m.vZe.NUMBER:return function(e,t,n,r){if(!Vn[m.vZe.NUMBER].includes(n))return t;if(0===e)return e;if(!e)return null;switch(n){case m.vZe.NUMBER:case m.vZe.RATE:case m.vZe.DURATION:return e;case m.vZe.TEXT:if(e.includes("%"))return(0,m.WHw)(e,"percent")}var o="string"===typeof e?e:e.toString();return(0,m.nYS)(o,r)}(e,t,a,l);case m.vZe.DATE:return function(e,t,n,r,o){var a=(null===o||void 0===o?void 0:o.format)||m.D23,i=(null===r||void 0===r?void 0:r.format)||m.D23;switch(n){case m.vZe.DATE:var s=i.indexOf("HH:mm"),l=a.indexOf("HH:mm");return s>-1&&l>-1||s===l?e:Hn(e,a);case m.vZe.CTIME:case m.vZe.MTIME:return Hn(e,a);case m.vZe.TEXT:if(e.indexOf("\u5e74")>-1){var c=e.replace(/\s*/g,"");return Gn.test(c)?Hn(c.replace(Gn,"$1-$2-$3"),a):""}return Hn(e,a);default:return t}}(e,t,a,i,l);case m.vZe.SINGLE_SELECT:return function(e,t,n,r){if(!e)return t;var o;switch(n.type){case m.vZe.SINGLE_SELECT:var a=(0,m.FiT)(n);o=(0,m.BW0)(a,e)||"";break;case m.vZe.MULTIPLE_SELECT:var i=(0,m.FiT)(n),s=e[0];o=(0,m.BW0)(i,s)||"";break;case m.vZe.TEXT:o=e}if(!o)return t;var l=(0,m.FiT)(r),c=(0,m.rgt)(l,o);return m.LOw.includes(r.key)?c.id:c.name}(e,t,r,n);case m.vZe.MULTIPLE_SELECT:return qn(e,t,r,n,o);case m.vZe.LONG_TEXT:return function(e,t,n){var r=n.type,o=n.data;switch(r){case m.vZe.LONG_TEXT:var a={text:e};return(0,m.EDs)(a)?(0,m.ZRJ)(a).text:e||null;case m.vZe.TEXT:return e||null;case m.vZe.NUMBER:return(0,m.HLJ)(e,o)||null;case m.vZe.DATE:return(0,m.u1Q)(e,o.format||m.D23)||null;default:return t}}(e,t,r);case m.vZe.TEXT:return function(e,t,n){var r=n.type,o=n.data;switch(r){case m.vZe.TEXT:return(0,m.EtT)(e)?String(e):e?"string"===typeof e?e.replace(/\n/g,"").trim():String(e):null;case m.vZe.URL:case m.vZe.EMAIL:case m.vZe.AUTO_NUMBER:return e;case m.vZe.NUMBER:return(0,m.HLJ)(e,o);case m.vZe.DATE:return(0,m.u1Q)(e,o.format||m.D23);case m.vZe.SINGLE_SELECT:var a=(0,m.FiT)(n);return(0,m.BW0)(a,e)||null;case m.vZe.COLLABORATOR:var i=window.sfMetadata.getCollaborators();return(0,m.LYl)(i,e);case m.vZe.CREATOR:case m.vZe.LAST_MODIFIER:if(!e)return null;var s=window.sfMetadata.getCollaborators();return(0,m.LYl)(s,[e]);default:return t}}(e,t,r);case m.vZe.COLLABORATOR:return function(e,t,n){switch(n){case m.vZe.COLLABORATOR:if(!Array.isArray(e)||0===e.length)return null;var r=window.sfMetadata.getCollaborators(),o={};return r.forEach((function(e){return o[e.email]=!0})),e.filter((function(e){return!!o[e]}));case m.vZe.TEXT:if(!e)return t;var a=e.split(",");if(0===a.length)return t;var i=window.sfMetadata.getCollaborators(),s={};i.forEach((function(e){return s[e.name]=e}));var l=a.map((function(e){var t=s[e];return t?t.email:null})).filter(Boolean);return 0===l.length?t:l;case m.vZe.CREATOR:case m.vZe.LAST_MODIFIER:var c=window.sfMetadata.getCollaborators(),u={};return c.forEach((function(e){return u[e.email]=!0})),e&&u[e]?[e]:null;default:return t}}(e,t,a);case m.vZe.RATE:return function(e,t,n,r){var o=n.type;if(""===e||[m.vZe.TEXT,m.vZe.NUMBER,m.vZe.RATE].includes(o)){var a;if(0===e)return 0;if(!e)return null;var i=o===m.vZe.NUMBER?null===n||void 0===n||null===(a=n.data)||void 0===a?void 0:a.format:null;"percent"===i&&(e*=100);var s=(0,m.WHw)(e.toString(),i);if(s>0){var l=r.data.max,c=void 0===l?5:l,u=Number(s.toFixed(0));return u<c?u:c}return null}return null}(e,0,r,n);default:return t}}var Wn=function(e){return e.value},Kn=function(){return(0,A.A)((function e(t,n){(0,C.A)(this,e),this.metadata=t,this.api=n}),[{key:"getCopiedContent",value:function(e){var t=this,n=e.type,r=e.copied,o=e.isGroupView,a=e.columns;if(n===h.aG.DTABLE_FRAGMENT){var i=r.selectedRecordIds,s=r.copiedRange;if(Array.isArray(i)&&i.length>0)return{copiedRecords:i.map((function(e){return t.api.recordGetterById(e)})),copiedColumns:(0,xe.A)(a)};for(var l=[],c=[],u=s.topLeft,d=s.bottomRight,p=u.rowIdx,f=u.idx,m=u.groupRecordIndex,g=d.rowIdx,v=d.idx,y=m,C=p;C<=g;C++)l.push(this.api.recordGetterByIndex({isGroupView:o,groupRecordIndex:y,recordIndex:C})),o&&y++;for(var A=f;A<=v;A++)c.push((0,G.wV)(A,a));return{copiedRecords:l,copiedColumns:c}}return{copiedRecords:r.copiedRecords,copiedColumns:r.copiedColumns}}},{key:"paste",value:function(){var e=(0,d.A)((0,u.A)().mark((function e(t){var n,r,o,a,i,s,l,c,d,p,f,h,g,v,y,C,A,x,b,_,w,S,D,E,k,M,I,N,P,T,O,j,R,L,F,U,Y,B,H,V,q,z,W,K,Z,X,$;return(0,u.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.copied,r=t.multiplePaste,o=t.pasteRange,a=t.isGroupView,i=t.columns,s=this.metadata.row_ids,l=o.topLeft,c=o.bottomRight,d=void 0===c?{}:c,p=l.rowIdx,f=l.idx,h=l.groupRecordIndex,g=d.rowIdx,v=d.idx,y=n.copiedRecords,C=n.copiedColumns,A=y.length,x=C.length,b=r?g-p+1:A,_=r?v-f+1:x,w=s.length,!(A>w-p)){e.next=14;break}return e.abrupt("return");case 14:S=[],D={},E={},k={},M={},I=h,N=0;case 21:if(!(N<b)){e.next=59;break}if(P=this.api.recordGetterByIndex({isGroupView:a,groupRecordIndex:I,recordIndex:p+N}),a&&I++,P){e.next=26;break}return e.abrupt("continue",56);case 26:T=P._id,O=y[N%A],j={},R={},L={},F={},U=window.sfMetadataContext,Y=U.canModifyRow,B=U.canModifyColumn,H=0;case 35:if(!(H<_)){e.next=55;break}if((V=(0,G.wV)(H+f,i))&&Y(P)&&B(V)){e.next=39;break}return e.abrupt("continue",52);case 39:if(q=H%x,z=(0,G.wV)(q,C),W=(0,G.KO)(V),K=(0,G.KO)(z),Z=Object.prototype.hasOwnProperty.call(P,W)?(0,m.Teq)(P,V):null,X=Object.prototype.hasOwnProperty.call(O,K)?(0,m.Teq)(O,z):null,($=zn(X,Z,V,z,this.api))!==Z){e.next=48;break}return e.abrupt("continue",52);case 48:j[W]=$,R[V.key]=$,L[W]=Z,F[V.key]=Z;case 52:H++,e.next=35;break;case 55:Object.keys(j).length>0&&(S.push(T),D[T]=j,E[T]=R,k[T]=L,M[T]=F);case 56:N++,e.next=21;break;case 59:if(0!==S.length){e.next=61;break}return e.abrupt("return");case 61:this.api.modifyRecords(S,D,E,k,M,true);case 62:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getLinkedRowsIdsByNameColumn",value:function(e,t,n,r){if(!Array.isArray(e)||0===e.length)return[];var o=String(n),a=e.find((function(e){var t;return(null===(t=e["0000"])||void 0===t?void 0:t.trim())===o.trim()}))||null;if(a)return r[t]=[{display_value:o,row_id:a._id}],[a._id];var i=[];if(o.includes(",")||o.includes("\uff0c")){var s=o.split(/[,\uff0c]/).map((function(e){return e.trim()})).filter((function(e,t,n){return n.indexOf(e)===t}));if(!Array.isArray(s)||0===s.length)return[];r[t]=[],s.forEach((function(n){var o=e.find((function(e){var t;return(null===(t=e["0000"])||void 0===t?void 0:t.trim())===n}))||null;o&&(r[t].push({display_value:n,row_id:o._id}),i.push(o._id))}))}return i}},{key:"getUpdateDraggedRecords",value:function(e,t,n,r,o){for(var a=[],i={},s={},l={},u={},d=e.overRecordIdx,p=e.topLeft,f=e.bottomRight,m=p.idx,g=f.idx,v=f.rowIdx,y=f.groupRecordIndex,C=window.sfMetadataContext,A=C.canModifyRow,x=C.canModifyColumn,b=this.getDraggedRangeMatrix(t,e,n,o,r),_=this.getDraggedRangeRules(b,t,m),w=b[0].length,S=b[0].length,D=y+1,E=v+1;E<=d;E++){var k=void 0;if(D)k=r[Ee(D,o).rowId];else k=n[E];var M=k._id;if(S++,A(k)){a.push(M);for(var I=(E-v-1)%w,N=m;N<=g;N++){var P=t[N],T=P.key,O=P.type,j=(0,G.KO)(P);if(x(P)&&!h.__.includes(O)){var R=b[N-m][I],L=(0,_[T])({n:S-1,value:R});i[M]=Object.assign({},i[M],(0,c.default)({},j,L)),s[M]=Object.assign({},s[M],(0,c.default)({},j,k[j]));var F=i[M],U=s[M];l[M]=Object.assign({},l[M],F),u[M]=Object.assign({},u[M],U)}}D++}}return{recordIds:a,idOriginalRecordUpdates:i,idRecordUpdates:l,idOriginalOldRecordData:s,idOldRecordData:u}}},{key:"getDraggedRangeMatrix",value:function(e,t,n,r,o){for(var a=[],i=t.topLeft,s=t.bottomRight,l=i.idx,c=i.rowIdx,u=i.groupRecordIndex,d=s.idx,p=s.rowIdx,f=l;f<=d;f++){var h=u;a[f-l]=[];for(var g=e[f],v=c;v<=p;v++){var y=void 0;if(h)y=o[Ee(h,r).rowId];else y=n[v];a[f-l][v-c]=(0,m.Teq)(y,g),h++}}return a}},{key:"getDraggedRangeRules",value:function(e,t,n){var r=this,o={};return e.forEach((function(e,a){var i=t[a+n],s=i.type,l=i.data,c=i.key,u=Wn;if(e.length>1)switch(s){case m.vZe.DATE:var d=l&&l.format&&l.format.indexOf("HH:mm")>-1?"YYYY-MM-DD HH:mm":"YYYY-MM-DD",p=e[0],f=r.getYearTolerance(e);if(f){u=function(e){var t=e.n;return qe()(p).add(t*f,"years").format(d)};break}var h=r.getMonthTolerance(e);if(h){u=function(e){var t=e.n;return qe()(p).add(t*h,"months").format(d)};break}var g=r.getDayTolerance(e);if(g){u=function(e){var t=e.n*g+r.getDateStringValue(p);return qe()(t).format(d)};break}break;case m.vZe.NUMBER:u=r.getLeastSquares(e);break;case m.vZe.TEXT:u=r._getTextRule(e);break;case m.vZe.RATE:u=r.getRatingLeastSquares(e,l);break;default:u=Wn}o[c]=u})),o}},{key:"getDateStringValue",value:function(e){var t=qe()(e);return t.isValid()?t.valueOf():0}},{key:"getYearTolerance",value:function(e){var t=qe()(e[0]),n=qe()(e[1]);if(!t.isValid()||!n.isValid())return 0;if(t.month()!==n.month()||t.date()!==n.date()||t.hour()!==n.hour()||t.minute()!==n.minute())return 0;var r=t.year(),o=n.year()-r;return e.every((function(e,t){var n=qe()(e);return!!n.isValid()&&n.year()===t*o+r}))?o:0}},{key:"getMonthTolerance",value:function(e){var t=qe()(e[0]),n=qe()(e[1]);if(!t.isValid()||!n.isValid())return 0;if(t.date()!==n.date()||t.hour()!==n.hour()||t.minute()!==n.minute())return 0;var r=n.month()-t.month()+12*(n.year()-t.year());return e.every((function(t,n){var o=n*r,a=qe()(t);return!!a.isValid()&&a.isSame(qe()(e[0]).add(o,"month"),"minute")}))?r:0}},{key:"getDayTolerance",value:function(e){var t=this,n=this.getDateStringValue(e[0]),r=this.getDateStringValue(e[1])-n;return e.every((function(e,o){return!!qe()(e).isValid()&&t.getDateStringValue(e)===o*r+n}))?r:0}},{key:"getLeastSquares",value:function(e){var t,n,r,o,a=0,i=0,s=0,l=0,c=0,u=[];return e.forEach((function(e,t){void 0!==e&&null!==e&&""!==e?(c++,a+=t,i+=e,l+=e*t,s+=Math.pow(t,2)):u.push(t)})),c<2?Wn:(t=(l-c*(r=a/c)*(o=i/c))/(s-c*Math.pow(r,2)),n=o-t*r,function(r){var o=r.n;return u.length&&u.includes(o%e.length)?"":Number(parseFloat(o*t+n).toFixed(8))})}}])}(),Zn=Kn,Xn=["metadata","modifyRecord","modifyRecords","loadMore","loadAll","searchResult","recordGetterByIndex","recordGetterById","modifyColumnData"],$n=function(e){var t,n,a=e.metadata,i=e.modifyRecord,l=e.modifyRecords,u=e.loadMore,d=e.loadAll,p=(e.searchResult,e.recordGetterByIndex),f=e.recordGetterById,m=e.modifyColumnData,v=(0,g.A)(e,Xn),C=(0,o.useMemo)((function(){return new Zn(a,{modifyRecord:i,modifyRecords:l,recordGetterByIndex:p,recordGetterById:f,modifyColumnData:m})}),[a,i,l,p,f,m]),A=(0,o.useMemo)((function(){var e;return((null===a||void 0===a||null===(e=a.view)||void 0===e?void 0:e.groupbys)||[]).length}),[a]),x=(0,o.useMemo)((function(){return A*h.ax}),[A]),b=(0,o.useMemo)((function(){var e=a.view,t=e.columns,n=e.hidden_columns;return t.filter((function(e){return!n.includes(e.key)}))}),[a]),_=(0,o.useCallback)((function(e){var t=e.type,n=e.copied,r=e.isGroupView;return C.getCopiedContent({type:t,copied:n,isGroupView:r,columns:b})}),[C,b]),w=(0,o.useCallback)((function(e){var t=e.rowId,n=e.updates,r=e.originalUpdates,o=e.oldRowData,a=e.originalOldRowData;i&&i(t,n,o,r,a)}),[i]),S=(0,o.useCallback)((function(e){var t=e.recordIds,n=e.idRecordUpdates,r=e.idOriginalRecordUpdates,o=e.idOldRecordData,a=e.idOriginalOldRecordData,i=e.isCopyPaste;l&&l(t,n,r,o,a,void 0!==i&&i)}),[l]),D=(0,o.useCallback)((function(e){var t=e.type,n=e.copied,r=e.multiplePaste,o=e.pasteRange,a=e.isGroupView;C.paste({type:t,copied:n,multiplePaste:r,pasteRange:o,isGroupView:a,columns:b})}),[C,b]);return(0,s.jsx)("div",{className:y()("table-main-container container-fluid p-0",(0,c.default)({},"group-level-".concat(A+1),A>0)),children:(0,s.jsx)(Yn,(0,r.A)({columns:b,recordIds:a.view.rows||[],groups:a.view.groups,groupbys:a.view.groupbys,recordsCount:(null===a||void 0===a||null===(t=a.view)||void 0===t||null===(n=t.rows)||void 0===n?void 0:n.length)||0,table:a,hasMore:a.hasMore,gridUtils:C,scrollToLoadMore:u,loadAll:d,paste:D,groupOffsetLeft:x,modifyRecord:w,updateRecords:S,getCopiedRecordsAndColumnsFromRange:_,recordGetterById:f,recordGetterByIndex:p,modifyColumnData:m},v))})},Jn=function(){var e=(0,o.useState)(!1),t=(0,p.A)(e,2),n=t[0],r=t[1],i=(0,a.p)(),l=i.isLoading,g=i.metadata,v=i.store,y=(0,o.useRef)(null),C=(0,o.useCallback)((function(e){if(!e.target.className.includes("editor-main"))return m.sR0.isModF(e)?(e.preventDefault(),void window.sfMetadataContext.eventBus.dispatch(h.Tw.SEARCH_CELLS)):void 0}),[]),A=(0,o.useMemo)((function(){return!(l||!g)&&(0,m.YD9)(g.view.groupbys,g.columns).length>0}),[l,g]),x=(0,o.useCallback)((0,d.A)((0,u.A)().mark((function e(){var t;return(0,u.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(g.hasMore){e.next=2;break}return e.abrupt("return");case 2:return r(!0),e.prev=3,e.next=6,v.loadMore(h.bK);case 6:r(!1),e.next=15;break;case 9:return e.prev=9,e.t0=e.catch(3),t=ae.Aq.getErrorMsg(e.t0),f.A.danger(t),r(!1),e.abrupt("return");case 15:case"end":return e.stop()}}),e,null,[[3,9]])}))),[g,v]),b=(0,o.useCallback)(function(){var e=(0,d.A)((0,u.A)().mark((function e(t,n){var o,a,i;return(0,u.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(g.hasMore){e.next=2;break}return e.abrupt("return");case 2:return r(!0),o=g.row_ids.length,a=o%h._z!==0?h._z-o%h._z:h._z,e.prev=5,e.next=8,v.loadMore(a);case 8:r(!1),e.next=17;break;case 11:return e.prev=11,e.t0=e.catch(5),i=ae.Aq.getErrorMsg(e.t0),f.A.danger(i),r(!1),e.abrupt("return");case 17:v.data.hasMore&&v.data.row_ids.length<t?b(t,n):("function"===typeof n&&n(v.data.hasMore),r(!1));case 18:case"end":return e.stop()}}),e,null,[[5,11]])})));return function(t,n){return e.apply(this,arguments)}}(),[g,v]),_=(0,o.useCallback)((function(e,t,n,r,o){var a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];v.modifyRecords(e,t,n,r,o,a)}),[v]),w=(0,o.useCallback)((function(e,t,n,r,o){var a=[e],i=(0,c.default)({},e,t),s=(0,c.default)({},e,r),l=(0,c.default)({},e,n),u=(0,c.default)({},e,o);_(a,i,s,l,u)}),[_]),S=(0,o.useCallback)((function(e){var t=g.row_ids.length,n=[],r=[],o=[],a={};return e.forEach((function(e){return a[e]=e})),g.row_ids.forEach((function(e,i){if(a[e]){var s=0===i?null:g.row_ids[i-1],l=i===t-1?null:g.row_ids[i+1];n.push(e),r.push(s),o.push(l)}})),{rowIdsInOrder:n,upperRowIds:r,belowRowIds:o}}),[g]),D=(0,o.useCallback)((function(e,t,n){v.renameColumn(e,t,n)}),[v]),E=(0,o.useCallback)((function(e,t){v.deleteColumn(e,t)}),[v]),k=(0,o.useCallback)((function(e,t,n){v.modifyColumnData(e,t,n)}),[v]),M=(0,o.useCallback)((function(e,t){v.modifyColumnWidth(e,t)}),[v]),I=(0,o.useCallback)((function(e,t){v.modifyColumnOrder(e,t)}),[v]),N=(0,o.useCallback)((function(e){return g.id_row_map[e]}),[g]),P=(0,o.useCallback)((function(e){var t=g.view.rows[e];return t&&N(t)}),[g,N]),T=(0,o.useCallback)((function(e){if(!window.sfMetadataBody||!window.sfMetadataBody.getGroupRecordByIndex)return null;var t=window.sfMetadataBody.getGroupRecordByIndex(e).rowId;return t&&N(t)}),[N]),O=(0,o.useCallback)((function(e){var t=e.isGroupView,n=e.groupRecordIndex,r=e.recordIndex;return t?T(n):P(r)}),[T,P]),j=(0,o.useCallback)((function(){var e;return(null===y||void 0===y||null===(e=y.current)||void 0===e?void 0:e.getBoundingClientRect())||{x:0,right:window.innerWidth}}),[y]);return(0,o.useEffect)((function(){return document.addEventListener("keydown",C),function(){document.removeEventListener("keydown",C)}}),[]),(0,s.jsx)("div",{className:"sf-metadata-container",ref:y,children:(0,s.jsx)($n,{isGroupView:A,isLoadingMore:n,loadMore:x,metadata:g,modifyRecord:w,modifyRecords:_,recordGetterById:N,recordGetterByIndex:O,getTableContentRect:j,getAdjacentRowsIds:S,loadAll:b,renameColumn:D,deleteColumn:E,modifyColumnData:k,modifyColumnWidth:M,modifyColumnOrder:I})})},Qn=function(e){var t=e.groups,n=e.overScan,r=e.columns,a=e.size,l=e.gap,c=(0,o.useMemo)((function(){return a+l}),[a,l]),u=(0,o.useCallback)((function(e){var t=n.top,o=n.bottom,i=e.name,l=e.children,u=e.height,d=e.top;if(d>=o||d+u<=t)return(0,s.jsx)("div",{className:"w-100",style:{height:u,flexShrink:0}},i);var p=l.findIndex((function(e){return e.top>=t})),f=l.findIndex((function(e){return e.top>=o}));return-1===p&&-1===f?(0,s.jsx)("div",{className:"w-100",style:{height:u,flexShrink:0}},i):(p=Math.max(p,0),-1===f&&(f=l.length),f>0&&(f-=1),(0,s.jsxs)("div",{className:"metadata-gallery-date-group w-100",style:{height:u},children:[0===p&&(0,s.jsx)("div",{className:"metadata-gallery-date-tag",children:i}),(0,s.jsx)("div",{className:"metadata-gallery-image-list",style:{gridTemplateColumns:"repeat(".concat(r,", 1fr)"),paddingTop:p*c,paddingBottom:(l.length-1-f)*c},children:l.slice(p,f+1).map((function(e){return e.children.map((function(e){return(0,s.jsx)("div",{tabIndex:1,className:"metadata-gallery-image-item",style:{width:a,height:a,background:"#f1f1f1"},children:(0,s.jsx)("img",{className:"metadata-gallery-grid-image",src:e.src,alt:e.name})},e.src)}))}))})]},i))}),[n,r,a,c]);return Array.isArray(t)&&0!==t.length?t.map((function(e,t){return u(e,t)})):(0,s.jsx)(Nn.A,{text:(0,i.AP)("No record")})},er=["children"],tr=function(){var e=(0,o.useRef)(null),t=(0,o.useState)(!0),n=(0,p.A)(t,2),i=n[0],c=n[1],v=(0,o.useState)(!1),y=(0,p.A)(v,2),C=y[0],A=y[1],x=(0,o.useState)(0),b=(0,p.A)(x,2),_=b[0],w=b[1],S=(0,o.useState)(0),D=(0,p.A)(S,2),E=D[0],k=D[1],M=(0,o.useState)({top:0,bottom:0}),I=(0,p.A)(M,2),N=I[0],P=I[1],T=(0,o.useRef)(null),O=(0,a.p)(),j=O.metadata,R=O.store,L=window.sfMetadataContext.getSetting("repoID"),U=(0,o.useMemo)((function(){return 8-_}),[_]),Y=(0,o.useMemo)((function(){return(E-2*U-2)/U}),[E,U]),B=(0,o.useMemo)((function(){if(i)return[];var e=j.view.sorts[0],t=j.rows.filter((function(e){return ae.Aq.imageCheck(e[m.L2D.FILE_NAME])})).reduce((function(t,n){var r=n[m.L2D.FILE_NAME],o=n[m.L2D.PARENT_DIR],a=ae.Aq.encodePath(ae.Aq.joinPath(o,r)),i=(0,m.u1Q)(n[e.column_key],"YYYY-MM-DD"),s={name:r,url:"".concat(F.Yc,"lib/").concat(L,"/file").concat(a),src:"".concat(F.Yc,"thumbnail/").concat(L,"/").concat(F.HJ).concat(a),date:i},l=t.find((function(e){return e.name===i}));return l?l.children.push(s):t.push({name:i,children:[s]}),t}),[]),n=[],o=Y+2;return t.forEach((function(e,t){var a=e.children,i=(0,g.A)(e,er),s=0,l=[];if(t>0){var c=n[t-1],u=c.top,d=c.height;s=u+d}a.forEach((function(e,t){var n=~~(t/U);l[n]||(l[n]={top:s+n*o,children:[]}),l[n].children.push(e)}));var p=l.length*o;n.push((0,r.A)((0,r.A)({},i),{},{top:s,height:p,children:l}))})),n}),[i,j,j.recordsCount,L,U,Y]),H=(0,o.useCallback)((0,d.A)((0,u.A)().mark((function e(){var t;return(0,u.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!C){e.next=2;break}return e.abrupt("return");case 2:if(j.hasMore){e.next=4;break}return e.abrupt("return");case 4:return A(!0),e.prev=5,e.next=8,R.loadMore(h.bK);case 8:A(!1),e.next=17;break;case 11:return e.prev=11,e.t0=e.catch(5),t=ae.Aq.getErrorMsg(e.t0),f.A.danger(t),A(!1),e.abrupt("return");case 17:case"end":return e.stop()}}),e,null,[[5,11]])}))),[C,j,R]);(0,o.useEffect)((function(){var t=window.sfMetadataContext.localStorage.getItem("zoom-gear",0)||0;w(t);var n=e.current;if(n){var r=n.offsetWidth,o=n.clientHeight;k(r);var a=8-t;P({top:0,bottom:o+2*((r-2*a-2)/a+2)})}c(!1);var i=new ResizeObserver((function(){n&&k(n.offsetWidth)}));n&&i.observe(n);var s=window.sfMetadataContext.eventBus.subscribe(h.Tw.MODIFY_GALLERY_ZOOM_GEAR,(function(e){window.sfMetadataContext.localStorage.setItem("zoom-gear",e),w(e),setTimeout((function(){n.scrollTop+=10*e}),200)}));return function(){n&&i.unobserve(n),s(),T.current&&clearTimeout(T.current)}}),[]);var V=(0,o.useCallback)((function(){if(e.current){var t=e.current,n=t.scrollTop,r=t.scrollHeight;n+t.clientHeight>=r-10?H():(T.current&&clearTimeout(T.current),T.current=setTimeout((function(){var t=e.current,n=t.scrollTop,r=t.clientHeight,o=Math.max(0,n-3*(Y+2));P({top:o,bottom:n+r+3*(Y+2)}),T.current=null}),200))}}),[Y,H,T]);return(0,s.jsx)("div",{className:"sf-metadata-container",children:(0,s.jsx)("div",{className:"sf-metadata-gallery-container",ref:e,onScroll:V,children:!i&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Qn,{groups:B,size:Y,columns:U,overScan:N,gap:2}),C&&(0,s.jsx)("div",{className:"sf-metadata-gallery-loading-more",children:(0,s.jsx)(l.Du,{})})]})})})},nr=function(){var e=(0,a.p)(),t=e.isLoading,n=e.metadata,r=e.errorMsg,c=(0,o.useCallback)((function(e){if(!e)return!1;switch(e.view.type){case m.rX9.GALLERY:return(0,s.jsx)(tr,{});case m.rX9.TABLE:return(0,s.jsx)(Jn,{});default:return null}}),[]);return t?(0,s.jsx)(l.Du,{}):(0,s.jsx)("div",{className:"sf-metadata-wrapper",children:(0,s.jsx)("div",{className:"sf-metadata-main",children:r?(0,s.jsx)("div",{className:"d-center-middle error",children:(0,i.AP)(r)}):c(n)})})},rr=function(e){var t=e.value,n=e.onChange,r=(0,o.useCallback)((function(e){e&&e.stopPropagation(),n(!t)}),[t,n]);return(0,s.jsx)("div",{className:"sf-metadata-property-detail-editor sf-metadata-checkbox-property-detail-editor",children:(0,s.jsx)("div",{className:"sf-metadata-checkbox-property-detail-editor-content",onClick:r,children:t&&(0,s.jsx)(l.In,{iconName:"check-mark"})})})},or=o.memo((function(e){var t=e.value,n=e.onChange,r=(0,o.useState)(!1),a=(0,p.A)(r,2),c=a[0],u=a[1],d=(0,o.useRef)(null);(0,o.useEffect)((function(){d.current.innerText=t||""}),[t]);var f=(0,o.useCallback)((function(){if(c){var e=d.current.innerText;e!==t&&n((0,i.yD)(e)||""),u(!1)}}),[c,t,n]),h=(0,o.useCallback)((function(e){e.stopPropagation()}),[]),m=(0,o.useCallback)((function(e){e.stopPropagation()}),[]),g=(0,o.useCallback)((function(e){var t=e.currentTarget,n=t.selectionStart,r=t.selectionEnd,o=t.value;e.keyCode===pt.cK.Enter?(e.preventDefault(),f()):(e.keyCode===pt.cK.ChineseInputMethod||e.keyCode===pt.cK.LeftArrow&&0===n||e.keyCode===pt.cK.RightArrow&&r===o.length)&&e.stopPropagation()}),[f]),v=(0,o.useCallback)((function(){c||(u(!0),setTimeout((function(){d.current.focus();var e=document.createRange();e.selectNodeContents(d.current),e.collapse(!1);var t=window.getSelection();t.removeAllRanges(),t.addRange(e)}),1))}),[c]);return(0,s.jsx)(l.ij,{onClickOutside:f,children:(0,s.jsx)("div",{className:y()("sf-metadata-property-detail-editor sf-metadata-text-property-detail-editor",{formatter:!c}),onClick:v,ref:d,onKeyDown:g,onCut:m,onPaste:h,placeholder:(0,i.AP)("Empty"),contentEditable:c})})}),(function(e,t){return!(ne(e.value,t.value,t.field.type)||!te.A.isSameObject(e.field,t.field)||e.onChange!==t.onChange)})),ar=o.memo((function(e){var t=e.value,n=e.field,r=e.onChange,a=(0,o.useState)(""),l=(0,p.A)(a,2),c=l[0],u=l[1],d=(0,o.useRef)(null);(0,o.useEffect)((function(){var e=t||0===t?t:"",r=(null===n||void 0===n?void 0:n.data)||{},o=(0,m.HLJ)(e,r)||"";u(o)}),[t,n]);var f=(0,o.useCallback)((function(e){var t,r=(null===n||void 0===n||null===(t=n.data)||void 0===t?void 0:t.format)||m.KYu,o="custom_currency"===r?n.data.currency_symbol:null,a=e.target.value.trim();if((0,m.cX8)()||!(a.indexOf(".\u3002")>-1)){var i=(0,m.yAg)(a,r,o);i!==c&&u(i)}}),[n,c]),h=(0,o.useCallback)((function(){var e=(0,m.nYS)(c,n.data);e!==t&&r(e)}),[t,c,n,r]),g=(0,o.useCallback)((function(e){e.stopPropagation()}),[]),v=(0,o.useCallback)((function(e){e.stopPropagation()}),[]),y=(0,o.useCallback)((function(e){var t=e.currentTarget,n=t.selectionStart,r=t.selectionEnd,o=t.value;e.keyCode===pt.cK.Enter?(e.preventDefault(),d.current&&d.current.blur()):(e.keyCode===pt.cK.ChineseInputMethod||e.keyCode===pt.cK.LeftArrow&&0===n||e.keyCode===pt.cK.RightArrow&&r===o.length)&&e.stopPropagation()}),[]),C=(0,o.useCallback)((function(e){f(e)}),[f]);return(0,s.jsx)("input",{ref:d,type:"text",className:"sf-metadata-number-property-detail-editor form-control",placeholder:(0,i.AP)("Empty")||"",onBlur:h,onCut:v,onPaste:g,value:c,name:n.name,title:n.name,"aria-label":n.name,onChange:f,onKeyDown:y,onCompositionEnd:C})}),(function(e,t){return!(ne(e.value,t.value,t.field.type)||!te.A.isSameObject(e.field,t.field)||e.onChange!==t.onChange)})),ir=n(9772),sr=function(e){var t=e.field,n=e.value,a=e.record,l=e.fields,c=e.onChange,u=e.modifyColumnData,d=(0,o.useRef)(null),f=(0,o.useState)(!1),h=(0,p.A)(f,2),g=h[0],v=h[1],y=(0,o.useMemo)((function(){return(0,m.FiT)(t)}),[t]),C=(0,o.useCallback)((function(e){if(e.target&&!((0,i.wD)(e).indexOf("sf-metadata-search-options")>-1)){var t=document.querySelector(".sf-metadata-single-select-editor");t&&(t.contains(e.target)||d.current&&!d.current.contains(e.target)&&g&&v(!1))}}),[g]),A=(0,o.useCallback)((function(e){e.keyCode===m.cKb.Esc&&g&&v(!1)}),[g]);(0,o.useEffect)((function(){return document.addEventListener("mousedown",C),document.addEventListener("keydown",A,!0),function(){document.removeEventListener("mousedown",C),document.removeEventListener("keydown",A,!0)}}),[C,A]);var x=(0,o.useCallback)((function(){v(!0)}),[]),b=(0,o.useCallback)((function(e){!e||(0,m.om8)(y,e)?(c(e),v(!1)):v(!1)}),[y,c]),_=n?(0,m.om8)(y,n):null,w=(0,o.useCallback)((function(){if(!g)return null;var e=d.current.getBoundingClientRect().width;return(0,s.jsx)(ir.A,{target:d,isOpen:!0,placement:"bottom-end",hideArrow:!0,fade:!1,className:"sf-metadata-property-editor-popover sf-metadata-single-select-property-editor-popover",boundariesElement:document.body,children:(0,s.jsx)(xt,{value:n,column:(0,r.A)((0,r.A)({},t),{},{width:Math.max(e-2,200)}),columns:l,modifyColumnData:u,record:a,height:2,onCommit:b})})}),[g,b,a,n,u,l,t]);return(0,s.jsxs)("div",{className:"sf-metadata-property-detail-editor sf-metadata-single-select-property-detail-editor",placeholder:(0,i.AP)("Empty"),ref:d,onClick:x,children:[_&&(0,s.jsx)("div",{className:"sf-metadata-single-select-property-value",style:{backgroundColor:_.color,color:_.textColor||null},children:_.name}),w()]})},lr=function(e){var t=e.field,n=e.value,a=e.onChange,l=e.modifyColumnData,c=(0,o.useRef)(null),u=(0,o.useState)(!1),d=(0,p.A)(u,2),f=d[0],h=d[1],g=(0,o.useMemo)((function(){return(0,m.FiT)(t)}),[t]),v=(0,o.useCallback)((function(e){if(e.target&&!((0,i.wD)(e).indexOf("sf-metadata-search-options")>-1)){var t=document.querySelector(".sf-metadata-multiple-select-editor");t&&(t.contains(e.target)||c.current&&!c.current.contains(e.target)&&f&&h(!1))}}),[f]),y=(0,o.useCallback)((function(e){e.keyCode===m.cKb.Esc&&f&&h(!1)}),[f]);(0,o.useEffect)((function(){return document.addEventListener("mousedown",v),document.addEventListener("keydown",y,!0),function(){document.removeEventListener("mousedown",v),document.removeEventListener("keydown",y,!0)}}),[v,y]);var C=(0,o.useCallback)((function(){h(!0)}),[]),A=(0,o.useCallback)((function(e,r){r&&r.stopPropagation(),r&&r.nativeEvent&&r.nativeEvent.stopImmediatePropagation();var o=(0,m.bLM)(t,n).filter((function(t){return t!==e}));a(o)}),[t,n,a]),x=(0,o.useCallback)((function(e){a(e)}),[a]),b=(0,o.useCallback)((function(){if(!f)return null;var e=c.current.getBoundingClientRect().width;return(0,s.jsx)(ir.A,{target:c,isOpen:!0,placement:"bottom-end",hideArrow:!0,fade:!1,className:"sf-metadata-property-editor-popover sf-metadata-single-select-property-editor-popover sf-metadata-multiple-select-property-editor-popover",boundariesElement:document.body,children:(0,s.jsx)(wt,{saveImmediately:!0,value:n,column:(0,r.A)((0,r.A)({},t),{},{width:Math.max(e-2,200)}),modifyColumnData:l,onCommit:x})})}),[f,x,n,l,t]),_=(0,o.useMemo)((function(){if(!Array.isArray(n)||0===n.length)return!0;var e=g.filter((function(e){return n.includes(e.id)||n.includes(e.name)})),t=n.filter((function(e){return e&&!g.find((function(t){return t.id===e||t.name===e}))}));return e.length+t.length===0}),[g,n]);return(0,s.jsxs)("div",{className:"sf-metadata-property-detail-editor sf-metadata-single-select-property-detail-editor sf-metadata-multiple-select-property-detail-editor",placeholder:(0,i.AP)("Empty"),ref:c,onClick:C,children:[!_&&(0,s.jsx)(bt,{value:n,options:g,onDelete:A}),b()]})},cr=function(e){var t=e.field,n=e.value,r=e.onChange,a=(0,o.useRef)(null),l=(0,o.useState)(!1),c=(0,p.A)(l,2),u=c[0],d=c[1],f=(0,oe.D1)().getCollaborator,h=(0,o.useCallback)((function(e){if(u&&(e.target&&!((0,i.wD)(e).indexOf("sf-metadata-search-collaborators")>-1))){var t=document.querySelector(".sf-metadata-collaborator-editor");t&&t.contains(e.target)||a.current.contains(e.target)||d(!1)}}),[u]),g=(0,o.useCallback)((function(e){e.keyCode===m.cKb.Esc&&u&&d(!1)}),[u]);(0,o.useEffect)((function(){return document.addEventListener("mousedown",h),document.addEventListener("keydown",g,!0),function(){document.removeEventListener("mousedown",h),document.removeEventListener("keydown",g,!0)}}),[h,g]);var v=(0,o.useCallback)((function(){d(!0)}),[]),y=(0,o.useCallback)((function(e){r(e)}),[r]),C=(0,o.useCallback)((function(e,t){t&&t.stopPropagation(),t&&t.nativeEvent&&t.nativeEvent.stopImmediatePropagation();var o=n.filter((function(t){return t!==e}));r(o)}),[n,r]),A=(0,o.useCallback)((function(){if(!u)return null;var e=a.current.getBoundingClientRect().width;return(0,s.jsx)(ir.A,{target:a,isOpen:!0,placement:"bottom-end",hideArrow:!0,fade:!1,className:"sf-metadata-property-editor-popover sf-metadata-collaborator-property-editor-popover",boundariesElement:document.body,style:{width:Math.max(e-2,200)},children:(0,s.jsx)(Et,{saveImmediately:!0,value:n,column:t,height:2,onCommit:y})})}),[u,y,n,t]),x=Array.isArray(n)?n.filter((function(e){return f(e)})):[];return(0,s.jsxs)("div",{className:"sf-metadata-property-detail-editor sf-metadata-collaborator-property-detail-editor",placeholder:(0,i.AP)("Empty"),ref:a,onClick:v,children:[x.length>0&&(0,s.jsx)(St,{value:n,onDelete:C}),A()]})},ur=function(e){var t=e.value,n=e.field,r=e.onChange,a=e.lang,c=(0,o.useState)(!1),u=(0,p.A)(c,2),d=u[0],f=u[1],h=(0,o.useMemo)((function(){var e;return(null===n||void 0===n||null===(e=n.data)||void 0===e?void 0:e.format)||m.D23}),[n]),g=(0,o.useCallback)((function(){f(!0)}),[]),v=(0,o.useCallback)((function(e){r(e)}),[r]),y=(0,o.useCallback)((function(){r(null),f(!1)}),[r]),C=(0,o.useCallback)((function(){f(!1)}),[]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"sf-metadata-property-detail-editor sf-metadata-date-property-detail-editor",placeholder:(0,i.AP)("Empty"),onClick:g,children:(0,m.u1Q)(t,h)}),d&&(0,s.jsx)(l.US,{lang:a,format:h,value:t,onChange:v,onClose:C,onClear:y})]})},dr=function(e){var t=e.field,n=e.value,r=e.onChange,a=(0,o.useState)(n),i=(0,p.A)(a,2),c=i[0],u=i[1],d=(0,o.useState)(!1),f=(0,p.A)(d,2),h=f[0],m=f[1],g=(0,o.useCallback)((function(){m(!0)}),[]),v=(0,o.useCallback)((function(e){r&&r(e),u(e)}),[r]),y=(0,o.useCallback)((function(){m(!1)}),[]),C=!c||!c.trim();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"sf-metadata-property-detail-editor sf-metadata-long-text-property-detail-editor",placeholder:(0,F.AP)("Empty"),onClick:g,children:!C&&(0,s.jsx)(l.qz,{value:c,className:"sf-metadata-property-detail-formatter"})}),h&&(0,s.jsx)(Ot,{value:c,column:t,onCommit:v,onCommitCancel:y})]})},pr=function(e){var t=e.value,n=e.field,r=e.onChange,a=(0,o.useCallback)((function(e){r(e[n.key])}),[n,r]);return(0,s.jsx)("div",{className:"sf-metadata-property-detail-editor sf-metadata-rate-property-detail-editor",placeholder:(0,i.AP)("Empty"),children:(0,s.jsx)(ue,{isCellSelected:!0,field:n,value:t,onChange:a})})},fr=["field","onChange"],hr=function(e){var t=e.field,n=e.onChange,a=(0,g.A)(e,fr),i=(0,o.useCallback)((function(e){n(t.key,e)}),[t,n]);switch(t.type){case m.vZe.CHECKBOX:return(0,s.jsx)(rr,(0,r.A)((0,r.A)({},a),{},{field:t,onChange:i}));case m.vZe.TEXT:return(0,s.jsx)(or,(0,r.A)((0,r.A)({},a),{},{field:t,onChange:i}));case m.vZe.NUMBER:return(0,s.jsx)(ar,(0,r.A)((0,r.A)({},a),{},{field:t,onChange:i}));case m.vZe.DATE:return(0,s.jsx)(ur,(0,r.A)((0,r.A)({},a),{},{field:t,onChange:i,lang:F.vV}));case m.vZe.SINGLE_SELECT:return(0,s.jsx)(sr,(0,r.A)((0,r.A)({},a),{},{field:t,onChange:i}));case m.vZe.MULTIPLE_SELECT:return(0,s.jsx)(lr,(0,r.A)((0,r.A)({},a),{},{field:t,onChange:i}));case m.vZe.COLLABORATOR:return(0,s.jsx)(cr,(0,r.A)((0,r.A)({},a),{},{field:t,onChange:i}));case m.vZe.LONG_TEXT:return(0,s.jsx)(dr,(0,r.A)((0,r.A)({},a),{},{field:t,onChange:i}));case m.vZe.RATE:return(0,s.jsx)(pr,(0,r.A)((0,r.A)({},a),{},{field:t,onChange:i}));default:return null}},mr=n(88238),gr=function(e){var t=Object.assign({},(function(e){if(null==e)throw new TypeError("Cannot destructure "+e)}(e),e));return(0,s.jsx)(a.X,(0,r.A)((0,r.A)({},t),{},{children:(0,s.jsx)(nr,{})}))},vr=n(58195),yr=n(14113),Cr=n(99308),Ar=n(85907),xr=n(18849),br=n(99730),_r=n(19175),wr=function(e){var t=e.toggle,n=e.submit;return(0,s.jsxs)(vr.A,{isOpen:!0,toggle:t,children:[(0,s.jsx)(yr.A,{toggle:t,children:(0,i.AP)("Turn off extended properties")}),(0,s.jsx)(Cr.A,{children:(0,s.jsx)("p",{children:(0,i.AP)("Do you really want to turn off extended properties? Existing properties will all be deleted.")})}),(0,s.jsxs)(Ar.A,{children:[(0,s.jsx)(xr.A,{color:"secondary",onClick:t,children:(0,i.AP)("Cancel")}),(0,s.jsx)(xr.A,{color:"primary",onClick:n,children:(0,i.AP)("Turn off")})]})]})},Sr=function(e){var t=e.value,n=e.repoID,r=e.toggle,a=e.submit,i=(0,o.useState)(t),l=(0,p.A)(i,2),c=l[0],u=l[1],d=(0,o.useState)(!1),h=(0,p.A)(d,2),m=h[0],g=h[1],v=(0,o.useState)(!1),C=(0,p.A)(v,2),A=C[0],x=C[1],b=(0,o.useCallback)((function(){m||r&&r()}),[m,r]),_=(0,o.useCallback)((function(){c?(g(!0),_r.A.createMetadata(n).then((function(e){a(!0),r()})).catch((function(e){var t=ae.Aq.getErrorMsg(e);f.A.danger(t),g(!1)}))):x(!0)}),[n,c,a,r]),w=(0,o.useCallback)((function(){x(!A)}),[A]),S=(0,o.useCallback)((function(){x(!1),g(!0),_r.A.deleteMetadata(n).then((function(e){a(!1),r()})).catch((function(e){var t=ae.Aq.getErrorMsg(e);f.A.danger(t),g(!1)}))}),[n,a,r]),D=(0,o.useCallback)((function(){u(!c)}),[c]);return(0,s.jsxs)(s.Fragment,{children:[!A&&(0,s.jsxs)(vr.A,{className:"metadata-status-management-dialog",isOpen:!0,toggle:b,children:[(0,s.jsx)(yr.A,{toggle:b,children:(0,F.AP)("Extended properties management")}),(0,s.jsxs)(Cr.A,{children:[(0,s.jsx)(br.A,{checked:c,disabled:m,size:"large",textPosition:"right",className:y()("change-metadata-status-management w-100",{disabled:m}),onChange:D,placeholder:(0,F.AP)("Enable extended properties")}),(0,s.jsx)("div",{className:"tip",children:(0,F.AP)("After enable extended properties for files, you can add different properties to files, like collaborators, file expiring time, file description. You can also create different views for files based extended properties.")})]}),(0,s.jsxs)(Ar.A,{children:[(0,s.jsx)(xr.A,{color:"secondary",onClick:b,children:(0,F.AP)("Cancel")}),(0,s.jsx)(xr.A,{color:"primary",disabled:t===c||m,onClick:_,children:(0,F.AP)("Submit")})]})]}),A&&(0,s.jsx)(wr,{toggle:w,submit:S})]})},Dr=n(85077),Er=n(95754),kr=n(36402),Mr=n(76115),Ir=n(33175),Nr=function(e){var t=e.value,n=e.target,r=e.otherViewsName,a=e.toggle,c=e.onSubmit,u=(0,o.useState)(t||""),d=(0,p.A)(u,2),f=d[0],h=d[1],g=(0,o.useState)(""),v=(0,p.A)(g,2),y=v[0],C=v[1],A=(0,o.useRef)(null),x=(0,o.useCallback)((function(e){h(e.target.value)}),[]),b=(0,o.useCallback)((function(){a()}),[a]),_=(0,o.useCallback)((function(e){e.preventDefault(),e.stopPropagation();var n=(0,m.LWT)(f,r),o=n.isValid,a=n.message;if(!o)return C(a),void A.current.focus();a!==t?c(a):b()}),[t,f,r,c,b]),w=(0,o.useCallback)((function(e){(0,Ir.isEnter)(e)&&_(e)}),[_]);return(0,s.jsxs)(l.Rw,{className:"sf-metadata-rename-view-popover",target:n,placement:"right-start",hideArrow:!0,fade:!1,modifiers:{preventOverflow:{boundariesElement:document.body}},canHide:!y,hide:b,hideWithEsc:b,children:[(0,s.jsx)("div",{className:"sf-metadata-rename-view-popover-header",children:(0,i.AP)("Rename view")}),(0,s.jsx)("div",{className:"seafile-divider dropdown-divider"}),(0,s.jsxs)("div",{className:"sf-metadata-rename-view-popover-body",children:[(0,s.jsx)(Dr.A,{innerRef:A,className:"sf-metadata-view-rename-input",value:f,onChange:x,autoFocus:!0,onBlur:_,onKeyDown:w}),y&&(0,s.jsx)(Mr.A,{color:"danger",className:"mt-2 mb-0",children:y})]})]})},Pr=n(42119),Tr=[{key:"table",type:m.rX9.TABLE},{key:"gallery",type:m.rX9.GALLERY}],Or=function(e){var t=e.target,n=e.toggle,r=e.onOptionClick,a=(0,o.useRef)(null),l=(0,o.useCallback)((function(e){a.current&&!a.current.contains(e.target)&&n(e)}),[n]);(0,o.useEffect)((function(){return a.current&&document.addEventListener("click",l,!0),function(){document.removeEventListener("click",l,!0)}}),[l]);var c=(0,o.useCallback)((function(e){switch(e){case m.rX9.TABLE:return(0,i.AP)("Table");case m.rX9.GALLERY:return(0,i.AP)("Gallery");default:return e}}),[]);return(0,s.jsx)(Pr.A,{className:"sf-metadata-addview-popover",isOpen:!0,toggle:n,target:t,placement:"right-start",hideArrow:!0,fade:!1,boundariesElement:document.body,children:(0,s.jsxs)("div",{ref:a,children:[(0,s.jsx)("div",{className:"sf-metadata-addview-popover-header",children:(0,i.AP)("New view")}),(0,s.jsx)("div",{className:"sf-metadata-addview-popover-body",children:Tr.map((function(e,t){return(0,s.jsxs)("button",{className:"dropdown-item sf-metadata-addview-popover-item",onClick:function(){return r(e)},children:[(0,s.jsx)("div",{className:"left-icon",children:(0,s.jsx)(Er.A,{symbol:m.jWt[e.type]||"table",className:"metadata-view-icon"})}),(0,s.jsx)("div",{children:c(e.type)})]},t)}))})]})})},jr=function(e){var t=e.canDelete,n=e.userPerm,r=e.isSelected,a=e.view,i=e.onClick,l=e.onDelete,c=e.onCopy,u=e.onUpdate,d=e.onMove,f=(0,o.useState)(!1),h=(0,p.A)(f,2),g=h[0],v=h[1],C=(0,o.useState)(!1),A=(0,p.A)(C,2),x=A[0],b=A[1],_=(0,o.useState)(!1),w=(0,p.A)(_,2),S=w[0],D=w[1],E=(0,o.useState)(!1),k=(0,p.A)(E,2),M=k[0],I=k[1],N=(0,oe.p_)().viewsMap,P=Object.values(N).filter((function(e){return e._id!==a._id})).map((function(e){return e.name})),T=(0,o.useMemo)((function(){return"rw"===n||"admin"===n}),[n]),O=(0,o.useMemo)((function(){return!(ae.Aq.isIEBrowser()||!T)}),[T]),j=(0,o.useMemo)((function(){if(!T)return[];var e=[{key:"rename",value:(0,F.AP)("Rename")},{key:"duplicate",value:(0,F.AP)("Duplicate")}];return t&&e.push({key:"delete",value:(0,F.AP)("Delete")}),e}),[T,t]),R=(0,o.useCallback)((function(){x||v(!0)}),[x]),L=(0,o.useCallback)((function(){x||v(!0)}),[x]),U=(0,o.useCallback)((function(){x||v(!1)}),[x]),Y=(0,o.useCallback)((function(){b(!0)}),[]),B=(0,o.useCallback)((function(){b(!1),v(!1)}),[]),H=(0,o.useCallback)((function(e){"rename"!==e?"duplicate"!==e?"delete"!==e||l():c():I(!0)}),[l,c]),V=(0,o.useCallback)((function(){I(!1)}),[]),G=(0,o.useCallback)((function(e,t){u({name:e},(function(){I(!1)}),t)}),[u]),q=(0,o.useCallback)((function(e){if(!O)return!1;var t=JSON.stringify({type:"sf-metadata-view",view_id:a._id});e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("application/drag-sf-metadata-view",t)}),[O,a]),z=(0,o.useCallback)((function(e){if(!O)return!1;D(!0)}),[O]),W=(0,o.useCallback)((function(){if(!O)return!1;D(!1)}),[O]),K=(0,o.useCallback)((function(e){if(!O)return!1;e.preventDefault(),e.dataTransfer.dropEffect="move"}),[O]),Z=(0,o.useCallback)((function(e){if(!O)return!1;e.stopPropagation(),D(!1);var t=e.dataTransfer.getData("application/drag-sf-metadata-view");if(t){if("sf-metadata-view"!==(t=JSON.parse(t)).type)return!1;t.view_id&&d&&d(t.view_id,a._id)}}),[O,a,d]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:y()("tree-node-inner text-nowrap",{"tree-node-inner-hover":g,"tree-node-hight-light":r,"tree-node-drop":S}),title:(0,F.AP)("File extended properties"),onMouseEnter:R,onMouseOver:L,onMouseLeave:U,onClick:function(){return i(a)},children:[(0,s.jsx)("div",{className:"tree-node-text",draggable:T,onDragStart:q,onDragEnter:z,onDragLeave:W,onDragOver:K,onDrop:Z,children:a.name}),(0,s.jsx)("div",{className:"left-icon",children:(0,s.jsx)("div",{className:"tree-node-icon",children:(0,s.jsx)(Er.A,{symbol:m.jWt[a.type]||"table",className:"metadata-views-icon"})})}),(0,s.jsx)("div",{className:"right-icon",id:"metadata-view-dropdown-item-".concat(a._id),children:g&&(0,s.jsx)(kr.A,{item:{name:"metadata-view"},toggleClass:"sf3-font sf3-font-more",freezeItem:Y,unfreezeItem:B,getMenuList:function(){return j},onMenuItemClick:H,menuStyle:ae.Fr?{zIndex:1050}:{}})})]}),M&&(0,s.jsx)(Nr,{value:a.name,otherViewsName:P,target:"metadata-view-dropdown-item-".concat(a._id),toggle:V,onSubmit:G})]})},Rr=function(e){var t=e.userPerm,n=e.currentPath,r=(0,o.useMemo)((function(){return"rw"===t||"admin"===t}),[t]),a=(0,o.useState)(0),i=(0,p.A)(a,2)[1],c=(0,oe.p_)(),u=c.showFirstView,d=c.navigation,h=c.viewsMap,g=c.selectView,v=c.addView,y=c.duplicateView,C=c.deleteView,A=c.updateView,x=c.moveView,b=(0,o.useState)(null),_=(0,p.A)(b,2),w=_[0],S=_[1],D=(0,o.useState)(!1),E=(0,p.A)(D,2),k=E[0],M=E[1],I=(0,o.useState)(!1),N=(0,p.A)(I,2),P=N[0],T=N[1],O=(0,o.useRef)(null),j=(0,o.useState)(""),R=(0,p.A)(j,2),L=R[0],U=R[1];(0,o.useEffect)((function(){var e=window.location,t=e.origin,n=e.pathname,r=e.search,o=new URLSearchParams(r).get("view");if(o){var a=h[o]||"";if(a)return void g(a);var i="".concat(t).concat(n);window.history.pushState({url:i,path:""},"",i)}var s=d.find((function(e){return"view"===e.type})),l=s?h[s._id]:"";u&&l&&g(l)}),[]);var Y=(0,o.useCallback)((function(e,t,n,r){A(e,t,(function(){i((function(e){return e+1})),n&&n()}),r)}),[A]),B=function(e){e.stopPropagation(),M(!k)},H=(0,o.useCallback)((function(e){S(e);for(var t=(0,F.AP)("Untitled"),n=Object.values(h).map((function(e){return e.name})),r=1;n.includes(t);)t=(0,F.AP)("Untitled")+" ("+r+++")";U(t),T(!0),M(!1)}),[h]),V=(0,o.useCallback)((function(e){e.preventDefault(),e.stopPropagation();var t=Object.values(h).map((function(e){return e.name})),n=(0,m.LWT)(L,t),r=n.isValid,o=n.message;if(!r)return f.A.danger(o),void O.current.focus();v(o,w.type),T(!1)}),[L,h,v,w]),G=(0,o.useCallback)((function(e){(0,Ir.isEnter)(e)&&V(e)}),[V]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"tree-view tree metadata-tree-view",children:(0,s.jsx)("div",{className:"tree-node",children:(0,s.jsxs)("div",{className:"children",children:[d.map((function(e,r){var o=h[e._id],a="/"+pt.AT.FILE_EXTENDED_PROPERTIES+"/"+o._id,i=n===a;return(0,s.jsx)(jr,{canDelete:0!==r,isSelected:i,userPerm:t,view:o,onClick:function(e){return g(e,i)},onDelete:function(){return C(o._id,i)},onCopy:function(){return y(o._id)},onUpdate:function(e,t,n){return Y(o._id,e,t,n)},onMove:x},o._id)})),P&&(0,s.jsxs)("div",{className:"tree-view-inner sf-metadata-view-form",children:[(0,s.jsx)("div",{className:"left-icon",children:(0,s.jsx)(Er.A,{symbol:m.jWt[w.type]||"table",className:"metadata-views-icon"})}),(0,s.jsx)(Dr.A,{className:"sf-metadata-view-input",innerRef:O,value:L,onChange:function(e){U(e.target.value)},autoFocus:!0,onBlur:V,onKeyDown:G})]}),r&&(0,s.jsx)("div",{id:"sf-metadata-view-popover",children:(0,s.jsx)(l.NC,{className:"sf-metadata-add-view",callBack:B,footerName:(0,F.AP)("Add view"),addIconClassName:"sf-metadata-add-view-icon"})})]})})}),k&&(0,s.jsx)(Or,{target:"sf-metadata-view-popover",toggle:B,onOptionClick:H})]})},Lr=n(31195),Fr=[m.L2D.ID,m.L2D.CTIME,m.L2D.MTIME,m.L2D.CREATOR,m.L2D.LAST_MODIFIER,m.L2D.FILE_CREATOR,m.L2D.FILE_CTIME,m.L2D.FILE_MODIFIER,m.L2D.FILE_MTIME,m.L2D.PARENT_DIR,m.L2D.FILE_NAME,m.L2D.IS_DIR,m.L2D.FILE_TYPE,m.L2D.OBJ_ID,m.L2D.SIZE,m.L2D.SUFFIX,m.L2D.FILE_DETAILS],Ur=["/_Internal","/images"],Yr=["type","key"],Br=n(92811),Hr=function(e){var t=e.repoID,n=e.filePath,a=e.repoInfo,i=e.direntType,l=(0,o.useState)(!0),u=(0,p.A)(l,2),d=u[0],h=u[1],v=(0,o.useState)({record:{},fields:[]}),y=(0,p.A)(v,2),C=y[0],A=y[1],x=(0,o.useMemo)((function(){return"admin"!==a.permission&&"rw"!==a.permission?"r":"rw"}),[a]);(0,o.useEffect)((function(){if(h(!0),Ur.find((function(e){return n.startsWith(e)})))h(!1);else{var e=ae.Aq.getDirName(n),o=ae.Aq.getFileName(n),a="file"===i?e:e.slice(0,e.length-o.length-1);a.startsWith("/")||(a="/"+a),_r.A.getMetadataRecordInfo(t,a,o).then((function(e){var t=e.data,n=t.results,a=t.metadata,i=Array.isArray(n)&&n.length>0?n[0]:{},s=function(e){if(!Array.isArray(e)||0===e.length)return[];var t=e.map((function(e){var t=e.type,n=e.key,o=(0,g.A)(e,Yr);return(0,r.A)((0,r.A)({},o),{},{key:n,type:(0,G.nh)(n,t),width:200})})).filter((function(e){return!Fr.includes(e.key)})),n=[];return t.forEach((function(e){n.push(e)})),n}(a).map((function(e){return new Lr.A(e)}));ae.Aq.imageCheck(o)||(s=s.filter((function(e){return e.key!==m.L2D.LOCATION}))),A({record:i,fields:s}),h(!1)})).catch((function(e){var t=ae.Aq.getErrorMsg(e);f.A.danger(t),h(!1)}))}}),[t,n,i]);var b=(0,o.useCallback)((function(e,n){var o=C.record,a=C.fields.find((function(t){return t.key===e})),i=(0,G.KO)(a),s=(0,c.default)({},i,n);if(m.LOw.includes(a.key)||a.type!==m.vZe.SINGLE_SELECT)a.type===m.vZe.MULTIPLE_SELECT&&(s=(0,c.default)({},i,n?(0,m.zXq)(a,n):[]));else{var l=(0,m.FiT)(a);s=(0,c.default)({},i,(0,m.BW0)(l,n))}_r.A.modifyRecord(t,o._id,s,o._obj_id).then((function(e){var t=(0,r.A)((0,r.A)({},C),{},{record:(0,r.A)((0,r.A)({},o),s)});A(t)})).catch((function(e){var t=ae.Aq.getErrorMsg(e);f.A.danger(t)}))}),[t,C]),_=(0,o.useCallback)((function(e,n){var o,a=C.fields,i=C.record,s=a.slice(0);_r.A.modifyColumnData(t,e,n).then((function(t){var n=new Lr.A(t.data.column),r=a.findIndex((function(t){return t.key===e}));return s[r]=n,n})).then((function(n){var r=(0,G.KO)(n),a=(0,m.FiT)(n),s=a[a.length-1];if(o=(0,c.default)({},r,s.id),m.LOw.includes(e)||n.type!==m.vZe.SINGLE_SELECT){if(n.type===m.vZe.MULTIPLE_SELECT){var l=(0,m.Teq)(i,n)||[];o=(0,c.default)({},r,[].concat((0,xe.A)(l),[s.name]))}}else o=(0,c.default)({},r,(0,m.BW0)(a,s.id));return _r.A.modifyRecord(t,i._id,o,i._obj_id)})).then((function(e){var t=(0,r.A)((0,r.A)({},C),{},{record:(0,r.A)((0,r.A)({},i),o),fields:s});A(t)})).catch((function(e){var t=ae.Aq.getErrorMsg(e);f.A.danger(t)}))}),[t,C]);if(d)return null;var w=C.fields,S=C.record;return S._id?(0,s.jsx)(s.Fragment,{children:w.map((function(e){var t="rw"===x&&e.editable,n=(0,m.Teq)(S,e);return(0,s.jsx)(Br.A,{field:e,readonly:!t,children:t?(0,s.jsx)(hr,{field:e,value:n,onChange:b,fields:w,record:S,modifyColumnData:_}):(0,s.jsx)(se,{field:e,value:n,emptyTip:(0,F.AP)("Empty"),className:"sf-metadata-property-detail-formatter"})},e.key)}))}):null}},84307:function(e,t,n){"use strict";n.d(t,{Kv:function(){return d},ZP:function(){return l},gm:function(){return c},vZ:function(){return i},BQ:function(){return u},cV:function(){return m},sN:function(){return h},D2:function(){return p},KY:function(){return g},SR:function(){return w},JI:function(){return _},fz:function(){return A},_W:function(){return M},Ar:function(){return I},Zu:function(){return N},Tx:function(){return y},Tu:function(){return D},CJ:function(){return v},LO:function(){return S},L2:function(){return x},Aj:function(){return b},uC:function(){return P},Wv:function(){return T},Tv:function(){return O},rT:function(){return C},T6:function(){return f},hT:function(){return E}});var r,o,a,i={DEFAULT:"default",TEXT:"text",CREATOR:"creator",CTIME:"ctime",LAST_MODIFIER:"last-modifier",MTIME:"mtime",FILE_NAME:"file-name",CHECKBOX:"checkbox",COLLABORATOR:"collaborator",DATE:"date",LONG_TEXT:"long-text",SINGLE_SELECT:"single-select",MULTIPLE_SELECT:"multiple-select",NUMBER:"number",GEOLOCATION:"geolocation",RATE:"rate"},s=n(64467),l=(r={},(0,s.default)((0,s.default)((0,s.default)((0,s.default)((0,s.default)((0,s.default)((0,s.default)((0,s.default)((0,s.default)((0,s.default)(r,i.CREATOR,"creator"),i.LAST_MODIFIER,"creator"),i.CTIME,"creation-time"),i.MTIME,"creation-time"),i.DEFAULT,"text"),i.TEXT,"text"),i.FILE_NAME,"text"),i.CHECKBOX,"checkbox"),i.COLLABORATOR,"collaborator"),i.DATE,"date"),(0,s.default)((0,s.default)((0,s.default)((0,s.default)((0,s.default)((0,s.default)(r,i.LONG_TEXT,"long-text"),i.SINGLE_SELECT,"single-select"),i.MULTIPLE_SELECT,"multiple-select"),i.NUMBER,"number"),i.GEOLOCATION,"location"),i.RATE,"rate")),c=(o={},(0,s.default)((0,s.default)((0,s.default)((0,s.default)((0,s.default)((0,s.default)((0,s.default)((0,s.default)((0,s.default)((0,s.default)(o,i.CREATOR,"Creator"),i.LAST_MODIFIER,"Last modifier"),i.CTIME,"CTime"),i.MTIME,"Last modified time"),i.DEFAULT,"Text"),i.TEXT,"Text"),i.FILE_NAME,"File name"),i.CHECKBOX,"Checkbox"),i.COLLABORATOR,"Collaborator"),i.DATE,"Date"),(0,s.default)((0,s.default)((0,s.default)((0,s.default)((0,s.default)((0,s.default)(o,i.LONG_TEXT,"Long text"),i.SINGLE_SELECT,"Single select"),i.MULTIPLE_SELECT,"Multiple select"),i.NUMBER,"Number"),i.GEOLOCATION,"Geolocation"),i.RATE,"Rate")),u=[i.CTIME,i.MTIME,i.DATE],d=(i.NUMBER,i.RATE,[i.CREATOR,i.LAST_MODIFIER,i.COLLABORATOR]),p="YYYY-MM-DD",f="YYYY-MM-DDTHH:mm:ss.SSSZ",h={YEAR:"year",MONTH:"month",WEEK:"week",DAY:"day",HOUR:"hour",HOURS:"hours",MINUTE:"minute",MINUTES:"minutes",SECOND:"second"},m={YYYY_MM_DD:"YYYY-MM-DD",YYYY_MM_DD_HH_MM:"YYYY-MM-DD HH:mm",YYYY_MM_DD_HH_MM_SS:"YYYY-MM-DD HH:mm:ss"},g="number",v=(i.CTIME,i.MTIME,i.CREATOR,i.LAST_MODIFIER,(0,s.default)((0,s.default)((0,s.default)((0,s.default)({},i.CTIME,!0),i.MTIME,!0),i.CREATOR,!0),i.LAST_MODIFIER,!0)),y=(0,s.default)((0,s.default)({},i.COLLABORATOR,!0),i.MULTIPLE_SELECT,!0),C=(a={},(0,s.default)((0,s.default)((0,s.default)((0,s.default)((0,s.default)((0,s.default)((0,s.default)((0,s.default)((0,s.default)((0,s.default)(a,i.TEXT,!0),i.CTIME,!0),i.MTIME,!0),i.CREATOR,!0),i.LAST_MODIFIER,!0),i.FILE_NAME,!0),i.CHECKBOX,!0),i.DATE,!0),i.LONG_TEXT,!0),i.SINGLE_SELECT,!0),(0,s.default)((0,s.default)(a,i.NUMBER,!0),i.RATE,!0)),A={LNG_LAT:"lng_lat",COUNTRY_REGION:"country_region",PROVINCE:"province",PROVINCE_CITY:"province_city",PROVINCE_CITY_DISTRICT:"province_city_district",MAP_SELECTION:"map_selection"},x={ID:"_id",CTIME:"_ctime",MTIME:"_mtime",CREATOR:"_creator",LAST_MODIFIER:"_last_modifier",IS_DIR:"_is_dir",PARENT_DIR:"_parent_dir",FILE_CTIME:"_file_ctime",FILE_MTIME:"_file_mtime",FILE_CREATOR:"_file_creator",FILE_MODIFIER:"_file_modifier",FILE_NAME:"_name",FILE_TYPE:"_file_type",FILE_COLLABORATORS:"_collaborators",FILE_EXPIRE_TIME:"_expire_time",FILE_KEYWORDS:"_keywords",FILE_DESCRIPTION:"_description",FILE_EXPIRED:"_expired",FILE_STATUS:"_status",LOCATION:"_location",OBJ_ID:"_obj_id",SIZE:"_size",SUFFIX:"_suffix",FILE_DETAILS:"_file_details"},b=[x.ID,x.CTIME,x.MTIME,x.CREATOR,x.LAST_MODIFIER,x.IS_DIR,x.PARENT_DIR,x.FILE_CTIME,x.FILE_MTIME,x.FILE_CREATOR,x.FILE_MODIFIER,x.FILE_NAME,x.FILE_TYPE,x.FILE_COLLABORATORS,x.FILE_EXPIRE_TIME,x.FILE_KEYWORDS,x.FILE_DESCRIPTION,x.FILE_EXPIRED,x.FILE_STATUS,x.LOCATION,x.OBJ_ID,x.SIZE,x.SUFFIX,x.FILE_DETAILS],_=[x.FILE_COLLABORATORS,x.FILE_EXPIRE_TIME,x.FILE_KEYWORDS,x.FILE_DESCRIPTION,x.FILE_EXPIRED,x.FILE_STATUS],w=[],S=(x.FILE_COLLABORATORS,x.FILE_EXPIRE_TIME,x.FILE_KEYWORDS,x.FILE_DESCRIPTION,x.FILE_EXPIRED,x.FILE_STATUS,[x.FILE_COLLABORATORS,x.FILE_EXPIRE_TIME,x.FILE_KEYWORDS,x.FILE_DESCRIPTION,x.FILE_EXPIRED,x.FILE_STATUS]),D=[x.ID,x.CTIME,x.MTIME,x.CREATOR,x.LAST_MODIFIER,x.OBJ_ID,x.SUFFIX,x.FILE_DETAILS,x.LOCATION,x.IS_DIR],E=[x.IS_DIR],k=n(40326),M=(0,s.default)((0,s.default)({},i.TEXT,1e4),i.LONG_TEXT,1e5),I=(0,k.AP)("The content of the document has exceeded the limit of 100000 characters, and the content cannot be saved"),N=(0,k.AP)("The content of the document has exceeded the limit of 100000 characters, and only the first 100000 characters are saved"),P=["#FF8000","#FFB600","#E91E63","#EB00B1","#7626FD","#1DDD1D","#02C0FF","#00C9C7","#1688FC","#656463"],T=[{name:1},{name:2},{name:3},{name:4},{name:5},{name:6},{name:7},{name:8},{name:9},{name:10}],O=["rate","like","praise","flag"]},73224:function(e,t,n){"use strict";n.d(t,{X:function(){return i},_:function(){return s}});var r,o=n(64467),a=n(40326),i={TODAY:"today",TOMORROW:"tomorrow",YESTERDAY:"yesterday",ONE_WEEK_AGO:"one_week_ago",ONE_WEEK_FROM_NOW:"one_week_from_now",ONE_MONTH_AGO:"one_month_ago",ONE_MONTH_FROM_NOW:"one_month_from_now",NUMBER_OF_DAYS_AGO:"number_of_days_ago",NUMBER_OF_DAYS_FROM_NOW:"number_of_days_from_now",EXACT_DATE:"exact_date",THE_PAST_WEEK:"the_past_week",THE_PAST_MONTH:"the_past_month",THE_PAST_YEAR:"the_past_year",THE_NEXT_WEEK:"the_next_week",THE_NEXT_MONTH:"the_next_month",THE_NEXT_YEAR:"the_next_year",THE_NEXT_NUMBERS_OF_DAYS:"the_next_numbers_of_days",THE_PAST_NUMBERS_OF_DAYS:"the_past_numbers_of_days",THIS_WEEK:"this_week",THIS_MONTH:"this_month",THIS_YEAR:"this_year"},s=(r={},(0,o.default)((0,o.default)((0,o.default)((0,o.default)((0,o.default)((0,o.default)((0,o.default)((0,o.default)((0,o.default)((0,o.default)(r,i.TODAY,(0,a.AP)("Today")),i.TOMORROW,(0,a.AP)("Tomorrow")),i.YESTERDAY,(0,a.AP)("Yesterday")),i.ONE_WEEK_AGO,(0,a.AP)("One week ago")),i.ONE_WEEK_FROM_NOW,(0,a.AP)("One week from now")),i.ONE_MONTH_AGO,(0,a.AP)("One month ago")),i.ONE_MONTH_FROM_NOW,(0,a.AP)("One month from now")),i.NUMBER_OF_DAYS_AGO,(0,a.AP)("Number of days ago")),i.NUMBER_OF_DAYS_FROM_NOW,(0,a.AP)("Number of days from now")),i.EXACT_DATE,(0,a.AP)("Exact date")),(0,o.default)((0,o.default)((0,o.default)((0,o.default)((0,o.default)((0,o.default)((0,o.default)((0,o.default)((0,o.default)((0,o.default)(r,i.THE_PAST_WEEK,(0,a.AP)("The past week")),i.THE_PAST_MONTH,(0,a.AP)("The past month")),i.THE_PAST_YEAR,(0,a.AP)("The past year")),i.THE_NEXT_WEEK,(0,a.AP)("The next week")),i.THE_NEXT_MONTH,(0,a.AP)("The next month")),i.THE_NEXT_YEAR,(0,a.AP)("The next year")),i.THE_NEXT_NUMBERS_OF_DAYS,(0,a.AP)("The next numbers of days")),i.THE_PAST_NUMBERS_OF_DAYS,(0,a.AP)("The past numbers of days")),i.THIS_WEEK,(0,a.AP)("This week")),i.THIS_MONTH,(0,a.AP)("This month")),(0,o.default)(r,i.THIS_YEAR,(0,a.AP)("This year")))},32728:function(e,t,n){"use strict";n.d(t,{U:function(){return i},b:function(){return s}});var r,o=n(64467),a=n(40326),i={CONTAINS:"contains",NOT_CONTAIN:"does_not_contain",IS:"is",IS_NOT:"is_not",EQUAL:"equal",NOT_EQUAL:"not_equal",LESS:"less",GREATER:"greater",LESS_OR_EQUAL:"less_or_equal",GREATER_OR_EQUAL:"greater_or_equal",EMPTY:"is_empty",NOT_EMPTY:"is_not_empty",IS_WITHIN:"is_within",IS_BEFORE:"is_before",IS_AFTER:"is_after",IS_ON_OR_BEFORE:"is_on_or_before",IS_ON_OR_AFTER:"is_on_or_after",HAS_ANY_OF:"has_any_of",HAS_ALL_OF:"has_all_of",HAS_NONE_OF:"has_none_of",IS_EXACTLY:"is_exactly",INCLUDE_ME:"include_me",IS_CURRENT_USER_ID:"is_current_user_ID",IS_ANY_OF:"is_any_of",IS_NONE_OF:"is_none_of"},s=(r={},(0,o.default)((0,o.default)((0,o.default)((0,o.default)((0,o.default)((0,o.default)((0,o.default)((0,o.default)((0,o.default)((0,o.default)(r,i.CONTAINS,(0,a.AP)("contains")),i.NOT_CONTAIN,(0,a.AP)("does not contain")),i.IS,(0,a.AP)("is")),i.IS_NOT,(0,a.AP)("is not")),i.EQUAL,"="),i.NOT_EQUAL,"\u2260"),i.LESS,"<"),i.GREATER,">"),i.LESS_OR_EQUAL,"\u2264"),i.GREATER_OR_EQUAL,"\u2265"),(0,o.default)((0,o.default)((0,o.default)((0,o.default)((0,o.default)((0,o.default)((0,o.default)((0,o.default)((0,o.default)((0,o.default)(r,i.EMPTY,(0,a.AP)("is empty")),i.NOT_EMPTY,(0,a.AP)("is not empty")),i.IS_WITHIN,(0,a.AP)("is within...")),i.IS_BEFORE,(0,a.AP)("is before...")),i.IS_AFTER,(0,a.AP)("is after...")),i.IS_ON_OR_BEFORE,(0,a.AP)("is on or before...")),i.IS_ON_OR_AFTER,(0,a.AP)("is on or after...")),i.HAS_ANY_OF,(0,a.AP)("has any of...")),i.HAS_ALL_OF,(0,a.AP)("has all of...")),i.HAS_NONE_OF,(0,a.AP)("has none of...")),(0,o.default)((0,o.default)((0,o.default)((0,o.default)((0,o.default)(r,i.IS_EXACTLY,(0,a.AP)("is exactly...")),i.IS_CURRENT_USER_ID,(0,a.AP)("is current user's ID")),i.INCLUDE_ME,(0,a.AP)("include the current user")),i.IS_ANY_OF,(0,a.AP)("is any of...")),i.IS_NONE_OF,(0,a.AP)("is none of...")))},36149:function(e,t,n){"use strict";n.d(t,{Ts:function(){return p},FK:function(){return m},pQ:function(){return g},bo:function(){return s.b},US:function(){return s.U},_z:function(){return i._},Xu:function(){return i.X},B3:function(){return h},uv:function(){return f}});var r,o=n(64467),a=n(84307),i=n(73224),s=n(32728),l=[s.U.CONTAINS,s.U.NOT_CONTAIN,s.U.IS,s.U.IS_NOT,s.U.EMPTY,s.U.NOT_EMPTY,s.U.IS_CURRENT_USER_ID],c=[s.U.EQUAL,s.U.NOT_EQUAL,s.U.LESS,s.U.GREATER,s.U.LESS_OR_EQUAL,s.U.GREATER_OR_EQUAL,s.U.EMPTY,s.U.NOT_EMPTY],u=[s.U.IS,s.U.IS_WITHIN,s.U.IS_BEFORE,s.U.IS_AFTER,s.U.IS_ON_OR_BEFORE,s.U.IS_ON_OR_AFTER,s.U.IS_NOT,s.U.EMPTY,s.U.NOT_EMPTY],d=[i.X.TODAY,i.X.TOMORROW,i.X.YESTERDAY,i.X.ONE_WEEK_AGO,i.X.ONE_WEEK_FROM_NOW,i.X.ONE_MONTH_AGO,i.X.ONE_MONTH_FROM_NOW,i.X.NUMBER_OF_DAYS_AGO,i.X.NUMBER_OF_DAYS_FROM_NOW,i.X.EXACT_DATE],p=(r={},(0,o.default)((0,o.default)((0,o.default)((0,o.default)((0,o.default)((0,o.default)((0,o.default)((0,o.default)((0,o.default)((0,o.default)(r,a.vZ.TEXT,{filterPredicateList:l}),a.vZ.NUMBER,{filterPredicateList:c}),a.vZ.FILE_NAME,{filterPredicateList:l}),a.vZ.DATE,{filterPredicateList:u,filterTermModifierList:d}),a.vZ.SINGLE_SELECT,{filterPredicateList:[s.U.IS,s.U.IS_NOT,s.U.IS_ANY_OF,s.U.IS_NONE_OF,s.U.EMPTY,s.U.NOT_EMPTY]}),a.vZ.MULTIPLE_SELECT,{filterPredicateList:[s.U.HAS_ANY_OF,s.U.HAS_ALL_OF,s.U.HAS_NONE_OF,s.U.IS_EXACTLY,s.U.EMPTY,s.U.NOT_EMPTY]}),a.vZ.CTIME,{filterPredicateList:u,filterTermModifierList:d}),a.vZ.MTIME,{filterPredicateList:u,filterTermModifierList:d}),a.vZ.CREATOR,{filterPredicateList:[s.U.CONTAINS,s.U.NOT_CONTAIN,s.U.INCLUDE_ME,s.U.IS,s.U.IS_NOT]}),a.vZ.LAST_MODIFIER,{filterPredicateList:[s.U.CONTAINS,s.U.NOT_CONTAIN,s.U.INCLUDE_ME,s.U.IS,s.U.IS_NOT]}),(0,o.default)((0,o.default)((0,o.default)((0,o.default)((0,o.default)(r,a.vZ.CHECKBOX,{filterPredicateList:[s.U.IS]}),a.vZ.URL,{filterPredicateList:[s.U.CONTAINS,s.U.NOT_CONTAIN,s.U.IS,s.U.IS_NOT,s.U.EMPTY,s.U.NOT_EMPTY]}),a.vZ.COLLABORATOR,{filterPredicateList:[s.U.HAS_ANY_OF,s.U.HAS_ALL_OF,s.U.HAS_NONE_OF,s.U.IS_EXACTLY,s.U.EMPTY,s.U.NOT_EMPTY,s.U.INCLUDE_ME]}),a.vZ.LONG_TEXT,{filterPredicateList:[s.U.EMPTY,s.U.NOT_EMPTY]}),a.vZ.RATE,{filterPredicateList:c})),f=[i.X.EXACT_DATE,i.X.TODAY,i.X.TOMORROW,i.X.YESTERDAY,i.X.ONE_WEEK_AGO,i.X.ONE_WEEK_FROM_NOW,i.X.ONE_MONTH_AGO,i.X.ONE_MONTH_FROM_NOW,i.X.NUMBER_OF_DAYS_AGO,i.X.NUMBER_OF_DAYS_FROM_NOW],h=[i.X.THE_PAST_WEEK,i.X.THE_PAST_MONTH,i.X.THE_PAST_YEAR,i.X.THIS_WEEK,i.X.THIS_MONTH,i.X.THIS_YEAR,i.X.THE_NEXT_WEEK,i.X.THE_NEXT_MONTH,i.X.THE_NEXT_YEAR,i.X.THE_NEXT_NUMBERS_OF_DAYS,i.X.THE_PAST_NUMBERS_OF_DAYS],m={AND:"And",OR:"Or"},g={INVALID_FILTER:"invalid filter",INCOMPLETE_FILTER:"incomplete filter",COLUMN_MISSING:"the column to filter does not exist",COLUMN_NOT_SUPPORTED:"the column to filter is not supported",UNMATCHED_PREDICATE:"unmatched filter predicate",UNMATCHED_MODIFIER:"unmatched filter modifier",INVALID_TERM:"invalid filter term"}},81602:function(e,t,n){"use strict";n.d(t,{Ll:function(){return u},Sv:function(){return d},UY:function(){return i},XJ:function(){return s},lj:function(){return c},mm:function(){return a},wA:function(){return l}});var r=n(64467),o=n(84307),a=3,i={DAY:"day",WEEK:"week",MONTH:"month",QUARTER:"quarter",YEAR:"year"},s=(0,r.default)((0,r.default)((0,r.default)((0,r.default)((0,r.default)({},i.DAY,"By day"),i.WEEK,"By week"),i.MONTH,"By month"),i.QUARTER,"By quarter"),i.YEAR,"By year"),l={PROVINCE:"province",CITY:"city",DISTRICT:"district",COUNTRY:"country"},c=(0,r.default)((0,r.default)((0,r.default)({},l.PROVINCE,"By province"),l.CITY,"By city"),l.DISTRICT,"By district"),u=[o.vZ.TEXT,o.vZ.DATE,o.vZ.CTIME,o.vZ.MTIME,o.vZ.CHECKBOX,o.vZ.SINGLE_SELECT,o.vZ.MULTIPLE_SELECT,o.vZ.COLLABORATOR,o.vZ.CREATOR,o.vZ.LAST_MODIFIER,o.vZ.GEOLOCATION,o.vZ.RATE],d=[i.DAY,i.WEEK,i.MONTH,i.QUARTER,i.YEAR]},52719:function(e,t,n){"use strict";n.d(t,{ZP:function(){return g.ZP},gm:function(){return g.gm},vZ:function(){return g.vZ},sN:function(){return g.sN},D2:function(){return g.D2},KY:function(){return g.KY},XJ:function(){return y.XJ},lj:function(){return y.lj},SR:function(){return g.SR},JI:function(){return g.JI},Ts:function(){return v.Ts},pQ:function(){return v.pQ},bo:function(){return v.bo},US:function(){return v.US},_z:function(){return v._z},Xu:function(){return v.Xu},fz:function(){return g.fz},Sv:function(){return y.Sv},UY:function(){return y.UY},wA:function(){return y.wA},Jl:function(){return C},cK:function(){return a()},Ar:function(){return g.Ar},Zu:function(){return g.Zu},mm:function(){return y.mm},Tu:function(){return g.Tu},CJ:function(){return g.CJ},LO:function(){return g.LO},L2:function(){return g.L2},Aj:function(){return g.Aj},uC:function(){return g.uC},Wv:function(){return g.Wv},Tv:function(){return g.Tv},Gi:function(){return A.G},Xe:function(){return x.oC},dc:function(){return x.dc},Cl:function(){return x.Cl},Ll:function(){return y.Ll},T6:function(){return g.T6},cP:function(){return j},hT:function(){return g.hT},p:function(){return O},rX:function(){return I},pk:function(){return P},hc:function(){return T},jW:function(){return N},Mu:function(){return r},B3:function(){return v.B3},uv:function(){return v.uv}});var r={};n.r(r),n.d(r,{OB:function(){return i},wt:function(){return m},dC:function(){return p},WA:function(){return d},Rc:function(){return h},HK:function(){return f},rW:function(){return u},dg:function(){return l},gA:function(){return c},NT:function(){return s}});var o=n(76805),a=n.n(o),i=1,s=1,l=2,c=2,u=2,d=2,p=3,f=4,h=4,m=9,g=n(84307),v=n(36149),y=n(81602),C={DEFAULT:"default",DOUBLE:"double"},A=n(34807),x=n(21905),b=n(64467),_="ERROR",w="DIV/0",S="NAME",D="NULL",E="VALUE",k="GETTING_DATA",M=(0,b.default)((0,b.default)((0,b.default)((0,b.default)((0,b.default)((0,b.default)((0,b.default)((0,b.default)((0,b.default)({},_,"#ERROR!"),w,"#DIV/0!"),S,"#NAME?"),"N/A","#N/A"),D,"#NULL!"),"NUM","#NUM!"),"REF","#REF!"),E,"#VALUE!"),k,"#GETTING_DATA"),I=(M[_],M[w],M[S],M["N/A"],M[D],M.NUM,M.REF,M[E],M[k],{TABLE:"table",GALLERY:"gallery"}),N=(0,b.default)((0,b.default)((0,b.default)({},I.TABLE,"table"),I.GALLERY,"image"),"image","image"),P=(0,b.default)((0,b.default)({},I.TABLE,[{column_key:g.L2.IS_DIR,filter_predicate:v.US.IS,filter_term:"file"}]),I.GALLERY,[{column_key:g.L2.FILE_TYPE,filter_predicate:v.US.IS,filter_term:"picture"}]),T=(0,b.default)((0,b.default)({},I.TABLE,[]),I.GALLERY,[{column_key:g.L2.FILE_CTIME,sort_type:x.Cl.DOWN}]),O=(0,b.default)((0,b.default)({},I.TABLE,x.dc),I.GALLERY,x.cV),j=(0,b.default)((0,b.default)({},I.TABLE,x.dc),I.GALLERY,x.zN)},76805:function(e){e.exports={Backspace:8,Tab:9,Enter:13,Shift:16,Ctrl:17,Alt:18,PauseBreak:19,CapsLock:20,Escape:27,Esc:27,Space:32,PageUp:33,PageDown:34,End:35,Home:36,LeftArrow:37,UpArrow:38,RightArrow:39,DownArrow:40,Insert:45,Delete:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,LeftWindowKey:91,RightWindowKey:92,SelectKey:93,NumPad0:96,NumPad1:97,NumPad2:98,NumPad3:99,NumPad4:100,NumPad5:101,NumPad6:102,NumPad7:103,NumPad8:104,NumPad9:105,Multiply:106,Add:107,Subtract:109,DecimalPoint:110,Divide:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F12:123,NumLock:144,ScrollLock:145,SemiColon:186,EqualSign:187,Comma:188,Dash:189,Period:190,ForwardSlash:191,GraveAccent:192,OpenBracket:219,BackSlash:220,CloseBracket:221,SingleQuote:222,ChineseInputMethod:229}},34807:function(e,t,n){"use strict";n.d(t,{G:function(){return r}});var r=[{COLOR:"#FFFCB5",BORDER_COLOR:"#E8E79D",TEXT_COLOR:"#212529"},{COLOR:"#FFEAB6",BORDER_COLOR:"#ECD084",TEXT_COLOR:"#212529"},{COLOR:"#FFD9C8",BORDER_COLOR:"#EFBAA3",TEXT_COLOR:"#212529"},{COLOR:"#FFDDE5",BORDER_COLOR:"#EDC4C1",TEXT_COLOR:"#212529"},{COLOR:"#FFD4FF",BORDER_COLOR:"#E6B6E6",TEXT_COLOR:"#212529"},{COLOR:"#DAD7FF",BORDER_COLOR:"#C3BEEF",TEXT_COLOR:"#212529"},{COLOR:"#DDFFE6",BORDER_COLOR:"#BBEBCD",TEXT_COLOR:"#212529"},{COLOR:"#DEF7C4",BORDER_COLOR:"#C5EB9E",TEXT_COLOR:"#212529"},{COLOR:"#D8FAFF",BORDER_COLOR:"#B4E4E9",TEXT_COLOR:"#212529"},{COLOR:"#D7E8FF",BORDER_COLOR:"#BAD1E9",TEXT_COLOR:"#212529"},{COLOR:"#B7CEF9",BORDER_COLOR:"#96B2E1",TEXT_COLOR:"#212529"},{COLOR:"#E9E9E9",BORDER_COLOR:"#DADADA",TEXT_COLOR:"#212529"},{COLOR:"#FBD44A",BORDER_COLOR:"#E5C142",TEXT_COLOR:"#FFFFFF"},{COLOR:"#EAA775",BORDER_COLOR:"#D59361",TEXT_COLOR:"#FFFFFF"},{COLOR:"#F4667C",BORDER_COLOR:"#DC556A",TEXT_COLOR:"#FFFFFF"},{COLOR:"#DC82D2",BORDER_COLOR:"#D166C5",TEXT_COLOR:"#FFFFFF"},{COLOR:"#9860E5",BORDER_COLOR:"#844BD2",TEXT_COLOR:"#FFFFFF"},{COLOR:"#9F8CF1",BORDER_COLOR:"#8F75E2",TEXT_COLOR:"#FFFFFF"},{COLOR:"#59CB74",BORDER_COLOR:"#4EB867",TEXT_COLOR:"#FFFFFF"},{COLOR:"#ADDF84",BORDER_COLOR:"#9CCF72",TEXT_COLOR:"#FFFFFF"},{COLOR:"#89D2EA",BORDER_COLOR:"#7BC0D6",TEXT_COLOR:"#FFFFFF"},{COLOR:"#4ECCCB",BORDER_COLOR:"#45BAB9",TEXT_COLOR:"#FFFFFF"},{COLOR:"#46A1FD",BORDER_COLOR:"#3C8FE4",TEXT_COLOR:"#FFFFFF"},{COLOR:"#C2C2C2",BORDER_COLOR:"#ADADAD",TEXT_COLOR:"#FFFFFF"}]},21905:function(e,t,n){"use strict";n.d(t,{$4:function(){return u},Cl:function(){return o},FI:function(){return c},cV:function(){return s},dc:function(){return a},oC:function(){return i},zN:function(){return l}});var r=n(84307),o={UP:"up",DOWN:"down"},a=[r.vZ.FILE_NAME,r.vZ.CTIME,r.vZ.MTIME,r.vZ.TEXT,r.vZ.DATE,r.vZ.SINGLE_SELECT,r.vZ.MULTIPLE_SELECT,r.vZ.COLLABORATOR,r.vZ.CHECKBOX,r.vZ.NUMBER,r.vZ.RATE],i=[r.vZ.LONG_TEXT,r.vZ.GEOLOCATION,r.vZ.CREATOR,r.vZ.LAST_MODIFIER],s=[r.vZ.CTIME,r.vZ.MTIME,r.vZ.RATE,r.vZ.NUMBER,r.vZ.FILE_NAME],l=[r.vZ.CTIME,r.vZ.MTIME],c=[r.vZ.TEXT],u=[r.vZ.NUMBER,r.vZ.RATE]},3563:function(e,t,n){"use strict";n.d(t,{ZPL:function(){return i.ZP},gmg:function(){return i.gm},vZe:function(){return i.vZ},sR0:function(){return s},D23:function(){return i.D2},KYu:function(){return i.KY},XJ$:function(){return i.XJ},lj4:function(){return i.lj},EmK:function(){return $},SRQ:function(){return i.SR},JIQ:function(){return i.JI},Tsr:function(){return i.Ts},pQi:function(){return i.pQ},boc:function(){return i.bo},USE:function(){return i.US},_z2:function(){return i._z},XuU:function(){return i.Xu},SvE:function(){return i.Sv},UYn:function(){return i.UY},wAv:function(){return i.wA},JlJ:function(){return i.Jl},cKb:function(){return i.cK},Ar4:function(){return i.Ar},Zu0:function(){return i.Zu},DTU:function(){return u},mmt:function(){return i.mm},Tuj:function(){return i.Tu},CJP:function(){return i.CJ},LOw:function(){return i.LO},L2D:function(){return i.L2},Ajs:function(){return i.Aj},uCw:function(){return i.uC},WvA:function(){return i.Wv},Tvi:function(){return i.Tv},Gin:function(){return i.Gi},oCN:function(){return i.Xe},dc:function(){return i.dc},ClR:function(){return i.Cl},LlW:function(){return i.Ll},T6Y:function(){return i.T6},DLc:function(){return a},cPK:function(){return i.cP},hTT:function(){return i.hT},paJ:function(){return i.p},rX9:function(){return i.rX},pkt:function(){return i.pk},hcH:function(){return i.hc},jWt:function(){return i.jW},T76:function(){return H},Mue:function(){return i.Mu},sg1:function(){return He},B3:function(){return i.B3},uv8:function(){return i.uv},nYS:function(){return g.nY},rgt:function(){return x.rg},oHI:function(){return x.oH},Teq:function(){return p},$i0:function(){return Q},LYl:function(){return I},rm3:function(){return v},pTd:function(){return y},bLM:function(){return k},xnw:function(){return D},zXq:function(){return E},FiT:function(){return x.Fi},u1Q:function(){return m},bj$:function(){return ue},WHw:function(){return g.WH},qaV:function(){return Fe},N71:function(){return Pe},HLJ:function(){return g.HL},om8:function(){return w},BW0:function(){return S},fj4:function(){return je},VLM:function(){return Re},a1m:function(){return te},YD9:function(){return pe},ZRJ:function(){return _},iWx:function(){return we},hBA:function(){return A},RIy:function(){return Be},Tnt:function(){return Ye},rnW:function(){return Le},EDs:function(){return b},cX8:function(){return Ue},EtT:function(){return g.Et},ZvR:function(){return Ve},EOE:function(){return Te},B9Y:function(){return N},Bsv:function(){return _e},LWT:function(){return G},yAg:function(){return g.yA},eD3:function(){return Oe}});var r=n(92901),o=n(23029),a=(0,r.A)((function e(t){var n=this,r=t.api,a=t.mediaUrl,i=void 0===a?"":a;(0,o.A)(this,e),this.queryUser=function(e,t){e&&(n.waitingExecCallbacks.push(t),n.emailUserMap[e]||n.waitingQueryEmails.includes(e)||(n.waitingQueryEmails.push(e),n.startQueryUsers()))},this.queryUsers=function(e,t){var r;if(Array.isArray(e)&&0!==e.length){var o=[];e.forEach((function(e){n.waitingExecCallbacks.push(t),n.emailUserMap[e]||n.waitingQueryEmails.includes(e)||o.push(e)})),0!==o.length&&((r=n.waitingQueryEmails).push.apply(r,o),n.startQueryUsers())}},this.startQueryUsers=function(){n.pendingTimer||0===n.waitingQueryEmails.length||(n.pendingTimer=setTimeout((function(){n.api(n.waitingQueryEmails).then((function(e){e.data.user_list.forEach((function(e){n.emailUserMap[e.email]=e})),n.queryUserCallback()})).catch((function(){n.waitingQueryEmails.forEach((function(e){n.emailUserMap[e]={email:e,name:e,avatar_url:n.defaultAvatarUrl}})),n.queryUserCallback()})),clearTimeout(n.pendingTimer),n.pendingTimer=null}),1e3))},this.queryUserCallback=function(){n.waitingExecCallbacks.forEach((function(e){e(n.emailUserMap)})),n.waitingQueryEmails=[],n.waitingExecCallbacks=[]},this.api=r,this.defaultAvatarUrl="".concat(i,"/avatars/default.png"),this.waitingQueryEmails=[],this.waitingExecCallbacks=[],this.emailUserMap={}})),i=n(52719),s=n(33175),l=n(64467),c=n(89379),u=function(){return(0,r.A)((function e(t){(0,o.A)(this,e),this.baseName=t||"sf-metadata"}),[{key:"getStorage",value:function(){try{return JSON.parse(window.localStorage.getItem(this.baseName)||"{}")}catch(e){return""}}},{key:"setItem",value:function(e,t){var n=this.getStorage(),r=(0,c.A)((0,c.A)({},n),{},(0,l.default)({},e,t));return window.localStorage.setItem(this.baseName,JSON.stringify(r))}},{key:"getItem",value:function(e){return this.getStorage()[e]}}])}(),d=function(e){return void 0!==e&&(null!==e&&(""!==e&&("{}"!==JSON.stringify(e)&&"[]"!==JSON.stringify(e))))},p=function(e,t){if(!e||!t)return null;var n=t.key,r=t.name;return i.Aj.includes(n)?e[n]:e[r]},f=n(4159),h=n.n(f),m=function(e,t){if(!e||"string"!==typeof e)return"";var n=h()(e);if(!n.isValid())return e;switch(t){case"D/M/YYYY":case"DD/MM/YYYY":var r=n.format("YYYY-MM-DD").split("-");return"".concat(r[2],"/").concat(r[1],"/").concat(r[0]);case"D/M/YYYY HH:mm":case"DD/MM/YYYY HH:mm":var o=n.format("YYYY-MM-DD HH:mm").split(" "),a=o[0].split("-");return"".concat(a[2],"/").concat(a[1],"/").concat(a[0]," ").concat(o[1]);case"M/D/YYYY":return n.format("M/D/YYYY");case"M/D/YYYY HH:mm":return n.format("M/D/YYYY HH:mm");case"YYYY-MM-DD":default:return n.format("YYYY-MM-DD");case"YYYY-MM-DD HH:mm":return n.format("YYYY-MM-DD HH:mm");case"YYYY-MM-DD HH:mm:ss":return n.format("YYYY-MM-DD HH:mm:ss");case"DD.MM.YYYY":return n.format("DD.MM.YYYY");case"DD.MM.YYYY HH:mm":return n.format("DD.MM.YYYY HH:mm")}},g=n(91210),v=function(e,t){return Array.isArray(e)&&t?e.find((function(e){return e.key===t})):null},y=function(e,t){return Array.isArray(e)&&t?e.find((function(e){return e.name===t})):null},C=n(84307),A=function(e){return C.BQ.includes(function(e){return e.type}(e))},x=n(51511),b=function(e){var t=C._W[C.vZ.LONG_TEXT],n=e.text;return!!n&&n.length>=t},_=function(e){var t=C._W[C.vZ.LONG_TEXT],n=(0,c.A)({},e),r=n.text,o=n.preview;return n.text=r?r.slice(0,t):"",n.preview=o?o.slice(0,t):"",n},w=function(e,t){return Array.isArray(e)&&t?e.find((function(e){return e.id===t||e.name===t})):null},S=function(e,t){if(!t||!Array.isArray(e))return"";var n=w(e,t);return n?n.name:""},D=function(e,t){if(i.Aj.includes(e.key))return t;var n=(0,x.Fi)(e);return S(n,t)},E=function(e,t){if(i.Aj.includes(e.key))return t;if(!Array.isArray(t)||0===t.length)return[];var n=(0,x.Fi)(e);return Array.isArray(n)&&0!==n.length?t.map((function(e){return S(n,e)})).filter((function(e){return e})):[]},k=function(e,t){if(i.Aj.includes(e.key))return t;if(!Array.isArray(t)||0===t.length)return[];var n=(0,x.Fi)(e);return Array.isArray(n)&&0!==n.length?t.map((function(e){var t=w(n,e);return t?t.id:null})).filter((function(e){return e})):[]},M=function(e,t){if(!Array.isArray(e)||!Array.isArray(t))return[];var n={};return t.forEach((function(e){n[e.email]=e})),e.map((function(e){var t=n[e];return t&&t.name})).filter(Boolean)},I=function(e,t){var n=M(t,e);return Array.isArray(n)&&0!==n.length?n.join(", "):""},N=function(e){return/^[A-Za-z0-9]+([-_.][A-Za-z0-9]+)*@([A-Za-z0-9]+[-.])+[A-Za-z0-9]{2,20}$/.test(e)},P=n(36149),T="number",O="string",j="boolean",R="array",L=[P.US.IS_ANY_OF,P.US.IS_NONE_OF],F=[C.vZ.TEXT,C.vZ.FILE_NAME],U=[P.US.EMPTY,P.US.NOT_EMPTY],Y=[P.Xu.NUMBER_OF_DAYS_AGO,P.Xu.NUMBER_OF_DAYS_FROM_NOW,P.Xu.THE_NEXT_NUMBERS_OF_DAYS,P.Xu.THE_PAST_NUMBERS_OF_DAYS,P.Xu.EXACT_DATE],B=[P.Xu.NUMBER_OF_DAYS_AGO,P.Xu.NUMBER_OF_DAYS_FROM_NOW,P.Xu.THE_NEXT_NUMBERS_OF_DAYS,P.Xu.THE_PAST_NUMBERS_OF_DAYS],H=function(){return(0,r.A)((function e(){(0,o.A)(this,e)}),null,[{key:"validate",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=e.column_key,o=e.filter_predicate,a=e.filter_term_modifier,i=e.filter_term,s=this.validateColumn(r,t).error_message;if(s)return{error_message:s};var l=t.find((function(e){return e.key===r})),c=this.validatePredicate(o,l).error_message;if(c)return{error_message:c};if(this.isFilterOnlyWithPredicate(o,l))return{error_message:null};var u=this.validateModifier(a,o,l).error_message;if(u)return{error_message:u};if(this.isFilterOnlyWithModifier(a,l))return{error_message:null};if(n){var d=this.validateTerm(i,o,a,l).error_message;if(d)return{error_message:d}}return{error_message:null}}},{key:"validateColumn",value:function(e,t){if(!e)return{error_message:P.pQ.INCOMPLETE_FILTER};var n=t.find((function(t){return t.key===e}));return n?this.isValidColumnType(n)?{error_message:null}:{error_message:P.pQ.COLUMN_NOT_SUPPORTED}:{error_message:P.pQ.COLUMN_MISSING}}},{key:"validatePredicate",value:function(e,t){if(!e)return{error_message:P.pQ.INCOMPLETE_FILTER};var n=t.type;return P.Ts[n].filterPredicateList.includes(e)?{error_message:null}:{error_message:P.pQ.UNMATCHED_PREDICATE}}},{key:"validatePredicateWithArrayType",value:function(e,t){var n=t.data.array_type;return n===C.vZ.CHECKBOX||n===C.vZ.BOOL?this.validatePredicate(e,{type:C.vZ.CHECKBOX}):!!U.includes(e)||(n===C.vZ.SINGLE_SELECT||n===C.vZ.DEPARTMENT_SINGLE_SELECT?this.validatePredicate(e,{type:C.vZ.MULTIPLE_SELECT}):C.Kv.includes(n)?this.validatePredicate(e,{type:C.vZ.COLLABORATOR}):this.validatePredicate(e,{type:n}))}},{key:"isFilterOnlyWithPredicate",value:function(e,t){if(U.includes(e))return!0;var n=t.type,r=P.US.IS_CURRENT_USER_ID,o=P.US.INCLUDE_ME;return!(e!==r||!F.includes(n))||!(e!==o||!C.Kv.includes(n))}},{key:"validateModifier",value:function(e,t,n){if(!A(n))return{error_message:null};if(!e)return{error_message:P.pQ.INCOMPLETE_FILTER};if(t===P.US.IS_WITHIN){if(P.B3.includes(e))return{error_message:null}}else if(P.uv.includes(e))return{error_message:null};return{error_message:P.pQ.UNMATCHED_MODIFIER}}},{key:"isFilterOnlyWithModifier",value:function(e,t){return!!A(t)&&!Y.includes(e)}},{key:"validateTerm",value:function(e,t,n,r){return this.isTermMissing(e)?{error_message:P.pQ.INCOMPLETE_FILTER}:this.isValidTerm(e,t,n,r)?{error_message:null}:{error_message:P.pQ.INVALID_TERM}}},{key:"isTermMissing",value:function(e){return!e&&0!==e&&!1!==e||Array.isArray(e)&&0===e.length}},{key:"isValidTerm",value:function(e,t,n,r){switch(r.type){case C.vZ.TEXT:case C.vZ.GEOLOCATION:case C.vZ.FILE_NAME:return this.isValidTermType(e,O);case C.vZ.NUMBER:case C.vZ.RATE:return this.isValidTermType(e,T);case C.vZ.CHECKBOX:case C.vZ.BOOL:return this.isValidTermType(e,j);case C.vZ.COLLABORATOR:case C.vZ.CREATOR:case C.vZ.LAST_MODIFIER:return this.isValidTermType(e,R);case C.vZ.DATE:case C.vZ.CTIME:case C.vZ.MTIME:return B.includes(n)?this.isValidTermType(e,T):this.isValidTermType(e,O);case C.vZ.SINGLE_SELECT:var o=(0,x.Fi)(r);return L.includes(t)?!!this.isValidTermType(e,R)&&this.isValidSelectedOptions(e,o):!!this.isValidTermType(e,O)&&!!o.find((function(t){return e===t.id}));case C.vZ.MULTIPLE_SELECT:if(!this.isValidTermType(e,R))return!1;var a=(0,x.Fi)(r);return this.isValidSelectedOptions(e,a);default:return!1}}},{key:"isValidTermType",value:function(e,t){return t===R?Array.isArray(e)&&e.length>0:t===C.vZ.NUMBER?typeof e===t||!isNaN(Number(e)):typeof e===t}},{key:"isValidTermWithArrayType",value:function(e,t,n,r){var o=r.data,a=o.array_type,i=o.array_data;return a===C.vZ.SINGLE_SELECT?this.isValidTerm(e,t,n,{type:C.vZ.MULTIPLE_SELECT,data:i}):C.Kv.includes(a)?this.isValidTerm(e,t,n,{type:C.vZ.COLLABORATOR}):this.isValidTerm(e,t,n,{type:a,data:i})}},{key:"isValidColumnType",value:function(e){var t=e.type;return P.Ts.hasOwnProperty(t)}},{key:"isValidSelectedOptions",value:function(e,t){var n=t.filter((function(t){return e.includes(t.id)}));return e.length===n.length}}])}(),V=n(58419),G=function(e,t){return"string"!==typeof e?{isValid:!1,message:(0,V.AP)("Name should be string")}:""===(e=e.trim())?{isValid:!1,message:(0,V.AP)("Name is required")}:e.includes("/")?{isValid:!1,message:(0,V.AP)("Name cannot contain slash")}:e.includes("\\")?{isValid:!1,message:(0,V.AP)("Name cannot contain backslash")}:t.includes(e)?{isValid:!1,message:(0,V.AP)("Name already exists")}:{isValid:!0,message:e}},q=[1,1,1,2,2,2,3,3,3,4,4,4],z=/(\[[^[]*\])|([-:/.()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,W=/\d\d?/,K=/\d\d/,Z={mm:[W,i.sN.MINUTES],HH:[W,i.sN.HOURS],D:[W,i.sN.DAY],DD:[K,i.sN.DAY],M:[W,i.sN.MONTH],MM:[K,i.sN.MONTH],YYYY:[/\d{4}/,i.sN.YEAR]},X=["YYYY","MM","M","DD","D"],$=function(){return(0,r.A)((function e(){(0,o.A)(this,e)}),null,[{key:"format",value:function(e,t){var n=this.getValidDate(e);if(!n)return"";var r=t&&t.toUpperCase(),o=n.getFullYear(),a=n.getMonth()+1,i=n.getDate(),s=a<10?"0".concat(a):a,l=i<10?"0".concat(i):i;switch(r){case"YYYY-MM-DD HH:MM:SS":var c=n.getHours(),u=n.getMinutes(),d=n.getSeconds(),p=c<10?"0".concat(c):c,f=u<10?"0".concat(u):u,h=d<10?"0".concat(d):d;return"".concat(o,"-").concat(s,"-").concat(l," ").concat(p,":").concat(f,":").concat(h);case"YYYY-MM-DD HH:MM":var m=n.getHours(),g=n.getMinutes(),v=m<10?"0".concat(m):m,y=g<10?"0".concat(g):g;return"".concat(o,"-").concat(s,"-").concat(l," ").concat(v,":").concat(y);default:return"".concat(o,"-").concat(s,"-").concat(l)}}},{key:"getDateByGranularity",value:function(e,t){var n=this.getValidDate(e);if(!n)return"";var r=t&&t.toUpperCase(),o=n.getFullYear();switch(r){case"YEAR":return"".concat(o);case"QUARTER":var a=n.getMonth(),i=q[a];return"".concat(o,"-Q").concat(i);case"MONTH":var s=n.getMonth()+1,l=s<10?"0".concat(s):s;return"".concat(o,"-").concat(l);case"WEEK":var c=n.getDay(),u=n.getDate()+(0===c?-6:1-c),d=new Date(o,n.getMonth(),u),p=d.getMonth()+1,f=d.getDate(),h=p<10?"0".concat(p):p,m=f<10?"0".concat(f):f;return"".concat(d.getFullYear(),"-").concat(h,"-").concat(m);case"DAY":var g=n.getMonth()+1,v=n.getDate(),y=g<10?"0".concat(g):g,C=v<10?"0".concat(v):v;return"".concat(o,"-").concat(y,"-").concat(C);default:return""}}},{key:"isValidDateObject",value:function(e){return e instanceof Date&&!isNaN(e.getTime())}},{key:"getValidDate",value:function(e){if(!e)return null;var t="string"===typeof e,n=e,r=e;return t&&(n.split(" ").length>1||n.includes("T")?r=new Date(e):(n="".concat(e," 00:00:00"),r=new Date(n))),this.isValidDateObject(r)?r:t?(r=new Date(n.replace(/-/g,"/")),this.isValidDateObject(r)?r:null):null}},{key:"parseDateWithFormat",value:function(e,t){if(e.includes("T")){var n=new Date(e);return this.isValidDateObject(n)?n:this.getValidDate(e)}try{var r=this.makeParser(t)(e),o=r.year,a=r.month,i=r.day,s=r.hours,l=r.minutes;if(!o)o=(new Date).getFullYear();var c=new Date("".concat(o,"-").concat(a,"-").concat(i," ").concat(s||"00",":").concat(l||"00"));return this.isValidDateObject(c)?c:this.getValidDate(e)}catch(u){return this.getValidDate(e)}}},{key:"makeParser",value:function(e){var t=(e||i.D2).match(z),n=t.length;return function(e){for(var r=e.split(" "),o=r[0]||"",a=r[1]||"",i={},s=0;s<n;s++){var l=t[s],c=Z[l];if(c){var u=c[0],d=c[1];if(d){var p=X.includes(l),f=p?u.exec(o):u.exec(a);if(f){var h=f[0];i[d]=h,p?o=o.replace(h,""):a=a.replace(h,"")}}}}return i}}}])}(),J=$,Q=function(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).collaborators,r=void 0===n?[]:n;if(!e)return"";var o=t.type,a=t.data,s=p(e,t);switch(o){case i.vZ.LONG_TEXT:return function(e){if(!e)return"";var t=typeof e;return"string"===t?e:"object"===t&&e.text||""}(s);case i.vZ.NUMBER:return(0,g.HL)(s,a);case i.vZ.SINGLE_SELECT:var l=(0,x.Fi)(t);return Array.isArray(l)&&0!==l.length?S(l,s):"";case i.vZ.MULTIPLE_SELECT:var c=(0,x.Fi)(t);if(!Array.isArray(c)||0===c.length)return"";var u=k(t,s);return E(t,u).join(", ");case i.vZ.DATE:var d=(a||{}).format,f=void 0===d?i.D2:d;return m(s,f);case i.vZ.CTIME:case i.vZ.MTIME:return J.format(s,"YYYY-MM-DD HH:MM:SS");case i.vZ.COLLABORATOR:return I(r,s);case i.vZ.CREATOR:case i.vZ.LAST_MODIFIER:return"anonymous"===s?s:I(r,[s]);case i.vZ.GEOLOCATION:return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.isBaiduMap,o=void 0===r||r,a=n.hyphen,s=void 0===a?"":a;if(!e)return"";switch((t||{}).geo_format){case i.fz.LNG_LAT:var l=e.lng,c=e.lat;return function(e,t){return(e||0===e)&&(t||0===t)}(l,c)?o?"".concat(l,", ").concat(c):"".concat(c,", ").concat(l):"";case i.fz.COUNTRY_REGION:return e.country_region||"";case i.fz.PROVINCE:return e.province||"";case i.fz.PROVINCE_CITY:var u=e.province,d=e.city;return"".concat(u||"").concat(s).concat(d||"").trim();case i.fz.PROVINCE_CITY_DISTRICT:var p=e.province,f=e.city,h=e.district;return"".concat(p||"").concat(s).concat(f||"").concat(s).concat(h||"").trim();case i.fz.MAP_SELECTION:var m=e.address,g=e.title;return"".concat(m||"").concat(s).concat(g||"").trim();default:var v=e.province,y=e.city,C=e.district,A=e.detail;return v||y||C||A?"".concat(v||"").concat(s).concat(y||"").concat(s).concat(C||"").concat(s).concat(A||"").trim():""}}(s,a,{isBaiduMap:!0,hyphen:" "});default:return s||"boolean"===typeof s?String(s):""}},ee=[P.Xu.TODAY,P.Xu.TOMORROW,P.Xu.YESTERDAY,P.Xu.ONE_WEEK_AGO,P.Xu.ONE_WEEK_FROM_NOW,P.Xu.ONE_MONTH_AGO,P.Xu.ONE_MONTH_FROM_NOW,P.Xu.NUMBER_OF_DAYS_AGO,P.Xu.NUMBER_OF_DAYS_FROM_NOW,P.Xu.EXACT_DATE],te=function(e,t){return Array.isArray(e)&&Array.isArray(t)?e.filter((function(e){var n=H.validate(e,t).error_message;return!n||n!==P.pQ.INCOMPLETE_FILTER})):[]},ne=function(e,t){var n=function(e,t){var n=new Date,r=n.getFullYear(),o=n.getMonth(),a=n.getDate(),i=[31,28,31,30,31,30,31,31,30,31,30,31];switch(i[1]=r%4!==0||r%100===0&&r%400!==0?28:29,e){case P.Xu.TODAY:return new Date(r,o,a,0,0,0);case P.Xu.TOMORROW:return new Date(r,o,a+1);case P.Xu.YESTERDAY:return new Date(r,o,a-1);case P.Xu.ONE_WEEK_AGO:return new Date(r,o,a-7);case P.Xu.ONE_WEEK_FROM_NOW:return new Date(r,o,a+7);case P.Xu.ONE_MONTH_AGO:var s=o-1,l=0===o?11:s,c=a>i[l]?i[l]:a;return new Date(r,s,c);case P.Xu.ONE_MONTH_FROM_NOW:var u=o+1,d=11===o?0:u,p=a>i[d]?i[d]:a;return new Date(r,u,p);case P.Xu.NUMBER_OF_DAYS_AGO:return new Date(r,o,a-Number(t));case P.Xu.NUMBER_OF_DAYS_FROM_NOW:return new Date(r,o,a+Number(t));case P.Xu.EXACT_DATE:return new Date(t);case P.Xu.THE_PAST_WEEK:var f=0!==n.getDay()?n.getDay():7;return{startDate:new Date(r,o,a-f-6),endDate:new Date(r,o,a-f)};case P.Xu.THIS_WEEK:var h=0!==n.getDay()?n.getDay():7;return{startDate:new Date(r,o,a-h+1),endDate:new Date(r,o,a-h+7)};case P.Xu.THE_NEXT_WEEK:var m=0!==n.getDay()?n.getDay():7;return{startDate:new Date(r,o,a-m+8),endDate:new Date(r,o,a-m+14)};case P.Xu.THE_PAST_MONTH:var g=o-1;return{startDate:new Date(r,g,1),endDate:new Date(r,g,i[0===o?11:g])};case P.Xu.THIS_MONTH:return{startDate:new Date(r,o,1),endDate:new Date(r,o,i[o])};case P.Xu.THE_NEXT_MONTH:var v=o+1;return{startDate:new Date(r,v,1),endDate:new Date(r,v,11===o?i[0]:i[v])};case P.Xu.THE_PAST_YEAR:var y=r-1;return{startDate:new Date(y,0,1),endDate:new Date(y,11,31)};case P.Xu.THIS_YEAR:return{startDate:new Date(r,0,1),endDate:new Date(r,11,31)};case P.Xu.THE_NEXT_YEAR:var C=r+1;return{startDate:new Date(C,0,1),endDate:new Date(C,11,31)};case P.Xu.THE_NEXT_NUMBERS_OF_DAYS:return{startDate:new Date(r,o,a+1,0,0,0),endDate:new Date(r,o,a+Number(t))};case P.Xu.THE_PAST_NUMBERS_OF_DAYS:return{startDate:new Date(r,o,a-Number(t)),endDate:new Date(r,o,a,0,0,0)};default:return{}}}(e,t);if(ee.includes(e))return $.format(n);var r=n.startDate,o=n.endDate;return{startDate:r?$.format(r):"",endDate:o?$.format(o):""}},re=function(e){return e.map((function(e){return function(e,t){var n=e.filter_term,r=e.filter_term_modifier,o=e;switch(t.type){case C.vZ.CTIME:case C.vZ.MTIME:case C.vZ.DATE:o.other_date=ne(r,n)}return o}(e,e.column)}))},oe=n(32728),ae=n(73224),ie=n(60436),se=n(82240),le=function(e,t,n){var r=n.username,o=n.userId,a=t.column,s=p(e,a);switch(a.type){case C.vZ.CTIME:case C.vZ.MTIME:case C.vZ.DATE:return function(e,t){var n=t.filter_predicate,r=t.filter_term_modifier,o=t.filter_term,a=t.other_date;switch(n){case oe.U.IS:return r===ae.X.EXACT_DATE&&!o||$.format(e)===a;case oe.U.IS_WITHIN:if(r===ae.X.EXACT_DATE&&!o)return!0;if(!e)return!1;var i=a.startDate,s=a.endDate,l=$.format(e);return l>=i&&l<=s;case oe.U.IS_BEFORE:return r===ae.X.EXACT_DATE&&!o||!(!e||!$.getValidDate(e))&&$.format(e)<a;case oe.U.IS_AFTER:return r===ae.X.EXACT_DATE&&!o||!(!e||!$.getValidDate(e))&&$.format(e)>a;case oe.U.IS_ON_OR_BEFORE:return r===ae.X.EXACT_DATE&&!o||!(!e||!$.getValidDate(e))&&$.format(e)<=a;case oe.U.IS_ON_OR_AFTER:return r===ae.X.EXACT_DATE&&!o||!(!e||!$.getValidDate(e))&&$.format(e)>=a;case oe.U.IS_NOT:return r===ae.X.EXACT_DATE&&!o||!(!e||!$.getValidDate(e))&&$.format(e)!==a;case oe.U.EMPTY:return!(e&&$.getValidDate(e));case oe.U.NOT_EMPTY:return!(!e||!$.getValidDate(e));default:return!1}}(s=$.format(s,C.cV.YYYY_MM_DD),t);case C.vZ.FILE_NAME:case C.vZ.TEXT:return function(e,t,n){var r=t.filter_predicate,o=t.filter_term;switch(r){case oe.U.CONTAINS:return!o||!!e&&e.toString().toLowerCase().indexOf(o.toLowerCase())>-1;case oe.U.NOT_CONTAIN:return!o||!e||e.toString().toLowerCase().indexOf(o.toLowerCase())<0;case oe.U.IS:return!o||e===o;case oe.U.IS_NOT:return!o||e!==o;case oe.U.EMPTY:return!e;case oe.U.NOT_EMPTY:return!!e;case oe.U.IS_CURRENT_USER_ID:return!!n&&e===n;default:return!1}}(s,t,o);case C.vZ.LAST_MODIFIER:case C.vZ.CREATOR:return function(e,t,n){var r=t.filter_predicate,o=t.filter_term;switch(r){case oe.U.CONTAINS:return!Array.isArray(o)||!!e&&o.findIndex((function(t){return t===e}))>-1;case oe.U.NOT_CONTAIN:return!Array.isArray(o)||!e||o.findIndex((function(t){return t===e}))<0;case oe.U.INCLUDE_ME:return e===n;case oe.U.IS:return!o||(Array.isArray(o)?e===o[0]:e===o);case oe.U.IS_NOT:return!o||(Array.isArray(o)?e!==o[0]:e!==o);default:return!1}}(s,t,r);case C.vZ.CHECKBOX:return function(e,t){var n=t.filter_term||!1;return("string"===typeof e?"TRUE"===e.toLocaleUpperCase():e||!1)===n}(s,t);case C.vZ.SINGLE_SELECT:return function(e,t){var n=t.filter_predicate,r=t.filter_term;switch(n){case i.US.IS:return!r||e===r;case i.US.IS_NOT:return!r||e!==r;case i.US.IS_ANY_OF:return 0===r.length||r.includes(e);case i.US.IS_NONE_OF:return 0===r.length||r.indexOf(e)<0;case i.US.EMPTY:return!e;case i.US.NOT_EMPTY:return!!e;default:return!1}}(s,t);case C.vZ.MULTIPLE_SELECT:return function(e,t){var n=t.filter_predicate,r=t.filter_term;switch(n){case oe.U.HAS_ANY_OF:return 0===r.length||Array.isArray(e)&&e.some((function(e){return r.includes(e)}));case oe.U.HAS_ALL_OF:return 0===r.length||Array.isArray(e)&&r.every((function(t){return e.includes(t)}));case oe.U.HAS_NONE_OF:return 0===r.length||!Array.isArray(e)||0===e.length||r.every((function(t){return e.indexOf(t)<0}));case oe.U.IS_EXACTLY:if(0===r.length)return!0;if(!Array.isArray(e))return!1;var o=function(e){return(0,ie.A)(new Set(e)).sort()};return o(e).toString()===o(r).toString();case oe.U.EMPTY:return!Array.isArray(e)||0===e.length;case oe.U.NOT_EMPTY:return Array.isArray(e)&&e.length>0;default:return!1}}(s,t);case C.vZ.NUMBER:case C.vZ.RATE:return function(e,t){var n=t.filter_predicate,r=t.filter_term;switch(n){case i.US.EQUAL:return!r&&0!==r||!(!e&&0!==e)&&(0,se.YX)(r,e);case i.US.NOT_EQUAL:return!r&&0!==r||!e&&0!==e||!(0,se.YX)(r,e);case i.US.LESS:return!r&&0!==r||!(!e&&0!==e||(0,se.YX)(e,r))&&e<r;case i.US.GREATER:return!r&&0!==r||!(!e&&0!==e||(0,se.YX)(e,r))&&e>r;case i.US.LESS_OR_EQUAL:return!r&&0!==r||!(!e&&0!==e)&&(!!(0,se.YX)(e,r)||e<r);case i.US.GREATER_OR_EQUAL:return!r&&0!==r||!(!e&&0!==e)&&((0,se.YX)(e,r)||e>r);case i.US.EMPTY:return 0!==e&&(!e||"number"!==typeof e);case i.US.NOT_EMPTY:return 0===e||!(!e||"number"!==typeof e);default:return!1}}(s,t);case C.vZ.COLLABORATOR:return function(e,t,n){var r=t.filter_predicate,o=t.filter_term;switch(r){case i.US.HAS_ANY_OF:return!Array.isArray(o)||0===o.length||Array.isArray(e)&&o.some((function(t){return e.includes(t)}));case i.US.HAS_ALL_OF:return!Array.isArray(o)||0===o.length||Array.isArray(e)&&o.every((function(t){return e.includes(t)}));case i.US.HAS_NONE_OF:return!Array.isArray(o)||0===o.length||!Array.isArray(e)||0===e.length||o.every((function(t){return e.indexOf(t)<0}));case i.US.IS_EXACTLY:if(!Array.isArray(o)||0===o.length)return!0;if(!Array.isArray(e)||0===e.length)return!1;var a=(0,ie.A)(new Set(e));return a.length===o.length&&o.every((function(e){return a.includes(e)}));case i.US.EMPTY:return!Array.isArray(e)||0===e.length;case i.US.NOT_EMPTY:return Array.isArray(e)&&e.length>0;case i.US.INCLUDE_ME:return Array.isArray(e)&&e.indexOf(n)>-1;default:return!1}}(s,t,r);default:return!1}},ce=function(e,t,n,r){var o=r.username,a=r.userId,i=[],s=re(t);return n.forEach((function(t){var n=t._id;(function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=r.username,a=void 0===o?"":o,i=r.userId;return t===P.FK.AND?n.every((function(t){return le(e,t,{username:a,userId:i})})):t===P.FK.OR&&n.some((function(t){return le(e,t,{username:a,userId:i})}))})(t,e,s,{username:o,userId:a})&&i.push(n)})),i},ue=function(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=o.username,i=void 0===a?null:a,s=o.userId,l=void 0===s?null:s,u=e.columns,d=[];try{d=function(e,t){if(!Array.isArray(e)||0===e.length)return[];var n=[];return e.forEach((function(e){var r=e.column_key,o=H.validate(e,t).error_message;if(o){if(o!==P.pQ.INCOMPLETE_FILTER)throw new Error(o)}else{var a=t.find((function(e){return e.key===r})),i=(0,c.A)((0,c.A)({},e),{},{column:a});n.push(i)}})),n}(r,u)}catch(p){return{row_ids:[],error_message:p.message}}return{row_ids:0===d.length?t.map((function(e){return e._id})):ce(n,d,t,{username:i,userId:l}),error_message:null}},de=n(81602),pe=function(e,t){return Array.isArray(e)&&Array.isArray(t)?e.filter((function(e){return function(e,t){if(!e||!Array.isArray(t))return!1;var n=e.column_key,r=t.find((function(e){return e.key===n}));return!!r&&de.Ll.includes(r.type)}(e,t)})):[]},fe=function(e,t,n){var r=!e,o=!t;return r&&o?0:r?1:o?-1:e>t?n===i.Cl.UP?1:-1:e<t?n===i.Cl.UP?-1:1:0},he=/\d+|\D+/g,me=/\d/,ge=n(21905),ve=function(e,t){if(!e&&!t)return 0;if(!e)return-1;if(!t)return 1;if("string"!==typeof e||"string"!==typeof t)return 0;for(var n,r,o=e.match(he),a=t.match(he),i=Math.min(o.length,a.length),s=0;s<i;s++){if(n=o[s],r=a[s],me.test(n)&&me.test(r)){if((n=parseInt(n))>(r=parseInt(r)))return 1;if(n<r)return-1}if(n!==r)return e.localeCompare(t)}return e.localeCompare(t)},ye=function(e,t,n){var r=!e,o=!t;return r&&o?0:r?1:o?-1:t===e?0:n===ge.Cl.UP?ve(e,t):-1*ve(e,t)},Ce=function(e,t,n){var r=e?1:-1,o=t?1:-1;return r>o?n===i.Cl.UP?1:-1:r<o?n===i.Cl.UP?-1:1:0},Ae=function(e,t,n){var r=Array.isArray(e)&&e.length?e.join(""):null,o=Array.isArray(t)&&t.length?t.join(""):null;return ye(r,o,n)},xe=function(e,t,n){var r=!e&&0!==e,o=!t&&0!==t;return r&&o?0:r?1:o?-1:e>t?n===ge.Cl.UP?1:-1:e<t?n===ge.Cl.UP?-1:1:0},be=function(e,t,n){var r=n.sort_type,o=n.option_id_index_map,a=o[e],i=o[t],s=!a&&0!==a,l=!i&&0!==i;return s&&l?0:s?1:l?-1:a>i?r===ge.Cl.UP?1:-1:a<i?r===ge.Cl.UP?-1:1:0},_e=function(e,t){var n=e&&t.find((function(t){return t.key===e.column_key}));return!!n&&ge.dc.includes(n.type)},we=function(e,t){return Array.isArray(e)&&Array.isArray(t)?e.filter((function(e){return _e(e,t)})):[]},Se=function(e,t){var n=[];return e.forEach((function(e){var r=t[e];r>-1&&n.push(r)})),n.sort()},De=function(e,t,n){var r=n.sort_type,o=n.option_id_index_map,a=!e||0===e.length,i=!t||0===t.length;if(a&&i)return 0;if(a)return 1;if(i)return-1;var s=Se(e,o),l=Se(t,o),c=s.length,u=l.length;if(c===u&&(0===c||s.join("")===l.join("")))return 0;for(var d=Math.min(c,u),p=0;p<d;p++){if(s[p]>l[p])return r===ge.Cl.UP?1:-1;if(s[p]<l[p])return r===ge.Cl.UP?-1:1}return c>u?r===ge.Cl.UP?1:-1:r===ge.Cl.UP?-1:1},Ee=function(e,t){var n=t.column,r=t.count_type;switch(n.type){case C.vZ.TEXT:case C.vZ.LAST_MODIFIER:case C.vZ.CREATOR:return e||null;case C.vZ.DATE:case C.vZ.CTIME:case C.vZ.MTIME:return $.getDateByGranularity(e,r)||null;case C.vZ.NUMBER:case C.vZ.RATE:return e||0===e?e:null;case C.vZ.CHECKBOX:return!!e;case C.vZ.SINGLE_SELECT:return e||null;case C.vZ.MULTIPLE_SELECT:case C.vZ.COLLABORATOR:return Array.isArray(e)?e:[];case C.vZ.GEOLOCATION:return function(e,t){if(!e)return"";var n=e.province,r=e.city,o=e.district,a=e.country_region;switch(t){case i.wA.CITY:return r||"";case i.wA.DISTRICT:return o||"";case i.wA.COUNTRY:return a||"";default:return n||""}}(e,r);default:return null}},ke=function(e,t){var n=null;return C.rT[t]?n="string"===typeof e?e:String(e):C.Tx[t]&&(n=(0,ie.A)(e).sort().toString()),n},Me=function(e,t,n){var r=t[e];return r&&r.index>-1?r.index:(t[e]={},t[e].subgroups={},t[e].index=n,-1)},Ie=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=t[n],a=o.column,i=o.sort_type,s=a.type,l=a.data,u=i||ge.Cl.UP,p={};if(s===C.vZ.SINGLE_SELECT||s===C.vZ.MULTIPLE_SELECT){var f=(l||{}).options;Array.isArray(f)&&f.forEach((function(e,t){p[e.id]=t}))}if(e.sort((function(e,t){var n=e.cell_value,o=t.cell_value;if(ge.dc.includes(s)){var a;if(ge.FI.includes(s))a=ye(n,o,u);else if(C.BQ.includes(s))a=fe(n,o,u);else if(ge.$4.includes(s))a=xe(n,o,u);else if(s===C.vZ.CHECKBOX)a=Ce(n,o,u);else if(s===C.vZ.COLLABORATOR){var i=n,l=o;r&&(i=M(i,r),l=M(l,r)),a=Ae(i,l,u)}else s===C.vZ.SINGLE_SELECT?a=be(n,o,{sort_type:u,option_id_index_map:p}):s===C.vZ.MULTIPLE_SELECT&&(a=De(n,o,{sort_type:u,option_id_index_map:p}));return a}var c=d(n),f=d(o);return c||f?c?f?0:-1:1:0})),Array.isArray(e[0].subgroups)&&e[0].subgroups.length>0){var h=n+1;e=e.map((function(e){var n=Ie(e.subgroups,t,h,r);return(0,c.A)((0,c.A)({},e),{},{subgroups:n})}))}return e},Ne=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(0===e.length)return[];if(e.length>1)return function(e,t,n){var r=e.length>de.mm?e.slice(0,de.mm):(0,ie.A)(e),o=[],a={};return t.forEach((function(e){for(var t,n,i=e._id,s=0;s<r.length;s++){var l=r[s],c=l.column,u=l.column_key,d=c.type,f=p(e,c),h=Ee(f,l),m=ke(h,d),g={cell_value:h,original_cell_value:f,row_ids:null,column_key:u,subgroups:[],summaries:{}};if(0===s){var v=Me(m,a,o.length);n=a[m].subgroups,v<0?(o.push(g),t=o[o.length-1]):t=o[v]}else{var y=Me(m,n,t.subgroups.length);n=n[m].subgroups,y<0?(t.subgroups.push(g),t=t.subgroups[t.subgroups.length-1]):t=t.subgroups[y],s===r.length-1&&(t.row_ids?t.row_ids.push(i):t.row_ids=[i])}}})),o=Ie(o,r,0,n)}(e,t,n);var r=e[0],o=r.column_key,a=r.column,i=a.type,s=[],l={};return t.forEach((function(e){var t=p(e,a),n=Ee(t,r),c=function(e,t,n){var r=t[e];return r>-1?r:(t[e]=n,-1)}(ke(n,i),l,s.length);c>-1?s[c].row_ids.push(e._id):s.push({cell_value:n,original_cell_value:t,column_key:o,row_ids:[e._id],subgroups:null,summaries:{}})})),s=Ie(s,e,0,n)},Pe=function(e,t,n,r){var o=r.collaborators;if(0===t.length)return[];if(0===n.length)return t;var a=[];try{a=function(e,t){var n=pe(e,t),r=[];return n.forEach((function(e){var n=e.column_key,o=e.count_type,a=t.find((function(e){return n===e.key})),i=a.type,s=(0,c.A)((0,c.A)({},e),{},{column:a});switch(i){case C.vZ.DATE:case C.vZ.CTIME:case C.vZ.MTIME:s.count_type=o||de.UY.MONTH;break;case C.vZ.GEOLOCATION:s.count_type=o||de.wA.PROVINCE}r.push(s)})),r}(n,e.columns)}catch(i){a=[]}return Ne(a,t,o)},Te=function(e){return Array.isArray(e)&&"object"===typeof e[0]},Oe=function(e,t,n,r){var o=r.collaborators,a=e.columns;if(!Array.isArray(t)||0===t.length)return[];var i=t.slice(0),s=function(e,t){var n=we(e,t),r=[];return n.forEach((function(e){var n=e.column_key,o=t.find((function(e){return e.key===n})),a=(0,c.A)((0,c.A)({},e),{},{column:o});switch(o.type){case C.vZ.SINGLE_SELECT:case C.vZ.MULTIPLE_SELECT:var i=(0,x.Fi)(o),s={};i.forEach((function(e,t){s[e.id]=t})),a.option_id_index_map=s}r.push(a)})),r}(n,a);return function(e,t,n){var r=n.collaborators;e.sort((function(e,n){var o=0;return t.forEach((function(t){var a=t.sort_type,i=t.column,s=i.type,l=p(e,i),c=p(n,i);if(C.BQ.includes(s))o=o||fe(l,c,a);else if(s===C.vZ.SINGLE_SELECT)o=o||be(l,c,t);else if(ge.$4.includes(s))o=o||xe(l,c,a);else if(s===C.vZ.MULTIPLE_SELECT)o=o||De(l,c,t);else if(s===C.vZ.COLLABORATOR){var u=l,d=c;r&&(u=M(l,r),d=M(c,r)),o=o||Ae(u,d,a)}else o=s===C.vZ.CHECKBOX?o||Ce(l,c,a):o||ye(l,c,a)})),o}))}(i,s,{collaborators:o}),i.map((function(e){return e._id}))},je=function(e,t){return e&&e.id_row_map&&t?e.id_row_map[t]:null},Re=function(e,t){return e&&e.id_row_map&&Array.isArray(t)?t.map((function(t){return e.id_row_map[t]})).filter(Boolean):[]},Le=function(e,t){return pe(e.groupbys,t).length>0},Fe=function(e,t){if(!Array.isArray(e)||!Array.isArray(t))return null;var n=e[0];if(n<0||n>=t.length)return null;for(var r=1,o=t[n];r<e.length&&o;){var a=o.subgroups,i=e[r];if(!Array.isArray(a)||i<0||i>=a.length)break;o=a[i],r+=1}return o},Ue=function(){var e=navigator.platform;return"Mac68K"===e||"MacPPC"===e||"Macintosh"===e||"MacIntel"===e},Ye=function(e){return e&&"[object Function]"==={}.toString.call(e)},Be=function(e){var t;for(t in e)return!1;return!0},He=function(e,t){var n=null;return function(){null!==n&&clearTimeout(n),n=setTimeout(e,t)}},Ve=function(e){try{return!!new RegExp(e)}catch(t){return!1}}},91210:function(e,t,n){"use strict";n.d(t,{nY:function(){return g},WH:function(){return m},HL:function(){return f},Et:function(){return v},yA:function(){return h}});var r=function(e){var t=e.toString().split(/[eE]/),n=(t[0].split(".")[1]||"").length-+(t[1]||0);return n>0?n:0},o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15;return+parseFloat(Number(e).toPrecision(t))},a=function(e){if(-1===e.toString().indexOf("e"))return Number(e.toString().replace(".",""));var t=r(e);return t>0?o(Number(e)*Math.pow(10,t)):Number(e)},i=function(e,t){var n=a(e),o=a(t),i=r(e)+r(t);return n*o/Math.pow(10,i)},s=n(82240),l=n(84307),c=(n(52719),["bytes","KB","MB","GB","TB","PB"]),u={comma:",",dot:".",no:"",space:" "},d=function(e){return"string"!==typeof e?"":e.endsWith("0")?e.replace(/(?:\.0*|(\.\d+?)0+)$/,"$1"):e},p=function(e,t){var n=t.formats,o=t.isCurrency,a=void 0===o||o,l=n||{},c=l.decimal,p=void 0===c?"dot":c,f=l.thousands,h=void 0===f?"no":f,m=l.precision,g=void 0===m?2:m,v=l.enable_precision,y=void 0!==v&&v;if(String(e).includes("e")){if(e<1&&e>-1){var C=e.toFixed(y?g:8);return y||(C=d(C)),0===parseFloat(C)&&C.startsWith("-")?C.substring(1):C}return String(e)}var A=u[p],x=u[h],b=y?g:function(e){if(Number.isInteger(e))return 0;var t=String(e).split(".")[1],n=t?t.length:8;return n>8?8:n}(e),_=parseFloat((0,s.LI)(e,b).toFixed(b)),w=_<0,S=Math.trunc(_),D=String(Math.abs(function(e,t){var n=Math.pow(10,Math.max(r(e),r(t)));return(i(e,n)-i(t,n))/n}(_,S)).toFixed(b)).slice(1);y||(D=d(D)),a&&(y||(D=2===D.length?D=D.padEnd(3,"0"):(D.substring(0,3)||".").padEnd(3,"0"))),D=D.replace(/./,A);for(var E=[],k=0,M=(S=Math.abs(S).toString()).length-1;M>-1;M--)k+=1,E.unshift(S[M]),k%3||0===M||E.unshift(x);return"".concat(w?"-":"").concat(E.join("")).concat(D)},f=function(e,t){var n=Object.prototype.toString.call(e);if("[object Number]"!==n)return"[object String]"===n&&e.startsWith("#")?e:"";if(isNaN(e)||e===1/0||e===-1/0)return String(e);var r=(t||{}).format;switch(void 0===r?l.KY:r){case"number":return p(e,{formats:t,isCurrency:!1});case"percent":return"".concat(p(Number.parseFloat((100*e).toFixed(8)),{formats:t,isCurrency:!1}),"%");case"yuan":return"\uffe5".concat(p(e,{formats:t}));case"dollar":return"$".concat(p(e,{formats:t}));case"euro":return"\u20ac".concat(p(e,{formats:t}));case"custom_currency":return"after"===t.currency_symbol_position?"".concat(p(e,{formats:t})).concat(t.currency_symbol||""):"".concat(t.currency_symbol||"").concat(p(e,{formats:t}));case"byte":if(e<0)return"--";if(0===e)return e+" "+c[0];var o=parseInt(Math.floor(Math.log(e)/Math.log(1e3)),10);return 0===o?e+" "+c[o]:(e/Math.pow(1e3,o)).toFixed(1)+" "+c[o];default:return String(e)}},h=function(e,t,n){if(!e)return"";var r=e.replace(/\u3002/g,".");switch(t){case"percent":return r.replace(/[^.-\d,%]/g,"");case"yuan":return r.replace(/[^.-\d\xa5\uffe5,]/g,"");case"dollar":return r.replace(/[^.-\d$,]/g,"");case"euro":return r.replace(/[^.-\d\u20ac,]/g,"");case"custom_currency":var o=new RegExp("[^.-\\d"+n+",]","g");return r.replace(o,"");default:return r.replace(/[^.-\d,]/g,"")}},m=function(e,t){if(!e&&0!==e)return null;if("number"===typeof e)return e;if("string"!==typeof e)return null;var n=parseFloat(e.replace(/[^.-\d]/g,""));return"percent"!==t||isNaN(n)?isNaN(n)?null:n:function(e,t){var n=a(e),s=a(t);return i(n/s,o(Math.pow(10,r(t)-r(e))))}(n,100)},g=function(e,t){var n=t||{},r=n.format,o=n.decimal,a=n.thousands,i=n.enable_precision,l=n.precision,c=e;if(o&&a&&"comma"===o&&(c="dot"===a?(c=(c=c.replace(/,/,"@")).replace(/\./g,",")).replace(/@/,"."):(c=c.replace(/\./g,"")).replace(/,/,".")),c=m(c,r),i&&c){var u="percent"===r?l+2:l;c=parseFloat((0,s.LI)(c,u).toFixed(u))}return c},v=function(e){return(e||0===e)&&"[object Number]"===Object.prototype.toString.call(e)}},51511:function(e,t,n){"use strict";n.d(t,{Cl:function(){return i},Fi:function(){return o},oH:function(){return c},rg:function(){return l},zX:function(){return a}});var r=n(34807),o=function(e){return e&&e.data&&Array.isArray(e.data.options)?e.data.options:[]},a=function(e,t){return(o(e).find((function(e){return e.id===t}))||{}).name},i=function(e){if(1===e.length)return String(Math.floor(Math.random()*Math.pow(10,6)));for(var t,n=!1;!n&&(t=String(Math.floor(Math.random()*Math.pow(10,6))),!(n=e.every((function(e){return e.id!==t})))););return t},s=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=i(e),a=n&&r.G.find((function(e){return e.COLOR===n}));return a||(a=function(e){var t=r.G.slice(12,24),n=Math.floor(Math.random()*t.length);if(!Array.isArray(e)||0===e.length)return t[n];var o=e.slice(-(t.length-1)),a=[],i={};for(t.forEach((function(e,t){i[e.COLOR]=t})),o.forEach((function(e){var t=i[e.color];a.push(t)}));-1!=a.indexOf(n);)n=Math.floor(Math.random()*t.length);return t[n]||t[0]}(e)),{id:o,name:t,color:a.COLOR,textColor:a.TEXT_COLOR}},l=function(e,t){var n=e.find((function(e){return e.name===t}));return n||(s(e,t)||{})},c=function(e,t){var n=[],r=[];return t.forEach((function(t){var o=e.find((function(e){return e.name===t}));if(o)r.push(o.id);else{var a=s(e,t);a&&(n.push(a),r.push(a.id))}})),0===n.length?{selectedOptionIds:r}:{cellOptions:n,selectedOptionIds:r}}},33175:function(e,t,n){"use strict";n.r(t),n.d(t,{isEnter:function(){return k},isModBackslash:function(){return f},isModComma:function(){return d},isModDot:function(){return u},isModDown:function(){return g},isModF:function(){return s},isModG:function(){return c},isModL:function(){return i},isModLeft:function(){return v},isModP:function(){return l},isModRight:function(){return y},isModS:function(){return o},isModSemicolon:function(){return h},isModShiftComma:function(){return b},isModShiftDot:function(){return x},isModShiftG:function(){return A},isModShiftZ:function(){return C},isModSlash:function(){return p},isModUp:function(){return m},isModZ:function(){return a},isOptPageDown:function(){return D},isOptPageUp:function(){return S},isShiftEnter:function(){return _},isShiftModEnter:function(){return w},isSpace:function(){return E}});var r=n(75168),o=(0,r.default)("mod+s"),a=(0,r.default)("mod+z"),i=(0,r.default)("mod+l"),s=(0,r.default)("mod+f"),l=(0,r.default)("mod+p"),c=(0,r.default)("mod+g"),u=(0,r.default)("mod+."),d=(0,r.default)("mod+,"),p=(0,r.default)("mod+/"),f=(0,r.default)("mod+'"),h=(0,r.default)("mod+;"),m=(0,r.default)("mod+up"),g=(0,r.default)("mod+down"),v=(0,r.default)("mod+left"),y=(0,r.default)("mod+right"),C=(0,r.default)("mod+shift+z"),A=(0,r.default)("mod+shift+g"),x=(0,r.default)("mod+shift+."),b=(0,r.default)("mod+shift+,"),_=(0,r.default)("shift+enter"),w=(0,r.default)("shift+mod+enter"),S=(0,r.default)("opt+pageup"),D=(0,r.default)("opt+pagedown"),E=(0,r.default)("space"),k=(0,r.default)("enter")},82240:function(e,t,n){"use strict";n.d(t,{LI:function(){return o},YX:function(){return r}});var r=function(e,t){return e===t||Math.abs(e-t)<1e-5},o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(0===t)return Math.round(e);var n=Math.pow(10,t),r=e*n;return t>0&&(r=Number.parseFloat(r.toFixed(1))),Math.round(r)/n}},82622:function(e,t,n){"use strict";var r=n(9950),o=n(78297),a=n(48738),i=n.n(a),s=n(71791),l=n(44414);t.A=function(e){var t=e.isShowRateItem,n=e.field,a=e.enterIndex,c=e.index,u=e.value,d=e.onMouseEnter,p=e.onMouseLeave,f=e.onChange,h=(0,r.useRef)(null),m=(0,r.useCallback)((function(){d(c)}),[c,d]),g=(0,r.useCallback)((function(){p()}),[p]),v=(0,r.useCallback)((function(){f(c)}),[c,f]);if(!t&&c>u)return null;var y=n.data||{},C=y.color,A=y.type,x={fill:u>=c?C:"#e5e5e5"};return a>=c&&(x={fill:C,opacity:u>=c?1:.4}),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{onMouseEnter:m,onMouseLeave:g,style:x,onClick:v,className:i()("sf-metadata-rate-item",{active:u>=c}),ref:h,children:(0,l.jsx)(s.In,{iconName:A||"rate"})}),-1!==a&&(0,l.jsx)(o.A,{placement:"bottom",target:h,modifiers:{preventOverflow:{boundariesElement:document.body}},className:"sf-metadata-tooltip",children:a})]})}},65842:function(e,t,n){"use strict";n.d(t,{UI:function(){return o},me:function(){return a},zP:function(){return r}});var r={COLUMN_NAME:"COLUMN_NAME",COLUMN_TYPE:"COLUMN_TYPE"},o={CUSTOM_REGULAR:"CUSTOM_REGULAR"},a={CUSTOM_CURRENCY:"CUSTOM_CURRENCY"}},46971:function(e,t,n){"use strict";n.d(t,{A:function(){return j}});var r=n(5544),o=n(9950),a=n(42119),i=n(18849),s=n(48738),l=n.n(s),c=n(3563),u=n(58419),d=n(51528),p=n(54154),f=n(65842),h=n(47127),m=n(76152),g=n(85077),v=n(15668),y=n(44414),C=(0,o.forwardRef)((function(e,t){var n=e.readOnly,a=e.value,i=(0,o.useState)(""),s=(0,r.A)(i,2),c=s[0],d=s[1],p=(0,o.useState)(a||""),f=(0,r.A)(p,2),h=f[0],C=f[1],A=(0,o.useCallback)((function(e){var t=e.target.value;h!==t&&C(t)}),[h]);return(0,o.useImperativeHandle)(t,(function(){return{getName:function(){return h},setError:function(e){return d(e)}}}),[h]),(0,o.useEffect)((function(){C(a)}),[a]),(0,y.jsxs)(m.A,{className:l()("sf-metadata-column-settings-item",{"is-invalid":c}),children:[(0,y.jsx)(g.A,{placeholder:(0,u.AP)("Property name"),value:h,onChange:A,readOnly:n,autoFocus:!0}),c&&(0,y.jsx)(v.A,{children:c})]})})),A=n(55627),x=n(71791),b=n(31425),_=n(40866),w=450,S=function(e){var t=e.column,n=e.columns,a=e.target,i=e.parentWidth,s=e.onChange,c=e.onToggle,d=(0,o.useRef)(null),p=(0,o.useRef)(null),f=(0,o.useMemo)((function(){if(a){var e=a.getBoundingClientRect(),t=e.top,n=e.left,r={width:w,left:n+i,top:t,maxHeight:"calc(100% - ".concat(t,"px - 5px)")};return n+w+i>document.body.offsetWidth&&(r.left=n-w<=5?5:n-w),r}}),[a,i]),h=(0,o.useState)(""),m=(0,r.A)(h,2),v=m[0],C=m[1],A=(0,o.useMemo)((function(){var e=v.trim().toLocaleLowerCase();return n.filter((function(t){return t.name.toLocaleLowerCase().indexOf(e)>-1}))}),[v,n]),b=(0,o.useCallback)((function(e){var t=e.target.value;t!==v&&C(t)}),[v]),S=(0,o.useCallback)((function(e){e.stopPropagation()}),[]),D=(0,o.useMemo)((function(){return A.filter((function(e){return"basics"===e.groupby}))}),[A]),E=(0,o.useMemo)((function(){return A.filter((function(e){return"predefined"===e.groupby}))}),[A]),k=(0,o.useCallback)((function(e,t){e&&e.stopPropagation(),e&&e.nativeEvent.stopImmediatePropagation(),s(t)}),[s]);(0,o.useEffect)((function(){setTimeout((function(){var e;null===d||void 0===d||null===(e=d.current)||void 0===e||e.focus()}),1)}),[]);var M=(0,o.useCallback)((function(e){p.current&&(-1!==(0,u.wD)(e).indexOf("popover")||p.current.contains(e.target)||setTimeout((function(){return c()}),100))}),[p,c]);return(0,o.useEffect)((function(){return document.addEventListener("click",M),function(){document.removeEventListener("click",M)}}),[]),(0,y.jsx)(_.A,{children:(0,y.jsxs)("div",{className:"sf-metadata-column-types-popover",style:f,ref:p,children:[(0,y.jsx)("div",{className:"search-column-container",children:(0,y.jsx)(g.A,{onChange:b,placeholder:(0,u.AP)("Search property types"),value:v,onClick:S,ref:d})}),A.length>0&&(0,y.jsx)("div",{className:"select-column-wrapper",children:(0,y.jsxs)("div",{className:"select-column-list",children:[E.length>0&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{className:"select-column-title",children:(0,u.AP)("Predefined properties")}),E.map((function(e){return(0,y.jsxs)("div",{className:l()("select-column-item text-truncate",{active:e.key===t.key}),onClick:function(t){return k(t,e)},children:[(0,y.jsx)(x.In,{iconName:e.icon}),(0,y.jsx)("span",{children:e.name})]},e.key)}))]}),D.length>0&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{className:"select-column-title",children:(0,u.AP)("Custom properties")}),D.map((function(e){return(0,y.jsxs)("div",{className:l()("select-column-item text-truncate",{active:e.key===t.key}),onClick:function(t){return k(t,e)},children:[(0,y.jsx)(x.In,{iconName:e.icon}),(0,y.jsx)("span",{children:e.name})]},e.key)}))]})]})})]})})},D=[{icon:c.ZPL[c.vZe.COLLABORATOR],type:c.vZe.COLLABORATOR,name:(0,b.Q8)(c.L2D.FILE_COLLABORATORS),unique:!0,key:c.L2D.FILE_COLLABORATORS,canChangeName:!1,groupby:"predefined"},{icon:c.ZPL[c.vZe.DATE],type:c.vZe.DATE,name:(0,b.Q8)(c.L2D.FILE_EXPIRE_TIME),unique:!0,key:c.L2D.FILE_EXPIRE_TIME,canChangeName:!1,groupby:"predefined"},{icon:c.ZPL[c.vZe.LONG_TEXT],type:c.vZe.LONG_TEXT,name:(0,b.Q8)(c.L2D.FILE_DESCRIPTION),unique:!0,key:c.L2D.FILE_DESCRIPTION,canChangeName:!1,groupby:"predefined"},{icon:c.ZPL[c.vZe.SINGLE_SELECT],type:c.vZe.SINGLE_SELECT,name:(0,b.Q8)(c.L2D.FILE_STATUS),unique:!0,key:c.L2D.FILE_STATUS,canChangeName:!1,groupby:"predefined"},{icon:c.ZPL[c.vZe.TEXT],type:c.vZe.TEXT,name:(0,u.AP)("Text"),canChangeName:!0,key:c.vZe.TEXT,groupby:"basics"},{icon:c.ZPL[c.vZe.LONG_TEXT],type:c.vZe.LONG_TEXT,name:(0,u.AP)("Long text"),canChangeName:!0,key:c.vZe.LONG_TEXT,groupby:"basics"},{icon:c.ZPL[c.vZe.NUMBER],type:c.vZe.NUMBER,name:(0,u.AP)("Number"),canChangeName:!0,key:c.vZe.NUMBER,groupby:"basics"},{icon:c.ZPL[c.vZe.COLLABORATOR],type:c.vZe.COLLABORATOR,name:(0,u.AP)("Collaborator"),canChangeName:!0,key:c.vZe.COLLABORATOR,groupby:"basics"},{icon:c.ZPL[c.vZe.CHECKBOX],type:c.vZe.CHECKBOX,name:(0,u.AP)("Checkbox"),canChangeName:!0,key:c.vZe.CHECKBOX,groupby:"basics"},{icon:c.ZPL[c.vZe.DATE],type:c.vZe.DATE,name:(0,u.AP)("Date"),canChangeName:!0,key:c.vZe.DATE,groupby:"basics"},{icon:c.ZPL[c.vZe.SINGLE_SELECT],type:c.vZe.SINGLE_SELECT,name:(0,u.AP)("Single select"),canChangeName:!0,key:c.vZe.SINGLE_SELECT,groupby:"basics"},{icon:c.ZPL[c.vZe.MULTIPLE_SELECT],type:c.vZe.MULTIPLE_SELECT,name:(0,u.AP)("Multiple select"),canChangeName:!0,key:c.vZe.MULTIPLE_SELECT,groupby:"basics"},{icon:c.ZPL[c.vZe.RATE],type:c.vZe.RATE,name:(0,u.AP)("Rate"),canChangeName:!0,key:c.vZe.RATE,groupby:"basics"}],E=(0,o.forwardRef)((function(e,t){var n=e.parentWidth,a=e.column,i=e.onChange,s=(0,o.useState)(""),c=(0,r.A)(s,2),d=c[0],p=c[1],f=(0,o.useState)(!1),h=(0,r.A)(f,2),g=h[0],C=h[1],b=(0,o.useRef)(null),_=(0,o.useCallback)((function(e){e&&e.stopPropagation(),e&&e.nativeEvent.stopImmediatePropagation(),C(!g)}),[g]),w=(0,o.useCallback)((function(){C(!1)}),[]),E=(0,o.useCallback)((function(e){i(e)}),[i]);return(0,o.useImperativeHandle)(t,(function(){return{setError:function(e){return p(e)},getIsPopoverShow:function(){return g},setPopoverState:function(e){return C(e)}}}),[g]),(0,o.useEffect)((function(){i(D[6])}),[]),(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(m.A,{className:l()("sf-metadata-column-settings-item",{"is-invalid":d}),children:[(0,y.jsx)(A.A,{children:(0,u.AP)("Type")}),(0,y.jsxs)("div",{className:l()("sf-metadata-column-type",{"sf-metadata-column-type-focus":g}),ref:b,onClick:_,children:[(0,y.jsxs)("div",{className:"sf-metadata-column-type-info",children:[(0,y.jsx)(x.In,{iconName:a.icon,className:"mr-2"}),(0,y.jsx)("span",{children:a.name})]}),(0,y.jsx)(x.In,{iconName:"drop-down"})]}),d&&(0,y.jsx)(v.A,{children:d})]}),g&&b.current&&(0,y.jsx)(S,{columns:D,column:a,target:b.current,parentWidth:n,onChange:E,onToggle:w})]})})),k=n(89379),M=n(99730),I=function(e){var t=e.value,n=e.onChange,r=(t||{format:"YYYY-MM-DD"}).format,a=(0,o.useMemo)((function(){var e=new Date,t=e.getFullYear(),n=e.getMonth()+1,r=e.getDate(),o=e.getHours(),a=e.getMinutes();return n=n>9?n:"0".concat(n),r=r>9?r:"0".concat(r),o=o>9?o:"0".concat(o),a=a>9?a:"0".concat(a),"".concat(t,"-").concat(n,"-").concat(r," ").concat(o,":").concat(a)}),[]),i=(0,o.useMemo)((function(){return[{label:"".concat((0,u.AP)("ISO")," (").concat((0,c.u1Q)(a,"YYYY-MM-DD"),")"),value:"YYYY-MM-DD"},{label:"".concat((0,u.AP)("US")," (").concat((0,c.u1Q)(a,"M/D/YYYY"),")"),value:"M/D/YYYY"},{label:"".concat((0,u.AP)("European")," (").concat((0,c.u1Q)(a,"DD/MM/YYYY"),")"),value:"DD/MM/YYYY"},{label:"".concat((0,u.AP)("Germany Russia etc")," (").concat((0,c.u1Q)(a,"DD.MM.YYYY"),")"),value:"DD.MM.YYYY"}]}),[a]),s=(0,o.useCallback)((function(e){n((0,k.A)((0,k.A)({},t),{},{format:e}))}),[t,n]),l=(0,o.useCallback)((function(e){var t=r||"YYYY-MM-DD",o=r.split(" ");1===o.length&&(t=r+" HH:mm"),2===o.length&&(t=o[0]),n({format:t})}),[r,n]);(0,o.useEffect)((function(){r||n({format:"YYYY-MM-DD"})}),[]);var d=i.find((function(e){return e.value===r}))||i[0];return(0,y.jsxs)("div",{className:"sf-metadata-column-data-settings sf-metadata-date-column-data-settings",children:[(0,y.jsxs)(m.A,{className:"",children:[(0,y.jsx)(A.A,{children:(0,u.AP)("Format")}),(0,y.jsx)(x.Cg,{value:d,options:i,onSelectOption:s})]}),(0,y.jsx)("div",{className:"pb-4",children:(0,y.jsx)(M.A,{checked:!!r&&r.indexOf("HH:mm")>-1,size:"large",textPosition:"right",className:"sf-metadata-date-column-data-minute w-100",onChange:l,placeholder:(0,u.AP)("Accurate to minute")})})]})},N=function(e){var t=e.value,n=e.onChange,a=e.updatePopoverState,i=(0,k.A)({max:5,color:"#FF8000",type:"rate"},t),s=i.max,d=i.color,p=i.type,f=(0,o.useState)(!1),h=(0,r.A)(f,2),g=h[0],v=h[1],C=(0,o.useMemo)((function(){return c.WvA.map((function(e){return{label:e.name,value:e.name}}))}),[]);(0,o.useEffect)((function(){n(i)}),[]);var b=(0,o.useMemo)((function(){return C.find((function(e){return e.value===s}))||C.find((function(e){return 5===e.value}))}),[C,s]),_=(0,o.useCallback)((function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),g||(v(!0),a(!0))}),[a]),w=(0,o.useCallback)((function(){v(!1),setTimeout((function(){return a(!1)}),100)}),[a]),S=(0,o.useCallback)((function(e,r){n((0,k.A)((0,k.A)({},t),{},{color:e,type:r})),w()}),[t,n,w]),D=(0,o.useCallback)((function(e){n((0,k.A)((0,k.A)({},t),{},{max:e}))}),[t,n]);return(0,y.jsx)("div",{className:"sf-metadata-column-data-settings sf-metadata-rate-column-data-settings",children:(0,y.jsxs)("div",{className:"column-data-settings-container",children:[(0,y.jsxs)(m.A,{className:"rate-column-data-setting-item rate-column-data-style-setting",children:[(0,y.jsx)(A.A,{children:(0,u.AP)("Style")}),(0,y.jsxs)("div",{className:l()("sf-metadata-select custom-select rate-column-data-style-setting-wrapper",{focus:g}),id:"sf-metadata-rate-column-data-style-setting-wrapper",onClick:_,children:[(0,y.jsx)("div",{className:"selected-option",style:{fill:d},children:(0,y.jsx)(x.In,{iconName:p})}),(0,y.jsx)(x.In,{iconName:"drop-down"})]}),g&&(0,y.jsx)(x.Rw,{target:"sf-metadata-rate-column-data-style-setting-wrapper",className:"sf-metadata-rate-column-data-style-setting-popover",hide:w,hideWithEsc:w,modifiers:{preventOverflow:{boundariesElement:document.body}},children:(0,y.jsx)("div",{className:"rate-column-style-list",children:c.uCw.map((function(e){return c.Tvi.map((function(t){return(0,y.jsx)(x.Oi,{iconName:t,onClick:function(){return S(e,t)},style:{fill:e},className:"rate-column-data-style-item"},t+"color"+e)}))}))})})]}),(0,y.jsxs)(m.A,{className:"rate-column-data-setting-item rate-column-data-max-setting",children:[(0,y.jsx)(A.A,{children:(0,u.AP)("Max")}),(0,y.jsx)(x.Cg,{value:b,options:C,onSelectOption:D})]})]})})},P=(0,o.forwardRef)((function(e,t){var n=e.column,a=(0,o.useMemo)((function(){return n.type}),[n]),i=(0,o.useState)({}),s=(0,r.A)(i,2),l=s[0],u=s[1],d=(0,o.useState)(!1),p=(0,r.A)(d,2),f=p[0],h=p[1];(0,o.useImperativeHandle)(t,(function(){return{getValue:function(){return l},setValue:function(e){return u(e)},getIsPopoverShow:function(){return f}}}),[f,l]);var m=(0,o.useCallback)((function(e){u(e)}),[]);return a===c.vZe.DATE?(0,y.jsx)(I,{value:l,onChange:m}):a===c.vZe.RATE?(0,y.jsx)(N,{value:l,onChange:m,updatePopoverState:h}):null})),T=P,O={},j=function(e){var t=e.target,n=e.onChange,s=(0,o.useState)({}),m=(0,r.A)(s,2),g=m[0],v=m[1],A=(0,o.useRef)(null),x=(0,o.useRef)(null),_=(0,o.useRef)(null),w=(0,o.useRef)(null),S=(0,o.useRef)(null),D=(0,h.p)().metadata,k=(0,o.useMemo)((function(){return O[g.type]||350}),[g]),M=(0,o.useCallback)((function(e){var t,n;null!==(t=w.current)&&void 0!==t&&t.getIsPopoverShow()||null!==(n=S.current)&&void 0!==n&&n.getIsPopoverShow()||A.current.toggle()}),[w,S]),I=(0,o.useCallback)((function(e){setTimeout((function(){w.current.setPopoverState(!1)}),100),d.A.isSameObject(g,e)||(v(e),e.type!==g.type&&S.current.setValue({}))}),[w,g]),N=(0,o.useCallback)((function(){_.current.setError(""),w.current.setError("");var e=1,t=_.current.getName(),r=p.Sp[f.zP.COLUMN_NAME]({columnName:t,metadata:D,gettext:u.AP});r&&(_.current.setError(r.tips),e=0);var o=p.Sp[f.zP.COLUMN_TYPE]({column:g,metadata:D,gettext:u.AP});if(o&&(w.current.setError(o.tips),e=0),0!=e){var a=S.current.getValue();0===Object.keys(a).length&&(a=null,g.unique?g.type===c.vZe.SINGLE_SELECT&&g.key===c.L2D.FILE_STATUS&&(a={options:(0,b.YO)()}):g.type===c.vZe.SINGLE_SELECT||g.type===c.vZe.MULTIPLE_SELECT?a={options:[]}:g.type===c.vZe.DATE&&(a={format:c.D23})),n(g.unique?g.key:t,g.type,{key:g.unique?g.key:"",data:a}),M()}}),[_,g,D,n,M]);return(0,y.jsx)(a.A,{target:t,trigger:"legacy",placement:"bottom-end",hideArrow:!0,toggle:M,fade:!1,ref:A,className:"sf-metadata-column-popover",children:(0,y.jsxs)("div",{className:"sf-metadata-column-popover-inner",ref:x,style:{width:k},children:[(0,y.jsxs)("div",{children:[(0,y.jsx)(C,{ref:_,readOnly:null===g||void 0===g?void 0:g.unique,value:null!==g&&void 0!==g&&g.unique?g.name:""}),(0,y.jsx)(E,{ref:w,column:g,onChange:I,parentWidth:k}),(0,y.jsx)(T,{ref:S,column:g})]}),(0,y.jsxs)("div",{className:l()("sf-metadata-column-popover-footer",{"sf-metadata-number-column-popover-footer":g.type===c.vZe.NUMBER}),children:[(0,y.jsx)(i.A,{color:"secondary",className:"mr-4",onClick:M,children:(0,u.AP)("Cancel")}),(0,y.jsx)(i.A,{color:"primary",onClick:N,children:(0,u.AP)("Submit")})]})]})})}},54154:function(e,t,n){"use strict";n.d(t,{Sp:function(){return i}});var r=n(64467),o=n(3563),a=n(65842),i=(0,r.default)((0,r.default)((0,r.default)((0,r.default)({},a.zP.COLUMN_NAME,(function(e){var t=e.columnName,n=e.oldColumn,r=e.metadata,i=e.gettext;return t?t.includes(".")?{type:a.zP.COLUMN_NAME,tips:i("Name cannot contain dots")}:t.includes("`")?{type:a.zP.COLUMN_NAME,tips:i("Name cannot contain backtick")}:t.includes("{")||t.includes("}")?{type:a.zP.COLUMN_NAME,tips:i("Name cannot contain curly braces")}:(!n||n&&n.name!==t)&&(0,o.pTd)(r.columns,t)?{type:a.zP.COLUMN_NAME,tips:i("There is another property with this name")}:null:{type:a.zP.COLUMN_NAME,tips:i("This is required")}})),a.zP.COLUMN_TYPE,(function(e){var t=e.column,n=e.metadata,r=e.gettext;return t.unique&&(0,o.rm3)(n.columns,t.key)?{type:a.zP.COLUMN_TYPE,tips:r("Another property has this property type")}:null})),o.vZe.TEXT,(function(e){var t=e.column,n=e.gettext,r=t.format_specification_value;return"custom_format"===t.format_check_type&&r&&!(0,o.ZvR)(r)?{type:a.UI.CUSTOM_REGULAR,tips:n("Invalid regular expression")}:null})),o.vZe.NUMBER,(function(e){var t=e.column,n=e.gettext,r=t.format,o=t.currency_symbol;return"custom_currency"!==r||o?null:{type:a.me.CUSTOM_CURRENCY,tips:n("This is required")}}))},99153:function(e,t,n){"use strict";n.d(t,{Iz:function(){return ye},D0:function(){return je},Oe:function(){return Ue},wm:function(){return R},Yt:function(){return m},cu:function(){return De}});n(46971);var r=n(5544),o=n(9950),a=n(26100),i=n(85077),s=n(71791),l=n(13042),c=n(54154),u=n(65842),d=n(47127),p=n(58419),f=n(4086),h=n(44414),m=function(e){var t=e.value,n=e.target,m=e.onToggle,g=e.onSubmit,v=(0,o.useState)(t),y=(0,r.A)(v,2),C=y[0],A=y[1],x=(0,o.useRef)(null),b=(0,d.p)().metadata,_=(0,o.useCallback)((function(e){var t=e.target.value;t!==C&&A(t)}),[C]),w=(0,o.useCallback)((function(){if(C!==t){var e=c.Sp[u.zP.COLUMN_NAME]({columnName:C,metadata:b,gettext:p.AP});e?f.A.danger(e.tips):g(C)}else m()}),[C,t,b,g,m]),S=(0,o.useCallback)((function(e){e.keyCode===l.cK.Enter&&(e.preventDefault(),w())}),[w]),D=(0,o.useCallback)((function(e){e.preventDefault()}),[]);return(0,o.useEffect)((function(){return x.current.focus(),document.addEventListener("keydown",S),function(){document.removeEventListener("keydown",S)}}),[S]),(0,h.jsx)(s.Rw,{target:n,className:"sf-metadata-rename-column-popover",hide:w,hideWithEsc:m,children:(0,h.jsx)(a.A,{className:"p-4",children:(0,h.jsx)(i.A,{value:C,innerRef:x,onClick:D,onChange:_})})})},g=n(3563),v=n(51511),y=n(35975),C=n(89857),A=n(72784),x=(0,C.Tl)("sfMetadataSingleSelectOption",{},(function(e){return{connectDropTarget:e.dropTarget()}}))((function(e){var t=e.inputRef,n=e.options;return Array.isArray(n)&&0!==n.length?(0,h.jsx)("div",{className:"sf-metadata-select-options-list",ref:t,children:n}):null})),b=(0,A.A)(x),_=n(60436),w=n(23029),S=n(92901),D=n(39874),E=n(85501),k=n(78297),M=function(e){function t(){var e;(0,w.A)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=(0,D.A)(this,t,[].concat(r))).getValidOptions=function(t){var n,r=e.props.column,o=(null===r||void 0===r||null===(n=r.data)||void 0===n?void 0:n.options)||[],a=[],i={};o.forEach((function(e){return i[e.id]=!0}));for(var s=0;s<t.length;s++)t[s]&&"object"===typeof t[s]&&t[s].name&&t[s].color&&t[s].id&&!i[t[s].id]&&(a.push(t[s]),i[t[s].id]=!0);return a},e.onImportOptionsToggle=function(){e.importOptionsInput.click()},e.importOptionsInputChange=function(){if(e.importOptionsInput.files&&0!==e.importOptionsInput.files.length){var t=new FileReader;t.onload=e.handleImportOptions.bind(e),t.onerror=e.handleImportOptionsError.bind(e),t.readAsText(e.importOptionsInput.files[0])}else f.A.warning((0,p.AP)("Please select a file"))},e.handleImportOptions=function(t){var n,r=[];try{r=JSON.parse(t.target.result)}catch(s){return void f.A.danger((0,p.AP)("The imported options are invalid"))}if(Array.isArray(r)&&0!==r.length){var o=e.getValidOptions(r);if(0!==o.length){var a=e.props.column,i=(null===a||void 0===a||null===(n=a.data)||void 0===n?void 0:n.options)||[];o=[].concat((0,_.A)(i),(0,_.A)(o)),e.props.onImportOptions(o),e.importOptionsInput.value=null,f.A.success((0,p.AP)("Options imported"))}else f.A.warning((0,p.AP)("The imported option already exists"))}else f.A.danger((0,p.AP)("The imported options are invalid"))},e.handleImportOptionsError=function(){f.A.success((0,p.AP)("Failed imported options"))},e}return(0,E.A)(t,e),(0,S.A)(t,[{key:"render",value:function(){var e,t=this,n=this.props,r=n.column,o=n.onToggle,a=(null===r||void 0===r||null===(e=r.data)||void 0===e?void 0:e.options)||[],i="data:text/json;charset=utf-8,".concat(encodeURIComponent(JSON.stringify(a)));return(0,h.jsxs)("div",{className:"option-editor-footer",children:[(0,h.jsx)("span",{"aria-hidden":"true",className:"sf3-font-help sf3-font option-editor-tips",id:"edit-option-tip"}),(0,h.jsx)(k.A,{delay:{show:0,hide:0},target:"edit-option-tip",placement:"bottom",className:"sf-metadata-tooltip",children:(0,p.AP)("Use the import/export function to transfer options quickly. (The export is in JSON format.) By pasting cells, copied from a text column, an Excel or a TXT file, you can also add options quickly.")}),(0,h.jsx)("input",{type:"file",ref:function(e){return t.importOptionsInput=e},accept:".json",className:"d-none",onChange:this.importOptionsInputChange}),(0,h.jsx)("span",{className:"item-text",onClick:this.onImportOptionsToggle,children:(0,p.AP)("Import options")}),a&&a.length>0&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("span",{className:"mx-2",children:"|"}),(0,h.jsx)("a",{href:i,download:"".concat(r.name,"-options.json"),onClick:o,children:(0,h.jsx)("span",{className:"item-text",children:(0,p.AP)("Export options")})})]})]})}}])}(o.Component),I=n(48738),N=n.n(I),P=function(e){var t=e.option,n=e.isViewing,a=e.onChange,i=(0,o.useMemo)((function(){return"option-color-".concat(t.id)}),[t]),l=(0,o.useState)(!1),c=(0,r.A)(l,2),u=c[0],d=c[1],p=(0,o.useCallback)((function(){d(!0)}),[]),f=(0,o.useCallback)((function(){d(!1)}),[]),m=(0,o.useCallback)((function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),d(!1);var n=e.target.value;if(n!==(null===t||void 0===t?void 0:t.color)){var r=g.Gin.find((function(e){return e.COLOR===n})),o=Object.assign({},t,{color:n,textColor:r.TEXT_COLOR,borderColor:r.BORDER_COLOR});a(o)}}),[t,a]);return(0,o.useEffect)((function(){n||d(!1)}),[n]),(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(s.Oi,{className:"sf-metadata-edit-option-color",id:i,style:{backgroundColor:(null===t||void 0===t?void 0:t.color)||null},iconName:"drop-down",iconStyle:{fill:(null===t||void 0===t?void 0:t.textColor)||"#666"},onClick:p}),u&&(0,h.jsx)(s.Rw,{target:i,className:"sf-metadata-edit-option-color-popover",hide:f,hideWithEsc:f,children:(0,h.jsx)("div",{className:"row gutters-xs",onClick:function(e){return e&&e.stopPropagation()},children:g.Gin.map((function(e,n){var r=e.COLOR,o=e.BORDER_COLOR,a=e.TEXT_COLOR,l=0===n&&!t||(null===t||void 0===t?void 0:t.color)===r;return(0,h.jsx)("div",{className:"col-auto",children:(0,h.jsxs)("label",{className:"color-select",children:[(0,h.jsx)("input",{name:"color",type:"radio",value:r,className:"sf-metadata-edit-option-color-item-input",defaultChecked:l,onClick:m}),(0,h.jsx)(s.Oi,{className:N()("sf-metadata-edit-option-color-item-container",{selected:l}),id:i,style:{backgroundColor:r||null,borderColor:o},iconName:"check-mark",iconStyle:{fill:a||"#666"}})]})},e.COLOR)}))})})]})},T=function(e){var t=e.isEditing,n=e.option,a=e.onOpen,s=e.onClose,l=e.onToggleFreeze,c=e.onChange,u=(0,o.useState)((null===n||void 0===n?void 0:n.name)||""),d=(0,r.A)(u,2),p=d[0],f=d[1],m=(0,o.useRef)(null),v=(0,o.useCallback)((function(){var e=p.trim();if(e!==n.name&&""!==e){var t=Object.assign({},n,{name:e});c(t,(function(){l(!1),s()}),(function(){a(n.id)}))}}),[p,l,n,c,a,s]),y=(0,o.useCallback)((function(e){m.current&&!m.current.contains(e.target)&&t&&v()}),[t,v]),C=(0,o.useCallback)((function(e){var t=e.target.value;t!==p&&f(t)}),[p]),A=(0,o.useCallback)((function(e){e.keyCode===g.cKb.Enter&&(e.preventDefault(),v())}),[v]),x=(0,o.useCallback)((function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),a(n.id)}),[n,a]);return(0,o.useEffect)((function(){return document.addEventListener("mousedown",y),function(){document.addEventListener("mousedown",y)}}),[]),(0,h.jsx)("div",{ref:m,className:"sf-metadata-edit-option-name",style:{width:"calc(100% - 30px)"},children:t?(0,h.jsx)(i.A,{className:"sf-metadata-edit-option-name-input mx-2",type:"text",value:p,onChange:C,onKeyDown:A,onBlur:v,autoFocus:!0}):(0,h.jsx)("div",{className:"sf-metadata-edit-option-name-value text-truncate",onClick:x,title:p,children:p})})},O=(0,C.Tl)("sfMetadataSingleSelectOption",{drop:function(e,t){var n=t.getItem(),r=e.index;if(r!==n.idx){var o={idx:r,data:e.option};e.onMove(n,o)}}},(function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver(),canDrop:t.canDrop(),dragged:t.getItem()}}))((0,C.I4)("sfMetadataSingleSelectOption",{beginDrag:function(e){return{idx:e.index,data:e.option,mode:"sfMetadataSingleSelectOption"}},endDrag:function(e,t){var n=t.getItem();if(!t.didDrop())return{optionSource:n,optionTarget:{}}},isDragging:function(e,t){var n=e.index;return e.dragged.idx>n}},(function(e,t){return{connectDragSource:e.dragSource(),connectDragPreview:e.dragPreview(),isDragging:t.isDragging()}}))((function(e){var t=e.isOver,n=e.isDragging,r=e.canDrop,a=e.connectDragSource,i=e.connectDragPreview,l=e.connectDropTarget,c=e.isViewing,u=e.isDeleting,d=e.isEditing,p=e.option,f=e.onDelete,m=e.onUpdate,g=e.onMouseLeave,v=e.onMouseEnter,y=e.onToggleFreeze,C=e.onOpenNameEditor,A=e.onCloseNameEditor,x=(0,o.useCallback)((function(e){e.nativeEvent.stopImmediatePropagation(),f(p.id)}),[p,f]),b=(0,o.useCallback)((function(){v(p.id)}),[p,v]);return l(i((0,h.jsxs)("div",{className:N()("sf-metadata-edit-option-container",{"sf-metadata-edit-option-can-drop":t&&r&&!n,"sf-metadata-edit-deleting-option":u,"sf-metadata-edit-option-can-drop-top":t&&r&&n,"sf-metadata-edit-option-viewing":c,"sf-metadata-edit-option-editing":d}),onMouseEnter:function(){return b()},onMouseLeave:g,children:[a((0,h.jsx)("div",{className:"sf-metadata-edit-option-drag-container",children:(0,h.jsx)(s.In,{iconName:"drag"})})),(0,h.jsxs)("div",{className:"sf-metadata-edit-option-content",children:[(0,h.jsx)(P,{option:p,onChange:m,isViewing:c}),(0,h.jsx)(T,{option:p,isEditing:d,onChange:m,onToggleFreeze:y,onOpen:C,onClose:A})]}),(0,h.jsx)("div",{id:"sf-metadata-edit-option-more-operation-".concat(p.id),className:"sf-metadata-edit-option-more-operations",children:(c||u)&&(0,h.jsx)(s.Oi,{className:"sf-metadata-edit-option-operation-item",onClick:x,iconName:"delete"})})]})))}))),j=function(e){var t=e.option,n=e.onToggle,a=e.onSubmit,i=e.deleteNumber,l=(0,o.useState)(!1),c=(0,r.A)(l,2),u=c[0],d=c[1],f=(0,o.useCallback)((function(){n()}),[n]),m=(0,o.useCallback)((function(){d(!0),a()}),[a]);return(0,h.jsxs)(s.Rw,{target:"sf-metadata-edit-option-more-operation-".concat(t.id),className:"sf-metadata-confirm-delete-option-popover",hide:f,hideWithEsc:f,children:[(0,h.jsxs)("div",{className:"sf-metadata-tip-default mt-2 mb-4",children:[(0,p.AP)("{name} rows use this option.").replace("{name}",i)," ",(0,p.AP)("Are you sure you want to delete this option?")]}),(0,h.jsxs)("div",{className:"d-flex justify-content-end",children:[(0,h.jsx)("button",{className:"btn btn-secondary mr-2",onClick:f,children:(0,p.AP)("Cancel")}),(0,h.jsx)("button",{className:"btn btn-primary",disabled:u,onClick:u?function(){}:m,children:u?(0,h.jsx)(s.Rh,{}):(0,p.AP)("Delete")})]})]})},R=function(e){var t=e.target,n=e.column,a=e.onToggle,i=e.onSubmit,l=(0,o.useState)((0,g.FiT)(n)),c=(0,r.A)(l,2),u=c[0],m=c[1],C=(0,o.useState)(""),A=(0,r.A)(C,2),x=A[0],_=A[1],w=(0,o.useState)(-1),S=(0,r.A)(w,2),D=S[0],E=S[1],k=(0,o.useState)(""),I=(0,r.A)(k,2),N=I[0],P=I[1],T=(0,o.useState)(-1),R=(0,r.A)(T,2),L=R[0],F=R[1],U=(0,o.useState)(0),Y=(0,r.A)(U,2),B=Y[0],H=Y[1],V=(0,o.useRef)(!1),G=(0,o.useRef)(null),q=(0,o.useRef)(!0),z=(0,d.p)().metadata,W=(0,o.useMemo)((function(){var e=x.trim().toLowerCase();return e?u.filter((function(t){var n=t.name;return"string"===typeof n&&n.toLowerCase().includes(e)})):u||[]}),[u,x]),K=(0,o.useCallback)((function(e){i(e.filter((function(e){return e.name}))),m(e)}),[i]),Z=(0,o.useCallback)((function(e,t,n){if(u.find((function(t){return t.name===e.name&&t.id!==e.id})))return f.A.danger((0,p.AP)("There is another option with this name")),n&&n(),void(q.current=!1);q.current=!0,t&&t();var r=u.slice(0),o=r.findIndex((function(t){return t.id===e.id}));r.splice(o,1,e),K(r)}),[u,K,q]),X=(0,o.useCallback)((function(e,t){var n=e.idx,r=t.idx,o=t.data,a=W.splice(n,1)[0],i=u.slice(0).filter((function(e){return e.id!==a.id})),s=i.findIndex((function(e){return e.id===o.id}));r>n&&s++,i.splice(s,0,a),K(i)}),[u,W,K]),$=(0,o.useCallback)((function(){var e=(null===x||void 0===x?void 0:x.trim())||"",t=(0,y.r)(u,e),n=u.slice(0);n.push(t),K(n),F(e?"":t.id)}),[x,u,K]),J=(0,o.useCallback)((function(e){var t,n=u.filter((function(t){return t.id!==e}));W[W.length-1].id===e&&E((null===(t=W[W.length-2])||void 0===t?void 0:t.id)||"");P(""),K(n)}),[W,u,K]),Q=(0,o.useCallback)((function(e){V.current||D===e||E(e)}),[V,D]),ee=(0,o.useCallback)((function(){V.current||E("")}),[]),te=(0,o.useCallback)((function(e){V.current=e}),[]),ne=(0,o.useCallback)((function(e){q.current&&F(e)}),[q]),re=(0,o.useCallback)((function(){F("")}),[]),oe=(0,o.useCallback)((function(e){x!==e&&_(e)}),[x]),ae=(0,o.useCallback)((function(){P("")}),[]),ie=(0,o.useCallback)((function(){J(N)}),[N,J]),se=(0,o.useCallback)((function(e){i(e),m(e)}),[i]),le=(0,o.useCallback)((function(e){var t=(0,v.zX)(n,e),r=0;z.rows.forEach((function(e){e[n.name]===t&&r++})),r>0?(P(e),H(r)):(H(0),J(e))}),[z,n,J]),ce=(0,o.useCallback)((function(){return W.length>0?null:x?(0,h.jsx)("div",{className:"none-search-result mt-2",children:(0,p.AP)("No options available")}):(0,h.jsx)("div",{className:"none-search-result mt-2",children:(0,p.AP)("No options")})}),[x,W]),ue=(0,o.useCallback)((function(){return Array.isArray(W)?W.map((function(e,t){var n=e.id;return(0,h.jsx)(O,{option:e,index:t,isEditing:L===n,isDeleting:N===n,isViewing:D===n,onMove:X,onUpdate:Z,onDelete:le,onMouseEnter:Q,onMouseLeave:ee,onToggleFreeze:te,onOpenNameEditor:ne,onCloseNameEditor:re},n)})):[]}),[W,L,N,D,X,Z,le,Q,ee,te,ne,re]);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(s.Rw,{target:t,className:"sf-metadata-edit-column-options-popover",canHide:!N&&q.current,hide:a,hideWithEsc:a,children:(0,h.jsxs)("div",{className:"sf-metadata-edit-column-options-container",children:[(0,h.jsx)("div",{className:"sf-metadata-edit-column-options-search-container",children:(0,h.jsx)(s.DO,{className:"sf-metadata-option-search-control",placeholder:(0,p.AP)("Search option"),onChange:oe,autoFocus:!0})}),ce(),(0,h.jsx)(b,{options:ue(),viewingOptionId:D,inputRef:G}),(0,h.jsx)(s.NC,{className:"sf-metadata-add-option",callBack:$,footerName:(0,p.AP)("Add option"),addIconClassName:"sf-metadata-add-option-icon"}),(0,h.jsx)(M,{column:n,onToggle:a,onImportOptions:se})]})}),N&&(0,h.jsx)(j,{option:u.find((function(e){return e.id===N})),onToggle:ae,onSubmit:ie,deleteNumber:B})]})},L=n(75168),F=n(42119),U=n(76152),Y=n(55627),B=n(18849),H=n(64467),V=((0,H.default)((0,H.default)({},g.vZe.TEXT,!0),g.vZe.URL,!0),(0,H.default)((0,H.default)((0,H.default)((0,H.default)((0,H.default)({},g.XuU.EXACT_DATE,!0),g.XuU.NUMBER_OF_DAYS_AGO,!0),g.XuU.NUMBER_OF_DAYS_FROM_NOW,!0),g.XuU.THE_NEXT_NUMBERS_OF_DAYS,!0),g.XuU.THE_PAST_NUMBERS_OF_DAYS,!0),(0,H.default)((0,H.default)((0,H.default)((0,H.default)((0,H.default)((0,H.default)({},g.USE.IS_ANY_OF,!0),g.USE.IS_NONE_OF,!0),g.USE.HAS_ANY_OF,!0),g.USE.HAS_ALL_OF,!0),g.USE.HAS_NONE_OF,!0),g.USE.IS_EXACTLY,!0)),G=(0,H.default)((0,H.default)({},g.USE.IS,!0),g.USE.IS_NOT,!0),q=(0,H.default)((0,H.default)({},g.USE.EMPTY,!0),g.USE.NOT_EMPTY,!0),z=(g.pQi.INVALID_FILTER,g.pQi.INCOMPLETE_FILTER,g.pQi.COLUMN_MISSING,g.pQi.COLUMN_NOT_SUPPORTED,g.pQi.UNMATCHED_PREDICATE,g.pQi.UNMATCHED_MODIFIER,g.pQi.INVALID_TERM,[g.vZe.CREATOR,g.vZe.LAST_MODIFIER]),W=function(e,t){var n=e.type;return!!z.includes(n)||!(n!==g.vZe.SINGLE_SELECT||![g.USE.IS_ANY_OF,g.USE.IS_NONE_OF].includes(t))},K=function(e,t){var n=[g.USE.CONTAINS,g.USE.NOT_CONTAIN],r=e.filter_predicate,o=e.filter_term;if(n.includes(r)){o=o?e.filter_term.slice(0):[];var a=t.email,i=o.indexOf(a);i>-1?o.splice(i,1):o.push(a)}else{if(o[0]===t.email)return;o=[t.email]}return Object.assign({},e,{filter_term:o})},Z=function(e,t){var n;if(V[e.filter_predicate]){var r=(n=Array.isArray(e.filter_term)?(0,_.A)(e.filter_term):[]).indexOf(t.id);-1===r?n.push(t.id):n.splice(r,1)}else n=t.id;return Object.assign({},e,{filter_term:n})},X=function(e,t){var n=e.filter_term?e.filter_term:[],r=n.indexOf(t.id);return r>-1?n.splice(r,1):n.push(t.id),Object.assign({},e,{filter_term:n})},$=function(e,t){var n=e.filter_term?e.filter_term.slice(0):[],r=t.email,o=n.indexOf(r);return o>-1?n.splice(o,1):n.push(r),Object.assign({},e,{filter_term:n})},J=function(e){var t=e.type;return g.Tsr[t]||{}},Q=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=J(e).filterPredicateList;if(n){var r=n[0],o=Object.assign({},t,{column_key:e.key,filter_predicate:r});if(o.filter_term="",W(e,r))return o.filter_term=[],o;if((0,g.hBA)(e)){var a=r===g.USE.IS_WITHIN?g.B3[0]:g.uv8[0];return o.filter_term_modifier=a,o.filter_term="",o}return o}},ee=function(){return(0,S.A)((function e(){(0,w.A)(this,e)}),null,[{key:"generatorColumnOption",value:function(e){if(!e)return null;var t=e.type,n=e.name;return{value:{column:e},label:(0,h.jsxs)(o.Fragment,{children:[(0,h.jsx)("span",{className:"sf-metadata-filter-header-icon",children:(0,h.jsx)(s.In,{iconName:g.ZPL[t]})}),(0,h.jsx)("span",{className:"select-option-name",children:n})]})}}},{key:"generatorPredicateOption",value:function(e){return{value:{filterPredicate:e},label:(0,h.jsx)("span",{className:"select-option-name",children:g.boc[e]})}}},{key:"generatorTermModifierOption",value:function(e){return{value:{filterTermModifier:e},label:(0,h.jsx)("span",{className:"select-option-name",children:g._z2[e]})}}},{key:"generatorSingleSelectOption",value:function(e,t){return{value:{columnOption:e},label:(0,h.jsxs)("div",{className:"select-option-name single-option-name",children:[(0,h.jsx)("div",{className:"single-select-option",style:{background:e.color,color:e.textColor||null},title:e.name,"aria-label":e.name,children:e.name}),(0,h.jsx)("div",{className:"single-check-icon",children:(null===t||void 0===t?void 0:t.id)===e.id&&(0,h.jsx)(s.In,{iconName:"check-mark"})})]})}}},{key:"generatorMultipleSelectOption",value:function(e,t){return{value:{columnOption:e},label:(0,h.jsxs)("div",{className:"select-option-name multiple-option-name",children:[(0,h.jsx)("div",{className:"multiple-select-option",style:{background:e.color,color:e.textColor},title:e.name,"aria-label":e.name,children:e.name}),(0,h.jsx)("div",{className:"multiple-check-icon",children:t.indexOf(e.id)>-1&&(0,h.jsx)(s.In,{iconName:"check-mark"})})]})}}},{key:"generatorConjunctionOptions",value:function(){return[{value:{filterConjunction:"And"},label:(0,h.jsx)("span",{className:"select-option-name",children:(0,p.AP)("And")})},{value:{filterConjunction:"Or"},label:(0,h.jsx)("span",{className:"select-option-name",children:(0,p.AP)("Or")})}]}},{key:"getActiveConjunctionOption",value:function(e){return"And"===e?{value:{filterConjunction:"And"},label:(0,h.jsx)("span",{className:"select-option-name",children:(0,p.AP)("And")})}:{value:{filterConjunction:"Or"},label:(0,h.jsx)("span",{className:"select-option-name",children:(0,p.AP)("Or")})}}}])}(),te=function(e){var t=e.readOnly,n=e.filterIndex,r=e.filterTerm,a=e.collaborators,i=e.placeholder,l=e.filter_predicate,c=e.onSelectCollaborator,u=(0,o.useMemo)((function(){return[g.USE.HAS_ANY_OF,g.USE.HAS_ALL_OF,g.USE.HAS_NONE_OF,g.USE.IS_EXACTLY]}),[]),d=(0,o.useMemo)((function(){return u.indexOf(l)>-1}),[u,l]),f=(0,o.useMemo)((function(){return Array.isArray(r)?a.map((function(e){var t=r.findIndex((function(t){return t===e.email}))>-1;return{value:{filterIndex:n,columnOption:e},label:(0,h.jsx)(o.Fragment,{children:(0,h.jsxs)("div",{className:"select-option-name option-collaborator",children:[(0,h.jsx)("div",{className:"collaborator-container",children:(0,h.jsxs)("div",{className:"collaborator",children:[(0,h.jsx)("span",{className:"collaborator-avatar-container",children:(0,h.jsx)("img",{className:"collaborator-avatar",alt:e.name,src:e.avatar_url})}),(0,h.jsx)("span",{className:"collaborator-name text-truncate",style:{maxWidth:"200px"},title:e.name,"aria-label":e.name,children:e.name})]})}),(0,h.jsx)("div",{className:"collaborator-check-icon",children:t&&(0,h.jsx)(s.In,{iconName:"check-mark"})})]})})}})):[]}),[n,a,r]),m=(0,o.useMemo)((function(){return Array.isArray(r)&&r.length>0&&r.map((function(e){var t=a.find((function(t){return t.email===e}));return t?(0,h.jsxs)("div",{className:"collaborator",children:[(0,h.jsx)("span",{className:"collaborator-avatar-container",children:(0,h.jsx)("img",{className:"collaborator-avatar",alt:t.name,src:t.avatar_url})}),(0,h.jsx)("span",{className:"collaborator-name text-truncate",title:t.name,"aria-label":t.name,children:t.name})]},e):null}))}),[r,a]);return(0,h.jsx)(s.Cg,{className:"sf-metadata-selector-collaborator",value:m?{label:m}:{},onSelectOption:c,options:f,placeholder:i,readOnly:t,supportMultipleSelect:d,searchable:!0,searchPlaceholder:(0,p.AP)("Search collaborator"),isShowSelected:!1,noOptionsPlaceholder:(0,p.AP)("No collaborators")})},ne=n(31425),re=n(40326),oe=function(e){var t=e.value,n=e.filterColumn,r=e.readOnly,o=e.onChange,a=(0,ne.Kf)(n).trim();return(0,h.jsx)(s.sv,{isReadOnly:r,format:a,lang:re.vV,value:t,onChange:o,zIndex:1061})},ae=n(73575),ie=n(82622),se=[g.USE.EMPTY,g.USE.NOT_EMPTY],le=function(e){function t(e){var n;return(0,w.A)(this,t),(n=(0,D.A)(this,t,[e])).initSelectOptions=function(e){var t=e.filter,r=e.filterColumn,o=(e.value,J(r)),a=o.filterPredicateList,i=o.filterTermModifierList;n.filterPredicateOptions=a?a.map((function(e){return ee.generatorPredicateOption(e)})).filter((function(e){return e})):[];var s=t.filter_predicate;(0,g.hBA)(r)&&(s===g.USE.IS_WITHIN&&(i=g.B3),n.filterTermModifierOptions=i.map((function(e){return ee.generatorTermModifierOption(e)})))},n.onDeleteFilter=function(e){e.nativeEvent.stopImmediatePropagation();var t=n.props.index;n.props.deleteFilter(t)},n.resetState=function(e){n.setState({filterTerm:e.filter_term})},n.onSelectConjunction=function(e){n.props.filterConjunction!==e.filterConjunction&&n.props.updateConjunction(e.filterConjunction)},n.onSelectColumn=function(e){var t=n.props,r=t.index,o=t.filter,a=e.column;if(a.key!==o.column_key){var i=Q(a,o);i&&(n.resetState(i),n.props.updateFilter(r,i))}},n.onSelectPredicate=function(e){var t=n.props,r=t.index,o=t.filter,a=t.filterColumn,i=e.filterPredicate;if(o.filter_predicate!==i){var s=function(e,t,n){var r=Object.assign({},e,{filter_predicate:n}),o=t.type;if(o===g.vZe.CHECKBOX)return r.filter_term=!1,r;if(o===g.vZe.SINGLE_SELECT)return V[n]?V[e.filter_predicate]!==V[n]&&(r.filter_term=[]):G[n]?G[e.filter_predicate]!==G[n]&&(r.filter_term=""):r.filter_term="",r;if([g.vZe.CREATOR,g.vZe.LAST_MODIFIER].includes(o)&&(G[e.filter_predicate]===G[n]&&n!==g.USE.INCLUDE_ME||(r.filter_term=[])),W(t,n))return(q[n]||n===g.USE.INCLUDE_ME)&&(r.filter_term=[]),r;if((0,g.hBA)(t)){var a=n===g.USE.IS_WITHIN?g.B3[0]:g.uv8[0];return r.filter_term_modifier=a,r}return r}(o,a,i);n.resetState(s),n.props.updateFilter(r,s)}},n.onSelectTermModifier=function(e){var t=n.props,r=t.index,o=t.filter,a=e.filterTermModifier,i=[g.XuU.EXACT_DATE,g.XuU.NUMBER_OF_DAYS_AGO,g.XuU.NUMBER_OF_DAYS_FROM_NOW,g.XuU.THE_NEXT_NUMBERS_OF_DAYS,g.XuU.THE_PAST_NUMBERS_OF_DAYS];if(o.filter_term_modifier!==a){var s=o.filter_term;i.indexOf(o.filter_term_modifier)>-1&&(s="");var l=Object.assign({},o,{filter_term_modifier:a,filter_term:s});n.resetState(l),n.props.updateFilter(r,l)}},n.onSelectSingle=function(e){var t=n.props,r=t.index,o=t.filter,a=e.columnOption;if(o.filter_term!==a.id){var i=Z(o,a);n.resetState(i),n.props.updateFilter(r,i)}},n.onSelectMultiple=function(e){var t=n.props,r=t.index,o=t.filter,a=e.columnOption,i=X(o,a);n.resetState(i),n.props.updateFilter(r,i)},n.onSelectCollaborator=function(e){var t=n.props,r=t.index,o=t.filter,a=e.columnOption,i=$(o,a);n.resetState(i),n.props.updateFilter(r,i)},n.onSelectCreator=function(e){var t=n.props,r=t.index,o=t.filter,a=e.columnOption,i=K(o,a);i&&(n.resetState(i),n.props.updateFilter(r,i))},n.onFilterTermCheckboxChanged=function(e){n.onFilterTermChanged(e.target.checked)},n.onFilterTermTextChanged=function(e){n.onFilterTermChanged(e)},n.onFilterTermNumberChanged=function(){var e=n.numberEditor.getValue();n.onFilterTermChanged(Object.values(e)[0])},n.onFilterExactDateChanged=function(e){n.onFilterTermChanged(e)},n.onFilterTermChanged=function(e){var t=n.props,r=t.index,o=t.filter;if(e!==n.state.filterTerm){n.setState({filterTerm:e});var a=Object.assign({},o,{filter_term:e});n.props.updateFilter(r,a)}},n.onMouseEnterRateItem=function(e){n.setState({enterRateItemIndex:e})},n.onMouseLeaveRateItem=function(){n.setState({enterRateItemIndex:-1})},n.onChangeRateNumber=function(e){n.onFilterTermChanged(e)},n.getInputComponent=function(e){var t=n.props.readOnly,r=n.state.filterTerm;if("text"===e)return(0,h.jsx)(s.DO,{value:r,onChange:n.onFilterTermTextChanged,autoFocus:!1,disabled:t,className:"text-truncate"});if("checkbox"===e){var o=n.props.readOnly;return(0,h.jsx)("input",{type:"checkbox",disabled:o,checked:r,onChange:n.onFilterTermCheckboxChanged})}},n.renderConjunction=function(){var e=n.props,t=e.index,r=e.readOnly,o=e.filterConjunction,a=e.conjunctionOptions;switch(t){case 0:return null;case 1:var i=ee.getActiveConjunctionOption(o);return(0,h.jsx)(s.Cg,{readOnly:r,value:i,options:a,onSelectOption:n.onSelectConjunction});default:return(0,h.jsx)("span",{className:"selected-conjunction-show",children:(0,p.AP)(o)})}},n.renderMultipleSelectOption=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,r=n.props.filter.filter_predicate,a=!1;[g.USE.IS_ANY_OF,g.USE.IS_NONE_OF,g.USE.HAS_ANY_OF,g.USE.HAS_ALL_OF,g.USE.HAS_NONE_OF,g.USE.IS_EXACTLY].includes(r)&&(a=!0);var i=[];Array.isArray(e)&&Array.isArray(t)&&t.forEach((function(t){var n=e.find((function(e){return e.id===t})),r={margin:"0 10px 0 0"},o=null;n?(o=n.name,r.background=n.color,r.color=n.textColor||null):(r.background=ae.lX,o=(0,p.AP)(ae.fT)),i.push((0,h.jsx)("span",{className:"select-option-name multiple-select-option",style:r,title:o,"aria-label":o,children:o},"option_"+t))}));var l=i.length>0?{label:(0,h.jsx)(o.Fragment,{children:i})}:{},c=e.map((function(e){return ee.generatorMultipleSelectOption(e,t)}));return(0,h.jsx)(s.Cg,{className:"sf-metadata-selector-multiple-select",value:l,options:c,onSelectOption:n.onSelectMultiple,placeholder:(0,p.AP)("Select option(s)"),searchable:!0,searchPlaceholder:(0,p.AP)("Search option"),noOptionsPlaceholder:(0,p.AP)("No options available"),supportMultipleSelect:a})},n.getAllCollaborators=function(){var e=window.sfMetadata.collaborators,t=window.sfMetadata.collaboratorsCache;return[].concat((0,_.A)(e),(0,_.A)(Object.values(t)))},n.renderFilterTerm=function(e){var t=n.props,r=t.index,o=t.filter,a=t.collaborators,i=t.readOnly,l=e.type,c=o.filter_term,u=o.filter_predicate,d=o.filter_term_modifier;if(se.includes(u))return null;if((0,g.hBA)(e))return[g.XuU.EXACT_DATE,g.XuU.NUMBER_OF_DAYS_AGO,g.XuU.NUMBER_OF_DAYS_FROM_NOW,g.XuU.THE_NEXT_NUMBERS_OF_DAYS,g.XuU.THE_PAST_NUMBERS_OF_DAYS].indexOf(d)>-1?"exact_date"===d?(0,h.jsx)(oe,{readOnly:i,onChange:n.onFilterExactDateChanged,value:n.state.filterTerm,filterColumn:e}):n.getInputComponent("text"):null;switch(l){case g.vZe.NUMBER:case g.vZe.FILE_NAME:case g.vZe.TEXT:case g.vZe.URL:return u===g.USE.IS_CURRENT_USER_ID?null:n.getInputComponent("text");case g.vZe.CREATOR:case g.vZe.LAST_MODIFIER:if(u===g.USE.INCLUDE_ME)return null;var f=a;return(0,h.jsx)(te,{readOnly:i,filterIndex:r,filterTerm:c||[],collaborators:f,onSelectCollaborator:n.onSelectCreator});case g.vZe.CHECKBOX:return n.getInputComponent("checkbox");case g.vZe.SINGLE_SELECT:var m=(0,g.FiT)(e);if([g.USE.IS_ANY_OF,g.USE.IS_NONE_OF].includes(u))return n.renderMultipleSelectOption(m,c);var v={label:null};if(c){var y=m.find((function(e){return e.id===c})),C=y?{background:y.color,color:y.textColor||null}:{background:ae.lX},A=y?y.name:(0,p.AP)("deleted option");v={label:(0,h.jsx)("span",{className:"select-option-name single-select-option",style:C,title:A,"aria-label":A,children:A})}}var x=m.map((function(e){return ee.generatorSingleSelectOption(e)}));return(0,h.jsx)(s.Cg,{readOnly:i,className:"sf-metadata-selector-single-select",value:v,options:x||[],onSelectOption:n.onSelectSingle,placeholder:(0,p.AP)("Select an option"),searchable:!0,searchPlaceholder:(0,p.AP)("Search option"),noOptionsPlaceholder:(0,p.AP)("No options available"),isInModal:n.props.isInModal});case g.vZe.COLLABORATOR:if(u===g.USE.INCLUDE_ME)return null;var b=n.getAllCollaborators();return(0,h.jsx)(te,{readOnly:i,filterIndex:r,filterTerm:c||[],filter_predicate:u,collaborators:b,placeholder:(0,p.AP)("Select collaborators"),onSelectCollaborator:n.onSelectCollaborator});case g.vZe.MULTIPLE_SELECT:var _=(e.data||{}).options,w=void 0===_?[]:_;return n.renderMultipleSelectOption(w,c,i);case g.vZe.RATE:for(var S=(e.data||{}).max,D=[],E=0;E<S;E++){var k=(0,h.jsx)(ie.A,{enterIndex:n.state.enterRateItemIndex,index:E+1,onMouseEnter:n.onMouseEnterRateItem,onMouseLeave:n.onMouseLeaveRateItem,value:Number(c)||S,field:e,isShowRateItem:!0,onChange:n.onChangeRateNumber},E);D.push(k)}return(0,h.jsx)("div",{className:"filter-rate-list",children:D});default:return null}},n.isRenderErrorTips=function(){var e=n.props.errMsg;return e&&e!==g.pQi.INCOMPLETE_FILTER},n.renderErrorMessage=function(){return n.isRenderErrorTips()?(0,h.jsxs)("div",{className:"ml-2",children:[(0,h.jsx)(s.Oi,{ref:n.invalidFilterTip,iconName:"exclamation-triangle"}),(0,h.jsx)(k.A,{target:n.invalidFilterTip,placement:"bottom",fade:!1,className:"sf-metadata-tooltip",children:(0,p.AP)("Invalid filter")})]}):null},n.state={filterTerm:e.filter.filter_term,enterRateItemIndex:-1},n.filterPredicateOptions=null,n.filterTermModifierOptions=null,n.filterToolTip=o.createRef(),n.invalidFilterTip=o.createRef(),n.initSelectOptions(e),n}return(0,E.A)(t,e),(0,S.A)(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.props.filter;e.filter!==t&&(this.initSelectOptions(e),this.setState({filterTerm:e.filter.filter_term}))}},{key:"shouldComponentUpdate",value:function(e,t){var n=this.props;return e.index!==n.index||e.filter!==n.filter||e.filterColumn!==n.filterColumn||e.filterConjunction!==n.filterConjunction||e.conjunctionOptions!==n.conjunctionOptions||e.filterColumnOptions!==n.filterColumnOptions||t.enterRateItemIndex!==this.state.enterRateItemIndex}},{key:"render",value:function(){var e=this.filterPredicateOptions,t=this.filterTermModifierOptions,n=this.props,r=n.filter,o=n.filterColumn,a=n.filterColumnOptions,i=n.readOnly,l=r.filter_predicate,c=r.filter_term_modifier,u=ee.generatorColumnOption(o),d=ee.generatorPredicateOption(l),f=null,m=!1;(0,g.hBA)(o)?f=ee.generatorTermModifierOption(c):(0,ne.u7)(o)&&(m=!0);var v=!se.includes(l);return(0,h.jsxs)("div",{className:"filter-item",children:[!i&&(0,h.jsx)("div",{className:"delete-filter",onClick:this.onDeleteFilter,children:(0,h.jsx)(s.In,{iconName:"fork-number"})}),(0,h.jsxs)("div",{className:"condition",children:[(0,h.jsx)("div",{className:"filter-conjunction",children:this.renderConjunction()}),(0,h.jsxs)("div",{className:"filter-container",children:[(0,h.jsx)("div",{className:"filter-column",children:(0,h.jsx)(s.Cg,{readOnly:i,value:u,options:a,onSelectOption:this.onSelectColumn,searchable:!0,searchPlaceholder:(0,p.AP)("Search property"),noOptionsPlaceholder:(0,p.AP)("No results")})}),(0,h.jsx)("div",{className:"filter-predicate ml-2 ".concat(m?"filter-checkbox-predicate":""),children:(0,h.jsx)(s.Cg,{readOnly:i,value:d,options:e,onSelectOption:this.onSelectPredicate})}),(0,g.hBA)(o)&&v&&(0,h.jsx)("div",{className:"filter-term-modifier ml-2",children:(0,h.jsx)(s.Cg,{readOnly:i,value:f,options:t,onSelectOption:this.onSelectTermModifier})}),(0,h.jsx)("div",{className:"filter-term ml-2",children:this.renderFilterTerm(o)}),this.renderErrorMessage()]})]})]})}}])}(o.Component),ce=le,ue=function(e){function t(e){var n;return(0,w.A)(this,t),(n=(0,D.A)(this,t,[e])).updateFilter=function(e,t){t&&n.props.updateFilter(e,t)},n.deleteFilter=function(e){var t=n.props.scheduleUpdate;n.props.deleteFilter(e,t)},n.updateConjunction=function(e){n.props.modifyFilterConjunction(e)},n.getConjunctionOptions=function(){return n.conjunctionOptions||(n.conjunctionOptions=ee.generatorConjunctionOptions()),n.conjunctionOptions},n.getFilterColumns=function(){return n.props.columns.filter((function(e){var t=e.type;return Object.prototype.hasOwnProperty.call(g.Tsr,t)}))},n.getColumnOptions=function(){if(!n.columnOptions){var e=n.getFilterColumns();n.columnOptions=e.map((function(e){return ee.generatorColumnOption(e)}))}return n.columnOptions},n.renderFilterItem=function(e,t,r,o){var a=n.props,i=a.readOnly,s=a.filterConjunction,l=a.value,c=n.getConjunctionOptions(),u=n.getColumnOptions();return(0,h.jsx)(ce,{readOnly:i,index:t,filter:e,errMsg:r,filterColumn:o,filterConjunction:s,conjunctionOptions:c,filterColumnOptions:u,value:l,deleteFilter:n.deleteFilter,updateFilter:n.updateFilter,updateConjunction:n.updateConjunction,collaborators:n.props.collaborators,isPre:n.props.isPre},t)},n.conjunctionOptions=null,n.columnOptions=null,n}return(0,E.A)(t,e),(0,S.A)(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.columns!==this.props.columns&&(this.columnOptions=null)}},{key:"render",value:function(){var e=this,t=this.props,n=t.filters,r=t.className,o=t.emptyPlaceholder,a=t.columns,i=0===n.length;return(0,h.jsxs)("div",{className:N()("sf-metadata-filters-list",{"empty-filters-container":i},(0,H.default)({},r,r)),children:[i&&(0,h.jsx)("div",{className:"empty-filters-list",children:o}),!i&&n.map((function(t,n){var r=t.column_key,o=g.T76.validate(t,a).error_message,i=(0,g.rm3)(a,r)||{};return e.renderFilterItem(t,n,o,i)}))]})}}])}(o.Component),de=n(89379),pe=[{value:"file",name:(0,p.AP)("Only files")},{value:"folder",name:(0,p.AP)("Only folders")},{value:"all",name:(0,p.AP)("Files and folders")}],fe=function(e){var t=e.readOnly,n=e.value,r=void 0===n?"all":n,a=e.onChange,i=(0,o.useMemo)((function(){return pe.map((function(e){var t=e.name;return{value:e.value,label:(0,h.jsxs)("div",{className:"select-basic-filter-option",children:[(0,h.jsx)("div",{className:"select-basic-filter-option-name",title:t,"aria-label":t,children:t}),(0,h.jsx)("div",{className:"select-basic-filter-option-check-icon",children:r===e.value&&(0,h.jsx)(s.In,{iconName:"check-mark"})})]})}}))}),[r]),l=(0,o.useMemo)((function(){var e=pe.find((function(e){return e.value===r}))||pe[2];return{label:(0,h.jsx)("div",{children:e.name})}}),[r]),c=(0,o.useCallback)((function(e){e!==r&&a(e)}),[r,a]);return(0,h.jsx)(s.Cg,{readOnly:t,className:"sf-metadata-basic-filters-select",value:l,options:i,onSelectOption:c,component:{DropDownIcon:(0,h.jsx)("i",{className:"sf3-font sf3-font-down"})}})},he=[{value:"picture",name:(0,p.AP)("Only pictures")},{value:"video",name:(0,p.AP)("Only videos")},{value:"all",name:(0,p.AP)("Pictures and videos")}],me=function(e){var t=e.readOnly,n=e.value,r=void 0===n?"picture":n,a=e.onChange,i=(0,o.useMemo)((function(){return he.map((function(e){var t=e.name;return{value:e.value,label:(0,h.jsxs)("div",{className:"select-basic-filter-option",children:[(0,h.jsx)("div",{className:"select-basic-filter-option-name",title:t,"aria-label":t,children:t}),(0,h.jsx)("div",{className:"select-basic-filter-option-check-icon",children:r===e.value&&(0,h.jsx)(s.In,{iconName:"check-mark"})})]})}}))}),[r]),l=(0,o.useMemo)((function(){var e=he.find((function(e){return e.value===r}))||he[2];return{label:(0,h.jsx)("div",{children:e.name})}}),[r]),c=(0,o.useCallback)((function(e){e!==r&&a(e)}),[r,a]);return(0,h.jsx)(s.Cg,{readOnly:t,className:"sf-metadata-basic-filters-select",value:l,options:i,onSelectOption:c,component:{DropDownIcon:(0,h.jsx)("i",{className:"sf3-font sf3-font-down"})}})},ge=function(e){var t=e.readOnly,n=e.filters,r=void 0===n?[]:n,a=e.onChange,i=(0,o.useCallback)((function(e){var t=r.findIndex((function(e){return e.column_key===g.L2D.IS_DIR})),n=r[t],o=r.slice(0);o[t]=(0,de.A)((0,de.A)({},n),{},{filter_term:e}),a(o)}),[r,a]),s=(0,o.useCallback)((function(e){var t=r.findIndex((function(e){return e.column_key===g.L2D.FILE_TYPE})),n=r[t],o=r.slice(0);o[t]=(0,de.A)((0,de.A)({},n),{},{filter_term:e}),a(o)}),[r,a]);return(0,h.jsxs)(U.A,{className:"filter-group-basic filter-group p-4",children:[(0,h.jsx)(Y.A,{className:"filter-group-name",children:(0,p.AP)("Basic")}),(0,h.jsx)("div",{className:"filter-group-container",children:(0,h.jsx)("div",{className:"sf-metadata-filters-list",children:r.map((function(e,n){var r=e.column_key,o=e.filter_term;return r===g.L2D.IS_DIR?(0,h.jsx)(fe,{readOnly:t,value:o,onChange:i},r):r===g.L2D.FILE_TYPE?(0,h.jsx)(me,{readOnly:t,value:o,onChange:s},r):null}))})})]})},ve=function(e){function t(e){var n;return(0,w.A)(this,t),(n=(0,D.A)(this,t,[e])).onHotKey=function(e){(0,L.default)("esc",e)&&!n.isSelectOpen&&(e.preventDefault(),n.props.hidePopover())},n.setSelectStatus=function(e){n.isSelectOpen=e},n.hideDTablePopover=function(e){if(n.dtablePopoverRef&&!(0,p.wD)(e).includes("popover")&&!n.dtablePopoverRef.contains(e.target))return n.props.hidePopover(e),e.preventDefault(),e.stopPropagation(),!1},n.update=function(e){if(n.props.isNeedSubmit){n.setState({filters:e,isSubmitDisabled:!1})}else n.setState({filters:e},(function(){var t={filters:e,filter_conjunction:n.state.filterConjunction};n.props.update(t)}))},n.deleteFilter=function(e,t){var r=n.state.filters.slice(0);r.splice(e,1),0===r.length&&t(),n.update(r)},n.updateFilter=function(e,t){var r=n.state.filters.slice(0);r[e]=t,n.update(r)},n.modifyFilterConjunction=function(e){if(n.props.isNeedSubmit){n.setState({filterConjunction:e,isSubmitDisabled:!1})}else n.setState({filterConjunction:e},(function(){var t={filters:n.state.filters,filter_conjunction:e};n.props.update(t)}))},n.addFilter=function(e){var t=n.props.columns,r=t[0];if(g.Tsr[r.type]||(r=t.find((function(e){return g.Tsr[e.type]}))),r){var o=Q(r),a=n.state.filters.slice(0);0===a.length&&e(),a.push(o),n.update(a)}},n.onClosePopover=function(){n.props.hidePopover()},n.onSubmitFilters=function(){var e=n.state,t={filters:e.filters,filter_conjunction:e.filterConjunction,basic_filters:e.basicFilters};n.props.update(t),n.props.hidePopover()},n.onPopoverInsideClick=function(e){e.stopPropagation()},n.onBasicFilterChange=function(e){if(n.props.isNeedSubmit){n.setState({basicFilters:e,isSubmitDisabled:!1})}else n.setState({basicFilters:e},(function(){var t={filters:n.state.filters,filter_conjunction:n.state.filterConjunction,basic_filters:e};n.props.update(t)}))},n.state={basicFilters:e.basicFilters,filters:(0,g.a1m)(e.filters,e.columns),filterConjunction:e.filterConjunction||"And",isSubmitDisabled:!0},n.isSelectOpen=!1,n}return(0,E.A)(t,e),(0,S.A)(t,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.hideDTablePopover,!0),document.addEventListener("keydown",this.onHotKey),this.unsubscribeOpenSelect=window.sfMetadataContext.eventBus.subscribe(ae.Tw.OPEN_SELECT,this.setSelectStatus)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.hideDTablePopover,!0),document.removeEventListener("keydown",this.onHotKey),this.unsubscribeOpenSelect()}},{key:"render",value:function(){var e=this,t=this.props,n=t.readOnly,r=t.target,o=t.columns,a=t.placement,i=this.state,l=i.filters,c=i.filterConjunction,u=i.basicFilters,d=o.length>0;return(0,h.jsx)(F.A,{placement:a,isOpen:!0,target:r,fade:!1,hideArrow:!0,className:"sf-metadata-filter-popover",boundariesElement:document.body,children:function(t){var r=t.scheduleUpdate;return(0,h.jsxs)("div",{ref:function(t){return e.dtablePopoverRef=t},onClick:e.onPopoverInsideClick,className:e.props.filtersClassName,children:[(0,h.jsx)(ge,{filters:u,onChange:e.onBasicFilterChange}),(0,h.jsxs)(U.A,{className:"filter-group-advanced filter-group mb-0",children:[(0,h.jsx)(Y.A,{className:"filter-group-name",children:(0,p.AP)("Advanced")}),(0,h.jsxs)("div",{className:"filter-group-container",children:[(0,h.jsx)(ue,{filterConjunction:c,filters:l,columns:o,emptyPlaceholder:(0,p.AP)("No filters"),updateFilter:e.updateFilter,deleteFilter:e.deleteFilter,modifyFilterConjunction:e.modifyFilterConjunction,collaborators:e.props.collaborators,readOnly:n,scheduleUpdate:r,isPre:e.props.isPre}),!n&&(0,h.jsx)(s.NC,{className:"popover-add-tool ".concat(d?"":"disabled"),callBack:d?function(){return e.addFilter(r)}:function(){},footerName:(0,p.AP)("Add filter"),addIconClassName:"popover-add-icon"})]})]}),!n&&e.props.isNeedSubmit&&(0,h.jsxs)("div",{className:"sf-metadata-popover-footer",children:[(0,h.jsx)(B.A,{className:"mr-2",onClick:e.onClosePopover,children:(0,p.AP)("Cancel")}),(0,h.jsx)(B.A,{color:"primary",disabled:e.state.isSubmitDisabled,onClick:e.onSubmitFilters,children:(0,p.AP)("Submit")})]})]})}})}}])}(o.Component);ve.defaultProps={filtersClassName:"",placement:"auto-start"};var ye=ve,Ce="add_sort",Ae="delete_sort",xe="modify_sort_column",be="modify_sort_type",_e=function(e,t){var n=t.sorts;switch(e){case Ce:var r={column_key:null,sort_type:g.ClR.UP};return n.push(r),n;case Ae:var o=t.index;return n.splice(o,1),n;case xe:var a=t.index,i={column_key:t.column_key,sort_type:g.ClR.UP};return n[a]=i,n;case be:var s=t.index,l=t.sort_type,c={column_key:n[s].column_key,sort_type:l};return n[s]=c,n;default:return n}},we=[{name:(0,p.AP)("Up"),value:g.ClR.UP},{name:(0,p.AP)("Down"),value:g.ClR.DOWN}],Se=function(e){function t(e){var n;(0,w.A)(this,t),(n=(0,D.A)(this,t,[e])).hideDTablePopover=function(e){if(n.sortPopoverRef&&!(0,p.wD)(e).includes("popover")&&!n.sortPopoverRef.contains(e.target))return n.props.onSortComponentToggle(e),e.preventDefault(),e.stopPropagation(),!1},n.onHotKey=function(e){(0,L.default)("esc",e)&&!n.isSelectOpen&&(e.preventDefault(),n.props.onSortComponentToggle())},n.setSelectStatus=function(e){n.isSelectOpen=e},n.addSort=function(){var e=n.state.sorts,t=_e(Ce,{sorts:e});n.updateSorts(t)},n.deleteSort=function(e,t){e.nativeEvent.stopImmediatePropagation();var r=n.state.sorts.slice(0),o=_e(Ae,{sorts:r,index:t});n.updateSorts(o)},n.onSelectColumn=function(e,t){var r=n.state.sorts.slice(0),o=e.column.key;if(o!==r[t].column_key){var a=_e(xe,{sorts:r,index:t,column_key:o});n.updateSorts(a)}},n.onSelectSortType=function(e,t){var r=n.state.sorts.slice(0),o=e.sortType;if(o!==r[t].sort_type){var a=_e(be,{sorts:r,index:t,sort_type:o});n.updateSorts(a)}},n.updateSorts=function(e){if(n.props.isNeedSubmit){n.setState({sorts:e,isSubmitDisabled:!1})}else n.setState({sorts:e},(function(){n.handleSortAnimation()}))},n.handleSortAnimation=function(){var e={sorts:n.state.sorts};n.props.update(e)},n.onClosePopover=function(){n.props.onSortComponentToggle()},n.onSubmitSorts=function(){var e={sorts:n.state.sorts};n.props.update(e),n.props.onSortComponentToggle()},n.createColumnsOptions=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).filter((function(e){return n.supportSortColumnOptions.includes(e.type)})).map((function(e){var t=e.type,n=e.name;return{value:{column:e},label:(0,h.jsxs)(o.Fragment,{children:[(0,h.jsx)("span",{className:"sf-metadata-filter-header-icon",children:(0,h.jsx)(s.In,{iconName:g.ZPL[t]})}),(0,h.jsx)("span",{className:"",children:n})]})}}))},n.createSortTypeOptions=function(){return we.map((function(e){return{value:{sortType:e.value},label:(0,h.jsx)("span",{className:"select-option-name",children:e.name})}}))},n.renderSortsList=function(){var e=n.props.columns;return n.state.sorts.map((function(t,r){var o=(0,g.rm3)(e,t.column_key)||{};return n.renderSortItem(o,t,r)}))},n.renderSortItem=function(e,t,r){var a=e.name,i=e.type,l=n.props,c=l.readOnly,u=l.type,d={label:(0,h.jsxs)(o.Fragment,{children:[(0,h.jsx)("span",{className:"sf-metadata-filter-header-icon",children:(0,h.jsx)(s.In,{iconName:g.ZPL[i]})}),(0,h.jsx)("span",{className:"select-option-name",title:a,"aria-label":a,children:a})]})},f=t.sort_type,m=we.find((function(e){return e.value===f})),v=f&&{label:(0,h.jsx)("span",{className:"select-option-name",children:(null===m||void 0===m?void 0:m.name)||(0,p.AP)("Up")})},y=n.columnsOptions;return 0===r&&(y=y.filter((function(e){return n.supportFirstSortColumnOptions.includes(e.value.column.type)}))),(0,h.jsxs)("div",{className:"sort-item",children:[!c&&(0,h.jsx)("div",{className:"delete-sort",onClick:u===g.rX9.GALLERY&&0===r?function(){}:function(e){return n.deleteSort(e,r)},children:!(u===g.rX9.GALLERY&&0===r)&&(0,h.jsx)(s.In,{iconName:"fork-number"})}),(0,h.jsxs)("div",{className:"condition",children:[(0,h.jsx)("div",{className:"sort-column",children:(0,h.jsx)(s.Cg,{readOnly:c,value:d,onSelectOption:function(e){return n.onSelectColumn(e,r)},options:y,searchable:!0,searchPlaceholder:(0,p.AP)("Search property"),noOptionsPlaceholder:(0,p.AP)("No results")})}),(0,h.jsx)("div",{className:"sort-predicate ml-2",children:(0,h.jsx)(s.Cg,{readOnly:c,value:v,onSelectOption:function(e){return n.onSelectSortType(e,r)},options:n.sortTypeOptions})})]})]},"sort-item-"+r)},n.onPopoverInsideClick=function(e){e.stopPropagation()};var r,a,i=n.props,l=i.sorts,c=i.columns,u=i.type;return n.sortTypeOptions=n.createSortTypeOptions(),n.supportFirstSortColumnOptions=g.cPK[u||g.rX9.TABLE],n.supportSortColumnOptions=g.paJ[u||g.rX9.TABLE],n.columnsOptions=n.createColumnsOptions(c),n.state={sorts:(r=l,a=c,Array.isArray(r)&&Array.isArray(a)?r.filter((function(e){return!e.column_key||(0,g.Bsv)(e,a)})):[]),isSubmitDisabled:!0},n.isSelectOpen=!1,n}return(0,E.A)(t,e),(0,S.A)(t,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.hideDTablePopover,!0),document.addEventListener("keydown",this.onHotKey),this.unsubscribeOpenSelect=window.sfMetadataContext.eventBus.subscribe(ae.Tw.OPEN_SELECT,this.setSelectStatus)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.hideDTablePopover,!0),document.removeEventListener("keydown",this.onHotKey),this.unsubscribeOpenSelect()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.columns;t!==this.props.columns&&(this.columnsOptions=this.createColumnsOptions(t))}},{key:"render",value:function(){var e=this,t=this.props,n=t.target,r=t.readOnly,o=function(e){return!e||0===e.length}(this.state.sorts);return(0,h.jsx)(F.A,{placement:"bottom-end",isOpen:!0,target:n,fade:!1,hideArrow:!0,className:"sf-metadata-sort-popover",boundariesElement:document.body,children:(0,h.jsxs)("div",{ref:function(t){return e.sortPopoverRef=t},onClick:this.onPopoverInsideClick,children:[(0,h.jsx)("div",{className:"sorts-list ".concat(o?"empty-sorts-container":""),children:o?(0,h.jsx)("div",{className:"empty-sorts-list",children:(0,p.AP)("No sorts")}):this.renderSortsList()}),!r&&(0,h.jsx)(s.NC,{callBack:this.addSort,footerName:(0,p.AP)("Add sort"),className:"popover-add-tool",addIconClassName:"popover-add-icon"}),this.props.isNeedSubmit&&!r&&(0,h.jsxs)("div",{className:"sf-metadata-popover-footer",children:[(0,h.jsx)(B.A,{className:"mr-2",onClick:this.onClosePopover,children:(0,p.AP)("Cancel")}),(0,h.jsx)(B.A,{color:"primary",disabled:this.state.isSubmitDisabled,onClick:this.onSubmitSorts,children:(0,p.AP)("Submit")})]})]})})}}])}(o.Component);Se.defaultProps={readOnly:!1};var De=Se,Ee=[g.wAv.COUNTRY,g.wAv.PROVINCE,g.wAv.CITY,g.wAv.DISTRICT],ke=function(e){return(0,g.hBA)(e)?g.UYn.MONTH:e.type===g.vZe.GEOLOCATION?"country_region"===(e.data||{}).geo_format?Ee[0]:Ee[1]:null},Me=function(e){if((0,g.hBA)(e))return!0;var t=e.data||{};return e.type===g.vZe.GEOLOCATION&&(t.geo_format!==g.wAv.PROVINCE&&"country_region"!==t.geo_format)},Ie=n(51528),Ne=(0,o.memo)((function(e){var t=e.isOver,n=e.isDragging,r=e.canDrop,a=e.connectDragSource,i=e.connectDragPreview,l=e.connectDropTarget,c=e.showDragBtn,u=e.index,d=e.readOnly,f=e.groupby,m=e.columns,v=e.onDelete,y=e.onUpdate,C=(0,o.useMemo)((function(){return(0,g.rm3)(m,f.column_key)}),[f,m]),A=(0,o.useMemo)((function(){return Array.isArray(m)&&0!==m.length?m.map((function(e){var t=e.type,n=e.name;return{value:{column:e},label:(0,h.jsxs)(o.Fragment,{children:[(0,h.jsx)("span",{className:"sf-metadata-filter-header-icon",children:(0,h.jsx)(s.In,{iconName:g.ZPL[t]})}),(0,h.jsx)("span",{className:"select-option-name",children:n})]})}})):[]}),[m]),x=(0,o.useMemo)((function(){return A.find((function(e){return e.value.column.key===f.column_key}))}),[A,f]),b=(0,o.useMemo)((function(){return[{value:{sortType:g.ClR.UP},label:(0,h.jsx)("span",{className:"select-option-name",children:(0,p.AP)("Up")})},{value:{sortType:g.ClR.DOWN},label:(0,h.jsx)("span",{className:"select-option-name",children:(0,p.AP)("Down")})}]}),[]),_=(0,o.useMemo)((function(){return b.find((function(e){return e.value.sortType===f.sort_type}))}),[b,f]),w=(0,o.useMemo)((function(){return{"By day":(0,p.AP)("By day"),"By week":(0,p.AP)("By week"),"By month":(0,p.AP)("By month"),"By quarter":(0,p.AP)("By quarter"),"By year":(0,p.AP)("By year")}}),[]),S=(0,o.useMemo)((function(){var e=function(e){var t=[],n={};if((0,g.hBA)(e))t=g.SvE,n=g.XJ$;else if(e.type===g.vZe.GEOLOCATION){var r=(e.data||{}).geo_format;t=Ee.filter((function(e){var t=e===g.wAv.PROVINCE||e===g.wAv.CITY;return r===("province_city"===r&&t)||e!==g.wAv.COUNTRY})),n=g.lj4}return{granularityList:t,displayGranularity:n}}((0,g.rm3)(m,f.column_key)),t=e.granularityList,n=e.displayGranularity;return t.map((function(e){return{value:e,label:(0,h.jsx)("span",{className:"select-option-name",children:w[n[e]]})}}))}),[m,f,w]),D=(0,o.useMemo)((function(){var e=f.count_type,t=function(e,t){var n=t||ke(e);return n&&(0,g.hBA)(e)?g.XJ$[n]:null}(C,e);if(t)return{label:(0,h.jsx)("span",{className:"select-option-name",children:w[t]})}}),[C,f,w]),E=(0,o.useCallback)((function(e){e.nativeEvent.stopImmediatePropagation(),v(u)}),[u,v]),k=(0,o.useCallback)((function(e){var t=f.column_key;if(e.column.key!==t){var n=g.ClR.UP,r=ke(e.column),o=(0,de.A)((0,de.A)({},f),{column_key:e.column.key,sort_type:n,count_type:r});y(o,u)}}),[f,u,y]),M=(0,o.useCallback)((function(e){if(e!==f.sort_type){var t=(0,de.A)((0,de.A)({},f),{},{count_type:e});y(t,u)}}),[f,u,y]),I=(0,o.useCallback)((function(e){var t=f.count_type;if(e.sortType!==t){var n=(0,de.A)((0,de.A)({},f),{},{sort_type:e.sortType});y(n,u)}}),[f,u,y]);return l(i((0,h.jsxs)("div",{className:N()("groupby-item",{"group-can-drop-top":t&&r&&n},{"group-can-drop":t&&r&&!n}),children:[!d&&(0,h.jsx)("div",{className:"delete-groupby",onClick:E,"aria-label":(0,p.AP)("Delete"),children:(0,h.jsx)(s.In,{iconName:"fork-number"})}),(0,h.jsxs)("div",{className:"condition",children:[(0,h.jsx)("div",{className:"groupby-column",children:(0,h.jsx)(s.Cg,{readOnly:d,value:x,options:A,onSelectOption:k,searchable:!0,searchPlaceholder:(0,p.AP)("Search property"),noOptionsPlaceholder:(0,p.AP)("No results")})}),Me(C)&&(0,h.jsx)("div",{className:"groupby-count-type",children:(0,h.jsx)(s.Cg,{readOnly:d,value:D,onSelectOption:M,options:S})}),(0,h.jsx)("div",{className:"groupby-predicate",children:(!C.key||g.dc.includes(C.type))&&(0,h.jsx)(s.Cg,{readOnly:d,value:_,options:b,onSelectOption:I})})]}),!d&&c&&a((0,h.jsx)("div",{className:"groupby-drag",children:(0,h.jsx)(s.In,{iconName:"drag"})}))]})))}),(function(e,t){return!(e.index!==t.index||!Ie.A.isSameObject(e.groupby,t.groupby)||e.isDragging!==t.isDragging||e.isOver!==t.isOver||e.canDrop!==t.canDrop||e.showDragBtn!==t.showDragBtn)})),Pe=(0,C.Tl)("sfMetadataGroupbyItem",{drop:function(e,t){var n=t.getItem(),r=e.index;if(r!==n.idx){var o={idx:r,data:e.groupby};e.onMove(n,o)}}},(function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver(),canDrop:t.canDrop(),dragged:t.getItem()}}))((0,C.I4)("sfMetadataGroupbyItem",{beginDrag:function(e){return{idx:e.index,data:e.groupby,mode:"sfMetadataGroupbyItem"}},endDrag:function(e,t){var n=t.getItem();if(!t.didDrop())return{groupSource:n,groupTarget:{}}},isDragging:function(e){var t=e.index;return e.dragged.idx>t}},(function(e,t){return{connectDragSource:e.dragSource(),connectDragPreview:e.dragPreview(),isDragging:t.isDragging()}}))(Ne)),Te=(0,C.Tl)("sfMetadataGroupbyItem",{},(function(e){return{connectDropTarget:e.dropTarget()}}))((function(e){var t=e.readOnly,n=e.groupbys,r=e.columns,a=e.onDelete,i=e.onUpdate,s=e.onMove,l=(0,o.useMemo)((function(){return!Array.isArray(n)||0===n.length}),[n]),c=(0,o.useMemo)((function(){return!t&&(!(!Array.isArray(n)||0===n.length)&&n.length>1)}),[t,n]);return(0,h.jsxs)("div",{className:N()("groupbys-list",{"empty-groupbys-container":l}),children:[l&&(0,h.jsx)("div",{className:"empty-groupbys-list",children:(0,p.AP)("No groupings applied to this view.")}),!l&&n.map((function(e,n){return(0,h.jsx)(Pe,{index:n,readOnly:t,showDragBtn:c,groupby:e,columns:r,onDelete:a,onUpdate:i,onMove:s},n)}))]})})),Oe=(0,A.A)(Te),je=function(e){var t=e.groupbys,n=e.isNeedSubmit,a=e.readOnly,i=e.hidePopover,l=e.onChange,c=e.target,u=e.placement,d=e.columns,f=(0,o.useState)(t),m=(0,r.A)(f,2),v=m[0],y=m[1],C=(0,o.useState)(!1),A=(0,r.A)(C,2),x=A[0],b=A[1],_=(0,o.useState)(!1),w=(0,o.useRef)(null),S=(0,o.useCallback)((function(e){if(w.current&&!(0,p.wD)(e).includes("popover")&&!w.current.contains(e.target))return i(e),e.preventDefault(),e.stopPropagation(),!1}),[i]),D=(0,o.useCallback)((function(e){(0,L.default)("esc",e)&&!_.current&&(e.preventDefault(),i())}),[_,i]),E=(0,o.useCallback)((function(e){_.current=e}),[_]);(0,o.useEffect)((function(){document.addEventListener("click",S,!0),document.addEventListener("keydown",D);var e=window.sfMetadataContext.eventBus.subscribe(ae.Tw.OPEN_SELECT,E);return function(){document.removeEventListener("click",S,!0),document.removeEventListener("keydown",D),e()}}),[]);var k=(0,o.useCallback)((function(){l(v),i()}),[v,l,i]),M=(0,o.useCallback)((function(e){y(e),n?b(!0):l(e)}),[n,l]),I=(0,o.useCallback)((function(e){e&&e.nativeEvent.stopImmediatePropagation();var t=function(e){var t={};return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).forEach((function(e){var n=e.column_key;n&&(t[n]=!0)})),e.filter((function(e){var n=e.key,r=e.type;return!!g.LlW.includes(r)&&!t[n]}))}(d);if(Array.isArray(t)&&0!==t.length){var n=function(e){var t=e.find((function(e){return e.type===g.vZe.DATE}))||e.find((function(e){return(0,g.hBA)(e)})),n={column_key:null,sort_type:g.ClR.UP};return t&&(n.column_key=t.key,n.count_type=ke(t)),n}(t),r=v.slice(0);r.push(n),M(r)}}),[v,d,M]),N=(0,o.useCallback)((function(e){var t=v.slice(0);t.splice(e,1),M(t)}),[v,M]),P=(0,o.useCallback)((function(e,t){var n=v.slice(0);n[t]=e,M(n)}),[v,M]),T=(0,o.useCallback)((function(e,t){var n=v.slice(0);n.splice(e.idx,1),n.splice(t.idx,0,e.data),M(n)}),[v,M]),O=(0,o.useCallback)((function(){window.sfMetadataContext.eventBus.dispatch(ae.Tw.COLLAPSE_ALL_GROUPS)}),[]),j=(0,o.useCallback)((function(){window.sfMetadataContext.eventBus.dispatch(ae.Tw.EXPAND_ALL_GROUPS)}),[]),R=(0,o.useCallback)((function(e){e.stopPropagation()}),[]);return(0,h.jsx)(F.A,{placement:u,isOpen:!0,target:c,fade:!1,hideArrow:!0,className:"sf-metadata-groupbys-popover",boundariesElement:document.body,children:(0,h.jsxs)("div",{ref:w,onClick:R,className:"sf-metadata-groupbys",children:[(0,h.jsx)(Oe,{readOnly:a,groupbys:v,columns:d,onDelete:N,onUpdate:P,onMove:T}),!a&&v.length<g.mmt&&(0,h.jsx)(s.NC,{className:"popover-add-tool",callBack:I,footerName:(0,p.AP)("Add group"),addIconClassName:"popover-add-icon"}),v.length>0&&(0,h.jsxs)("div",{className:"groupbys-tools",children:[(0,h.jsx)("span",{className:"groupbys-tool-item",onClick:O,children:(0,p.AP)("Collapse all")}),(0,h.jsx)("span",{className:"groupbys-tool-item",onClick:j,children:(0,p.AP)("Expand all")})]}),!a&&n&&(0,h.jsxs)("div",{className:"sf-metadata-popover-footer",children:[(0,h.jsx)(B.A,{className:"mr-2",onClick:i,children:(0,p.AP)("Cancel")}),(0,h.jsx)(B.A,{color:"primary",disabled:!x,onClick:k,children:(0,p.AP)("Submit")})]})]})})},Re=(0,C.Tl)("sfMetadataHiddenColumns",{drop:function(e,t){var n=t.getItem(),r=e.column;if(r.key!==n.key&&n.column.frozen===r.frozen){var o={key:r.key};e.onMove(n.key,o.key)}}},(function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver(),canDrop:t.canDrop(),dragged:t.getItem()}}))((0,C.I4)("sfMetadataHiddenColumns",{beginDrag:function(e){return{key:e.column.key,column:e.column}},endDrag:function(e,t){var n=t.getItem();if(!t.didDrop())return{source:n,target:{}}},isDragging:function(e){var t=e.columnIndex;return e.currentIndex>t}},(function(e,t){return{connectDragSource:e.dragSource(),connectDragPreview:e.dragPreview(),isDragging:t.isDragging()}}))((function(e){var t=e.isOver,n=e.isDragging,r=e.canDrop,a=e.connectDragSource,i=e.connectDragPreview,l=e.connectDropTarget,c=e.readOnly,u=e.column,d=e.columnIndex,p=e.isHidden,f=e.onChange,m=e.onMouseEnter,v=e.onMouseLeave,y=(0,o.useCallback)((function(){c||f(u.key)}),[c,u,f]);return(0,h.jsx)(h.Fragment,{children:l(i((0,h.jsxs)("div",{className:N()("hide-column-item",{disabled:c,"hide-column-can-drop-top":t&&r&&n,"hide-column-can-drop":t&&r&&!n}),onMouseEnter:function(){return m(d)},onMouseLeave:v,children:[!c&&(0,h.jsx)(h.Fragment,{children:a((0,h.jsx)("div",{className:"drag-hide-column-handle",children:(0,h.jsx)(s.In,{iconName:"drag"})}))}),(0,h.jsx)(s.dO,{disabled:c,checked:p,placeholder:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(s.In,{iconName:g.ZPL[u.type]}),(0,h.jsx)("span",{className:"text-truncate",children:u.name})]}),onChange:y,switchClassName:"hide-column-item-switch"})]})))})}))),Le=(0,C.Tl)("sfMetadataHiddenColumns",{},(function(e){return{connectDropTarget:e.dropTarget()}}))((function(e){var t=e.readOnly,n=e.columns,a=e.hiddenColumns,i=e.onChange,s=e.modifyColumnOrder,l=(0,o.useState)(-1),c=(0,r.A)(l,2),u=c[0],d=c[1],f=(0,o.useMemo)((function(){return!Array.isArray(n)||0===n.length}),[n]),m=(0,o.useCallback)((function(e){u!==e&&d(e)}),[u]),g=(0,o.useCallback)((function(){d(-1)}),[]);return(0,h.jsxs)("div",{className:N()("hide-columns-list",{"empty-hide-columns-container":f}),children:[f&&(0,h.jsx)("div",{className:"empty-hide-columns-list",children:(0,p.AP)("No properties available to be hidden")}),!f&&n.map((function(e,n){return(0,h.jsx)(Re,{readOnly:t,columnIndex:n,currentIndex:u,isHidden:!a.includes(e.key),column:e,onChange:i,onMove:s,onMouseEnter:m,onMouseLeave:g},e.key)}))]})})),Fe=(0,A.A)(Le),Ue=function(e){var t=e.hidePopover,n=e.onChange,a=e.readOnly,i=e.target,l=e.placement,c=e.columns,u=e.hiddenColumns,d=e.modifyColumnOrder,f=(0,o.useState)(""),m=(0,r.A)(f,2),v=m[0],y=m[1],C=(0,o.useState)(u),A=(0,r.A)(C,2),x=A[0],b=A[1],_=(0,o.useMemo)((function(){if(!v)return Array.isArray(c)?c:[];var e=v.trim().toLocaleLowerCase();return c.filter((function(t){return t.name.toLocaleLowerCase().indexOf(e)>-1}))}),[v,c]),w=(0,o.useRef)(null),S=(0,o.useCallback)((function(e){if(w.current&&!(0,p.wD)(e).includes("popover")&&!w.current.contains(e.target))return t(e),e.preventDefault(),e.stopPropagation(),!1}),[t]),D=(0,o.useCallback)((function(e){(0,L.default)("esc",e)&&(e.preventDefault(),t())}),[t]);(0,o.useEffect)((function(){return document.addEventListener("click",S,!0),document.addEventListener("keydown",D),function(){document.removeEventListener("click",S,!0),document.removeEventListener("keydown",D)}}),[]);var E=(0,o.useCallback)((function(e){e.stopPropagation()}),[]),k=(0,o.useCallback)((function(e){e.keyCode!==g.cKb.ChineseInputMethod&&e.keyCode!==g.cKb.Enter&&e.keyCode!==g.cKb.LeftArrow&&e.keyCode!==g.cKb.RightArrow||e.stopPropagation()}),[]),M=(0,o.useCallback)((function(e){v!==e&&y(e)}),[v]),I=(0,o.useCallback)((function(e){b(e),n(e)}),[n]),N=(0,o.useCallback)((function(e){var t=x.slice(0),n=t.indexOf(e);n>-1?t.splice(n,1):t.push(e),I(t)}),[x,I]),P=(0,o.useCallback)((function(){I(_.map((function(e){return e.key})))}),[_,I]),T=(0,o.useCallback)((function(){I([])}),[I]);return(0,h.jsx)(F.A,{placement:l,isOpen:!0,target:i,fade:!1,hideArrow:!0,className:"sf-metadata-hide-columns-popover",boundariesElement:document.body,children:(0,h.jsxs)("div",{ref:w,onClick:E,className:"sf-metadata-hide-columns-container",style:{maxHeight:window.innerHeight-100},children:[(0,h.jsx)("div",{className:"sf-metadata-hide-columns-search-container",children:(0,h.jsx)(s.DO,{placeholder:(0,p.AP)("Search property"),onKeyDown:k,onChange:M,autoFocus:!0})}),(0,h.jsx)(Fe,{readOnly:a,columns:_,hiddenColumns:x,onChange:N,modifyColumnOrder:d}),!a&&!v&&(0,h.jsxs)("div",{className:"sf-metadata-hide-columns-operations",children:[(0,h.jsx)("div",{className:"sf-metadata-hide-columns-operation px-2",onClick:P,"aria-label":(0,p.AP)("Hide all"),children:(0,p.AP)("Hide all")}),(0,h.jsx)("div",{className:"sf-metadata-hide-columns-operation px-2",onClick:T,"aria-label":(0,p.AP)("Show all"),children:(0,p.AP)("Show all")})]})]})})}},73575:function(e,t,n){"use strict";n.d(t,{AD:function(){return f},lX:function(){return C},fT:function(){return A},rr:function(){return _},Tw:function(){return a},jN:function(){return l},L9:function(){return c},q$:function(){return d},Gi:function(){return h},ax:function(){return u},J3:function(){return m},_z:function(){return b},__:function(){return g},hw:function(){return y},bK:function(){return x},sN:function(){return s},$p:function(){return v},W6:function(){return p},aG:function(){return i}});var r=n(64467),o=n(3563),a={QUERY_COLLABORATORS:"query-collaborators",QUERY_COLLABORATOR:"query-collaborator",UPDATE_TABLE_ROWS:"update-table-rows",LOCAL_TABLE_CHANGED:"local-table-changed",SERVER_TABLE_CHANGED:"server-table-changed",TABLE_ERROR:"table-error",OPEN_EDITOR:"open-editor",CLOSE_EDITOR:"close-editor",SELECT_CELL:"select_cell",SELECT_START:"select_start",SELECT_UPDATE:"select_update",SELECT_END:"select_end",SELECT_END_WITH_SHIFT:"select_end_with_shift",SELECT_NONE:"select_none",COPY_CELLS:"copy_cells",PASTE_CELLS:"paste_cells",SEARCH_CELLS:"search-cells",CLOSE_SEARCH_CELLS:"close-search-cells",OPEN_SELECT:"open-select",UPDATE_LINKED_RECORDS:"update_linked_records",SELECT_COLUMN:"select_column",DRAG_ENTER:"drag_enter",COLLAPSE_ALL_GROUPS:"collapse_all_groups",EXPAND_ALL_GROUPS:"expand_all_groups",RELOAD_DATA:"reload_data",MODIFY_FILTERS:"modify_filters",MODIFY_SORTS:"modify_sorts",MODIFY_GROUPBYS:"modify_groupbys",MODIFY_HIDDEN_COLUMNS:"modify_hidden_columns",DISPLAY_SORTS:"display_sorts",VIEW_CHANGED:"view_changed",MODIFY_COLUMN_ORDER:"modify_column_order",SAVING:"saving",SAVED:"saved",ERROR:"error",MODIFY_GALLERY_ZOOM_GEAR:"modify_gallery_zoom_gear"},i={FRAGMENT:"application/x-sf-metadata-fragment",HTML:"text/html",TEXT:"text/plain",FILES:"files",DTABLE_FRAGMENT:"sf-metadata-fragment"},s=80,l=32,c=56,u=16,d=48,p=((0,r.default)((0,r.default)((0,r.default)((0,r.default)((0,r.default)({},o.vZe.CREATOR,!0),o.vZe.LAST_MODIFIER,!0),o.vZe.CTIME,!0),o.vZe.MTIME,!0),o.vZe.FILE_NAME,!0),(0,r.default)((0,r.default)((0,r.default)((0,r.default)((0,r.default)((0,r.default)({},o.vZe.TEXT,!0),o.vZe.DATE,!0),o.vZe.NUMBER,!0),o.vZe.SINGLE_SELECT,!0),o.vZe.COLLABORATOR,!0),o.vZe.CHECKBOX,!0)),f=((0,r.default)({},o.vZe.TEXT,!0),44),h={GROUP_CONTAINER:"group_container",ROW:"row",BTN_INSERT_ROW:"btn_insert_row"},m=32,g=[],v=[],y=10,C="#eaeaea",A="deleted_option",x=1e3,b=1e4,_={PREVIEWER:"previewer",ADDITION:"addition"}},88238:function(e,t,n){"use strict";var r=n(90675),o=n(89379),a=n(10467),i=n(23029),s=n(92901),l=n(19175),c=n(3563),u=n(72249),d=n(40326),p=function(){return(0,s.A)((function e(){var t=this;(0,i.A)(this,e),this.destroy=function(){t.settings={},t.metadataAPI=null,t.localStorage=null,t.eventBus=null,t.hasInit=!1,t.permission="r"},this.getSetting=function(e){return!1===t.settings[e]?t.settings[e]:t.settings[e]||""},this.setSetting=function(e,n){t.settings[e]=n},this.getUsername=function(){return d.Xh},this.getCollaborators=function(){var e=t.settings.repoID;return t.metadataAPI.getCollaborators(e)},this.getMetadata=function(e){var n=t.settings.repoID;return t.metadataAPI?t.metadataAPI.getMetadata(n,e):null},this.getRecord=function(e,n){var r=t.settings.repoID;return t.metadataAPI.getMetadataRecordInfo(r,e,n)},this.getViews=function(){var e=t.settings.repoID;return t.metadataAPI.listViews(e)},this.getView=function(e){var n=t.settings.repoID;return t.metadataAPI.getView(n,e)},this.getPermission=function(){return t.permission},this.canModify=function(){return"r"!==t.permission},this.canModifyRow=function(e){return"r"!==t.permission},this.canModifyRows=function(){return"r"!==t.permission},this.canModifyColumn=function(e){return"r"!==t.permission&&(!!e.editable&&!(c.Ajs.includes(e.key)&&!c.JIQ.includes(e.key)))},this.canRenameColumn=function(e){return"r"!==t.permission&&!c.Ajs.includes(e.key)},this.canModifyColumnData=function(e){if("r"===t.permission)return!1;var n=e.key;return!c.Ajs.includes(n)||c.SRQ.includes(n)},this.canDeleteColumn=function(e){if("r"===t.permission)return!1;var n=e.key;return!c.Ajs.includes(n)||c.LOw.includes(n)},this.canModifyColumnOrder=function(){return"r"!==t.permission},this.canModifyView=function(e){return"r"!==t.permission},this.restoreRows=function(){},this.updateRows=function(){},this.lockRowViaButton=function(){},this.updateRowViaButton=function(){},this.insertColumn=function(e,n,r,o){var a=o.key,i=o.data;return t.metadataAPI.insertColumn(e,n,r,{key:a,data:i})},this.deleteColumn=function(e,n){return t.metadataAPI.deleteColumn(e,n)},this.renameColumn=function(e,n,r){return t.metadataAPI.renameColumn(e,n,r)},this.modifyColumnData=function(e,n,r){return t.metadataAPI.modifyColumnData(e,n,r)},this.modifyRecord=function(e,n,r,o){return t.metadataAPI.modifyRecord(e,n,r,o)},this.modifyRecords=function(e,n,r){return t.metadataAPI.modifyRecords(e,n,r)},this.modifyView=function(e,n,r){return t.metadataAPI.modifyView(e,n,r)},this.getRowsByIds=function(){},this.generateDescription=function(e){var n=t.settings.repoID;return t.metadataAPI.generateDescription(n,e)},this.imageCaption=function(e){var n=t.settings.repoID,r=t.settings.lang;return t.metadataAPI.imageCaption(n,e,r)},this.settings={lang:d.vV},this.metadataAPI=null,this.localStorage=null,this.eventBus=null,this.hasInit=!1,this.permission="r",this.collaboratorsCache={}}),[{key:"init",value:function(){var e=(0,a.A)((0,r.A)().mark((function e(t){var n,a,i,s,d,p;return(0,r.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.hasInit){e.next=2;break}return e.abrupt("return");case 2:this.settings=(0,o.A)((0,o.A)({},this.settings),t),n=this.settings.repoInfo,this.metadataAPI=l.A,a=this.settings,i=a.repoID,s=a.viewID,d=s?"sf-metadata-".concat(i,"-").concat(s):"sf-metadata-".concat(i),this.localStorage=new c.DTU(d),p=new u.A,this.eventBus=p,this.permission="admin"!==n.permission&&"rw"!==n.permission?"r":"rw",this.hasInit=!0;case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}])}();t.A=p},47127:function(e,t,n){"use strict";n.d(t,{X:function(){return X},p:function(){return $}});var r,o=n(89379),a=n(5544),i=n(80045),s=n(9950),l=n(4086),c=n(88238),u=n(60436),d=n(90675),p=n(10467),f=n(23029),h=n(92901),m=n(55097),g=n.n(m),v=n(3563),y=n(4159),C=n.n(y),A=n(36220),x=n.n(A),b=n(64467),_={MODIFY_RECORD:"modify_record",MODIFY_RECORDS:"modify_records",RESTORE_RECORDS:"restore_records",RELOAD_RECORDS:"reload_records",MODIFY_FILTERS:"modify_filters",MODIFY_SORTS:"modify_sorts",MODIFY_GROUPBYS:"modify_groupbys",MODIFY_HIDDEN_COLUMNS:"modify_hidden_columns",LOCK_RECORD_VIA_BUTTON:"lock_record_via_button",MODIFY_RECORD_VIA_BUTTON:"modify_record_via_button",INSERT_COLUMN:"insert_column",DELETE_COLUMN:"delete_column",RENAME_COLUMN:"rename_column",MODIFY_COLUMN_DATA:"modify_column_data",MODIFY_COLUMN_WIDTH:"modify_column_width",MODIFY_COLUMN_ORDER:"modify_column_order"},w=(r={},(0,b.default)((0,b.default)((0,b.default)((0,b.default)((0,b.default)((0,b.default)((0,b.default)((0,b.default)((0,b.default)((0,b.default)(r,_.MODIFY_RECORD,["repo_id","row_id","updates","old_row_data","original_updates","original_old_row_data"]),_.MODIFY_RECORDS,["repo_id","row_ids","id_row_updates","id_original_row_updates","id_old_row_data","id_original_old_row_data","is_copy_paste","id_obj_id"]),_.RESTORE_RECORDS,["repo_id","rows_data","original_rows","link_infos","upper_row_ids"]),_.RELOAD_RECORDS,["repo_id","row_ids"]),_.MODIFY_FILTERS,["repo_id","view_id","filter_conjunction","filters","basic_filters"]),_.MODIFY_SORTS,["repo_id","view_id","sorts"]),_.MODIFY_GROUPBYS,["repo_id","view_id","groupbys"]),_.MODIFY_HIDDEN_COLUMNS,["repo_id","view_id","hidden_columns"]),_.LOCK_RECORD_VIA_BUTTON,["repo_id","row_id","button_column_key"]),_.MODIFY_RECORD_VIA_BUTTON,["repo_id","row_id","updates","old_row_data","original_updates","original_old_row_data","button_column_key"]),(0,b.default)((0,b.default)((0,b.default)((0,b.default)((0,b.default)((0,b.default)(r,_.INSERT_COLUMN,["repo_id","name","column_type","key","data"]),_.RENAME_COLUMN,["repo_id","column_key","new_name","old_name"]),_.MODIFY_COLUMN_DATA,["repo_id","column_key","new_data","old_data"]),_.DELETE_COLUMN,["repo_id","column_key","column"]),_.MODIFY_COLUMN_WIDTH,["column_key","new_width","old_width"]),_.MODIFY_COLUMN_ORDER,["repo_id","view_id","new_columns_keys","old_columns_keys"])),S=[],D=[],E=[_.MODIFY_RECORD,_.MODIFY_RECORDS,_.MODIFY_FILTERS,_.MODIFY_SORTS,_.MODIFY_GROUPBYS,_.MODIFY_HIDDEN_COLUMNS,_.INSERT_COLUMN,_.DELETE_COLUMN,_.RENAME_COLUMN,_.MODIFY_COLUMN_DATA,_.MODIFY_COLUMN_WIDTH,_.MODIFY_COLUMN_ORDER],k=[_.MODIFY_FILTERS,_.MODIFY_SORTS,_.MODIFY_GROUPBYS,_.MODIFY_HIDDEN_COLUMNS],M=[_.INSERT_COLUMN,_.DELETE_COLUMN,_.RENAME_COLUMN,_.MODIFY_COLUMN_DATA,_.MODIFY_COLUMN_WIDTH,_.MODIFY_COLUMN_ORDER],I=n(31195),N=(0,h.A)((function e(t,n){var r=this;(0,f.A)(this,e),this._id=t._id||"",this.type=t.type||"table","image"===this.type&&(this.type=v.rX9.GALLERY),this.filters=t.filters||[],this.filter_conjunction=t.filter_conjunction||"Or",this.basic_filters=t.basic_filters&&t.basic_filters.length>0?t.basic_filters:v.pkt[this.type],this.sorts=t.sorts&&t.sorts.length>0?t.sorts:v.hcH[this.type],this.groupbys=t.groupbys||[],this.groups=t.groups,this.hidden_columns=t.hidden_columns||[],this.rows=t.rows||[],this.available_columns=n||[],this.display_available_columns=this.available_columns.filter((function(e){return!v.hTT.includes(e.key)})),this.columns=this.display_available_columns;var o=t.columns_keys||[];if(0===o.length)this.columns_keys=this.display_available_columns.map((function(e){return e.key}));else{var a=o.map((function(e){return(0,v.rm3)(r.display_available_columns,e)})).filter((function(e){return e}));this.display_available_columns.forEach((function(e){(0,v.rm3)(a,e.key)||a.push(e)})),this.columns_keys=a.map((function(e){return e.key})),this.columns=a}}));C().extend(x());var P=function(){function e(t){var n=this;(0,f.A)(this,e);var r=g()(t),o=r.type||r.op_type,a=w[o];this.op_type=o,a.forEach((function(e){n[e]=r[e]})),this.success_callback=r.success_callback,this.fail_callback=r.fail_callback}return(0,h.A)(e,[{key:"clone",value:function(){return new e(this)}},{key:"apply",value:function(e){return function(e,t){switch(t.op_type){case _.MODIFY_RECORD:var n=t.row_id,r=t.original_updates,a=e.rows,i=a.findIndex((function(e){return n===e._id}));if(i<0)return e;var s=C()().utc().format(v.T6Y),l=window.sfMetadataContext.getUsername(),c=Object.assign({},a[i],r,{_mtime:s,_last_modifier:l});return e.rows[i]=c,e.id_row_map[n]=c,e;case _.MODIFY_RECORDS:var d=t.id_original_row_updates,p=t.id_row_updates,f=e.rows,h=C()().utc().format(v.T6Y),m=window.sfMetadataContext.getUsername(),g=(0,u.A)(f);return f.forEach((function(t,n){var r=t._id,o=d[r],a=p[r];if(a||o){var i=Object.assign({},t,a,o,{_mtime:h,_last_modifier:m});g[n]=i,e.id_row_map[r]=i}})),e.rows=g,e;case _.RESTORE_RECORDS:var y=t.original_rows,A=C()().utc().format(v.T6Y),x=window.sfMetadataContext.getUsername(),b=[];return y.forEach((function(t){var n=(0,o.A)((0,o.A)({},t),{},{_ctime:A,_mtime:A,_creator:x,_last_modifier:x});b.push(n),e.id_row_map[t._id]=n})),e.rows.push(b),e;case _.LOCK_RECORD_VIA_BUTTON:var w=t.row_id,S=e.rows,D=S.findIndex((function(e){return w===e._id}));if(D<0)return e;var E=(0,o.A)((0,o.A)({},S[D]),{},{_locked:!0});return e.rows[D]=E,e.id_row_map[w]=E,e;case _.MODIFY_RECORD_VIA_BUTTON:var k=t.row_id,M=t.original_updates,P=e.rows,T=P.findIndex((function(e){return k===e._id}));if(T<0)return e;var O=C()().utc().format(v.T6Y),j=window.sfMetadataContext.getUsername(),R=Object.assign({},P[T],M,{_mtime:O,_last_modifier:j});return e.rows[T]=R,e.id_row_map[k]=R,e;case _.MODIFY_FILTERS:var L=t.filter_conjunction,F=t.filters,U=t.basic_filters;return e.view.filter_conjunction=L,e.view.filters=F,e.view.basic_filters=U,e;case _.MODIFY_SORTS:var Y=t.sorts;return e.view.sorts=Y,e;case _.MODIFY_GROUPBYS:var B=t.groupbys;return e.view.groupbys=B,e;case _.MODIFY_HIDDEN_COLUMNS:var H=t.hidden_columns;return e.view.hidden_columns=H,e;case _.INSERT_COLUMN:var V=t.column,G=new I.A(V);return e.columns.push(G),e.view=new N(e.view,e.columns),e;case _.DELETE_COLUMN:var q=t.column_key,z=e.columns.slice(0),W=z.findIndex((function(e){return e.key===q}));return-1!==W&&(z.splice(W,1),e.columns=z,e.view=new N(e.view,e.columns)),e;case _.RENAME_COLUMN:var K=t.column_key,Z=t.new_name,X=e.columns.findIndex((function(e){return e.key===K}));if(-1!==X){var $=new I.A((0,o.A)((0,o.A)({},e.columns[X]),{},{name:Z}));e.columns[X]=$}return e.view=new N(e.view,e.columns),e;case _.MODIFY_COLUMN_DATA:var J=t.column_key,Q=t.new_data,ee=e.columns.findIndex((function(e){return e.key===J}));if(-1!==ee){var te=e.columns[ee],ne=new I.A((0,o.A)((0,o.A)({},te),{},{data:(0,o.A)((0,o.A)({},te.data),Q)}));e.columns[ee]=ne}return e.view=new N(e.view,e.columns),e;case _.MODIFY_COLUMN_WIDTH:var re=t.column_key,oe=t.new_width,ae=e.columns.findIndex((function(e){return e.key===re}));if(-1!==ae){var ie=e.columns[ae],se=new I.A((0,o.A)((0,o.A)({},ie),{},{width:oe}));e.columns[ae]=se}return e.view=new N(e.view,e.columns),e;case _.MODIFY_COLUMN_ORDER:var le=t.new_columns_keys;return e.view=new N((0,o.A)((0,o.A)({},e.view),{},{columns_keys:le}),e.columns),e;default:return e}}(e,this)}},{key:"invert",value:function(){return function(e){switch(e.clone().op_type){case _.MODIFY_RECORD:var t=e.page_id,n=e.row_id,r=e.updates,o=e.old_row_data,a=e.original_updates,i=e.original_old_row_data;return T({type:_.MODIFY_RECORD,page_id:t,row_id:n,updates:g()(o),old_row_data:g()(r),original_updates:g()(i),original_old_row_data:g()(a)});case _.MODIFY_RECORDS:var s=e.page_id,l=e.is_copy_paste,c=e.row_ids,u=e.id_row_updates,d=e.id_original_row_updates,p=e.id_old_row_data,f=e.id_original_old_row_data;return T({type:_.MODIFY_RECORDS,page_id:s,is_copy_paste:l,row_ids:g()(c),id_row_updates:g()(p),id_original_row_updates:g()(f),id_old_row_data:g()(u),id_original_old_row_data:g()(d)});case _.RESTORE_RECORDS:var h=e.page_id,m=e.rows_data,v=e.original_rows,y=e.link_infos,C=e.upper_row_ids,A=m.map((function(e){return e._id}));return T({type:_.DELETE_RECORDS,page_id:h,row_ids:A,deleted_rows:g()(m),original_deleted_rows:g()(v),deleted_link_infos:g()(y),upper_row_ids:g()(C)})}}(this)}},{key:"set",value:function(e,t){this[e]=t}}])}();function T(e){return new P(e)}var O,j=n(73575),R=n(40326),L=function(){return(0,h.A)((function e(){(0,f.A)(this,e)}),null,[{key:"getFilteredRows",value:function(e,t,n,r){var o=(0,v.EOE)(t)?t:(0,v.VLM)(e,t);return(0,v.bj$)(e,o,n,r,{username:R.Xh}).row_ids}},{key:"getSortedRows",value:function(e,t,n,r){var o=r.collaborators,a=(0,v.EOE)(t)?t:(0,v.VLM)(e,t);return(0,v.eD3)(e,a,n,{collaborators:o})}},{key:"getGroupedRows",value:function(e,t,n,r){var o=r.collaborators,a=(0,v.EOE)(t)?t:(0,v.VLM)(e,t);return(0,v.N71)(e,a,n,{collaborators:o})}},{key:"updateSummaries",value:function(e,t){}},{key:"hasRelatedGroupby",value:function(e,t){return e.some((function(e){return t[e.column_key]}))}},{key:"deleteGroupRows",value:function(e,t){var n=this;e.forEach((function(e){var r=e.subgroups,o=e.row_ids;Array.isArray(r)&&r.length>0?n.deleteGroupRows(r,t):o&&(e.row_ids=o.filter((function(e){return!t[e]})))}))}},{key:"run",value:function(e,t){var n=t.collaborators,r=e.rows,o=e.view.groupbys,a=e.view.available_columns||e.columns,i=(0,v.rnW)({groupbys:o},a);if(i){var s=r,l=i?this.getGroupedRows(e,s,o,{collaborators:n}):[],c=(0,v.EOE)(s)?s.map((function(e){return e._id})):s;e.view.rows=c,e.view.groups=l}else e.view.rows=e.rows.map((function(e){return e._id}))}},{key:"updateDataWithModifyRecords",value:function(e,t,n,r){var o=r.collaborators,a=e.view,i=a.available_columns,s=a.groupbys,l=a.rows;(0,v.rnW)({groupbys:s},i)&&this.hasRelatedGroupby(s,t)&&(e.view.groups=this.getGroupedRows(e,l,s,{collaborators:o}))}},{key:"handleReloadedRecords",value:function(e,t,n){var r=t.reduce((function(e,t){return e[t._id]=t,e}),{});e.rows.forEach((function(t,n){var o=t._id,a=r[o],i=Object.assign({},e.rows[n],a);a&&(e.rows[n]=i,e.id_row_map[o]=i)})),this.updateDataWithModifyRecords(),this.updateSummaries()}},{key:"handleNotExistRecords",value:function(e,t){var n=[],r=[];e.rows.forEach((function(o){var a=o._id;t[a]?(n.push(o),delete e.id_row_map[a]):r.push(o)})),e.rows=e.rows.filter((function(e){return!t[e._id]})),e.view.rows=e.rows.filter((function(e){return!t[e]})),this.updateSummaries()}},{key:"syncOperationOnData",value:function(e,t,n){var r=n.collaborators;switch(t.op_type){case _.MODIFY_RECORD:case _.MODIFY_RECORDS:var o=e.view.available_columns,a=t.id_original_row_updates,i=t.row_ids,s={},l=[];i.forEach((function(e){var t=a[e];t&&l.push.apply(l,(0,u.A)(Object.keys(t)))})),l.forEach((function(e){s[e]||(0,v.rm3)(o,e)&&(s[e]=!0)})),this.updateDataWithModifyRecords(e,s,i,{collaborators:r}),this.updateSummaries();break;case _.MODIFY_RECORD_VIA_BUTTON:var c=e.view.available_columns,d=t.original_updates,p={};for(var f in d){(0,v.rm3)(c,f)&&(p[f]=!0)}this.updateDataWithModifyRecords(),this.updateSummaries();break;case _.RESTORE_RECORDS:var h=t.rows_data,m=t.upper_row_ids,g=e.view.rows,y=h.map((function(e){return e._id})),C=(0,u.A)(g);Array.isArray(m)&&0!==m.length?m.forEach((function(e,t){var n=y[t],r=C.indexOf(e);r<0?C.push(n):C.splice(r+1,0,n)})):C.push.apply(C,(0,u.A)(y)),e.view.rows=C,this.updateDataWithModifyRecords(e,{collaborators:r}),this.updateSummaries();break;case _.MODIFY_GROUPBYS:var A=e.view,x=A.available_columns,b=A.groupbys,w=A.rows;if(!(0,v.rnW)({groupbys:b},x)){e.view.groups=[];break}e.view.groups=this.getGroupedRows(e,w,b,{collaborators:r})}}}])}();O=L,L.hasRelatedFilters=function(e,t){return e.some((function(e){return t[e.column_key]}))},L.hasRelatedSort=function(e,t){return e.some((function(e){return t[e.column_key]}))},L.deleteEmptyGroups=function(e){return e.filter((function(e){var t=e.subgroups,n=e.row_ids;return t&&t.length>0?0!==O.deleteEmptyGroups(t).length:!(!n||0===n.length)}))};var F=L,U=n(58419),Y=function(){return(0,h.A)((function e(){(0,f.A)(this,e),this.checkReloadRecordsOperation=function(e){return e.op_type===_.RELOAD_RECORDS}}),[{key:"applyOperation",value:function(e,t){switch(e.op_type){case _.MODIFY_RECORD:var n=e.repo_id,r=[{record_id:e.row_id,record:e.updates}];window.sfMetadataContext.modifyRecords(n,r).then((function(n){t({operation:e})})).catch((function(e){t({error:(0,U.AP)("Failed to modify record")})}));break;case _.MODIFY_RECORDS:var a=e.repo_id,i=e.row_ids,s=e.id_row_updates,l=e.is_copy_paste,c=e.id_obj_id,u=i.map((function(e){return{record_id:e,record:s[e],obj_id:c[e]}}));window.sfMetadataContext.modifyRecords(a,u,l).then((function(n){t({operation:e})})).catch((function(e){t({error:(0,U.AP)("Failed to modify records")})}));break;case _.RESTORE_RECORDS:var d=e.repo_id,p=e.rows_data;if(!Array.isArray(p)||0===p.length){t({error:(0,U.AP)("Failed to restore records")});break}window.sfMetadataContext.restoreRows(d,p).then((function(n){t({operation:e})})).catch((function(e){t({error:(0,U.AP)("Failed to restore records")})}));break;case _.RELOAD_RECORDS:t({operation:e});break;case _.INSERT_COLUMN:var f=e.repo_id,h=e.name,m=e.column_type,g=e.key,v=e.data;window.sfMetadataContext.insertColumn(f,h,m,{key:g,data:v}).then((function(n){e.column=n.data.column,t({operation:e})})).catch((function(e){t({error:(0,U.AP)("Failed to insert property")})}));break;case _.DELETE_COLUMN:var y=e.repo_id,C=e.column_key;window.sfMetadataContext.deleteColumn(y,C).then((function(n){t({operation:e})})).catch((function(e){t({error:(0,U.AP)("Failed to delete property")})}));break;case _.RENAME_COLUMN:var A=e.repo_id,x=e.column_key,w=e.new_name;window.sfMetadataContext.renameColumn(A,x,w).then((function(n){t({operation:e})})).catch((function(e){t({error:(0,U.AP)("Failed to rename property")})}));break;case _.MODIFY_COLUMN_DATA:var S=e.repo_id,D=e.column_key,E=e.new_data;window.sfMetadataContext.modifyColumnData(S,D,E).then((function(n){t({operation:e})})).catch((function(e){t({error:(0,U.AP)("Failed to modify property data")})}));break;case _.MODIFY_COLUMN_WIDTH:var k=e.column_key,M=e.new_width;try{var I=window.sfMetadataContext.localStorage.getItem("columns_width")||{};window.sfMetadataContext.localStorage.setItem("columns_width",(0,o.A)((0,o.A)({},I),{},(0,b.default)({},k,M))),t({operation:e})}catch(Z){t({error:(0,U.AP)("Failed to modify property width")})}break;case _.MODIFY_COLUMN_ORDER:var N=e.repo_id,P=e.view_id,T=e.new_columns_keys;window.sfMetadataContext.modifyView(N,P,{columns_keys:T}).then((function(n){t({operation:e})})).catch((function(e){t({error:(0,U.AP)("Failed to modify property order")})}));break;case _.MODIFY_FILTERS:var O=e.repo_id,j=e.view_id,R=e.filter_conjunction,L=e.filters,F=e.basic_filters;window.sfMetadataContext.modifyView(O,j,{filters:L,filter_conjunction:R,basic_filters:F}).then((function(n){t({operation:e})})).catch((function(e){t({error:(0,U.AP)("Failed to modify filter")})}));break;case _.MODIFY_SORTS:var Y=e.repo_id,B=e.view_id,H=e.sorts;window.sfMetadataContext.modifyView(Y,B,{sorts:H}).then((function(n){t({operation:e})})).catch((function(e){t({error:(0,U.AP)("Failed to modify sort")})}));break;case _.MODIFY_GROUPBYS:var V=e.repo_id,G=e.view_id,q=e.groupbys;window.sfMetadataContext.modifyView(V,G,{groupbys:q}).then((function(n){t({operation:e})})).catch((function(e){t({error:(0,U.AP)("Failed to modify group")})}));break;case _.MODIFY_HIDDEN_COLUMNS:var z=e.repo_id,W=e.view_id,K=e.hidden_columns;window.sfMetadataContext.modifyView(z,W,{hidden_columns:K}).then((function(n){t({operation:e})})).catch((function(e){t({error:(0,U.AP)("Failed to modify hidden properties")})}))}}},{key:"handleReloadRecords",value:function(e,t,n){var r=t.repo_id,o=this.getOperationRelatedColumns(e,t).relatedColumnKeyMap;if(this.checkReloadRecordsOperation(t)){var a=this.getOperatedRowsIds(t);this.asyncReloadRecords(a,r,o,n)}}},{key:"asyncReloadRecords",value:function(e,t,n,r){var o=this;if(Array.isArray(e)&&0!==e.length){var a=(0,u.A)(e),i=a.splice(0,100);window.sfMetadataContext.getRowsByIds(t,i).then((function(e){if(e&&e.data&&e.data.results){var s=e.data.results,l=[],c={},u={};s.length>0&&s.forEach((function(e){l.push(e),c[e._id]=!0})),i.forEach((function(e){c[e]||(u[e]=!0)})),r({reloadedRecords:l,idRecordNotExistMap:u,relatedColumnKeyMap:n}),o.asyncReloadRecords(a,t,n,r)}else o.asyncReloadRecords(a,t,n,r)})).catch((function(e){console.log(e),o.asyncReloadRecords(a,t,n,r)}))}}},{key:"getOperationRelatedColumns",value:function(e,t){var n;switch(t.op_type){case _.MODIFY_RECORDS:var r=t.id_original_row_updates;n=this.getRelatedColumnKeysFromRecordUpdates(r);break;case _.RELOAD_RECORDS:var o=e.view.available_columns,a={};return o.forEach((function(e){var t=e.key;a[t]=!0})),{relatedColumnKeyMap:a,relatedColumns:o};case _.MODIFY_RECORD_VIA_BUTTON:var i=t.row_id,s=t.original_updates;n=this.getRelatedColumnKeysFromRecordUpdates((0,b.default)({},i,s));break;default:n=[]}return this.getRelatedColumns(n,e)}},{key:"getOperatedRowsIds",value:function(e){switch(e.op_type){case _.MODIFY_RECORDS:case _.RELOAD_RECORDS:var t=e.row_ids;return Array.isArray(t)?(0,u.A)(t):[];case _.MODIFY_RECORD_VIA_BUTTON:var n=e.row_id;return n?[n]:[];default:return[]}}},{key:"getRelatedColumns",value:function(e,t){if(!e||0===e.length)return{relatedColumnKeyMap:{},relatedColumns:[]};var n={},r=[],o=t.view.available_columns;return e.forEach((function(e){if(!n[e]){var t=(0,v.rm3)(o,e);t&&(n[e]=!0,r.push(t))}})),{relatedColumnKeyMap:n,relatedColumns:r}}},{key:"getRelatedColumnKeysFromRecordUpdates",value:function(e){return e?Object.keys(e).reduce((function(t,n){var r=e[n];return r&&t.push.apply(t,(0,u.A)(Object.keys(r))),t}),[]):[]}}])}(),B=n(31425),H=(0,h.A)((function e(t){var n=this;(0,f.A)(this,e);var r=t.columns||[];this.columns=r.map((function(e){return new I.A(e)})),this.rows=t.rows||[],this.id_row_map={},this.row_ids=[],this.rows.forEach((function(e){n.row_ids.push(e._id),n.id_row_map[e._id]=e})),this.hasMore=!0,this.recordsCount=this.row_ids.length,this.view=new N(t.view||{},this.columns)})),V=function(){return(0,h.A)((function e(t){var n=this;(0,f.A)(this,e),this.destroy=function(){n.viewId="",n.data=null,n.startIndex=0,n.redos=[],n.undos=[],n.pendingOperations=[],n.isSendingOperation=!1},this.initStartIndex=function(){n.startIndex=0},this.sendOperationCallback=function(e,t){var r=t.operation,o=t.error;if(o)return r&&r.fail_callback&&r.fail_callback(),n.context.eventBus.dispatch(j.Tw.TABLE_ERROR,{error:o}),void n.sendNextOperation(e);E.includes(r.op_type)&&(n.handleUndoRedos(e,r),n.data=g()(r.apply(n.data)),n.syncOperationOnData(r)),(k.includes(r.op_type)||M.includes(r.op_type))&&window.sfMetadataContext.eventBus.dispatch(j.Tw.VIEW_CHANGED,n.data.view),r.success_callback&&r.success_callback(),n.context.eventBus.dispatch(j.Tw.SERVER_TABLE_CHANGED),n.serverOperator.handleReloadRecords(n.data,r,(function(e){var t=e.reloadedRecords,r=e.idRecordNotExistMap,o=e.relatedColumnKeyMap;t.length>0&&F.handleReloadedRecords(n.data,t,o),Object.keys(r).length>0&&F.handleNotExistRecords(n.data,r),n.context.eventBus.dispatch(j.Tw.SERVER_TABLE_CHANGED)})),n.sendNextOperation(e)},this.insertColumn=function(e,t,r){var o=r.key,a=r.data,i=_.INSERT_COLUMN,s=n.createOperation({type:i,repo_id:n.repoId,name:e,column_type:t,key:o,data:a});n.applyOperation(s)},this.deleteColumn=function(e,t){var r=_.DELETE_COLUMN,o=n.createOperation({type:r,repo_id:n.repoId,column_key:e});n.applyOperation(o)},this.renameColumn=function(e,t,r){var o=_.RENAME_COLUMN,a=n.createOperation({type:o,repo_id:n.repoId,column_key:e,new_name:t,old_name:r});n.applyOperation(a)},this.modifyColumnData=function(e,t,r){var o=_.MODIFY_COLUMN_DATA,a=n.createOperation({type:o,repo_id:n.repoId,column_key:e,new_data:t,old_data:r});n.applyOperation(a)},this.modifyColumnWidth=function(e,t){var r=_.MODIFY_COLUMN_WIDTH,o=(0,v.rm3)(n.data.columns,e),a=n.createOperation({type:r,repo_id:n.repoId,column_key:e,new_width:t,old_width:o.width});n.applyOperation(a)},this.modifyColumnOrder=function(e,t){var r=_.MODIFY_COLUMN_ORDER,o=n.data.view.columns_keys,a=o.indexOf(t),i=o.slice(0);(i=i.filter((function(t){return t!==e}))).splice(a,0,e);var s=n.createOperation({type:r,repo_id:n.repoId,view_id:n.viewId,new_columns_keys:i,old_columns_keys:o});n.applyOperation(s)},this.repoId=t.repoId,this.viewId=t.viewId,this.data=null,this.context=t.context,this.startIndex=0,this.redos=[],this.undos=[],this.pendingOperations=[],this.isSendingOperation=!1,this.isReadonly=!1,this.serverOperator=new Y,this.collaborators=t.collaborators||[]}),[{key:"loadMetadata",value:function(){var e=(0,p.A)((0,d.A)().mark((function e(t,n){var r,o,a,i,s,l,c;return(0,d.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.context.getMetadata({view_id:this.viewId,start:this.startIndex,limit:n});case 2:a=e.sent,i=(null===a||void 0===a||null===(r=a.data)||void 0===r?void 0:r.results)||[],s=(0,B.H2)(null===a||void 0===a||null===(o=a.data)||void 0===o?void 0:o.metadata),(l=new H({rows:i,columns:s,view:t})).view.rows=l.row_ids,c=i.length,l.hasMore=c===n,this.data=l,this.startIndex+=c,F.run(this.data,{collaborators:this.collaborators});case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=(0,p.A)((0,d.A)().mark((function e(){var t,n,r,o,a=arguments;return(0,d.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>0&&void 0!==a[0]?a[0]:j.bK,e.next=3,this.context.getView(this.viewId);case 3:return r=e.sent,o=(null===r||void 0===r||null===(t=r.data)||void 0===t?void 0:t.view)||{},e.next=7,this.loadMetadata(o,n);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"reload",value:function(){var e=(0,p.A)((0,d.A)().mark((function e(){var t,n=arguments;return(0,d.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:j.bK,this.startIndex=0,e.next=4,this.loadMetadata(this.data.view,t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadMore",value:function(){var e=(0,p.A)((0,d.A)().mark((function e(t){var n,r,o,a,i,s=this;return(0,d.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.data){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.context.getMetadata({view_id:this.viewId,start:this.startIndex,limit:t});case 4:if(o=e.sent,a=(null===o||void 0===o||null===(n=o.data)||void 0===n?void 0:n.results)||[],Array.isArray(a)&&0!==a.length){e.next=9;break}return this.hasMore=!1,e.abrupt("return");case 9:(r=this.data.rows).push.apply(r,(0,u.A)(a)),a.forEach((function(e){s.data.row_ids.push(e._id),s.data.id_row_map[e._id]=e})),i=a.length,this.data.hasMore=i===t,this.data.recordsCount=this.data.row_ids.length,this.startIndex=this.startIndex+i,F.run(this.data,{collaborators:this.collaborators}),this.context.eventBus.dispatch(j.Tw.LOCAL_TABLE_CHANGED);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateRowData",value:function(){var e=(0,p.A)((0,d.A)().mark((function e(t){var n,r,o;return(0,d.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.context.getRowsByIds(this.repoId,[t]);case 2:if((n=e.sent)&&n.data){e.next=5;break}return e.abrupt("return");case 5:r=n.data.results[0],o=this.data.rows.findIndex((function(e){return e._id===t})),this.data.id_row_map[t]=r,this.data.rows[o]=r,F.run(this.data,{collaborators:this.collaborators});case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createOperation",value:function(e){return new P(e)}},{key:"applyOperation",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{handleUndo:!0},n=e.op_type;E.includes(n)||(this.handleUndoRedos(t,e),this.data=g()(e.apply(this.data)),this.syncOperationOnData(e),this.context.eventBus.dispatch(j.Tw.LOCAL_TABLE_CHANGED)),D.includes(n)||this.addPendingOperations(e,t)}},{key:"addPendingOperations",value:function(e,t){this.pendingOperations.push(e),this.startSendOperation(t)}},{key:"startSendOperation",value:function(e){this.isSendingOperation||0===this.pendingOperations.length||(this.isSendingOperation=!0,this.context.eventBus.dispatch(j.Tw.SAVING),this.sendNextOperation(e))}},{key:"sendNextOperation",value:function(e){if(0===this.pendingOperations.length)return this.isSendingOperation=!1,void this.context.eventBus.dispatch(j.Tw.SAVED);var t=this.pendingOperations.shift();this.serverOperator.applyOperation(t,this.sendOperationCallback.bind(this,e))}},{key:"handleUndoRedos",value:function(e,t){var n=e.handleUndo,r=e.asyncUndoRedo;n&&(this.redos.length>0&&(this.redos=[]),this.undos.length>10&&(this.undos=this.undos.slice(-10)),S.includes(t.op_type)&&this.undos.push(t)),r&&r(t)}},{key:"undoOperation",value:function(){var e=this;if(!this.isReadonly&&0!==this.undos.length){var t=this.undos.pop(),n=t.invert();E.includes(n.op_type)?this.applyOperation(n,{handleUndo:!1,asyncUndoRedo:function(n){n.op_type===_.INSERT_RECORD&&(t.row_id=n.row_data._id),e.redos.push(t)}}):(this.redos.push(t),this.applyOperation(n,{handleUndo:!1}))}}},{key:"redoOperation",value:function(){var e=this;if(!this.isReadonly&&0!==this.redos.length){var t=this.redos.pop();E.includes(t.op_type)?this.applyOperation(t,{handleUndo:!1,asyncUndoRedo:function(n){n.op_type===_.INSERT_RECORD&&(t=n),e.undos.push(t)}}):(this.undos.push(t),this.applyOperation(t,{handleUndo:!1}))}}},{key:"syncOperationOnData",value:function(e){F.syncOperationOnData(this.data,e,{collaborators:this.collaborators})}},{key:"modifyRecord",value:function(e,t,n,r,o){var a=(0,v.fj4)(this.data,e);if(a&&this.context.canModifyRow(a)){var i=_.MODIFY_RECORD,s=this.createOperation({type:i,repo_id:this.repoId,row_id:e,updates:t,old_row_data:n,original_updates:r,original_old_row_data:o});this.applyOperation(s)}}},{key:"modifyRecords",value:function(e,t,n,r,o,a){var i=this,s=(0,v.VLM)(this.data,e),l=[],c={},u={},d={},p={},f={};s.forEach((function(e){if(e&&i.context.canModifyRow(e)){var a=e._id;l.push(a),c[a]=t[a],f[a]=e._obj_id,u[a]=n[a],d[a]=r[a],p[a]=o[a]}}));var h=_.MODIFY_RECORDS,m=this.createOperation({type:h,repo_id:this.repoId,row_ids:l,id_row_updates:c,id_original_row_updates:u,id_old_row_data:d,id_original_old_row_data:p,is_copy_paste:a,id_obj_id:f});this.applyOperation(m)}},{key:"reloadRecords",value:function(e){var t=_.RELOAD_RECORDS,n=this.createOperation({type:t,repo_id:this.repoId,row_ids:e});this.applyOperation(n)}},{key:"lockRecordViaButton",value:function(e,t,n){var r=n.success_callback,o=n.fail_callback,a=_.LOCK_RECORD_VIA_BUTTON,i=this.createOperation({type:a,repo_id:this.repoId,row_id:e,button_column_key:t,success_callback:r,fail_callback:o});this.applyOperation(i)}},{key:"modifyRecordViaButton",value:function(e,t,n,r,o,a,i){var s=i.success_callback,l=i.fail_callback;if((0,v.fj4)(this.data,e)){var c=_.MODIFY_RECORD_VIA_BUTTON,u=this.createOperation({type:c,repo_id:this.repoId,row_id:e,updates:t,old_row_data:n,original_updates:r,original_old_row_data:o,button_column_key:a,success_callback:s,fail_callback:l});this.applyOperation(u)}}},{key:"modifyFilters",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=_.MODIFY_FILTERS,a=this.createOperation({type:o,filter_conjunction:e,filters:t,basic_filters:r,repo_id:this.repoId,view_id:this.viewId,success_callback:function(){n.context.eventBus.dispatch(j.Tw.RELOAD_DATA)}});this.applyOperation(a)}},{key:"modifySorts",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=_.MODIFY_SORTS,o=this.createOperation({type:r,sorts:e,repo_id:this.repoId,view_id:this.viewId,success_callback:function(){t.context.eventBus.dispatch(j.Tw.RELOAD_DATA),n&&t.context.eventBus.dispatch(j.Tw.DISPLAY_SORTS)}});this.applyOperation(o)}},{key:"modifyGroupbys",value:function(e){var t=_.MODIFY_GROUPBYS,n=this.createOperation({type:t,groupbys:e,repo_id:this.repoId,view_id:this.viewId});this.applyOperation(n)}},{key:"modifyHiddenColumns",value:function(e){var t=_.MODIFY_HIDDEN_COLUMNS,n=this.createOperation({type:t,hidden_columns:e,repo_id:this.repoId,view_id:this.viewId});this.applyOperation(n)}}])}(),G=V,q=n(65604),z=n(44),W=n(44414),K=["children","repoID","viewID"],Z=s.createContext(null),X=function(e){var t=e.children,n=e.repoID,r=e.viewID,u=(0,i.A)(e,K),d=(0,s.useState)(!0),p=(0,a.A)(d,2),f=p[0],h=p[1],m=(0,s.useState)({rows:[],columns:[],view:{}}),g=(0,a.A)(m,2),v=g[0],y=g[1],C=(0,s.useRef)(null),A=(0,z.D1)().collaborators,x=(0,z.p_)(),b=x.showFirstView,_=x.setShowFirstView,w=(0,s.useCallback)((function(){y(C.current.data)}),[]),S=(0,s.useCallback)((function(e){l.A.danger(e.error)}),[]),D=(0,s.useCallback)((function(e){y(e)}),[]),E=(0,s.useCallback)((function(){h(!0),C.current.reload(j.bK).then((function(){y(C.current.data),h(!1)})).catch((function(e){var t=q.Aq.getErrorMsg(e);l.A.danger(t)}))}),[]),k=(0,s.useCallback)((function(e,t,n){window.sfMetadataStore.modifyFilters(t,e,n)}),[]),M=(0,s.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];window.sfMetadataStore.modifySorts(e,t)}),[]),I=(0,s.useCallback)((function(e){window.sfMetadataStore.modifyGroupbys(e)}),[]),N=(0,s.useCallback)((function(e){window.sfMetadataStore.modifyHiddenColumns(e)}),[]),P=(0,s.useCallback)((function(e,t){window.sfMetadataStore.modifyColumnOrder(e,t)}),[]);return(0,s.useEffect)((function(){h(!0);var e=new c.A;window.sfMetadataContext=e,window.sfMetadataContext.init((0,o.A)((0,o.A)({},u),{},{repoID:n,viewID:r})),C.current=new G({context:window.sfMetadataContext,repoId:n,viewId:r,collaborators:A}),window.sfMetadataStore=C.current,C.current.initStartIndex(),C.current.load(j.bK).then((function(){b&&0===C.current.data.rows.length&&l.A.success((0,U.AP)("The files' metadata is being created. This may take a minute or so. Please refresh the page later.")),y(C.current.data),_(!1),h(!1)})).catch((function(e){var t=q.Aq.getErrorMsg(e);l.A.danger(t)}));var t=window.sfMetadataContext.eventBus,a=t.subscribe(j.Tw.SERVER_TABLE_CHANGED,w),i=t.subscribe(j.Tw.LOCAL_TABLE_CHANGED,w),s=t.subscribe(j.Tw.TABLE_ERROR,S),d=t.subscribe(j.Tw.UPDATE_TABLE_ROWS,D),p=t.subscribe(j.Tw.RELOAD_DATA,E),f=t.subscribe(j.Tw.MODIFY_FILTERS,k),m=t.subscribe(j.Tw.MODIFY_SORTS,M),g=t.subscribe(j.Tw.MODIFY_GROUPBYS,I),v=t.subscribe(j.Tw.MODIFY_HIDDEN_COLUMNS,N),x=t.subscribe(j.Tw.MODIFY_COLUMN_ORDER,P);return function(){window.sfMetadataContext.destroy(),window.sfMetadataStore.destroy(),a(),i(),s(),d(),p(),f(),m(),g(),v(),x()}}),[n,r]),(0,W.jsx)(Z.Provider,{value:{isLoading:f,metadata:v,store:C.current},children:t})},$=function(){var e=(0,s.useContext)(Z);if(!e)throw new Error("'MetadataContext' is null");return{isLoading:e.isLoading,metadata:e.metadata,store:e.store}}},31195:function(e,t,n){"use strict";var r=n(92901),o=n(23029),a=n(31425),i=n(3563),s=(0,r.A)((function e(t){(0,o.A)(this,e),this.is_frozen=function(e){return e===i.L2D.FILE_NAME},this.enable_edit=function(e,t){return!i.Ajs.includes(e)||i.JIQ.includes(e)},this.key=t.key||"",this.name=(0,a.Q8)(this.key,t.name)||"",this.type=t.type||"",this.data=t.data||null,this.width=t.width||200,this.editable=this.enable_edit(this.key,this.type),this.data=(0,a.Qq)(this),this.frozen=this.is_frozen(this.key)||t.frozen||!1}));t.A=s},31425:function(e,t,n){"use strict";n.d(t,{Ax:function(){return h},H2:function(){return S},Hs:function(){return v},KO:function(){return x},Kf:function(){return d},Q8:function(){return A},Qq:function(){return w},YO:function(){return _},Zz:function(){return m},dK:function(){return D},iM:function(){return y},nh:function(){return b},s9:function(){return C},u7:function(){return p},wV:function(){return f},wo:function(){return g}});var r=n(80045),o=n(89379),a=n(55097),i=n.n(a),s=n(3563),l=n(73575),c=n(40326),u=["type","key"];function d(e){return e&&e.data&&e.data.format?e.data.format:s.D23}function p(e){return e.type===s.vZe.CHECKBOX}function f(e,t){return Array.isArray(t)?t[e]:"undefined"!==typeof Immutable?t.get(e):null}var h=function(e){return"_name"===e.key},m=function(e){return!!e&&!0===e.frozen};function g(e,t){return t[e.idx].editable}function v(e,t){var n=t[e.idx];return[s.vZe.CHECKBOX].includes(null===n||void 0===n?void 0:n.type)}var y=function(e,t){var n=e,r=t,o=n.reduce((function(e,t){return e+=t.width}),0),a=l.sN,i=n.filter((function(e){return m(e)})),s=i.reduce((function(e,t){return e+t.width}),0);return{totalWidth:o,lastFrozenColumnKey:s>0?i[i.length-1].key:null,frozenColumnsWidth:s,columns:n.map((function(e,t){var n=e.width;return e.idx=t,e.left=a,e.width=n,a+=n,e})),allColumns:r}},C=function(e,t,n){var r=i()(e),a=e.columns.findIndex((function(e){return e.key===t})),s=e.columns[a],l=(0,o.A)((0,o.A)({},s),{},{width:n});r.columns[a]=l;var c=e.allColumns.findIndex((function(e){return e.key===t}));return r.allColumns[c]=(0,o.A)((0,o.A)({},e.columns[a]),{},{width:n}),y(r.columns,r.allColumns)},A=function(e,t){switch(e){case s.L2D.CTIME:case s.L2D.FILE_CTIME:return(0,c.AP)("Created time");case s.L2D.MTIME:case s.L2D.FILE_MTIME:return(0,c.AP)("Last modified time");case s.L2D.CREATOR:case s.L2D.FILE_CREATOR:return(0,c.AP)("Creator");case s.L2D.LAST_MODIFIER:case s.L2D.FILE_MODIFIER:return(0,c.AP)("Last modifier");case s.L2D.IS_DIR:return"";case s.L2D.PARENT_DIR:return(0,c.AP)("Parent folder");case s.L2D.FILE_NAME:return(0,c.AP)("File name");case s.L2D.FILE_TYPE:return(0,c.AP)("File type");case s.L2D.FILE_COLLABORATORS:return(0,c.AP)("Document collaborators");case s.L2D.FILE_EXPIRE_TIME:return(0,c.AP)("File expire time");case s.L2D.FILE_KEYWORDS:return(0,c.AP)("Document keywords");case s.L2D.FILE_DESCRIPTION:return(0,c.AP)("Description");case s.L2D.FILE_EXPIRED:return(0,c.AP)("Is expired");case s.L2D.FILE_STATUS:return(0,c.AP)("File status");case s.L2D.LOCATION:return(0,c.AP)("Image location");case s.L2D.SIZE:return(0,c.AP)("Size");case s.L2D.FILE_DETAILS:return(0,c.AP)("File details");default:return t}},x=function(e){var t=e.key,n=e.name;return s.Ajs.includes(t)?t:n},b=function(e,t){switch(e){case s.L2D.CTIME:case s.L2D.FILE_CTIME:return s.vZe.CTIME;case s.L2D.MTIME:case s.L2D.FILE_MTIME:return s.vZe.MTIME;case s.L2D.CREATOR:case s.L2D.FILE_CREATOR:return s.vZe.CREATOR;case s.L2D.LAST_MODIFIER:case s.L2D.FILE_MODIFIER:return s.vZe.LAST_MODIFIER;case s.L2D.FILE_NAME:return s.vZe.FILE_NAME;case s.L2D.IS_DIR:return s.vZe.CHECKBOX;case s.L2D.FILE_COLLABORATORS:return s.vZe.COLLABORATOR;case s.L2D.FILE_EXPIRE_TIME:return s.vZe.DATE;case s.L2D.FILE_KEYWORDS:return s.vZe.TEXT;case s.L2D.FILE_DESCRIPTION:return s.vZe.LONG_TEXT;case s.L2D.FILE_EXPIRED:return s.vZe.CHECKBOX;case s.L2D.FILE_STATUS:return s.vZe.SINGLE_SELECT;case s.L2D.LOCATION:return s.vZe.GEOLOCATION;default:return t}},_=function(){return[{id:"_in_progress",name:"_in_progress"},{id:"_in_review",name:"_in_review"},{id:"_done",name:"_done"}]},w=function(e){var t=e.key,n=e.data;if(s.Ajs.includes(t)){if(t===s.L2D.FILE_TYPE)return function(e){var t=e.data,n={_picture:{name:(0,c.AP)("Picture"),color:"#FFFCB5",textColor:"#202428"},_document:{name:(0,c.AP)("Document"),color:"#B7CEF9",textColor:"#202428"},_video:{name:(0,c.AP)("Video"),color:"#9860E5",textColor:"#FFFFFF",borderColor:"#844BD2"},_audio:{name:(0,c.AP)("Audio"),color:"#FBD44A",textColor:"#FFFFFF",borderColor:"#E5C142"},_code:{name:(0,c.AP)("Code"),color:"#4ad8fb",textColor:"#FFFFFF",borderColor:"#4283e5"}},r=(0,o.A)({},t);return r.options=Array.isArray(t.options)?t.options.map((function(e){return(0,o.A)((0,o.A)({},e),n[e.id])})):[],r}(e);if(t===s.L2D.FILE_STATUS)return function(e){var t=e.data,n=(0,o.A)({},t),r={_in_progress:{name:(0,c.AP)("In progress"),color:"#EED5FF",textColor:"#202428"},_in_review:{name:(0,c.AP)("In review"),color:"#FFFDCF",textColor:"#202428"},_done:{name:(0,c.AP)("Done"),color:"#59CB74",textColor:"#FFFFFF",borderColor:"#844BD2"}};return n.options=Array.isArray(null===t||void 0===t?void 0:t.options)?t.options.map((function(e){return(0,o.A)((0,o.A)({},e),r[e.id])})):[],n}(e);if(t===s.L2D.SIZE)return function(e){return(0,o.A)((0,o.A)({},e.data),{},{format:"byte"})}(e)}return e.type===s.vZe.SINGLE_SELECT?(0,o.A)((0,o.A)({},n),{},{options:(null===n||void 0===n?void 0:n.options)||[]}):e.type===s.vZe.DATE?(0,o.A)((0,o.A)({},n),{},{format:(null===n||void 0===n?void 0:n.format)||s.D23}):n},S=function(e){if(!Array.isArray(e)||0===e.length)return[];var t=window.sfMetadataContext.localStorage.getItem("columns_width")||{},n=e.map((function(e){var n=e.type,a=e.key,i=(0,r.A)(e,u),s=b(a,n);return(0,o.A)((0,o.A)({},i),{},{key:a,type:s,width:t[a]||200})})).filter((function(e){return!s.Tuj.includes(e.key)})),a=[];return n.forEach((function(e){if("_name"===e.key)a.unshift(e);else if(e.key===s.L2D.PARENT_DIR){var t=a.findIndex((function(e){return e.key===s.L2D.PARENT_DIR}));-1===t?a.unshift(e):a.splice(t,0,e)}else a.push(e)})),a};function D(e,t,n){return!!e&&(!1!==window.sfMetadataContext.canModifyColumn(e)&&(null!=e.editable&&"function"===typeof e.editable?!0===n&&e.editable(t):!0===n&&!!e.editable))}},42996:function(e,t,n){"use strict";var r=n(64467),o=n(73575),a=o.aG.FRAGMENT,i=o.aG.HTML,s=o.aG.TEXT;function l(e,t){return e.types&&e.types.length?e.getData(t):t===s&&e.getData("Text")||null}function c(e){var t=(e?e.replace(/\r/g,""):"").split("\n"),n=t[0].split("\t").map((function(e,t){return{key:"col".concat(t),type:"text"}})),r=[];return t.forEach((function(e){var t={};e&&(e=e.split("\t")).forEach((function(e,n){t["col".concat(n)]=e})),r.push(t)})),{copiedRecords:r,copiedColumns:n}}t.A=function(e){var t=e.dataTransfer||e.clipboardData,n=l(t,a),u=l(t,i),d=l(t,s),p=function(e){var t;try{e.items&&e.items.length?t=Array.from(e.items).map((function(e){return"file"===e.kind?e.getAsFile():null})).filter((function(e){return e})):e.files&&e.files.length&&(t=Array.from(e.files))}catch(n){e.files&&e.files.length&&(t=Array.from(e.files))}return t}(t);if(n)return(0,r.default)((0,r.default)({},o.aG.DTABLE_FRAGMENT,JSON.parse(n)),"type",o.aG.DTABLE_FRAGMENT);if(u){var f=(new DOMParser).parseFromString(u,i).querySelector("table");return f?(0,r.default)((0,r.default)((0,r.default)((0,r.default)({},o.aG.DTABLE_FRAGMENT,function(e){var t=e.querySelectorAll("tr"),n=t[0].querySelectorAll("td"),r=[],o=[];return n.forEach((function(e,t){r.push({key:"col".concat(t),type:"text"})})),t.forEach((function(e){var t={};e.querySelectorAll("td").forEach((function(e,n){t["col".concat(n)]=e.innerText})),o.push(t)})),{copiedRecords:o,copiedColumns:r}}(f)),"html",u),"text",d),"type","html"):(0,r.default)((0,r.default)((0,r.default)((0,r.default)({},o.aG.DTABLE_FRAGMENT,c(d)),"html",u),"text",d),"type","html")}return p&&p.length?(0,r.default)((0,r.default)((0,r.default)({},o.aG.DTABLE_FRAGMENT,c(d)),"files",p),"type","files"):d?(0,r.default)((0,r.default)((0,r.default)({},o.aG.DTABLE_FRAGMENT,c(d)),"text",d),"type","text"):void 0}},58419:function(e,t,n){"use strict";n.d(t,{AP:function(){return r.AP},B$:function(){return i},Fr:function(){return a},SW:function(){return s},eP:function(){return l},wD:function(){return o},yD:function(){return u},zR:function(){return c}});n(42996);var r=n(40326),o=function(e){return e&&e.target&&e.target.getAttribute("class")||""},a="undefined"!==typeof window&&(window.innerWidth<768||null!=navigator.userAgent.toLowerCase().match(/(ipod|ipad|iphone|android|coolpad|mmp|smartphone|midp|wap|xoom|symbian|j2me|blackberry|wince)/i)),i=function(e,t){return e.split(" ").indexOf(t)>-1?e:e+" "+t},s=function(e,t){var n=e.split(" "),r=n.indexOf(t);return r<0?e:(n.splice(r,1),n.join(" "))},l=function(){return/windows|win32/i.test(navigator.userAgent)},c=function(){return navigator.userAgent.toLowerCase().includes("webkit")},u=function(e){return"string"===typeof e?e.trim():""}},51528:function(e,t,n){"use strict";var r=n(89379),o=n(23029),a=n(92901),i=function(){return(0,a.A)((function e(){(0,o.A)(this,e)}),null,[{key:"getDataType",value:function(e){var t=typeof e;return"object"!==t?t:Object.prototype.toString.call(e).replace(/^\[object (\S+)\]$/,"$1")}},{key:"iterable",value:function(e){return["Object","Array"].includes(this.getDataType(e))}},{key:"isObjectChanged",value:function(e,t){var n=this;if(!this.iterable(e))throw new Error("source should be a Object or Array , but got ".concat(this.getDataType(e)));if(this.getDataType(e)!==this.getDataType(t))return!0;var o=Object.keys(e),a=Object.keys((0,r.A)((0,r.A)({},e),t));return o.length!==a.length||a.some((function(r){return n.iterable(e[r])?n.isObjectChanged(e[r],t[r]):e[r]!==t[r]}))}},{key:"isSameObject",value:function(e,t){return!e&&!t||!(!e||!t)&&!this.isObjectChanged(e,t)}}])}();t.A=i},35975:function(e,t,n){"use strict";n.d(t,{r:function(){return a}});var r=n(34807),o=n(51511),a=function(e,t){var n=function(e){for(var t=r.G.slice(12,24),n=t[Math.floor(Math.random()*t.length)],o=e.slice(-11),a=function(e){return e.color===n.COLOR},i=o.find(a);i;)n=t[Math.floor(Math.random()*t.length)],i=o.find(a);return n}(e),a={name:t,color:n.COLOR,textColor:n.TEXT_COLOR,borderColor:n.BORDER_COLOR};return a.id=(0,o.Cl)(e),a}},76154:function(e,t,n){"use strict";var r=n(23029),o=n(92901),a=n(58801),i=n(26910),s=n(85520),l=n.n(s),c=n(40326),u=function(){return(0,o.A)((function e(){(0,r.A)(this,e)}),[{key:"init",value:function(e){var t=e.server,n=e.username,r=e.password,o=e.token;return this.server=t,this.username=n,this.password=r,this.token=o,this.token&&this.server&&(this.req=i.A.create({baseURL:this.server,headers:{Authorization:"Token "+this.token}})),this}},{key:"initForSeahubUsage",value:function(e){var t=e.siteRoot,n=e.xcsrfHeaders;if(t&&"/"===t.charAt(t.length-1)){var r=t.substring(0,t.length-1);this.server=r}else this.server=t;return this.req=i.A.create({headers:{"X-CSRFToken":n}}),this}},{key:"_sendPostRequest",value:function(e,t){return t.getHeaders?this.req.post(e,t,{headers:t.getHeaders()}):this.req.post(e,t)}},{key:"listWikiDepartments",value:function(){var e=this.server+"/api/v2.1/departments/";return this.req.get(e,{params:{can_admin:!0}})}},{key:"listWikiDir",value:function(e,t,n){var r=encodeURIComponent(t),o=this.server+"/api/v2.1/wikis/"+e+"/dir/?p="+r;return n&&(o=this.server+"/api/v2.1/wikis/"+e+"/dir/?p="+r+"&with_parents="+n),this.req.get(o)}},{key:"getWikiFileContent",value:function(e,t){var n=encodeURIComponent(t),r=(new Date).getTime(),o=this.server+"/api/v2.1/wikis/"+e+"/content/?p="+n+"&_="+r;return this.req.get(o)}},{key:"listWikis",value:function(e){var t=this.server+"/api/v2.1/wikis/";return e?this.req.get(t,{params:e,paramsSerializer:{serialize:function(e){var t=[];for(var n in e)if(Array.isArray(e[n]))for(var r=0,o=e[n].length;r<o;r++)t.push(n+"="+encodeURIComponent(e[n][r]));else t.push(n+"="+encodeURIComponent(e[n]));return t.join("&")}}}):this.req.get(t)}},{key:"addWiki",value:function(e){var t=this.server+"/api/v2.1/wikis/",n=new(l());return n.append("name",e),this._sendPostRequest(t,n)}},{key:"renameWiki",value:function(e,t){var n=this.server+"/api/v2.1/wikis/"+e+"/",r=new(l());return r.append("wiki_name",t),this._sendPostRequest(n,r)}},{key:"deleteWiki",value:function(e){var t=this.server+"/api/v2.1/wikis/"+e+"/";return this.req.delete(t)}},{key:"listWikis2",value:function(e){var t=this.server+"/api/v2.1/wikis2/";return e?this.req.get(t,{params:e,paramsSerializer:{serialize:function(e){var t=[];for(var n in e)if(Array.isArray(e[n]))for(var r=0,o=e[n].length;r<o;r++)t.push(n+"="+encodeURIComponent(e[n][r]));else t.push(n+"="+encodeURIComponent(e[n]));return t.join("&")}}}):this.req.get(t)}},{key:"addWiki2",value:function(e,t){var n=this.server+"/api/v2.1/wikis2/",r=new(l());return r.append("name",e),t&&r.append("owner",t),this._sendPostRequest(n,r)}},{key:"deleteWiki2",value:function(e){var t=this.server+"/api/v2.1/wiki2/"+e+"/";return this.req.delete(t)}},{key:"updateWiki2Config",value:function(e,t){var n=this.server+"/api/v2.1/wiki2/"+e+"/config/",r={wiki_config:t};return this.req.put(n,r)}},{key:"getWiki2Config",value:function(e){var t=this.server+"/api/v2.1/wiki2/"+e+"/config/";return this.req.get(t)}},{key:"getWiki2PublishConfig",value:function(e){var t=this.server+"/api/v2.1/wiki2/"+e+"/publish/config/";return this.req.get(t)}},{key:"createWiki2Page",value:function(e,t,n){var r=this.server+"/api/v2.1/wiki2/"+e+"/pages/",o=new(l());return o.append("page_name",t),n&&o.append("current_id",n),this._sendPostRequest(r,o)}},{key:"deleteWiki2Page",value:function(e,t){var n=this.server+"/api/v2.1/wiki2/"+e+"/page/"+t+"/";return this.req.delete(n)}},{key:"moveWiki2Page",value:function(e,t,n,r){var o=this.server+"/api/v2.1/wiki2/"+e+"/pages/",a={moved_id:t,target_id:n,move_position:r};return this.req.put(o,a)}},{key:"deleteWiki2Folder",value:function(e,t){var n=this.server+"/api/v2.1/wiki2/"+e+"/folder/"+t+"/";return this.req.delete(n)}},{key:"getWiki2Page",value:function(e,t){var n=this.server+"/api/v2.1/wiki2/"+e+"/page/"+t+"/";return this.req.get(n)}},{key:"getWiki2PublishPage",value:function(e,t){var n=this.server+"/api/v2.1/wiki2/"+e+"/publish/page/"+t+"/";return this.req.get(n)}},{key:"renameWiki2",value:function(e,t){var n=this.server+"/api/v2.1/wiki2/"+e+"/",r={wiki_name:t};return this.req.put(n,r)}},{key:"duplicateWiki2Page",value:function(e,t){var n=this.server+"/api/v2.1/wiki2/"+e+"/duplicate-page/",r=new(l());return r.append("page_id",t),this._sendPostRequest(n,r)}},{key:"getWikiTrash",value:function(e,t,n){var r=this.server+"/api/v2.1/wiki2/"+e+"/trash/",o={page:t||1,per_page:n};return this.req.get(r,{params:o})}},{key:"revertTrashPage",value:function(e,t){var n=this.server+"/api/v2.1/wiki2/"+e+"/trash/",r={page_id:t};return this.req.put(n,r)}},{key:"cleanWikiTrash",value:function(e,t){var n=this.server+"/api/v2.1/wiki2/"+e+"/trash/",r={keep_days:t};return this.req.delete(n,{data:r})}},{key:"publishWiki",value:function(e,t){var n=this.server+"/api/v2.1/wiki2/"+e+"/publish/",r=new(l());return r.append("publish_url",t),this._sendPostRequest(n,r)}},{key:"getPublishWikiLink",value:function(e){var t=this.server+"/api/v2.1/wiki2/"+e+"/publish/";return this.req.get(t)}},{key:"deletePublishWikiLink",value:function(e,t){var n=this.server+"/api/v2.1/wiki2/"+e+"/publish/";return this.req.delete(n)}}])}(),d=new u,p=a.Ay.load("sfcsrftoken");d.initForSeahubUsage({siteRoot:c.Yc,xcsrfHeaders:p}),t.A=d},58814:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default,l=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(9950)),u=s(n(17119)),d=s(n(82894)),p=s(n(39739)),f=n(66327),h=s(n(44956)),m=n(56265);n(43195),n(92356),n(92305),n(63138);var g=(0,h.default)(),v=function(e){function t(e){var n;return r(this,t),(n=a(this,t,[e])).onChange=function(e){e&&(n.setState({value:e}),(0,m.isFunction)(n.props.onChange)&&n.props.onChange(e.format(n.valueSubmitFormat)))},n.getValue=function(){var e=n.state.value;return e?e.format(n.valueSubmitFormat):null},n.getInputNode=function(){var e=u.default.findDOMNode(n);return"INPUT"===e.tagName?e:e.querySelector("input:not([type=hidden])")},n.onOpenChange=function(e){n.setState({open:e},(function(){e||n.props.onClose&&n.props.onClose()}))},n.onReadOnlyFocus=function(){n.setState({open:!0})},n.onBlur=function(e){n.props.onBlur&&n.props.onBlur(e)},n.closeEditor=function(){n.setState({open:!1}),n.onBlur()},n.getCalendarContainer=function(){return document.body},n.handleMouseDown=function(e){e.preventDefault()},n.handleKeyDown=function(e){[37,38,39,40].includes(e.keyCode)?e.stopPropagation():13===e.keyCode&&(e.preventDefault(),n.onBlur("enter"))},n.onClick=function(e){e.stopPropagation();var t=(0,m.getEventClassName)(e);n.showHourAndMinute||"rc-calendar-date"!==t||(n.timer=setTimeout((function(){n.closeEditor()}),1)),n.showHourAndMinute&&"rc-calendar-date"===t&&n.setState({open:!0})},n.onClear=function(){(0,m.isFunction)(n.props.onClear)?n.props.onClear():n.setState({value:null},(function(){n.setState({open:!0})}))},n.onHotKey=function(e){27===e.keyCode&&(e.stopPropagation(),n.props.onClose&&n.props.onClose())},n.getCalendarFormat=function(){if(n.format.indexOf("YYYY-MM-DD")>-1){var e=n.format.replace("YYYY-MM-DD","YYYY-M-D");return[n.format,e]}if(n.format.indexOf("DD/MM/YYYY")>-1){var t=n.format.replace("DD/MM/YYYY","D/M/YYYY");return[n.format,t]}return[n.format]},n.getDefaultMinutesTime=function(){var e=n.props.value;return e?(0,h.default)(e).format("HH:mm"):""},n.onClickRightPanelTime=function(){setTimeout((function(){n.closeEditor()}),1)},n.state={value:null,open:!0},n.format=e.format||"YYYY-MM-DD",n.calendarContainerRef=c.default.createRef(),n.defaultCalendarValue=null,n.showHourAndMinute=n.format.indexOf("HH:mm")>-1,n.valueSubmitFormat=n.showHourAndMinute?"YYYY-MM-DD HH:mm":"YYYY-MM-DD",n}return i(t,e),o(t,[{key:"componentDidMount",value:function(){var e="zh-cn"===this.props.lang;g=e?g.locale("zh-cn"):g.locale("en-gb"),this.defaultCalendarValue=g.clone();var t=this.props.value;if(t&&(0,h.default)(t).isValid()){if("string"===typeof t&&1===t.length&&!isNaN(Number(t,10)))return void(this.timer=setTimeout((function(){var e=document.getElementsByClassName("rc-calendar-input")[0];e&&(e.value=t)}),200));var n=(0,h.default)(t).isValid()?(0,h.default)(t):(0,h.default)(this.defaultCalendarValue);this.setState({value:e?(0,h.default)(n).locale("zh-cn"):(0,h.default)(n).locale("en-gb")})}document.addEventListener("keydown",this.onHotKey,!0)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.onHotKey,!0),this.timer&&(clearTimeout(this.timer),this.timer=null)}},{key:"render",value:function(){var e=this,t=this.props,n=t.isReadOnly,r=t.lang,o=this.state;if(n)return c.default.createElement("input",{className:"ant-calendar-picker-input ant-input form-control",value:o.value?o.value.format(this.format):"",disabled:!0});var a=this.getCalendarFormat(),i=this.getDefaultMinutesTime(),s=c.default.createElement(d.default,{className:"sf-metadata-rc-calendar",locale:(0,f.translateCalendar)(r),style:{zIndex:1001},dateInputPlaceholder:(0,m.gettext)("Enter date"),format:a,defaultValue:this.defaultCalendarValue,showDateInput:!0,focusablePanel:!1,showHourAndMinute:this.showHourAndMinute,onClear:this.onClear,onClickRightPanelTime:this.onClickRightPanelTime,defaultMinutesTime:i});return c.default.createElement("div",{className:"date-picker-container",onKeyDown:function(t){return e.handleKeyDown(t)},onClick:function(t){return e.onClick(t)}},c.default.createElement(p.default,{calendar:s,value:o.value,onChange:this.onChange,getCalendarContainer:this.getCalendarContainer,onOpenChange:this.onOpenChange,open:o.open,style:{zIndex:1001}},(function(t){var n=t.value;return c.default.createElement("span",{tabIndex:"0",onFocus:e.onReadOnlyFocus},c.default.createElement("input",{placeholder:e.format?e.format:(0,m.gettext)("Please select"),tabIndex:"-1",readOnly:!0,className:"ant-calendar-picker-input ant-input form-control",value:n?n.format(e.format):"",onMouseDown:e.handleMouseDown}),c.default.createElement("div",{ref:e.calendarContainerRef}))})))}}])}(c.Component);v.defaultProps={format:"YYYY-MM-DD",lang:"zh-cn",isReadOnly:!1};t.default=v},97157:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default,l=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(9950)),u=s(n(82894)),d=s(n(39739)),p=n(66327),f=s(n(44956));n(43195),n(92356),n(92305),n(63138);var h=(0,f.default)(),m=function(e){function t(e){var n;return r(this,t),(n=a(this,t,[e])).handleMouseDown=function(e){e.preventDefault()},n.onChange=function(e){var t=n.props.onChange;n.setState({value:e},(function(){n.state.value&&t(n.state.value.format("YYYY-MM-DD"))}))},n.onClear=function(){n.setState({value:null},(function(){n.setState({open:!0})}))},n.onOpenChange=function(e){n.setState({open:e})},n.onReadOnlyFocus=function(){!n.state.open&&n.state.isMouseDown?n.setState({isMouseDown:!1}):n.setState({open:!0})},n.getCalendarContainer=function(){return n.calendarContainerRef.current},n.getCalendarFormat=function(){if(n.format.indexOf("YYYY-MM-DD")>-1){var e=n.format.replace("YYYY-MM-DD","YYYY-M-D");return[n.format,e]}if(n.format.indexOf("DD/MM/YYYY")>-1){var t=n.format.replace("DD/MM/YYYY","D/M/YYYY");return[n.format,t]}return[n.format]},n.state={open:!1,value:null},n.format=e.format.split(" ")[0],n.calendarContainerRef=c.default.createRef(),n.defaultCalendarValue=null,n}return i(t,e),o(t,[{key:"componentDidMount",value:function(){var e="zh-cn"===this.props.lang;h=e?h.locale("zh-cn"):h.locale("en-gb"),this.defaultCalendarValue=h.clone();var t=this.props.value;if(t&&(0,f.default)(t).isValid()){var n=(0,f.default)(t).isValid()?(0,f.default)(t):(0,f.default)(this.defaultCalendarValue);this.setState({value:e?(0,f.default)(n).locale("zh-cn"):(0,f.default)(n).locale("en-gb")})}}},{key:"render",value:function(){var e=this,t=this.props,n=t.isReadOnly,r=t.lang,o=t.zIndex,a=this.state;if(n)return c.default.createElement("input",{className:"ant-calendar-picker-input ant-input form-control",value:a.value?a.value.format(this.format):"",disabled:!0});var i=this.getCalendarFormat(),s=c.default.createElement(u.default,{className:"sf-metadata-rc-calendar",locale:(0,p.translateCalendar)(r),style:{zIndex:o||1001},dateInputPlaceholder:"please enter date",format:i,defaultValue:this.defaultCalendarValue,showDateInput:!0,focusablePanel:!1,onClear:this.onClear});return c.default.createElement("div",{className:"date-picker-container"},c.default.createElement(d.default,{calendar:s,value:a.value,onChange:this.onChange,getCalendarContainer:this.getCalendarContainer,onOpenChange:this.onOpenChange,open:a.open,style:{zIndex:o||1001}},(function(t){var n=t.value;return c.default.createElement("span",{tabIndex:"0",onFocus:e.onReadOnlyFocus},c.default.createElement("input",{tabIndex:"-1",readOnly:!0,className:"ant-calendar-picker-input ant-input form-control",value:n?n.format(e.format):"",onMouseDown:e.handleMouseDown}),c.default.createElement("div",{ref:e.calendarContainerRef}))})))}}])}(c.Component);m.defaultProps={format:"YYYY-MM-DD",lang:"zh-cn",isReadOnly:!1};t.default=m},49046:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"SfCalendar",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"SfFilterCalendar",{enumerable:!0,get:function(){return a.default}});var o=r(n(58814)),a=r(n(97157))},66327:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.translateCalendar=function(e){var t;switch(e||"en"){case"zh-cn":t=r;break;case"zh-tw":t=o;break;case"en":default:t=a;break;case"fr":t=i;break;case"de":t=s;break;case"es":case"es-ar":case"es-mx":t=l;break;case"pl":t=c;break;case"cs":t=u;break;case"ru":t=d}return t};var r=n(95502),o=n(33850),a=n(37932),i=n(88309),s=n(10507),l=n(1205),c=n(16969),u=n(19550),d=n(36967)},13677:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(9950)),a=r(n(86615)),i=r(n(26984));n(41939);t.default=function(e){return o.default.createElement("div",{className:(0,a.default)("sf-metadata-centered-loading",e.className)},o.default.createElement(i.default,null))}},92178:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(n(9950)),c=function(e){function t(){var e;return r(this,t),(e=a(this,t,arguments)).isClickedInside=!1,e.handleDocumentClick=function(t){e.isClickedInside?e.isClickedInside=!1:e.props.onClickOutside(t)},e.handleMouseDown=function(){e.isClickedInside=!0},e}return i(t,e),o(t,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.handleDocumentClick)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.handleDocumentClick)}},{key:"render",value:function(){return l.default.cloneElement(l.default.Children.only(this.props.children),{onMouseDownCapture:this.handleMouseDown})}}])}(l.default.Component);t.default=c},57425:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"CellType",{enumerable:!0,get:function(){return o.default}}),t.GEOLOCATION_FORMAT=t.DELETED_OPTION_TIPS=t.DELETED_OPTION_BACKGROUND_COLOR=t.DEFAULT_NUMBER_FORMAT=void 0;var o=r(n(54965));t.GEOLOCATION_FORMAT={LNG_LAT:"lng_lat",COUNTRY_REGION:"country_region",PROVINCE:"province",PROVINCE_CITY:"province_city",PROVINCE_CITY_DISTRICT:"province_city_district",MAP_SELECTION:"map_selection"},t.DEFAULT_NUMBER_FORMAT="number",t.DELETED_OPTION_BACKGROUND_COLOR="#eaeaea",t.DELETED_OPTION_TIPS="Deleted_option"},54965:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={DEFAULT:"default",TEXT:"text",CREATOR:"creator",CTIME:"ctime",LAST_MODIFIER:"last-modifier",MTIME:"mtime",FILE_NAME:"file-name",CHECKBOX:"checkbox",COLLABORATOR:"collaborator",DATE:"date",LONG_TEXT:"long-text",SINGLE_SELECT:"single-select",MULTIPLE_SELECT:"multiple-select",NUMBER:"number",GEOLOCATION:"geolocation",RATE:"rate"}},18142:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(9950)),a=r(n(35349));n(70238);t.default=function(e){var t=e.callBack,n=e.footerName,r=e.className,i=e.addIconClassName,s=e.hideIcon,l=e.style;return o.default.createElement("div",{className:"sf-metadata-ui add-item-btn ".concat(r||""),style:l,onClick:function(e){t(e)}},!s&&o.default.createElement(a.default,{iconName:"add-table",className:i}),o.default.createElement("span",{className:"text-truncate"},n))}},55859:function(e,t,n){"use strict";var r=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(9950)),a=n(48843),i=n(56265),s=function(e){var t=e.target,n=e.innerClassName,r=e.className,s=e.hideArrow,l=e.modifiers,c=e.placement,u=e.canHide,d=e.hide,p=e.hideWithEsc,f=e.children,h=(0,o.useRef)(null),m=(0,o.useCallback)((function(e){u&&h.current&&e&&-1===(0,i.getEventClassName)(e).indexOf("popover")&&!h.current.contains(e.target)&&d(e)}),[u,d]),g=(0,o.useCallback)((function(e){if(27===e.keyCode&&"function"===typeof p)e.preventDefault(),p();else if(13===e.keyCode){if(u)return;e.stopImmediatePropagation()}}),[u,p]),v=(0,o.useCallback)((function(e){e.preventDefault(),d(e)}),[d]),y=(0,o.useCallback)((function(e){e.stopPropagation()}),[]);return(0,o.useEffect)((function(){return document.addEventListener("click",m),document.addEventListener("keydown",g),window.addEventListener("popstate",v),function(){document.removeEventListener("click",m),document.removeEventListener("keydown",g),window.removeEventListener("popstate",v)}}),[m,g,v]),o.default.createElement(a.Popover,{placement:c,isOpen:!0,target:t,fade:!1,hideArrow:s,innerClassName:n,className:r,modifiers:l},o.default.createElement("div",{ref:h,onClick:y},f))};s.defaultProps={placement:"bottom-start",hideArrow:!0,canHide:!0};t.default=s},71082:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default,l=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(9950)),u=s(n(86615)),d=s(n(35349)),p=s(n(20536)),f=s(n(90665)),h=n(56265);n(86954);var m=function(e){function t(e){var n;return r(this,t),(n=a(this,t,[e])).onSelectToggle=function(e){e.preventDefault(),n.state.isShowSelectOptions&&e.stopPropagation();var t=(0,h.getEventClassName)(e);n.props.readOnly||t.indexOf("option-search-control")>-1||"sf-metadata-option-group-search"===t||""!==e.target.value&&n.setState({isShowSelectOptions:!n.state.isShowSelectOptions})},n.onClick=function(e){n.props.isShowSelected&&e.target.className.includes("icon-fork-number")||n.selector.contains(e.target)||n.closeSelect()},n.closeSelect=function(){n.setState({isShowSelectOptions:!1})},n.getSelectedOptionTop=function(){return n.selector?n.selector.getBoundingClientRect().height:38},n.getFilterOptions=function(e){var t=n.props,r=t.options;if(!t.searchable)return r||[];var o=e.trim().toLowerCase();return o?r.filter((function(e){var t=e.value,n=e.name;return"string"===typeof n?n.toLowerCase().indexOf(o)>-1:"object"===typeof t&&(t.column?t.column.name.toLowerCase().indexOf(o)>-1:t.name?t.name.toLowerCase().indexOf(o)>-1:t.columnOption&&t.columnOption.name.toLowerCase().indexOf(o)>-1)})):r||[]},n.renderDropDownIcon=function(){var e=n.props,t=e.readOnly,r=e.component;if(!t){var o=(r||{}).DropDownIcon;return o?c.default.createElement("div",{className:"custom-select-dropdown-icon"},o):c.default.createElement(d.default,{iconName:"drop-down"})}},n.state={isShowSelectOptions:!1},n}return i(t,e),o(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.className,r=t.value,o=t.options,a=t.placeholder,i=t.searchable,s=t.searchPlaceholder,l=t.noOptionsPlaceholder,d=t.readOnly,h=t.isInModal,m=t.addOptionAble,g=t.component;return c.default.createElement("div",{ref:function(t){return e.selector=t},className:(0,u.default)("sf-metadata-select custom-select",{focus:this.state.isShowSelectOptions},{disabled:d},n),onClick:this.onSelectToggle},c.default.createElement("div",{className:"selected-option"},r&&r.label?c.default.createElement("span",{className:"selected-option-show"},r.label):c.default.createElement("span",{className:"select-placeholder"},a),this.renderDropDownIcon()),this.state.isShowSelectOptions&&!h&&c.default.createElement(p.default,{value:r,addOptionAble:m,component:g,isShowSelected:this.props.isShowSelected,top:this.getSelectedOptionTop(),options:o,onSelectOption:this.props.onSelectOption,searchable:i,searchPlaceholder:s,noOptionsPlaceholder:l,onClickOutside:this.onClick,closeSelect:this.closeSelect,getFilterOptions:this.getFilterOptions,supportMultipleSelect:this.props.supportMultipleSelect}),this.state.isShowSelectOptions&&h&&c.default.createElement(f.default,null,c.default.createElement(p.default,{className:n,value:r,addOptionAble:m,component:g,isShowSelected:this.props.isShowSelected,position:this.selector.getBoundingClientRect(),isInModal:h,top:this.getSelectedOptionTop(),options:o,onSelectOption:this.props.onSelectOption,searchable:i,searchPlaceholder:s,noOptionsPlaceholder:l,onClickOutside:this.onClick,closeSelect:this.closeSelect,getFilterOptions:this.getFilterOptions,supportMultipleSelect:this.props.supportMultipleSelect})))}}])}(c.Component);t.default=m},62088:function(e,t,n){"use strict";var r=n(85715).default,o=n(24994).default,a=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(9950)),s=n(56265),l=o(n(783));t.default=function(e){var t=e.value,n=e.mediaUrl,o=e.api,a=e.collaborators,c=e.collaboratorsCache,u=e.updateCollaboratorsCache,d=(0,i.useState)(null),p=r(d,2),f=p[0],h=p[1];return(0,i.useEffect)((function(){var e=!0;if(!t)return e&&h(null),function(){return e=!1};var r=a&&a.find((function(e){return e.email===t}));if(r)return e&&h(r),function(){return e=!1};var i="".concat(n,"/avatars/default.png");return"anonymous"===t?(r={name:"anonymous",avatar_url:i},e&&h(r),function(){return e=!1}):(r=c[t])?(e&&h(r),function(){return e=!1}):(0,s.isValidEmail)(t)?(o&&o(t,(function(n){r=n[t],u(r),e&&h(r)})),function(){return e=!1}):(u(r={email:t,name:t,avatar_url:i}),e&&h(r),function(){return e=!1})}),[]),f?i.default.createElement(l.default,{collaborator:f}):null}},25217:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(9950)),a=r(n(86615)),i=r(n(35349));n(95399);t.default=function(e){var t=e.value,n=e.className,r=e.children;return t?o.default.createElement("div",{className:(0,a.default)("sf-metadata-ui cell-formatter-container checkbox-formatter",n)},o.default.createElement(i.default,{iconName:"check-mark"})):r}},783:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(9950)),a=r(n(35349));n(41341);t.default=function(e){var t=e.enableDelete,n=void 0!==t&&t,r=e.collaborator,i=e.onDelete;return r?o.default.createElement("div",{className:"sf-metadata-ui collaborator-item"},o.default.createElement("span",{className:"collaborator-avatar"},o.default.createElement("img",{className:"collaborator-avatar-icon",alt:r.name,src:r.avatar_url})),o.default.createElement("span",{className:"collaborator-name"},r.name),n&&o.default.createElement("span",{className:"collaborator-remove",onClick:i},o.default.createElement(a.default,{iconName:"delete"}))):null}},80199:function(e,t,n){"use strict";var r=n(91847).default,o=["value","className","children"],a=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(9950)),s=a(n(86615)),l=a(n(62088));n(91173);t.default=function(e){var t=e.value,n=e.className,a=e.children,c=r(e,o);return Array.isArray(t)&&0!==t.length?0===t.filter((function(e){return e})).length?a||null:i.default.createElement("div",{className:(0,s.default)("sf-metadata-ui cell-formatter-container collaborators-formatter",n)},t.map((function(e){return i.default.createElement(l.default,Object.assign({key:e},c,{value:e}))}))):a||null}},44314:function(e,t,n){"use strict";var r=n(85715).default,o=n(24994).default,a=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(9950)),s=o(n(86615)),l=n(56265),c=o(n(783));t.default=function(e){var t=e.value,n=e.mediaUrl,o=e.className,a=e.api,u=e.collaborators,d=void 0===u?[]:u,p=e.collaboratorsCache,f=void 0===p?{}:p,h=e.updateCollaboratorsCache,m=e.children,g=(0,i.useState)(null),v=r(g,2),y=v[0],C=v[1];return(0,i.useEffect)((function(){var e=!0;if(!t)return e&&C(null),function(){return e=!1};var r=d&&d.find((function(e){return e.email===t}));if(r)return e&&C(r),function(){return e=!1};var o="".concat(n,"/avatars/default.png");return"anonymous"===t?(r={name:"anonymous",avatar_url:o},e&&C(r),function(){return e=!1}):(r=f[t])?(e&&C(r),function(){return e=!1}):(0,l.isValidEmail)(t)?(a&&a(t,(function(n){r=n[t],Object.values(n).forEach((function(e){h&&h(e)})),e&&C(r)})),function(){return e=!1}):(r={email:t,name:t,avatar_url:o},h&&h(r),e&&C(r),function(){return e=!1})}),[]),y?i.default.createElement("div",{className:(0,s.default)("sf-metadata-ui cell-formatter-container creator-formatter",o)},i.default.createElement(c.default,{collaborator:y})):m||null}},70794:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(9950)),a=r(n(86615)),i=r(n(84583));t.default=function(e){var t=e.value,n=e.className,r=e.children;if(!t)return r||null;var s=(0,i.default)(t).format("YYYY-MM-DD HH:mm:ss");return o.default.createElement("div",{className:(0,a.default)("sf-metadata-ui cell-formatter-container ctime-formatter",n)},s)}},96388:function(e,t,n){"use strict";var r=n(24994).default,o=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(9950)),i=r(n(86615)),s=n(39856);n(35816);t.default=function(e){var t=e.value,n=e.format,r=e.className,o=e.children,l=(0,a.useMemo)((function(){return(0,s.getDateDisplayString)(t,n)}),[t,n]);return l?a.default.createElement("div",{className:(0,i.default)("sf-metadata-ui cell-formatter-container date-formatter",r)},l):o||null}},39276:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(9950));t.default=function(e){var t=e.fieldType,n=e.placeholder;return o.default.createElement("span",{className:"sf-metadata-record-cell-empty sf-metadata-record-".concat(t,"-cell-empty"),placeholder:n})}},78003:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(9950)),a=r(n(86615));n(22257);t.default=function(e){var t=e.value,n=e.isDir,r=e.className,i=e.children,s=e.getFolderIconUrl,l=e.getFileIconUrl;return t?o.default.createElement("div",{className:(0,a.default)("sf-metadata-ui cell-formatter-container file-name-formatter",r)},o.default.createElement("img",{className:"sf-metadata-file-icon",src:n?s():l(t),height:"24",alt:""}),o.default.createElement("span",{className:"sf-metadata-file-name"},t)):i||null}},57399:function(e,t,n){"use strict";var r=n(91847).default,o=["field","value","isSample","queryUserAPI","emptyTip"],a=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(9950)),s=n(57425),l=a(n(12863)),c=a(n(44314)),u=a(n(70794)),d=a(n(39276)),p=a(n(78003)),f=a(n(96388)),h=a(n(34041)),m=a(n(80199)),g=a(n(25217)),v=a(n(93448)),y=a(n(12532)),C=a(n(98801)),A=a(n(82717));n(16525);var x=a(n(73002));t.default=function(e){var t=e.field,n=e.value,a=(e.isSample,e.queryUserAPI),b=e.emptyTip,_=r(e,o),w=(t||{}).type,S="sf-metadata-".concat(w,"-formatter");switch(w){case s.CellType.TEXT:return i.default.createElement(l.default,{value:n,className:S},i.default.createElement(d.default,{fieldType:w,placeholder:b}));case s.CellType.CTIME:case s.CellType.MTIME:return i.default.createElement(u.default,{value:n,className:S},i.default.createElement(d.default,{fieldType:w,placeholder:b}));case s.CellType.CREATOR:case s.CellType.LAST_MODIFIER:return i.default.createElement(c.default,Object.assign({value:n,className:S,api:a},_),i.default.createElement(d.default,{fieldType:w,placeholder:b}));case s.CellType.FILE_NAME:return i.default.createElement(p.default,Object.assign({value:n,className:S},_),i.default.createElement(d.default,{fieldType:w,placeholder:b}));case s.CellType.DATE:var D;return i.default.createElement(f.default,{value:n,format:null===(D=t.data)||void 0===D?void 0:D.format,className:S},i.default.createElement(d.default,{fieldType:w,placeholder:b}));case s.CellType.SINGLE_SELECT:var E;return i.default.createElement(h.default,{value:n,options:(null===(E=t.data)||void 0===E?void 0:E.options)||[],className:S},i.default.createElement(d.default,{fieldType:w,placeholder:b}));case s.CellType.MULTIPLE_SELECT:var k;return i.default.createElement(A.default,{value:n,options:(null===(k=t.data)||void 0===k?void 0:k.options)||[],className:S},i.default.createElement(d.default,{fieldType:w,placeholder:b}));case s.CellType.COLLABORATOR:return i.default.createElement(m.default,Object.assign({value:n,className:S,api:a},_),i.default.createElement(d.default,{fieldType:w,placeholder:b}));case s.CellType.CHECKBOX:return i.default.createElement(g.default,{value:n,className:S},i.default.createElement(d.default,{fieldType:w,placeholder:b}));case s.CellType.GEOLOCATION:var M;return i.default.createElement(v.default,Object.assign({},_,{format:null===(M=t.data)||void 0===M?void 0:M.geo_format,value:n,className:S}),i.default.createElement(d.default,{fieldType:w,placeholder:b}));case s.CellType.LONG_TEXT:return i.default.createElement(y.default,Object.assign({},_,{value:n,className:S}),i.default.createElement(d.default,{fieldType:w,placeholder:b}));case s.CellType.NUMBER:return i.default.createElement(C.default,{value:n,formats:null===t||void 0===t?void 0:t.data,className:S},i.default.createElement(d.default,{fieldType:w,placeholder:b}));case s.CellType.RATE:return i.default.createElement(x.default,{value:n,data:null===t||void 0===t?void 0:t.data,className:S},i.default.createElement(d.default,{fieldType:w,placeholder:b}));default:return i.default.createElement(l.default,{value:n,className:S},i.default.createElement(d.default,{fieldType:w,placeholder:b}))}}},93448:function(e,t,n){"use strict";var r=n(24994).default,o=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(9950)),i=r(n(86615)),s=n(39856);t.default=function(e){var t=e.isBaiduMap,n=e.format,r=e.value,o=e.children,l=e.className,c=e.hyphen,u=void 0===c?" ":c,d=(0,a.useMemo)((function(){return"object"!==typeof r?null:(0,s.getGeolocationDisplayString)(r,{geo_format:n},{isBaiduMap:t,hyphen:u})}),[r,n,t,u]);return d?a.default.createElement("div",{className:(0,i.default)("sf-metadata-ui cell-formatter-container geolocation-formatter",l)},d):o||null}},50502:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"CTimeFormatter",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"CheckboxFormatter",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(t,"CollaboratorFormatter",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"CollaboratorsFormatter",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"CreatorFormatter",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"DateFormatter",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"GeolocationFormatter",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(t,"LongTextFormatter",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(t,"MultipleSelectFormatter",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(t,"NumberFormatter",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(t,"RateFormatter",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(t,"SingleSelectFormatter",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"TextFormatter",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"URLFormatter",{enumerable:!0,get:function(){return c.default}}),t.default=void 0;var o=r(n(783)),a=r(n(80199)),i=r(n(44314)),s=r(n(70794)),l=r(n(12863)),c=r(n(43007)),u=r(n(96388)),d=r(n(34041)),p=r(n(25217)),f=r(n(93448)),h=r(n(12532)),m=r(n(98801)),g=r(n(82717)),v=r(n(73002)),y=r(n(57399));n(41186);t.default=y.default},12532:function(e,t,n){"use strict";var r=n(85715).default,o=n(24994).default,a=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(9950)),s=o(n(86615)),l=n(92203),c=o(n(35349)),u=o(n(90665)),d=o(n(21724));n(60784);t.default=function(e){var t=e.value,n=e.className,o=e.previewClassName,a=e.children,p=(0,i.useState)(!1),f=r(p,2),h=f[0],m=f[1],g=(0,i.useRef)(null),v=(0,i.useRef)({}),y=(0,i.useRef)(null),C=(0,i.useRef)(null),A=(0,i.useMemo)((function(){if(!t)return null;var e=typeof t;if("object"===e)return t;if("string"===e){var n=(0,l.getPreviewContent)(t),r=n.previewText,o=n.images,a=n.links,i=n.checklist;return{text:t,preview:r,images:o,links:a,checklist:i}}return null}),[t]);(0,i.useEffect)((function(){return function(){y.current&&clearTimeout(y.current),C.current&&clearTimeout(C.current)}}),[]);var x=(0,i.useCallback)((function(){if(!A)return null;var e=A.links;return Array.isArray(e)&&0!==e.length?i.default.createElement("span",{className:"sf-metadata-long-text-links"},i.default.createElement(c.default,{iconName:"url"}),e.length):null}),[A]),b=(0,i.useCallback)((function(){if(!A)return null;var e=A.checklist;return e&&0!==e.total?i.default.createElement("span",{className:(0,s.default)("sf-metadata-long-text-check-list",{completed:e.completed===e.total})},i.default.createElement(c.default,{iconName:"check-square-solid"}),"".concat(e.completed,"/").concat(e.total)):null}),[A]),_=(0,i.useCallback)((function(){if(!A)return null;var e=A.images;return Array.isArray(e)&&0!==e.length?i.default.createElement("span",{className:"sf-metadata-long-text-images"},i.default.createElement("img",{src:e[0],alt:""}),i.default.createElement("i",{className:"sf-metadata-image-number"},e.length>1?"+"+e.length:null)):null}),[A]),w=(0,i.useCallback)((function(){return A?A.preview:null}),[A]),S=(0,i.useCallback)((function(){if(document.getElementById("modal-wrapper")&&(y.current&&clearTimeout(y.current),y.current=null,A))return h?(C.current&&clearTimeout(C.current),void(C.current=null)):void(y.current=setTimeout((function(){v.current=g.current?g.current.getBoundingClientRect():{},m(!0)}),2e3))}),[h,A,y]),D=(0,i.useCallback)((function(){y.current&&clearTimeout(y.current),y.current=null,C.current=setTimeout((function(){h&&m(!1)}),2e3)}),[h,y]),E=(0,i.useCallback)((function(){C.current&&clearTimeout(C.current),C.current=null}),[C]),k=(0,i.useCallback)((function(){h&&m(!1)}),[h]);return A?i.default.createElement("div",{className:(0,s.default)("sf-metadata-ui cell-formatter-container long-text-formatter",n),onMouseEnter:S,onMouseLeave:D,ref:g},x(),b(),_(),w(),h&&i.default.createElement(u.default,null,i.default.createElement(d.default,{className:o,value:A,targetStyle:v.current,onMouseEnter:E,onMouseLeave:k}))):a||null}},21724:function(e,t,n){"use strict";var r=n(85715).default,o=n(24994).default,a=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(9950)),s=o(n(86615)),l=o(n(13608));n(71188);var c=i.default.memo((function(e){var t=e.value,n=e.className,o=e.targetStyle,a=e.onMouseEnter,c=e.onMouseLeave,u=(0,i.useRef)(null),d=(0,i.useState)({height:450,opacity:0}),p=r(d,2),f=p[0],h=p[1];(0,i.useEffect)((function(){setTimeout((function(){var e;if(u.current){var n=(null===t||void 0===t||null===(e=t.images)||void 0===e?void 0:e.length)>=2,r=u.current.getBoundingClientRect().height;r=n?450:r,h({height:Math.min(r,450),opacity:1})}}),10)}),[]);var m=(0,i.useCallback)((function(e){a&&a(e)}),[a]),g=(0,i.useCallback)((function(e){c&&c(e)}),[c]),v=(0,i.useCallback)((function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()}),[]),y=(0,i.useMemo)((function(){var e=o.left,t=o.top,n=f.height,r=f.opacity;return e=e-520>0?e-520-12:0,(t-=6)+n>window.innerHeight&&(t=t-n>0?t-n:0),{left:e,top:t,opacity:r}}),[o,f]),C=t?t.text:"";return i.default.createElement("div",{className:(0,s.default)("sf-metadata-long-text-preview",n),style:y,ref:u,onMouseEnter:m,onMouseLeave:g,onClick:v},i.default.createElement("div",{className:"sf-metadata-longtext-container sf-metadata-longtext-container-scroll"},i.default.createElement(l.default,{value:C,showTOC:!1})))}));t.default=c},13608:function(e,t,n){"use strict";var r=n(24994).default,o=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(9950)),i=n(92203),s=r(n(29447)),l=a.default.memo((function(e){var t=e.value,n=e.showTOC;return(0,a.useMemo)((function(){if(!window.chrome)return!1;var e=navigator.appVersion.split(" "),t=e.findIndex((function(e){return e.indexOf("Chrome")>=0}));if(-1===t)return!1;var n=e[t];return!(53!==(n=parseInt(n.slice(n.indexOf("/")+1)))||!navigator.appVersion||!navigator.appVersion.includes("WindowsWechat"))}),[])?a.default.createElement(s.default,{value:t}):a.default.createElement(i.MarkdownViewer,{value:t,isShowOutline:n})}));t.default=l},29447:function(e,t,n){"use strict";var r=n(85715).default,o=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(9950)),i=n(92203);t.default=function(e){var t=e.value,n=(0,a.useState)(""),o=r(n,2),s=o[0],l=o[1];return(0,a.useEffect)((function(){i.processor.process(t).then((function(e){var t=String(e).replace(/<a /gi,'<a target="_blank" tabindex="-1"');l(t)}))}),[t]),a.default.createElement("div",{className:"sf-metadata-long-text-container article",dangerouslySetInnerHTML:{__html:s}})}},82717:function(e,t,n){"use strict";var r=n(41132).default,o=n(24994).default,a=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(9950)),s=o(n(86615)),l=o(n(24263)),c=n(57425),u=n(27399);n(77392);t.default=function(e){var t=e.value,n=e.options,o=e.fontSize,a=e.className,d=e.children,p=(0,i.useMemo)((function(){if(!Array.isArray(t)||0===t.length)return[];var e=n.filter((function(e){return t.includes(e.id)||t.includes(e.name)})),o=t.filter((function(e){return e&&!n.find((function(t){return t.id===e||t.name===e}))})).map((function(e){return{id:e,name:(0,u.gettext)(c.DELETED_OPTION_TIPS),color:c.DELETED_OPTION_BACKGROUND_COLOR}}));return[].concat(r(e),r(o))}),[n,t]);return 0===p.length?d||null:i.default.createElement("div",{className:(0,s.default)("sf-metadata-ui cell-formatter-container multiple-select-formatter",a)},p.map((function(e){return i.default.createElement(l.default,{key:e.id,option:e,fontSize:o})})))}},98801:function(e,t,n){"use strict";var r=n(24994).default,o=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(9950)),i=r(n(86615)),s=n(56265);t.default=function(e){var t=e.value,n=e.formats,r=e.className,o=e.children,l=(0,a.useMemo)((function(){return(0,s.getNumberDisplayString)(t,n)}),[t,n]);return l?a.default.createElement("div",{className:(0,i.default)("sf-metadata-ui cell-formatter-container text-formatter number-formatter",r)},l):o||null}},73002:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(9950)),a=r(n(86615)),i=r(n(35349));n(27770);t.default=function(e){var t=e.value,n=e.data,r=e.className,s=e.children;if(!t)return s||null;for(var l=n||{},c=l.max,u=void 0===c?5:c,d=l.color,p=void 0===d?"#e5e5e5":d,f=l.type,h=void 0===f?"rate":f,m=Math.min(u,t),g=[],v=0;v<m;v++)g.push(o.default.createElement("div",{className:"sf-metadata-rate-item",style:{fill:p||"#e5e5e5"},key:v},o.default.createElement(i.default,{iconName:h})));return o.default.createElement("div",{className:(0,a.default)("sf-metadata-ui cell-formatter-container rate-formatter",r)},g)}},24263:function(e,t,n){"use strict";var r=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(9950));n(61945);t.default=function(e){var t=e.option,n=e.fontSize,r=(0,o.useMemo)((function(){return{display:"inline-block",padding:"0px 10px",height:"20px",lineHeight:"20px",textAlign:"center",borderRadius:"10px",maxWidth:"250px",fontSize:n||13,backgroundColor:t.color,color:t.textColor||null}}),[t,n]);return o.default.createElement("div",{className:"sf-metadata-ui-select-option text-truncate",style:r,title:t.name},t.name)}},34041:function(e,t,n){"use strict";var r=n(24994).default,o=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(9950)),i=r(n(86615)),s=r(n(24263));n(3627);t.default=function(e){var t=e.value,n=e.options,r=e.fontSize,o=e.className,l=e.children,c=(0,a.useMemo)((function(){return n.find((function(e){return e.id===t||e.name===t}))}),[n,t]);return c?a.default.createElement("div",{className:(0,i.default)("sf-metadata-ui cell-formatter-container single-select-formatter",o)},a.default.createElement(s.default,{option:c,fontSize:r})):l||null}},12863:function(e,t,n){"use strict";var r=n(24994).default,o=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(9950)),i=r(n(86615)),s=n(56265);t.default=function(e){var t=e.value,n=e.className,r=e.children,o=(0,a.useMemo)((function(){return"number"===typeof t?t+"":"object"===typeof t?null:"Boolean"===(0,s.getType)(t)?t+"":t}),[t]);return o?a.default.createElement("div",{className:(0,i.default)("sf-metadata-ui cell-formatter-container text-formatter",n)},o):r||null}},43007:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(9950)),a=r(n(86615));n(12081);t.default=function(e){var t=e.value,n=e.className,r=e.children;return t?o.default.createElement("div",{className:(0,a.default)("sf-metadata-ui cell-formatter-container url-formatter",n)},t):r||null}},92544:function(e,t,n){"use strict";var r=n(91847).default,o=["size","className","iconClassName","iconName","iconStyle","onClick"],a=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(9950)),s=a(n(86615)),l=a(n(35349));n(89156);t.default=function(e){var t=e.size,n=void 0===t?20:t,a=e.className,c=e.iconClassName,u=e.iconName,d=e.iconStyle,p=e.onClick,f=r(e,o);return i.default.createElement("div",Object.assign({className:(0,s.default)("sf-metadata-icon-btn","sf-metadata-icon-btn-".concat(n),a),onClick:p||function(){}},f),i.default.createElement(l.default,{iconName:u,className:c,style:d}))}},35349:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(9950)),a=r(n(86615));n(83695);t.default=function(e){var t=e.className,n=e.iconName,r=e.style;return o.default.createElement("svg",{className:(0,a.default)("sf-metadata-icon","sf-metadata-icon-".concat(n),t),style:r},o.default.createElement("use",{xlinkHref:"#".concat(n)}))}},71791:function(e,t,n){"use strict";var r=n(6305).default,o=n(24994).default;Object.defineProperty(t,"Du",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"ij",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"NC",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"Rw",{enumerable:!0,get:function(){return A.default}}),Object.defineProperty(t,"Cg",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"ZA",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(t,"In",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"Oi",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"Rh",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(t,"qz",{enumerable:!0,get:function(){return c.LongTextFormatter}}),Object.defineProperty(t,"Q$",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(t,"DO",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(t,"US",{enumerable:!0,get:function(){return C.SfCalendar}}),Object.defineProperty(t,"sv",{enumerable:!0,get:function(){return C.SfFilterCalendar}}),Object.defineProperty(t,"dO",{enumerable:!0,get:function(){return g.default}}),n(32514);var a=o(n(13677)),i=o(n(92178)),s=o(n(18142)),l=o(n(71082)),c=r(n(50502)),u=o(n(35349)),d=o(n(92544)),p=o(n(26984)),f=o(n(2966)),h=o(n(44798)),m=o(n(29173)),g=o(n(55192)),v=o(n(90665)),y=o(n(89659)),C=n(49046),A=o(n(55859))},46290:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(6305).default,i=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=i(n(9950)),l=i(n(10865)),c=i(n(742)),u=i(n(63785)),d=i(n(10949)),p=a(n(66602)),f=i(n(83163));if(!String.prototype.defaultMessage){var h=function(e){return this||e||""};String.prototype.defaultMessage=h,String.prototype.d=h}var m=function(){return o((function e(){r(this,e),this.options={currentLocale:null,locales:{},warningHandler:function(){var e;(e=console).warn.apply(e,arguments)},escapeHtml:!0,fallbackLocale:null,debug:!1,dataKey:"data-i18n-key"}}),[{key:"_getFormattedMessage",value:function(e,t){if(this.options.intlGetHook)try{this.options.intlGetHook(e,this.options.currentLocale)}catch(h){console.log("intl get hook error: ",h)}(0,d.default)(e,"key is required");var n=this.options,r=n.locales,o=n.currentLocale,a=n.formats;if(!r||!r[o]){var i='react-intl-universal locales data "'.concat(o,'" not exists.');return o||(i+=" More info: https://github.com/alibaba/react-intl-universal/issues/144#issuecomment-1345193138"),this.options.warningHandler(i),""}var s=this.getDescendantProp(r[o],e);if(null==s){if(!this.options.fallbackLocale)return this.options.warningHandler('react-intl-universal key "'.concat(e,'" not defined in ').concat(o)),"";if(null==(s=this.getDescendantProp(r[this.options.fallbackLocale],e)))return this.options.warningHandler('react-intl-universal key "'.concat(e,'" not defined in ').concat(o," or the fallback locale, ").concat(this.options.fallbackLocale)),""}if(t)for(var u in t=Object.assign({},t)){var p=t[u];!0===this.options.escapeHtml&&("string"===typeof p||p instanceof String)&&p.indexOf("<")>=0&&(p=(0,c.default)(p)),t[u]=p}try{var f;if(t)f=new l.default(s,o,a).format(t);else f=s;return f}catch(m){return this.options.warningHandler("react-intl-universal format message failed for key='".concat(e,"'."),m.message),s}}},{key:"get",value:function(e,t){var n=this._getFormattedMessage(e,t);return this.options.debug?this._getSpanElementMessage(e,n):n}},{key:"getHTML",value:function(e,t){var n=this._getFormattedMessage(e,t);return n?this._getSpanElementMessage(e,n):""}},{key:"formatMessage",value:function(e,t){var n=e.id,r=e.defaultMessage;return this.get(n,t).defaultMessage(r)}},{key:"formatHTMLMessage",value:function(e,t){var n=e.id,r=e.defaultMessage;return this.getHTML(n,t).defaultMessage(r)}},{key:"determineLocale",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.getLocaleFromURL(e)||this.getLocaleFromCookie(e)||this.getLocaleFromLocalStorage(e)||this.getLocaleFromBrowser()}},{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,d.default)(e.currentLocale,"options.currentLocale is required"),(0,d.default)(e.locales,"options.locales is required"),Object.assign(this.options,e),this.options.formats=Object.assign({},this.options.formats,p.defaultFormats),new Promise((function(e,t){e()}))}},{key:"getInitOptions",value:function(){return this.options}},{key:"load",value:function(e){(0,f.default)(this.options.locales,e)}},{key:"getLocaleFromCookie",value:function(e){var t=e.cookieLocaleKey;if(t){var n=u.default.parse(document.cookie);return n&&n[t]}}},{key:"getLocaleFromLocalStorage",value:function(e){var t=e.localStorageLocaleKey;if(t&&window.localStorage)return localStorage.getItem(t)}},{key:"getLocaleFromURL",value:function(e){var t=e.urlLocaleKey;if(t){var n=window.location.search.split("?");if(n.length>=2){var r=new URLSearchParams(n[1]);if(r.has(t))return r.get(t)}}}},{key:"getDescendantProp",value:function(e,t){return e[t]?e[t]:t.split(".").reduce((function(e,t){return void 0!==e?e[t]:e}),e)}},{key:"getLocaleFromBrowser",value:function(){return navigator.language||navigator.userLanguage}},{key:"_getSpanElementMessage",value:function(e,t){var n={dangerouslySetInnerHTML:{__html:t}};this.options.debug&&(n[this.options.dataKey]=e);var r=s.default.createElement("span",n),o=function(){return r};return Object.assign({defaultMessage:o,d:o},r)}}])}();t.default=m},66602:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultFormats=void 0;for(var n=["AFN","EUR","ALL","DZD","USD","AOA","XCD","ARS","AMD","AWG","AUD","AZN","BSD","BHD","BDT","BBD","BYN","BZD","XOF","BMD","INR","BTN","BOB","BOV","BAM","BWP","NOK","BRL","BND","BGN","BIF","CVE","KHR","XAF","CAD","KYD","CLP","CLF","CNY","COP","COU","KMF","CDF","NZD","CRC","HRK","CUP","CUC","ANG","CZK","DKK","DJF","DOP","EGP","SVC","ERN","ETB","FKP","FJD","XPF","GMD","GEL","GHS","GIP","GTQ","GBP","GNF","GYD","HTG","HNL","HKD","HUF","ISK","IDR","XDR","IRR","IQD","ILS","JMD","JPY","JOD","KZT","KES","KPW","KRW","KWD","KGS","LAK","LBP","LSL","ZAR","LRD","LYD","CHF","MOP","MKD","MGA","MWK","MYR","MVR","MRO","MUR","XUA","MXN","MXV","MDL","MNT","MAD","MZN","MMK","NAD","NPR","NIO","NGN","OMR","PKR","PAB","PGK","PYG","PEN","PHP","PLN","QAR","RON","RUB","RWF","SHP","WST","STD","SAR","RSD","SCR","SLL","SGD","XSU","SBD","SOS","SSP","LKR","SDG","SRD","SZL","SEK","CHE","CHW","SYP","TWD","TJS","TZS","THB","TOP","TTD","TND","TRY","TMT","UGX","UAH","AED","USN","UYU","UYI","UZS","VUV","VEF","VND","YER","ZMW","ZWL","XBA","XBB","XBC","XBD","XTS","XXX","XAU","XPD","XPT","XAG"],r={},o=0;o<n.length;o++)r[n[o]]={style:"currency",currency:n[o]};t.defaultFormats={number:r}},5799:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ReactIntlUniversal",{enumerable:!0,get:function(){return o.default}}),t.load=t.init=t.getLocaleFromURL=t.getLocaleFromLocalStorage=t.getLocaleFromCookie=t.getLocaleFromBrowser=t.getInitOptions=t.getHTML=t.getDescendantProp=t.get=t.formatMessage=t.formatHTMLMessage=t.determineLocale=t.default=void 0;var o=r(n(46290)),a=t.default=new o.default;a.ReactIntlUniversal=o.default;t.get=a.get.bind(a),t.getHTML=a.getHTML.bind(a),t.formatMessage=a.formatMessage.bind(a),t.formatHTMLMessage=a.formatHTMLMessage.bind(a),t.determineLocale=a.determineLocale.bind(a),t.init=a.init.bind(a),t.getInitOptions=a.getInitOptions.bind(a),t.load=a.load.bind(a),t.getLocaleFromCookie=a.getLocaleFromCookie.bind(a),t.getLocaleFromLocalStorage=a.getLocaleFromLocalStorage.bind(a),t.getLocaleFromURL=a.getLocaleFromURL.bind(a),t.getDescendantProp=a.getDescendantProp.bind(a),t.getLocaleFromBrowser=a.getLocaleFromBrowser.bind(a)},26984:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return o.default.createElement("span",{className:"sf-metadata-loading-tip sf-metadata-loading-icon"})};var o=r(n(9950));n(65544)},32514:function(e,t,n){"use strict";var r,o,a,i=n(24994).default,s=i(n(5799)),l=i(n(38572)),c=i(n(54788)),u=i(n(2587)),d=i(n(96791)),p=i(n(85086)),f=i(n(91647)),h=i(n(98765)),m={de:l.default,en:c.default,fr:u.default,"zh-cn":h.default,es:d.default,ru:p.default,pt:f.default},g=(null===(r=window)||void 0===r||null===(o=r.app)||void 0===o||null===(a=o.config)||void 0===a?void 0:a.lang)||"zh-cn";s.default.init({currentLocale:g,locales:m})},38572:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={Deleted_option:"Die Option wurde gel\xf6scht."}},54788:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={Deleted_option:"Deleted option"}},96791:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={Deleted_option:"Opciones borradas"}},2587:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={Deleted_option:"L'option a \xe9t\xe9 supprim\xe9e."}},91647:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={Deleted_option:"op\xe7\xe3o exclu\xedda"}},85086:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={deleted_option:"Deleted option"}},98765:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={Deleted_option:"\u5df2\u5220\u9664\u7684\u6807\u7b7e"}},90665:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(n(9950)),c=s(n(17119)),u=document.getElementById("modal-wrapper"),d=function(e){function t(e){var n;return r(this,t),(n=a(this,t,[e])).el=document.createElement("div"),n}return i(t,e),o(t,[{key:"componentDidMount",value:function(){u.appendChild(this.el)}},{key:"componentWillUnmount",value:function(){u.removeChild(this.el)}},{key:"render",value:function(){return c.default.createPortal(this.props.children,this.el)}}])}(l.default.Component);t.default=d},2966:function(e,t,n){"use strict";var r=n(91847).default,o=["record","columns","openRecord"],a=n(24994).default,i=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=i(n(9950)),l=a(n(50502));n(58986);t.default=function(e){var t,n=e.record,a=e.columns,i=e.openRecord,c=r(e,o),u=(0,s.useCallback)((function(){i&&i(n)}),[n,i]);return s.default.createElement("div",{className:"sf-metadata-record",onClick:u},s.default.createElement("div",{className:"sf-metadata-record-container"},s.default.createElement("div",{className:"sf-metadata-record-header"},s.default.createElement("div",{className:"sf-metadata-record-cell sf-metadata-record-cell-name"},s.default.createElement(l.default,Object.assign({value:n[null===(t=a[0])||void 0===t?void 0:t.key],field:a[0]},c)))),s.default.createElement("div",{className:"sf-metadata-record-content"},a.slice(1).map((function(e){return s.default.createElement("div",{className:"sf-metadata-record-cell",key:e.key,style:{width:e.width||200}},s.default.createElement(l.default,Object.assign({isSample:!0,value:n[e.key],field:e},c)))})))))}},24910:function(e,t,n){"use strict";var r=n(24994).default,o=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(9950)),i=n(48843),s=r(n(92544)),l=r(n(35349));n(35174);t.default=function(e){var t=e.field,n=e.fieldIconConfig,r=t.type,o=t.name,c=t.description,u=t.key,d=(0,a.useRef)(null);return a.default.createElement(i.Col,{md:3,className:"d-flex sf-metadata-record-details-item-label"},a.default.createElement("div",{className:"d-flex justify-content-between"},a.default.createElement("div",{className:"field-description-section"},a.default.createElement("span",{className:"header-icon",id:"header-icon-".concat(u)},a.default.createElement(l.default,{iconName:n[r]})),a.default.createElement("span",{className:"field-description-section-field-name"},o||""),c&&a.default.createElement(a.default.Fragment,null,a.default.createElement(s.default,{ref:d,iconName:"description",className:"field-uneditable-tip ml-2"}),d.current&&a.default.createElement(i.UncontrolledTooltip,{target:d.current,fade:!1,placement:"right",modifiers:{preventOverflow:{boundariesElement:document.body}}},c)))))}},44798:function(e,t,n){"use strict";var r=n(85715).default,o=n(91847).default,a=["fields","record","onToggle","fieldIconConfig"],i=n(24994).default,s=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(n(9950)),c=n(48843),u=n(56265),d=i(n(13677)),p=i(n(24910)),f=i(n(50502)),h=i(n(92544));n(90562);t.default=function(e){var t=e.fields,n=e.record,i=e.onToggle,s=e.fieldIconConfig,m=o(e,a),g=(0,l.useState)(!0),v=r(g,2),y=v[0],C=v[1],A=(0,l.useState)(!0),x=r(A,2),b=x[0],_=x[1],w=(0,l.useRef)(null),S=(0,l.useMemo)((function(){return{width:"".concat(window.innerWidth-80,"px"),maxWidth:"".concat(window.innerWidth-80,"px"),marginLeft:"".concat(80,"px"),height:"".concat(100,"px"),marginRight:"".concat(80,"px"),marginTop:"30%",transition:"all .3s"}}),[]),D=(0,l.useMemo)((function(){return{width:800,maxWidth:800,marginLeft:(window.innerWidth-800)/2,height:"calc(100% - 56px)"}}),[]);(0,l.useEffect)((function(){setTimeout((function(){var e=w.current.firstChild,t=D.width,n=D.maxWidth,r=D.marginLeft,o=D.height;e.style.width="".concat(t,"px"),e.style.maxWidth="".concat(n,"px"),e.style.marginLeft="".concat(r,"px"),e.style.height=o,e.style.marginRight="unset",e.style.marginTop="28px",setTimeout((function(){C(!1),e.style.transition="none",_(!1)}),280)}),1)}),[]);var E=(0,l.useCallback)((function(){i()}),[i]),k=(0,l.useCallback)((function(e){var t=e.key,r=e.name;return l.default.createElement(f.default,Object.assign({field:e,value:t.startsWith("_")?n[t]:n[r]},m))}),[n,m]),M=(0,l.useCallback)((function(){return b?l.default.createElement(d.default,null):Array.isArray(t)&&0!==t.length?l.default.createElement(l.default.Fragment,null,t.map((function(e){return l.default.createElement("div",{className:"sf-metadata-record-details-item sf-metadata-record-details-item-field-".concat(e.type),key:e.key},l.default.createElement("div",{className:"pb-4 row"},l.default.createElement(p.default,{field:e,fieldIconConfig:s}),l.default.createElement(c.Col,{md:9,className:"d-flex align-items-center sf-metadata-record-details-item-col"},k(e))))}))):null}),[b,t,s,k]);return l.default.createElement(c.Modal,{isOpen:!0,toggle:E,className:"sf-metadata-record-details-dialog",style:y?S:D,zIndex:1048,contentClassName:"sf-metadata-record-details-content",modalClassName:"sf-metadata-record-details-modal",fade:!1,innerRef:w,keyboard:!1},!y&&l.default.createElement("div",{className:"sf-metadata-record-details"},l.default.createElement(c.ModalHeader,{close:l.default.createElement("div",{className:"header-close-list"},l.default.createElement(h.default,{iconName:"close",size:24,onClick:E}))},l.default.createElement("div",{className:"sf-metadata-record-details-left-btns"},l.default.createElement("div",{className:"sf-metadata-record-details-title text-truncate"},(0,u.gettext)("Details")))),l.default.createElement(c.ModalBody,{className:"sf-metadata-record-details-container"},M())))}},29173:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default,l=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(9950)),u=s(n(86615)),d=n(56265),p=function(e){function t(e){var n;return r(this,t),(n=a(this,t,[e])).onCompositionStart=function(){n.isInputtingChinese=!0},n.onChange=function(e){n.timer&&clearTimeout(n.timer);var t=n.props,r=t.onChange,o=t.wait,a=e.target.value;n.setState({searchValue:a||""},(function(){n.isInputtingChinese||(n.timer=setTimeout((function(){r&&r(n.state.searchValue.trim())}),o))}))},n.onCompositionEnd=function(e){n.isInputtingChinese=!1,n.onChange(e)},n.clearSearch=function(){var e=n.props.clearValue;n.setState({searchValue:""},(function(){e&&e()}))},n.setFocus=function(e){if(n.inputRef!==document.activeElement&&(n.inputRef.focus(),e)){var t=n.state.searchValue.length;n.inputRef.setSelectionRange(0,t)}},n.renderClear=function(){var e=n.props,t=e.isClearable,r=e.clearClassName,o=e.components,a=void 0===o?{}:o,i=n.state.searchValue;if(!t||!i)return null;var s=a.ClearIndicator;return c.default.isValidElement(s)?c.default.cloneElement(s,{clearValue:n.clearSearch}):(0,d.isFunction)(s)?c.default.createElement(s,{clearValue:n.clearSearch}):c.default.createElement("i",{className:(0,u.default)("search-text-clear input-icon-addon",r),onClick:n.clearSearch},"\xd7")},n.state={searchValue:e.value},n.isInputtingChinese=!1,n.timer=null,n.inputRef=null,n}return i(t,e),o(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.value!==this.props.value&&this.setState({searchValue:e.value})}},{key:"componentWillUnmount",value:function(){this.timer&&clearTimeout(this.timer),this.timer=null,this.inputRef=null}},{key:"render",value:function(){var e=this,t=this.props,n=t.placeholder,r=t.autoFocus,o=t.className,a=t.onKeyDown,i=t.disabled,s=t.style,l=this.state.searchValue;return c.default.createElement(c.Fragment,null,c.default.createElement("input",{type:"text",value:l,className:(0,u.default)("form-control",o),onChange:this.onChange,autoFocus:r,placeholder:n,onCompositionStart:this.onCompositionStart,onCompositionEnd:this.onCompositionEnd,onKeyDown:a,disabled:i,style:s,ref:function(t){return e.inputRef=t}}),this.renderClear())}}])}(c.Component);p.defaultProps={wait:100,disabled:!1,value:""};t.default=p},59281:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={LeftArrow:37,UpArrow:38,RightArrow:39,DownArrow:40,Enter:13,Tab:9,Escape:27,Esc:27}},20536:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default,l=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(9950)),u=s(n(86615)),d=s(n(89251)),p=s(n(29173)),f=s(n(59281)),h=s(n(92178));n(15623);var m=function(e){function t(e){var n;return r(this,t),(n=a(this,t,[e])).resetMenuStyle=function(){var e=n.props,t=e.isInModal,r=e.position,o=n.optionGroupRef.getBoundingClientRect(),a=o.top,i=o.height;if(t)r.y+r.height+i>window.innerHeight&&(n.optionGroupRef.style.top=r.y-i+"px"),n.optionGroupRef.style.opacity=1;else if(i+a>window.innerHeight){n.optionGroupRef.style.top=-1*(i+2)+"px"}},n.onHotKey=function(e){var t=e.keyCode;if(t===f.default.UpArrow)n.onPressUp();else if(t===f.default.DownArrow)n.onPressDown();else if(t===f.default.Enter){var r=n.filterOptions&&n.filterOptions[n.state.activeIndex];r&&(n.props.onSelectOption(r.value),n.props.supportMultipleSelect||n.props.closeSelect())}else t!==f.default.Tab&&t!==f.default.Escape||n.props.closeSelect()},n.onPressUp=function(){n.state.activeIndex>0&&n.setState({activeIndex:n.state.activeIndex-1},(function(){n.scrollContent()}))},n.onPressDown=function(){n.filterOptions&&n.state.activeIndex<n.filterOptions.length-1&&n.setState({activeIndex:n.state.activeIndex+1},(function(){n.scrollContent()}))},n.onMouseDown=function(e){n.props.isInModal&&(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation())},n.scrollContent=function(){var e=n.optionGroupContentRef,t=e.offsetHeight,r=e.scrollTop;n.setState({disableHover:!0}),n.timer=setTimeout((function(){n.setState({disableHover:!1})}),500),32*n.state.activeIndex!==0?32*n.state.activeIndex<r?n.optionGroupContentRef.scrollTop=r-32:32*n.state.activeIndex>t+r&&(n.optionGroupContentRef.scrollTop=r+32):n.optionGroupContentRef.scrollTop=0},n.changeIndex=function(e){n.setState({activeIndex:e})},n.onChangeSearch=function(e){var t=e||"";t!==n.state.searchVal&&n.setState({searchVal:t,activeIndex:-1})},n.renderOptGroup=function(e){var t=n.props,r=t.noOptionsPlaceholder,o=t.onSelectOption;return n.filterOptions=n.props.getFilterOptions(e),0===n.filterOptions.length?c.default.createElement("div",{className:"none-search-result"},r):n.filterOptions.map((function(e,t){var r=e.value.column?e.value.column.key:t,a=n.state.activeIndex===t;return c.default.createElement(d.default,{key:r,index:t,isActive:a,value:e.value,onSelectOption:o,changeIndex:n.changeIndex,supportMultipleSelect:n.props.supportMultipleSelect,disableHover:n.state.disableHover},e.label)}))},n.state={searchVal:"",activeIndex:-1,disableHover:!1},n.filterOptions=null,n.timer=null,n}return i(t,e),o(t,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("keydown",this.onHotKey),setTimeout((function(){e.resetMenuStyle()}),1)}},{key:"componentWillUnmount",value:function(){this.filterOptions=null,this.timer&&clearTimeout(this.timer),window.removeEventListener("keydown",this.onHotKey)}},{key:"render",value:function(){var e=this,t=this.props,n=t.searchable,r=t.searchPlaceholder,o=t.top,a=t.left,i=t.minWidth,s=t.value,l=t.isShowSelected,d=t.isInModal,f=t.position,m=t.className,g=t.addOptionAble,v=(t.component||{}).AddOption,y=this.state.searchVal,C={top:o||0,left:a||0};return i&&(C={top:o||0,left:a||0,minWidth:i}),d&&(C={position:"fixed",left:f.x,top:f.y+f.height,minWidth:f.width,opacity:0}),c.default.createElement(h.default,{onClickOutside:this.props.onClickOutside},c.default.createElement("div",{className:(0,u.default)("sf-metadata-option-group",m?"sf-metadata-option-group-"+m:"",{"pt-0":l,"create-new-sf-metadata-option-group":g}),ref:function(t){return e.optionGroupRef=t},style:C,onMouseDown:this.onMouseDown},l&&c.default.createElement("div",{className:"editor-list-delete mb-2",onClick:function(e){return e.stopPropagation()}},s.label||""),n&&c.default.createElement("div",{className:"sf-metadata-option-group-search"},c.default.createElement(p.default,{className:"option-search-control",placeholder:r,onChange:this.onChangeSearch,autoFocus:!0})),c.default.createElement("div",{className:"sf-metadata-option-group-content",ref:function(t){return e.optionGroupContentRef=t}},this.renderOptGroup(y)),g&&v))}}])}(c.Component);t.default=m},89251:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(n(9950)),c=function(e){function t(){var e;return r(this,t),(e=a(this,t,arguments)).onSelectOption=function(t,n){e.props.supportMultipleSelect&&n.stopPropagation(),e.props.onSelectOption(t,n)},e.onMouseEnter=function(){e.props.disableHover||e.props.changeIndex(e.props.index)},e.onMouseLeave=function(){e.props.disableHover||e.props.changeIndex(-1)},e}return i(t,e),o(t,[{key:"render",value:function(){return l.default.createElement("div",{className:this.props.isActive?"sf-metadata-option sf-metadata-option-active":"sf-metadata-option",onClick:this.onSelectOption.bind(this,this.props.value),onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},this.props.children)}}])}(l.Component);t.default=c},55192:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(9950));t.default=function(e){var t=e.onChange,n=e.checked,r=e.placeholder,a=e.disabled,i=e.switchClassName;return o.default.createElement("div",{className:"sf-metadata-switch position-relative ".concat(i||"")},o.default.createElement("label",{className:"custom-switch"},o.default.createElement("input",{className:"custom-switch-input",type:"checkbox",checked:n,onChange:t,name:"custom-switch-checkbox",disabled:a}),o.default.createElement("span",{className:"custom-switch-description text-truncate"},r),o.default.createElement("span",{className:"custom-switch-indicator"})))}},39856:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.throttle=t.isValidEmail=t.isMac=t.isFunction=t.getType=t.getNumberDisplayString=t.getGeolocationDisplayString=t.getEventClassName=t.getDateDisplayString=t.debounce=void 0;var o=r(n(84583)),a=n(57425),i=n(97701),s=n(22724);t.debounce=function(e,t){var n=null;return function(){null!==n&&clearTimeout(n),n=setTimeout(e,t)}};t.throttle=function(e,t){var n=null,r=Date.now();return function(){var o=Date.now(),a=t-(o-r),i=arguments;clearTimeout(n),a<=0?(e.apply(this,i),r=Date.now()):n=setTimeout(e,a)}};t.isMac=function(){var e=navigator.platform;return"Mac68K"==e||"MacPPC"==e||"Macintosh"==e||"MacIntel"==e};t.getEventClassName=function(e){return e&&e.target&&e.target.getAttribute("class")||""};t.isValidEmail=function(e){return/^[A-Za-z0-9]+([-_.][A-Za-z0-9]+)*@([A-Za-z0-9]+[-.])+[A-Za-z0-9]{2,20}$/.test(e)};t.isFunction=function(e){return e&&"[object Function]"==={}.toString.call(e)};t.getType=function(e){return Object.prototype.toString.call(e).slice(8,-1)};t.getDateDisplayString=function(e,t){if(!e||"string"!==typeof e)return"";var n=(0,o.default)(e);if(!n.isValid())return e;switch(t){case"D/M/YYYY":case"DD/MM/YYYY":var r=n.format("YYYY-MM-DD").split("-");return"".concat(r[2],"/").concat(r[1],"/").concat(r[0]);case"D/M/YYYY HH:mm":case"DD/MM/YYYY HH:mm":var a=n.format("YYYY-MM-DD HH:mm").split(" "),i=a[0].split("-");return"".concat(i[2],"/").concat(i[1],"/").concat(i[0]," ").concat(a[1]);case"M/D/YYYY":return n.format("M/D/YYYY");case"M/D/YYYY HH:mm":return n.format("M/D/YYYY HH:mm");case"YYYY-MM-DD":default:return n.format("YYYY-MM-DD");case"YYYY-MM-DD HH:mm":return n.format("YYYY-MM-DD HH:mm");case"YYYY-MM-DD HH:mm:ss":return n.format("YYYY-MM-DD HH:mm:ss");case"DD.MM.YYYY":return n.format("DD.MM.YYYY");case"DD.MM.YYYY HH:mm":return n.format("DD.MM.YYYY HH:mm")}};t.getGeolocationDisplayString=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=(n.isBaiduMap,n.hyphen),o=void 0===r?"":r;if(!e)return"";switch((t||{}).geo_format){case a.GEOLOCATION_FORMAT.LNG_LAT:var i=e.lng,s=e.lat;if(!function(e,t){return(e||0===e)&&(t||0===t)}(i,s))return"";var l=function(e){if(!e&&0!==e)return"";if(e<-180||e>180)return"";var t=Math.floor(Math.abs(e)),n=60*(Math.abs(e)-t),r=Math.floor(n),o=Math.round(60*(n-r));return"".concat(e>=0?"E":"W").concat(t,"\xb0").concat(r,"'").concat(o,'"')}(i),c=function(e){if(!e&&0!==e)return"";if(e<-90||e>90)return"";var t=Math.floor(Math.abs(e)),n=60*(Math.abs(e)-t),r=Math.floor(n),o=Math.round(60*(n-r));return"".concat(e>=0?"N":"S").concat(t,"\xb0").concat(r,"'").concat(o,'"')}(s);return"".concat(c,", ").concat(l);case a.GEOLOCATION_FORMAT.COUNTRY_REGION:return e.country_region||"";case a.GEOLOCATION_FORMAT.PROVINCE:return e.province||"";case a.GEOLOCATION_FORMAT.PROVINCE_CITY:var u=e.province,d=e.city;return"".concat(u||"").concat(o).concat(d||"").trim();case a.GEOLOCATION_FORMAT.PROVINCE_CITY_DISTRICT:var p=e.province,f=e.city,h=e.district;return"".concat(p||"").concat(o).concat(f||"").concat(o).concat(h||"").trim();case a.GEOLOCATION_FORMAT.MAP_SELECTION:var m=e.address,g=e.title;return"".concat(m||"").concat(o).concat(g||"").trim();default:var v=e.province,y=e.city,C=e.district,A=e.detail;return v||y||C||A?"".concat(v||"").concat(o).concat(y||"").concat(o).concat(C||"").concat(o).concat(A||"").trim():""}};var l=["bytes","KB","MB","GB","TB","PB"],c={comma:",",dot:".",no:"",space:" "},u=function(e){return"string"!==typeof e?"":e.endsWith("0")?e.replace(/(?:\.0*|(\.\d+?)0+)$/,"$1"):e},d=function(e,t){var n=t.formats,r=t.isCurrency,o=void 0===r||r,a=n||{},l=a.decimal,d=void 0===l?"dot":l,p=a.thousands,f=void 0===p?"no":p,h=a.precision,m=void 0===h?2:h,g=a.enable_precision,v=void 0!==g&&g;if(String(e).includes("e")){if(e<1&&e>-1){var y=e.toFixed(v?m:8);return v||(y=u(y)),0===parseFloat(y)&&y.startsWith("-")?y.substring(1):y}return String(e)}var C=c[d],A=c[f],x=v?m:function(e){if(Number.isInteger(e))return 0;var t=String(e).split(".")[1],n=t?t.length:8;return n>8?8:n}(e),b=parseFloat((0,s.round)(e,x).toFixed(x)),_=b<0,w=Math.trunc(b),S=String(Math.abs((0,i.NPminus)(b,w)).toFixed(x)).slice(1);v||(S=u(S)),o&&(v||(S=2===S.length?S=S.padEnd(3,"0"):(S.substring(0,3)||".").padEnd(3,"0"))),S=S.replace(/./,C);for(var D=[],E=0,k=(w=Math.abs(w).toString()).length-1;k>-1;k--)E+=1,D.unshift(w[k]),E%3||0===k||D.unshift(A);return"".concat(_?"-":"").concat(D.join("")).concat(S)};t.getNumberDisplayString=function(e,t){var n=Object.prototype.toString.call(e);if("[object Number]"!==n)return"[object String]"===n&&e.startsWith("#")?e:"";if(isNaN(e)||e===1/0||e===-1/0)return String(e);var r=(t||{}).format;switch(void 0===r?a.DEFAULT_NUMBER_FORMAT:r){case"number":return d(e,{formats:t,isCurrency:!1});case"percent":return"".concat(d(Number.parseFloat((100*e).toFixed(8)),{formats:t,isCurrency:!1}),"%");case"yuan":return"\uffe5".concat(d(e,{formats:t}));case"dollar":return"$".concat(d(e,{formats:t}));case"euro":return"\u20ac".concat(d(e,{formats:t}));case"custom_currency":return"after"===t.currency_symbol_position?"".concat(d(e,{formats:t})).concat(t.currency_symbol||""):"".concat(t.currency_symbol||"").concat(d(e,{formats:t}));case"byte":if(e<0)return"--";if(0===e)return e+" "+l[0];var o=parseInt(Math.floor(Math.log(e)/Math.log(1e3)),10);return 0===o?e+" "+l[o]:(e/Math.pow(1e3,o)).toFixed(1)+" "+l[o];default:return String(e)}}},44956:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(84583)),a=r(n(27619));o.default.extend(a.default);t.default=o.default},56265:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"debounce",{enumerable:!0,get:function(){return o.debounce}}),Object.defineProperty(t,"getEventClassName",{enumerable:!0,get:function(){return o.getEventClassName}}),Object.defineProperty(t,"getHTML",{enumerable:!0,get:function(){return r.getHTML}}),Object.defineProperty(t,"getNumberDisplayString",{enumerable:!0,get:function(){return o.getNumberDisplayString}}),Object.defineProperty(t,"getType",{enumerable:!0,get:function(){return o.getType}}),Object.defineProperty(t,"gettext",{enumerable:!0,get:function(){return r.gettext}}),Object.defineProperty(t,"isFunction",{enumerable:!0,get:function(){return o.isFunction}}),Object.defineProperty(t,"isMac",{enumerable:!0,get:function(){return o.isMac}}),Object.defineProperty(t,"isValidEmail",{enumerable:!0,get:function(){return o.isValidEmail}}),Object.defineProperty(t,"throttle",{enumerable:!0,get:function(){return o.throttle}});var r=n(27399),o=n(39856)},97701:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NPminus=t.NPdivide=void 0;var n=function(e){var t=e.toString().split(/[eE]/),n=(t[0].split(".")[1]||"").length-+(t[1]||0);return n>0?n:0},r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15;return+parseFloat(Number(e).toPrecision(t))},o=function(e){if(-1===e.toString().indexOf("e"))return Number(e.toString().replace(".",""));var t=n(e);return t>0?r(Number(e)*Math.pow(10,t)):Number(e)},a=function(e,t){var r=o(e),a=o(t),i=n(e)+n(t);return r*a/Math.pow(10,i)};t.NPminus=function(e,t){var r=Math.pow(10,Math.max(n(e),n(t)));return(a(e,r)-a(t,r))/r};t.NPdivide=function(e,t){var i=o(e),s=o(t);return a(i/s,r(Math.pow(10,n(t)-n(e))))}},22724:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.round=t.isNumberEqual=t.isNumber=void 0;t.isNumber=function(e){return(e||0===e)&&"[object Number]"===Object.prototype.toString.call(e)};t.isNumberEqual=function(e,t){return e===t||Math.abs(e-t)<1e-5};t.round=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(0===t)return Math.round(e);var n=Math.pow(10,t),r=e*n;return t>0&&(r=Number.parseFloat(r.toFixed(1))),Math.round(r)/n}},27399:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.gettext=t.getHTML=void 0;var o=r(n(5799));t.gettext=function(e,t){return e?o.default.get(e,t)||e:""};t.getHTML=function(e,t){return e?o.default.getHTML(e,t)||e:""}},89659:function(e,t,n){"use strict";var r=n(12897).default,o=n(17383).default,a=n(34579).default,i=n(18336).default,s=n(29511).default,l=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(9950));t.default=function(e){var t;return t=function(t){function n(){return o(this,n),i(this,n,arguments)}return s(n,t),a(n,[{key:"render",value:function(){var t=r({},this.props);return"function"===typeof this.props.getInstance&&(t.ref=this.props.getInstance),c.default.createElement(e,t)}}])}(c.Component),t.displayName="withRef(".concat(e.displayName||e.name||"Component",")"),t}},82894:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Oe}});var r=n(7219),o=n(26380),a=n(52889),i=n(5316),s=n(9950),l=n(17119),c=n(11942),u=n.n(c),d=n(91478),p=n(4899),f=n(84583),h=n.n(f),m=function(e){function t(){return(0,o.default)(this,t),(0,a.default)(this,e.apply(this,arguments))}return(0,i.default)(t,e),t.prototype.render=function(){var e=this.props,t=e.value.localeData(),n=e.prefixCls,r=void 0,o=t.weekdaysMin(),a=t.weekdaysShort();e.showWeekNumber&&(r=s.createElement("th",{role:"columnheader",className:n+"-column-header "+n+"-week-number-header"},s.createElement("span",{className:n+"-column-header-inner"},"x")));var i=a.map((function(e,t){return s.createElement("th",{key:t,role:"columnheader",title:e,className:n+"-column-header"},s.createElement("span",{className:n+"-column-header-inner"},o[t]))}));return s.createElement("thead",null,s.createElement("tr",{role:"row"},r,i))},t}(s.Component),g=m,v=n(86615),y=n.n(v),C=6,A=7,x=n(6740),b=n.n(x);h().extend(b());var _={disabledHours:function(){return[]},disabledMinutes:function(){return[]},disabledSeconds:function(){return[]}};function w(e){var t=h()();return t=t.locale(e.locale()).utcOffset(e.utcOffset())}function S(e){return e.format("LL")}function D(e){return S(w(e))}function E(e){var t=e.locale();return e.localeData()["zh-cn"===t?"months":"monthsShort"](e)}function k(e,t){var n=t?t(e):{};return n=(0,r.default)({},_,n)}function M(e,t,n){return(!t||!t(e))&&!(n&&!function(e,t){return function(e,t){var n=!1;if(e){var r=e.hour(),o=e.minute(),a=e.second();n=-1!==t.disabledHours().indexOf(r)||-1!==t.disabledMinutes(r).indexOf(o)||-1!==t.disabledSeconds(r,o).indexOf(a)}return!n}(e,k(e,t))}(e,n))}function I(e,t){return e?(Array.isArray(t)&&(t=t[0]),e.format(t)):""}function N(e,t){return e&&t&&e.isSame(t,"day")}function P(e,t){return e.year()<t.year()?1:e.year()===t.year()&&e.month()<t.month()}function T(e,t){return e.year()>t.year()?1:e.year()===t.year()&&e.month()>t.month()}var O=function(e){function t(){return(0,o.default)(this,t),(0,a.default)(this,e.apply(this,arguments))}return(0,i.default)(t,e),t.prototype.render=function(){var e=this.props,t=e.contentRender,n=e.prefixCls,r=e.selectedValue,o=e.value,a=e.showWeekNumber,i=e.dateRender,l=e.disabledDate,c=e.hoverValue,u=void 0,d=void 0,p=void 0,f=[],h=w(o),m=n+"-cell",g=n+"-week-number-cell",v=n+"-date",x=n+"-today",b=n+"-selected-day",_=n+"-selected-date",D=n+"-selected-start-date",E=n+"-selected-end-date",k=n+"-in-range-cell",M=n+"-last-month-cell",I=n+"-next-month-btn-day",O=n+"-disabled-cell",j=n+"-disabled-cell-first-of-row",R=n+"-disabled-cell-last-of-row",L=n+"-last-day-of-month",F=o.clone(),U=((F=F.date(1)).day()+7-7)%7,Y=F.clone();Y=Y.add(0-U,"days");var B=0;for(u=0;u<C;u++)for(d=0;d<A;d++)p=Y,B&&(p=(p=p.clone()).add(B,"days")),f.push(p),B++;var H,V=[];for(B=0,u=0;u<C;u++){var G,q=void 0,z=void 0,W=!1,K=[];for(a&&(z=s.createElement("td",{key:f[B].week(),role:"gridcell",className:g},f[B].week())),d=0;d<A;d++){var Z=null,X=null;p=f[B],d<A-1&&(Z=f[B+1]),d>0&&(X=f[B-1]);var $=m,J=!1,Q=!1;N(p,h)&&($+=" "+x,q=!0);var ee=P(p,o),te=T(p,o);if(r&&Array.isArray(r)){var ne=c.length?c:r;if(!ee&&!te){var re=ne[0],oe=ne[1];re&&N(p,re)&&(Q=!0,W=!0,$+=" "+D),(re||oe)&&(N(p,oe)?(Q=!0,W=!0,$+=" "+E):(null!==re&&void 0!==re||!p.isBefore(oe,"day"))&&(null!==oe&&void 0!==oe||!p.isAfter(re,"day"))?p.isAfter(re,"day")&&p.isBefore(oe,"day")&&($+=" "+k):$+=" "+k)}}else N(p,o)&&(Q=!0,W=!0);N(p,r)&&($+=" "+_),ee&&($+=" "+M),te&&($+=" "+I),p.clone().endOf("month").date()===p.date()&&($+=" "+L),l&&l(p,o)&&(J=!0,X&&l(X,o)||($+=" "+j),Z&&l(Z,o)||($+=" "+R)),Q&&($+=" "+b),J&&($+=" "+O);var ae=void 0;if(i)ae=i(p,o);else{var ie=t?t(p,o):p.date();ae=s.createElement("div",{key:(H=p,"rc-calendar-"+H.year()+"-"+H.month()+"-"+H.date()),className:v,"aria-selected":Q,"aria-disabled":J},ie)}K.push(s.createElement("td",{key:B,onClick:J?void 0:e.onSelect.bind(null,p),onMouseEnter:J?void 0:e.onDayHover&&e.onDayHover.bind(null,p)||void 0,role:"gridcell",title:S(p),className:$},ae)),B++}V.push(s.createElement("tr",{key:u,role:"row",className:y()((G={},G[n+"-current-week"]=q,G[n+"-active-week"]=W,G))},z,K))}return s.createElement("tbody",{className:n+"-tbody"},V)},t}(s.Component);O.propTypes={contentRender:u().func,dateRender:u().func,disabledDate:u().func,prefixCls:u().string,selectedValue:u().oneOfType([u().object,u().arrayOf(u().object)]),value:u().object,hoverValue:u().any,showWeekNumber:u().bool},O.defaultProps={hoverValue:[]};var j=O,R=function(e){function t(){return(0,o.default)(this,t),(0,a.default)(this,e.apply(this,arguments))}return(0,i.default)(t,e),t.prototype.render=function(){var e=this.props,t=e.prefixCls;return s.createElement("table",{className:t+"-table",cellSpacing:"0",role:"grid"},s.createElement(g,e),s.createElement(j,e))},t}(s.Component),L=R,F=n(59398);function U(e){var t=this.state.value.clone();t=t.month(e),this.setAndSelectValue(t)}var Y=function(e){function t(n){(0,o.default)(this,t);var r=(0,a.default)(this,e.call(this,n));return r.state={value:n.value},r}return(0,i.default)(t,e),t.prototype.componentWillReceiveProps=function(e){"value"in e&&this.setState({value:e.value})},t.prototype.setAndSelectValue=function(e){this.setState({value:e}),this.props.onSelect(e)},t.prototype.months=function(){for(var e=this.state.value.clone(),t=[],n=0,r=0;r<4;r++){t[r]=[];for(var o=0;o<3;o++){var a=E(e=e.month(n));t[r][o]={value:n,content:a,title:a},n++}}return t},t.prototype.render=function(){var e=this,t=this.props,n=this.state.value,r=w(n),o=this.months(),a=n.month(),i=t.prefixCls,l=t.locale,c=t.contentRender,u=t.cellRender,d=o.map((function(o,d){var p=o.map((function(o){var d,p=!1;if(t.disabledDate){var f=n.clone();f=f.month(o.value),p=t.disabledDate(f)}var h=((d={})[i+"-cell"]=1,d[i+"-cell-disabled"]=p,d[i+"-selected-cell"]=o.value===a,d[i+"-current-cell"]=r.year()===n.year()&&o.value===r.month(),d),m=void 0;if(u){var g=n.clone();g=g.month(o.value),m=u(g,l)}else{var v=void 0;if(c){var C=n.clone();C=C.month(o.value),v=c(C,l)}else v=o.content;m=s.createElement("a",{className:i+"-month"},v)}return s.createElement("td",{role:"gridcell",key:o.value,onClick:p?null:U.bind(e,o.value),title:o.title,className:y()(h)},m)}));return s.createElement("tr",{key:d,role:"row"},p)}));return s.createElement("table",{className:i+"-table",cellSpacing:"0",role:"grid"},s.createElement("tbody",{className:i+"-tbody"},d))},t}(s.Component);Y.defaultProps={onSelect:function(){}},Y.propTypes={onSelect:u().func,cellRender:u().func,prefixCls:u().string,value:u().object};var B=Y;function H(e){this.props.changeYear(e)}function V(){}var G=function(e){function t(n){(0,o.default)(this,t);var r=(0,a.default)(this,e.call(this,n));return r.setAndSelectValue=function(e){r.setValue(e),r.props.onSelect(e)},r.setValue=function(e){"value"in r.props&&r.setState({value:e})},r.nextYear=H.bind(r,1),r.previousYear=H.bind(r,-1),r.prefixCls=n.rootPrefixCls+"-month-panel",r.state={value:n.value||n.defaultValue},r}return(0,i.default)(t,e),t.getDerivedStateFromProps=function(e){var t={};return"value"in e&&(t={value:e.value}),t},t.prototype.render=function(){var e=this.props,t=this.state.value,n=e.locale,r=e.cellRender,o=e.contentRender,a=e.renderFooter,i=t.year(),l=this.prefixCls,c=a&&a("month");return s.createElement("div",{className:l,style:e.style},s.createElement("div",null,s.createElement("div",{className:l+"-header"},s.createElement("a",{className:l+"-prev-year-btn",role:"button",onClick:this.previousYear,title:n.previousYear}),s.createElement("a",{className:l+"-year-select",role:"button",onClick:e.onYearPanelShow,title:n.yearSelect},s.createElement("span",{className:l+"-year-select-content"},i),s.createElement("span",{className:l+"-year-select-arrow"},"x")),s.createElement("a",{className:l+"-next-year-btn",role:"button",onClick:this.nextYear,title:n.nextYear})),s.createElement("div",{className:l+"-body"},s.createElement(B,{disabledDate:e.disabledDate,onSelect:this.setAndSelectValue,locale:n,value:t,cellRender:r,contentRender:o,prefixCls:l})),c&&s.createElement("div",{className:l+"-footer"},c)))},t}(s.Component);G.propTypes={onChange:u().func,disabledDate:u().func,onSelect:u().func,renderFooter:u().func,rootPrefixCls:u().string,value:u().object,defaultValue:u().object},G.defaultProps={onChange:V,onSelect:V},(0,p.polyfill)(G);var q=G;function z(e){var t=this.state.value.clone();t=t.add(e,"year"),this.setState({value:t})}function W(e){var t=this.state.value.clone();t=(t=t.year(e)).month(this.state.value.month()),this.setState({value:t}),this.props.onSelect(t)}var K=function(e){function t(n){(0,o.default)(this,t);var r=(0,a.default)(this,e.call(this,n));return r.prefixCls=n.rootPrefixCls+"-year-panel",r.state={value:n.value||n.defaultValue},r.nextDecade=z.bind(r,10),r.previousDecade=z.bind(r,-10),r}return(0,i.default)(t,e),t.prototype.years=function(){for(var e=this.state.value.year(),t=10*parseInt(e/10,10)-1,n=[],r=0,o=0;o<4;o++){n[o]=[];for(var a=0;a<3;a++){var i=t+r,s=String(i);n[o][a]={content:s,year:i,title:s},r++}}return n},t.prototype.render=function(){var e=this,t=this.props,n=this.state.value,r=t.locale,o=t.renderFooter,a=this.years(),i=n.year(),l=10*parseInt(i/10,10),c=l+9,u=this.prefixCls,d=a.map((function(t,n){var r=t.map((function(t){var n,r=((n={})[u+"-cell"]=1,n[u+"-selected-cell"]=t.year===i,n);return s.createElement("td",{role:"gridcell",title:t.title,key:t.content,onClick:W.bind(e,t.year),className:y()(r)},s.createElement("a",{className:u+"-year"},t.content))}));return s.createElement("tr",{key:n,role:"row"},r)})),p=o&&o("year");return s.createElement("div",{className:this.prefixCls},s.createElement("div",null,s.createElement("div",{className:u+"-header"},s.createElement("a",{className:u+"-prev-decade-btn",role:"button",onClick:this.previousDecade,title:r.previousDecade}),s.createElement("a",{className:u+"-decade-select",role:"button",onClick:t.onDecadePanelShow,title:r.decadeSelect},s.createElement("span",{className:u+"-decade-select-content"},l,"-",c),s.createElement("span",{className:u+"-decade-select-arrow"},"x")),s.createElement("a",{className:u+"-next-decade-btn",role:"button",onClick:this.nextDecade,title:r.nextDecade})),s.createElement("div",{className:u+"-body"},s.createElement("table",{className:u+"-table",cellSpacing:"0",role:"grid"},s.createElement("tbody",{className:u+"-tbody"},d))),p&&s.createElement("div",{className:u+"-footer"},p)))},t}(s.Component),Z=K;K.propTypes={rootPrefixCls:u().string,value:u().object,defaultValue:u().object,renderFooter:u().func},K.defaultProps={onSelect:function(){}};function X(e){var t=this.state.value.clone();t=t.add(e,"years"),this.setState({value:t})}function $(e,t){var n=this.state.value.clone();n=(n=n.year(e)).month(this.state.value.month()),this.props.onSelect(n),t.preventDefault()}var J=function(e){function t(n){(0,o.default)(this,t);var r=(0,a.default)(this,e.call(this,n));return r.state={value:n.value||n.defaultValue},r.prefixCls=n.rootPrefixCls+"-decade-panel",r.nextCentury=X.bind(r,100),r.previousCentury=X.bind(r,-100),r}return(0,i.default)(t,e),t.prototype.render=function(){for(var e=this,t=this.state.value,n=this.props,r=n.locale,o=n.renderFooter,a=t.year(),i=100*parseInt(a/100,10),l=i-10,c=i+99,u=[],d=0,p=this.prefixCls,f=0;f<4;f++){u[f]=[];for(var h=0;h<3;h++){var m=l+10*d,g=l+10*d+9;u[f][h]={startDecade:m,endDecade:g},d++}}var v=o&&o("decade"),C=u.map((function(t,n){var r=t.map((function(t){var n,r=t.startDecade,o=t.endDecade,l=r<i,u=o>c,d=((n={})[p+"-cell"]=1,n[p+"-selected-cell"]=r<=a&&a<=o,n[p+"-last-century-cell"]=l,n[p+"-next-century-cell"]=u,n),f=r+"-"+o,h=void 0;return h=l?e.previousCentury:u?e.nextCentury:$.bind(e,r),s.createElement("td",{key:r,onClick:h,role:"gridcell",className:y()(d)},s.createElement("a",{className:p+"-decade"},f))}));return s.createElement("tr",{key:n,role:"row"},r)}));return s.createElement("div",{className:this.prefixCls},s.createElement("div",{className:p+"-header"},s.createElement("a",{className:p+"-prev-century-btn",role:"button",onClick:this.previousCentury,title:r.previousCentury}),s.createElement("div",{className:p+"-century"},i,"-",c),s.createElement("a",{className:p+"-next-century-btn",role:"button",onClick:this.nextCentury,title:r.nextCentury})),s.createElement("div",{className:p+"-body"},s.createElement("table",{className:p+"-table",cellSpacing:"0",role:"grid"},s.createElement("tbody",{className:p+"-tbody"},C))),v&&s.createElement("div",{className:p+"-footer"},v))},t}(s.Component),Q=J;function ee(e){var t=this.props.value.clone();t=t.add(e,"months"),this.props.onValueChange(t)}function te(e){var t=this.props.value.clone();t=t.add(e,"years"),this.props.onValueChange(t)}function ne(e,t){return e?t:null}J.propTypes={locale:u().object,value:u().object,defaultValue:u().object,rootPrefixCls:u().string,renderFooter:u().func},J.defaultProps={onSelect:function(){}};var re=function(e){function t(n){(0,o.default)(this,t);var r=(0,a.default)(this,e.call(this,n));return oe.call(r),r.nextMonth=ee.bind(r,1),r.previousMonth=ee.bind(r,-1),r.nextYear=te.bind(r,1),r.previousYear=te.bind(r,-1),r.state={yearPanelReferer:null},r}return(0,i.default)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.prefixCls,r=t.locale,o=t.mode,a=t.value,i=t.showTimePicker,l=t.enableNext,c=t.enablePrev,u=t.disabledMonth,d=t.renderFooter,p=null;return"month"===o&&(p=s.createElement(q,{locale:r,value:a,rootPrefixCls:n,onSelect:this.onMonthSelect,onYearPanelShow:function(){return e.showYearPanel("month")},disabledDate:u,cellRender:t.monthCellRender,contentRender:t.monthCellContentRender,renderFooter:d,changeYear:this.changeYear})),"year"===o&&(p=s.createElement(Z,{locale:r,defaultValue:a,rootPrefixCls:n,onSelect:this.onYearSelect,onDecadePanelShow:this.showDecadePanel,renderFooter:d})),"decade"===o&&(p=s.createElement(Q,{locale:r,defaultValue:a,rootPrefixCls:n,onSelect:this.onDecadeSelect,renderFooter:d})),s.createElement("div",{className:n+"-header"},s.createElement("div",{style:{position:"relative"}},ne(c&&!i,s.createElement("a",{className:n+"-prev-year-btn",role:"button",onClick:this.previousYear,title:r.previousYear})),ne(c&&!i,s.createElement("a",{className:n+"-prev-month-btn",role:"button",onClick:this.previousMonth,title:r.previousMonth})),this.monthYearElement(i),ne(l&&!i,s.createElement("a",{className:n+"-next-month-btn",onClick:this.nextMonth,title:r.nextMonth})),ne(l&&!i,s.createElement("a",{className:n+"-next-year-btn",onClick:this.nextYear,title:r.nextYear}))),p)},t}(s.Component);re.propTypes={prefixCls:u().string,value:u().object,onValueChange:u().func,showTimePicker:u().bool,onPanelChange:u().func,locale:u().object,enablePrev:u().any,enableNext:u().any,disabledMonth:u().func,renderFooter:u().func,onMonthSelect:u().func},re.defaultProps={enableNext:1,enablePrev:1,onPanelChange:function(){},onValueChange:function(){}};var oe=function(){var e=this;this.onMonthSelect=function(t){e.props.onPanelChange(t,"date"),e.props.onMonthSelect?e.props.onMonthSelect(t):e.props.onValueChange(t)},this.onYearSelect=function(t){var n=e.state.yearPanelReferer;e.setState({yearPanelReferer:null}),e.props.onPanelChange(t,n),e.props.onValueChange(t)},this.onDecadeSelect=function(t){e.props.onPanelChange(t,"year"),e.props.onValueChange(t)},this.changeYear=function(t){t>0?e.nextYear():e.previousYear()},this.monthYearElement=function(t){var n=e.props,r=n.prefixCls,o=n.locale,a=n.value,i=a.localeData(),l=o.monthBeforeYear,c=r+"-"+(l?"my-select":"ym-select"),u=t?" "+r+"-time-status":"",d=s.createElement("a",{className:r+"-year-select"+u,role:"button",onClick:t?null:function(){return e.showYearPanel("date")},title:t?null:o.yearSelect},a.format(o.yearFormat)),p=s.createElement("a",{className:r+"-month-select"+u,role:"button",onClick:t?null:e.showMonthPanel,title:t?null:o.monthSelect},o.monthFormat?a.format(o.monthFormat):i.monthsShort(a)),f=void 0;t&&(f=s.createElement("a",{className:r+"-day-select"+u,role:"button"},a.format(o.dayFormat)));var h=[];return h=l?[p,f,d]:[d,p,f],s.createElement("span",{className:c},(0,F.A)(h))},this.showMonthPanel=function(){e.props.onPanelChange(null,"month")},this.showYearPanel=function(t){e.setState({yearPanelReferer:t}),e.props.onPanelChange(null,"year")},this.showDecadePanel=function(){e.props.onPanelChange(null,"decade")}},ae=re;function ie(e){var t=e.prefixCls,n=e.locale,r=e.value,o=e.timePicker,a=e.disabled,i=e.disabledDate,l=e.onToday,c=e.text,u=(!c&&o?n.now:c)||n.today,d=i&&!M(w(r),i)||a,p=d?t+"-today-btn-disabled":"";return s.createElement("a",{className:t+"-today-btn "+p,role:"button",onClick:d?null:l,title:D(r)},u)}function se(e){var t=e.prefixCls,n=e.locale,r=e.okDisabled,o=e.onOk,a=t+"-ok-btn";return r&&(a+=" "+t+"-ok-btn-disabled"),s.createElement("a",{className:a,role:"button",onClick:r?null:o},n.ok)}function le(e){var t,n=e.prefixCls,r=e.locale,o=e.showTimePicker,a=e.onOpenTimePicker,i=e.onCloseTimePicker,l=e.timePickerDisabled,c=y()(((t={})[n+"-time-picker-btn"]=!0,t[n+"-time-picker-btn-disabled"]=l,t)),u=null;return l||(u=o?i:a),s.createElement("a",{className:c,role:"button",onClick:u},o?r.dateSelect:r.timeSelect)}var ce=function(e){function t(){return(0,o.default)(this,t),(0,a.default)(this,e.apply(this,arguments))}return(0,i.default)(t,e),t.prototype.onSelect=function(e){this.props.onSelect(e)},t.prototype.getRootDOMNode=function(){return l.findDOMNode(this)},t.prototype.render=function(){var e=this.props,t=e.value,n=e.prefixCls,o=e.showOk,a=e.timePicker,i=e.renderFooter,l=e.mode,c=null,u=i&&i(l);if(e.showToday||a||u){var d,p=void 0;e.showToday&&(p=s.createElement(ie,(0,r.default)({},e,{value:t})));var f=void 0;(!0===o||!1!==o&&e.timePicker)&&(f=s.createElement(se,e));var h=void 0;e.timePicker&&(h=s.createElement(le,e));var m=void 0;(p||h||f||u)&&(m=s.createElement("span",{className:n+"-footer-btn"},u,(0,F.A)([p,h,f])));var g=y()(n+"-footer",((d={})[n+"-footer-show-ok"]=f,d));c=s.createElement("div",{className:g},m)}return c},t}(s.Component);ce.propTypes={prefixCls:u().string,showDateInput:u().bool,disabledTime:u().any,timePicker:u().element,selectedValue:u().any,showOk:u().bool,onSelect:u().func,value:u().object,renderFooter:u().func,defaultValue:u().object,mode:u().string};var ue=ce,de=function(e){function t(n){(0,o.default)(this,t);var r=(0,a.default)(this,e.call(this,n));return r.onSelect=function(e){r.setState({highlightTime:e}),r.props.onSelect(e),r.props.onClickRightPanelTime()},r.getTimes=function(){for(var e=[],t=0;t<24;t++){var n=(String(t)+":00").padStart(5,"0"),r=(String(t)+":30").padStart(5,"0");e.push(n),e.push(r)}return e},r.scrollUp=function(){r.timeRef.current.scrollBy(0,-200)},r.scrollDown=function(){r.timeRef.current.scrollBy(0,200)},r.state={highlightTime:r.props.value||null},r.timeRef=s.createRef(),r.times=r.getTimes(),r}return(0,i.default)(t,e),t.prototype.componentDidMount=function(){var e=this.props.defaultMinutesTime,t=this.times.findIndex((function(t){return t===e})),n=t>-1?t:16;this.timeRef.current.scrollTo(0,34*n)},t.prototype.render=function(){var e=this,t=this.props,n=t.value,r=t.prefixCls,o=t.locale,a=n.format().slice(0,10),i=this.state.highlightTime,l=i?i.format().slice(11,16):null,c=o&&"\u4eca\u5929"===o.today;return s.createElement("div",{className:r+"-right-panel"},s.createElement("div",{className:r+"-right-panel-header",onClick:this.scrollUp},s.createElement("span",null)),s.createElement("div",{className:r+"-right-panel-body",ref:this.timeRef},s.createElement("ul",null,this.times.map((function(t){var n=h()(a+" "+t);return n=c?n.locale("zh-cn"):n.locale("en-gb"),s.createElement("li",{key:t,onClick:e.onSelect.bind(e,n),className:l===t?r+"-selected-time":""},t)})))),s.createElement("div",{className:r+"-right-panel-footer",onClick:this.scrollDown},s.createElement("span",null)))},t}(s.Component);de.propTypes={prefixCls:u().string,value:u().object,onSelect:u().func,onClickRightPanelTime:u().func,locale:u().object,defaultMinutesTime:u().string};var pe=de;function fe(e){return e?w(e):h()()}var he={value:u().object,defaultValue:u().object,onKeyDown:u().func},me={onKeyDown:function(){}};function ge(){}var ve={className:u().string,locale:u().object,style:u().object,visible:u().bool,onSelect:u().func,prefixCls:u().string,onChange:u().func,onOk:u().func},ye={locale:{today:"Today",now:"Now",backToToday:"Back to today",ok:"Ok",clear:"Clear",month:"Month",year:"Year",timeSelect:"select time",dateSelect:"select date",weekSelect:"Choose a week",monthSelect:"Choose a month",yearSelect:"Choose a year",decadeSelect:"Choose a decade",yearFormat:"YYYY",dateFormat:"M/D/YYYY",dayFormat:"D",dateTimeFormat:"M/D/YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Previous month (PageUp)",nextMonth:"Next month (PageDown)",previousYear:"Last year (Control + left)",nextYear:"Next year (Control + right)",previousDecade:"Last decade",nextDecade:"Next decade",previousCentury:"Last century",nextCentury:"Next century"},style:{},visible:!0,prefixCls:"rc-calendar",className:"",onSelect:ge,onChange:ge,onClear:ge,renderFooter:function(){return null},renderSidebar:function(){return null}},Ce=void 0,Ae=void 0,xe=void 0,be=function(e){function t(n){(0,o.default)(this,t);var r=(0,a.default)(this,e.call(this,n));_e.call(r);var i=n.selectedValue;return r.state={str:I(i,r.props.format),invalid:!1,hasFocus:!1},r}return(0,i.default)(t,e),t.prototype.componentDidUpdate=function(){!xe||!this.state.hasFocus||this.state.invalid||0===Ce&&0===Ae||xe.setSelectionRange(Ce,Ae)},t.getDerivedStateFromProps=function(e,t){var n={};xe&&(Ce=xe.selectionStart,Ae=xe.selectionEnd);var r=e.selectedValue;return t.hasFocus||(n={str:I(r,e.format),invalid:!1}),n},t.getInstance=function(){return xe},t.prototype.render=function(){var e=this.props,t=this.state,n=t.invalid,r=t.str,o=e.locale,a=e.prefixCls,i=e.placeholder,l=e.clearIcon,c=e.inputMode,u=n?a+"-input-invalid":"";return s.createElement("div",{className:a+"-input-wrap"},s.createElement("div",{className:a+"-date-input-wrap"},s.createElement("input",{ref:this.saveDateInput,className:a+"-input "+u,value:r,disabled:e.disabled,placeholder:i,onChange:this.onInputChange,onKeyDown:this.onKeyDown,onFocus:this.onFocus,onBlur:this.onBlur,inputMode:c})),e.showClear?s.createElement("a",{role:"button",title:o.clear,onClick:this.onClear},l||s.createElement("span",{className:a+"-clear-btn"})):null)},t}(s.Component);be.propTypes={prefixCls:u().string,timePicker:u().object,value:u().object,disabledTime:u().any,format:u().oneOfType([u().string,u().arrayOf(u().string)]),locale:u().object,disabledDate:u().func,onChange:u().func,onClear:u().func,placeholder:u().string,onSelect:u().func,selectedValue:u().object,clearIcon:u().node,inputMode:u().string};var _e=function(){var e=this;this.onClear=function(){e.setState({str:""}),e.props.onClear(null)},this.onInputChange=function(t){var n=t.target.value,r=e.props,o=r.disabledDate,a=r.format,i=r.onChange,s=r.selectedValue;if(!n)return i(null),void e.setState({invalid:!1,str:n});var l=h()(n,a,!0);if(l.isValid()){var c=e.props.value.clone();!(c=c.year(l.year()).month(l.month()).date(l.date()).hour(l.hour()).minute(l.minute()).second(l.second()))||o&&o(c)?e.setState({invalid:!0,str:n}):(s!==c||s&&c&&!s.isSame(c))&&(e.setState({invalid:!1,str:n}),i(c))}else e.setState({invalid:!0,str:n})},this.onFocus=function(){e.setState({hasFocus:!0})},this.onBlur=function(){e.setState((function(e,t){return{hasFocus:!1,str:I(t.value,t.format)}}))},this.onKeyDown=function(t){var n=t.keyCode,r=e.props,o=r.onSelect,a=r.value,i=r.disabledDate;n===d.A.ENTER&&o&&((!i||!i(a))&&o(a.clone()),t.preventDefault())},this.getRootDOMNode=function(){return l.findDOMNode(e)},this.focus=function(){xe&&xe.focus()},this.saveDateInput=function(e){xe=e}};(0,p.polyfill)(be);var we=be;var Se=n(43650),De=n.n(Se),Ee=n(97676),ke=n.n(Ee);function Me(){}h().extend(b()),h().extend(De()),h().extend(ke());var Ie=function(e){return!(!h().isDayjs(e)||!e.isValid())&&e},Ne=function(e){function t(n){(0,o.default)(this,t);var r=(0,a.default)(this,e.call(this,n));return Pe.call(r),r.state={mode:r.props.mode||"date",value:Ie(n.value)||Ie(n.defaultValue)||h()(),selectedValue:n.selectedValue||n.defaultSelectedValue},r}return(0,i.default)(t,e),t.prototype.componentDidMount=function(){this.props.showDateInput&&this.saveFocusElement(we.getInstance())},t.getDerivedStateFromProps=function(e,t){var n=e.value,r=e.selectedValue,o={};return"mode"in e&&t.mode!==e.mode&&(o={mode:e.mode}),"value"in e&&(o.value=Ie(n)||Ie(e.defaultValue)||fe(t.value)),"selectedValue"in e&&(o.selectedValue=r),o},t.prototype.render=function(){var e=this.props,t=this.state,n=e.locale,o=e.prefixCls,a=e.disabledDate,i=e.dateInputPlaceholder,l=e.timePicker,c=e.onClickRightPanelTime,u=e.disabledTime,d=e.clearIcon,p=e.renderFooter,f=e.inputMode,h=e.showHourAndMinute,m=t.value,g=t.selectedValue,v=t.mode,y="time"===v,C=y&&u&&l?k(g,u):null,A=null;if(l&&y){var x=(0,r.default)({showHour:!0,showSecond:!0,showMinute:!0},l.props,C,{onChange:this.onDateInputChange,value:g,disabledTime:u});void 0!==l.props.defaultValue&&(x.defaultOpenValue=l.props.defaultValue),A=s.cloneElement(l,x)}var b=e.showDateInput?s.createElement(we,{format:this.getFormat(),key:"date-input",value:m,locale:n,placeholder:i,showClear:!0,disabledTime:u,disabledDate:a,onClear:this.onClear,prefixCls:o,selectedValue:g,onChange:this.onDateInputChange,onSelect:this.onDateInputSelect,clearIcon:d,inputMode:f}):null,_=[];return e.renderSidebar&&_.push(e.renderSidebar()),_.push(s.createElement("div",{className:o+"-panel",key:"panel"},b,s.createElement("div",{className:o+"-date-panel-container"},s.createElement("div",{tabIndex:this.props.focusablePanel?0:void 0,className:o+"-date-panel"},s.createElement(ae,{locale:n,mode:v,value:m,onValueChange:this.setValue,onPanelChange:this.onPanelChange,renderFooter:p,showTimePicker:y,prefixCls:o}),l&&y?s.createElement("div",{className:o+"-time-picker"},s.createElement("div",{className:o+"-time-picker-panel"},A)):null,s.createElement("div",{className:o+"-body"},s.createElement(L,{locale:n,value:m,selectedValue:g,prefixCls:o,dateRender:e.dateRender,onSelect:this.onDateTableSelect,disabledDate:a,showWeekNumber:e.showWeekNumber})),s.createElement(ue,{showOk:e.showOk,mode:v,renderFooter:e.renderFooter,locale:n,prefixCls:o,showToday:e.showToday,disabledTime:u,showTimePicker:y,showDateInput:e.showDateInput,timePicker:l,selectedValue:g,value:m,disabledDate:a,okDisabled:!1!==e.showOk&&(!g||!this.isAllowedDate(g)),onOk:this.onOk,onSelect:this.onSelect,onToday:this.onToday,onOpenTimePicker:this.openTimePicker,onCloseTimePicker:this.closeTimePicker})),h&&s.createElement(pe,{prefixCls:o,value:m,locale:n,onSelect:this.onDateTableSelect,onClickRightPanelTime:c,defaultMinutesTime:this.props.defaultMinutesTime})))),this.renderRoot({children:_,className:e.showWeekNumber?o+"-week-number":""})},t}(s.Component);Ne.propTypes=(0,r.default)({},he,ve,{prefixCls:u().string,className:u().string,style:u().object,defaultValue:u().object,value:u().object,selectedValue:u().object,defaultSelectedValue:u().object,mode:u().oneOf(["time","date","month","year","decade"]),locale:u().object,showDateInput:u().bool,showWeekNumber:u().bool,showToday:u().bool,showOk:u().bool,showHourAndMinute:u().bool,defaultMinutesTime:u().string,onSelect:u().func,onOk:u().func,onKeyDown:u().func,timePicker:u().element,dateInputPlaceholder:u().any,onClear:u().func,onChange:u().func,onPanelChange:u().func,disabledDate:u().func,disabledTime:u().any,dateRender:u().func,renderFooter:u().func,renderSidebar:u().func,clearIcon:u().node,focusablePanel:u().bool,inputMode:u().string,onBlur:u().func,onClickRightPanelTime:u().func}),Ne.defaultProps=(0,r.default)({},me,ye,{showToday:!0,showDateInput:!0,showHourAndMinute:!1,timePicker:null,onOk:Me,onPanelChange:Me,onClickRightPanelTime:Me,focusablePanel:!0});var Pe=function(){var e=this;this.onPanelChange=function(t,n){var r=e.props,o=e.state;"mode"in r||e.setState({mode:n}),r.onPanelChange(t||o.value,n)},this.onKeyDown=function(t){if("input"!==t.target.nodeName.toLowerCase()){var n=t.keyCode,r=t.ctrlKey||t.metaKey,o=e.props.disabledDate,a=e.state.value;switch(n){case d.A.DOWN:return e.goTime(1,"weeks"),t.preventDefault(),1;case d.A.UP:return e.goTime(-1,"weeks"),t.preventDefault(),1;case d.A.LEFT:return r?e.goTime(-1,"years"):e.goTime(-1,"days"),t.preventDefault(),1;case d.A.RIGHT:return r?e.goTime(1,"years"):e.goTime(1,"days"),t.preventDefault(),1;case d.A.HOME:return e.setValue(e.state.value.clone().startOf("month")),t.preventDefault(),1;case d.A.END:return e.setValue(function(e){return e.clone().endOf("month")}(e.state.value)),t.preventDefault(),1;case d.A.PAGE_DOWN:return e.goTime(1,"month"),t.preventDefault(),1;case d.A.PAGE_UP:return e.goTime(-1,"month"),t.preventDefault(),1;case d.A.ENTER:return o&&o(a)||e.onSelect(a,{source:"keyboard"}),t.preventDefault(),1;default:return e.props.onKeyDown(t),1}}},this.onClear=function(){e.onSelect(null),e.props.onClear()},this.onOk=function(){var t=e.state.selectedValue;e.isAllowedDate(t)&&e.props.onOk(t)},this.onDateInputChange=function(t){e.onSelect(t,{source:"dateInput"})},this.onDateInputSelect=function(t){e.onSelect(t,{source:"dateInputSelect"})},this.onDateTableSelect=function(t){var n,r,o=e.props.timePicker;if(!e.state.selectedValue&&o){var a=o.props.defaultValue;a&&(n=a,r=t,h().isDayjs(n)&&h().isDayjs(r)&&(r=(r=(r=(r=r.hour(n.hour())).minute(n.minute())).second(n.second())).millisecond(n.millisecond())))}e.onSelect(t)},this.onToday=function(){var t=w(e.state.value);e.onSelect(t,{source:"todayButton"})},this.onBlur=function(t){setTimeout((function(){var n=we.getInstance(),r=e.rootInstance;!r||r.contains(document.activeElement)||n&&n.contains(document.activeElement)||e.props.onBlur&&e.props.onBlur(t)}),0)},this.getRootDOMNode=function(){return l.findDOMNode(e)},this.openTimePicker=function(){e.onPanelChange(null,"time")},this.closeTimePicker=function(){e.onPanelChange(null,"date")},this.goTime=function(t,n){e.setValue(function(e,t,n){return e.clone().add(t,n)}(e.state.value,t,n))}};(0,p.polyfill)(Ne);var Te=function(e){var t,n;return n=t=function(t){function n(){var e,r,i;(0,o.default)(this,n);for(var l=arguments.length,c=Array(l),u=0;u<l;u++)c[u]=arguments[u];return e=r=(0,a.default)(this,t.call.apply(t,[this].concat(c))),r.onSelect=function(e,t){e&&r.setValue(e),r.setSelectedValue(e,t)},r.renderRoot=function(e){var t,n=r.props,o=n.prefixCls,a=((t={})[o]=1,t[o+"-hidden"]=!n.visible,t[n.className]=!!n.className,t[e.className]=!!e.className,t);return s.createElement("div",{ref:r.saveRoot,className:""+y()(a),style:r.props.style,tabIndex:"0",onKeyDown:r.onKeyDown,onBlur:r.onBlur},e.children)},r.setSelectedValue=function(e,t){"selectedValue"in r.props||r.setState({selectedValue:e}),r.props.onSelect&&r.props.onSelect(e,t)},r.setValue=function(e){var t=r.state.value;"value"in r.props||r.setState({value:e}),(t&&e&&!t.isSame(e)||!t&&e||t&&!e)&&r.props.onChange(e)},r.isAllowedDate=function(e){return M(e,r.props.disabledDate,r.props.disabledTime)},i=e,(0,a.default)(r,i)}return(0,i.default)(n,t),n.getDerivedStateFromProps=function(t,n){if(e.getDerivedStateFromProps)return e.getDerivedStateFromProps(t,n);var r=t.value,o=t.selectedValue,a={};return"value"in t&&(a.value=r||t.defaultValue||fe(n.value)),"selectedValue"in t&&(a.selectedValue=o),a},n}(e),t.displayName="CalendarMixinWrapper",t.defaultProps=e.defaultProps,n}(function(e){var t,n;return n=t=function(e){function t(){var n,r,i;(0,o.default)(this,t);for(var s=arguments.length,l=Array(s),c=0;c<s;c++)l[c]=arguments[c];return n=r=(0,a.default)(this,e.call.apply(e,[this].concat(l))),r.getFormat=function(){var e=r.props.format,t=r.props,n=t.locale,o=t.timePicker;return e||(e=o?n.dateTimeFormat:n.dateFormat),e},r.focus=function(){r.focusElement?r.focusElement.focus():r.rootInstance&&r.rootInstance.focus()},r.saveFocusElement=function(e){r.focusElement=e},r.saveRoot=function(e){r.rootInstance=e},i=n,(0,a.default)(r,i)}return(0,i.default)(t,e),t.prototype.shouldComponentUpdate=function(e){return this.props.visible||e.visible},t}(e),t.displayName="CommonMixinWrapper",t.defaultProps=e.defaultProps,t.getDerivedStateFromProps=e.getDerivedStateFromProps,n}(Ne)),Oe=Te},39739:function(e,t,n){"use strict";t.__esModule=!0;var r=h(n(26380)),o=h(n(52889)),a=h(n(5316)),i=h(n(9950)),s=h(n(17119)),l=h(n(11942)),c=n(4899),u=h(n(19699)),d=h(n(13225)),p=h(n(32886)),f=h(n(826));function h(e){return e&&e.__esModule?e:{default:e}}function m(){}function g(e,t){this[e]=t}var v=function(e){function t(n){(0,r.default)(this,t);var a=(0,o.default)(this,e.call(this,n));y.call(a);var i=void 0;i="open"in n?n.open:n.defaultOpen;var s=n.value||n.defaultValue;return a.saveCalendarRef=g.bind(a,"calendarInstance"),a.state={open:i,value:s},a}return(0,a.default)(t,e),t.prototype.componentDidUpdate=function(e,t){!t.open&&this.state.open&&(this.focusTimeout=setTimeout(this.focusCalendar,0,this))},t.prototype.componentWillUnmount=function(){clearTimeout(this.focusTimeout)},t.getDerivedStateFromProps=function(e){var t={},n=e.value,r=e.open;return"value"in e&&(t.value=n),void 0!==r&&(t.open=r),t},t.prototype.render=function(){var e=this.props,t=e.prefixCls,n=e.placement,r=e.style,o=e.getCalendarContainer,a=e.align,s=e.animation,l=e.disabled,c=e.dropdownClassName,u=e.transitionName,d=e.children,h=this.state;return i.default.createElement(f.default,{popup:this.getCalendarElement(),popupAlign:a,builtinPlacements:p.default,popupPlacement:n,action:l&&!h.open?[]:["click"],destroyPopupOnHide:!0,getPopupContainer:o,popupStyle:r,popupAnimation:s,popupTransitionName:u,popupVisible:h.open,onPopupVisibleChange:this.onVisibleChange,prefixCls:t,popupClassName:c},i.default.cloneElement(d(h,e),{onKeyDown:this.onKeyDown}))},t}(i.default.Component);v.propTypes={animation:l.default.oneOfType([l.default.func,l.default.string]),disabled:l.default.bool,transitionName:l.default.string,onChange:l.default.func,onOpenChange:l.default.func,children:l.default.func,getCalendarContainer:l.default.func,calendar:l.default.element,style:l.default.object,open:l.default.bool,defaultOpen:l.default.bool,prefixCls:l.default.string,placement:l.default.any,value:l.default.oneOfType([l.default.object,l.default.array]),defaultValue:l.default.oneOfType([l.default.object,l.default.array]),align:l.default.object,dateRender:l.default.func,onBlur:l.default.func},v.defaultProps={prefixCls:"rc-calendar-picker",style:{},align:{},placement:"bottomLeft",defaultOpen:!1,onChange:m,onOpenChange:m,onBlur:m};var y=function(){var e=this;this.onCalendarKeyDown=function(t){t.keyCode===d.default.ESC&&(t.stopPropagation(),e.close(e.focus))},this.onCalendarSelect=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.props;"value"in r||e.setState({value:t}),("keyboard"===n.source||"dateInputSelect"===n.source||!r.calendar.props.timePicker&&"dateInput"!==n.source||"todayButton"===n.source)&&e.close(e.focus),r.onChange(t)},this.onKeyDown=function(t){e.state.open||t.keyCode!==d.default.DOWN&&t.keyCode!==d.default.ENTER||(e.open(),t.preventDefault())},this.onCalendarOk=function(){e.close(e.focus)},this.onCalendarClear=function(){e.close(e.focus)},this.onCalendarBlur=function(){e.setOpen(!1)},this.onVisibleChange=function(t){e.setOpen(t)},this.getCalendarElement=function(){var t=e.props,n=e.state,r=t.calendar.props,o=n.value,a=o,s={ref:e.saveCalendarRef,defaultValue:a||r.defaultValue,selectedValue:o,onKeyDown:e.onCalendarKeyDown,onOk:(0,u.default)(r.onOk,e.onCalendarOk),onSelect:(0,u.default)(r.onSelect,e.onCalendarSelect),onClear:(0,u.default)(r.onClear,e.onCalendarClear),onBlur:(0,u.default)(r.onBlur,e.onCalendarBlur)};return i.default.cloneElement(t.calendar,s)},this.setOpen=function(t,n){var r=e.props.onOpenChange;e.state.open!==t&&("open"in e.props||e.setState({open:t},n),r(t))},this.open=function(t){e.setOpen(!0,t)},this.close=function(t){e.setOpen(!1,t)},this.focus=function(){e.state.open||s.default.findDOMNode(e).focus()},this.focusCalendar=function(){e.state.open&&e.calendarInstance&&e.calendarInstance.focus()}};(0,c.polyfill)(v),t.default=v,e.exports=t.default},19550:function(e,t){"use strict";t.__esModule=!0,t.default={today:"Dnes",now:"Nyn\xed",backToToday:"Zp\u011bt na dne\u0161ek",ok:"Ok",clear:"Vymazat",month:"M\u011bs\xedc",year:"Rok",timeSelect:"Vybrat \u010das",dateSelect:"Vybrat datum",monthSelect:"Vyberte m\u011bs\xedc",yearSelect:"Vyberte rok",decadeSelect:"Vyberte dek\xe1du",yearFormat:"YYYY",dateFormat:"D.M.YYYY",dayFormat:"D",dateTimeFormat:"D.M.YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"P\u0159edchoz\xed m\u011bs\xedc (PageUp)",nextMonth:"N\xe1sleduj\xedc\xed (PageDown)",previousYear:"P\u0159edchoz\xed rok (Control + left)",nextYear:"N\xe1sleduj\xedc\xed rok (Control + right)",previousDecade:"P\u0159edchoz\xed dek\xe1da",nextDecade:"N\xe1sleduj\xedc\xed dek\xe1da",previousCentury:"P\u0159edchoz\xed stolet\xed",nextCentury:"N\xe1sleduj\xedc\xed stolet\xed"},e.exports=t.default},10507:function(e,t){"use strict";t.__esModule=!0,t.default={today:"Heute",now:"Jetzt",backToToday:"Zur\xfcck zu Heute",ok:"OK",clear:"Zur\xfccksetzen",month:"Monat",year:"Jahr",timeSelect:"Zeit w\xe4hlen",dateSelect:"Datum w\xe4hlen",monthSelect:"W\xe4hle einen Monat",yearSelect:"W\xe4hle ein Jahr",decadeSelect:"W\xe4hle ein Jahrzehnt",yearFormat:"YYYY",dateFormat:"D.M.YYYY",dayFormat:"D",dateTimeFormat:"D.M.YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Vorheriger Monat (PageUp)",nextMonth:"N\xe4chster Monat (PageDown)",previousYear:"Vorheriges Jahr (Ctrl + left)",nextYear:"N\xe4chstes Jahr (Ctrl + right)",previousDecade:"Vorheriges Jahrzehnt",nextDecade:"N\xe4chstes Jahrzehnt",previousCentury:"Vorheriges Jahrhundert",nextCentury:"N\xe4chstes Jahrhundert"},e.exports=t.default},37932:function(e,t){"use strict";t.__esModule=!0,t.default={today:"Today",now:"Now",backToToday:"Back to today",ok:"Ok",clear:"Clear",month:"Month",year:"Year",timeSelect:"select time",dateSelect:"select date",weekSelect:"Choose a week",monthSelect:"Choose a month",yearSelect:"Choose a year",decadeSelect:"Choose a decade",yearFormat:"YYYY",dateFormat:"M/D/YYYY",dayFormat:"D",dateTimeFormat:"M/D/YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Previous month (PageUp)",nextMonth:"Next month (PageDown)",previousYear:"Last year (Control + left)",nextYear:"Next year (Control + right)",previousDecade:"Last decade",nextDecade:"Next decade",previousCentury:"Last century",nextCentury:"Next century"},e.exports=t.default},1205:function(e,t){"use strict";t.__esModule=!0,t.default={today:"Hoy",now:"Ahora",backToToday:"Volver a hoy",ok:"Aceptar",clear:"Limpiar",month:"Mes",year:"A\xf1o",timeSelect:"Seleccionar hora",dateSelect:"Seleccionar fecha",monthSelect:"Elegir un mes",yearSelect:"Elegir un a\xf1o",decadeSelect:"Elegir una d\xe9cada",yearFormat:"YYYY",dateFormat:"D/M/YYYY",dayFormat:"D",dateTimeFormat:"D/M/YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Mes anterior (PageUp)",nextMonth:"Mes siguiente (PageDown)",previousYear:"A\xf1o anterior (Control + left)",nextYear:"A\xf1o siguiente (Control + right)",previousDecade:"D\xe9cada anterior",nextDecade:"D\xe9cada siguiente",previousCentury:"Siglo anterior",nextCentury:"Siglo siguiente"},e.exports=t.default},88309:function(e,t){"use strict";t.__esModule=!0,t.default={today:"Aujourd'hui",now:"Maintenant",backToToday:"Aujourd'hui",ok:"Ok",clear:"R\xe9tablir",month:"Mois",year:"Ann\xe9e",timeSelect:"S\xe9lectionner l'heure",dateSelect:"S\xe9lectionner la date",monthSelect:"Choisissez un mois",yearSelect:"Choisissez une ann\xe9e",decadeSelect:"Choisissez une d\xe9cennie",yearFormat:"YYYY",dateFormat:"DD/MM/YYYY",dayFormat:"DD",dateTimeFormat:"DD/MM/YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Mois pr\xe9c\xe9dent (PageUp)",nextMonth:"Mois suivant (PageDown)",previousYear:"Ann\xe9e pr\xe9c\xe9dente (Ctrl + gauche)",nextYear:"Ann\xe9e prochaine (Ctrl + droite)",previousDecade:"D\xe9cennie pr\xe9c\xe9dente",nextDecade:"D\xe9cennie suivante",previousCentury:"Si\xe8cle pr\xe9c\xe9dent",nextCentury:"Si\xe8cle suivant"},e.exports=t.default},16969:function(e,t){"use strict";t.__esModule=!0,t.default={today:"Dzisiaj",now:"Teraz",backToToday:"Ustaw dzisiaj",ok:"Ok",clear:"Wyczy\u015b\u0107",month:"Miesi\u0105c",year:"Rok",timeSelect:"Ustaw czas",dateSelect:"Ustaw dat\u0119",monthSelect:"Wybierz miesi\u0105c",yearSelect:"Wybierz rok",decadeSelect:"Wybierz dekad\u0119",yearFormat:"YYYY",dateFormat:"D/M/YYYY",dayFormat:"D",dateTimeFormat:"D/M/YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Poprzedni miesi\u0105c (PageUp)",nextMonth:"Nast\u0119pny miesi\u0105c (PageDown)",previousYear:"Ostatni rok (Ctrl + left)",nextYear:"Nast\u0119pny rok (Ctrl + right)",previousDecade:"Ostatnia dekada",nextDecade:"Nast\u0119pna dekada",previousCentury:"Ostatni wiek",nextCentury:"Nast\u0119pny wiek"},e.exports=t.default},36967:function(e,t){"use strict";t.__esModule=!0,t.default={today:"\u0421\u0435\u0433\u043e\u0434\u043d\u044f",now:"\u0421\u0435\u0439\u0447\u0430\u0441",backToToday:"\u0422\u0435\u043a\u0443\u0449\u0430\u044f \u0434\u0430\u0442\u0430",ok:"Ok",clear:"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c",month:"\u041c\u0435\u0441\u044f\u0446",year:"\u0413\u043e\u0434",timeSelect:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0432\u0440\u0435\u043c\u044f",dateSelect:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0434\u0430\u0442\u0443",monthSelect:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u043c\u0435\u0441\u044f\u0446",yearSelect:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0433\u043e\u0434",decadeSelect:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0434\u0435\u0441\u044f\u0442\u0438\u043b\u0435\u0442\u0438\u0435",yearFormat:"YYYY",dateFormat:"D-M-YYYY",dayFormat:"D",dateTimeFormat:"D-M-YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"\u041f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u0439 \u043c\u0435\u0441\u044f\u0446 (PageUp)",nextMonth:"\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 \u043c\u0435\u0441\u044f\u0446 (PageDown)",previousYear:"\u041f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u0439 \u0433\u043e\u0434 (Control + left)",nextYear:"\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 \u0433\u043e\u0434 (Control + right)",previousDecade:"\u041f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0435\u0435 \u0434\u0435\u0441\u044f\u0442\u0438\u043b\u0435\u0442\u0438\u0435",nextDecade:"\u0421\u043b\u0435\u0434\u0443\u0449\u0435\u0435 \u0434\u0435\u0441\u044f\u0442\u0438\u043b\u0435\u0442\u0438\u0435",previousCentury:"\u041f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u0439 \u0432\u0435\u043a",nextCentury:"\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 \u0432\u0435\u043a"},e.exports=t.default},95502:function(e,t){"use strict";t.__esModule=!0,t.default={today:"\u4eca\u5929",now:"\u6b64\u523b",backToToday:"\u8fd4\u56de\u4eca\u5929",ok:"\u786e\u5b9a",timeSelect:"\u9009\u62e9\u65f6\u95f4",dateSelect:"\u9009\u62e9\u65e5\u671f",weekSelect:"\u9009\u62e9\u5468",clear:"\u6e05\u9664",month:"\u6708",year:"\u5e74",previousMonth:"\u4e0a\u4e2a\u6708 (\u7ffb\u9875\u4e0a\u952e)",nextMonth:"\u4e0b\u4e2a\u6708 (\u7ffb\u9875\u4e0b\u952e)",monthSelect:"\u9009\u62e9\u6708\u4efd",yearSelect:"\u9009\u62e9\u5e74\u4efd",decadeSelect:"\u9009\u62e9\u5e74\u4ee3",yearFormat:"YYYY\u5e74",dayFormat:"D\u65e5",dateFormat:"YYYY\u5e74M\u6708D\u65e5",dateTimeFormat:"YYYY\u5e74M\u6708D\u65e5 HH\u65f6mm\u5206ss\u79d2",previousYear:"\u4e0a\u4e00\u5e74 (Control\u952e\u52a0\u5de6\u65b9\u5411\u952e)",nextYear:"\u4e0b\u4e00\u5e74 (Control\u952e\u52a0\u53f3\u65b9\u5411\u952e)",previousDecade:"\u4e0a\u4e00\u5e74\u4ee3",nextDecade:"\u4e0b\u4e00\u5e74\u4ee3",previousCentury:"\u4e0a\u4e00\u4e16\u7eaa",nextCentury:"\u4e0b\u4e00\u4e16\u7eaa"},e.exports=t.default},33850:function(e,t){"use strict";t.__esModule=!0,t.default={today:"\u4eca\u5929",now:"\u6b64\u523b",backToToday:"\u8fd4\u56de\u4eca\u5929",ok:"\u78ba\u5b9a",timeSelect:"\u9078\u64c7\u6642\u9593",dateSelect:"\u9078\u64c7\u65e5\u671f",clear:"\u6e05\u9664",month:"\u6708",year:"\u5e74",previousMonth:"\u4e0a\u500b\u6708 (\u7ffb\u9801\u4e0a\u9375)",nextMonth:"\u4e0b\u500b\u6708 (\u7ffb\u9801\u4e0b\u9375)",monthSelect:"\u9078\u64c7\u6708\u4efd",yearSelect:"\u9078\u64c7\u5e74\u4efd",decadeSelect:"\u9078\u64c7\u5e74\u4ee3",yearFormat:"YYYY\u5e74",dayFormat:"D\u65e5",dateFormat:"YYYY\u5e74M\u6708D\u65e5",dateTimeFormat:"YYYY\u5e74M\u6708D\u65e5 HH\u6642mm\u5206ss\u79d2",previousYear:"\u4e0a\u4e00\u5e74 (Control\u9375\u52a0\u5de6\u65b9\u5411\u9375)",nextYear:"\u4e0b\u4e00\u5e74 (Control\u9375\u52a0\u53f3\u65b9\u5411\u9375)",previousDecade:"\u4e0a\u4e00\u5e74\u4ee3",nextDecade:"\u4e0b\u4e00\u5e74\u4ee3",previousCentury:"\u4e0a\u4e00\u4e16\u7d00",nextCentury:"\u4e0b\u4e00\u4e16\u7d00"},e.exports=t.default},32886:function(e,t){"use strict";t.__esModule=!0;var n={adjustX:1,adjustY:1},r=[0,0],o={bottomLeft:{points:["tl","tl"],overflow:n,offset:[0,-3],targetOffset:r},bottomRight:{points:["tr","tr"],overflow:n,offset:[0,-3],targetOffset:r},topRight:{points:["br","br"],overflow:n,offset:[0,3],targetOffset:r},topLeft:{points:["bl","bl"],overflow:n,offset:[0,3],targetOffset:r}};t.default=o,e.exports=t.default},86615:function(e,t){var n;!function(){"use strict";var r={}.hasOwnProperty;function o(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var a=typeof n;if("string"===a||"number"===a)e.push(n);else if(Array.isArray(n)){if(n.length){var i=o.apply(null,n);i&&e.push(i)}}else if("object"===a){if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]")){e.push(n.toString());continue}for(var s in n)r.call(n,s)&&n[s]&&e.push(s)}}}return e.join(" ")}e.exports?(o.default=o,e.exports=o):void 0===(n=function(){return o}.apply(t,[]))||(e.exports=n)}()},84583:function(e){e.exports=function(){"use strict";var e=1e3,t=6e4,n=36e5,r="millisecond",o="second",a="minute",i="hour",s="day",l="week",c="month",u="quarter",d="year",p="date",f="Invalid Date",h=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,m=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,g={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},v=function(e,t,n){var r=String(e);return!r||r.length>=t?e:""+Array(t+1-r.length).join(n)+e},y={s:v,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),r=Math.floor(n/60),o=n%60;return(t<=0?"+":"-")+v(r,2,"0")+":"+v(o,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var r=12*(n.year()-t.year())+(n.month()-t.month()),o=t.clone().add(r,c),a=n-o<0,i=t.clone().add(r+(a?-1:1),c);return+(-(r+(n-o)/(a?o-i:i-o))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:c,y:d,w:l,d:s,D:p,h:i,m:a,s:o,ms:r,Q:u}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},C="en",A={};A[C]=g;var x=function(e){return e instanceof S},b=function(e,t,n){var r;if(!e)return C;if("string"==typeof e)A[e]&&(r=e),t&&(A[e]=t,r=e);else{var o=e.name;A[o]=e,r=o}return!n&&r&&(C=r),r||!n&&C},_=function(e,t){if(x(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new S(n)},w=y;w.l=b,w.i=x,w.w=function(e,t){return _(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var S=function(){function g(e){this.$L=b(e.locale,null,!0),this.parse(e)}var v=g.prototype;return v.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(w.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var r=t.match(h);if(r){var o=r[2]-1||0,a=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],o,r[3]||1,r[4]||0,r[5]||0,r[6]||0,a)):new Date(r[1],o,r[3]||1,r[4]||0,r[5]||0,r[6]||0,a)}}return new Date(t)}(e),this.$x=e.x||{},this.init()},v.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},v.$utils=function(){return w},v.isValid=function(){return!(this.$d.toString()===f)},v.isSame=function(e,t){var n=_(e);return this.startOf(t)<=n&&n<=this.endOf(t)},v.isAfter=function(e,t){return _(e)<this.startOf(t)},v.isBefore=function(e,t){return this.endOf(t)<_(e)},v.$g=function(e,t,n){return w.u(e)?this[t]:this.set(n,e)},v.unix=function(){return Math.floor(this.valueOf()/1e3)},v.valueOf=function(){return this.$d.getTime()},v.startOf=function(e,t){var n=this,r=!!w.u(t)||t,u=w.p(e),f=function(e,t){var o=w.w(n.$u?Date.UTC(n.$y,t,e):new Date(n.$y,t,e),n);return r?o:o.endOf(s)},h=function(e,t){return w.w(n.toDate()[e].apply(n.toDate("s"),(r?[0,0,0,0]:[23,59,59,999]).slice(t)),n)},m=this.$W,g=this.$M,v=this.$D,y="set"+(this.$u?"UTC":"");switch(u){case d:return r?f(1,0):f(31,11);case c:return r?f(1,g):f(0,g+1);case l:var C=this.$locale().weekStart||0,A=(m<C?m+7:m)-C;return f(r?v-A:v+(6-A),g);case s:case p:return h(y+"Hours",0);case i:return h(y+"Minutes",1);case a:return h(y+"Seconds",2);case o:return h(y+"Milliseconds",3);default:return this.clone()}},v.endOf=function(e){return this.startOf(e,!1)},v.$set=function(e,t){var n,l=w.p(e),u="set"+(this.$u?"UTC":""),f=(n={},n[s]=u+"Date",n[p]=u+"Date",n[c]=u+"Month",n[d]=u+"FullYear",n[i]=u+"Hours",n[a]=u+"Minutes",n[o]=u+"Seconds",n[r]=u+"Milliseconds",n)[l],h=l===s?this.$D+(t-this.$W):t;if(l===c||l===d){var m=this.clone().set(p,1);m.$d[f](h),m.init(),this.$d=m.set(p,Math.min(this.$D,m.daysInMonth())).$d}else f&&this.$d[f](h);return this.init(),this},v.set=function(e,t){return this.clone().$set(e,t)},v.get=function(e){return this[w.p(e)]()},v.add=function(r,u){var p,f=this;r=Number(r);var h=w.p(u),m=function(e){var t=_(f);return w.w(t.date(t.date()+Math.round(e*r)),f)};if(h===c)return this.set(c,this.$M+r);if(h===d)return this.set(d,this.$y+r);if(h===s)return m(1);if(h===l)return m(7);var g=(p={},p[a]=t,p[i]=n,p[o]=e,p)[h]||1,v=this.$d.getTime()+r*g;return w.w(v,this)},v.subtract=function(e,t){return this.add(-1*e,t)},v.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return n.invalidDate||f;var r=e||"YYYY-MM-DDTHH:mm:ssZ",o=w.z(this),a=this.$H,i=this.$m,s=this.$M,l=n.weekdays,c=n.months,u=function(e,n,o,a){return e&&(e[n]||e(t,r))||o[n].substr(0,a)},d=function(e){return w.s(a%12||12,e,"0")},p=n.meridiem||function(e,t,n){var r=e<12?"AM":"PM";return n?r.toLowerCase():r},h={YY:String(this.$y).slice(-2),YYYY:this.$y,M:s+1,MM:w.s(s+1,2,"0"),MMM:u(n.monthsShort,s,c,3),MMMM:u(c,s),D:this.$D,DD:w.s(this.$D,2,"0"),d:String(this.$W),dd:u(n.weekdaysMin,this.$W,l,2),ddd:u(n.weekdaysShort,this.$W,l,3),dddd:l[this.$W],H:String(a),HH:w.s(a,2,"0"),h:d(1),hh:d(2),a:p(a,i,!0),A:p(a,i,!1),m:String(i),mm:w.s(i,2,"0"),s:String(this.$s),ss:w.s(this.$s,2,"0"),SSS:w.s(this.$ms,3,"0"),Z:o};return r.replace(m,(function(e,t){return t||h[e]||o.replace(":","")}))},v.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},v.diff=function(r,p,f){var h,m=w.p(p),g=_(r),v=(g.utcOffset()-this.utcOffset())*t,y=this-g,C=w.m(this,g);return C=(h={},h[d]=C/12,h[c]=C,h[u]=C/3,h[l]=(y-v)/6048e5,h[s]=(y-v)/864e5,h[i]=y/n,h[a]=y/t,h[o]=y/e,h)[m]||y,f?C:w.a(C)},v.daysInMonth=function(){return this.endOf(c).$D},v.$locale=function(){return A[this.$L]},v.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),r=b(e,t,!0);return r&&(n.$L=r),n},v.clone=function(){return w.w(this.$d,this)},v.toDate=function(){return new Date(this.valueOf())},v.toJSON=function(){return this.isValid()?this.toISOString():null},v.toISOString=function(){return this.$d.toISOString()},v.toString=function(){return this.$d.toUTCString()},g}(),D=S.prototype;return _.prototype=D,[["$ms",r],["$s",o],["$m",a],["$H",i],["$W",s],["$M",c],["$y",d],["$D",p]].forEach((function(e){D[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),_.extend=function(e,t){return e.$i||(e(t,S,_),e.$i=!0),_},_.locale=b,_.isDayjs=x,_.unix=function(e){return _(1e3*e)},_.en=A[C],_.Ls=A,_.p={},_}()},92356:function(e,t,n){e.exports=function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(e),r={name:"en-gb",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekStart:1,yearStart:4,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},ordinal:function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||t[0])+"]"}};return n.default.locale(r,null,!0),r}(n(84583))},43195:function(e,t,n){e.exports=function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(e),r={name:"zh-cn",weekdays:"\u661f\u671f\u65e5_\u661f\u671f\u4e00_\u661f\u671f\u4e8c_\u661f\u671f\u4e09_\u661f\u671f\u56db_\u661f\u671f\u4e94_\u661f\u671f\u516d".split("_"),weekdaysShort:"\u5468\u65e5_\u5468\u4e00_\u5468\u4e8c_\u5468\u4e09_\u5468\u56db_\u5468\u4e94_\u5468\u516d".split("_"),weekdaysMin:"\u65e5_\u4e00_\u4e8c_\u4e09_\u56db_\u4e94_\u516d".split("_"),months:"\u4e00\u6708_\u4e8c\u6708_\u4e09\u6708_\u56db\u6708_\u4e94\u6708_\u516d\u6708_\u4e03\u6708_\u516b\u6708_\u4e5d\u6708_\u5341\u6708_\u5341\u4e00\u6708_\u5341\u4e8c\u6708".split("_"),monthsShort:"1\u6708_2\u6708_3\u6708_4\u6708_5\u6708_6\u6708_7\u6708_8\u6708_9\u6708_10\u6708_11\u6708_12\u6708".split("_"),ordinal:function(e,t){return"W"===t?e+"\u5468":e+"\u65e5"},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY\u5e74M\u6708D\u65e5",LLL:"YYYY\u5e74M\u6708D\u65e5Ah\u70b9mm\u5206",LLLL:"YYYY\u5e74M\u6708D\u65e5ddddAh\u70b9mm\u5206",l:"YYYY/M/D",ll:"YYYY\u5e74M\u6708D\u65e5",lll:"YYYY\u5e74M\u6708D\u65e5 HH:mm",llll:"YYYY\u5e74M\u6708D\u65e5dddd HH:mm"},relativeTime:{future:"%s\u5185",past:"%s\u524d",s:"\u51e0\u79d2",m:"1 \u5206\u949f",mm:"%d \u5206\u949f",h:"1 \u5c0f\u65f6",hh:"%d \u5c0f\u65f6",d:"1 \u5929",dd:"%d \u5929",M:"1 \u4e2a\u6708",MM:"%d \u4e2a\u6708",y:"1 \u5e74",yy:"%d \u5e74"},meridiem:function(e,t){var n=100*e+t;return n<600?"\u51cc\u6668":n<900?"\u65e9\u4e0a":n<1100?"\u4e0a\u5348":n<1300?"\u4e2d\u5348":n<1800?"\u4e0b\u5348":"\u665a\u4e0a"}};return n.default.locale(r,null,!0),r}(n(84583))},27619:function(e){e.exports=function(){"use strict";var e={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},t=/(\[[^[]*\])|([-:/.()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,n=/\d\d/,r=/\d\d?/,o=/\d*[^\s\d-_:/()]+/,a={},i=function(e){return(e=+e)+(e>68?1900:2e3)},s=function(e){return function(t){this[e]=+t}},l=[/[+-]\d\d:?(\d\d)?|Z/,function(e){(this.zone||(this.zone={})).offset=function(e){if(!e)return 0;if("Z"===e)return 0;var t=e.match(/([+-]|\d\d)/g),n=60*t[1]+(+t[2]||0);return 0===n?0:"+"===t[0]?-n:n}(e)}],c=function(e){var t=a[e];return t&&(t.indexOf?t:t.s.concat(t.f))},u=function(e,t){var n,r=a.meridiem;if(r){for(var o=1;o<=24;o+=1)if(e.indexOf(r(o,0,t))>-1){n=o>12;break}}else n=e===(t?"pm":"PM");return n},d={A:[o,function(e){this.afternoon=u(e,!1)}],a:[o,function(e){this.afternoon=u(e,!0)}],S:[/\d/,function(e){this.milliseconds=100*+e}],SS:[n,function(e){this.milliseconds=10*+e}],SSS:[/\d{3}/,function(e){this.milliseconds=+e}],s:[r,s("seconds")],ss:[r,s("seconds")],m:[r,s("minutes")],mm:[r,s("minutes")],H:[r,s("hours")],h:[r,s("hours")],HH:[r,s("hours")],hh:[r,s("hours")],D:[r,s("day")],DD:[n,s("day")],Do:[o,function(e){var t=a.ordinal,n=e.match(/\d+/);if(this.day=n[0],t)for(var r=1;r<=31;r+=1)t(r).replace(/\[|\]/g,"")===e&&(this.day=r)}],M:[r,s("month")],MM:[n,s("month")],MMM:[o,function(e){var t=c("months"),n=(c("monthsShort")||t.map((function(e){return e.substr(0,3)}))).indexOf(e)+1;if(n<1)throw new Error;this.month=n%12||n}],MMMM:[o,function(e){var t=c("months").indexOf(e)+1;if(t<1)throw new Error;this.month=t%12||t}],Y:[/[+-]?\d+/,s("year")],YY:[n,function(e){this.year=i(e)}],YYYY:[/\d{4}/,s("year")],Z:l,ZZ:l};function p(n){var r,o;r=n,o=a&&a.formats;for(var i=(n=r.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function(t,n,r){var a=r&&r.toUpperCase();return n||o[r]||e[r]||o[a].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(e,t,n){return t||n.slice(1)}))}))).match(t),s=i.length,l=0;l<s;l+=1){var c=i[l],u=d[c],p=u&&u[0],f=u&&u[1];i[l]=f?{regex:p,parser:f}:c.replace(/^\[|\]$/g,"")}return function(e){for(var t={},n=0,r=0;n<s;n+=1){var o=i[n];if("string"==typeof o)r+=o.length;else{var a=o.regex,l=o.parser,c=e.substr(r),u=a.exec(c)[0];l.call(t,u),e=e.replace(u,"")}}return function(e){var t=e.afternoon;if(void 0!==t){var n=e.hours;t?n<12&&(e.hours+=12):12===n&&(e.hours=0),delete e.afternoon}}(t),t}}return function(e,t,n){n.p.customParseFormat=!0,e&&e.parseTwoDigitYear&&(i=e.parseTwoDigitYear);var r=t.prototype,o=r.parse;r.parse=function(e){var t=e.date,r=e.utc,i=e.args;this.$u=r;var s=i[1];if("string"==typeof s){var l=!0===i[2],c=!0===i[3],u=l||c,d=i[2];c&&(d=i[2]),a=this.$locale(),!l&&d&&(a=n.Ls[d]),this.$d=function(e,t,n){try{if(["x","X"].indexOf(t)>-1)return new Date(("X"===t?1e3:1)*e);var r=p(t)(e),o=r.year,a=r.month,i=r.day,s=r.hours,l=r.minutes,c=r.seconds,u=r.milliseconds,d=r.zone,f=new Date,h=i||(o||a?1:f.getDate()),m=o||f.getFullYear(),g=0;o&&!a||(g=a>0?a-1:f.getMonth());var v=s||0,y=l||0,C=c||0,A=u||0;return d?new Date(Date.UTC(m,g,h,v,y,C,A+60*d.offset*1e3)):n?new Date(Date.UTC(m,g,h,v,y,C,A)):new Date(m,g,h,v,y,C,A)}catch(e){return new Date("")}}(t,s,r),this.init(),d&&!0!==d&&(this.$L=this.locale(d).$L),u&&t!=this.format(s)&&(this.$d=new Date("")),a={}}else if(s instanceof Array)for(var f=s.length,h=1;h<=f;h+=1){i[1]=s[h-1];var m=n.apply(this,i);if(m.isValid()){this.$d=m.$d,this.$L=m.$L,this.init();break}h===f&&(this.$d=new Date(""))}else o.call(this,e)}}}()},43650:function(e){e.exports=function(){"use strict";return function(e,t,n){var r=t.prototype,o=function(e){return e&&(e.indexOf?e:e.s)},a=function(e,t,n,r,a){var i=e.name?e:e.$locale(),s=o(i[t]),l=o(i[n]),c=s||l.map((function(e){return e.substr(0,r)}));if(!a)return c;var u=i.weekStart;return c.map((function(e,t){return c[(t+(u||0))%7]}))},i=function(){return n.Ls[n.locale()]},s=function(e,t){return e.formats[t]||function(e){return e.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(e,t,n){return t||n.slice(1)}))}(e.formats[t.toUpperCase()])},l=function(){var e=this;return{months:function(t){return t?t.format("MMMM"):a(e,"months")},monthsShort:function(t){return t?t.format("MMM"):a(e,"monthsShort","months",3)},firstDayOfWeek:function(){return e.$locale().weekStart||0},weekdays:function(t){return t?t.format("dddd"):a(e,"weekdays")},weekdaysMin:function(t){return t?t.format("dd"):a(e,"weekdaysMin","weekdays",2)},weekdaysShort:function(t){return t?t.format("ddd"):a(e,"weekdaysShort","weekdays",3)},longDateFormat:function(t){return s(e.$locale(),t)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};r.localeData=function(){return l.bind(this)()},n.localeData=function(){var e=i();return{firstDayOfWeek:function(){return e.weekStart||0},weekdays:function(){return n.weekdays()},weekdaysShort:function(){return n.weekdaysShort()},weekdaysMin:function(){return n.weekdaysMin()},months:function(){return n.months()},monthsShort:function(){return n.monthsShort()},longDateFormat:function(t){return s(e,t)},meridiem:e.meridiem,ordinal:e.ordinal}},n.months=function(){return a(i(),"months")},n.monthsShort=function(){return a(i(),"monthsShort","months",3)},n.weekdays=function(e){return a(i(),"weekdays",null,null,e)},n.weekdaysShort=function(e){return a(i(),"weekdaysShort","weekdays",3,e)},n.weekdaysMin=function(e){return a(i(),"weekdaysMin","weekdays",2,e)}}}()},6740:function(e){e.exports=function(){"use strict";var e="minute",t=/[+-]\d\d(?::?\d\d)?/g,n=/([+-]|\d\d)/g;return function(r,o,a){var i=o.prototype;a.utc=function(e){return new o({date:e,utc:!0,args:arguments})},i.utc=function(t){var n=a(this.toDate(),{locale:this.$L,utc:!0});return t?n.add(this.utcOffset(),e):n},i.local=function(){return a(this.toDate(),{locale:this.$L,utc:!1})};var s=i.parse;i.parse=function(e){e.utc&&(this.$u=!0),this.$utils().u(e.$offset)||(this.$offset=e.$offset),s.call(this,e)};var l=i.init;i.init=function(){if(this.$u){var e=this.$d;this.$y=e.getUTCFullYear(),this.$M=e.getUTCMonth(),this.$D=e.getUTCDate(),this.$W=e.getUTCDay(),this.$H=e.getUTCHours(),this.$m=e.getUTCMinutes(),this.$s=e.getUTCSeconds(),this.$ms=e.getUTCMilliseconds()}else l.call(this)};var c=i.utcOffset;i.utcOffset=function(r,o){var a=this.$utils().u;if(a(r))return this.$u?0:a(this.$offset)?c.call(this):this.$offset;if("string"==typeof r&&null===(r=function(e){void 0===e&&(e="");var r=e.match(t);if(!r)return null;var o=(""+r[0]).match(n)||["-",0,0],a=o[0],i=60*+o[1]+ +o[2];return 0===i?0:"+"===a?i:-i}(r)))return this;var i=Math.abs(r)<=16?60*r:r,s=this;if(o)return s.$offset=i,s.$u=0===r,s;if(0!==r){var l=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(s=this.local().add(i+l,e)).$offset=i,s.$x.$localOffset=l}else s=this.utc();return s};var u=i.format;i.format=function(e){var t=e||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return u.call(this,t)},i.valueOf=function(){var e=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||(new Date).getTimezoneOffset());return this.$d.valueOf()-6e4*e},i.isUTC=function(){return!!this.$u},i.toISOString=function(){return this.toDate().toISOString()},i.toString=function(){return this.toDate().toUTCString()};var d=i.toDate;i.toDate=function(e){return"s"===e&&this.$offset?a(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():d.call(this)};var p=i.diff;i.diff=function(e,t,n){if(e&&this.$u===e.$u)return p.call(this,e,t,n);var r=this.local(),o=a(e).local();return p.call(r,o,t,n)}}}()},97676:function(e){e.exports=function(){"use strict";var e="week",t="year";return function(n,r,o){var a=r.prototype;a.week=function(n){if(void 0===n&&(n=null),null!==n)return this.add(7*(n-this.week()),"day");var r=this.$locale().yearStart||1;if(11===this.month()&&this.date()>25){var a=o(this).startOf(t).add(1,t).date(r),i=o(this).endOf(e);if(a.isBefore(i))return 1}var s=o(this).startOf(t).date(r).startOf(e).subtract(1,"millisecond"),l=this.diff(s,e,!0);return l<0?o(this).startOf("week").week():Math.ceil(l)},a.weeks=function(e){return void 0===e&&(e=null),this.week(e)}}}()},49539:function(e){function t(){}e.exports=function(e,n,r){var o=!1;return r=r||t,a.count=e,0===e?n():a;function a(e,t){if(a.count<=0)throw new Error("after called too many times");--a.count,e?(o=!0,n(e),n=r):0!==a.count||o||n(null,t)}}},76673:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(7219),a=(r=o)&&r.__esModule?r:{default:r};t.getComponentLocale=function(e,t,n,r){var o={};if(t&&t.antLocale&&t.antLocale[n])o=t.antLocale[n];else{var i=r();o=i.default||i}var s=(0,a.default)({},o);e.locale&&(s=(0,a.default)({},s,e.locale),e.locale.lang&&(s.lang=(0,a.default)({},o.lang,e.locale.lang)));return s},t.getLocaleCode=function(e){var t=e.antLocale&&e.antLocale.locale;if(e.antLocale&&e.antLocale.exist&&!t)return"zh-cn";return t}},13651:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=m(n(7219)),o=m(n(26380)),a=m(n(754)),i=m(n(52889)),s=m(n(5316)),l=h(n(11942)),c=h(n(9950)),u=m(n(80065)),d=m(n(6885)),p=n(76673),f=n(44814);function h(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function m(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(){(0,o.default)(this,t);var e=(0,i.default)(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.setScrollValue=function(t){e.scrollValue=t},e.onOk=function(t){void 0!==e.scrollValue&&(t=e.scrollValue),e.props.onChange&&e.props.onChange(t),e.props.onOk&&e.props.onOk(t)},e.onVisibleChange=function(t){e.scrollValue=void 0,e.props.onVisibleChange&&e.props.onVisibleChange(t)},e.fixOnOk=function(t){t&&(t.onOk=e.onOk)},e}return(0,s.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props,t=this.context,o=e.children,a=e.value,i=e.popupPrefixCls,s=(0,p.getComponentLocale)(e,t,"DatePicker",(function(){return n(29051)})),l=s.okText,h=s.dismissText,m=s.extra,g=s.DatePickerLocale,v=c.createElement(u.default,{minuteStep:e.minuteStep,locale:g,minDate:e.minDate,maxDate:e.maxDate,mode:e.mode,pickerPrefixCls:e.pickerPrefixCls,prefixCls:e.prefixCls,defaultDate:a||new Date,use12Hours:e.use12Hours,onValueChange:e.onValueChange,onScrollChange:this.setScrollValue});return c.createElement(d.default,(0,r.default)({datePicker:v,WrapComponent:"div",transitionName:"am-slide-up",maskTransitionName:"am-fade"},e,{prefixCls:i,date:a||new Date,dismissText:this.props.dismissText||h,okText:this.props.okText||l,ref:this.fixOnOk,onVisibleChange:this.onVisibleChange}),o&&c.isValidElement(o)&&c.cloneElement(o,{extra:a?(0,f.formatFn)(this,a):this.props.extra||m}))}}]),t}(c.Component);t.default=g,g.defaultProps={mode:"datetime",prefixCls:"am-picker",pickerPrefixCls:"am-picker-col",popupPrefixCls:"am-picker-popup",minuteStep:1,use12Hours:!1},g.contextTypes={antLocale:l.object},e.exports=t.default},29051:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(23664),a=(r=o)&&r.__esModule?r:{default:r};t.default={okText:"\u786e\u5b9a",dismissText:"\u53d6\u6d88",extra:"\u8bf7\u9009\u62e9",DatePickerLocale:a.default},e.exports=t.default},44814:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(69861),a=(r=o)&&r.__esModule?r:{default:r};function i(e,t){var n=function(e){return e<10?"0"+e:e},r=e.getFullYear()+"-"+n(e.getMonth()+1)+"-"+n(e.getDate()),o=n(e.getHours())+":"+n(e.getMinutes());return"YYYY-MM-DD"===t?r:"HH:mm"===t?o:r+" "+o}t.formatFn=function(e,t){var n=e.props.format,r="undefined"===typeof n?"undefined":(0,a.default)(n);if("string"===r)return i(t,n);if("function"===r)return n(t);return i(t,{date:"YYYY-MM-DD",time:"HH:mm",datetime:"YYYY-MM-DD HH:mm"}[e.props.mode])}},95406:function(e){e.exports=function(e,t,n){var r=e.byteLength;if(t=t||0,n=n||r,e.slice)return e.slice(t,n);if(t<0&&(t+=r),n<0&&(n+=r),n>r&&(n=r),t>=r||t>=n||0===r)return new ArrayBuffer(0);for(var o=new Uint8Array(e),a=new Uint8Array(n-t),i=t,s=0;i<n;i++,s++)a[s]=o[i];return a.buffer}},64293:function(e){function t(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=t,t.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},t.prototype.reset=function(){this.attempts=0},t.prototype.setMin=function(e){this.ms=e},t.prototype.setMax=function(e){this.max=e},t.prototype.setJitter=function(e){this.jitter=e}},48705:function(e,t){!function(e){"use strict";t.encode=function(t){var n,r=new Uint8Array(t),o=r.length,a="";for(n=0;n<o;n+=3)a+=e[r[n]>>2],a+=e[(3&r[n])<<4|r[n+1]>>4],a+=e[(15&r[n+1])<<2|r[n+2]>>6],a+=e[63&r[n+2]];return o%3===2?a=a.substring(0,a.length-1)+"=":o%3===1&&(a=a.substring(0,a.length-2)+"=="),a},t.decode=function(t){var n,r,o,a,i,s=.75*t.length,l=t.length,c=0;"="===t[t.length-1]&&(s--,"="===t[t.length-2]&&s--);var u=new ArrayBuffer(s),d=new Uint8Array(u);for(n=0;n<l;n+=4)r=e.indexOf(t[n]),o=e.indexOf(t[n+1]),a=e.indexOf(t[n+2]),i=e.indexOf(t[n+3]),d[c++]=r<<2|o>>4,d[c++]=(15&o)<<4|a>>2,d[c++]=(3&a)<<6|63&i;return u}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},4280:function(e){var t="undefined"!==typeof t?t:"undefined"!==typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!==typeof MSBlobBuilder?MSBlobBuilder:"undefined"!==typeof MozBlobBuilder&&MozBlobBuilder,n=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),r=n&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),o=t&&t.prototype.append&&t.prototype.getBlob;function a(e){return e.map((function(e){if(e.buffer instanceof ArrayBuffer){var t=e.buffer;if(e.byteLength!==t.byteLength){var n=new Uint8Array(e.byteLength);n.set(new Uint8Array(t,e.byteOffset,e.byteLength)),t=n.buffer}return t}return e}))}function i(e,n){n=n||{};var r=new t;return a(e).forEach((function(e){r.append(e)})),n.type?r.getBlob(n.type):r.getBlob()}function s(e,t){return new Blob(a(e),t||{})}"undefined"!==typeof Blob&&(i.prototype=Blob.prototype,s.prototype=Blob.prototype),e.exports=n?r?Blob:s:o?i:void 0},1354:function(e){var t=[].slice;e.exports=function(e,n){if("string"==typeof n&&(n=e[n]),"function"!=typeof n)throw new Error("bind() requires a function");var r=t.call(arguments,2);return function(){return n.apply(e,r.concat(t.call(arguments)))}}},19621:function(e){function t(e){if(e)return function(e){for(var n in t.prototype)e[n]=t.prototype[n];return e}(e)}e.exports=t,t.prototype.on=t.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},t.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeAllListeners=t.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var o=0;o<r.length;o++)if((n=r[o])===t||n.fn===t){r.splice(o,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},t.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var o=(n=n.slice(0)).length;r<o;++r)n[r].apply(this,t)}return this},t.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},t.prototype.hasListeners=function(e){return!!this.listeners(e).length}},28960:function(e){e.exports=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},36220:function(e){e.exports=function(){"use strict";var e="minute",t=/[+-]\d\d(?::?\d\d)?/g,n=/([+-]|\d\d)/g;return function(r,o,a){var i=o.prototype;a.utc=function(e){return new o({date:e,utc:!0,args:arguments})},i.utc=function(t){var n=a(this.toDate(),{locale:this.$L,utc:!0});return t?n.add(this.utcOffset(),e):n},i.local=function(){return a(this.toDate(),{locale:this.$L,utc:!1})};var s=i.parse;i.parse=function(e){e.utc&&(this.$u=!0),this.$utils().u(e.$offset)||(this.$offset=e.$offset),s.call(this,e)};var l=i.init;i.init=function(){if(this.$u){var e=this.$d;this.$y=e.getUTCFullYear(),this.$M=e.getUTCMonth(),this.$D=e.getUTCDate(),this.$W=e.getUTCDay(),this.$H=e.getUTCHours(),this.$m=e.getUTCMinutes(),this.$s=e.getUTCSeconds(),this.$ms=e.getUTCMilliseconds()}else l.call(this)};var c=i.utcOffset;i.utcOffset=function(r,o){var a=this.$utils().u;if(a(r))return this.$u?0:a(this.$offset)?c.call(this):this.$offset;if("string"==typeof r&&(r=function(e){void 0===e&&(e="");var r=e.match(t);if(!r)return null;var o=(""+r[0]).match(n)||["-",0,0],a=o[0],i=60*+o[1]+ +o[2];return 0===i?0:"+"===a?i:-i}(r),null===r))return this;var i=Math.abs(r)<=16?60*r:r,s=this;if(o)return s.$offset=i,s.$u=0===r,s;if(0!==r){var l=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(s=this.local().add(i+l,e)).$offset=i,s.$x.$localOffset=l}else s=this.utc();return s};var u=i.format;i.format=function(e){var t=e||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return u.call(this,t)},i.valueOf=function(){var e=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*e},i.isUTC=function(){return!!this.$u},i.toISOString=function(){return this.toDate().toISOString()},i.toString=function(){return this.toDate().toUTCString()};var d=i.toDate;i.toDate=function(e){return"s"===e&&this.$offset?a(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():d.call(this)};var p=i.diff;i.diff=function(e,t,n){if(e&&this.$u===e.$u)return p.call(this,e,t,n);var r=this.local(),o=a(e).local();return p.call(r,o,t,n)}}}()},4139:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(n(98201));n(96285);var c=function(e){function t(e){var n;return r(this,t),(n=a(this,t,[e])).onCommit=function(){var e={};e[n.props.column.name]=n.state.value,n.props.onCommit(e)},n.onChange=function(e){n.props.isReadOnly||n.setState({value:!n.state.value},(function(){n.onCommit()}))},n.state={value:!!e.value&&e.value},n}return i(t,e),o(t,[{key:"render",value:function(){var e=this.state.value,t={cursor:this.props.isReadOnly?"default":"pointer"};return l.default.createElement("div",{className:"dtable-ui-checkbox-editor",style:t},l.default.createElement("input",{type:"checkbox",className:"raw-checkbox",checked:e,onChange:this.onChange}),l.default.createElement("div",{className:"shown-checkbox"},e&&l.default.createElement("span",{className:"dtable-font dtable-icon-check-mark"})))}}])}(l.default.Component);c.defaultProps={isReadOnly:!1,value:!1};t.default=c},71970:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default,l=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(98201)),u=s(n(70446)),d=n(61779),p=s(n(33162)),f=s(n(35012)),h=s(n(73490)),m=s(n(12549)),g=s(n(23615));n(10806);var v=function(e){function t(e){var n;return r(this,t),(n=a(this,t,[e])).onMouseDown=function(e){n.state.isPopoverShow&&n.editorPopoverRef&&(n.editorPopoverRef===e.target||n.editorPopoverRef.contains(e.target))||n.editorContainer===e.target||n.editorContainer.contains(e.target)||n.onClosePopover()},n.getFormattedCollaborators=function(){var e=n.state.newValue;if(Array.isArray(e)&&e.length>0){var t=n.props.collaborators;return e.map((function(e){return t.find((function(t){return t.email===e}))})).filter((function(e){return!!e}))}return[]},n.togglePopover=function(e){if(e.nativeEvent.stopImmediatePropagation(),e.stopPropagation(),!n.props.isReadOnly){var t=!n.state.isPopoverShow;if(t){var r=n.caculatePopoverPosition();n.setState({isPopoverShow:t,popoverPosition:r})}else n.setState({isPopoverShow:t})}},n.onCommit=function(e){var t={};t[n.props.column.name]=e,n.props.onCommit(t)},n.onCollaboratorItemToggle=function(e){var t=n.state.newValue.slice(),r=t.findIndex((function(t){return t===e.email}));-1!==r?t.splice(r,1):t.push(e.email),n.setState({newValue:t},(function(){n.onCommit(t)}))},n.onDeleteCollaborator=function(e){var t=n.state.newValue.slice(),r=t.findIndex((function(t){return t===e.email}));r>-1&&(t.splice(r,1),n.setState({newValue:t},(function(){n.onCommit(t)})))},n.caculatePopoverPosition=function(){if(n.props.isInModel){var e=n.editor.getBoundingClientRect();return{top:e.top+40,left:e.left,zIndex:1051}}var t=window.innerHeight,r=n.editor.getClientRects()[0],o=r.top,a=r.height,i={top:a+1,left:0};t-(o+a)>200||(i={bottom:a+1,left:0});return i},n.onClosePopover=function(){n.setState({isPopoverShow:!1})},n.onClickContainer=function(e){e.stopPropagation(),n.props.isShowEditButton||n.state.isPopoverShow||n.setState({isPopoverShow:!0,popoverPosition:n.caculatePopoverPosition()})},n.setEditorContainerRef=function(e){n.editorContainer=e},n.setEditorRef=function(e){n.editor=e},n.setPopoverRef=function(e){n.editorPopoverRef=e},n.state={newValue:Array.isArray(e.value)?e.value:[],isPopoverShow:!1,popoverPosition:{}},n}return i(t,e),o(t,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.onMouseDown)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.onMouseDown)}},{key:"render",value:function(){var e=this,t=this.props,n=t.collaborators,r=t.isReadOnly,o=t.isShowEditButton,a=this.state,i=a.isPopoverShow,s=a.popoverPosition,l=this.getFormattedCollaborators(),v=!r;return c.default.createElement("div",{ref:this.setEditorContainerRef,className:"dtable-ui-collaborator-editor"},c.default.createElement("div",{ref:this.setEditorRef,className:"dtable-ui-collaborator-editor-container ".concat(o?"":"dtable-ui-collaborator-editor-container-no-btn"),onClick:this.onClickContainer},o&&c.default.createElement(h.default,{text:(0,d.getLocale)("Add_a_collaborator"),onClick:this.togglePopover}),l.length>0&&c.default.createElement("div",{className:"collaborators-container ".concat(o?"mt-2":"")},l.map((function(t){return c.default.createElement(f.default,{key:t.email,collaborator:t,enableDeleteCollaborator:v,onDeleteCollaborator:e.onDeleteCollaborator})})))),i&&c.default.createElement(c.Fragment,null,c.default.createElement(u.default,{query:"(min-width: 768px)"},c.default.createElement(p.default,null,c.default.createElement(m.default,{popoverPosition:s,isReadOnly:this.props.isReadOnly,selectedCollaborators:l,collaborators:n,onCollaboratorItemToggle:this.onCollaboratorItemToggle,setPopoverRef:this.setPopoverRef}))),c.default.createElement(u.default,{query:"(max-width: 767.8px)"},c.default.createElement(g.default,{isReadOnly:this.props.isReadOnly,value:this.state.newValue,column:this.props.column,collaborators:this.props.collaborators,onCollaboratorItemToggle:this.onCollaboratorItemToggle,onClosePopover:this.onClosePopover}))))}}])}(c.default.Component);v.defaultProps={isShowEditButton:!0,isReadOnly:!1,value:[],isInModel:!1};t.default=v},23615:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(n(98201)),c=n(61779),u=s(n(36720));n(70545);var d=function(e){function t(e){var n;return r(this,t),(n=a(this,t,[e])).handleHistaryBack=function(e){e.preventDefault(),n.props.onClosePopover()},n.onContainerClick=function(e){if(n.editorPopover&&n.editorPopover.contains(e.target))return e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),!1},n.onChangeSearch=function(e){var t=n.state.searchVal;t!==e.target.value&&(t=e.target.value,n.setState({searchVal:t}))},n.getSelectedCollaborators=function(){var e=n.props,t=e.value,r=e.collaborators;return Array.isArray(t)?r.filter((function(e){return t.indexOf(e.email)>-1})):[]},n.getFilteredCollaborators=function(){var e=n.props.collaborators,t=n.state.searchVal;return t?e.filter((function(e){return e.name.indexOf(t)>-1})):e},n.onSelectCollaborator=function(e){n.props.onCollaboratorItemToggle(e)},n.onRemoveCollaborator=function(e){n.props.onCollaboratorItemToggle(e)},n.renderFilteredCollaborators=function(e){var t=n.props.value;return e.map((function(e,r){var o=t.some((function(t){return t===e.email}));return l.default.createElement("div",{className:"mb-collaborator-option-item",key:r,onMouseDown:n.onSelectCollaborator.bind(n,e)},l.default.createElement("span",{className:"mb-collaborator-info"},l.default.createElement("span",{className:"collaborator-avatar"},l.default.createElement("img",{src:e.avatar_url,width:"24",height:"24",alt:"avatar"})),l.default.createElement("span",{className:"collaborator-name"},e.name)),o&&l.default.createElement("i",{className:"mb-collaborator-checked dtable-font dtable-icon-check-mark"}))}))},n.setEditorPopover=function(e){n.editorPopover=e},n.state={searchVal:""},n}return i(t,e),o(t,[{key:"componentDidMount",value:function(){history.pushState(null,null,"#"),window.addEventListener("popstate",this.handleHistaryBack,!1)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("popstate",this.handleHistaryBack,!1)}},{key:"render",value:function(){var e=this.props.column,t=this.state.searchVal,n=this.getFilteredCollaborators();return l.default.createElement("div",{ref:this.setEditorPopover,className:"dtable-ui-mb-editor-popover mb-collaborator-editor-popover",onClick:this.onContainerClick},l.default.createElement(u.default,{title:e.name,leftContent:l.default.createElement("i",{className:"dtable-font dtable-icon-return"}),rightContent:l.default.createElement("span",null,(0,c.getLocale)("Done")),onLeftClick:this.props.onClosePopover,onRightClick:this.props.onClosePopover}),l.default.createElement("div",{className:"dtable-ui-mb-editor-body dtable-ui-mb-collaborator-editor-body"},l.default.createElement("div",{className:"mb-search-collaborator-items"},l.default.createElement("input",{className:"form-control",type:"text",placeholder:(0,c.getLocale)("Search_collaborator"),value:t,onChange:this.onChangeSearch,onClick:this.onInputClick})),l.default.createElement("div",{className:"mb-collaborators-container"},l.default.createElement("div",{className:"title"},(0,c.getLocale)("Choose_a_collaborator")),l.default.createElement("div",{className:"content"},0===n.length&&l.default.createElement("div",{className:"search-result-none"},(0,c.getLocale)("No_collaborators_avaliable")),n.length>0&&this.renderFilteredCollaborators(n)))))}}])}(l.default.Component);d.defaultProps={isReadOnly:!1,value:[]};t.default=d},12549:function(e,t,n){"use strict";var r=n(12897).default,o=n(17383).default,a=n(34579).default,i=n(18336).default,s=n(29511).default,l=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(98201)),u=n(61779),d=l(n(35012));n(9399);var p=function(e){function t(e){var n;return o(this,t),(n=i(this,t,[e])).onValueChanged=function(e){var t=e.target.value;n.setState({searchValue:t})},n.onInputClick=function(e){e.nativeEvent.stopImmediatePropagation(),e.stopPropagation()},n.onCollaboratorItemToggle=function(e){n.props.onCollaboratorItemToggle(e)},n.getFilterCollaborator=function(){var e=n.props.collaborators,t=n.state.searchValue.toLowerCase();return t?e.filter((function(e){return e.name.toString().toLowerCase().indexOf(t)>-1})):e},n.state={searchValue:""},n.editorInputRef=c.default.createRef(),n}return s(t,e),a(t,[{key:"componentDidMount",value:function(){this.editorInputRef.current.focus()}},{key:"render",value:function(){var e=this,t=this.state.searchValue,n=this.props,o=n.selectedCollaborators,a=n.popoverPosition,i=this.getFilterCollaborator(),s=Object.assign({},r({},a),{position:"absolute"});return c.default.createElement("div",{className:"dtable-ui-editor-popover dtable-ui-collaborator-editor-popover",style:s,ref:this.props.setPopoverRef},c.default.createElement("div",{className:"collaborator-search-container"},c.default.createElement("input",{className:"form-control",value:t,onChange:this.onValueChanged,onClick:this.onInputClick,placeholder:(0,u.getLocale)("Search_collaborator"),ref:this.editorInputRef})),c.default.createElement("div",{className:"collaborator-list-container"},i.length>0&&i.map((function(t,n){var r=o.some((function(e){return e.email===t.email}));return c.default.createElement("div",{key:n,className:"collaborator-item-container",onClick:e.onCollaboratorItemToggle.bind(e,t)},c.default.createElement(d.default,{collaborator:t}),c.default.createElement("div",{className:"collaborator-checked"},r&&c.default.createElement("i",{className:"dtable-font dtable-icon-check-mark"})))})),0===i.length&&c.default.createElement("div",{className:"no-search-result"},(0,u.getLocale)("No_collaborators_available"))))}}])}(c.default.Component);t.default=p},98581:function(e,t,n){"use strict";var r=n(85715).default,o=n(24994).default,a=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(98201)),s=o(n(28414));n(42283);t.default=function(e){var t=e.className,n=e.title,o=e.children,a=(0,i.useState)(!0),l=r(a,2),c=l[0],u=l[1];return i.default.createElement("div",{className:(0,s.default)("collapsible-setting-layout",t)},i.default.createElement("div",{className:"collapsible-setting-layout-header w-100 d-flex align-items-center",onClick:function(){return u(!c)}},i.default.createElement("span",{className:"collapsible-setting-layout-title"},n),i.default.createElement("i",{className:"dtable-font dtable-icon-right".concat(c?" dtable-icon-spin":"")})),c&&i.default.createElement("div",{className:"collapsible-setting-layout-body mt-3 pl-2"},o||""))}},94848:function(e,t,n){"use strict";var r=n(43693).default,o=n(12897).default,a=n(85715).default,i=n(24994).default,s=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(n(98201)),c=n(48843),u=n(25825),d=n(96795),p=n(61779),f=i(n(35376)),h=n(82233);n(79079);var m=["#ffffff","#f5f5f5","#eef6f9","#deffe6","#def7c4","#fefdb5","#feebb6","#ffdde5"],g="hex",v="rgba",y="r",C="g",A="b",x="dtable-color-picker",b=(0,l.forwardRef)((function(e,t){var n=e.onToggle,i=e.popoverStyle,s=e.color,b=e.defaultColors,_=(0,h.hexToRgba)(s),w=(0,l.useState)(_),S=a(w,2),D=S[0],E=S[1],k=(0,l.useState)((0,h.getInitialHexVal)(s)),M=a(k,2),I=M[0],N=M[1],P=(0,l.useState)((0,h.toPercentage)(_.a)),T=a(P,2),O=T[0],j=T[1],R=(0,l.useState)(_.r),L=a(R,2),F=L[0],U=L[1],Y=(0,l.useState)(_.g),B=a(Y,2),H=B[0],V=B[1],G=(0,l.useState)(_.b),q=a(G,2),z=q[0],W=q[1],K=(0,l.useState)(g),Z=a(K,2),X=Z[0],$=Z[1],J=(0,l.useRef)(null),Q=[],ee=window.localStorage.getItem(x);try{Q=ee?JSON.parse(ee):[]}catch(he){console.error("Error parsing current used colors from localStorage:",he)}(0,l.useEffect)((function(){var e=document.querySelector(".chrome-picker > div:last-of-type > .flexbox-fix:first-of-type");e&&e.classList.add("color-bar")}),[]),(0,l.useImperativeHandle)(t,(function(){return{getHeight:function(){return J.current?J.current.offsetHeight:0}}}));var te=function(e){var t=e.rgb;t.a=Math.round(100*t.a)/100;var n=(0,h.rgbaToHex)(t).substring(1,7),r=t.r,o=t.g,a=t.b,i=t.a;j((0,h.toPercentage)(i)),le(t),X===g?N(n):(U(r),V(o),W(a))},ne=function(){var e;if(X===g){e=v;var t=(0,h.hexToRgba)(s),n=t.r,r=t.g,o=t.b;U(n),V(r),W(o)}else{e=g;var a=(0,h.rgbaToHex)(D,!1,!1);N(a)}$(e)},re=function(e){var t=e.target.value;N(t)},oe=function(){if(/^#?([a-fA-F0-9]{6}|[a-fA-F0-9]{3})$/i.test(I)){var e=I;3===e.length&&(e=e.split("").map((function(e){return e+e})).join("")),N(e);var t=(0,h.hexToRgba)(e),n={r:t.r,g:t.g,b:t.b,a:D.a};le(n)}else{var r=(0,h.rgbaToHex)(D,!1);N(r)}},ae=function(e){var t=e.target.value.trim().replace("%","");/^(\d+|\d+%)?$/.test(t)&&j(t)},ie=function(e,t){var n=e.target.value;if(/^[0-9]*$/.test(n))switch(n&&(n=parseInt(n)),t){case y:U(n);break;case C:V(n);break;case A:W(n)}},se=function(e){var t=F,n=U;if(e===C?(t=H,n=V):e===A&&(t=z,n=W),(0,d.isEmpty)(t)||t<0||t>255)n(D[e]);else{var a=o(o({},D),{},r({},e,t));le(a)}},le=function(t){E(t);var n=(0,h.rgbaToHex)(t);e.onSubmit(n)},ce=function(){if((0,d.isEmpty)(O)||O<0||O>100)j((0,h.toPercentage)(D.a));else{var e=o(o({},D),{},{a:parseFloat(O)/100});le(e)}},ue=function(e,t){"Enter"===e.key&&(e.preventDefault(),e.target.blur(),t&&t())},de=function(e){var t=(0,h.hexToRgba)(e),n=t.r,r=t.g,o=t.b,a=t.a,i=(0,h.toPercentage)(a);X===v&&(U(n),V(r),W(o)),N(e.slice(1,7)),j(i),le(t)},pe=function(){return l.default.createElement("div",{className:"hex-container ml-2"},l.default.createElement("span",null,"#"),l.default.createElement(c.Input,{className:"hex-input",type:"text",value:I,onBlur:oe,onKeyDown:function(e){return ue(e,oe)},onChange:re}))},fe=function(){return l.default.createElement("div",{className:"rgb-container"},l.default.createElement("span",null,"R"),l.default.createElement(c.Input,{className:"rgb-input",type:"text",value:F,onBlur:function(){return se(y)},onChange:function(e){return ie(e,y)}}),l.default.createElement("span",null,"G"),l.default.createElement(c.Input,{className:"rgb-input",type:"text",value:H,onBlur:function(){return se(C)},onChange:function(e){return ie(e,C)}}),l.default.createElement("span",null,"B"),l.default.createElement(c.Input,{className:"rgb-input",type:"text",value:z,onBlur:function(){return se(A)},onChange:function(e){return ie(e,A)}}))};return l.default.createElement(f.default,{onClickOutside:function(){Q.length>=8&&Q.pop();var e=(0,h.rgbaToHex)(D);Q.includes(e)||(Q.unshift(e),window.localStorage.setItem(x,JSON.stringify(Q))),n()}},l.default.createElement("div",{style:i,ref:J,className:"dtable-color-picker"},function(){var e=b?b.slice(0,8):m;return l.default.createElement("div",{className:"default-color-setting"},l.default.createElement("span",null,(0,p.getLocale)("Default")),l.default.createElement("div",{className:"default-colors-container d-flex mt-2 mb-2"},e.map((function(e,t){var n=(0,h.isLightColor)(e);return l.default.createElement("div",{className:"color-item mr-2 ".concat(n?"":"dark"),onClick:function(){return de(e)},key:"default-color-".concat(t)},l.default.createElement("span",{className:"colorinput-color d-flex align-items-center justify-content-center",style:{backgroundColor:e}},e==="".concat((0,h.rgbaToHex)(D))&&100===O&&l.default.createElement("i",{className:"dtable-icon-color-check dtable-font dtable-icon-check-mark"})))}))))}(),l.default.createElement(l.default.Fragment,null,l.default.createElement("span",null,(0,p.getLocale)("Custom")),l.default.createElement(u.ChromePicker,{className:"mt-2",color:D,onChange:te}),l.default.createElement("div",{className:"color-setting d-flex align-items-center ".concat(X)},l.default.createElement("span",{className:"mode-btn d-flex",onClick:ne},X===g?"HEX":"RGB",l.default.createElement("i",{className:"dtable-font dtable-icon-right"})),X===g?pe():fe(),l.default.createElement(c.Input,{className:"alpha-input",type:"text",value:O+"%",onBlur:ce,onKeyDown:function(e){return ue(e,ce)},onChange:ae}))),l.default.createElement("div",{className:"current-used-container mt-2"},l.default.createElement("span",null,(0,p.getLocale)("Recently_used")),l.default.createElement("div",{className:"current-used-colors d-flex mt-2"},Q.length>0?l.default.createElement(l.default.Fragment,null,Q.map((function(e,t){var n=(0,h.isLightColor)(e);return l.default.createElement("div",{className:"color-item mr-2 ".concat(n?"":"dark"),onClick:function(){return de(e)},key:"default-color-".concat(t)},l.default.createElement("span",{className:"colorinput-color d-flex align-items-center justify-content-center",style:{backgroundColor:e}}))}))):l.default.createElement("div",{className:"blank-placeholder d-flex align-items-center justify-content-center"},l.default.createElement("span",null,"/"))))))}));b.defaultProps={color:"#ffffff"};t.default=b},82233:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toPercentage=t.rgbaToHex=t.isLightColor=t.hexToRgba=t.getInitialHexVal=void 0;var n=/^#?([a-fA-F0-9]{6}|[a-fA-F0-9]{3})$/i,r=/^rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})(?:\s*,\s*(0|1|0?\.\d+))?\s*\)$/i,o=function(e){try{if(r.test(e))return e;var t,n,a,i=1,s=e.replace(/^#/,"");if(6===s.length||8===s.length)t=parseInt(s.slice(0,2),16),n=parseInt(s.slice(2,4),16),a=parseInt(s.slice(4,6),16),i=8===s.length?Math.round(parseInt(s.slice(6,8),16)/255*100)/100:1;else{if(3!==s.length)throw new Error("Invalid HEX color.");t=parseInt(s[0]+s[0],16),n=parseInt(s[1]+s[1],16),a=parseInt(s[2]+s[2],16)}return{r:t,g:n,b:a,a:i}}catch(l){return console.error(l.message),o("#ffffff")}};t.hexToRgba=o;t.rgbaToHex=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(n.test(e))return e;var o=e.r,a=e.g,i=e.b,s=e.a,l=function(e){var t=e.toString(16);return 1===t.length?"0"+t:t},c=void 0!==s&&1!==s?l(Math.round(255*s)):"";return"".concat(t?"#":"").concat(l(o)).concat(l(a)).concat(l(i)).concat(r?c:"")};t.isLightColor=function(e){e.startsWith("#")&&(e=e.slice(1));var t=parseInt(e.substring(0,2),16),n=parseInt(e.substring(2,4),16),r=parseInt(e.substring(4,6),16),o=8===e.length?parseInt(e.substring(6,8),16)/255:1,a=255,i=255,s=255;return.2126*Math.round((1-o)*a+o*t)+.7152*Math.round((1-o)*i+o*n)+.0722*Math.round((1-o)*s+o*r)>128};t.getInitialHexVal=function(e){var t=e.slice(1);return t.length>6&&(t=t.slice(0,6)),t};t.toPercentage=function(e){return e<0||e>1?null:Math.round(100*e)}},8871:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(98201));n(38469);t.default=function(e){var t=e.callBack,n=e.footerName,r=e.className,a=e.addIconClassName,i=e.hideIcon,s=e.style;return o.default.createElement("div",{className:"dtable-ui add-item-btn ".concat(r||""),style:s,onClick:function(e){t(e)}},!i&&o.default.createElement("span",{className:"dtable-font dtable-icon-add-table ".concat(a||"")}),o.default.createElement("span",{className:"text-truncate"},n))}},30886:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default,l=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(98201)),u=s(n(28414)),d=n(48843),p=n(96795),f=s(n(72581));n(49202);var h=function(e){function t(e){var n;return r(this,t),(n=a(this,t,[e])).onSelectToggle=function(e){e.preventDefault(),n.state.isShowSelectOptions&&e.nativeEvent.stopImmediatePropagation();var t=e.target.className;n.props.isLocked||t.indexOf("option-search-control")>-1||"option-group-search"===t||""!==e.target.value&&(n.selectedOptionWidth=n.selectedOptionRef.clientWidth,n.setState({isShowSelectOptions:!n.state.isShowSelectOptions}))},n.onMousedown=function(e){var t=e.target.className;"select-placeholder"===t||t.includes("icon-fork-number")||n.selector.contains(e.target)||n.closeSelect()},n.closeSelect=function(){n.setState({isShowSelectOptions:!1})},n.getFilterOptions=function(e){var t=n.props,r=t.options;return t.searchable?(0,p.searchCollaborators)(r,e):r||[]},n.renderOptionGroup=function(){var e=n.props,t=e.value,r=e.options,o=e.searchable,a=e.searchPlaceholder,i=e.noOptionsPlaceholder,s=e.top,l=e.left;return e.isUsePopover?c.default.createElement(d.Popover,{placement:"bottom",isOpen:!0,target:n.id,fade:!1,hideArrow:!0,className:"dtable-customize-collaborator-select dtable-select"},c.default.createElement(f.default,{value:t,top:s,left:l,minWidth:n.btnWidth+8,options:r,onSelectOption:n.props.onSelectOption,searchable:o,searchPlaceholder:a,noOptionsPlaceholder:i,closeSelect:n.closeSelect,getFilterOptions:n.getFilterOptions,supportMultipleSelect:n.props.supportMultipleSelect,stopClickEvent:!0,isShowSelected:!0})):c.default.createElement(f.default,{value:t,top:s,left:l,minWidth:n.btnWidth+8,options:r,onSelectOption:n.props.onSelectOption,searchable:o,searchPlaceholder:a,noOptionsPlaceholder:i,closeSelect:n.closeSelect,getFilterOptions:n.getFilterOptions,supportMultipleSelect:n.props.supportMultipleSelect,stopClickEvent:!0,isShowSelected:!0})},n.state={isShowSelectOptions:!1},n.id="collaborator-select-"+Math.trunc(1e4*Math.random()),n}return i(t,e),o(t,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.onMousedown),this.btnWidth=this.selector.clientWidth}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.onMousedown)}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,r=t.value,o=t.placeholder,a=t.isLocked;return c.default.createElement("button",{ref:function(t){return e.selector=t},className:(0,u.default)("dtable-select custom-select collaborator-select",{focus:this.state.isShowSelectOptions},{disabled:a},n),id:this.id,onClick:this.onSelectToggle},c.default.createElement("div",{className:"selected-option",ref:function(t){return e.selectedOptionRef=t}},r.label?c.default.createElement("span",{className:"selected-option-show"},r.label):c.default.createElement("span",{className:"select-placeholder"},o),!a&&c.default.createElement("i",{className:"dtable-font dtable-icon-drop-down"})),this.state.isShowSelectOptions&&this.renderOptionGroup())}}])}(c.Component);h.defaultProps={top:-3,left:-3};t.default=h},80749:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(n(98201));n(70359);var c=function(e){function t(){return r(this,t),a(this,t,arguments)}return i(t,e),o(t,[{key:"render",value:function(){var e=this.props,t=e.text,n=e.title,r=e.type;return l.default.createElement("div",{className:"empty-tip"},l.default.createElement("img",{src:this.props.src,alt:"",width:"100",height:"100",className:"no-items-img-tip"}),n&&l.default.createElement("span",{className:"empty-tip-title"},n),t&&l.default.createElement("span",{className:"empty-tip-text",style:{color:"error"===r?"red":"#666"}},t),this.props.children&&this.props.children)}}])}(l.default.Component);t.default=c},65641:function(e,t,n){"use strict";var r=n(43693).default;Object.defineProperty(t,"__esModule",{value:!0}),t.STRING_PREDICATE=t.SPECIAL_TERM_TYPE=t.SIMPLE_TEXT_INPUT_COLUMNS_MAP=t.MULTIPLE_SELECTOR_COLUMNS=t.FORMULA_COLUMN_TYPES=t.FILTER_TERM_MODIFIER_SHOW=t.DATE_LABEL_MAP=t.DATE_EMPTY_LABEL_MAP=t.ARRAY_PREDICATE=void 0;var o=n(96795);t.FORMULA_COLUMN_TYPES=[o.CellType.FORMULA,o.CellType.LINK_FORMULA],t.SPECIAL_TERM_TYPE={CREATOR:"creator",SINGLE_SELECT:"single_select",MULTIPLE_SELECT:"multiple_select",COLLABORATOR:"collaborator",RATE:"rate"},t.SIMPLE_TEXT_INPUT_COLUMNS_MAP=r(r(r(r(r(r(r(r(r(r({},o.CellType.TEXT,!0),o.CellType.LONG_TEXT,!0),o.CellType.GEOLOCATION,!0),o.CellType.AUTO_NUMBER,!0),o.CellType.EMAIL,!0),o.CellType.URL,!0),o.CellType.IMAGE,!0),o.CellType.FILE,!0),o.FORMULA_RESULT_TYPE.STRING,!0),o.FORMULA_RESULT_TYPE.BOOL,!0),t.DATE_LABEL_MAP=r(r(r(r(r({},o.FILTER_TERM_MODIFIER_TYPE.EXACT_DATE,!0),o.FILTER_TERM_MODIFIER_TYPE.NUMBER_OF_DAYS_AGO,!0),o.FILTER_TERM_MODIFIER_TYPE.NUMBER_OF_DAYS_FROM_NOW,!0),o.FILTER_TERM_MODIFIER_TYPE.THE_NEXT_NUMBERS_OF_DAYS,!0),o.FILTER_TERM_MODIFIER_TYPE.THE_PAST_NUMBERS_OF_DAYS,!0),t.ARRAY_PREDICATE=r(r({},o.FILTER_PREDICATE_TYPE.IS_ANY_OF,!0),o.FILTER_PREDICATE_TYPE.IS_NONE_OF,!0),t.STRING_PREDICATE=r(r({},o.FILTER_PREDICATE_TYPE.IS,!0),o.FILTER_PREDICATE_TYPE.IS_NOT,!0),t.DATE_EMPTY_LABEL_MAP=r(r({},o.FILTER_PREDICATE_TYPE.EMPTY,!0),o.FILTER_PREDICATE_TYPE.NOT_EMPTY,!0),t.MULTIPLE_SELECTOR_COLUMNS=[o.CellType.MULTIPLE_SELECT,o.CellType.COLLABORATOR,o.CellType.CREATOR,o.CellType.LAST_MODIFIER],t.FILTER_TERM_MODIFIER_SHOW={today:"Today",tomorrow:"Tomorrow",yesterday:"Yesterday",one_week_ago:"One_week_ago",one_week_from_now:"One_week_from_now",one_month_ago:"One_month_ago",one_month_from_now:"One_month_from_now",number_of_days_ago:"Number_of_days_ago",number_of_days_from_now:"Number_of_days_from_now",exact_date:"Exact_date",the_past_week:"Last_week",the_past_month:"Last_month",the_past_year:"Last_year",the_next_week:"The_next_week",the_next_month:"The_next_month",the_next_year:"The_next_year",the_next_numbers_of_days:"The_next_numbers_of_days",the_past_numbers_of_days:"The_past_numbers_of_days",this_week:"This_week",this_month:"This_month",this_year:"This_year"}},16615:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default,l=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(98201)),u=s(n(75168)),d=n(48843),p=n(96795),f=s(n(8871)),h=n(70017),m=n(44017),g=s(n(45207)),v=s(n(4527)),y=n(38680),C=n(61779);n(55501);var A=function(e){function t(e){var n;return r(this,t),(n=a(this,t,[e])).onHotKey=function(e){(0,u.default)("esc",e)&&!n.isSelectOpen&&(e.preventDefault(),n.props.hidePopover())},n.setSelectStatus=function(e){n.isSelectOpen=e},n.hideDTablePopover=function(e){if(n.dtablePopoverRef&&!(0,h.getEventClassName)(e).includes("popover")&&!n.dtablePopoverRef.contains(e.target))return n.props.hidePopover(e),e.preventDefault(),e.stopPropagation(),!1},n.isNeedSubmit=function(){return n.props.isNeedSubmit},n.update=function(e){if(n.isNeedSubmit()){n.setState({filters:e,isSubmitDisabled:!1})}else n.setState({filters:e},(function(){var t={filters:e,filter_conjunction:n.state.filterConjunction};n.props.update(t)}))},n.deleteFilter=function(e,t){var r=n.state.filters.slice(0);r.splice(e,1),0===r.length&&t(),n.update(r)},n.updateFilter=function(e,t){var r=n.state.filters.slice(0);r[e]=t,n.update(r)},n.updateFilterConjunction=function(e){if(n.isNeedSubmit()){n.setState({filterConjunction:e,isSubmitDisabled:!1})}else n.setState({filterConjunction:e},(function(){var t={filters:n.state.filters,filter_conjunction:e};n.props.update(t)}))},n.addFilter=function(e){var t=n.props.columns,r=t[0];if(p.FILTER_COLUMN_OPTIONS[r.type]||(r=t.find((function(e){return p.FILTER_COLUMN_OPTIONS[e.type]}))),r){var o=(0,m.getFilterByColumn)(r),a=n.state.filters.slice(0);0===a.length&&e(),a.push(o),n.update(a)}},n.onClosePopover=function(){n.props.hidePopover()},n.onSubmitFilters=function(){var e=n.state,t={filters:e.filters,filter_conjunction:e.filterConjunction};n.props.update(t),n.props.hidePopover()},n.onPopoverInsideClick=function(e){e.stopPropagation()},n.state={filters:(0,p.getValidFilters)(e.filters,e.columns),filterConjunction:e.filterConjunction||"And"},n.isSelectOpen=!1,n}return i(t,e),o(t,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.hideDTablePopover,!0),document.addEventListener("keydown",this.onHotKey),this.unsubscribeOpenSelect=v.default.subscribe(y.EVENT_BUS_TYPE.OPEN_SELECT,this.setSelectStatus)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.hideDTablePopover,!0),document.removeEventListener("keydown",this.onHotKey),this.unsubscribeOpenSelect()}},{key:"render",value:function(){var e=this,t=this.props,n=t.target,r=t.columns,o=t.className,a=t.userDepartmentIdsMap,i=t.departments,s=t.lang,l=t.readOnly,u=this.state,p=u.filters,h=u.filterConjunction,m=r.length>0;return c.default.createElement(d.UncontrolledPopover,{placement:"auto-start",isOpen:!0,target:n,fade:!1,hideArrow:!0,className:"dtable-filter-popover",boundariesElement:document.body},(function(t){var n=t.scheduleUpdate;return c.default.createElement("div",{ref:function(t){return e.dtablePopoverRef=t},onClick:e.onPopoverInsideClick,className:o},c.default.createElement(g.default,{filterConjunction:h,filters:p,columns:r,emptyPlaceholder:(0,C.getLocale)("No_filters"),collaborators:e.props.collaborators,readOnly:l,scheduleUpdate:n,userDepartmentIdsMap:a,departments:i,lang:s,updateFilter:e.updateFilter,deleteFilter:e.deleteFilter,updateFilterConjunction:e.updateFilterConjunction}),c.default.createElement(f.default,{className:"popover-add-tool ".concat(m?"":"disabled"),callBack:m?function(){return e.addFilter(n)}:function(){},footerName:(0,C.getLocale)("Add_filter"),addIconClassName:"popover-add-icon"}),e.isNeedSubmit()&&c.default.createElement("div",{className:"dtable-filter-popover-footer"},c.default.createElement(d.Button,{className:"mr-2",onClick:e.onClosePopover},(0,C.getLocale)("Cancel")),c.default.createElement(d.Button,{color:"primary",disabled:e.state.isSubmitDisabled,onClick:e.onSubmitFilters},(0,C.getLocale)("Submit"))))}))}}])}(c.Component);A.defaultProps={className:"",readOnly:!1};t.default=A},62547:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(98201)),s=n(96795),l=n(61779),c=function(){return o((function e(){r(this,e)}),null,[{key:"generatorColumnOption",value:function(e){if(!e)return null;var t=e.type,n=e.name;return{value:{column:e},label:i.default.createElement(i.Fragment,null,i.default.createElement("span",{className:"filter-header-icon"},i.default.createElement("i",{className:s.COLUMNS_ICON_CONFIG[t]})),i.default.createElement("span",{className:"select-option-name"},n))}}},{key:"generatorPredicateOption",value:function(e){return{value:{filterPredicate:e},label:i.default.createElement("span",{className:"select-option-name"},(0,l.getLocale)(e))}}},{key:"generatorTermModifierOption",value:function(e){var t={today:(0,l.getLocale)("today"),tomorrow:(0,l.getLocale)("tomorrow"),yesterday:(0,l.getLocale)("yesterday"),one_week_ago:(0,l.getLocale)("one_week_ago"),one_week_from_now:(0,l.getLocale)("one_week_from_now"),one_month_ago:(0,l.getLocale)("one_month_ago"),one_month_from_now:(0,l.getLocale)("one_month_from_now"),number_of_days_ago:(0,l.getLocale)("number_of_days_ago"),number_of_days_from_now:(0,l.getLocale)("number_of_days_from_now"),exact_date:(0,l.getLocale)("exact_date"),the_past_week:(0,l.getLocale)("last_week"),the_past_month:(0,l.getLocale)("last_month"),the_past_year:(0,l.getLocale)("last_year"),the_next_week:(0,l.getLocale)("the_next_week"),the_next_month:(0,l.getLocale)("the_next_month"),the_next_year:(0,l.getLocale)("the_next_year"),the_next_numbers_of_days:(0,l.getLocale)("the_next_numbers_of_days"),the_past_numbers_of_days:(0,l.getLocale)("the_past_numbers_of_days"),this_week:(0,l.getLocale)("this_week"),this_month:(0,l.getLocale)("this_month"),this_year:(0,l.getLocale)("this_year")};return{value:{filterTermModifier:e},label:i.default.createElement("span",{className:"select-option-name"},t[e])}}},{key:"generatorSingleSelectOption",value:function(e){return{value:{columnOption:e},label:i.default.createElement("div",{className:"select-option-name"},i.default.createElement("div",{className:"single-select-option",style:{background:e.color,color:e.textColor||null},title:e.name,"aria-label":e.name},e.name))}}},{key:"generatorMultipleSelectOption",value:function(e,t){return{value:{columnOption:e},label:i.default.createElement("div",{className:"select-option-name multiple-option-name"},i.default.createElement("div",{className:"multiple-select-option",style:{background:e.color,color:e.textColor},title:e.name,"aria-label":e.name},e.name),i.default.createElement("div",{className:"multiple-check-icon"},t.indexOf(e.id)>-1&&i.default.createElement("i",{className:"option-edit dtable-font dtable-icon-check-mark"})))}}},{key:"generatorConjunctionOptions",value:function(){return[{value:{filterConjunction:"And"},label:i.default.createElement("span",{className:"select-option-name"},(0,l.getLocale)("And"))},{value:{filterConjunction:"Or"},label:i.default.createElement("span",{className:"select-option-name"},(0,l.getLocale)("Or"))}]}},{key:"getActiveConjunctionOption",value:function(e){return"And"===e?{value:{filterConjunction:"And"},label:i.default.createElement("span",{className:"select-option-name"},(0,l.getLocale)("And"))}:{value:{filterConjunction:"Or"},label:i.default.createElement("span",{className:"select-option-name"},(0,l.getLocale)("Or"))}}}])}();t.default=c},44017:function(e,t,n){"use strict";var r=n(41132).default,o=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"FilterItemUtils",{enumerable:!0,get:function(){return i.default}}),t.isFilterTermArray=t.isCheckboxColumn=t.getUpdatedFilterByTermModifier=t.getUpdatedFilterBySpecialTerm=t.getUpdatedFilterBySelectSingle=t.getUpdatedFilterBySelectMultiple=t.getUpdatedFilterByRate=t.getUpdatedFilterByPredicate=t.getUpdatedFilterByNormalTerm=t.getUpdatedFilterByCreator=t.getUpdatedFilterByColumn=t.getUpdatedFilterByCollaborator=t.getFormulaColumnFilter=t.getFilterByColumn=t.getDateColumnFormat=t.getColumnOptions=t.getColumnByKey=t.generateDefaultUser=void 0;var a=n(96795),i=o(n(62547)),s=n(65641),l=function(e){return a.COLLABORATOR_COLUMN_TYPES.includes(e)||e===a.CellType.SINGLE_SELECT||e===a.CellType.MULTIPLE_SELECT},c=function(e,t){var n=e.type,r=e.data;if(s.MULTIPLE_SELECTOR_COLUMNS.includes(n))return!0;if(n===a.CellType.SINGLE_SELECT&&[a.FILTER_PREDICATE_TYPE.IS_ANY_OF,a.FILTER_PREDICATE_TYPE.IS_NONE_OF].includes(t))return!0;if(s.FORMULA_COLUMN_TYPES.includes(n)){var o=r||{},i=o.result_type,c=o.array_type;return i===a.FORMULA_RESULT_TYPE.ARRAY&&l(c)}if(n===a.CellType.LINK){var u=(r||{}).array_type;return l(u)}return!1};t.isFilterTermArray=c;var u=function(e,t){var n=[a.FILTER_PREDICATE_TYPE.CONTAINS,a.FILTER_PREDICATE_TYPE.NOT_CONTAIN],r=e.filter_predicate,o=e.filter_term;if(n.includes(r)){o=o?e.filter_term.slice(0):[];var i=t.email,s=o.indexOf(i);s>-1?o.splice(s,1):o.push(i)}else{if(o[0]===t.email)return;o=[t.email]}return Object.assign({},e,{filter_term:o})};t.getUpdatedFilterByCreator=u;var d=function(e,t){var n;if(e.filter_predicate===a.FILTER_PREDICATE_TYPE.IS_ANY_OF||e.filter_predicate===a.FILTER_PREDICATE_TYPE.IS_NONE_OF){var o=(n=Array.isArray(e.filter_term)?r(e.filter_term):[]).indexOf(t.id);-1===o?n.push(t.id):n.splice(o,1)}else n=t.id;return Object.assign({},e,{filter_term:n})};t.getUpdatedFilterBySelectSingle=d;var p=function(e,t){var n=e.filter_term?e.filter_term:[],r=n.indexOf(t.id);return r>-1?n.splice(r,1):n.push(t.id),Object.assign({},e,{filter_term:n})};t.getUpdatedFilterBySelectMultiple=p;var f=function(e,t){var n=e.filter_term?e.filter_term.slice(0):[],r=t.email,o=n.indexOf(r);return o>-1?n.splice(o,1):n.push(r),Object.assign({},e,{filter_term:n})};t.getUpdatedFilterByCollaborator=f;var h=function(e,t){if(e.filter_term!==t)return Object.assign({},e,{filter_term:t})};t.getUpdatedFilterByRate=h;var m=function(e){var t=e.type,n=e.data;if(s.FORMULA_COLUMN_TYPES.includes(t))return g(e);if(t===a.CellType.LINK){var r=(n||{}).array_type;return r===a.FORMULA_RESULT_TYPE.BOOL?a.FILTER_COLUMN_OPTIONS[a.CellType.CHECKBOX]:r===a.FORMULA_RESULT_TYPE.STRING?a.FILTER_COLUMN_OPTIONS[a.CellType.TEXT]:v(r)}return a.FILTER_COLUMN_OPTIONS[t]||{}};t.getColumnOptions=m;var g=function(e){var t=e.data||{},n=t.result_type,r=t.array_type;return n===a.FORMULA_RESULT_TYPE.BOOL?a.FILTER_COLUMN_OPTIONS[a.CellType.CHECKBOX]:n===a.FORMULA_RESULT_TYPE.STRING?a.FILTER_COLUMN_OPTIONS[a.CellType.TEXT]:[a.FORMULA_RESULT_TYPE.NUMBER,a.FORMULA_RESULT_TYPE.DATE].includes(n)?a.FILTER_COLUMN_OPTIONS[n]:n===a.FORMULA_RESULT_TYPE.ARRAY?v(r):a.FILTER_COLUMN_OPTIONS[a.CellType.TEXT]},v=function(e){if(!e)return{};var t=e;if(a.COLLABORATOR_COLUMN_TYPES.includes(e)?t=a.CellType.COLLABORATOR:e===a.CellType.SINGLE_SELECT||e===a.CellType.DEPARTMENT_SINGLE_SELECT?t=a.CellType.MULTIPLE_SELECT:a.DATE_COLUMN_OPTIONS.includes(e)?t=a.CellType.DATE:(0,a.isNumericColumn)({type:e})&&(t=a.CellType.NUMBER),t===a.CellType.CHECKBOX||t===a.CellType.BOOL)return a.FILTER_COLUMN_OPTIONS[a.CellType.CHECKBOX];var n=a.FILTER_COLUMN_OPTIONS[t]||a.FILTER_COLUMN_OPTIONS[a.CellType.TEXT],r=n.filterPredicateList;return r&&!r.includes(a.FILTER_PREDICATE_TYPE.EMPTY)&&r.push(a.FILTER_PREDICATE_TYPE.EMPTY),r&&!r.includes(a.FILTER_PREDICATE_TYPE.NOT_EMPTY)&&r.push(a.FILTER_PREDICATE_TYPE.NOT_EMPTY),n},y=function(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).textDefaultPredicate,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=e.type,i=e.data,l=m(e).filterPredicateList;if(l){var u=l[0];n&&o===a.CellType.TEXT&&l.includes(n)&&(u=n);var d=Object.assign({},r,{column_key:e.key,filter_predicate:u});if(d.filter_term="",o===a.CellType.CHECKBOX)return d.filter_term=!1,d;if(o===a.CellType.RATE){var p=i.rate_max_number;return d.filter_term=p,d}if(c(e,u))return d.filter_term=[],d;if((0,a.isDateColumn)(e)){var f=u===a.FILTER_PREDICATE_TYPE.IS_WITHIN?a.filterTermModifierIsWithin[0]:a.filterTermModifierNotWithin[0];return d.filter_term_modifier=f,d.filter_term="",d}if(s.FORMULA_COLUMN_TYPES.includes(o)){var h=C(e,t,r);return h&&(d.filter_term=h.filter_term),d}if(o===a.CellType.LINK){var g=i||{},v=g.array_type,A=g.array_data;if(v){v===a.FORMULA_RESULT_TYPE.BOOL&&(v=a.CellType.CHECKBOX),v===a.FORMULA_RESULT_TYPE.STRING&&(v=a.CellType.TEXT);var x={key:e.key,type:v,data:A},b=y(x,t,r)||{};b&&(d.filter_term=b.filter_term)}return d}return d}};t.getFilterByColumn=y;var C=function(e,t,n){var r=e.data||{},o=r.result_type,i=r.array_type,s=r.array_data;if(o===a.FORMULA_RESULT_TYPE.ARRAY){var l={key:e.key,type:i,data:s};return y(l,t,n)}o===a.FORMULA_RESULT_TYPE.BOOL&&(i=a.CellType.CHECKBOX),o===a.FORMULA_RESULT_TYPE.STRING&&(i=a.CellType.TEXT);var c={key:e.key,type:i,data:s};return y(c,t,n)};t.getFormulaColumnFilter=C;t.getUpdatedFilterByColumn=function(e,t,n,r){var o=e[n];if(o.column_key!==r.key)return y(r,t,o)};t.getUpdatedFilterByPredicate=function(e,t,n){var r=Object.assign({},e,{filter_predicate:n}),o=t.type;if(o===a.CellType.CHECKBOX)return r.filter_term=!1,r;if([a.CellType.SINGLE_SELECT,a.CellType.DEPARTMENT_SINGLE_SELECT].includes(o))return s.ARRAY_PREDICATE[n]?s.ARRAY_PREDICATE[e.filter_predicate]!==s.ARRAY_PREDICATE[n]&&(r.filter_term=[]):s.STRING_PREDICATE[n]?s.STRING_PREDICATE[e.filter_predicate]!==s.STRING_PREDICATE[n]&&(r.filter_term=""):r.filter_term="",r;if([a.CellType.CREATOR,a.CellType.LAST_MODIFIER].includes(o)&&(s.STRING_PREDICATE[e.filter_predicate]===s.STRING_PREDICATE[n]&&n!==a.FILTER_PREDICATE_TYPE.INCLUDE_ME||(r.filter_term=[])),c(t,n))return(s.DATE_EMPTY_LABEL_MAP[n]||n===a.FILTER_PREDICATE_TYPE.INCLUDE_ME)&&(r.filter_term=[]),r;if((0,a.isDateColumn)(t)){var i=n===a.FILTER_PREDICATE_TYPE.IS_WITHIN?a.filterTermModifierIsWithin[0]:a.filterTermModifierNotWithin[0];return r.filter_term_modifier=i,r}return r};t.getUpdatedFilterByTermModifier=function(e,t,n){var r=e[t];if(r.filter_term_modifier!==n)return Object.assign({},r,{filter_term_modifier:n})};t.getUpdatedFilterByNormalTerm=function(e,t,n,r){var o,i=e[n];if(o=t.type===a.CellType.CHECKBOX?r.target.checked:r.target.value,i.filter_term!==o)return Object.assign({},i,{filter_term:o})};t.getUpdatedFilterBySpecialTerm=function(e,t,n,r){var o=e[t];switch(n){case s.SPECIAL_TERM_TYPE.CREATOR:return u(o,r);case s.SPECIAL_TERM_TYPE.SINGLE_SELECT:return d(o,r);case s.SPECIAL_TERM_TYPE.MULTIPLE_SELECT:return p(o,r);case s.SPECIAL_TERM_TYPE.COLLABORATOR:return f(o,r);case s.SPECIAL_TERM_TYPE.RATE:return h(o,r)}};t.getColumnByKey=function(e,t){return Array.isArray(e)&&t?e.find((function(e){return e.key===t})):null};t.isCheckboxColumn=function(e){var t=e.type,n=e.data;if(a.FORMULA_COLUMN_TYPES_MAP[t]){var r=n||{},o=r.result_type,i=r.array_type;return o===a.FORMULA_RESULT_TYPE.ARRAY&&i===a.CellType.CHECKBOX}return t===a.CellType.CHECKBOX};t.getDateColumnFormat=function(e){return e&&e.data&&e.data.format?e.data.format:a.DEFAULT_DATE_FORMAT};t.generateDefaultUser=function(e){var t=function(){var e,t,n,r;return(null===(e=window)||void 0===e||null===(t=e.dtable)||void 0===t?void 0:t.mediaUrl)||(null===(n=window)||void 0===n||null===(r=n.dtablePluginConfig)||void 0===r?void 0:r.mediaUrl)||"/media/"}();return{name:e,email:e,avatar_url:"".concat(t,"avatars/default.png")}}},93043:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default,l=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(98201)),u=n(96795),d=s(n(15462)),p=n(61779);n(84425);var f=function(e){function t(e){var n;return r(this,t),(n=a(this,t,[e])).createCollaboratorOptions=function(e,t,n){return t.map((function(t){var r=n.findIndex((function(e){return e===t.email}))>-1;return{value:{filterIndex:e,columnOption:t},label:c.default.createElement(c.Fragment,null,c.default.createElement("div",{className:"select-option-name option-collaborator"},c.default.createElement("div",{className:"collaborator-container"},c.default.createElement("div",{className:"collaborator"},c.default.createElement("span",{className:"collaborator-avatar-container"},c.default.createElement("img",{className:"collaborator-avatar",alt:t.name,src:t.avatar_url})),c.default.createElement("span",{className:"collaborator-name text-truncate",style:{maxWidth:"200px"},title:t.name,"aria-label":t.name},t.name))),c.default.createElement("div",{className:"collaborator-check-icon"},r&&c.default.createElement("i",{className:"option-edit dtable-font dtable-icon-check-mark"}))))}}))},n.onClick=function(e,t){e.stopPropagation(),n.props.onSelectCollaborator({columnOption:t})},n.supportMultipleSelectOptions=[u.FILTER_PREDICATE_TYPE.HAS_ANY_OF,u.FILTER_PREDICATE_TYPE.HAS_ALL_OF,u.FILTER_PREDICATE_TYPE.HAS_NONE_OF,u.FILTER_PREDICATE_TYPE.IS_EXACTLY],n}return i(t,e),o(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.filterIndex,r=t.filterTerm,o=t.collaborators,a=t.placeholder,i=t.filter_predicate,s=this.supportMultipleSelectOptions.indexOf(i)>-1,l=Array.isArray(r)&&r.length>0&&r.map((function(t){var n=o.find((function(e){return e.email===t}));return n?c.default.createElement("div",{key:t,className:"collaborator"},c.default.createElement("span",{className:"collaborator-avatar-container"},c.default.createElement("img",{className:"collaborator-avatar",alt:n.name,src:n.avatar_url})),c.default.createElement("span",{className:"collaborator-name text-truncate",title:n.name,"aria-label":n.name},n.name),c.default.createElement("span",{className:"remove-container"},c.default.createElement("span",{className:"remove-icon",onClick:function(t){e.onClick(t,n)}},c.default.createElement("i",{className:"dtable-font dtable-icon-fork-number"})))):null})),u=l?{label:c.default.createElement(c.default.Fragment,null,l)}:{},f=Array.isArray(r)?this.createCollaboratorOptions(n,o,r):[];return c.default.createElement(d.default,{className:"selector-collaborator",value:u,onSelectOption:this.props.onSelectCollaborator,options:f,placeholder:a,isLocked:this.props.isLocked,supportMultipleSelect:s,searchable:!0,searchPlaceholder:(0,p.getLocale)("Search_collaborator"),isShowSelected:!1})}}])}(c.Component);t.default=f},80301:function(e,t,n){"use strict";var r=n(85715).default,o=n(24994).default,a=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(98201)),s=o(n(28414)),l=o(n(26533)),c=o(n(84098)),u=n(60516),d=n(88053),p=n(61779);t.default=function(e){var t=e.value,n=e.departments,o=(0,i.useState)(!1),a=r(o,2),f=a[0],h=a[1],m=(0,i.useState)(t||[]),g=r(m,2),v=g[0],y=g[1],C=(0,i.useRef)(null);function A(t,n){t.stopPropagation(),t.nativeEvent.stopImmediatePropagation();var r=v.slice(0),o=r.findIndex((function(e){return e===n}));-1!==o?r.splice(o,1):r.push(n),y(r);var a={id:n};e.onCommit({columnOption:a})}return(0,d.useClickOutside)({currDOM:C.current,onClickOutside:function(){return h(!1)}},[v]),i.default.createElement("div",{ref:C,className:(0,s.default)("dtable-select custom-select",{focus:f}),onClick:function(e){e.preventDefault(),h(!f)},id:"filter-department-editor"},i.default.createElement("div",{className:"selected-option"},v.length>0?i.default.createElement("span",{className:"selected-option-show"},i.default.createElement(l.default,{value:v,departments:n})):i.default.createElement("span",{className:"select-placeholder"},(0,p.getLocale)("Select_department")),i.default.createElement("span",{className:"dtable-font dtable-icon-drop-down"})),f&&i.default.createElement(c.default,{isShowSelectedDepartments:!1,classNamePrefix:"filter",value:v,onCommit:A,renderUserDepartmentOptions:function(){return u.DEPARTMENT_SELECT_RANGE_OPTIONS.slice(0,2).map((function(e,t){var n=e.type,r=e.name;return i.default.createElement("div",{className:"dropdown-item d-flex align-items-center",key:t,onClick:function(e){return A(e,n)}},i.default.createElement("input",{type:"checkbox",className:"vam department-select-input",checked:v.includes(n),onChange:function(e){return A(e,n)}}),i.default.createElement("span",{className:"text-truncate department-name"},(0,p.getLocale)(r)))}))},departments:n}))}},47233:function(e,t,n){"use strict";var r=n(85715).default,o=n(24994).default,a=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(98201)),s=o(n(28414)),l=o(n(26533)),c=o(n(69517)),u=n(60516),d=n(88053),p=n(61779);t.default=function(e){var t=e.value,n=e.column,o=e.departments,a=e.userDepartmentIdsMap,f=(0,i.useState)(!1),h=r(f,2),m=h[0],g=h[1],v=(0,i.useState)(t||""),y=r(v,2),C=y[0],A=y[1],x=(0,i.useRef)(null),b=[];return b.push(t),(0,d.useClickOutside)({currDOM:x.current,onClickOutside:function(){return g(!1)}},[C]),i.default.createElement("div",{ref:x,className:(0,s.default)("dtable-select custom-select",{focus:m}),onClick:function(e){e.preventDefault(),g(!m)},id:"filter-department-editor"},i.default.createElement("div",{className:"selected-option"},t?i.default.createElement("span",{className:"selected-option-show"},i.default.createElement(l.default,{value:b,departments:o})):i.default.createElement("span",{className:"select-placeholder"},(0,p.getLocale)("Select_department")),i.default.createElement("span",{className:"dtable-font dtable-icon-drop-down"})),m&&i.default.createElement(c.default,{enableSelectRange:!1,column:n,value:t,onCommit:function(t){A(t),g(!1);var n={id:t};e.onCommit({columnOption:n})},userDepartmentIdsMap:a,departments:o,renderUserDepartmentOptions:function(e){return o&&0!==o.length?u.DEPARTMENT_SELECT_RANGE_OPTIONS.slice(0,2).map((function(t,n){var r=t.type,o=t.name;return i.default.createElement("div",{className:"dropdown-item department-item d-flex align-items-center",key:n,onClick:function(t){return e(t,r)}},i.default.createElement("div",{className:"department-item-left-content d-flex align-items-center"},i.default.createElement("span",{className:"text-truncate department-name"},(0,p.getLocale)(o)),C===r&&i.default.createElement("span",{className:"department-check-icon"},i.default.createElement("i",{className:"dtable-font dtable-icon-check-mark"}))))})):[]}}))}},65642:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default,l=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(98201)),u=s(n(47629));n(86210),n(6037);var d=s(n(32712)),p=s(n(94082)),f=n(61779),h=n(44017);n(60062);var m=(0,u.default)(),g=function(e){function t(e){var n;r(this,t),(n=a(this,t,[e])).handleMouseDown=function(e){e.preventDefault()},n.onChange=function(e){var t=n.props.onChange;n.setState({value:e},(function(){n.state.value&&t(n.state.value.format("YYYY-MM-DD"))}))},n.onClear=function(){n.setState({value:null},(function(){n.setState({open:!0})}))},n.onOpenChange=function(e){n.setState({open:e})},n.onReadOnlyFocus=function(){!n.state.open&&n.state.isMouseDown?n.setState({isMouseDown:!1}):n.setState({open:!0})},n.getCalendarContainer=function(){return n.calendarContainerRef.current},n.getCalendarFormat=function(){var e=[];if(n.columnDataFormat.indexOf("YYYY-MM-DD")>-1){var t=n.columnDataFormat.replace("YYYY-MM-DD","YYYY-M-D");e=[n.columnDataFormat,t]}else if(n.columnDataFormat.indexOf("DD/MM/YYYY")>-1){var r=n.columnDataFormat.replace("DD/MM/YYYY","D/M/YYYY");e=[n.columnDataFormat,r]}else e=[n.columnDataFormat];return e},n.state={open:!1,value:null};var o=(0,h.getDateColumnFormat)(e.filterColumn).trim();return n.columnDataFormat=o.split(" ")[0],n.calendarContainerRef=c.default.createRef(),n.defaultCalendarValue=null,n}return i(t,e),o(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.value,n="zh-cn"===e.lang;if(m=n?m.locale("zh-cn"):m.locale("en-gb"),this.defaultCalendarValue=m.clone(),t&&(0,u.default)(t).isValid()){var r=(0,u.default)(t).isValid()?(0,u.default)(t):(0,u.default)(this.defaultCalendarValue);this.setState({value:n?(0,u.default)(r).locale("zh-cn"):(0,u.default)(r).locale("en-gb")})}}},{key:"render",value:function(){var e=this,t=this.props.isReadOnly,n=this.state;if(t)return c.default.createElement("input",{className:"ant-calendar-picker-input ant-input form-control",value:n.value?n.value.format(this.columnDataFormat):"",disabled:!0});var r=this.getCalendarFormat(),o=c.default.createElement("i",{className:"item-icon dtable-font dtable-icon-x",style:{position:"absolute",top:"15px",left:"225px",color:"gray",fontSize:"12px"}}),a=c.default.createElement(d.default,{className:"dtable-rc-calendar",locale:(0,f.translateCalendar)(),style:{zIndex:1001},dateInputPlaceholder:"please enter date",format:r,defaultValue:this.defaultCalendarValue,showDateInput:!0,focusablePanel:!1,onClear:this.onClear,clearIcon:o});return c.default.createElement("div",{className:"date-picker-container"},c.default.createElement(p.default,{calendar:a,value:n.value,onChange:this.onChange,getCalendarContainer:this.getCalendarContainer,onOpenChange:this.onOpenChange,open:n.open,style:{zIndex:1001}},(function(t){var n=t.value;return c.default.createElement("span",{tabIndex:"0",onFocus:e.onReadOnlyFocus},c.default.createElement("input",{tabIndex:"-1",readOnly:!0,className:"ant-calendar-picker-input ant-input form-control",value:n?n.format(e.columnDataFormat):"",onMouseDown:e.handleMouseDown}),c.default.createElement("div",{ref:e.calendarContainerRef}))})))}}])}(c.Component);t.default=g},65219:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default,l=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(98201)),u=s(n(28414)),d=n(48843),p=n(96795),f=s(n(15462)),h=s(n(71449)),m=s(n(93043)),g=s(n(47233)),v=s(n(80301)),y=s(n(89047)),C=s(n(65642)),A=n(44017),x=n(61779),b=[p.FILTER_PREDICATE_TYPE.EMPTY,p.FILTER_PREDICATE_TYPE.NOT_EMPTY],_=function(e){function t(e){var n,o;return r(this,t),n=a(this,t,[e]),o=n,n.initSelectOptions=function(e){var t=e.filter,r=e.filterColumn,o=e.value,a=(0,A.getColumnOptions)(r,o),i=a.filterPredicateList,s=a.filterTermModifierList;n.filterPredicateOptions=i?i.map((function(e){return A.FilterItemUtils.generatorPredicateOption(e)})).filter((function(e){return e})):[];var l=t.filter_predicate;(0,p.isDateColumn)(r)&&(l===p.FILTER_PREDICATE_TYPE.IS_WITHIN&&(s=p.filterTermModifierIsWithin),n.filterTermModifierOptions=s.map((function(e){return A.FilterItemUtils.generatorTermModifierOption(e)})))},n.onDeleteFilter=function(e){e.nativeEvent.stopImmediatePropagation();var t=n.props.index;n.props.deleteFilter(t)},n.resetState=function(e){n.setState({filterTerm:e.filter_term})},n.onSelectConjunction=function(e){n.props.filterConjunction!==e.filterConjunction&&n.props.updateConjunction(e.filterConjunction)},n.onSelectColumn=function(e){var t=n.props,r=t.index,o=t.filter,a=e.column;if(a.key!==o.column_key){var i=(0,A.getFilterByColumn)(a,o);i&&(n.resetState(i),n.props.updateFilter(r,i))}},n.onSelectPredicate=function(e){var t=n.props,r=t.index,o=t.filter,a=t.filterColumn,i=e.filterPredicate;if(o.filter_predicate!==i){var s=(0,A.getUpdatedFilterByPredicate)(o,a,i);n.resetState(s),n.props.updateFilter(r,s)}},n.onSelectTermModifier=function(e){var t=n.props,r=t.index,o=t.filter,a=e.filterTermModifier,i=[p.FILTER_TERM_MODIFIER_TYPE.EXACT_DATE,p.FILTER_TERM_MODIFIER_TYPE.NUMBER_OF_DAYS_AGO,p.FILTER_TERM_MODIFIER_TYPE.NUMBER_OF_DAYS_FROM_NOW,p.FILTER_TERM_MODIFIER_TYPE.THE_NEXT_NUMBERS_OF_DAYS,p.FILTER_TERM_MODIFIER_TYPE.THE_PAST_NUMBERS_OF_DAYS];if(o.filter_term_modifier!==a){var s=o.filter_term;i.indexOf(o.filter_term_modifier)>-1&&(s="");var l=Object.assign({},o,{filter_term_modifier:a,filter_term:s});n.resetState(l),n.props.updateFilter(r,l)}},n.onSelectSingle=function(e){var t=n.props,r=t.index,o=t.filter,a=e.columnOption;if(o.filter_term!==a.id){var i=(0,A.getUpdatedFilterBySelectSingle)(o,a);n.resetState(i),n.props.updateFilter(r,i)}},n.onSelectMultiple=function(e){var t=n.props,r=t.index,o=t.filter,a=e.columnOption,i=(0,A.getUpdatedFilterBySelectMultiple)(o,a);n.resetState(i),n.props.updateFilter(r,i)},n.onSelectCollaborator=function(e){var t=n.props,r=t.index,o=t.filter,a=e.columnOption,i=(0,A.getUpdatedFilterByCollaborator)(o,a);n.resetState(i),n.props.updateFilter(r,i)},n.onSelectCreator=function(e){var t=n.props,r=t.index,o=t.filter,a=e.columnOption,i=(0,A.getUpdatedFilterByCreator)(o,a);i&&(n.resetState(i),n.props.updateFilter(r,i))},n.onFilterTermCheckboxChanged=function(e){n.onFilterTermChanged(e.target.checked)},n.onFilterTermTextChanged=function(e){n.onFilterTermChanged(e)},n.onFilterTermChanged=function(e){var t=n.props,r=t.index,o=t.filter;if(e!==n.state.filterTerm){n.setState({filterTerm:e});var a=Object.assign({},o,{filter_term:e});n.props.updateFilter(r,a)}},n.onMouseEnterRateItem=function(e){n.setState({enterRateItemIndex:e})},n.onMouseLeaveRateItem=function(){n.setState({enterRateItemIndex:0})},n.onChangeRateNumber=function(e){n.onFilterTermChanged(e)},n.getInputComponent=function(e){var t=n.state.filterTerm;return"text"===e?c.default.createElement(h.default,{value:t,onChange:n.onFilterTermTextChanged,autoFocus:!1,className:(0,u.default)("text-truncate")}):"checkbox"===e?c.default.createElement("input",{type:"checkbox",checked:t,onChange:n.onFilterTermCheckboxChanged}):void 0},n.renderConjunction=function(){var e=n.props,t=e.index,r=e.filterConjunction,o=e.conjunctionOptions;switch(t){case 0:return null;case 1:var a=A.FilterItemUtils.getActiveConjunctionOption(r);return c.default.createElement(f.default,{value:a,options:o,onSelectOption:n.onSelectConjunction});default:return c.default.createElement("span",{className:"selected-conjunction-show"},(0,x.getLocale)(r))}},n.renderMultipleSelectOption=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=o.props.filter.filter_predicate,r=!1;[p.FILTER_PREDICATE_TYPE.IS_ANY_OF,p.FILTER_PREDICATE_TYPE.IS_NONE_OF,p.FILTER_PREDICATE_TYPE.HAS_ANY_OF,p.FILTER_PREDICATE_TYPE.HAS_ALL_OF,p.FILTER_PREDICATE_TYPE.HAS_NONE_OF,p.FILTER_PREDICATE_TYPE.IS_EXACTLY].includes(n)&&(r=!0);var a=[];Array.isArray(e)&&Array.isArray(t)&&t.forEach((function(t){var n=e.find((function(e){return e.id===t}));if(n){var r={margin:"0 10px 0 0",background:n.color,color:n.textColor||null};a.push(c.default.createElement("span",{className:"select-option-name multiple-select-option",style:r,key:"option_"+t,title:n.name,"aria-label":n.name},n.name))}}));var i=a.length>0?{label:c.default.createElement(c.Fragment,null,a)}:{},s=e.map((function(e){return A.FilterItemUtils.generatorMultipleSelectOption(e,t)}));return c.default.createElement(f.default,{className:"selector-multiple-select",value:i,options:s,onSelectOption:o.onSelectMultiple,placeholder:(0,x.getLocale)("Select_option(s)"),searchable:!0,searchPlaceholder:(0,x.getLocale)("Search_option"),noOptionsPlaceholder:(0,x.getLocale)("No_options_available"),supportMultipleSelect:r})},n.renderFilterTerm=function(e){var t=n.props,r=t.index,o=t.filter,a=t.collaborators,i=t.userDepartmentIdsMap,s=t.departments,l=t.lang,u=e.type,d=o.filter_term,h=o.filter_predicate,_=o.filter_term_modifier;if(b.includes(h))return null;if((0,p.isDateColumn)(e))return[p.FILTER_TERM_MODIFIER_TYPE.EXACT_DATE,p.FILTER_TERM_MODIFIER_TYPE.NUMBER_OF_DAYS_AGO,p.FILTER_TERM_MODIFIER_TYPE.NUMBER_OF_DAYS_FROM_NOW,p.FILTER_TERM_MODIFIER_TYPE.THE_NEXT_NUMBERS_OF_DAYS,p.FILTER_TERM_MODIFIER_TYPE.THE_PAST_NUMBERS_OF_DAYS].indexOf(_)>-1?"exact_date"===_?c.default.createElement(C.default,{lang:l,value:n.state.filterTerm,filterColumn:e,onChange:n.onFilterTermTextChanged}):n.getInputComponent("text"):null;switch(u){case p.CellType.TEXT:case p.CellType.LONG_TEXT:case p.CellType.GEOLOCATION:case p.CellType.NUMBER:case p.CellType.AUTO_NUMBER:case p.CellType.DURATION:case p.CellType.EMAIL:case p.CellType.URL:return h===p.FILTER_PREDICATE_TYPE.IS_CURRENT_USER_ID?null:n.getInputComponent("text");case p.CellType.CHECKBOX:return n.getInputComponent("checkbox");case p.CellType.SINGLE_SELECT:var w=(e.data||{}).options,S=void 0===w?[]:w;if([p.FILTER_PREDICATE_TYPE.IS_ANY_OF,p.FILTER_PREDICATE_TYPE.IS_NONE_OF].includes(h))return n.renderMultipleSelectOption(S,d);var D=S.find((function(e){return e.id===d})),E={};if(D){var k={background:D.color,color:D.textColor||null};E={label:c.default.createElement("span",{className:"select-option-name single-select-option",style:k,title:D.name,"aria-label":D.name},D.name)}}var M=S.map((function(e){return A.FilterItemUtils.generatorSingleSelectOption(e)}));return c.default.createElement(f.default,{className:"selector-single-select",value:E,options:M,onSelectOption:n.onSelectSingle,placeholder:(0,x.getLocale)("Select_an_option"),searchable:!0,searchPlaceholder:(0,x.getLocale)("Search_option"),noOptionsPlaceholder:(0,x.getLocale)("No_options_available")});case p.CellType.MULTIPLE_SELECT:var I=(e.data||{}).options,N=void 0===I?[]:I;return n.renderMultipleSelectOption(N,d);case p.CellType.DEPARTMENT_SINGLE_SELECT:return[p.FILTER_PREDICATE_TYPE.IS_ANY_OF,p.FILTER_PREDICATE_TYPE.IS_NONE_OF].includes(h)?c.default.createElement(v.default,{value:d||[],userDepartmentIdsMap:i,departments:s,onCommit:n.onSelectMultiple}):c.default.createElement(g.default,{column:e,value:d||"",userDepartmentIdsMap:i,departments:s,onCommit:n.onSelectSingle});case p.CellType.COLLABORATOR:return h===p.FILTER_PREDICATE_TYPE.INCLUDE_ME?null:c.default.createElement(m.default,{filterIndex:r,filterTerm:d||[],filter_predicate:h,collaborators:a,onSelectCollaborator:n.onSelectCollaborator});case p.CellType.CREATOR:case p.CellType.LAST_MODIFIER:if(h===p.FILTER_PREDICATE_TYPE.INCLUDE_ME)return null;var P=a.concat([(0,A.generateDefaultUser)("anonymous")]);return c.default.createElement(m.default,{filterIndex:r,filterTerm:d||[],collaborators:P,onSelectCollaborator:n.onSelectCreator});case p.CellType.RATE:for(var T=(e.data||{}).rate_max_number,O=[],j=0;j<T;j++){var R=c.default.createElement(y.default,{key:j,enterRateItemIndex:n.state.enterRateItemIndex,rateItemIndex:j+1,onMouseEnterRateItem:n.onMouseEnterRateItem,onMouseLeaveRateItem:n.onMouseLeaveRateItem,value:Number(d)||T,column:e,isShowRateItem:!0,onChangeRateNumber:n.onChangeRateNumber,editable:!0});O.push(R)}return c.default.createElement("div",{className:"filter-rate-list"},O);case p.CellType.FORMULA:case p.CellType.LINK_FORMULA:return n.renderFormulaFilterTerm(h,d,r,e);case p.CellType.LINK:return n.renderLinkFilterTerm(h,d,r,e);default:return null}},n.renderFormulaFilterTerm=function(e,t,r,o){var a=((o||{}).data||{}).result_type;return e===p.FILTER_PREDICATE_TYPE.IS_CURRENT_USER_ID?null:a===p.FORMULA_RESULT_TYPE.ARRAY?n.renderFilterTermByArrayType(e,t,r,o):n.getInputComponent("text")},n.renderLinkFilterTerm=function(e,t,r,o){return e===p.FILTER_PREDICATE_TYPE.IS_CURRENT_USER_ID?null:n.renderFilterTermByArrayType(e,t,r,o)},n.renderFilterTermByArrayType=function(e,t,r,o){var a=n.props,i=a.collaborators,s=a.departments,l=(o||{}).data||{},u=l.array_type,d=l.array_data;if(!u)return null;var f={type:u,data:d};if(u===p.CellType.SINGLE_SELECT||u===p.CellType.MULTIPLE_SELECT){var h=(d||{}).options,g=void 0===h?[]:h;return n.renderMultipleSelectOption(g,t)}return u===p.CellType.DEPARTMENT_SINGLE_SELECT?c.default.createElement(v.default,{value:t||[],departments:s,onCommit:n.onSelectMultiple}):p.DATE_COLUMN_OPTIONS.includes(u)||u===p.CellType.RATE||u===p.CellType.CHECKBOX?n.renderFilterTerm(f):p.COLLABORATOR_COLUMN_TYPES.includes(u)?e===p.FILTER_PREDICATE_TYPE.INCLUDE_ME?null:c.default.createElement(m.default,{filterIndex:r,filterTerm:t||[],collaborators:i,onSelectCollaborator:n.onSelectCollaborator,placeholder:(0,x.getLocale)("Add_collaborator")}):n.getInputComponent("text")},n.renderErrorMessage=function(){return c.default.createElement("div",{className:"ml-2"},c.default.createElement("span",{ref:n.invalidFilterTip,className:"dtable-font dtable-icon-exclamation-triangle invalid-filter"}),c.default.createElement(d.UncontrolledTooltip,{target:n.invalidFilterTip,placement:"bottom",fade:!1},(0,x.getLocale)("Invalid_filter")))},n.state={filterTerm:e.filter.filter_term,enterRateItemIndex:0},n.filterPredicateOptions=null,n.filterTermModifierOptions=null,n.invalidFilterTip=c.default.createRef(),n.initSelectOptions(e),n}return i(t,e),o(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.props.filter;e.filter!==t&&(this.initSelectOptions(e),this.setState({filterTerm:e.filter.filter_term}))}},{key:"shouldComponentUpdate",value:function(e){var t=this.props;return e.index!==t.index||e.filter!==t.filter||e.filterColumn!==t.filterColumn||e.filterConjunction!==t.filterConjunction||e.conjunctionOptions!==t.conjunctionOptions||e.filterColumnOptions!==t.filterColumnOptions}},{key:"render",value:function(){var e=this.filterPredicateOptions,t=this.filterTermModifierOptions,n=this.props,r=n.filter,o=n.filterColumn,a=n.filterColumnOptions,i=n.errMsg,s=r.filter_predicate,l=r.filter_term_modifier,u=A.FilterItemUtils.generatorColumnOption(o),d=A.FilterItemUtils.generatorPredicateOption(s),h=null,m=!1;(0,p.isDateColumn)(o)?h=A.FilterItemUtils.generatorTermModifierOption(l):(0,A.isCheckboxColumn)(o)&&(m=!0);var g=!b.includes(s);return c.default.createElement("div",{className:"filter-item"},c.default.createElement("div",{className:"delete-filter",onClick:this.onDeleteFilter},c.default.createElement("i",{className:"dtable-font dtable-icon-fork-number"})),c.default.createElement("div",{className:"condition"},c.default.createElement("div",{className:"filter-conjunction"},this.renderConjunction()),c.default.createElement("div",{className:"filter-container"},c.default.createElement("div",{className:"filter-column"},c.default.createElement(f.default,{value:u,options:a,onSelectOption:this.onSelectColumn,searchable:!0,searchPlaceholder:(0,x.getLocale)("Search_column"),noOptionsPlaceholder:(0,x.getLocale)("No_results")})),c.default.createElement("div",{className:"filter-predicate ml-2 ".concat(m?"filter-checkbox-predicate":"")},c.default.createElement(f.default,{value:d,options:e,onSelectOption:this.onSelectPredicate})),(0,p.isDateColumn)(o)&&g&&c.default.createElement("div",{className:"filter-term-modifier ml-2"},c.default.createElement(f.default,{value:h,options:t,onSelectOption:this.onSelectTermModifier})),c.default.createElement("div",{className:"filter-term ml-2"},this.renderFilterTerm(o)),i&&this.renderErrorMessage())))}}])}(c.default.Component);t.default=_},45207:function(e,t,n){"use strict";var r=n(43693).default,o=n(17383).default,a=n(34579).default,i=n(18336).default,s=n(29511).default,l=n(24994).default,c=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u=c(n(98201)),d=l(n(28414)),p=n(96795),f=l(n(65219)),h=n(44017);n(13461);var m=function(e){function t(e){var n;return o(this,t),(n=i(this,t,[e])).updateFilter=function(e,t){t&&n.props.updateFilter(e,t)},n.deleteFilter=function(e){var t=n.props.scheduleUpdate;n.props.deleteFilter(e,t)},n.updateConjunction=function(e){n.props.updateFilterConjunction(e)},n.getConjunctionOptions=function(){return n.conjunctionOptions||(n.conjunctionOptions=h.FilterItemUtils.generatorConjunctionOptions()),n.conjunctionOptions},n.getFilterColumns=function(){return n.props.columns.filter((function(e){var t=e.data,n=e.type;return t&&(n===p.CellType.LINK||p.FORMULA_COLUMN_TYPES_MAP[n]&&t.result_type===p.FORMULA_RESULT_TYPE.ARRAY)&&(n=t.array_type),Object.prototype.hasOwnProperty.call(p.FILTER_COLUMN_OPTIONS,n)}))},n.getColumnOptions=function(){if(!n.columnOptions){var e=n.getFilterColumns();n.columnOptions=e.map((function(e){return h.FilterItemUtils.generatorColumnOption(e)}))}return n.columnOptions},n.renderFilterItem=function(e,t,r,o){var a=n.props,i=a.filterConjunction,s=a.value,l=a.isLocked,c=a.collaborators,d=a.userDepartmentIdsMap,p=a.departments,h=a.lang,m=n.getConjunctionOptions(),g=n.getColumnOptions();return u.default.createElement(f.default,{key:t,isLocked:l,index:t,filter:e,errMsg:r,filterColumn:o,filterConjunction:i,conjunctionOptions:m,filterColumnOptions:g,value:s,collaborators:c,userDepartmentIdsMap:d,departments:p,lang:h,deleteFilter:n.deleteFilter,updateFilter:n.updateFilter,updateConjunction:n.updateConjunction})},n.conjunctionOptions=null,n.columnOptions=null,n}return s(t,e),a(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.columns!==this.props.columns&&(this.columnOptions=null)}},{key:"render",value:function(){var e=this,t=this.props,n=t.filters,o=t.className,a=t.emptyPlaceholder,i=t.columns,s=0===n.length;return u.default.createElement("div",{className:(0,d.default)("filters-list",{"empty-filters-container":s},r({},o,o))},s&&u.default.createElement("div",{className:"empty-filters-list"},a),!s&&n.map((function(t,n){var r=t.column_key,o=p.ValidateFilter.validateColumn(r,i).error_message,a=(0,h.getColumnByKey)(i,r)||{};return e.renderFilterItem(t,n,o,a)})))}}])}(u.Component);t.default=m},89047:function(e,t,n){"use strict";var r=n(12897).default,o=n(17383).default,a=n(34579).default,i=n(18336).default,s=n(29511).default,l=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(98201)),u=n(48843),d=function(e){function t(e){var n;return o(this,t),(n=i(this,t,[e])).onMouseEnterRateItem=function(){var e=n.props.rateItemIndex;n.props.onMouseEnterRateItem(e)},n.onMouseLeaveRateItem=function(){n.props.onMouseLeaveRateItem()},n.onChangeRateNumber=function(){var e=n.props,t=e.onChangeRateNumber,r=e.rateItemIndex,o=e.editable;t&&o&&t(r)},n.tooltipRef=c.default.createRef(),n.state={isOpen:!1},n}return s(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.enterRateItemIndex,n=e.rateItemIndex,o=e.value,a=e.column,i=e.isShowRateItem,s=e.editable,l=a.data||{},d=l.rate_style_color,p=l.rate_style_type,f=p||"dtable-icon-rate";if(!i&&n>o)return null;var h={cursor:s?"pointer":"default",color:o>=n?d:"#e5e5e5"},m=h;return t>=n&&(m=r(r({},h),{},{color:d,opacity:.4})),c.default.createElement("div",{onMouseEnter:this.onMouseEnterRateItem,onMouseLeave:this.onMouseLeaveRateItem,style:m,onClick:this.onChangeRateNumber,className:"rate-item ".concat(o>=n?"rate-item-active":"")},c.default.createElement("span",{className:"dtable-font ".concat(f),ref:this.tooltipRef}),s&&c.default.createElement(u.UncontrolledTooltip,{placement:"bottom",target:this.tooltipRef},n))}}])}(c.default.Component);t.default=d},78036:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(n(98201)),c=n(48843),u=n(70017),d=function(e){function t(){var e;return r(this,t),(e=a(this,t,arguments)).dtablePopoverRef=null,e.onHistoryState=function(t){t.preventDefault(),e.props.hideDTablePopover(t)},e.onKeyDown=function(t){var n=e.props,r=n.canHideDTablePopover,o=n.hideDTablePopoverWithEsc;if(27===t.keyCode&&"function"===typeof o)t.preventDefault(),o();else if(13===t.keyCode){if(r)return;t.stopImmediatePropagation()}},e.onMousedown=function(t){e.props.canHideDTablePopover&&e.dtablePopoverRef&&t&&-1===(0,u.getEventClassName)(t).indexOf("popover")&&!e.dtablePopoverRef.contains(t.target)&&e.props.hideDTablePopover(t)},e.onPopoverInsideClick=function(e){e.stopPropagation()},e}return i(t,e),o(t,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.onMousedown),document.addEventListener("keydown",this.onKeyDown),window.addEventListener("popstate",this.onHistoryState)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.onMousedown),document.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("popstate",this.onHistoryState)}},{key:"render",value:function(){var e=this,t=this.props,n=t.target,r=t.innerClassName,o=t.popoverClassName,a=t.hideArrow,i=t.modifiers,s=t.placement;return l.default.createElement(c.Popover,{placement:s,isOpen:!0,target:n,fade:!1,hideArrow:a,innerClassName:r,className:o,modifiers:i},l.default.createElement("div",{ref:function(t){return e.dtablePopoverRef=t},onClick:this.onPopoverInsideClick},this.props.children))}}])}(l.default.Component);d.defaultProps={placement:"bottom-start",hideArrow:!0,canHideDTablePopover:!0};t.default=d},76994:function(e,t,n){"use strict";var r=n(43693).default,o=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n(98201)),i=o(n(28414));function s(e){var t=e.className;return a.default.createElement("label",{className:(0,i.default)("dtable-radio w-100 align-items-center",r({"dtable-radio-disable":e.disabled},t,t))},a.default.createElement("input",{type:"radio",className:"dtable-radio-input position-absolute",checked:e.isChecked,onChange:e.disabled?function(){}:e.onCheckedChange,name:e.name,value:e.value}),a.default.createElement("span",{className:(0,i.default)("dtable-radio-indicator position-relative",{"dtable-radio-selected-indicator":e.isChecked,"dtable-radio-indicator-disable":e.disabled})}),a.default.createElement("span",{className:"dtable-radio-description text-truncate ml-2"},e.label))}n(83162),s.defaultProps={disabled:!1,name:"dtable-radio-input",onCheckedChange:function(){}};t.default=s},5081:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(n(98201));n(68431);var c=function(e){function t(e){var n;return r(this,t),(n=a(this,t,[e])).setSliderTransition=function(){n.setTransitionTimer=setTimeout((function(){n.slider.style.transition="150ms cubic-bezier(.4, 0, .2, 1)",n.clearTransitionTimer()}),1)},n.removeSliderTransition=function(){n.slider&&(n.slider.style.transition="none")},n.clearTransitionTimer=function(){n.setTransitionTimer&&(clearTimeout(n.setTransitionTimer),n.setTransitionTimer=null)},n.onSelectChanged=function(e){var t=e.target.dataset.option;t!==n.state.activeOption&&(n.setState({activeOption:t}),n.props.onSelectChanged&&n.props.onSelectChanged(t))},n.state={activeOption:e.activeOption},n.setTransitionTimer=null,n}return i(t,e),o(t,[{key:"componentDidMount",value:function(){var e=this.props.options;this.btn&&this.slider&&Array.isArray(e)&&(this.slider.style.width="".concat(100/e.length,"%"),this.setSliderTransition())}},{key:"componentDidUpdate",value:function(e){var t=this.props.activeOption;t!==e.activeOption&&t!==this.state.activeOption&&this.setState({activeOption:t})}},{key:"componentWillUnmount",value:function(){this.clearTransitionTimer()}},{key:"render",value:function(){var e=this,t=this.props,n=t.options,r=t.optionsDisplay,o=t.readOnly,a=this.state.activeOption;return l.default.createElement("div",{className:"radio-group-wrapper"},l.default.createElement("div",{className:"radio-group-options ".concat(o?"read-only":"")},n.map((function(t){var n=a===t,o=r&&r[t]||"";return l.default.createElement("div",{key:t,ref:function(t){return e.btn=t},className:"radio-group-button ".concat(n?"active":""),"data-option":t,onClick:e.onSelectChanged},o)})),l.default.createElement("span",{className:"radio-group-slider btn-primary",ref:function(t){return e.slider=t}})))}}])}(l.default.Component);t.default=c},14471:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(98201));function a(e){var t=e.classname,n=e.name,r=e.isSelect;return o.default.createElement("div",{className:"".concat(t," w-100 d-flex justify-content-between")},o.default.createElement("span",null,n),r&&o.default.createElement("div",{className:"dtable-select-check-icon"},o.default.createElement("i",{className:"dtable-font dtable-icon-check-mark"})))}n(53021),a.defaultProps={classname:"",name:"",isSelect:!1};t.default=a},96991:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(n(98201)),c=s(n(30615)),u=n(20090),d=function(e){function t(){return r(this,t),a(this,t,arguments)}return i(t,e),o(t,[{key:"render",value:function(){var e=this.props,t=e.options,n=e.onChange,r=e.value,o=e.isSearchable,a=e.placeholder,i=e.isMulti,s=e.menuPosition,d=e.isClearable,p=e.noOptionsMessage,f=e.classNamePrefix,h=e.style,m=e.innerRef,g=e.isDisabled,v=e.form,y=e.customFilterOption,C=e.autoFocus;return l.default.createElement(c.default,{value:r,onChange:n,options:t,isMulti:i,classNamePrefix:f,styles:h||u.MenuSelectStyle,components:{Option:u.Option,DropdownIndicator:u.DropdownIndicator,MenuList:u.MenuList,ClearIndicator:u.ClearIndicator},placeholder:a,isSearchable:o,isClearable:d,menuPosition:s||"fixed",menuShouldScrollIntoView:!0,menuPortalTarget:document.querySelector(this.props.menuPortalTarget),captureMenuScroll:!1,hideSelectedOptions:!1,noOptionsMessage:p,isDisabled:g,ref:m,filterOption:y,form:v,autoFocus:C})}}])}(l.default.Component);t.default=d,d.defaultProps={options:[],value:{},isDisabled:!1,isSearchable:!1,isClearable:!1,placeholder:"",isMulti:!1,autoFocus:!1,menuPortalTarget:".modal",noOptionsMessage:function(){return null}}},20090:function(e,t,n){"use strict";var r=n(91847).default,o=n(12897).default,a=["innerProps"],i=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.UserSelectStyle=t.Option=t.MenuSelectStyle=t.MenuList=t.DropdownIndicator=t.ClearIndicator=void 0;var s=i(n(98201)),l=n(30615);t.UserSelectStyle={option:function(e,t){var n=t.isDisabled,r=t.isFocused;return o(o({},e),{},{cursor:n?"default":"pointer",backgroundColor:r?"#f5f5f5":"#fff"})},control:function(e){return o(o({},e),{},{fontSize:"14px",cursor:"pointer",lineHeight:"1.5"})},indicatorSeparator:function(){return{display:"none"}},dropdownIndicator:function(){return{display:"none"}},clearIndicator:function(){return{display:"none"}},multiValue:function(e){return o(o({},e),{},{display:"inline-flex",alignItems:"center",background:"#eaeaea",borderRadius:"10px",margin:"0 10px 0 0",padding:"0 0 0 2px"})},multiValueLabel:function(e){return o(o({},e),{},{padding:"0px"})},multiValueRemove:function(e){return o(o({},e),{},{color:"#666",":hover":{backgroundColor:"transparent",color:"#555555"}})},singleValue:function(e){return o(o({},e),{},{display:"inline-flex",alignItems:"center",background:"#eaeaea",borderRadius:"10px",margin:"0",padding:"0 2px",width:"fit-content"})}},t.MenuSelectStyle={option:function(e,t){var n=t.isDisabled,r=t.isFocused;return o(o({},e),{},{fontSize:"13px",color:"#212529",cursor:n?"default":"pointer",backgroundColor:r?"#f5f5f5":"#fff",".header-icon .dtable-font":{color:"#aaa"}})},control:function(e){return o(o({},e),{},{fontSize:"14px",cursor:"pointer",lineHeight:"1.5"})},menuPortal:function(e){return o(o({},e),{},{zIndex:9999})},indicatorSeparator:function(){}};t.DropdownIndicator=function(e){return l.components.DropdownIndicator&&s.default.createElement(l.components.DropdownIndicator,e,s.default.createElement("span",{className:"dtable-font dtable-icon-drop-down",style:{fontSize:"12px"}}))};t.ClearIndicator=function(e){var t=e.innerProps,n=r(e,a);return n.innerProps=o(o({},t),{},{onMouseDown:function(e){e.nativeEvent.stopImmediatePropagation(),t.onMouseDown(e)}}),s.default.createElement(l.components.ClearIndicator,n)};t.MenuList=function(e){return s.default.createElement("div",{onClick:function(e){return e.nativeEvent.stopImmediatePropagation()},onMouseDown:function(e){return e.nativeEvent.stopImmediatePropagation()}},s.default.createElement(l.components.MenuList,e,e.children))};t.Option=function(e){return s.default.createElement("div",{style:e.data.style},s.default.createElement(l.components.Option,e))}},64386:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default,l=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(98201)),u=s(n(70446)),d=s(n(18184)),p=n(96795),f=s(n(19970)),h=s(n(17791));n(86210),n(6037),n(16482);var m=function(e){function t(e){var n;return r(this,t),(n=a(this,t,[e])).getDateFormat=function(){var e=n.props.column;return e.data&&e.data.format||"YYYY-MM-DD"},n.onDateEditorToggle=function(){n.props.isReadOnly||n.setState({isPopoverShow:!n.state.isPopoverShow})},n.onValueChanged=function(e){e!==n.state.newValue&&(n.setState({newValue:e}),n.onCommit(e),n.state.showHourAndMinute||n.onClosePopover())},n.onCommit=function(e){var t={};t[n.props.column.key]=e,n.props.onCommit(t)},n.onClosePopover=function(){n.setState({isPopoverShow:!1})},n.state={isDateInit:!1,newValue:"",isPopoverShow:!1,showHourAndMinute:!1,defaultCalendarValue:null},n}return i(t,e),o(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.value,n=e.lang;d.default.locale(n);var r=this.getDateFormat();this.setState({isDateInit:!0,newValue:t,dateFormat:r,showHourAndMinute:r.indexOf("HH:mm")>-1})}},{key:"render",value:function(){if(!this.state.isDateInit)return c.default.createElement("div",{className:"cell-editor date-editor"},c.default.createElement("div",{className:"date-editor-container"},c.default.createElement("div",{className:"control-form"})));var e=this.props,t=e.lang,n=e.column,r=e.className,o=this.state,a=o.newValue,i=o.isPopoverShow,s=o.dateFormat,l=o.showHourAndMinute;return c.default.createElement("div",{className:"cell-editor dtable-ui-date-editor"},!i&&c.default.createElement("div",{className:"dtable-ui-date-editor-container"},c.default.createElement("div",{className:"form-control",onClick:this.onDateEditorToggle},(0,p.getDateDisplayString)(a,s))),i&&c.default.createElement(c.Fragment,null,c.default.createElement(u.default,{query:"(min-width: 768px)"},c.default.createElement(f.default,{className:r,lang:t,value:a,dateFormat:s,showHourAndMinute:l,onValueChanged:this.onValueChanged})),c.default.createElement(u.default,{query:"(max-width: 767.8px)"},c.default.createElement(h.default,{className:r,isReadOnly:this.props.isReadOnly,lang:t,value:a,dateFormat:s,showHourAndMinute:l,column:n,onValueChanged:this.onValueChanged,onClosePopover:this.onClosePopover}))))}}])}(c.default.Component);m.defaultProps={isReadOnly:!1,value:"",lang:"en"};t.default=m},17791:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(6305).default,l=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(13651)),u=l(n(98201)),d=l(n(28414)),p=l(n(18184)),f=l(n(32712)),h=s(n(94082)),m=n(61779),g=n(37151),v=l(n(36720));n(60062),n(99201);var y=function(e){function t(e){var n;return r(this,t),(n=a(this,t,[e])).handleHistaryBack=function(e){e.preventDefault(),n.closePopover()},n.handleDateChange=function(e){var t=n.props,r=t.dateFormat,o=t.showHourAndMinute,a=(0,p.default)(e);if(o){var i=n.state.datePickerValue.format("HH:mm"),s=r.split(" ")[0],l=(0,p.default)(e).format(s)+" "+i;a=(0,p.default)(l)}n.setState({datePickerValue:(0,p.default)(e)}),n.props.onValueChanged(a.format(r))},n.handleTimeChange=function(e){var t=n.state.datePickerValue,r=n.props.dateFormat,o=r.split(" ")[0],a=t.format(o)+" "+(0,p.default)(e).format("HH:mm"),i=(0,p.default)(a);n.setState({datePickerValue:i}),n.props.onValueChanged(t.format(r))},n.closePopover=function(){n.props.onClosePopover()},n.deleteDate=function(){n.props.onValueChanged(""),n.closePopover()},n.onChange=function(e){if(e){var t=n.props.dateFormat;n.setState({datePickerValue:e}),n.props.onValueChanged(e.format(t))}},n.onContainerClick=function(e){if(n.editorPopover&&n.editorPopover.contains(e.target))return e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),!1},n.setEditorPopover=function(e){n.editorPopover=e},n.getCalendarContainer=function(){return n.calendarContainerRef.current},n.getCalender=function(){var e=n.props,t=e.dateFormat,r=e.lang,o=e.className,a=(0,p.default)().clone();return u.default.createElement(f.default,{className:(0,d.default)("dtable-rc-calendar",o),locale:(0,g.initDateEditorLanguage)(r),format:t,defaultValue:a,dateInputPlaceholder:(0,m.getLocale)("Please_input"),showDateInput:!1,focusablePanel:!1,showToday:!1,showTime:!1,style:{width:"100%",fontSize:"14px"}})},n.renderDataPicker=function(){var e=n.props.dateFormat,t=n.state.datePickerValue,r=n.getCalender();return u.default.createElement(h,{open:!0,style:{width:"100%"},calendar:r,value:t,getCalendarContainer:n.getCalendarContainer,onChange:n.onChange},(function(t){var r=t.value;return r=r&&r.format(e),u.default.createElement("div",{tabIndex:"0",onFocus:n.onReadOnlyFocus},u.default.createElement("input",{placeholder:(0,m.getLocale)("Please_select"),readOnly:!0,tabIndex:"-1",className:"form-control",value:r||""}),u.default.createElement("div",{ref:n.calendarContainerRef,style:{height:"22rem"}}))}))},n.state={open:!0,datePickerValue:e.value?(0,p.default)(e.value):(0,p.default)().clone()},n.calendarContainerRef=u.default.createRef(),n}return i(t,e),o(t,[{key:"componentDidMount",value:function(){history.pushState(null,null,"#"),window.addEventListener("popstate",this.handleHistaryBack,!1)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("popstate",this.handleHistaryBack,!1)}},{key:"render",value:function(){var e=this.props,t=e.lang,n=e.column,r=e.dateFormat,o=e.showHourAndMinute,a=r.split(" ")[0],i=r.split(" ")[1],s=this.state.datePickerValue;return u.default.createElement("div",{ref:this.setEditorPopover,className:"dtable-ui-mb-editor-popover mb-date-editor-popover",onClick:this.onContainerClick},u.default.createElement(v.default,{title:n.name,leftContent:u.default.createElement("i",{className:"dtable-font dtable-icon-return"}),rightContent:u.default.createElement("span",null,(0,m.getLocale)("Done")),onLeftClick:this.props.onClosePopover,onRightClick:this.props.onClosePopover}),u.default.createElement("div",{className:"dtable-ui-mb-editor-body dtable-ui-mb-date-editor-body"},u.default.createElement("div",{className:"mb-date-editor-input"},u.default.createElement("div",{className:"date-input"},u.default.createElement(c.default,{mode:"date",locale:(0,g.initDateEditorLanguage)(t),value:this.state.value,onChange:this.handleDateChange},u.default.createElement("div",{className:"date-input-day"},s&&s.format(a)))),o&&u.default.createElement("div",{className:"date-input"},u.default.createElement(c.default,{mode:"time",locale:(0,g.initDateEditorLanguage)(t),value:this.state.value,onChange:this.handleTimeChange},u.default.createElement("div",{className:"date-input-day"},s&&s.format(i))))),u.default.createElement("div",{className:"dtable-ui mb-date-editor-picker"},this.renderDataPicker()),u.default.createElement("div",{className:"mb-date-editor-clear"},u.default.createElement("div",{onClick:this.deleteDate,className:"clear-date"},(0,m.getLocale)("Clear")))))}}])}(u.default.PureComponent);t.default=y},19970:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(n(98201)),c=s(n(18184)),u=s(n(28414)),d=s(n(94082)),p=s(n(32712)),f=n(37151);n(60062);var h=n(61779),m=function(e){function t(e){var n;return r(this,t),(n=a(this,t,[e])).onChange=function(e){if(e){var t=n.props.dateFormat;n.setState({datePickerValue:e,open:!0}),n.props.onValueChanged(e.format(t))}},n.onOpenChange=function(e){n.setState({open:e})},n.onClear=function(){n.setState({datePickerValue:null})},n.onFocusDatePicker=function(){n.setState({open:!0})},n.handleMouseDown=function(e){e.preventDefault(),e.stopPropagation()},n.getCalendarContainer=function(){return n.calendarContainerRef.current},n.getCalender=function(){var e=n.props,t=e.dateFormat,r=e.showHourAndMinute,o=e.lang,a=e.className,i=(0,c.default)().clone();return l.default.createElement(p.default,{className:(0,u.default)("dtable-rc-calendar",a),locale:(0,f.initDateEditorLanguage)(o),style:{zIndex:1001},format:t,defaultValue:i,showHourAndMinute:r,dateInputPlaceholder:(0,h.getLocale)("Please_input"),showDateInput:!0,focusablePanel:!1,onClear:n.onClear})},n.state={open:!0,datePickerValue:e.value?(0,c.default)(e.value):null},n.calendarContainerRef=l.default.createRef(),n}return i(t,e),o(t,[{key:"render",value:function(){var e=this,t=this.props.dateFormat,n=this.state,r=n.open,o=n.datePickerValue,a=this.getCalender();return l.default.createElement(d.default,{open:r,value:o,animation:"slide-up",style:{zIndex:1001},calendar:a,getCalendarContainer:this.getCalendarContainer,onChange:this.onChange,onOpenChange:this.onOpenChange},(function(n){var r=n.value;return r=r&&r.format(t),l.default.createElement("span",{className:"dtable-ui-date-editor-container",tabIndex:"0",onFocus:e.onFocusDatePicker},l.default.createElement("input",{readOnly:!0,tabIndex:"-1",className:"form-control",placeholder:(0,h.getLocale)("Please_select"),value:r||"",onMouseDown:e.handleMouseDown}),l.default.createElement("div",{ref:e.calendarContainerRef}))}))}}])}(l.default.Component);t.default=m},60516:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEPARTMENT_SELECT_RANGE_OPTIONS=void 0;t.DEPARTMENT_SELECT_RANGE_OPTIONS=[{name:"Current_user_department",type:"current_user_department"},{name:"Current_user_department_and_sub",type:"current_user_department_and_sub"},{name:"Specific_departments",type:"specific_departments"}]},84098:function(e,t,n){"use strict";var r=n(85715).default,o=n(24994).default,a=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(98201)),s=n(8408),l=o(n(26533)),c=n(61779);n(21825);t.default=function(e){var t=e.value,n=e.onCommit,o=e.classNamePrefix,a=e.isShowSelectedDepartments,u=e.renderUserDepartmentOptions,d=e.departments,p=(0,i.useState)(""),f=r(p,2),h=f[0],m=f[1],g=(0,i.useState)((0,s.getNormalizedDepartments)(d)),v=r(g,2),y=v[0],C=v[1],A=(0,i.useRef)(null),x=(0,i.useRef)([]);function b(e){var t=e.target.value;h!==t&&(x.current=(0,s.searchDepartments)(y,t),m(t))}function _(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()}function w(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()}function S(e,r,o){var a=e.hasChild,s=e.isExpanded,l=e.name,c=e.id,u=o+1,d={marginRight:"".concat(15*u+5,"px")},p={paddingLeft:a?"":"16px"},f=t.includes(c);return i.default.createElement(i.Fragment,{key:c},i.default.createElement("div",{className:"dropdown-item d-flex align-items-center",onClick:function(e){return function(e,t){e.stopPropagation(),n(e,t)}(e,c)}},i.default.createElement("input",{type:"checkbox",className:"vam department-select-input",checked:f,style:d,onChange:function(){}}),a&&!h&&i.default.createElement("span",{className:"dtable-font expand dtable-icon-".concat(s?"drop-down":"right-slide"," pr-1"),onClick:function(e){return function(e,t,n){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation();var r=y.slice(0),o=r.findIndex((function(e){return e.id===t}));r[o].isExpanded=!n,C(r)}(e,c,s)}}),i.default.createElement("span",{style:h?{}:p,title:l,className:"text-truncate"},l)),s&&a&&function(e,t,n){var r=t.filter((function(t){return t.parent_id===e})),o=t.filter((function(t){return t.parent_id!==e}));return 0===r.length?null:r.map((function(e){return S(e,o,n)}))}(c,r,u))}return(0,i.useEffect)((function(){A.current&&function(){var e=A.current.getBoundingClientRect(),t=e.top,n=e.height;if(n+t>window.innerHeight){var r=1;A.current.style.top=-1*(n+r-38)+"px"}}()}),[]),function(){var e=y.filter((function(e){return-1!==e.parent_id})),r=y.find((function(e){return-1===e.parent_id}));return r?i.default.createElement("div",{ref:A,onClick:w,onMouseDown:w,className:"dropdown-menu show departments-container dtable-ui ".concat(o)},a&&i.default.createElement("div",{className:"selected-departments dtable-ui",onClick:_},i.default.createElement(l.default,{value:t,removeDepartment:n,isShowRemoveIcon:!0,departments:y})),i.default.createElement("div",{className:"search-departments"},i.default.createElement("input",{className:"form-control",type:"text",autoFocus:!0,placeholder:(0,c.getLocale)("Search_department"),value:h,onChange:b,onClick:_})),i.default.createElement("div",{className:"department-item-container"},!h&&u&&u(),x.current.length>0&&h&&x.current.map((function(e){return S(e,[],-1)})),!h&&S(r,e,-1))):null}()}},69517:function(e,t,n){"use strict";var r=n(12897).default,o=n(17383).default,a=n(34579).default,i=n(18336).default,s=n(29511).default,l=n(24994).default,c=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u=c(n(98201)),d=n(96795),p=l(n(2129)),f=n(8408),h=n(61779);n(48119);var m=function(e){function t(e){var n,a;return o(this,t),n=i(this,t,[e]),a=n,n.resetMenuStyle=function(){if(n.departmentsRef){var e=n.departmentsRef.getBoundingClientRect().bottom;if(e>window.innerHeight){var t=n.departmentsRef.style.top||0;n.departmentsRef.style.top=parseInt(t)-e+window.innerHeight+"px"}}},n.initDepartments=function(e){var t=(0,f.getNormalizedDepartments)(e||[]);n.validDepartments=t,n.setState({departments:t})},n.initRangeDepartments=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=a.getSelectedRange(),r=n.selectedRange,o=n.specificDepartments,i=e||{},s=i.current_user_department_ids,l=void 0===s?[]:s,c=i.current_user_department_and_sub_ids,u=void 0===c?[]:c,p=[],h=[];if(r===d.DEPARTMENT_SELECT_RANGE_MAP.CURRENT_USER_DEPARTMENT)h=l,p=t.filter((function(e){return l.includes(e.id)}));else if(r===d.DEPARTMENT_SELECT_RANGE_MAP.CURRENT_USER_DEPARTMENT_AND_SUB){h=t.filter((function(e){return l.includes(e.id)})).filter((function(e){return!l.includes(e.parent_id)})).map((function(e){return e.id})),p=t.filter((function(e){return u.includes(e.id)}))}else p=t.filter((function(e){return o.includes(e.id)}));var m=(0,f.getNormalizedDepartments)(p);a.validDepartments=m,a.setState({departments:m,topParentIds:h})},n.getSelectedRange=function(){var e=n.props.column.data||{};return{selectedRange:e.selected_range||"",specificDepartments:e.specific_departments||[]}},n.onExpand=function(e,t,r){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation();var o=n.state.departments.slice(0),a=o.findIndex((function(e){return e.id===t}));o[a].isExpanded=!r,n.setState({departments:o})},n.onChangeSearch=function(e){var t=e.target.value;if(n.state.searchVal!==t){var r=n.state.departments;n.validDepartments=(0,f.searchDepartments)(r,t),n.setState({searchVal:t})}},n.onSelectDepartment=function(e,t){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation();var r=n.props;(0,r.onCommit)(t===r.value?"":t)},n.onStopPropagation=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},n.renderSubDepartments=function(e,t,r){var o=t.filter((function(t){return t.parent_id===e})),a=t.filter((function(t){return t.parent_id!==e}));if(0===o.length)return null;var i=o.map((function(e){return e.id})),s=!!t.find((function(e){return i.includes(e.parent_id)}));return o.map((function(e){return n.renderDepartment(e,a,r,s)}))},n.renderDepartment=function(e,t,r,o){var a=n.props.value,i=r+1,s=e.hasChild,l=e.isExpanded,c=e.name,d=e.id,p={paddingLeft:s?"":o?"16px":"12px"},f={paddingLeft:"".concat(15*i+10,"px")},h=a===d;return u.default.createElement(u.Fragment,{key:d},u.default.createElement("div",{className:"dropdown-item department-item d-flex align-items-center",onClick:function(e){return n.onSelectDepartment(e,d)},style:f},u.default.createElement("div",{className:"department-item-left-content d-flex align-items-center"},s&&u.default.createElement("span",{className:"dtable-font expand dtable-icon-".concat(l?"drop-down":"right-slide"," pr-1"),onClick:function(e){return n.onExpand(e,d,l)}}),u.default.createElement("span",{style:p,title:c,className:"text-truncate department-name"},c),h&&u.default.createElement("span",{className:"department-check-icon"},u.default.createElement("i",{className:"dtable-font dtable-icon-check-mark"})))),l&&s&&n.renderSubDepartments(d,t,i))},n.renderAllDepartments=function(){var e=n.state.departments,t=e.find((function(e){return-1===e.parent_id})),r=e.filter((function(e){return-1!==e.parent_id}));return u.default.createElement(u.default.Fragment,null,t?n.renderDepartment(t,r,-1,!0):n.renderEmptyTip())},n.renderSpecificDepartments=function(){var e=n.state.departments;return u.default.createElement(u.default.Fragment,null,0===n.validDepartments.length&&n.renderEmptyTip(),n.validDepartments.length>0&&n.validDepartments.map((function(t){var o=r(r({},t),{},{hasChild:!1});return n.renderDepartment(o,e,-1,!1)})))},n.renderCurrentDepartmentsAndSub=function(){var e=n.state,t=e.departments,r=e.topParentIds,o=!!n.validDepartments.find((function(e){return r.includes(e.parent_id)}));return u.default.createElement(u.default.Fragment,null,0===n.validDepartments.length&&n.renderEmptyTip(),n.validDepartments.length>0&&n.validDepartments.map((function(e){var a=e;return r.includes(e.id)?n.renderDepartment(a,t,-1,o):null})))},n.renderEmptyTip=function(){return u.default.createElement("span",{className:"none-search-result d-flex justify-content-center"},(0,h.getLocale)("No_departments_available"))},n.renderMenuContent=function(){var e=n.state.searchVal,t=n.props,r=t.enableSelectRange,o=t.renderUserDepartmentOptions,a=n.getSelectedRange().selectedRange,i=n.renderAllDepartments();return r&&[d.DEPARTMENT_SELECT_RANGE_MAP.CURRENT_USER_DEPARTMENT,d.DEPARTMENT_SELECT_RANGE_MAP.SPECIFIC_DEPARTMENTS].includes(a)||e?i=n.renderSpecificDepartments():r&&a===d.DEPARTMENT_SELECT_RANGE_MAP.CURRENT_USER_DEPARTMENT_AND_SUB&&(i=n.renderCurrentDepartmentsAndSub()),u.default.createElement("div",{className:"editor-department-container",ref:function(e){return n.departmentContainerRef=e}},!e&&o&&o(n.onSelectDepartment),i)},n.state={searchVal:"",departments:[],topParentIds:[],isLoading:!1},n.validDepartments=[],n}return s(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){e.resetMenuStyle()}),1);var t=this.props,n=t.enableSelectRange,r=t.userDepartmentIdsMap,o=t.departments;n?this.initRangeDepartments(r,o):this.initDepartments(o)}},{key:"render",value:function(){var e=this;return u.default.createElement("div",{className:"dropdown-menu department-editor-list dtable-ui show m-0 p-0",style:this.props.menuStyle||{},ref:function(t){return e.departmentsRef=t},onClick:this.onStopPropagation,onMouseDown:this.onStopPropagation},u.default.createElement("div",{className:"search-departments"},u.default.createElement("input",{className:"form-control",type:"text",autoFocus:!0,placeholder:(0,h.getLocale)("Search_department"),value:this.state.searchVal,onChange:this.onChangeSearch,onClick:this.onStopPropagation})),this.state.isLoading?u.default.createElement("div",{className:"mt-4"},u.default.createElement(p.default,null)):this.renderMenuContent())}}])}(u.Component);t.default=m},26533:function(e,t,n){"use strict";var r=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(98201)),a=n(96795),i=n(60516),s=n(61779);function l(e){var t=e.value,n=e.removeDepartment,r=e.isShowRemoveIcon,l=e.departments,c=(0,o.useMemo)((function(){var e={};return l.forEach((function(t){e[t.id]=t})),e}),[l]);return Array.isArray(t)?t.map((function(e,t){if([a.DEPARTMENT_SELECT_RANGE_MAP.CURRENT_USER_DEPARTMENT,a.DEPARTMENT_SELECT_RANGE_MAP.CURRENT_USER_DEPARTMENT_AND_SUB].includes(e)){var l=(0,s.getLocale)(i.DEPARTMENT_SELECT_RANGE_OPTIONS.find((function(t){return t.type===e})).name);return o.default.createElement("div",{key:"department-".concat(t),className:"department mr-1"},o.default.createElement("span",{className:"department-name text-truncate",title:l,"aria-label":l},l))}var u=c[e];if(u){var d=u.name;return o.default.createElement("div",{key:"department-".concat(t),className:"department mr-1"},o.default.createElement("div",{className:"department-avatar-container d-flex align-items-center justify-content-center"},o.default.createElement("span",{className:"dtable-font dtable-icon-department-single-selection"})),o.default.createElement("span",{className:"department-name text-truncate",title:d,"aria-label":d},d),r&&o.default.createElement("span",{className:"remove-container"},o.default.createElement("span",{className:"remove-icon",onClick:function(t){return n(t,e)}},o.default.createElement("i",{className:"dtable-font dtable-icon-fork-number department-remove-icon"}))))}return o.default.createElement("div",{key:"department-".concat(t),className:"department empty-department mr-1"},o.default.createElement("div",{className:"department-avatar-container d-flex align-items-center justify-content-center"},o.default.createElement("span",{className:"dtable-font dtable-icon-department-single-selection"})),o.default.createElement("span",{className:"department-name"},(0,s.getLocale)("Deleted_department")),r&&o.default.createElement("span",{className:"remove-container"},o.default.createElement("span",{className:"remove-icon",onClick:function(t){return n(t,e)}},o.default.createElement("i",{className:"dtable-font dtable-icon-fork-number department-remove-icon"}))))})):null}n(56643),l.defaultProps={isShowRemoveIcon:!1,departments:[]};t.default=l},8408:function(e,t,n){"use strict";var r=n(12897).default;Object.defineProperty(t,"__esModule",{value:!0}),t.searchDepartments=t.getNormalizedDepartments=void 0;t.searchDepartments=function(e,t){var n=t?t.trim().toLowerCase():"",r=Array.isArray(e)?e:[];return n?r.filter((function(e){var t=e.name;return!!t&&t.toString().toLowerCase().indexOf(n)>-1})):r};t.getNormalizedDepartments=function(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n={},o=0;o<e.length;o++){var a=e[o];n[a.parent_id]=!0}return e.map((function(e){var o=t&&!!n[e.id],a=-1===e.parent_id;return r(r({},e),{},{hasChild:o,isExpanded:a})}))}},91799:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(98201)),a=r(n(47233)),i=r(n(80301));t.default=function(e){var t=e.isMultiple,n=e.value,r={column:e.column,value:n,userDepartmentIdsMap:e.userDepartmentIdsMap,departments:e.departments,onCommit:e.onCommit};return o.default.createElement(o.default.Fragment,null,t?o.default.createElement(i.default,r):o.default.createElement(a.default,r))}},24102:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default,l=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(98201)),u=s(n(28414)),d=s(n(11746)),p=s(n(57818)),f=n(71559),h=n(70017);n(65190);var m=function(e){function t(e){var n;return r(this,t),(n=a(this,t,[e])).getSignImages=function(){var e=n.props,t=e.value,r=e.config;return[(0,f.getDigitalSignImageUrl)(t,r)].filter(Boolean)},n.onClickSignImage=function(e){n.props.isSupportPreview&&n.setState({isPreviewSignImage:!0,largeSignImageIndex:e})},n.hideLargeSignImage=function(){n.props.isSupportPreview&&(n.props.onCloseCallback&&n.props.onCloseCallback(),n.setState({isPreviewSignImage:!1,largeSignImageIndex:-1}))},n.downloadImage=function(e){var t=e,n=t.indexOf("?a=");n>-1&&(t=t.slice(0,n));var r=-1!==t.indexOf("?dl=1")?t:t+"?dl=1";(0,h.downloadFile)(r)},n.state={isPreviewSignImage:!1,largeSignImageIndex:-1},n}return i(t,e),o(t,[{key:"render",value:function(){var e=this.props,t=e.containerClassName,n=e.readOnly,r=e.config,o=e.isSample,a=e.renderItem,i=(0,u.default)("dtable-ui cell-formatter-container digital-sign-formatter",t),s=this.getSignImages();if(0===s.length)return null;var l=this.state,f=l.isPreviewSignImage,h=l.largeSignImageIndex;return c.default.createElement(c.default.Fragment,null,c.default.createElement("div",{className:i},c.default.createElement(d.default,{images:s,server:r.server,onImageClick:this.onClickSignImage,renderItem:a})),f&&c.default.createElement(p.default,{className:"digital-sign-formatter-image-previewer",readOnly:n,server:o?r.server:"",imageItems:s,imageIndex:h,closeImagePopup:this.hideLargeSignImage,downloadImage:this.downloadImage,moveToPrevImage:function(){},moveToNextImage:function(){}}))}}])}(c.Component);m.defaultProps={isSample:!1,isSupportPreview:!1,readOnly:!0,value:"",config:{},containerClassName:""};t.default=m},71559:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isValidDigitalSignImageValue=t.getDigitalSignImageUrl=void 0;t.getDigitalSignImageUrl=function(e,t){if(!e)return"";var n=e&&e.sign_image_url||"";if(!n)return"";if(!t)return n;var r=t||{},o=r.server,a=r.workspaceID,i=r.dtableUuid;return o&&(a||0===a)&&i?"".concat(o,"/workspace/").concat(a,"/asset/").concat(i).concat(n):n};t.isValidDigitalSignImageValue=function(e){return!!e&&!(!e||!e.sign_image_url)}},73490:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(n(98201));n(34966);var c=function(e){function t(){return r(this,t),a(this,t,arguments)}return i(t,e),o(t,[{key:"render",value:function(){var e=this.props.text;return l.default.createElement("span",{className:"dtable-ui-editor-button",onClick:this.props.onClick},e)}}])}(l.default.Component);t.default=c},3923:function(e,t,n){"use strict";var r=n(85715).default,o=n(24994).default,a=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(98201)),s=n(96795),l=o(n(39791));t.default=function(e){var t=e.field,n=e.isCollapsed,o=e.onClickField,a=e.onMoveField,c=0,u=(0,i.useRef)(null),d=(0,i.useState)(!1),p=r(d,2),f=p[0],h=p[1];return i.default.createElement("div",{ref:u,className:"field-item-container ".concat(n?"d-none":""),onDrop:function(e){e.stopPropagation(),e.preventDefault(),h(!1);var n=e.dataTransfer.getData("text/plain");n!==t.key&&a(n,t.key)},onDragEnter:function(e){e.stopPropagation(),0===++c||f||h(!0)},onDragOver:function(e){"copy"!==e.dataTransfer.dropEffect&&(e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="move")},onDragLeave:function(e){e.stopPropagation(),0===--c&&h(!1)}},i.default.createElement("div",{className:"field-dragbar",draggable:"true",onDragStart:function(e){e.stopPropagation(),e.dataTransfer.setDragImage(u.current,10,10),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",t.key)}},i.default.createElement("i",{className:"dtable-font dtable-icon-drag pr-2"})),i.default.createElement(l.default,{checked:t.shown,switchClassName:"flex-fill",placeholder:i.default.createElement("div",{className:"field-switch"},i.default.createElement("i",{className:"dtable-font ".concat(s.COLUMNS_ICON_CONFIG[t.type])}),i.default.createElement("span",null,t.name)),onChange:function(e){e.nativeEvent.stopImmediatePropagation();var n=e.target.checked;n!==t.shown&&o(t.key,n)}}))}},93355:function(e,t,n){"use strict";var r=n(12897).default,o=n(85715).default,a=n(24994).default,i=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=i(n(98201)),l=n(48843),c=n(61911),u=a(n(3923));n(51969);t.default=function(e){var t=e.fields,n=e.textProperties,a=e.fieldAllShown,i=e.onClickField,d=e.onMoveField,p=e.onToggleFieldsVisibility,f=(0,s.useRef)(null),h=(0,s.useState)(!0),m=o(h,2),g=m[0],v=m[1],y={transition:"all ".concat(300,"ms cubic-bezier(.645,.045,.355,1)"),opacity:0},C={entering:{opacity:1,height:"".concat(30*t.length+24,"px")},entered:{opacity:1,height:"".concat(30*t.length+24,"px")},exiting:{opacity:0,height:0},exited:{opacity:0,height:0}};return s.default.createElement("div",{className:"field-setting"},s.default.createElement("div",{className:"field-setting-header d-flex align-items-center justify-content-between",onClick:function(){v(!g)}},s.default.createElement(l.Label,{className:"mb-0"},n.titleValue),s.default.createElement("span",{className:"dtable-font dtable-icon-right expand-button ".concat(g?"":"revolving")})),s.default.createElement(c.Transition,{nodeRef:f,in:!g,timeout:300},(function(e){return s.default.createElement("div",{className:"field-setting-wrapper",ref:f,style:r(r({},y),C[e])},s.default.createElement("div",{className:"field-setting-banner ".concat(g?"d-none":"d-flex"," align-items-center justify-content-between h-5 mt-2 mb-2")},s.default.createElement(l.Label,{className:"mb-0"},n.bannerValue),s.default.createElement("span",{className:"show-all-button",onClick:p},a?n.hideValue:n.showValue)),s.default.createElement("div",{className:"field-setting-body"},t.map((function(e,t){return s.default.createElement(u.default,{key:"".concat(e.key,"-").concat(t),field:e,isCollapsed:g,onClickField:i,onMoveField:d})}))))})))}},50194:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default,l=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(98201)),u=s(n(70446)),d=n(96795),p=n(61779),f=n(38680),h=s(n(73490)),m=s(n(95888)),g=s(n(93121)),v=s(n(59263));n(96114);var y=function(e){function t(e){var n;return r(this,t),(n=a(this,t,[e])).onMouseDown=function(e){n.editorContainer===e.target||n.editorContainer.contains(e.target)||n.onClosePopover()},n.getLinkedCellValue=function(){var e=n.props,t=e.row,r=e.column,o=e.linkMetaData,a=r.data||{},i=a.link_id,s=a.table_id,l=a.other_table_id;return n.linkId=i,n.tableId=s,n.otherTableId=l,o.getLinkedCellValue(n.linkId,n.tableId,n.otherTableId,t._id)},n.formatLinkedValuesToOptions=function(){var e=n.props,t=e.column,r=e.linkMetaData,o=n.state.newValue;if(o&&Array.isArray(o)&&o.length>0){var a=r.getLinkedRows(n.otherTableId,o),i=r.getLinkedTable(n.otherTableId);return a.map((function(e){var r=t.data.display_column_key,o=n.getDisplayValue(i,e,r);return{id:e._id,name:o}}))}return[]},n.getDisplayValue=function(e,t,n){var r=t[n],o=e.columns.find((function(e){return e.key===n})),a=o.type,i=o.data;switch(a){case f.CellType.NUMBER:return(0,d.getNumberDisplayString)(r,i);case f.CellType.DATE:var s=i.format;return(0,d.getDateDisplayString)(r,s);default:return r}},n.getAvailableLinkedOptions=function(){var e=n.props,t=e.column,r=e.linkMetaData,o=t.data.display_column_key,a=r.getLinkedTable(n.otherTableId);return a.rows.filter((function(e){return!!e[o]})).map((function(e){var t=n.getDisplayValue(a,e,o);return{id:e._id,name:t}}))},n.onCommit=function(e){},n.onAddOptionToggle=function(e){if(e.nativeEvent.stopImmediatePropagation(),e.stopPropagation(),!n.props.isReadOnly){var t=!n.state.isPopoverShow;if(t){var r=n.caculatePopoverPosition();n.setState({isPopoverShow:t,popoverPosition:r})}else n.setState({isPopoverShow:t})}},n.onOptionItemToggle=function(e){var t=n.props,r=t.row,o=t.linkMetaData,a=n.state.newValue.slice(),i=a.findIndex((function(t){return t===e.id}));-1!==i?(a.splice(i,1),o.removeLink(n.linkId,n.tableId,n.otherTableId,r._id,e.id)):(a.push(e.id),o.addLink(n.linkId,n.tableId,n.otherTableId,r._id,e.id)),n.setState({newValue:a})},n.onDeleteOption=function(e){var t=n.props,r=t.row,o=t.linkMetaData,a=n.state.newValue.slice(),i=a.findIndex((function(t){return t===e.id}));a.splice(i,1),n.setState({newValue:a},(function(){o.removeLink(n.linkId,n.tableId,n.otherTableId,r._id,e.id)}))},n.caculatePopoverPosition=function(){var e=window.innerHeight,t=n.editor.getClientRects()[0],r=t.top,o=t.height,a={top:o+1,left:0};e-(r+o)>200||(a={bottom:o+1,left:0});return a},n.onClosePopover=function(){n.setState({isPopoverShow:!1})},n.setEditorContainerRef=function(e){n.editorContainer=e},n.setEditorRef=function(e){n.editor=e},n.linkId="",n.tableId="",n.otherTableId="",n.state={newValue:n.getLinkedCellValue(),isPopoverShow:!1,popoverPosition:{}},n}return i(t,e),o(t,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.onMouseDown)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.onMouseDown)}},{key:"render",value:function(){var e=this,t=this.props.isReadOnly,n=this.state,r=n.isPopoverShow,o=n.popoverPosition,a=this.getAvailableLinkedOptions(),i=this.formatLinkedValuesToOptions(),s=!t;return c.default.createElement("div",{ref:this.setEditorContainerRef,className:"dtable-ui-link-editor"},c.default.createElement("div",{ref:this.setEditorRef,className:"dtable-ui-link-editor-container",onClick:this.onAddOptionToggle},0===i.length&&c.default.createElement(h.default,{text:(0,p.getLocale)("Add_an_option")}),0!==i.length&&i.map((function(t){return c.default.createElement(m.default,{key:t.id,option:t,isShowRemoveIcon:s,onDeleteLinkOption:e.onDeleteOption})}))),r&&c.default.createElement(c.Fragment,null,c.default.createElement(u.default,{query:"(min-width: 768px)"},c.default.createElement(g.default,{popoverPosition:o,options:a,selectedOptions:i,onOptionItemToggle:this.onOptionItemToggle})),c.default.createElement(u.default,{query:"(max-width: 767.8px)"},c.default.createElement(v.default,{isReadOnly:this.props.isReadOnly,value:this.state.newValue,column:this.props.column,options:a,onOptionItemToggle:this.onOptionItemToggle,onClosePopover:this.onClosePopover}))))}}])}(c.default.Component);y.defaultProps={isReadOnly:!1};t.default=y},95888:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(n(98201)),c=function(e){function t(){var e;return r(this,t),(e=a(this,t,arguments)).onDeleteOption=function(t){t.nativeEvent.stopImmediatePropagation(),t.stopPropagation(),e.props.onDeleteLinkOption(e.props.option)},e.getContainerStyle=function(){return{display:"inline-flex",marginRight:"10px",padding:"0px 5px",height:"20px",borderRadius:"2px",fontSize:"13px",background:"#eceff4",cursor:"pointer"}},e.getOptionStyle=function(){return{flex:1,display:"flex",alignContent:"center",margin:"0 4px 0 2px"}},e.getOptionNameStyle=function(){return{maxWidth:"230px",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}},e.getOperationStyle=function(){return{height:"20px",width:"16px",cursor:"pointer",color:"#909090",transform:"scale(.8)"}},e}return i(t,e),o(t,[{key:"render",value:function(){var e=this.props,t=e.option,n=e.isShowRemoveIcon,r=this.getContainerStyle(),o=this.getOptionStyle(),a=this.getOptionNameStyle(),i=this.getOperationStyle();return l.default.createElement("div",{className:"dtable-ui link-option-item",style:r},l.default.createElement("div",{className:"option-info",style:o},l.default.createElement("div",{className:"option-name",style:a,title:t.name},t.name)),n&&l.default.createElement("div",{className:"option-remove",style:i,onClick:this.onDeleteOption},l.default.createElement("i",{className:"dtable-font dtable-icon-fork-number",style:{fontSize:"12px",lineHeight:"20px"}})))}}])}(l.default.Component);c.defaultProps={isShowRemoveIcon:!1};t.default=c},59263:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(n(98201)),c=n(61779),u=s(n(36720));n(54497);var d=function(e){function t(e){var n;return r(this,t),(n=a(this,t,[e])).handleHistaryBack=function(e){e.preventDefault(),n.props.onClosePopover()},n.onContainerClick=function(e){if(n.editorPopover&&n.editorPopover.contains(e.target))return e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),!1},n.onChangeSearch=function(e){var t=n.state.searchVal;t!==e.target.value&&(t=e.target.value,n.setState({searchVal:t}))},n.getSelectedOptions=function(){var e=n.props,t=e.value,r=e.options;return Array.isArray(t)?r.filter((function(e){return t.indexOf(e.email)>-1})):[]},n.getFilterOptions=function(){var e=n.props.options,t=n.state.searchVal;return t?e.filter((function(e){return e.name.indexOf(t)>-1})):e},n.onSelectOption=function(e){n.props.onOptionItemToggle(e)},n.onRemoveOption=function(e){n.props.onOptionItemToggle(e)},n.renderFilteredOptions=function(e){var t=n.props.value;return e.map((function(e,r){var o=t.some((function(t){return t===e.id}));return l.default.createElement("div",{className:"mb-link-option-item",key:r,onMouseDown:n.onSelectOption.bind(n,e)},l.default.createElement("span",{className:"mb-option-info"},l.default.createElement("span",{className:"option-name",title:e.name},e.name)),o&&l.default.createElement("i",{className:"mb-option-checked dtable-font dtable-icon-check-mark"}))}))},n.setEditorPopover=function(e){n.editorPopover=e},n.state={searchVal:""},n}return i(t,e),o(t,[{key:"componentDidMount",value:function(){history.pushState(null,null,"#"),window.addEventListener("popstate",this.handleHistaryBack,!1)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("popstate",this.handleHistaryBack,!1)}},{key:"render",value:function(){var e=this.props.column,t=this.state.searchVal,n=this.getFilterOptions();return l.default.createElement("div",{ref:this.setEditorPopover,className:"dtable-ui-mb-editor-popover mb-link-editor-popover",onClick:this.onContainerClick},l.default.createElement(u.default,{title:e.name,leftContent:l.default.createElement("i",{className:"dtable-font dtable-icon-return"}),rightContent:l.default.createElement("span",null,(0,c.getLocale)("Done")),onLeftClick:this.props.onClosePopover,onRightClick:this.props.onClosePopover}),l.default.createElement("div",{className:"dtable-ui-mb-editor-body dtable-ui-mb-link-editor-body"},l.default.createElement("div",{className:"mb-search-link-items"},l.default.createElement("input",{className:"form-control",type:"text",placeholder:(0,c.getLocale)("Search_option"),value:t,onChange:this.onChangeSearch,onClick:this.onInputClick})),l.default.createElement("div",{className:"mb-link-container"},l.default.createElement("div",{className:"title"},(0,c.getLocale)("Choose_an_option")),l.default.createElement("div",{className:"content"},0===n.length&&l.default.createElement("div",{className:"search-result-none"},(0,c.getLocale)("No_options_available")),n.length>0&&this.renderFilteredOptions(n)))))}}])}(l.default.Component);d.defaultProps={isReadOnly:!1,value:[]};t.default=d},93121:function(e,t,n){"use strict";var r=n(12897).default,o=n(17383).default,a=n(34579).default,i=n(18336).default,s=n(29511).default,l=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(98201)),u=n(61779);n(64555);var d=function(e){function t(e){var n;return o(this,t),(n=i(this,t,[e])).onValueChanged=function(e){var t=e.target.value;n.setState({searchValue:t})},n.onInputClick=function(e){e.nativeEvent.stopImmediatePropagation(),e.stopPropagation()},n.onOptionItemToggle=function(e){n.props.onOptionItemToggle(e)},n.getFilterOptions=function(){var e=n.props.options,t=n.state.searchValue.toLowerCase();return t?e.filter((function(e){return e.name.toString().toLowerCase().indexOf(t)>-1})):e},n.state={searchValue:""},n}return s(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.getFilterOptions(),n=this.props,o=n.popoverPosition,a=n.selectedOptions,i=this.state.searchValue,s=Object.assign({},r({},o),{position:"absolute"});return c.default.createElement("div",{className:"dtable-ui-editor-popover dtable-ui-link-editor-popover",style:s},c.default.createElement("div",{className:"link-options-search"},c.default.createElement("input",{className:"form-control",value:i,onChange:this.onValueChanged,onClick:this.onInputClick,placeholder:(0,u.getLocale)("Search_option")})),c.default.createElement("div",{className:"link-options-container"},t.length>0&&t.map((function(t,n){var r=a.some((function(e){return e.id===t.id}));return c.default.createElement("div",{key:n,className:"link-option-item",onClick:e.onOptionItemToggle.bind(e,t)},c.default.createElement("div",{className:"option-info"},c.default.createElement("div",{className:"option-name",title:t.name},t.name)),c.default.createElement("div",{className:"option-checked"},r&&c.default.createElement("i",{className:"dtable-font dtable-icon-check-mark"})))})),0===t.length&&c.default.createElement("div",{className:"link-option-null"},(0,u.getLocale)("No_options_available"))))}}])}(c.default.Component);d.defaultProps={popoverPosition:{},options:[]};t.default=d},34627:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(n(98201)),c=s(n(28414)),u=n(96795);n(50781);var d=function(e){function t(e){var n;return r(this,t),(n=a(this,t,[e])).getLinkedCellValue=function(e){if(!e)return[];var t=n.props,r=t.column,o=t.currentTableId,a=t.linkMetaData,i=r.data||{},s=i.link_id,l=i.table_id,c=i.other_table_id;return n.linkID=s,n.tableID=o===l?l:c,n.otherTableID=n.tableID===l?c:l,a.getLinkedCellValue(n.linkID,n.tableID,n.otherTableID,e._id)},n.expandLinkedTableRow=function(e){var t=n.props,r=t.enableOpenLinkedRow,o=t.linkMetaData;r&&o.expandLinkedTableRow(e,n.otherTableID)},n.getDisplayValues=function(){var e=n.props,t=e.column,r=e.linkMetaData,o=n.state.value;if(o&&Array.isArray(o)&&o.length>0){var a=r.getLinkedTable(n.otherTableID);return r.getLinkedRows(n.otherTableID,o).map((function(e,r){var o=t.data.display_column_key,i=n.getDisplayValue(a,e,o);return l.default.createElement("div",{key:r,className:"link-item",onClick:n.expandLinkedTableRow.bind(n,e)},l.default.createElement("div",{className:"link-name",title:i},i))}))}return null},n.getDisplayValue=function(e,t,n){var r=t[n],o=e.columns.find((function(e){return e.key===n})),a=o.type,i=o.data;switch(a){case u.CellType.NUMBER:return(0,u.getNumberDisplayString)(r,i);case u.CellType.DATE:var s=i.format;return(0,u.getDateDisplayString)(r,s);default:return r}},n.linkID="",n.tableID="",n.otherTableID="",n.state={value:n.getLinkedCellValue(e.row)},n}return i(t,e),o(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.row;t._id!==this.props.row._id&&this.setState({value:this.getLinkedCellValue(t)})}},{key:"render",value:function(){var e=this.props.containerClassName,t=(0,c.default)("dtable-ui cell-formatter-container link-formatter",e),n=this.getDisplayValues();return l.default.createElement("div",{className:t},n)}}])}(l.default.Component);d.defaultProps={enableOpenLinkedRow:!1,currentTableId:"",value:[],column:{},row:{}};t.default=d},36720:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(n(98201)),c=function(e){function t(){return r(this,t),a(this,t,arguments)}return i(t,e),o(t,[{key:"render",value:function(){var e=this.props,t=e.title,n=e.titleClass,r=e.leftContent,o=e.rightContent,a=e.onLeftClick,i=e.onRightClick;return l.default.createElement("div",{className:"dtable-ui-mb-editor-header ".concat(n||"")},l.default.createElement("span",{className:"editor-header-left-content",onClick:a},r),l.default.createElement("span",{className:"editor-header-title"},t),l.default.createElement("span",{className:"editor-header-right-content",onClick:i,style:{color:"#f09f3f"}},o))}}])}(l.default.Component);t.default=c},66986:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default,l=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(98201)),u=s(n(70446)),d=n(61779),p=s(n(73490)),f=n(60979);n(17746);var h=function(e){function t(e){var n;r(this,t),(n=a(this,t,[e])).onMouseDown=function(e){n.editorContainer===e.target||n.editorContainer.contains(e.target)||n.onClosePopover()},n.getFormattedOptions=function(){var e=n.state.newValue;return Array.isArray(e)&&e.length>0?e.map((function(e){return n.options.find((function(t){return t.id===e}))})).filter((function(e){return!!e})):[]},n.onAddOptionToggle=function(e){if(e.nativeEvent.stopImmediatePropagation(),e.stopPropagation(),!n.props.isReadOnly){var t=!n.state.isPopoverShow;if(t){var r=n.caculatePopoverPosition();n.setState({isPopoverShow:t,popoverPosition:r})}else n.setState({isPopoverShow:t})}},n.onCommit=function(e){var t={};t[n.props.column.key]=e,n.props.onCommit(t)},n.onOptionItemToggle=function(e){var t=n.state.newValue.slice(),r=t.findIndex((function(t){return t===e.id}));-1!==r?t.splice(r,1):t.push(e.id),n.setState({newValue:t},(function(){n.onCommit(t)}))},n.onDeleteOption=function(e){var t=n.state.newValue.slice(),r=t.findIndex((function(t){return t===e.id}));t.splice(r,1),n.setState({newValue:t},(function(){n.onCommit(t)}))},n.onAddNewOption=function(e){n.props.onAddNewOption(e),n.onClosePopover()},n.caculatePopoverPosition=function(){var e=window.innerHeight,t=n.editor.getClientRects()[0],r=t.top,o=t.height,a={top:o+1,left:0};e-(r+o)>200||(a={bottom:o+1,left:0});return a},n.onClosePopover=function(){n.setState({isPopoverShow:!1})},n.setEditorContainerRef=function(e){n.editorContainer=e},n.setEditorRef=function(e){n.editor=e},n.state={newValue:Array.isArray(e.value)?e.value:[],isPopoverShow:!1,popoverPosition:{}};var o=n.props.column;return n.options=o.data&&(o.data.options||[]),n}return i(t,e),o(t,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.onMouseDown)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.onMouseDown)}},{key:"render",value:function(){var e=this,t=this.state,n=t.isPopoverShow,r=t.popoverPosition,o=this.options,a=this.getFormattedOptions();return c.default.createElement("div",{ref:this.setEditorContainerRef,className:"cell-editor dtable-ui-multiple-select-editor"},c.default.createElement("div",{ref:this.setEditorRef,className:"dtable-ui-select-editor-container",onClick:this.onAddOptionToggle},0===a.length&&c.default.createElement(p.default,{text:(0,d.getLocale)("Add_an_option")}),0!==a.length&&a.map((function(t){return c.default.createElement(f.SelectEditorOption,{key:t.id,option:t,isShowRemoveIcon:!0,onDeleteSelectOption:e.onDeleteOption})}))),n&&c.default.createElement(c.Fragment,null,c.default.createElement(u.default,{query:"(min-width: 768px)"},c.default.createElement(f.PCSelectEditorPopover,{popoverPosition:r,options:o,selectedOptions:a,onOptionItemToggle:this.onOptionItemToggle,isSupportNewOption:this.props.isSupportNewOption,onAddNewOption:this.onAddNewOption})),c.default.createElement(u.default,{query:"(max-width: 767.8px)"},c.default.createElement(f.MBSelectEditorPopover,{isReadOnly:this.props.isReadOnly,value:this.state.newValue,column:this.props.column,options:o,onOptionItemToggle:this.onOptionItemToggle,isShowRemoveIcon:!0,isSupportNewOption:this.props.isSupportNewOption,onAddNewOption:this.onAddNewOption,onClosePopover:this.onClosePopover}))))}}])}(c.default.Component);h.defaultProps={isReadOnly:!1,value:[]};t.default=h},24629:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(n(98201)),c=n(48843);n(47175);var u=function(e){function t(){var e;return r(this,t),(e=a(this,t,arguments)).onMouseDown=function(t){if(!e.notificationContainerRef.contains(t.target)){if(document.removeEventListener("mousedown",e.onMouseDown),"tool notification"===t.target.className||"tool notification"===t.target.parentNode.className)return;e.props.onNotificationListToggle()}},e.onNotificationDialogToggle=function(){e.props.onNotificationDialogToggle(),e.props.onNotificationListToggle()},e.onWeixinQRCodeDialogToggle=function(){e.props.onOpenWeixinQRCodeDialog(),e.props.onNotificationListToggle()},e.onHandleScroll=function(){e.notificationListRef.offsetHeight+e.notificationListRef.scrollTop+1>=e.notificationsWrapperRef.offsetHeight&&e.props.listNotifications&&e.props.listNotifications()},e}return i(t,e),o(t,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.onMouseDown)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.onMouseDown)}},{key:"render",value:function(){var e=this,t=this.props,n=t.headerText,r=t.bodyText,o=t.footerText;return l.default.createElement(c.Popover,{className:"notification-wrapper",target:"notification-popover",isOpen:!0,fade:!1,hideArrow:!0,placement:"bottom"},l.default.createElement("div",{className:"notification-container",ref:function(t){return e.notificationContainerRef=t}},l.default.createElement("div",{className:"notification-header"},n,l.default.createElement("span",{className:"dtable-font dtable-icon-x notification-close-icon",onClick:this.props.onNotificationListToggle})),l.default.createElement("div",{className:"notification-body"},this.props.enableWeixin&&l.default.createElement("div",{className:"show-weixin-qrcode",onClick:this.onWeixinQRCodeDialogToggle},l.default.createElement("i",{className:"dtable-font dtable-icon-wechat weixin-icon"}),l.default.createElement("span",{className:"ml-2"},"\u5173\u6ce8\u516c\u4f17\u53f7\u83b7\u53d6\u5b9e\u65f6\u901a\u77e5")),l.default.createElement("div",{className:"mark-notifications",onClick:this.props.onMarkAllNotifications},r),l.default.createElement("div",{className:"notification-list-container",onScroll:this.onHandleScroll,ref:function(t){return e.notificationListRef=t}},l.default.createElement("div",{ref:function(t){return e.notificationsWrapperRef=t}},this.props.children)),l.default.createElement("div",{className:"notification-footer",onClick:this.onNotificationDialogToggle},o))))}}])}(l.default.Component);t.default=u,u.defaultProps={headerText:"",bodyText:"",footerText:""}},68475:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(n(98201)),c=s(n(75168)),u=n(96795),d=n(38680),p=n(70017),f=function(e){function t(e){var n;r(this,t),(n=a(this,t,[e])).onEditorHandle=function(){n.props.isReadOnly||n.setState({isEditorShow:!0,inputValue:n.state.textValue},(function(){n.input.focus()}))},n.onCommit=function(){var e={},t=n.props.column,r=n.state.inputValue?n.state.inputValue.toString():"",o=r?(0,u.formatStringToNumber)(r):"";e[t.key]=o,n.props.onCommit(e);var a=(0,u.getNumberDisplayString)(o,t.data);n.setState({isEditorShow:!1,textValue:a})},n.onChange=function(e){var t=n.props.column.data,r=e.target.value.trim(),o=null;t&&"custom_currency"===t.format&&(o=t.currency_symbol),!(0,p.isMac)()&&r.indexOf(".\u3002")>-1||(r=(0,u.replaceNumberNotAllowInput)(r,n.dataFormat,o))!==n.state.inputValue&&n.setState({inputValue:r})},n.onBlur=function(){n.onCommit()},n.onKeyDown=function(e){var t=e.currentTarget,r=t.selectionStart,o=t.selectionEnd,a=t.value;(0,c.default)("enter",e)?(e.preventDefault(),n.onBlur()):(37===e.keyCode&&0===r||39===e.keyCode&&o===a.length)&&e.stopPropagation()},n.onPaste=function(e){e.stopPropagation()},n.onCut=function(e){e.stopPropagation()},n.getStyle=function(){return{width:"320px",textAlign:"left"}},n.setInputRef=function(e){return n.input=e,n.input};var o=n.props,i=o.value,s=o.column,l=s.data&&s.data.format;n.dataFormat=l||d.NUMBER_TYPES.NUMBER;var f=(0,u.getNumberDisplayString)(i,s.data);return n.state={inputValue:f,textValue:f,isEditorShow:!1},n}return i(t,e),o(t,[{key:"render",value:function(){var e=this.getStyle();return l.default.createElement("div",{className:"cell-editor number-editor"},l.default.createElement("div",{className:"number-editor-container"},!this.state.isEditorShow&&l.default.createElement("div",{className:"form-control",style:e,onClick:this.onEditorHandle},this.state.textValue),this.state.isEditorShow&&l.default.createElement("input",{ref:this.setInputRef,type:"text",className:"form-control",style:e,value:this.state.inputValue,onChange:this.onChange,onBlur:this.onBlur,onCut:this.onCut,onPaste:this.onPaste,onKeyDown:this.onKeyDown})))}}])}(l.default.Component);f.defaultProps={isReadOnly:!1,value:""};t.default=f},61216:function(e,t,n){"use strict";var r=n(85715).default,o=n(24994).default,a=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(98201)),s=n(48843),l=o(n(28414));n(2872);t.default=function(e){var t=e.isShowDropdownIcon,n=e.currentOption,o=e.menuOptions,a=e.onChangeOption,c=e.closeShowDropdownIcon,u=(0,i.useState)(!1),d=r(u,2),p=d[0],f=d[1];return i.default.createElement(s.Dropdown,{isOpen:p,className:"role-status-editor",toggle:function(){return f(!p)}},i.default.createElement(s.DropdownToggle,{className:"dropdown-toggle-button d-flex align-items-center",tag:"div"},n.label,i.default.createElement("div",{className:"dropdown-icon-container ml-1"},i.default.createElement("span",{className:(0,l.default)("dtable-font dtable-icon-drop-down",{hide:!t})}))),i.default.createElement(s.DropdownMenu,{positionFixed:!0,modifiers:{preventOverflow:{boundariesElement:document.body}}},o.map((function(e){var t=e.value,r=e.label;return i.default.createElement(s.DropdownItem,{key:"item-".concat(t),onClick:function(){return function(e){var t=e.value;c&&c(),t!==n.value&&a(t)}(e)}},r,t===n.value&&i.default.createElement("i",{className:"dtable-font dtable-icon-check-mark ml-2"}))}))))}},65147:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(n(98201)),c=s(n(28414)),u=n(37151);n(22757);var d=function(e){function t(){var e;return r(this,t),(e=a(this,t,arguments)).onOpenEmailLink=function(){var t=e.props.value.trim();window.location.href="mailto:".concat(t)},e}return i(t,e),o(t,[{key:"render",value:function(){var e=this.props,t=e.containerClassName,n=e.value,r=(0,c.default)("dtable-ui cell-formatter-container email-formatter",t);return l.default.createElement("div",{className:r},l.default.createElement("span",{className:"email-formatter-value text-truncate"},n),(0,u.getTrimmedString)(n)&&l.default.createElement("span",{className:"dtable-font dtable-icon-email row-expand-jump-link",onClick:this.onOpenEmailLink}))}}])}(l.default.Component);t.default=d},96839:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(n(98201)),c=s(n(28414)),u=s(n(35880));n(93401);var d=function(e){function t(){return r(this,t),a(this,t,arguments)}return i(t,e),o(t,[{key:"render",value:function(){var e=this.props,t=e.value,n=e.containerClassName,r=e.column,o=e.downloadFile,a=e.deleteFile,i=e.readOnly;return Array.isArray(t)&&0!==t.length?l.default.createElement("div",{className:(0,c.default)("dtable-ui cell-formatter-container row-expand-file-formatter",n)},t.map((function(e,t){return l.default.createElement(u.default,{file:e,key:t,index:t,column:r,downloadFile:o,deleteFile:a,readOnly:i})}))):null}}])}(l.default.PureComponent);t.default=d,d.defaultProps={value:[],containerClassName:""}},35880:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default,l=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(98201)),u=n(48843),d=n(61779),p=n(16069),f=s(n(49015)),h=function(e){function t(e){var o;return r(this,t),(o=a(this,t,[e])).toggleTooltip=function(){o.setState({isTooltipOpen:!o.state.isTooltipOpen})},o.closeDeleteTip=function(){o.setState({isDeleteTipOpen:!1})},o.onClickDelete=function(e){e.stopPropagation(),o.position={top:e.clientY,left:e.clientX},o.setState({isDeleteTipOpen:!0})},o.onDelete=function(e){e.stopPropagation(),o.closeDeleteTip(),o.props.deleteFile(o.props.index)},o.getFileIconData=function(e){var t=(0,p.getFileIconUrl)(e.name,e.type);return n(81936)("./"+t)},o.state={isTooltipOpen:!1,isDeleteTipOpen:!1},o}return i(t,e),o(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.file,r=t.column,o=t.index,a=t.readOnly,i=t.downloadFile,s=t.deleteFile,l="file-list-preview-item"+r.key+o,p=this.getFileIconData(n);return c.default.createElement(c.default.Fragment,null,c.default.createElement("div",{key:"file-".concat(o),className:"row-expand-item-file",id:l},c.default.createElement("img",{src:p,id:"item-file-".concat(o),alt:n.name}),c.default.createElement("div",{className:"dtable-file-icons-choice"},i&&c.default.createElement("span",{className:"file-icon",onClick:function(t){return e.props.downloadFile(n,t)}},c.default.createElement("i",{className:"dtable-font dtable-icon-download"})),!a&&s&&c.default.createElement("span",{className:"file-icon",onClick:this.onClickDelete},c.default.createElement("i",{className:"dtable-font dtable-icon-fork-number"})))),this.state.isDeleteTipOpen&&c.default.createElement(f.default,{position:this.position,toggle:this.closeDeleteTip,onDelete:this.onDelete,deleteTip:(0,d.getLocale)("Are_you_sure_you_want_to_delete_this_file")}),c.default.createElement(u.Tooltip,{placement:"bottom",isOpen:this.state.isTooltipOpen,toggle:this.toggleTooltip,target:l,delay:{show:0,hide:0},fade:!1},n.name))}}])}(c.Component);t.default=h},97113:function(e,t,n){"use strict";var r=n(43693).default,o=n(12897).default,a=n(17383).default,i=n(34579).default,s=n(18336).default,l=n(29511).default,c=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u=c(n(98201)),d=c(n(28414)),p=c(n(15882)),f=c(n(36352)),h=c(n(28624)),m=c(n(99155)),g=c(n(79127)),v=c(n(90251)),y=c(n(72403)),C=c(n(27812)),A=c(n(82663)),x=c(n(77013)),b=c(n(43349)),_=c(n(69216)),w=c(n(49159)),S=c(n(63845)),D=c(n(61875)),E=c(n(18055)),k=c(n(71140)),M=c(n(65147)),I=c(n(26011)),N=c(n(83440)),P=c(n(96839)),T=c(n(93245)),O=c(n(67457)),j=c(n(24102)),R=c(n(73125)),L=n(38680);n(24103);var F=function(e){function t(e){var n;return a(this,t),(n=s(this,t,[e])).updateCollaborators=function(){n.setState({collaborators:n.getCollaborator()})},n.calculateCollaboratorData=function(e){var t=e.row,r=e.column;if(r.type===L.CellType.CREATOR||r.type===L.CellType.LAST_MODIFIER){var o=t[r.name];n.loadCollaborator(o)}else if(r.type===L.CellType.COLLABORATOR){var a=t[r.name];Array.isArray(a)&&a.forEach((function(e){n.loadCollaborator(e)}))}},n.getCollaborator=function(){var e=n.props,t=e.context,r=e.collaborators;return t&&t.getCollaboratorsFromCache?t.getCollaboratorsFromCache():r||[]},n.loadCollaborator=function(e){var t=n.props.context;t&&t.loadCollaborator&&t.loadCollaborator(e)},n.renderEmpty=function(){return u.default.createElement("div",{className:"d-flex align-items-center form-control disabled h-auto"})},n.renderFormatter=function(){var e=n.props,t=e.column,r=e.row,a=e.className,i=t.type,s=n.state.collaborators,l="dtable-".concat(i,"-formatter ").concat(a||""),c=null!==r[t.key]&&void 0!==r[t.key]?r[t.key]:r[t.name];switch(i){case L.CellType.TEXT:return u.default.createElement("div",{className:"form-control d-flex align-items-center w-100"},u.default.createElement(p.default,{value:c,containerClassName:l}));case L.CellType.COLLABORATOR:return u.default.createElement("div",{className:"form-control d-flex align-items-center w-100 h-auto"},u.default.createElement(y.default,{value:c,collaborators:s,containerClassName:l}));case L.CellType.LONG_TEXT:return c?u.default.createElement("div",{className:"longtext-formatter-container"},u.default.createElement(C.default,{value:c,containerClassName:l,isSample:!1})):null;case L.CellType.GEOLOCATION:return"object"!==typeof c?null:u.default.createElement("div",{className:"geolocation-formatter-container"},u.default.createElement(A.default,{value:c,data:t.data,containerClassName:l}));case L.CellType.NUMBER:return u.default.createElement("div",{className:"form-control d-flex align-items-center",style:{width:320}},u.default.createElement(f.default,{value:c,data:t.data,containerClassName:l}));case L.CellType.DATE:return u.default.createElement("div",{className:"form-control d-flex align-items-center",style:{width:320}},u.default.createElement(m.default,{value:c,format:t.data.format,containerClassName:l}));case L.CellType.CTIME:return u.default.createElement("div",{className:"form-control d-flex align-items-center ctime-formatter-container",style:{width:320}},u.default.createElement(x.default,{value:r._ctime,containerClassName:l}));case L.CellType.MTIME:return u.default.createElement("div",{className:"form-control d-flex align-items-center mtime-formatter-container",style:{width:320}},u.default.createElement(w.default,{value:r._mtime,containerClassName:l}));case L.CellType.MULTIPLE_SELECT:var d=t.data?t.data.options:[];return u.default.createElement("div",{className:"form-control d-flex align-items-center w-100 h-auto"},u.default.createElement(v.default,{value:c,options:d,containerClassName:l}));case L.CellType.SINGLE_SELECT:var F=t.data?t.data.options:[];return u.default.createElement("div",{className:"form-control d-flex align-items-center w-100"},u.default.createElement(g.default,{value:c,options:F,containerClassName:l}));case L.CellType.FILE:return u.default.createElement(P.default,{value:c,column:t,downloadFile:n.props.downloadFile,deleteFile:n.props.deleteFile});case L.CellType.IMAGE:return u.default.createElement(N.default,{value:c,column:t,downloadImage:n.props.downloadImage,deleteFile:n.props.deleteFile,onRotateImage:n.props.onRotateImage});case L.CellType.CHECKBOX:return u.default.createElement("div",{className:"checkbox-formatter-container"},u.default.createElement(h.default,{value:c}));case L.CellType.CREATOR:return u.default.createElement(b.default,{collaborators:s,value:c,containerClassName:l});case L.CellType.LAST_MODIFIER:return u.default.createElement(_.default,{collaborators:s,value:c,containerClassName:l});case L.CellType.FORMULA:case L.CellType.LINK_FORMULA:return u.default.createElement(O.default,{value:c,column:t,collaborators:s,containerClassName:l});case L.CellType.LINK:var U=t.data,Y=U.display_column_key,B=U.array_type,H=U.array_data;return U.display_column||(t=o(o({},t),{},{data:o(o({},U),{},{display_column:{key:Y||"0000",type:B||L.CellType.TEXT,data:H||null}})})),u.default.createElement(T.default,{value:c,column:t,collaborators:s,containerClassName:l,renderEmpty:n.renderEmpty});case L.CellType.AUTO_NUMBER:return u.default.createElement(S.default,{value:c,containerClassName:l});case L.CellType.URL:return u.default.createElement("div",{className:"form-control d-flex align-items-center w-100"},u.default.createElement(k.default,{value:c,containerClassName:l}));case L.CellType.EMAIL:return u.default.createElement("div",{className:"form-control d-flex align-items-center w-100"},u.default.createElement(M.default,{value:c,containerClassName:l}));case L.CellType.DURATION:return u.default.createElement("div",{className:"form-control d-flex align-items-center",style:{width:320}},u.default.createElement(D.default,{value:c,format:t.data.duration_format,containerClassName:l}));case L.CellType.RATE:return u.default.createElement("div",{className:"form-control d-flex align-items-center",style:{width:320}},u.default.createElement(I.default,{value:c,data:t.data,containerClassName:l}));case L.CellType.BUTTON:return u.default.createElement(E.default,{data:t.data,containerClassName:l,onClickButton:n.props.onClickButton});case L.CellType.DIGITAL_SIGN:return u.default.createElement(j.default,{value:c,containerClassName:l,config:n.props.config});case L.CellType.DEPARTMENT_SINGLE_SELECT:return u.default.createElement(R.default,{value:c,departments:n.props.departments});default:return null}},n.state={collaborators:n.getCollaborator()},n}return l(t,e),i(t,[{key:"componentDidMount",value:function(){this.calculateCollaboratorData(this.props),this.props.eventBus&&(this.unsubscribeCollaboratorsUpdated=this.props.eventBus.subscribe("collaborators-updated",this.updateCollaborators))}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.calculateCollaboratorData(e)}},{key:"componentWillUnmount",value:function(){this.props.eventBus&&this.unsubscribeCollaboratorsUpdated&&this.unsubscribeCollaboratorsUpdated()}},{key:"render",value:function(){var e=this.props.className;return u.default.createElement("div",{className:(0,d.default)("dtable-ui dtable-row-expand-formatter",r({},e,e))},this.renderFormatter())}}])}(u.default.Component);t.default=F,F.defaultProps={className:""}},67457:function(e,t,n){"use strict";var r=n(12897).default,o=n(17383).default,a=n(34579).default,i=n(18336).default,s=n(29511).default,l=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(98201)),u=l(n(28414)),d=n(96795),p=l(n(18206)),f=l(n(15882)),h=n(81370),m=l(n(93116)),g=l(n(63561)),v=n(61779);n(7513);var y=function(e){function t(){var e;return o(this,t),(e=i(this,t,arguments)).getGridCellClassName=function(e){switch(e){case d.FORMULA_RESULT_TYPE.NUMBER:case d.FORMULA_RESULT_TYPE.DATE:return"text-right";default:return""}},e.onOpenUrlLink=function(e){(0,h.isValidUrl)(e)||(e="http://".concat(e));try{(0,h.openUrlLink)(e)}catch(t){g.default.danger((0,v.getLocale)("URL_is_invalid"))}},e.onOpenEmailLink=function(e){window.location.href="mailto:".concat(e.trim())},e.renderBorder=function(t){var n=e.props.column,o=n.data.result_type,a={minHeight:"38px"};o!==d.FORMULA_RESULT_TYPE.DATE&&o!==d.FORMULA_RESULT_TYPE.NUMBER||(a={width:"320px"});var i=(0,d.getColumnType)(n);return[d.CellType.URL,d.CellType.EMAIL].includes(i)&&(a=r(r({},a),{},{position:"relative"})),c.default.createElement("div",{className:"d-flex align-items-center form-control disabled h-auto",style:a},t)},e.renderCellValue=function(t,n){var r=e.props.containerClassName,o=e.getGridCellClassName(n),a="dtable-ui cell-formatter-container formula-formatter ".concat(r," ").concat(o);return e.renderBorder(c.default.createElement("div",{className:a,title:t,"aria-label":t},t))},e.renderInternalErrorValue=function(t,n){return e.renderCellValue(t,n)},e.renderOtherColumnFormatter=function(){var t=e.props,n=t.value,r=t.column,o=t.collaborators,a=r.data,i=a.array_type,s=a.array_data;if(!i||i===d.CellType.LINK)return null;var l=p.default[i],f=e.getFormatterProps(i,s,o);if((0,h.isArrayFormatColumn)(i))return f.value=n,e.renderBorder(e.createColumnFormatter(l,f));var g=(0,d.getColumnType)(r),v=n;Array.isArray(n)||(v=(0,m.default)(n,i)?[n]:[]);var y="";g===d.CellType.URL&&(y=(y=v[0])?y.trim():"");var C="";return g===d.CellType.EMAIL&&(C=(C=v[0])?C.trim():""),e.renderBorder(c.default.createElement("div",{className:"dtable-ui formula-formatter multiple"},v.map((function(t,n){return f.value=t,c.default.createElement("div",{className:(0,u.default)("formula-formatter-content-item",{"simple-cell-formatter":(0,h.isSimpleCellFormatter)(i)},{"formula-url-formatter-column":y||C}),key:"formula-formatter-content-item-".concat(n)},y&&c.default.createElement("span",{"aria-hidden":"true",className:"dtable-font dtable-icon-url formula-url-link",onClick:e.onOpenUrlLink.bind(e,y)}),C&&c.default.createElement("span",{"aria-hidden":"true",className:"dtable-font dtable-icon-email formula-email-link",onClick:e.onOpenEmailLink.bind(e,C)}),e.createColumnFormatter(l,f))}))))},e.getFormatterProps=function(e,t,n){switch(e){case d.CellType.DURATION:return{format:t.duration_format};case d.CellType.NUMBER:case d.CellType.RATE:case d.CellType.GEOLOCATION:return{data:t};default:return r(r({},t),{},{collaborators:n})}},e}return s(t,e),a(t,[{key:"createColumnFormatter",value:function(e,t){return c.default.isValidElement(e)?c.default.cloneElement(e,r({},t)):(0,h.isFunction)(e)?c.default.createElement(e,t):c.default.createElement(f.default,t)}},{key:"render",value:function(){var e=this.props,t=e.column,n=e.collaborators,r=e.value,o=t.data,a=o.array_type,i=o.result_type;if(d.DISPLAY_INTERNAL_ERRORS.includes(r))return this.renderInternalErrorValue(r,i);if(a===d.CellType.LONG_TEXT&&Array.isArray(r)&&(r=r.map((function(e){return(0,h.convertValueToDtableLongTextValue)(e)}))),i===d.FORMULA_RESULT_TYPE.ARRAY)return this.renderOtherColumnFormatter();if("object"===typeof r)return null;var s=(0,d.getFormulaDisplayString)(r,o,{collaborators:n});return this.renderCellValue(s,i)}}])}(c.default.Component);t.default=y},83440:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default,l=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(98201)),u=s(n(28414)),d=s(n(72198)),p=s(n(57818));n(11624);var f=function(e){function t(e){var n;return r(this,t),(n=a(this,t,[e])).onImageClick=function(e){n.setState({isPreviewImage:!0,previewImageIndex:e})},n.closeImagePopup=function(){n.props.onCloseCallback&&n.props.onCloseCallback(),n.setState({isPreviewImage:!1,previewImageIndex:-1})},n.movePrev=function(){var e=n.props.value;n.setState((function(t){return{previewImageIndex:(t.previewImageIndex+e.length-1)%e.length}}))},n.moveNext=function(){var e=n.props.value;n.setState((function(t){return{previewImageIndex:(t.previewImageIndex+1)%e.length}}))},n.state={isPreviewImage:!1,previewImageIndex:-1},n}return i(t,e),o(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.value,r=t.server,o=t.containerClassName,a=t.readOnly,i=t.column,s=t.downloadImage,l=this.state,f=l.isPreviewImage,h=l.previewImageIndex;return Array.isArray(n)&&0!==n.length?c.default.createElement(c.Fragment,null,c.default.createElement("div",{className:(0,u.default)("dtable-ui cell-formatter-container row-expand-image-formatter",o)},n.map((function(t,n){return c.default.createElement(d.default,{url:t,key:n,index:n,column:i,downloadFile:s,deleteFile:e.props.deleteFile,readOnly:a,onImageClick:e.onImageClick})}))),f&&c.default.createElement(p.default,{imageItems:n,imageIndex:h,closeImagePopup:this.closeImagePopup,moveToPrevImage:this.movePrev,moveToNextImage:this.moveNext,deleteImage:this.props.deleteFile,downloadImage:s,onRotateImage:this.props.rotateImage,readOnly:a,server:r,moveToPrevRowImage:this.props.moveToPrevRowImage,moveToNextRowImage:this.props.moveToNextRowImage})):null}}])}(c.default.Component);t.default=f,f.defaultProps={readOnly:!0,value:[],server:"",containerClassName:""}},72198:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default,l=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(98201)),u=n(48843),d=s(n(70446)),p=n(61779),f=s(n(49015)),h=function(e){function t(e){var n;return r(this,t),(n=a(this,t,[e])).toggleTooltip=function(){n.setState({isTooltipOpen:!n.state.isTooltipOpen})},n.closeDeleteTip=function(){n.setState({isDeleteTipOpen:!1})},n.onClickDelete=function(e){e.preventDefault(),e.stopPropagation(),n.position={top:e.clientY,left:e.clientX},n.setState({isDeleteTipOpen:!0})},n.onClickDownload=function(e){e.preventDefault(),e.stopPropagation(),n.props.downloadFile(n.props.url,e)},n.onDelete=function(e){e.stopPropagation(),n.closeDeleteTip(),n.props.deleteFile(n.props.index)},n.onClickImage=function(){n.props.onImageClick(n.props.index)},n.state={isTooltipOpen:!1,isDeleteTipOpen:!1},n}return i(t,e),o(t,[{key:"render",value:function(){var e=this.props,t=e.url,n=e.column,r=e.index,o=e.readOnly,a=e.downloadFile,i=e.deleteFile,s="image-list-preview-item"+n.key+r,l=decodeURI(t.slice(t.lastIndexOf("/")+1));return c.default.createElement(c.default.Fragment,null,c.default.createElement("div",{key:"image-".concat(r),className:"row-expand-item-image",id:s,onClick:this.onClickImage},c.default.createElement("img",{src:t,id:"item-image-".concat(r),alt:l}),c.default.createElement("div",{className:"dtable-image-icons-choice"},a&&c.default.createElement("span",{className:"image-icon",onClick:this.onClickDownload},c.default.createElement("i",{className:"dtable-font dtable-icon-download"})),!o&&i&&c.default.createElement("span",{className:"image-icon",onClick:this.onClickDelete},c.default.createElement("i",{className:"dtable-font dtable-icon-fork-number"})))),this.state.isDeleteTipOpen&&c.default.createElement(f.default,{position:this.position,toggle:this.closeDeleteTip,onDelete:this.onDelete,deleteTip:(0,p.getLocale)("Are_you_sure_you_want_to_delete_this_image")}),c.default.createElement(d.default,{query:"(min-width: 768px)"},c.default.createElement(u.Tooltip,{placement:"bottom",isOpen:this.state.isTooltipOpen,toggle:this.toggleTooltip,target:s,delay:{show:0,hide:0},fade:!1},l)))}}])}(c.Component);t.default=h},57254:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default,l=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(98201)),u=n(96795),d=s(n(35012)),p=function(e){function t(e){var n;return r(this,t),(n=a(this,t,[e])).calculateCollaboratorData=function(e){var t=n.props,r=t.context,o=t.collaborators,a=e.cellValue;if(a){n.setState({isDataLoaded:!1,collaborator:null});var i=o&&o.find((function(e){return e.name===a}));if(i)n.setState({isDataLoaded:!0,collaborator:i});else if(r){var s=r.getSetting("mediaUrl"),l="".concat(s,"/avatars/default.png");if("anonymous"===a)return i={name:"anonymous",avatar_url:l},void n.setState({isDataLoaded:!0,collaborator:i});var c=r.getSetting("collaboratorsCache");if(!(i=c[a]))return(0,u.isValidEmail)(a)?void n.props.context.getUserCommonInfo(a).then((function(e){i=e.data,c[a]=i,n.setState({isDataLoaded:!0,collaborator:i})})).catch((function(){i={name:a,avatar_url:l},c[a]=i,n.setState({isDataLoaded:!0,collaborator:i})})):(i={name:a,avatar_url:l},c[a]=i,void n.setState({isDataLoaded:!0,collaborator:i}));n.setState({isDataLoaded:!0,collaborator:i})}}else n.setState({isDataLoaded:!0,collaborator:null})},n.state={isDataLoaded:!1,collaborator:null},n}return i(t,e),o(t,[{key:"componentDidMount",value:function(){this.calculateCollaboratorData(this.props)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.calculateCollaboratorData(e)}},{key:"render",value:function(){var e=this.props.cellValue,t=this.state,n=t.collaborator;return t.isDataLoaded&&e&&n?c.default.createElement(d.default,{collaborator:n,enableDeleteCollaborator:!1}):this.props.renderEmpty()}}])}(c.Component);t.default=p},93245:function(e,t,n){"use strict";var r=n(43693).default,o=n(17383).default,a=n(34579).default,i=n(18336).default,s=n(29511).default,l=n(24994).default,c=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u=c(n(98201)),d=n(38680),p=l(n(90251)),f=l(n(77013)),h=l(n(49159)),m=l(n(99155)),g=l(n(57254)),v=n(1480),y=n(24115);n(94307);var C=function(e){function t(){return o(this,t),i(this,t,arguments)}return s(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.column,n=e.value,o=e.containerClassName,a=e.collaborators,i=t.data;if(!Array.isArray(n)||0===n.length)return e.renderEmpty();var s=(i||{}).display_column;if(!s)return e.renderEmpty();var l=s.type,c=s.data,C=(0,v.getFormulaArrayValue)(n,!(0,v.isArrayFormatColumn)(l));if(!Array.isArray(C)||0===C.length)return e.renderEmpty();switch(l){case d.CellType.TEXT:case d.CellType.AUTO_NUMBER:case d.CellType.EMAIL:case d.CellType.URL:case d.CellType.DURATION:case d.CellType.NUMBER:return u.default.createElement("div",{className:o},C.map((function(e,t){return e?u.default.createElement("div",{key:"link-".concat(l,"-").concat(t),className:"row-expand-link-item"},e):null})));case d.CellType.DATE:return u.default.createElement("div",{className:o},C.map((function(e,t){if(!e||"string"!==typeof e)return null;var n=(c||{}).format;return u.default.createElement(m.default,{key:"link-".concat(l,"-").concat(t),value:e,format:n,containerClassName:"row-expand-link-item"})})));case d.CellType.CTIME:return u.default.createElement("div",{className:o},C.map((function(e,t){return e?u.default.createElement(f.default,{key:"link-".concat(l,"-").concat(t),value:e,containerClassName:"row-expand-link-item"}):null})));case d.CellType.MTIME:return u.default.createElement("div",{className:o},C.map((function(e,t){return e?u.default.createElement(h.default,{key:"link-".concat(l,"-").concat(t),value:e,containerClassName:"row-expand-link-item"}):null})));case d.CellType.CREATOR:case d.CellType.LAST_MODIFIER:return u.default.createElement("div",{className:"dtable-ui cell-formatter-container collaborator-formatter sql-query-collaborator-formatter"},C.map((function(t,n){return t?u.default.createElement(g.default,{key:"link-".concat(l,"-").concat(n),cellValue:t,collaborators:a,context:e.context,renderEmpty:e.renderEmpty}):null})));case d.CellType.SINGLE_SELECT:var A=c&&Array.isArray(c.options)?c.options:[];return u.default.createElement(p.default,{value:C,options:A||[]});case d.CellType.FORMULA:return u.default.createElement("div",{className:o},C.map((function(e,t){return e?u.default.createElement("div",{key:"link-".concat(l,"-").concat(t),className:"row-expand-link-item"},(0,y.getCellDisplayValue)(r({},s.key,e),s,a)):null})));default:return e.renderEmpty()}}}])}(u.Component);t.default=C},1480:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTwoDimensionArrayValue=t.getFormulaArrayValue=void 0,t.isArrayFormatColumn=function(e){return[r.CellType.IMAGE,r.CellType.FILE,r.CellType.MULTIPLE_SELECT,r.CellType.COLLABORATOR].includes(e)},t.isValidCellValue=void 0;var r=n(38680),o=function(e){return void 0!==e&&(null!==e&&(""!==e&&("{}"!==JSON.stringify(e)&&"[]"!==JSON.stringify(e))))};t.isValidCellValue=o;t.getFormulaArrayValue=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Array.isArray(e)?t?e.map((function(e){if("[object Object]"!==Object.prototype.toString.call(e))return e;if(!Object.prototype.hasOwnProperty.call(e,"display_value"))return e;var t=e.display_value;return Array.isArray(t)&&0!==t.length?t.map((function(e){return"[object Object]"===Object.prototype.toString.call(e)&&Object.prototype.hasOwnProperty.call(e,"display_value")?e.display_value:e})):t})).flat().filter((function(e){return o(e)})):a(e):[]};var a=function(e){return Array.isArray(e)?e.map((function(e){if("[object Object]"!==Object.prototype.toString.call(e))return e;if(!Object.prototype.hasOwnProperty.call(e,"display_value"))return e;var t=e.display_value;return Array.isArray(t)&&0!==t.length?t.map((function(e){return"[object Object]"===Object.prototype.toString.call(e)&&Object.prototype.hasOwnProperty.call(e,"display_value")?e.display_value:e})):t})):[]};t.getTwoDimensionArrayValue=a},24115:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCellDisplayValue=void 0;var r=n(96795),o=[r.CellType.TEXT,r.CellType.NUMBER,r.CellType.DATE,r.CellType.COLLABORATOR,r.CellType.CREATOR,r.CellType.AUTO_NUMBER];t.getCellDisplayValue=function(e,t,n){if(!t||!o.includes(t.type))return"";var a=t.key,i=t.type,s=t.data;return(0,r.getCellValueDisplayString)(e,i,a,{data:s,collaborators:n,geolocationHyphen:" "})}},26011:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(n(98201)),c=s(n(28414));n(52029);var u=function(e){function t(){var e;return r(this,t),(e=a(this,t,arguments)).getRateList=function(){for(var t=e.props,n=t.data,r=t.value,o=n||{},a=o.rate_max_number,i=void 0===a?5:a,s=o.rate_style_color,c=void 0===s?"#e5e5e5":s,u=o.rate_style_type,d=void 0===u?"dtable-icon-rate":u,p=[],f=0;f<i;f++){var h={color:r>=f+1?c:"#e5e5e5"};p.push(l.default.createElement("i",{key:"dtable-ui-component-rate-".concat(f),className:"dtable-font ".concat(d),style:h}))}return p},e}return i(t,e),o(t,[{key:"render",value:function(){var e=this.props.containerClassName,t=(0,c.default)("dtable-ui cell-formatter-container rate-formatter",e),n=this.getRateList();return l.default.createElement("div",{className:t},n)}}])}(l.default.Component);u.defaultProps={value:"",containerClassName:""};t.default=u},71140:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(n(98201)),c=s(n(28414)),u=s(n(63561)),d=n(37151);n(29244);var p=function(e){function t(){var e;return r(this,t),(e=a(this,t,arguments)).onOpenUrlLink=function(){var t=e.props.value,n=(0,d.getTrimmedString)(t),r=(0,d.isValidUrl)(n)?n:"http://".concat(n);try{var o=document.createElement("a");document.body.appendChild(o),o.href=r,o.target="_blank",o.rel="noopener noreferrer",o.click(),document.body.removeChild(o)}catch(a){u.default.danger("The url is invalid")}},e}return i(t,e),o(t,[{key:"render",value:function(){var e=this.props,t=e.containerClassName,n=e.value,r=(0,c.default)("dtable-ui cell-formatter-container url-formatter",t);return l.default.createElement("div",{className:r},l.default.createElement("span",{className:"url-formatter-value text-truncate"},n),(0,d.getTrimmedString)(n)&&l.default.createElement("span",{className:"dtable-font dtable-icon-url row-expand-jump-link",onClick:this.onOpenUrlLink}))}}])}(l.default.Component);t.default=p},34926:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default,l=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(98201)),u=s(n(70446)),d=n(61779),p=s(n(73490)),f=n(60979);n(94298);var h=function(e){function t(e){var n;r(this,t),(n=a(this,t,[e])).onMouseDown=function(e){n.editorContainer===e.target||n.editorContainer.contains(e.target)||n.onClosePopover()},n.formatOption=function(){var e=n.state.newValue;return n.options.find((function(t){return t.name===e}))},n.onAddOptionToggle=function(e){if(e.nativeEvent.stopImmediatePropagation(),e.stopPropagation(),!n.props.isReadOnly){var t=!n.state.isPopoverShow;if(t){var r=n.caculatePopoverPosition();n.setState({isPopoverShow:t,popoverPosition:r})}else n.setState({isPopoverShow:t})}},n.onCommit=function(e){var t={};t[n.props.column.name]=e,n.props.onCommit(t)},n.onOptionItemToggle=function(e){var t=n.state.newValue===e.name?"":e.name;n.setState({newValue:t},(function(){n.onCommit(t),n.onClosePopover()}))},n.caculatePopoverPosition=function(){var e=window.innerHeight,t=n.editor.getClientRects()[0],r=t.top,o=t.height,a={top:o+1,left:0};e-(r+o)>200||(a={bottom:o+1,left:0});return a},n.onAddNewOption=function(e){n.props.onAddNewOption(e),n.onClosePopover()},n.onClosePopover=function(){n.setState({isPopoverShow:!1})},n.setEditorContainerRef=function(e){n.editorContainer=e},n.setEditorRef=function(e){n.editor=e},n.state={newValue:e.value,isPopoverShow:!1,popoverPosition:{}};var o=n.props.column;return n.options=o.data&&(o.data.options||[]),n}return i(t,e),o(t,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.onMouseDown)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.onMouseDown)}},{key:"render",value:function(){var e=this.state,t=e.isPopoverShow,n=e.popoverPosition,r=this.formatOption(),o=this.options,a=r?[r]:[];return c.default.createElement("div",{ref:this.setEditorContainerRef,className:"dtable-ui-single-select-editor"},c.default.createElement("div",{ref:this.setEditorRef,className:r?"":"d-inline-block",onClick:this.onAddOptionToggle},r?c.default.createElement("div",{className:"dtable-ui-single-select-option-container"},c.default.createElement(f.SelectEditorOption,{option:r})):c.default.createElement(p.default,{text:(0,d.getLocale)("Add_an_option")})),t&&c.default.createElement(c.Fragment,null,c.default.createElement(u.default,{query:"(min-width: 768px)"},c.default.createElement(f.PCSelectEditorPopover,{popoverPosition:n,options:o,selectedOptions:a,onOptionItemToggle:this.onOptionItemToggle,isSupportNewOption:this.props.isSupportNewOption,onAddNewOption:this.onAddNewOption})),c.default.createElement(u.default,{query:"(max-width: 767.8px)"},c.default.createElement(f.MBSelectEditorPopover,{isReadOnly:this.props.isReadOnly,value:[this.state.newValue],column:this.props.column,options:o,onOptionItemToggle:this.onOptionItemToggle,isShowRemoveIcon:!0,isSupportNewOption:this.props.isSupportNewOption,onAddNewOption:this.onAddNewOption,onClosePopover:this.onClosePopover}))))}}])}(c.default.Component);h.defaultProps={isReadOnly:!1,value:""};t.default=h},81625:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(n(98201)),c=s(n(75168)),u=n(48843),d=function(e){function t(e){var n;return r(this,t),(n=a(this,t,[e])).onCommit=function(){var e={},t=n.props.column,r=n.state.newValue;e[t.name]=r?r.trim():"",n.props.onCommit(e)},n.onBlur=function(){n.onCommit()},n.onChange=function(e){var t=e.target.value;n.setState({newValue:t})},n.onKeyDown=function(e){var t=e.currentTarget,n=t.selectionStart,r=t.selectionEnd,o=t.value;(0,c.default)("enter",e)?(e.preventDefault(),e.target.blur()):(37===e.keyCode&&0===n||39===e.keyCode&&r===o.length)&&e.stopPropagation()},n.onPaste=function(e){e.stopPropagation()},n.onCut=function(e){e.stopPropagation()},n.setInputRef=function(e){n.input=e},n.state={newValue:e.value},n}return i(t,e),o(t,[{key:"render",value:function(){var e=this.props.isReadOnly;return l.default.createElement(u.Input,{ref:this.setInputRef,type:"text",value:this.state.newValue,readOnly:e,onChange:this.onChange,onKeyDown:this.onKeyDown,onBlur:this.onBlur,onCut:this.onCut,onPaste:this.onPaste})}}])}(l.default.Component);d.defaultProps={isReadOnly:!1,value:""};t.default=d},49015:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(n(98201)),c=s(n(33162)),u=n(61779);n(36917);var d=function(e){function t(){var e;return r(this,t),(e=a(this,t,arguments)).onMouseDown=function(t){e.tipContainer&&!e.tipContainer.contains(t.target)&&e.props.toggle()},e}return i(t,e),o(t,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.onMouseDown)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.onMouseDown)}},{key:"render",value:function(){var e=this,t=this.props,n=t.toggle,r=t.onDelete,o=t.position,a=t.deleteTip;return l.default.createElement(c.default,null,l.default.createElement("div",{ref:function(t){return e.tipContainer=t},className:"dtable-tip tip-container",style:{top:o.top,left:o.left},onClick:function(e){return e.stopPropagation()}},l.default.createElement("b",{className:"mb-4"},a),l.default.createElement("div",{className:"d-flex justify-content-end"},l.default.createElement("button",{className:"btn btn-secondary mr-2",onClick:n},(0,u.getLocale)("Cancel")),l.default.createElement("button",{className:"btn btn-primary",onClick:r},(0,u.getLocale)("Delete")))))}}])}(l.default.Component);t.default=d},88053:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useClickOutside=void 0;var r=n(98201);t.useClickOutside=function(e,t){var n=e.currDOM,o=e.onClickOutside;(0,r.useEffect)((function(){var e=function(e){n&&e&&n.contains(e.target)||o&&o(e)};return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}}),t||[])}},44110:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"Rh",{enumerable:!0,get:function(){return a.default}});var o=r(n(63561)),a=r(n(2129)),i=n(61779),s=r(n(28624)),l=r(n(8638)),c=r(n(27812)),u=r(n(15882)),d=r(n(79127)),p=r(n(90251)),f=r(n(67376)),h=r(n(48841)),m=r(n(34627)),g=r(n(72403)),v=r(n(36352)),y=r(n(99155)),C=r(n(43349)),A=r(n(77013)),x=r(n(69216)),b=r(n(49159)),_=r(n(82663)),w=r(n(26815)),S=r(n(63845)),D=r(n(31642)),E=r(n(84493)),k=r(n(61875)),M=r(n(86821)),I=r(n(18055)),N=r(n(57818)),P=r(n(35012)),T=r(n(54124)),O=r(n(24102)),j=r(n(73125)),R=r(n(21294)),L=r(n(96839)),F=r(n(83440)),U=r(n(93245)),Y=r(n(26011)),B=r(n(65147)),H=r(n(71140)),V=r(n(67457)),G=r(n(97113)),q=r(n(81625)),z=r(n(68475)),W=r(n(4139)),K=r(n(34926)),Z=r(n(66986)),X=r(n(71970)),$=r(n(64386)),J=r(n(50194)),Q=r(n(78036)),ee=r(n(76994)),te=r(n(8871)),ne=r(n(24629)),re=r(n(96991)),oe=r(n(14471)),ae=r(n(39791)),ie=r(n(15462)),se=r(n(30886)),le=r(n(71449)),ce=r(n(94848)),ue=r(n(40714)),de=r(n(61216)),pe=r(n(91799)),fe=r(n(93355)),he=r(n(16615)),me=r(n(35376)),ge=r(n(98581)),ve=r(n(5081)),ye=r(n(80749))},61779:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.getLocale=_,t.getMobileDatePickerLocale=function(){return{DatePickerLocale:{year:_("Year"),month:_("Month"),day:_("Day"),hour:_("Hour"),minute:_("Minute")},okText:_("Done"),dismissText:_("Cancel")}},t.setLocale=function(e){b=A[x="string"===typeof e?e:x]},t.substitute=function(e,t){if("string"===typeof e)return e.indexOf("{")<0?e:e.replace(/\\?\{([^{}]+)\}/g,(function(e,n){return"\\"===e.charAt(0)?e.slice(1):null===t[n]||void 0===t[n]?"":t[n]}));if("function"===typeof e){var n=e(t);return n===t&&"object"===typeof n&&(n=Object.assign({},t)),n}return""},t.translateCalendar=function(){var e;switch(x||"en"){case"zh-cn":e=d;break;case"zh-tw":e=p;break;case"en":default:e=f;break;case"fr":e=h;break;case"de":e=m;break;case"es":case"es-ar":case"es-mx":e=g;break;case"pl":e=v;break;case"cs":e=y;break;case"ru":e=C}return e};var o=r(n(19016)),a=r(n(98704)),i=r(n(80175)),s=r(n(73875)),l=r(n(49474)),c=r(n(4411)),u=r(n(89907)),d=n(16519),p=n(37167),f=n(68977),h=n(30148),m=n(21230),g=n(96720),v=n(75520),y=n(12275),C=n(18806),A={de:o.default,en:a.default,fr:i.default,pt:s.default,ru:l.default,es:c.default,"zh-cn":u.default},x="en",b=A[x];function _(e,t){return e?b[e]?b[e]:t||e:t}},19016:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={Add_an_option:"F\xfcgen Sie eine Option hinzu",Search_option:"Finden Sie eine Option",No_options_available:"Es sind keine Optionen verf\xfcgbar.",Current_option:"Aktuelle Option",No_option:"Keine Option",Choose_an_option:"W\xe4hle eine Option",Add_a_collaborator:"F\xfcgen Sie einen Mitarbeiter hinzu",Search_collaborator:"Mitarbeiter suchen",No_collaborators_available:"Es sind keine Mitarbeiter verf\xfcgbar.",Done:"Erledigt",Choose_a_collaborator:"W\xe4hlen Sie einen Mitarbeiter",Please_input:"Bitte eingeben",Please_select:"Ausw\xe4hlen",Clear:"Leeren",Are_you_sure_you_want_to_delete_this_file:"M\xf6chten Sie diese Datei wirklich l\xf6schen?",Are_you_sure_you_want_to_delete_this_image:"M\xf6chten Sie das Bild wirklich l\xf6schen?",Cancel:"Abbrechen",Delete:"L\xf6schen",Search_department:"Bereich suchen",No_departments_available:"Es sind keine Departments verf\xfcgbar.",Current_user_department:"Department des aktuellen Benutzers",Current_user_department_and_sub:"Bereich und Unterbereiche des aktuellen Benutzers",Specific_departments:"Bestimmte Bereiche",Deleted_department:"Der Bereich wurde gel\xf6scht.",Add_filter:"Filter hinzuf\xfcgen",No_filters:"Keine Filter",Submit:"Abschicken",Select_an_option:"Option ausw\xe4hlen",Add_collaborator:"Mitarbeiter hinzuf\xfcgen",Add_a_creator:"Mitarbeiter hinzuf\xfcgen",Add_a_last_modifier:"Letzten Bearbeiter hinzuf\xfcgen",Invalid_filter:"Ung\xfcltiger Filter",Search_column:"Spalte suchen",No_results:"Keine Ergebnisse","Select_option(s)":"Option(en) ausw\xe4hlen",contains:"enth\xe4lt",does_not_contain:"enth\xe4lt nicht",is:"ist gleich",is_not:"ist ungleich",equal:"=",not_equal:"\u2260",less:"<",greater:">",less_or_equal:"\u2264",greater_or_equal:"\u2265",is_empty:"ist leer",is_not_empty:"ist nicht leer",is_within:"ist innerhalb",is_before:"ist vor",is_after:"ist nach",is_on_or_before:"ist am oder vor",is_on_or_after:"ist am oder nach",has_any_of:"enth\xe4lt einen von",has_all_of:"enth\xe4lt alle",has_none_of:"enth\xe4lt nicht",is_exactly:"ist genau",is_current_user_ID:"Ist ID des angemeldeten Benutzers",Current_date:"Aktuelles Datum",Specific_date:"Bestimmtes Datum",x_days_before_current_date:"Tage vor dem aktuellen Datum",x_days_after_current_date:"Tage nach dem aktuellen Datum",is_any_of:"ist eine von",is_none_of:"ist nicht",include_me:"Aktuellen Benutzer inkludieren",today:"Heute",tomorrow:"Morgen",yesterday:"Gestern",one_week_ago:"Vor einer Woche",one_week_from_now:"In einer Woche",one_month_ago:"Vor einem Monat",one_month_from_now:"In einem Monat",number_of_days_ago:"Tage vor Heute",number_of_days_from_now:"Tage von Heute",exact_date:"Exaktes Datum",the_past_week:"letzte Woche",the_past_month:"letzten Monat",the_past_year:"letztes Jahr",the_next_week:"In n\xe4chster Woche",the_next_month:"Im n\xe4chsten Monat",the_next_year:"Im n\xe4chsten Jahr",the_next_numbers_of_days:"Innerhalb der n\xe4chsten x Tage",the_past_numbers_of_days:"Innerhalb der letzten x Tage",this_week:"Diese Woche",this_month:"Diesen Monat",this_year:"Dieses Jahr",last_week:"letzte Woche",last_month:"letzten Monat",last_year:"letztes Jahr",URL_is_invalid:"Die URL ist ung\xfcltig.",Select_department:"Bereich ausw\xe4hlen",Default:"Standard",Custom:"Benutzerdefiniert",Recently_used:"K\xfcrzlich benutzt"}},98704:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={Add_an_option:"Add an option",Search_option:"Search option",No_options_available:"No options available",Current_option:"Current option",No_option:"No option",Choose_an_option:"Choose an option",Add_a_collaborator:"Add a collaborator",Search_collaborator:"Search collaborator",No_collaborators_available:"No collaborators available",Done:"Done",Choose_a_collaborator:"Choose a collaborator",Please_input:"Please input",Please_select:"Please select",Clear:"Clear",Are_you_sure_you_want_to_delete_this_file:"Are you sure you want to delete this file?",Are_you_sure_you_want_to_delete_this_image:"Are you sure you want to delete this image?",Cancel:"Cancel",Delete:"Delete",Search_department:"Search department",No_departments_available:"No departments available",Current_user_department:'Current user"s department',Current_user_department_and_sub:'Current user"s department and sub-departments',Specific_departments:"Specific departments",Deleted_department:"Deleted department",Add_filter:"Add filter",Submit:"Submit",No_filters:"No filters",Select_an_option:"Select an option",Add_collaborator:"Add collaborator",Add_a_creator:"Add a creator",Add_a_last_modifier:"Add a last modifier",Invalid_filter:"Invalid filter",Search_column:"Search column",No_results:"No results","Select_option(s)":"Select option(s)",contains:"contains",does_not_contain:"does not contain",is:"is",is_not:"is not",equal:"=",not_equal:"\u2260",less:"<",greater:">",less_or_equal:"\u2264",greater_or_equal:"\u2265",is_empty:"is empty",is_not_empty:"is not empty",is_within:"is within",is_before:"is before",is_after:"is after",is_on_or_before:"is on or before",is_on_or_after:"is on or after",has_any_of:"has any of",has_all_of:"has all of",has_none_of:"has none of",is_exactly:"is exactly",is_current_user_ID:"is current user's ID",Current_date:"Current date",Specific_date:"Specific date",x_days_before_current_date:"x days before current date",x_days_after_current_date:"x days after current date",is_any_of:"is any of",is_none_of:"is none of",include_me:"include the current user",today:"today",tomorrow:"tomorrow",yesterday:"yesterday",one_week_ago:"one week ago",one_week_from_now:"one week from now",one_month_ago:"one month ago",one_month_from_now:"one month from now",number_of_days_ago:"number of days ago",number_of_days_from_now:"number of days from now",exact_date:"exact date",the_past_week:"last week",the_past_month:"last month",the_past_year:"last year",the_next_week:"the next week",the_next_month:"the next month",the_next_year:"the next year",the_next_numbers_of_days:"the next numbers of days",the_past_numbers_of_days:"the past numbers of days",this_week:"this week",this_month:"this month",this_year:"this year",last_week:"last week",last_month:"last month",last_year:"last year",URL_is_invalid:"URL is invalid",Select_department:"Select department",Default:"Default",Custom:"Custom",Recently_used:"Recently used"}},4411:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={Add_an_option:"Add an option",Search_option:"Search option",No_options_available:" No hay opciones disponibles",Current_option:"Opci\xf3n actual",No_option:"Sin opciones",Choose_an_option:"Choose an option",Add_a_collaborator:"A\xf1adir a colaborador",Search_collaborator:"Encuentra un colaborador",No_collaborators_available:"No hay colaboradores disponibles.",Done:"Hecho",Choose_a_collaborator:"Choose a collaborator",Please_input:"Please input",Please_select:"Please select",Clear:"Limpiar",Are_you_sure_you_want_to_delete_this_image:"\xbfSeguro que deseas borrar esta imagen?",Are_you_sure_you_want_to_delete_this_file:"\xbfEst\xe1 seguro de querer eliminar este archivo?",Cancel:"Cancelar",Delete:"Borrar",Search_department:"Search department",No_departments_available:"No departments available",Current_user_department:"Current user's department",Current_user_department_and_sub:"Current user's department and sub-departments",Specific_departments:"Specific departments",Deleted_department:"Deleted department",Add_filter:"A\xf1adir filtro",Submit:"Enviar",No_filters:"Sin filtros",Select_an_option:"Elige una opci\xf3n",Add_collaborator:"A\xf1adir colaborador",Add_a_creator:"A\xf1adir un creador",Add_a_last_modifier:"A\xf1adir un \xfaltimo en modificar",Invalid_filter:"Filtro inv\xe1lido",Search_column:"Search column",No_results:"Sin resultados.","Select_option(s)":"Elegir opci\xf3n(es)",contains:"contiene",does_not_contain:"no contiene",is:"es",is_not:"no es",equal:"=",not_equal:"\u2260",less:"<",greater:">",less_or_equal:"\u2264",greater_or_equal:"\u2265",is_empty:"est\xe1 en blanco",is_not_empty:"no est\xe1 en blanco",is_within:"es entre",is_before:"es previo a",is_after:"es posterior a",is_on_or_before:"es en o antes de",is_on_or_after:"es en o despu\xe9s de",has_any_of:"tiene al menos uno de",has_all_of:"tiene todos de",has_none_of:"no tiene ninguno de",is_exactly:"es exactamente",is_current_user_ID:"es el ID del usuario actual",Current_date:"Fecha actual",Specific_date:"Fecha espec\xedfica",x_days_before_current_date:"x d\xedas antes de hoy",x_days_after_current_date:"x d\xedas despu\xe9s de hoy",is_any_of:"es al menos uno de",is_none_of:"no es ninguno de",include_me:"incluir el usuario actual",today:"hoy",tomorrow:"ma\xf1ana",yesterday:"ayer",one_week_ago:"hace una semana",one_week_from_now:"una semana desde ahora",one_month_ago:"hace un mes",one_month_from_now:"un mes desde ahora",number_of_days_ago:"hace tantos d\xedas",number_of_days_from_now:"tantos d\xedas desde ahora",exact_date:"fecha exacta",the_past_week:"la semana pasada",the_past_month:"el mes pasado",the_past_year:"el a\xf1o pasado",the_next_week:"la pr\xf3xima semana",the_next_month:"el pr\xf3ximo mes",the_next_year:"el pr\xf3ximo a\xf1o",the_next_numbers_of_days:"pasados estos d\xedas",the_past_numbers_of_days:"en los \xfaltimos d\xedas",this_week:"esta semana",this_month:"este mes",this_year:"este a\xf1o",last_week:"la semana pasada",last_month:"el mes pasado",last_year:"el a\xf1o pasado",URL_is_invalid:"URL no v\xe1lida",Select_department:"Select department",Default:"Incumplimiento de contrato",Custom:"Costumbres",Recently_used:"Recientemente usado"}},80175:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={Add_an_option:"Ajouter une option",Search_option:"Trouver une option",No_options_available:"Il n'y a pas d'options disponibles.",Current_option:"Option actuelle",No_option:"Aucune option",Choose_an_option:"Choisis une option",Add_a_collaborator:"Ajouter un collaborateur",Search_collaborator:"Trouver un collaborateur",No_collaborators_available:"Aucun collaborateur n'est disponible.",Done:"Fait",Choose_a_collaborator:"Choisissez un collaborateur",Please_input:"Veuillez saisir",Please_select:"Veuillez s\xe9lectionner",Clear:"Effacer",Are_you_sure_you_want_to_delete_this_image:"\xcates-vous s\xfbr de vouloir supprimer cette image?",Are_you_sure_you_want_to_delete_this_file:"\xcates-vous s\xfbr de vouloir supprimer ce fichier?",Cancel:"Annuler",Delete:"Supprimer",Search_department:"Chercher un d\xe9partement",No_departments_available:"Aucun d\xe9partement n'est disponible.",Current_user_department:"D\xe9partement de l'utilisateur actuel",Current_user_department_and_sub:"D\xe9partement et sous-d\xe9partements de l'utilisateur actuel",Specific_departments:"D\xe9partements sp\xe9cifiques",Deleted_department:"Le d\xe9partement a \xe9t\xe9 supprim\xe9.",Add_filter:"Ajouter un filtre",No_filters:"Aucun filtre",Submit:"Soumettre",Select_an_option:"S\xe9lectionner une option",Add_collaborator:"Ajouter un collaborateur",Add_a_creator:"Ajouter un cr\xe9ateur",Add_a_last_modifier:"Ajouter un dernier \xe9diteur",Invalid_filter:"Filtre invalide",Search_column:"Rechercher une colonne",No_results:"Aucun r\xe9sultat","Select_option(s)":"Selectionner une ou plusieurs options",contains:"contient",does_not_contain:"ne contient pas",is:"est \xe9gale \xe0",is_not:"est diff\xe9rente de",equal:"=",not_equal:"\u2260",less:"<",greater:">",less_or_equal:"\u2264",greater_or_equal:"\u2265",is_empty:"est vide",is_not_empty:"n'est pas vide",is_within:"est pendant",is_before:"est avant",is_after:"est apr\xe8s",is_on_or_before:"est le ou avant",is_on_or_after:"est le ou apr\xe8s",has_any_of:"contient au moins un",has_all_of:"contient tout",has_none_of:"ne contient aucun",is_exactly:"est exactement",is_current_user_ID:"est l'ID de l'utilisateur connect\xe9",Current_date:"Date actuelle",Specific_date:"Date sp\xe9cifique",x_days_before_current_date:"Jour avant la date actuelle",x_days_after_current_date:"Jour apr\xe8s la data actuelle",is_any_of:"contient au moins un",is_none_of:"ne contient aucun",include_me:" Inclure l'utilisateur actuel",today:"aujourd'hui",tomorrow:"demain",yesterday:"hier",one_week_ago:"il y a une semaine",one_week_from_now:"dans une semaine",one_month_ago:"il y a un mois",one_month_from_now:"dans un mois",number_of_days_ago:"il y a tels jours",number_of_days_from_now:"dans tels jours",exact_date:"date exacte",the_past_week:"la semaine derni\xe8re",the_past_month:"le mois dernier",the_past_year:"l'ann\xe9e derni\xe8re",the_next_week:"la semaine prochaine",the_next_month:"le mois prochain",the_next_year:"l'ann\xe9e prochaine",the_next_numbers_of_days:"au cours de tels prochains jours",the_past_numbers_of_days:"au cours de tels derniers jours",this_week:"cette semaine",this_month:"ce mois",this_year:"cette ann\xe9e",last_week:"la semaine derni\xe8re",last_month:"le mois dernier",last_year:"l'ann\xe9e derni\xe8re",URL_is_invalid:"L'URL est invalide.",Select_department:"S\xe9lectionner un d\xe9partement",Default:"Violation",Custom:"Les coutumes",Recently_used:"Utilis\xe9 r\xe9cemment"}},73875:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={Add_an_option:"Adicione uma op\xe7\xe3o",Search_option:"Encontre uma op\xe7\xe3o",No_options_available:"Sem op\xe7\xf5es dispon\xedveis",Current_option:"Op\xe7\xe3o atual",No_option:"Nenhuma op\xe7\xe3o",Choose_an_option:"Escolha uma op\xe7\xe3o",Add_a_collaborator:"Adicionar um colaborador",Search_collaborator:"Encontre um colaborador",No_collaborators_available:"Nenhum colaborador dispon\xedvel.",Done:"Feita",Choose_a_collaborator:"Choose a collaborator",Please_input:"Please input",Please_select:"Please select",Clear:"Clara",Are_you_sure_you_want_to_delete_this_image:"Tem certeza de que deseja apagar esta imagem?",Are_you_sure_you_want_to_delete_this_file:"Tem certeza de que deseja excluir este arquivo?",Cancel:"Cancelar",Delete:"Excluir",Search_department:"Search department",No_departments_available:"No departments available",Current_user_department:"Current user's department",Current_user_department_and_sub:"Current user's department and sub-departments",Specific_departments:"Specific departments",Deleted_department:"Deleted department",Add_filter:"Adicione o filtro",Submit:"Enviar",No_filters:"Sem filtros",Select_an_option:"Selecione uma op\xe7\xe3o",Add_collaborator:"Adicione o colaborador",Add_a_creator:"Adicione um Criador",Add_a_last_modifier:"Adicione um \xfaltimo modificador",Invalid_filter:"Filtro inv\xe1lido",Search_column:"Encontrar coluna",No_results:"Sem resultados.","Select_option(s)":"Selecione as op\xe7\xf5es)",contains:"cont\xe9m",does_not_contain:"n\xe3o cont\xe9m",is:"\xe9",is_not:"n\xe3o \xe9",equal:"=",not_equal:"\u2260",less:"<",greater:">",less_or_equal:"\u2264",greater_or_equal:"\u2265",is_empty:"est\xe1 vazia",is_not_empty:"n\xe3o est\xe1 vazio",is_within:"est\xe1 dentro",is_before:"\xe9 antes",is_after:"\xe9 depois",is_on_or_before:"est\xe1 ligado ou antes",is_on_or_after:"est\xe1 ligado ou depois",has_any_of:"tem qualquer um",has_all_of:"tem tudo de",has_none_of:"n\xe3o tem nenhum",is_exactly:"\xe9 exatamente",is_current_user_ID:"\xe9 o ID do usu\xe1rio atual",Current_date:"Data atua",Specific_date:"Espec\xedfico",x_days_before_current_date:"x dias antes da data atual",x_days_after_current_date:"x dias ap\xf3s a data atual",is_any_of:"\xe9 qualquer um",is_none_of:"n\xe3o \xe9 nenhum",include_me:"incluir o usu\xe1rio atual",today:"hoje",tomorrow:"amanh\xe3",yesterday:"ontem",one_week_ago:"uma semana atr\xe1s",one_week_from_now:"daqui a uma semana",one_month_ago:"um m\xeas atr\xe1s",one_month_from_now:"um m\xeas atr\xe1s",number_of_days_ago:"n\xfamero de dias atr\xe1s",number_of_days_from_now:"n\xfamero de dias a partir de agora",exact_date:"data exata",the_past_week:"semana anterior",the_past_month:"m\xeas passado",the_past_year:"ano passado",the_next_week:"a pr\xf3xima semana",the_next_month:"o pr\xf3ximo m\xeas",the_next_year:"no pr\xf3ximo ano",the_next_numbers_of_days:"os pr\xf3ximos n\xfameros de dias",the_past_numbers_of_days:"os \xfaltimos n\xfameros de dias",this_week:"essa semana",this_month:"este m\xeas",this_year:"este ano",last_week:"semana anterior",last_month:"m\xeas passado",last_year:"ano passado",URL_is_invalid:"URL \xe9 inv\xe1lido",Select_department:"Select department",Default:"por omiss\xe3o",Custom:"personalizado",Recently_used:"usado recentemente"}},49474:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={Add_an_option:"Add an option",Search_option:"Search option",No_options_available:"\u041d\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u043e\u0432.",Current_option:"\u0422\u0435\u043a\u0443\u0449\u0430\u044f \u043e\u043f\u0446\u0438\u044f",No_option:"\u041d\u0435\u0442 \u043e\u043f\u0446\u0438\u0439",Choose_an_option:"Choose an option",Add_a_collaborator:"Add a collaborator",Search_collaborator:"\u041d\u0430\u0439\u0442\u0438 \u0441\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u043a\u043e\u0432",No_collaborators_available:"\u041d\u0435\u0442 \u0441\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u043a\u043e\u0432.",Done:"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e",Choose_a_collaborator:"Choose a collaborator",Please_input:"Please input",Please_select:"Please select",Clear:"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c",Are_you_sure_you_want_to_delete_this_image:"Are you sure you want to delete this image?",Are_you_sure_you_want_to_delete_this_file:"Are you sure you want to delete this file?",Cancel:"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c",Delete:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",Search_department:"Search department",No_departments_available:"No departments available",Current_user_department:"Current user's department",Current_user_department_and_sub:"Current user's department and sub-departments",Specific_departments:"Specific departments",Deleted_department:"Deleted department",Add_filter:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0444\u0438\u043b\u044c\u0442\u0440",Submit:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",No_filters:"No filters",Select_an_option:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043e\u043f\u0446\u0438\u044e",Add_collaborator:"Add collaborator",Add_a_creator:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u043e\u0437\u0434\u0430\u0442\u0435\u043b\u044f",Add_a_last_modifier:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0439 \u0438\u0437\u043c\u0435\u043d\u0438\u0432\u0448\u0438\u0439",Invalid_filter:"Invalid filter",Search_column:"Search column",No_results:"\u041d\u0435\u0442 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u0432.","Select_option(s)":"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043e\u043f\u0446\u0438\u044e(\u0438)",contains:"\u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442",does_not_contain:"\u043d\u0435 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442",is:"\u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f",is_not:"\u043d\u0435 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f",equal:"=",not_equal:"\u2260",less:"<",greater:">",less_or_equal:"\u2264",greater_or_equal:"\u2265",is_empty:"\u043f\u0443\u0441\u0442\u043e",is_not_empty:"\u043d\u0435 \u043f\u0443\u0441\u0442\u043e",include_me:"\u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",is_within:"\u0432\u043d\u0443\u0442\u0440\u0438...",is_before:"\u0440\u0430\u043d\u044c\u0448\u0435 ...",is_after:"\u043f\u043e\u0441\u043b\u0435 ...",is_on_or_before:"\u0441\u0435\u0439\u0447\u0430\u0441 \u0438\u043b\u0438 \u0440\u0430\u043d\u044c\u0448\u0435 ...",is_on_or_after:"\u0441\u0435\u0439\u0447\u0430\u0441 \u0438\u043b\u0438 \u043f\u043e\u0441\u043b\u0435 ...",has_any_of:"\u0438\u043c\u0435\u0435\u0442 \u043a\u0430\u043a\u043e\u0439-\u043b\u0438\u0431\u043e \u0438\u0437 ...",has_all_of:"\u0435\u0441\u0442\u044c \u0432\u0441\u0435 ...",has_none_of:"\u043d\u0435 \u0438\u043c\u0435\u0435\u0442 \u043d\u0438 \u043e\u0434\u043d\u043e\u0433\u043e \u0438\u0437 \u043d\u0438\u0445...",is_exactly:"\u0442\u043e\u0447\u043d\u043e ...",is_current_user_ID:"\u044d\u0442\u043e \u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440 \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",Current_date:"Current date",Specific_date:"Specific date",x_days_before_current_date:"X days before current date",x_days_after_current_date:"X days after current date",is_any_of:"\u043b\u044e\u0431\u043e\u0439 \u0438\u0437 ...",is_none_of:"\u043a\u0440\u043e\u043c\u0435 ...",today:"\u0421\u0435\u0433\u043e\u0434\u043d\u044f",tomorrow:"\u0437\u0430\u0432\u0442\u0440\u0430",yesterday:"\u0432\u0447\u0435\u0440\u0430",one_week_ago:"\u043d\u0435\u0434\u0435\u043b\u044e \u043d\u0430\u0437\u0430\u0434",one_week_from_now:"\u0447\u0435\u0440\u0435\u0437 \u043d\u0435\u0434\u0435\u043b\u044e",one_month_ago:"\u043c\u0435\u0441\u044f\u0446 \u043d\u0430\u0437\u0430\u0434",one_month_from_now:"\u0447\u0435\u0440\u0435\u0437 \u043c\u0435\u0441\u044f\u0446",number_of_days_ago:"\u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0434\u043d\u0435\u0439 \u043d\u0430\u0437\u0430\u0434",number_of_days_from_now:"\u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0434\u043d\u0435\u0439 \u0441 \u044d\u0442\u043e\u0433\u043e \u043c\u043e\u043c\u0435\u043d\u0442\u0430",exact_date:"\u0442\u043e\u0447\u043d\u0430\u044f \u0434\u0430\u0442\u0430",the_past_week:"\u043f\u0440\u043e\u0448\u043b\u0430\u044f \u043d\u0435\u0434\u0435\u043b\u044f",the_past_month:"\u043f\u0440\u043e\u0448\u043b\u044b\u0439 \u043c\u0435\u0441\u044f\u0446",the_past_year:"\u043f\u0440\u043e\u0448\u043b\u044b\u0439 \u0433\u043e\u0434",the_next_week:"\u043d\u0430 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u0439 \u043d\u0435\u0434\u0435\u043b\u0435",the_next_month:"\u0432 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u043c \u043c\u0435\u0441\u044f\u0446\u0435",the_next_year:"\u0432 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u043c \u0433\u043e\u0434\u0443",the_next_numbers_of_days:"\u0447\u0435\u0440\u0435\u0437 \u0434\u043d\u0435\u0439...",the_past_numbers_of_days:"\u0434\u043e \u0434\u043d\u0435\u0439 ...",this_week:"\u043d\u0430 \u044d\u0442\u043e\u0439 \u043d\u0435\u0434\u0435\u043b\u0435",this_month:"\u0432 \u044d\u0442\u043e\u043c \u043c\u0435\u0441\u044f\u0446\u0435",this_year:"\u0432 \u044d\u0442\u043e\u043c \u0433\u043e\u0434\u0443",last_week:"last week",last_month:"last month",last_year:"last year",URL_is_invalid:"URL-\u0430\u0434\u0440\u0435\u0441 \u043d\u0435\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u0435\u043d",Select_department:"Select department",Default:"\u041d\u0430\u0440\u0443\u0448\u0435\u043d\u0438\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u0441\u0442\u0432",Custom:"\u041e\u0431\u044b\u0447\u0430\u0438",Recently_used:"\u041d\u0435\u0434\u0430\u0432\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u043d\u044b\u0439"}},89907:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={Add_an_option:"\u6dfb\u52a0\u4e00\u4e2a\u9009\u9879",Search_option:"\u67e5\u627e\u6807\u7b7e",No_options_available:"\u6ca1\u6709\u627e\u5230\u6807\u7b7e\u3002",Current_option:"\u5f53\u524d\u6807\u7b7e",No_option:"\u6ca1\u6709\u6807\u7b7e",Choose_an_option:"\u9009\u62e9\u4e00\u4e2a\u6807\u7b7e",Add_a_collaborator:"\u6dfb\u52a0\u534f\u4f5c\u8005",Search_collaborator:"\u641c\u7d22\u534f\u4f5c\u8005",No_collaborators_available:"\u6ca1\u6709\u627e\u5230\u534f\u4f5c\u8005",Done:"\u5b8c\u6210",Choose_a_collaborator:"\u9009\u62e9\u4e00\u4e2a\u534f\u4f5c\u8005",Please_input:"\u8bf7\u8f93\u5165",Please_select:"\u8bf7\u9009\u62e9",Clear:"\u6e05\u7a7a",Are_you_sure_you_want_to_delete_this_file:"\u4f60\u786e\u5b9a\u8981\u5220\u9664\u6b64\u6587\u4ef6\u5417\uff1f",Are_you_sure_you_want_to_delete_this_image:"\u4f60\u786e\u5b9a\u8981\u5220\u9664\u6b64\u56fe\u7247\u5417\uff1f",Cancel:"\u53d6\u6d88",Delete:"\u5220\u9664",Search_department:"\u67e5\u627e\u90e8\u95e8",No_departments_available:"\u6ca1\u6709\u53ef\u7528\u7684\u90e8\u95e8",Current_user_department:"\u5f53\u524d\u7528\u6237\u7684\u90e8\u95e8",Current_user_department_and_sub:"\u5f53\u524d\u7528\u6237\u7684\u90e8\u95e8\u548c\u5b50\u90e8\u95e8",Specific_departments:"\u5177\u4f53\u90e8\u95e8",Deleted_department:"\u5df2\u7ecf\u5220\u9664\u7684\u90e8\u95e8",Add_filter:"\u6dfb\u52a0\u8fc7\u6ee4",Submit:"\u63d0\u4ea4",No_filters:"\u6ca1\u6709\u8fc7\u6ee4\u6761\u4ef6",Select_an_option:"\u9009\u62e9\u6807\u7b7e",Add_collaborator:"\u6dfb\u52a0\u534f\u4f5c\u4eba",Add_a_creator:"\u589e\u52a0\u521b\u5efa\u8005",Add_a_last_modifier:"\u589e\u52a0\u6700\u540e\u4fee\u6539\u8005",Invalid_filter:"\u65e0\u6548\u7684\u8fc7\u6ee4\u5668",Search_column:"\u67e5\u627e\u5217",No_results:"\u6ca1\u6709\u7ed3\u679c","Select_option(s)":"\u9009\u62e9\u6807\u7b7e",contains:"\u5305\u542b",does_not_contain:"\u4e0d\u5305\u542b",is:"\u662f",is_not:"\u4e0d\u662f",equal:"=",not_equal:"\u2260",less:"<",greater:">",less_or_equal:"\u2264",greater_or_equal:"\u2265",is_empty:"\u662f\u7a7a",is_not_empty:"\u4e0d\u662f\u7a7a",is_within:"\u5728\u67d0\u6bb5\u65f6\u95f4\u5185",is_before:"\u5728\u67d0\u5929\u4e4b\u524d",is_after:"\u5728\u67d0\u5929\u4e4b\u540e",is_on_or_before:"\u5728\u67d0\u5929\u6216\u4e4b\u524d",is_on_or_after:"\u5728\u67d0\u5929\u6216\u4e4b\u540e",has_any_of:"\u5305\u542b\u5176\u4e2d\u4e00\u4e2a",has_all_of:"\u5305\u542b\u6240\u6709",has_none_of:"\u4e0d\u5305\u542b",is_exactly:"\u7cbe\u786e\u7b5b\u9009",is_current_user_ID:"\u662f\u5f53\u524d\u7528\u6237\u7684 ID",Current_date:"\u5f53\u524d\u65e5\u671f",Specific_date:"\u6307\u5b9a\u65e5\u671f",x_days_before_current_date:"\u5f53\u524d\u65e5\u671f\u7684\u524d X \u5929",x_days_after_current_date:"\u5f53\u524d\u65e5\u671f\u7684\u540e X \u5929",is_any_of:"\u662f\u4efb\u610f\u4e00\u4e2a...",is_none_of:"\u4e0d\u662f\u4efb\u610f\u4e00\u4e2a...",include_me:"\u5305\u62ec\u5f53\u524d\u7528\u6237",today:"\u4eca\u5929",tomorrow:"\u660e\u5929",yesterday:"\u6628\u5929",one_week_ago:"\u4e00\u5468\u524d",one_week_from_now:"\u4e00\u5468\u540e",one_month_ago:"\u4e00\u4e2a\u6708\u524d",one_month_from_now:"\u4e00\u4e2a\u6708\u540e",number_of_days_ago:"\u7279\u5b9a\u5929\u6570\u524d",number_of_days_from_now:"\u7279\u5b9a\u5929\u6570\u540e",exact_date:"\u7cbe\u786e\u65e5\u671f",the_past_week:"\u4e0a\u4e2a\u661f\u671f",the_past_month:"\u4e0a\u4e2a\u6708",the_past_year:"\u53bb\u5e74",the_next_week:"\u4e0b\u4e2a\u661f\u671f",the_next_month:"\u4e0b\u4e2a\u6708",the_next_year:"\u4e0b\u4e00\u5e74",the_next_numbers_of_days:"\u4eca\u5929\u4e4b\u540e\u7684\u6307\u5b9a\u5929\u6570",the_past_numbers_of_days:"\u4eca\u5929\u4e4b\u524d\u7684\u6307\u5b9a\u5929\u6570",this_week:"\u8fd9\u4e2a\u661f\u671f",this_month:"\u8fd9\u4e2a\u6708",this_year:"\u4eca\u5e74",last_week:"\u4e0a\u4e2a\u661f\u671f",last_month:"\u4e0a\u4e2a\u6708",last_year:"\u53bb\u5e74",URL_is_invalid:"URL \u65e0\u6548",Select_department:"\u9009\u62e9\u90e8\u95e8",Default:"\u9ed8\u8ba4",Custom:"\u81ea\u5b9a\u4e49",Recently_used:"\u6700\u8fd1\u4f7f\u7528"}},60979:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"MBSelectEditorPopover",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"PCSelectEditorPopover",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"SelectEditorOption",{enumerable:!0,get:function(){return i.default}});var o=r(n(6396)),a=r(n(84690)),i=r(n(11427))},6396:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default,l=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(98201)),u=n(61779),d=s(n(11427)),p=s(n(36720));n(94940);var f=function(e){function t(e){var n;return r(this,t),(n=a(this,t,[e])).handleHistaryBack=function(e){e.preventDefault(),n.props.onClosePopover()},n.onContainerClick=function(e){if(n.editorPopover&&n.editorPopover.contains(e.target))return e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),!1},n.onChangeSearch=function(e){var t=n.state.searchVal;t!==e.target.value&&(t=e.target.value,n.setState({searchVal:t}))},n.getSelectedOptions=function(){var e=n.props,t=e.value,r=e.options;return Array.isArray(t)?r.filter((function(e){return t.indexOf(e.id)>-1})):[]},n.getFilteredOptions=function(){var e=n.props.options,t=n.state.searchVal;return t?e.filter((function(e){return e.name.indexOf(t)>-1})):e},n.onSelectOption=function(e){n.props.onOptionItemToggle(e)},n.onAddNewOption=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation();var t=n.state.searchVal.trim();t&&(n.props.onAddNewOption(t),n.props.onClosePopover())},n.onRemoveOption=function(e){n.props.onOptionItemToggle(e)},n.renderSelectOptions=function(e){var t=n.props.value;return e.map((function(e,r){var o=t.some((function(t){return t===e.id})),a={backgroundColor:e.color,color:e.textColor||null};return c.default.createElement("div",{className:"mb-select-option-item",key:r,onMouseDown:n.onSelectOption.bind(n,e)},c.default.createElement("span",{className:"mb-select-item"},c.default.createElement("span",{className:"item-name",style:a,title:e.name},e.name)),c.default.createElement("span",{className:"mb-item-checked"},o&&c.default.createElement("i",{className:"dtable-font dtable-icon-check-mark"})))}))},n.setEditorPopover=function(e){n.editorPopover=e},n.state={searchVal:""},n}return i(t,e),o(t,[{key:"componentDidMount",value:function(){history.pushState(null,null,"#"),window.addEventListener("popstate",this.handleHistaryBack,!1)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("popstate",this.handleHistaryBack,!1)}},{key:"render",value:function(){var e=this,t=this.props,n=t.isReadOnly,r=t.column,o=t.isSupportNewOption,a=t.isShowRemoveIcon,i=this.state.searchVal,s=this.getSelectedOptions(),l=this.getFilteredOptions(),f=!n&&a,h=!n&&o&&!!i;return h&&(h=0===l.length),c.default.createElement("div",{ref:this.setEditorPopover,className:"dtable-ui-mb-editor-popover mb-select-editor-popover",style:{zIndex:99},onClick:this.onContainerClick},c.default.createElement(p.default,{title:r.name,leftContent:c.default.createElement("i",{className:"dtable-font dtable-icon-return"}),onLeftClick:this.props.onClosePopover}),c.default.createElement("div",{className:"dtable-ui-mb-editor-body dtable-ui-mb-select-editor-body"},c.default.createElement("div",{className:"mb-selected-item"},c.default.createElement("div",{className:"title"},(0,u.getLocale)("Current_option")),c.default.createElement("div",{className:"content"},0===s.length&&c.default.createElement("span",{className:"empty-placeholder"},(0,u.getLocale)("No_option")),s.length>0&&s.map((function(t){return c.default.createElement(d.default,{key:t.id,option:t,isShowRemoveIcon:f,onDeleteSelectOption:e.onRemoveOption})})))),c.default.createElement("div",{className:"mb-search-select-items"},c.default.createElement("input",{className:"form-control",type:"text",placeholder:(0,u.getLocale)("Search_option"),value:i,onChange:this.onChangeSearch,onClick:this.onInputClick})),c.default.createElement("div",{className:"mb-select-options-container"},c.default.createElement("div",{className:"title"},c.default.createElement("span",null,(0,u.getLocale)("Choose_an_option"))),c.default.createElement("div",{className:"content"},c.default.createElement(c.Fragment,null,0===l.length&&c.default.createElement("div",{className:"search-result-none"},(0,u.getLocale)("No_options_available")),l.length>0&&this.renderSelectOptions(l)))),h&&c.default.createElement("div",{className:"mb-create-select-item",onClick:this.onAddNewOption},c.default.createElement("i",{className:"dtable-font dtable-icon-add-table"}),c.default.createElement("span",{className:"dtable-ui-add-new-option"},"".concat((0,u.getLocale)("Add_an_option")," ").concat(i)))))}}])}(c.default.Component);f.defaultProps={isReadOnly:!1,isShowRemoveIcon:!1,isSupportNewOption:!1,value:[]};t.default=f},84690:function(e,t,n){"use strict";var r=n(12897).default,o=n(17383).default,a=n(34579).default,i=n(18336).default,s=n(29511).default,l=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(98201)),u=n(61779);n(57314);var d=function(e){function t(e){var n;return o(this,t),(n=i(this,t,[e])).onValueChanged=function(e){var t=e.target.value;n.setState({searchValue:t})},n.onInputClick=function(e){e.nativeEvent.stopImmediatePropagation(),e.stopPropagation()},n.onAddNewOption=function(){var e=n.state.searchValue.trim();n.props.onAddNewOption(e)},n.onOptionItemToggle=function(e){n.props.onOptionItemToggle(e)},n.getFilterOptions=function(){var e=n.props.options,t=n.state.searchValue.toLowerCase();return t?e.filter((function(e){return e.name.toString().toLowerCase().indexOf(t)>-1})):e},n.getOptionStyle=function(e){var t=e.textColor||null;return{display:"inline-block",padding:"0px 10px",height:"20px",lineHeight:"20px",borderRadius:"10px",fontSize:"13px",backgroundColor:e.color,color:t}},n.state={searchValue:""},n}return s(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.getFilterOptions(),n=this.props,o=n.popoverPosition,a=n.selectedOptions,i=n.isSupportNewOption,s=this.state.searchValue,l=Object.assign({},r({},o),{position:"absolute"});return c.default.createElement("div",{className:"dtable-ui-editor-popover dtable-ui-select-editor-popover",style:l},c.default.createElement("div",{className:"select-options-search"},c.default.createElement("input",{className:"form-control",onChange:this.onValueChanged,onClick:this.onInputClick,placeholder:(0,u.getLocale)("Search_option")})),c.default.createElement("div",{className:"select-options-container"},t.length>0&&t.map((function(t,n){var r=e.getOptionStyle(t),o=a.some((function(e){return e.id===t.id}));return c.default.createElement("div",{key:n,className:"select-option-item",onClick:e.onOptionItemToggle.bind(e,t)},c.default.createElement("div",{className:"option-info"},c.default.createElement("div",{className:"option-name",style:r,title:t.name},t.name)),c.default.createElement("div",{className:"option-checked"},o&&c.default.createElement("i",{className:"dtable-font dtable-icon-check-mark"})))})),0===t.length&&c.default.createElement("div",{className:"no-search-result"},(0,u.getLocale)("No_options_available"))),i&&!!s&&c.default.createElement("div",{className:"select-options-add",onClick:this.onAddNewOption},c.default.createElement("i",{className:"dtable-font dtable-icon-add-table"}),c.default.createElement("span",null,(0,u.getLocale)("Add_an_option")," ",s)))}}])}(c.default.Component);d.defaultProps={popoverPosition:{},options:[],isShowAddBtn:!1};t.default=d},11427:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(n(98201)),c=function(e){function t(){var e;return r(this,t),(e=a(this,t,arguments)).onDeleteOption=function(t){t.nativeEvent.stopImmediatePropagation(),t.stopPropagation(),e.props.onDeleteSelectOption(e.props.option)},e.getContainerStyle=function(){return{display:"inline-flex",justifyContent:"center",marginRight:"10px",padding:"0px 10px",height:"20px",borderRadius:"10px",fontSize:"13px",backgroundColor:e.props.option.color}},e.getOptionStyle=function(e){return{flex:1,display:"flex",alignContent:"center",margin:"0 4px 0 2px",color:e.textColor||null}},e.getOperationStyle=function(e){return{height:"20px",width:"16px",cursor:"pointer",color:"#FFFFFF"===(e.textColor||null)?"#FFFFFF":"#909090",transform:"scale(.8)"}},e}return i(t,e),o(t,[{key:"render",value:function(){var e=this.props,t=e.option,n=e.isShowRemoveIcon,r=this.getContainerStyle(),o=this.getOptionStyle(t),a=this.getOperationStyle(t);return l.default.createElement("div",{className:"dtable-ui select-option-item",style:r},l.default.createElement("div",{className:"option-info",style:o},l.default.createElement("div",{className:"option-name",title:t.name},t.name)),n&&l.default.createElement("div",{className:"option-remove",style:a,onClick:this.onDeleteOption},l.default.createElement("i",{className:"dtable-font dtable-icon-fork-number",style:{fontSize:"12px",lineHeight:"20px"}})))}}])}(l.default.Component);c.defaultProps={isShowRemoveIcon:!1};t.default=c},75972:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(n(98201)),c=function(e){function t(){return r(this,t),a(this,t,arguments)}return i(t,e),o(t,[{key:"getIconClass",value:function(e){switch(e){case"success":default:return"dtable-font dtable-icon-check-circle";case"warning":return"dtable-font dtable-icon-exclamation-triangle";case"none":case"danger":return"dtable-font dtable-icon-exclamation-circle"}}},{key:"render",value:function(){var e=this.props,t=e.intent,n=e.title,r=e.children,o=e.isRemovable,a=e.onRemove,i=this.getIconClass(t);return l.default.createElement("div",{className:"dtable-toast-alert-container ".concat(t||"success")},l.default.createElement("div",{className:"toast-alert-icon"},l.default.createElement("i",{className:i})),l.default.createElement("div",{className:"toast-text-container"},l.default.createElement("p",{className:"toast-text-title"},n),r?l.default.createElement("p",{className:"toast-text-child"},r):null),o&&l.default.createElement("div",{onClick:a,className:"toast-close"},l.default.createElement("span",null,"\xd7")))}}])}(l.default.PureComponent);t.default=c},63561:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=new(r(n(42817)).default);t.default=o},46206:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,a=n(18336).default,i=n(29511).default,s=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(n(98201)),c=s(n(29357)),u=s(n(75972)),d=function(e){function t(){var e;return r(this,t),(e=a(this,t,arguments)).state={isShown:!0,height:0},e.close=function(t){t&&(t.nativeEvent.stopImmediatePropagation(),t.stopPropagation()),e.clearCloseTimer(),e.setState({isShown:!1})},e.startCloseTimer=function(){e.props.duration&&(e.closeTimer=setTimeout((function(){e.close()}),1e3*e.props.duration))},e.clearCloseTimer=function(){e.closeTimer&&(clearTimeout(e.closeTimer),e.closeTimer=null)},e.handleMouseEnter=function(){e.clearCloseTimer()},e.handleMouseLeave=function(){e.startCloseTimer()},e.onRef=function(t){if(null!==t){var n=t.getBoundingClientRect().height;e.setState({height:n})}},e}return i(t,e),o(t,[{key:"componentDidUpdate",value:function(e){e.isShown!==this.props.isShown&&this.setState({isShown:this.props.isShown})}},{key:"componentDidMount",value:function(){this.startCloseTimer()}},{key:"componentWillUnmount",value:function(){this.clearCloseTimer()}},{key:"render",value:function(){var e=this;return l.default.createElement(c.default,{appear:!0,unmountOnExit:!0,timeout:240,in:this.state.isShown,onExited:this.props.onRemove},(function(t){return l.default.createElement("div",{"data-state":t,className:"dtable-toast-container ".concat(t),onMouseEnter:e.handleMouseEnter,onMouseLeave:e.handleMouseLeave,style:{height:e.state.height,zIndex:e.props.zIndex,marginBottom:e.state.isShown?0:-e.state.height}},l.default.createElement("div",{ref:e.onRef,style:{padding:8}},l.default.createElement(u.default,{intent:e.props.intent,title:e.props.title,children:e.props.children||"",isRemovable:e.props.hasCloseButton,onRemove:function(t){return e.close(t)}})))}))}}])}(l.default.PureComponent);t.default=d,d.defaultProps={intent:"none"}},54675:function(e,t,n){"use strict";var r=n(91847).default,o=n(12897).default,a=n(41132).default,i=n(50883).default,s=n(17383).default,l=n(34579).default,c=n(18336).default,u=n(29511).default,d=["id","description"],p=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var f=p(n(98201)),h=p(n(46206)),m=function(e){return Object.hasOwnProperty.call(e,"id")},g=function(e){function t(e,n){var r;return s(this,t),(r=c(this,t,[e,n])).getToasts=function(){return r.state.toasts},r.closeAll=function(){r.getToasts().forEach((function(e){return e.close()}))},r.notify=function(e,t){if(m(t)){var n,o=i(r.state.toasts);try{for(o.s();!(n=o.n()).done;){var s=n.value;String(s.id).startsWith(t.id)&&r.closeToast(s.id)}}catch(c){o.e(c)}finally{o.f()}}var l=r.createToastInstance(e,t);return r.setState((function(e){return{toasts:[l].concat(a(e.toasts))}})),l},r.createToastInstance=function(e,n){var o=++t.idCounter,a=m(n)?"".concat(n.id,"-").concat(o):o,i=n.hasCloseButton||!0,s=n.duration||2;return void 0!==n.hasCloseButton&&(i=n.hasCloseButton),void 0!==n.duration&&(s=n.duration),{id:a,title:e,description:n.description,hasCloseButton:i,duration:s,close:function(){return r.closeToast(a)},intent:n.intent}},r.closeToast=function(e){r.setState((function(t){return{toasts:t.toasts.map((function(t){return t.id===e?o(o({},t),{},{isShown:!1}):t}))}}))},r.removeToast=function(e){r.setState((function(t){return{toasts:t.toasts.filter((function(t){return t.id!==e}))}}))},e.bindNotify(r.notify),e.bindGetToasts(r.getToasts),e.bindCloseAll(r.closeAll),r.state={toasts:[]},r}return u(t,e),l(t,[{key:"render",value:function(){var e=this;return f.default.createElement("div",{className:"dtable-toast-manager"},this.state.toasts.map((function(t){var n=t.id,o=t.description,a=r(t,d);return f.default.createElement(h.default,Object.assign({key:n,onRemove:function(){return e.removeToast(n)}},a),o)})))}}])}(f.default.PureComponent);t.default=g,g.idCounter=0},42817:function(e,t,n){"use strict";var r=n(12897).default,o=n(34579).default,a=n(17383).default,i=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=i(n(98201)),l=i(n(52136)),c=i(n(54675));n(33215);var u="undefined"!==typeof window&&"undefined"!==typeof window.document,d=o((function e(){var t=this;a(this,e);var n=this;if(this._bindNotify=function(e){t.notifyHandler=e},this._bindGetToasts=function(e){t.getToastsHandler=e},this._bindCloseAll=function(e){t.closeAllHandler=e},this.getToasts=function(){return t.getToastsHandler()},this.closeAll=function(){return t.closeAllHandler()},this.notify=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n.notifyHandler(e,r(r({},t),{},{intent:"none"}))},this.success=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n.notifyHandler(e,r(r({},t),{},{intent:"success"}))},this.warning=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n.notifyHandler(e,r(r({},t),{},{intent:"warning"}))},this.danger=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n.notifyHandler(e,r(r({},t),{},{intent:"danger"}))},u){var o=document.createElement("div");o.setAttribute("data-evergreen-toaster-container",""),document.body.appendChild(o),l.default.render(s.default.createElement(c.default,{bindNotify:this._bindNotify,bindGetToasts:this._bindGetToasts,bindCloseAll:this._bindCloseAll}),o)}}));t.default=d},47629:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(18184)),a=r(n(99822));o.default.extend(a.default);t.default=o.default},37151:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isValidUrl=t.initDateEditorLanguage=t.getTrimmedString=t.getSelectOptionItem=void 0;var r=n(16519),o=n(37167),a=n(68977),i=n(30148),s=n(21230),l=n(96720),c=n(75520),u=n(37604),d=n(12275),p=n(18806);t.initDateEditorLanguage=function(e){var t;switch(e){case"zh-cn":default:t=r;break;case"zh-tw":t=o;break;case"en":t=a;break;case"fr":t=i;break;case"de":t=s;break;case"es":case"es-ar":case"es-mx":t=l;break;case"pl":t=c;break;case"pt-br":t=u;break;case"cs":t=d;break;case"ru":t=p}return t};t.getSelectOptionItem=function(e,t){return e.find((function(e){return e.id===t}))};t.isValidUrl=function(e){return/^(([-a-zA-Z0-9+.]+):\/\/)[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]/.test(e)};t.getTrimmedString=function(e){return"string"===typeof e?e.trim():""}},4527:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(){return o((function e(){r(this,e),this.subscribers={}}),[{key:"subscribe",value:function(e,t){this.subscribers[e]||(this.subscribers[e]=[]);var n=this.subscribers[e];return n.push(t),function(){var e=n.indexOf(t);e>-1&&n.splice(e,1)}}},{key:"dispatch",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=this.subscribers[e];Array.isArray(o)&&o.forEach((function(e){return e.apply(void 0,n)}))}}])}(),i=new a;t.default=i},70017:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.throttle=t.isMac=t.getEventClassName=t.downloadFile=t.debounce=void 0;t.debounce=function(e,t){var n=null;return function(){null!==n&&clearTimeout(n),n=setTimeout(e,t)}};t.throttle=function(e,t){var n=null,r=Date.now();return function(){var o=Date.now(),a=t-(o-r),i=arguments;clearTimeout(n),a<=0?(e.apply(this,i),r=Date.now()):n=setTimeout(e,a)}};t.isMac=function(){var e=navigator.platform;return"Mac68K"==e||"MacPPC"==e||"Macintosh"==e||"MacIntel"==e};t.downloadFile=function(e){var t=document.getElementById("dtableUiComponentDownloadFrame");null!=t&&document.body.removeChild(t);var n=document.createElement("iframe");n.setAttribute("id","dtableUiComponentDownloadFrame"),n.style.display="none",n.src=e,document.body.appendChild(n)};t.getEventClassName=function(e){return e&&e.target&&e.target.getAttribute("class")||""}},32712:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Oe}});var r=n(7219),o=n(26380),a=n(52889),i=n(5316),s=n(98201),l=n(52136),c=n(11942),u=n.n(c),d=n(91478),p=n(4899),f=n(18184),h=n.n(f),m=function(e){function t(){return(0,o.default)(this,t),(0,a.default)(this,e.apply(this,arguments))}return(0,i.default)(t,e),t.prototype.render=function(){var e=this.props,t=e.value.localeData(),n=e.prefixCls,r=void 0,o=t.weekdaysMin(),a=t.weekdaysShort();e.showWeekNumber&&(r=s.createElement("th",{role:"columnheader",className:n+"-column-header "+n+"-week-number-header"},s.createElement("span",{className:n+"-column-header-inner"},"x")));var i=a.map((function(e,t){return s.createElement("th",{key:t,role:"columnheader",title:e,className:n+"-column-header"},s.createElement("span",{className:n+"-column-header-inner"},o[t]))}));return s.createElement("thead",null,s.createElement("tr",{role:"row"},r,i))},t}(s.Component),g=m,v=n(28414),y=n.n(v),C=6,A=7,x=n(4601),b=n.n(x);h().extend(b());var _={disabledHours:function(){return[]},disabledMinutes:function(){return[]},disabledSeconds:function(){return[]}};function w(e){var t=h()();return t=t.locale(e.locale()).utcOffset(e.utcOffset())}function S(e){return e.format("LL")}function D(e){return S(w(e))}function E(e){var t=e.locale();return e.localeData()["zh-cn"===t?"months":"monthsShort"](e)}function k(e,t){var n=t?t(e):{};return n=(0,r.default)({},_,n)}function M(e,t,n){return(!t||!t(e))&&!(n&&!function(e,t){return function(e,t){var n=!1;if(e){var r=e.hour(),o=e.minute(),a=e.second();n=-1!==t.disabledHours().indexOf(r)||-1!==t.disabledMinutes(r).indexOf(o)||-1!==t.disabledSeconds(r,o).indexOf(a)}return!n}(e,k(e,t))}(e,n))}function I(e,t){return e?(Array.isArray(t)&&(t=t[0]),e.format(t)):""}function N(e,t){return e&&t&&e.isSame(t,"day")}function P(e,t){return e.year()<t.year()?1:e.year()===t.year()&&e.month()<t.month()}function T(e,t){return e.year()>t.year()?1:e.year()===t.year()&&e.month()>t.month()}var O=function(e){function t(){return(0,o.default)(this,t),(0,a.default)(this,e.apply(this,arguments))}return(0,i.default)(t,e),t.prototype.render=function(){var e=this.props,t=e.contentRender,n=e.prefixCls,r=e.selectedValue,o=e.value,a=e.showWeekNumber,i=e.dateRender,l=e.disabledDate,c=e.hoverValue,u=void 0,d=void 0,p=void 0,f=[],h=w(o),m=n+"-cell",g=n+"-week-number-cell",v=n+"-date",x=n+"-today",b=n+"-selected-day",_=n+"-selected-date",D=n+"-selected-start-date",E=n+"-selected-end-date",k=n+"-in-range-cell",M=n+"-last-month-cell",I=n+"-next-month-btn-day",O=n+"-disabled-cell",j=n+"-disabled-cell-first-of-row",R=n+"-disabled-cell-last-of-row",L=n+"-last-day-of-month",F=o.clone(),U=((F=F.date(1)).day()+7-7)%7,Y=F.clone();Y=Y.add(0-U,"days");var B=0;for(u=0;u<C;u++)for(d=0;d<A;d++)p=Y,B&&(p=(p=p.clone()).add(B,"days")),f.push(p),B++;var H,V=[];for(B=0,u=0;u<C;u++){var G,q=void 0,z=void 0,W=!1,K=[];for(a&&(z=s.createElement("td",{key:f[B].week(),role:"gridcell",className:g},f[B].week())),d=0;d<A;d++){var Z=null,X=null;p=f[B],d<A-1&&(Z=f[B+1]),d>0&&(X=f[B-1]);var $=m,J=!1,Q=!1;N(p,h)&&($+=" "+x,q=!0);var ee=P(p,o),te=T(p,o);if(r&&Array.isArray(r)){var ne=c.length?c:r;if(!ee&&!te){var re=ne[0],oe=ne[1];re&&N(p,re)&&(Q=!0,W=!0,$+=" "+D),(re||oe)&&(N(p,oe)?(Q=!0,W=!0,$+=" "+E):(null!==re&&void 0!==re||!p.isBefore(oe,"day"))&&(null!==oe&&void 0!==oe||!p.isAfter(re,"day"))?p.isAfter(re,"day")&&p.isBefore(oe,"day")&&($+=" "+k):$+=" "+k)}}else N(p,o)&&(Q=!0,W=!0);N(p,r)&&($+=" "+_),ee&&($+=" "+M),te&&($+=" "+I),p.clone().endOf("month").date()===p.date()&&($+=" "+L),l&&l(p,o)&&(J=!0,X&&l(X,o)||($+=" "+j),Z&&l(Z,o)||($+=" "+R)),Q&&($+=" "+b),J&&($+=" "+O);var ae=void 0;if(i)ae=i(p,o);else{var ie=t?t(p,o):p.date();ae=s.createElement("div",{key:(H=p,"rc-calendar-"+H.year()+"-"+H.month()+"-"+H.date()),className:v,"aria-selected":Q,"aria-disabled":J},ie)}K.push(s.createElement("td",{key:B,onClick:J?void 0:e.onSelect.bind(null,p),onMouseEnter:J?void 0:e.onDayHover&&e.onDayHover.bind(null,p)||void 0,role:"gridcell",title:S(p),className:$},ae)),B++}V.push(s.createElement("tr",{key:u,role:"row",className:y()((G={},G[n+"-current-week"]=q,G[n+"-active-week"]=W,G))},z,K))}return s.createElement("tbody",{className:n+"-tbody"},V)},t}(s.Component);O.propTypes={contentRender:u().func,dateRender:u().func,disabledDate:u().func,prefixCls:u().string,selectedValue:u().oneOfType([u().object,u().arrayOf(u().object)]),value:u().object,hoverValue:u().any,showWeekNumber:u().bool},O.defaultProps={hoverValue:[]};var j=O,R=function(e){function t(){return(0,o.default)(this,t),(0,a.default)(this,e.apply(this,arguments))}return(0,i.default)(t,e),t.prototype.render=function(){var e=this.props,t=e.prefixCls;return s.createElement("table",{className:t+"-table",cellSpacing:"0",role:"grid"},s.createElement(g,e),s.createElement(j,e))},t}(s.Component),L=R,F=n(59398);function U(e){var t=this.state.value.clone();t=t.month(e),this.setAndSelectValue(t)}var Y=function(e){function t(n){(0,o.default)(this,t);var r=(0,a.default)(this,e.call(this,n));return r.state={value:n.value},r}return(0,i.default)(t,e),t.prototype.componentWillReceiveProps=function(e){"value"in e&&this.setState({value:e.value})},t.prototype.setAndSelectValue=function(e){this.setState({value:e}),this.props.onSelect(e)},t.prototype.months=function(){for(var e=this.state.value.clone(),t=[],n=0,r=0;r<4;r++){t[r]=[];for(var o=0;o<3;o++){var a=E(e=e.month(n));t[r][o]={value:n,content:a,title:a},n++}}return t},t.prototype.render=function(){var e=this,t=this.props,n=this.state.value,r=w(n),o=this.months(),a=n.month(),i=t.prefixCls,l=t.locale,c=t.contentRender,u=t.cellRender,d=o.map((function(o,d){var p=o.map((function(o){var d,p=!1;if(t.disabledDate){var f=n.clone();f=f.month(o.value),p=t.disabledDate(f)}var h=((d={})[i+"-cell"]=1,d[i+"-cell-disabled"]=p,d[i+"-selected-cell"]=o.value===a,d[i+"-current-cell"]=r.year()===n.year()&&o.value===r.month(),d),m=void 0;if(u){var g=n.clone();g=g.month(o.value),m=u(g,l)}else{var v=void 0;if(c){var C=n.clone();C=C.month(o.value),v=c(C,l)}else v=o.content;m=s.createElement("a",{className:i+"-month"},v)}return s.createElement("td",{role:"gridcell",key:o.value,onClick:p?null:U.bind(e,o.value),title:o.title,className:y()(h)},m)}));return s.createElement("tr",{key:d,role:"row"},p)}));return s.createElement("table",{className:i+"-table",cellSpacing:"0",role:"grid"},s.createElement("tbody",{className:i+"-tbody"},d))},t}(s.Component);Y.defaultProps={onSelect:function(){}},Y.propTypes={onSelect:u().func,cellRender:u().func,prefixCls:u().string,value:u().object};var B=Y;function H(e){this.props.changeYear(e)}function V(){}var G=function(e){function t(n){(0,o.default)(this,t);var r=(0,a.default)(this,e.call(this,n));return r.setAndSelectValue=function(e){r.setValue(e),r.props.onSelect(e)},r.setValue=function(e){"value"in r.props&&r.setState({value:e})},r.nextYear=H.bind(r,1),r.previousYear=H.bind(r,-1),r.prefixCls=n.rootPrefixCls+"-month-panel",r.state={value:n.value||n.defaultValue},r}return(0,i.default)(t,e),t.getDerivedStateFromProps=function(e){var t={};return"value"in e&&(t={value:e.value}),t},t.prototype.render=function(){var e=this.props,t=this.state.value,n=e.locale,r=e.cellRender,o=e.contentRender,a=e.renderFooter,i=t.year(),l=this.prefixCls,c=a&&a("month");return s.createElement("div",{className:l,style:e.style},s.createElement("div",null,s.createElement("div",{className:l+"-header"},s.createElement("a",{className:l+"-prev-year-btn",role:"button",onClick:this.previousYear,title:n.previousYear}),s.createElement("a",{className:l+"-year-select",role:"button",onClick:e.onYearPanelShow,title:n.yearSelect},s.createElement("span",{className:l+"-year-select-content"},i),s.createElement("span",{className:l+"-year-select-arrow"},"x")),s.createElement("a",{className:l+"-next-year-btn",role:"button",onClick:this.nextYear,title:n.nextYear})),s.createElement("div",{className:l+"-body"},s.createElement(B,{disabledDate:e.disabledDate,onSelect:this.setAndSelectValue,locale:n,value:t,cellRender:r,contentRender:o,prefixCls:l})),c&&s.createElement("div",{className:l+"-footer"},c)))},t}(s.Component);G.propTypes={onChange:u().func,disabledDate:u().func,onSelect:u().func,renderFooter:u().func,rootPrefixCls:u().string,value:u().object,defaultValue:u().object},G.defaultProps={onChange:V,onSelect:V},(0,p.polyfill)(G);var q=G;function z(e){var t=this.state.value.clone();t=t.add(e,"year"),this.setState({value:t})}function W(e){var t=this.state.value.clone();t=(t=t.year(e)).month(this.state.value.month()),this.setState({value:t}),this.props.onSelect(t)}var K=function(e){function t(n){(0,o.default)(this,t);var r=(0,a.default)(this,e.call(this,n));return r.prefixCls=n.rootPrefixCls+"-year-panel",r.state={value:n.value||n.defaultValue},r.nextDecade=z.bind(r,10),r.previousDecade=z.bind(r,-10),r}return(0,i.default)(t,e),t.prototype.years=function(){for(var e=this.state.value.year(),t=10*parseInt(e/10,10)-1,n=[],r=0,o=0;o<4;o++){n[o]=[];for(var a=0;a<3;a++){var i=t+r,s=String(i);n[o][a]={content:s,year:i,title:s},r++}}return n},t.prototype.render=function(){var e=this,t=this.props,n=this.state.value,r=t.locale,o=t.renderFooter,a=this.years(),i=n.year(),l=10*parseInt(i/10,10),c=l+9,u=this.prefixCls,d=a.map((function(t,n){var r=t.map((function(t){var n,r=((n={})[u+"-cell"]=1,n[u+"-selected-cell"]=t.year===i,n);return s.createElement("td",{role:"gridcell",title:t.title,key:t.content,onClick:W.bind(e,t.year),className:y()(r)},s.createElement("a",{className:u+"-year"},t.content))}));return s.createElement("tr",{key:n,role:"row"},r)})),p=o&&o("year");return s.createElement("div",{className:this.prefixCls},s.createElement("div",null,s.createElement("div",{className:u+"-header"},s.createElement("a",{className:u+"-prev-decade-btn",role:"button",onClick:this.previousDecade,title:r.previousDecade}),s.createElement("a",{className:u+"-decade-select",role:"button",onClick:t.onDecadePanelShow,title:r.decadeSelect},s.createElement("span",{className:u+"-decade-select-content"},l,"-",c),s.createElement("span",{className:u+"-decade-select-arrow"},"x")),s.createElement("a",{className:u+"-next-decade-btn",role:"button",onClick:this.nextDecade,title:r.nextDecade})),s.createElement("div",{className:u+"-body"},s.createElement("table",{className:u+"-table",cellSpacing:"0",role:"grid"},s.createElement("tbody",{className:u+"-tbody"},d))),p&&s.createElement("div",{className:u+"-footer"},p)))},t}(s.Component),Z=K;K.propTypes={rootPrefixCls:u().string,value:u().object,defaultValue:u().object,renderFooter:u().func},K.defaultProps={onSelect:function(){}};function X(e){var t=this.state.value.clone();t=t.add(e,"years"),this.setState({value:t})}function $(e,t){var n=this.state.value.clone();n=(n=n.year(e)).month(this.state.value.month()),this.props.onSelect(n),t.preventDefault()}var J=function(e){function t(n){(0,o.default)(this,t);var r=(0,a.default)(this,e.call(this,n));return r.state={value:n.value||n.defaultValue},r.prefixCls=n.rootPrefixCls+"-decade-panel",r.nextCentury=X.bind(r,100),r.previousCentury=X.bind(r,-100),r}return(0,i.default)(t,e),t.prototype.render=function(){for(var e=this,t=this.state.value,n=this.props,r=n.locale,o=n.renderFooter,a=t.year(),i=100*parseInt(a/100,10),l=i-10,c=i+99,u=[],d=0,p=this.prefixCls,f=0;f<4;f++){u[f]=[];for(var h=0;h<3;h++){var m=l+10*d,g=l+10*d+9;u[f][h]={startDecade:m,endDecade:g},d++}}var v=o&&o("decade"),C=u.map((function(t,n){var r=t.map((function(t){var n,r=t.startDecade,o=t.endDecade,l=r<i,u=o>c,d=((n={})[p+"-cell"]=1,n[p+"-selected-cell"]=r<=a&&a<=o,n[p+"-last-century-cell"]=l,n[p+"-next-century-cell"]=u,n),f=r+"-"+o,h=void 0;return h=l?e.previousCentury:u?e.nextCentury:$.bind(e,r),s.createElement("td",{key:r,onClick:h,role:"gridcell",className:y()(d)},s.createElement("a",{className:p+"-decade"},f))}));return s.createElement("tr",{key:n,role:"row"},r)}));return s.createElement("div",{className:this.prefixCls},s.createElement("div",{className:p+"-header"},s.createElement("a",{className:p+"-prev-century-btn",role:"button",onClick:this.previousCentury,title:r.previousCentury}),s.createElement("div",{className:p+"-century"},i,"-",c),s.createElement("a",{className:p+"-next-century-btn",role:"button",onClick:this.nextCentury,title:r.nextCentury})),s.createElement("div",{className:p+"-body"},s.createElement("table",{className:p+"-table",cellSpacing:"0",role:"grid"},s.createElement("tbody",{className:p+"-tbody"},C))),v&&s.createElement("div",{className:p+"-footer"},v))},t}(s.Component),Q=J;function ee(e){var t=this.props.value.clone();t=t.add(e,"months"),this.props.onValueChange(t)}function te(e){var t=this.props.value.clone();t=t.add(e,"years"),this.props.onValueChange(t)}function ne(e,t){return e?t:null}J.propTypes={locale:u().object,value:u().object,defaultValue:u().object,rootPrefixCls:u().string,renderFooter:u().func},J.defaultProps={onSelect:function(){}};var re=function(e){function t(n){(0,o.default)(this,t);var r=(0,a.default)(this,e.call(this,n));return oe.call(r),r.nextMonth=ee.bind(r,1),r.previousMonth=ee.bind(r,-1),r.nextYear=te.bind(r,1),r.previousYear=te.bind(r,-1),r.state={yearPanelReferer:null},r}return(0,i.default)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.prefixCls,r=t.locale,o=t.mode,a=t.value,i=t.showTimePicker,l=t.enableNext,c=t.enablePrev,u=t.disabledMonth,d=t.renderFooter,p=null;return"month"===o&&(p=s.createElement(q,{locale:r,value:a,rootPrefixCls:n,onSelect:this.onMonthSelect,onYearPanelShow:function(){return e.showYearPanel("month")},disabledDate:u,cellRender:t.monthCellRender,contentRender:t.monthCellContentRender,renderFooter:d,changeYear:this.changeYear})),"year"===o&&(p=s.createElement(Z,{locale:r,defaultValue:a,rootPrefixCls:n,onSelect:this.onYearSelect,onDecadePanelShow:this.showDecadePanel,renderFooter:d})),"decade"===o&&(p=s.createElement(Q,{locale:r,defaultValue:a,rootPrefixCls:n,onSelect:this.onDecadeSelect,renderFooter:d})),s.createElement("div",{className:n+"-header"},s.createElement("div",{style:{position:"relative"}},ne(c&&!i,s.createElement("a",{className:n+"-prev-year-btn",role:"button",onClick:this.previousYear,title:r.previousYear})),ne(c&&!i,s.createElement("a",{className:n+"-prev-month-btn",role:"button",onClick:this.previousMonth,title:r.previousMonth})),this.monthYearElement(i),ne(l&&!i,s.createElement("a",{className:n+"-next-month-btn",onClick:this.nextMonth,title:r.nextMonth})),ne(l&&!i,s.createElement("a",{className:n+"-next-year-btn",onClick:this.nextYear,title:r.nextYear}))),p)},t}(s.Component);re.propTypes={prefixCls:u().string,value:u().object,onValueChange:u().func,showTimePicker:u().bool,onPanelChange:u().func,locale:u().object,enablePrev:u().any,enableNext:u().any,disabledMonth:u().func,renderFooter:u().func,onMonthSelect:u().func},re.defaultProps={enableNext:1,enablePrev:1,onPanelChange:function(){},onValueChange:function(){}};var oe=function(){var e=this;this.onMonthSelect=function(t){e.props.onPanelChange(t,"date"),e.props.onMonthSelect?e.props.onMonthSelect(t):e.props.onValueChange(t)},this.onYearSelect=function(t){var n=e.state.yearPanelReferer;e.setState({yearPanelReferer:null}),e.props.onPanelChange(t,n),e.props.onValueChange(t)},this.onDecadeSelect=function(t){e.props.onPanelChange(t,"year"),e.props.onValueChange(t)},this.changeYear=function(t){t>0?e.nextYear():e.previousYear()},this.monthYearElement=function(t){var n=e.props,r=n.prefixCls,o=n.locale,a=n.value,i=a.localeData(),l=o.monthBeforeYear,c=r+"-"+(l?"my-select":"ym-select"),u=t?" "+r+"-time-status":"",d=s.createElement("a",{className:r+"-year-select"+u,role:"button",onClick:t?null:function(){return e.showYearPanel("date")},title:t?null:o.yearSelect},a.format(o.yearFormat)),p=s.createElement("a",{className:r+"-month-select"+u,role:"button",onClick:t?null:e.showMonthPanel,title:t?null:o.monthSelect},o.monthFormat?a.format(o.monthFormat):i.monthsShort(a)),f=void 0;t&&(f=s.createElement("a",{className:r+"-day-select"+u,role:"button"},a.format(o.dayFormat)));var h=[];return h=l?[p,f,d]:[d,p,f],s.createElement("span",{className:c},(0,F.A)(h))},this.showMonthPanel=function(){e.props.onPanelChange(null,"month")},this.showYearPanel=function(t){e.setState({yearPanelReferer:t}),e.props.onPanelChange(null,"year")},this.showDecadePanel=function(){e.props.onPanelChange(null,"decade")}},ae=re;function ie(e){var t=e.prefixCls,n=e.locale,r=e.value,o=e.timePicker,a=e.disabled,i=e.disabledDate,l=e.onToday,c=e.text,u=(!c&&o?n.now:c)||n.today,d=i&&!M(w(r),i)||a,p=d?t+"-today-btn-disabled":"";return s.createElement("a",{className:t+"-today-btn "+p,role:"button",onClick:d?null:l,title:D(r)},u)}function se(e){var t=e.prefixCls,n=e.locale,r=e.okDisabled,o=e.onOk,a=t+"-ok-btn";return r&&(a+=" "+t+"-ok-btn-disabled"),s.createElement("a",{className:a,role:"button",onClick:r?null:o},n.ok)}function le(e){var t,n=e.prefixCls,r=e.locale,o=e.showTimePicker,a=e.onOpenTimePicker,i=e.onCloseTimePicker,l=e.timePickerDisabled,c=y()(((t={})[n+"-time-picker-btn"]=!0,t[n+"-time-picker-btn-disabled"]=l,t)),u=null;return l||(u=o?i:a),s.createElement("a",{className:c,role:"button",onClick:u},o?r.dateSelect:r.timeSelect)}var ce=function(e){function t(){return(0,o.default)(this,t),(0,a.default)(this,e.apply(this,arguments))}return(0,i.default)(t,e),t.prototype.onSelect=function(e){this.props.onSelect(e)},t.prototype.getRootDOMNode=function(){return l.findDOMNode(this)},t.prototype.render=function(){var e=this.props,t=e.value,n=e.prefixCls,o=e.showOk,a=e.timePicker,i=e.renderFooter,l=e.mode,c=null,u=i&&i(l);if(e.showToday||a||u){var d,p=void 0;e.showToday&&(p=s.createElement(ie,(0,r.default)({},e,{value:t})));var f=void 0;(!0===o||!1!==o&&e.timePicker)&&(f=s.createElement(se,e));var h=void 0;e.timePicker&&(h=s.createElement(le,e));var m=void 0;(p||h||f||u)&&(m=s.createElement("span",{className:n+"-footer-btn"},u,(0,F.A)([p,h,f])));var g=y()(n+"-footer",((d={})[n+"-footer-show-ok"]=f,d));c=s.createElement("div",{className:g},m)}return c},t}(s.Component);ce.propTypes={prefixCls:u().string,showDateInput:u().bool,disabledTime:u().any,timePicker:u().element,selectedValue:u().any,showOk:u().bool,onSelect:u().func,value:u().object,renderFooter:u().func,defaultValue:u().object,mode:u().string};var ue=ce,de=function(e){function t(n){(0,o.default)(this,t);var r=(0,a.default)(this,e.call(this,n));return r.onSelect=function(e){r.setState({highlightTime:e}),r.props.onSelect(e),r.props.onClickRightPanelTime()},r.getTimes=function(){for(var e=[],t=0;t<24;t++){var n=(String(t)+":00").padStart(5,"0"),r=(String(t)+":30").padStart(5,"0");e.push(n),e.push(r)}return e},r.scrollUp=function(){r.timeRef.current.scrollBy(0,-200)},r.scrollDown=function(){r.timeRef.current.scrollBy(0,200)},r.state={highlightTime:r.props.value||null},r.timeRef=s.createRef(),r.times=r.getTimes(),r}return(0,i.default)(t,e),t.prototype.componentDidMount=function(){var e=this.props.defaultMinutesTime,t=this.times.findIndex((function(t){return t===e})),n=t>-1?t:16;this.timeRef.current.scrollTo(0,34*n)},t.prototype.render=function(){var e=this,t=this.props,n=t.value,r=t.prefixCls,o=t.locale,a=n.format().slice(0,10),i=this.state.highlightTime,l=i?i.format().slice(11,16):null,c=o&&"\u4eca\u5929"===o.today;return s.createElement("div",{className:r+"-right-panel"},s.createElement("div",{className:r+"-right-panel-header",onClick:this.scrollUp},s.createElement("span",null)),s.createElement("div",{className:r+"-right-panel-body",ref:this.timeRef},s.createElement("ul",null,this.times.map((function(t){var n=h()(a+" "+t);return n=c?n.locale("zh-cn"):n.locale("en-gb"),s.createElement("li",{key:t,onClick:e.onSelect.bind(e,n),className:l===t?r+"-selected-time":""},t)})))),s.createElement("div",{className:r+"-right-panel-footer",onClick:this.scrollDown},s.createElement("span",null)))},t}(s.Component);de.propTypes={prefixCls:u().string,value:u().object,onSelect:u().func,onClickRightPanelTime:u().func,locale:u().object,defaultMinutesTime:u().string};var pe=de;function fe(e){return e?w(e):h()()}var he={value:u().object,defaultValue:u().object,onKeyDown:u().func},me={onKeyDown:function(){}};function ge(){}var ve={className:u().string,locale:u().object,style:u().object,visible:u().bool,onSelect:u().func,prefixCls:u().string,onChange:u().func,onOk:u().func},ye={locale:{today:"Today",now:"Now",backToToday:"Back to today",ok:"Ok",clear:"Clear",month:"Month",year:"Year",timeSelect:"select time",dateSelect:"select date",weekSelect:"Choose a week",monthSelect:"Choose a month",yearSelect:"Choose a year",decadeSelect:"Choose a decade",yearFormat:"YYYY",dateFormat:"M/D/YYYY",dayFormat:"D",dateTimeFormat:"M/D/YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Previous month (PageUp)",nextMonth:"Next month (PageDown)",previousYear:"Last year (Control + left)",nextYear:"Next year (Control + right)",previousDecade:"Last decade",nextDecade:"Next decade",previousCentury:"Last century",nextCentury:"Next century"},style:{},visible:!0,prefixCls:"rc-calendar",className:"",onSelect:ge,onChange:ge,onClear:ge,renderFooter:function(){return null},renderSidebar:function(){return null}},Ce=void 0,Ae=void 0,xe=void 0,be=function(e){function t(n){(0,o.default)(this,t);var r=(0,a.default)(this,e.call(this,n));_e.call(r);var i=n.selectedValue;return r.state={str:I(i,r.props.format),invalid:!1,hasFocus:!1},r}return(0,i.default)(t,e),t.prototype.componentDidUpdate=function(){!xe||!this.state.hasFocus||this.state.invalid||0===Ce&&0===Ae||xe.setSelectionRange(Ce,Ae)},t.getDerivedStateFromProps=function(e,t){var n={};xe&&(Ce=xe.selectionStart,Ae=xe.selectionEnd);var r=e.selectedValue;return t.hasFocus||(n={str:I(r,e.format),invalid:!1}),n},t.getInstance=function(){return xe},t.prototype.render=function(){var e=this.props,t=this.state,n=t.invalid,r=t.str,o=e.locale,a=e.prefixCls,i=e.placeholder,l=e.clearIcon,c=e.inputMode,u=n?a+"-input-invalid":"";return s.createElement("div",{className:a+"-input-wrap"},s.createElement("div",{className:a+"-date-input-wrap"},s.createElement("input",{ref:this.saveDateInput,className:a+"-input "+u,value:r,disabled:e.disabled,placeholder:i,onChange:this.onInputChange,onKeyDown:this.onKeyDown,onFocus:this.onFocus,onBlur:this.onBlur,inputMode:c})),e.showClear?s.createElement("a",{role:"button",title:o.clear,onClick:this.onClear},l||s.createElement("span",{className:a+"-clear-btn"})):null)},t}(s.Component);be.propTypes={prefixCls:u().string,timePicker:u().object,value:u().object,disabledTime:u().any,format:u().oneOfType([u().string,u().arrayOf(u().string)]),locale:u().object,disabledDate:u().func,onChange:u().func,onClear:u().func,placeholder:u().string,onSelect:u().func,selectedValue:u().object,clearIcon:u().node,inputMode:u().string};var _e=function(){var e=this;this.onClear=function(){e.setState({str:""}),e.props.onClear(null)},this.onInputChange=function(t){var n=t.target.value,r=e.props,o=r.disabledDate,a=r.format,i=r.onChange,s=r.selectedValue;if(!n)return i(null),void e.setState({invalid:!1,str:n});var l=h()(n,a,!0);if(l.isValid()){var c=e.props.value.clone();!(c=c.year(l.year()).month(l.month()).date(l.date()).hour(l.hour()).minute(l.minute()).second(l.second()))||o&&o(c)?e.setState({invalid:!0,str:n}):(s!==c||s&&c&&!s.isSame(c))&&(e.setState({invalid:!1,str:n}),i(c))}else e.setState({invalid:!0,str:n})},this.onFocus=function(){e.setState({hasFocus:!0})},this.onBlur=function(){e.setState((function(e,t){return{hasFocus:!1,str:I(t.value,t.format)}}))},this.onKeyDown=function(t){var n=t.keyCode,r=e.props,o=r.onSelect,a=r.value,i=r.disabledDate;n===d.A.ENTER&&o&&((!i||!i(a))&&o(a.clone()),t.preventDefault())},this.getRootDOMNode=function(){return l.findDOMNode(e)},this.focus=function(){xe&&xe.focus()},this.saveDateInput=function(e){xe=e}};(0,p.polyfill)(be);var we=be;var Se=n(3229),De=n.n(Se),Ee=n(5691),ke=n.n(Ee);function Me(){}h().extend(b()),h().extend(De()),h().extend(ke());var Ie=function(e){return!(!h().isDayjs(e)||!e.isValid())&&e},Ne=function(e){function t(n){(0,o.default)(this,t);var r=(0,a.default)(this,e.call(this,n));return Pe.call(r),r.state={mode:r.props.mode||"date",value:Ie(n.value)||Ie(n.defaultValue)||h()(),selectedValue:n.selectedValue||n.defaultSelectedValue},r}return(0,i.default)(t,e),t.prototype.componentDidMount=function(){this.props.showDateInput&&this.saveFocusElement(we.getInstance())},t.getDerivedStateFromProps=function(e,t){var n=e.value,r=e.selectedValue,o={};return"mode"in e&&t.mode!==e.mode&&(o={mode:e.mode}),"value"in e&&(o.value=Ie(n)||Ie(e.defaultValue)||fe(t.value)),"selectedValue"in e&&(o.selectedValue=r),o},t.prototype.render=function(){var e=this.props,t=this.state,n=e.locale,o=e.prefixCls,a=e.disabledDate,i=e.dateInputPlaceholder,l=e.timePicker,c=e.onClickRightPanelTime,u=e.disabledTime,d=e.clearIcon,p=e.renderFooter,f=e.inputMode,h=e.showHourAndMinute,m=t.value,g=t.selectedValue,v=t.mode,y="time"===v,C=y&&u&&l?k(g,u):null,A=null;if(l&&y){var x=(0,r.default)({showHour:!0,showSecond:!0,showMinute:!0},l.props,C,{onChange:this.onDateInputChange,value:g,disabledTime:u});void 0!==l.props.defaultValue&&(x.defaultOpenValue=l.props.defaultValue),A=s.cloneElement(l,x)}var b=e.showDateInput?s.createElement(we,{format:this.getFormat(),key:"date-input",value:m,locale:n,placeholder:i,showClear:!0,disabledTime:u,disabledDate:a,onClear:this.onClear,prefixCls:o,selectedValue:g,onChange:this.onDateInputChange,onSelect:this.onDateInputSelect,clearIcon:d,inputMode:f}):null,_=[];return e.renderSidebar&&_.push(e.renderSidebar()),_.push(s.createElement("div",{className:o+"-panel",key:"panel"},b,s.createElement("div",{className:o+"-date-panel-container"},s.createElement("div",{tabIndex:this.props.focusablePanel?0:void 0,className:o+"-date-panel"},s.createElement(ae,{locale:n,mode:v,value:m,onValueChange:this.setValue,onPanelChange:this.onPanelChange,renderFooter:p,showTimePicker:y,prefixCls:o}),l&&y?s.createElement("div",{className:o+"-time-picker"},s.createElement("div",{className:o+"-time-picker-panel"},A)):null,s.createElement("div",{className:o+"-body"},s.createElement(L,{locale:n,value:m,selectedValue:g,prefixCls:o,dateRender:e.dateRender,onSelect:this.onDateTableSelect,disabledDate:a,showWeekNumber:e.showWeekNumber})),s.createElement(ue,{showOk:e.showOk,mode:v,renderFooter:e.renderFooter,locale:n,prefixCls:o,showToday:e.showToday,disabledTime:u,showTimePicker:y,showDateInput:e.showDateInput,timePicker:l,selectedValue:g,value:m,disabledDate:a,okDisabled:!1!==e.showOk&&(!g||!this.isAllowedDate(g)),onOk:this.onOk,onSelect:this.onSelect,onToday:this.onToday,onOpenTimePicker:this.openTimePicker,onCloseTimePicker:this.closeTimePicker})),h&&s.createElement(pe,{prefixCls:o,value:m,locale:n,onSelect:this.onDateTableSelect,onClickRightPanelTime:c,defaultMinutesTime:this.props.defaultMinutesTime})))),this.renderRoot({children:_,className:e.showWeekNumber?o+"-week-number":""})},t}(s.Component);Ne.propTypes=(0,r.default)({},he,ve,{prefixCls:u().string,className:u().string,style:u().object,defaultValue:u().object,value:u().object,selectedValue:u().object,defaultSelectedValue:u().object,mode:u().oneOf(["time","date","month","year","decade"]),locale:u().object,showDateInput:u().bool,showWeekNumber:u().bool,showToday:u().bool,showOk:u().bool,showHourAndMinute:u().bool,defaultMinutesTime:u().string,onSelect:u().func,onOk:u().func,onKeyDown:u().func,timePicker:u().element,dateInputPlaceholder:u().any,onClear:u().func,onChange:u().func,onPanelChange:u().func,disabledDate:u().func,disabledTime:u().any,dateRender:u().func,renderFooter:u().func,renderSidebar:u().func,clearIcon:u().node,focusablePanel:u().bool,inputMode:u().string,onBlur:u().func,onClickRightPanelTime:u().func}),Ne.defaultProps=(0,r.default)({},me,ye,{showToday:!0,showDateInput:!0,showHourAndMinute:!1,timePicker:null,onOk:Me,onPanelChange:Me,onClickRightPanelTime:Me,focusablePanel:!0});var Pe=function(){var e=this;this.onPanelChange=function(t,n){var r=e.props,o=e.state;"mode"in r||e.setState({mode:n}),r.onPanelChange(t||o.value,n)},this.onKeyDown=function(t){if("input"!==t.target.nodeName.toLowerCase()){var n=t.keyCode,r=t.ctrlKey||t.metaKey,o=e.props.disabledDate,a=e.state.value;switch(n){case d.A.DOWN:return e.goTime(1,"weeks"),t.preventDefault(),1;case d.A.UP:return e.goTime(-1,"weeks"),t.preventDefault(),1;case d.A.LEFT:return r?e.goTime(-1,"years"):e.goTime(-1,"days"),t.preventDefault(),1;case d.A.RIGHT:return r?e.goTime(1,"years"):e.goTime(1,"days"),t.preventDefault(),1;case d.A.HOME:return e.setValue(e.state.value.clone().startOf("month")),t.preventDefault(),1;case d.A.END:return e.setValue(function(e){return e.clone().endOf("month")}(e.state.value)),t.preventDefault(),1;case d.A.PAGE_DOWN:return e.goTime(1,"month"),t.preventDefault(),1;case d.A.PAGE_UP:return e.goTime(-1,"month"),t.preventDefault(),1;case d.A.ENTER:return o&&o(a)||e.onSelect(a,{source:"keyboard"}),t.preventDefault(),1;default:return e.props.onKeyDown(t),1}}},this.onClear=function(){e.onSelect(null),e.props.onClear()},this.onOk=function(){var t=e.state.selectedValue;e.isAllowedDate(t)&&e.props.onOk(t)},this.onDateInputChange=function(t){e.onSelect(t,{source:"dateInput"})},this.onDateInputSelect=function(t){e.onSelect(t,{source:"dateInputSelect"})},this.onDateTableSelect=function(t){var n,r,o=e.props.timePicker;if(!e.state.selectedValue&&o){var a=o.props.defaultValue;a&&(n=a,r=t,h().isDayjs(n)&&h().isDayjs(r)&&(r=(r=(r=(r=r.hour(n.hour())).minute(n.minute())).second(n.second())).millisecond(n.millisecond())))}e.onSelect(t)},this.onToday=function(){var t=w(e.state.value);e.onSelect(t,{source:"todayButton"})},this.onBlur=function(t){setTimeout((function(){var n=we.getInstance(),r=e.rootInstance;!r||r.contains(document.activeElement)||n&&n.contains(document.activeElement)||e.props.onBlur&&e.props.onBlur(t)}),0)},this.getRootDOMNode=function(){return l.findDOMNode(e)},this.openTimePicker=function(){e.onPanelChange(null,"time")},this.closeTimePicker=function(){e.onPanelChange(null,"date")},this.goTime=function(t,n){e.setValue(function(e,t,n){return e.clone().add(t,n)}(e.state.value,t,n))}};(0,p.polyfill)(Ne);var Te=function(e){var t,n;return n=t=function(t){function n(){var e,r,i;(0,o.default)(this,n);for(var l=arguments.length,c=Array(l),u=0;u<l;u++)c[u]=arguments[u];return e=r=(0,a.default)(this,t.call.apply(t,[this].concat(c))),r.onSelect=function(e,t){e&&r.setValue(e),r.setSelectedValue(e,t)},r.renderRoot=function(e){var t,n=r.props,o=n.prefixCls,a=((t={})[o]=1,t[o+"-hidden"]=!n.visible,t[n.className]=!!n.className,t[e.className]=!!e.className,t);return s.createElement("div",{ref:r.saveRoot,className:""+y()(a),style:r.props.style,tabIndex:"0",onKeyDown:r.onKeyDown,onBlur:r.onBlur},e.children)},r.setSelectedValue=function(e,t){"selectedValue"in r.props||r.setState({selectedValue:e}),r.props.onSelect&&r.props.onSelect(e,t)},r.setValue=function(e){var t=r.state.value;"value"in r.props||r.setState({value:e}),(t&&e&&!t.isSame(e)||!t&&e||t&&!e)&&r.props.onChange(e)},r.isAllowedDate=function(e){return M(e,r.props.disabledDate,r.props.disabledTime)},i=e,(0,a.default)(r,i)}return(0,i.default)(n,t),n.getDerivedStateFromProps=function(t,n){if(e.getDerivedStateFromProps)return e.getDerivedStateFromProps(t,n);var r=t.value,o=t.selectedValue,a={};return"value"in t&&(a.value=r||t.defaultValue||fe(n.value)),"selectedValue"in t&&(a.selectedValue=o),a},n}(e),t.displayName="CalendarMixinWrapper",t.defaultProps=e.defaultProps,n}(function(e){var t,n;return n=t=function(e){function t(){var n,r,i;(0,o.default)(this,t);for(var s=arguments.length,l=Array(s),c=0;c<s;c++)l[c]=arguments[c];return n=r=(0,a.default)(this,e.call.apply(e,[this].concat(l))),r.getFormat=function(){var e=r.props.format,t=r.props,n=t.locale,o=t.timePicker;return e||(e=o?n.dateTimeFormat:n.dateFormat),e},r.focus=function(){r.focusElement?r.focusElement.focus():r.rootInstance&&r.rootInstance.focus()},r.saveFocusElement=function(e){r.focusElement=e},r.saveRoot=function(e){r.rootInstance=e},i=n,(0,a.default)(r,i)}return(0,i.default)(t,e),t.prototype.shouldComponentUpdate=function(e){return this.props.visible||e.visible},t}(e),t.displayName="CommonMixinWrapper",t.defaultProps=e.defaultProps,t.getDerivedStateFromProps=e.getDerivedStateFromProps,n}(Ne)),Oe=Te},94082:function(e,t,n){"use strict";t.__esModule=!0;var r=h(n(26380)),o=h(n(52889)),a=h(n(5316)),i=h(n(98201)),s=h(n(52136)),l=h(n(11942)),c=n(4899),u=h(n(19699)),d=h(n(13225)),p=h(n(47893)),f=h(n(826));function h(e){return e&&e.__esModule?e:{default:e}}function m(){}function g(e,t){this[e]=t}var v=function(e){function t(n){(0,r.default)(this,t);var a=(0,o.default)(this,e.call(this,n));y.call(a);var i=void 0;i="open"in n?n.open:n.defaultOpen;var s=n.value||n.defaultValue;return a.saveCalendarRef=g.bind(a,"calendarInstance"),a.state={open:i,value:s},a}return(0,a.default)(t,e),t.prototype.componentDidUpdate=function(e,t){!t.open&&this.state.open&&(this.focusTimeout=setTimeout(this.focusCalendar,0,this))},t.prototype.componentWillUnmount=function(){clearTimeout(this.focusTimeout)},t.getDerivedStateFromProps=function(e){var t={},n=e.value,r=e.open;return"value"in e&&(t.value=n),void 0!==r&&(t.open=r),t},t.prototype.render=function(){var e=this.props,t=e.prefixCls,n=e.placement,r=e.style,o=e.getCalendarContainer,a=e.align,s=e.animation,l=e.disabled,c=e.dropdownClassName,u=e.transitionName,d=e.children,h=this.state;return i.default.createElement(f.default,{popup:this.getCalendarElement(),popupAlign:a,builtinPlacements:p.default,popupPlacement:n,action:l&&!h.open?[]:["click"],destroyPopupOnHide:!0,getPopupContainer:o,popupStyle:r,popupAnimation:s,popupTransitionName:u,popupVisible:h.open,onPopupVisibleChange:this.onVisibleChange,prefixCls:t,popupClassName:c},i.default.cloneElement(d(h,e),{onKeyDown:this.onKeyDown}))},t}(i.default.Component);v.propTypes={animation:l.default.oneOfType([l.default.func,l.default.string]),disabled:l.default.bool,transitionName:l.default.string,onChange:l.default.func,onOpenChange:l.default.func,children:l.default.func,getCalendarContainer:l.default.func,calendar:l.default.element,style:l.default.object,open:l.default.bool,defaultOpen:l.default.bool,prefixCls:l.default.string,placement:l.default.any,value:l.default.oneOfType([l.default.object,l.default.array]),defaultValue:l.default.oneOfType([l.default.object,l.default.array]),align:l.default.object,dateRender:l.default.func,onBlur:l.default.func},v.defaultProps={prefixCls:"rc-calendar-picker",style:{},align:{},placement:"bottomLeft",defaultOpen:!1,onChange:m,onOpenChange:m,onBlur:m};var y=function(){var e=this;this.onCalendarKeyDown=function(t){t.keyCode===d.default.ESC&&(t.stopPropagation(),e.close(e.focus))},this.onCalendarSelect=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.props;"value"in r||e.setState({value:t}),("keyboard"===n.source||"dateInputSelect"===n.source||!r.calendar.props.timePicker&&"dateInput"!==n.source||"todayButton"===n.source)&&e.close(e.focus),r.onChange(t)},this.onKeyDown=function(t){e.state.open||t.keyCode!==d.default.DOWN&&t.keyCode!==d.default.ENTER||(e.open(),t.preventDefault())},this.onCalendarOk=function(){e.close(e.focus)},this.onCalendarClear=function(){e.close(e.focus)},this.onCalendarBlur=function(){e.setOpen(!1)},this.onVisibleChange=function(t){e.setOpen(t)},this.getCalendarElement=function(){var t=e.props,n=e.state,r=t.calendar.props,o=n.value,a=o,s={ref:e.saveCalendarRef,defaultValue:a||r.defaultValue,selectedValue:o,onKeyDown:e.onCalendarKeyDown,onOk:(0,u.default)(r.onOk,e.onCalendarOk),onSelect:(0,u.default)(r.onSelect,e.onCalendarSelect),onClear:(0,u.default)(r.onClear,e.onCalendarClear),onBlur:(0,u.default)(r.onBlur,e.onCalendarBlur)};return i.default.cloneElement(t.calendar,s)},this.setOpen=function(t,n){var r=e.props.onOpenChange;e.state.open!==t&&("open"in e.props||e.setState({open:t},n),r(t))},this.open=function(t){e.setOpen(!0,t)},this.close=function(t){e.setOpen(!1,t)},this.focus=function(){e.state.open||s.default.findDOMNode(e).focus()},this.focusCalendar=function(){e.state.open&&e.calendarInstance&&e.calendarInstance.focus()}};(0,c.polyfill)(v),t.default=v,e.exports=t.default},12275:function(e,t){"use strict";t.__esModule=!0,t.default={today:"Dnes",now:"Nyn\xed",backToToday:"Zp\u011bt na dne\u0161ek",ok:"Ok",clear:"Vymazat",month:"M\u011bs\xedc",year:"Rok",timeSelect:"Vybrat \u010das",dateSelect:"Vybrat datum",monthSelect:"Vyberte m\u011bs\xedc",yearSelect:"Vyberte rok",decadeSelect:"Vyberte dek\xe1du",yearFormat:"YYYY",dateFormat:"D.M.YYYY",dayFormat:"D",dateTimeFormat:"D.M.YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"P\u0159edchoz\xed m\u011bs\xedc (PageUp)",nextMonth:"N\xe1sleduj\xedc\xed (PageDown)",previousYear:"P\u0159edchoz\xed rok (Control + left)",nextYear:"N\xe1sleduj\xedc\xed rok (Control + right)",previousDecade:"P\u0159edchoz\xed dek\xe1da",nextDecade:"N\xe1sleduj\xedc\xed dek\xe1da",previousCentury:"P\u0159edchoz\xed stolet\xed",nextCentury:"N\xe1sleduj\xedc\xed stolet\xed"},e.exports=t.default},21230:function(e,t){"use strict";t.__esModule=!0,t.default={today:"Heute",now:"Jetzt",backToToday:"Zur\xfcck zu Heute",ok:"OK",clear:"Zur\xfccksetzen",month:"Monat",year:"Jahr",timeSelect:"Zeit w\xe4hlen",dateSelect:"Datum w\xe4hlen",monthSelect:"W\xe4hle einen Monat",yearSelect:"W\xe4hle ein Jahr",decadeSelect:"W\xe4hle ein Jahrzehnt",yearFormat:"YYYY",dateFormat:"D.M.YYYY",dayFormat:"D",dateTimeFormat:"D.M.YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Vorheriger Monat (PageUp)",nextMonth:"N\xe4chster Monat (PageDown)",previousYear:"Vorheriges Jahr (Ctrl + left)",nextYear:"N\xe4chstes Jahr (Ctrl + right)",previousDecade:"Vorheriges Jahrzehnt",nextDecade:"N\xe4chstes Jahrzehnt",previousCentury:"Vorheriges Jahrhundert",nextCentury:"N\xe4chstes Jahrhundert"},e.exports=t.default},68977:function(e,t){"use strict";t.__esModule=!0,t.default={today:"Today",now:"Now",backToToday:"Back to today",ok:"Ok",clear:"Clear",month:"Month",year:"Year",timeSelect:"select time",dateSelect:"select date",weekSelect:"Choose a week",monthSelect:"Choose a month",yearSelect:"Choose a year",decadeSelect:"Choose a decade",yearFormat:"YYYY",dateFormat:"M/D/YYYY",dayFormat:"D",dateTimeFormat:"M/D/YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Previous month (PageUp)",nextMonth:"Next month (PageDown)",previousYear:"Last year (Control + left)",nextYear:"Next year (Control + right)",previousDecade:"Last decade",nextDecade:"Next decade",previousCentury:"Last century",nextCentury:"Next century"},e.exports=t.default},96720:function(e,t){"use strict";t.__esModule=!0,t.default={today:"Hoy",now:"Ahora",backToToday:"Volver a hoy",ok:"Aceptar",clear:"Limpiar",month:"Mes",year:"A\xf1o",timeSelect:"Seleccionar hora",dateSelect:"Seleccionar fecha",monthSelect:"Elegir un mes",yearSelect:"Elegir un a\xf1o",decadeSelect:"Elegir una d\xe9cada",yearFormat:"YYYY",dateFormat:"D/M/YYYY",dayFormat:"D",dateTimeFormat:"D/M/YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Mes anterior (PageUp)",nextMonth:"Mes siguiente (PageDown)",previousYear:"A\xf1o anterior (Control + left)",nextYear:"A\xf1o siguiente (Control + right)",previousDecade:"D\xe9cada anterior",nextDecade:"D\xe9cada siguiente",previousCentury:"Siglo anterior",nextCentury:"Siglo siguiente"},e.exports=t.default},30148:function(e,t){"use strict";t.__esModule=!0,t.default={today:"Aujourd'hui",now:"Maintenant",backToToday:"Aujourd'hui",ok:"Ok",clear:"R\xe9tablir",month:"Mois",year:"Ann\xe9e",timeSelect:"S\xe9lectionner l'heure",dateSelect:"S\xe9lectionner la date",monthSelect:"Choisissez un mois",yearSelect:"Choisissez une ann\xe9e",decadeSelect:"Choisissez une d\xe9cennie",yearFormat:"YYYY",dateFormat:"DD/MM/YYYY",dayFormat:"DD",dateTimeFormat:"DD/MM/YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Mois pr\xe9c\xe9dent (PageUp)",nextMonth:"Mois suivant (PageDown)",previousYear:"Ann\xe9e pr\xe9c\xe9dente (Ctrl + gauche)",nextYear:"Ann\xe9e prochaine (Ctrl + droite)",previousDecade:"D\xe9cennie pr\xe9c\xe9dente",nextDecade:"D\xe9cennie suivante",previousCentury:"Si\xe8cle pr\xe9c\xe9dent",nextCentury:"Si\xe8cle suivant"},e.exports=t.default},75520:function(e,t){"use strict";t.__esModule=!0,t.default={today:"Dzisiaj",now:"Teraz",backToToday:"Ustaw dzisiaj",ok:"Ok",clear:"Wyczy\u015b\u0107",month:"Miesi\u0105c",year:"Rok",timeSelect:"Ustaw czas",dateSelect:"Ustaw dat\u0119",monthSelect:"Wybierz miesi\u0105c",yearSelect:"Wybierz rok",decadeSelect:"Wybierz dekad\u0119",yearFormat:"YYYY",dateFormat:"D/M/YYYY",dayFormat:"D",dateTimeFormat:"D/M/YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Poprzedni miesi\u0105c (PageUp)",nextMonth:"Nast\u0119pny miesi\u0105c (PageDown)",previousYear:"Ostatni rok (Ctrl + left)",nextYear:"Nast\u0119pny rok (Ctrl + right)",previousDecade:"Ostatnia dekada",nextDecade:"Nast\u0119pna dekada",previousCentury:"Ostatni wiek",nextCentury:"Nast\u0119pny wiek"},e.exports=t.default},37604:function(e,t){"use strict";t.__esModule=!0,t.default={today:"Hoje",now:"Agora",backToToday:"Voltar para hoje",ok:"Ok",clear:"Limpar",month:"M\xeas",year:"Ano",timeSelect:"Selecionar tempo",dateSelect:"Selecionar data",monthSelect:"Escolher m\xeas",yearSelect:"Escolher ano",decadeSelect:"Escolher d\xe9cada",yearFormat:"YYYY",dateFormat:"D/M/YYYY",dayFormat:"D",dateTimeFormat:"D/M/YYYY HH:mm:ss",monthBeforeYear:!1,previousMonth:"M\xeas anterior (PageUp)",nextMonth:"Pr\xf3ximo m\xeas (PageDown)",previousYear:"Ano anterior (Control + esquerda)",nextYear:"Pr\xf3ximo ano (Control + direita)",previousDecade:"D\xe9cada anterior",nextDecade:"Pr\xf3xima d\xe9cada",previousCentury:"S\xe9culo anterior",nextCentury:"Pr\xf3ximo s\xe9culo"},e.exports=t.default},18806:function(e,t){"use strict";t.__esModule=!0,t.default={today:"\u0421\u0435\u0433\u043e\u0434\u043d\u044f",now:"\u0421\u0435\u0439\u0447\u0430\u0441",backToToday:"\u0422\u0435\u043a\u0443\u0449\u0430\u044f \u0434\u0430\u0442\u0430",ok:"Ok",clear:"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c",month:"\u041c\u0435\u0441\u044f\u0446",year:"\u0413\u043e\u0434",timeSelect:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0432\u0440\u0435\u043c\u044f",dateSelect:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0434\u0430\u0442\u0443",monthSelect:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u043c\u0435\u0441\u044f\u0446",yearSelect:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0433\u043e\u0434",decadeSelect:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0434\u0435\u0441\u044f\u0442\u0438\u043b\u0435\u0442\u0438\u0435",yearFormat:"YYYY",dateFormat:"D-M-YYYY",dayFormat:"D",dateTimeFormat:"D-M-YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"\u041f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u0439 \u043c\u0435\u0441\u044f\u0446 (PageUp)",nextMonth:"\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 \u043c\u0435\u0441\u044f\u0446 (PageDown)",previousYear:"\u041f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u0439 \u0433\u043e\u0434 (Control + left)",nextYear:"\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 \u0433\u043e\u0434 (Control + right)",previousDecade:"\u041f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0435\u0435 \u0434\u0435\u0441\u044f\u0442\u0438\u043b\u0435\u0442\u0438\u0435",nextDecade:"\u0421\u043b\u0435\u0434\u0443\u0449\u0435\u0435 \u0434\u0435\u0441\u044f\u0442\u0438\u043b\u0435\u0442\u0438\u0435",previousCentury:"\u041f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u0439 \u0432\u0435\u043a",nextCentury:"\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 \u0432\u0435\u043a"},e.exports=t.default},16519:function(e,t){"use strict";t.__esModule=!0,t.default={today:"\u4eca\u5929",now:"\u6b64\u523b",backToToday:"\u8fd4\u56de\u4eca\u5929",ok:"\u786e\u5b9a",timeSelect:"\u9009\u62e9\u65f6\u95f4",dateSelect:"\u9009\u62e9\u65e5\u671f",weekSelect:"\u9009\u62e9\u5468",clear:"\u6e05\u9664",month:"\u6708",year:"\u5e74",previousMonth:"\u4e0a\u4e2a\u6708 (\u7ffb\u9875\u4e0a\u952e)",nextMonth:"\u4e0b\u4e2a\u6708 (\u7ffb\u9875\u4e0b\u952e)",monthSelect:"\u9009\u62e9\u6708\u4efd",yearSelect:"\u9009\u62e9\u5e74\u4efd",decadeSelect:"\u9009\u62e9\u5e74\u4ee3",yearFormat:"YYYY\u5e74",dayFormat:"D\u65e5",dateFormat:"YYYY\u5e74M\u6708D\u65e5",dateTimeFormat:"YYYY\u5e74M\u6708D\u65e5 HH\u65f6mm\u5206ss\u79d2",previousYear:"\u4e0a\u4e00\u5e74 (Control\u952e\u52a0\u5de6\u65b9\u5411\u952e)",nextYear:"\u4e0b\u4e00\u5e74 (Control\u952e\u52a0\u53f3\u65b9\u5411\u952e)",previousDecade:"\u4e0a\u4e00\u5e74\u4ee3",nextDecade:"\u4e0b\u4e00\u5e74\u4ee3",previousCentury:"\u4e0a\u4e00\u4e16\u7eaa",nextCentury:"\u4e0b\u4e00\u4e16\u7eaa"},e.exports=t.default},37167:function(e,t){"use strict";t.__esModule=!0,t.default={today:"\u4eca\u5929",now:"\u6b64\u523b",backToToday:"\u8fd4\u56de\u4eca\u5929",ok:"\u78ba\u5b9a",timeSelect:"\u9078\u64c7\u6642\u9593",dateSelect:"\u9078\u64c7\u65e5\u671f",clear:"\u6e05\u9664",month:"\u6708",year:"\u5e74",previousMonth:"\u4e0a\u500b\u6708 (\u7ffb\u9801\u4e0a\u9375)",nextMonth:"\u4e0b\u500b\u6708 (\u7ffb\u9801\u4e0b\u9375)",monthSelect:"\u9078\u64c7\u6708\u4efd",yearSelect:"\u9078\u64c7\u5e74\u4efd",decadeSelect:"\u9078\u64c7\u5e74\u4ee3",yearFormat:"YYYY\u5e74",dayFormat:"D\u65e5",dateFormat:"YYYY\u5e74M\u6708D\u65e5",dateTimeFormat:"YYYY\u5e74M\u6708D\u65e5 HH\u6642mm\u5206ss\u79d2",previousYear:"\u4e0a\u4e00\u5e74 (Control\u9375\u52a0\u5de6\u65b9\u5411\u9375)",nextYear:"\u4e0b\u4e00\u5e74 (Control\u9375\u52a0\u53f3\u65b9\u5411\u9375)",previousDecade:"\u4e0a\u4e00\u5e74\u4ee3",nextDecade:"\u4e0b\u4e00\u5e74\u4ee3",previousCentury:"\u4e0a\u4e00\u4e16\u7d00",nextCentury:"\u4e0b\u4e00\u4e16\u7d00"},e.exports=t.default},47893:function(e,t){"use strict";t.__esModule=!0;var n={adjustX:1,adjustY:1},r=[0,0],o={bottomLeft:{points:["tl","tl"],overflow:n,offset:[0,-3],targetOffset:r},bottomRight:{points:["tr","tr"],overflow:n,offset:[0,-3],targetOffset:r},topRight:{points:["br","br"],overflow:n,offset:[0,3],targetOffset:r},topLeft:{points:["bl","bl"],overflow:n,offset:[0,3],targetOffset:r}};t.default=o,e.exports=t.default},6037:function(e,t,n){e.exports=function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(e),r={name:"en-gb",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekStart:1,yearStart:4,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},ordinal:function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||t[0])+"]"}};return n.default.locale(r,null,!0),r}(n(18184))},86210:function(e,t,n){e.exports=function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(e),r={name:"zh-cn",weekdays:"\u661f\u671f\u65e5_\u661f\u671f\u4e00_\u661f\u671f\u4e8c_\u661f\u671f\u4e09_\u661f\u671f\u56db_\u661f\u671f\u4e94_\u661f\u671f\u516d".split("_"),weekdaysShort:"\u5468\u65e5_\u5468\u4e00_\u5468\u4e8c_\u5468\u4e09_\u5468\u56db_\u5468\u4e94_\u5468\u516d".split("_"),weekdaysMin:"\u65e5_\u4e00_\u4e8c_\u4e09_\u56db_\u4e94_\u516d".split("_"),months:"\u4e00\u6708_\u4e8c\u6708_\u4e09\u6708_\u56db\u6708_\u4e94\u6708_\u516d\u6708_\u4e03\u6708_\u516b\u6708_\u4e5d\u6708_\u5341\u6708_\u5341\u4e00\u6708_\u5341\u4e8c\u6708".split("_"),monthsShort:"1\u6708_2\u6708_3\u6708_4\u6708_5\u6708_6\u6708_7\u6708_8\u6708_9\u6708_10\u6708_11\u6708_12\u6708".split("_"),ordinal:function(e,t){return"W"===t?e+"\u5468":e+"\u65e5"},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY\u5e74M\u6708D\u65e5",LLL:"YYYY\u5e74M\u6708D\u65e5Ah\u70b9mm\u5206",LLLL:"YYYY\u5e74M\u6708D\u65e5ddddAh\u70b9mm\u5206",l:"YYYY/M/D",ll:"YYYY\u5e74M\u6708D\u65e5",lll:"YYYY\u5e74M\u6708D\u65e5 HH:mm",llll:"YYYY\u5e74M\u6708D\u65e5dddd HH:mm"},relativeTime:{future:"%s\u5185",past:"%s\u524d",s:"\u51e0\u79d2",m:"1 \u5206\u949f",mm:"%d \u5206\u949f",h:"1 \u5c0f\u65f6",hh:"%d \u5c0f\u65f6",d:"1 \u5929",dd:"%d \u5929",M:"1 \u4e2a\u6708",MM:"%d \u4e2a\u6708",y:"1 \u5e74",yy:"%d \u5e74"},meridiem:function(e,t){var n=100*e+t;return n<600?"\u51cc\u6668":n<900?"\u65e9\u4e0a":n<1100?"\u4e0a\u5348":n<1300?"\u4e2d\u5348":n<1800?"\u4e0b\u5348":"\u665a\u4e0a"}};return n.default.locale(r,null,!0),r}(n(18184))},99822:function(e){e.exports=function(){"use strict";var e={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},t=/(\[[^[]*\])|([-:/.()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,n=/\d\d/,r=/\d\d?/,o=/\d*[^\s\d-_:/()]+/,a={},i=function(e){return(e=+e)+(e>68?1900:2e3)},s=function(e){return function(t){this[e]=+t}},l=[/[+-]\d\d:?(\d\d)?|Z/,function(e){(this.zone||(this.zone={})).offset=function(e){if(!e)return 0;if("Z"===e)return 0;var t=e.match(/([+-]|\d\d)/g),n=60*t[1]+(+t[2]||0);return 0===n?0:"+"===t[0]?-n:n}(e)}],c=function(e){var t=a[e];return t&&(t.indexOf?t:t.s.concat(t.f))},u=function(e,t){var n,r=a.meridiem;if(r){for(var o=1;o<=24;o+=1)if(e.indexOf(r(o,0,t))>-1){n=o>12;break}}else n=e===(t?"pm":"PM");return n},d={A:[o,function(e){this.afternoon=u(e,!1)}],a:[o,function(e){this.afternoon=u(e,!0)}],S:[/\d/,function(e){this.milliseconds=100*+e}],SS:[n,function(e){this.milliseconds=10*+e}],SSS:[/\d{3}/,function(e){this.milliseconds=+e}],s:[r,s("seconds")],ss:[r,s("seconds")],m:[r,s("minutes")],mm:[r,s("minutes")],H:[r,s("hours")],h:[r,s("hours")],HH:[r,s("hours")],hh:[r,s("hours")],D:[r,s("day")],DD:[n,s("day")],Do:[o,function(e){var t=a.ordinal,n=e.match(/\d+/);if(this.day=n[0],t)for(var r=1;r<=31;r+=1)t(r).replace(/\[|\]/g,"")===e&&(this.day=r)}],M:[r,s("month")],MM:[n,s("month")],MMM:[o,function(e){var t=c("months"),n=(c("monthsShort")||t.map((function(e){return e.substr(0,3)}))).indexOf(e)+1;if(n<1)throw new Error;this.month=n%12||n}],MMMM:[o,function(e){var t=c("months").indexOf(e)+1;if(t<1)throw new Error;this.month=t%12||t}],Y:[/[+-]?\d+/,s("year")],YY:[n,function(e){this.year=i(e)}],YYYY:[/\d{4}/,s("year")],Z:l,ZZ:l};function p(n){var r,o;r=n,o=a&&a.formats;for(var i=(n=r.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function(t,n,r){var a=r&&r.toUpperCase();return n||o[r]||e[r]||o[a].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(e,t,n){return t||n.slice(1)}))}))).match(t),s=i.length,l=0;l<s;l+=1){var c=i[l],u=d[c],p=u&&u[0],f=u&&u[1];i[l]=f?{regex:p,parser:f}:c.replace(/^\[|\]$/g,"")}return function(e){for(var t={},n=0,r=0;n<s;n+=1){var o=i[n];if("string"==typeof o)r+=o.length;else{var a=o.regex,l=o.parser,c=e.substr(r),u=a.exec(c)[0];l.call(t,u),e=e.replace(u,"")}}return function(e){var t=e.afternoon;if(void 0!==t){var n=e.hours;t?n<12&&(e.hours+=12):12===n&&(e.hours=0),delete e.afternoon}}(t),t}}return function(e,t,n){n.p.customParseFormat=!0,e&&e.parseTwoDigitYear&&(i=e.parseTwoDigitYear);var r=t.prototype,o=r.parse;r.parse=function(e){var t=e.date,r=e.utc,i=e.args;this.$u=r;var s=i[1];if("string"==typeof s){var l=!0===i[2],c=!0===i[3],u=l||c,d=i[2];c&&(d=i[2]),a=this.$locale(),!l&&d&&(a=n.Ls[d]),this.$d=function(e,t,n){try{if(["x","X"].indexOf(t)>-1)return new Date(("X"===t?1e3:1)*e);var r=p(t)(e),o=r.year,a=r.month,i=r.day,s=r.hours,l=r.minutes,c=r.seconds,u=r.milliseconds,d=r.zone,f=new Date,h=i||(o||a?1:f.getDate()),m=o||f.getFullYear(),g=0;o&&!a||(g=a>0?a-1:f.getMonth());var v=s||0,y=l||0,C=c||0,A=u||0;return d?new Date(Date.UTC(m,g,h,v,y,C,A+60*d.offset*1e3)):n?new Date(Date.UTC(m,g,h,v,y,C,A)):new Date(m,g,h,v,y,C,A)}catch(e){return new Date("")}}(t,s,r),this.init(),d&&!0!==d&&(this.$L=this.locale(d).$L),u&&t!=this.format(s)&&(this.$d=new Date("")),a={}}else if(s instanceof Array)for(var f=s.length,h=1;h<=f;h+=1){i[1]=s[h-1];var m=n.apply(this,i);if(m.isValid()){this.$d=m.$d,this.$L=m.$L,this.init();break}h===f&&(this.$d=new Date(""))}else o.call(this,e)}}}()},3229:function(e){e.exports=function(){"use strict";return function(e,t,n){var r=t.prototype,o=function(e){return e&&(e.indexOf?e:e.s)},a=function(e,t,n,r,a){var i=e.name?e:e.$locale(),s=o(i[t]),l=o(i[n]),c=s||l.map((function(e){return e.substr(0,r)}));if(!a)return c;var u=i.weekStart;return c.map((function(e,t){return c[(t+(u||0))%7]}))},i=function(){return n.Ls[n.locale()]},s=function(e,t){return e.formats[t]||function(e){return e.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(e,t,n){return t||n.slice(1)}))}(e.formats[t.toUpperCase()])},l=function(){var e=this;return{months:function(t){return t?t.format("MMMM"):a(e,"months")},monthsShort:function(t){return t?t.format("MMM"):a(e,"monthsShort","months",3)},firstDayOfWeek:function(){return e.$locale().weekStart||0},weekdays:function(t){return t?t.format("dddd"):a(e,"weekdays")},weekdaysMin:function(t){return t?t.format("dd"):a(e,"weekdaysMin","weekdays",2)},weekdaysShort:function(t){return t?t.format("ddd"):a(e,"weekdaysShort","weekdays",3)},longDateFormat:function(t){return s(e.$locale(),t)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};r.localeData=function(){return l.bind(this)()},n.localeData=function(){var e=i();return{firstDayOfWeek:function(){return e.weekStart||0},weekdays:function(){return n.weekdays()},weekdaysShort:function(){return n.weekdaysShort()},weekdaysMin:function(){return n.weekdaysMin()},months:function(){return n.months()},monthsShort:function(){return n.monthsShort()},longDateFormat:function(t){return s(e,t)},meridiem:e.meridiem,ordinal:e.ordinal}},n.months=function(){return a(i(),"months")},n.monthsShort=function(){return a(i(),"monthsShort","months",3)},n.weekdays=function(e){return a(i(),"weekdays",null,null,e)},n.weekdaysShort=function(e){return a(i(),"weekdaysShort","weekdays",3,e)},n.weekdaysMin=function(e){return a(i(),"weekdaysMin","weekdays",2,e)}}}()},4601:function(e){e.exports=function(){"use strict";var e="minute",t=/[+-]\d\d(?::?\d\d)?/g,n=/([+-]|\d\d)/g;return function(r,o,a){var i=o.prototype;a.utc=function(e){return new o({date:e,utc:!0,args:arguments})},i.utc=function(t){var n=a(this.toDate(),{locale:this.$L,utc:!0});return t?n.add(this.utcOffset(),e):n},i.local=function(){return a(this.toDate(),{locale:this.$L,utc:!1})};var s=i.parse;i.parse=function(e){e.utc&&(this.$u=!0),this.$utils().u(e.$offset)||(this.$offset=e.$offset),s.call(this,e)};var l=i.init;i.init=function(){if(this.$u){var e=this.$d;this.$y=e.getUTCFullYear(),this.$M=e.getUTCMonth(),this.$D=e.getUTCDate(),this.$W=e.getUTCDay(),this.$H=e.getUTCHours(),this.$m=e.getUTCMinutes(),this.$s=e.getUTCSeconds(),this.$ms=e.getUTCMilliseconds()}else l.call(this)};var c=i.utcOffset;i.utcOffset=function(r,o){var a=this.$utils().u;if(a(r))return this.$u?0:a(this.$offset)?c.call(this):this.$offset;if("string"==typeof r&&null===(r=function(e){void 0===e&&(e="");var r=e.match(t);if(!r)return null;var o=(""+r[0]).match(n)||["-",0,0],a=o[0],i=60*+o[1]+ +o[2];return 0===i?0:"+"===a?i:-i}(r)))return this;var i=Math.abs(r)<=16?60*r:r,s=this;if(o)return s.$offset=i,s.$u=0===r,s;if(0!==r){var l=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(s=this.local().add(i+l,e)).$offset=i,s.$x.$localOffset=l}else s=this.utc();return s};var u=i.format;i.format=function(e){var t=e||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return u.call(this,t)},i.valueOf=function(){var e=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||(new Date).getTimezoneOffset());return this.$d.valueOf()-6e4*e},i.isUTC=function(){return!!this.$u},i.toISOString=function(){return this.toDate().toISOString()},i.toString=function(){return this.toDate().toUTCString()};var d=i.toDate;i.toDate=function(e){return"s"===e&&this.$offset?a(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():d.call(this)};var p=i.diff;i.diff=function(e,t,n){if(e&&this.$u===e.$u)return p.call(this,e,t,n);var r=this.local(),o=a(e).local();return p.call(r,o,t,n)}}}()},5691:function(e){e.exports=function(){"use strict";var e="week",t="year";return function(n,r,o){var a=r.prototype;a.week=function(n){if(void 0===n&&(n=null),null!==n)return this.add(7*(n-this.week()),"day");var r=this.$locale().yearStart||1;if(11===this.month()&&this.date()>25){var a=o(this).startOf(t).add(1,t).date(r),i=o(this).endOf(e);if(a.isBefore(i))return 1}var s=o(this).startOf(t).date(r).startOf(e).subtract(1,"millisecond"),l=this.diff(s,e,!0);return l<0?o(this).startOf("week").week():Math.ceil(l)},a.weeks=function(e){return void 0===e&&(e=null),this.week(e)}}}()},1382:function(e){e.exports="undefined"!==typeof self?self:"undefined"!==typeof window?window:Function("return this")()},88127:function(e,t,n){e.exports=n(20414),e.exports.parser=n(27867)},20414:function(e,t,n){var r=n(1162),o=n(19621),a=n(92775)("engine.io-client:socket"),i=n(95896),s=n(27867),l=n(20204),c=n(71914);function u(e,t){if(!(this instanceof u))return new u(e,t);t=t||{},e&&"object"===typeof e&&(t=e,e=null),e?(e=l(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=l(t.host).host),this.secure=null!=t.secure?t.secure:"undefined"!==typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.agent=t.agent||!1,this.hostname=t.hostname||("undefined"!==typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!==typeof location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"===typeof this.query&&(this.query=c.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.withCredentials=!1!==t.withCredentials,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.transportOptions=t.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.perMessageDeflate=!1!==t.perMessageDeflate&&(t.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=t.pfx||void 0,this.key=t.key||void 0,this.passphrase=t.passphrase||void 0,this.cert=t.cert||void 0,this.ca=t.ca||void 0,this.ciphers=t.ciphers||void 0,this.rejectUnauthorized=void 0===t.rejectUnauthorized||t.rejectUnauthorized,this.forceNode=!!t.forceNode,this.isReactNative="undefined"!==typeof navigator&&"string"===typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),("undefined"===typeof self||this.isReactNative)&&(t.extraHeaders&&Object.keys(t.extraHeaders).length>0&&(this.extraHeaders=t.extraHeaders),t.localAddress&&(this.localAddress=t.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}e.exports=u,u.priorWebsocketSuccess=!1,o(u.prototype),u.protocol=s.protocol,u.Socket=u,u.Transport=n(44882),u.transports=n(1162),u.parser=n(27867),u.prototype.createTransport=function(e){a('creating transport "%s"',e);var t=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}(this.query);t.EIO=s.protocol,t.transport=e;var n=this.transportOptions[e]||{};return this.id&&(t.sid=this.id),new r[e]({query:t,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,withCredentials:n.withCredentials||this.withCredentials,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0,isReactNative:this.isReactNative})},u.prototype.open=function(){var e;if(this.rememberUpgrade&&u.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout((function(){t.emit("error","No transports available")}),0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(n){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},u.prototype.setTransport=function(e){a("setting transport %s",e.name);var t=this;this.transport&&(a("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",(function(){t.onDrain()})).on("packet",(function(e){t.onPacket(e)})).on("error",(function(e){t.onError(e)})).on("close",(function(){t.onClose("transport close")}))},u.prototype.probe=function(e){a('probing transport "%s"',e);var t=this.createTransport(e,{probe:1}),n=!1,r=this;function o(){if(r.onlyBinaryUpgrades){var o=!this.supportsBinary&&r.transport.supportsBinary;n=n||o}n||(a('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",(function(o){if(!n)if("pong"===o.type&&"probe"===o.data){if(a('probe transport "%s" pong',e),r.upgrading=!0,r.emit("upgrading",t),!t)return;u.priorWebsocketSuccess="websocket"===t.name,a('pausing current transport "%s"',r.transport.name),r.transport.pause((function(){n||"closed"!==r.readyState&&(a("changing transport and sending upgrade packet"),p(),r.setTransport(t),t.send([{type:"upgrade"}]),r.emit("upgrade",t),t=null,r.upgrading=!1,r.flush())}))}else{a('probe transport "%s" failed',e);var i=new Error("probe error");i.transport=t.name,r.emit("upgradeError",i)}})))}function i(){n||(n=!0,p(),t.close(),t=null)}function s(n){var o=new Error("probe error: "+n);o.transport=t.name,i(),a('probe transport "%s" failed because of error: %s',e,n),r.emit("upgradeError",o)}function l(){s("transport closed")}function c(){s("socket closed")}function d(e){t&&e.name!==t.name&&(a('"%s" works - aborting "%s"',e.name,t.name),i())}function p(){t.removeListener("open",o),t.removeListener("error",s),t.removeListener("close",l),r.removeListener("close",c),r.removeListener("upgrading",d)}u.priorWebsocketSuccess=!1,t.once("open",o),t.once("error",s),t.once("close",l),this.once("close",c),this.once("upgrading",d),t.open()},u.prototype.onOpen=function(){if(a("socket open"),this.readyState="open",u.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){a("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},u.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(a('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else a('packet received with socket readyState "%s"',this.readyState)},u.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},u.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout((function(){"closed"!==t.readyState&&t.onClose("ping timeout")}),e||t.pingInterval+t.pingTimeout)},u.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout((function(){a("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)}),e.pingInterval)},u.prototype.ping=function(){var e=this;this.sendPacket("ping",(function(){e.emit("ping")}))},u.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},u.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(a("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},u.prototype.write=u.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},u.prototype.sendPacket=function(e,t,n,r){if("function"===typeof t&&(r=t,t=void 0),"function"===typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var o={type:e,data:t,options:n};this.emit("packetCreate",o),this.writeBuffer.push(o),r&&this.once("flush",r),this.flush()}},u.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var e=this;this.writeBuffer.length?this.once("drain",(function(){this.upgrading?r():t()})):this.upgrading?r():t()}function t(){e.onClose("forced close"),a("socket closing - telling transport to close"),e.transport.close()}function n(){e.removeListener("upgrade",n),e.removeListener("upgradeError",n),t()}function r(){e.once("upgrade",n),e.once("upgradeError",n)}return this},u.prototype.onError=function(e){a("socket error %j",e),u.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},u.prototype.onClose=function(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){a('socket close with reason: "%s"',e);clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0}},u.prototype.filterUpgrades=function(e){for(var t=[],n=0,r=e.length;n<r;n++)~i(this.transports,e[n])&&t.push(e[n]);return t}},44882:function(e,t,n){var r=n(27867),o=n(19621);function a(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.withCredentials=e.withCredentials,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.isReactNative=e.isReactNative,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}e.exports=a,o(a.prototype),a.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},a.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},a.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},a.prototype.send=function(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)},a.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},a.prototype.onData=function(e){var t=r.decodePacket(e,this.socket.binaryType);this.onPacket(t)},a.prototype.onPacket=function(e){this.emit("packet",e)},a.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},1162:function(e,t,n){var r=n(38532),o=n(55154),a=n(83526),i=n(9173);t.polling=function(e){var t=!1,n=!1,i=!1!==e.jsonp;if("undefined"!==typeof location){var s="https:"===location.protocol,l=location.port;l||(l=s?443:80),t=e.hostname!==location.hostname||l!==e.port,n=e.secure!==s}if(e.xdomain=t,e.xscheme=n,"open"in new r(e)&&!e.forceJSONP)return new o(e);if(!i)throw new Error("JSONP disabled");return new a(e)},t.websocket=i},83526:function(e,t,n){var r=n(28241),o=n(28960),a=n(1382);e.exports=u;var i,s=/\n/g,l=/\\n/g;function c(){}function u(e){r.call(this,e),this.query=this.query||{},i||(i=a.___eio=a.___eio||[]),this.index=i.length;var t=this;i.push((function(e){t.onData(e)})),this.query.j=this.index,"function"===typeof addEventListener&&addEventListener("beforeunload",(function(){t.script&&(t.script.onerror=c)}),!1)}o(u,r),u.prototype.supportsBinary=!1,u.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),r.prototype.doClose.call(this)},u.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(t,n):(document.head||document.body).appendChild(t),this.script=t,"undefined"!==typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout((function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)}),100)},u.prototype.doWrite=function(e,t){var n=this;if(!this.form){var r,o=document.createElement("form"),a=document.createElement("textarea"),i=this.iframeId="eio_iframe_"+this.index;o.className="socketio",o.style.position="absolute",o.style.top="-1000px",o.style.left="-1000px",o.target=i,o.method="POST",o.setAttribute("accept-charset","utf-8"),a.name="d",o.appendChild(a),document.body.appendChild(o),this.form=o,this.area=a}function c(){u(),t()}function u(){if(n.iframe)try{n.form.removeChild(n.iframe)}catch(t){n.onError("jsonp polling iframe removal error",t)}try{var e='<iframe src="javascript:0" name="'+n.iframeId+'">';r=document.createElement(e)}catch(t){(r=document.createElement("iframe")).name=n.iframeId,r.src="javascript:0"}r.id=n.iframeId,n.form.appendChild(r),n.iframe=r}this.form.action=this.uri(),u(),e=e.replace(l,"\\\n"),this.area.value=e.replace(s,"\\n");try{this.form.submit()}catch(d){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===n.iframe.readyState&&c()}:this.iframe.onload=c}},55154:function(e,t,n){var r=n(38532),o=n(28241),a=n(19621),i=n(28960),s=n(92775)("engine.io-client:polling-xhr"),l=n(1382);function c(){}function u(e){if(o.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,"undefined"!==typeof location){var t="https:"===location.protocol,n=location.port;n||(n=t?443:80),this.xd="undefined"!==typeof location&&e.hostname!==location.hostname||n!==e.port,this.xs=e.secure!==t}}function d(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.withCredentials=e.withCredentials,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}if(e.exports=u,e.exports.Request=d,i(u,o),u.prototype.supportsBinary=!0,u.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.withCredentials=this.withCredentials,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new d(e)},u.prototype.doWrite=function(e,t){var n="string"!==typeof e&&void 0!==e,r=this.request({method:"POST",data:e,isBinary:n}),o=this;r.on("success",t),r.on("error",(function(e){o.onError("xhr post error",e)})),this.sendXhr=r},u.prototype.doPoll=function(){s("xhr poll");var e=this.request(),t=this;e.on("data",(function(e){t.onData(e)})),e.on("error",(function(e){t.onError("xhr poll error",e)})),this.pollXhr=e},a(d.prototype),d.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new r(e),n=this;try{s("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var o in t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(o)&&t.setRequestHeader(o,this.extraHeaders[o])}catch(a){}if("POST"===this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(a){}try{t.setRequestHeader("Accept","*/*")}catch(a){}"withCredentials"in t&&(t.withCredentials=this.withCredentials),this.requestTimeout&&(t.timeout=this.requestTimeout),this.hasXDR()?(t.onload=function(){n.onLoad()},t.onerror=function(){n.onError(t.responseText)}):t.onreadystatechange=function(){if(2===t.readyState)try{var e=t.getResponseHeader("Content-Type");(n.supportsBinary&&"application/octet-stream"===e||"application/octet-stream; charset=UTF-8"===e)&&(t.responseType="arraybuffer")}catch(a){}4===t.readyState&&(200===t.status||1223===t.status?n.onLoad():setTimeout((function(){n.onError("number"===typeof t.status?t.status:0)}),0))},s("xhr data %s",this.data),t.send(this.data)}catch(a){return void setTimeout((function(){n.onError(a)}),0)}"undefined"!==typeof document&&(this.index=d.requestsCount++,d.requests[this.index]=this)},d.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},d.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},d.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},d.prototype.cleanup=function(e){if("undefined"!==typeof this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=c:this.xhr.onreadystatechange=c,e)try{this.xhr.abort()}catch(t){}"undefined"!==typeof document&&delete d.requests[this.index],this.xhr=null}},d.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type")}catch(n){}e=("application/octet-stream"===t||"application/octet-stream; charset=UTF-8"===t)&&this.xhr.response||this.xhr.responseText}catch(n){this.onError(n)}null!=e&&this.onData(e)},d.prototype.hasXDR=function(){return"undefined"!==typeof XDomainRequest&&!this.xs&&this.enablesXDR},d.prototype.abort=function(){this.cleanup()},d.requestsCount=0,d.requests={},"undefined"!==typeof document)if("function"===typeof attachEvent)attachEvent("onunload",p);else if("function"===typeof addEventListener){addEventListener("onpagehide"in l?"pagehide":"unload",p,!1)}function p(){for(var e in d.requests)d.requests.hasOwnProperty(e)&&d.requests[e].abort()}},28241:function(e,t,n){var r=n(44882),o=n(71914),a=n(27867),i=n(28960),s=n(7479),l=n(92775)("engine.io-client:polling");e.exports=u;var c=null!=new(n(38532))({xdomain:!1}).responseType;function u(e){var t=e&&e.forceBase64;c&&!t||(this.supportsBinary=!1),r.call(this,e)}i(u,r),u.prototype.name="polling",u.prototype.doOpen=function(){this.poll()},u.prototype.pause=function(e){var t=this;function n(){l("paused"),t.readyState="paused",e()}if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(l("we are currently polling - waiting to pause"),r++,this.once("pollComplete",(function(){l("pre-pause polling complete"),--r||n()}))),this.writable||(l("we are currently writing - waiting to pause"),r++,this.once("drain",(function(){l("pre-pause writing complete"),--r||n()})))}else n()},u.prototype.poll=function(){l("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},u.prototype.onData=function(e){var t=this;l("polling got data %s",e);a.decodePayload(e,this.socket.binaryType,(function(e,n,r){if("opening"===t.readyState&&"open"===e.type&&t.onOpen(),"close"===e.type)return t.onClose(),!1;t.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():l('ignoring poll - transport state "%s"',this.readyState))},u.prototype.doClose=function(){var e=this;function t(){l("writing close packet"),e.write([{type:"close"}])}"open"===this.readyState?(l("transport open - closing"),t()):(l("transport not open - deferring close"),this.once("open",t))},u.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")};a.encodePayload(e,this.supportsBinary,(function(e){t.doWrite(e,n)}))},u.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(e[this.timestampParam]=s()),this.supportsBinary||e.sid||(e.b64=1),e=o.encode(e),this.port&&("https"===t&&443!==Number(this.port)||"http"===t&&80!==Number(this.port))&&(n=":"+this.port),e.length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e}},9173:function(e,t,n){var r,o,a=n(93325).hp,i=n(44882),s=n(27867),l=n(71914),c=n(28960),u=n(7479),d=n(92775)("engine.io-client:websocket");if("undefined"!==typeof WebSocket?r=WebSocket:"undefined"!==typeof self&&(r=self.WebSocket||self.MozWebSocket),"undefined"===typeof window)try{o=n(25660)}catch(h){}var p=r||o;function f(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=r&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(p=o),i.call(this,e)}e.exports=f,c(f,i),f.prototype.name="websocket",f.prototype.supportsBinary=!0,f.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,n={};this.isReactNative||(n.agent=this.agent,n.perMessageDeflate=this.perMessageDeflate,n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized),this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?t?new p(e,t):new p(e):new p(e,t,n)}catch(r){return this.emit("error",r)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},f.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},f.prototype.write=function(e){var t=this;this.writable=!1;for(var n=e.length,r=0,o=n;r<o;r++)!function(e){s.encodePacket(e,t.supportsBinary,(function(r){if(!t.usingBrowserWebSocket){var o={};if(e.options&&(o.compress=e.options.compress),t.perMessageDeflate)("string"===typeof r?a.byteLength(r):r.length)<t.perMessageDeflate.threshold&&(o.compress=!1)}try{t.usingBrowserWebSocket?t.ws.send(r):t.ws.send(r,o)}catch(h){d("websocket closed before onclose event")}--n||i()}))}(e[r]);function i(){t.emit("flush"),setTimeout((function(){t.writable=!0,t.emit("drain")}),0)}},f.prototype.onClose=function(){i.prototype.onClose.call(this)},f.prototype.doClose=function(){"undefined"!==typeof this.ws&&this.ws.close()},f.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"===t&&443!==Number(this.port)||"ws"===t&&80!==Number(this.port))&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=u()),this.supportsBinary||(e.b64=1),(e=l.encode(e)).length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e},f.prototype.check=function(){return!!p&&!("__initialize"in p&&this.name===f.prototype.name)}},38532:function(e,t,n){var r=n(15913),o=n(1382);e.exports=function(e){var t=e.xdomain,n=e.xscheme,a=e.enablesXDR;try{if("undefined"!==typeof XMLHttpRequest&&(!t||r))return new XMLHttpRequest}catch(i){}try{if("undefined"!==typeof XDomainRequest&&!n&&a)return new XDomainRequest}catch(i){}if(!t)try{return new(o[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(i){}}},92775:function(e,t,n){var r=n(85224);function o(){var e;try{e=t.storage.debug}catch(n){}return!e&&"undefined"!==typeof r&&"env"in r&&(e={NODE_ENV:"production",PUBLIC_URL:"http://0.0.0.0:3000/assets/bundles",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.DEBUG),e}(t=e.exports=n(49980)).log=function(){return"object"===typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return;var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var o=0,a=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(o++,"%c"===e&&(a=o))})),e.splice(a,0,r)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(n){}},t.load=o,t.useColors=function(){if("undefined"!==typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},t.enable(o())},49980:function(e,t,n){function r(e){var n;function r(){if(r.enabled){var e=r,o=+new Date,a=o-(n||o);e.diff=a,e.prev=n,e.curr=o,n=o;for(var i=new Array(arguments.length),s=0;s<i.length;s++)i[s]=arguments[s];i[0]=t.coerce(i[0]),"string"!==typeof i[0]&&i.unshift("%O");var l=0;i[0]=i[0].replace(/%([a-zA-Z%])/g,(function(n,r){if("%%"===n)return n;l++;var o=t.formatters[r];if("function"===typeof o){var a=i[l];n=o.call(e,a),i.splice(l,1),l--}return n})),t.formatArgs.call(e,i),(r.log||t.log||console.log.bind(console)).apply(e,i)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=function(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}(e),r.destroy=o,"function"===typeof t.init&&t.init(r),t.instances.push(r),r}function o(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var n;t.save(e),t.names=[],t.skips=[];var r=("string"===typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var a=t.instances[n];a.enabled=t.enabled(a.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(55387),t.instances=[],t.names=[],t.skips=[],t.formatters={}},55387:function(e){var t=1e3,n=60*t,r=60*n,o=24*r,a=365.25*o;function i(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}e.exports=function(e,s){s=s||{};var l,c=typeof e;if("string"===c&&e.length>0)return function(e){if((e=String(e)).length>100)return;var i=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!i)return;var s=parseFloat(i[1]);switch((i[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return s*a;case"days":case"day":case"d":return s*o;case"hours":case"hour":case"hrs":case"hr":case"h":return s*r;case"minutes":case"minute":case"mins":case"min":case"m":return s*n;case"seconds":case"second":case"secs":case"sec":case"s":return s*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}(e);if("number"===c&&!1===isNaN(e))return s.long?i(l=e,o,"day")||i(l,r,"hour")||i(l,n,"minute")||i(l,t,"second")||l+" ms":function(e){if(e>=o)return Math.round(e/o)+"d";if(e>=r)return Math.round(e/r)+"h";if(e>=n)return Math.round(e/n)+"m";if(e>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},27867:function(e,t,n){var r,o=n(463),a=n(69349),i=n(95406),s=n(49539),l=n(91640);"undefined"!==typeof ArrayBuffer&&(r=n(48705));var c="undefined"!==typeof navigator&&/Android/i.test(navigator.userAgent),u="undefined"!==typeof navigator&&/PhantomJS/i.test(navigator.userAgent),d=c||u;t.protocol=3;var p=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},f=o(p),h={type:"error",data:"parser error"},m=n(4280);function g(e,t,n){for(var r=new Array(e.length),o=s(e.length,n),a=function(e,n,o){t(n,(function(t,n){r[e]=n,o(t,r)}))},i=0;i<e.length;i++)a(i,e[i],o)}t.encodePacket=function(e,n,r,o){"function"===typeof n&&(o=n,n=!1),"function"===typeof r&&(o=r,r=null);var a=void 0===e.data?void 0:e.data.buffer||e.data;if("undefined"!==typeof ArrayBuffer&&a instanceof ArrayBuffer)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var o=e.data,a=new Uint8Array(o),i=new Uint8Array(1+o.byteLength);i[0]=p[e.type];for(var s=0;s<a.length;s++)i[s+1]=a[s];return r(i.buffer)}(e,n,o);if("undefined"!==typeof m&&a instanceof m)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);if(d)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var o=new FileReader;return o.onload=function(){t.encodePacket({type:e.type,data:o.result},n,!0,r)},o.readAsArrayBuffer(e.data)}(e,n,r);var o=new Uint8Array(1);o[0]=p[e.type];var a=new m([o.buffer,e.data]);return r(a)}(e,n,o);if(a&&a.base64)return function(e,n){var r="b"+t.packets[e.type]+e.data.data;return n(r)}(e,o);var i=p[e.type];return void 0!==e.data&&(i+=r?l.encode(String(e.data),{strict:!1}):String(e.data)),o(""+i)},t.encodeBase64Packet=function(e,n){var r,o="b"+t.packets[e.type];if("undefined"!==typeof m&&e.data instanceof m){var a=new FileReader;return a.onload=function(){var e=a.result.split(",")[1];n(o+e)},a.readAsDataURL(e.data)}try{r=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(c){for(var i=new Uint8Array(e.data),s=new Array(i.length),l=0;l<i.length;l++)s[l]=i[l];r=String.fromCharCode.apply(null,s)}return o+=btoa(r),n(o)},t.decodePacket=function(e,n,r){if(void 0===e)return h;if("string"===typeof e){if("b"===e.charAt(0))return t.decodeBase64Packet(e.substr(1),n);if(r&&!1===(e=function(e){try{e=l.decode(e,{strict:!1})}catch(t){return!1}return e}(e)))return h;var o=e.charAt(0);return Number(o)==o&&f[o]?e.length>1?{type:f[o],data:e.substring(1)}:{type:f[o]}:h}o=new Uint8Array(e)[0];var a=i(e,1);return m&&"blob"===n&&(a=new m([a])),{type:f[o],data:a}},t.decodeBase64Packet=function(e,t){var n=f[e.charAt(0)];if(!r)return{type:n,data:{base64:!0,data:e.substr(1)}};var o=r.decode(e.substr(1));return"blob"===t&&m&&(o=new m([o])),{type:n,data:o}},t.encodePayload=function(e,n,r){"function"===typeof n&&(r=n,n=null);var o=a(e);if(n&&o)return m&&!d?t.encodePayloadAsBlob(e,r):t.encodePayloadAsArrayBuffer(e,r);if(!e.length)return r("0:");g(e,(function(e,r){t.encodePacket(e,!!o&&n,!1,(function(e){r(null,function(e){return e.length+":"+e}(e))}))}),(function(e,t){return r(t.join(""))}))},t.decodePayload=function(e,n,r){if("string"!==typeof e)return t.decodePayloadAsBinary(e,n,r);var o;if("function"===typeof n&&(r=n,n=null),""===e)return r(h,0,1);for(var a,i,s="",l=0,c=e.length;l<c;l++){var u=e.charAt(l);if(":"===u){if(""===s||s!=(a=Number(s)))return r(h,0,1);if(s!=(i=e.substr(l+1,a)).length)return r(h,0,1);if(i.length){if(o=t.decodePacket(i,n,!1),h.type===o.type&&h.data===o.data)return r(h,0,1);if(!1===r(o,l+a,c))return}l+=a,s=""}else s+=u}return""!==s?r(h,0,1):void 0},t.encodePayloadAsArrayBuffer=function(e,n){if(!e.length)return n(new ArrayBuffer(0));g(e,(function(e,n){t.encodePacket(e,!0,!0,(function(e){return n(null,e)}))}),(function(e,t){var r=t.reduce((function(e,t){var n;return e+(n="string"===typeof t?t.length:t.byteLength).toString().length+n+2}),0),o=new Uint8Array(r),a=0;return t.forEach((function(e){var t="string"===typeof e,n=e;if(t){for(var r=new Uint8Array(e.length),i=0;i<e.length;i++)r[i]=e.charCodeAt(i);n=r.buffer}o[a++]=t?0:1;var s=n.byteLength.toString();for(i=0;i<s.length;i++)o[a++]=parseInt(s[i]);o[a++]=255;for(r=new Uint8Array(n),i=0;i<r.length;i++)o[a++]=r[i]})),n(o.buffer)}))},t.encodePayloadAsBlob=function(e,n){g(e,(function(e,n){t.encodePacket(e,!0,!0,(function(e){var t=new Uint8Array(1);if(t[0]=1,"string"===typeof e){for(var r=new Uint8Array(e.length),o=0;o<e.length;o++)r[o]=e.charCodeAt(o);e=r.buffer,t[0]=0}var a=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),i=new Uint8Array(a.length+1);for(o=0;o<a.length;o++)i[o]=parseInt(a[o]);if(i[a.length]=255,m){var s=new m([t.buffer,i.buffer,e]);n(null,s)}}))}),(function(e,t){return n(new m(t))}))},t.decodePayloadAsBinary=function(e,n,r){"function"===typeof n&&(r=n,n=null);for(var o=e,a=[];o.byteLength>0;){for(var s=new Uint8Array(o),l=0===s[0],c="",u=1;255!==s[u];u++){if(c.length>310)return r(h,0,1);c+=s[u]}o=i(o,2+c.length),c=parseInt(c);var d=i(o,0,c);if(l)try{d=String.fromCharCode.apply(null,new Uint8Array(d))}catch(m){var p=new Uint8Array(d);d="";for(u=0;u<p.length;u++)d+=String.fromCharCode(p[u])}a.push(d),o=i(o,c)}var f=a.length;a.forEach((function(e,o){r(t.decodePacket(e,n,!0),o,f)}))}},463:function(e){e.exports=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var r in e)n.call(e,r)&&t.push(r);return t}},91640:function(e){var t,n,r,o=String.fromCharCode;function a(e){for(var t,n,r=[],o=0,a=e.length;o<a;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<a?56320==(64512&(n=e.charCodeAt(o++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),o--):r.push(t);return r}function i(e,t){if(e>=55296&&e<=57343){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function s(e,t){return o(e>>t&63|128)}function l(e,t){if(0==(4294967168&e))return o(e);var n="";return 0==(4294965248&e)?n=o(e>>6&31|192):0==(4294901760&e)?(i(e,t)||(e=65533),n=o(e>>12&15|224),n+=s(e,6)):0==(4292870144&e)&&(n=o(e>>18&7|240),n+=s(e,12),n+=s(e,6)),n+=o(63&e|128)}function c(){if(r>=n)throw Error("Invalid byte index");var e=255&t[r];if(r++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function u(e){var o,a;if(r>n)throw Error("Invalid byte index");if(r==n)return!1;if(o=255&t[r],r++,0==(128&o))return o;if(192==(224&o)){if((a=(31&o)<<6|c())>=128)return a;throw Error("Invalid continuation byte")}if(224==(240&o)){if((a=(15&o)<<12|c()<<6|c())>=2048)return i(a,e)?a:65533;throw Error("Invalid continuation byte")}if(240==(248&o)&&(a=(7&o)<<18|c()<<12|c()<<6|c())>=65536&&a<=1114111)return a;throw Error("Invalid UTF-8 detected")}e.exports={version:"2.1.2",encode:function(e,t){for(var n=!1!==(t=t||{}).strict,r=a(e),o=r.length,i=-1,s="";++i<o;)s+=l(r[i],n);return s},decode:function(e,i){var s=!1!==(i=i||{}).strict;t=a(e),n=t.length,r=0;for(var l,c=[];!1!==(l=u(s));)c.push(l);return function(e){for(var t,n=e.length,r=-1,a="";++r<n;)(t=e[r])>65535&&(a+=o((t-=65536)>>>10&1023|55296),t=56320|1023&t),a+=o(t);return a}(c)}}},742:function(e){"use strict";var t=/["'&<>]/;e.exports=function(e){var n,r=""+e,o=t.exec(r);if(!o)return r;var a="",i=0,s=0;for(i=o.index;i<r.length;i++){switch(r.charCodeAt(i)){case 34:n="&quot;";break;case 38:n="&amp;";break;case 39:n="&#39;";break;case 60:n="&lt;";break;case 62:n="&gt;";break;default:continue}s!==i&&(a+=r.substring(s,i)),s=i+1,a+=n}return s!==i?a+r.substring(s,i):a}},69349:function(e,t,n){var r=n(93325).hp,o=n(47994),a=Object.prototype.toString,i="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===a.call(Blob),s="function"===typeof File||"undefined"!==typeof File&&"[object FileConstructor]"===a.call(File);e.exports=function e(t){if(!t||"object"!==typeof t)return!1;if(o(t)){for(var n=0,a=t.length;n<a;n++)if(e(t[n]))return!0;return!1}if("function"===typeof r&&r.isBuffer&&r.isBuffer(t)||"function"===typeof ArrayBuffer&&t instanceof ArrayBuffer||i&&t instanceof Blob||s&&t instanceof File)return!0;if(t.toJSON&&"function"===typeof t.toJSON&&1===arguments.length)return e(t.toJSON(),!0);for(var l in t)if(Object.prototype.hasOwnProperty.call(t,l)&&e(t[l]))return!0;return!1}},47994:function(e){var t={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==t.call(e)}},15913:function(e){try{e.exports="undefined"!==typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},95896:function(e){var t=[].indexOf;e.exports=function(e,n){if(t)return e.indexOf(n);for(var r=0;r<e.length;++r)if(e[r]===n)return r;return-1}},10865:function(e,t,n){"use strict";var r;function o(e){return e.type===r.literal}function a(e){return e.type===r.argument}function i(e){return e.type===r.number}function s(e){return e.type===r.date}function l(e){return e.type===r.time}function c(e){return e.type===r.select}function u(e){return e.type===r.plural}function d(e){return e.type===r.pound}function p(e){return!(!e||"object"!==typeof e||0!==e.type)}function f(e){return!(!e||"object"!==typeof e||1!==e.type)}n.r(t),n.d(t,{IntlMessageFormat:function(){return J},createDefaultFormatters:function(){return $},default:function(){return Q},formatHTMLMessage:function(){return K},formatToParts:function(){return F},formatToString:function(){return U}}),function(e){e[e.literal=0]="literal",e[e.argument=1]="argument",e[e.number=2]="number",e[e.date=3]="date",e[e.time=4]="time",e[e.select=5]="select",e[e.plural=6]="plural",e[e.pound=7]="pound"}(r||(r={}));var h=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),m=function(){return m=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},m.apply(this,arguments)},g=function(e){function t(n,r,o,a){var i=e.call(this)||this;return i.message=n,i.expected=r,i.found=o,i.location=a,i.name="SyntaxError","function"===typeof Error.captureStackTrace&&Error.captureStackTrace(i,t),i}return h(t,e),t.buildMessage=function(e,t){function n(e){return e.charCodeAt(0).toString(16).toUpperCase()}function r(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function o(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function a(e){switch(e.type){case"literal":return'"'+r(e.text)+'"';case"class":var t=e.parts.map((function(e){return Array.isArray(e)?o(e[0])+"-"+o(e[1]):o(e)}));return"["+(e.inverted?"^":"")+t+"]";case"any":return"any character";case"end":return"end of input";case"other":return e.description}}return"Expected "+function(e){var t,n,r=e.map(a);if(r.sort(),r.length>0){for(t=1,n=1;t<r.length;t++)r[t-1]!==r[t]&&(r[n]=r[t],n++);r.length=n}switch(r.length){case 1:return r[0];case 2:return r[0]+" or "+r[1];default:return r.slice(0,-1).join(", ")+", or "+r[r.length-1]}}(e)+" but "+(((i=t)?'"'+r(i)+'"':"end of input")+" found.");var i},t}(Error);var v=function(e,t){t=void 0!==t?t:{};var n,o={},a={start:ut},i=ut,s=function(e){return e.join("")},l=function(e){return m({type:r.literal,value:e},Tt())},c="#",u=rt("#",!1),d=function(){return m({type:r.pound},Tt())},p=at("argumentElement"),f="{",h=rt("{",!1),v="}",y=rt("}",!1),C=function(e){return m({type:r.argument,value:e},Tt())},A=at("numberSkeletonId"),x=/^['\/{}]/,b=ot(["'","/","{","}"],!1,!1),_={type:"any"},w=at("numberSkeletonTokenOption"),S="/",D=rt("/",!1),E=function(e){return e},k=at("numberSkeletonToken"),M=function(e,t){return{stem:e,options:t}},I=function(e){return m({type:0,tokens:e},Tt())},N="::",P=rt("::",!1),T=function(e){return e},O=function(){return Nt.push("numberArgStyle"),!0},j=function(e){return Nt.pop(),e.replace(/\s*$/,"")},R=",",L=rt(",",!1),F="number",U=rt("number",!1),Y=function(e,t,n){return m({type:"number"===t?r.number:"date"===t?r.date:r.time,style:n&&n[2],value:e},Tt())},B="'",H=rt("'",!1),V=/^[^']/,G=ot(["'"],!0,!1),q=/^[^a-zA-Z'{}]/,z=ot([["a","z"],["A","Z"],"'","{","}"],!0,!1),W=/^[a-zA-Z]/,K=ot([["a","z"],["A","Z"]],!1,!1),Z=function(e){return m({type:1,pattern:e},Tt())},X=function(){return Nt.push("dateOrTimeArgStyle"),!0},$="date",J=rt("date",!1),Q="time",ee=rt("time",!1),te="plural",ne=rt("plural",!1),re="selectordinal",oe=rt("selectordinal",!1),ae="offset:",ie=rt("offset:",!1),se=function(e,t,n,o){return m({type:r.plural,pluralType:"plural"===t?"cardinal":"ordinal",value:e,offset:n?n[2]:0,options:o.reduce((function(e,t){var n=t.id,r=t.value,o=t.location;return n in e&&nt('Duplicate option "'+n+'" in plural element: "'+et()+'"',tt()),e[n]={value:r,location:o},e}),{})},Tt())},le="select",ce=rt("select",!1),ue=function(e,t){return m({type:r.select,value:e,options:t.reduce((function(e,t){var n=t.id,r=t.value,o=t.location;return n in e&&nt('Duplicate option "'+n+'" in select element: "'+et()+'"',tt()),e[n]={value:r,location:o},e}),{})},Tt())},de="=",pe=rt("=",!1),fe=function(e){return Nt.push("select"),!0},he=function(e,t){return Nt.pop(),m({id:e,value:t},Tt())},me=function(e){return Nt.push("plural"),!0},ge=function(e,t){return Nt.pop(),m({id:e,value:t},Tt())},ve=at("whitespace"),ye=/^[\t-\r \x85\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/,Ce=ot([["\t","\r"]," ","\x85","\xa0","\u1680",["\u2000","\u200a"],"\u2028","\u2029","\u202f","\u205f","\u3000"],!1,!1),Ae=at("syntax pattern"),xe=/^[!-\/:-@[-\^`{-~\xA1-\xA7\xA9\xAB\xAC\xAE\xB0\xB1\xB6\xBB\xBF\xD7\xF7\u2010-\u2027\u2030-\u203E\u2041-\u2053\u2055-\u205E\u2190-\u245F\u2500-\u2775\u2794-\u2BFF\u2E00-\u2E7F\u3001-\u3003\u3008-\u3020\u3030\uFD3E\uFD3F\uFE45\uFE46]/,be=ot([["!","/"],[":","@"],["[","^"],"`",["{","~"],["\xa1","\xa7"],"\xa9","\xab","\xac","\xae","\xb0","\xb1","\xb6","\xbb","\xbf","\xd7","\xf7",["\u2010","\u2027"],["\u2030","\u203e"],["\u2041","\u2053"],["\u2055","\u205e"],["\u2190","\u245f"],["\u2500","\u2775"],["\u2794","\u2bff"],["\u2e00","\u2e7f"],["\u3001","\u3003"],["\u3008","\u3020"],"\u3030","\ufd3e","\ufd3f","\ufe45","\ufe46"],!1,!1),_e=at("optional whitespace"),we=at("number"),Se="-",De=rt("-",!1),Ee=function(e,t){return t?e?-t:t:0},ke=(at("apostrophe"),at("double apostrophes")),Me="''",Ie=rt("''",!1),Ne=function(){return"'"},Pe=function(e,t){return e+t.replace("''","'")},Te=function(e){return"{"!==e&&!(Pt()&&"#"===e)&&!(Nt.length>1&&"}"===e)},Oe="\n",je=rt("\n",!1),Re=function(e){return"{"===e||"}"===e||Pt()&&"#"===e},Le=at("argNameOrNumber"),Fe=at("argNumber"),Ue="0",Ye=rt("0",!1),Be=function(){return 0},He=/^[1-9]/,Ve=ot([["1","9"]],!1,!1),Ge=/^[0-9]/,qe=ot([["0","9"]],!1,!1),ze=function(e){return parseInt(e.join(""),10)},We=at("argName"),Ke=0,Ze=0,Xe=[{line:1,column:1}],$e=0,Je=[],Qe=0;if(void 0!==t.startRule){if(!(t.startRule in a))throw new Error("Can't start parsing from rule \""+t.startRule+'".');i=a[t.startRule]}function et(){return e.substring(Ze,Ke)}function tt(){return st(Ze,Ke)}function nt(e,t){throw function(e,t){return new g(e,[],"",t)}(e,t=void 0!==t?t:st(Ze,Ke))}function rt(e,t){return{type:"literal",text:e,ignoreCase:t}}function ot(e,t,n){return{type:"class",parts:e,inverted:t,ignoreCase:n}}function at(e){return{type:"other",description:e}}function it(t){var n,r=Xe[t];if(r)return r;for(n=t-1;!Xe[n];)n--;for(r={line:(r=Xe[n]).line,column:r.column};n<t;)10===e.charCodeAt(n)?(r.line++,r.column=1):r.column++,n++;return Xe[t]=r,r}function st(e,t){var n=it(e),r=it(t);return{start:{offset:e,line:n.line,column:n.column},end:{offset:t,line:r.line,column:r.column}}}function lt(e){Ke<$e||(Ke>$e&&($e=Ke,Je=[]),Je.push(e))}function ct(e,t,n){return new g(g.buildMessage(e,t),e,t,n)}function ut(){return dt()}function dt(){var e,t;for(e=[],t=pt();t!==o;)e.push(t),t=pt();return e}function pt(){var t;return(t=function(){var e,t;e=Ke,(t=ft())!==o&&(Ze=e,t=l(t));return e=t,e}())===o&&(t=function(){var t,n,r,a;Qe++,t=Ke,123===e.charCodeAt(Ke)?(n=f,Ke++):(n=o,0===Qe&&lt(h));n!==o&&_t()!==o&&(r=kt())!==o&&_t()!==o?(125===e.charCodeAt(Ke)?(a=v,Ke++):(a=o,0===Qe&&lt(y)),a!==o?(Ze=t,t=n=C(r)):(Ke=t,t=o)):(Ke=t,t=o);Qe--,t===o&&(n=o,0===Qe&&lt(p));return t}())===o&&(t=function(){var t;t=function(){var t,n,r,a,i,s,l,c,u;t=Ke,123===e.charCodeAt(Ke)?(n=f,Ke++):(n=o,0===Qe&&lt(h));n!==o&&_t()!==o&&(r=kt())!==o&&_t()!==o?(44===e.charCodeAt(Ke)?(a=R,Ke++):(a=o,0===Qe&&lt(L)),a!==o&&_t()!==o?(e.substr(Ke,6)===F?(i=F,Ke+=6):(i=o,0===Qe&&lt(U)),i!==o&&_t()!==o?(s=Ke,44===e.charCodeAt(Ke)?(l=R,Ke++):(l=o,0===Qe&&lt(L)),l!==o&&(c=_t())!==o?(u=function(){var t,n,r;t=Ke,e.substr(Ke,2)===N?(n=N,Ke+=2):(n=o,0===Qe&&lt(P));n!==o?(r=function(){var e,t,n;if(e=Ke,t=[],n=gt(),n!==o)for(;n!==o;)t.push(n),n=gt();else t=o;t!==o&&(Ze=e,t=I(t));return e=t,e}(),r!==o?(Ze=t,t=n=T(r)):(Ke=t,t=o)):(Ke=t,t=o);t===o&&(t=Ke,Ze=Ke,(n=(n=O())?void 0:o)!==o&&(r=ft())!==o?(Ze=t,t=n=j(r)):(Ke=t,t=o));return t}(),u!==o?s=l=[l,c,u]:(Ke=s,s=o)):(Ke=s,s=o),s===o&&(s=null),s!==o&&(l=_t())!==o?(125===e.charCodeAt(Ke)?(c=v,Ke++):(c=o,0===Qe&&lt(y)),c!==o?(Ze=t,t=n=Y(r,i,s)):(Ke=t,t=o)):(Ke=t,t=o)):(Ke=t,t=o)):(Ke=t,t=o)):(Ke=t,t=o);return t}(),t===o&&(t=function(){var t,n,r,a,i,s,l,c,u;t=Ke,123===e.charCodeAt(Ke)?(n=f,Ke++):(n=o,0===Qe&&lt(h));n!==o&&_t()!==o&&(r=kt())!==o&&_t()!==o?(44===e.charCodeAt(Ke)?(a=R,Ke++):(a=o,0===Qe&&lt(L)),a!==o&&_t()!==o?(e.substr(Ke,4)===$?(i=$,Ke+=4):(i=o,0===Qe&&lt(J)),i===o&&(e.substr(Ke,4)===Q?(i=Q,Ke+=4):(i=o,0===Qe&&lt(ee))),i!==o&&_t()!==o?(s=Ke,44===e.charCodeAt(Ke)?(l=R,Ke++):(l=o,0===Qe&&lt(L)),l!==o&&(c=_t())!==o?(u=function(){var t,n,r;t=Ke,e.substr(Ke,2)===N?(n=N,Ke+=2):(n=o,0===Qe&&lt(P));n!==o?(r=function(){var t,n,r,a;t=Ke,n=Ke,r=[],a=vt(),a===o&&(a=yt());if(a!==o)for(;a!==o;)r.push(a),(a=vt())===o&&(a=yt());else r=o;n=r!==o?e.substring(n,Ke):r;n!==o&&(Ze=t,n=Z(n));return t=n,t}(),r!==o?(Ze=t,t=n=T(r)):(Ke=t,t=o)):(Ke=t,t=o);t===o&&(t=Ke,Ze=Ke,(n=(n=X())?void 0:o)!==o&&(r=ft())!==o?(Ze=t,t=n=j(r)):(Ke=t,t=o));return t}(),u!==o?s=l=[l,c,u]:(Ke=s,s=o)):(Ke=s,s=o),s===o&&(s=null),s!==o&&(l=_t())!==o?(125===e.charCodeAt(Ke)?(c=v,Ke++):(c=o,0===Qe&&lt(y)),c!==o?(Ze=t,t=n=Y(r,i,s)):(Ke=t,t=o)):(Ke=t,t=o)):(Ke=t,t=o)):(Ke=t,t=o)):(Ke=t,t=o);return t}());return t}())===o&&(t=function(){var t,n,r,a,i,s,l,c,u,d,p;t=Ke,123===e.charCodeAt(Ke)?(n=f,Ke++):(n=o,0===Qe&&lt(h));if(n!==o)if(_t()!==o)if((r=kt())!==o)if(_t()!==o)if(44===e.charCodeAt(Ke)?(a=R,Ke++):(a=o,0===Qe&&lt(L)),a!==o)if(_t()!==o)if(e.substr(Ke,6)===te?(i=te,Ke+=6):(i=o,0===Qe&&lt(ne)),i===o&&(e.substr(Ke,13)===re?(i=re,Ke+=13):(i=o,0===Qe&&lt(oe))),i!==o)if(_t()!==o)if(44===e.charCodeAt(Ke)?(s=R,Ke++):(s=o,0===Qe&&lt(L)),s!==o)if(_t()!==o)if(l=Ke,e.substr(Ke,7)===ae?(c=ae,Ke+=7):(c=o,0===Qe&&lt(ie)),c!==o&&(u=_t())!==o&&(d=wt())!==o?l=c=[c,u,d]:(Ke=l,l=o),l===o&&(l=null),l!==o)if((c=_t())!==o){if(u=[],(d=At())!==o)for(;d!==o;)u.push(d),d=At();else u=o;u!==o&&(d=_t())!==o?(125===e.charCodeAt(Ke)?(p=v,Ke++):(p=o,0===Qe&&lt(y)),p!==o?(Ze=t,t=n=se(r,i,l,u)):(Ke=t,t=o)):(Ke=t,t=o)}else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;return t}())===o&&(t=function(){var t,n,r,a,i,s,l,c,u;t=Ke,123===e.charCodeAt(Ke)?(n=f,Ke++):(n=o,0===Qe&&lt(h));if(n!==o)if(_t()!==o)if((r=kt())!==o)if(_t()!==o)if(44===e.charCodeAt(Ke)?(a=R,Ke++):(a=o,0===Qe&&lt(L)),a!==o)if(_t()!==o)if(e.substr(Ke,6)===le?(i=le,Ke+=6):(i=o,0===Qe&&lt(ce)),i!==o)if(_t()!==o)if(44===e.charCodeAt(Ke)?(s=R,Ke++):(s=o,0===Qe&&lt(L)),s!==o)if(_t()!==o){if(l=[],(c=Ct())!==o)for(;c!==o;)l.push(c),c=Ct();else l=o;l!==o&&(c=_t())!==o?(125===e.charCodeAt(Ke)?(u=v,Ke++):(u=o,0===Qe&&lt(y)),u!==o?(Ze=t,t=n=ue(r,l)):(Ke=t,t=o)):(Ke=t,t=o)}else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;return t}())===o&&(t=function(){var t,n;t=Ke,35===e.charCodeAt(Ke)?(n=c,Ke++):(n=o,0===Qe&&lt(u));n!==o&&(Ze=t,n=d());return t=n,t}()),t}function ft(){var e,t,n;if(e=Ke,t=[],(n=St())===o&&(n=Dt())===o&&(n=Et()),n!==o)for(;n!==o;)t.push(n),(n=St())===o&&(n=Dt())===o&&(n=Et());else t=o;return t!==o&&(Ze=e,t=s(t)),e=t}function ht(){var t,n,r,a,i;if(Qe++,t=Ke,n=[],r=Ke,a=Ke,Qe++,(i=xt())===o&&(x.test(e.charAt(Ke))?(i=e.charAt(Ke),Ke++):(i=o,0===Qe&&lt(b))),Qe--,i===o?a=void 0:(Ke=a,a=o),a!==o?(e.length>Ke?(i=e.charAt(Ke),Ke++):(i=o,0===Qe&&lt(_)),i!==o?r=a=[a,i]:(Ke=r,r=o)):(Ke=r,r=o),r!==o)for(;r!==o;)n.push(r),r=Ke,a=Ke,Qe++,(i=xt())===o&&(x.test(e.charAt(Ke))?(i=e.charAt(Ke),Ke++):(i=o,0===Qe&&lt(b))),Qe--,i===o?a=void 0:(Ke=a,a=o),a!==o?(e.length>Ke?(i=e.charAt(Ke),Ke++):(i=o,0===Qe&&lt(_)),i!==o?r=a=[a,i]:(Ke=r,r=o)):(Ke=r,r=o);else n=o;return t=n!==o?e.substring(t,Ke):n,Qe--,t===o&&(n=o,0===Qe&&lt(A)),t}function mt(){var t,n,r;return Qe++,t=Ke,47===e.charCodeAt(Ke)?(n=S,Ke++):(n=o,0===Qe&&lt(D)),n!==o&&(r=ht())!==o?(Ze=t,t=n=E(r)):(Ke=t,t=o),Qe--,t===o&&(n=o,0===Qe&&lt(w)),t}function gt(){var e,t,n,r;if(Qe++,e=Ke,_t()!==o)if((t=ht())!==o){for(n=[],r=mt();r!==o;)n.push(r),r=mt();n!==o?(Ze=e,e=M(t,n)):(Ke=e,e=o)}else Ke=e,e=o;else Ke=e,e=o;return Qe--,e===o&&(0===Qe&&lt(k)),e}function vt(){var t,n,r,a;if(t=Ke,39===e.charCodeAt(Ke)?(n=B,Ke++):(n=o,0===Qe&&lt(H)),n!==o){if(r=[],(a=St())===o&&(V.test(e.charAt(Ke))?(a=e.charAt(Ke),Ke++):(a=o,0===Qe&&lt(G))),a!==o)for(;a!==o;)r.push(a),(a=St())===o&&(V.test(e.charAt(Ke))?(a=e.charAt(Ke),Ke++):(a=o,0===Qe&&lt(G)));else r=o;r!==o?(39===e.charCodeAt(Ke)?(a=B,Ke++):(a=o,0===Qe&&lt(H)),a!==o?t=n=[n,r,a]:(Ke=t,t=o)):(Ke=t,t=o)}else Ke=t,t=o;if(t===o)if(t=[],(n=St())===o&&(q.test(e.charAt(Ke))?(n=e.charAt(Ke),Ke++):(n=o,0===Qe&&lt(z))),n!==o)for(;n!==o;)t.push(n),(n=St())===o&&(q.test(e.charAt(Ke))?(n=e.charAt(Ke),Ke++):(n=o,0===Qe&&lt(z)));else t=o;return t}function yt(){var t,n;if(t=[],W.test(e.charAt(Ke))?(n=e.charAt(Ke),Ke++):(n=o,0===Qe&&lt(K)),n!==o)for(;n!==o;)t.push(n),W.test(e.charAt(Ke))?(n=e.charAt(Ke),Ke++):(n=o,0===Qe&&lt(K));else t=o;return t}function Ct(){var t,n,r,a,i;return t=Ke,_t()!==o&&(n=It())!==o&&_t()!==o?(123===e.charCodeAt(Ke)?(r=f,Ke++):(r=o,0===Qe&&lt(h)),r!==o?(Ze=Ke,(fe(n)?void 0:o)!==o&&(a=dt())!==o?(125===e.charCodeAt(Ke)?(i=v,Ke++):(i=o,0===Qe&&lt(y)),i!==o?(Ze=t,t=he(n,a)):(Ke=t,t=o)):(Ke=t,t=o)):(Ke=t,t=o)):(Ke=t,t=o),t}function At(){var t,n,r,a,i;return t=Ke,_t()!==o?(n=function(){var t,n,r,a;return t=Ke,n=Ke,61===e.charCodeAt(Ke)?(r=de,Ke++):(r=o,0===Qe&&lt(pe)),r!==o&&(a=wt())!==o?n=r=[r,a]:(Ke=n,n=o),(t=n!==o?e.substring(t,Ke):n)===o&&(t=It()),t}(),n!==o&&_t()!==o?(123===e.charCodeAt(Ke)?(r=f,Ke++):(r=o,0===Qe&&lt(h)),r!==o?(Ze=Ke,(me(n)?void 0:o)!==o&&(a=dt())!==o?(125===e.charCodeAt(Ke)?(i=v,Ke++):(i=o,0===Qe&&lt(y)),i!==o?(Ze=t,t=ge(n,a)):(Ke=t,t=o)):(Ke=t,t=o)):(Ke=t,t=o)):(Ke=t,t=o)):(Ke=t,t=o),t}function xt(){var t;return Qe++,ye.test(e.charAt(Ke))?(t=e.charAt(Ke),Ke++):(t=o,0===Qe&&lt(Ce)),Qe--,t===o&&(0===Qe&&lt(ve)),t}function bt(){var t;return Qe++,xe.test(e.charAt(Ke))?(t=e.charAt(Ke),Ke++):(t=o,0===Qe&&lt(be)),Qe--,t===o&&(0===Qe&&lt(Ae)),t}function _t(){var t,n,r;for(Qe++,t=Ke,n=[],r=xt();r!==o;)n.push(r),r=xt();return t=n!==o?e.substring(t,Ke):n,Qe--,t===o&&(n=o,0===Qe&&lt(_e)),t}function wt(){var t,n,r;return Qe++,t=Ke,45===e.charCodeAt(Ke)?(n=Se,Ke++):(n=o,0===Qe&&lt(De)),n===o&&(n=null),n!==o&&(r=Mt())!==o?(Ze=t,t=n=Ee(n,r)):(Ke=t,t=o),Qe--,t===o&&(n=o,0===Qe&&lt(we)),t}function St(){var t,n;return Qe++,t=Ke,e.substr(Ke,2)===Me?(n=Me,Ke+=2):(n=o,0===Qe&&lt(Ie)),n!==o&&(Ze=t,n=Ne()),Qe--,(t=n)===o&&(n=o,0===Qe&&lt(ke)),t}function Dt(){var t,n,r,a,i,s;if(t=Ke,39===e.charCodeAt(Ke)?(n=B,Ke++):(n=o,0===Qe&&lt(H)),n!==o)if(r=function(){var t,n,r,a;t=Ke,n=Ke,e.length>Ke?(r=e.charAt(Ke),Ke++):(r=o,0===Qe&&lt(_));r!==o?(Ze=Ke,(a=(a=Re(r))?void 0:o)!==o?n=r=[r,a]:(Ke=n,n=o)):(Ke=n,n=o);t=n!==o?e.substring(t,Ke):n;return t}(),r!==o){for(a=Ke,i=[],e.substr(Ke,2)===Me?(s=Me,Ke+=2):(s=o,0===Qe&&lt(Ie)),s===o&&(V.test(e.charAt(Ke))?(s=e.charAt(Ke),Ke++):(s=o,0===Qe&&lt(G)));s!==o;)i.push(s),e.substr(Ke,2)===Me?(s=Me,Ke+=2):(s=o,0===Qe&&lt(Ie)),s===o&&(V.test(e.charAt(Ke))?(s=e.charAt(Ke),Ke++):(s=o,0===Qe&&lt(G)));(a=i!==o?e.substring(a,Ke):i)!==o?(39===e.charCodeAt(Ke)?(i=B,Ke++):(i=o,0===Qe&&lt(H)),i===o&&(i=null),i!==o?(Ze=t,t=n=Pe(r,a)):(Ke=t,t=o)):(Ke=t,t=o)}else Ke=t,t=o;else Ke=t,t=o;return t}function Et(){var t,n,r,a;return t=Ke,n=Ke,e.length>Ke?(r=e.charAt(Ke),Ke++):(r=o,0===Qe&&lt(_)),r!==o?(Ze=Ke,(a=(a=Te(r))?void 0:o)!==o?n=r=[r,a]:(Ke=n,n=o)):(Ke=n,n=o),n===o&&(10===e.charCodeAt(Ke)?(n=Oe,Ke++):(n=o,0===Qe&&lt(je))),t=n!==o?e.substring(t,Ke):n}function kt(){var t,n;return Qe++,t=Ke,(n=Mt())===o&&(n=It()),t=n!==o?e.substring(t,Ke):n,Qe--,t===o&&(n=o,0===Qe&&lt(Le)),t}function Mt(){var t,n,r,a,i;if(Qe++,t=Ke,48===e.charCodeAt(Ke)?(n=Ue,Ke++):(n=o,0===Qe&&lt(Ye)),n!==o&&(Ze=t,n=Be()),(t=n)===o){if(t=Ke,n=Ke,He.test(e.charAt(Ke))?(r=e.charAt(Ke),Ke++):(r=o,0===Qe&&lt(Ve)),r!==o){for(a=[],Ge.test(e.charAt(Ke))?(i=e.charAt(Ke),Ke++):(i=o,0===Qe&&lt(qe));i!==o;)a.push(i),Ge.test(e.charAt(Ke))?(i=e.charAt(Ke),Ke++):(i=o,0===Qe&&lt(qe));a!==o?n=r=[r,a]:(Ke=n,n=o)}else Ke=n,n=o;n!==o&&(Ze=t,n=ze(n)),t=n}return Qe--,t===o&&(n=o,0===Qe&&lt(Fe)),t}function It(){var t,n,r,a,i;if(Qe++,t=Ke,n=[],r=Ke,a=Ke,Qe++,(i=xt())===o&&(i=bt()),Qe--,i===o?a=void 0:(Ke=a,a=o),a!==o?(e.length>Ke?(i=e.charAt(Ke),Ke++):(i=o,0===Qe&&lt(_)),i!==o?r=a=[a,i]:(Ke=r,r=o)):(Ke=r,r=o),r!==o)for(;r!==o;)n.push(r),r=Ke,a=Ke,Qe++,(i=xt())===o&&(i=bt()),Qe--,i===o?a=void 0:(Ke=a,a=o),a!==o?(e.length>Ke?(i=e.charAt(Ke),Ke++):(i=o,0===Qe&&lt(_)),i!==o?r=a=[a,i]:(Ke=r,r=o)):(Ke=r,r=o);else n=o;return t=n!==o?e.substring(t,Ke):n,Qe--,t===o&&(n=o,0===Qe&&lt(We)),t}var Nt=["root"];function Pt(){return"plural"===Nt[Nt.length-1]}function Tt(){return t&&t.captureLocation?{location:tt()}:{}}if((n=i())!==o&&Ke===e.length)return n;throw n!==o&&Ke<e.length&&lt({type:"end"}),ct(Je,$e<e.length?e.charAt($e):null,$e<e.length?st($e,$e+1):st($e,$e))},y=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var a=arguments[t],i=0,s=a.length;i<s;i++,o++)r[o]=a[i];return r},C=/(^|[^\\])#/g;function A(e){e.forEach((function(e){(u(e)||c(e))&&Object.keys(e.options).forEach((function(t){for(var n,r=e.options[t],a=-1,i=void 0,s=0;s<r.value.length;s++){var l=r.value[s];if(o(l)&&C.test(l.value)){a=s,i=l;break}}if(i){var c=i.value.replace(C,"$1{"+e.value+", number}"),u=v(c);(n=r.value).splice.apply(n,y([a,1],u))}A(r.value)}))}))}function x(e,t){var n=v(e,t);return t&&!1===t.normalizeHashtagInPlural||A(n),n}var b=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var a=arguments[t],i=0,s=a.length;i<s;i++,o++)r[o]=a[i];return r};function _(e){return JSON.stringify(e.map((function(e){return e&&"object"===typeof e?(t=e,Object.keys(t).sort().map((function(e){var n;return(n={})[e]=t[e],n}))):e;var t})))}var w=function(e,t){return void 0===t&&(t={}),function(){for(var n,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];var a=_(r),i=a&&t[a];return i||(i=new((n=e).bind.apply(n,b([void 0],r))),a&&(t[a]=i)),i}},S=function(){return S=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},S.apply(this,arguments)},D=/(?:[Eec]{1,6}|G{1,5}|[Qq]{1,5}|(?:[yYur]+|U{1,5})|[ML]{1,5}|d{1,2}|D{1,3}|F{1}|[abB]{1,5}|[hkHK]{1,2}|w{1,2}|W{1}|m{1,2}|s{1,2}|[zZOvVxX]{1,4})(?=([^']*'[^']*')*[^']*$)/g;function E(e){var t={};return e.replace(D,(function(e){var n=e.length;switch(e[0]){case"G":t.era=4===n?"long":5===n?"narrow":"short";break;case"y":t.year=2===n?"2-digit":"numeric";break;case"Y":case"u":case"U":case"r":throw new RangeError("`Y/u/U/r` (year) patterns are not supported, use `y` instead");case"q":case"Q":throw new RangeError("`q/Q` (quarter) patterns are not supported");case"M":case"L":t.month=["numeric","2-digit","short","long","narrow"][n-1];break;case"w":case"W":throw new RangeError("`w/W` (week) patterns are not supported");case"d":t.day=["numeric","2-digit"][n-1];break;case"D":case"F":case"g":throw new RangeError("`D/F/g` (day) patterns are not supported, use `d` instead");case"E":t.weekday=4===n?"short":5===n?"narrow":"short";break;case"e":if(n<4)throw new RangeError("`e..eee` (weekday) patterns are not supported");t.weekday=["short","long","narrow","short"][n-4];break;case"c":if(n<4)throw new RangeError("`c..ccc` (weekday) patterns are not supported");t.weekday=["short","long","narrow","short"][n-4];break;case"a":t.hour12=!0;break;case"b":case"B":throw new RangeError("`b/B` (period) patterns are not supported, use `a` instead");case"h":t.hourCycle="h12",t.hour=["numeric","2-digit"][n-1];break;case"H":t.hourCycle="h23",t.hour=["numeric","2-digit"][n-1];break;case"K":t.hourCycle="h11",t.hour=["numeric","2-digit"][n-1];break;case"k":t.hourCycle="h24",t.hour=["numeric","2-digit"][n-1];break;case"j":case"J":case"C":throw new RangeError("`j/J/C` (hour) patterns are not supported, use `h/H/K/k` instead");case"m":t.minute=["numeric","2-digit"][n-1];break;case"s":t.second=["numeric","2-digit"][n-1];break;case"S":case"A":throw new RangeError("`S/A` (second) pattenrs are not supported, use `s` instead");case"z":t.timeZoneName=n<4?"short":"long";break;case"Z":case"O":case"v":case"V":case"X":case"x":throw new RangeError("`Z/O/v/V/X/x` (timeZone) pattenrs are not supported, use `z` instead")}return""})),t}var k=/^\.(?:(0+)(\+|#+)?)?$/g,M=/^(@+)?(\+|#+)?$/g;function I(e){var t={};return e.replace(M,(function(e,n,r){return"string"!==typeof r?(t.minimumSignificantDigits=n.length,t.maximumSignificantDigits=n.length):"+"===r?t.minimumSignificantDigits=n.length:"#"===n[0]?t.maximumSignificantDigits=n.length:(t.minimumSignificantDigits=n.length,t.maximumSignificantDigits=n.length+("string"===typeof r?r.length:0)),""})),t}function N(e){switch(e){case"sign-auto":return{signDisplay:"auto"};case"sign-accounting":return{currencySign:"accounting"};case"sign-always":return{signDisplay:"always"};case"sign-accounting-always":return{signDisplay:"always",currencySign:"accounting"};case"sign-except-zero":return{signDisplay:"exceptZero"};case"sign-accounting-except-zero":return{signDisplay:"exceptZero",currencySign:"accounting"};case"sign-never":return{signDisplay:"never"}}}function P(e){var t=N(e);return t||{}}function T(e){for(var t={},n=0,r=e;n<r.length;n++){var o=r[n];switch(o.stem){case"percent":t.style="percent";continue;case"currency":t.style="currency",t.currency=o.options[0];continue;case"group-off":t.useGrouping=!1;continue;case"precision-integer":t.maximumFractionDigits=0;continue;case"measure-unit":t.style="unit",t.unit=o.options[0].replace(/^(.*?)-/,"");continue;case"compact-short":t.notation="compact",t.compactDisplay="short";continue;case"compact-long":t.notation="compact",t.compactDisplay="long";continue;case"scientific":t=S(S(S({},t),{notation:"scientific"}),o.options.reduce((function(e,t){return S(S({},e),P(t))}),{}));continue;case"engineering":t=S(S(S({},t),{notation:"engineering"}),o.options.reduce((function(e,t){return S(S({},e),P(t))}),{}));continue;case"notation-simple":t.notation="standard";continue;case"unit-width-narrow":t.currencyDisplay="narrowSymbol",t.unitDisplay="narrow";continue;case"unit-width-short":t.currencyDisplay="code",t.unitDisplay="short";continue;case"unit-width-full-name":t.currencyDisplay="name",t.unitDisplay="long";continue;case"unit-width-iso-code":t.currencyDisplay="symbol";continue}if(k.test(o.stem)){if(o.options.length>1)throw new RangeError("Fraction-precision stems only accept a single optional option");o.stem.replace(k,(function(e,n,r){return"."===e?t.maximumFractionDigits=0:"+"===r?t.minimumFractionDigits=r.length:"#"===n[0]?t.maximumFractionDigits=n.length:(t.minimumFractionDigits=n.length,t.maximumFractionDigits=n.length+("string"===typeof r?r.length:0)),""})),o.options.length&&(t=S(S({},t),I(o.options[0])))}else if(M.test(o.stem))t=S(S({},t),I(o.stem));else{var a=N(o.stem);a&&(t=S(S({},t),a))}}return t}var O,j=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),R=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var a=arguments[t],i=0,s=a.length;i<s;i++,o++)r[o]=a[i];return r},L=function(e){function t(t,n){var r=e.call(this,t)||this;return r.variableId=n,r}return j(t,e),t}(Error);function F(e,t,n,r,h,m,g){if(1===e.length&&o(e[0]))return[{type:0,value:e[0].value}];for(var v,y=[],C=0,A=e;C<A.length;C++){var x=A[C];if(o(x))y.push({type:0,value:x.value});else if(d(x))"number"===typeof m&&y.push({type:0,value:n.getNumberFormat(t).format(m)});else{var b=x.value;if(!h||!(b in h))throw new L('The intl string context variable "'+b+'" was not provided to the string "'+g+'"');var _=h[b];if(a(x))_&&"string"!==typeof _&&"number"!==typeof _||(_="string"===typeof _||"number"===typeof _?String(_):""),y.push({type:1,value:_});else if(s(x)){var w="string"===typeof x.style?r.date[x.style]:void 0;y.push({type:0,value:n.getDateTimeFormat(t,w).format(_)})}else if(l(x)){w="string"===typeof x.style?r.time[x.style]:f(x.style)?E(x.style.pattern):void 0;y.push({type:0,value:n.getDateTimeFormat(t,w).format(_)})}else if(i(x)){w="string"===typeof x.style?r.number[x.style]:p(x.style)?T(x.style.tokens):void 0;y.push({type:0,value:n.getNumberFormat(t,w).format(_)})}else if(c(x)){if(!(S=x.options[_]||x.options.other))throw new RangeError('Invalid values for "'+x.value+'": "'+_+'". Options are "'+Object.keys(x.options).join('", "')+'"');y.push.apply(y,F(S.value,t,n,r,h))}else if(u(x)){var S;if(!(S=x.options["="+_])){if(!Intl.PluralRules)throw new L('Intl.PluralRules is not available in this environment.\nTry polyfilling it using "@formatjs/intl-pluralrules"\n');var D=n.getPluralRules(t,{type:x.pluralType}).select(_-(x.offset||0));S=x.options[D]||x.options.other}if(!S)throw new RangeError('Invalid values for "'+x.value+'": "'+_+'". Options are "'+Object.keys(x.options).join('", "')+'"');y.push.apply(y,F(S.value,t,n,r,h,_-(x.offset||0)))}else;}}return(v=y).length<2?v:v.reduce((function(e,t){var n=e[e.length-1];return n&&0===n.type&&0===t.type?n.value+=t.value:e.push(t),e}),[])}function U(e,t,n,r,o,a){var i=F(e,t,n,r,o,void 0,a);return 1===i.length?i[0].value:i.reduce((function(e,t){return e+t.value}),"")}var Y="@@",B=/@@(\d+_\d+)@@/g,H=0;function V(e,t){return e.split(B).filter(Boolean).map((function(e){return null!=t[e]?t[e]:e})).reduce((function(e,t){return e.length&&"string"===typeof t&&"string"===typeof e[e.length-1]?e[e.length-1]+=t:e.push(t),e}),[])}var G=/(<([0-9a-zA-Z-_]*?)>(.*?)<\/([0-9a-zA-Z-_]*?)>)|(<[0-9a-zA-Z-_]*?\/>)/,q=Date.now()+"@@",z=["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr"];function W(e,t,n){var r=e.tagName,o=e.outerHTML,a=e.textContent,i=e.childNodes;if(!r)return V(a||"",t);r=r.toLowerCase();var s=~z.indexOf(r),l=n[r];if(l&&s)throw new L(r+" is a self-closing tag and can not be used, please use another tag name.");if(!i.length)return[o];var c=Array.prototype.slice.call(i).reduce((function(e,r){return e.concat(W(r,t,n))}),[]);return l?"function"===typeof l?[l.apply(void 0,c)]:[l]:R(["<"+r+">"],c,["</"+r+">"])}function K(e,t,n,r,o,a){var i=F(e,t,n,r,o,void 0,a),s={},l=i.reduce((function(e,t){if(0===t.type)return e+t.value;var n=Date.now()+"_"+ ++H;return s[n]=t.value,e+""+Y+n+Y}),"");if(!G.test(l))return V(l,s);if(!o)throw new L("Message has placeholders but no values was given");if("undefined"===typeof DOMParser)throw new L("Cannot format XML message without DOMParser");O||(O=new DOMParser);var c=O.parseFromString('<formatted-message id="'+q+'">'+l+"</formatted-message>","text/html").getElementById(q);if(!c)throw new L("Malformed HTML message "+l);var u=Object.keys(o).filter((function(e){return!!c.getElementsByTagName(e).length}));if(!u.length)return V(l,s);var d=u.filter((function(e){return e!==e.toLowerCase()}));if(d.length)throw new L("HTML tag must be lowercased but the following tags are not: "+d.join(", "));return Array.prototype.slice.call(c.childNodes).reduce((function(e,t){return e.concat(W(t,s,o))}),[])}var Z=function(){return Z=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Z.apply(this,arguments)};function X(e,t){return t?Object.keys(e).reduce((function(n,r){var o,a;return n[r]=(o=e[r],(a=t[r])?Z(Z(Z({},o||{}),a||{}),Object.keys(o).reduce((function(e,t){return e[t]=Z(Z({},o[t]),a[t]||{}),e}),{})):o),n}),Z({},e)):e}function $(e){return void 0===e&&(e={number:{},dateTime:{},pluralRules:{}}),{getNumberFormat:w(Intl.NumberFormat,e.number),getDateTimeFormat:w(Intl.DateTimeFormat,e.dateTime),getPluralRules:w(Intl.PluralRules,e.pluralRules)}}var J=function(){function e(t,n,r,o){var a=this;if(void 0===n&&(n=e.defaultLocale),this.formatterCache={number:{},dateTime:{},pluralRules:{}},this.format=function(e){return U(a.ast,a.locales,a.formatters,a.formats,e,a.message)},this.formatToParts=function(e){return F(a.ast,a.locales,a.formatters,a.formats,e,void 0,a.message)},this.formatHTMLMessage=function(e){return K(a.ast,a.locales,a.formatters,a.formats,e,a.message)},this.resolvedOptions=function(){return{locale:Intl.NumberFormat.supportedLocalesOf(a.locales)[0]}},this.getAst=function(){return a.ast},"string"===typeof t){if(this.message=t,!e.__parse)throw new TypeError("IntlMessageFormat.__parse must be set to process `message` of type `string`");this.ast=e.__parse(t,{normalizeHashtagInPlural:!1})}else this.ast=t;if(!Array.isArray(this.ast))throw new TypeError("A message must be provided as a String or AST.");this.formats=X(e.formats,r),this.locales=n,this.formatters=o&&o.formatters||$(this.formatterCache)}return e.defaultLocale=(new Intl.NumberFormat).resolvedOptions().locale,e.__parse=x,e.formats={number:{currency:{style:"currency"},percent:{style:"percent"}},date:{short:{month:"numeric",day:"numeric",year:"2-digit"},medium:{month:"short",day:"numeric",year:"numeric"},long:{month:"long",day:"numeric",year:"numeric"},full:{weekday:"long",month:"long",day:"numeric",year:"numeric"}},time:{short:{hour:"numeric",minute:"numeric"},medium:{hour:"numeric",minute:"numeric",second:"numeric"},long:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"},full:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"}}},e}(),Q=J},83163:function(e,t,n){e=n.nmd(e);var r="__lodash_hash_undefined__",o=9007199254740991,a="[object Arguments]",i="[object AsyncFunction]",s="[object Function]",l="[object GeneratorFunction]",c="[object Null]",u="[object Object]",d="[object Proxy]",p="[object Undefined]",f=/^\[object .+?Constructor\]$/,h=/^(?:0|[1-9]\d*)$/,m={};m["[object Float32Array]"]=m["[object Float64Array]"]=m["[object Int8Array]"]=m["[object Int16Array]"]=m["[object Int32Array]"]=m["[object Uint8Array]"]=m["[object Uint8ClampedArray]"]=m["[object Uint16Array]"]=m["[object Uint32Array]"]=!0,m[a]=m["[object Array]"]=m["[object ArrayBuffer]"]=m["[object Boolean]"]=m["[object DataView]"]=m["[object Date]"]=m["[object Error]"]=m[s]=m["[object Map]"]=m["[object Number]"]=m[u]=m["[object RegExp]"]=m["[object Set]"]=m["[object String]"]=m["[object WeakMap]"]=!1;var g="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,v="object"==typeof self&&self&&self.Object===Object&&self,y=g||v||Function("return this")(),C=t&&!t.nodeType&&t,A=C&&e&&!e.nodeType&&e,x=A&&A.exports===C,b=x&&g.process,_=function(){try{var e=A&&A.require&&A.require("util").types;return e||b&&b.binding&&b.binding("util")}catch(t){}}(),w=_&&_.isTypedArray;var S,D,E=Array.prototype,k=Function.prototype,M=Object.prototype,I=y["__core-js_shared__"],N=k.toString,P=M.hasOwnProperty,T=function(){var e=/[^.]+$/.exec(I&&I.keys&&I.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),O=M.toString,j=N.call(Object),R=RegExp("^"+N.call(P).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),L=x?y.Buffer:void 0,F=y.Symbol,U=y.Uint8Array,Y=L?L.allocUnsafe:void 0,B=(S=Object.getPrototypeOf,D=Object,function(e){return S(D(e))}),H=Object.create,V=M.propertyIsEnumerable,G=E.splice,q=F?F.toStringTag:void 0,z=function(){try{var e=ye(Object,"defineProperty");return e({},"",{}),e}catch(t){}}(),W=L?L.isBuffer:void 0,K=Math.max,Z=Date.now,X=ye(y,"Map"),$=ye(Object,"create"),J=function(){function e(){}return function(t){if(!Ie(t))return{};if(H)return H(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function Q(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function ee(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function te(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function ne(e){var t=this.__data__=new ee(e);this.size=t.size}function re(e,t){var n=Se(e),r=!n&&we(e),o=!n&&!r&&Ee(e),a=!n&&!r&&!o&&Pe(e),i=n||r||o||a,s=i?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],l=s.length;for(var c in e)!t&&!P.call(e,c)||i&&("length"==c||o&&("offset"==c||"parent"==c)||a&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Ce(c,l))||s.push(c);return s}function oe(e,t,n){(void 0!==n&&!_e(e[t],n)||void 0===n&&!(t in e))&&se(e,t,n)}function ae(e,t,n){var r=e[t];P.call(e,t)&&_e(r,n)&&(void 0!==n||t in e)||se(e,t,n)}function ie(e,t){for(var n=e.length;n--;)if(_e(e[n][0],t))return n;return-1}function se(e,t,n){"__proto__"==t&&z?z(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}Q.prototype.clear=function(){this.__data__=$?$(null):{},this.size=0},Q.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Q.prototype.get=function(e){var t=this.__data__;if($){var n=t[e];return n===r?void 0:n}return P.call(t,e)?t[e]:void 0},Q.prototype.has=function(e){var t=this.__data__;return $?void 0!==t[e]:P.call(t,e)},Q.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=$&&void 0===t?r:t,this},ee.prototype.clear=function(){this.__data__=[],this.size=0},ee.prototype.delete=function(e){var t=this.__data__,n=ie(t,e);return!(n<0)&&(n==t.length-1?t.pop():G.call(t,n,1),--this.size,!0)},ee.prototype.get=function(e){var t=this.__data__,n=ie(t,e);return n<0?void 0:t[n][1]},ee.prototype.has=function(e){return ie(this.__data__,e)>-1},ee.prototype.set=function(e,t){var n=this.__data__,r=ie(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},te.prototype.clear=function(){this.size=0,this.__data__={hash:new Q,map:new(X||ee),string:new Q}},te.prototype.delete=function(e){var t=ve(this,e).delete(e);return this.size-=t?1:0,t},te.prototype.get=function(e){return ve(this,e).get(e)},te.prototype.has=function(e){return ve(this,e).has(e)},te.prototype.set=function(e,t){var n=ve(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},ne.prototype.clear=function(){this.__data__=new ee,this.size=0},ne.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},ne.prototype.get=function(e){return this.__data__.get(e)},ne.prototype.has=function(e){return this.__data__.has(e)},ne.prototype.set=function(e,t){var n=this.__data__;if(n instanceof ee){var r=n.__data__;if(!X||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new te(r)}return n.set(e,t),this.size=n.size,this};var le,ce=function(e,t,n){for(var r=-1,o=Object(e),a=n(e),i=a.length;i--;){var s=a[le?i:++r];if(!1===t(o[s],s,o))break}return e};function ue(e){return null==e?void 0===e?p:c:q&&q in Object(e)?function(e){var t=P.call(e,q),n=e[q];try{e[q]=void 0;var r=!0}catch(a){}var o=O.call(e);r&&(t?e[q]=n:delete e[q]);return o}(e):function(e){return O.call(e)}(e)}function de(e){return Ne(e)&&ue(e)==a}function pe(e){return!(!Ie(e)||function(e){return!!T&&T in e}(e))&&(ke(e)?R:f).test(function(e){if(null!=e){try{return N.call(e)}catch(t){}try{return e+""}catch(t){}}return""}(e))}function fe(e){if(!Ie(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=Ae(e),n=[];for(var r in e)("constructor"!=r||!t&&P.call(e,r))&&n.push(r);return n}function he(e,t,n,r,o){e!==t&&ce(t,(function(a,i){if(o||(o=new ne),Ie(a))!function(e,t,n,r,o,a,i){var s=xe(e,n),l=xe(t,n),c=i.get(l);if(c)return void oe(e,n,c);var d=a?a(s,l,n+"",e,t,i):void 0,p=void 0===d;if(p){var f=Se(l),h=!f&&Ee(l),m=!f&&!h&&Pe(l);d=l,f||h||m?Se(s)?d=s:Ne(g=s)&&De(g)?d=function(e,t){var n=-1,r=e.length;t||(t=Array(r));for(;++n<r;)t[n]=e[n];return t}(s):h?(p=!1,d=function(e,t){if(t)return e.slice();var n=e.length,r=Y?Y(n):new e.constructor(n);return e.copy(r),r}(l,!0)):m?(p=!1,d=function(e,t){var n=t?function(e){var t=new e.constructor(e.byteLength);return new U(t).set(new U(e)),t}(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}(l,!0)):d=[]:function(e){if(!Ne(e)||ue(e)!=u)return!1;var t=B(e);if(null===t)return!0;var n=P.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&N.call(n)==j}(l)||we(l)?(d=s,we(s)?d=function(e){return function(e,t,n,r){var o=!n;n||(n={});var a=-1,i=t.length;for(;++a<i;){var s=t[a],l=r?r(n[s],e[s],s,n,e):void 0;void 0===l&&(l=e[s]),o?se(n,s,l):ae(n,s,l)}return n}(e,Te(e))}(s):Ie(s)&&!ke(s)||(d=function(e){return"function"!=typeof e.constructor||Ae(e)?{}:J(B(e))}(l))):p=!1}var g;p&&(i.set(l,d),o(d,l,r,a,i),i.delete(l));oe(e,n,d)}(e,t,i,n,he,r,o);else{var s=r?r(xe(e,i),a,i+"",e,t,o):void 0;void 0===s&&(s=a),oe(e,i,s)}}),Te)}function me(e,t){return be(function(e,t,n){return t=K(void 0===t?e.length-1:t,0),function(){for(var r=arguments,o=-1,a=K(r.length-t,0),i=Array(a);++o<a;)i[o]=r[t+o];o=-1;for(var s=Array(t+1);++o<t;)s[o]=r[o];return s[t]=n(i),function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}(e,this,s)}}(e,t,Re),e+"")}var ge=z?function(e,t){return z(e,"toString",{configurable:!0,enumerable:!1,value:(n=t,function(){return n}),writable:!0});var n}:Re;function ve(e,t){var n=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function ye(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return pe(n)?n:void 0}function Ce(e,t){var n=typeof e;return!!(t=null==t?o:t)&&("number"==n||"symbol"!=n&&h.test(e))&&e>-1&&e%1==0&&e<t}function Ae(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||M)}function xe(e,t){if(("constructor"!==t||"function"!==typeof e[t])&&"__proto__"!=t)return e[t]}var be=function(e){var t=0,n=0;return function(){var r=Z(),o=16-(r-n);if(n=r,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(ge);function _e(e,t){return e===t||e!==e&&t!==t}var we=de(function(){return arguments}())?de:function(e){return Ne(e)&&P.call(e,"callee")&&!V.call(e,"callee")},Se=Array.isArray;function De(e){return null!=e&&Me(e.length)&&!ke(e)}var Ee=W||function(){return!1};function ke(e){if(!Ie(e))return!1;var t=ue(e);return t==s||t==l||t==i||t==d}function Me(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=o}function Ie(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Ne(e){return null!=e&&"object"==typeof e}var Pe=w?function(e){return function(t){return e(t)}}(w):function(e){return Ne(e)&&Me(e.length)&&!!m[ue(e)]};function Te(e){return De(e)?re(e,!0):fe(e)}var Oe,je=(Oe=function(e,t,n){he(e,t,n)},me((function(e,t){var n=-1,r=t.length,o=r>1?t[r-1]:void 0,a=r>2?t[2]:void 0;for(o=Oe.length>3&&"function"==typeof o?(r--,o):void 0,a&&function(e,t,n){if(!Ie(n))return!1;var r=typeof t;return!!("number"==r?De(n)&&Ce(t,n.length):"string"==r&&t in n)&&_e(n[t],e)}(t[0],t[1],a)&&(o=r<3?void 0:o,r=1),e=Object(e);++n<r;){var i=t[n];i&&Oe(e,i,n,o)}return e})));function Re(e){return e}e.exports=je},71914:function(e,t){t.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},t.decode=function(e){for(var t={},n=e.split("&"),r=0,o=n.length;r<o;r++){var a=n[r].split("=");t[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return t}},20204:function(e){var t=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,n=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var r=e,o=e.indexOf("["),a=e.indexOf("]");-1!=o&&-1!=a&&(e=e.substring(0,o)+e.substring(o,a).replace(/:/g,";")+e.substring(a,e.length));for(var i=t.exec(e||""),s={},l=14;l--;)s[n[l]]=i[l]||"";return-1!=o&&-1!=a&&(s.source=r,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s.pathNames=function(e,t){var n=/\/{2,9}/g,r=t.replace(n,"/").split("/");"/"!=t.substr(0,1)&&0!==t.length||r.splice(0,1);"/"==t.substr(t.length-1,1)&&r.splice(r.length-1,1);return r}(0,s.path),s.queryKey=function(e,t){var n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,r){t&&(n[t]=r)})),n}(0,s.query),s}},61911:function(e,t,n){"use strict";n.r(t),n.d(t,{CSSTransition:function(){return p},ReplaceTransition:function(){return y},SwitchTransition:function(){return D},Transition:function(){return l.default},TransitionGroup:function(){return h.A},config:function(){return E.A}});var r=n(58168),o=n(98587),a=n(77387);function i(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}var s=n(9950),l=n(29357),c=n(50385),u=function(e,t){return e&&t&&t.split(" ").forEach((function(t){return r=t,void((n=e).classList?n.classList.remove(r):"string"===typeof n.className?n.className=i(n.className,r):n.setAttribute("class",i(n.className&&n.className.baseVal||"",r)));var n,r}))},d=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this).appliedClasses={appear:{},enter:{},exit:{}},t.onEnter=function(e,n){var r=t.resolveArguments(e,n),o=r[0],a=r[1];t.removeClasses(o,"exit"),t.addClass(o,a?"appear":"enter","base"),t.props.onEnter&&t.props.onEnter(e,n)},t.onEntering=function(e,n){var r=t.resolveArguments(e,n),o=r[0],a=r[1]?"appear":"enter";t.addClass(o,a,"active"),t.props.onEntering&&t.props.onEntering(e,n)},t.onEntered=function(e,n){var r=t.resolveArguments(e,n),o=r[0],a=r[1]?"appear":"enter";t.removeClasses(o,a),t.addClass(o,a,"done"),t.props.onEntered&&t.props.onEntered(e,n)},t.onExit=function(e){var n=t.resolveArguments(e)[0];t.removeClasses(n,"appear"),t.removeClasses(n,"enter"),t.addClass(n,"exit","base"),t.props.onExit&&t.props.onExit(e)},t.onExiting=function(e){var n=t.resolveArguments(e)[0];t.addClass(n,"exit","active"),t.props.onExiting&&t.props.onExiting(e)},t.onExited=function(e){var n=t.resolveArguments(e)[0];t.removeClasses(n,"exit"),t.addClass(n,"exit","done"),t.props.onExited&&t.props.onExited(e)},t.resolveArguments=function(e,n){return t.props.nodeRef?[t.props.nodeRef.current,e]:[e,n]},t.getClassNames=function(e){var n=t.props.classNames,r="string"===typeof n,o=r?""+(r&&n?n+"-":"")+e:n[e];return{baseClassName:o,activeClassName:r?o+"-active":n[e+"Active"],doneClassName:r?o+"-done":n[e+"Done"]}},t}(0,a.A)(t,e);var n=t.prototype;return n.addClass=function(e,t,n){var r=this.getClassNames(t)[n+"ClassName"],o=this.getClassNames("enter").doneClassName;"appear"===t&&"done"===n&&o&&(r+=" "+o),"active"===n&&e&&(0,c.F)(e),r&&(this.appliedClasses[t][n]=r,function(e,t){e&&t&&t.split(" ").forEach((function(t){return r=t,void((n=e).classList?n.classList.add(r):function(e,t){return e.classList?!!t&&e.classList.contains(t):-1!==(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")}(n,r)||("string"===typeof n.className?n.className=n.className+" "+r:n.setAttribute("class",(n.className&&n.className.baseVal||"")+" "+r)));var n,r}))}(e,r))},n.removeClasses=function(e,t){var n=this.appliedClasses[t],r=n.base,o=n.active,a=n.done;this.appliedClasses[t]={},r&&u(e,r),o&&u(e,o),a&&u(e,a)},n.render=function(){var e=this.props,t=(e.classNames,(0,o.A)(e,["classNames"]));return s.createElement(l.default,(0,r.A)({},t,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},t}(s.Component);d.defaultProps={classNames:""},d.propTypes={};var p=d,f=n(17119),h=n(38166),m=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this).handleEnter=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.handleLifecycle("onEnter",0,n)},t.handleEntering=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.handleLifecycle("onEntering",0,n)},t.handleEntered=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.handleLifecycle("onEntered",0,n)},t.handleExit=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.handleLifecycle("onExit",1,n)},t.handleExiting=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.handleLifecycle("onExiting",1,n)},t.handleExited=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.handleLifecycle("onExited",1,n)},t}(0,a.A)(t,e);var n=t.prototype;return n.handleLifecycle=function(e,t,n){var r,o=this.props.children,a=s.Children.toArray(o)[t];if(a.props[e]&&(r=a.props)[e].apply(r,n),this.props[e]){var i=a.props.nodeRef?void 0:f.findDOMNode(this);this.props[e](i)}},n.render=function(){var e=this.props,t=e.children,n=e.in,r=(0,o.A)(e,["children","in"]),a=s.Children.toArray(t),i=a[0],l=a[1];return delete r.onEnter,delete r.onEntering,delete r.onEntered,delete r.onExit,delete r.onExiting,delete r.onExited,s.createElement(h.A,r,n?s.cloneElement(i,{key:"first",onEnter:this.handleEnter,onEntering:this.handleEntering,onEntered:this.handleEntered}):s.cloneElement(l,{key:"second",onEnter:this.handleExit,onEntering:this.handleExiting,onEntered:this.handleExited}))},t}(s.Component);m.propTypes={};var g,v,y=m,C=n(28555);var A="out-in",x="in-out",b=function(e,t,n){return function(){var r;e.props[t]&&(r=e.props)[t].apply(r,arguments),n()}},_=((g={})[A]=function(e){var t=e.current,n=e.changeState;return s.cloneElement(t,{in:!1,onExited:b(t,"onExited",(function(){n(l.ENTERING,null)}))})},g[x]=function(e){var t=e.current,n=e.changeState,r=e.children;return[t,s.cloneElement(r,{in:!0,onEntered:b(r,"onEntered",(function(){n(l.ENTERING)}))})]},g),w=((v={})[A]=function(e){var t=e.children,n=e.changeState;return s.cloneElement(t,{in:!0,onEntered:b(t,"onEntered",(function(){n(l.ENTERED,s.cloneElement(t,{in:!0}))}))})},v[x]=function(e){var t=e.current,n=e.children,r=e.changeState;return[s.cloneElement(t,{in:!1,onExited:b(t,"onExited",(function(){r(l.ENTERED,s.cloneElement(n,{in:!0}))}))}),s.cloneElement(n,{in:!0})]},v),S=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this).state={status:l.ENTERED,current:null},t.appeared=!1,t.changeState=function(e,n){void 0===n&&(n=t.state.current),t.setState({status:e,current:n})},t}(0,a.A)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.appeared=!0},t.getDerivedStateFromProps=function(e,t){return null==e.children?{current:null}:t.status===l.ENTERING&&e.mode===x?{status:l.ENTERING}:!t.current||(n=t.current,r=e.children,n===r||s.isValidElement(n)&&s.isValidElement(r)&&null!=n.key&&n.key===r.key)?{current:s.cloneElement(e.children,{in:!0})}:{status:l.EXITING};var n,r},n.render=function(){var e,t=this.props,n=t.children,r=t.mode,o=this.state,a=o.status,i=o.current,c={children:n,current:i,changeState:this.changeState,status:a};switch(a){case l.ENTERING:e=w[r](c);break;case l.EXITING:e=_[r](c);break;case l.ENTERED:e=i}return s.createElement(C.A.Provider,{value:{isMounting:!this.appeared}},e)},t}(s.Component);S.propTypes={},S.defaultProps={mode:A};var D=S,E=n(35460)},80065:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=p(n(7219)),o=p(n(26380)),a=p(n(754)),i=p(n(52889)),s=p(n(5316)),l=p(n(9950)),c=p(n(35215)),u=p(n(43572)),d=p(n(65210));function p(e){return e&&e.__esModule?e:{default:e}}function f(e){return new Date(e.getFullYear(),e.getMonth()+1,0).getDate()}function h(e){return e<10?"0"+e:e+""}function m(e){return new Date(+e)}var g="datetime",v="date",y="time",C="month",A="year",x=864e5,b=function(e){function t(){(0,o.default)(this,t);var e=(0,i.default)(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.state={date:e.props.date||e.props.defaultDate},e.getNewDate=function(t,n){var r,o,a=parseInt(t[n],10),i=e.props.mode,s=m(e.getDate());if(i===g||i===v||i===A||i===C)switch(n){case 0:s.setFullYear(a);break;case 1:o=a,(r=s).setDate(Math.min(r.getDate(),f(new Date(r.getFullYear(),o)))),r.setMonth(o);break;case 2:s.setDate(a);break;case 3:e.setHours(s,a);break;case 4:s.setMinutes(a);break;case 5:e.setAmPm(s,a)}else if(i===y)switch(n){case 0:e.setHours(s,a);break;case 1:s.setMinutes(a);break;case 2:e.setAmPm(s,a)}return e.clipDate(s)},e.onValueChange=function(t,n){var r=e.props,o=e.getNewDate(t,n);"date"in r||e.setState({date:o}),r.onDateChange&&r.onDateChange(o),r.onValueChange&&r.onValueChange(t,n)},e.onScrollChange=function(t,n){var r=e.props;if(r.onScrollChange){var o=e.getNewDate(t,n);r.onScrollChange(o,t,n)}},e}return(0,s.default)(t,e),(0,a.default)(t,[{key:"componentWillReceiveProps",value:function(e){"date"in e&&this.setState({date:e.date||e.defaultDate})}},{key:"setHours",value:function(e,t){if(this.props.use12Hours){var n=t;n=(n=e.getHours()>=12?t+12:t)>=24?0:n,e.setHours(n)}else e.setHours(t)}},{key:"setAmPm",value:function(e,t){0===t?e.setTime(+e-432e5):e.setTime(+e+432e5)}},{key:"getDefaultMinDate",value:function(){return this.defaultMinDate||(this.defaultMinDate=new Date(2e3,1,1,0,0,0)),this.defaultMinDate}},{key:"getDefaultMaxDate",value:function(){return this.defaultMaxDate||(this.defaultMaxDate=new Date(2030,1,1,23,59,59)),this.defaultMaxDate}},{key:"getDate",value:function(){return this.clipDate(this.state.date||this.getDefaultMinDate())}},{key:"getValue",value:function(){return this.getDate()}},{key:"getMinYear",value:function(){return this.getMinDate().getFullYear()}},{key:"getMaxYear",value:function(){return this.getMaxDate().getFullYear()}},{key:"getMinMonth",value:function(){return this.getMinDate().getMonth()}},{key:"getMaxMonth",value:function(){return this.getMaxDate().getMonth()}},{key:"getMinDay",value:function(){return this.getMinDate().getDate()}},{key:"getMaxDay",value:function(){return this.getMaxDate().getDate()}},{key:"getMinHour",value:function(){return this.getMinDate().getHours()}},{key:"getMaxHour",value:function(){return this.getMaxDate().getHours()}},{key:"getMinMinute",value:function(){return this.getMinDate().getMinutes()}},{key:"getMaxMinute",value:function(){return this.getMaxDate().getMinutes()}},{key:"getMinDate",value:function(){return this.props.minDate||this.getDefaultMinDate()}},{key:"getMaxDate",value:function(){return this.props.maxDate||this.getDefaultMaxDate()}},{key:"getDateData",value:function(){for(var e=this.props,t=e.locale,n=e.formatMonth,r=e.formatDay,o=e.mode,a=this.getDate(),i=a.getFullYear(),s=a.getMonth(),l=this.getMinYear(),c=this.getMaxYear(),u=this.getMinMonth(),d=this.getMaxMonth(),p=this.getMinDay(),h=this.getMaxDay(),m=[],g=l;g<=c;g++)m.push({value:g+"",label:g+t.year+""});var v={key:"year",props:{children:m}};if(o===A)return[v];var y=[],x=0,b=11;l===i&&(x=u),c===i&&(b=d);for(var _=x;_<=b;_++){var w=n?n(_,a):_+1+t.month+"";y.push({value:_+"",label:w})}var S={key:"month",props:{children:y}};if(o===C)return[v,S];var D=[],E=1,k=f(a);l===i&&u===s&&(E=p),c===i&&d===s&&(k=h);for(var M=E;M<=k;M++){var I=r?r(M,a):M+t.day+"";D.push({value:M+"",label:I})}return[v,S,{key:"day",props:{children:D}}]}},{key:"getDisplayHour",value:function(e){return this.props.use12Hours?(0===e&&(e=12),e>12&&(e-=12),e):e}},{key:"getTimeData",value:function(e){var t=this.props,n=t.minHour,r=void 0===n?0:n,o=t.maxHour,a=void 0===o?23:o,i=t.minMinute,s=void 0===i?0:i,l=t.maxMinute,c=void 0===l?59:l,u=this.props,d=u.mode,p=u.locale,f=u.minuteStep,m=u.use12Hours,v=this.getMinMinute(),y=this.getMaxMinute(),C=this.getMinHour(),A=this.getMaxHour(),x=e.getHours();if(d===g){var b=e.getFullYear(),_=e.getMonth(),w=e.getDate(),S=this.getMinYear(),D=this.getMaxYear(),E=this.getMinMonth(),k=this.getMaxMonth(),M=this.getMinDay(),I=this.getMaxDay();S===b&&E===_&&M===w&&(r=C,C===x&&(s=v)),D===b&&k===_&&I===w&&(a=A,A===x&&(c=y))}else r=C,C===x&&(s=v),a=A,A===x&&(c=y);var N=[];0===r&&0===a||0!==r&&0!==a?r=this.getDisplayHour(r):0===r&&m&&(r=1,N.push({value:"0",label:p.hour?"12"+p.hour:"12"})),a=this.getDisplayHour(a);for(var P=r;P<=a;P++)N.push({value:P+"",label:p.hour?P+p.hour+"":h(P)});for(var T=[],O=e.getMinutes(),j=s;j<=c;j+=f)T.push({value:j+"",label:p.minute?j+p.minute+"":h(j)}),O>j&&O<j+f&&T.push({value:O+"",label:p.minute?O+p.minute+"":h(O)});return{cols:[{key:"hours",props:{children:N}},{key:"minutes",props:{children:T}}].concat(m?[{key:"ampm",props:{children:[{value:"0",label:p.am},{value:"1",label:p.pm}]}}]:[]),selMinute:O}}},{key:"clipDate",value:function(e){var t=this.props.mode,n=this.getMinDate(),r=this.getMaxDate();if(t===g){if(e<n)return m(n);if(e>r)return m(r)}else if(t===v||t===A||t===C){if(+e+x<=n)return m(n);if(e>=+r+x)return m(r)}else if(t===y){var o=r.getHours(),a=r.getMinutes(),i=n.getHours(),s=n.getMinutes(),l=e.getHours(),c=e.getMinutes();if(l<i||l===i&&c<s)return m(n);if(l>o||l===o&&c>a)return m(r)}return e}},{key:"getValueCols",value:function(){var e=this.props,t=e.mode,n=e.use12Hours,r=this.getDate(),o=[],a=[];if(t===A)return{cols:this.getDateData(),value:[r.getFullYear()+""]};if(t===C)return{cols:this.getDateData(),value:[r.getFullYear()+"",r.getMonth()+""]};if(t!==g&&t!==v||(o=this.getDateData(),a=[r.getFullYear()+"",r.getMonth()+"",r.getDate()+""]),t===g||t===y){var i=this.getTimeData(r);o=o.concat(i.cols);var s=r.getHours(),l=[s+"",i.selMinute+""];n&&(l=[(s>12?s-12:s)+"",i.selMinute+"",(s>=12?1:0)+""]),a=a.concat(l)}return{value:a,cols:o}}},{key:"render",value:function(){var e=this.getValueCols(),t=e.value,n=e.cols,o=this.props,a=o.disabled,i=o.pickerPrefixCls,s=o.prefixCls,d=o.rootNativeProps,p=o.className,f=o.style,h=o.itemStyle,m=(0,r.default)({flexDirection:"row",alignItems:"center"},f);return l.default.createElement(c.default,{style:m,rootNativeProps:d,className:p,prefixCls:s,selectedValue:t,onValueChange:this.onValueChange,onScrollChange:this.onScrollChange},n.map((function(e){return l.default.createElement(u.default,{style:{flex:1},key:e.key,disabled:a,prefixCls:i,itemStyle:h},e.props.children.map((function(e){return l.default.createElement(u.default.Item,{key:e.value,value:e.value},e.label)})))})))}}]),t}(l.default.Component);b.defaultProps={prefixCls:"rmc-date-picker",pickerPrefixCls:"rmc-picker",locale:d.default,mode:v,disabled:!1,minuteStep:1,onDateChange:function(){},use12Hours:!1},t.default=b,e.exports=t.default},6885:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=u(n(7219)),o=u(n(26380)),a=u(n(754)),i=u(n(52889)),s=u(n(5316)),l=u(n(9950)),c=u(n(50086));function u(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(){(0,o.default)(this,t);var e=(0,i.default)(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.onOk=function(t){var n=e.props,r=n.onChange,o=n.onOk;r&&r(t),o&&o(t)},e}return(0,s.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){return l.default.createElement(c.default,(0,r.default)({picker:this.props.datePicker,value:this.props.date},this.props,{onOk:this.onOk}))}}]),t}(l.default.Component);d.defaultProps={pickerValueProp:"date",pickerValueChangeProp:"onDateChange"},t.default=d,e.exports=t.default},65210:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={year:"",month:"",day:"",hour:"",minute:"",am:"AM",pm:"PM"},e.exports=t.default},23664:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={year:"\u5e74",month:"\u6708",day:"\u65e5",hour:"\u65f6",minute:"\u5206",am:"\u4e0a\u5348",pm:"\u4e0b\u5348"},e.exports=t.default},88210:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return C}});var r=n(7219),o=n(26380),a=n(754),i=n(52889),s=n(5316),l=n(9950),c=n(17119),u=n(66104),d=function(e){function t(){return(0,o.default)(this,t),(0,i.default)(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,a.default)(t,[{key:"shouldComponentUpdate",value:function(e){return!!e.hiddenClassName||!!e.visible}},{key:"render",value:function(){var e=this.props.className;this.props.hiddenClassName&&!this.props.visible&&(e+=" "+this.props.hiddenClassName);var t=(0,r.default)({},this.props);return delete t.hiddenClassName,delete t.visible,t.className=e,l.createElement("div",(0,r.default)({},t))}}]),t}(l.Component),p=d;function f(){}var h=function(e){function t(){(0,o.default)(this,t);var e=(0,i.default)(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.getDialogElement=function(){var t=e.props,n=t.closable,r=t.prefixCls,o=void 0;t.footer&&(o=l.createElement("div",{className:r+"-footer",ref:function(t){return e.footerRef=t}},t.footer));var a=void 0;t.title&&(a=l.createElement("div",{className:r+"-header",ref:function(t){return e.headerRef=t}},l.createElement("div",{className:r+"-title"},t.title)));var i=void 0;n&&(i=l.createElement("button",{onClick:e.close,"aria-label":"Close",className:r+"-close"},l.createElement("span",{className:r+"-close-x"})));var s=e.getTransitionName(),c=l.createElement(p,{key:"dialog-element",role:"document",ref:function(t){return e.dialogRef=t},style:t.style||{},className:r+" "+(t.className||""),visible:t.visible},l.createElement("div",{className:r+"-content"},i,a,l.createElement("div",{className:r+"-body",style:t.bodyStyle,ref:function(t){return e.bodyRef=t}},t.children),o));return l.createElement(u.A,{key:"dialog",showProp:"visible",onAppear:e.onAnimateAppear,onLeave:e.onAnimateLeave,transitionName:s,component:"",transitionAppear:!0},c)},e.onAnimateAppear=function(){document.body.style.overflow="hidden"},e.onAnimateLeave=function(){document.body.style.overflow="",e.wrapRef&&(e.wrapRef.style.display="none"),e.props.onAnimateLeave&&e.props.onAnimateLeave(),e.props.afterClose&&e.props.afterClose()},e.close=function(t){e.props.onClose&&e.props.onClose(t)},e.onMaskClick=function(t){t.target===t.currentTarget&&e.close(t)},e}return(0,s.default)(t,e),(0,a.default)(t,[{key:"componentWillUnmount",value:function(){document.body.style.overflow="",this.wrapRef&&(this.wrapRef.style.display="none")}},{key:"getZIndexStyle",value:function(){var e={},t=this.props;return void 0!==t.zIndex&&(e.zIndex=t.zIndex),e}},{key:"getWrapStyle",value:function(){var e=this.props.wrapStyle||{};return(0,r.default)({},this.getZIndexStyle(),e)}},{key:"getMaskStyle",value:function(){var e=this.props.maskStyle||{};return(0,r.default)({},this.getZIndexStyle(),e)}},{key:"getMaskTransitionName",value:function(){var e=this.props,t=e.maskTransitionName,n=e.maskAnimation;return!t&&n&&(t=e.prefixCls+"-"+n),t}},{key:"getTransitionName",value:function(){var e=this.props,t=e.transitionName,n=e.animation;return!t&&n&&(t=e.prefixCls+"-"+n),t}},{key:"getMaskElement",value:function(){var e=this.props,t=void 0;if(e.mask){var n=this.getMaskTransitionName();t=l.createElement(p,(0,r.default)({style:this.getMaskStyle(),key:"mask-element",className:e.prefixCls+"-mask",hiddenClassName:e.prefixCls+"-mask-hidden",visible:e.visible},e.maskProps)),n&&(t=l.createElement(u.A,{key:"mask",showProp:"visible",transitionAppear:!0,component:"",transitionName:n},t))}return t}},{key:"render",value:function(){var e=this,t=this.props,n=t.prefixCls,o=t.maskClosable,a=this.getWrapStyle();return t.visible&&(a.display=null),l.createElement("div",null,this.getMaskElement(),l.createElement("div",(0,r.default)({className:n+"-wrap "+(t.wrapClassName||""),ref:function(t){return e.wrapRef=t},onClick:o?this.onMaskClick:void 0,role:"dialog","aria-labelledby":t.title,style:a},t.wrapProps),this.getDialogElement()))}}]),t}(l.Component),m=h;h.defaultProps={afterClose:f,className:"",mask:!0,visible:!1,closable:!0,maskClosable:!0,prefixCls:"rmc-dialog",onClose:f};var g=!!c.createPortal,v=!("undefined"===typeof window||!window.document||!window.document.createElement),y=function(e){function t(){(0,o.default)(this,t);var e=(0,i.default)(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.saveRef=function(t){g&&(e._component=t)},e.getComponent=function(t){var n=(0,r.default)({},e.props);return["visible","onAnimateLeave"].forEach((function(e){n.hasOwnProperty(e)&&delete n[e]})),l.createElement(m,(0,r.default)({},n,{visible:t,onAnimateLeave:e.removeContainer,ref:e.saveRef}))},e.removeContainer=function(){e.container&&(g||c.unmountComponentAtNode(e.container),e.container.parentNode.removeChild(e.container),e.container=null)},e.getContainer=function(){if(!e.container){var t=document.createElement("div"),n=e.props.prefixCls+"-container-"+(new Date).getTime();t.setAttribute("id",n),document.body.appendChild(t),e.container=t}return e.container},e}return(0,s.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){this.props.visible&&this.componentDidUpdate()}},{key:"shouldComponentUpdate",value:function(e){var t=e.visible;return!(!this.props.visible&&!t)}},{key:"componentWillUnmount",value:function(){this.props.visible?g?this.removeContainer():this.renderDialog(!1):this.removeContainer()}},{key:"componentDidUpdate",value:function(){g||this.renderDialog(this.props.visible)}},{key:"renderDialog",value:function(e){c.unstable_renderSubtreeIntoContainer(this,this.getComponent(e),this.getContainer())}},{key:"render",value:function(){if(!v)return null;var e=this.props.visible;return g&&(e||this._component)?c.createPortal(this.getComponent(e),this.getContainer()):null}}]),t}(l.Component),C=y;y.defaultProps={visible:!1,prefixCls:"rmc-dialog",onClose:function(){}}},18152:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return p}});var r=n(7219),o=n(26380),a=n(754),i=n(52889),s=n(5316),l=n(9950),c=n(48738),u=n.n(c),d=function(e){function t(){(0,o.default)(this,t);var e=(0,i.default)(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.state={active:!1},e.onTouchStart=function(t){e.triggerEvent("TouchStart",!0,t)},e.onTouchMove=function(t){e.triggerEvent("TouchMove",!1,t)},e.onTouchEnd=function(t){e.triggerEvent("TouchEnd",!1,t)},e.onTouchCancel=function(t){e.triggerEvent("TouchCancel",!1,t)},e.onMouseDown=function(t){e.triggerEvent("MouseDown",!0,t)},e.onMouseUp=function(t){e.triggerEvent("MouseUp",!1,t)},e.onMouseLeave=function(t){e.triggerEvent("MouseLeave",!1,t)},e}return(0,s.default)(t,e),(0,a.default)(t,[{key:"componentDidUpdate",value:function(){this.props.disabled&&this.state.active&&this.setState({active:!1})}},{key:"triggerEvent",value:function(e,t,n){var r="on"+e,o=this.props.children;o.props[r]&&o.props[r](n),t!==this.state.active&&this.setState({active:t})}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.disabled,o=e.activeClassName,a=e.activeStyle,i=n?void 0:{onTouchStart:this.onTouchStart,onTouchMove:this.onTouchMove,onTouchEnd:this.onTouchEnd,onTouchCancel:this.onTouchCancel,onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onMouseLeave:this.onMouseLeave},s=l.Children.only(t);if(!n&&this.state.active){var c=s.props,d=c.style,p=c.className;return!1!==a&&(a&&(d=(0,r.default)({},d,a)),p=u()(p,o)),l.cloneElement(s,(0,r.default)({className:p,style:d},i))}return l.cloneElement(s,i)}}]),t}(l.Component),p=d;d.defaultProps={disabled:!1}},35215:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(9950)),o=a(n(48738));function a(e){return e&&e.__esModule?e:{default:e}}function i(){return i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i.apply(this,arguments)}var s=(0,a(n(21418)).default)((function(e){var t=e.prefixCls,n=e.className,a=e.rootNativeProps,s=e.children,l=e.style,c=e.getValue(),u=r.Children.map(s,(function(t,n){return r.cloneElement(t,{selectedValue:c[n],onValueChange:function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return e.onValueChange.apply(e,[n].concat(r))},onScrollChange:e.onScrollChange&&function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return e.onScrollChange.apply(e,[n].concat(r))}})}));return r.createElement("div",i({},a,{style:l,className:(0,o.default)(n,t)}),u)}));t.default=s},21418:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t;return t=function(t){function n(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,i(n).apply(this,arguments))).getValue=function(){var t=e.props,n=t.children,o=t.selectedValue;return o&&o.length?o:n?r.Children.map(n,(function(e){var t=r.Children.toArray(e.children||e.props.children);return t&&t[0]&&t[0].props.value})):[]},e.onChange=function(t,n,r){var o=e.getValue().concat();o[t]=n,r&&r(o,t)},e.onValueChange=function(t,n){e.onChange(t,n,e.props.onValueChange)},e.onScrollChange=function(t,n){e.onChange(t,n,e.props.onScrollChange)},e}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(n,t),function(e,t,n){t&&a(e.prototype,t);n&&a(e,n)}(n,[{key:"render",value:function(){return r.createElement(e,o({},this.props,{getValue:this.getValue,onValueChange:this.onValueChange,onScrollChange:this.props.onScrollChange&&this.onScrollChange}))}}]),n}(r.Component),t.defaultProps={prefixCls:"rmc-multi-picker",onValueChange:function(){}},t};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(9950));function o(){return o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o.apply(this,arguments)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e){return i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},i(e)}function s(e,t){return s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},s(e,t)}},43572:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(9950)),o=i(n(48738)),a=i(n(66667));function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(){return l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l.apply(this,arguments)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return!t||"object"!==typeof t&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}function p(e,t){return p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},p(e,t)}var f=function(e){function t(e){var n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=u(this,d(t).call(this,e))).scrollHanders=function(){var e=-1,t=0,r=0,o=!1,a=!1,i=function(e,t){e.transform=t,e.webkitTransform=t},s=function(e,t){e.transition=t,e.webkitTransition=t},l=function(t,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.3;e!==r&&(e=r,o&&!n.props.noAnimate&&s(n.contentRef.style,"cubic-bezier(0,0,0.2,1.15) ".concat(o,"s")),i(n.contentRef.style,"translate3d(0,".concat(-r,"px,0)")),setTimeout((function(){n.scrollingComplete(),n.contentRef&&s(n.contentRef.style,"")}),1e3*+o))},c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=0,r=0,o=0,a={record:function(a){var i=+new Date;o=(a-r)/(i-n),i-n>=e&&(o=i-n<=t?o:0,r=a,n=i)},getVelocity:function(e){return e!==r&&a.record(e),o}};return a}(),u=function(){a=!1;var t=e,r=(n.props.children.length-1)*n.itemHeight,o=.3,i=4*c.getVelocity(t);i&&(t=40*i+t,o=.1*Math.abs(i)),t%n.itemHeight!==0&&(t=Math.round(t/n.itemHeight)*n.itemHeight),t<0?t=0:t>r&&(t=r),l(0,t,o<.3?.3:o),n.onScrollChange()},d=function(n){o||(a=!0,r=n,t=e)},p=function(s){!o&&a&&(e=t-s+r,c.record(e),n.onScrollChange(),i(n.contentRef.style,"translate3d(0,".concat(-e,"px,0)")))};return{touchstart:function(e){return d(e.touches[0].pageY)},mousedown:function(e){return d(e.pageY)},touchmove:function(e){e.preventDefault(),p(e.touches[0].pageY)},mousemove:function(e){e.preventDefault(),p(e.pageY)},touchend:function(){return u()},touchcancel:function(){return u()},mouseup:function(){return u()},getValue:function(){return e},scrollTo:l,setDisabled:function(){o=arguments.length>0&&void 0!==arguments[0]&&arguments[0]}}}(),n.scrollTo=function(e){n.scrollHanders.scrollTo(0,e)},n.scrollToWithoutAnimation=function(e){n.scrollHanders.scrollTo(0,e,0)},n.fireValueChange=function(e){e!==n.state.selectedValue&&("selectedValue"in n.props||n.setState({selectedValue:e}),n.props.onValueChange&&n.props.onValueChange(e))},n.onScrollChange=function(){var e=n.scrollHanders.getValue();if(e>=0){var t=r.Children.toArray(n.props.children),o=n.props.computeChildIndex(e,n.itemHeight,t.length);if(n.scrollValue!==o){n.scrollValue=o;var a=t[o];a&&n.props.onScrollChange?n.props.onScrollChange(a.props.value):!a&&console.warn&&console.warn("child not found",t,o)}}},n.scrollingComplete=function(){var e=n.scrollHanders.getValue();e>=0&&n.props.doScrollingComplete(e,n.itemHeight,n.fireValueChange)};var a=n.props,i=a.selectedValue,s=a.defaultSelectedValue;if(void 0!==i)o=i;else if(void 0!==s)o=s;else{var l=r.Children.toArray(n.props.children);o=l&&l[0]&&l[0].props.value}return n.state={selectedValue:o},n}var n,a,i;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(t,e),n=t,(a=[{key:"componentDidMount",value:function(){var e=this,t=this.contentRef,n=this.indicatorRef,r=this.maskRef,o=this.rootRef,a=o.getBoundingClientRect().height,i=this.itemHeight=n.getBoundingClientRect().height,s=Math.floor(a/i);s%2===0&&s--,s--,s/=2,t.style.padding="".concat(i*s,"px 0"),n.style.top="".concat(i*s,"px"),r.style.backgroundSize="100% ".concat(i*s,"px"),this.scrollHanders.setDisabled(this.props.disabled),this.props.select(this.state.selectedValue,this.itemHeight,this.scrollTo);var l=this.passiveSupported(),c=!!l&&{passive:!1},u=!!l&&{passive:!0};Object.keys(this.scrollHanders).forEach((function(t){if(0===t.indexOf("touch")||0===t.indexOf("mouse")){var n=t.indexOf("move")>=0?c:u;o.addEventListener(t,e.scrollHanders[t],n)}}))}},{key:"componentWillUnmount",value:function(){var e=this;Object.keys(this.scrollHanders).forEach((function(t){0!==t.indexOf("touch")&&0!==t.indexOf("mouse")||e.rootRef.removeEventListener(t,e.scrollHanders[t])}))}},{key:"passiveSupported",value:function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("test",null,t)}catch(n){}return e}},{key:"componentWillReceiveProps",value:function(e){var t=this;"selectedValue"in e&&this.state.selectedValue!==e.selectedValue&&this.setState({selectedValue:e.selectedValue},(function(){t.props.select(e.selectedValue,t.itemHeight,e.noAnimate?t.scrollToWithoutAnimation:t.scrollTo)})),this.scrollHanders.setDisabled(e.disabled)}},{key:"shouldComponentUpdate",value:function(e,t){return this.state.selectedValue!==t.selectedValue||this.props.children!==e.children}},{key:"componentDidUpdate",value:function(){this.props.select(this.state.selectedValue,this.itemHeight,this.scrollToWithoutAnimation)}},{key:"getValue",value:function(){if("selectedValue"in this.props)return this.props.selectedValue;var e=r.Children.toArray(this.props.children);return e&&e[0]&&e[0].props.value}},{key:"render",value:function(){var e,t=this,n=this.props,a=n.prefixCls,i=n.itemStyle,c=n.indicatorStyle,u=n.indicatorClassName,d=void 0===u?"":u,p=n.children,f=this.state.selectedValue,h="".concat(a,"-item"),m="".concat(h," ").concat(a,"-item-selected"),g=function(e){var t=e.props,n=t.className,o=void 0===n?"":n,a=t.style,s=t.value;return r.createElement("div",{style:l({},i,a),className:"".concat(f===s?m:h," ").concat(o),key:s},e.children||e.props.children)},v=r.Children?r.Children.map(p,g):[].concat(p).map(g),y=(s(e={},n.className,!!n.className),s(e,a,!0),e);return r.createElement("div",{className:(0,o.default)(y),ref:function(e){return t.rootRef=e},style:this.props.style},r.createElement("div",{className:"".concat(a,"-mask"),ref:function(e){return t.maskRef=e}}),r.createElement("div",{className:"".concat(a,"-indicator ").concat(d),ref:function(e){return t.indicatorRef=e},style:c}),r.createElement("div",{className:"".concat(a,"-content"),ref:function(e){return t.contentRef=e}},v))}}])&&c(n.prototype,a),i&&c(n,i),t}(r.Component);f.defaultProps={prefixCls:"rmc-picker"};var h=(0,a.default)(f);t.default=h},66667:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t;return t=function(t){function n(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,i(n).apply(this,arguments))).select=function(t,n,o){for(var a=r.Children.toArray(e.props.children),i=0,s=a.length;i<s;i++)if(a[i].props.value===t)return void e.selectByIndex(i,n,o);e.selectByIndex(0,n,o)},e.doScrollingComplete=function(t,n,o){var a=r.Children.toArray(e.props.children),i=e.computeChildIndex(t,n,a.length),s=a[i];s?o(s.props.value):console.warn&&console.warn("child not found",a,i)},e}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(n,t),function(e,t,n){t&&a(e.prototype,t);n&&a(e,n)}(n,[{key:"selectByIndex",value:function(e,t,n){e<0||e>=r.Children.count(this.props.children)||!t||n(e*t)}},{key:"computeChildIndex",value:function(e,t,n){var r=Math.round(e/t);return Math.min(r,n-1)}},{key:"render",value:function(){return r.createElement(e,o({},this.props,{doScrollingComplete:this.doScrollingComplete,computeChildIndex:this.computeChildIndex,select:this.select}))}}]),n}(r.Component),t.Item=l,t};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(9950));function o(){return o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o.apply(this,arguments)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e){return i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},i(e)}function s(e,t){return s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},s(e,t)}var l=function(e){return null}},50086:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(9950)),o=s(n(88210)),a=s(n(86893)),i=s(n(18152));function s(e){return e&&e.__esModule?e:{default:e}}var l=(0,a.default)((function(e,t,n){var a=n.getContent,s=n.hide,l=n.onDismiss,c=n.onOk;if(!t)return null;var u=e.prefixCls;return r.createElement(o.default,{prefixCls:"".concat(u),className:e.className||"",visible:!0,closable:!1,transitionName:e.transitionName||e.popupTransitionName,maskTransitionName:e.maskTransitionName,onClose:s,style:e.style},r.createElement("div",null,r.createElement("div",{className:"".concat(u,"-header")},r.createElement(i.default,{activeClassName:"".concat(u,"-item-active")},r.createElement("div",{className:"".concat(u,"-item ").concat(u,"-header-left"),onClick:l},e.dismissText)),r.createElement("div",{className:"".concat(u,"-item ").concat(u,"-title")},e.title),r.createElement(i.default,{activeClassName:"".concat(u,"-item-active")},r.createElement("div",{className:"".concat(u,"-item ").concat(u,"-header-right"),onClick:c},e.okText))),a()))}),{prefixCls:"rmc-picker-popup",WrapComponent:"span",triggerType:"onClick",pickerValueProp:"selectedValue",pickerValueChangeProp:"onValueChange"});t.default=l},86893:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n;return(n=function(t){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,s(n).call(this,e))).onPickerChange=function(e){if(t.state.pickerValue!==e){t.setState({pickerValue:e});var n=t.props,r=n.picker,o=n.pickerValueChangeProp;r&&r.props[o]&&r.props[o](e)}},t.saveRef=function(e){t.picker=e},t.onTriggerClick=function(e){var n=t.props.children.props||{};n[t.props.triggerType]&&n[t.props.triggerType](e),t.fireVisibleChange(!t.state.visible)},t.onOk=function(){t.props.onOk(t.picker&&t.picker.getValue()),t.fireVisibleChange(!1)},t.getContent=function(){if(t.props.picker){var e,n=t.state.pickerValue;return null===n&&(n=t.props.value),r.cloneElement(t.props.picker,(a(e={},t.props.pickerValueProp,n),a(e,t.props.pickerValueChangeProp,t.onPickerChange),a(e,"ref",t.saveRef),e))}return t.props.content},t.onDismiss=function(){t.props.onDismiss(),t.fireVisibleChange(!1)},t.hide=function(){t.fireVisibleChange(!1)},t.state={pickerValue:"value"in t.props?t.props.value:null,visible:t.props.visible||!1},t}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(n,t),function(e,t,n){t&&i(e.prototype,t);n&&i(e,n)}(n,[{key:"componentWillReceiveProps",value:function(e){"value"in e&&this.setState({pickerValue:e.value}),"visible"in e&&this.setVisibleState(e.visible)}},{key:"setVisibleState",value:function(e){this.setState({visible:e}),e||this.setState({pickerValue:null})}},{key:"fireVisibleChange",value:function(e){this.state.visible!==e&&("visible"in this.props||this.setVisibleState(e),this.props.onVisibleChange(e))}},{key:"getRender",value:function(){var t=this.props,n=t.children;if(!n)return e(t,this.state.visible,{getContent:this.getContent,onOk:this.onOk,hide:this.hide,onDismiss:this.onDismiss});var o=this.props,a=o.WrapComponent,i=n,s={};return o.disabled||(s[t.triggerType]=this.onTriggerClick),r.createElement(a,{style:t.wrapStyle},r.cloneElement(i,s),e(t,this.state.visible,{getContent:this.getContent,onOk:this.onOk,hide:this.hide,onDismiss:this.onDismiss}))}},{key:"render",value:function(){return this.getRender()}}]),n}(r.Component)).defaultProps=o({onVisibleChange:function(e){},okText:"Ok",dismissText:"Dismiss",title:"",onOk:function(e){},onDismiss:function(){}},t),n};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(9950));function o(){return o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o.apply(this,arguments)}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function l(e,t){return l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},l(e,t)}},46256:function(e,t,n){var r=n(36273),o=n(8404),a=n(92411),i=n(54818)("socket.io-client");e.exports=t=l;var s=t.managers={};function l(e,t){"object"===typeof e&&(t=e,e=void 0),t=t||{};var n,o=r(e),l=o.source,c=o.id,u=o.path,d=s[c]&&u in s[c].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||d?(i("ignoring socket cache for %s",l),n=a(l,t)):(s[c]||(i("new io instance for %s",l),s[c]=a(l,t)),n=s[c]),o.query&&!t.query&&(t.query=o.query),n.socket(o.path,t)}t.protocol=o.protocol,t.connect=l,t.Manager=n(92411),t.Socket=n(29227)},92411:function(e,t,n){var r=n(88127),o=n(29227),a=n(19621),i=n(8404),s=n(99823),l=n(1354),c=n(54818)("socket.io-client:manager"),u=n(95896),d=n(64293),p=Object.prototype.hasOwnProperty;function f(e,t){if(!(this instanceof f))return new f(e,t);e&&"object"===typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new d({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var n=t.parser||i;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}e.exports=f,f.prototype.emitAll=function(){for(var e in this.emit.apply(this,arguments),this.nsps)p.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},f.prototype.updateSocketIds=function(){for(var e in this.nsps)p.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},f.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},a(f.prototype),f.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},f.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},f.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},f.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},f.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},f.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},f.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},f.prototype.open=f.prototype.connect=function(e,t){if(c("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;c("opening %s",this.uri),this.engine=r(this.uri,this.opts);var n=this.engine,o=this;this.readyState="opening",this.skipReconnect=!1;var a=s(n,"open",(function(){o.onopen(),e&&e()})),i=s(n,"error",(function(t){if(c("connect_error"),o.cleanup(),o.readyState="closed",o.emitAll("connect_error",t),e){var n=new Error("Connection error");n.data=t,e(n)}else o.maybeReconnectOnOpen()}));if(!1!==this._timeout){var l=this._timeout;c("connect attempt will timeout after %d",l),0===l&&a.destroy();var u=setTimeout((function(){c("connect attempt timed out after %d",l),a.destroy(),n.close(),n.emit("error","timeout"),o.emitAll("connect_timeout",l)}),l);this.subs.push({destroy:function(){clearTimeout(u)}})}return this.subs.push(a),this.subs.push(i),this},f.prototype.onopen=function(){c("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(s(e,"data",l(this,"ondata"))),this.subs.push(s(e,"ping",l(this,"onping"))),this.subs.push(s(e,"pong",l(this,"onpong"))),this.subs.push(s(e,"error",l(this,"onerror"))),this.subs.push(s(e,"close",l(this,"onclose"))),this.subs.push(s(this.decoder,"decoded",l(this,"ondecoded")))},f.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},f.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},f.prototype.ondata=function(e){this.decoder.add(e)},f.prototype.ondecoded=function(e){this.emit("packet",e)},f.prototype.onerror=function(e){c("error",e),this.emitAll("error",e)},f.prototype.socket=function(e,t){var n=this.nsps[e];if(!n){n=new o(this,e,t),this.nsps[e]=n;var r=this;n.on("connecting",a),n.on("connect",(function(){n.id=r.generateId(e)})),this.autoConnect&&a()}function a(){~u(r.connecting,n)||r.connecting.push(n)}return n},f.prototype.destroy=function(e){var t=u(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},f.prototype.packet=function(e){c("writing packet %j",e);var t=this;e.query&&0===e.type&&(e.nsp+="?"+e.query),t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,(function(n){for(var r=0;r<n.length;r++)t.engine.write(n[r],e.options);t.encoding=!1,t.processPacketQueue()})))},f.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},f.prototype.cleanup=function(){c("cleanup");for(var e=this.subs.length,t=0;t<e;t++){this.subs.shift().destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},f.prototype.close=f.prototype.disconnect=function(){c("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},f.prototype.onclose=function(e){c("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},f.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)c("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();c("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var n=setTimeout((function(){e.skipReconnect||(c("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open((function(t){t?(c("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(c("reconnect success"),e.onreconnect())})))}),t);this.subs.push({destroy:function(){clearTimeout(n)}})}},f.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},99823:function(e){e.exports=function(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}},29227:function(e,t,n){var r=n(8404),o=n(19621),a=n(73802),i=n(99823),s=n(1354),l=n(54818)("socket.io-client:socket"),c=n(71914),u=n(69349);e.exports=f;var d={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},p=o.prototype.emit;function f(e,t,n){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}o(f.prototype),f.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[i(e,"open",s(this,"onopen")),i(e,"packet",s(this,"onpacket")),i(e,"close",s(this,"onclose"))]}},f.prototype.open=f.prototype.connect=function(){return this.connected||(this.subEvents(),this.io.reconnecting||this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting")),this},f.prototype.send=function(){var e=a(arguments);return e.unshift("message"),this.emit.apply(this,e),this},f.prototype.emit=function(e){if(d.hasOwnProperty(e))return p.apply(this,arguments),this;var t=a(arguments),n={type:(void 0!==this.flags.binary?this.flags.binary:u(t))?r.BINARY_EVENT:r.EVENT,data:t,options:{}};return n.options.compress=!this.flags||!1!==this.flags.compress,"function"===typeof t[t.length-1]&&(l("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),this.flags={},this},f.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},f.prototype.onopen=function(){if(l("transport is open - connecting"),"/"!==this.nsp)if(this.query){var e="object"===typeof this.query?c.encode(this.query):this.query;l("sending connect packet with query %s",e),this.packet({type:r.CONNECT,query:e})}else this.packet({type:r.CONNECT})},f.prototype.onclose=function(e){l("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},f.prototype.onpacket=function(e){var t=e.nsp===this.nsp,n=e.type===r.ERROR&&"/"===e.nsp;if(t||n)switch(e.type){case r.CONNECT:this.onconnect();break;case r.EVENT:case r.BINARY_EVENT:this.onevent(e);break;case r.ACK:case r.BINARY_ACK:this.onack(e);break;case r.DISCONNECT:this.ondisconnect();break;case r.ERROR:this.emit("error",e.data)}},f.prototype.onevent=function(e){var t=e.data||[];l("emitting event %j",t),null!=e.id&&(l("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?p.apply(this,t):this.receiveBuffer.push(t)},f.prototype.ack=function(e){var t=this,n=!1;return function(){if(!n){n=!0;var o=a(arguments);l("sending ack %j",o),t.packet({type:u(o)?r.BINARY_ACK:r.ACK,id:e,data:o})}}},f.prototype.onack=function(e){var t=this.acks[e.id];"function"===typeof t?(l("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):l("bad ack %s",e.id)},f.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emitBuffered(),this.emit("connect")},f.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)p.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},f.prototype.ondisconnect=function(){l("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},f.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},f.prototype.close=f.prototype.disconnect=function(){return this.connected&&(l("performing disconnect (%s)",this.nsp),this.packet({type:r.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},f.prototype.compress=function(e){return this.flags.compress=e,this},f.prototype.binary=function(e){return this.flags.binary=e,this}},36273:function(e,t,n){var r=n(20204),o=n(54818)("socket.io-client:url");e.exports=function(e,t){var n=e;t=t||"undefined"!==typeof location&&location,null==e&&(e=t.protocol+"//"+t.host);"string"===typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(o("protocol-less url %s",e),e="undefined"!==typeof t?t.protocol+"//"+e:"https://"+e),o("parse %s",e),n=r(e));n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443"));n.path=n.path||"/";var a=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+a+":"+n.port,n.href=n.protocol+"://"+a+(t&&t.port===n.port?"":":"+n.port),n}},54818:function(e,t,n){var r=n(85224);function o(){var e;try{e=t.storage.debug}catch(n){}return!e&&"undefined"!==typeof r&&"env"in r&&(e={NODE_ENV:"production",PUBLIC_URL:"http://0.0.0.0:3000/assets/bundles",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.DEBUG),e}(t=e.exports=n(95589)).log=function(){return"object"===typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return;var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var o=0,a=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(o++,"%c"===e&&(a=o))})),e.splice(a,0,r)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(n){}},t.load=o,t.useColors=function(){if("undefined"!==typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},t.enable(o())},95589:function(e,t,n){function r(e){var n;function r(){if(r.enabled){var e=r,o=+new Date,a=o-(n||o);e.diff=a,e.prev=n,e.curr=o,n=o;for(var i=new Array(arguments.length),s=0;s<i.length;s++)i[s]=arguments[s];i[0]=t.coerce(i[0]),"string"!==typeof i[0]&&i.unshift("%O");var l=0;i[0]=i[0].replace(/%([a-zA-Z%])/g,(function(n,r){if("%%"===n)return n;l++;var o=t.formatters[r];if("function"===typeof o){var a=i[l];n=o.call(e,a),i.splice(l,1),l--}return n})),t.formatArgs.call(e,i),(r.log||t.log||console.log.bind(console)).apply(e,i)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=function(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}(e),r.destroy=o,"function"===typeof t.init&&t.init(r),t.instances.push(r),r}function o(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var n;t.save(e),t.names=[],t.skips=[];var r=("string"===typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var a=t.instances[n];a.enabled=t.enabled(a.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(80324),t.instances=[],t.names=[],t.skips=[],t.formatters={}},80324:function(e){var t=1e3,n=60*t,r=60*n,o=24*r,a=365.25*o;function i(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}e.exports=function(e,s){s=s||{};var l,c=typeof e;if("string"===c&&e.length>0)return function(e){if((e=String(e)).length>100)return;var i=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!i)return;var s=parseFloat(i[1]);switch((i[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return s*a;case"days":case"day":case"d":return s*o;case"hours":case"hour":case"hrs":case"hr":case"h":return s*r;case"minutes":case"minute":case"mins":case"min":case"m":return s*n;case"seconds":case"second":case"secs":case"sec":case"s":return s*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}(e);if("number"===c&&!1===isNaN(e))return s.long?i(l=e,o,"day")||i(l,r,"hour")||i(l,n,"minute")||i(l,t,"second")||l+" ms":function(e){if(e>=o)return Math.round(e/o)+"d";if(e>=r)return Math.round(e/r)+"h";if(e>=n)return Math.round(e/n)+"m";if(e>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},16775:function(e,t,n){var r=n(36173),o=n(91945),a=Object.prototype.toString,i="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===a.call(Blob),s="function"===typeof File||"undefined"!==typeof File&&"[object FileConstructor]"===a.call(File);function l(e,t){if(!e)return e;if(o(e)){var n={_placeholder:!0,num:t.length};return t.push(e),n}if(r(e)){for(var a=new Array(e.length),i=0;i<e.length;i++)a[i]=l(e[i],t);return a}if("object"===typeof e&&!(e instanceof Date)){a={};for(var s in e)a[s]=l(e[s],t);return a}return e}function c(e,t){if(!e)return e;if(e&&!0===e._placeholder){if("number"===typeof e.num&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}if(r(e))for(var n=0;n<e.length;n++)e[n]=c(e[n],t);else if("object"===typeof e)for(var o in e)e[o]=c(e[o],t);return e}t.deconstructPacket=function(e){var t=[],n=e.data,r=e;return r.data=l(n,t),r.attachments=t.length,{packet:r,buffers:t}},t.reconstructPacket=function(e,t){return e.data=c(e.data,t),e.attachments=void 0,e},t.removeBlobs=function(e,t){var n=0,a=e;!function e(l,c,u){if(!l)return l;if(i&&l instanceof Blob||s&&l instanceof File){n++;var d=new FileReader;d.onload=function(){u?u[c]=this.result:a=this.result,--n||t(a)},d.readAsArrayBuffer(l)}else if(r(l))for(var p=0;p<l.length;p++)e(l[p],p,l);else if("object"===typeof l&&!o(l))for(var f in l)e(l[f],f,l)}(a),n||t(a)}},8404:function(e,t,n){var r=n(48898)("socket.io-parser"),o=n(19621),a=n(16775),i=n(36173),s=n(91945);function l(){}t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=l,t.Decoder=d;var c=t.ERROR+'"encode error"';function u(e){var n=""+e.type;if(t.BINARY_EVENT!==e.type&&t.BINARY_ACK!==e.type||(n+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(n+=e.nsp+","),null!=e.id&&(n+=e.id),null!=e.data){var o=function(e){try{return JSON.stringify(e)}catch(t){return!1}}(e.data);if(!1===o)return c;n+=o}return r("encoded %j as %s",e,n),n}function d(){this.reconstructor=null}function p(e){this.reconPack=e,this.buffers=[]}l.prototype.encode=function(e,n){(r("encoding packet %j",e),t.BINARY_EVENT===e.type||t.BINARY_ACK===e.type)?function(e,t){function n(e){var n=a.deconstructPacket(e),r=u(n.packet),o=n.buffers;o.unshift(r),t(o)}a.removeBlobs(e,n)}(e,n):n([u(e)])},o(d.prototype),d.prototype.add=function(e){var n;if("string"===typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");n=function(e){var n=0,o={type:Number(e.charAt(0))};if(null==t.types[o.type])return a="unknown packet type "+o.type,{type:t.ERROR,data:"parser error: "+a};var a;if(t.BINARY_EVENT===o.type||t.BINARY_ACK===o.type){for(var s=n+1;"-"!==e.charAt(++n)&&n!=e.length;);var l=e.substring(s,n);if(l!=Number(l)||"-"!==e.charAt(n))throw new Error("Illegal attachments");o.attachments=Number(l)}if("/"===e.charAt(n+1)){for(s=n+1;++n;){if(","===(u=e.charAt(n)))break;if(n===e.length)break}o.nsp=e.substring(s,n)}else o.nsp="/";var c=e.charAt(n+1);if(""!==c&&Number(c)==c){for(s=n+1;++n;){var u;if(null==(u=e.charAt(n))||Number(u)!=u){--n;break}if(n===e.length)break}o.id=Number(e.substring(s,n+1))}if(e.charAt(++n)){var d=function(e){try{return JSON.parse(e)}catch(t){return!1}}(e.substr(n));if(!function(e,t){switch(e){case 0:return"object"===typeof t;case 1:return void 0===t;case 4:return"string"===typeof t||"object"===typeof t;case 2:case 5:return i(t)&&("string"===typeof t[0]||"number"===typeof t[0]);case 3:case 6:return i(t)}}(o.type,d))throw new Error("invalid payload");o.data=d}return r("decoded %s as %j",e,o),o}(e),t.BINARY_EVENT===n.type||t.BINARY_ACK===n.type?(this.reconstructor=new p(n),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",n)):this.emit("decoded",n)}else{if(!s(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(n=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",n))}},d.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},p.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=a.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},p.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},91945:function(e,t,n){var r=n(93325).hp;e.exports=function(e){return o&&r.isBuffer(e)||a&&(e instanceof ArrayBuffer||i(e))};var o="function"===typeof r&&"function"===typeof r.isBuffer,a="function"===typeof ArrayBuffer,i=function(e){return"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer}},48898:function(e,t,n){var r=n(85224);function o(){var e;try{e=t.storage.debug}catch(n){}return!e&&"undefined"!==typeof r&&"env"in r&&(e={NODE_ENV:"production",PUBLIC_URL:"http://0.0.0.0:3000/assets/bundles",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.DEBUG),e}(t=e.exports=n(96709)).log=function(){return"object"===typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return;var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var o=0,a=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(o++,"%c"===e&&(a=o))})),e.splice(a,0,r)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(n){}},t.load=o,t.useColors=function(){if("undefined"!==typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},t.enable(o())},96709:function(e,t,n){function r(e){var n;function r(){if(r.enabled){var e=r,o=+new Date,a=o-(n||o);e.diff=a,e.prev=n,e.curr=o,n=o;for(var i=new Array(arguments.length),s=0;s<i.length;s++)i[s]=arguments[s];i[0]=t.coerce(i[0]),"string"!==typeof i[0]&&i.unshift("%O");var l=0;i[0]=i[0].replace(/%([a-zA-Z%])/g,(function(n,r){if("%%"===n)return n;l++;var o=t.formatters[r];if("function"===typeof o){var a=i[l];n=o.call(e,a),i.splice(l,1),l--}return n})),t.formatArgs.call(e,i),(r.log||t.log||console.log.bind(console)).apply(e,i)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=function(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}(e),r.destroy=o,"function"===typeof t.init&&t.init(r),t.instances.push(r),r}function o(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var n;t.save(e),t.names=[],t.skips=[];var r=("string"===typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var a=t.instances[n];a.enabled=t.enabled(a.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(77604),t.instances=[],t.names=[],t.skips=[],t.formatters={}},36173:function(e){var t={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==t.call(e)}},77604:function(e){var t=1e3,n=60*t,r=60*n,o=24*r,a=365.25*o;function i(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}e.exports=function(e,s){s=s||{};var l,c=typeof e;if("string"===c&&e.length>0)return function(e){if((e=String(e)).length>100)return;var i=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!i)return;var s=parseFloat(i[1]);switch((i[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return s*a;case"days":case"day":case"d":return s*o;case"hours":case"hour":case"hrs":case"hr":case"h":return s*r;case"minutes":case"minute":case"mins":case"min":case"m":return s*n;case"seconds":case"second":case"secs":case"sec":case"s":return s*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}(e);if("number"===c&&!1===isNaN(e))return s.long?i(l=e,o,"day")||i(l,r,"hour")||i(l,n,"minute")||i(l,t,"second")||l+" ms":function(e){if(e>=o)return Math.round(e/o)+"d";if(e>=r)return Math.round(e/r)+"h";if(e>=n)return Math.round(e/n)+"m";if(e>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},73802:function(e){e.exports=function(e,t){for(var n=[],r=(t=t||0)||0;r<e.length;r++)n[r-t]=e[r];return n}},7479:function(e){"use strict";var t,n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),r=64,o={},a=0,i=0;function s(e){var t="";do{t=n[e%r]+t,e=Math.floor(e/r)}while(e>0);return t}function l(){var e=s(+new Date);return e!==t?(a=0,t=e):e+"."+s(a++)}for(;i<r;i++)o[n[i]]=i;l.encode=s,l.decode=function(e){var t=0;for(i=0;i<e.length;i++)t=t*r+o[e.charAt(i)];return t},e.exports=l},63138:function(e,t,n){"use strict";n.r(t),t.default={}},41939:function(e,t,n){"use strict";n.r(t),t.default={}},70238:function(e,t,n){"use strict";n.r(t),t.default={}},86954:function(e,t,n){"use strict";n.r(t),t.default={}},95399:function(e,t,n){"use strict";n.r(t),t.default={}},41341:function(e,t,n){"use strict";n.r(t),t.default={}},91173:function(e,t,n){"use strict";n.r(t),t.default={}},35816:function(e,t,n){"use strict";n.r(t),t.default={}},22257:function(e,t,n){"use strict";n.r(t),t.default={}},16525:function(e,t,n){"use strict";n.r(t),t.default={}},41186:function(e,t,n){"use strict";n.r(t),t.default={}},60784:function(e,t,n){"use strict";n.r(t),t.default={}},71188:function(e,t,n){"use strict";n.r(t),t.default={}},77392:function(e,t,n){"use strict";n.r(t),t.default={}},27770:function(e,t,n){"use strict";n.r(t),t.default={}},61945:function(e,t,n){"use strict";n.r(t),t.default={}},3627:function(e,t,n){"use strict";n.r(t),t.default={}},12081:function(e,t,n){"use strict";n.r(t),t.default={}},89156:function(e,t,n){"use strict";n.r(t),t.default={}},83695:function(e,t,n){"use strict";n.r(t),t.default={}},65544:function(e,t,n){"use strict";n.r(t),t.default={}},58986:function(e,t,n){"use strict";n.r(t),t.default={}},35174:function(e,t,n){"use strict";n.r(t),t.default={}},90562:function(e,t,n){"use strict";n.r(t),t.default={}},15623:function(e,t,n){"use strict";n.r(t),t.default={}},92305:function(e,t,n){"use strict";n.r(t),t.default={}},96285:function(e,t,n){"use strict";n.r(t),t.default={}},10806:function(e,t,n){"use strict";n.r(t),t.default={}},70545:function(e,t,n){"use strict";n.r(t),t.default={}},9399:function(e,t,n){"use strict";n.r(t),t.default={}},42283:function(e,t,n){"use strict";n.r(t),t.default={}},79079:function(e,t,n){"use strict";n.r(t),t.default={}},38469:function(e,t,n){"use strict";n.r(t),t.default={}},49202:function(e,t,n){"use strict";n.r(t),t.default={}},70359:function(e,t,n){"use strict";n.r(t),t.default={}},55501:function(e,t,n){"use strict";n.r(t),t.default={}},84425:function(e,t,n){"use strict";n.r(t),t.default={}},13461:function(e,t,n){"use strict";n.r(t),t.default={}},83162:function(e,t,n){"use strict";n.r(t),t.default={}},68431:function(e,t,n){"use strict";n.r(t),t.default={}},53021:function(e,t,n){"use strict";n.r(t),t.default={}},16482:function(e,t,n){"use strict";n.r(t),t.default={}},99201:function(e,t,n){"use strict";n.r(t),t.default={}},21825:function(e,t,n){"use strict";n.r(t),t.default={}},48119:function(e,t,n){"use strict";n.r(t),t.default={}},56643:function(e,t,n){"use strict";n.r(t),t.default={}},65190:function(e,t,n){"use strict";n.r(t),t.default={}},34966:function(e,t,n){"use strict";n.r(t),t.default={}},51969:function(e,t,n){"use strict";n.r(t),t.default={}},96114:function(e,t,n){"use strict";n.r(t),t.default={}},54497:function(e,t,n){"use strict";n.r(t),t.default={}},64555:function(e,t,n){"use strict";n.r(t),t.default={}},50781:function(e,t,n){"use strict";n.r(t),t.default={}},17746:function(e,t,n){"use strict";n.r(t),t.default={}},47175:function(e,t,n){"use strict";n.r(t),t.default={}},2872:function(e,t,n){"use strict";n.r(t),t.default={}},22757:function(e,t,n){"use strict";n.r(t),t.default={}},93401:function(e,t,n){"use strict";n.r(t),t.default={}},24103:function(e,t,n){"use strict";n.r(t),t.default={}},11624:function(e,t,n){"use strict";n.r(t),t.default={}},94307:function(e,t,n){"use strict";n.r(t),t.default={}},52029:function(e,t,n){"use strict";n.r(t),t.default={}},29244:function(e,t,n){"use strict";n.r(t),t.default={}},94298:function(e,t,n){"use strict";n.r(t),t.default={}},36917:function(e,t,n){"use strict";n.r(t),t.default={}},94940:function(e,t,n){"use strict";n.r(t),t.default={}},57314:function(e,t,n){"use strict";n.r(t),t.default={}},33215:function(e,t,n){"use strict";n.r(t),t.default={}},60062:function(e,t,n){"use strict";n.r(t),t.default={}},47100:function(){},79627:function(e,t,n){"use strict";n.r(t),t.default={}},25660:function(){}},function(e){e.O(0,[4223],(function(){return t=52074,e(e.s=t);var t}));e.O()}]);