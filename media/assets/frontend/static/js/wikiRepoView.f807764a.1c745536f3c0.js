"use strict";(self.webpackChunkseahub_frontend=self.webpackChunkseahub_frontend||[]).push([[7004],{99991:function(e,t,n){n.d(t,{A:function(){return g}});var r=n(5544),a=n(9950),i=n(40326),o=n(80415),u=n(12549),s=n(44414),c=function(e){var t=e.recordsCount,n=e.columnsCount,o=e.setHasSearchValue,u=e.searchCells,c=e.onKeyDown,l=(0,a.useState)(""),d=(0,r.default)(l,2),f=d[0],v=d[1],g=(0,a.useRef)(!1),h=(0,a.useRef)(null),p=function(e){h.current&&clearTimeout(h.current);var r=e.target.value,a=function(){var e=(t||0)*(n||0)*.1;return(e=e>500?500:Math.floor(e))<100&&(e=100),e}(),i=r||"",s=i.trim();v(i),o(!!s),g.current||(h.current=setTimeout((function(){u&&u(s)}),a))};return(0,s.jsx)("input",{className:"sf-table-searcher-input form-control",name:"sf-table-search-input",type:"text",autoFocus:!0,value:f,onChange:p,placeholder:(0,i.APU)("Search"),onKeyDown:c,onCompositionStart:function(){g.current=!0},onCompositionEnd:function(e){g.current=!1,p(e)}})},l=n(74361),d=n(61105),f=n(45613),v=n(95754),g=function(e){var t=e.recordsCount,n=e.columnsCount,g=e.searchResult,h=e.searchCells,p=e.closeSearcher,m=e.focusNextMatchedCell,y=e.focusPreviousMatchedCell,w=e.showResultNavigation,b=void 0===w||w,C=(0,a.useState)(!1),D=(0,r.default)(C,2),T=D[0],E=D[1],I=(0,a.useState)(!1),S=(0,r.default)(I,2),O=S[0],_=S[1],k=(0,a.useMemo)((function(){return(0,l.Y)(g)}),[g]),A=(0,a.useCallback)((function(){E(!1),p&&p()}),[p]);return(0,a.useEffect)((function(){var e=window.sfMetadataContext&&window.sfMetadataContext.eventBus,t=e&&e.subscribe(d.Tw.RESET_SEARCH_BAR,A);return function(){t&&t()}}),[A]),(0,s.jsxs)("div",{className:"sf-table-searcher-container",children:[!T&&(0,s.jsx)(f.A,{className:"sf-table-searcher-btn active-search m-0",symbol:"search",title:(0,i.APU)("Search"),op:function(){E(!T)}}),T&&(0,s.jsxs)("div",{className:"sf-table-searcher-input-wrapper",children:[(0,s.jsx)("span",{className:"input-icon-addon",children:(0,s.jsx)(v.A,{symbol:"search"})}),(0,s.jsx)(c,{recordsCount:t,columnsCount:n,onKeyDown:function(e){var t=!k;if(e.keyCode===o.cK.Escape)e.preventDefault(),A();else if((0,u.E5)(e)){if(e.preventDefault(),t)return;m&&m()}else if((0,u.ks)(e)){if(e.preventDefault(),t)return;y&&y()}},setHasSearchValue:_,searchCells:h}),b?(0,s.jsxs)("span",{className:"input-icon-addon search-poll-button",children:[O&&(0,s.jsx)("span",{className:"search-description",children:k?g.currentSelectIndex+1+" of "+g.matchedCells.length:"0 of 0"}),k&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"toolbar-search-btn",role:"button",onClick:y||function(){},children:(0,s.jsx)(v.A,{symbol:"down",className:"rotate-180"})}),(0,s.jsx)("span",{role:"button",className:"toolbar-search-btn",onClick:m||function(){},children:(0,s.jsx)(v.A,{symbol:"down"})})]})]}):null,(0,s.jsx)(f.A,{title:(0,i.APU)("Close"),className:"btn-close-searcher-wrapper input-icon-addon",symbol:"x-01",op:A})]})]})}},75904:function(e,t,n){n.d(t,{Q1:function(){return E},uR:function(){return h},Qg:function(){return _},EZ:function(){return M},Uy:function(){return L},vj:function(){return F},cw:function(){return S}});var r=n(5544),a=n(9950),i=n(61105),o=n(40326),u=n(48308),s=n(34322),c=n(65488),l=n(95754),d=n(65604),f=n(44414),v=function(e){var t=e.viewID,n=(0,a.useState)((function(){return window.sfMetadataContext.localStorage.getItem(i.fi,0)||0})),u=(0,r.default)(n,2),v=u[0],g=u[1];(0,a.useEffect)((function(){var e=window.sfMetadataContext.localStorage.getItem(i.fi,0);g(e||0)}),[t]);var h=(0,a.useCallback)((function(e){var t=parseInt(e.target.value,10);g(t),window.sfMetadataContext.eventBus.dispatch(i.Tw.MODIFY_GALLERY_ZOOM_GEAR,t)}),[]),p=(0,a.useCallback)((function(){if(!(v>=i.uK)){var e=Math.min(v+1,i.uK);g(e),window.sfMetadataContext.eventBus.dispatch(i.Tw.MODIFY_GALLERY_ZOOM_GEAR,e)}}),[v]),m=(0,a.useCallback)((function(){if(!(v<=i.yp)){var e=Math.max(v-1,i.yp);g(e),window.sfMetadataContext.eventBus.dispatch(i.Tw.MODIFY_GALLERY_ZOOM_GEAR,e)}}),[v]);return(0,f.jsxs)("div",{className:"metadata-slider-container",children:[(0,f.jsx)(s.A,{className:"metadata-slider-icon-button",onClick:m,disabled:v<=i.yp,"aria-label":(0,o.APU)("Zoom out"),title:(0,o.APU)("Zoom out"),onKeyDown:d.Aq.onKeyDown,children:(0,f.jsx)(l.A,{symbol:"minus_sign",className:"metadata-slider-icon"})}),(0,f.jsx)(c.A,{type:"range",tabIndex:-1,"aria-hidden":"true",min:i.yp,max:i.uK,step:"1",value:v,onChange:h,className:"metadata-slider"}),(0,f.jsx)(s.A,{className:"metadata-slider-icon-button",onClick:p,disabled:v>=i.uK,"aria-label":(0,o.APU)("Zoom in"),title:(0,o.APU)("Zoom in"),onKeyDown:d.Aq.onKeyDown,children:(0,f.jsx)(l.A,{symbol:"new",className:"metadata-slider-icon"})})]})},g=[{value:i._Y.YEAR,label:(0,o.APU)("Year")},{value:i._Y.MONTH,label:(0,o.APU)("Month")},{value:i._Y.DAY,label:(0,o.APU)("Day")},{value:i._Y.ALL,label:(0,o.APU)("All")}],h=function(e){var t=e.viewID,n=(0,a.useState)(i._Y.YEAR),o=(0,r.default)(n,2),s=o[0],c=o[1],l=(0,a.useCallback)((function(e){e!==s&&(window.sfMetadataContext.localStorage.setItem(i.Wr,e),window.sfMetadataContext.eventBus.dispatch(i.Tw.SWITCH_GALLERY_GROUP_BY,e))}),[s]);return(0,a.useEffect)((function(){var e=window.sfMetadataContext.eventBus.subscribe(i.Tw.SWITCH_GALLERY_GROUP_BY,(function(e){e!==s&&c(e)}));return function(){e()}}),[s]),(0,a.useEffect)((function(){var e=window.sfMetadataContext.localStorage.getItem(i.Wr,i._Y.DAY);c(e||i._Y.DAY)}),[t]),(0,f.jsxs)(f.Fragment,{children:[s===i._Y.ALL&&(0,f.jsx)(v,{viewID:t}),(0,f.jsx)(u.A,{className:"sf-metadata-gallery-groupby-setter",value:s,options:g,onChange:l})]})},p=n(48738),m=n.n(p),y=n(55097),w=n.n(y),b=n(49867),C=n(73737),D=n(42146),T=n(12549),E=function(e){var t=e.readOnly,n=e.columns,u=e.wrapperClass,s=e.filters,c=e.isPre,l=e.collaborators,d=e.filtersClassName,v=e.target,g=void 0===v?"sf-metadata-filter-popover":v,h=e.filterConjunction,p=e.basicFilters,y=void 0===p?[]:p,E=e.modifyFilters,I=e.viewType,S=void 0===I?i.rX.TABLE:I,O=(0,a.useState)(!1),_=(0,r.default)(O,2),k=_[0],A=_[1],R=(0,a.useMemo)((function(){return w()((0,D.a1)(s||[],n))}),[s,n]),x=(0,a.useMemo)((function(){return R.length+y.length}),[R,y]),N=(0,a.useMemo)((function(){return 1===x?(0,o.APU)("1 filter"):x>1?x+" "+(0,o.APU)("Filters"):(0,o.APU)("Filter")}),[x]),M=(0,a.useCallback)((function(){A(!k)}),[k]),P=(0,a.useCallback)((function(e){e.stopPropagation(),((0,T.RI)(e)||(0,T.xC)(e))&&M()}),[M]),L=(0,a.useCallback)((function(e){var t=e||{},r=t.filters,a=t.filter_conjunction,i=t.basic_filters,o=(0,D.a1)(r,n);E(o,a,i)}),[n,E]);if(!n)return null;var j=m()(u,{active:x>0});return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(b.A,{symbol:"filter",size:24,className:j,onClick:M,role:"button",onKeyDown:P,title:N,"aria-label":N,tabIndex:0,id:g}),k&&(0,f.jsx)(C.Iz,{placement:"bottom-end",filtersClassName:d,target:g,readOnly:t,columns:n,collaborators:l,filterConjunction:h,filters:R,basicFilters:y,hidePopover:M,update:L,isPre:c,viewType:S})]})},I=n(12455),S=function(e){var t=e.target,n=void 0===t?"sf-metadata-sort-popover":t,u=e.type,s=e.sorts,c=e.readOnly,l=e.columns,v=e.wrapperClass,g=e.modifySorts,h=(0,a.useState)(!1),p=(0,r.default)(h,2),y=p[0],w=p[1],D=(0,a.useMemo)((function(){return(0,I.iW)(s||[],l)}),[s,l]),T=(0,a.useMemo)((function(){var e=D.length;return 1===e?(0,o.APU)("1 sort"):e>1?e+" "+(0,o.APU)("sorts"):(0,o.APU)("Sort")}),[D]),E=(0,a.useCallback)((function(){w(!0)}),[]);(0,a.useEffect)((function(){var e=window.sfMetadataContext.eventBus.subscribe(i.Tw.DISPLAY_SORTS,E);return function(){e()}}),[]);var S=(0,a.useCallback)((function(){w(!y)}),[y]),O=(0,a.useCallback)((function(e){var t=(e||{}).sorts;g(t)}),[g]);return l?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(b.A,{symbol:"sort",size:24,className:m()(v,{active:D.length>0}),onClick:S,tabIndex:0,role:"button",onKeyDown:d.Aq.onKeyDown,title:T,"aria-label":(0,o.APU)("Sort"),id:n}),y&&(0,f.jsx)(C.cu,{readOnly:c,type:u,target:n,columns:l,sorts:D,hidePopover:S,update:O})]}):null},O=n(3277),_=function(e){var t=e.target,n=void 0===t?"sf-metadata-groupby-popover":t,u=e.columns,s=e.readOnly,c=e.groupbys,l=e.wrapperClass,d=e.modifyGroupbys,v=(0,a.useState)(!1),g=(0,r.default)(v,2),h=g[0],p=g[1],y=(0,a.useMemo)((function(){return u.filter((function(e){return i.Ll.includes(e.type)}))}),[u]),w=(0,a.useMemo)((function(){return(0,O.YD)(c,y)||[]}),[y,c]),D=(0,a.useMemo)((function(){var e=w?w.length:0;return 1===e?(0,o.APU)("Grouped by 1 property"):e>1?(0,o.APU)("Grouped by {name_placeholder} properties").replace("{name_placeholder}",e):(0,o.APU)("Group by")}),[w]),E=(0,a.useCallback)((function(){p(!h)}),[h]),I=(0,a.useCallback)((function(e){e.stopPropagation(),((0,T.RI)(e)||(0,T.xC)(e))&&E()}),[E]),S=(0,a.useCallback)((function(e){var t=(0,O.YD)(e,y);d(t)}),[y,d]),_=m()(l,{active:w.length>0});return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(b.A,{symbol:"group",size:24,className:_,onClick:E,role:"button",onKeyDown:I,title:D,"aria-label":D,tabIndex:0,id:n}),h&&(0,f.jsx)(C.D0,{readOnly:s,groupbys:w,target:n,placement:"bottom-end",columns:y,hidePopover:E,onChange:S})]})},k=n(23029),A=n(92901),R=n(39874),x=n(85501),N=(a.Component,n(75150)),M=function(e){var t=e.readOnly,n=e.columns,u=e.wrapperClass,s=e.target,c=e.hiddenColumns,l=e.modifyHiddenColumns,d=e.modifyColumnOrder,v=(0,a.useState)(!1),g=(0,r.default)(v,2),h=g[0],p=g[1],y=(0,N.nk)().globalHiddenColumns,w=(0,a.useMemo)((function(){return n.filter((function(e){return!i.of.includes(e.key)&&!y.includes(e.key)}))}),[n,y]),D=(0,a.useMemo)((function(){return c.filter((function(e){return n.find((function(t){return t.key===e}))}))}),[n,c]),E=(0,a.useMemo)((function(){var e=D.length;return 1===e?(0,o.APU)("1 hidden property"):e>1?(0,o.APU)("{name_placeholder} hidden properties").replace("{name_placeholder}",e):(0,o.APU)("Hide properties")}),[D]),I=(0,a.useCallback)((function(){p(!h)}),[h]),S=(0,a.useCallback)((function(e){e.stopPropagation(),((0,T.RI)(e)||(0,T.xC)(e))&&I()}),[I]),O=(0,a.useCallback)((function(e){l(e)}),[l]),_=m()(u,{active:D.length>0});return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(b.A,{symbol:"hide",size:24,className:_,onClick:I,role:"button",onKeyDown:S,title:E,"aria-label":E,tabIndex:0,id:s}),h&&(0,f.jsx)(C.Oe,{readOnly:t,hiddenColumns:D,target:s,placement:"bottom-end",columns:w,hidePopover:I,onChange:O,modifyColumnOrder:d})]})},P=[{value:i.K$.MAP,label:(0,o.APU)("Map")},{value:i.K$.SATELLITE,label:(0,o.APU)("Satellite")}],L=function(e){var t=e.viewID,n=(0,a.useState)(i.K$.MAP),o=(0,r.default)(n,2),s=o[0],c=o[1];(0,a.useEffect)((function(){var e=window.sfMetadataContext.localStorage.getItem(i.q8)||i.K$.MAP;c(e)}),[t]);var l=(0,a.useCallback)((function(e){s!==e&&(c(e),window.sfMetadataContext.eventBus.dispatch(i.Tw.MODIFY_MAP_TYPE,e))}),[s]);return(0,f.jsx)(u.A,{className:"sf-metadata-map-type-setter",options:P,value:s,onChange:l})},j=n(99991),F=function(e){var t=e.viewId,n=e.columns,o=(0,a.useState)(null),u=(0,r.default)(o,2),s=u[0],c=u[1],l=(0,a.useState)(""),d=(0,r.default)(l,2),v=d[0],g=d[1],h=(0,a.useMemo)((function(){var e,t;return(null===(e=window.sfMetadataStore)||void 0===e||null===(t=e.view)||void 0===t?void 0:t.records_count)||0}),[]),p=(0,a.useMemo)((function(){return(null===n||void 0===n?void 0:n.length)||0}),[n]),m=(0,a.useCallback)((function(e){g(e),window.sfMetadataContext.eventBus&&window.sfMetadataContext.eventBus.dispatch(i.Tw.SEARCH_ROWS,e,(function(e){c(e)}))}),[]),y=(0,a.useCallback)((function(){g(""),c(null),window.sfMetadataContext.eventBus&&window.sfMetadataContext.eventBus.dispatch(i.Tw.SEARCH_ROWS)}),[]);return(0,a.useEffect)((function(){var e;if(null!==(e=window.sfMetadataContext)&&void 0!==e&&e.eventBus)return window.sfMetadataContext.eventBus.subscribe(i.Tw.RESET_SEARCH_BAR,(function(){g(""),c(null)}))}),[]),(0,a.useEffect)((function(){var e;g(""),c(null),null!==(e=window.sfMetadataContext)&&void 0!==e&&e.eventBus&&window.sfMetadataContext.eventBus.dispatch(i.Tw.SEARCH_ROWS,"")}),[t]),(0,f.jsx)(j.A,{recordsCount:h,columnsCount:p,searchResult:s,searchCells:m,closeSearcher:y,showResultNavigation:!1,searchValue:v},t)}},15847:function(e,t,n){var r=n(9950),a=n(75904),i=n(61105),o=n(75150),u=n(44414);t.A=function(e){var t=e.readOnly,n=e.view,s=e.collaborators,c=e.modifyFilters,l=e.modifySorts,d=e.modifyGroupbys,f=e.modifyHiddenColumns,v=e.modifyColumnOrder,g=(0,o.nk)().globalHiddenColumns,h=(0,r.useMemo)((function(){return n.type}),[n]),p=(0,r.useMemo)((function(){return n?n.columns.filter((function(e){return!g.includes(e.key)})):[]}),[n,g]),m=(0,r.useMemo)((function(){return p.filter((function(e){return e.key!==i.L2.FILE_TYPE}))}),[p]);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("div",{className:"sf-metadata-tool-left-operations",children:[(0,u.jsx)(a.vj,{viewId:n._id,columns:p}),(0,u.jsx)(a.Q1,{wrapperClass:"sf-metadata-view-tool-operation-btn sf-metadata-view-tool-filter",filtersClassName:"sf-metadata-filters",target:"sf-metadata-filter-popover",readOnly:t,filterConjunction:n.filter_conjunction,basicFilters:n.basic_filters,filters:n.filters,columns:m,modifyFilters:c,collaborators:s,viewType:h}),(0,u.jsx)(a.cw,{wrapperClass:"sf-metadata-view-tool-operation-btn sf-metadata-view-tool-sort",target:"sf-metadata-sort-popover",readOnly:t,sorts:n.sorts,type:h,columns:p,modifySorts:l}),(0,u.jsx)(a.Qg,{wrapperClass:"sf-metadata-view-tool-operation-btn sf-metadata-view-tool-groupby",target:"sf-metadata-groupby-popover",readOnly:t,columns:p,groupbys:n.groupbys,modifyGroupbys:d}),(0,u.jsx)(a.EZ,{wrapperClass:"sf-metadata-view-tool-operation-btn sf-metadata-view-tool-hide-column",target:"sf-metadata-hide-column-popover",readOnly:t,columns:p.slice(1),hiddenColumns:n.hidden_columns||[],modifyHiddenColumns:f,modifyColumnOrder:v})]}),(0,u.jsx)("div",{className:"sf-metadata-tool-right-operations"})]})}},28360:function(e,t,n){var r=n(9950),a=n(1352),i=n(5544),o=n(17065),u=n(72500),s=n(24765),c=n(64467),l=n(89379),d=n(80045),f=n(4086),v=n(51112),g=n(61105),h=n(65604),p=n(44049),m=n(10222),y=n(48621),w=n(87364),b=n(11037),C=n(1560),D=n(40326),T=n(27404),E=n(75150),I=n(74361),S=n(62822),O=n(10467),_=n(23029),k=n(92901),A=n(146),R=n(72249),x=n(11238),N=n(90287),M=n(49211),P=function(){return(0,k.default)((function e(){var t=this;(0,_.default)(this,e),this.getCollaborators=function(e){var n=t.server+"/api/v2.1/repos/"+e+"/related-users/";return t.req.get(n)},this.listUserInfo=function(e){var n=t.server+"/api/v2.1/user-list/",r={user_id_list:e};return t._sendPostRequest(n,r,{headers:{"Content-type":"application/json"}})}}),[{key:"init",value:function(e){var t=e.server,n=e.username,r=e.password,a=e.token;return this.server=t,this.username=n,this.password=r,this.token=a,this.token&&this.server&&(this.req=N.A.create({baseURL:this.server,headers:{Authorization:"Token "+this.token}})),this}},{key:"initForSeahubUsage",value:function(e){var t=e.siteRoot,n=e.xcsrfHeaders;if(t&&"/"===t.charAt(t.length-1)){var r=t.substring(0,t.length-1);this.server=r}else this.server=t;return this.req=N.A.create({headers:{"X-CSRFToken":n}}),this}},{key:"_sendPostRequest",value:function(e,t){return t.getHeaders?this.req.post(e,t,{headers:t.getHeaders()}):this.req.post(e,t)}},{key:"getMetadata",value:function(e,t,n){var r=this.server+"/api/v2.1/wiki2/"+e+"/views/"+t+"/records/";return this.req.get(r,{params:n})}},{key:"getView",value:function(e,t){var n=this.server+"/api/v2.1/wiki2/"+e+"/views/"+t+"/";return this.req.get(n)}},{key:"modifyView",value:function(e,t,n){var r=this.server+"/api/v2.1/wiki2/"+e+"/views/",a={view_id:t,view_data:n};return this.req.put(r,a)}}])}(),L=new P,j=M.A.get("sfcsrftoken");L.initForSeahubUsage({siteRoot:D.YcY,xcsrfHeaders:j});var F=L,B=window.app.pageOptions.wikiID,U=function(){return(0,k.default)((function e(){var t=this;(0,_.default)(this,e),this.destroy=function(){t.settings={},t.metadataAPI=null,t.tagsAPI=null,t.localStorage=null,t.eventBus=null,t.hasInit=!1,t.permission="r"},this.getSetting=function(e){return!1===t.settings[e]?t.settings[e]:t.settings[e]||""},this.setSetting=function(e,n){t.settings[e]=n},this.getUsername=function(){return D.Xh_},this.updateFileTags=function(e){var n=t.settings.repoID;return t.tagsAPI.updateFileTags(n,e)},this.getCollaborators=function(){var e=t.settings.repoID;return t.metadataAPI.getCollaborators(e)},this.getMetadata=function(e){if(!t.metadataAPI)return null;var n=e.view_id;return t.metadataAPI.getMetadata(B,n,e)},this.getView=function(e){return t.metadataAPI.getView(B,e)},this.modifyView=function(e,n,r){return t.metadataAPI.modifyView(B,n,r)},this.canInsertColumn=function(){return!1},this.canModify=function(){return!1},this.canModifyRow=function(){return!1},this.canModifyColumn=function(){return!1},this.canModifyColumnOrder=function(){return!1},this.canModifyRows=function(){return!1},this.canPreview=function(){return!1},this.canModifyView=function(){return"r"!==t.permission},this.settings={lang:D.vVe},this.metadataAPI=null,this.tagsAPI=null,this.localStorage=null,this.eventBus=null,this.hasInit=!1,this.permission="r",this.collaboratorsCache={}}),[{key:"init",value:function(){var e=(0,O.default)((0,S.A)().mark((function e(t){var n,r,a,i,o,u;return(0,S.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.hasInit){e.next=2;break}return e.abrupt("return");case 2:this.settings=(0,l.default)((0,l.default)({},this.settings),t),this.metadataAPI=F,this.tagsAPI=x.A,n=this.settings.repoInfo,this.permission="admin"!==n.permission&&"rw"!==n.permission?"r":"rw",r=this.settings,a=r.repoID,i=r.viewID,o=i?"sf-metadata-".concat(a,"-").concat(i):"sf-metadata-".concat(a),this.localStorage=new A.A(o),u=new R.A,this.eventBus=u,this.hasInit=!0;case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}])}(),V=U,H=n(44414),G=["children","repoID","viewID","renameFileCallback","deleteFilesCallback","moveFileCallback","copyFileCallback","toggleShowDirentToolbar"],Y=["subgroups","row_ids"],q=r.createContext(null),K=function(e){var t=e.children,n=e.repoID,a=e.viewID,o=e.renameFileCallback,u=e.deleteFilesCallback,S=e.moveFileCallback,O=e.copyFileCallback,_=e.toggleShowDirentToolbar,k=(0,d.default)(e,G),A=(0,r.useState)(!0),R=(0,i.default)(A,2),x=R[0],N=R[1],M=(0,r.useState)({rows:[],columns:[],view:{}}),P=(0,i.default)(M,2),L=P[0],j=P[1],F=(0,r.useState)(null),B=(0,i.default)(F,2),U=B[0],K=B[1],W=(0,T.PL)().modifyLocalFileTags,Z=(0,r.useState)({searchValue:"",searchResult:null,isActive:!1,lastSearchMetadata:null}),X=(0,i.default)(Z,2),z=X[0],Q=X[1],$=(0,m.D)(),J=$.collaborators,ee=$.collaboratorsCache,te=(0,p.p)(),ne=te.isBeingBuilt,re=te.setIsBeingBuilt,ae=(0,E.Tz)(),ie=ae.onOCR,oe=ae.generateDescription,ue=ae.extractFilesDetails,se=ae.faceRecognition,ce=ae.generateFileTags,le=(0,E.nk)().globalHiddenColumns,de=(0,r.useRef)(null),fe=(0,r.useRef)(null),ve=(0,r.useRef)(J),ge=(0,r.useCallback)((function(e){return!(!z.isActive||!z.searchValue)&&(0,g.yj)(e)}),[z.isActive,z.searchValue]),he=(0,r.useCallback)((function(){Q({searchValue:"",searchResult:null,isActive:!1,lastSearchMetadata:null})}),[]),pe=(0,r.useCallback)((function(e){Q((function(t){return(0,l.default)((0,l.default)({},t),e)}))}),[]),me=(0,r.useRef)(null),ye=(0,r.useCallback)((function(e){var t,n;me.current?me.current(e):(null!==(t=de.current)&&void 0!==t&&t.data&&j(de.current.data),z.isActive&&(he(),null!==(n=window.sfMetadataContext)&&void 0!==n&&n.eventBus&&window.sfMetadataContext.eventBus.dispatch(g.Tw.RESET_SEARCH_BAR)))}),[z.isActive,he]),we=(0,r.useCallback)((function(){ye(g.Tw.LOCAL_TABLE_CHANGED)}),[ye]),be=(0,r.useCallback)((function(){ye(g.Tw.SERVER_TABLE_CHANGED)}),[ye]),Ce=(0,r.useCallback)((function(e){f.A.danger(e.error)}),[]),De=(0,r.useCallback)((function(e){ye(g.Tw.UPDATE_TABLE_ROWS)}),[ye]),Te=(0,r.useCallback)((function(){N(!0),de.current.reload(g.bK).then((function(){N(!1),fe.current=null,ye(g.Tw.RELOAD_DATA)})).catch((function(e){var t=h.Aq.getErrorMsg(e);K(t),N(!1)}))}),[ye]),Ee=(0,r.useCallback)((function(){fe.current&&clearTimeout(fe.current),fe.current=setTimeout((function(){Te()}),600)}),[Te]),Ie=(0,r.useCallback)((function(e,t,n){de.current.modifyFilters(t,e,n),setTimeout((function(){return ye(g.Tw.MODIFY_FILTERS)}),0)}),[de,ye]),Se=(0,r.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];de.current.modifySorts(e,t),setTimeout((function(){return ye(g.Tw.MODIFY_SORTS)}),0)}),[de,ye]),Oe=(0,r.useCallback)((function(e){de.current.modifyGroupbys(e),setTimeout((function(){return ye(g.Tw.MODIFY_GROUPBYS)}),0)}),[de,ye]),_e=(0,r.useCallback)((function(e){de.current.modifyHiddenColumns(e),setTimeout((function(){return ye(g.Tw.MODIFY_HIDDEN_COLUMNS)}),0)}),[de,ye]),ke=(0,r.useCallback)((function(e){de.current.modifySettings(e),setTimeout((function(){return ye(g.Tw.MODIFY_SETTINGS)}),0)}),[de,ye]),Ae=(0,r.useCallback)((function(e,t){var n=e.recordId,r=e.parentDir,a=e.fileName;de.current.modifyLocalRecord({record_id:n,parent_dir:r,file_name:a},t),setTimeout((function(){return ye(g.Tw.LOCAL_RECORD_CHANGED)}),0)}),[de,ye]),Re=(0,r.useCallback)((function(e,t,n){de.current.modifyLocalColumnData(e,t,n),setTimeout((function(){return ye(g.Tw.LOCAL_COLUMN_DATA_CHANGED)}),0)}),[ye]),xe=(0,r.useCallback)((function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},s=u.success_callback,c=u.fail_callback,l=de.current.checkIsRenameFileOperator(e,n),d=null;if(l){var v=e[0],g=(0,y.f)(L,v),p=n[v],m=g._parent_dir,b=g._name;d=(0,w.NZ)(p);var C=(0,h.yS)(d),T=C.isValid,E=C.errMessage;if(!T)return void f.A.danger(E);if(d===b)return;if(de.current.checkDuplicatedName(d,m)){var I=(0,D.APU)('The name "{name}" is already taken. Please choose a different name.');return I=I.replace("{name}",h.Aq.HTMLescape(d)),void f.A.danger(I)}}de.current.modifyRecords(e,t,n,r,a,i,l,{fail_callback:function(e){c&&c(e),e&&f.A.danger(e)},success_callback:function(e){if(e.is_rename){var t=e.row_ids[0],n=(0,y.f)(L,t),r=e.id_original_row_updates[t],a=e.id_original_old_row_data[t],i=(0,w.ND)(n),u=(0,w.NZ)(a),c=h.Aq.joinPath(i,u),l=(0,w.NZ)(r);o(c,l)}s&&s()}})}),[L,de,o]),Ne=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.success_callback,a=n.fail_callback;if(Array.isArray(e)&&0!==e.length){var i=[],o=[],s=(null===(t=de.current)||void 0===t?void 0:t.data)||L;e.forEach((function(e){var t=(0,y.f)(s,e)||{},n=t._parent_dir,r=t._name;if(n&&r){var a=h.Aq.joinPath(n,r);i.push(a),o.push(r)}})),de.current.deleteRecords(e,{fail_callback:function(e){a&&a(e),e&&f.A.danger(e)},success_callback:function(){u(i,o);var e=o.length>1?(0,D.APU)("Successfully deleted {name} and {n} other items"):(0,D.APU)("Successfully deleted {name}");e=e.replace("{name}",o[0]).replace("{n}",o.length-1),f.A.success(e),r&&r()}})}},Me=function(e,t,r,a,i,o){var u=t.repo_id,s=(0,y.f)(L,e),l=L.rows,d=(0,C.o4)(s),v=r.name,p=h.Aq.joinPath(i,v),m=[],b=[],D={},T={};if(n===u){var E=(0,w.$5)(l,a,v);if(b.push(e),D[e]=(0,c.default)((0,c.default)({},g.L2.PARENT_DIR,a),g.L2.FILE_NAME,E),T[e]=(0,c.default)((0,c.default)({},g.L2.PARENT_DIR,i),g.L2.FILE_NAME,v),d){var I=h.Aq.joinPath(a,E);l.forEach((function(e){var t=(0,w.ND)(e);if(e&&t.startsWith(p)){var n=(0,w.sq)(e);b.push(n),D[n]=(0,c.default)({},g.L2.PARENT_DIR,t.replace(p,I)),T[n]=(0,c.default)({},g.L2.PARENT_DIR,t)}}))}}else m=[e],d&&l.forEach((function(e){var t=(0,w.ND)(e);if(e&&t.startsWith(p)){var n=(0,w.sq)(e);m.push(n)}}));de.current.moveRecord(e,u,r,a,i,{modify_row_ids:b,modify_id_row_updates:D,modify_id_old_row_data:T,delete_row_ids:m},{success_callback:function(e){S&&S(n,t,r,a,i,e.task_id,o)},fail_callback:function(e){e&&f.A.danger(e)}})},Pe=function(e,t,r,a,i,o){de.current.duplicateRecord(e,t.repo_id,r,a,i,{success_callback:function(e){O&&O(n,t,r,a,i,e.task_id,o),n===t.repo_id&&Ee()},fail_callback:function(e){e&&f.A.danger(e)}})},Le=(0,r.useCallback)((function(e,t,n){de.current.renameColumn(e,t,n)}),[de]),je=(0,r.useCallback)((function(e,t){de.current.deleteColumn(e,t)}),[de]),Fe=(0,r.useCallback)((function(e,t,n){var r=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).optionModifyType;de.current.modifyColumnData(e,t,n,{optionModifyType:r})}),[de]),Be=(0,r.useCallback)((function(e,t){de.current.modifyColumnWidth(e,t)}),[de]),Ue=(0,r.useCallback)((function(e,t){de.current.modifyColumnOrder(e,t),setTimeout((function(){return ye(g.Tw.MODIFY_COLUMN_ORDER)}),0)}),[de,ye]),Ve=(0,r.useCallback)((function(e,t,n){var r=n.key,a=n.data;de.current.insertColumn(e,t,{key:r,data:a})}),[de]),He=(0,r.useCallback)((function(e){var t=e[0],n=t.record_id,r=t.tags;W(n,r),de.current.updateFileTags(e)}),[de,W]),Ge=(0,r.useCallback)((function(e,t){_(e.length>0),setTimeout((function(){window.sfMetadataContext&&window.sfMetadataContext.eventBus&&window.sfMetadataContext.eventBus.dispatch(g.Tw.SELECT_RECORDS,e,L,t)}),0)}),[L,_]),Ye=(0,r.useCallback)((function(e){var t=e.map((function(e){return(0,w.ql)(e)}));if(t.length>50)f.A.danger((0,D.APU)("Select up to 50 files"));else{var n=e.map((function(e){return(0,w.sq)(e)}));ue(t,{success_callback:function(t){var r,a=t.details,i={},o={},u={},s={},c=g.L2.CAPTURE_TIME,l=g.L2.LOCATION,d=(null===(r=de.current)||void 0===r?void 0:r.data)||L,f=(0,b.rm)(d.columns,g.L2.CAPTURE_TIME),v=(0,b.rm)(d.columns,g.L2.LOCATION);e.forEach((function(e){var t=e[g.L2.ID];i[t]={},o[t]={},f&&(i[t][c]=e[c],o[t][c]=e[c]),v&&(i[t][l]=e[l],o[t][l]=e[l],e._location_translated&&(i[t]._location_translated=e._location_translated,o[t]._location_translated=e._location_translated))})),a.forEach((function(e){var t=e[g.L2.ID];u[t]={},s[t]={},f&&(u[t][c]=e[c],s[t][c]=e[c]),v&&(u[t][l]=e[l],s[t][l]=e[l],e._location_translated&&(u[t]._location_translated=e._location_translated,s[t]._location_translated=e._location_translated))})),xe(n,u,s,i,o)}})}}),[L,ue,xe]),qe=(0,r.useCallback)((function(e){var t=e.map((function(e){return(0,w.ql)(e)}));t.length>50?f.A.danger((0,D.APU)("Select up to 50 files")):se(t)}),[se]),Ke=(0,r.useCallback)((function(e){var t=(0,w.ND)(e),n=(0,w.NZ)(e),r=(0,w.sq)(e);if(n&&t&&h.Aq.isDescriptionSupportedFile(n)){var a=g.L2.FILE_DESCRIPTION,i=(0,c.default)({},e[g.L2.ID],(0,c.default)({},a,e[a])),o=(0,c.default)({},e[g.L2.ID],(0,c.default)({},a,e[a]));oe({parentDir:t,fileName:n,recordId:r},{success_callback:function(t){var n=t.description,r=e[g.L2.ID],u=[r],s={},l={};s[r]=(0,c.default)({},a,n),l[r]=(0,c.default)({},a,n),xe(u,s,l,i,o)}})}}),[xe,oe]),We=(0,r.useCallback)((function(e,t){var n=(0,w.ND)(e);if((0,w.NZ)(e)&&n){var r=g.L2.FILE_DESCRIPTION,a=(0,c.default)({},e[g.L2.ID],(0,c.default)({},r,e[r])),i=(0,c.default)({},e[g.L2.ID],(0,c.default)({},r,e[r]));ie(e,{success_callback:function(t){if(t){var n=e[g.L2.ID],o=[n],u={},s={};u[n]=(0,c.default)({},r,t||null),s[n]=(0,c.default)({},r,t||null),xe(o,u,s,a,i)}}},t)}}),[xe,ie]),Ze=(0,r.useCallback)((function(e){var t=(0,w.ND)(e);(0,w.NZ)(e)&&t&&ce(e,{success_callback:He})}),[He,ce]),Xe=(0,r.useCallback)((function(e,t,n,r,a){var i,o=t.type,u=(0,w.Te)(e,t);if(!u)return"";switch(o){case g.vZ.GEOLOCATION:return(null===(i=e._location_translated)||void 0===i?void 0:i.address)||"";case g.vZ.COLLABORATOR:return(0,w.LY)(n,u);case g.vZ.LAST_MODIFIER:case g.vZ.CREATOR:var s=n.find((function(e){return e.email===u}))||a[u];return(null===s||void 0===s?void 0:s.name)||u;case g.vZ.NUMBER:return(0,w.HL)(u,t.data);case g.vZ.TAGS:return(null===u||void 0===u?void 0:u.map((function(e){var t=null===r||void 0===r?void 0:r.rows.find((function(t){return t._id===e.row_id}));return null===t||void 0===t?void 0:t._tag_name})).filter(Boolean).join(", "))||"";default:return String(u)}}),[]),ze=(0,r.useCallback)((function(e,t){return Array.isArray(e)?e.map((function(e){var n=e.subgroups,r=e.row_ids,a=(0,d.default)(e,Y);if(n&&n.length>0){var i=ze(n,t);return(0,l.default)((0,l.default)({},a),{},{subgroups:i.filter((function(e){return e.subgroups&&e.subgroups.length>0||e.row_ids&&e.row_ids.length>0}))})}if(r&&r.length>0){var o=r.filter((function(e){return t.includes(e)}));return(0,l.default)((0,l.default)({},a),{},{row_ids:o})}return e})).filter((function(e){return e.subgroups&&e.subgroups.length>0||e.row_ids&&e.row_ids.length>0})):e}),[]),Qe=(0,r.useCallback)((function(e,t,n,r,a,i){var o={matchedCells:[],matchedRows:{},currentSelectIndex:0},u=!1;return e.rows.forEach((function(e,c){var l,d=(0,s.default)(t);try{for(d.s();!(l=d.n()).done;){var f=l.value,v=Xe(e,f,r,a,i);if(n.test(v)){u=!0,o.matchedRows[e._id]||(o.matchedRows[e._id]=[]),o.matchedRows[e._id].push(f.key),o.matchedCells.push({rowId:e._id,columnKey:f.key,value:v,rowIndex:c});break}}}catch(g){d.e(g)}finally{d.f()}})),{searchResult:o,hasMatches:u}}),[Xe]),$e=(0,r.useCallback)((function(e,t,n){return n?(0,l.default)((0,l.default)({},e),{},{row_ids:t,rows:t.map((function(t){return e.id_row_map[t]})).filter(Boolean),view:(0,l.default)((0,l.default)({},e.view),{},{rows:t},e.view.groups&&{groups:ze(e.view.groups,t)})}):(0,l.default)((0,l.default)({},e),{},{row_ids:[],rows:[],view:(0,l.default)((0,l.default)({},e.view),{},{rows:[]},e.view.groups&&{groups:[]})})}),[ze]),Je=(0,r.useCallback)((function(e,t){var n;if(!e||!t)return t;var r=(0,I.R)(e);if(!r)return t;var a=t.view,i=a.columns,o=a.hidden_columns,u=i.filter((function(e){return!le.includes(e.key)&&!o.includes(e.key)&&!g.of.includes(e.key)&&g.vz.includes(e.type)}));if(!u.length)return t;var s=ve.current,c=null===(n=window.sfTagsDataStore)||void 0===n?void 0:n.data,d=Qe(t,u,r,s,c,ee),f=d.searchResult,v=d.hasMatches,h=Object.keys(f.matchedRows),p=$e(t,h,v);return Q((function(e){return(0,l.default)((0,l.default)({},e),{},{searchResult:f,lastSearchMetadata:t})})),p}),[le,ee,Qe,$e]),et=(0,r.useCallback)((function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"UNKNOWN";if(null!==(e=de.current)&&void 0!==e&&e.data){var n=de.current.data;if(ge(t))if(z.searchValue){var r=Je(z.searchValue,n);j(r)}else j(n);else j(n),z.isActive&&(he(),window.sfMetadataContext.eventBus.dispatch(g.Tw.RESET_SEARCH_BAR))}}),[z,ge,Je,he]);me.current=et;var tt=(0,r.useCallback)((function(e,t){var n,r,a=null===(n=de.current)||void 0===n?void 0:n.data,i=null===(r=window.sfTagsDataStore)||void 0===r?void 0:r.data;if(a&&a.rows&&a.view&&a.view.columns){if(!e||!a.rows.length)return Q({searchValue:"",searchResult:null,isActive:!1,lastSearchMetadata:null}),j(a),void(t&&t(null));var o=(0,I.R)(e);if(!o)return Q({searchValue:"",searchResult:null,isActive:!1,lastSearchMetadata:null}),j(a),void(t&&t(null));var u=a.view,s=u.columns,c=u.hidden_columns,l=s.filter((function(e){return!le.includes(e.key)&&!c.includes(e.key)&&!g.of.includes(e.key)&&g.vz.includes(e.type)}));if(!l.length)return t&&t(null),void j(a);var d=ve.current,f=Qe(a,l,o,d,i,ee),v=f.searchResult,h=f.hasMatches,p=Object.keys(v.matchedRows),m=$e(a,p,h);Q({searchValue:e,searchResult:v,isActive:!0,lastSearchMetadata:a}),j(m),t&&t(v)}else t&&t(null)}),[le,ee,$e,Qe]);return(0,r.useEffect)((function(){z.isActive&&Q({searchValue:"",searchResult:null,isActive:!1,lastSearchMetadata:null}),N(!0);var e=new V;window.sfMetadataContext=e,window.sfMetadataContext.init((0,l.default)((0,l.default)({},k),{},{repoID:n,viewID:a})),de.current=new v.A({context:window.sfMetadataContext,repoId:n,viewId:a,collaborators:J}),window.sfMetadataStore=de.current,de.current.initStartIndex(),de.current.load(g.bK,ne).then((function(){j(de.current.data),re(!1),N(!1)})).catch((function(e){var t=h.Aq.getErrorMsg(e);f.A.danger(t)}));var t=window.sfMetadataContext.eventBus,r=t.subscribe(g.Tw.SERVER_TABLE_CHANGED,be),i=t.subscribe(g.Tw.LOCAL_TABLE_CHANGED,we),o=t.subscribe(g.Tw.TABLE_ERROR,Ce),u=t.subscribe(g.Tw.UPDATE_TABLE_ROWS,De),s=t.subscribe(g.Tw.RELOAD_DATA,Te),c=t.subscribe(g.Tw.MODIFY_FILTERS,Ie),d=t.subscribe(g.Tw.MODIFY_SORTS,Se),p=t.subscribe(g.Tw.MODIFY_GROUPBYS,Oe),m=t.subscribe(g.Tw.MODIFY_HIDDEN_COLUMNS,_e),y=t.subscribe(g.Tw.MODIFY_COLUMN_ORDER,Ue),w=t.subscribe(g.Tw.MODIFY_SETTINGS,ke),b=t.subscribe(g.Tw.LOCAL_RECORD_CHANGED,Ae),C=t.subscribe(g.Tw.LOCAL_COLUMN_DATA_CHANGED,Re),D=t.subscribe(g.Tw.UPDATE_SELECTED_RECORD_IDS,Ge),T=t.subscribe(g.Tw.MOVE_RECORD,Me),E=t.subscribe(g.Tw.DUPLICATE_RECORD,Pe),I=t.subscribe(g.Tw.DELETE_RECORDS,Ne),S=t.subscribe(g.Tw.UPDATE_RECORD_DETAILS,Ye),O=t.subscribe(g.Tw.UPDATE_FACE_RECOGNITION,qe),_=t.subscribe(g.Tw.GENERATE_DESCRIPTION,Ke),A=t.subscribe(g.Tw.EXTRACT_TEXT,We),R=t.subscribe(g.Tw.SEARCH_ROWS,tt),x=t.subscribe(g.Tw.GENERATE_FILE_TAGS,Ze);return function(){window.sfMetadataContext&&window.sfMetadataContext.destroy(),window.sfMetadataStore.destroy(),r(),i(),o(),u(),s(),c(),d(),p(),m(),y(),w(),b(),C(),D(),T(),E(),I(),S(),O(),_(),A(),R(),x(),fe.current&&clearTimeout(fe.current)}}),[n,a]),(0,r.useEffect)((function(){ve.current&&(ve.current=J)}),[J]),(0,H.jsx)(q.Provider,{value:{isLoading:x,repoID:n,viewID:a,isBeingBuilt:ne,errorMessage:U,metadata:L,store:de.current,searchState:z,updateSearchState:pe,isDirentDetailShow:k.isDirentDetailShow,updateCurrentDirent:k.updateCurrentDirent,showDirentDetail:k.showDirentDetail,deleteFilesCallback:u,renameFileCallback:o,modifySettings:ke,modifyRecords:xe,deleteRecords:Ne,modifyRecord:function(e,t,n,r,a,i){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},u=o.success_callback,s=o.fail_callback,l=[e],d=(0,c.default)({},e,t),f=(0,c.default)({},e,r),v=(0,c.default)({},e,n),g=(0,c.default)({},e,a);xe(l,d,f,v,g,i,{success_callback:u,fail_callback:s})},moveRecord:Me,duplicateRecord:Pe,renameColumn:Le,deleteColumn:je,modifyColumnOrder:Ue,modifyColumnData:Fe,modifyColumnWidth:Be,insertColumn:Ve,updateFileTags:He,updateCurrentPath:k.updateCurrentPath,updateSelectedRecordIds:Ge,updateRecordDetails:Ye,updateFaceRecognition:qe,updateRecordDescription:Ke,onOCR:We,generateFileTags:Ze},children:t})},W=function(){var e=(0,r.useContext)(q);if(!e)throw new Error("'MetadataContext' is null");return e},Z=n(23105),X=n(97011),z=n(9961),Q=n(4668),$=n(75168),J=n(3277),ee=n(12549),te=n(48738),ne=n.n(te),re=n(14292),ae=n(12562),ie=["metadata","modifyRecord","modifyRecords","loadMore","loadAll","searchResult","recordGetterByIndex","recordGetterById","insertColumn","modifyColumnData","updateFileTags"],oe=function(e){var t,n,a=e.metadata,i=e.modifyRecord,o=e.modifyRecords,u=e.loadMore,s=e.loadAll,f=(e.searchResult,e.recordGetterByIndex),v=e.recordGetterById,h=e.insertColumn,p=e.modifyColumnData,m=e.updateFileTags,y=(0,d.default)(e,ie),w=(0,E.nk)().globalHiddenColumns,b=(0,r.useMemo)((function(){return new ae.A(a,{modifyRecord:i,modifyRecords:o,recordGetterByIndex:f,recordGetterById:v,modifyColumnData:p,updateFileTags:m})}),[a,i,o,f,v,p,m]),C=(0,r.useMemo)((function(){var e;return((null===a||void 0===a||null===(e=a.view)||void 0===e?void 0:e.groupbys)||[]).length}),[a]),D=(0,r.useMemo)((function(){return C*g.ax}),[C]),T=(0,r.useMemo)((function(){var e=a.view,t=e.columns,n=e.hidden_columns;return t.filter((function(e){return!w.includes(e.key)&&!n.includes(e.key)&&!g.of.includes(e.key)}))}),[a,w]),I=(0,r.useCallback)((function(e){var t=e.type,n=e.copied,r=e.isGroupView;return b.getCopiedContent({type:t,copied:n,isGroupView:r,columns:T})}),[b,T]),S=(0,r.useCallback)((function(e){var t=e.rowId,n=e.updates,r=e.originalUpdates,a=e.oldRowData,o=e.originalOldRowData;i&&i(t,n,a,r,o)}),[i]),O=(0,r.useCallback)((function(e,t,n){var r=n.key,a=n.data;h&&h(e,t,{key:r,data:a})}),[h]),_=(0,r.useCallback)((function(e){var t=e.type,n=e.copied,r=e.multiplePaste,a=e.pasteRange,i=e.isGroupView,o=e.pasteSource,u=e.cutPosition,s=e.viewId;b.paste({type:t,copied:n,multiplePaste:r,pasteRange:a,isGroupView:i,columns:T,pasteSource:o,cutPosition:u,viewId:s})}),[b,T]);return(0,H.jsx)("div",{className:ne()("table-main-container container-fluid p-0",(0,c.default)({},"group-level-".concat(C+1),C>0)),children:(0,H.jsx)(re.A,(0,l.default)({columns:T,metadata:a,recordIds:a.view.rows||[],groups:a.view.groups,groupbys:a.view.groupbys,recordsCount:(null===a||void 0===a||null===(t=a.view)||void 0===t||null===(n=t.rows)||void 0===n?void 0:n.length)||0,table:a,hasMore:a.hasMore,gridUtils:b,scrollToLoadMore:u,loadAll:s,paste:_,groupOffsetLeft:D,modifyRecord:S,deleteRecords:y.deleteRecords,getCopiedRecordsAndColumnsFromRange:I,recordGetterById:v,recordGetterByIndex:f,modifyColumnData:p,insertColumn:O,updateFileTags:m,modifyRecords:o},y))})},ue=function(){var e=(0,r.useState)(!1),t=(0,i.default)(e,2),n=t[0],a=t[1],o=W(),u=o.isLoading,s=o.metadata,c=o.store,l=o.modifyRecords,d=o.deleteRecords,v=o.modifyRecord,p=o.renameColumn,m=o.deleteColumn,y=o.modifyColumnData,w=o.modifyColumnOrder,b=o.modifyColumnWidth,C=o.insertColumn,D=o.updateFileTags,T=o.updateSelectedRecordIds,E=o.updateRecordDetails,I=o.updateFaceRecognition,_=o.updateRecordDescription,k=o.onOCR,A=o.generateFileTags,R=(0,r.useRef)(null),x=!1,N=(0,r.useCallback)((function(){setTimeout((function(){return window.sfMetadataContext.eventBus.dispatch(g.Tw.FOCUS_CANVAS)}),0)}),[]),M=(0,r.useCallback)((function(e){if(e.keyCode!==(0,$.toKeyCode)("mod+shift")&&!e.target.className.includes("sf-metadata-editor-main")){var t=document.activeElement;R.current.contains(t)&&((0,ee.LQ)(e)||(0,ee.rd)(e))&&e.preventDefault()}}),[x,c,N]),P=(0,r.useCallback)((function(e){e.target.className.includes("sf-metadata-editor-main")}),[]),L=(0,r.useMemo)((function(){return!(u||!s)&&(0,J.YD)(s.view.groupbys,s.columns).length>0}),[u,s]),j=(0,r.useCallback)((0,O.default)((0,S.A)().mark((function e(){var t;return(0,S.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s.hasMore){e.next=2;break}return e.abrupt("return");case 2:return a(!0),e.prev=3,e.next=6,c.loadMore(g.bK);case 6:a(!1),e.next=15;break;case 9:return e.prev=9,e.t0=e.catch(3),t=h.Aq.getErrorMsg(e.t0),f.A.danger(t),a(!1),e.abrupt("return");case 15:case"end":return e.stop()}}),e,null,[[3,9]])}))),[s,c]),F=(0,r.useCallback)(function(){var e=(0,O.default)((0,S.A)().mark((function e(t){var n,r,i;return(0,S.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s.hasMore){e.next=2;break}return e.abrupt("return");case 2:return a(!0),n=s.row_ids.length,r=n%g.Hc!==0?g.Hc-n%g.Hc:g.Hc,e.prev=5,e.next=8,c.loadMore(r);case 8:a(!1),e.next=17;break;case 11:return e.prev=11,e.t0=e.catch(5),i=h.Aq.getErrorMsg(e.t0),f.A.danger(i),a(!1),e.abrupt("return");case 17:c.data.hasMore&&c.data.row_ids.length<t?F(t):a(!1);case 18:case"end":return e.stop()}}),e,null,[[5,11]])})));return function(t){return e.apply(this,arguments)}}(),[s,c]),B=(0,r.useCallback)((function(e){var t=s.row_ids.length,n=[],r=[],a=[],i={};return e.forEach((function(e){return i[e]=e})),s.row_ids.forEach((function(e,o){if(i[e]){var u=0===o?null:s.row_ids[o-1],c=o===t-1?null:s.row_ids[o+1];n.push(e),r.push(u),a.push(c)}})),{rowIdsInOrder:n,upperRowIds:r,belowRowIds:a}}),[s]),U=(0,r.useCallback)((function(e){return s.id_row_map[e]}),[s]),V=(0,r.useCallback)((function(e){var t=s.view.rows[e];return t&&U(t)}),[s,U]),G=(0,r.useCallback)((function(e){if(!window.sfMetadataBody||!window.sfMetadataBody.getGroupRecordByIndex)return null;var t=window.sfMetadataBody.getGroupRecordByIndex(e).rowId;return t&&U(t)}),[U]),Y=(0,r.useCallback)((function(e){var t=e.isGroupView,n=e.groupRecordIndex,r=e.recordIndex;return t?G(n):V(r)}),[G,V]),q=(0,r.useCallback)((function(){var e;return(null===R||void 0===R||null===(e=R.current)||void 0===e?void 0:e.getBoundingClientRect())||{x:0,right:window.innerWidth}}),[R]);return(0,H.jsx)("div",{className:"sf-metadata-container sf-metadata-container-transform",ref:R,children:(0,H.jsx)(oe,{isGroupView:L,isLoadingMore:n,loadMore:j,metadata:s,modifyRecord:v,modifyRecords:l,deleteRecords:d,recordGetterById:U,recordGetterByIndex:Y,getTableContentRect:q,getAdjacentRowsIds:B,loadAll:F,insertColumn:C,renameColumn:p,deleteColumn:m,modifyColumnData:y,modifyColumnWidth:b,modifyColumnOrder:w,updateFileTags:D,generateFileTags:A,onGridKeyDown:M,onGridKeyUp:P,updateSelectedRecordIds:T,updateRecordDetails:E,updateFaceRecognition:I,updateRecordDescription:_,onOCR:k})})},se=function(){var e=W(),t=e.isLoading,n=e.isBeingBuilt,r=e.errorMessage;return t?n?(0,H.jsxs)("div",{className:"sf-metadata-loading-wrapper",children:[(0,H.jsx)(z.A,{className:"sf-metadata-loading-tip center"}),(0,H.jsx)("span",{className:"sf-metadata-loading-tip",children:(0,D.APU)("Extended properties are being built.")})]}):(0,H.jsx)(Q.A,{}):(0,H.jsx)("div",{className:"sf-metadata-wrapper",id:"sf-metadata-wrapper",children:(0,H.jsxs)("div",{className:"sf-metadata-main",children:[r&&(0,H.jsx)("div",{className:"d-center-middle error",children:r}),!r&&(0,H.jsx)(ue,{})]})})},ce=n(15847),le=function(e){var t=e.viewId,n=(0,r.useState)(null),a=(0,i.default)(n,2),o=a[0],u=a[1],s=(0,r.useState)([]),c=(0,i.default)(s,2),l=c[0],d=c[1],f=(0,r.useCallback)((function(){window.sfMetadataContext.eventBus.dispatch(g.Tw.SELECT_NONE)}),[]),v=(0,r.useCallback)((function(e,t,n){window.sfMetadataContext.eventBus.dispatch(g.Tw.MODIFY_FILTERS,e,t,n)}),[]),h=(0,r.useCallback)((function(e){window.sfMetadataContext.eventBus.dispatch(g.Tw.MODIFY_SORTS,e)}),[]),p=(0,r.useCallback)((function(e){window.sfMetadataContext.eventBus.dispatch(g.Tw.MODIFY_GROUPBYS,e)}),[]),m=(0,r.useCallback)((function(e){window.sfMetadataContext.eventBus.dispatch(g.Tw.MODIFY_HIDDEN_COLUMNS,e)}),[]),y=(0,r.useCallback)((function(e,t){window.sfMetadataContext.eventBus.dispatch(g.Tw.MODIFY_COLUMN_ORDER,e,t)}),[]),w=(0,r.useCallback)((function(e){u(e)}),[]);if((0,r.useEffect)((function(){var e,t=setInterval((function(){var n;window.sfMetadataContext&&window.sfMetadataStore.data&&(t&&clearInterval(t),t=null,u(window.sfMetadataStore.data.view),d((null===(n=window.sfMetadataStore)||void 0===n?void 0:n.collaborators)||[]),e=window.sfMetadataContext.eventBus.subscribe(g.Tw.VIEW_CHANGED,w))}),300);return function(){t&&clearInterval(t),e&&e()}}),[t]),!o)return null;var b=!window.sfMetadataContext||!window.sfMetadataContext.canModifyView(o);return(0,H.jsx)("div",{className:"sf-metadata-tool",onClick:f,children:(0,H.jsx)(ce.A,{readOnly:b,view:o,collaborators:l,modifyFilters:v,modifySorts:h,modifyGroupbys:p,modifyHiddenColumns:m,modifyColumnOrder:y})})},de=window.app.pageOptions,fe=de.repoID,ve=de.wikiID,ge=de.viewID;function he(){var e=(0,r.useState)(!0),t=(0,i.default)(e,2),n=t[0],a=t[1],s=(0,r.useState)(null),c=(0,i.default)(s,2),l=c[0],d=c[1];return(0,r.useEffect)((function(){X.e.getRepoInfo(fe).then((function(e){d(e.data),a(!1)}))}),[]),n?null:(0,H.jsx)(o.Q,{backend:u.t2,children:(0,H.jsx)(E.NH,{repoID:fe,currentPath:"/",repoInfo:l,hideMetadataView:!1,statusCallback:function(){},children:(0,H.jsx)(Z.Pf,{repoID:fe,repoInfo:l,currentPath:"/",selectTagsView:function(){},tagsChangedCallback:function(){},children:(0,H.jsx)(Z.Xj,{repoID:fe,currentPath:"/",repoInfo:l,selectMetadataView:function(){},children:(0,H.jsx)(K,{repoID:fe,repoInfo:l,wikiID:ve,viewID:ge,children:(0,H.jsxs)("div",{className:"wiki-repo-view",children:[(0,H.jsx)("div",{className:"wiki-repo-view-toolbar",children:(0,H.jsx)(le,{viewId:ge})}),(0,H.jsx)("div",{className:"wiki-repo-view-content",children:(0,H.jsx)(se,{})})]})})})})})})}(0,a.createRoot)(document.getElementById("wrapper")).render((0,H.jsx)(he,{}))},72500:function(e,t,n){n.d(t,{t2:function(){return O}});var r={};n.r(r),n.d(r,{FILE:function(){return l},HTML:function(){return v},TEXT:function(){return f},URL:function(){return d}});var a=n(23029),i=n(92901);function o(e){var t=null;return function(){return null==t&&(t=e()),t}}var u=function(){return(0,i.default)((function e(t){(0,a.default)(this,e),this.entered=[],this.isNodeInDocument=t}),[{key:"enter",value:function(e){var t=this,n=this.entered.length;return this.entered=function(e,t){var n=new Set,r=function(e){return n.add(e)};e.forEach(r),t.forEach(r);var a=[];return n.forEach((function(e){return a.push(e)})),a}(this.entered.filter((function(n){return t.isNodeInDocument(n)&&(!n.contains||n.contains(e))})),[e]),0===n&&this.entered.length>0}},{key:"leave",value:function(e){var t,n,r=this.entered.length;return this.entered=(t=this.entered.filter(this.isNodeInDocument),n=e,t.filter((function(e){return e!==n}))),r>0&&0===this.entered.length}},{key:"reset",value:function(){this.entered=[]}}])}(),s=function(){return(0,i.default)((function e(t){(0,a.default)(this,e),this.config=t,this.item={},this.initializeExposedProperties()}),[{key:"initializeExposedProperties",value:function(){var e=this;Object.keys(this.config.exposeProperties).forEach((function(t){Object.defineProperty(e.item,t,{configurable:!0,enumerable:!0,get:function(){return console.warn("Browser doesn't allow reading \"".concat(t,'" until the drop event.')),null}})}))}},{key:"loadDataTransfer",value:function(e){var t=this;if(e){var n={};Object.keys(this.config.exposeProperties).forEach((function(r){var a=t.config.exposeProperties[r];null!=a&&(n[r]={value:a(e,t.config.matchesTypes),configurable:!0,enumerable:!0})})),Object.defineProperties(this.item,n)}}},{key:"canDrag",value:function(){return!0}},{key:"beginDrag",value:function(){return this.item}},{key:"isDragging",value:function(e,t){return t===e.getSourceId()}},{key:"endDrag",value:function(){}}])}(),c=n(64467),l="__NATIVE_FILE__",d="__NATIVE_URL__",f="__NATIVE_TEXT__",v="__NATIVE_HTML__";function g(e,t,n){var r=t.reduce((function(t,n){return t||e.getData(n)}),"");return null!=r?r:n}var h=(0,c.default)((0,c.default)((0,c.default)((0,c.default)({},l,{exposeProperties:{files:function(e){return Array.prototype.slice.call(e.files)},items:function(e){return e.items},dataTransfer:function(e){return e}},matchesTypes:["Files"]}),v,{exposeProperties:{html:function(e,t){return g(e,t,"")},dataTransfer:function(e){return e}},matchesTypes:["Html","text/html"]}),d,{exposeProperties:{urls:function(e,t){return g(e,t,"").split("\n")},dataTransfer:function(e){return e}},matchesTypes:["Url","text/uri-list"]}),f,{exposeProperties:{text:function(e,t){return g(e,t,"")},dataTransfer:function(e){return e}},matchesTypes:["Text","text/plain"]});function p(e){if(!e)return null;var t=Array.prototype.slice.call(e.types||[]);return Object.keys(h).filter((function(e){var n=h[e];return!!(null===n||void 0===n?void 0:n.matchesTypes)&&n.matchesTypes.some((function(e){return t.indexOf(e)>-1}))}))[0]||null}var m=o((function(){return/firefox/i.test(navigator.userAgent)})),y=o((function(){return Boolean(window.safari)})),w=function(){return(0,i.default)((function e(t,n){(0,a.default)(this,e);for(var r=t.length,i=[],o=0;o<r;o++)i.push(o);i.sort((function(e,n){return t[e]<t[n]?-1:1}));for(var u,s,c=[],l=[],d=[],f=0;f<r-1;f++)u=t[f+1]-t[f],s=n[f+1]-n[f],l.push(u),c.push(s),d.push(s/u);for(var v=[d[0]],g=0;g<l.length-1;g++){var h=d[g],p=d[g+1];if(h*p<=0)v.push(0);else{u=l[g];var m=l[g+1],y=u+m;v.push(3*y/((y+m)/h+(y+u)/p))}}v.push(d[d.length-1]);for(var w,b=[],C=[],D=0;D<v.length-1;D++){w=d[D];var T=v[D],E=1/l[D],I=T+v[D+1]-w-w;b.push((w-T-I)*E),C.push(I*E*E)}this.xs=t,this.ys=n,this.c1s=v,this.c2s=b,this.c3s=C}),[{key:"interpolate",value:function(e){var t=this.xs,n=this.ys,r=this.c1s,a=this.c2s,i=this.c3s,o=t.length-1;if(e===t[o])return n[o];for(var u,s=0,c=i.length-1;s<=c;){var l=t[u=Math.floor(.5*(s+c))];if(l<e)s=u+1;else{if(!(l>e))return n[u];c=u-1}}var d=e-t[o=Math.max(0,c)],f=d*d;return n[o]+r[o]*d+a[o]*f+i[o]*d*f}}])}();function b(e){var t=1===e.nodeType?e:e.parentElement;if(!t)return null;var n=t.getBoundingClientRect(),r=n.top;return{x:n.left,y:r}}function C(e){return{x:e.clientX,y:e.clientY}}function D(e,t,n,r,a){var i=function(e){var t;return"IMG"===e.nodeName&&(m()||!(null===(t=document.documentElement)||void 0===t?void 0:t.contains(e)))}(t),o=b(i?e:t),u={x:n.x-o.x,y:n.y-o.y},s=e.offsetWidth,c=e.offsetHeight,l=r.anchorX,d=r.anchorY,f=function(e,t,n,r){var a=e?t.width:n,i=e?t.height:r;return y()&&e&&(i/=window.devicePixelRatio,a/=window.devicePixelRatio),{dragPreviewWidth:a,dragPreviewHeight:i}}(i,t,s,c),v=f.dragPreviewWidth,g=f.dragPreviewHeight,h=a.offsetX,p=a.offsetY,C=0===p||p;return{x:0===h||h?h:new w([0,.5,1],[u.x,u.x/s*v,u.x+v-s]).interpolate(l),y:C?p:function(){var e=new w([0,.5,1],[u.y,u.y/c*g,u.y+g-c]).interpolate(d);return y()&&i&&(e+=(window.devicePixelRatio-1)*g),e}()}}var T=function(){return(0,i.default)((function e(t,n){(0,a.default)(this,e),this.ownerDocument=null,this.globalContext=t,this.optionsArgs=n}),[{key:"window",get:function(){return this.globalContext?this.globalContext:"undefined"!==typeof window?window:void 0}},{key:"document",get:function(){var e;return(null===(e=this.globalContext)||void 0===e?void 0:e.document)?this.globalContext.document:this.window?this.window.document:void 0}},{key:"rootElement",get:function(){var e;return(null===(e=this.optionsArgs)||void 0===e?void 0:e.rootElement)||this.window}}])}();function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){E(e,t,n[t])}))}return e}var S=function(){return(0,i.default)((function e(t,n,r){var i=this;(0,a.default)(this,e),this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.sourceNodes=new Map,this.sourceNodeOptions=new Map,this.dragStartSourceIds=null,this.dropTargetIds=[],this.dragEnterTargetIds=[],this.currentNativeSource=null,this.currentNativeHandle=null,this.currentDragSourceNode=null,this.altKeyPressed=!1,this.mouseMoveTimeoutTimer=null,this.asyncEndDragFrameId=null,this.dragOverTargetIds=null,this.lastClientOffset=null,this.hoverRafId=null,this.getSourceClientOffset=function(e){var t=i.sourceNodes.get(e);return t&&b(t)||null},this.endDragNativeItem=function(){i.isDraggingNativeItem()&&(i.actions.endDrag(),i.currentNativeHandle&&i.registry.removeSource(i.currentNativeHandle),i.currentNativeHandle=null,i.currentNativeSource=null)},this.isNodeInDocument=function(e){return Boolean(e&&i.document&&i.document.body&&i.document.body.contains(e))},this.endDragIfSourceWasRemovedFromDOM=function(){var e=i.currentDragSourceNode;null==e||i.isNodeInDocument(e)||(i.clearCurrentDragSourceNode()&&i.monitor.isDragging()&&i.actions.endDrag(),i.cancelHover())},this.scheduleHover=function(e){null===i.hoverRafId&&"undefined"!==typeof requestAnimationFrame&&(i.hoverRafId=requestAnimationFrame((function(){i.monitor.isDragging()&&i.actions.hover(e||[],{clientOffset:i.lastClientOffset}),i.hoverRafId=null})))},this.cancelHover=function(){null!==i.hoverRafId&&"undefined"!==typeof cancelAnimationFrame&&(cancelAnimationFrame(i.hoverRafId),i.hoverRafId=null)},this.handleTopDragStartCapture=function(){i.clearCurrentDragSourceNode(),i.dragStartSourceIds=[]},this.handleTopDragStart=function(e){if(!e.defaultPrevented){var t=i.dragStartSourceIds;i.dragStartSourceIds=null;var n=C(e);i.monitor.isDragging()&&(i.actions.endDrag(),i.cancelHover()),i.actions.beginDrag(t||[],{publishSource:!1,getSourceClientOffset:i.getSourceClientOffset,clientOffset:n});var r=e.dataTransfer,a=p(r);if(i.monitor.isDragging()){if(r&&"function"===typeof r.setDragImage){var o=i.monitor.getSourceId(),u=i.sourceNodes.get(o),s=i.sourcePreviewNodes.get(o)||u;if(s){var c=i.getCurrentSourcePreviewNodeOptions(),l=D(u,s,n,{anchorX:c.anchorX,anchorY:c.anchorY},{offsetX:c.offsetX,offsetY:c.offsetY});r.setDragImage(s,l.x,l.y)}}try{null===r||void 0===r||r.setData("application/json",{})}catch(d){}i.setCurrentDragSourceNode(e.target),i.getCurrentSourcePreviewNodeOptions().captureDraggingState?i.actions.publishDragSource():setTimeout((function(){return i.actions.publishDragSource()}),0)}else if(a)i.beginDragNativeItem(a);else{if(r&&!r.types&&(e.target&&!e.target.hasAttribute||!e.target.hasAttribute("draggable")))return;e.preventDefault()}}},this.handleTopDragEndCapture=function(){i.clearCurrentDragSourceNode()&&i.monitor.isDragging()&&i.actions.endDrag(),i.cancelHover()},this.handleTopDragEnterCapture=function(e){var t;(i.dragEnterTargetIds=[],i.isDraggingNativeItem())&&(null===(t=i.currentNativeSource)||void 0===t||t.loadDataTransfer(e.dataTransfer));if(i.enterLeaveCounter.enter(e.target)&&!i.monitor.isDragging()){var n=e.dataTransfer,r=p(n);r&&i.beginDragNativeItem(r,n)}},this.handleTopDragEnter=function(e){var t=i.dragEnterTargetIds;(i.dragEnterTargetIds=[],i.monitor.isDragging())&&(i.altKeyPressed=e.altKey,t.length>0&&i.actions.hover(t,{clientOffset:C(e)}),t.some((function(e){return i.monitor.canDropOnTarget(e)}))&&(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect=i.getCurrentDropEffect())))},this.handleTopDragOverCapture=function(e){var t;(i.dragOverTargetIds=[],i.isDraggingNativeItem())&&(null===(t=i.currentNativeSource)||void 0===t||t.loadDataTransfer(e.dataTransfer))},this.handleTopDragOver=function(e){var t=i.dragOverTargetIds;if(i.dragOverTargetIds=[],!i.monitor.isDragging())return e.preventDefault(),void(e.dataTransfer&&(e.dataTransfer.dropEffect="none"));i.altKeyPressed=e.altKey,i.lastClientOffset=C(e),i.scheduleHover(t),(t||[]).some((function(e){return i.monitor.canDropOnTarget(e)}))?(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect=i.getCurrentDropEffect())):i.isDraggingNativeItem()?e.preventDefault():(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="none"))},this.handleTopDragLeaveCapture=function(e){i.isDraggingNativeItem()&&e.preventDefault(),i.enterLeaveCounter.leave(e.target)&&(i.isDraggingNativeItem()&&setTimeout((function(){return i.endDragNativeItem()}),0),i.cancelHover())},this.handleTopDropCapture=function(e){var t;(i.dropTargetIds=[],i.isDraggingNativeItem())?(e.preventDefault(),null===(t=i.currentNativeSource)||void 0===t||t.loadDataTransfer(e.dataTransfer)):p(e.dataTransfer)&&e.preventDefault();i.enterLeaveCounter.reset()},this.handleTopDrop=function(e){var t=i.dropTargetIds;i.dropTargetIds=[],i.actions.hover(t,{clientOffset:C(e)}),i.actions.drop({dropEffect:i.getCurrentDropEffect()}),i.isDraggingNativeItem()?i.endDragNativeItem():i.monitor.isDragging()&&i.actions.endDrag(),i.cancelHover()},this.handleSelectStart=function(e){var t=e.target;"function"===typeof t.dragDrop&&("INPUT"===t.tagName||"SELECT"===t.tagName||"TEXTAREA"===t.tagName||t.isContentEditable||(e.preventDefault(),t.dragDrop()))},this.options=new T(n,r),this.actions=t.getActions(),this.monitor=t.getMonitor(),this.registry=t.getRegistry(),this.enterLeaveCounter=new u(this.isNodeInDocument)}),[{key:"profile",value:function(){var e,t;return{sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,sourceNodeOptions:this.sourceNodeOptions.size,sourceNodes:this.sourceNodes.size,dragStartSourceIds:(null===(e=this.dragStartSourceIds)||void 0===e?void 0:e.length)||0,dropTargetIds:this.dropTargetIds.length,dragEnterTargetIds:this.dragEnterTargetIds.length,dragOverTargetIds:(null===(t=this.dragOverTargetIds)||void 0===t?void 0:t.length)||0}}},{key:"window",get:function(){return this.options.window}},{key:"document",get:function(){return this.options.document}},{key:"rootElement",get:function(){return this.options.rootElement}},{key:"setup",value:function(){var e=this.rootElement;if(void 0!==e){if(e.__isReactDndBackendSetUp)throw new Error("Cannot have two HTML5 backends at the same time.");e.__isReactDndBackendSetUp=!0,this.addEventListeners(e)}}},{key:"teardown",value:function(){var e,t=this.rootElement;void 0!==t&&(t.__isReactDndBackendSetUp=!1,this.removeEventListeners(this.rootElement),this.clearCurrentDragSourceNode(),this.asyncEndDragFrameId&&(null===(e=this.window)||void 0===e||e.cancelAnimationFrame(this.asyncEndDragFrameId)))}},{key:"connectDragPreview",value:function(e,t,n){var r=this;return this.sourcePreviewNodeOptions.set(e,n),this.sourcePreviewNodes.set(e,t),function(){r.sourcePreviewNodes.delete(e),r.sourcePreviewNodeOptions.delete(e)}}},{key:"connectDragSource",value:function(e,t,n){var r=this;this.sourceNodes.set(e,t),this.sourceNodeOptions.set(e,n);var a=function(t){return r.handleDragStart(t,e)},i=function(e){return r.handleSelectStart(e)};return t.setAttribute("draggable","true"),t.addEventListener("dragstart",a),t.addEventListener("selectstart",i),function(){r.sourceNodes.delete(e),r.sourceNodeOptions.delete(e),t.removeEventListener("dragstart",a),t.removeEventListener("selectstart",i),t.setAttribute("draggable","false")}}},{key:"connectDropTarget",value:function(e,t){var n=this,r=function(t){return n.handleDragEnter(t,e)},a=function(t){return n.handleDragOver(t,e)},i=function(t){return n.handleDrop(t,e)};return t.addEventListener("dragenter",r),t.addEventListener("dragover",a),t.addEventListener("drop",i),function(){t.removeEventListener("dragenter",r),t.removeEventListener("dragover",a),t.removeEventListener("drop",i)}}},{key:"addEventListeners",value:function(e){e.addEventListener&&(e.addEventListener("dragstart",this.handleTopDragStart),e.addEventListener("dragstart",this.handleTopDragStartCapture,!0),e.addEventListener("dragend",this.handleTopDragEndCapture,!0),e.addEventListener("dragenter",this.handleTopDragEnter),e.addEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.addEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.addEventListener("dragover",this.handleTopDragOver),e.addEventListener("dragover",this.handleTopDragOverCapture,!0),e.addEventListener("drop",this.handleTopDrop),e.addEventListener("drop",this.handleTopDropCapture,!0))}},{key:"removeEventListeners",value:function(e){e.removeEventListener&&(e.removeEventListener("dragstart",this.handleTopDragStart),e.removeEventListener("dragstart",this.handleTopDragStartCapture,!0),e.removeEventListener("dragend",this.handleTopDragEndCapture,!0),e.removeEventListener("dragenter",this.handleTopDragEnter),e.removeEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.removeEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.removeEventListener("dragover",this.handleTopDragOver),e.removeEventListener("dragover",this.handleTopDragOverCapture,!0),e.removeEventListener("drop",this.handleTopDrop),e.removeEventListener("drop",this.handleTopDropCapture,!0))}},{key:"getCurrentSourceNodeOptions",value:function(){var e=this.monitor.getSourceId(),t=this.sourceNodeOptions.get(e);return I({dropEffect:this.altKeyPressed?"copy":"move"},t||{})}},{key:"getCurrentDropEffect",value:function(){return this.isDraggingNativeItem()?"copy":this.getCurrentSourceNodeOptions().dropEffect}},{key:"getCurrentSourcePreviewNodeOptions",value:function(){var e=this.monitor.getSourceId();return I({anchorX:.5,anchorY:.5,captureDraggingState:!1},this.sourcePreviewNodeOptions.get(e)||{})}},{key:"isDraggingNativeItem",value:function(){var e=this.monitor.getItemType();return Object.keys(r).some((function(t){return r[t]===e}))}},{key:"beginDragNativeItem",value:function(e,t){this.clearCurrentDragSourceNode(),this.currentNativeSource=function(e,t){var n=h[e];if(!n)throw new Error("native type ".concat(e," has no configuration"));var r=new s(n);return r.loadDataTransfer(t),r}(e,t),this.currentNativeHandle=this.registry.addSource(e,this.currentNativeSource),this.actions.beginDrag([this.currentNativeHandle])}},{key:"setCurrentDragSourceNode",value:function(e){var t=this;this.clearCurrentDragSourceNode(),this.currentDragSourceNode=e;this.mouseMoveTimeoutTimer=setTimeout((function(){var e;return null===(e=t.rootElement)||void 0===e?void 0:e.addEventListener("mousemove",t.endDragIfSourceWasRemovedFromDOM,!0)}),1e3)}},{key:"clearCurrentDragSourceNode",value:function(){if(this.currentDragSourceNode){var e;if(this.currentDragSourceNode=null,this.rootElement)null===(e=this.window)||void 0===e||e.clearTimeout(this.mouseMoveTimeoutTimer||void 0),this.rootElement.removeEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0);return this.mouseMoveTimeoutTimer=null,!0}return!1}},{key:"handleDragStart",value:function(e,t){e.defaultPrevented||(this.dragStartSourceIds||(this.dragStartSourceIds=[]),this.dragStartSourceIds.unshift(t))}},{key:"handleDragEnter",value:function(e,t){this.dragEnterTargetIds.unshift(t)}},{key:"handleDragOver",value:function(e,t){null===this.dragOverTargetIds&&(this.dragOverTargetIds=[]),this.dragOverTargetIds.unshift(t)}},{key:"handleDrop",value:function(e,t){this.dropTargetIds.unshift(t)}}])}(),O=function(e,t,n){return new S(e,t,n)}},17065:function(e,t,n){n.d(t,{Q:function(){return De}});var r=n(5544),a=n(44414);function i(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var o="function"===typeof Symbol&&Symbol.observable||"@@observable",u=function(){return Math.random().toString(36).substring(7).split("").join(".")},s={INIT:"@@redux/INIT"+u(),REPLACE:"@@redux/REPLACE"+u(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+u()}};function c(e){if("object"!==typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function l(e,t,n){var r;if("function"===typeof t&&"function"===typeof n||"function"===typeof n&&"function"===typeof arguments[3])throw new Error(i(0));if("function"===typeof t&&"undefined"===typeof n&&(n=t,t=void 0),"undefined"!==typeof n){if("function"!==typeof n)throw new Error(i(1));return n(l)(e,t)}if("function"!==typeof e)throw new Error(i(2));var a=e,u=t,d=[],f=d,v=!1;function g(){f===d&&(f=d.slice())}function h(){if(v)throw new Error(i(3));return u}function p(e){if("function"!==typeof e)throw new Error(i(4));if(v)throw new Error(i(5));var t=!0;return g(),f.push(e),function(){if(t){if(v)throw new Error(i(6));t=!1,g();var n=f.indexOf(e);f.splice(n,1),d=null}}}function m(e){if(!c(e))throw new Error(i(7));if("undefined"===typeof e.type)throw new Error(i(8));if(v)throw new Error(i(9));try{v=!0,u=a(u,e)}finally{v=!1}for(var t=d=f,n=0;n<t.length;n++){(0,t[n])()}return e}return m({type:s.INIT}),(r={dispatch:m,subscribe:p,getState:h,replaceReducer:function(e){if("function"!==typeof e)throw new Error(i(10));a=e,m({type:s.REPLACE})}})[o]=function(){var e,t=p;return(e={subscribe:function(e){if("object"!==typeof e||null===e)throw new Error(i(11));function n(){e.next&&e.next(h())}return n(),{unsubscribe:t(n)}}})[o]=function(){return this},e},r}var d=n(23029),f=n(92901),v=n(53268);function g(e){return"object"===typeof e}var h="dnd-core/INIT_COORDS",p="dnd-core/BEGIN_DRAG",m="dnd-core/PUBLISH_DRAG_SOURCE",y="dnd-core/HOVER",w="dnd-core/DROP",b="dnd-core/END_DRAG";function C(e,t){return{type:h,payload:{sourceClientOffset:t||null,clientOffset:e||null}}}var D={type:h,payload:{clientOffset:null,sourceClientOffset:null}};function T(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{publishSource:!0},r=n.publishSource,a=void 0===r||r,i=n.clientOffset,o=n.getSourceClientOffset,u=e.getMonitor(),s=e.getRegistry();e.dispatch(C(i)),function(e,t,n){(0,v.V)(!t.isDragging(),"Cannot call beginDrag while dragging."),e.forEach((function(e){(0,v.V)(n.getSource(e),"Expected sourceIds to be registered.")}))}(t,u,s);var c=function(e,t){for(var n=null,r=e.length-1;r>=0;r--)if(t.canDragSource(e[r])){n=e[r];break}return n}(t,u);if(null!=c){var l=null;if(i){if(!o)throw new Error("getSourceClientOffset must be defined");!function(e){(0,v.V)("function"===typeof e,"When clientOffset is provided, getSourceClientOffset must be a function.")}(o),l=o(c)}e.dispatch(C(i,l));var d=s.getSource(c).beginDrag(u,c);if(null!=d){!function(e){(0,v.V)(g(e),"Item must be an object.")}(d),s.pinSource(c);var f=s.getSourceType(c);return{type:p,payload:{itemType:f,item:d,sourceId:c,clientOffset:i||null,sourceClientOffset:l||null,isSourcePublic:!!a}}}}else e.dispatch(D)}}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){E(e,t,n[t])}))}return e}function S(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.getMonitor(),r=e.getRegistry();!function(e){(0,v.V)(e.isDragging(),"Cannot call drop while not dragging."),(0,v.V)(!e.didDrop(),"Cannot call drop twice during one drag operation.")}(n);var a=function(e){var t=e.getTargetIds().filter(e.canDropOnTarget,e);return t.reverse(),t}(n);a.forEach((function(a,i){var o=function(e,t,n,r){var a=n.getTarget(e),i=a?a.drop(r,e):void 0;(function(e){(0,v.V)("undefined"===typeof e||g(e),"Drop result must either be an object or undefined.")})(i),"undefined"===typeof i&&(i=0===t?{}:r.getDropResult());return i}(a,i,r,n),u={type:w,payload:{dropResult:I({},t,o)}};e.dispatch(u)}))}}function O(e){return function(){var t=e.getMonitor(),n=e.getRegistry();!function(e){(0,v.V)(e.isDragging(),"Cannot call endDrag while not dragging.")}(t);var r=t.getSourceId();null!=r&&(n.getSource(r,!0).endDrag(t,r),n.unpinSource());return{type:b}}}function _(e,t){return null===t?null===e:Array.isArray(e)?e.some((function(e){return e===t})):e===t}function k(e){return function(t){var n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).clientOffset;!function(e){(0,v.V)(Array.isArray(e),"Expected targetIds to be an array.")}(t);var r=t.slice(0),a=e.getMonitor(),i=e.getRegistry();return function(e,t,n){for(var r=e.length-1;r>=0;r--){var a=e[r];_(t.getTargetType(a),n)||e.splice(r,1)}}(r,i,a.getItemType()),function(e,t,n){(0,v.V)(t.isDragging(),"Cannot call hover while not dragging."),(0,v.V)(!t.didDrop(),"Cannot call hover after drop.");for(var r=0;r<e.length;r++){var a=e[r];(0,v.V)(e.lastIndexOf(a)===r,"Expected targetIds to be unique in the passed array.");var i=n.getTarget(a);(0,v.V)(i,"Expected targetIds to be registered.")}}(r,a,i),function(e,t,n){e.forEach((function(e){n.getTarget(e).hover(t,e)}))}(r,a,i),{type:y,payload:{targetIds:r,clientOffset:n||null}}}}function A(e){return function(){if(e.getMonitor().isDragging())return{type:m}}}var R=function(){return(0,f.default)((function e(t,n){var r=this;(0,d.default)(this,e),this.isSetUp=!1,this.handleRefCountChange=function(){var e=r.store.getState().refCount>0;r.backend&&(e&&!r.isSetUp?(r.backend.setup(),r.isSetUp=!0):!e&&r.isSetUp&&(r.backend.teardown(),r.isSetUp=!1))},this.store=t,this.monitor=n,t.subscribe(this.handleRefCountChange)}),[{key:"receiveBackend",value:function(e){this.backend=e}},{key:"getMonitor",value:function(){return this.monitor}},{key:"getBackend",value:function(){return this.backend}},{key:"getRegistry",value:function(){return this.monitor.registry}},{key:"getActions",value:function(){var e=this,t=this.store.dispatch;var n=function(e){return{beginDrag:T(e),publishDragSource:A(e),hover:k(e),drop:S(e),endDrag:O(e)}}(this);return Object.keys(n).reduce((function(r,a){var i,o=n[a];return r[a]=(i=o,function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var o=i.apply(e,r);"undefined"!==typeof o&&t(o)}),r}),{})}},{key:"dispatch",value:function(e){this.store.dispatch(e)}}])}();function x(e,t){return{x:e.x-t.x,y:e.y-t.y}}var N=[],M=[];N.__IS_NONE__=!0,M.__IS_ALL__=!0;var P=function(){return(0,f.default)((function e(t,n){(0,d.default)(this,e),this.store=t,this.registry=n}),[{key:"subscribeToStateChange",value:function(e){var t=this,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).handlerIds;(0,v.V)("function"===typeof e,"listener must be a function."),(0,v.V)("undefined"===typeof n||Array.isArray(n),"handlerIds, when specified, must be an array of strings.");var r=this.store.getState().stateId;return this.store.subscribe((function(){var a=t.store.getState(),i=a.stateId;try{var o=i===r||i===r+1&&!function(e,t){return e!==N&&(e===M||"undefined"===typeof t||(n=e,t.filter((function(e){return n.indexOf(e)>-1}))).length>0);var n}(a.dirtyHandlerIds,n);o||e()}finally{r=i}}))}},{key:"subscribeToOffsetChange",value:function(e){var t=this;(0,v.V)("function"===typeof e,"listener must be a function.");var n=this.store.getState().dragOffset;return this.store.subscribe((function(){var r=t.store.getState().dragOffset;r!==n&&(n=r,e())}))}},{key:"canDragSource",value:function(e){if(!e)return!1;var t=this.registry.getSource(e);return(0,v.V)(t,"Expected to find a valid source. sourceId=".concat(e)),!this.isDragging()&&t.canDrag(this,e)}},{key:"canDropOnTarget",value:function(e){if(!e)return!1;var t=this.registry.getTarget(e);return(0,v.V)(t,"Expected to find a valid target. targetId=".concat(e)),!(!this.isDragging()||this.didDrop())&&(_(this.registry.getTargetType(e),this.getItemType())&&t.canDrop(this,e))}},{key:"isDragging",value:function(){return Boolean(this.getItemType())}},{key:"isDraggingSource",value:function(e){if(!e)return!1;var t=this.registry.getSource(e,!0);return(0,v.V)(t,"Expected to find a valid source. sourceId=".concat(e)),!(!this.isDragging()||!this.isSourcePublic())&&(this.registry.getSourceType(e)===this.getItemType()&&t.isDragging(this,e))}},{key:"isOverTarget",value:function(e){if(!e)return!1;var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shallow:!1}).shallow;if(!this.isDragging())return!1;var n=this.registry.getTargetType(e),r=this.getItemType();if(r&&!_(n,r))return!1;var a=this.getTargetIds();if(!a.length)return!1;var i=a.indexOf(e);return t?i===a.length-1:i>-1}},{key:"getItemType",value:function(){return this.store.getState().dragOperation.itemType}},{key:"getItem",value:function(){return this.store.getState().dragOperation.item}},{key:"getSourceId",value:function(){return this.store.getState().dragOperation.sourceId}},{key:"getTargetIds",value:function(){return this.store.getState().dragOperation.targetIds}},{key:"getDropResult",value:function(){return this.store.getState().dragOperation.dropResult}},{key:"didDrop",value:function(){return this.store.getState().dragOperation.didDrop}},{key:"isSourcePublic",value:function(){return Boolean(this.store.getState().dragOperation.isSourcePublic)}},{key:"getInitialClientOffset",value:function(){return this.store.getState().dragOffset.initialClientOffset}},{key:"getInitialSourceClientOffset",value:function(){return this.store.getState().dragOffset.initialSourceClientOffset}},{key:"getClientOffset",value:function(){return this.store.getState().dragOffset.clientOffset}},{key:"getSourceClientOffset",value:function(){return function(e){var t,n,r=e.clientOffset,a=e.initialClientOffset,i=e.initialSourceClientOffset;return r&&a&&i?x((n=i,{x:(t=r).x+n.x,y:t.y+n.y}),a):null}(this.store.getState().dragOffset)}},{key:"getDifferenceFromInitialOffset",value:function(){return function(e){var t=e.clientOffset,n=e.initialClientOffset;return t&&n?x(t,n):null}(this.store.getState().dragOffset)}}])}(),L="undefined"!==typeof global?global:self,j=L.MutationObserver||L.WebKitMutationObserver;function F(e){return function(){var t=setTimeout(r,0),n=setInterval(r,50);function r(){clearTimeout(t),clearInterval(n),e()}}}var B="function"===typeof j?function(e){var t=1,n=new j(e),r=document.createTextNode("");return n.observe(r,{characterData:!0}),function(){t=-t,r.data=t}}:F,U=function(){return(0,f.default)((function e(){var t=this;(0,d.default)(this,e),this.queue=[],this.pendingErrors=[],this.flushing=!1,this.index=0,this.capacity=1024,this.flush=function(){for(var e=t.queue;t.index<e.length;){var n=t.index;if(t.index++,e[n].call(),t.index>t.capacity){for(var r=0,a=e.length-t.index;r<a;r++)e[r]=e[r+t.index];e.length-=t.index,t.index=0}}e.length=0,t.index=0,t.flushing=!1},this.registerPendingError=function(e){t.pendingErrors.push(e),t.requestErrorThrow()},this.requestFlush=B(this.flush),this.requestErrorThrow=F((function(){if(t.pendingErrors.length)throw t.pendingErrors.shift()}))}),[{key:"enqueueTask",value:function(e){var t=this.queue,n=this.requestFlush;t.length||(n(),this.flushing=!0),t[t.length]=e}}])}(),V=function(){return(0,f.default)((function e(t,n){(0,d.default)(this,e),this.onError=t,this.release=n,this.task=null}),[{key:"call",value:function(){try{this.task&&this.task()}catch(e){this.onError(e)}finally{this.task=null,this.release(this)}}}])}(),H=function(){return(0,f.default)((function e(t){(0,d.default)(this,e),this.onError=t,this.freeTasks=[]}),[{key:"create",value:function(e){var t=this.freeTasks,n=t.length?t.pop():new V(this.onError,(function(e){return t[t.length]=e}));return n.task=e,n}}])}(),G=new U,Y=new H(G.registerPendingError);var q,K="dnd-core/ADD_SOURCE",W="dnd-core/ADD_TARGET",Z="dnd-core/REMOVE_SOURCE",X="dnd-core/REMOVE_TARGET";function z(e,t){t&&Array.isArray(e)?e.forEach((function(e){return z(e,!1)})):(0,v.V)("string"===typeof e||"symbol"===typeof e,t?"Type can only be a string, a symbol, or an array of either.":"Type can only be a string or a symbol.")}!function(e){e.SOURCE="SOURCE",e.TARGET="TARGET"}(q||(q={}));var Q=0;function $(e){var t=(Q++).toString();switch(e){case q.SOURCE:return"S".concat(t);case q.TARGET:return"T".concat(t);default:throw new Error("Unknown Handler Role: ".concat(e))}}function J(e){switch(e[0]){case"S":return q.SOURCE;case"T":return q.TARGET;default:throw new Error("Cannot parse handler ID: ".concat(e))}}function ee(e,t){var n=e.entries(),a=!1;do{var i=n.next(),o=i.done;if((0,r.default)(i.value,2)[1]===t)return!0;a=!!o}while(!a);return!1}var te=function(){return(0,f.default)((function e(t){(0,d.default)(this,e),this.types=new Map,this.dragSources=new Map,this.dropTargets=new Map,this.pinnedSourceId=null,this.pinnedSource=null,this.store=t}),[{key:"addSource",value:function(e,t){z(e),function(e){(0,v.V)("function"===typeof e.canDrag,"Expected canDrag to be a function."),(0,v.V)("function"===typeof e.beginDrag,"Expected beginDrag to be a function."),(0,v.V)("function"===typeof e.endDrag,"Expected endDrag to be a function.")}(t);var n=this.addHandler(q.SOURCE,e,t);return this.store.dispatch(function(e){return{type:K,payload:{sourceId:e}}}(n)),n}},{key:"addTarget",value:function(e,t){z(e,!0),function(e){(0,v.V)("function"===typeof e.canDrop,"Expected canDrop to be a function."),(0,v.V)("function"===typeof e.hover,"Expected hover to be a function."),(0,v.V)("function"===typeof e.drop,"Expected beginDrag to be a function.")}(t);var n=this.addHandler(q.TARGET,e,t);return this.store.dispatch(function(e){return{type:W,payload:{targetId:e}}}(n)),n}},{key:"containsHandler",value:function(e){return ee(this.dragSources,e)||ee(this.dropTargets,e)}},{key:"getSource",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,v.V)(this.isSourceId(e),"Expected a valid source ID."),t&&e===this.pinnedSourceId?this.pinnedSource:this.dragSources.get(e)}},{key:"getTarget",value:function(e){return(0,v.V)(this.isTargetId(e),"Expected a valid target ID."),this.dropTargets.get(e)}},{key:"getSourceType",value:function(e){return(0,v.V)(this.isSourceId(e),"Expected a valid source ID."),this.types.get(e)}},{key:"getTargetType",value:function(e){return(0,v.V)(this.isTargetId(e),"Expected a valid target ID."),this.types.get(e)}},{key:"isSourceId",value:function(e){return J(e)===q.SOURCE}},{key:"isTargetId",value:function(e){return J(e)===q.TARGET}},{key:"removeSource",value:function(e){var t,n=this;(0,v.V)(this.getSource(e),"Expected an existing source."),this.store.dispatch(function(e){return{type:Z,payload:{sourceId:e}}}(e)),t=function(){n.dragSources.delete(e),n.types.delete(e)},G.enqueueTask(Y.create(t))}},{key:"removeTarget",value:function(e){(0,v.V)(this.getTarget(e),"Expected an existing target."),this.store.dispatch(function(e){return{type:X,payload:{targetId:e}}}(e)),this.dropTargets.delete(e),this.types.delete(e)}},{key:"pinSource",value:function(e){var t=this.getSource(e);(0,v.V)(t,"Expected an existing source."),this.pinnedSourceId=e,this.pinnedSource=t}},{key:"unpinSource",value:function(){(0,v.V)(this.pinnedSource,"No source is pinned at the time."),this.pinnedSourceId=null,this.pinnedSource=null}},{key:"addHandler",value:function(e,t,n){var r=$(e);return this.types.set(r,t),e===q.SOURCE?this.dragSources.set(r,n):e===q.TARGET&&this.dropTargets.set(r,n),r}}])}(),ne=function(e,t){return e===t};function re(){var e=arguments.length>1?arguments[1]:void 0;switch(e.type){case y:break;case K:case W:case X:case Z:return N;default:return M}var t=e.payload,n=t.targetIds,r=void 0===n?[]:n,a=t.prevTargetIds,i=void 0===a?[]:a,o=function(e,t){var n=new Map,r=function(e){n.set(e,n.has(e)?n.get(e)+1:1)};e.forEach(r),t.forEach(r);var a=[];return n.forEach((function(e,t){1===e&&a.push(t)})),a}(r,i),u=o.length>0||!function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ne;if(e.length!==t.length)return!1;for(var r=0;r<e.length;++r)if(!n(e[r],t[r]))return!1;return!0}(r,i);if(!u)return N;var s=i[i.length-1],c=r[r.length-1];return s!==c&&(s&&o.push(s),c&&o.push(c)),o}function ae(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ie={initialSourceClientOffset:null,initialClientOffset:null,clientOffset:null};function oe(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie,r=arguments.length>1?arguments[1]:void 0,a=r.payload;switch(r.type){case h:case p:return{initialSourceClientOffset:a.sourceClientOffset,initialClientOffset:a.clientOffset,clientOffset:a.clientOffset};case y:return e=n.clientOffset,t=a.clientOffset,!e&&!t||e&&t&&e.x===t.x&&e.y===t.y?n:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){ae(e,t,n[t])}))}return e}({},n,{clientOffset:a.clientOffset});case b:case w:return ie;default:return n}}function ue(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){ue(e,t,n[t])}))}return e}var ce={itemType:null,item:null,sourceId:null,targetIds:[],dropResult:null,didDrop:!1,isSourcePublic:null};function le(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ce,r=arguments.length>1?arguments[1]:void 0,a=r.payload;switch(r.type){case p:return se({},n,{itemType:a.itemType,item:a.item,sourceId:a.sourceId,isSourcePublic:a.isSourcePublic,dropResult:null,didDrop:!1});case m:return se({},n,{isSourcePublic:!0});case y:return se({},n,{targetIds:a.targetIds});case X:return-1===n.targetIds.indexOf(a.targetId)?n:se({},n,{targetIds:(e=n.targetIds,t=a.targetId,e.filter((function(e){return e!==t})))});case w:return se({},n,{dropResult:a.dropResult,didDrop:!0,targetIds:[]});case b:return se({},n,{itemType:null,item:null,sourceId:null,dropResult:null,didDrop:!1,isSourcePublic:null,targetIds:[]});default:return n}}function de(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;switch((arguments.length>1?arguments[1]:void 0).type){case K:case W:return e+1;case Z:case X:return e-1;default:return e}}function fe(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)+1}function ve(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){ve(e,t,n[t])}))}return e}function he(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0;return{dirtyHandlerIds:re(r.dirtyHandlerIds,{type:a.type,payload:ge({},a.payload,{prevTargetIds:(e=r,t="dragOperation.targetIds",n=[],t.split(".").reduce((function(e,t){return e&&e[t]?e[t]:n||null}),e))})}),dragOffset:oe(r.dragOffset,a),refCount:de(r.refCount,a),dragOperation:le(r.dragOperation,a),stateId:fe(r.stateId)}}function pe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=function(e){var t="undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__;return l(he,e&&t&&t({name:"dnd-core",instanceId:"dnd-core"}))}(arguments.length>3&&void 0!==arguments[3]&&arguments[3]),a=new P(r,new te(r)),i=new R(r,a),o=e(i,t,n);return i.receiveBackend(o),i}var me=n(9950),ye=n(7376);function we(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var be=0,Ce=Symbol.for("__REACT_DND_CONTEXT_INSTANCE__"),De=(0,me.memo)((function(e){var t=e.children,n=function(e){if("manager"in e){return[{dragDropManager:e.manager},!1]}var t=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Te(),n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,a=t;a[Ce]||(a[Ce]={dragDropManager:pe(e,t,n,r)});return a[Ce]}(e.backend,e.context,e.options,e.debugMode),n=!e.context;return[t,n]}(we(e,["children"])),i=(0,r.default)(n,2),o=i[0],u=i[1];return(0,me.useEffect)((function(){if(u){var e=Te();return++be,function(){0===--be&&(e[Ce]=null)}}}),[]),(0,a.jsx)(ye.M.Provider,{value:o,children:t})}));function Te(){return"undefined"!==typeof global?global:window}}},function(e){e.O(0,[4223],(function(){return t=28360,e(e.s=t);var t}));e.O()}]);