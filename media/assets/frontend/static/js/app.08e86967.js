/*! For license information please see app.08e86967.js.LICENSE.txt */
(self.webpackChunkseahub_frontend=self.webpackChunkseahub_frontend||[]).push([[3524],{3835:function(e,t,n){"use strict";var r=n(23029),o=n(92901),i=n(39874),a=n(85501),s=n(9950),l=n(17119),c=n(13690),u=n(70446),d=n.n(u),p=n(58195),h=n(40326),f=n(65604),m=n(44414),g=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).close=function(){if(n.setState({isClosed:!0}),navigator.cookieEnabled){var e=new Date,t=document.cookie.split("; "),r=!1,o=h.Qv+"_";e.setTime(e.getTime()+12096e5),o+="; expires="+e.toGMTString()+"; path="+h.Yc;for(var i=0,a=t.length;i<a;i++)if("info_id"==t[i].split("=")[0]){r=!0,document.cookie="info_id="+t[i].split("=")[1]+o;break}r||(document.cookie="info_id="+o)}},n.state={isClosed:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return!h.M8||this.state.isClosed?null:(0,m.jsxs)("div",{id:"info-bar",className:"d-flex justify-content-between",children:[(0,m.jsx)("p",{id:"info-bar-info",className:"m-0",dangerouslySetInnerHTML:{__html:h.M8}}),(0,m.jsx)("button",{className:"close sf2-icon-x1",title:(0,h.AP)("Close"),"aria-label":(0,h.AP)("Close"),onClick:this.close})]})}}])}(s.Component),v=g,y=function(){return(0,o.A)((function e(){(0,r.A)(this,e),this.subscribers={}}),[{key:"subscribe",value:function(e,t){this.subscribers[e]||(this.subscribers[e]=[]);var n=this.subscribers[e];return n.push(t),function(){var e=n.indexOf(t);e>-1&&n.splice(e,1)}}},{key:"dispatch",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=this.subscribers[e];Array.isArray(o)&&o.forEach((function(e){return e.apply(void 0,n)}))}}])}(),x=y,A=n(49403),C=n(27288),b=function(e){function t(){var e;(0,r.A)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=(0,i.A)(this,t,[].concat(o))).onMouseEnter=function(){e.props.isSidePanelFolded&&e.props.eventBus.dispatch("top-header-mouse-enter")},e}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.onShowSidePanel,n=e.onSearchedClick,r=e.showSearch,o=e.children;return(0,m.jsxs)("div",{id:"header",className:"top-header d-flex justify-content-between flex-shrink-0",onMouseEnter:this.onMouseEnter,children:[(0,m.jsx)("div",{className:"flex-shrink-0 d-none d-md-flex",children:(0,m.jsx)(A.A,{onCloseSidePanel:this.props.onCloseSidePanel})}),(0,m.jsxs)("div",{className:"flex-shrink-0 d-flex flex-fill ".concat(o?"border-left-show":""),children:[(0,m.jsxs)("div",{className:"cur-view-toolbar",children:[(0,m.jsx)("span",{title:"Side Nav Menu",onClick:t,className:"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none"}),o]}),(0,m.jsx)(C.A,{showSearch:r,searchPlaceholder:this.props.searchPlaceholder,onSearchedClick:n,eventBus:this.props.eventBus})]})]})}}])}(s.Component),w=b,S=n(48738),D=n.n(S),k=n(97011),M=(0,o.A)((function e(t){(0,r.A)(this,e),this.id=t.id,this.name=t.name,this.owner=t.owner,this.admins=t.admins||[],this.avatar_url=t.avatar_url,this.created_at=t.created_at,this.parent_group_id=t.parent_group_id,this.wiki_enabled=t.wiki_enabled,this.repos=t.repos||[],this.group_quota=t.group_quota,this.group_quota_usage=t.group_quota_usage})),j=n(4086),I=n(14113),_=n(99308),P=n(85077),N=n(85907),O=n(18849),T=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).handleGroupChange=function(e){var t=e.target.value;t.trim()?n.setState({isSubmitBtnActive:!0}):n.setState({isSubmitBtnActive:!1}),n.setState({groupName:t}),n.state.errorMsg&&n.setState({errorMsg:""})},n.handleSubmitGroup=function(){var e=n.state.groupName.trim();if(e){var t=n;k.e.createGroup(e).then((function(e){t.props.onCreateGroup(e.data),n.props.toggleDialog()})).catch((function(e){var t=f.Aq.getErrorMsg(e);n.setState({errorMsg:t})}))}else n.setState({errorMsg:(0,h.AP)("Name is required")});n.setState({groupName:""})},n.handleKeyDown=function(e){13===e.keyCode&&(n.handleSubmitGroup(),e.preventDefault())},n.state={groupName:"",errorMsg:"",isSubmitBtnActive:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.props.toggleDialog,autoFocus:!1,children:[(0,m.jsx)(I.A,{toggle:this.props.toggleDialog,children:(0,h.AP)("New Group")}),(0,m.jsxs)(_.A,{children:[(0,m.jsx)("label",{htmlFor:"groupName",children:(0,h.AP)("Name")}),(0,m.jsx)(P.A,{type:"text",id:"groupName",value:this.state.groupName,onChange:this.handleGroupChange,onKeyDown:this.handleKeyDown,autoFocus:!0}),(0,m.jsx)("span",{className:"error",children:this.state.errorMsg})]}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(O.A,{color:"secondary",onClick:this.props.toggleDialog,children:(0,h.AP)("Cancel")}),(0,m.jsx)(O.A,{color:"primary",onClick:this.handleSubmitGroup,disabled:!this.state.isSubmitBtnActive,children:(0,h.AP)("Submit")})]})]})}}])}(s.Component),E=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).tabItemClick=function(e,t,r){n.props.tabItemClick(e,t,r)},n.getActiveClass=function(e){return n.props.currentTab===e?"active":""},n.state={groupItems:[]},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"renderSharedGroups",value:function(){var e=this;return(0,m.jsx)(m.Fragment,{children:this.props.groupItems.map((function(t){return(0,m.jsx)("li",{className:"nav-item ".concat(e.getActiveClass(t.name)),children:(0,m.jsxs)(c.N_,{to:h.Yc+"group/"+t.id+"/",className:"nav-link ellipsis ".concat(e.getActiveClass(t.name)),onClick:function(n){return e.tabItemClick(n,t.name,t.id)},children:[(0,m.jsx)("span",{className:"".concat(0==t.parent_group_id?"sf3-font-group":"sf3-font-department"," sf3-font nav-icon"),"aria-hidden":"true"}),(0,m.jsx)("span",{className:"nav-text",children:t.name})]})},t.id)}))})}},{key:"render",value:function(){var e=this;return(0,m.jsxs)(m.Fragment,{children:[h._s&&(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("my-libs")||this.getActiveClass("deleted")),children:(0,m.jsxs)(c.N_,{to:h.Yc+"my-libs/",className:"nav-link ellipsis ".concat(this.getActiveClass("my-libs")||this.getActiveClass("deleted")),title:(0,h.AP)("My Libraries"),onClick:function(t){return e.tabItemClick(t,"my-libs")},children:[(0,m.jsx)("span",{className:"sf3-font-mine sf3-font nav-icon","aria-hidden":"true"}),(0,m.jsx)("span",{className:"nav-text",children:(0,h.AP)("My Libraries")})]})}),(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("shared-libs")),children:(0,m.jsxs)(c.N_,{to:h.Yc+"shared-libs/",className:"nav-link ellipsis ".concat(this.getActiveClass("shared-libs")),title:(0,h.AP)("Shared with me"),onClick:function(t){return e.tabItemClick(t,"shared-libs")},children:[(0,m.jsx)("span",{className:"sf3-font-share-with-me sf3-font nav-icon","aria-hidden":"true"}),(0,m.jsx)("span",{className:"nav-text",children:(0,h.AP)("Shared with me")})]})}),h.Yi&&(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("org")),onClick:function(t){return e.tabItemClick(t,"org")},children:(0,m.jsxs)(c.N_,{to:h.Yc+"org/",className:"nav-link ellipsis ".concat(this.getActiveClass("org")),title:(0,h.AP)("Shared with all"),children:[(0,m.jsx)("span",{className:"sf3-font-share-with-all sf3-font nav-icon","aria-hidden":"true"}),(0,m.jsx)("span",{className:"nav-text",children:(0,h.AP)("Shared with all")})]})}),this.renderSharedGroups()]})}}])}(s.Component),R=n(13042),L=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).shExtend=function(){n.setState({sharedExtended:!n.state.sharedExtended})},n.loadGroups=function(){k.e.listGroups().then((function(e){var t=e.data.map((function(e){return new M(e)}));n.filesNavHeight=(t.length+(h.pP?1:0)+(h._s?1:0)+(h.Yi?1:0)+1)*R.R5,n.setState({groupItems:t.sort((function(e,t){return e.name.toLowerCase()<t.name.toLowerCase()?-1:1}))})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.tabItemClick=function(e,t,r){if(window.uploader&&window.uploader.isUploadProgressDialogShow&&100!==window.uploader.totalProgress){if(!window.confirm((0,h.AP)("A file is being uploaded. Are you sure you want to leave this page?")))return e.preventDefault(),!1;window.uploader.isUploadProgressDialogShow=!1}n.props.tabItemClick(t,r)},n.getActiveClass=function(e){return n.props.currentTab===e?"active":""},n.onCreateGroup=function(e){var t=new M(e),r=n.state.groupItems;r.push(t),n.filesNavHeight+=R.R5,n.setState({groupItems:r})},n.toggleCreateGroupDialog=function(){n.setState({isCreateGroupDialogOpen:!n.state.isCreateGroupDialogOpen})},n.toggleFilesNav=function(e){e.preventDefault(),e.stopPropagation(),n.setState({filesNavUnfolded:!n.state.filesNavUnfolded},(function(){n.state.filesNavUnfolded&&n.loadGroups()}))},n.state={filesNavUnfolded:!1,sharedExtended:!1,groupItems:[],isCreateGroupDialogOpen:!1},n.adminHeight=0,n.filesNavHeight=0,n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"renderAddGroup",value:function(){return(0,m.jsx)(m.Fragment,{children:h.pP&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("li",{className:"nav-item",onClick:this.toggleCreateGroupDialog,children:(0,m.jsxs)("span",{className:"nav-link",role:"button",children:[(0,m.jsx)("i",{className:"sf2-icon-plus nav-icon","aria-hidden":"true"}),(0,h.AP)("New Group")]})}),this.state.isCreateGroupDialogOpen&&(0,m.jsx)(T,{toggleDialog:this.toggleCreateGroupDialog,onCreateGroup:this.onCreateGroup})]})})}},{key:"renderSharedAdmin",value:function(){var e=this,t=0;this.state.sharedExtended&&(this.adminHeight||(this.adminHeight=3*R.R5),t=this.adminHeight);var n={height:t,opacity:0===t?0:1},r=null;return h.zn?r=(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("share-admin-share-links")),children:(0,m.jsxs)(c.N_,{to:h.Yc+"share-admin-share-links/",className:"nav-link ellipsis ".concat(this.getActiveClass("share-admin-share-links")),title:(0,h.AP)("Links"),onClick:function(t){return e.tabItemClick(t,"share-admin-share-links")},children:[(0,m.jsx)("span",{"aria-hidden":"true",className:"sharp",children:"#"}),(0,m.jsx)("span",{className:"nav-text",children:(0,h.AP)("Links")})]})}):h.fY&&(r=(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("share-admin-upload-links")),children:(0,m.jsxs)(c.N_,{to:h.Yc+"share-admin-upload-links/",className:"nav-link ellipsis ".concat(this.getActiveClass("share-admin-upload-links")),title:(0,h.AP)("Links"),onClick:function(t){return e.tabItemClick(t,"share-admin-upload-links")},children:[(0,m.jsx)("span",{"aria-hidden":"true",className:"sharp",children:"#"}),(0,m.jsx)("span",{className:"nav-text",children:(0,h.AP)("Links")})]})})),(0,m.jsxs)("ul",{id:"share-admin-sub-nav",className:"nav sub-nav nav-pills flex-column ".concat(this.state.sharedExtended?"side-panel-slide-share-admin":"side-panel-slide-up-share-admin"),style:n,children:[h._s&&h.Ih&&(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("share-admin-libs")),children:(0,m.jsxs)(c.N_,{to:h.Yc+"share-admin-libs/",className:"nav-link ellipsis ".concat(this.getActiveClass("share-admin-libs")),title:(0,h.AP)("Libraries"),onClick:function(t){return e.tabItemClick(t,"share-admin-libs")},children:[(0,m.jsx)("span",{"aria-hidden":"true",className:"sharp",children:"#"}),(0,m.jsx)("span",{className:"nav-text",children:(0,h.AP)("Libraries")})]})}),h.Ih&&(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("share-admin-folders")),children:(0,m.jsxs)(c.N_,{to:h.Yc+"share-admin-folders/",className:"nav-link ellipsis ".concat(this.getActiveClass("share-admin-folders")),title:(0,h.AP)("Folders"),onClick:function(t){return e.tabItemClick(t,"share-admin-folders")},children:[(0,m.jsx)("span",{"aria-hidden":"true",className:"sharp",children:"#"}),(0,m.jsx)("span",{className:"nav-text",children:(0,h.AP)("Folders")})]})}),r]})}},{key:"renderCustomNavItems",value:function(){return h.vn.map((function(e,t){return(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsxs)("a",{href:e.link,className:"nav-link ellipsis",title:e.desc,children:[(0,m.jsx)("span",{className:e.icon,"aria-hidden":"true"}),(0,m.jsx)("span",{className:"nav-text",children:e.desc})]})},t)}))}},{key:"render",value:function(){var e=this,t=h.q5||h.am||!h.Ez,n=this.state,r=n.filesNavUnfolded,o=n.groupItems;return(0,m.jsx)("div",{className:"side-nav",children:(0,m.jsxs)("div",{className:"side-nav-con d-flex flex-column",children:[(0,m.jsx)("h2",{className:"mb-2 px-2 font-weight-normal heading",children:(0,h.AP)("Workspace")}),(0,m.jsxs)("ul",{className:"nav nav-pills flex-column nav-container",children:[(0,m.jsxs)("li",{id:"files",className:"nav-item flex-column ".concat(this.getActiveClass("libraries")),children:[(0,m.jsxs)(c.N_,{to:h.Yc+"libraries/",className:"nav-link ellipsis ".concat(this.getActiveClass("libraries")),title:(0,h.AP)("Files"),onClick:function(t){return e.tabItemClick(t,"libraries")},children:[(0,m.jsx)("span",{className:"sf3-font-files sf3-font","aria-hidden":"true"}),(0,m.jsx)("span",{className:"nav-text",children:(0,h.AP)("Files")}),(0,m.jsx)("span",{className:"toggle-icon sf3-font sf3-font-down ".concat(r?"":"rotate-90"),"aria-hidden":"true",onClick:this.toggleFilesNav})]}),(0,m.jsxs)("ul",{id:"files-sub-nav",className:"nav sub-nav nav-pills flex-column ".concat(r?"side-panel-slide":"side-panel-slide-up"),style:{height:r?this.filesNavHeight:0,opacity:r?1:0},children:[(0,m.jsx)(E,{groupItems:o,tabItemClick:this.tabItemClick,currentTab:this.props.currentTab}),this.renderAddGroup()]})]}),(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("starred")),children:(0,m.jsxs)(c.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("starred")),to:h.Yc+"starred/",title:(0,h.AP)("Favorites"),onClick:function(t){return e.tabItemClick(t,"starred")},children:[(0,m.jsx)("span",{className:"sf3-font-starred sf3-font","aria-hidden":"true"}),(0,m.jsx)("span",{className:"nav-text",children:(0,h.AP)("Favorites")})]})}),t&&(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("dashboard")),children:(0,m.jsxs)(c.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("dashboard")),to:h.Yc+"dashboard/",title:(0,h.AP)("Activities"),onClick:function(t){return e.tabItemClick(t,"dashboard")},children:[(0,m.jsx)("span",{className:"sf3-font-activities sf3-font","aria-hidden":"true"}),(0,m.jsx)("span",{className:"nav-text",children:(0,h.AP)("Activities")})]})}),(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("published")),children:(0,m.jsxs)(c.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("published")),to:h.Yc+"published/",title:(0,h.AP)("Wikis"),onClick:function(t){return e.tabItemClick(t,"published")},children:[(0,m.jsx)("span",{className:"sf3-font-wiki sf3-font","aria-hidden":"true"}),(0,m.jsx)("span",{className:"nav-text",children:(0,h.AP)("Wikis")})]})}),h.Rf&&(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("invitations")),children:(0,m.jsxs)(c.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("invitations")),to:h.Yc+"invitations/",title:(0,h.AP)("Invite Guest"),onClick:function(t){return e.tabItemClick(t,"invitations")},children:[(0,m.jsx)("span",{className:"sf3-font-invite-visitors sf3-font","aria-hidden":"true"}),(0,m.jsx)("span",{className:"nav-text",children:(0,h.AP)("Invite Guest")})]})}),(0,m.jsxs)("li",{id:"share-admin-nav",className:"nav-item flex-column",children:[(0,m.jsxs)("a",{className:"nav-link ellipsis",title:(0,h.AP)("Share Admin"),onClick:this.shExtend,children:[(0,m.jsx)("span",{className:"sf3-font-wrench sf3-font","aria-hidden":"true"}),(0,m.jsx)("span",{className:"nav-text",children:(0,h.AP)("Share Admin")}),(0,m.jsx)("span",{className:"toggle-icon sf3-font sf3-font-down ".concat(this.state.sharedExtended?"":"rotate-90"),"aria-hidden":"true"})]}),this.renderSharedAdmin()]}),h.vn&&this.renderCustomNavItems()]}),(0,m.jsx)("h2",{className:"mb-2 pt-1 px-2 font-weight-normal heading",children:(0,h.AP)("Help and resources")}),h.QU?(0,m.jsx)("div",{className:"side-nav-footer",dangerouslySetInnerHTML:{__html:h.QU}}):(0,m.jsxs)("ul",{className:"nav nav-pills flex-column nav-container",children:[(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsxs)("a",{className:"nav-link",href:h.Yc+"help/",title:(0,h.AP)("Help"),children:[(0,m.jsx)("span",{className:"sf3-font-help sf3-font","aria-hidden":"true"}),(0,m.jsx)("span",{className:"nav-text",children:(0,h.AP)("Help")})]})}),h.jk&&(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsxs)("a",{href:"".concat(h.Yc,"terms/"),className:"nav-link",children:[(0,m.jsx)("span",{className:"sf3-font-terms sf3-font","aria-hidden":"true"}),(0,m.jsx)("span",{className:"nav-text",children:(0,h.AP)("Terms")})]})}),h.Vk&&(0,m.jsx)(m.Fragment,{children:Object.keys(h.Vk).map((function(e,t){return(0,m.jsxs)("a",{className:"nav-link",href:h.Vk[e],children:[(0,m.jsx)("span",{className:"sf3-font-terms sf3-font","aria-hidden":"true"}),(0,m.jsx)("span",{className:"nav-text",children:e})]})}))}),(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsxs)("a",{href:h.Yc+"download_client_program/",className:"nav-link",children:[(0,m.jsx)("span",{className:"sf3-font-devices sf3-font","aria-hidden":"true"}),(0,m.jsx)("span",{className:"nav-text",children:(0,h.AP)("Clients")})]})})]}),(0,m.jsxs)("div",{className:"side-nav-bottom-toolbar d-none d-md-flex mt-auto px-2 rounded flex-shrink-0 align-items-center",onClick:this.props.toggleFoldSideNav,children:[(0,m.jsx)("img",{className:"mr-2",src:"".concat(h.SG,"img/close-sidebar.svg"),width:"20",alt:""}),(0,m.jsx)("span",{children:(0,h.AP)("Fold the sidebar")})]})]})})}}])}(s.Component),F=n(5544),U=n(81718);var B=function(e){var t=(0,s.useState)(!1),n=(0,F.A)(t,2),r=n[0],o=n[1],i=(0,s.useState)(!1),a=(0,F.A)(i,2),l=a[0],c=a[1],u=(0,s.useCallback)((function(){r?(o(!1),c(!1)):(o(!0),setTimeout((function(){c(!0)}),10))}),[r]);return(0,m.jsx)(U.A,{popperClassName:"side-nav-icon-tip-popover",innerClassName:l?"side-nav-icon-tip side-nav-icon-tip-animation":"side-nav-icon-tip",toggle:u,hideArrow:!0,delay:{show:0,hide:0},target:e.target,placement:"right",isOpen:r,children:e.text})},Y=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).handleOutsideClick=function(e){n.state.isFilesSubNavShown&&!n.filesSubNav.contains(e.target)&&n.closeSubNav()},n.openSubNav=function(){if(!n.state.isFilesSubNavShown){if(h.M8){var e=document.getElementById("info-bar"),t=60+(e?e.clientHeight:0)+"px";n.filesSubNav.style.top=t}n.setState({isFilesSubNavShown:!0})}},n.closeSubNav=function(){n.state.isFilesSubNavShown&&n.setState({isFilesSubNavShown:!1})},n.tabItemClick=function(e,t,r){if(window.uploader&&window.uploader.isUploadProgressDialogShow&&100!==window.uploader.totalProgress){if(!window.confirm((0,h.AP)("A file is being uploaded. Are you sure you want to leave this page?")))return e.preventDefault(),!1;window.uploader.isUploadProgressDialogShow=!1}n.props.tabItemClick(t,r),n.setState({isFilesSubNavShown:!1})},n.getActiveClass=function(e){return n.props.currentTab===e?"active":""},n.state={groupItems:[],isFilesSubNavShown:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("click",this.handleOutsideClick),this.unsubscribeHeaderEvent=this.props.eventBus.subscribe("top-header-mouse-enter",this.closeSubNav),k.e.listGroups().then((function(t){e.setState({groupItems:t.data.map((function(e){return new M(e)})).sort((function(e,t){return e.name.toLowerCase()<t.name.toLowerCase()?-1:1}))})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.handleOutsideClick),this.unsubscribeHeaderEvent()}},{key:"render",value:function(){var e=this,t=h.q5||h.am||!h.Ez,n=this.state,r=n.groupItems,o=n.isFilesSubNavShown;return(0,m.jsxs)("div",{className:"side-nav-folded-container h-100 position-relative",children:[(0,m.jsx)("div",{className:"side-nav side-nav-folded position-relative",style:{zIndex:2},children:(0,m.jsx)("div",{className:"side-nav-con p-0",children:(0,m.jsx)("div",{className:"nav nav-pills nav-container",children:(0,m.jsx)("ul",{id:"files-sub-nav",className:"sub-nav position-fixed rounded border shadow p-4 o-auto",style:{left:o?R.xQ+4:"-240px",maxHeight:10*R.R5+32,opacity:o?1:0},ref:function(t){return e.filesSubNav=t},onMouseLeave:this.closeSubNav,children:(0,m.jsx)(E,{groupItems:r,tabItemClick:this.tabItemClick,currentTab:this.props.currentTab})})})})}),(0,m.jsx)("div",{className:"side-nav side-nav-folded h-100 position-relative",style:{zIndex:3},children:(0,m.jsxs)("div",{className:"side-nav-con d-flex flex-column",children:[(0,m.jsxs)("ul",{className:"nav nav-pills flex-column nav-container",children:[(0,m.jsx)("li",{className:"nav-item flex-column ".concat(this.getActiveClass("libraries")),children:(0,m.jsx)(c.N_,{to:h.Yc+"libraries/",className:"nav-link ellipsis ".concat(this.getActiveClass("libraries")),onClick:function(t){return e.tabItemClick(t,"libraries")},onMouseEnter:this.openSubNav,children:(0,m.jsx)("span",{className:"sf3-font-files sf3-font mr-0","aria-hidden":"true"})})}),(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("starred")),onMouseEnter:this.closeSubNav,children:(0,m.jsxs)(c.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("starred")),to:h.Yc+"starred/",onClick:function(t){return e.tabItemClick(t,"starred")},children:[(0,m.jsx)("span",{className:"sf3-font-starred sf3-font mr-0","aria-hidden":"true",id:"main-side-nav-folded-starred"}),(0,m.jsx)(B,{target:"main-side-nav-folded-starred",text:(0,h.AP)("Favorites")})]})}),t&&(0,m.jsx)(m.Fragment,{children:(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("dashboard")),onMouseEnter:this.closeSubNav,children:(0,m.jsxs)(c.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("dashboard")),to:h.Yc+"dashboard/",onClick:function(t){return e.tabItemClick(t,"dashboard")},children:[(0,m.jsx)("span",{className:"sf3-font-activities sf3-font mr-0","aria-hidden":"true",id:"main-side-nav-folded-dashboard"}),(0,m.jsx)(B,{target:"main-side-nav-folded-dashboard",text:(0,h.AP)("Activities")})]})})}),(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("published")),onMouseEnter:this.closeSubNav,children:(0,m.jsxs)(c.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("published")),to:h.Yc+"published/",onClick:function(t){return e.tabItemClick(t,"published")},children:[(0,m.jsx)("span",{className:"sf3-font-wiki sf3-font mr-0","aria-hidden":"true",id:"main-side-nav-folded-wikis"}),(0,m.jsx)(B,{target:"main-side-nav-folded-wikis",text:(0,h.AP)("Wikis")})]})}),h.Rf&&(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("invitations")),onMouseEnter:this.closeSubNav,children:(0,m.jsxs)(c.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("invitations")),to:h.Yc+"invitations/",onClick:function(t){return e.tabItemClick(t,"invitations")},children:[(0,m.jsx)("span",{className:"sf3-font-invite-visitors sf3-font mr-0","aria-hidden":"true",id:"main-side-nav-folded-invitations"}),(0,m.jsx)(B,{target:"main-side-nav-folded-invitations",text:(0,h.AP)("Invite Guest")})]})}),h.vn&&h.vn.map((function(e,t){return(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsx)("a",{href:e.link,className:"nav-link ellipsis",title:e.desc,children:(0,m.jsx)("span",{className:e.icon,"aria-hidden":"true",title:e.desc})})},t)}))]}),h.QU?(0,m.jsx)("div",{className:"side-nav-footer",dangerouslySetInnerHTML:{__html:h.QU}}):(0,m.jsxs)("ul",{className:"nav nav-pills flex-column nav-container",children:[(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsxs)("a",{className:"nav-link",href:h.Yc+"help/",title:(0,h.AP)("Help"),children:[(0,m.jsx)("span",{className:"sf3-font-help sf3-font mr-0","aria-hidden":"true",id:"main-side-nav-folded-help"}),(0,m.jsx)(B,{target:"main-side-nav-folded-help",text:(0,h.AP)("Help")})]})}),h.jk&&(0,m.jsx)(m.Fragment,{children:(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsxs)("a",{href:"".concat(h.Yc,"terms/"),className:"nav-link",children:[(0,m.jsx)("span",{className:"sf3-font-terms sf3-font mr-0","aria-hidden":"true",id:"main-side-nav-folded-terms"}),(0,m.jsx)(B,{target:"main-side-nav-folded-terms",text:(0,h.AP)("Terms")})]})})}),h.Vk&&(0,m.jsx)(m.Fragment,{children:Object.keys(h.Vk).map((function(e,t){return(0,m.jsx)("a",{className:"nav-link",href:h.Vk[e],children:(0,m.jsx)("span",{className:"sf3-font-terms sf3-font mr-0","aria-hidden":"true"})})}))}),(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsxs)("a",{href:h.Yc+"download_client_program/",className:"nav-link",children:[(0,m.jsx)("span",{className:"sf3-font-devices sf3-font mr-0","aria-hidden":"true",id:"main-side-nav-folded-clients"}),(0,m.jsx)(B,{target:"main-side-nav-folded-clients",text:(0,h.AP)("Clients")})]})})]}),(0,m.jsx)("div",{className:"side-nav-bottom-toolbar d-none d-md-flex mt-auto px-2 rounded flex-shrink-0 align-items-center",onClick:this.props.toggleFoldSideNav,children:(0,m.jsx)("img",{src:"".concat(h.SG,"img/open-sidebar.svg"),width:"20",alt:"",title:(0,h.AP)("Unfold the sidebar")})})]})})]})}}])}(s.Component),q=function(e){function t(){return(0,r.A)(this,t),(0,i.A)(this,t,arguments)}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.isSidePanelFolded,r=e.style,o=e.eventBus;return(0,m.jsxs)("div",{className:D()("side-panel",{"side-panel-folded":n,"left-zero":!this.props.isSidePanelClosed}),style:n?{flexBasis:R.xQ}:r,children:[(0,m.jsx)(d(),{query:"(max-width: 767.8px)",children:(0,m.jsx)("div",{className:"side-panel-north",children:(0,m.jsx)(A.A,{onCloseSidePanel:this.props.onCloseSidePanel})})}),(0,m.jsxs)("div",{className:"side-panel-center",children:[t||null,!t&&!n&&(0,m.jsx)(L,{tabItemClick:this.props.tabItemClick,currentTab:this.props.currentTab,isSidePanelFolded:n,toggleFoldSideNav:this.props.toggleFoldSideNav}),!t&&n&&(0,m.jsx)(Y,{tabItemClick:this.props.tabItemClick,currentTab:this.props.currentTab,toggleFoldSideNav:this.props.toggleFoldSideNav,eventBus:o})]})]})}}])}(s.Component),H=q;var G=function(e){return(0,m.jsxs)("div",{className:"resize-bar",ref:e.resizeBarRef,style:Object.assign({zIndex:2},e.resizeBarStyle),onMouseDown:e.onResizeMouseDown,onMouseOver:e.onResizeMouseOver,children:[(0,m.jsx)("div",{className:"resize-bar-line"}),(0,m.jsx)("div",{className:"resize-bar-drag-handler",ref:e.dragHandlerRef,style:e.dragHandlerStyle})]})},z=26,V=.22,W=n(60436),K=n(59051),X=n.n(K),$=n(81446),Z=(0,o.A)((function e(t){(0,r.A)(this,e),this.repo_id=t.repo_id,this.repo_name=t.repo_name,this.obj_type=t.obj_type,this.commit_id=t.commit_id,this.path=t.path,this.name=t.name,this.author_email=t.author_email,this.author_name=t.author_name,this.author_contact_email=t.author_contact_email,this.avatar_url=t.avatar_url,this.time=t.time,this.op_type=t.op_type,this.createdFilesCount=0,this.createdFilesList=[],"clean-up-trash"===t.op_type?this.days=t.days:"rename"===t.op_type&&"repo"===t.obj_type?this.old_repo_name=t.old_repo_name:"move"===t.op_type&&["dir","file"].includes(t.obj_type)?this.old_path=t.old_path:"rename"===t.op_type&&["dir","file"].includes(t.obj_type)?(this.old_path=t.old_path,this.old_name=t.old_name):"publish"===t.op_type&&(this.old_path=t.old_path)})),J=n(43066),Q=n(21205),ee=function(e){function t(){var e;(0,r.A)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=(0,i.A)(this,t,[].concat(o))).toggle=function(t){e.props.toggleCancel(t)},e}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.activity;return(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.toggle,children:[(0,m.jsx)(I.A,{toggle:this.toggle,children:(0,h.AP)("Created Files")}),(0,m.jsx)(_.A,{children:(0,m.jsxs)(Q.A,{children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"75%",children:(0,h.AP)("Name")}),(0,m.jsx)("th",{width:"25%",children:(0,h.AP)("Time")})]})}),(0,m.jsx)("tbody",{children:e.createdFilesList.map((function(e,t){var n="".concat(h.Yc,"lib/").concat(e.repo_id,"/file").concat(f.Aq.encodePath(e.path)),r=(0,m.jsx)("a",{href:n,target:"_blank",rel:"noreferrer",children:e.name});return e.name.endsWith("(draft).md")&&(r=e.name),(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{children:r}),(0,m.jsx)("td",{children:X()(e.time).fromNow()})]},t)}))})]})}),(0,m.jsx)(N.A,{children:(0,m.jsx)(O.A,{color:"secondary",onClick:this.toggle.bind(this,e),children:(0,h.AP)("Close")})})]})}}])}(s.Component),te=ee,ne=n(40866);X().locale(window.app.config.lang);var re=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onListCreatedFilesToggle=function(){n.setState({isListCreatedFiles:!n.state.isListCreatedFiles})},n.onMouseEnter=function(){n.setState({isHighlighted:!0})},n.onMouseLeave=function(){n.setState({isHighlighted:!1})},n.state={isListCreatedFiles:!1,isHighlighted:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e,t,n=this.state.isHighlighted,r=this.props.isDesktop,o=this.props,i=o.item,a=o.index,l=o.items,c=!1,u="".concat(h.Yc,"profile/").concat(encodeURIComponent(i.author_email),"/"),d=h.Yc+"library/"+i.repo_id+"/"+encodeURIComponent(i.repo_name)+"/",p=(0,m.jsx)("a",{href:d,children:i.repo_name}),g=(0,m.jsx)("a",{className:"small text-secondary",href:d,children:i.repo_name});if("repo"==i.obj_type)switch(i.op_type){case"create":e=(0,h.AP)("Created library"),t=p;break;case"rename":e=(0,h.AP)("Renamed library"),t=(0,m.jsxs)("span",{children:[i.old_repo_name," => ",p]});break;case"delete":e=(0,h.AP)("Deleted library"),t=i.repo_name;break;case"recover":e=(0,h.AP)("Restored library"),t=p;break;case"clean-up-trash":e=(0,h.AP)("Cleaned trash"),t=0==i.days?(0,h.AP)("Removed all items from trash."):(0,h.AP)("Removed items older than {n} days from trash.").replace("{n}",i.days),c=!0}else if("files"==i.obj_type){var v="".concat(h.Yc,"lib/").concat(i.repo_id,"/file").concat(f.Aq.encodePath(i.path)),y="<a href=".concat(v,' target="_blank">').concat(i.name,"</a>"),x=i.createdFilesCount-1,A=(0,h.AP)("{file} and {n} other files").replace("{file}",y).replace("{n}",x);e=(0,h.AP)("Created {n} files").replace("{n}",i.createdFilesCount),t=(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("p",{className:"m-0 d-inline",dangerouslySetInnerHTML:{__html:A}}),r&&(0,m.jsx)("button",{type:"button",onClick:this.onListCreatedFilesToggle,className:"activity-details text-secondary ml-2 border-0 p-0 bg-transparent",children:(0,h.AP)("details")})]}),c=!0}else if("file"==i.obj_type){var C=i.name.endsWith("(draft).md"),b=C?"":"".concat(h.Yc,"lib/").concat(i.repo_id,"/file").concat(f.Aq.encodePath(i.path)),w=(0,m.jsx)("a",{href:b,target:"_blank",rel:"noreferrer",children:i.name});switch(C&&(w=i.name),i.op_type){case"create":e=C?(0,h.AP)("Created draft"):(0,h.AP)("Created file"),t=w,c=!0;break;case"delete":e=C?(0,h.AP)("Deleted draft"):(0,h.AP)("Deleted file"),t=i.name,c=!0;break;case"recover":e=(0,h.AP)("Restored file"),t=w,c=!0;break;case"rename":e=(0,h.AP)("Renamed file"),t=(0,m.jsxs)("span",{children:[i.old_name," => ",w]}),c=!0;break;case"move":var S=(0,m.jsx)("a",{href:b,children:i.path});e=(0,h.AP)("Moved file"),t=(0,m.jsxs)("span",{children:[i.old_path," => ",S]}),c=!0;break;case"edit":e=C?(0,h.AP)("Updated draft"):(0,h.AP)("Updated file"),t=w,c=!0}}else{var D=h.Yc+"library/"+i.repo_id+"/"+encodeURIComponent(i.repo_name)+f.Aq.encodePath(i.path),k=(0,m.jsx)("a",{href:D,target:"_blank",rel:"noreferrer",children:i.name});switch(i.op_type){case"create":e=(0,h.AP)("Created folder"),t=k,c=!0;break;case"delete":e=(0,h.AP)("Deleted folder"),t=i.name,c=!0;break;case"recover":e=(0,h.AP)("Restored folder"),t=k,c=!0;break;case"rename":e=(0,h.AP)("Renamed folder"),t=(0,m.jsxs)("span",{children:[i.old_name," => ",k]}),c=!0;break;case"move":var M=(0,m.jsx)("a",{href:D,children:i.path});e=(0,h.AP)("Moved folder"),t=(0,m.jsxs)("span",{children:[i.old_path," => ",M]}),c=!0}}var j=!0;if(a>0){var I=l[a-1].time;j=!X()(i.time).isSame(I,"day")}return(0,m.jsxs)(s.Fragment,{children:[j&&(0,m.jsx)("tr",{children:(0,m.jsx)("td",{colSpan:r?5:3,className:"border-top-0",children:X()(i.time).format("YYYY-MM-DD")})}),r?(0,m.jsxs)("tr",{className:n?"tr-highlight":"",onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[(0,m.jsx)("td",{className:"text-center",children:(0,m.jsx)("img",{src:i.avatar_url,alt:"",width:"32",height:"32",className:"avatar"})}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:u,children:i.author_name})}),(0,m.jsx)("td",{children:e}),(0,m.jsxs)("td",{children:[t,c&&(0,m.jsx)("br",{}),c&&g]}),(0,m.jsx)("td",{className:"text-secondary",children:(0,m.jsx)("time",{datetime:i.time,is:"relative-time",title:X()(i.time).format("llll"),children:X()(i.time).fromNow()})})]}):(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{className:"text-center align-top",children:(0,m.jsx)("img",{src:i.avatar_url,alt:"",width:"32",height:"32",className:"avatar"})}),(0,m.jsxs)("td",{children:[(0,m.jsx)("a",{href:u,children:i.author_name}),(0,m.jsx)("p",{className:"m-0 text-secondary",children:e}),t]}),(0,m.jsxs)("td",{className:"text-right align-top",children:[(0,m.jsx)("span",{className:"text-secondary mobile-activity-time",children:(0,m.jsx)("time",{datetime:i.time,is:"relative-time",title:X()(i.time).format("llll"),children:X()(i.time).fromNow()})}),c&&(0,m.jsx)("br",{}),c&&p]})]}),this.state.isListCreatedFiles&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(te,{activity:i,toggleCancel:this.onListCreatedFilesToggle})})]})}}])}(s.Component);X().locale(window.app.config.lang);var oe=function(e){function t(){return(0,r.A)(this,t),(0,i.A)(this,t,arguments)}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=f.Aq.isDesktop(),t=this.props,n=t.items,r=t.isLoadingMore;if(!n.length)return(0,m.jsx)(J.A,{text:(0,h.AP)("No more activities")});var o=(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"8%"}),(0,m.jsx)("th",{width:"15%",children:(0,h.AP)("User")}),(0,m.jsx)("th",{width:"20%",children:(0,h.AP)("Operation")}),(0,m.jsxs)("th",{width:"37%",children:[(0,h.AP)("File")," / ",(0,h.AP)("Library")]}),(0,m.jsx)("th",{width:"20%",children:(0,h.AP)("Time")})]})}),i=(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"15%"}),(0,m.jsx)("th",{width:"53%"}),(0,m.jsx)("th",{width:"32%"})]})});return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsxs)("table",{className:"table-thead-hidden",children:[e?o:i,(0,m.jsx)("tbody",{children:n.map((function(t,r){return(0,m.jsx)(re,{isDesktop:e,item:t,index:r,items:n},r)}))})]}),r?(0,m.jsx)("span",{className:"loading-icon loading-tip"}):""]})}}])}(s.Component),ie=oe,ae=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).handleOutsideClick=function(e){n.state.isPopoverOpen&&!n.userSelector.contains(e.target)&&n.togglePopover()},n.togglePopover=function(){n.setState({isPopoverOpen:!n.state.isPopoverOpen},(function(){if(!n.state.isPopoverOpen){var e=n.props.availableUsers.filter((function(e){return e.isSelected}));n.props.setTargetUsers(e)}}))},n.onToggleClick=function(e){e.stopPropagation(),n.togglePopover()},n.onQueryChange=function(e){n.setState({query:e.target.value})},n.toggleSelectItem=function(e,t){e.stopPropagation(),n.props.toggleSelectUser(t)},n.state={isPopoverOpen:!1,query:""},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.handleOutsideClick)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.handleOutsideClick)}},{key:"render",value:function(){var e=this,t=this.state,n=t.isPopoverOpen,r=t.query,o=this.props,i=o.currentSelectedUsers,a=o.availableUsers,s=a.filter((function(e){return e.isSelected})),l=r.trim()?a.filter((function(e){return-1!=e.contact_email.indexOf(r.trim())||-1!=e.name.indexOf(r.trim())})):a;return(0,m.jsxs)("div",{className:"mt-4 position-relative",children:[(0,m.jsxs)("span",{className:"cur-activity-modifiers d-inline-block p-2 rounded",onClick:this.onToggleClick,children:[i.length>0?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("span",{children:(0,h.AP)("Modified by:")}),(0,m.jsx)("span",{className:"d-inline-block ml-1",children:i.map((function(e){return e.name})).join(", ")})]}):(0,h.AP)("Modified by"),(0,m.jsx)("i",{className:"sf3-font sf3-font-down ml-2 toggle-icon"})]}),n&&(0,m.jsxs)("div",{className:"position-absolute activity-modifier-selector-container rounded shadow",ref:function(t){return e.userSelector=t},children:[(0,m.jsx)("ul",{className:"activity-selected-modifiers px-3 py-1 list-unstyled",children:s.map((function(t,n){return(0,m.jsxs)("li",{className:"activity-selected-modifier",children:[(0,m.jsx)("img",{src:t.avatar_url,className:"avatar w-5 h-5",alt:""}),(0,m.jsx)("span",{className:"activity-user-name ml-2",children:t.name}),(0,m.jsx)("i",{className:"sf2-icon-close unselect-activity-user ml-2",onClick:function(n){e.toggleSelectItem(n,t)}})]},n)}))}),(0,m.jsx)("div",{className:"px-3 pt-3",children:(0,m.jsx)(P.A,{type:"text",placeholder:(0,h.AP)("Find modifiers"),value:r,onChange:this.onQueryChange})}),(0,m.jsx)("ul",{className:"activity-user-list list-unstyled p-3 o-auto",children:l.map((function(t,n){return(0,m.jsxs)("li",{className:"activity-user-item h-6 p-1 rounded d-flex justify-content-between align-items-center",onClick:function(n){e.toggleSelectItem(n,t)},children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("img",{src:t.avatar_url,className:"avatar w-5 h-5",alt:""}),(0,m.jsx)("span",{className:"activity-user-name ml-2",children:t.name})]}),t.isSelected&&(0,m.jsx)("i",{className:"sf2-icon-tick text-gray font-weight-bold"})]},n)}))})]})]})}}])}(s.Component);X().locale(window.app.config.lang);var se=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).mergePublishEvents=function(e){e.forEach((function(e){"publish"===e.op_type&&(n.curPathList.push(e.path),n.oldPathList.push(e.old_path))}));for(var t=[],r=0;r<e.length;r++)"file"===e[r].obj_type?"delete"===e[r].op_type&&n.oldPathList.includes(e[r].path)?n.oldPathList.splice(n.oldPathList.indexOf(e[r].path),1):"edit"===e[r].op_type&&n.curPathList.includes(e[r].path)?n.curPathList.splice(n.curPathList.indexOf(e[r].path),1):"rename"===e[r].op_type&&n.oldPathList.includes(e[r].old_path)?n.oldPathList.splice(n.oldPathList.indexOf(e[r].old_path),1):t.push(e[r]):t.push(e[r]);return t},n.mergeFileCreateEvents=function(e){for(var t=[],n=null,r=0;r<e.length;r++){var o="file"===e[r].obj_type&&"create"===e[r].op_type&&e[r+1]&&"file"===e[r+1].obj_type&&"create"===e[r+1].op_type&&e[r+1].repo_name===e[r].repo_name&&e[r+1].author_email===e[r].author_email;if(null!=n){if(n.createdFilesCount++,n.createdFilesList.push(e[r]),o)continue;t.push(n),n=null}else o?((n=new Z(e[r])).obj_type="files",n.createdFilesCount++,n.createdFilesList.push(e[r])):t.push(e[r])}return t},n.filterEvents=function(e){var t=n.props.onlyMine,r=n.state.targetUsers;return t?e.filter((function(e){return e.author_email==h.Xh})):r.length?e.filter((function(e){return-1!=r.map((function(e){return e.email})).indexOf(e.author_email)})):e},n.setTargetUsers=function(e){n.setState({targetUsers:e},(function(){var e=n.filterEvents(n.state.allItems);n.setState({items:e},(function(){e.length<25&&n.state.hasMore&&n.getMore()}))}))},n.toggleSelectUser=function(e){var t=n.state.availableUsers;n.setState({availableUsers:t.map((function(t){return t.email==e.email&&(t.isSelected=!e.isSelected),t}))})},n.handleScroll=function(e){if(!n.state.isLoadingMore&&n.state.hasMore){var t=e.target.clientHeight,r=e.target.scrollHeight;t+e.target.scrollTop+1>=r&&n.setState({isLoadingMore:!0},(function(){n.getMore()}))}},n.state={errorMsg:"",isFirstLoading:!0,isLoadingMore:!1,currentPage:1,hasMore:!0,allItems:[],items:[],availableUsers:[],targetUsers:[]},n.avatarSize=72,n.curPathList=[],n.oldPathList=[],n.availableUserEmails=new Set,n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.state,n=t.currentPage,r=t.availableUsers;k.e.listActivities(n,this.avatarSize).then((function(t){var o=e.mergePublishEvents(t.data.events);(o=e.mergeFileCreateEvents(o)).forEach((function(t){e.availableUserEmails.has(t.author_email)||(e.availableUserEmails.add(t.author_email),r.push({email:t.author_email,name:t.author_name,contact_email:t.author_contact_email,avatar_url:t.avatar_url,isSelected:!1}))}));var i=e.filterEvents(o);e.setState({allItems:o,items:i,availableUsers:r,currentPage:n+1,isFirstLoading:0==i.length,hasMore:!0}),e.state.items.length<25&&e.getMore()})).catch((function(t){e.setState({isFirstLoading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"getMore",value:function(){var e=this,t=this.state,n=t.currentPage,r=t.availableUsers,o=t.targetUsers;k.e.listActivities(n,this.avatarSize).then((function(t){var i=e.mergePublishEvents(t.data.events);(i=e.mergeFileCreateEvents(i)).forEach((function(t){e.availableUserEmails.has(t.author_email)||(e.availableUserEmails.add(t.author_email),r.push({email:t.author_email,name:t.author_name,contact_email:t.author_contact_email,avatar_url:t.avatar_url,isSelected:!1}))}));var a=e.filterEvents(i),s=[].concat((0,W.A)(e.state.items),(0,W.A)(a));e.setState({allItems:[].concat((0,W.A)(e.state.allItems),(0,W.A)(i)),items:s,availableUsers:r,currentPage:n+1,isFirstLoading:0==s.length,isLoadingMore:!1,hasMore:0!==t.data.events.length}),e.state.items.length<25&&e.state.hasMore&&(o.length&&100==n||e.getMore())})).catch((function(t){e.setState({isFirstLoading:!1,isLoadingMore:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this.props.onlyMine,t=this.state,n=t.targetUsers,r=t.availableUsers;return(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",id:"activities",children:[(0,m.jsx)("div",{className:"cur-view-path",children:(0,m.jsxs)("ul",{className:"nav",children:[(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsx)(c.N_,{to:"".concat(h.Yc,"dashboard/"),className:"nav-link".concat(e?"":" active"),children:(0,h.AP)("All Activities")})}),(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsx)(c.N_,{to:"".concat(h.Yc,"my-activities/"),className:"nav-link".concat(e?" active":""),children:(0,h.AP)("My Activities")})})]})}),(0,m.jsxs)("div",{className:"cur-view-content d-block",onScroll:this.handleScroll,children:[this.state.isFirstLoading&&(0,m.jsx)($.A,{}),!this.state.isFirstLoading&&this.state.errorMsg&&(0,m.jsx)("p",{className:"error text-center",children:this.state.errorMsg}),!this.state.isFirstLoading&&(0,m.jsxs)(s.Fragment,{children:[!e&&(0,m.jsx)(ae,{availableUsers:r,currentSelectedUsers:n,setTargetUsers:this.setTargetUsers,toggleSelectUser:this.toggleSelectUser}),(0,m.jsx)(ie,{items:this.state.items,isLoadingMore:this.state.isLoadingMore})]})]})]})})}}])}(s.Component),le=se,ce=function(e){function t(){return(0,r.A)(this,t),(0,i.A)(this,t,arguments)}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return(0,m.jsx)(le,{onlyMine:!0})}}])}(s.Component),ue=ce,de=n(19260),pe=n(6030),he=n(68879),fe=function(e){function t(){return(0,r.A)(this,t),(0,i.A)(this,t,arguments)}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.data,t=e.loading,n=e.errorMsg,r=e.items;if(t)return(0,m.jsx)($.A,{});if(n)return(0,m.jsx)("p",{className:"error text-center",children:n});if(0===r.length)return(0,m.jsx)(J.A,{title:(0,h.AP)("No favorites"),text:(0,h.AP)("You have not added any libraries, folders or files to your favorites yet. A favorite gives you quick access to your most frequently used objects. You can add a library, folder or file to your favorites by clicking the star to the left of its name.")});var o=f.Aq.isDesktop();return(0,m.jsxs)("table",{className:"table-hover ".concat(o?"":"table-thead-hidden"),children:[o?(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"4%"}),(0,m.jsx)("th",{width:"40%",children:(0,h.AP)("Name")}),(0,m.jsx)("th",{width:"32%",children:(0,h.AP)("Library")}),(0,m.jsx)("th",{width:"18%",children:(0,h.AP)("Last Update")}),(0,m.jsx)("th",{width:"6%"})]})}):(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"12%"}),(0,m.jsx)("th",{width:"80%"}),(0,m.jsx)("th",{width:"8%"})]})}),(0,m.jsx)(me,{items:r,isDesktop:o})]})}}])}(s.Component),me=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).state={items:n.props.items},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.getThumbnails()}},{key:"getThumbnails",value:function(){var e=this.state.items.filter((function(e){return(f.Aq.imageCheck(e.obj_name)||h.Nz&&f.Aq.videoCheck(e.obj_name)||h.E7&&f.Aq.pdfCheck(e.obj_name))&&!e.repo_encrypted&&!e.encoded_thumbnail_src&&!e.deleted}));if(0!=e.length){var t=e.length,n=this,r=function(o){var i=e[o];k.e.createThumbnail(i.repo_id,i.path,48).then((function(e){i.encoded_thumbnail_src=e.data.encoded_thumbnail_src})).catch((function(e){})).then((function(){o<t-1?r(++o):n.setState({items:n.state.items})}))};r(0)}}},{key:"render",value:function(){var e=this.state.items.map((function(e,t){return"/"===e.path?e.item_icon_url=f.Aq.getDefaultLibIconUrl(!1):e.item_icon_url=e.is_dir?f.Aq.getFolderIconUrl(!1):f.Aq.getFileIconUrl(e.obj_name),e.encoded_path=f.Aq.encodePath(e.path),e.thumbnail_url=e.encoded_thumbnail_src?"".concat(h.Yc).concat(e.encoded_thumbnail_src):"",e.dirent_view_url=e.is_dir?"".concat(h.Yc,"library/").concat(e.repo_id,"/").concat(e.repo_name).concat(e.encoded_path):"".concat(h.Yc,"lib/").concat(e.repo_id,"/file").concat(e.encoded_path),"/"!==e.encoded_path&&(e.dirent_view_url=e.dirent_view_url.replace(/\/+$/,"")),e.mtime_relative=X()(e.mtime).fromNow(),(0,m.jsx)(ge,{data:e,isDesktop:this.props.isDesktop},t)}),this);return(0,m.jsx)("tbody",{children:e})}}])}(s.Component),ge=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).toggleOpMenu=function(){n.setState({isOpMenuOpen:!n.state.isOpMenuOpen})},n.handleMouseOver=function(){n.setState({showOpIcon:!0})},n.handleMouseOut=function(){n.setState({showOpIcon:!1})},n.unstar=function(e){e.preventDefault();var t=n.props.data;k.e.unstarItem(t.repo_id,t.path).then((function(e){n.setState({unstarred:!0})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.visitItem=function(){var e=n.props.data;e.is_dir?(0,c.oo)(e.dirent_view_url):window.open(e.dirent_view_url)},n.renderMobile=function(){var e=n.props.data,t=e.dirent_view_url;return(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{className:"text-center",onClick:n.visitItem,children:e.thumbnail_url?(0,m.jsx)("img",{className:"thumbnail",src:e.thumbnail_url,alt:""}):(0,m.jsx)("img",{src:e.item_icon_url,alt:(0,h.AP)("icon"),width:"24"})}),(0,m.jsxs)("td",{onClick:n.visitItem,children:[e.is_dir?(0,m.jsx)(c.N_,{to:t,children:e.obj_name}):(0,m.jsx)("a",{className:"normal",href:e.dirent_view_url,target:"_blank",rel:"noreferrer",children:e.obj_name}),(0,m.jsx)("br",{}),(0,m.jsx)("span",{className:"item-meta-info",children:e.repo_name}),(0,m.jsx)("span",{className:"item-meta-info",dangerouslySetInnerHTML:{__html:e.mtime_relative}})]}),(0,m.jsx)("td",{children:(0,m.jsxs)(de.A,{isOpen:n.state.isOpMenuOpen,toggle:n.toggleOpMenu,children:[(0,m.jsx)(pe.A,{tag:"i",className:"sf-dropdown-toggle sf3-font sf3-font-more-vertical ml-0",title:(0,h.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":n.state.isOpMenuOpen}),(0,m.jsxs)("div",{className:n.state.isOpMenuOpen?"":"d-none",onClick:n.toggleOpMenu,children:[(0,m.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),(0,m.jsx)("div",{className:"mobile-operation-menu",children:(0,m.jsx)(he.A,{className:"mobile-menu-item",onClick:n.unstar,children:(0,h.AP)("Unstar")})})]})]})})]})},n.renderDesktop=function(){var e=n.props.data,t="sf2-icon-x3 unstar action-icon";t+=n.state.showOpIcon?"":" invisible";var r=e.dirent_view_url;return(0,m.jsxs)("tr",{onMouseOver:n.handleMouseOver,onMouseOut:n.handleMouseOut,onFocus:n.handleMouseOver,children:[(0,m.jsx)("td",{className:"text-center",children:e.thumbnail_url?(0,m.jsx)("img",{className:"thumbnail",src:e.thumbnail_url,alt:""}):(0,m.jsx)("img",{src:e.item_icon_url,alt:(0,h.AP)("icon"),width:"24"})}),(0,m.jsx)(s.Fragment,{children:e.deleted?(0,m.jsxs)("td",{children:[e.obj_name," ",(0,m.jsx)("span",{style:{color:"red"},children:(0,h.AP)("deleted")})]}):(0,m.jsx)("td",{children:e.is_dir?(0,m.jsx)(c.N_,{to:r,children:e.obj_name}):(0,m.jsx)("a",{className:"normal",href:r,target:"_blank",rel:"noreferrer",children:e.obj_name})})}),(0,m.jsx)("td",{children:e.repo_name}),(0,m.jsx)("td",{dangerouslySetInnerHTML:{__html:e.mtime_relative}}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"#",role:"button",className:t,title:(0,h.AP)("Unstar"),"aria-label":(0,h.AP)("Unstar"),onClick:n.unstar})})]})},n.state={showOpIcon:!1,unstarred:!1,isOpMenuOpen:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return this.state.unstarred?null:this.props.isDesktop?this.renderDesktop():this.renderMobile()}}])}(s.Component),ve=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).state={loading:!0,errorMsg:"",items:[]},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;k.e.listStarredItems().then((function(t){e.setState({loading:!1,items:t.data.starred_item_list})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",id:"starred",children:[(0,m.jsx)("div",{className:"cur-view-path",children:(0,m.jsx)("h3",{className:"sf-heading",children:(0,h.AP)("Favorites")})}),(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsx)(fe,{data:this.state})})]})})}}])}(s.Component),ye=n(21870),xe=function(e){function t(){return(0,r.A)(this,t),(0,i.A)(this,t,arguments)}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.data,t=e.loading,n=e.errorMsg,r=e.items;if(t)return(0,m.jsx)("span",{className:"loading-icon loading-tip"});if(n)return(0,m.jsx)("p",{className:"error text-center",children:n});var o=(0,m.jsx)(J.A,{title:(0,h.AP)("No linked devices"),text:(0,h.AP)("You have not accessed your files with any client (desktop or mobile) yet. Configure clients on your devices to access your data more comfortably.")}),i=(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"13%",children:(0,h.AP)("Platform")}),(0,m.jsx)("th",{width:"30%",children:(0,h.AP)("Device Name")}),(0,m.jsx)("th",{width:"30%",children:(0,h.AP)("IP")}),(0,m.jsx)("th",{width:"17%",children:(0,h.AP)("Last Access")}),(0,m.jsx)("th",{width:"10%"})]})}),a=(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"92%"}),(0,m.jsx)("th",{width:"8%"})]})}),s=f.Aq.isDesktop();return r.length?(0,m.jsxs)("table",{className:"table-hover ".concat(s?"":"table-thead-hidden"),children:[s?i:a,(0,m.jsx)("tbody",{children:r.map((function(e,t){return(0,m.jsx)(Ae,{data:e,isDesktop:s},t)}))})]}):o}}])}(s.Component),Ae=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).toggleOpMenu=function(){n.setState({isOpMenuOpen:!n.state.isOpMenuOpen})},n.handleMouseOver=function(){n.setState({isOpIconShown:!0})},n.handleMouseOut=function(){n.setState({isOpIconShown:!1})},n.toggleDialog=function(){n.setState({isConfirmUnlinkDialogOpen:!n.state.isConfirmUnlinkDialogOpen})},n.handleClick=function(e){if(e.preventDefault(),n.props.data.is_desktop_client)n.toggleDialog();else{n.unlinkDevice(!0)}},n.unlinkDevice=function(e){var t=n.props.data;k.e.unlinkDevice(t.platform,t.device_id,e).then((function(e){n.setState({unlinked:!0});var r=(0,h.AP)("Successfully unlinked %(name)s.");r=r.replace("%(name)s",t.device_name),j.A.success(r)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.renderDesktopItem=function(){var e=n.props.data,t="sf3-font-delete1 sf3-font unlink-device action-icon";return t+=n.state.isOpIconShown?"":" invisible",(0,m.jsxs)("tr",{onMouseOver:n.handleMouseOver,onMouseOut:n.handleMouseOut,onFocus:n.handleMouseOver,children:[(0,m.jsx)("td",{children:e.platform}),(0,m.jsx)("td",{children:e.device_name}),(0,m.jsx)("td",{children:e.last_login_ip}),(0,m.jsx)("td",{children:X()(e.last_accessed).fromNow()}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"#",className:t,title:(0,h.AP)("Unlink"),role:"button","aria-label":(0,h.AP)("Unlink"),onClick:n.handleClick})})]})},n.renderMobileItem=function(){var e=n.props.data;return(0,m.jsxs)("tr",{children:[(0,m.jsxs)("td",{children:[e.device_name,(0,m.jsx)("br",{}),(0,m.jsx)("span",{className:"item-meta-info",children:e.last_login_ip}),(0,m.jsx)("span",{className:"item-meta-info",children:X()(e.last_accessed).fromNow()}),(0,m.jsx)("span",{className:"item-meta-info",children:e.platform})]}),(0,m.jsx)("td",{children:(0,m.jsxs)(de.A,{isOpen:n.state.isOpMenuOpen,toggle:n.toggleOpMenu,children:[(0,m.jsx)(pe.A,{tag:"i",className:"sf-dropdown-toggle sf3-font sf3-font-more-vertical ml-0",title:(0,h.AP)("More operations"),"aria-label":(0,h.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":n.state.isOpMenuOpen}),(0,m.jsxs)("div",{className:n.state.isOpMenuOpen?"":"d-none",onClick:n.toggleOpMenu,children:[(0,m.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),(0,m.jsx)("div",{className:"mobile-operation-menu",children:(0,m.jsx)(he.A,{className:"mobile-menu-item",onClick:n.handleClick,children:(0,h.AP)("Unlink")})})]})]})})]})},n.state={isOpMenuOpen:!1,isOpIconShown:!1,unlinked:!1,isConfirmUnlinkDialogOpen:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return this.state.unlinked?null:(0,m.jsxs)(s.Fragment,{children:[this.props.isDesktop?this.renderDesktopItem():this.renderMobileItem(),this.state.isConfirmUnlinkDialogOpen&&(0,m.jsx)(ye.A,{executeOperation:this.unlinkDevice,toggleDialog:this.toggleDialog})]})}}])}(s.Component),Ce=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).state={loading:!0,errorMsg:"",items:[]},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;k.e.listLinkedDevices().then((function(t){e.setState({loading:!1,items:t.data})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",id:"linked-devices",children:[(0,m.jsx)("div",{className:"cur-view-path",children:(0,m.jsx)("h3",{className:"sf-heading",children:(0,h.AP)("Linked Devices")})}),(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsx)(xe,{data:this.state})})]})})}}])}(s.Component),be=n(89470),we=(0,o.A)((function e(t){(0,r.A)(this,e),this.repo_id=t.repo_id,this.repo_name=t.repo_name,this.share_type=t.share_type,this.share_permission=t.share_permission,this.share_permission_name=t.share_permission_name,this.modifier_name=t.modifier_name,this.modifier_email=t.modifier_email,this.modifier_contact_email=t.modifier_contact_email,this.encrypted=t.encrypted,"personal"===this.share_type?(this.is_admin=t.is_admin,this.user_name=t.user_name,this.user_email=t.user_email,this.contact_email=t.contact_email):"group"===this.share_type&&(this.is_admin=t.is_admin,this.group_id=t.group_id,this.group_name=t.group_name)})),Se=n(17437),De=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).listCustomPermissions=function(){var e=n.props.repoID;k.e.listCustomPermissions(e).then((function(e){var t=e.data.permission_list.map((function(e){return new Se.A(e)}));n.setState({isLoading:!1,customPermissions:t})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t),n.setState({isLoading:!1})}))},n.switchOption=function(e){if(e.target.checked){var t=e.target.value;n.setState({currentOption:t}),n.props.changePerm(t),n.props.toggleDialog()}},n.translatePermission=function(e){var t=f.Aq.sharePerms(e);if(!t){var r=n.state.customPermissions.find((function(t){return t.id+""===e}));t=r&&r.name}return t},n.translateExplanation=function(e){var t=f.Aq.sharePermsExplanation(e);if(!t){var r=n.state.customPermissions.find((function(t){return t.id+""===e}));t=r&&r.description}return t},n.getPermissions=function(){var e=n.props.permissions.slice(),t=n.state.customPermissions;return n.customPermissions||(t.length>0&&t.forEach((function(t){e.push(t.id+"")})),n.customPermissions=e),n.customPermissions},n.state={isLoading:!0,currentOption:n.props.currentPerm,customPermissions:[]},n.customPermissions=null,n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.props.repoID?this.listCustomPermissions():this.setState({isLoading:!1})}},{key:"render",value:function(){var e=this,t=this.state,n=t.isLoading,r=t.currentOption,o=[];return n||(o=this.getPermissions()),(0,m.jsx)(p.A,{isOpen:!0,toggle:this.props.toggleDialog,children:(0,m.jsxs)(_.A,{style:{maxHeight:"400px",overflow:"auto"},children:[n&&(0,m.jsx)($.A,{}),!n&&o.map((function(t,n){return(0,m.jsxs)("div",{className:"d-flex",children:[(0,m.jsx)("input",{id:"option-".concat(n),className:"mt-1",type:"radio",name:"permission",value:t,checked:r==t,onChange:e.switchOption}),(0,m.jsxs)("label",{htmlFor:"option-".concat(n),className:"ml-2",children:[e.translatePermission(t),(0,m.jsx)("p",{className:"text-secondary small m-0",children:e.translateExplanation(t)})]})]},n)}))]})})}}])}(s.Component),ke=function(e){function t(){var e;(0,r.A)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=(0,i.A)(this,t,[].concat(o))).sortByName=function(t){t.preventDefault();var n="asc"==e.props.sortOrder?"desc":"asc";e.props.sortItems("name",n)},e}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg,r=e.items,o=e.sortBy,i=e.sortOrder;if(t)return(0,m.jsx)("span",{className:"loading-icon loading-tip"});if(n)return(0,m.jsx)("p",{className:"error text-center",children:n});var a=(0,m.jsx)(J.A,{title:(0,h.AP)("No libraries shared"),text:(0,h.AP)('You have not shared any libraries with other users yet. You can share a library with other users by clicking the share icon to the right of a library\'s name in "My Libraries".')}),s="name"==o,l="asc"==i?(0,m.jsx)("span",{className:"sf3-font sf3-font-down rotate-180 d-inline-block"}):(0,m.jsx)("span",{className:"sf3-font sf3-font-down"}),c=f.Aq.isDesktop(),u=(0,m.jsxs)("table",{className:"table-hover ".concat(c?"":"table-thead-hidden"),children:[(0,m.jsx)("thead",{children:c?(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"4%"}),(0,m.jsx)("th",{width:"34%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByName,children:[(0,h.AP)("Name")," ",s&&l]})}),(0,m.jsx)("th",{width:"30%",children:(0,h.AP)("Share To")}),(0,m.jsx)("th",{width:"24%",children:(0,h.AP)("Permission")}),(0,m.jsx)("th",{width:"8%"})]}):(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"12%"}),(0,m.jsx)("th",{width:"80%"}),(0,m.jsx)("th",{width:"8%"})]})}),(0,m.jsx)("tbody",{children:r.map((function(e,t){return(0,m.jsx)(Me,{isDesktop:c,item:e},t)}))})]});return r.length?u:a}}])}(s.Component),Me=function(e){function t(e){var n;(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).toggleOpMenu=function(){n.setState({isOpMenuOpen:!n.state.isOpMenuOpen})},n.togglePermSelectDialog=function(){n.setState({isPermSelectDialogOpen:!n.state.isPermSelectDialogOpen})},n.onMouseEnter=function(){n.setState({isOpIconShown:!0})},n.onMouseLeave=function(){n.setState({isOpIconShown:!1})},n.changePerm=function(e){var t=n.props.item,r=t.share_type,o={share_type:r,permission:e};"personal"==r?o.user=t.user_email:"group"==r&&(o.group_id=t.group_id),k.e.updateRepoSharePerm(t.repo_id,o).then((function(){n.setState({share_permission:"admin"==e?"rw":e,is_admin:"admin"==e}),j.A.success((0,h.AP)("Successfully modified permission."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.unshare=function(e){e.preventDefault();var t=n.props.item,r=t.share_type,o={share_type:r};"personal"==r?o.user=t.user_email:"group"==r&&(o.group_id=t.group_id),k.e.unshareRepo(t.repo_id,o).then((function(e){n.setState({unshared:!0});var r=(0,h.AP)("Successfully unshared {name}").replace("{name}",t.repo_name);j.A.success(r)})).catch((function(e){var t=f.Aq.getErrorMsg(e);(0,j.A)(t)}))},n.onEditPermission=function(e){e.nativeEvent.stopImmediatePropagation(),n.setState({isShowPermEditor:!0})};var o=n.props.item;n.state={share_permission:o.share_permission,share_permission_name:o.share_permission_name,is_admin:o.is_admin,isOpIconShown:!1,isOpMenuOpen:!1,isPermSelectDialogOpen:!1,unshared:!1,isShowPermEditor:!1};var a=["rw","r"];return n.permissions=a,n.showAdmin=h.am&&"public"!==o.share_type,n.showAdmin&&a.push("admin"),h.am&&a.push("cloud-edit","preview"),n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){if(this.state.unshared)return null;var e=this.state,t=e.share_permission,n=e.share_permission_name,r=e.is_admin,o=e.isOpIconShown,i=e.isPermSelectDialogOpen,a=e.isShowPermEditor,l=this.props.item;Object.assign(l,{share_permission:t,is_admin:r});var u,d=f.Aq.getLibIconUrl(l),p=f.Aq.getLibIconTitle(l),g="".concat(h.Yc,"library/").concat(l.repo_id,"/").concat(encodeURIComponent(l.repo_name),"/"),v=l.share_type;return"personal"==v?u=l.user_name:"group"==v?u=l.group_name:"public"==v&&(u=(0,h.AP)("all members")),this.showAdmin&&r&&(t="admin"),t.startsWith("custom-")&&(t=t.slice(7)),this.props.isDesktop?(0,m.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onFocus:this.onMouseEnter,children:[(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:d,title:p,alt:p,width:"24"})}),(0,m.jsx)("td",{children:(0,m.jsx)(c.N_,{to:g,children:l.repo_name})}),(0,m.jsx)("td",{children:"personal"==l.share_type?(0,m.jsx)("span",{title:l.contact_email,children:u}):u}),(0,m.jsxs)("td",{children:[!a&&(0,m.jsxs)("div",{children:[(0,m.jsx)("span",{children:f.Aq.sharePerms(t)||n}),o&&(0,m.jsx)("a",{href:"#",role:"button","aria-label":(0,h.AP)("Edit"),title:(0,h.AP)("Edit"),className:"sf3-font sf3-font-rename attr-action-icon",onClick:this.onEditPermission})]}),a&&(0,m.jsx)(be.A,{repoID:l.repo_id,isTextMode:!0,isEditing:!0,autoFocus:!0,isEditIconShow:this.state.isOpIconShown,currentPermission:t,permissions:this.permissions,onPermissionChanged:this.changePerm})]}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"#",role:"button","aria-label":(0,h.AP)("Unshare"),className:"action-icon sf2-icon-x3 ".concat(o?"":"invisible"),title:(0,h.AP)("Unshare"),onClick:this.unshare})})]}):(0,m.jsxs)(s.Fragment,{children:[(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:d,title:p,alt:p,width:"24"})}),(0,m.jsxs)("td",{children:[(0,m.jsx)(c.N_,{to:g,children:l.repo_name}),(0,m.jsx)("span",{className:"item-meta-info-highlighted",children:f.Aq.sharePerms(t)}),(0,m.jsx)("br",{}),(0,m.jsx)("span",{className:"item-meta-info",children:"".concat((0,h.AP)("Share To:")," ").concat(u)})]}),(0,m.jsx)("td",{children:(0,m.jsxs)(de.A,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu,children:[(0,m.jsx)(pe.A,{tag:"i",className:"sf-dropdown-toggle sf3-font sf3-font-more-vertical ml-0",title:(0,h.AP)("More operations"),"aria-label":(0,h.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),(0,m.jsxs)("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu,children:[(0,m.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),(0,m.jsxs)("div",{className:"mobile-operation-menu",children:[(0,m.jsx)(he.A,{className:"mobile-menu-item",onClick:this.togglePermSelectDialog,children:(0,h.AP)("Permission")}),(0,m.jsx)(he.A,{className:"mobile-menu-item",onClick:this.unshare,children:(0,h.AP)("Unshare")})]})]})]})})]}),i&&(0,m.jsx)(De,{repoID:l.repo_id,currentPerm:t,permissions:this.permissions,changePerm:this.changePerm,toggleDialog:this.togglePermSelectDialog})]})}}])}(s.Component),je=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).sortItems=function(e,t){n.setState({sortBy:e,sortOrder:t,items:f.Aq.sortRepos(n.state.items,e,t)})},n.state={loading:!0,errorMsg:"",items:[],sortBy:"name",sortOrder:"asc"},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;k.e.listSharedRepos().then((function(t){var n=t.data.map((function(e){return new we(e)}));e.setState({loading:!1,items:f.Aq.sortRepos(n,e.state.sortBy,e.state.sortOrder)})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",id:"share-admin-libs",children:[(0,m.jsx)("div",{className:"cur-view-path",children:(0,m.jsx)("h3",{className:"sf-heading",children:(0,h.AP)("Libraries")})}),(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsx)(ke,{errorMsg:this.state.errorMsg,loading:this.state.loading,items:this.state.items,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems})})]})})}}])}(s.Component),Ie=(0,o.A)((function e(t){(0,r.A)(this,e),this.path=t.path,this.folder_name=t.folder_name,this.repo_id=t.repo_id,this.repo_name=t.repo_name,this.share_type=t.share_type,this.share_permission=t.share_permission,this.share_permission_name=t.share_permission_name,"group"===t.share_type?(this.group_id=t.group_id,this.group_name=t.group_name):(this.user_name=t.user_name,this.user_email=t.user_email,this.contact_email=t.contact_email)})),_e=function(e){function t(){var e;(0,r.A)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=(0,i.A)(this,t,[].concat(o))).sortByName=function(t){t.preventDefault();var n="asc"==e.props.sortOrder?"desc":"asc";e.props.sortItems("name",n)},e}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg,r=e.items,o=e.sortBy,i=e.sortOrder;if(t)return(0,m.jsx)($.A,{});if(n)return(0,m.jsx)("p",{className:"error text-center",children:n});var a=(0,m.jsx)(J.A,{title:(0,h.AP)("No folders shared"),text:(0,h.AP)("You have not shared any folders with other users yet. You can share a folder with other users by clicking the share icon to the right of a folder's name.")}),s="name"==o,l="asc"==i?(0,m.jsx)("span",{className:"sf3-font sf3-font-down rotate-180 d-inline-block"}):(0,m.jsx)("span",{className:"sf3-font sf3-font-down"}),c=f.Aq.isDesktop(),u=(0,m.jsxs)("table",{className:"table-hover ".concat(c?"":"table-thead-hidden"),children:[(0,m.jsx)("thead",{children:c?(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"4%"}),(0,m.jsx)("th",{width:"34%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByName,children:[(0,h.AP)("Name")," ",s&&l]})}),(0,m.jsx)("th",{width:"30%",children:(0,h.AP)("Share To")}),(0,m.jsx)("th",{width:"24%",children:(0,h.AP)("Permission")}),(0,m.jsx)("th",{width:"8%"})]}):(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"12%"}),(0,m.jsx)("th",{width:"80%"}),(0,m.jsx)("th",{width:"8%"})]})}),(0,m.jsx)("tbody",{children:r.map((function(e,t){return(0,m.jsx)(Pe,{isDesktop:c,item:e},t)}))})]});return r.length?u:a}}])}(s.Component),Pe=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).toggleOpMenu=function(){n.setState({isOpMenuOpen:!n.state.isOpMenuOpen})},n.togglePermSelectDialog=function(){n.setState({isPermSelectDialogOpen:!n.state.isPermSelectDialogOpen})},n.onMouseEnter=function(){n.setState({isOpIconShown:!0})},n.onMouseLeave=function(){n.setState({isOpIconShown:!1})},n.unshare=function(e){e.preventDefault();var t=n.props.item,r={p:t.path};"personal"==t.share_type?Object.assign(r,{share_type:"user",username:t.user_email}):Object.assign(r,{share_type:t.share_type,group_id:t.group_id}),k.e.unshareFolder(t.repo_id,r).then((function(e){n.setState({unshared:!0});var r=(0,h.AP)("Successfully unshared {name}").replace("{name}",t.folder_name);j.A.success(r)})).catch((function(e){var t=f.Aq.getErrorMsg(e);(0,j.A)(t)}))},n.changePerm=function(e){var t=n.props.item,r={permission:e},o={p:t.path};"personal"==t.share_type?Object.assign(o,{share_type:"user",username:t.user_email}):Object.assign(o,{share_type:t.share_type,group_id:t.group_id}),k.e.updateFolderSharePerm(t.repo_id,r,o).then((function(t){n.setState({share_permission:e}),j.A.success((0,h.AP)("Successfully modified permission."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.onEditPermission=function(e){e.nativeEvent.stopImmediatePropagation(),n.setState({isShowPermEditor:!0})},n.state={share_permission:n.props.item.share_permission,share_permission_name:n.props.item.share_permission_name,isOpIconShown:!1,isOpMenuOpen:!1,isPermSelectDialogOpen:!1,unshared:!1,isShowPermEditor:!1},n.permissions=["rw","r"],h.am&&n.permissions.push("cloud-edit","preview"),n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){if(this.state.unshared)return null;var e=this.props.item,t=this.state,n=t.share_permission,r=t.share_permission_name,o=t.isOpIconShown,i=t.isPermSelectDialogOpen,a=t.isShowPermEditor,l=!1;"r"!=n&&"preview"!=n||(l=!0);var u=f.Aq.getFolderIconUrl(l),d=f.Aq.getFolderIconTitle({permission:n}),p="".concat(h.Yc,"library/").concat(e.repo_id,"/").concat(encodeURIComponent(e.repo_name)).concat(f.Aq.encodePath(e.path));return n.startsWith("custom-")&&(n=n.slice(7)),this.props.isDesktop?(0,m.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onFocus:this.onMouseEnter,children:[(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:u,title:d,alt:d,width:"24"})}),(0,m.jsx)("td",{children:(0,m.jsx)(c.N_,{to:p,children:e.folder_name})}),(0,m.jsx)("td",{children:"personal"==e.share_type?(0,m.jsx)("span",{title:e.contact_email,children:e.user_name}):e.group_name}),(0,m.jsxs)("td",{children:[!a&&(0,m.jsxs)("div",{children:[(0,m.jsx)("span",{children:f.Aq.sharePerms(n)||r}),o&&(0,m.jsx)("a",{href:"#",role:"button","aria-label":(0,h.AP)("Edit"),title:(0,h.AP)("Edit"),className:"sf3-font sf3-font-rename attr-action-icon",onClick:this.onEditPermission})]}),a&&(0,m.jsx)(be.A,{repoID:e.repo_id,isTextMode:!0,isEditIconShow:o,isEditing:!0,autoFocus:!0,currentPermission:n,permissions:this.permissions,onPermissionChanged:this.changePerm})]}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"#",role:"button","aria-label":(0,h.AP)("Unshare"),className:"action-icon sf2-icon-x3 ".concat(o?"":"invisible"),title:(0,h.AP)("Unshare"),onClick:this.unshare})})]}):(0,m.jsxs)(s.Fragment,{children:[(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:u,title:d,alt:d,width:"24"})}),(0,m.jsxs)("td",{children:[(0,m.jsx)(c.N_,{to:p,children:e.folder_name}),(0,m.jsx)("span",{className:"item-meta-info-highlighted",children:f.Aq.sharePerms(n)}),(0,m.jsx)("br",{}),(0,m.jsx)("span",{className:"item-meta-info",children:"".concat((0,h.AP)("Share To:")," ").concat("personal"==e.share_type?e.user_name:e.group_name)})]}),(0,m.jsx)("td",{children:(0,m.jsxs)(de.A,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu,children:[(0,m.jsx)(pe.A,{tag:"i",className:"sf-dropdown-toggle sf3-font sf3-font-more-vertical ml-0",title:(0,h.AP)("More operations"),"aria-label":(0,h.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),(0,m.jsxs)("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu,children:[(0,m.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),(0,m.jsxs)("div",{className:"mobile-operation-menu",children:[(0,m.jsx)(he.A,{className:"mobile-menu-item",onClick:this.togglePermSelectDialog,children:(0,h.AP)("Permission")}),(0,m.jsx)(he.A,{className:"mobile-menu-item",onClick:this.unshare,children:(0,h.AP)("Unshare")})]})]})]})})]}),i&&(0,m.jsx)(De,{repoID:e.repo_id,currentPerm:n,permissions:this.permissions,changePerm:this.changePerm,toggleDialog:this.togglePermSelectDialog})]})}}])}(s.Component),Ne=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e]))._sortItems=function(e,t,n){var r;switch("".concat(t,"-").concat(n)){case"name-asc":r=function(e,t){return f.Aq.compareTwoWord(e.folder_name,t.folder_name)};break;case"name-desc":r=function(e,t){return-f.Aq.compareTwoWord(e.folder_name,t.folder_name)}}return e.sort(r),e},n.sortItems=function(e,t){n.setState({sortBy:e,sortOrder:t,items:n._sortItems(n.state.items,e,t)})},n.state={loading:!0,errorMsg:"",items:[],sortBy:"name",sortOrder:"asc"},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;k.e.listSharedFolders().then((function(t){var n=t.data.map((function(e){return new Ie(e)}));e.setState({loading:!1,items:e._sortItems(n,e.state.sortBy,e.state.sortOrder)})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",id:"share-admin-libs",children:[(0,m.jsx)("div",{className:"cur-view-path",children:(0,m.jsx)("h3",{className:"sf-heading",children:(0,h.AP)("Folders")})}),(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsx)(_e,{errorMsg:this.state.errorMsg,loading:this.state.loading,items:this.state.items,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems})})]})})}}])}(s.Component),Oe=n(26548),Te=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).switchOption=function(e){if(e.target.checked){var t=e.target.value;n.setState({currentOption:t}),n.props.changePerm(t),n.props.toggleDialog()}},n.state={currentOption:n.props.currentPerm},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props.permissions,n=this.state.currentOption;return(0,m.jsx)(p.A,{isOpen:!0,toggle:this.props.toggleDialog,children:(0,m.jsx)(_.A,{children:t.map((function(t,r){return(0,m.jsxs)("div",{className:"d-flex",children:[(0,m.jsx)("input",{id:"option-".concat(r),className:"mt-1",type:"radio",name:"permission",value:t,checked:n==t,onChange:e.switchOption}),(0,m.jsx)("label",{htmlFor:"option-".concat(r),className:"ml-2",children:f.Aq.getShareLinkPermissionObject(t).text})]},r)}))})})}}])}(s.Component),Ee=n(91611),Re=function(e){function t(e){var n;(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).switchOption=function(e){if(e.target.checked){n.setState({currentOption:e.target.value});var t=e.target.value.split("-"),r=(0,F.A)(t,2),o=r[0],i=r[1];n.props.sortItems(o,i),n.props.toggleDialog()}},n.sortOptions=n.props.sortOptions||[{value:"name-asc",text:(0,h.AP)("By name ascending")},{value:"name-desc",text:(0,h.AP)("By name descending")},{value:"size-asc",text:(0,h.AP)("By size ascending")},{value:"size-desc",text:(0,h.AP)("By size descending")},{value:"time-asc",text:(0,h.AP)("By time ascending")},{value:"time-desc",text:(0,h.AP)("By time descending")}];var o=n.props,a=o.sortBy,s=o.sortOrder;return n.state={currentOption:"".concat(a,"-").concat(s)},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this;return(0,m.jsx)(p.A,{isOpen:!0,toggle:this.props.toggleDialog,children:(0,m.jsx)(_.A,{children:this.sortOptions.map((function(t,n){return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("input",{id:"option-".concat(n),className:"align-middle",type:"radio",name:"sort-option",value:t.value,checked:e.state.currentOption==t.value,onChange:e.switchOption}),(0,m.jsx)("label",{htmlFor:"option-".concat(n),className:"align-middle m-2",children:t.text}),(0,m.jsx)("br",{})]},n)}))})})}}])}(s.Component),Le=n(82487),Fe=n(66149),Ue=n(33151),Be=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).toggleDropdownMenu=function(){n.setState({isDropdownMenuOpen:!n.state.isDropdownMenuOpen})},n.onDropdownToggleKeyDown=function(e){"Enter"!=e.key&&"Space"!=e.key||n.toggleDropdownMenu()},n.onMenuItemKeyDown=function(e,t){"Enter"!=t.key&&"Space"!=t.key||e.onClick()},n.state={isDropdownMenuOpen:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props.opList;return(0,m.jsx)(s.Fragment,{children:(0,m.jsxs)(de.A,{isOpen:this.state.isDropdownMenuOpen,toggle:this.toggleDropdownMenu,children:[(0,m.jsx)(pe.A,{tag:"i",role:"button",className:"sf3-font-down sf3-font ml-1 sf-dropdown-toggle",onClick:this.toggleDropdownMenu,onKeyDown:this.onDropdownToggleKeyDown,"data-toggle":"dropdown"}),(0,m.jsx)(Ue.A,{children:t.map((function(t,n){return"Divider"==t?(0,m.jsx)(he.A,{divider:!0},n):(0,m.jsx)(he.A,{onClick:t.onClick,onKeyDown:e.onMenuItemKeyDown.bind(e,t),children:t.text},n)}))})]})})}}])}(s.Component),Ye=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).toggleItemFreezed=function(e){n.setState({isItemFreezed:e})},n.sortByName=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortItems("name",t)},n.sortByTime=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortItems("time",t)},n.state={isItemFreezed:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,o=t.items,i=t.sortBy,a=t.sortOrder;if(n)return(0,m.jsx)($.A,{});if(r)return(0,m.jsx)("p",{className:"error text-center",children:r});var s=(0,m.jsx)(J.A,{title:(0,h.AP)("No share links"),text:(0,h.AP)("You have not created any share links yet. A share link can be used to share files and folders with anyone. You can create a share link for a file or folder by clicking the share icon to the right of its name.")}),l="name"==i,c="time"==i,u="asc"==a?(0,m.jsx)("span",{className:"sf3-font sf3-font-down rotate-180 d-inline-block"}):(0,m.jsx)("span",{className:"sf3-font sf3-font-down"}),d=f.Aq.isDesktop(),p=h.am?["14%","7%","14%"]:["21%","14%","20%"],g=(0,m.jsxs)("table",{className:"".concat(d?"":"table-thead-hidden"),children:[(0,m.jsx)("thead",{children:d?(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"4%"}),(0,m.jsx)("th",{width:"31%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByName,children:[(0,h.AP)("Name")," ",l&&u]})}),(0,m.jsx)("th",{width:p[0],children:(0,h.AP)("Library")}),h.am&&(0,m.jsx)("th",{width:"20%",children:(0,h.AP)("Permission")}),(0,m.jsx)("th",{width:p[1],children:(0,h.AP)("Visits")}),(0,m.jsx)("th",{width:p[2],children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByTime,children:[(0,h.AP)("Expiration")," ",c&&u]})}),(0,m.jsx)("th",{width:"10%"})]}):(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"12%"}),(0,m.jsx)("th",{width:"80%"}),(0,m.jsx)("th",{width:"8%"})]})}),(0,m.jsx)("tbody",{children:o.map((function(t,n){return(0,m.jsx)(qe,{isDesktop:d,item:t,onRemoveLink:e.props.onRemoveLink,isItemFreezed:e.state.isItemFreezed,toggleItemFreezed:e.toggleItemFreezed},n)}))})]});return o.length?(0,m.jsxs)(m.Fragment,{children:[g,this.props.isLoadingMore&&(0,m.jsx)("div",{className:"flex-shrink-0",children:(0,m.jsx)($.A,{})})]}):s}}])}(s.Component),qe=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).updatePermissionOptions=function(){var e=n.props.item,t=e.is_dir?"/"===e.path?"library":"dir":"file",r=e.repo_folder_permission,o=f.Aq.getShareLinkPermissionList(t,r,e.path,e.can_edit),i=f.Aq.getShareLinkPermissionStr(n.props.item.permissions);n.setState({permissionOptions:o,currentPermission:i})},n.toggleOpMenu=function(){n.setState({isOpMenuOpen:!n.state.isOpMenuOpen})},n.togglePermSelectDialog=function(){n.setState({isPermSelectDialogOpen:!n.state.isPermSelectDialogOpen})},n.toggleLinkDialog=function(){n.setState({isLinkDialogOpen:!n.state.isLinkDialogOpen})},n.handleMouseEnter=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!0,highlight:!0})},n.handleMouseLeave=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!1,highlight:!1})},n.viewLink=function(e){e.preventDefault(),n.toggleLinkDialog()},n.removeLink=function(e){e.preventDefault(),n.props.onRemoveLink(n.props.item)},n.renderExpiration=function(){var e=n.props.item;if(!e.expire_date)return"--";var t=X()(e.expire_date).format("YYYY-MM-DD"),r=X()(e.expire_date).format("YYYY-MM-DD HH:mm:ss");return(0,m.jsx)("span",{className:e.is_expired?"error":"",title:r,children:t})},n.changePermission=function(e){n.changePerm(e.value)},n.changePerm=function(e){var t=n.props.item,r=f.Aq.getShareLinkPermissionObject(e).permissionDetails;k.e.updateShareLink(t.token,JSON.stringify(r)).then((function(){n.setState({currentPermission:e});var t=(0,h.AP)("Successfully modified permission.");j.A.success(t)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.state={highlight:!1,isOpIconShown:!1,isOpMenuOpen:!1,isPermSelectDialogOpen:!1,isLinkDialogOpen:!1,permissionOptions:[],currentPermission:""},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){h.am&&this.updatePermissionOptions()}},{key:"render",value:function(){var e=this.props.item,t=this.state,n=t.currentPermission,r=t.permissionOptions,o=t.isOpIconShown,i=t.isPermSelectDialogOpen,a=t.isLinkDialogOpen;this.permOptions=r.map((function(e){return{value:e,text:f.Aq.getShareLinkPermissionObject(e).text,isSelected:e==n}}));var l,u,d=this.permOptions.filter((function(e){return e.isSelected}))[0]||{};if(e.is_dir){var p="/"===e.path?"/":e.path.slice(0,e.path.length-1);l=f.Aq.getFolderIconUrl(!1),u="".concat(h.Yc,"library/").concat(e.repo_id,"/").concat(encodeURIComponent(e.repo_name)).concat(f.Aq.encodePath(p))}else l=f.Aq.getFileIconUrl(e.obj_name),u="".concat(h.Yc,"lib/").concat(e.repo_id,"/file").concat(f.Aq.encodePath(e.path));return(0,m.jsxs)(s.Fragment,{children:[this.props.isDesktop?(0,m.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onFocus:this.handleMouseEnter,children:[(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:l,width:"24",alt:""})}),(0,m.jsxs)("td",{children:[e.is_dir?(0,m.jsx)(c.N_,{to:u,children:e.obj_name}):(0,m.jsx)("a",{href:u,target:"_blank",rel:"noreferrer",children:e.obj_name}),""===e.obj_id?(0,m.jsx)("span",{style:{color:"red"},children:(0,h.AP)("(deleted)")}):null]}),(0,m.jsx)("td",{children:(0,m.jsx)(c.N_,{to:"".concat(h.Yc,"library/").concat(e.repo_id,"/").concat(encodeURIComponent(e.repo_name),"/"),children:e.repo_name})}),h.am&&(0,m.jsx)("td",{children:(0,m.jsx)(Fe.A,{isDropdownToggleShown:o&&!e.is_expired,currentSelectedOption:d,options:this.permOptions,selectOption:this.changePermission,toggleItemFreezed:this.props.toggleItemFreezed})}),(0,m.jsx)("td",{children:e.view_cnt}),(0,m.jsx)("td",{children:this.renderExpiration()}),(0,m.jsxs)("td",{children:[!e.is_expired&&(0,m.jsx)("a",{href:"#",className:"sf2-icon-link action-icon op-icon ".concat(o?"":"invisible"),title:(0,h.AP)("View"),"aria-label":(0,h.AP)("View"),role:"button",onClick:this.viewLink}),(0,m.jsx)("a",{href:"#",className:"sf3-font-delete1 sf3-font action-icon op-icon ".concat(o?"":"invisible"),title:(0,h.AP)("Remove"),"aria-label":(0,h.AP)("Remove"),role:"button",onClick:this.removeLink})]})]}):(0,m.jsxs)(s.Fragment,{children:[(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:l,alt:"",width:"24"})}),(0,m.jsxs)("td",{children:[e.is_dir?(0,m.jsx)(c.N_,{to:u,children:e.obj_name}):(0,m.jsx)("a",{href:u,target:"_blank",rel:"noreferrer",children:e.obj_name}),h.am&&(0,m.jsx)("span",{className:"item-meta-info-highlighted",children:f.Aq.getShareLinkPermissionObject(n).text}),(0,m.jsx)("br",{}),(0,m.jsx)("span",{children:e.repo_name}),(0,m.jsx)("br",{}),(0,m.jsxs)("span",{className:"item-meta-info",children:[(0,h.AP)("Visits"),": ",e.view_cnt]}),(0,m.jsxs)("span",{className:"item-meta-info",children:[(0,h.AP)("Expiration"),": ",this.renderExpiration()]})]}),(0,m.jsx)("td",{children:(0,m.jsxs)(de.A,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu,children:[(0,m.jsx)(pe.A,{tag:"i",className:"sf-dropdown-toggle sf3-font sf3-font-more-vertical ml-0",title:(0,h.AP)("More operations"),"aria-label":(0,h.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),(0,m.jsxs)("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu,children:[(0,m.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),(0,m.jsxs)("div",{className:"mobile-operation-menu",children:[h.am&&!e.is_expired&&(0,m.jsx)(he.A,{className:"mobile-menu-item",onClick:this.togglePermSelectDialog,children:(0,h.AP)("Permission")}),!e.is_expired&&(0,m.jsx)(he.A,{className:"mobile-menu-item",onClick:this.viewLink,children:(0,h.AP)("View")}),(0,m.jsx)(he.A,{className:"mobile-menu-item",onClick:this.removeLink,children:(0,h.AP)("Remove")})]})]})]})})]}),i&&(0,m.jsx)(Te,{currentPerm:n,permissions:r,changePerm:this.changePerm,toggleDialog:this.togglePermSelectDialog})]}),a&&(0,m.jsx)(Ee.A,{link:e.link,toggleDialog:this.toggleLinkDialog})]})}}])}(s.Component),He=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e]))._sortItems=function(e,t,n){var r;switch("".concat(t,"-").concat(n)){case"name-asc":r=function(e,t){return f.Aq.compareTwoWord(e.obj_name,t.obj_name)};break;case"name-desc":r=function(e,t){return-f.Aq.compareTwoWord(e.obj_name,t.obj_name)};break;case"time-asc":r=function(e,t){return e.expire_date<t.expire_date?-1:1};break;case"time-desc":r=function(e,t){return e.expire_date<t.expire_date?1:-1}}return e.sort((function(e,t){return e.is_dir&&!t.is_dir?-1:!e.is_dir&&t.is_dir?1:r(e,t)})),e},n.sortItems=function(e,t){n.setState({sortBy:e,sortOrder:t,items:n._sortItems(n.state.items,e,t)})},n.handleScroll=function(e){if(!n.state.isLoadingMore&&n.state.hasMore){var t=e.target.clientHeight,r=e.target.scrollHeight;t+e.target.scrollTop+1>=r&&n.setState({isLoadingMore:!0},(function(){n.getMore()}))}},n.getMore=function(){var e=n.state.page;k.e.listShareLinks({page:e+1}).then((function(t){var r=t.data.map((function(e){return new Oe.A(e)}));n.setState({isLoadingMore:!1,hasMore:25==t.data.length,page:e+1,items:n._sortItems(n.state.items.concat(r),n.state.sortBy,n.state.sortOrder)})})).catch((function(e){n.setState({isLoadingMore:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.onRemoveLink=function(e){k.e.deleteShareLink(e.token).then((function(){var t=n.state.items.filter((function(t){return t.token!==e.token}));n.setState({items:t});var r=(0,h.AP)("Successfully deleted 1 item.");j.A.success(r)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.toggleSortOptionsDialog=function(){n.setState({isSortOptionsDialogOpen:!n.state.isSortOptionsDialogOpen})},n.toggleCleanInvalidShareLinksDialog=function(){n.setState({isCleanInvalidShareLinksDialogOpen:!n.state.isCleanInvalidShareLinksDialogOpen})},n.cleanInvalidShareLinks=function(){k.e.cleanInvalidShareLinks().then((function(e){var t=n.state.items.filter((function(e){return""!==e.obj_id})).filter((function(e){return!e.is_expired}));n.setState({items:t}),j.A.success((0,h.AP)("Successfully cleaned invalid share links."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.state={isCleanInvalidShareLinksDialogOpen:!1,loading:!0,hasMore:!1,isLoadingMore:!1,page:1,errorMsg:"",items:[],sortBy:"name",sortOrder:"asc"},n.sortOptions=[{value:"name-asc",text:(0,h.AP)("By name ascending")},{value:"name-desc",text:(0,h.AP)("By name descending")},{value:"time-asc",text:(0,h.AP)("By expiration ascending")},{value:"time-desc",text:(0,h.AP)("By expiration descending")}],n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.listUserShareLinks()}},{key:"listUserShareLinks",value:function(){var e=this,t=this.state.page;k.e.listShareLinks({page:t}).then((function(t){var n=t.data.map((function(e){return new Oe.A(e)}));e.setState({loading:!1,hasMore:25==t.data.length,items:e._sortItems(n,e.state.sortBy,e.state.sortOrder)})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsxs)("div",{className:"cur-view-path share-upload-nav",children:[(0,m.jsxs)("ul",{className:"nav",children:[(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsxs)(c.N_,{to:"".concat(h.Yc,"share-admin-share-links/"),className:"nav-link active",children:[(0,h.AP)("Share Links"),(0,m.jsx)(Be,{opList:[{text:(0,h.AP)("Clean invalid share links"),onClick:this.toggleCleanInvalidShareLinksDialog}]})]})}),h.fY&&(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsx)(c.N_,{to:"".concat(h.Yc,"share-admin-upload-links/"),className:"nav-link",children:(0,h.AP)("Upload Links")})})]}),!f.Aq.isDesktop()&&this.state.items.length>0&&(0,m.jsx)("span",{className:"sf3-font sf3-font-sort action-icon",onClick:this.toggleSortOptionsDialog})]}),(0,m.jsx)("div",{className:"cur-view-content",onScroll:this.handleScroll,children:(0,m.jsx)(Ye,{loading:this.state.loading,isLoadingMore:this.state.isLoadingMore,errorMsg:this.state.errorMsg,items:this.state.items,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems,onRemoveLink:this.onRemoveLink})})]})}),this.state.isSortOptionsDialogOpen&&(0,m.jsx)(Re,{toggleDialog:this.toggleSortOptionsDialog,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortOptions:this.sortOptions,sortItems:this.sortItems}),this.state.isCleanInvalidShareLinksDialogOpen&&(0,m.jsx)(Le.A,{title:(0,h.AP)("Clean invalid share links"),message:(0,h.AP)("Are you sure you want to clean invalid share links?"),executeOperation:this.cleanInvalidShareLinks,confirmBtnText:(0,h.AP)("Clean"),toggleDialog:this.toggleCleanInvalidShareLinksDialog})]})}}])}(s.Component),Ge=n(8576),ze=function(e){function t(){return(0,r.A)(this,t),(0,i.A)(this,t,arguments)}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,o=t.items;if(n)return(0,m.jsx)($.A,{});if(r)return(0,m.jsx)("p",{className:"error text-center",children:r});var i=(0,m.jsx)(J.A,{title:(0,h.AP)("No upload links"),text:(0,h.AP)("You have not created any upload links yet. An upload link allows anyone to upload files to a folder or library. You can create an upload link for a folder or library by clicking the share icon to the right of its name.")}),a=f.Aq.isDesktop(),s=(0,m.jsxs)("table",{className:"table-hover ".concat(a?"":"table-thead-hidden"),children:[(0,m.jsx)("thead",{children:a?(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"4%"}),(0,m.jsx)("th",{width:"30%",children:(0,h.AP)("Name")}),(0,m.jsx)("th",{width:"24%",children:(0,h.AP)("Library")}),(0,m.jsx)("th",{width:"16%",children:(0,h.AP)("Visits")}),(0,m.jsx)("th",{width:"16%",children:(0,h.AP)("Expiration")}),(0,m.jsx)("th",{width:"10%"})]}):(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"12%"}),(0,m.jsx)("th",{width:"80%"}),(0,m.jsx)("th",{width:"8%"})]})}),(0,m.jsx)("tbody",{children:o.map((function(t,n){return(0,m.jsx)(Ve,{isDesktop:a,item:t,onRemoveLink:e.props.onRemoveLink},n)}))})]});return o.length?s:i}}])}(s.Component),Ve=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).toggleOpMenu=function(){n.setState({isOpMenuOpen:!n.state.isOpMenuOpen})},n.toggleLinkDialog=function(){n.setState({isLinkDialogOpen:!n.state.isLinkDialogOpen})},n.handleMouseOver=function(){n.setState({isOpIconShown:!0})},n.handleMouseOut=function(){n.setState({isOpIconShown:!1})},n.viewLink=function(e){e.preventDefault(),n.toggleLinkDialog()},n.removeLink=function(e){e.preventDefault(),n.props.onRemoveLink(n.props.item)},n.renderExpiration=function(){var e=n.props.item;if(!e.expire_date)return"--";var t=X()(e.expire_date).format("YYYY-MM-DD"),r=X()(e.expire_date).format("YYYY-MM-DD HH:mm:ss");return(0,m.jsx)("span",{className:e.is_expired?"error":"",title:r,children:t})},n.state={isOpIconShown:!1,isOpMenuOpen:!1,isLinkDialogOpen:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.item,t=this.state,n=t.isOpIconShown,r=t.isLinkDialogOpen,o=f.Aq.getFolderIconUrl(!1),i="".concat(h.Yc,"library/").concat(e.repo_id,"/").concat(encodeURIComponent(e.repo_name)),a="".concat(i).concat(f.Aq.encodePath(e.path));return(0,m.jsxs)(s.Fragment,{children:[this.props.isDesktop?(0,m.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:o,alt:"",width:"24"})}),(0,m.jsxs)("td",{children:[(0,m.jsx)(c.N_,{to:a,children:e.obj_name}),""===e.obj_id?(0,m.jsx)("span",{style:{color:"red"},children:(0,h.AP)("(deleted)")}):null]}),(0,m.jsx)("td",{children:(0,m.jsx)(c.N_,{to:i,children:e.repo_name})}),(0,m.jsx)("td",{children:e.view_cnt}),(0,m.jsx)("td",{children:this.renderExpiration()}),(0,m.jsxs)("td",{children:[!e.is_expired&&(0,m.jsx)("a",{href:"#",className:"sf2-icon-link action-icon op-icon ".concat(n?"":"invisible"),title:(0,h.AP)("View"),"aria-label":(0,h.AP)("View"),role:"button",onClick:this.viewLink}),(0,m.jsx)("a",{href:"#",className:"sf3-font-delete1 sf3-font action-icon op-icon ".concat(n?"":"invisible"),title:(0,h.AP)("Remove"),"aria-label":(0,h.AP)("Remove"),role:"button",onClick:this.removeLink})]})]}):(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:o,alt:"",width:"24"})}),(0,m.jsxs)("td",{children:[(0,m.jsx)(c.N_,{to:a,children:e.obj_name}),(0,m.jsx)("br",{}),(0,m.jsx)("span",{children:e.repo_name}),(0,m.jsx)("br",{}),(0,m.jsxs)("span",{className:"item-meta-info",children:[(0,h.AP)("Visits"),": ",e.view_cnt]}),(0,m.jsxs)("span",{className:"item-meta-info",children:[(0,h.AP)("Expiration"),": ",this.renderExpiration()]})]}),(0,m.jsx)("td",{children:(0,m.jsxs)(de.A,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu,children:[(0,m.jsx)(pe.A,{tag:"i",className:"sf-dropdown-toggle sf3-font sf3-font-more-vertical ml-0",title:(0,h.AP)("More operations"),"aria-label":(0,h.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),(0,m.jsxs)("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu,children:[(0,m.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),(0,m.jsxs)("div",{className:"mobile-operation-menu",children:[!e.is_expired&&(0,m.jsx)(he.A,{className:"mobile-menu-item",onClick:this.viewLink,children:(0,h.AP)("View")}),(0,m.jsx)(he.A,{className:"mobile-menu-item",onClick:this.removeLink,children:(0,h.AP)("Remove")})]})]})]})})]}),r&&(0,m.jsx)(Ee.A,{link:e.link,toggleDialog:this.toggleLinkDialog})]})}}])}(s.Component),We=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onRemoveLink=function(e){k.e.deleteUploadLink(e.token).then((function(){var t=n.state.items.filter((function(t){return t.token!==e.token}));n.setState({items:t});var r=(0,h.AP)("Successfully deleted 1 item.");j.A.success(r)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.toggleCleanInvalidUploadLinksDialog=function(){n.setState({isCleanInvalidUploadLinksDialogOpen:!n.state.isCleanInvalidUploadLinksDialogOpen})},n.cleanInvalidUploadLinks=function(){k.e.cleanInvalidUploadLinks().then((function(e){var t=n.state.items.filter((function(e){return""!==e.obj_id})).filter((function(e){return!e.is_expired}));n.setState({items:t}),j.A.success((0,h.AP)("Successfully cleaned invalid upload links."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.state={isCleanInvalidUploadLinksDialogOpen:!1,loading:!0,errorMsg:"",items:[]},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.listUserUploadLinks()}},{key:"listUserUploadLinks",value:function(){var e=this;k.e.listUserUploadLinks().then((function(t){var n=t.data.map((function(e){return new Ge.A(e)}));e.setState({loading:!1,items:n})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)("div",{className:"cur-view-path share-upload-nav",children:(0,m.jsxs)("ul",{className:"nav",children:[h.zn&&(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsx)(c.N_,{to:"".concat(h.Yc,"share-admin-share-links/"),className:"nav-link",children:(0,h.AP)("Share Links")})}),(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsxs)(c.N_,{to:"".concat(h.Yc,"share-admin-upload-links/"),className:"nav-link active",children:[(0,h.AP)("Upload Links"),(0,m.jsx)(Be,{opList:[{text:(0,h.AP)("Clean invalid upload links"),onClick:this.toggleCleanInvalidUploadLinksDialog}]})]})})]})}),(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsx)(ze,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.items,onRemoveLink:this.onRemoveLink})})]})}),this.state.isCleanInvalidUploadLinksDialogOpen&&(0,m.jsx)(Le.A,{title:(0,h.AP)("Clean invalid upload links"),message:(0,h.AP)("Are you sure you want to clean invalid upload links?"),executeOperation:this.cleanInvalidUploadLinks,confirmBtnText:(0,h.AP)("Clean"),toggleDialog:this.toggleCleanInvalidUploadLinksDialog})]})}}])}(s.Component),Ke=n(58801),Xe=(0,o.A)((function e(t){(0,r.A)(this,e),this.repo_id=t.repo_id,this.repo_name=t.repo_name,this.repo_type=t.repo_type,this.permission=t.permission,this.size_original=t.size,this.size=f.Aq.bytesToSize(t.size),this.owner_name=t.owner_name,this.owner_email=t.owner_email,this.owner_contact_email=t.owner_contact_email,this.owner_avatar=t.owner_avatar||"",this.encrypted=t.encrypted,this.last_modified=t.last_modified,this.modifier_contact_email=t.modifier_contact_email,this.modifier_email=t.modifier_email,this.modifier_name=t.modifier_name,this.modifier_avatar=t.modifier_avatar,this.type=t.type,this.starred=t.starred,this.monitored=t.monitored,this.status=t.status,this.storage_name=t.storage_name,void 0!=t.is_admin&&(this.is_admin=t.is_admin),this.file_count=t.file_count||0,this.has_been_shared_out=t.has_been_shared_out,this.is_virtual=t.is_virtual,this.lib_need_decrypt=t.lib_need_decrypt,this.no_quota=t.no_quota})),$e=function(e){function t(){return(0,r.A)(this,t),(0,i.A)(this,t,arguments)}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.inAllLibs,t=void 0!==e&&e?["14%","78%","8%"]:["12%","80%","8%"];return(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:t[0],children:(0,m.jsx)("span",{className:"sr-only",children:(0,h.AP)("Library Type")})}),(0,m.jsx)("th",{width:t[1]}),(0,m.jsx)("th",{width:t[2],children:(0,m.jsx)("span",{className:"sr-only",children:(0,h.AP)("Actions")})})]})})}}])}(s.Component),Ze=$e,Je=n(88134),Qe=n(78297),et=function(e){function t(){return(0,r.A)(this,t),(0,i.A)(this,t,arguments)}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.repoID,n=e.className;return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("i",{id:"watching-".concat(t),className:"sf3-font-monitor sf3-font ".concat(n||"")}),(0,m.jsx)(Qe.A,{placement:"bottom",target:"#watching-".concat(t),children:(0,h.AP)("You are watching file changes of this library.")})]})}}])}(s.Component),tt=et,nt=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).freezeItem=function(e){n.setState({isItemFreezed:e})},n.sortByName=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortItems("name",t)},n.sortByTime=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortItems("time",t)},n.sortBySize=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortItems("size",t)},n.state={isItemFreezed:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,o=t.items,i=t.sortBy,a=t.sortOrder,s=t.theadHidden,l=t.inAllLibs,c=t.currentViewMode,u=l?(0,m.jsx)("p",{className:"libraries-empty-tip-in-".concat(c,"-mode"),children:(0,h.AP)("No shared libraries")}):(0,m.jsx)(J.A,{title:(0,h.AP)("No shared libraries"),text:(0,h.AP)("No libraries have been shared directly with you. A shared library can be shared with full or restricted permission. If you need access to a library owned by another user, ask the user to share the library with you.")});if(n)return(0,m.jsx)($.A,{});if(r)return(0,m.jsx)("p",{className:"error text-center",children:r});var d="name"==i,p="time"==i,g="size"==i,v="asc"==a?(0,m.jsx)("span",{className:"sf3-font sf3-font-down rotate-180 d-inline-block"}):(0,m.jsx)("span",{className:"sf3-font sf3-font-down"}),y=(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"4%"}),(0,m.jsx)("th",{width:"3%",children:(0,m.jsx)("span",{className:"sr-only",children:(0,h.AP)("Library Type")})}),(0,m.jsx)("th",{width:"35%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByName,children:[(0,h.AP)("Name")," ",d&&v]})}),(0,m.jsx)("th",{width:"10%",children:(0,m.jsx)("span",{className:"sr-only",children:(0,h.AP)("Actions")})}),(0,m.jsx)("th",{width:"14%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortBySize,children:[(0,h.AP)("Size")," ",g&&v]})}),(0,m.jsx)("th",{width:"17%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByTime,children:[(0,h.AP)("Last Update")," ",p&&v]})}),(0,m.jsx)("th",{width:"17%",children:(0,h.AP)("Owner")})]})}),x=f.Aq.isDesktop(),A=(0,m.jsx)(m.Fragment,{children:o.map((function(t,n){return(0,m.jsx)(rt,{data:t,isDesktop:x,isItemFreezed:e.state.isItemFreezed,freezeItem:e.freezeItem,onMonitorRepo:e.props.onMonitorRepo,currentViewMode:c},n)}))}),C="list"==c?(0,m.jsxs)("table",{className:x&&!s?"":"table-thead-hidden",children:[x?y:(0,m.jsx)(Ze,{inAllLibs:l}),(0,m.jsx)("tbody",{children:A})]}):(0,m.jsx)("div",{className:"d-flex justify-content-between flex-wrap",children:A});return o.length?C:u}}])}(s.Component),rt=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).toggleOpMenu=function(){n.setState({isOpMenuOpen:!n.state.isOpMenuOpen},(function(){n.props.freezeItem(n.state.isOpMenuOpen)}))},n.handleMouseOver=function(){n.props.isItemFreezed||n.setState({highlight:!0,showOpIcon:!0})},n.handleMouseOut=function(){n.props.isItemFreezed||n.setState({highlight:!1,showOpIcon:!1})},n.share=function(e){e.preventDefault(),n.setState({isShowSharedDialog:!0})},n.leaveShare=function(e){e.preventDefault();var t,r=n.props.data;if(-1==r.owner_email.indexOf("@seafile_group")){var o={share_type:"personal",from:r.owner_email};t=k.e.leaveShareRepo(r.repo_id,o)}else t=k.e.leaveShareGroupOwnedRepo(r.repo_id);t.then((function(e){n.setState({unshared:!0});var t=(0,h.AP)("Successfully unshared {name}").replace("{name}",r.repo_name);j.A.success(t)})).catch((function(e){var t=f.Aq.getErrorMsg(e);t===(0,h.AP)("Error")&&(t=(0,h.AP)("Failed to unshare {name}").replace("{name}",r.repo_name)),(0,j.A)(t)}))},n.toggleShareDialog=function(){n.setState({isShowSharedDialog:!1})},n.onToggleStarRepo=function(e){e.preventDefault();var t=n.props.data.repo_name;n.state.isStarred?k.e.unstarItem(n.props.data.repo_id,"/").then((function(){n.setState({isStarred:!n.state.isStarred});var e=(0,h.AP)("Successfully unstarred {library_name_placeholder}.").replace("{library_name_placeholder}",t);j.A.success(e)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)})):k.e.starItem(n.props.data.repo_id,"/").then((function(){n.setState({isStarred:!n.state.isStarred});var e=(0,h.AP)("Successfully starred {library_name_placeholder}.").replace("{library_name_placeholder}",t);j.A.success(e)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.visitRepo=function(){(0,c.oo)(n.repoURL)},n.watchFileChanges=function(){var e=n.props.data;k.e.monitorRepo(e.repo_id).then((function(){n.props.onMonitorRepo(e,!0)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.unwatchFileChanges=function(){var e=n.props.data;k.e.unMonitorRepo(e.repo_id).then((function(){n.props.onMonitorRepo(e,!1)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.state={highlight:!1,showOpIcon:!1,unshared:!1,isShowSharedDialog:!1,isStarred:n.props.data.starred,isOpMenuOpen:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){if(this.state.unshared)return null;var e=this.state.isStarred,t=this.props,n=t.data,r=t.currentViewMode,o=void 0===r?"list":r,i="grid"==o;n.icon_url=f.Aq.getLibIconUrl(n,i),n.icon_title=f.Aq.getLibIconTitle(n);var a=this.state.showOpIcon?"":" invisible",l="op-icon sf3-font-share sf3-font repo-share-btn"+a,u="op-icon sf2-icon-x3"+a,d=this.repoURL="".concat(h.Yc,"library/").concat(n.repo_id,"/").concat(f.Aq.encodePath(n.repo_name),"/"),p=h.am&&("r"==n.permission||"rw"==n.permission);return this.props.isDesktop?(0,m.jsxs)(s.Fragment,{children:["list"==o?(0,m.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[(0,m.jsx)("td",{className:"text-center",children:(0,m.jsx)("i",{role:"button",title:this.state.isStarred?(0,h.AP)("Unstar"):(0,h.AP)("Star"),"aria-label":this.state.isStarred?(0,h.AP)("Unstar"):(0,h.AP)("Star"),onClick:this.onToggleStarRepo,className:"op-icon m-0 ".concat(this.state.isStarred?"sf3-font-star":"sf3-font-star-empty"," sf3-font")})}),(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:n.icon_url,title:n.icon_title,alt:n.icon_title,width:"24"})}),(0,m.jsx)("td",{children:(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)(c.N_,{to:d,children:n.repo_name}),n.monitored&&(0,m.jsx)(tt,{repoID:n.repo_id,className:"ml-1 op-icon"})]})}),(0,m.jsxs)("td",{children:[h.am&&n.is_admin&&(0,m.jsx)("a",{href:"#",className:l,title:(0,h.AP)("Share"),role:"button","aria-label":(0,h.AP)("Share"),onClick:this.share}),(0,m.jsx)("a",{href:"#",className:u,title:(0,h.AP)("Leave Share"),role:"button","aria-label":(0,h.AP)("Leave Share"),onClick:this.leaveShare}),p&&(0,m.jsxs)(de.A,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu,children:[(0,m.jsx)(pe.A,{tag:"i",role:"button",tabIndex:"0",className:"sf-dropdown-toggle sf3-font-more sf3-font ".concat(a),title:(0,h.AP)("More operations"),"aria-label":(0,h.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),(0,m.jsx)(Ue.A,{children:(0,m.jsx)(he.A,{onClick:n.monitored?this.unwatchFileChanges:this.watchFileChanges,children:n.monitored?(0,h.AP)("Unwatch File Changes"):(0,h.AP)("Watch File Changes")})})]})]}),(0,m.jsx)("td",{children:n.size}),(0,m.jsx)("td",{title:X()(n.last_modified).format("llll"),children:X()(n.last_modified).fromNow()}),(0,m.jsx)("td",{title:n.owner_contact_email,children:n.owner_name})]}):(0,m.jsxs)("div",{className:"library-grid-item px-3 d-flex justify-content-between align-items-center",onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[(0,m.jsxs)("div",{className:"d-flex align-items-center text-truncate",children:[(0,m.jsx)("img",{src:n.icon_url,title:n.icon_title,alt:n.icon_title,width:"36",className:"mr-2"}),(0,m.jsx)(c.N_,{to:d,className:"text-truncate library-name",title:n.repo_name,children:n.repo_name}),e&&(0,m.jsx)("i",{role:"button",title:(0,h.AP)("Unstar"),"aria-label":(0,h.AP)("Unstar"),onClick:this.onToggleStarRepo,className:"op-icon library-grid-item-icon sf3-font-star sf3-font"}),n.monitored&&(0,m.jsx)(tt,{repoID:n.repo_id,className:"op-icon library-grid-item-icon"})]}),(0,m.jsxs)("div",{className:"flex-shrink-0",children:[h.am&&n.is_admin&&(0,m.jsx)("a",{href:"#",className:l,title:(0,h.AP)("Share"),role:"button","aria-label":(0,h.AP)("Share"),onClick:this.share}),(0,m.jsx)("a",{href:"#",className:u,title:(0,h.AP)("Leave Share"),role:"button","aria-label":(0,h.AP)("Leave Share"),onClick:this.leaveShare}),p&&(0,m.jsxs)(de.A,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu,children:[(0,m.jsx)(pe.A,{tag:"i",role:"button",tabIndex:"0",className:"sf-dropdown-toggle sf3-font-more sf3-font ".concat(a),title:(0,h.AP)("More operations"),"aria-label":(0,h.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),(0,m.jsx)(Ue.A,{children:(0,m.jsx)(he.A,{onClick:n.monitored?this.unwatchFileChanges:this.watchFileChanges,children:n.monitored?(0,h.AP)("Unwatch File Changes"):(0,h.AP)("Watch File Changes")})})]})]})]}),this.state.isShowSharedDialog&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(Je.A,{itemType:"library",itemName:n.repo_name,itemPath:"/",repoID:n.repo_id,repoEncrypted:n.encrypted,enableDirPrivateShare:!0,userPerm:n.permission,isAdmin:!0,toggleDialog:this.toggleShareDialog})})]}):(0,m.jsxs)(s.Fragment,{children:[(0,m.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,children:[(0,m.jsx)("td",{onClick:this.visitRepo,children:(0,m.jsx)("img",{src:n.icon_url,title:n.icon_title,alt:n.icon_title,width:"24"})}),(0,m.jsxs)("td",{onClick:this.visitRepo,children:[(0,m.jsx)(c.N_,{to:d,children:n.repo_name}),n.monitored&&(0,m.jsx)(tt,{repoID:n.repo_id,className:"ml-1 op-icon"}),(0,m.jsx)("br",{}),(0,m.jsx)("span",{className:"item-meta-info",title:n.owner_contact_email,children:n.owner_name}),(0,m.jsx)("span",{className:"item-meta-info",children:n.size}),(0,m.jsx)("span",{className:"item-meta-info",title:X()(n.last_modified).format("llll"),children:X()(n.last_modified).fromNow()})]}),(0,m.jsx)("td",{children:(0,m.jsxs)(de.A,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu,children:[(0,m.jsx)(pe.A,{tag:"i",className:"sf-dropdown-toggle sf3-font sf3-font-more-vertical ml-0",title:(0,h.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),(0,m.jsxs)("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu,children:[(0,m.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),(0,m.jsxs)("div",{className:"mobile-operation-menu",children:[(0,m.jsx)(he.A,{className:"mobile-menu-item",onClick:this.onToggleStarRepo,children:this.state.isStarred?(0,h.AP)("Unstar"):(0,h.AP)("Star")}),h.am&&n.is_admin&&(0,m.jsx)(he.A,{className:"mobile-menu-item",onClick:this.share,children:(0,h.AP)("Share")}),(0,m.jsx)(he.A,{className:"mobile-menu-item",onClick:this.leaveShare,children:(0,h.AP)("Leave Share")}),p&&(0,m.jsx)(he.A,{className:"mobile-menu-item",onClick:n.monitored?this.unwatchFileChanges:this.watchFileChanges,children:n.monitored?(0,h.AP)("Unwatch File Changes"):(0,h.AP)("Watch File Changes")})]})]})]})})]}),this.state.isShowSharedDialog&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(Je.A,{itemType:"library",itemName:n.repo_name,itemPath:"/",repoID:n.repo_id,repoEncrypted:n.encrypted,enableDirPrivateShare:!0,userPerm:n.permission,isAdmin:!0,toggleDialog:this.toggleShareDialog})})]})}}])}(s.Component),ot=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).sortItems=function(e,t){Ke.Ay.save("seafile-repo-dir-sort-by",e),Ke.Ay.save("seafile-repo-dir-sort-order",t),n.setState({sortBy:e,sortOrder:t,items:f.Aq.sortRepos(n.state.items,e,t)})},n.toggleSortOptionsDialog=function(){n.setState({isSortOptionsDialogOpen:!n.state.isSortOptionsDialogOpen})},n.onMonitorRepo=function(e,t){var r=n.state.items.map((function(n){return n.repo_id===e.repo_id&&(n.monitored=t),n}));n.setState({items:r})},n.renderContent=function(){var e=n.props,t=e.inAllLibs,r=void 0!==t&&t,o=e.currentViewMode,i=void 0===o?"list":o,a=e.repoList,s=n.state.items;return(0,m.jsx)(nt,{loading:n.state.loading,errorMsg:n.state.errorMsg,items:r?a:s,sortBy:n.state.sortBy,sortOrder:n.state.sortOrder,sortItems:n.sortItems,onMonitorRepo:n.onMonitorRepo,theadHidden:r,inAllLibs:r,currentViewMode:i})},n.renderSortIconInMobile=function(){return(0,m.jsx)(m.Fragment,{children:!f.Aq.isDesktop()&&n.state.items.length>0&&(0,m.jsx)("span",{className:"sf3-font sf3-font-sort action-icon",onClick:n.toggleSortOptionsDialog})})},n.state={loading:!0,errorMsg:"",items:[],sortBy:Ke.Ay.load("seafile-repo-dir-sort-by")||"name",sortOrder:Ke.Ay.load("seafile-repo-dir-sort-order")||"asc",isSortOptionsDialogOpen:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.repoList?this.setState({loading:!1,items:this.props.repoList}):k.e.listRepos({type:"shared"}).then((function(t){var n=t.data.repos.map((function(e){return new Xe(e)}));e.setState({loading:!1,items:f.Aq.sortRepos(n,e.state.sortBy,e.state.sortOrder)})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this.props,t=e.inAllLibs,n=void 0!==t&&t,r=e.currentViewMode,o=void 0===r?"list":r;return(0,m.jsxs)(s.Fragment,{children:[n?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{className:"d-flex justify-content-between mt-3 py-1 ".concat("list"==o?"sf-border-bottom":""),children:[(0,m.jsxs)("h4",{className:"sf-heading m-0",children:[(0,m.jsx)("span",{className:"sf3-font-share-with-me sf3-font nav-icon","aria-hidden":"true"}),(0,h.AP)("Shared with me")]}),this.renderSortIconInMobile()]}),this.renderContent()]}):(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsxs)("div",{className:"cur-view-path",children:[(0,m.jsx)("h3",{className:"sf-heading m-0",children:(0,h.AP)("Shared with me")}),this.renderSortIconInMobile()]}),(0,m.jsx)("div",{className:"cur-view-content",children:this.renderContent()})]})}),this.state.isSortOptionsDialogOpen&&(0,m.jsx)(Re,{toggleDialog:this.toggleSortOptionsDialog,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems})]})}}])}(s.Component),it=function(e){function t(){return(0,r.A)(this,t),(0,i.A)(this,t,arguments)}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,o=t.items,i=(0,m.jsx)(J.A,{title:(0,h.AP)("No libraries have been shared with you"),text:(0,h.AP)("No libraries have been shared with you from other servers.")});if(n)return(0,m.jsx)($.A,{});if(r)return(0,m.jsx)("p",{className:"error text-center",children:r});var a=(0,m.jsxs)("table",{children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"4%"}),(0,m.jsx)("th",{width:"20%",children:(0,h.AP)("Name")}),(0,m.jsx)("th",{width:"20%",children:(0,h.AP)("Shared by")}),(0,m.jsx)("th",{width:"26%",children:(0,h.AP)("At server")}),(0,m.jsx)("th",{width:"20%",children:(0,h.AP)("Time")}),(0,m.jsx)("th",{width:"10%"})]})}),(0,m.jsx)("tbody",{children:o.map((function(t,n){return(0,m.jsx)(at,{item:t,leaveShare:e.props.leaveShare},n)}))})]});return o.length?a:i}}])}(s.Component),at=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).handleMouseOver=function(){n.setState({isOpIconShown:!0})},n.handleMouseOut=function(){n.setState({isOpIconShown:!1})},n.leaveShare=function(e){e.preventDefault(),n.props.leaveShare(n.props.item)},n.state={isOpIconShown:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.item,t=this.state.isOpIconShown;e.icon_url=f.Aq.getLibIconUrl(e),e.icon_title=f.Aq.getLibIconTitle(e);var n="".concat(h.Yc,"remote-library/").concat(this.props.item.provider_id,"/").concat(this.props.item.repo_id,"/").concat(f.Aq.encodePath(this.props.item.repo_name),"/");return(0,m.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:e.icon_url,title:e.icon_title,alt:e.icon_title,width:"24"})}),(0,m.jsx)("td",{children:(0,m.jsx)(c.N_,{to:n,children:e.repo_name})}),(0,m.jsx)("td",{children:e.from_user}),(0,m.jsx)("td",{children:e.from_server_url}),(0,m.jsx)("td",{title:X()(e.last_modified).format("llll"),children:X()(e.ctime).fromNow()}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"#",role:"button",className:"action-icon sf2-icon-x3 ".concat(t?"":"invisible"),title:(0,h.AP)("Leave Share"),"aria-label":(0,h.AP)("Leave Share"),onClick:this.leaveShare})})]})}}])}(s.Component),st=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).leaveShare=function(e){var t=e.id,r=e.repo_name;k.e.deleteOCMShareReceived(t).then((function(e){var o=n.state.items.filter((function(e){return e.id!=t}));n.setState({items:o}),j.A.success((0,h.AP)("Successfully unshared {name}").replace("{name}",r))})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.state={loading:!0,errorMsg:"",items:[]},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;k.e.listOCMSharesReceived().then((function(t){e.setState({loading:!1,items:t.data.ocm_share_received_list})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,m.jsx)(s.Fragment,{children:(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)("div",{className:"cur-view-path",children:(0,m.jsx)("h3",{className:"sf-heading m-0",children:(0,h.AP)("Shared from other servers")})}),(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsx)(it,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.items,leaveShare:this.leaveShare})})]})})})}}])}(s.Component),lt=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).getAllReceivedShares=function(){var e=k.e.server+"/ocm-via-webdav/received-shares/";k.e.req.get(e).then((function(e){n.setState({loading:!1,shareID:"",path:"",items:e.data.received_share_list})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.leaveShare=function(e){var t=e.id,r=e.name,o=k.e.server+"/ocm-via-webdav/received-shares/"+t+"/";k.e.req.delete(o).then((function(e){var o=n.state.items.filter((function(e){return e.id!=t}));n.setState({items:o}),j.A.success((0,h.AP)("Successfully unshared {name}").replace("{name}",r))})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.openFolder=function(e){n.setState({loading:!0});var t=k.e.server+"/ocm-via-webdav/received-shares/"+e.id+"/?path="+e.path;k.e.req.get(t).then((function(t){n.setState({loading:!1,shareID:e.id,path:t.data.parent_dir,items:t.data.received_share_list})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.onPathClick=function(e){n.setState({loading:!0});var t=k.e.server+"/ocm-via-webdav/received-shares/"+n.state.shareID+"/?path="+e;k.e.req.get(t).then((function(e){n.setState({loading:!1,items:e.data.received_share_list,path:e.data.parent_dir})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.state={loading:!0,shareID:"",path:"",items:[],errorMsg:""},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.getAllReceivedShares()}},{key:"render",value:function(){return(0,m.jsx)(s.Fragment,{children:(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)("div",{className:"cur-view-path align-items-center",children:(0,m.jsx)(dt,{shareID:this.state.shareID,currentPath:this.state.path,onPathClick:this.onPathClick,getAllReceivedShares:this.getAllReceivedShares})}),(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsx)(ct,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.items,path:this.state.path,leaveShare:this.leaveShare,openFolder:this.openFolder})})]})})})}}])}(s.Component),ct=function(e){function t(e){return(0,r.A)(this,t),(0,i.A)(this,t,[e])}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,o=t.items,i=t.path,a=(0,m.jsx)(J.A,{title:(0,h.AP)("No libraries have been shared with you"),text:(0,h.AP)("No libraries have been shared with you from other servers.")});if(n)return(0,m.jsx)($.A,{});if(r)return(0,m.jsx)("p",{className:"error text-center",children:r});var s=(0,m.jsxs)("table",{children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"5%"}),(0,m.jsx)("th",{width:"30%",children:(0,h.AP)("Name")}),(0,m.jsx)("th",{width:"35%",children:(0,h.AP)("Shared By")}),(0,m.jsx)("th",{width:"20%",children:(0,h.AP)("Time")}),(0,m.jsx)("th",{width:"5%"}),(0,m.jsx)("th",{width:"5%"})]})}),(0,m.jsx)("tbody",{children:o.map((function(t,n){return(0,m.jsx)(ut,{item:t,path:i,leaveShare:e.props.leaveShare,openFolder:e.props.openFolder},n)}))})]});return o.length?s:a}}])}(s.Component),ut=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).handleMouseOver=function(){n.setState({isOpIconShown:!0})},n.handleMouseOut=function(){n.setState({isOpIconShown:!1})},n.downloadFile=function(){var e=h.Yc+"ocm-via-webdav/download-received-file/?share_id="+n.props.item.id+"&path="+n.props.item.path;window.location.href=e},n.leaveShare=function(e){e.preventDefault(),n.props.leaveShare(n.props.item)},n.openFolder=function(e){e.preventDefault(),n.props.openFolder(n.props.item)},n.state={isOpIconShown:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.item,t=this.state.isOpIconShown;return e.is_dir?e.icon_url=f.Aq.getFolderIconUrl():e.icon_url=f.Aq.getFileIconUrl(e.name),(0,m.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,children:[(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:e.icon_url,width:"24",alt:""})}),(0,m.jsx)("td",{children:e.is_dir?(0,m.jsx)("a",{href:"#",onClick:this.openFolder,children:e.name}):e.name}),(0,m.jsx)("td",{children:e.shared_by}),(0,m.jsx)("td",{title:X()(e.last_modified).format("llll"),children:X()(e.ctime).fromNow()}),(0,m.jsx)("td",{children:e.is_dir?"":(0,m.jsx)("a",{href:"#",className:"action-icon sf2-icon-download ".concat(t?"":"invisible"),title:(0,h.AP)("Download"),onClick:this.downloadFile})}),(0,m.jsx)("td",{children:this.props.path?"":(0,m.jsx)("a",{href:"#",className:"action-icon sf2-icon-x3 ".concat(t?"":"invisible"),title:(0,h.AP)("Leave Share"),onClick:this.leaveShare})})]})}}])}(s.Component),dt=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onPathClick=function(e){var t=f.Aq.getEventData(e,"path");n.props.onPathClick(t)},n.turnPathToLink=function(e){var t=(e=e.slice(1,e.length-1)).split("/"),r="";return t.map((function(e,o){return o===t.length-1?(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("span",{className:"path-split",children:"/"}),(0,m.jsx)("span",{className:"path-file-name",children:e})]},o):(0===o?r="/":r+=e+"/",(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("span",{className:"path-split",children:"/"}),(0,m.jsx)("a",{className:"path-link","data-path":r,onClick:n.onPathClick,children:e})]},o))}))},n.state={},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.turnPathToLink(this.props.currentPath);return(0,m.jsxs)("div",{className:"path-container",children:[(0,m.jsx)("a",{href:"#",onClick:this.props.getAllReceivedShares,children:(0,h.AP)("All")}),e]})}}])}(s.Component),pt=lt,ht=n(26910),ft=function(e){function t(){var e;(0,r.A)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=(0,i.A)(this,t,[].concat(o))).onPathClick=function(t){var n=f.Aq.getEventData(t,"path");e.props.onPathClick(n)},e.turnPathToLink=function(t){var n=(t="/"===t[t.length-1]?t.slice(0,t.length-1):t).split("/"),r="";return n.map((function(t,o){return""===t?null:o===n.length-1?(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("span",{className:"path-split",children:"/"}),(0,m.jsx)("span",{className:"path-file-name",children:t})]},o):(r+="/"+t,(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("span",{className:"path-split",children:"/"}),(0,m.jsx)("a",{className:"path-link","data-path":r,onClick:e.onPathClick,children:t})]},o))}))},e}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.currentPath,r=t.repoName,o=this.turnPathToLink(n);return(0,m.jsxs)("div",{className:"path-container",children:[(0,m.jsx)(c.N_,{to:h.Yc+"shared-with-ocm/",className:"normal",onClick:function(t){return e.props.onTabNavClick("shared-with-ocm")},children:(0,h.AP)("All")}),(0,m.jsx)("span",{className:"path-split",children:"/"}),"/"===n||""===n?(0,m.jsx)("span",{className:"path-repo-name",children:r}):(0,m.jsx)("a",{className:"path-link","data-path":"/",onClick:this.onPathClick,children:r}),o]})}}])}(s.Component),mt=ft,gt=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).handleMouseOver=function(){n.setState({isOpIconShown:!0})},n.handleMouseOut=function(){n.setState({isOpIconShown:!1})},n.openFolder=function(){n.props.openFolder(n.props.dirent)},n.downloadDirent=function(e){e.preventDefault(),n.props.downloadDirent(n.props.dirent)},n.state={isOpIconShown:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.state.isOpIconShown,t=this.props.dirent,n=f.Aq.getDirentIcon(t);return(0,m.jsx)(s.Fragment,{children:(0,m.jsxs)("tr",{onMouseEnter:this.handleMouseOver,onMouseLeave:this.handleMouseOut,children:[(0,m.jsx)("td",{className:"text-center",children:(0,m.jsx)("img",{src:n,width:"24",alt:""})}),(0,m.jsx)("td",{children:t.is_file?t.name:(0,m.jsx)(c.N_,{to:"#",onClick:this.openFolder,children:t.name})}),(0,m.jsx)("td",{children:e&&t.is_file&&(0,m.jsx)("a",{href:"#",className:"op-icon sf3-font sf3-font-download1",title:(0,h.AP)("Download"),onClick:this.downloadDirent})}),(0,m.jsx)("td",{children:f.Aq.bytesToSize(t.size)}),(0,m.jsx)("td",{children:X()(t.mtime).fromNow()})]})})}}])}(s.Component),vt=function(e){function t(e){return(0,r.A)(this,t),(0,i.A)(this,t,[e])}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.errorMsg,o=t.direntList;return n?(0,m.jsx)($.A,{}):r?(0,m.jsx)("p",{className:"error text-center mt-4",children:r}):(0,m.jsx)(s.Fragment,{children:(0,m.jsxs)("table",{className:"table-hover",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"5%"}),(0,m.jsx)("th",{width:"55%",children:(0,h.AP)("Name")}),(0,m.jsx)("th",{width:"10%"}),(0,m.jsx)("th",{width:"15%",children:(0,h.AP)("Size")}),(0,m.jsx)("th",{width:"15%",children:(0,h.AP)("Last Update")})]})}),(0,m.jsx)("tbody",{children:o.map((function(t,n){return(0,m.jsx)(gt,{dirent:t,openFolder:e.props.openFolder,deleteDirent:e.props.deleteDirent,downloadDirent:e.props.downloadDirent},n)}))})]})})}}])}(s.Component),yt=function(){return(0,o.A)((function e(t){(0,r.A)(this,e),this.name=t.name,this.mtime=t.mtime,this.size=t.size,this.is_file="file"===t.type}),[{key:"isDir",value:function(){return!this.is_file}}])}(),xt=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onPathClick=function(e){n.loadDirentList(e)},n.openFolder=function(e){var t=f.Aq.joinPath(n.state.path,e.name);e.is_file||n.loadDirentList(t)},n.loadDirentList=function(e){var t=n.props,r=t.providerID,o=t.repoID;k.e.listOCMRepoDir(r,o,e).then((function(t){var i=t.data,a=i.repo_name,s=i.dirent_list,l=i.user_perm,c=[];s.forEach((function(e){var t=new yt(e);c.push(t)})),n.setState({loading:!1,repoName:a,direntList:c,path:e,userPerm:l},(function(){var t="".concat(h.Yc,"remote-library/").concat(r,"/").concat(o,"/").concat(a).concat(f.Aq.encodePath(e));window.history.replaceState({url:t,path:e},e,t)}))})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.downloadDirent=function(e){var t=f.Aq.joinPath(n.state.path,e.name);k.e.getOCMRepoDownloadURL(n.props.providerID,n.props.repoID,t).then((function(e){location.href=e.data})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.openFileInput=function(){n.fileInput.current.click()},n.onFileInputChange=function(){if(n.fileInput.current.files.length){var e=n.fileInput.current.files[0],t=n.state.path,r=n.props,o=r.providerID,i=r.repoID;k.e.getOCMRepoUploadURL(o,i,t).then((function(r){var o=new FormData;o.append("parent_dir",t),o.append("file",e),ht.A.post(r.data,o).then((function(e){var t=e.data[0],r=new yt({type:"file",name:t.name,size:t.size,mtime:(new Date).getTime()}),o=n.state.direntList,i=o.filter((function(e){return!e.is_file}));o.splice(i.length,0,r),n.setState({direntList:o})}))})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))}},n.state={loading:!0,errorMsg:"",repoName:"",path:"",direntList:[],isNewFolderDialogOpen:!1,userPerm:""},n.fileInput=s.createRef(),n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.loadDirentList("/")}},{key:"render",value:function(){var e=this.state,t=e.loading,n=e.errorMsg,r=e.repoName,o=e.direntList,i=e.path,a=this.props.repoID;return(0,m.jsx)(s.Fragment,{children:(0,m.jsx)("div",{className:"main-panel-center flex-row",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)("div",{className:"cur-view-path align-items-center",children:(0,m.jsx)(mt,{repoID:a,repoName:r,currentPath:i,onPathClick:this.onPathClick,onTabNavClick:this.props.onTabNavClick})}),(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsx)(vt,{loading:t,errorMsg:n,direntList:o,openFolder:this.openFolder,deleteDirent:this.deleteDirent,downloadDirent:this.downloadDirent})})]})})})}}])}(s.Component),At=n(73606),Ct=n(37382),bt=n(19247),wt=n(76152),St=n(55627),Dt=n(76115),kt=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).submit=function(){var e=n.state.keepDays;n.state.autoHistory&&(e=n.state.expireDays);var t=n.props.repoID;if(/^-?\d+$/.test(e)){var r=(0,h.AP)("Successfully set library history.");k.e.setRepoHistoryLimit(t,e).then((function(e){j.A.success(r),n.setState({keepDays:e.data.keep_days}),n.props.toggleDialog()})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))}else n.setState({errorInfo:(0,h.AP)("Please enter a non-negative integer")})},n.handleKeyDown=function(e){"Enter"===e.key&&(n.submit(),e.preventDefault())},n.onChange=function(e){var t=e.target.value;n.setState({keepDays:t,expireDays:t})},n.setLimitDays=function(e){"allHistory"===e?n.setState({keepDays:-1,disabled:!0}):"noHistory"===e?n.setState({keepDays:0,disabled:!0}):n.setState({disabled:!1}),n.setState({allHistory:"allHistory"===e,noHistory:"noHistory"===e,autoHistory:"autoHistory"===e})},n.state={keepDays:-1,expireDays:30,disabled:!0,allHistory:!0,noHistory:!1,autoHistory:!1,errorInfo:""},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;k.e.getRepoHistoryLimit(this.props.repoID).then((function(t){e.setState({keepDays:t.data.keep_days,allHistory:t.data.keep_days<0,noHistory:0===t.data.keep_days,autoHistory:t.data.keep_days>0,disabled:!(t.data.keep_days>0),expireDays:t.data.keep_days>0?t.data.keep_days:30})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))}},{key:"render",value:function(){var e=this,t=this.props.itemName,n=(0,h.AP)("{placeholder} History Setting");return n=n.replace("{placeholder}",'<span class="op-target text-truncate mx-1">'+f.Aq.HTMLescape(t)+"</span>"),(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.props.toggleDialog,children:[(0,m.jsx)(I.A,{toggle:this.props.toggleDialog,children:(0,m.jsx)("span",{dangerouslySetInnerHTML:{__html:n},className:"d-flex mw-100"})}),(0,m.jsx)(_.A,{children:(0,m.jsxs)(bt.A,{children:[!h.GF&&(0,m.jsx)(wt.A,{children:(0,m.jsx)(St.A,{className:"error",children:(0,h.AP)("Setting library history is disabled by Admin.")})}),(0,m.jsxs)(wt.A,{check:!0,children:[(0,m.jsx)(P.A,{type:"radio",name:"radio1",checked:this.state.allHistory,disabled:!h.GF,onChange:function(){e.setLimitDays("allHistory")}})," ",(0,m.jsx)(St.A,{children:(0,h.AP)("Keep full history")})]}),(0,m.jsxs)(wt.A,{check:!0,children:[(0,m.jsx)(P.A,{type:"radio",name:"radio1",checked:this.state.noHistory,disabled:!h.GF,onChange:function(){e.setLimitDays("noHistory")}})," ",(0,m.jsx)(St.A,{children:(0,h.AP)("Don't keep history")})]}),(0,m.jsxs)(wt.A,{check:!0,children:[(0,m.jsx)(P.A,{type:"radio",name:"radio1",checked:this.state.autoHistory,disabled:!h.GF,onChange:function(){e.setLimitDays("autoHistory")}})," ",(0,m.jsx)(St.A,{children:(0,h.AP)("Only keep a period of history:")}),(0,m.jsx)(P.A,{type:"text",className:"expire-input",value:this.state.expireDays,onChange:this.onChange,disabled:this.state.disabled,onKeyDown:this.handleKeyDown})," ",(0,m.jsx)(St.A,{children:(0,m.jsx)("span",{children:(0,h.AP)("days")})})]}),this.state.errorInfo&&(0,m.jsx)(Dt.A,{color:"danger",children:this.state.errorInfo})]})}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(O.A,{color:"secondary",onClick:this.props.toggleDialog,children:(0,h.AP)("Cancel")}),(0,m.jsx)(O.A,{color:"primary",onClick:this.submit,children:(0,h.AP)("Submit")})]})]})}}])}(s.Component),Mt=kt,jt=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).handleOldPasswordInputChange=function(e){n.setState({oldPassword:e.target.value})},n.handleNewPasswordInputChange=function(e){n.setState({newPassword:e.target.value})},n.handleNewPasswordAgainInputChange=function(e){n.setState({newPasswordAgain:e.target.value})},n.formSubmit=function(e){var t=n.state,r=t.oldPassword,o=t.newPassword,i=t.newPasswordAgain;return r?o?o.length<h.cT?(n.setState({errorMsg:(0,h.AP)("New password is too short")}),!1):i?o!=i?(n.setState({errorMsg:(0,h.AP)("New passwords don't match")}),!1):(n.setState({submitBtnDisabled:!0}),void k.e.changeEncryptedRepoPassword(n.props.repoID,r,o).then((function(){n.props.toggleDialog(),j.A.success((0,h.AP)("Successfully changed library password."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);n.setState({errorMsg:t,submitBtnDisabled:!1})}))):(n.setState({errorMsg:(0,h.AP)("Please enter the new password again")}),!1):(n.setState({errorMsg:(0,h.AP)("Please enter a new password")}),!1):(n.setState({errorMsg:(0,h.AP)("Please enter the old password")}),!1)},n.state={oldPassword:"",newPassword:"",newPasswordAgain:"",submitBtnDisabled:!1,errorMsg:""},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.repoName,n=e.toggleDialog,r=(0,h.AP)("Change Password of Library {placeholder}");return r=r.replace("{placeholder}",'<span class="op-target text-truncate mx-1">'+f.Aq.HTMLescape(t)+"</span>"),(0,m.jsxs)(p.A,{isOpen:!0,style:{height:"auto"},toggle:n,children:[(0,m.jsx)(I.A,{toggle:n,children:(0,m.jsx)("span",{dangerouslySetInnerHTML:{__html:r},className:"d-flex mw-100"})}),(0,m.jsx)(_.A,{children:(0,m.jsxs)("form",{id:"repo-change-passwd-form",action:"",method:"post",children:[(0,m.jsx)("label",{htmlFor:"passwd",children:(0,h.AP)("Old Password")}),(0,m.jsx)("br",{}),(0,m.jsx)("input",{type:"password",name:"old_passwd",className:"form-control",id:"passwd",value:this.state.oldPassword,onChange:this.handleOldPasswordInputChange}),(0,m.jsx)("br",{}),(0,m.jsx)("label",{htmlFor:"new-passwd",children:(0,h.AP)("New Password")}),(0,m.jsx)("span",{className:"tip",children:(0,h.AP)("(at least {placeholder} characters)").replace("{placeholder}",h.cT)}),(0,m.jsx)("br",{}),(0,m.jsx)("input",{type:"password",name:"new_passwd",className:"form-control",id:"new-passwd",value:this.state.newPassword,onChange:this.handleNewPasswordInputChange}),(0,m.jsx)("br",{}),(0,m.jsx)("label",{htmlFor:"new-passwd-again",children:(0,h.AP)("New Password Again")}),(0,m.jsx)("br",{}),(0,m.jsx)("input",{type:"password",name:"new_passwd_again",className:"form-control",id:"new-passwd-again",value:this.state.newPasswordAgain,onChange:this.handleNewPasswordAgainInputChange}),(0,m.jsx)("br",{}),this.state.errorMsg&&(0,m.jsx)(Dt.A,{color:"danger",children:this.state.errorMsg})]})}),(0,m.jsx)(N.A,{children:(0,m.jsx)("button",{className:"btn btn-primary",disabled:this.state.submitBtnDisabled,onClick:this.formSubmit,children:(0,h.AP)("Submit")})})]})}}])}(s.Component),It=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).state={errMessage:"",showLoading:!0,showSuccess:!1,showError:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;k.e.resetAndSendEncryptedRepoPassword(this.props.repoID).then((function(t){e.setState({showLoading:!1}),e.setState({showSuccess:!0})})).catch((function(t){t.response&&(e.setState({errMessage:t.response.data.error_msg}),e.setState({showLoading:!1}),e.setState({showError:!0}))}))}},{key:"render",value:function(){var e="<strong>"+h.bd+"</strong>",t=(0,h.AP)("New password has been sent to your email {mail}. Please check your mailbox. If you don\u2019t receive the password, please check if your email address is properly configured.").replace("{mail}",e);return(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.props.toggleDialog,children:[(0,m.jsx)(I.A,{toggle:this.props.toggleDialog,children:(0,h.AP)("Reset library password")}),(0,m.jsxs)(_.A,{children:[this.state.showLoading&&(0,m.jsx)("span",{children:(0,h.AP)("Sending new password...")}),this.state.showSuccess&&(0,m.jsx)("div",{dangerouslySetInnerHTML:{__html:t}}),this.state.showError&&(0,m.jsx)("span",{className:"err-message",children:this.state.errMessage})]})]})}}])}(s.Component),_t=n(20015),Pt=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).handleInputChange=function(e){n.setState({inputValue:e})},n.formSubmit=function(){var e=n.state.inputValue;if(e&&e.length){n.setState({submitBtnDisabled:!0});var t=n.props,r=t.repoID,o=t.repoName,i=e.map((function(e,t){return e.value})).join(",");k.e.addNewRepoLabels(r,i).then((function(e){var t=(0,h.AP)("Successfully added label(s) for library {placeholder}").replace("{placeholder}",o);j.A.success(t),n.props.toggleDialog()})).catch((function(e){var t=f.Aq.getErrorMsg(e);n.setState({formErrorMsg:t,submitBtnDisabled:!1})}))}else n.setState({formErrorMsg:(0,h.AP)("It is required.")})},n.state={isLoading:!0,existingLabels:null,errorMsg:"",submitBtnDisabled:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;k.e.getAllRepoSnapshotLabels().then((function(t){e.setState({isLoading:!1,existingLabels:t.data,errorMsg:""})})).catch((function(t){var n=f.Aq.getErrorMsg(t);e.setState({isLoading:!1,errorMsg:n})}))}},{key:"render",value:function(){return(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.props.toggleDialog,children:[(0,m.jsx)(I.A,{toggle:this.props.toggleDialog,children:(0,h.AP)("Label Current State")}),(0,m.jsx)(_.A,{children:(0,m.jsx)(Nt,{data:this.state,handleChange:this.handleInputChange})}),this.state.existingLabels&&(0,m.jsxs)(N.A,{children:[(0,m.jsx)("button",{className:"btn btn-secondary",onClick:this.props.toggleDialog,children:(0,h.AP)("Cancel")}),(0,m.jsx)("button",{className:"btn btn-primary",disabled:this.state.submitBtnDisabled,onClick:this.formSubmit,children:(0,h.AP)("Submit")})]})]})}}])}(s.Component),Nt=function(e){function t(){return(0,r.A)(this,t),(0,i.A)(this,t,arguments)}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.data,t=e.isLoading,n=e.errorMsg,r=e.existingLabels,o=e.formErrorMsg;return t?(0,m.jsx)($.A,{}):n?(0,m.jsx)("p",{className:"error mt-4 text-center",children:n}):(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)(_t.A,{isMulti:!0,onChange:this.props.handleChange,placeholder:"",options:r.map((function(e,t){return{label:e,value:e}}))}),o&&(0,m.jsx)("p",{className:"error m-0 mt-2",children:o})]})}}])}(s.Component),Ot=Pt,Tt=n(52308),Et=n(8743),Rt=n(36640),Lt=n(51445),Ft=n(52088),Ut=n(48918),Bt=n(30038),Yt=n(94988),qt=n(50022),Ht=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onMouseEnter=function(){n.setState({isOperationShow:!0})},n.onMouseLeave=function(){n.setState({isOperationShow:!1})},n.deleteUserFolderPermission=function(){var e=n.props.item;n.props.deleteUserFolderPermission(e)},n.onChangeUserFolderPerm=function(e){var t=n.props.item;n.props.onChangeUserFolderPerm(t.repo_id,e,t.folder_path,t.user_email)},n.state={isOperationShow:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.item,t=e.permission;return(0,m.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onFocus:this.onMouseEnter,children:[(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"".concat(h.Yc,"profile/").concat(encodeURIComponent(e.user_email),"/"),target:"_blank",rel:"noreferrer",children:e.user_name})}),this.props.showPath&&(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"".concat(h.Yc,"library/").concat(e.repo_id,"/").concat(f.Aq.encodePath(this.props.repoName+e.folder_path)),children:e.folder_name})}),(0,m.jsx)("td",{children:(0,m.jsx)(be.A,{isTextMode:!0,autoFocus:!0,isEditIconShow:this.state.isOperationShow,currentPermission:t,permissions:this.props.permissions,onPermissionChanged:this.onChangeUserFolderPerm})}),(0,m.jsx)("td",{children:(0,m.jsx)("span",{tabIndex:"0",role:"button",className:"sf2-icon-x3 action-icon ".concat(this.state.isOperationShow?"":"hide"),onClick:this.deleteUserFolderPermission,onKeyDown:f.Aq.onKeyDown,title:(0,h.AP)("Delete"),"aria-label":(0,h.AP)("Delete")})})]})}}])}(s.Component),Gt=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).handleUserSelectChange=function(e){n.setState({selectedUsers:e})},n.setPermission=function(e){n.setState({permission:e})},n.addUserFolderPerm=function(){var e=n.state.selectedUsers,t=n.props.folderPath||n.state.folderPath;if(!e||!e.length||!t)return!1;var r=e.map((function(e,t){return e.email}));(n.props.isDepartmentRepo?k.e.addDepartmentRepoUserFolderPerm(n.props.repoID,n.state.permission,t,r):k.e.addUserFolderPerm(n.props.repoID,n.state.permission,t,r)).then((function(e){var t=[];if(e.data.failed.length>0)for(var r=0;r<e.data.failed.length;r++)t[r]=e.data.failed[r];n.setState({errorMsg:t,userFolderPermItems:n.state.userFolderPermItems.concat(e.data.success),selectedUsers:null,permission:"rw",folderPath:""}),n.refs.userSelect.clearSelect()})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.deleteUserFolderPermItem=function(e){(n.props.isDepartmentRepo?k.e.deleteDepartmentRepoUserFolderPerm(e.repo_id,e.permission,e.folder_path,e.user_email):k.e.deleteUserFolderPerm(e.repo_id,e.permission,e.folder_path,e.user_email)).then((function(t){n.setState({userFolderPermItems:n.state.userFolderPermItems.filter((function(t){return t!=e}))})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.onChangeUserFolderPerm=function(e,t,r,o){(n.props.isDepartmentRepo?k.e.updateDepartmentRepoUserFolderPerm(e,t,r,o):k.e.updateUserFolderPerm(e,t,r,o)).then((function(e){var i=n.state.userFolderPermItems.map((function(e){return e.user_email===o&&e.folder_path===r&&(e.permission=t),e}));n.setState({userFolderPermItems:i})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.onSetSubFolder=function(e){n.setState({folderPath:e.target.value})},n.toggleFileChooser=function(){n.setState({showFileChooser:!n.state.showFileChooser,folderPath:""})},n.toggleSubFolder=function(e,t,r){n.setState({folderPath:t})},n.handleFileChooserSubmit=function(){n.setState({folderPath:n.state.folderPath||"/",showFileChooser:!n.state.showFileChooser})},n.onRepoItemClick=function(){n.setState({folderPath:"/"})},n.state={selectedUsers:null,errorMsg:[],permission:"rw",userFolderPermItems:[],folderPath:"",showFileChooser:!1},h.am?n.permissions=["r","rw","cloud-edit","preview","invisible"]:n.permissions=["r","rw"],n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.repoID,r=t.folderPath;(t.isDepartmentRepo?k.e.listDepartmentRepoUserFolderPerm(n,r):k.e.listUserFolderPerm(n,r)).then((function(t){0!==t.data.length&&e.setState({userFolderPermItems:t.data})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))}},{key:"render",value:function(){var e=this,t=!this.props.folderPath,n=this.state.userFolderPermItems;if(this.state.showFileChooser)return(0,m.jsxs)("div",{children:[(0,m.jsx)(qt.A,{repoID:this.props.repoID,mode:"only_current_library",onDirentItemClick:this.toggleSubFolder,onRepoItemClick:this.onRepoItemClick}),(0,m.jsxs)("div",{className:"modal-footer",children:[(0,m.jsx)(O.A,{color:"secondary",onClick:this.toggleFileChooser,children:(0,h.AP)("Cancel")}),(0,m.jsx)(O.A,{color:"primary",onClick:this.handleFileChooserSubmit,children:(0,h.AP)("Submit")})]})]});var r=(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:t?"32%":"55%",children:(0,h.AP)("User")}),t&&(0,m.jsx)("th",{width:"32%",children:(0,h.AP)("Folder")}),(0,m.jsx)("th",{width:t?"24%":"30%",children:(0,h.AP)("Permission")}),(0,m.jsx)("th",{width:t?"12%":"15%"})]})});return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsxs)("table",{className:"w-xs-250",children:[r,(0,m.jsxs)("tbody",{children:[(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{children:(0,m.jsx)(Yt.A,{ref:"userSelect",isMulti:!0,placeholder:(0,h.AP)("Search users"),onSelectChange:this.handleUserSelectChange,value:this.state.selectedUsers})}),t&&(0,m.jsx)("td",{children:(0,m.jsxs)(Ut.A,{children:[(0,m.jsx)(P.A,{value:this.state.folderPath,onChange:this.onSetSubFolder}),(0,m.jsx)(Bt.A,{addonType:"append",children:(0,m.jsx)(O.A,{className:"sf2-icon-plus",onClick:this.toggleFileChooser})})]})}),(0,m.jsx)("td",{children:(0,m.jsx)(be.A,{isTextMode:!1,isEditIconShow:!1,currentPermission:this.state.permission,permissions:this.permissions,onPermissionChanged:this.setPermission})}),(0,m.jsx)("td",{children:(0,m.jsx)(O.A,{color:"primary",onClick:this.addUserFolderPerm,children:(0,h.AP)("Submit")})})]}),this.state.errorMsg.length>0&&this.state.errorMsg.map((function(e,t){var n="";return n=e.user_email?e.user_email+": "+e.error_msg:e,(0,m.jsx)("tr",{children:(0,m.jsx)("td",{colSpan:3,children:(0,m.jsx)("p",{className:"error",children:n})})},t)}))]})]}),(0,m.jsx)("div",{className:"share-list-container",children:(0,m.jsxs)("table",{className:"table-thead-hidden w-xs-250",children:[r,(0,m.jsx)("tbody",{children:n.map((function(n,r){return(0,m.jsx)(Ht,{item:n,permissions:e.permissions,deleteUserFolderPermission:e.deleteUserFolderPermItem,onChangeUserFolderPerm:e.onChangeUserFolderPerm,showPath:t,repoName:e.props.repoName},r)}))})]})})]})}}])}(s.Component),zt=Gt,Vt=n(76229),Wt=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onMouseEnter=function(){n.setState({isOperationShow:!0})},n.onMouseLeave=function(){n.setState({isOperationShow:!1})},n.deleteGroupPermissionItem=function(){var e=n.props.item;n.props.deleteGroupPermissionItem(e)},n.onChangeGroupPermission=function(e){var t=n.props.item;n.props.onChangeGroupPermission(t,e)},n.state={isOperationShow:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.item;return(0,m.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onFocus:this.onMouseEnter,children:[(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"".concat(h.Yc,"group/").concat(e.group_id,"/"),target:"_blank",rel:"noreferrer",children:e.group_name})}),this.props.showPath&&(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"".concat(h.Yc,"library/").concat(e.repo_id,"/").concat(f.Aq.encodePath(this.props.repoName+e.folder_path)),children:e.folder_name})}),(0,m.jsx)("td",{children:(0,m.jsx)(be.A,{isTextMode:!0,autoFocus:!0,isEditIconShow:this.state.isOperationShow,currentPermission:e.permission,permissions:this.props.permissions,onPermissionChanged:this.onChangeGroupPermission})}),(0,m.jsx)("td",{children:(0,m.jsx)("span",{tabIndex:"0",role:"button",className:"sf2-icon-x3 action-icon ".concat(this.state.isOperationShow?"":"hide"),onClick:this.deleteGroupPermissionItem,onKeyDown:f.Aq.onKeyDown,title:(0,h.AP)("Delete"),"aria-label":(0,h.AP)("Delete")})})]})}}])}(s.Component),Kt=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).handleSelectChange=function(e){n.setState({selectedOption:e})},n.loadOptions=function(){k.e.shareableGroups().then((function(e){n.options=e.data.map((function(e,t){return{id:e.id,label:e.name,value:e.name}}))})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.listGroupPermissionItems=function(){var e=n.props,t=e.isDepartmentRepo,r=e.repoID,o=e.folderPath;(t?k.e.listDepartmentRepoGroupFolderPerm(r,o):k.e.listGroupFolderPerm(r,o)).then((function(e){0!==e.data.length&&n.setState({groupPermissionItems:e.data})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.setPermission=function(e){n.setState({permission:e})},n.addGroupFolderPerm=function(){var e=n.state.selectedOption,t=n.props.folderPath||n.state.folderPath;if(!e||!t)return!1;(n.props.isDepartmentRepo?k.e.addDepartmentRepoGroupFolderPerm(n.props.repoID,n.state.permission,t,e.id):k.e.addGroupFolderPerm(n.props.repoID,n.state.permission,t,e.id)).then((function(e){var t=[];if(e.data.failed.length>0)for(var r=0;r<e.data.failed.length;r++)t[r]=e.data.failed[r];n.setState({errorMsg:t,groupPermissionItems:n.state.groupPermissionItems.concat(e.data.success),selectedOption:null,permission:"rw",folderPath:""})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.deleteGroupPermissionItem=function(e){(n.props.isDepartmentRepo?k.e.deleteDepartmentRepoGroupFolderPerm(e.repo_id,e.permission,e.folder_path,e.group_id):k.e.deleteGroupFolderPerm(e.repo_id,e.permission,e.folder_path,e.group_id)).then((function(){n.setState({groupPermissionItems:n.state.groupPermissionItems.filter((function(t){return t!=e}))})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.onChangeGroupPermission=function(e,t){(n.props.isDepartmentRepo?k.e.updateDepartmentRepoGroupFolderPerm(e.repo_id,t,e.folder_path,e.group_id):k.e.updateGroupFolderPerm(e.repo_id,t,e.folder_path,e.group_id)).then((function(){n.updateGroupPermission(e,t)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.updateGroupPermission=function(e,t){var r=e.group_id,o=n.state.groupPermissionItems.map((function(n){var o=n.group_id;return r===o&&e.folder_path===n.folder_path&&(n.permission=t),n}));n.setState({groupPermissionItems:o})},n.onSetSubFolder=function(e){n.setState({folderPath:e.target.value})},n.toggleFileChooser=function(){n.setState({showFileChooser:!n.state.showFileChooser,folderPath:""})},n.toggleSubFolder=function(e,t,r){n.setState({folderPath:t})},n.handleSubmit=function(){n.setState({folderPath:n.state.folderPath||"/",showFileChooser:!n.state.showFileChooser})},n.onRepoItemClick=function(){n.setState({folderPath:"/"})},n.state={selectedOption:null,errorMsg:[],permission:"rw",groupPermissionItems:[],folderPath:"",showFileChooser:!1},n.options=[],h.am?n.permissions=["r","rw","cloud-edit","preview","invisible"]:n.permissions=["r","rw"],n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.loadOptions(),this.listGroupPermissionItems()}},{key:"render",value:function(){var e=this,t=!this.props.folderPath;if(this.state.showFileChooser)return(0,m.jsxs)("div",{children:[(0,m.jsx)(qt.A,{repoID:this.props.repoID,mode:"only_current_library",onDirentItemClick:this.toggleSubFolder,onRepoItemClick:this.onRepoItemClick}),(0,m.jsxs)("div",{className:"modal-footer",children:[(0,m.jsx)(O.A,{color:"secondary",onClick:this.toggleFileChooser,children:(0,h.AP)("Cancel")}),(0,m.jsx)(O.A,{color:"primary",onClick:this.handleSubmit,children:(0,h.AP)("Submit")})]})]});var n=(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:t?"32%":"55%",children:(0,h.AP)("Group")}),t&&(0,m.jsx)("th",{width:"32%",children:(0,h.AP)("Folder")}),(0,m.jsx)("th",{width:t?"24%":"30%",children:(0,h.AP)("Permission")}),(0,m.jsx)("th",{width:t?"12%":"15%"})]})});return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsxs)("table",{className:"w-xs-250",children:[n,(0,m.jsxs)("tbody",{children:[(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{children:(0,m.jsx)(Vt.by,{onChange:this.handleSelectChange,options:this.options,placeholder:(0,h.AP)("Select a group"),maxMenuHeight:200,value:this.state.selectedOption,components:{NoOptionsMessage:Vt.iI}})}),t&&(0,m.jsx)("td",{children:(0,m.jsxs)(Ut.A,{children:[(0,m.jsx)(P.A,{value:this.state.folderPath,onChange:this.onSetSubFolder}),(0,m.jsx)(Bt.A,{addonType:"append",children:(0,m.jsx)(O.A,{className:"sf2-icon-plus",onClick:this.toggleFileChooser})})]})}),(0,m.jsx)("td",{children:(0,m.jsx)(be.A,{isTextMode:!1,isEditIconShow:!1,currentPermission:this.state.permission,permissions:this.permissions,onPermissionChanged:this.setPermission})}),(0,m.jsx)("td",{children:(0,m.jsx)(O.A,{color:"primary",onClick:this.addGroupFolderPerm,children:(0,h.AP)("Submit")})})]}),this.state.errorMsg.length>0&&this.state.errorMsg.map((function(e,t){var n=e.group_id+": "+e.error_msg;return(0,m.jsx)("tr",{children:(0,m.jsx)("td",{colSpan:3,children:(0,m.jsx)("p",{className:"error",children:n})})},t)}))]})]}),(0,m.jsx)("div",{className:"share-list-container",children:(0,m.jsxs)("table",{className:"table-thead-hidden w-xs-250",children:[n,(0,m.jsx)("tbody",{children:this.state.groupPermissionItems.map((function(n,r){return(0,m.jsx)(Wt,{item:n,permissions:e.permissions,deleteGroupPermissionItem:e.deleteGroupPermissionItem,onChangeGroupPermission:e.onChangeGroupPermission,showPath:t,repoName:e.props.repoName},r)}))})]})})]})}}])}(s.Component),Xt=Kt,$t=(n(59625),function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).toggle=function(e){n.state.activeTab!==e&&n.setState({activeTab:e})},n.renderContent=function(){var e=n.state.activeTab;return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("div",{className:"share-dialog-side",children:(0,m.jsxs)(Tt.A,{pills:!0,children:[(0,m.jsx)(Et.A,{role:"tab","aria-selected":"userPermission"===e,"aria-controls":"user-perm-panel",children:(0,m.jsx)(Rt.A,{className:"userPermission"===e?"active":"",onClick:n.toggle.bind(n,"userPermission"),tabIndex:"0",onKeyDown:f.Aq.onKeyDown,children:(0,h.AP)("User Permission")})}),(0,m.jsx)(Et.A,{role:"tab","aria-selected":"groupPermission"===e,"aria-controls":"group-perm-panel",children:(0,m.jsx)(Rt.A,{className:"groupPermission"===e?"active":"",onClick:n.toggle.bind(n,"groupPermission"),tabIndex:"0",onKeyDown:f.Aq.onKeyDown,children:(0,h.AP)("Group Permission")})})]})}),(0,m.jsx)("div",{className:"share-dialog-main",children:(0,m.jsxs)(Lt.A,{activeTab:n.state.activeTab,children:[(0,m.jsx)(Ft.A,{tabId:"userPermission",role:"tabpanel",id:"user-perm-panel",children:(0,m.jsx)(zt,{repoID:n.props.repoID,repoName:n.props.repoName,folderPath:n.props.folderPath,isDepartmentRepo:n.props.isDepartmentRepo})}),(0,m.jsx)(Ft.A,{tabId:"groupPermission",role:"tabpanel",id:"group-perm-panel",children:(0,m.jsx)(Xt,{repoID:n.props.repoID,repoName:n.props.repoName,folderPath:n.props.folderPath,isDepartmentRepo:n.props.isDepartmentRepo})})]})})]})},n.state={activeTab:"userPermission"},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.repoName,n=e.folderName,r=t?(0,h.AP)("{placeholder} Folder Permission"):(0,h.AP)("Set permission of {placeholder}");return r=r.replace("{placeholder}",'<span class="op-target text-truncate mx-1">'+f.Aq.HTMLescape(t||n)+"</span>"),(0,m.jsx)("div",{children:(0,m.jsxs)(p.A,{isOpen:!0,style:{maxWidth:"980px"},className:"share-dialog",toggle:this.props.toggleDialog,children:[(0,m.jsx)(I.A,{toggle:this.props.toggleDialog,children:(0,m.jsx)("span",{dangerouslySetInnerHTML:{__html:r},className:"d-flex mw-100"})}),(0,m.jsx)(_.A,{className:"dialog-list-container share-dialog-content",role:"tablist",children:this.renderContent()})]})})}}])}(s.Component)),Zt=n(86274),Jt=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onMenuItemClick=function(e){var t=f.Aq.getEventData(e,"toggle");n.props.onMenuItemClick(t)},n.onMenuItemKeyDown=function(e){"Enter"!=e.key&&"Space"!=e.key||n.onMenuItemClick(e)},n.onDropdownToggleClick=function(e){n.toggleOperationMenu(e)},n.onDropdownToggleKeyDown=function(e){"Enter"!=e.key&&"Space"!=e.key||n.onDropdownToggleClick(e)},n.toggleOperationMenu=function(e){var t=e.target?e.target.dataset:null;t&&t.toggle&&"Rename"===t.toggle?n.setState({isItemMenuShow:!n.state.isItemMenuShow}):n.setState({isItemMenuShow:!n.state.isItemMenuShow},(function(){n.state.isItemMenuShow?n.props.onFreezedItem():n.props.onUnfreezedItem()}))},n.toggleAdvancedMenuShown=function(e){n.setState({isAdvancedMenuShown:!0})},n.toggleAdvancedMenu=function(e){e.stopPropagation(),n.setState({isAdvancedMenuShown:!n.state.isAdvancedMenuShown},(function(){n.toggleOperationMenu(e)}))},n.onDropDownMouseMove=function(e){n.state.isAdvancedMenuShown&&e.target&&"dropdown-item"===e.target.className&&n.setState({isAdvancedMenuShown:!1})},n.generatorOperations=function(){var e=n.props.repo,t=h.am&&e.encrypted&&h.ez&&h.bw,r=["Rename","Transfer"];if(h.wR&&r.push("Folder Permission"),r.push("Share Admin","Divider"),e.encrypted&&r.push("Change Password"),t&&r.push("Reset Password"),h.am){var o=e.monitored?"Unwatch File Changes":"Watch File Changes";r.push(o)}r.push("Divider","History Setting","Advanced");for(var i=0;i<r.length;i++)"Divider"===r[i]&&"Divider"===r[i+1]&&(r.splice(i,1),i--);return r},n.getAdvancedOperations=function(){var e=[];return e.push("API Token"),n.props.isPC&&h.gj&&e.push("Label Current State"),h.if&&e.push("Old Files Auto Delete"),h.vu&&e.push("SeaTable integration"),e},n.translateOperations=function(e){var t="";switch(e){case"Star":t=(0,h.AP)("Star");break;case"Unstar":t=(0,h.AP)("Unstar");break;case"Share":t=(0,h.AP)("Share");break;case"Delete":t=(0,h.AP)("Delete");break;case"Rename":t=(0,h.AP)("Rename");break;case"Transfer":t=(0,h.AP)("Transfer");break;case"History Setting":t=(0,h.AP)("History Setting");break;case"Change Password":t=(0,h.AP)("Change Password");break;case"Reset Password":t=(0,h.AP)("Reset Password");break;case"Watch File Changes":t=(0,h.AP)("Watch File Changes");break;case"Unwatch File Changes":t=(0,h.AP)("Unwatch File Changes");break;case"Folder Permission":t=(0,h.AP)("Folder Permission");break;case"Label Current State":t=(0,h.AP)("Label Current State");break;case"API Token":t="API Token";break;case"Share Admin":t=(0,h.AP)("Share Admin");break;case"Old Files Auto Delete":t=(0,h.AP)("Auto Deletion Setting");break;case"Advanced":t=(0,h.AP)("Advanced");break;case"SeaTable integration":t=(0,h.AP)("SeaTable integration")}return t},n.state={isItemMenuShow:!1,isAdvancedMenuShown:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.generatorOperations(),n=this.getAdvancedOperations();return this.props.isPC?(0,m.jsxs)(de.A,{isOpen:this.state.isItemMenuShow,toggle:this.toggleOperationMenu,children:[(0,m.jsx)(pe.A,{tag:"i",role:"button",tabIndex:"0",className:"sf-dropdown-toggle sf3-font-more sf3-font",title:(0,h.AP)("More operations"),"aria-label":(0,h.AP)("More operations"),onClick:this.onDropdownToggleClick,onKeyDown:this.onDropdownToggleKeyDown,"data-toggle":"dropdown"}),(0,m.jsx)(Ue.A,{onMouseMove:this.onDropDownMouseMove,children:t.map((function(t,r){return"Divider"==t?(0,m.jsx)(he.A,{divider:!0},r):"Advanced"==t?(0,m.jsxs)(de.A,{direction:"right",className:"w-100",isOpen:e.state.isAdvancedMenuShown,toggle:e.toggleAdvancedMenu,onMouseMove:function(e){e.stopPropagation()},children:[(0,m.jsxs)(pe.A,{className:"dropdown-item font-weight-normal rounded-0 d-flex justify-content-between align-items-center pr-2",onMouseEnter:e.toggleAdvancedMenuShown,children:[e.translateOperations(t),(0,m.jsx)("i",{className:"sf3-font-down sf3-font rotate-270"})]}),(0,m.jsx)(Ue.A,{children:n.map((function(t,n){return(0,m.jsx)(he.A,{"data-toggle":t,onClick:e.onMenuItemClick,onKeyDown:e.onMenuItemKeyDown,children:e.translateOperations(t)},n)}))})]},r):(0,m.jsx)(he.A,{"data-toggle":t,onClick:e.onMenuItemClick,onKeyDown:e.onMenuItemKeyDown,children:e.translateOperations(t)},r)}))})]}):(t.pop(),t.unshift("Delete"),t.unshift("Share"),this.props.isStarred?t.unshift("Unstar"):t.unshift("Star"),(0,m.jsxs)(de.A,{isOpen:this.state.isItemMenuShow,toggle:this.toggleOperationMenu,children:[(0,m.jsx)(pe.A,{tag:"i",className:"sf-dropdown-toggle sf3-font sf3-font-more-vertical ml-0",title:(0,h.AP)("More operations"),"aria-label":(0,h.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isItemMenuShow}),(0,m.jsxs)("div",{className:"".concat(this.state.isItemMenuShow?"":"d-none"),onClick:this.toggleOperationMenu,children:[(0,m.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),(0,m.jsx)("div",{className:"mobile-operation-menu",children:t.map((function(t,n){return"Divider"!=t?(0,m.jsx)(he.A,{className:"mobile-menu-item","data-toggle":t,onClick:e.onMenuItemClick,children:e.translateOperations(t)},n):null}))})]})]}))}}])}(s.Component),Qt=Jt,en=n(45613),tn=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onHideSelect=function(){n.setState({isEditing:!1})},n.onEditPermission=function(e){e.nativeEvent.stopImmediatePropagation(),n.setState({isEditing:!0})},n.onPermissionChanged=function(e){e.value!==n.props.currentPermission&&n.props.onPermissionChanged(e.value),n.setState({isEditing:!1})},n.onSelectHandler=function(e){e.nativeEvent.stopImmediatePropagation()},n.state={isEditing:!1},n.options=[{value:"rw",label:(0,m.jsx)("div",{children:(0,h.AP)("Read-Write")})},{value:"r",label:(0,m.jsx)("div",{children:(0,h.AP)("Read-Only")})}],n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.onHideSelect)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.onHideSelect)}},{key:"render",value:function(){var e=this.props,t=e.currentPermission,n=e.isTextMode,r="rw"===t?(0,h.AP)("Read-Write"):(0,h.AP)("Read-Only");return(0,m.jsx)("div",{onClick:this.onSelectHandler,children:n&&!this.state.isEditing?(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("span",{children:r}),this.props.isEditIconShow&&(0,m.jsx)(en.A,{title:(0,h.AP)("Edit"),className:"sf3-font sf3-font-rename attr-action-icon",op:this.onEditPermission})]}):(0,m.jsx)(Vt.by,{options:this.options,placeholder:r,onChange:this.onPermissionChanged,captureMenuScroll:!1,value:this.options.find((function(e){return e.value===t}))||null})})}}])}(s.Component),nn=n(67243),rn=n.n(nn),on=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onMouseEnter=function(){n.setState({isOperationShow:!0})},n.onMouseLeave=function(){n.setState({isOperationShow:!1})},n.onDeleteAPIToken=function(){n.props.deleteAPIToken(n.props.item.app_name)},n.onUpdateAPIToken=function(e){n.props.updateAPIToken(n.props.item.app_name,e)},n.onCopyAPIToken=function(){var e=n.props.item.api_token;rn()(e),j.A.success((0,h.AP)("API token is copied to the clipboard."))},n.state={isOperationShow:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.item;return(0,m.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,tabIndex:"0",onFocus:this.onMouseEnter,children:[(0,m.jsx)("td",{className:"name",children:e.app_name}),(0,m.jsx)("td",{children:(0,m.jsx)(tn,{isTextMode:!0,isEditIconShow:this.state.isOperationShow,currentPermission:e.permission,onPermissionChanged:this.onUpdateAPIToken})}),(0,m.jsxs)("td",{children:[(0,m.jsx)("span",{children:e.api_token}),this.state.isOperationShow&&(0,m.jsx)(en.A,{className:"action-icon sf3-font sf3-font-copy1",op:this.onCopyAPIToken,title:(0,h.AP)("Copy")})]}),(0,m.jsx)("td",{children:(0,m.jsx)(en.A,{className:"sf2-icon-x3 action-icon ".concat(this.state.isOperationShow?"":"hide"),op:this.onDeleteAPIToken,title:(0,h.AP)("Delete")})})]})}}])}(s.Component),an=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).listAPITokens=function(){k.e.listRepoAPITokens(n.repo.repo_id).then((function(e){n.setState({apiTokenList:e.data.repo_api_tokens,loading:!1})})).catch((function(e){403===e.response.status?n.setState({errorMsg:(0,h.AP)("Permission denied")}):n.handleError(e)}))},n.onInputChange=function(e){var t=e.target.value;n.setState({appName:t})},n.onKeyDown=function(e){13===e.keyCode&&(e.preventDefault(),n.addAPIToken())},n.setPermission=function(e){n.setState({permission:e})},n.addAPIToken=function(){if(n.state.appName){n.setState({isSubmitBtnActive:!1});var e=n.state,t=e.appName,r=e.permission,o=e.apiTokenList;k.e.addRepoAPIToken(n.repo.repo_id,t,r).then((function(e){o.push(e.data),n.setState({apiTokenList:o,isSubmitBtnActive:!0})})).catch((function(e){n.handleError(e),n.setState({isSubmitBtnActive:!0})}))}},n.deleteAPIToken=function(e){k.e.deleteRepoAPIToken(n.repo.repo_id,e).then((function(t){var r=n.state.apiTokenList.filter((function(t){return t.app_name!==e}));n.setState({apiTokenList:r})})).catch((function(e){n.handleError(e)}))},n.updateAPIToken=function(e,t){k.e.updateRepoAPIToken(n.repo.repo_id,e,t).then((function(r){var o=n.state.apiTokenList.filter((function(n){return n.app_name===e&&(n.permission=t),n}));n.setState({apiTokenList:o})})).catch((function(e){n.handleError(e)}))},n.handleError=function(e){e.response?j.A.danger(e.response.data.error_msg||e.response.data.detail||(0,h.AP)("Error"),{duration:3}):j.A.danger((0,h.AP)("Please check the network."),{duration:3})},n.renderContent=function(){var e=n.state.apiTokenList.map((function(e,t){return(0,m.jsx)(on,{item:e,deleteAPIToken:n.deleteAPIToken,updateAPIToken:n.updateAPIToken},t)})),t=(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"20%",children:(0,h.AP)("App Name")}),(0,m.jsx)("th",{width:"20%",children:(0,h.AP)("Permission")}),(0,m.jsx)("th",{width:"48%",children:"API Token"}),(0,m.jsx)("th",{width:"12%"})]})});return(0,m.jsxs)(s.Fragment,{children:[n.state.errorMsg&&(0,m.jsx)("p",{className:"error text-center",children:n.state.errorMsg}),!n.state.errorMsg&&(0,m.jsxs)(s.Fragment,{children:[(0,m.jsxs)("table",{className:"w-xs-250",children:[t,(0,m.jsx)("tbody",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{children:(0,m.jsx)(P.A,{type:"text",id:"appName",value:n.state.appName,onChange:n.onInputChange,onKeyDown:n.onKeyDown})}),(0,m.jsx)("td",{children:(0,m.jsx)(tn,{isTextMode:!1,isEditIconShow:!1,currentPermission:n.state.permission,onPermissionChanged:n.setPermission})}),(0,m.jsx)("td",{children:(0,m.jsx)("span",{className:"text-secondary",children:"--"})}),(0,m.jsx)("td",{children:(0,m.jsx)(O.A,{color:"primary",onClick:n.addAPIToken,disabled:!n.state.isSubmitBtnActive,children:(0,h.AP)("Submit")})})]})})]}),(0,m.jsx)("div",{style:{minHeight:"10rem",maxHeight:"18rem"},children:0!==n.state.apiTokenList.length&&(0,m.jsxs)("table",{className:"table-thead-hidden w-xs-250",children:[t,(0,m.jsx)("tbody",{children:e})]})}),n.state.loading&&(0,m.jsx)($.A,{})]})]})},n.state={apiTokenList:[],permission:"rw",appName:"",errorMsg:"",loading:!0,isSubmitBtnActive:!0},n.repo=n.props.repo,n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.listAPITokens()}},{key:"render",value:function(){var e=this.repo,t='<span class="op-target text-truncate mr-1">'+f.Aq.HTMLescape(e.repo_name)+"</span>",n=(0,h.AP)("{placeholder} API Token").replace("{placeholder}",t);return(0,m.jsxs)(p.A,{isOpen:!0,style:{maxWidth:"800px"},toggle:this.props.onRepoAPITokenToggle,children:[(0,m.jsx)(I.A,{toggle:this.props.onRepoAPITokenToggle,children:(0,m.jsx)("span",{dangerouslySetInnerHTML:{__html:n},className:"d-flex mw-100"})}),(0,m.jsx)(_.A,{children:(0,m.jsx)("div",{className:"o-auto",children:this.renderContent()})})]})}}])}(s.Component),sn=n(90675),ln=n(10467),cn=function(e){function t(){return(0,r.A)(this,t),(0,i.A)(this,t,arguments)}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.accountName,n=e.closeDialog;return(0,m.jsxs)(p.A,{isOpen:!0,toggle:n,children:[(0,m.jsx)(I.A,{toggle:n,children:(0,h.AP)("Delete SeaTable base")}),(0,m.jsx)(_.A,{children:(0,m.jsx)("p",{className:"pb-6",children:(0,h.AP)("Are you sure you want to delete SeaTable {accountName}?").replace("{accountName}",t)})}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(O.A,{color:"secondary",onClick:n,children:(0,h.AP)("Cancel")}),(0,m.jsx)(O.A,{color:"primary",onClick:this.props.onDeleteSeatables,children:(0,h.AP)("Delete")})]})]})}}])}(s.Component),un=cn,dn=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).openDialog=function(){n.setState({isShowDialog:!0})},n.closeDialog=function(){n.setState({isShowDialog:!1})},n.onDeleteSeatables=function(){var e=n.props.setting;n.props.deleteStableAccountSetting(e,"seatable_account_manage"),n.closeDialog()},n.state={isShowDialog:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.state.isShowDialog,t=this.props,n=t.setting,r=t.t,o=t.index,i=n.base_api_token,a=n.base_name,s=n.seatable_server_url;return(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{width:"30%",className:"text-truncate",title:a,"aria-label":a,children:a}),(0,m.jsx)("td",{id:"abc-".concat(o),width:"55%",className:"text-truncate",title:s,"aria-label":s,children:s}),(0,m.jsxs)("td",{width:"15%",children:[(0,m.jsx)("span",{className:"account-operation-btn",onClick:this.props.editSeatableSettingAccount.bind(this,i),title:(0,h.AP)("Edit"),"aria-label":(0,h.AP)("Edit"),children:(0,m.jsx)("i",{className:"sf2-icon-edit",style:{color:"#999"}})}),(0,m.jsx)("span",{className:"account-operation-btn",onClick:this.openDialog,title:(0,h.AP)("Delete"),"aria-label":(0,h.AP)("Delete"),children:(0,m.jsx)("i",{className:"sf3-font-delete1 sf3-font",style:{color:"#999"}})})]}),e&&(0,m.jsx)(un,{t:r,accountName:a,onDeleteSeatables:this.onDeleteSeatables,closeDialog:this.closeDialog})]},"account-".concat(i))}}])}(s.Component),pn=function(e){function t(){var e;(0,r.A)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=(0,i.A)(this,t,[].concat(o))).renderContent=function(){var t=e.props.seatableSettings;return Array.isArray(t)&&0!==t.length?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("table",{className:"accounts-list-header",children:(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"30%",children:(0,h.AP)("SeaTable base name")}),(0,m.jsx)("th",{width:"55%",children:(0,h.AP)("SeaTable server URL")}),(0,m.jsx)("th",{width:"15%",children:" "})]})})}),(0,m.jsx)("div",{className:"accounts-list-body",children:(0,m.jsx)("table",{children:(0,m.jsx)("tbody",{children:t.map((function(t,n){return(0,m.jsx)(dn,{index:n,setting:t,editSeatableSettingAccount:e.props.editSeatableSettingAccount,deleteStableAccountSetting:e.props.deleteStableAccountSetting},t.base_api_token)}))})})})]}):(0,m.jsx)(J.A,{text:(0,h.AP)("No SeaTable bases")})},e}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return(0,m.jsxs)("div",{className:"accounts-manage",children:[(0,m.jsxs)("div",{className:"accounts-manage-header d-flex align-items-center justify-content-between",children:[(0,m.jsx)("span",{children:"SeaTable"}),(0,m.jsx)(O.A,{color:"primary",size:"sm",outline:!0,onClick:this.props.changeStatus,children:(0,h.AP)("Add")})]}),(0,m.jsx)("div",{className:"accounts-list mt-2",children:this.renderContent()})]})}}])}(s.Component),hn=pn,fn=n(99121),mn=function(e){function t(e){var n;(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onChangeBaseName=function(e){var t=e.target.value;t!==n.state.base_name&&n.setState({base_name:t,errMessage:""})},n.onChangeSeatableUrl=function(e){var t=e.target.value;t!==n.state.seatable_url&&n.setState({seatable_url:t,successMessage:null,stage:"toCheck",errMessage:""})},n.onChangeSeatableApiToken=function(e){var t=e.target.value;t!==n.state.seatable_api_token&&n.setState({seatable_api_token:t,successMessage:null,stage:"toCheck",errMessage:""})},n.addSeatableAccountSetting=function(){var e=n.state,t=e.base_name,r=e.seatable_url,o=e.seatable_api_token;t=t.trim(),r=r.trim(),o=o.trim();var i="";if(t?r?o||(i=(0,h.AP)("SeaTable API token is required")):i=(0,h.AP)("SeaTable server URL is required"):i=(0,h.AP)("SeaTable base name is required"),n.setState({errMessage:i}),!i){var a={base_name:t,seatable_url:r,seatable_api_token:o};n.props.onSubmit(a,"seatable_account_manage")}},n.testSeatableAPIToken=(0,ln.A)((0,sn.A)().mark((function e(){var t,r,o,i,a,s,l;return(0,sn.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.state,r=t.seatable_url,o=t.seatable_api_token,k.e.req.defaults.headers.Authorization="Token ".concat(o),e.next=4,k.e.req.get("".concat(r,"api/v2.1/dtable/app-access-token/")).then((function(e){return[e,null]})).catch((function(e){return[null,e]}));case 4:i=e.sent,a=(0,F.A)(i,2),s=a[0],l=a[1],s&&n.setState({successMessage:s.data,stage:"toSubmit"}),l&&n.setState({errMessage:(0,h.AP)("URL or SeaTable API token is invalid")});case 10:case"end":return e.stop()}}),e)}))),n.togglePasswordShow=function(){"password"===n.state.passwordType?n.setState({passwordType:"text"}):n.setState({passwordType:"password"})};var o=e.currentDtableInfo;return n.state={errMessage:"",base_name:(null===o||void 0===o?void 0:o.base_name)||"",seatable_url:(null===o||void 0===o?void 0:o.seatable_url)||"",seatable_api_token:(null===o||void 0===o?void 0:o.base_api_token)||"",successMessage:null,stage:"toCheck",passwordType:"password"},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.state,t=e.errMessage,n=e.stage,r=e.successMessage,o=e.base_name,i=e.seatable_url,a=e.seatable_api_token,s=e.passwordType;return(0,m.jsxs)("div",{className:"add-account",children:[(0,m.jsxs)("div",{className:"add-account-header d-flex align-items-center justify-content-between",children:[(0,m.jsxs)("span",{children:[(0,m.jsx)("span",{className:"back-btn d-inline-flex align-items-center justify-content-center",onClick:this.props.changeStatus,children:(0,m.jsx)("i",{className:"link-icon icon-left sf3-font sf3-font-arrow",style:{transform:"rotate(180deg)",color:"#999"}})}),(0,m.jsx)("span",{className:"add-account-header-text",children:(0,h.AP)("Add SeaTable Integration")})]}),(0,m.jsx)("button",{onClick:"toCheck"===n?this.testSeatableAPIToken:this.addSeatableAccountSetting,type:"button",className:"btn btn-primary add-account-btn",children:"toCheck"===n?(0,h.AP)("Check"):(0,h.AP)("Submit")})]}),(0,m.jsxs)("div",{className:"base-account",children:[(0,m.jsxs)("div",{className:"account-name-desc",children:[(0,m.jsxs)(wt.A,{children:[(0,m.jsx)(St.A,{children:(0,h.AP)("SeaTable base name")}),(0,m.jsx)(P.A,{value:o,onChange:this.onChangeBaseName})]}),(0,m.jsxs)(wt.A,{children:[(0,m.jsx)(St.A,{children:(0,h.AP)("SeaTable server URL")}),(0,m.jsx)(P.A,{value:i,onChange:this.onChangeSeatableUrl})]}),(0,m.jsxs)(wt.A,{className:"base-account-password",children:[(0,m.jsx)(St.A,{children:(0,h.AP)("SeaTable API token")}),(0,m.jsxs)(Ut.A,{children:[(0,m.jsx)(P.A,{value:a,type:s,onChange:this.onChangeSeatableApiToken}),(0,m.jsx)(fn.A,{children:(0,m.jsx)("i",{className:"sf3-font sf3-font-eye".concat("password"===s?"-slash":""," cursor-pointer"),onClick:this.togglePasswordShow})})]})]})]}),t&&(0,m.jsx)(Dt.A,{color:"danger",children:t}),r&&(0,m.jsxs)(Dt.A,{color:"success",children:[(0,m.jsx)("span",{className:"dtable-font dtable-icon-check-circle mr-2"}),(0,h.AP)("Successfully connected to SeaTable")]})]})]})}}])}(s.Component),gn=mn,vn="seatable_account_manage",yn="add_seatable_account",xn="update_seatable_account",An=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).getSeatableSettings=function(){var e=(0,ln.A)((0,sn.A)().mark((function e(t){var r,o,i,a;return(0,sn.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k.e.req.defaults.headers.Authorization=null,e.next=3,k.e.getFileDownloadLink(n.repo.repo_id,h.lI).then((function(e){return[e,null]})).catch((function(e){return[null,e]}));case 3:if(r=e.sent,o=(0,F.A)(r,1),!(i=o[0])||!i.data){e.next=11;break}return e.next=9,k.e.getFileContent(i.data);case 9:null!==(a=e.sent)&&void 0!==a&&a.data&&a.data&&(n.setState({seatableSettings:a.data}),t&&n.setState({status:t}));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.changeTab=function(e){n.state.activeTab!==e&&n.setState({activeTab:e})},n.changeStatus=function(e){n.setState({status:e})},n.getFile=function(e,t){var n=e.base_name,r=e.seatable_url,o=e.seatable_api_token,i=[{base_name:n,seatable_server_url:r,base_api_token:o}];if(t&&0!==t.length){var a=null===t||void 0===t?void 0:t.findIndex((function(e){return e.base_api_token===o}));-1!==a?t[a]=i[0]:t.push(i[0]),i=t}var s=h.lI.split("/")[2],l=JSON.stringify(i);return new File([l],s)},n.editSeatableSettingAccount=function(e){var t=n.state.seatableSettings;n.setState({status:xn,currentDtableInfo:t.find((function(t){return t.base_api_token===e}))})},n.deleteStableAccountSetting=function(){var e=(0,ln.A)((0,sn.A)().mark((function e(t,r){var o,i,a,s,l,c,u,d,p,f,m;return(0,sn.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.base_api_token,k.e.req.defaults.headers.Authorization=null,e.next=4,k.e.getFileDownloadLink(n.repo.repo_id,h.lI).then((function(e){return[e,null]})).catch((function(e){return[null,e]}));case 4:if(i=e.sent,a=(0,F.A)(i,1),!(s=a[0])||!s.data){e.next=25;break}return e.next=10,k.e.getFileContent(s.data);case 10:if(null===(l=e.sent)||void 0===l||!l.data){e.next=25;break}if(c=l.data,-1===(u=null===c||void 0===c?void 0:c.findIndex((function(e){return e.base_api_token===o})))){e.next=25;break}return c.splice(u,1),d=JSON.stringify(c),p=h.lI.split("/")[2],f=new File([d],p),e.next=21,k.e.getUpdateLink(n.repo.repo_id,h.lI.slice(0,10));case 21:return m=e.sent,e.next=24,k.e.updateFile(m.data,h.lI,p,f).catch((function(e){j.A.danger((0,h.AP)(e.message))}));case 24:n.getSeatableSettings(r);case 25:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),n.onSubmit=function(){var e=(0,ln.A)((0,sn.A)().mark((function e(t,r){var o,i,a,s,l,c,u,d,p,f,m;return(0,sn.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k.e.req.defaults.headers.Authorization=null,e.next=3,k.e.getFileDownloadLink(n.repo.repo_id,h.lI).then((function(e){return[e,null]})).catch((function(e){return[null,e]}));case 3:if(o=e.sent,i=(0,F.A)(o,2),a=i[0],s=i[1],!a||!a.data){e.next=20;break}return e.next=10,k.e.getFileContent(a.data);case 10:if(null===(l=e.sent)||void 0===l||!l.data){e.next=20;break}return c=n.getFile(t,l.data),e.next=15,k.e.getUpdateLink(n.repo.repo_id,h.lI.slice(0,10));case 15:return u=e.sent,d=h.lI.split("/")[2],e.next=19,k.e.updateFile(u.data,h.lI,d,c).catch((function(e){j.A.danger((0,h.AP)(e.message))}));case 19:n.getSeatableSettings(r);case 20:if(!s){e.next=32;break}return e.next=23,k.e.getFileServerUploadLink(n.repo.repo_id,h.Jz);case 23:return p=e.sent,f=n.getFile(t),(m=new FormData).append("file",f),m.append("relative_path",h.lI.split("/")[1]),m.append("parent_dir",h.Jz),e.next=31,k.e.uploadImage(p.data+"?ret-json=1",m).catch((function(e){j.A.danger((0,h.AP)(e.message))}));case 31:n.getSeatableSettings(r);case 32:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),n.state={activeTab:"SeaTable",seatableSettings:[],baseApiToken:"",isPasswordVisible:!1,isShowDialog:!1,currentDtableInfo:{},status:vn},n.repo=n.props.repo,n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.getSeatableSettings()}},{key:"render",value:function(){var e=this,t=this.state,n=t.seatableSettings,r=t.status,o=t.currentDtableInfo,i=this.props.onSeaTableIntegrationToggle,a=this.repo,s='<span class="op-target">'+f.Aq.HTMLescape(a.repo_name)+"</span>",l=(0,h.AP)("{placeholder} SeaTable integration").replace("{placeholder}",s);return(0,m.jsxs)(p.A,{isOpen:!0,toggle:i,className:"account-dialog",children:[(0,m.jsx)(I.A,{toggle:i,children:(0,m.jsx)("p",{dangerouslySetInnerHTML:{__html:l},className:"m-0"})}),(0,m.jsx)(_.A,{className:"account-dialog-content",children:(0,m.jsxs)("div",{className:"account-dialog-main",children:[r===vn&&(0,m.jsx)(hn,{seatableSettings:n,changeStatus:function(){return e.changeStatus(yn)},editSeatableSettingAccount:this.editSeatableSettingAccount,deleteStableAccountSetting:this.deleteStableAccountSetting}),r===yn&&(0,m.jsx)(gn,{changeStatus:function(){return e.changeStatus(vn)},onSubmit:this.onSubmit}),r===xn&&(0,m.jsx)(gn,{currentDtableInfo:o,changeStatus:function(){return e.changeStatus(vn)},onSubmit:this.onSubmit})]})})]})}}])}(s.Component),Cn=An,bn=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onMouseEnter=function(){n.setState({isOperationShow:!0})},n.onMouseLeave=function(){n.setState({isOperationShow:!1})},n.onDeleteLink=function(e){e.preventDefault(),n.props.deleteItem(n.props.item)},n.state={isOperationShow:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e,t=this.props.item,n="/"===t.path?"/":t.path.slice(0,t.path.length-1);return e=t.is_dir?"".concat(h.Yc,"library/").concat(t.repo_id,"/").concat(encodeURIComponent(t.repo_name)).concat(f.Aq.encodePath(n)):"".concat(h.Yc,"lib/").concat(t.repo_id,"/file").concat(f.Aq.encodePath(t.path)),(0,m.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onFocus:this.onMouseEnter,children:[(0,m.jsx)("td",{className:"name",children:t.creator_name}),(0,m.jsx)("td",{children:t.is_dir?(0,m.jsx)(c.N_,{to:e,children:t.obj_name}):(0,m.jsx)("a",{href:e,target:"_blank",rel:"noreferrer",children:t.obj_name})}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:t.link,target:"_blank",rel:"noreferrer",children:t.link})}),(0,m.jsx)("td",{children:(0,m.jsx)("span",{tabIndex:"0",role:"button",className:"sf2-icon-x3 action-icon ".concat(this.state.isOperationShow?"":"invisible"),onClick:this.onDeleteLink,onKeyDown:f.Aq.onKeyDown,title:(0,h.AP)("Delete"),"aria-label":(0,h.AP)("Delete")})})]})}}])}(s.Component),wn=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).deleteItem=function(e){k.e.deleteRepoShareLink(n.props.repo.repo_id,e.token).then((function(){var t=n.state.items.filter((function(t){return t.token!==e.token}));n.setState({items:t});var r=(0,h.AP)("Successfully deleted 1 item");j.A.success(r)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.state={loading:!0,errorMsg:"",items:[]},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;k.e.listRepoShareLinks(this.props.repo.repo_id).then((function(t){e.setState({loading:!1,items:t.data})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.loading,r=t.errorMsg,o=t.items;return(0,m.jsxs)(s.Fragment,{children:[n&&(0,m.jsx)($.A,{}),!n&&r&&(0,m.jsx)("p",{className:"error text-center mt-8",children:r}),!n&&!r&&!o.length&&(0,m.jsx)(J.A,{text:(0,h.AP)("No share links")}),!n&&!r&&o.length>0&&(0,m.jsxs)("table",{className:"table-hover",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"22%",children:(0,h.AP)("Creator")}),(0,m.jsx)("th",{width:"20%",children:(0,h.AP)("Name")}),(0,m.jsx)("th",{width:"50%",children:(0,h.AP)("Link")}),(0,m.jsx)("th",{width:"8%"})]})}),(0,m.jsx)("tbody",{children:o.map((function(t,n){return(0,m.jsx)(bn,{item:t,deleteItem:e.deleteItem},n)}))})]})]})}}])}(s.Component),Sn=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onMouseEnter=function(){n.setState({isOperationShow:!0})},n.onMouseLeave=function(){n.setState({isOperationShow:!1})},n.onDeleteLink=function(e){e.preventDefault(),n.props.deleteItem(n.props.item)},n.state={isOperationShow:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.item,t="/"===e.path?"/":e.path.slice(0,e.path.length-1),n="".concat(h.Yc,"library/").concat(e.repo_id,"/").concat(encodeURIComponent(e.repo_name)).concat(f.Aq.encodePath(t));return(0,m.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onFocus:this.onMouseEnter,children:[(0,m.jsx)("td",{className:"name",children:e.creator_name}),(0,m.jsx)("td",{children:(0,m.jsx)(c.N_,{to:n,children:e.obj_name})}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:e.link,target:"_blank",rel:"noreferrer",children:e.link})}),(0,m.jsx)("td",{children:(0,m.jsx)("span",{tabIndex:"0",role:"button",className:"sf2-icon-x3 action-icon ".concat(this.state.isOperationShow?"":"invisible"),onClick:this.onDeleteLink,onKeyDown:f.Aq.onKeyDown,title:(0,h.AP)("Delete"),"aria-label":(0,h.AP)("Delete")})})]})}}])}(s.Component),Dn=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).deleteItem=function(e){k.e.deleteRepoUploadLink(n.props.repo.repo_id,e.token).then((function(){var t=n.state.items.filter((function(t){return t.token!==e.token}));n.setState({items:t});var r=(0,h.AP)("Successfully deleted 1 item");j.A.success(r)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.state={loading:!0,errorMsg:"",items:[]},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;k.e.listRepoUploadLinks(this.props.repo.repo_id).then((function(t){e.setState({loading:!1,items:t.data})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.loading,r=t.errorMsg,o=t.items;return(0,m.jsxs)(s.Fragment,{children:[n&&(0,m.jsx)($.A,{}),!n&&r&&(0,m.jsx)("p",{className:"error text-center mt-8",children:r}),!n&&!r&&!o.length&&(0,m.jsx)(J.A,{text:(0,h.AP)("No upload links")}),!n&&!r&&o.length>0&&(0,m.jsxs)("table",{className:"table-hover",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"22%",children:(0,h.AP)("Creator")}),(0,m.jsx)("th",{width:"20%",children:(0,h.AP)("Name")}),(0,m.jsx)("th",{width:"50%",children:(0,h.AP)("Link")}),(0,m.jsx)("th",{width:"8%"})]})}),(0,m.jsx)("tbody",{children:o.map((function(t,n){return(0,m.jsx)(Sn,{item:t,deleteItem:e.deleteItem},n)}))})]})]})}}])}(s.Component),kn=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onMouseEnter=function(){n.setState({isOperationShow:!0})},n.onMouseLeave=function(){n.setState({isOperationShow:!1})},n.onDeleteLink=function(e){e.preventDefault(),n.props.deleteItem(n.props.item)},n.changePerm=function(e){var t=n.props.item;k.e.updateShareToUserItemPermission(t.repo_id,t.path,"user",t.share_to,e).then((function(){n.setState({permission:e})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.onEditPermission=function(e){e.nativeEvent.stopImmediatePropagation(),n.setState({isShowPermEditor:!0})},n.state={permission:n.props.item.permission,isOperationShow:!1,isShowPermEditor:!1},n.permissions=["rw","r"],h.am&&("/"===n.props.item.path&&n.props.isRepoOwner&&n.permissions.push("admin"),n.permissions.push("cloud-edit","preview")),n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e,t=this.props.item,n="/"===t.path?"/":t.path.slice(0,t.path.length-1);return e="".concat(h.Yc,"library/").concat(t.repo_id,"/").concat(encodeURIComponent(t.repo_name)).concat(f.Aq.encodePath(n)),(0,m.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onFocus:this.onMouseEnter,children:[(0,m.jsx)("td",{children:(0,m.jsx)(c.N_,{to:e,children:f.Aq.getFolderName(t.path)})}),(0,m.jsx)("td",{className:"name",children:t.share_to_name}),(0,m.jsxs)("td",{children:[!this.state.isShowPermEditor&&(0,m.jsxs)("div",{children:[(0,m.jsx)("span",{children:t.permission_name||f.Aq.sharePerms(this.state.permission)}),this.state.isOperationShow&&(0,m.jsx)("a",{href:"#",role:"button","aria-label":(0,h.AP)("Edit"),title:(0,h.AP)("Edit"),className:"sf3-font sf3-font-rename attr-action-icon",onClick:this.onEditPermission})]}),this.state.isShowPermEditor&&(0,m.jsx)(be.A,{repoID:t.repo_id,isTextMode:!0,isEditIconShow:this.state.isOperationShow,isEditing:!0,currentPermission:this.state.permission,permissions:this.permissions,onPermissionChanged:this.changePerm})]}),(0,m.jsx)("td",{children:(0,m.jsx)("span",{tabIndex:"0",role:"button",className:"sf2-icon-x3 action-icon ".concat(this.state.isOperationShow?"":"invisible"),onClick:this.onDeleteLink,onKeyDown:f.Aq.onKeyDown,title:(0,h.AP)("Delete"),"aria-label":(0,h.AP)("Delete")})})]})}}])}(s.Component),Mn=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).deleteItem=function(e){k.e.deleteShareToUserItem(e.repo_id,e.path,"user",e.share_to).then((function(t){var r=n.state.items.filter((function(t){return t.path+t.share_to!==e.path+e.share_to}));n.setState({items:r});var o=(0,h.AP)("Successfully deleted 1 item");j.A.success(o)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.state={loading:!0,errorMsg:"",items:[]},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;k.e.getAllRepoFolderShareInfo(this.props.repo.repo_id,"user").then((function(t){e.setState({loading:!1,items:t.data.share_info_list})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.loading,r=t.errorMsg,o=t.items,i=this.props.repo.owner_email===h.Xh;return(0,m.jsxs)(s.Fragment,{children:[n&&(0,m.jsx)($.A,{}),!n&&r&&(0,m.jsx)("p",{className:"error text-center mt-8",children:r}),!n&&!r&&!o.length&&(0,m.jsx)(J.A,{text:(0,h.AP)("No user shares")}),!n&&!r&&o.length>0&&(0,m.jsxs)("table",{className:"table-hover",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"30%",children:(0,h.AP)("Name")}),(0,m.jsx)("th",{width:"30%",children:(0,h.AP)("User")}),(0,m.jsx)("th",{width:"30%",children:(0,h.AP)("Permission")}),(0,m.jsx)("th",{width:"10%"})]})}),(0,m.jsx)("tbody",{children:o.map((function(t,n){return(0,m.jsx)(kn,{item:t,deleteItem:e.deleteItem,isRepoOwner:i},n)}))})]})]})}}])}(s.Component),jn=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onMouseEnter=function(){n.setState({isOperationShow:!0})},n.onMouseLeave=function(){n.setState({isOperationShow:!1})},n.onDeleteLink=function(e){e.preventDefault(),n.props.deleteItem(n.props.item)},n.changePerm=function(e){var t=n.props.item;k.e.updateShareToGroupItemPermission(t.repo_id,t.path,"group",t.share_to,e).then((function(){n.setState({permission:e})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.onEditPermission=function(e){e.nativeEvent.stopImmediatePropagation(),n.setState({isShowPermEditor:!0})},n.state={permission:n.props.item.permission,isOperationShow:!1,isShowPermEditor:!1},n.permissions=["rw","r"],h.am&&("/"===n.props.item.path&&n.props.isRepoOwner&&n.permissions.push("admin"),n.permissions.push("cloud-edit","preview")),n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e,t=this.props.item,n="/"===t.path?"/":t.path.slice(0,t.path.length-1);return e="".concat(h.Yc,"library/").concat(t.repo_id,"/").concat(encodeURIComponent(t.repo_name)).concat(f.Aq.encodePath(n)),(0,m.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onFocus:this.onMouseEnter,children:[(0,m.jsx)("td",{children:(0,m.jsx)(c.N_,{to:e,children:f.Aq.getFolderName(t.path)})}),(0,m.jsx)("td",{className:"name",children:t.share_to_name}),(0,m.jsxs)("td",{children:[!this.state.isShowPermEditor&&(0,m.jsxs)("div",{children:[(0,m.jsx)("span",{children:t.permission_name||f.Aq.sharePerms(this.state.permission)}),this.state.isOperationShow&&(0,m.jsx)("a",{href:"#",role:"button","aria-label":(0,h.AP)("Edit"),title:(0,h.AP)("Edit"),className:"sf3-font sf3-font-rename attr-action-icon",onClick:this.onEditPermission})]}),this.state.isShowPermEditor&&(0,m.jsx)(be.A,{repoID:t.repo_id,isTextMode:!0,isEditIconShow:this.state.isOperationShow,isEditing:!0,currentPermission:this.state.permission,permissions:this.permissions,onPermissionChanged:this.changePerm})]}),(0,m.jsx)("td",{children:(0,m.jsx)("span",{tabIndex:"0",role:"button",className:"sf2-icon-x3 action-icon ".concat(this.state.isOperationShow?"":"invisible"),onClick:this.onDeleteLink,onKeyDown:f.Aq.onKeyDown,title:(0,h.AP)("Delete"),"aria-label":(0,h.AP)("Delete")})})]})}}])}(s.Component),In=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).deleteItem=function(e){k.e.deleteShareToGroupItem(e.repo_id,e.path,"group",e.share_to).then((function(t){var r=n.state.items.filter((function(t){return t.path+t.share_to!==e.path+e.share_to}));n.setState({items:r});var o=(0,h.AP)("Successfully deleted 1 item");j.A.success(o)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.state={loading:!0,errorMsg:"",items:[]},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;k.e.getAllRepoFolderShareInfo(this.props.repo.repo_id,"group").then((function(t){e.setState({loading:!1,items:t.data.share_info_list})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.loading,r=t.errorMsg,o=t.items,i=this.props.repo.owner_email===h.Xh;return(0,m.jsxs)(s.Fragment,{children:[n&&(0,m.jsx)($.A,{}),!n&&r&&(0,m.jsx)("p",{className:"error text-center mt-8",children:r}),!n&&!r&&!o.length&&(0,m.jsx)(J.A,{text:(0,h.AP)("No group shares")}),!n&&!r&&o.length>0&&(0,m.jsxs)("table",{className:"table-hover",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"30%",children:(0,h.AP)("Name")}),(0,m.jsx)("th",{width:"30%",children:(0,h.AP)("Group")}),(0,m.jsx)("th",{width:"30%",children:(0,h.AP)("Permission")}),(0,m.jsx)("th",{width:"10%"})]})}),(0,m.jsx)("tbody",{children:o.map((function(t,n){return(0,m.jsx)(jn,{item:t,deleteItem:e.deleteItem,isRepoOwner:i},n)}))})]})]})}}])}(s.Component),_n=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).getInitialActiveTab=function(){return n.enableShareLink?"shareLink":n.enableUploadLink?"uploadLink":"shareToUser"},n.toggle=function(e){n.state.activeTab!==e&&n.setState({activeTab:e})},n.onTabKeyDown=function(e){"Enter"!=e.key&&"Space"!=e.key||e.target.click()},n.enableShareLink=!n.props.repo.encrypted&&h.zn,n.enableUploadLink=!n.props.repo.encrypted&&h.fY,n.state={activeTab:n.getInitialActiveTab()},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.state.activeTab,t=this.props.repo.repo_name,n=(0,h.AP)("{placeholder} Share Admin");return n=n.replace("{placeholder}",'<span class="op-target text-truncate mx-1">'+f.Aq.HTMLescape(t)+"</span>"),(0,m.jsx)("div",{children:(0,m.jsxs)(p.A,{isOpen:!0,style:{maxWidth:"760px"},className:"share-dialog",toggle:this.props.toggleDialog,children:[(0,m.jsx)(I.A,{toggle:this.props.toggleDialog,children:(0,m.jsx)("span",{dangerouslySetInnerHTML:{__html:n},className:"d-flex mw-100"})}),(0,m.jsx)(_.A,{className:"dialog-list-container share-dialog-content",role:"tablist",children:(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("div",{className:"share-dialog-side",children:(0,m.jsxs)(Tt.A,{pills:!0,children:[this.enableShareLink&&(0,m.jsx)(Et.A,{role:"tab","aria-selected":"shareLink"===e,"aria-controls":"share-link-panel",children:(0,m.jsx)(Rt.A,{className:"shareLink"===e?"active":"",onClick:this.toggle.bind(this,"shareLink"),tabIndex:"0",onKeyDown:this.onTabKeyDown,children:(0,h.AP)("Share Links")})}),this.enableUploadLink&&(0,m.jsx)(Et.A,{role:"tab","aria-selected":"uploadLink"===e,"aria-controls":"upload-link-panel",children:(0,m.jsx)(Rt.A,{className:"uploadLink"===e?"active":"",onClick:this.toggle.bind(this,"uploadLink"),tabIndex:"0",onKeyDown:this.onTabKeyDown,children:(0,h.AP)("Upload Links")})}),(0,m.jsx)(Et.A,{role:"tab","aria-selected":"shareToUser"===e,"aria-controls":"share-to-user-panel",children:(0,m.jsx)(Rt.A,{className:"shareToUser"===e?"active":"",onClick:this.toggle.bind(this,"shareToUser"),tabIndex:"0",onKeyDown:this.onTabKeyDown,children:(0,h.AP)("User Shares")})}),(0,m.jsx)(Et.A,{role:"tab","aria-selected":"shareToGroup"===e,"aria-controls":"share-to-group-panel",children:(0,m.jsx)(Rt.A,{className:"shareToGroup"===e?"active":"",onClick:this.toggle.bind(this,"shareToGroup"),tabIndex:"0",onKeyDown:this.onTabKeyDown,children:(0,h.AP)("Group Shares")})})]})}),(0,m.jsx)("div",{className:"share-dialog-main",children:(0,m.jsxs)(Lt.A,{activeTab:this.state.activeTab,children:[this.enableShareLink&&"shareLink"===e&&(0,m.jsx)(Ft.A,{tabId:"shareLink",role:"tabpanel",id:"share-link-panel",children:(0,m.jsx)(wn,{repo:this.props.repo})}),this.enableUploadLink&&"uploadLink"===e&&(0,m.jsx)(Ft.A,{tabId:"uploadLink",role:"tabpanel",id:"upload-link-panel",children:(0,m.jsx)(Dn,{repo:this.props.repo})}),"shareToUser"===e&&(0,m.jsx)(Ft.A,{tabId:"shareToUser",role:"tabpanel",id:"share-to-user-panel",children:(0,m.jsx)(Mn,{repo:this.props.repo})}),"shareToGroup"===e&&(0,m.jsx)(Ft.A,{tabId:"shareToGroup",role:"tabpanel",id:"share-to-group-panel",children:(0,m.jsx)(In,{repo:this.props.repo})})]})})]})})]})})}}])}(s.Component),Pn=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).submit=function(){var e;if(n.state.isAutoDel){e=n.state.autoDelDays;if(!/^-?\d+$/.test(e)||e<=0)return void n.setState({errorInfo:(0,h.AP)("Please enter a positive integer")})}else e=0;var t=n.props.repoID;k.e.setRepoOldFilesAutoDelDays(t,e).then((function(e){n.props.toggleDialog(),j.A.success((0,h.AP)("Successfully set it."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.handleKeyDown=function(e){"Enter"===e.key&&(n.submit(),e.preventDefault())},n.onChange=function(e){var t=e.target.value;n.setState({autoDelDays:t})},n.updateRadioCheck=function(e){"noAutoDel"===e?n.setState({isAutoDel:!1}):"autoDel"===e&&n.setState({isAutoDel:!0})},n.state={autoDelDays:0,isAutoDel:!1,errorInfo:""},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;k.e.getRepoOldFilesAutoDelDays(this.props.repoID).then((function(t){e.setState({autoDelDays:t.data.auto_delete_days,isAutoDel:t.data.auto_delete_days>0})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))}},{key:"render",value:function(){var e=this;return(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.props.toggleDialog,children:[(0,m.jsx)(I.A,{toggle:this.props.toggleDialog,children:(0,h.AP)("Auto deletion")}),(0,m.jsx)(_.A,{children:(0,m.jsxs)(bt.A,{children:[(0,m.jsxs)(wt.A,{check:!0,children:[(0,m.jsx)(P.A,{type:"radio",name:"radio1",checked:!this.state.isAutoDel,onChange:function(){e.updateRadioCheck("noAutoDel")}})," ",(0,m.jsx)(St.A,{children:(0,h.AP)("Do not automatically delete files")})]}),(0,m.jsxs)(wt.A,{check:!0,children:[(0,m.jsx)(P.A,{type:"radio",name:"radio1",checked:this.state.isAutoDel,onChange:function(){e.updateRadioCheck("autoDel")}})," ",(0,m.jsx)(St.A,{children:(0,h.AP)("Automatically delete files that are not modified within certain days:")}),(0,m.jsx)(P.A,{type:"text",className:"expire-input",value:this.state.autoDelDays,disabled:!this.state.isAutoDel,onChange:this.onChange,onKeyDown:this.handleKeyDown})," ",(0,m.jsx)(St.A,{children:(0,m.jsx)("span",{children:(0,h.AP)("days")})})]}),this.state.errorInfo&&(0,m.jsx)(Dt.A,{color:"danger",children:this.state.errorInfo})]})}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(O.A,{color:"secondary",onClick:this.props.toggleDialog,children:(0,h.AP)("Cancel")}),(0,m.jsx)(O.A,{color:"primary",onClick:this.submit,children:(0,h.AP)("Submit")})]})]})}}])}(s.Component),Nn=Pn,On=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onFocus=function(){n.props.isItemFreezed||n.setState({isOpIconShow:!0})},n.onMouseEnter=function(){n.props.isItemFreezed||n.setState({isOpIconShow:!0,highlight:!0})},n.onMouseLeave=function(){n.props.isItemFreezed||n.setState({isOpIconShow:!1,highlight:!1})},n.onMenuItemClick=function(e){switch(e){case"Star":case"Unstar":n.onToggleStarRepo();break;case"Share":n.onShareToggle();break;case"Delete":n.onDeleteToggle();break;case"Rename":n.onRenameToggle();break;case"Transfer":n.onTransferToggle();break;case"History Setting":n.onHistorySettingToggle();break;case"Change Password":n.onChangePasswordToggle();break;case"Reset Password":n.onResetPasswordToggle();break;case"Watch File Changes":n.watchFileChanges();break;case"Unwatch File Changes":n.unwatchFileChanges();break;case"Folder Permission":n.onFolderPermissionToggle();break;case"Label Current State":n.onLabelToggle();break;case"API Token":n.onAPITokenToggle();break;case"Share Admin":n.toggleRepoShareAdminDialog();break;case"Old Files Auto Delete":n.toggleOldFilesAutoDelDialog();break;case"SeaTable integration":n.onSeaTableIntegrationToggle()}},n.visitRepo=function(){!n.state.isRenaming&&n.props.repo.repo_name&&(0,c.oo)(n.repoURL)},n.onToggleStarRepo=function(){var e=n.props.repo.repo_name;n.state.isStarred?k.e.unstarItem(n.props.repo.repo_id,"/").then((function(){n.setState({isStarred:!n.state.isStarred});var t=(0,h.AP)("Successfully unstarred {library_name_placeholder}.").replace("{library_name_placeholder}",e);j.A.success(t)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)})):k.e.starItem(n.props.repo.repo_id,"/").then((function(){n.setState({isStarred:!n.state.isStarred});var t=(0,h.AP)("Successfully starred {library_name_placeholder}.").replace("{library_name_placeholder}",e);j.A.success(t)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.watchFileChanges=function(){var e=n.props.repo;k.e.monitorRepo(e.repo_id).then((function(){n.props.onMonitorRepo(e,!0)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.unwatchFileChanges=function(){var e=n.props.repo;k.e.unMonitorRepo(e.repo_id).then((function(){n.props.onMonitorRepo(e,!1)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.onShareToggle=function(){n.setState({isShareDialogShow:!n.state.isShareDialogShow})},n.onDeleteToggle=function(){n.setState({isDeleteDialogShow:!n.state.isDeleteDialogShow})},n.onRenameToggle=function(){n.props.onFreezedItem(),n.setState({isRenaming:!n.state.isRenaming})},n.onTransferToggle=function(){n.setState({isTransferDialogShow:!n.state.isTransferDialogShow})},n.onHistorySettingToggle=function(){n.setState({isHistorySettingDialogShow:!n.state.isHistorySettingDialogShow})},n.onChangePasswordToggle=function(){n.setState({isChangePasswordDialogShow:!n.state.isChangePasswordDialogShow})},n.onResetPasswordToggle=function(){n.setState({isResetPasswordDialogShow:!n.state.isResetPasswordDialogShow})},n.onLabelToggle=function(){n.setState({isLabelRepoStateDialogOpen:!n.state.isLabelRepoStateDialogOpen})},n.onFolderPermissionToggle=function(){n.setState({isFolderPermissionDialogShow:!n.state.isFolderPermissionDialogShow})},n.onAPITokenToggle=function(){n.setState({isAPITokenDialogShow:!n.state.isAPITokenDialogShow})},n.onSeaTableIntegrationToggle=function(){n.setState({isSeaTableIntegrationShow:!n.state.isSeaTableIntegrationShow})},n.toggleRepoShareAdminDialog=function(){n.setState({isRepoShareAdminDialogOpen:!n.state.isRepoShareAdminDialogOpen})},n.toggleOldFilesAutoDelDialog=function(){n.setState({isOldFilesAutoDelDialogOpen:!n.state.isOldFilesAutoDelDialogOpen})},n.onUnfreezedItem=function(){n.setState({highlight:!1,isOpIconShow:!1}),n.props.onUnfreezedItem()},n.onRenameConfirm=function(e){var t=n.props.repo,r=t.repo_id;k.e.renameRepo(r,e).then((function(){n.props.onRenameRepo(t,e),n.onRenameCancel()})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.onRenameCancel=function(){n.props.onUnfreezedItem(),n.setState({isRenaming:!n.state.isRenaming})},n.onTransferRepo=function(e){var t=n.props.repo.repo_id;k.e.transferRepo(t,e.email).then((function(e){n.props.onTransferRepo(t);var r=(0,h.AP)("Successfully transferred the library.");j.A.success(r)})).catch((function(e){e.response?j.A.danger(e.response.data.error_msg||(0,h.AP)("Error"),{duration:3}):j.A.danger((0,h.AP)("Failed. Please check the network."),{duration:3})})),n.onTransferToggle()},n.onDeleteRepo=function(e){k.e.deleteRepo(e.repo_id).then((function(t){n.setState({isRepoDeleted:!0,isDeleteDialogShow:!1}),n.props.onDeleteRepo(e);var r=e.repo_name,o=(0,h.AP)("Successfully deleted {name}.").replace("{name}",r);j.A.success(o)})).catch((function(t){var r=f.Aq.getErrorMsg(t);if(r===(0,h.AP)("Error")){var o=e.repo_name;r=(0,h.AP)("Failed to delete {name}.").replace("{name}",o)}j.A.danger(r),n.setState({isRepoDeleted:!1})}))},n.renderPCUI=function(){var e=n.state.isStarred,t=n.props,r=t.repo,o=t.currentViewMode,i=void 0===o?"list":o,a="grid"==i,l=f.Aq.getLibIconUrl(r,a),u=f.Aq.getLibIconTitle(r),d="".concat(h.Yc,"library/").concat(r.repo_id,"/").concat(f.Aq.encodePath(r.repo_name),"/");return"list"==i?(0,m.jsxs)("tr",{className:n.state.highlight?"tr-highlight":"",onMouseEnter:n.onMouseEnter,onMouseLeave:n.onMouseLeave,onFocus:n.onFocus,children:[(0,m.jsx)("td",{className:"text-center",children:(0,m.jsx)("i",{role:"button",title:n.state.isStarred?(0,h.AP)("Unstar"):(0,h.AP)("Star"),"aria-label":n.state.isStarred?(0,h.AP)("Unstar"):(0,h.AP)("Star"),onClick:n.onToggleStarRepo,className:"op-icon m-0 ".concat(n.state.isStarred?"sf3-font-star":"sf3-font-star-empty"," sf3-font")})}),(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:l,title:u,alt:u,width:"24"})}),(0,m.jsxs)("td",{children:[n.state.isRenaming&&(0,m.jsx)(Zt.A,{name:r.repo_name,onRenameConfirm:n.onRenameConfirm,onRenameCancel:n.onRenameCancel}),!n.state.isRenaming&&r.repo_name&&(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)(c.N_,{to:d,children:r.repo_name}),r.monitored&&(0,m.jsx)(tt,{repoID:r.repo_id,className:"ml-1 op-icon"})]}),!n.state.isRenaming&&!r.repo_name&&(0,h.AP)("Broken (please contact your administrator to fix this library)")]}),(0,m.jsx)("td",{children:r.repo_name&&n.state.isOpIconShow&&(0,m.jsxs)("div",{children:[(0,m.jsx)("i",{className:"op-icon sf3-font-share sf3-font",title:(0,h.AP)("Share"),role:"button","aria-label":(0,h.AP)("Share"),onClick:n.onShareToggle}),(0,m.jsx)("i",{className:"op-icon sf3-font-delete1 sf3-font",title:(0,h.AP)("Delete"),role:"button","aria-label":(0,h.AP)("Delete"),onClick:n.onDeleteToggle}),(0,m.jsx)(Qt,{isPC:!0,repo:n.props.repo,onMenuItemClick:n.onMenuItemClick,onFreezedItem:n.props.onFreezedItem,onUnfreezedItem:n.onUnfreezedItem})]})}),(0,m.jsx)("td",{children:r.size}),h.$0.length>0&&(0,m.jsx)("td",{children:r.storage_name}),(0,m.jsx)("td",{title:X()(r.last_modified).format("llll"),children:X()(r.last_modified).fromNow()})]}):(0,m.jsxs)("div",{className:"library-grid-item px-3 d-flex justify-content-between align-items-center",onMouseEnter:n.onMouseEnter,onMouseLeave:n.onMouseLeave,onFocus:n.onFocus,children:[(0,m.jsxs)("div",{className:"d-flex align-items-center text-truncate",children:[(0,m.jsx)("img",{src:l,title:u,alt:u,width:"36",className:"mr-2"}),n.state.isRenaming&&(0,m.jsx)(Zt.A,{name:r.repo_name,onRenameConfirm:n.onRenameConfirm,onRenameCancel:n.onRenameCancel}),!n.state.isRenaming&&r.repo_name&&(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)(c.N_,{to:d,className:"library-name text-truncate",title:r.repo_name,children:r.repo_name}),e&&(0,m.jsx)("i",{role:"button",title:(0,h.AP)("Unstar"),"aria-label":(0,h.AP)("Unstar"),className:"op-icon library-grid-item-icon sf3-font-star sf3-font",onClick:n.onToggleStarRepo}),r.monitored&&(0,m.jsx)(tt,{repoID:r.repo_id,className:"op-icon library-grid-item-icon"})]}),!n.state.isRenaming&&!r.repo_name&&(0,m.jsx)("span",{children:(0,h.AP)("Broken (please contact your administrator to fix this library)")})]}),r.repo_name&&n.state.isOpIconShow&&(0,m.jsxs)("div",{className:"flex-shrink-0",children:[(0,m.jsx)("i",{className:"op-icon sf3-font-share sf3-font",title:(0,h.AP)("Share"),role:"button","aria-label":(0,h.AP)("Share"),onClick:n.onShareToggle}),(0,m.jsx)("i",{className:"op-icon sf3-font-delete1 sf3-font",title:(0,h.AP)("Delete"),role:"button","aria-label":(0,h.AP)("Delete"),onClick:n.onDeleteToggle}),(0,m.jsx)(Qt,{isPC:!0,repo:n.props.repo,onMenuItemClick:n.onMenuItemClick,onFreezedItem:n.props.onFreezedItem,onUnfreezedItem:n.onUnfreezedItem})]})]})},n.renderMobileUI=function(){var e=n.props.repo,t=f.Aq.getLibIconUrl(e),r=f.Aq.getLibIconTitle(e),o=n.repoURL="".concat(h.Yc,"library/").concat(e.repo_id,"/").concat(f.Aq.encodePath(e.repo_name),"/");return(0,m.jsxs)("tr",{className:n.state.highlight?"tr-highlight":"",onMouseEnter:n.onMouseEnter,onMouseLeave:n.onMouseLeave,children:[(0,m.jsx)("td",{onClick:n.visitRepo,children:(0,m.jsx)("img",{src:t,title:r,alt:r,width:"24"})}),(0,m.jsxs)("td",{onClick:n.visitRepo,children:[n.state.isRenaming&&(0,m.jsx)(Zt.A,{name:e.repo_name,onRenameConfirm:n.onRenameConfirm,onRenameCancel:n.onRenameCancel}),!n.state.isRenaming&&e.repo_name&&(0,m.jsxs)("div",{children:[(0,m.jsx)(c.N_,{to:o,children:e.repo_name}),e.monitored&&(0,m.jsx)(tt,{repoID:e.repo_id,className:"ml-1 op-icon"})]}),!n.state.isRenaming&&!e.repo_name&&(0,m.jsx)("div",{children:"(gettext('Broken (please contact your administrator to fix this library)'))"}),(0,m.jsx)("span",{className:"item-meta-info",children:e.size}),(0,m.jsx)("span",{className:"item-meta-info",title:X()(e.last_modified).format("llll"),children:X()(e.last_modified).fromNow()})]}),(0,m.jsx)("td",{children:e.repo_name&&(0,m.jsx)(Qt,{repo:n.props.repo,isStarred:n.state.isStarred,onMenuItemClick:n.onMenuItemClick,onFreezedItem:n.props.onFreezedItem,onUnfreezedItem:n.onUnfreezedItem})})]})},n.state={isOpIconShow:!1,isStarred:n.props.repo.starred,isRenaming:!1,isShareDialogShow:!1,isDeleteDialogShow:!1,isTransferDialogShow:!1,isHistorySettingDialogShow:!1,isChangePasswordDialogShow:!1,isResetPasswordDialogShow:!1,isLabelRepoStateDialogOpen:!1,isFolderPermissionDialogShow:!1,isAPITokenDialogShow:!1,isSeaTableIntegrationShow:!1,isRepoShareAdminDialogOpen:!1,isRepoDeleted:!1,isOldFilesAutoDelDialogOpen:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.repo;return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)(d(),{query:"(min-width: 768px)",children:this.renderPCUI()}),(0,m.jsx)(d(),{query:"(max-width: 767.8px)",children:this.renderMobileUI()}),this.state.isShareDialogShow&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(Je.A,{itemType:"library",itemName:e.repo_name,itemPath:"/",repoID:e.repo_id,repoEncrypted:e.encrypted,enableDirPrivateShare:!0,userPerm:e.permission,toggleDialog:this.onShareToggle})}),this.state.isDeleteDialogShow&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(At.A,{repo:e,isRepoDeleted:this.state.isRepoDeleted,onDeleteRepo:this.onDeleteRepo,toggle:this.onDeleteToggle})}),this.state.isTransferDialogShow&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(Ct.A,{itemName:e.repo_name,submit:this.onTransferRepo,toggleDialog:this.onTransferToggle})}),this.state.isHistorySettingDialogShow&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(Mt,{repoID:e.repo_id,itemName:e.repo_name,toggleDialog:this.onHistorySettingToggle})}),this.state.isChangePasswordDialogShow&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(jt,{repoID:e.repo_id,repoName:e.repo_name,toggleDialog:this.onChangePasswordToggle})}),this.state.isResetPasswordDialogShow&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(It,{repoID:e.repo_id,toggleDialog:this.onResetPasswordToggle})}),this.state.isLabelRepoStateDialogOpen&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(Ot,{repoID:e.repo_id,repoName:e.repo_name,toggleDialog:this.onLabelToggle})}),this.state.isFolderPermissionDialogShow&&(0,m.jsx)(ne.A,{children:(0,m.jsx)($t,{toggleDialog:this.onFolderPermissionToggle,repoID:e.repo_id,repoName:e.repo_name})}),this.state.isAPITokenDialogShow&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(an,{repo:e,onRepoAPITokenToggle:this.onAPITokenToggle})}),this.state.isSeaTableIntegrationShow&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(Cn,{repo:e,onSeaTableIntegrationToggle:this.onSeaTableIntegrationToggle})}),this.state.isRepoShareAdminDialogOpen&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(_n,{repo:e,toggleDialog:this.toggleRepoShareAdminDialog})}),this.state.isOldFilesAutoDelDialogOpen&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(Nn,{repoID:e.repo_id,toggleDialog:this.toggleOldFilesAutoDelDialog})})]})}}])}(s.Component),Tn=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.sortByName=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortRepoList("name",t)},n.sortByTime=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortRepoList("time",t)},n.sortBySize=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortRepoList("size",t)},n.renderRepoListView=function(){return(0,m.jsx)(s.Fragment,{children:n.props.repoList.map((function(e){return(0,m.jsx)(On,{repo:e,isItemFreezed:n.state.isItemFreezed,onFreezedItem:n.onFreezedItem,onUnfreezedItem:n.onUnfreezedItem,onRenameRepo:n.props.onRenameRepo,onDeleteRepo:n.props.onDeleteRepo,onTransferRepo:n.props.onTransferRepo,onMonitorRepo:n.props.onMonitorRepo,currentViewMode:n.props.currentViewMode},e.repo_id)}))})},n.renderPCUI=function(){var e=n.props,t=e.inAllLibs,r=e.currentViewMode,o=void 0===r?"list":r,i=!t&&h.$0.length>0,a="asc"===n.props.sortOrder?(0,m.jsx)("span",{className:"sf3-font sf3-font-down rotate-180 d-inline-block"}):(0,m.jsx)("span",{className:"sf3-font sf3-font-down"});return"list"==o?(0,m.jsxs)("table",{className:t?"table-thead-hidden":"",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"4%"}),(0,m.jsx)("th",{width:"3%",children:(0,m.jsx)("span",{className:"sr-only",children:(0,h.AP)("Library Type")})}),(0,m.jsx)("th",{width:i?"36%":"35%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:n.sortByName,children:[(0,h.AP)("Name")," ","name"===n.props.sortBy&&a]})}),(0,m.jsx)("th",{width:"10%",children:(0,m.jsx)("span",{className:"sr-only",children:(0,h.AP)("Actions")})}),(0,m.jsx)("th",{width:i?"15%":"14%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:n.sortBySize,children:[(0,h.AP)("Size")," ","size"===n.props.sortBy&&a]})}),i?(0,m.jsx)("th",{width:"17%",children:(0,h.AP)("Storage Backend")}):null,(0,m.jsx)("th",{width:i?"15%":"34%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:n.sortByTime,children:[(0,h.AP)("Last Update")," ","time"===n.props.sortBy&&a]})})]})}),(0,m.jsx)("tbody",{children:n.renderRepoListView()})]}):(0,m.jsx)("div",{className:"d-flex justify-content-between flex-wrap",children:n.renderRepoListView()})},n.renderMobileUI=function(){var e=n.props.inAllLibs;return(0,m.jsxs)("table",{className:"table-thead-hidden",children:[(0,m.jsx)(Ze,{inAllLibs:e}),(0,m.jsx)("tbody",{children:n.renderRepoListView()})]})},n.state={isItemFreezed:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)(d(),{query:"(min-width: 768px)",children:this.renderPCUI()}),(0,m.jsx)(d(),{query:"(max-width: 767.8px)",children:this.renderMobileUI()})]})}}])}(s.Component),En=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).handleRepoNameChange=function(e){e.target.value.trim()?n.setState({isSubmitBtnActive:!0}):n.setState({isSubmitBtnActive:!1}),n.setState({repoName:e.target.value})},n.handlePassword1Change=function(e){n.setState({password1:e.target.value})},n.handlePassword2Change=function(e){n.setState({password2:e.target.value})},n.handleSubmit=function(){if(n.validateInputParams()){var e=n.prepareRepoData();if("department"===n.props.libraryType)return void n.props.onCreateRepo(e,"department");n.props.onCreateRepo(e)}},n.handleKeyDown=function(e){"Enter"===e.key&&(n.handleSubmit(),e.preventDefault())},n.toggle=function(){n.props.onCreateToggle()},n.onPermissionChange=function(e){var t=e.target.value;n.setState({permission:t})},n.handleStorageInputChange=function(e){n.setState({storage_id:e.value})},n.handlelibraryTemplatesInputChange=function(e){n.setState({library_template:e.value})},n.onEncrypted=function(e){var t=e.target.checked;n.setState({encrypt:t,disabled:!t})},n.prepareRepoData=function(){var e=n.props.libraryType,t=n.state.repoName.trim(),r=n.state.encrypt?n.state.password1:"",o=n.state.permission,i=null;"mine"!==e&&"public"!==e||(i={name:t,passwd:r}),"group"===e&&(i={repo_name:t,password:r,permission:o}),"department"===e&&(i={repo_name:t,passwd:r});var a=n.state.storage_id;a&&(i.storage_id=a);var s=n.state.library_template;return s&&(i.library_template=s),i},n.state={repoName:"",disabled:!0,encrypt:!1,password1:"",password2:"",errMessage:"",permission:"rw",storage_id:h.$0.length?h.$0[0].id:"",library_template:h.xF.length?h.xF[0]:"",isSubmitBtnActive:!1},n.templateOptions=[],n.storageOptions=[],Array.isArray(h.xF)&&h.xF.length&&(n.templateOptions=h.xF.map((function(e){return{value:e,label:e}}))),Array.isArray(h.$0)&&h.$0.length&&(n.storageOptions=h.$0.map((function(e){return{value:e.id,label:e.name}}))),n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"validateInputParams",value:function(){var e="",t=this.state.repoName.trim();if(!t.length)return e=(0,h.AP)("Name is required"),this.setState({errMessage:e}),!1;if(t.indexOf("/")>-1)return e=(0,h.AP)("Name should not include '/'."),this.setState({errMessage:e}),!1;if(this.state.encrypt){var n=this.state.password1.trim(),r=this.state.password2.trim();if(!n.length)return e=(0,h.AP)("Please enter password"),this.setState({errMessage:e}),!1;if(!r.length)return e=(0,h.AP)("Please enter the password again"),this.setState({errMessage:e}),!1;if(n.length<h.cT)return e=(0,h.AP)("Password is too short"),this.setState({errMessage:e}),!1;if(n!==r)return e=(0,h.AP)("Passwords don't match"),this.setState({errMessage:e}),!1}return!0}},{key:"render",value:function(){var e=this;return(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.toggle,autoFocus:!1,children:[(0,m.jsx)(I.A,{toggle:this.toggle,children:(0,h.AP)("New Library")}),(0,m.jsxs)(_.A,{children:[(0,m.jsxs)(bt.A,{children:[(0,m.jsxs)(wt.A,{children:[(0,m.jsx)(St.A,{for:"repoName",children:(0,h.AP)("Name")}),(0,m.jsx)(P.A,{id:"repoName",onKeyDown:this.handleKeyDown,value:this.state.repoName,onChange:this.handleRepoNameChange,autoFocus:!0})]}),h.xF.length>0&&(0,m.jsxs)(wt.A,{children:[(0,m.jsx)(St.A,{children:(0,h.AP)("Template")}),(0,m.jsx)(Vt.by,{defaultValue:this.templateOptions[0],options:this.templateOptions,onChange:this.handlelibraryTemplatesInputChange,value:this.templateOptions.find((function(t){return t.value===e.state.library_template}))||null})]}),h.$0.length>0&&(0,m.jsxs)(wt.A,{children:[(0,m.jsx)(St.A,{children:(0,h.AP)("Storage Backend")}),(0,m.jsx)(Vt.by,{defaultValue:this.storageOptions[0],options:this.storageOptions,onChange:this.handleStorageInputChange,value:this.storageOptions.find((function(t){return t.value===e.state.storage_id}))||null})]}),"group"===this.props.libraryType&&(0,m.jsxs)(wt.A,{children:[(0,m.jsx)(St.A,{for:"exampleSelect",children:(0,h.AP)("Permission")}),(0,m.jsxs)(P.A,{type:"select",name:"select",id:"exampleSelect",onChange:this.onPermissionChange,value:this.state.permission,children:[(0,m.jsx)("option",{value:"rw",children:(0,h.AP)("Read-Write")}),(0,m.jsx)("option",{value:"r",children:(0,h.AP)("Read-Only")})]})]}),h.L5&&(0,m.jsxs)("div",{children:[(0,m.jsxs)(wt.A,{check:!0,children:[(0,m.jsx)(P.A,{type:"checkbox",id:"encrypt",onChange:this.onEncrypted}),(0,m.jsx)(St.A,{for:"encrypt",children:(0,h.AP)("Encrypt")})]}),!this.state.disabled&&(0,m.jsxs)(wt.A,{children:[(0,m.jsx)(St.A,{for:"passwd1",children:(0,h.AP)("Password")}),(0,m.jsxs)("span",{className:"tip",children:[" ",(0,h.AP)("(at least {placeholder} characters)").replace("{placeholder}",h.cT)]}),(0,m.jsx)(P.A,{id:"passwd1",type:"password",disabled:this.state.disabled,value:this.state.password1,onChange:this.handlePassword1Change,autoComplete:"new-password"})]}),!this.state.disabled&&(0,m.jsxs)(wt.A,{children:[(0,m.jsx)(St.A,{for:"passwd2",children:(0,h.AP)("Password again")}),(0,m.jsx)(P.A,{id:"passwd2",type:"password",disabled:this.state.disabled,value:this.state.password2,onChange:this.handlePassword2Change,autoComplete:"new-password"})]})]})]}),this.state.errMessage&&(0,m.jsx)(Dt.A,{color:"danger",children:this.state.errMessage})]}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(O.A,{color:"secondary",onClick:this.toggle,children:(0,h.AP)("Cancel")}),(0,m.jsx)(O.A,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive,children:(0,h.AP)("Submit")})]})]})}}])}(s.Component);X().locale(h.vV);var Rn=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).refreshDeletedRepoList=function(e){var t=n.state.deletedRepoList.filter((function(t){return t.repo_id!==e}));n.setState({deletedRepoList:t})},n.state={deletedRepoList:[],isLoading:!0},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;k.e.listDeletedRepo().then((function(t){e.setState({deletedRepoList:t.data,isLoading:!1})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))}},{key:"render",value:function(){var e=this,t=this.state.deletedRepoList;return(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.props.toggleDialog,className:"my-deleted-repos-dialog",children:[(0,m.jsx)(I.A,{toggle:this.props.toggleDialog,children:(0,h.AP)("Deleted Libraries")}),(0,m.jsxs)(_.A,{className:"my-deleted-repos-container",children:[this.state.isLoading&&(0,m.jsx)($.A,{}),!this.state.isLoading&&0===t.length&&(0,m.jsx)(J.A,{className:"my-deleted-repos-empty-tip",title:(0,h.AP)("No deleted libraries"),text:(0,h.AP)("You have not deleted any libraries in the last {placeholder} days. A deleted library will be cleaned automatically after this period.").replace("{placeholder}",h._R)}),0!==t.length&&(0,m.jsxs)("div",{children:[(0,m.jsx)("p",{className:"tip my-deleted-repos-tip",children:(0,h.AP)("Tip: libraries deleted {placeholder} days ago will be cleaned automatically.").replace("{placeholder}",h._R)}),(0,m.jsxs)("table",{children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"10%"}),(0,m.jsx)("th",{width:"50%",children:(0,h.AP)("Name")}),(0,m.jsx)("th",{width:"28%",children:(0,h.AP)("Deleted Time")}),(0,m.jsx)("th",{width:"12%"})]})}),(0,m.jsx)("tbody",{children:t.map((function(t){return(0,m.jsx)(Ln,{repo:t,refreshDeletedRepoList:e.refreshDeletedRepoList},t.repo_id)}))})]})]})]})]})}}])}(s.Component),Ln=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onMouseEnter=function(){n.setState({hideRestoreMenu:!1,highlight:!0})},n.onMouseLeave=function(){n.setState({hideRestoreMenu:!0,highlight:!1})},n.restoreDeletedRepo=function(e){e.preventDefault();var t=n.props.repo.repo_id,r=n.props.repo.repo_name;k.e.restoreDeletedRepo(t).then((function(e){var o=(0,h.AP)("Successfully restored the library {library_name}.").replace("{library_name}",r);j.A.success(o),n.props.refreshDeletedRepoList(t)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.state={hideRestoreMenu:!0,highlight:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=X().utc(this.props.repo.del_time).toDate();e=X()(e).fromNow();var t=f.Aq.getLibIconUrl(this.props.repo);return(0,m.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,tabIndex:"0",onFocus:this.onMouseEnter,children:[(0,m.jsx)("td",{className:"text-center",children:(0,m.jsx)("img",{src:t,alt:"",width:"24"})}),(0,m.jsx)("td",{className:"name",children:this.props.repo.repo_name}),(0,m.jsx)("td",{className:"update",children:e}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"#",onClick:this.restoreDeletedRepo,title:(0,h.AP)("Restore"),role:"button","aria-label":(0,h.AP)("Restore"),className:"sf2-icon-reply action-icon ".concat(this.state.highlight?"":"vh")})})]})}}])}(s.Component),Fn=Rn,Un=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).toggleSortOptionsDialog=function(){n.setState({isSortOptionsDialogOpen:!n.state.isSortOptionsDialogOpen})},n.onCreateRepo=function(e){n.toggleCreateRepoDialog(),k.e.createMineRepo(e).then((function(e){var t=new Xe({repo_id:e.data.repo_id,repo_name:e.data.repo_name,size:e.data.repo_size,mtime:e.data.mtime,owner_email:e.data.email,encrypted:e.data.encrypted,permission:e.data.permission,storage_name:e.data.storage_name});n.state.repoList.unshift(t),n.setState({repoList:n.state.repoList})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.sortRepoList=function(e,t){Ke.Ay.save("seafile-repo-dir-sort-by",e),Ke.Ay.save("seafile-repo-dir-sort-order",t),n.setState({sortBy:e,sortOrder:t,repoList:f.Aq.sortRepos(n.state.repoList,e,t)})},n.onTransferRepo=function(e){var t=n.state.repoList.filter((function(t){return t.repo_id!==e}));n.setState({repoList:t})},n.onRenameRepo=function(e,t){var r=n.state.repoList.map((function(n){return n.repo_id===e.repo_id&&(n.repo_name=t),n}));n.setState({repoList:r})},n.onMonitorRepo=function(e,t){var r=n.state.repoList.map((function(n){return n.repo_id===e.repo_id&&(n.monitored=t),n}));n.setState({repoList:r})},n.onDeleteRepo=function(e){var t=n.state.repoList.filter((function(t){return t.repo_id!==e.repo_id}));n.setState({repoList:t})},n.toggleCreateRepoDialog=function(){n.setState({isCreateRepoDialogOpen:!n.state.isCreateRepoDialogOpen})},n.toggleDeletedReposDialog=function(){n.setState({isDeletedReposDialogOpen:!n.state.isDeletedReposDialogOpen})},n.state={errorMsg:"",isLoading:!0,repoList:[],isDeletedReposDialogOpen:!1,isCreateRepoDialogOpen:!1,isSortOptionsDialogOpen:!1,sortBy:Ke.Ay.load("seafile-repo-dir-sort-by")||"name",sortOrder:Ke.Ay.load("seafile-repo-dir-sort-order")||"asc"},n.emptyTip=(0,m.jsx)(J.A,{title:(0,h.AP)("No libraries"),text:(0,h.AP)('You have not created any libraries yet. A library is a container to organize your files and folders. A library can also be shared with others and synced to your connected devices. You can create a library by clicking the "New Library" button in the menu bar.')}),n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;k.e.listRepos({type:"mine"}).then((function(t){var n=t.data.repos.map((function(e){return new Xe(e)}));e.setState({isLoading:!1,repoList:f.Aq.sortRepos(n,e.state.sortBy,e.state.sortOrder)})})).catch((function(t){e.setState({isLoading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,m.jsx)(s.Fragment,{children:(0,m.jsxs)("div",{className:"main-panel-center flex-row",children:[(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsxs)("div",{className:"cur-view-path",children:[(0,m.jsxs)("h3",{className:"sf-heading m-0",children:[(0,h.AP)("My Libraries"),(0,m.jsx)(Be,{opList:[{text:(0,h.AP)("New Library"),onClick:this.toggleCreateRepoDialog},{text:(0,h.AP)("Deleted Libraries"),onClick:this.toggleDeletedReposDialog}]})]}),(0,m.jsx)("div",{children:!f.Aq.isDesktop()&&this.state.repoList.length>0&&(0,m.jsx)("span",{className:"sf3-font sf3-font-sort action-icon",onClick:this.toggleSortOptionsDialog})})]}),(0,m.jsxs)("div",{className:"cur-view-content",children:[this.state.isLoading&&(0,m.jsx)($.A,{}),!this.state.isLoading&&this.state.errorMsg&&(0,m.jsx)("p",{className:"error text-center mt-8",children:this.state.errorMsg}),!this.state.isLoading&&!this.state.errorMsg&&0===this.state.repoList.length&&this.emptyTip,!this.state.isLoading&&!this.state.errorMsg&&this.state.repoList.length>0&&(0,m.jsx)(Tn,{sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,repoList:this.state.repoList,onRenameRepo:this.onRenameRepo,onDeleteRepo:this.onDeleteRepo,onTransferRepo:this.onTransferRepo,onMonitorRepo:this.onMonitorRepo,sortRepoList:this.sortRepoList})]})]}),this.state.isSortOptionsDialogOpen&&(0,m.jsx)(Re,{toggleDialog:this.toggleSortOptionsDialog,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortRepoList}),this.state.isCreateRepoDialogOpen&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(En,{libraryType:"mine",onCreateRepo:this.onCreateRepo,onCreateToggle:this.toggleCreateRepoDialog})}),this.state.isDeletedReposDialogOpen&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(Fn,{toggleDialog:this.toggleDeletedReposDialog})})]})})}}])}(s.Component);X().locale(h.vV);var Bn=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).refreshDeletedRepoList=function(e){var t=n.state.deletedRepoList.filter((function(t){return t.repo_id!==e}));n.setState({deletedRepoList:t})},n.state={deletedRepoList:[],isLoading:!0},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;k.e.listDeletedRepo().then((function(t){e.setState({deletedRepoList:t.data,isLoading:!1})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))}},{key:"render",value:function(){return(0,m.jsx)(s.Fragment,{children:(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)("div",{className:"cur-view-path",children:(0,m.jsxs)("div",{className:"path-container",children:[(0,m.jsx)(c.N_,{to:h.Yc+"my-libs/",children:(0,h.AP)("My Libraries")}),(0,m.jsx)("span",{className:"path-split",children:"/"}),(0,m.jsx)("span",{children:(0,h.AP)("Deleted Libraries")})]})}),(0,m.jsxs)("div",{className:"cur-view-content",children:[this.state.isLoading&&(0,m.jsx)($.A,{}),!this.state.isLoading&&0===this.state.deletedRepoList.length&&(0,m.jsx)(J.A,{title:(0,h.AP)("No deleted libraries"),text:(0,h.AP)("You have not deleted any libraries in the last {placeholder} days. A deleted library will be cleaned automatically after this period.").replace("{placeholder}",h._R)}),0!==this.state.deletedRepoList.length&&(0,m.jsxs)("div",{children:[(0,m.jsx)("p",{className:"tip mt-2",children:(0,h.AP)("Tip: libraries deleted {placeholder} days ago will be cleaned automatically.").replace("{placeholder}",h._R)}),(0,m.jsx)(Yn,{deletedRepoList:this.state.deletedRepoList,refreshDeletedRepoList:this.refreshDeletedRepoList})]})]})]})})})}}])}(s.Component),Yn=function(e){function t(){return(0,r.A)(this,t),(0,i.A)(this,t,arguments)}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props.deletedRepoList;return(0,m.jsxs)("table",{children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{style:{width:"4%"}}),(0,m.jsx)("th",{style:{width:"52%"},children:(0,h.AP)("Name")}),(0,m.jsx)("th",{style:{width:"30%"},children:(0,h.AP)("Deleted Time")}),(0,m.jsx)("th",{style:{width:"14%"}})]})}),(0,m.jsx)("tbody",{children:t&&t.map((function(t){return(0,m.jsx)(qn,{repo:t,refreshDeletedRepoList:e.props.refreshDeletedRepoList},t.repo_id)}))})]})}}])}(s.Component),qn=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onMouseEnter=function(){n.setState({hideRestoreMenu:!1,highlight:!0})},n.onMouseLeave=function(){n.setState({hideRestoreMenu:!0,highlight:!1})},n.restoreDeletedRepo=function(e){e.preventDefault();var t=n.props.repo.repo_id,r=n.props.repo.repo_name;k.e.restoreDeletedRepo(t).then((function(e){var o=(0,h.AP)("Successfully restored the library.")+"  "+r;j.A.success(o),n.props.refreshDeletedRepoList(t)})).catch((function(e){var t=f.Aq.getErrorMsg(e);t===(0,h.AP)("Error")&&(t=(0,h.AP)("Failed. Please check the network.")),j.A.danger(t)}))},n.state={hideRestoreMenu:!0,highlight:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=X().utc(this.props.repo.del_time).toDate();e=X()(e).fromNow();var t=f.Aq.getLibIconUrl(this.props.repo);return(0,m.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,tabIndex:"0",onFocus:this.onMouseEnter,children:[(0,m.jsx)("td",{className:"text-center",children:(0,m.jsx)("img",{src:t,alt:"",width:"24"})}),(0,m.jsx)("td",{className:"name",children:this.props.repo.repo_name}),(0,m.jsx)("td",{className:"update",children:e}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"#",onClick:this.restoreDeletedRepo,title:(0,h.AP)("Restore"),role:"button","aria-label":(0,h.AP)("Restore"),className:"sf2-icon-reply action-icon ".concat(this.state.highlight?"":"vh")})})]})}}])}(s.Component),Hn=Bn,Gn=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onMouseEnter=function(){n.props.isItemFreezed||n.setState({highlight:!0,isOperationShow:!0})},n.onMouseOver=function(){n.props.isItemFreezed||n.setState({highlight:!0,isOperationShow:!0})},n.onMouseLeave=function(){n.props.isItemFreezed||n.setState({highlight:!1,isOperationShow:!1})},n.clickOperationMenuToggle=function(e){n.toggleOperationMenu(e)},n.onDropdownToggleKeyDown=function(e){"Enter"!=e.key&&"Space"!=e.key||n.clickOperationMenuToggle(e)},n.toggleOperationMenu=function(e){var t=e.target?e.target.dataset:null;t&&t.toggle&&"Rename"===t.toggle?n.setState({isItemMenuShow:!n.state.isItemMenuShow}):n.setState({isItemMenuShow:!n.state.isItemMenuShow},(function(){n.state.isItemMenuShow?n.props.onFreezedItem():(n.props.onUnfreezedItem(),n.setState({highlight:!1,isOperationShow:!1}))}))},n.toggleAdvancedMenuShown=function(e){n.setState({isAdvancedMenuShown:!0})},n.toggleAdvancedMenu=function(e){e.stopPropagation(),n.setState({isAdvancedMenuShown:!n.state.isAdvancedMenuShown},(function(){n.toggleOperationMenu(e)}))},n.onDropDownMouseMove=function(e){n.state.isAdvancedMenuShown&&e.target&&"dropdown-item"===e.target.className&&n.setState({isAdvancedMenuShown:!1})},n.getRepoComputeParams=function(){var e=n.props,t=e.repo,r="grid"==e.currentViewMode;return{iconUrl:f.Aq.getLibIconUrl(t,r),iconTitle:f.Aq.getLibIconTitle(t),libPath:"".concat(h.Yc,"library/").concat(t.repo_id,"/").concat(f.Aq.encodePath(t.repo_name),"/")}},n.onMenuItemKeyDown=function(e){"Enter"!=e.key&&"Space"!=e.key||n.onMenuItemClick(e)},n.onMenuItemClick=function(e){switch(e.target.dataset.toggle){case"Rename":n.onItemRenameToggle();break;case"Folder Permission":n.onItemFolderPermissionToggle();break;case"Share":n.onItemShare();break;case"Unshare":n.onItemUnshare();break;case"History Setting":n.onHistorySettingToggle();break;case"API Token":n.onAPITokenToggle();break;case"Share Admin":n.toggleRepoShareAdminDialog();break;case"Change Password":n.onChangePasswordToggle();break;case"Reset Password":n.onResetPasswordToggle();break;case"Watch File Changes":n.watchFileChanges();break;case"Unwatch File Changes":n.unwatchFileChanges();break;case"Old Files Auto Delete":n.toggleOldFilesAutoDelDialog();break;case"SeaTable integration":n.onSeaTableIntegrationToggle()}},n.watchFileChanges=function(){var e=n.props.repo;k.e.monitorRepo(e.repo_id).then((function(){n.props.onMonitorRepo(e,!0)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.unwatchFileChanges=function(){var e=n.props.repo;k.e.unMonitorRepo(e.repo_id).then((function(){n.props.onMonitorRepo(e,!1)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.onItemRenameToggle=function(){n.props.onFreezedItem(),n.setState({isRenaming:!n.state.isRenaming,isOperationShow:!n.state.isOperationShow})},n.onRenameConfirm=function(e){n.props.onItemRename(n.props.repo,e),n.onRenameCancel()},n.onRenameCancel=function(){n.props.onUnfreezedItem(),n.setState({isRenaming:!n.state.isRenaming})},n.onItemFolderPermissionToggle=function(){n.setState({isFolderPermissionDialogOpen:!n.state.isFolderPermissionDialogOpen})},n.onHistorySettingToggle=function(){n.setState({isHistorySettingDialogShow:!n.state.isHistorySettingDialogShow})},n.onItemShare=function(){n.setState({isShowSharedDialog:!0})},n.onItemUnshare=function(){n.props.onItemUnshare(n.props.repo)},n.onItemDeleteToggle=function(){n.setState({isDeleteDialogShow:!n.state.isDeleteDialogShow})},n.onItemDelete=function(){var e=n.props,t=e.currentGroup,r=e.repo;if(t){var o=t.id;k.e.deleteGroupOwnedLibrary(o,r.repo_id).then((function(){n.setState({isRepoDeleted:!0,isDeleteDialogShow:!1}),n.props.onItemDelete(r);var e=r.repo_name,t=(0,h.AP)("Successfully deleted {name}.").replace("{name}",e);j.A.success(t)})).catch((function(e){var t=f.Aq.getErrorMsg(e);if(t===(0,h.AP)("Error")){var o=r.repo_name;t=(0,h.AP)("Failed to delete {name}.").replace("{name}",o)}j.A.danger(t),n.setState({isRepoDeleted:!1})}))}},n.toggleShareDialog=function(){n.setState({isShowSharedDialog:!1})},n.toggleRepoShareAdminDialog=function(){n.setState({isRepoShareAdminDialogOpen:!n.state.isRepoShareAdminDialogOpen})},n.toggleOldFilesAutoDelDialog=function(){n.setState({isOldFilesAutoDelDialogOpen:!n.state.isOldFilesAutoDelDialogOpen})},n.onSeaTableIntegrationToggle=function(){n.setState({isSeaTableIntegrationShow:!n.state.isSeaTableIntegrationShow})},n.onAPITokenToggle=function(){n.setState({isAPITokenDialogShow:!n.state.isAPITokenDialogShow})},n.onChangePasswordToggle=function(){n.setState({isChangePasswordDialogShow:!n.state.isChangePasswordDialogShow})},n.onResetPasswordToggle=function(){n.setState({isResetPasswordDialogShow:!n.state.isResetPasswordDialogShow})},n.translateMenuItem=function(e){var t="";switch(e){case"Rename":t=(0,h.AP)("Rename");break;case"Folder Permission":t=(0,h.AP)("Folder Permission");break;case"Unshare":t=(0,h.AP)("Unshare");break;case"Share":t=(0,h.AP)("Share");break;case"History Setting":t=(0,h.AP)("History Setting");break;case"Share Admin":t=(0,h.AP)("Share Admin");break;case"Change Password":t=(0,h.AP)("Change Password");break;case"Reset Password":t=(0,h.AP)("Reset Password");break;case"Watch File Changes":t=(0,h.AP)("Watch File Changes");break;case"Unwatch File Changes":t=(0,h.AP)("Unwatch File Changes");break;case"Old Files Auto Delete":t=(0,h.AP)("Auto Deletion Setting");break;case"API Token":t="API Token";break;case"Advanced":t=(0,h.AP)("Advanced");break;case"SeaTable integration":t=(0,h.AP)("SeaTable integration")}return t},n.getAdvancedOperations=function(){var e=[];return e.push("API Token"),h.if&&e.push("Old Files Auto Delete"),h.vu&&e.push("SeaTable integration"),e},n.generatorOperations=function(){var e=n.props,t=e.repo,r=e.currentGroup,o=r&&r.admins&&r.admins.indexOf(h.Xh)>-1,i=t.owner_email===h.Xh,a=t.is_admin,s=[];if(h.am){if(-1!=t.owner_email.indexOf("@seafile_group")){if(o){if(t.owner_email==r.id+"@seafile_group"){if(n.isDeparementOnwerGroupMember=!0,s=["Rename"],h.wR&&s.push("Folder Permission"),s.push("Share Admin","Divider"),t.encrypted&&s.push("Change Password"),t.encrypted&&h.ez&&h.bw&&s.push("Reset Password"),"r"==t.permission||"rw"==t.permission){var l=t.monitored?"Unwatch File Changes":"Watch File Changes";s.push(l)}return s.push("Divider","History Setting"),f.Aq.isDesktop()&&s.push("Advanced"),s}s.push("Unshare")}}else(i||a)&&s.push("Share"),(o||i||a)&&s.push("Unshare");if("r"==t.permission||"rw"==t.permission){var c=t.monitored?"Unwatch File Changes":"Watch File Changes";s.push(c)}}else i&&s.push("Share"),(o||i)&&s.push("Unshare");return s},n.generatorMobileMenu=function(){var e=[];if(n.props.libraryType&&"public"===n.props.libraryType){var t=n.props.repo.owner_email===h.Xh;(h.Gn||t)&&e.push("Unshare")}else e=n.generatorOperations().filter((function(e){return"Divider"!=e})),n.isDeparementOnwerGroupMember&&(e.unshift("Unshare"),e.unshift("Share"));return e.length?(0,m.jsxs)(de.A,{isOpen:n.state.isItemMenuShow,toggle:n.toggleOperationMenu,children:[(0,m.jsx)(pe.A,{tag:"i",className:"sf-dropdown-toggle sf3-font sf3-font-more-vertical ml-0",title:(0,h.AP)("More operations"),"aria-label":(0,h.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":n.state.isItemMenuShow,onClick:n.clickOperationMenuToggle}),(0,m.jsxs)("div",{className:"".concat(n.state.isItemMenuShow?"":"d-none"),onClick:n.toggleOperationMenu,children:[(0,m.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),(0,m.jsx)("div",{className:"mobile-operation-menu",children:e.map((function(e,t){return(0,m.jsx)(he.A,{"data-toggle":e,onClick:n.onMenuItemClick,children:n.translateMenuItem(e)},t)}))})]})]}):null},n.generatorPCMenu=function(){var e=[];if(n.props.libraryType&&"public"===n.props.libraryType){var t=n.props.repo.owner_email===h.Xh;(h.Gn||t)&&e.push("Unshare")}else e=n.generatorOperations();var r=(0,m.jsx)("i",{className:"op-icon sf3-font-share sf3-font",title:(0,h.AP)("Share"),role:"button","aria-label":(0,h.AP)("Share"),onClick:n.onItemShare}),o=(0,m.jsx)("i",{className:"op-icon sf2-icon-x3",title:(0,h.AP)("Unshare"),role:"button","aria-label":(0,h.AP)("Unshare"),onClick:n.onItemUnshare}),i=(0,m.jsx)("i",{className:"op-icon sf3-font-delete1 sf3-font",title:(0,h.AP)("Delete"),role:"button","aria-label":(0,h.AP)("Delete"),onClick:n.onItemDeleteToggle});if(n.isDeparementOnwerGroupMember){var a=n.getAdvancedOperations();return(0,m.jsxs)(s.Fragment,{children:[r,i,(0,m.jsxs)(de.A,{isOpen:n.state.isItemMenuShow,toggle:n.toggleOperationMenu,children:[(0,m.jsx)(pe.A,{tag:"i",role:"button",tabIndex:"0",className:"sf-dropdown-toggle sf3-font-more sf3-font",title:(0,h.AP)("More operations"),"aria-label":(0,h.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":n.state.isItemMenuShow,"aria-haspopup":!0,style:{minWidth:"0"},onClick:n.clickOperationMenuToggle,onKeyDown:n.onDropdownToggleKeyDown}),(0,m.jsx)(Ue.A,{onMouseMove:n.onDropDownMouseMove,children:e.map((function(e,t){return"Divider"==e?(0,m.jsx)(he.A,{divider:!0},t):"Advanced"==e?(0,m.jsxs)(de.A,{direction:"right",className:"w-100",isOpen:n.state.isAdvancedMenuShown,toggle:n.toggleAdvancedMenu,onMouseMove:function(e){e.stopPropagation()},children:[(0,m.jsxs)(pe.A,{className:"dropdown-item font-weight-normal rounded-0 d-flex justify-content-between align-items-center pr-2",onMouseEnter:n.toggleAdvancedMenuShown,children:[n.translateMenuItem(e),(0,m.jsx)("i",{className:"sf3-font-down sf3-font rotate-270"})]}),(0,m.jsx)(Ue.A,{children:a.map((function(e,t){return(0,m.jsx)(he.A,{"data-toggle":e,onClick:n.onMenuItemClick,onKeyDown:n.onMenuItemKeyDown,children:n.translateMenuItem(e)},t)}))})]},t):(0,m.jsx)(he.A,{"data-toggle":e,onClick:n.onMenuItemClick,onKeyDown:n.onMenuItemKeyDown,children:n.translateMenuItem(e)},t)}))})]})]})}return(0,m.jsx)(s.Fragment,{children:e.map((function(e){switch(e){case"Share":return(0,m.jsx)(s.Fragment,{children:r},e);case"Unshare":return(0,m.jsx)(s.Fragment,{children:o},e);case"Watch File Changes":case"Unwatch File Changes":return(0,m.jsxs)(de.A,{isOpen:n.state.isItemMenuShow,toggle:n.toggleOperationMenu,children:[(0,m.jsx)(pe.A,{tag:"i",role:"button",tabIndex:"0",className:"sf-dropdown-toggle sf3-font-more sf3-font",title:(0,h.AP)("More operations"),"aria-label":(0,h.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":n.state.isItemMenuShow,"aria-haspopup":!0,style:{minWidth:"0"},onClick:n.clickOperationMenuToggle,onKeyDown:n.onDropdownToggleKeyDown}),(0,m.jsx)(Ue.A,{children:[e].map((function(e,t){return(0,m.jsx)(he.A,{"data-toggle":e,onClick:n.onMenuItemClick,onKeyDown:n.onMenuItemKeyDown,children:n.translateMenuItem(e)},t)}))})]},e);default:return null}}))})},n.onToggleStarRepo=function(e){e.preventDefault();var t=n.props.repo.repo_name;n.state.isStarred?k.e.unstarItem(n.props.repo.repo_id,"/").then((function(){n.setState({isStarred:!n.state.isStarred});var e=(0,h.AP)("Successfully unstarred {library_name_placeholder}.").replace("{library_name_placeholder}",t);j.A.success(e)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)})):k.e.starItem(n.props.repo.repo_id,"/").then((function(){n.setState({isStarred:!n.state.isStarred});var e=(0,h.AP)("Successfully starred {library_name_placeholder}.").replace("{library_name_placeholder}",t);j.A.success(e)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.renderPCUI=function(){var e=n.state.isStarred,t=n.getRepoComputeParams(),r=t.iconUrl,o=t.iconTitle,i=t.libPath,a=n.props,l=a.repo;return"list"==a.currentViewMode?(0,m.jsxs)("tr",{className:n.state.highlight?"tr-highlight":"",onMouseEnter:n.onMouseEnter,onMouseOver:n.onMouseOver,onMouseLeave:n.onMouseLeave,onFocus:n.onMouseEnter,children:[(0,m.jsx)("td",{className:"text-center",children:(0,m.jsx)("i",{role:"button",title:n.state.isStarred?(0,h.AP)("Unstar"):(0,h.AP)("Star"),"aria-label":n.state.isStarred?(0,h.AP)("Unstar"):(0,h.AP)("Star"),onClick:n.onToggleStarRepo,className:"op-icon m-0 ".concat(n.state.isStarred?"sf3-font-star":"sf3-font-star-empty"," sf3-font")})}),(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:r,title:o,alt:o,width:"24"})}),(0,m.jsx)("td",{children:n.state.isRenaming?(0,m.jsx)(Zt.A,{name:l.repo_name,onRenameConfirm:n.onRenameConfirm,onRenameCancel:n.onRenameCancel}):(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)(c.N_,{to:i,children:l.repo_name}),l.monitored&&(0,m.jsx)(tt,{repoID:l.repo_id,className:"ml-1 op-icon"})]})}),(0,m.jsx)("td",{children:n.state.isOperationShow&&n.generatorPCMenu()}),(0,m.jsx)("td",{children:l.size}),(0,m.jsx)("td",{title:X()(l.last_modified).format("llll"),children:X()(l.last_modified).fromNow()}),(0,m.jsx)("td",{title:l.owner_contact_email,children:l.owner_name})]}):(0,m.jsxs)("div",{className:"library-grid-item px-3 d-flex justify-content-between align-items-center",onMouseEnter:n.onMouseEnter,onMouseLeave:n.onMouseLeave,onFocus:n.onMouseEnter,children:[(0,m.jsxs)("div",{className:"d-flex align-items-center text-truncate",children:[(0,m.jsx)("img",{src:r,title:o,alt:o,width:"36",className:"mr-2"}),n.state.isRenaming?(0,m.jsx)(Zt.A,{name:l.repo_name,onRenameConfirm:n.onRenameConfirm,onRenameCancel:n.onRenameCancel}):(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)(c.N_,{to:i,className:"library-name text-truncate",title:l.repo_name,children:l.repo_name}),e&&(0,m.jsx)("i",{role:"button",title:(0,h.AP)("Unstar"),"aria-label":(0,h.AP)("Unstar"),onClick:n.onToggleStarRepo,className:"op-icon library-grid-item-icon sf3-font-star sf3-font"}),l.monitored&&(0,m.jsx)(tt,{repoID:l.repo_id,className:"op-icon library-grid-item-icon"})]})]}),(0,m.jsx)("div",{className:"flex-shrink-0",children:n.state.isOperationShow&&n.generatorPCMenu()})]})},n.visitRepo=function(){n.state.isRenaming||(0,c.oo)(n.repoURL)},n.renderMobileUI=function(){var e=n.getRepoComputeParams(),t=e.iconUrl,r=e.iconTitle,o=e.libPath,i=n.props.repo;return n.repoURL=o,(0,m.jsx)(s.Fragment,{children:(0,m.jsxs)("tr",{className:n.state.highlight?"tr-highlight":"",onMouseEnter:n.onMouseEnter,onMouseOver:n.onMouseOver,onMouseLeave:n.onMouseLeave,children:[(0,m.jsx)("td",{onClick:n.visitRepo,children:(0,m.jsx)("img",{src:t,title:r,width:"24",alt:r})}),(0,m.jsxs)("td",{onClick:n.visitRepo,children:[n.state.isRenaming?(0,m.jsx)(Zt.A,{name:i.repo_name,onRenameConfirm:n.onRenameConfirm,onRenameCancel:n.onRenameCancel}):(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)(c.N_,{to:o,children:i.repo_name}),i.monitored&&(0,m.jsx)(tt,{repoID:i.repo_id,className:"ml-1 op-icon"})]}),(0,m.jsx)("br",{}),(0,m.jsx)("span",{className:"item-meta-info",title:i.owner_contact_email,children:i.owner_name}),(0,m.jsx)("span",{className:"item-meta-info",children:i.size}),(0,m.jsx)("span",{className:"item-meta-info",title:X()(i.last_modified).format("llll"),children:X()(i.last_modified).fromNow()})]}),(0,m.jsx)("td",{children:n.generatorMobileMenu()})]})})},n.state={highlight:!1,isOperationShow:!1,isItemMenuShow:!1,isAdvancedMenuShown:!1,isShowSharedDialog:!1,isRenaming:!1,isStarred:n.props.repo.starred,isFolderPermissionDialogOpen:!1,isHistorySettingDialogShow:!1,isDeleteDialogShow:!1,isAPITokenDialogShow:!1,isRepoShareAdminDialogOpen:!1,isRepoDeleted:!1,isChangePasswordDialogShow:!1,isResetPasswordDialogShow:!1,isOldFilesAutoDelDialogOpen:!1,isSeaTableIntegrationShow:!1},n.isDeparementOnwerGroupMember=!1,n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.repo,t=e.owner_email.indexOf("@seafile_group")>-1;return(0,m.jsxs)(s.Fragment,{children:[f.Aq.isDesktop()?this.renderPCUI():this.renderMobileUI(),this.state.isShowSharedDialog&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(Je.A,{itemType:"library",itemName:e.repo_name,itemPath:"/",repoID:e.repo_id,repoEncrypted:e.encrypted,enableDirPrivateShare:!0,userPerm:e.permission,isAdmin:e.is_admin,isGroupOwnedRepo:t,toggleDialog:this.toggleShareDialog})}),this.state.isFolderPermissionDialogOpen&&(0,m.jsx)(ne.A,{children:(0,m.jsx)($t,{toggleDialog:this.onItemFolderPermissionToggle,repoID:e.repo_id,repoName:e.repo_name,isDepartmentRepo:!0})}),this.state.isDeleteDialogShow&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(At.A,{repo:this.props.repo,isRepoDeleted:this.state.isRepoDeleted,onDeleteRepo:this.onItemDelete,toggle:this.onItemDeleteToggle})}),this.state.isHistorySettingDialogShow&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(Mt,{repoID:e.repo_id,itemName:e.repo_name,toggleDialog:this.onHistorySettingToggle})}),this.state.isAPITokenDialogShow&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(an,{repo:e,onRepoAPITokenToggle:this.onAPITokenToggle})}),this.state.isRepoShareAdminDialogOpen&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(_n,{repo:e,toggleDialog:this.toggleRepoShareAdminDialog})}),this.state.isChangePasswordDialogShow&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(jt,{repoID:e.repo_id,repoName:e.repo_name,toggleDialog:this.onChangePasswordToggle})}),this.state.isResetPasswordDialogShow&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(It,{repoID:e.repo_id,toggleDialog:this.onResetPasswordToggle})}),this.state.isOldFilesAutoDelDialogOpen&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(Nn,{repoID:e.repo_id,toggleDialog:this.toggleOldFilesAutoDelDialog})}),this.state.isSeaTableIntegrationShow&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(Cn,{repo:e,onSeaTableIntegrationToggle:this.onSeaTableIntegrationToggle})})]})}}])}(s.Component),zn=Gn,Vn=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).sortByName=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortItems("name",t)},n.sortByTime=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortItems("time",t)},n.sortBySize=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortItems("size",t)},n.getSortMetaData=function(){return{sortByName:"name"==n.props.sortBy,sortByTime:"time"==n.props.sortBy,sortBySize:"size"==n.props.sortBy,sortIcon:"asc"==n.props.sortOrder?(0,m.jsx)("span",{className:"sf3-font sf3-font-down rotate-180 d-inline-block"}):(0,m.jsx)("span",{className:"sf3-font sf3-font-down"})}},n.onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.onItemRename=function(e,t){if(n.props.repoList.some((function(e){return e.name===t}))){var r=(0,h.AP)('The name "{name}" is already taken. Please choose a different name.');return r=r.replace("{name}",f.Aq.HTMLescape(t)),j.A.danger(r),!1}n.props.onItemRename(e,t)},n.renderRepoListView=function(){var e=n.props.currentViewMode,t=void 0===e?"list":e;return(0,m.jsx)(s.Fragment,{children:n.props.repoList.map((function(e){return(0,m.jsx)(zn,{repo:e,libraryType:n.props.libraryType,currentGroup:n.props.currentGroup,isItemFreezed:n.state.isItemFreezed,onFreezedItem:n.onFreezedItem,onUnfreezedItem:n.onUnfreezedItem,onItemUnshare:n.props.onItemUnshare,onItemDelete:n.props.onItemDelete,onItemRename:n.props.onItemRename,onMonitorRepo:n.props.onMonitorRepo,currentViewMode:t},e.repo_id)}))})},n.renderPCUI=function(){var e=n.props,t=e.theadHidden,r=void 0!==t&&t,o=e.currentViewMode,i=void 0===o?"list":o,a=n.getSortMetaData(),s=a.sortByName,l=a.sortByTime,c=a.sortBySize,u=a.sortIcon;return"list"==i?(0,m.jsxs)("table",{className:r?"table-thead-hidden":"",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"4%"}),(0,m.jsx)("th",{width:"3%",children:(0,m.jsx)("span",{className:"sr-only",children:(0,h.AP)("Library Type")})}),(0,m.jsx)("th",{width:"35%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:n.sortByName,children:[(0,h.AP)("Name")," ",s&&u]})}),(0,m.jsx)("th",{width:"10%",children:(0,m.jsx)("span",{className:"sr-only",children:(0,h.AP)("Actions")})}),(0,m.jsx)("th",{width:"14%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:n.sortBySize,children:[(0,h.AP)("Size")," ",c&&u]})}),(0,m.jsx)("th",{width:"17%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:n.sortByTime,children:[(0,h.AP)("Last Update")," ",l&&u]})}),(0,m.jsx)("th",{width:"17%",children:(0,h.AP)("Owner")})]})}),(0,m.jsx)("tbody",{children:n.renderRepoListView()})]}):(0,m.jsx)("div",{className:"d-flex justify-content-between flex-wrap",children:n.renderRepoListView()})},n.renderMobileUI=function(){var e=n.props.inAllLibs,t=void 0!==e&&e;return(0,m.jsxs)("table",{className:"table-thead-hidden",children:[(0,m.jsx)(Ze,{inAllLibs:t}),(0,m.jsx)("tbody",{children:n.renderRepoListView()})]})},n.state={isItemFreezed:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=f.Aq.isDesktop()?this.renderPCUI():this.renderMobileUI();return this.props.hasNextPage?(0,m.jsxs)(s.Fragment,{children:[e,(0,m.jsx)($.A,{})]}):e}}])}(s.Component),Wn=Vn,Kn=function(e){function t(){var e;(0,r.A)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=(0,i.A)(this,t,[].concat(o))).onRepoSelect=function(t){var n=t.target.checked;e.props.onRepoSelect(e.props.repo,n)},e.onPermissionChange=function(t){var n=t.target.value,r=e.props.repo;e.props.onPermissionChange(r,n)},e}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.repo,t=f.Aq.getLibIconUrl(e);return(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{className:"text-center",children:(0,m.jsx)("input",{type:"checkbox",className:"vam",name:"repo",onChange:this.onRepoSelect})}),(0,m.jsx)("td",{className:"text-center",children:(0,m.jsx)("img",{src:t,width:"24",alt:(0,h.AP)("icon")})}),(0,m.jsx)("td",{className:"name",children:e.repo_name}),(0,m.jsx)("td",{children:X()(e.last_modified).fromNow()}),(0,m.jsx)("td",{children:(0,m.jsxs)(P.A,{style:{height:"1.5rem",padding:0},type:"select",name:"select",onChange:this.onPermissionChange,value:e.sharePermission,children:[(0,m.jsx)("option",{value:"rw",children:(0,h.AP)("Read-Write")}),(0,m.jsx)("option",{value:"r",children:(0,h.AP)("Read-Only")})]})})]})}}])}(s.Component),Xn=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onRepoSelect=function(e,t){var r=[];t?(n.state.selectedRepoList.push(e),r=n.state.selectedRepoList):r=n.state.selectedRepoList.filter((function(t){return t.repo_id!==e.repo_id})),n.setState({selectedRepoList:r})},n.onPermissionChange=function(e,t){var r=n.state.repoList.map((function(n){return n.repo_id===e.repo_id&&(n.sharePermission=t),n}));n.setState({repoList:r})},n.handleSubmit=function(){if(0!==n.state.selectedRepoList.length)n.props.onRepoSelectedHandler(n.state.selectedRepoList),n.toggle();else{var e=(0,h.AP)("Please select a library to share.");n.setState({errMessage:e})}},n.toggle=function(){n.props.onShareRepoDialogClose()},n.state={repoList:[],currentRepo:null,permission:"rw",selectedRepoList:[],errMessage:""},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;k.e.listRepos({type:"mine"}).then((function(t){var n=t.data.repos.map((function(e){var t=new Xe(e);return t.sharePermission="rw",t}));e.setState({repoList:n})}))}},{key:"render",value:function(){var e=this;return(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.toggle,children:[(0,m.jsx)(I.A,{toggle:this.toggle,children:(0,h.AP)("Select libraries to share")}),(0,m.jsx)(_.A,{className:"dialog-list-container",children:(0,m.jsxs)("table",{children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"4%"}),(0,m.jsx)("th",{width:"6%"}),(0,m.jsx)("th",{width:"35%",children:(0,h.AP)("Name")}),(0,m.jsx)("th",{width:"25%",children:(0,h.AP)("Last Update")}),(0,m.jsx)("th",{width:"30%",children:(0,h.AP)("Permission")})]})}),(0,m.jsx)("tbody",{children:this.state.repoList.map((function(t,n){return(0,m.jsx)(Kn,{repo:t,onRepoSelect:e.onRepoSelect,onPermissionChange:e.onPermissionChange},n)}))})]})}),this.state.errMessage&&(0,m.jsx)(Dt.A,{color:"danger",className:"mt-2",children:this.state.errMessage}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(O.A,{color:"secondary",onClick:this.toggle,children:(0,h.AP)("Close")}),(0,m.jsx)(O.A,{color:"primary",onClick:this.handleSubmit,children:(0,h.AP)("Submit")})]})]})}}])}(s.Component),$n=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onItemUnshare=function(e){k.e.unshareRepo(e.repo_id,{share_type:"public"}).then((function(){var t=n.state.repoList.filter((function(t){return t.repo_id!==e.repo_id}));n.setState({repoList:t});var r=(0,h.AP)("Successfully unshared {name}").replace("{name}",e.repo_name);j.A.success(r)})).catch((function(t){var n=f.Aq.getErrorMsg(t);n===(0,h.AP)("Error")&&(n=(0,h.AP)("Failed to unshare {name}").replace("{name}",e.repo_name)),(0,j.A)(n)}))},n.onItemDelete=function(){},n.addRepoItem=function(e){for(var t=!1,r=0,o=n.state.repoList,i=0;i<o.length;i++)if(e.repo_id===o[i].repo_id){t=!0,r=i;break}t&&n.state.repoList.splice(r,1);var a=n.state.repoList.map((function(e){return e}));a.unshift(e),n.setState({repoList:a})},n.sortItems=function(e,t){Ke.Ay.save("seafile-repo-dir-sort-by",e),Ke.Ay.save("seafile-repo-dir-sort-order",t),n.setState({sortBy:e,sortOrder:t,repoList:f.Aq.sortRepos(n.state.repoList,e,t)})},n.toggleSortOptionsDialog=function(){n.setState({isSortOptionsDialogOpen:!n.state.isSortOptionsDialogOpen})},n.renderContent=function(){var e=n.props,t=e.inAllLibs,r=void 0!==t&&t,o=e.currentViewMode,i=void 0===o?"list":o,a=n.state.errMessage,s=r?(0,m.jsx)("p",{className:"libraries-empty-tip-in-".concat(i,"-mode"),children:(0,h.AP)("No public libraries")}):(0,m.jsx)(J.A,{title:(0,h.AP)("No public libraries"),text:(0,h.AP)('No public libraries have been created yet. A public library is accessible by all users. You can create a public library by clicking the "Add Library" button in the menu bar.')});return(0,m.jsxs)(m.Fragment,{children:[n.state.isLoading&&(0,m.jsx)($.A,{}),!n.state.isLoading&&a&&a,!n.state.isLoading&&0===n.state.repoList.length&&s,!n.state.isLoading&&n.state.repoList.length>0&&(0,m.jsx)(Wn,{libraryType:n.state.libraryType,repoList:n.state.repoList,sortBy:n.state.sortBy,sortOrder:n.state.sortOrder,sortItems:n.sortItems,onItemUnshare:n.onItemUnshare,onItemDelete:n.onItemDelete,theadHidden:r,currentViewMode:i,inAllLibs:r})]})},n.renderSortIconInMobile=function(){return(0,m.jsx)(m.Fragment,{children:!f.Aq.isDesktop()&&n.state.repoList.length>0&&(0,m.jsx)("span",{className:"sf3-font sf3-font-sort action-icon",onClick:n.toggleSortOptionsDialog})})},n.onCreateRepoToggle=function(){n.setState({isCreateRepoDialogOpen:!n.state.isCreateRepoDialogOpen})},n.onSelectRepoToggle=function(){n.setState({isSelectRepoDialogOpen:!n.state.isSelectRepoDialogOpen})},n.onCreateRepo=function(e){n.onCreateRepoToggle(),k.e.createPublicRepo(e).then((function(e){var t={repo_id:e.data.id,repo_name:e.data.name,permission:e.data.permission,size:e.data.size,owner_name:e.data.owner_name,owner_email:e.data.owner,mtime:e.data.mtime,encrypted:e.data.encrypted},r=new Xe(t);n.addRepoItem(r)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.onRepoSelectedHandler=function(e){e.forEach((function(e){k.e.selectOwnedRepoToPublic(e.repo_id,{share_type:"public",permission:e.sharePermission}).then((function(){n.addRepoItem(e)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))}))},n.state={isLoading:!0,errMessage:"",repoList:[],isCreateRepoDialogOpen:!1,isSelectRepoDialogOpen:!1,sortBy:Ke.Ay.load("seafile-repo-dir-sort-by")||"name",sortOrder:Ke.Ay.load("seafile-repo-dir-sort-order")||"asc",isSortOptionsDialogOpen:!1,libraryType:"public"},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.repoList?this.setState({isLoading:!1,repoList:f.Aq.sortRepos(this.props.repoList,this.state.sortBy,this.state.sortOrder)}):k.e.listRepos({type:"public"}).then((function(t){var n=t.data.repos.map((function(e){return new Xe(e)}));e.setState({isLoading:!1,repoList:f.Aq.sortRepos(n,e.state.sortBy,e.state.sortOrder)})})).catch((function(t){e.setState({isLoading:!1,errMessage:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this.props,t=e.inAllLibs,n=void 0!==t&&t,r=e.currentViewMode,o=void 0===r?"list":r;return n?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{className:"d-flex justify-content-between mt-3 py-1 ".concat("list"==o?"sf-border-bottom":""),children:[(0,m.jsxs)("h4",{className:"sf-heading m-0",children:[(0,m.jsx)("span",{className:"sf3-font-share-with-all sf3-font nav-icon","aria-hidden":"true"}),(0,h.AP)("Shared with all")]}),this.renderSortIconInMobile()]}),this.renderContent()]}):(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsxs)("div",{className:"cur-view-path",children:[(0,m.jsxs)("h3",{className:"sf-heading m-0",children:[(0,h.AP)("Shared with all"),h.P9&&(0,m.jsx)(Be,{opList:[{text:(0,h.AP)("Share existing libraries"),onClick:this.onSelectRepoToggle},{text:(0,h.AP)("New Library"),onClick:this.onCreateRepoToggle}]})]}),this.renderSortIconInMobile()]}),(0,m.jsx)("div",{className:"cur-view-content",children:this.renderContent()})]})}),this.state.isSortOptionsDialogOpen&&(0,m.jsx)(Re,{toggleDialog:this.toggleSortOptionsDialog,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems}),this.state.isCreateRepoDialogOpen&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(En,{libraryType:this.state.libraryType,onCreateToggle:this.onCreateRepoToggle,onCreateRepo:this.onCreateRepo})}),this.state.isSelectRepoDialogOpen&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(Xn,{onRepoSelectedHandler:this.onRepoSelectedHandler,onShareRepoDialogClose:this.onSelectRepoToggle})})]})}}])}(s.Component),Zn=$n,Jn=n(46256),Qn=n.n(Jn),er=""!==h.Wg?Qn()(h.Wg):void 0,tr=new(function(){return(0,o.A)((function e(){(0,r.A)(this,e)}),[{key:"watchRepo",value:function(e,t){er&&(er.emit("repo_update",{request:"watch_update",repo_id:e,user:{name:h.UU,username:h.Xh,contact_email:h.bd}}),er.on("repo_update",t))}},{key:"unwatchRepo",value:function(e,t){er&&(er.emit("repo_update",{request:"unwatch_update",repo_id:e,user:{name:h.UU,username:h.Xh,contact_email:h.bd}}),er.off("repo_update",t))}}])}()),nr=n(84878),rr=n(67665),or=n(25531),ir=n(89615),ar=n(56044),sr=n(25547),lr=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).handleSubmit=function(e){var t=n.props.repoID,r=n.state.password;k.e.setRepoDecryptPassword(t,r).then((function(e){n.props.onLibDecryptDialog()})).catch((function(e){n.setState({showError:!0})})),e.preventDefault()},n.handleKeyDown=function(e){"Enter"==e.key&&n.handleSubmit(e)},n.handleChange=function(e){n.setState({password:e.target.value,showError:!1})},n.toggle=function(){window.location.href=h.Yc},n.state={password:"",showError:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return(0,m.jsx)(p.A,{isOpen:!0,toggle:this.toggle,children:(0,m.jsxs)(_.A,{children:[(0,m.jsx)("button",{type:"button",className:"close",onClick:this.toggle,children:(0,m.jsx)("span",{"aria-hidden":"true",children:"\xd7"})}),(0,m.jsxs)(bt.A,{className:"lib-decrypt-form text-center",children:[(0,m.jsx)("img",{src:"".concat(h.SG,"img/lock.png"),alt:"","aria-hidden":"true"}),(0,m.jsx)("p",{className:"intro",children:(0,h.AP)("This library is password protected")}),this.state.showError&&(0,m.jsx)("p",{className:"error",children:(0,h.AP)("Wrong password")}),(0,m.jsx)("input",{type:"password",name:"password",className:"form-control password-input",autoComplete:"off",onKeyDown:this.handleKeyDown,placeholder:(0,h.AP)("Password"),onChange:this.handleChange}),(0,m.jsx)("button",{type:"submit",className:"btn btn-primary submit",onClick:this.handleSubmit,children:(0,h.AP)("Submit")}),(0,m.jsxs)("p",{className:"tip",children:["* ",(0,h.AP)("The password will be kept in the server for only 1 hour.")]})]})]})})}}])}(s.Component),cr=n(58788),ur=n(81617),dr=n(56999),pr=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).toggleDesktopOpMenu=function(){n.setState({isDesktopMenuOpen:!n.state.isDesktopMenuOpen})},n.toggleMobileOpMenu=function(){n.setState({isMobileOpMenuOpen:!n.state.isMobileOpMenuOpen})},n.onUploadFile=function(e){n.props.onUploadFile(e)},n.onUploadFolder=function(e){n.props.onUploadFolder(e)},n.onShareClick=function(){n.setState({isShareDialogShow:!n.state.isShareDialogShow})},n.onCreateFolderToggle=function(){n.setState({isCreateFolderDialogShow:!n.state.isCreateFolderDialogShow})},n.onCreateFileToggle=function(){n.setState({isCreateFileDialogShow:!n.state.isCreateFileDialogShow,fileType:""})},n.onCreateMarkdownToggle=function(){n.setState({isCreateFileDialogShow:!n.state.isCreateFileDialogShow,fileType:".md"})},n.onCreateExcelToggle=function(){n.setState({isCreateFileDialogShow:!n.state.isCreateFileDialogShow,fileType:".xlsx"})},n.onCreatePPTToggle=function(){n.setState({isCreateFileDialogShow:!n.state.isCreateFileDialogShow,fileType:".pptx"})},n.onCreateWordToggle=function(){n.setState({isCreateFileDialogShow:!n.state.isCreateFileDialogShow,fileType:".docx"})},n.onCreateSeaDocToggle=function(){n.setState({isCreateFileDialogShow:!n.state.isCreateFileDialogShow,fileType:".sdoc"})},n.onAddFolder=function(e){n.setState({isCreateFolderDialogShow:!1}),n.props.onAddFolder(e)},n.checkDuplicatedName=function(e){return n.props.direntList.some((function(t){return t.name===e}))},n.onDropdownToggleKeyDown=function(e){"Enter"!=e.key&&"Space"!=e.key||n.toggleDesktopOpMenu()},n.onDropDownMouseMove=function(e){n.state.isSubMenuShown&&e.target&&"dropdown-item"===e.target.className&&n.setState({isSubMenuShown:!1})},n.toggleSubMenu=function(e){e.stopPropagation(),n.setState({isSubMenuShown:!n.state.isSubMenuShown})},n.toggleSubMenuShown=function(e){n.setState({isSubMenuShown:!0,currentItem:e.text})},n.onMenuItemKeyDown=function(e,t){"Enter"!=t.key&&"Space"!=t.key||e.onClick()},n.state={fileType:".md",isCreateFileDialogShow:!1,isCreateFolderDialogShow:!1,isShareDialogShow:!1,operationMenuStyle:"",isDesktopMenuOpen:!1,isSubMenuShown:!1,isMobileOpMenuOpen:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.path,r=t.repoName,o=t.userPerm,i="/"===n?"library":"dir",a="/"==n?r:f.Aq.getFolderName(n),l=f.Aq.getUserPermission(o),c=l.isCustomPermission,u=l.customPermission,d=!0,p=!0;if(c){var g=u.permission;d=g.upload,p=g.create}var v=null;if(f.Aq.isDesktop()){var y=this.props,x=y.showShareBtn,A=y.repoEncrypted,C=[];if(d&&(f.Aq.isSupportUploadFolder()?C.push({icon:"upload-files",text:(0,h.AP)("Upload Files"),onClick:this.onUploadFile},{icon:"upload-files",text:(0,h.AP)("Upload Folder"),onClick:this.onUploadFolder}):C.push({icon:"upload-files",text:(0,h.AP)("Upload"),onClick:this.onUploadFile})),p){var b=[{text:(0,h.AP)("New Folder"),onClick:this.onCreateFolderToggle},{text:(0,h.AP)("New File"),onClick:this.onCreateFileToggle},"Divider"];h.lU&&!A&&b.push({text:(0,h.AP)("New SeaDoc File"),onClick:this.onCreateSeaDocToggle}),b.push({text:(0,h.AP)("New Markdown File"),onClick:this.onCreateMarkdownToggle},{text:(0,h.AP)("New Excel File"),onClick:this.onCreateExcelToggle},{text:(0,h.AP)("New PowerPoint File"),onClick:this.onCreatePPTToggle},{text:(0,h.AP)("New Word File"),onClick:this.onCreateWordToggle}),C.push({icon:"new",text:(0,h.AP)("New"),subOpList:b})}x&&C.push({icon:"share",text:(0,h.AP)("Share"),onClick:this.onShareClick}),v=(0,m.jsx)(s.Fragment,{children:(0,m.jsxs)(de.A,{isOpen:this.state.isDesktopMenuOpen,toggle:this.toggleDesktopOpMenu,children:[(0,m.jsxs)(pe.A,{tag:"div",role:"button",className:"path-item",onClick:this.toggleDesktopOpMenu,onKeyDown:this.onDropdownToggleKeyDown,"data-toggle":"dropdown",children:[this.props.children,(0,m.jsx)("i",{className:"sf3-font-down sf3-font ml-1 path-item-dropdown-toggle"})]}),(0,m.jsx)(Ue.A,{onMouseMove:this.onDropDownMouseMove,positionFixed:!0,children:C.map((function(t,n){return"Divider"==t?(0,m.jsx)(he.A,{divider:!0},n):t.subOpList?(0,m.jsxs)(de.A,{direction:"right",className:"w-100",isOpen:e.state.isSubMenuShown&&e.state.currentItem==t.text,toggle:e.toggleSubMenu,onMouseMove:function(e){e.stopPropagation()},children:[(0,m.jsxs)(pe.A,{tag:"div",className:"dropdown-item font-weight-normal rounded-0 d-flex align-items-center",onMouseEnter:e.toggleSubMenuShown.bind(e,t),children:[(0,m.jsx)("i",{className:"sf3-font-".concat(t.icon," sf3-font mr-2 dropdown-item-icon")}),(0,m.jsx)("span",{className:"mr-auto",children:t.text}),(0,m.jsx)("i",{className:"sf3-font-down sf3-font rotate-270"})]}),(0,m.jsx)(Ue.A,{children:t.subOpList.map((function(t,n){return"Divider"==t?(0,m.jsx)(he.A,{divider:!0},n):(0,m.jsx)(he.A,{onClick:t.onClick,onKeyDown:e.onMenuItemKeyDown.bind(e,t),children:t.text},n)}))})]},n):(0,m.jsxs)(he.A,{onClick:t.onClick,onKeyDown:e.onMenuItemKeyDown.bind(e,t),children:[(0,m.jsx)("i",{className:"sf3-font-".concat(t.icon," sf3-font mr-2 dropdown-item-icon")}),t.text]},n)}))})]})})}else v=(0,m.jsxs)(de.A,{isOpen:this.state.isMobileOpMenuOpen,toggle:this.toggleMobileOpMenu,children:[(0,m.jsxs)(pe.A,{tag:"div",role:"button",className:"path-item",children:[this.props.children,(0,m.jsx)("i",{className:"sf3-font-down sf3-font ml-1 path-item-dropdown-toggle"})]}),(0,m.jsxs)(Ue.A,{positionFixed:!0,children:[d&&(0,m.jsx)(he.A,{onClick:this.onUploadFile,children:(0,h.AP)("Upload")}),p&&(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)(he.A,{onClick:this.onCreateFolderToggle,children:(0,h.AP)("New Folder")}),(0,m.jsx)(he.A,{onClick:this.onCreateFileToggle,children:(0,h.AP)("New File")})]})]})]});return(0,m.jsxs)(s.Fragment,{children:[("rw"===o||"admin"===o||"cloud-edit"===o||c)&&(0,m.jsx)("div",{className:"dir-operation",children:v}),this.state.isCreateFileDialogShow&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(dr.A,{parentPath:this.props.path,fileType:this.state.fileType,onAddFile:this.props.onAddFile,checkDuplicatedName:this.checkDuplicatedName,toggleDialog:this.onCreateFileToggle})}),this.state.isCreateFolderDialogShow&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(ur.A,{parentPath:this.props.path,onAddFolder:this.onAddFolder,checkDuplicatedName:this.checkDuplicatedName,addFolderCancel:this.onCreateFolderToggle})}),this.state.isShareDialogShow&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(Je.A,{itemType:i,itemName:a,itemPath:this.props.path,repoID:this.props.repoID,repoEncrypted:this.props.repoEncrypted,enableDirPrivateShare:this.props.enableDirPrivateShare,userPerm:this.props.userPerm,isGroupOwnedRepo:this.props.isGroupOwnedRepo,toggleDialog:this.onShareClick})})]})}}])}(s.Component),hr=pr,fr=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).inputNewName=function(e){n.setState({tagName:e.target.value}),n.state.errorMsg&&n.setState({errorMsg:""})},n.selectTagcolor=function(e){n.setState({tagColor:e.target.value})},n.createTag=function(){var e=n.state.tagName,t=n.state.tagColor,r=n.props.repoID;k.e.createRepoTag(r,e,t).then((function(e){var t=e.data.repo_tag.repo_tag_id;n.props.onRepoTagCreated&&n.props.onRepoTagCreated(t),n.props.toggleCancel()})).catch((function(t){var r;500===t.response.status?r=(0,h.AP)("Internal Server Error"):400===t.response.status&&(r=(r=(0,h.AP)('Tag "{name}" already exists.')).replace("{name}",f.Aq.HTMLescape(e))),n.setState({errorMsg:r})}))},n.handleKeyDown=function(e){"Enter"===e.key&&n.createTag()},n.state={tagName:"",tagColor:R.cj[0],newTag:{},errorMsg:""},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=!!this.state.tagName.trim();return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsxs)(I.A,{toggle:this.props.onClose,children:[(0,m.jsx)("span",{className:"tag-dialog-back sf3-font sf3-font-arrow rotate-180 d-inline-block",onClick:this.props.toggleCancel,"aria-label":(0,h.AP)("Back")}),(0,h.AP)("New Tag")]}),(0,m.jsx)(_.A,{children:(0,m.jsxs)("div",{role:"form",className:"tag-create",children:[(0,m.jsxs)("div",{className:"form-group",children:[(0,m.jsx)("label",{className:"form-label",children:(0,h.AP)("Name")}),(0,m.jsx)(P.A,{onKeyDown:this.handleKeyDown,autoFocus:!0,value:this.state.tagName,onChange:this.inputNewName}),(0,m.jsx)("div",{className:"mt-2",children:(0,m.jsx)("span",{className:"error",children:this.state.errorMsg})})]}),(0,m.jsxs)("div",{className:"form-group",children:[(0,m.jsx)("label",{className:"form-label",children:(0,h.AP)("Select a color")}),(0,m.jsx)("div",{className:"d-flex justify-content-between",children:R.cj.map((function(t,n){return(0,m.jsx)("div",{className:"tag-color-option",onChange:e.selectTagcolor,children:(0,m.jsxs)("label",{className:"colorinput",children:[0===n?(0,m.jsx)("input",{name:"color",type:"radio",value:t,className:"colorinput-input",defaultChecked:!0,onClick:e.selectTagcolor}):(0,m.jsx)("input",{name:"color",type:"radio",value:t,className:"colorinput-input",onClick:e.selectTagcolor}),(0,m.jsx)("span",{className:"colorinput-color rounded-circle d-flex align-items-center justify-content-center",style:{backgroundColor:t},children:(0,m.jsx)("i",{className:"sf2-icon-tick color-selected"})})]})},n)}))})]})]})}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(O.A,{color:"secondary",onClick:this.props.toggleCancel,children:(0,h.AP)("Cancel")}),t?(0,m.jsx)(O.A,{color:"primary",onClick:this.createTag,children:(0,h.AP)("Save")}):(0,m.jsx)(O.A,{color:"primary",disabled:!0,children:(0,h.AP)("Save")})]})]})}}])}(s.Component),mr=fr;n(79627);var gr,vr=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onMouseEnter=function(){n.setState({isTagHighlighted:!0})},n.onMouseLeave=function(){n.setState({isTagHighlighted:!1})},n.getRepoTagIdList=function(){return(n.props.fileTagList||[]).map((function(e){return e.repo_tag_id}))},n.onEditFileTag=function(){var e=n.props,t=e.repoID,r=e.repoTag,o=e.filePath,i=n.getRepoTagIdList();if(-1===i.indexOf(r.id)){var a=r.id;k.e.addFileTag(t,o,a).then((function(){i=n.getRepoTagIdList(),n.props.onFileTagChanged()})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))}else{for(var s=null,l=n.props.fileTagList,c=0;c<l.length;c++)if(l[c].repo_tag_id===r.id){s=l[c];break}k.e.deleteFileTag(t,s.id).then((function(){i=n.getRepoTagIdList(),n.props.onFileTagChanged()})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))}},n.state={isTagHighlighted:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.state.isTagHighlighted,t=this.props.repoTag,n=-1!=this.getRepoTagIdList().indexOf(t.id);return(0,m.jsxs)("li",{className:"tag-list-item cursor-pointer px-4 d-flex justify-content-between align-items-center ".concat(e?"hl":""),onClick:this.onEditFileTag,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[(0,m.jsxs)("div",{className:"d-flex align-items-center",children:[(0,m.jsx)("span",{className:"tag-color w-4 h-4 rounded-circle",style:{backgroundColor:t.color}}),(0,m.jsx)("span",{className:"tag-name mx-2",children:t.name})]}),n&&(0,m.jsx)("i",{className:"sf2-icon-tick tag-selected-icon"})]})}}])}(s.Component),yr=function(e){function t(){return(0,r.A)(this,t),(0,i.A)(this,t,arguments)}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props.repoTags;return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)(I.A,{toggle:this.props.toggleCancel,children:(0,h.AP)("Select Tags")}),(0,m.jsxs)(_.A,{className:"px-0",children:[(0,m.jsx)("ul",{className:"tag-list tag-list-container",children:t.map((function(t){return(0,m.jsx)(vr,{repoTag:t,repoID:e.props.repoID,filePath:e.props.filePath,fileTagList:e.props.fileTagList,onFileTagChanged:e.props.onFileTagChanged},t.id)}))}),(0,m.jsxs)("a",{href:"#",className:"add-tag-link px-4 py-2 d-flex align-items-center",onClick:this.props.createNewTag,children:[(0,m.jsx)("span",{className:"sf2-icon-plus mr-2"}),(0,h.AP)("Create a new tag")]})]}),(0,m.jsx)(N.A,{children:(0,m.jsx)(O.A,{onClick:this.props.toggleCancel,children:(0,h.AP)("Close")})})]})}}])}(s.Component),xr=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).createNewTag=function(){n.setState({isCreateRepoTagShow:!n.state.isCreateRepoTagShow,isListRepoTagShow:!n.state.isListRepoTagShow})},n.onRepoTagCreated=function(e){var t=n.props,r=t.repoID,o=t.filePath;k.e.addFileTag(r,o,e).then((function(){n.props.onFileTagChanged()})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.state={isCreateRepoTagShow:!1,isListRepoTagShow:!0},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.props.toggleCancel,autoFocus:!1,children:[this.state.isListRepoTagShow&&(0,m.jsx)(yr,{repoID:this.props.repoID,repoTags:this.props.repoTags,filePath:this.props.filePath,fileTagList:this.props.fileTagList,onFileTagChanged:this.props.onFileTagChanged,toggleCancel:this.props.toggleCancel,createNewTag:this.createNewTag}),this.state.isCreateRepoTagShow&&(0,m.jsx)(mr,{repoID:this.props.repoID,onClose:this.props.toggleCancel,toggleCancel:this.createNewTag,onRepoTagCreated:this.onRepoTagCreated})]})}}])}(s.Component),Ar=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).toggleDropdownMenu=function(){n.setState({isDropdownMenuOpen:!n.state.isDropdownMenuOpen})},n.onDropdownToggleKeyDown=function(e){"Enter"!=e.key&&"Space"!=e.key||n.toggleDropdownMenu()},n.onDropDownMouseMove=function(e){e.preventDefault(),n.state.isSubMenuShown&&e.target&&"dropdown-item"===e.target.className&&n.setState({isSubMenuShown:!1})},n.toggleSubMenu=function(e){e.stopPropagation(),n.setState({isSubMenuShown:!n.state.isSubMenuShown},(function(){n.toggleDropdownMenu()}))},n.toggleSubMenuShown=function(e){n.setState({isSubMenuShown:!0,currentItem:e.text})},n.onMenuItemKeyDown=function(e,t){"Enter"!=t.key&&"Space"!=t.key||e.onClick()},n.onEditClick=function(e){e.preventDefault();var t=n.props,r=t.path,o=t.repoID,i=h.Yc+"lib/"+o+"/file"+f.Aq.encodePath(r)+"?mode=edit";window.open(i)},n.toggleMore=function(){n.setState({isMoreMenuShow:!n.state.isMoreMenuShow})},n.onShareToggle=function(){n.setState({isShareDialogShow:!n.state.isShareDialogShow})},n.onEditFileTagToggle=function(){n.setState({isEditTagDialogShow:!n.state.isEditTagDialogShow})},n.onHistoryClick=function(){var e=h.Yc+"repo/file_revisions/"+n.props.repoID+"/?p="+f.Aq.encodePath(n.props.path);location.href=e},n.state={isDropdownMenuOpen:!1,isMoreMenuShow:!1,isShareDialogShow:!1,isEditTagDialogShow:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.filePermission,r=t.showShareBtn,o=[];return"rw"!==n&&"cloud-edit"!==n||o.push({icon:"rename",text:(0,h.AP)("Edit"),onClick:this.onEditClick}),"rw"===n&&(r&&o.push({icon:"share",text:(0,h.AP)("Share"),onClick:this.onShareToggle}),o.push({icon:"tag",text:(0,h.AP)("Tags"),onClick:this.onEditFileTagToggle},{icon:"history",text:(0,h.AP)("History"),onClick:this.onHistoryClick})),(0,m.jsxs)(s.Fragment,{children:[o.length>0&&(0,m.jsxs)(de.A,{isOpen:this.state.isDropdownMenuOpen,toggle:this.toggleDropdownMenu,className:"view-file-toolbar-dropdown",children:[(0,m.jsxs)(pe.A,{tag:"div",role:"button",className:"path-item",onClick:this.toggleDropdownMenu,onKeyDown:this.onDropdownToggleKeyDown,"data-toggle":"dropdown",children:[this.props.children,(0,m.jsx)("i",{className:"sf3-font-down sf3-font ml-1 path-item-dropdown-toggle"})]}),(0,m.jsx)(Ue.A,{positionFixed:!0,onMouseMove:this.onDropDownMouseMove,children:o.map((function(t,n){return"Divider"==t?(0,m.jsx)(he.A,{divider:!0},n):t.subOpList?(0,m.jsxs)(de.A,{direction:"right",className:"w-100",isOpen:e.state.isSubMenuShown&&e.state.currentItem==t.text,toggle:e.toggleSubMenu,onMouseMove:function(e){e.stopPropagation()},children:[(0,m.jsxs)(pe.A,{className:"dropdown-item font-weight-normal rounded-0 d-flex align-items-center",onMouseEnter:e.toggleSubMenuShown.bind(e,t),children:[(0,m.jsx)("i",{className:"sf3-font-".concat(t.icon," sf3-font mr-2 dropdown-item-icon")}),(0,m.jsx)("span",{className:"mr-auto",children:t.text}),(0,m.jsx)("i",{className:"sf3-font-down sf3-font rotate-270"})]}),(0,m.jsx)(Ue.A,{children:t.subOpList.map((function(t,n){return"Divider"==t?(0,m.jsx)(he.A,{divider:!0},n):(0,m.jsx)(he.A,{onClick:t.onClick,onKeyDown:e.onMenuItemKeyDown.bind(e,t),children:t.text},n)}))})]},n):(0,m.jsxs)(he.A,{onClick:t.onClick,onKeyDown:e.onMenuItemKeyDown.bind(e,t),children:[(0,m.jsx)("i",{className:"sf3-font-".concat(t.icon," sf3-font mr-2 dropdown-item-icon")}),t.text]},n)}))})]}),this.state.isShareDialogShow&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(Je.A,{itemType:"file",itemName:f.Aq.getFileName(this.props.path),itemPath:this.props.path,repoID:this.props.repoID,repoEncrypted:this.props.repoEncrypted,enableDirPrivateShare:this.props.enableDirPrivateShare,userPerm:this.props.userPerm,isGroupOwnedRepo:this.props.isGroupOwnedRepo,toggleDialog:this.onShareToggle})}),this.state.isEditTagDialogShow&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(xr,{filePath:this.props.path,repoID:this.props.repoID,repoTags:this.props.repoTags,fileTagList:this.props.fileTags,toggleCancel:this.onEditFileTagToggle,onFileTagChanged:this.props.onFileTagChanged})})]})}}])}(s.Component),Cr=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onPathClick=function(e){var t=f.Aq.getEventData(e,"path");n.props.onPathClick(t)},n.onTabNavClick=function(e,t,r){if(window.uploader&&window.uploader.isUploadProgressDialogShow&&100!==window.uploader.totalProgress){if(!window.confirm((0,h.AP)("A file is being uploaded. Are you sure you want to leave this page?")))return e.preventDefault(),!1;window.uploader.isUploadProgressDialogShow=!1}n.props.onTabNavClick(t,r)},n.onDragEnter=function(e){if(e.preventDefault(),f.Aq.isIEBrowser())return!1;n.setState({dropTargetPath:e.target.dataset.path})},n.onDragLeave=function(e){if(e.preventDefault(),f.Aq.isIEBrowser())return!1;n.setState({dropTargetPath:""})},n.onDragOver=function(e){if(f.Aq.isIEBrowser())return!1;e.preventDefault(),e.dataTransfer.dropEffect="move"},n.onDrop=function(e){if(f.Aq.isIEBrowser())return!1;if(!e.dataTransfer.files.length){var t=f.Aq.getEventData(e,"path"),r=e.dataTransfer.getData("application/drag-item-info");if(r=JSON.parse(r),Array.isArray(r))n.props.onItemsMove(n.props.currentRepoInfo,t);else{var o=r,i=o.nodeDirent,a=o.nodeParentPath;n.props.onItemMove(n.props.currentRepoInfo,i,t,a)}n.setState({dropTargetPath:""})}},n.turnPathToLink=function(e){var t=(e="/"===e[e.length-1]?e.slice(0,e.length-1):e).split("/"),r="";return t.map((function(e,o){return""===e?null:o===t.length-2&&e===R.AT.FILE_EXTENDED_PROPERTIES?(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("span",{className:"path-split",children:"/"}),(0,m.jsx)("span",{className:"path-item",children:(0,h.AP)("Views")})]},o):o===t.length-1&&t[t.length-2]===R.AT.FILE_EXTENDED_PROPERTIES?(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("span",{className:"path-split",children:"/"}),(0,m.jsx)("span",{className:"path-item",children:e})]},o):o===t.length-1?(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("span",{className:"path-split",children:"/"}),n.props.isViewFile?(0,m.jsx)(Ar,{path:n.props.currentPath,repoID:n.props.repoID,userPerm:n.props.userPerm,repoEncrypted:n.props.repoEncrypted,enableDirPrivateShare:n.props.enableDirPrivateShare,isGroupOwnedRepo:n.props.isGroupOwnedRepo,filePermission:n.props.filePermission,fileTags:n.props.fileTags,onFileTagChanged:n.props.onFileTagChanged,showShareBtn:n.props.showShareBtn,repoTags:n.props.repoTags,children:(0,m.jsx)("span",{className:"path-file-name",children:e})}):(0,m.jsx)(hr,{path:n.props.currentPath,repoID:n.props.repoID,repoName:n.props.repoName,repoEncrypted:n.props.repoEncrypted,direntList:n.props.direntList,showShareBtn:n.props.showShareBtn,enableDirPrivateShare:n.props.enableDirPrivateShare,userPerm:n.props.userPerm,isGroupOwnedRepo:n.props.isGroupOwnedRepo,onAddFile:n.props.onAddFile,onAddFolder:n.props.onAddFolder,onUploadFile:n.props.onUploadFile,onUploadFolder:n.props.onUploadFolder,children:(0,m.jsx)("span",{className:"path-file-name",children:e})})]},o):(r+="/"+e,(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("span",{className:"path-split",children:"/"}),(0,m.jsx)("span",{className:"path-item ".concat(r===n.state.dropTargetPath?"path-item-drop":""),"data-path":r,onClick:n.onPathClick,onDragEnter:n.onDragEnter,onDragLeave:n.onDragLeave,onDragOver:n.onDragOver,onDrop:n.onDrop,role:"button",children:e})]},o))}))},n.isViewMetadata=function(){var e=n.props.currentPath,t=("/"===e[e.length-1]?e.slice(0,e.length-1):e).split("/");return t[t.length-2]===R.AT.FILE_EXTENDED_PROPERTIES},n.state={dropTargetPath:""},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.currentPath,r=t.repoName,o=t.fileTags,i=this.turnPathToLink(n),a="";return o.length>0&&o.forEach((function(e){a+=e.name+" "})),(0,m.jsxs)("div",{className:"path-container dir-view-path",children:[(0,m.jsx)("span",{className:"cur-view-path-btn mr-1",onClick:this.props.toggleTreePanel,children:(0,m.jsx)("span",{className:"sf3-font-side-bar sf3-font"})}),this.props.pathPrefix&&this.props.pathPrefix.map((function(t,n){return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)(c.N_,{to:t.url,className:"path-item normal",onClick:function(n){return e.onTabNavClick(n,t.name,t.id)},children:(0,h.AP)(t.showName)}),(0,m.jsx)("span",{className:"path-split",children:"/"})]},n)})),this.props.pathPrefix&&0===this.props.pathPrefix.length&&(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)(c.N_,{to:h.Yc+"libraries/",className:"path-item normal",onClick:function(t){return e.onTabNavClick(t,"libraries")},children:(0,h.AP)("Files")}),(0,m.jsx)("span",{className:"path-split",children:"/"})]}),!this.props.pathPrefix&&(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)(c.N_,{to:h.Yc+"libraries/",className:"path-item normal",onClick:function(t){return e.onTabNavClick(t,"libraries")},children:(0,h.AP)("Files")}),(0,m.jsx)("span",{className:"path-split",children:"/"})]}),"/"===n||""===n?(0,m.jsx)(hr,{path:this.props.currentPath,repoID:this.props.repoID,repoName:this.props.repoName,repoEncrypted:this.props.repoEncrypted,direntList:this.props.direntList,showShareBtn:this.props.showShareBtn,enableDirPrivateShare:this.props.enableDirPrivateShare,userPerm:this.props.userPerm,isGroupOwnedRepo:this.props.isGroupOwnedRepo,onAddFile:this.props.onAddFile,onAddFolder:this.props.onAddFolder,onUploadFile:this.props.onUploadFile,onUploadFolder:this.props.onUploadFolder,children:(0,m.jsx)("span",{className:"path-repo-name",children:r})}):(0,m.jsx)("span",{className:"path-item","data-path":"/",onClick:this.onPathClick,role:"button",children:r}),i,this.props.isViewFile&&!this.isViewMetadata()&&(0,m.jsx)(cr.j,{repoID:this.props.repoID,path:this.props.currentPath}),this.props.isViewFile&&0!==o.length&&(0,m.jsxs)("span",{id:"column-mode-file-tags",className:"tag-list tag-list-stacked align-middle ml-1 d-flex align-items-center",children:[o.map((function(e,t){return(0,m.jsx)("span",{className:"file-tag",style:{zIndex:t,backgroundColor:e.color}},e.id)})),(0,m.jsx)(Qe.A,{target:"column-mode-file-tags",placement:"bottom",children:a})]})]})}}])}(s.Component),br=Cr,wr=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).toggleSortOptionsDialog=function(){n.setState({isSortOptionsDialogOpen:!n.state.isSortOptionsDialogOpen})},n.state={isSortOptionsDialogOpen:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return(0,m.jsxs)("div",{className:"cur-dir-path d-flex justify-content-between align-items-center",children:[(0,m.jsx)(br,{currentRepoInfo:this.props.currentRepoInfo,repoID:this.props.repoID,repoName:this.props.repoName,repoEncrypted:this.props.repoEncrypted,isGroupOwnedRepo:this.props.isGroupOwnedRepo,pathPrefix:this.props.pathPrefix,currentPath:this.props.currentPath,userPerm:this.props.userPerm,onPathClick:this.props.onPathClick,onTabNavClick:this.props.onTabNavClick,isViewFile:this.props.isViewFile,fileTags:this.props.fileTags,toggleTreePanel:this.props.toggleTreePanel,enableDirPrivateShare:this.props.enableDirPrivateShare,showShareBtn:this.props.showShareBtn,onAddFolder:this.props.onAddFolder,onAddFile:this.props.onAddFile,onUploadFile:this.props.onUploadFile,onUploadFolder:this.props.onUploadFolder,direntList:this.props.fullDirentList,filePermission:this.props.filePermission,onFileTagChanged:this.props.onFileTagChanged,repoTags:this.props.repoTags,onItemMove:this.props.onItemMove}),!this.props.isDesktop&&this.props.direntList.length>0&&(0,m.jsx)("span",{className:"sf3-font sf3-font-sort action-icon",onClick:this.toggleSortOptionsDialog}),this.state.isSortOptionsDialogOpen&&(0,m.jsx)(Re,{toggleDialog:this.toggleSortOptionsDialog,sortBy:this.props.sortBy,sortOrder:this.props.sortOrder,sortItems:this.props.sortItems})]})}}])}(s.Component),Sr=n(89379),Dr=n(94634),kr=n(4966),Mr={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},jr=new Uint8Array(16);function Ir(){if(!gr&&!(gr="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return gr(jr)}for(var _r=[],Pr=0;Pr<256;++Pr)_r.push((Pr+256).toString(16).slice(1));function Nr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return _r[e[t+0]]+_r[e[t+1]]+_r[e[t+2]]+_r[e[t+3]]+"-"+_r[e[t+4]]+_r[e[t+5]]+"-"+_r[e[t+6]]+_r[e[t+7]]+"-"+_r[e[t+8]]+_r[e[t+9]]+"-"+_r[e[t+10]]+_r[e[t+11]]+_r[e[t+12]]+_r[e[t+13]]+_r[e[t+14]]+_r[e[t+15]]}var Or,Tr,Er,Rr,Lr,Fr,Ur=function(e,t,n){if(Mr.randomUUID&&!t&&!e)return Mr.randomUUID();var r=(e=e||{}).random||(e.rng||Ir)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var o=0;o<16;++o)t[n+o]=r[o];return t}return Nr(r)},Br=n(9772),Yr=n(26100),qr=(n(79627),function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).togglePopover=function(){n.setState({isPopoverOpen:!n.state.isPopoverOpen})},n.selectTagColor=function(e){var t=e.target.value,r=n.props,o=r.repoID,i=r.tag,a=i.id,s=i.name;k.e.updateRepoTag(o,a,s,t).then((function(){n.setState({tagColor:t,isPopoverOpen:!n.state.isPopoverOpen})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.state={tagColor:n.props.tag.color,isPopoverOpen:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.tag.color!==this.props.tag.color&&this.setState({tagColor:e.tag.color})}},{key:"render",value:function(){var e=this,t=this.state,n=t.isPopoverOpen,r=t.tagColor,o=this.props.tag,i=o.id,a=o.color,s=(0,W.A)(R.cj);return-1==s.indexOf(a)&&s.unshift(a),(0,m.jsxs)("div",{children:[(0,m.jsx)("span",{id:"tag-".concat(i,"-color"),className:"tag-color cursor-pointer rounded-circle d-flex align-items-center justify-content-center",style:{backgroundColor:r},onClick:this.togglePopover,children:(0,m.jsx)("i",{className:"sf3-font sf3-font-down text-white"})}),(0,m.jsx)(Br.A,{target:"tag-".concat(i,"-color"),isOpen:n,placement:"bottom",toggle:this.togglePopover,className:"tag-color-popover mw-100",children:(0,m.jsx)(Yr.A,{className:"p-2",children:(0,m.jsx)("div",{className:"d-flex justify-content-between",children:s.map((function(t,n){return(0,m.jsx)("div",{className:"tag-color-option mx-1",children:(0,m.jsxs)("label",{className:"colorinput",children:[(0,m.jsx)("input",{name:"color",type:"radio",value:t,className:"colorinput-input",defaultChecked:t==r,onClick:e.selectTagColor}),(0,m.jsx)("span",{className:"colorinput-color rounded-circle d-flex align-items-center justify-content-center",style:{backgroundColor:t},children:(0,m.jsx)("i",{className:"sf2-icon-tick color-selected"})})]})},n)}))})})})]})}}])}(s.Component)),Hr=qr,Gr=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).toggleMode=function(){n.setState({isEditing:!n.state.isEditing},(function(){n.state.isEditing&&n.input.current.focus()}))},n.updateTagName=function(e){var t=e.target.value,r=n.props,o=r.repoID,i=r.tag,a=i.id,s=i.color;k.e.updateRepoTag(o,a,t,s).then((function(){n.setState({tagName:t})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.onInputKeyDown=function(e){"Enter"==e.key?(n.toggleMode(),n.updateTagName(e)):"Escape"==e.key&&(e.nativeEvent.stopImmediatePropagation(),n.toggleMode())},n.onInputBlur=function(e){n.toggleMode(),n.updateTagName(e)},n.state={tagName:n.props.tag.name,isEditing:!1},n.input=s.createRef(),n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.tag.name!==this.props.tag.name&&this.setState({tagName:e.tag.name})}},{key:"render",value:function(){var e=this.state,t=e.isEditing,n=e.tagName;return(0,m.jsx)("div",{className:"mx-2 flex-fill d-flex",children:t?(0,m.jsx)("input",{type:"text",ref:this.input,defaultValue:n,onBlur:this.onInputBlur,onKeyDown:this.onInputKeyDown,className:"flex-fill form-control-sm form-control"}):(0,m.jsx)("span",{onClick:this.toggleMode,className:"cursor-pointer flex-fill",children:n})})}}])}(s.Component),zr=Gr,Vr=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onMouseOver=function(){n.setState({isTagHighlighted:!0})},n.onMouseOut=function(){n.setState({isTagHighlighted:!1})},n.deleteTag=function(){n.props.onDeleteTag(n.props.item)},n.state={isTagHighlighted:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.state.isTagHighlighted,t=this.props,n=t.item,r=t.repoID;return(0,m.jsxs)("li",{className:"tag-list-item px-4 d-flex justify-content-between align-items-center ".concat(e?"hl":""),onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut,children:[(0,m.jsx)(Hr,{repoID:r,tag:n}),(0,m.jsx)(zr,{repoID:r,tag:n}),(0,m.jsx)("button",{className:"tag-delete-icon sf3-font-delete1 sf3-font border-0 px-0 bg-transparent cursor-pointer ".concat(e?"":"invisible"),onClick:this.deleteTag,"aria-label":(0,h.AP)("Delete"),title:(0,h.AP)("Delete")})]})}}])}(s.Component),Wr=Vr,Kr=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).togglePopover=function(){n.setState({isPopoverOpen:!n.state.isPopoverOpen})},n.selectTagColor=function(e){var t=e.target.value;n.props.updateVirtualTag(n.props.tag,{color:t}),n.setState({tagColor:t,isPopoverOpen:!n.state.isPopoverOpen})},n.state={tagColor:n.props.tag.color,isPopoverOpen:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.tag.color!==this.props.tag.color&&this.setState({tagColor:e.tag.color})}},{key:"render",value:function(){var e=this,t=this.state,n=t.isPopoverOpen,r=t.tagColor,o=this.props.tag,i=o.id,a=o.color,s=(0,W.A)(R.cj);return-1==s.indexOf(a)&&s.unshift(a),(0,m.jsxs)("div",{children:[(0,m.jsx)("span",{id:"tag-".concat(i,"-color"),className:"tag-color cursor-pointer rounded-circle d-flex align-items-center justify-content-center",style:{backgroundColor:r},onClick:this.togglePopover,children:(0,m.jsx)("i",{className:"sf3-font sf3-font-down text-white"})}),(0,m.jsx)(Br.A,{target:"tag-".concat(i,"-color"),isOpen:n,placement:"bottom",toggle:this.togglePopover,className:"tag-color-popover mw-100",children:(0,m.jsx)(Yr.A,{className:"p-2",children:(0,m.jsx)("div",{className:"d-flex justify-content-between",children:s.map((function(t,n){return(0,m.jsx)("div",{className:"tag-color-option mx-1",children:(0,m.jsxs)("label",{className:"colorinput",children:[(0,m.jsx)("input",{name:"color",type:"radio",value:t,className:"colorinput-input",defaultChecked:t==r,onClick:e.selectTagColor}),(0,m.jsx)("span",{className:"colorinput-color rounded-circle d-flex align-items-center justify-content-center",style:{backgroundColor:t},children:(0,m.jsx)("i",{className:"sf2-icon-tick color-selected"})})]})},n)}))})})})]})}}])}(s.Component),Xr=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).toggleMode=function(){n.setState({isEditing:!n.state.isEditing})},n.updateTagName=function(e){var t=e.target.value;n.props.updateVirtualTag(n.props.tag,{name:t}),n.setState({tagName:t})},n.onInputKeyDown=function(e){"Enter"==e.key?(n.toggleMode(),n.updateTagName(e)):"Escape"==e.key&&(e.nativeEvent.stopImmediatePropagation(),n.toggleMode())},n.onInputBlur=function(e){n.toggleMode(),n.updateTagName(e)},n.state={tagName:n.props.tag.name,isEditing:!0},n.input=s.createRef(),n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.tag.name!==this.props.tag.name&&this.setState({tagName:e.tag.name})}},{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){e.input.current.focus()}),1)}},{key:"render",value:function(){var e=this.state,t=e.isEditing,n=e.tagName;return(0,m.jsx)("div",{className:"mx-2 flex-fill d-flex",children:t?(0,m.jsx)("input",{type:"text",ref:this.input,defaultValue:n,onBlur:this.onInputBlur,onKeyDown:this.onInputKeyDown,className:"flex-fill form-control-sm form-control"}):(0,m.jsx)("span",{onClick:this.toggleMode,className:"cursor-pointer flex-fill",style:{width:100,height:20},children:n})})}}])}(s.Component),$r=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onMouseOver=function(){n.setState({isTagHighlighted:!0})},n.onMouseOut=function(){n.setState({isTagHighlighted:!1})},n.deleteVirtualTag=function(){n.props.deleteVirtualTag(n.props.item)},n.state={isTagHighlighted:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.state.isTagHighlighted,t=this.props,n=t.item,r=t.repoID;return(0,m.jsxs)("li",{className:"tag-list-item px-4 d-flex justify-content-between align-items-center ".concat(e?"hl":""),onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut,children:[(0,m.jsx)(Kr,{repoID:r,tag:n,updateVirtualTag:this.props.updateVirtualTag}),(0,m.jsx)(Xr,{repoID:r,tag:n,updateVirtualTag:this.props.updateVirtualTag}),(0,m.jsx)("button",{className:"tag-delete-icon sf3-font-delete1 sf3-font border-0 px-0 bg-transparent cursor-pointer ".concat(e?"":"invisible"),onClick:this.deleteVirtualTag,"aria-label":(0,h.AP)("Delete"),title:(0,h.AP)("Delete")})]})}}])}(s.Component),Zr=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).toggleTooltip=function(){n.setState({showTooltip:!n.state.showTooltip})},n.onClickImport=function(){n.importOptionsInput.click()},n.importTagsInputChange=function(){if(n.importOptionsInput.files&&n.importOptionsInput.files.length){var e=new FileReader;e.onload=n.onImportTags.bind(n),e.onerror=n.onImportTagsError.bind(n),e.readAsText(n.importOptionsInput.files[0])}else j.A.warning((0,h.AP)("Please select a file"))},n.getValidTags=function(e){var t=[],r={};n.props.repotagList.forEach((function(e){return r[e.name]=!0}));for(var o=0;o<e.length;o++)e[o]&&"object"===typeof e[o]&&e[o].name&&e[o].color&&(r[e[o].name]||(t.push({name:e[o].name,color:e[o].color}),r[e[o].name]=!0));return t},n.onImportTags=function(e){var t=[];try{t=JSON.parse(e.target.result)}catch(o){return void j.A.danger((0,h.AP)("The imported tags are invalid"))}if(Array.isArray(t)&&0!==t.length){var r=n.getValidTags(t);0!==r.length?(k.e.createRepoTags(n.props.repoID,r).then((function(e){j.A.success((0,h.AP)("Tags imported"));var t=[];e.data.repo_tags.forEach((function(e){var n=new or.A(e);t.push(n)})),n.props.updateTags(t)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)})),n.importOptionsInput.value=null):j.A.warning((0,h.AP)("The imported tag already exists"))}else j.A.danger((0,h.AP)("The imported tags are invalid"))},n.onImportTagsError=function(){j.A.success((0,h.AP)("Failed to import tags. Please reupload."))},n.getDownloadUrl=function(){var e=n.props.repotagList.map((function(e){return{name:e.name,color:e.color}}));return"data:text/json;charset=utf-8,".concat(encodeURIComponent(JSON.stringify(e)))},n.state={showTooltip:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this;return(0,m.jsxs)("div",{className:"tag-list-footer",children:[(0,m.jsx)("span",{className:"sf3-font sf3-font-tips mr-2",style:{color:"#999"},id:"import-export-tags-tip"}),(0,m.jsx)(U.A,{toggle:this.toggleTooltip,delay:{show:0,hide:0},target:"import-export-tags-tip",placement:"bottom",isOpen:this.state.showTooltip,children:(0,h.AP)("Use the import/export function to transfer tags quickly to another library. (The export is in JSON format.)")}),(0,m.jsx)("input",{type:"file",ref:function(t){return e.importOptionsInput=t},accept:".json",className:"d-none",onChange:this.importTagsInputChange}),(0,m.jsx)("span",{className:"item-text",onClick:this.onClickImport,children:(0,h.AP)("Import tags")}),(0,m.jsx)("span",{className:"mx-2",children:"|"}),(0,m.jsx)("a",{href:this.getDownloadUrl(),download:"tags.json",onClick:this.props.toggle,children:(0,m.jsx)("span",{className:"item-text",children:(0,h.AP)("Export tags")})})]})}}])}(s.Component),Jr=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).loadTags=function(){k.e.listRepoTags(n.props.repoID).then((function(e){var t=[];e.data.repo_tags.forEach((function(e){var n=new or.A(e);t.push(n)})),n.setState({repotagList:t})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.updateTags=function(e){n.setState({repotagList:[].concat((0,W.A)(n.state.repotagList),(0,W.A)(e))})},n.onDeleteTag=function(e){var t=n.props.repoID,r=e.id;k.e.deleteRepoTag(t,r).then((function(e){n.setState({repotagList:n.state.repotagList.filter((function(e){return e.id!=r}))})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.createVirtualTag=function(e){e.preventDefault();var t=n.state.repotagList,r={name:"",color:R.cj[Math.floor(Math.random()*R.cj.length)],id:"virtual-tag-".concat(Ur()),is_virtual:!0};t.push(r),n.setState({repotagList:t})},n.deleteVirtualTag=function(e){var t=n.state.repotagList,r=t.findIndex((function(t){return t.id===e.id}));t.splice(r,1),n.setState({repotagList:t})},n.updateVirtualTag=function(e,t){var r=n.props.repoID,o=n.state.repotagList,i=o.findIndex((function(t){return t.id===e.id}));if(i<0)return null;if(t.color)return e.color=t.color,o[i]=e,void n.setState({repotagList:o});if(t.name&&t.name.length>0){var a=e.color,s=t.name;k.e.createRepoTag(r,s,a).then((function(e){o[i]=new or.A(e.data.repo_tag),n.setState({repotagList:o})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))}},n.state={repotagList:[]},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.loadTags()}},{key:"render",value:function(){var e=this;return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("ul",{className:"tag-list tag-list-container my-2",children:this.state.repotagList.map((function(t,n){return t.is_virtual?(0,m.jsx)($r,{item:t,repoID:e.props.repoID,deleteVirtualTag:e.deleteVirtualTag,updateVirtualTag:e.updateVirtualTag},n):(0,m.jsx)(Wr,{item:t,repoID:e.props.repoID,onDeleteTag:e.onDeleteTag},n)}))}),(0,m.jsxs)("div",{className:"add-tag-link px-4 py-2 d-flex align-items-center",onClick:this.createVirtualTag,children:[(0,m.jsx)("span",{className:"sf2-icon-plus mr-2"}),(0,h.AP)("Create a new tag")]}),(0,m.jsx)(Zr,{toggle:this.props.onListTagCancel,repotagList:this.state.repotagList,updateTags:this.updateTags,repoID:this.props.repoID})]})}}])}(s.Component),Qr=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onKeyDown=function(e){e.shiftKey&&49===e.keyCode?n.props.switchViewMode("list"):e.shiftKey&&50===e.keyCode&&n.props.switchViewMode("grid")},n.toggleDropdownMenu=function(){n.setState({isDropdownMenuOpen:!n.state.isDropdownMenuOpen})},n.state={isDropdownMenuOpen:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.onKeyDown)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.onKeyDown)}},{key:"render",value:function(){var e=this,t=this.state.isDropdownMenuOpen,n=this.props.currentViewMode,r=[{icon:"list-view",text:(0,h.AP)("List view"),value:"list",shortcut:"Shift 1"},{icon:"grid-view",text:(0,h.AP)("Grid view"),value:"grid",shortcut:"Shift 2"}];return(0,m.jsxs)(de.A,{isOpen:t,toggle:this.toggleDropdownMenu,id:"cur-view-change-mode-dropdown",children:[(0,m.jsx)(pe.A,{tag:"div","data-toggle":"dropdown",title:(0,h.AP)("Switch view mode"),"aria-label":(0,h.AP)("Switch view mode"),"aria-expanded":t,children:(0,m.jsxs)("span",{className:"cur-view-path-btn px-1",children:[(0,m.jsx)("span",{className:"sf3-font sf3-font-".concat(n,"-view")}),(0,m.jsx)("span",{className:"sf3-font sf3-font-down"})]})}),(0,m.jsx)(Ue.A,{right:!0,className:"mt-1",children:r.map((function(t,r){return(0,m.jsx)(he.A,{className:"p-0",onClick:e.props.switchViewMode.bind(e,t.value),children:(0,m.jsxs)("div",{className:"view-modes-dropdown-wrapper",children:[(0,m.jsx)("span",{className:"view-modes-dropdown-tick",children:n===t.value&&(0,m.jsx)("i",{className:"sf2-icon-tick"})}),(0,m.jsxs)("span",{className:"view-modes-dropdown-content",children:[(0,m.jsx)("span",{className:"sf3-font-".concat(t.icon," sf3-font mr-2")}),(0,m.jsx)("span",{children:t.text})]}),(0,m.jsx)("span",{className:"view-modes-dropdown-shortcut",children:(0,m.jsx)("span",{children:t.shortcut})})]})},r)}))})]})}}])}(s.Component),eo=Qr,to=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).toggleDropdownMenu=function(){n.setState({isDropdownMenuOpen:!n.state.isDropdownMenuOpen})},n.state={isDropdownMenuOpen:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.state.isDropdownMenuOpen,n=this.props.sortOptions;return(0,m.jsxs)(de.A,{isOpen:t,toggle:this.toggleDropdownMenu,children:[(0,m.jsx)(pe.A,{tag:"div","data-toggle":"dropdown",title:(0,h.AP)("Switch sort mode"),"aria-label":(0,h.AP)("Switch sort mode"),"aria-expanded":t,children:(0,m.jsxs)("span",{className:"cur-view-path-btn px-1",role:"button",children:[(0,m.jsx)("i",{className:"sf3-font-sort2 sf3-font"}),(0,m.jsx)("i",{className:"sf3-font-down sf3-font"})]})}),(0,m.jsx)(Ue.A,{right:!0,className:"mt-1",children:n.map((function(t,n){return(0,m.jsx)(he.A,{onClick:e.props.onSelectSortOption.bind(e,t),children:(0,m.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,m.jsx)("span",{className:"mr-8",children:t.text}),(0,m.jsx)("span",{children:t.isSelected&&(0,m.jsx)("i",{className:"sf2-icon-tick"})})]})},n)}))})]})}}])}(s.Component),no=to,ro=n(64467),oo=(0,o.A)((function e(t){var n=this,o=t.api,i=t.mediaUrl,a=void 0===i?"":i;(0,r.A)(this,e),this.queryUser=function(e,t){e&&(n.waitingExecCallbacks.push(t),n.emailUserMap[e]||n.waitingQueryEmails.includes(e)||(n.waitingQueryEmails.push(e),n.startQueryUsers()))},this.queryUsers=function(e,t){var r;if(Array.isArray(e)&&0!==e.length){var o=[];e.forEach((function(e){n.waitingExecCallbacks.push(t),n.emailUserMap[e]||n.waitingQueryEmails.includes(e)||o.push(e)})),0!==o.length&&((r=n.waitingQueryEmails).push.apply(r,o),n.startQueryUsers())}},this.startQueryUsers=function(){n.pendingTimer||0===n.waitingQueryEmails.length||(n.pendingTimer=setTimeout((function(){n.api(n.waitingQueryEmails).then((function(e){e.data.user_list.forEach((function(e){n.emailUserMap[e.email]=e})),n.queryUserCallback()})).catch((function(){n.waitingQueryEmails.forEach((function(e){n.emailUserMap[e]={email:e,name:e,avatar_url:n.defaultAvatarUrl}})),n.queryUserCallback()})),clearTimeout(n.pendingTimer),n.pendingTimer=null}),1e3))},this.queryUserCallback=function(){n.waitingExecCallbacks.forEach((function(e){e(n.emailUserMap)})),n.waitingQueryEmails=[],n.waitingExecCallbacks=[]},this.api=o,this.defaultAvatarUrl="".concat(a,"/avatars/default.png"),this.waitingQueryEmails=[],this.waitingExecCallbacks=[],this.emailUserMap={}})),io=oo,ao=n(76805),so=n.n(ao),lo={DEFAULT:"default",TEXT:"text",CREATOR:"creator",CTIME:"ctime",LAST_MODIFIER:"last-modifier",MTIME:"mtime",FILE_NAME:"file-name",CHECKBOX:"checkbox",COLLABORATOR:"collaborator",DATE:"date",LONG_TEXT:"long-text",SINGLE_SELECT:"single-select",MULTIPLE_SELECT:"multiple-select",NUMBER:"number",GEOLOCATION:"geolocation"},co=(Or={},(0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)(Or,lo.CREATOR,"creator"),lo.LAST_MODIFIER,"creator"),lo.CTIME,"creation-time"),lo.MTIME,"creation-time"),lo.DEFAULT,"text"),lo.TEXT,"text"),lo.FILE_NAME,"text"),lo.CHECKBOX,"checkbox"),lo.COLLABORATOR,"collaborator"),lo.DATE,"date"),(0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)(Or,lo.LONG_TEXT,"long-text"),lo.SINGLE_SELECT,"single-select"),lo.MULTIPLE_SELECT,"multiple-select"),lo.NUMBER,"number"),lo.GEOLOCATION,"location")),uo=(Tr={},(0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)(Tr,lo.CREATOR,"Creator"),lo.LAST_MODIFIER,"Last modifier"),lo.CTIME,"CTime"),lo.MTIME,"Last modified time"),lo.DEFAULT,"Text"),lo.TEXT,"Text"),lo.FILE_NAME,"File name"),lo.CHECKBOX,"Checkbox"),lo.COLLABORATOR,"Collaborator"),lo.DATE,"Date"),(0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)(Tr,lo.LONG_TEXT,"Long text"),lo.SINGLE_SELECT,"Single select"),lo.MULTIPLE_SELECT,"Multiple select"),lo.NUMBER,"Number"),lo.GEOLOCATION,"Geolocation")),po=[lo.CTIME,lo.MTIME,lo.DATE],ho=(lo.NUMBER,[lo.CREATOR,lo.LAST_MODIFIER,lo.COLLABORATOR]),fo="YYYY-MM-DD",mo="YYYY-MM-DDTHH:mm:ss.SSSZ",go="year",vo="month",yo="day",xo="hours",Ao="minutes",Co="YYYY-MM-DD",bo="number",wo=(lo.CTIME,lo.MTIME,lo.CREATOR,lo.LAST_MODIFIER,(0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)({},lo.CTIME,!0),lo.MTIME,!0),lo.CREATOR,!0),lo.LAST_MODIFIER,!0)),So=(0,ro.default)((0,ro.default)({},lo.COLLABORATOR,!0),lo.MULTIPLE_SELECT,!0),Do=(Er={},(0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)(Er,lo.TEXT,!0),lo.CTIME,!0),lo.MTIME,!0),lo.CREATOR,!0),lo.LAST_MODIFIER,!0),lo.FILE_NAME,!0),lo.CHECKBOX,!0),lo.DATE,!0),lo.LONG_TEXT,!0),lo.SINGLE_SELECT,!0),(0,ro.default)(Er,lo.NUMBER,!0)),ko="_id",Mo="_ctime",jo="_mtime",Io="_creator",_o="_last_modifier",Po="_is_dir",No="_parent_dir",Oo="_file_ctime",To="_file_mtime",Eo="_file_creator",Ro="_file_modifier",Lo="_name",Fo="_file_type",Uo="_collaborators",Bo="_expire_time",Yo="_keywords",qo="_summary",Ho="_expired",Go="_status",zo="_location",Vo="_obj_id",Wo="_size",Ko="_suffix",Xo="_file_details",$o=[ko,Mo,jo,Io,_o,Po,No,Oo,To,Eo,Ro,Lo,Fo,Uo,Bo,Yo,qo,Ho,Go,zo,Vo,Wo,Ko,Xo],Zo=[Uo,Bo,Yo,Ho,Go],Jo=[],Qo=[Uo,Bo,Yo,qo,Ho,Go],ei=[ko,Mo,jo,Io,_o,Vo,Ko,Xo,zo,Po],ti=[Po],ni="today",ri="tomorrow",oi="yesterday",ii="one_week_ago",ai="one_week_from_now",si="one_month_ago",li="one_month_from_now",ci="number_of_days_ago",ui="number_of_days_from_now",di="exact_date",pi="the_past_week",hi="the_past_month",fi="the_past_year",mi="the_next_week",gi="the_next_month",vi="the_next_year",yi="the_next_numbers_of_days",xi="the_past_numbers_of_days",Ai="this_week",Ci="this_month",bi="this_year",wi=(Rr={},(0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)(Rr,ni,(0,h.AP)("Today")),ri,(0,h.AP)("Tomorrow")),oi,(0,h.AP)("Yesterday")),ii,(0,h.AP)("One week ago")),ai,(0,h.AP)("One week from now")),si,(0,h.AP)("One month ago")),li,(0,h.AP)("One month from now")),ci,(0,h.AP)("Number of days ago")),ui,(0,h.AP)("Number of days from now")),di,(0,h.AP)("Exact date")),(0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)(Rr,pi,(0,h.AP)("The past week")),hi,(0,h.AP)("The past month")),fi,(0,h.AP)("The past year")),mi,(0,h.AP)("The next week")),gi,(0,h.AP)("The next month")),vi,(0,h.AP)("The next year")),yi,(0,h.AP)("The next numbers of days")),xi,(0,h.AP)("The past numbers of days")),Ai,(0,h.AP)("This week")),Ci,(0,h.AP)("This month")),(0,ro.default)(Rr,bi,(0,h.AP)("This year"))),Si={CONTAINS:"contains",NOT_CONTAIN:"does_not_contain",IS:"is",IS_NOT:"is_not",EQUAL:"equal",NOT_EQUAL:"not_equal",LESS:"less",GREATER:"greater",LESS_OR_EQUAL:"less_or_equal",GREATER_OR_EQUAL:"greater_or_equal",EMPTY:"is_empty",NOT_EMPTY:"is_not_empty",IS_WITHIN:"is_within",IS_BEFORE:"is_before",IS_AFTER:"is_after",IS_ON_OR_BEFORE:"is_on_or_before",IS_ON_OR_AFTER:"is_on_or_after",HAS_ANY_OF:"has_any_of",HAS_ALL_OF:"has_all_of",HAS_NONE_OF:"has_none_of",IS_EXACTLY:"is_exactly",INCLUDE_ME:"include_me",IS_CURRENT_USER_ID:"is_current_user_ID",IS_ANY_OF:"is_any_of",IS_NONE_OF:"is_none_of"},Di=(Lr={},(0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)(Lr,Si.CONTAINS,(0,h.AP)("contains")),Si.NOT_CONTAIN,(0,h.AP)("does not contain")),Si.IS,(0,h.AP)("is")),Si.IS_NOT,(0,h.AP)("is not")),Si.EQUAL,"="),Si.NOT_EQUAL,"\u2260"),Si.LESS,"<"),Si.GREATER,">"),Si.LESS_OR_EQUAL,"\u2264"),Si.GREATER_OR_EQUAL,"\u2265"),(0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)(Lr,Si.EMPTY,(0,h.AP)("is empty")),Si.NOT_EMPTY,(0,h.AP)("is not empty")),Si.IS_WITHIN,(0,h.AP)("is within...")),Si.IS_BEFORE,(0,h.AP)("is before...")),Si.IS_AFTER,(0,h.AP)("is after...")),Si.IS_ON_OR_BEFORE,(0,h.AP)("is on or before...")),Si.IS_ON_OR_AFTER,(0,h.AP)("is on or after...")),Si.HAS_ANY_OF,(0,h.AP)("has any of...")),Si.HAS_ALL_OF,(0,h.AP)("has all of...")),Si.HAS_NONE_OF,(0,h.AP)("has none of...")),(0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)(Lr,Si.IS_EXACTLY,(0,h.AP)("is exactly...")),Si.IS_CURRENT_USER_ID,(0,h.AP)("is current user's ID")),Si.INCLUDE_ME,(0,h.AP)("include the current user")),Si.IS_ANY_OF,(0,h.AP)("is any of...")),Si.IS_NONE_OF,(0,h.AP)("is none of..."))),ki=[Si.CONTAINS,Si.NOT_CONTAIN,Si.IS,Si.IS_NOT,Si.EMPTY,Si.NOT_EMPTY,Si.IS_CURRENT_USER_ID],Mi=[Si.EQUAL,Si.NOT_EQUAL,Si.LESS,Si.GREATER,Si.LESS_OR_EQUAL,Si.GREATER_OR_EQUAL,Si.EMPTY,Si.NOT_EMPTY],ji=[Si.IS,Si.IS_WITHIN,Si.IS_BEFORE,Si.IS_AFTER,Si.IS_ON_OR_BEFORE,Si.IS_ON_OR_AFTER,Si.IS_NOT,Si.EMPTY,Si.NOT_EMPTY],Ii=[ni,ri,oi,ii,ai,si,li,ci,ui,di],_i=(Fr={},(0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)(Fr,lo.TEXT,{filterPredicateList:ki}),lo.NUMBER,{filterPredicateList:Mi}),lo.FILE_NAME,{filterPredicateList:ki}),lo.DATE,{filterPredicateList:ji,filterTermModifierList:Ii}),lo.SINGLE_SELECT,{filterPredicateList:[Si.IS,Si.IS_NOT,Si.IS_ANY_OF,Si.IS_NONE_OF,Si.EMPTY,Si.NOT_EMPTY]}),lo.MULTIPLE_SELECT,{filterPredicateList:[Si.HAS_ANY_OF,Si.HAS_ALL_OF,Si.HAS_NONE_OF,Si.IS_EXACTLY,Si.EMPTY,Si.NOT_EMPTY]}),lo.CTIME,{filterPredicateList:ji,filterTermModifierList:Ii}),lo.MTIME,{filterPredicateList:ji,filterTermModifierList:Ii}),lo.CREATOR,{filterPredicateList:[Si.CONTAINS,Si.NOT_CONTAIN,Si.INCLUDE_ME,Si.IS,Si.IS_NOT]}),lo.LAST_MODIFIER,{filterPredicateList:[Si.CONTAINS,Si.NOT_CONTAIN,Si.INCLUDE_ME,Si.IS,Si.IS_NOT]}),(0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)(Fr,lo.CHECKBOX,{filterPredicateList:[Si.IS]}),lo.URL,{filterPredicateList:[Si.CONTAINS,Si.NOT_CONTAIN,Si.IS,Si.IS_NOT,Si.EMPTY,Si.NOT_EMPTY]}),lo.COLLABORATOR,{filterPredicateList:[Si.HAS_ANY_OF,Si.HAS_ALL_OF,Si.HAS_NONE_OF,Si.IS_EXACTLY,Si.EMPTY,Si.NOT_EMPTY,Si.INCLUDE_ME]}),lo.LONG_TEXT,{filterPredicateList:[Si.EMPTY,Si.NOT_EMPTY]})),Pi=[di,ni,ri,oi,ii,ai,si,li,ci,ui],Ni=[pi,hi,fi,Ai,Ci,bi,mi,gi,vi,yi,xi],Oi="And",Ti="Or",Ei="incomplete filter",Ri="the column to filter does not exist",Li="the column to filter is not supported",Fi="unmatched filter predicate",Ui="unmatched filter modifier",Bi="invalid filter term",Yi="day",qi="week",Hi="month",Gi="quarter",zi="year",Vi=(0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)({},Yi,"By day"),qi,"By week"),Hi,"By month"),Gi,"By quarter"),zi,"By year"),Wi="province",Ki="city",Xi="district",$i="country",Zi=(0,ro.default)((0,ro.default)((0,ro.default)({},Wi,"By province"),Ki,"By city"),Xi,"By district"),Ji=[lo.TEXT,lo.DATE,lo.CTIME,lo.MTIME,lo.CHECKBOX,lo.SINGLE_SELECT,lo.MULTIPLE_SELECT,lo.COLLABORATOR,lo.CREATOR,lo.LAST_MODIFIER,lo.GEOLOCATION],Qi=[Yi,qi,Hi,Gi,zi],ea="default",ta="double",na=[{COLOR:"#FFFCB5",BORDER_COLOR:"#E8E79D",TEXT_COLOR:"#212529"},{COLOR:"#FFEAB6",BORDER_COLOR:"#ECD084",TEXT_COLOR:"#212529"},{COLOR:"#FFD9C8",BORDER_COLOR:"#EFBAA3",TEXT_COLOR:"#212529"},{COLOR:"#FFDDE5",BORDER_COLOR:"#EDC4C1",TEXT_COLOR:"#212529"},{COLOR:"#FFD4FF",BORDER_COLOR:"#E6B6E6",TEXT_COLOR:"#212529"},{COLOR:"#DAD7FF",BORDER_COLOR:"#C3BEEF",TEXT_COLOR:"#212529"},{COLOR:"#DDFFE6",BORDER_COLOR:"#BBEBCD",TEXT_COLOR:"#212529"},{COLOR:"#DEF7C4",BORDER_COLOR:"#C5EB9E",TEXT_COLOR:"#212529"},{COLOR:"#D8FAFF",BORDER_COLOR:"#B4E4E9",TEXT_COLOR:"#212529"},{COLOR:"#D7E8FF",BORDER_COLOR:"#BAD1E9",TEXT_COLOR:"#212529"},{COLOR:"#B7CEF9",BORDER_COLOR:"#96B2E1",TEXT_COLOR:"#212529"},{COLOR:"#E9E9E9",BORDER_COLOR:"#DADADA",TEXT_COLOR:"#212529"},{COLOR:"#FBD44A",BORDER_COLOR:"#E5C142",TEXT_COLOR:"#FFFFFF"},{COLOR:"#EAA775",BORDER_COLOR:"#D59361",TEXT_COLOR:"#FFFFFF"},{COLOR:"#F4667C",BORDER_COLOR:"#DC556A",TEXT_COLOR:"#FFFFFF"},{COLOR:"#DC82D2",BORDER_COLOR:"#D166C5",TEXT_COLOR:"#FFFFFF"},{COLOR:"#9860E5",BORDER_COLOR:"#844BD2",TEXT_COLOR:"#FFFFFF"},{COLOR:"#9F8CF1",BORDER_COLOR:"#8F75E2",TEXT_COLOR:"#FFFFFF"},{COLOR:"#59CB74",BORDER_COLOR:"#4EB867",TEXT_COLOR:"#FFFFFF"},{COLOR:"#ADDF84",BORDER_COLOR:"#9CCF72",TEXT_COLOR:"#FFFFFF"},{COLOR:"#89D2EA",BORDER_COLOR:"#7BC0D6",TEXT_COLOR:"#FFFFFF"},{COLOR:"#4ECCCB",BORDER_COLOR:"#45BAB9",TEXT_COLOR:"#FFFFFF"},{COLOR:"#46A1FD",BORDER_COLOR:"#3C8FE4",TEXT_COLOR:"#FFFFFF"},{COLOR:"#C2C2C2",BORDER_COLOR:"#ADADAD",TEXT_COLOR:"#FFFFFF"}],ra="up",oa="down",ia=[lo.FILE_NAME,lo.CTIME,lo.MTIME,lo.TEXT,lo.DATE,lo.SINGLE_SELECT,lo.MULTIPLE_SELECT,lo.COLLABORATOR,lo.CHECKBOX,lo.NUMBER],aa=[lo.TEXT],sa=[lo.NUMBER],la="ERROR",ca="DIV/0",ua="NAME",da="NULL",pa="VALUE",ha="GETTING_DATA",fa=(0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)({},la,"#ERROR!"),ca,"#DIV/0!"),ua,"#NAME?"),"N/A","#N/A"),da,"#NULL!"),"NUM","#NUM!"),"REF","#REF!"),pa,"#VALUE!"),ha,"#GETTING_DATA"),ma=(fa[la],fa[ca],fa[ua],fa["N/A"],fa[da],fa.NUM,fa.REF,fa[pa],fa[ha],n(75168)),ga=((0,ma.default)("mod+s"),(0,ma.default)("mod+z"),(0,ma.default)("mod+l"),(0,ma.default)("mod+f")),va=((0,ma.default)("mod+p"),(0,ma.default)("mod+g"),(0,ma.default)("mod+."),(0,ma.default)("mod+,"),(0,ma.default)("mod+/"),(0,ma.default)("mod+'"),(0,ma.default)("mod+;"),(0,ma.default)("mod+up"),(0,ma.default)("mod+down"),(0,ma.default)("mod+left"),(0,ma.default)("mod+right"),(0,ma.default)("mod+shift+z"),(0,ma.default)("mod+shift+g"),(0,ma.default)("mod+shift+."),(0,ma.default)("mod+shift+,"),(0,ma.default)("shift+enter"),(0,ma.default)("shift+mod+enter"),(0,ma.default)("opt+pageup"),(0,ma.default)("opt+pagedown"),(0,ma.default)("space")),ya=(0,ma.default)("enter"),xa=function(){return(0,o.A)((function e(t){(0,r.A)(this,e),this.baseName=t||"sf-metadata"}),[{key:"getStorage",value:function(){try{return JSON.parse(window.localStorage.getItem(this.baseName)||"{}")}catch(e){return""}}},{key:"setItem",value:function(e,t){var n=this.getStorage(),r=(0,Sr.A)((0,Sr.A)({},n),{},(0,ro.default)({},e,t));return window.localStorage.setItem(this.baseName,JSON.stringify(r))}},{key:"getItem",value:function(e){return this.getStorage()[e]}}])}(),Aa=xa,Ca=function(e){return void 0!==e&&(null!==e&&(""!==e&&("{}"!==JSON.stringify(e)&&"[]"!==JSON.stringify(e))))},ba=function(e,t){if(!e||!t)return null;var n=t.key,r=t.name;return $o.includes(n)?e[n]:e[r]},wa=n(4159),Sa=n.n(wa),Da=function(e,t){if(!e||"string"!==typeof e)return"";var n=Sa()(e);if(!n.isValid())return e;switch(t){case"D/M/YYYY":case"DD/MM/YYYY":var r=n.format("YYYY-MM-DD").split("-");return"".concat(r[2],"/").concat(r[1],"/").concat(r[0]);case"D/M/YYYY HH:mm":case"DD/MM/YYYY HH:mm":var o=n.format("YYYY-MM-DD HH:mm").split(" "),i=o[0].split("-");return"".concat(i[2],"/").concat(i[1],"/").concat(i[0]," ").concat(o[1]);case"M/D/YYYY":return n.format("M/D/YYYY");case"M/D/YYYY HH:mm":return n.format("M/D/YYYY HH:mm");case"YYYY-MM-DD":default:return n.format("YYYY-MM-DD");case"YYYY-MM-DD HH:mm":return n.format("YYYY-MM-DD HH:mm");case"YYYY-MM-DD HH:mm:ss":return n.format("YYYY-MM-DD HH:mm:ss");case"DD.MM.YYYY":return n.format("DD.MM.YYYY");case"DD.MM.YYYY HH:mm":return n.format("DD.MM.YYYY HH:mm")}},ka=function(e){var t=e.toString().split(/[eE]/),n=(t[0].split(".")[1]||"").length-+(t[1]||0);return n>0?n:0},Ma=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15;return+parseFloat(Number(e).toPrecision(t))},ja=function(e){if(-1===e.toString().indexOf("e"))return Number(e.toString().replace(".",""));var t=ka(e);return t>0?Ma(Number(e)*Math.pow(10,t)):Number(e)},Ia=function(e,t){var n=ja(e),r=ja(t),o=ka(e)+ka(t);return n*r/Math.pow(10,o)},_a=function(e,t){return e===t||Math.abs(e-t)<1e-5},Pa=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(0===t)return Math.round(e);var n=Math.pow(10,t),r=e*n;return t>0&&(r=Number.parseFloat(r.toFixed(1))),Math.round(r)/n},Na=["bytes","KB","MB","GB","TB","PB"],Oa={comma:",",dot:".",no:"",space:" "},Ta=function(e){return"string"!==typeof e?"":e.endsWith("0")?e.replace(/(?:\.0*|(\.\d+?)0+)$/,"$1"):e},Ea=function(e,t){var n=t.formats,r=t.isCurrency,o=void 0===r||r,i=n||{},a=i.decimal,s=void 0===a?"dot":a,l=i.thousands,c=void 0===l?"no":l,u=i.precision,d=void 0===u?2:u,p=i.enable_precision,h=void 0!==p&&p;if(String(e).includes("e")){if(e<1&&e>-1){var f=e.toFixed(h?d:8);return h||(f=Ta(f)),0===parseFloat(f)&&f.startsWith("-")?f.substring(1):f}return String(e)}var m=Oa[s],g=Oa[c],v=h?d:function(e){if(Number.isInteger(e))return 0;var t=String(e).split(".")[1],n=t?t.length:8;return n>8?8:n}(e),y=parseFloat(Pa(e,v).toFixed(v)),x=y<0,A=Math.trunc(y),C=String(Math.abs(function(e,t){var n=Math.pow(10,Math.max(ka(e),ka(t)));return(Ia(e,n)-Ia(t,n))/n}(y,A)).toFixed(v)).slice(1);h||(C=Ta(C)),o&&(h||(C=2===C.length?C=C.padEnd(3,"0"):(C.substring(0,3)||".").padEnd(3,"0"))),C=C.replace(/./,m);for(var b=[],w=0,S=(A=Math.abs(A).toString()).length-1;S>-1;S--)w+=1,b.unshift(A[S]),w%3||0===S||b.unshift(g);return"".concat(x?"-":"").concat(b.join("")).concat(C)},Ra=function(e,t){var n=Object.prototype.toString.call(e);if("[object Number]"!==n)return"[object String]"===n&&e.startsWith("#")?e:"";if(isNaN(e)||e===1/0||e===-1/0)return String(e);var r=(t||{}).format;switch(void 0===r?bo:r){case"number":return Ea(e,{formats:t,isCurrency:!1});case"percent":return"".concat(Ea(Number.parseFloat((100*e).toFixed(8)),{formats:t,isCurrency:!1}),"%");case"yuan":return"\uffe5".concat(Ea(e,{formats:t}));case"dollar":return"$".concat(Ea(e,{formats:t}));case"euro":return"\u20ac".concat(Ea(e,{formats:t}));case"custom_currency":return"after"===t.currency_symbol_position?"".concat(Ea(e,{formats:t})).concat(t.currency_symbol||""):"".concat(t.currency_symbol||"").concat(Ea(e,{formats:t}));case"byte":if(e<0)return"--";if(0===e)return e+" "+Na[0];var o=parseInt(Math.floor(Math.log(e)/Math.log(1e3)),10);return 0===o?e+" "+Na[o]:(e/Math.pow(1e3,o)).toFixed(1)+" "+Na[o];default:return String(e)}},La=function(e,t,n){if(!e)return"";var r=e.replace(/\u3002/g,".");switch(t){case"percent":return r.replace(/[^.-\d,%]/g,"");case"yuan":return r.replace(/[^.-\d\xa5\uffe5,]/g,"");case"dollar":return r.replace(/[^.-\d$,]/g,"");case"euro":return r.replace(/[^.-\d\u20ac,]/g,"");case"custom_currency":var o=new RegExp("[^.-\\d"+n+",]","g");return r.replace(o,"");default:return r.replace(/[^.-\d,]/g,"")}},Fa=function(e,t){if(!e&&0!==e)return null;if("number"===typeof e)return e;if("string"!==typeof e)return null;var n=parseFloat(e.replace(/[^.-\d]/g,""));return"percent"!==t||isNaN(n)?isNaN(n)?null:n:function(e,t){var n=ja(e),r=ja(t);return Ia(n/r,Ma(Math.pow(10,ka(t)-ka(e))))}(n,100)},Ua=function(e,t){var n=t||{},r=n.format,o=n.decimal,i=n.thousands,a=n.enable_precision,s=n.precision,l=e;if(o&&i&&"comma"===o&&(l="dot"===i?(l=(l=l.replace(/,/,"@")).replace(/\./g,",")).replace(/@/,"."):(l=l.replace(/\./g,"")).replace(/,/,".")),l=Fa(l,r),a&&l){var c="percent"===r?s+2:s;l=parseFloat(Pa(l,c).toFixed(c))}return l},Ba=function(e){return(e||0===e)&&"[object Number]"===Object.prototype.toString.call(e)},Ya=function(e,t){return Array.isArray(e)&&t?e.find((function(e){return e.key===t})):null},qa=function(e){return po.includes(function(e){return e.type}(e))},Ha=function(e){return e&&e.data&&Array.isArray(e.data.options)?e.data.options:[]},Ga=function(e){if(1===e.length)return String(Math.floor(Math.random()*Math.pow(10,6)));for(var t,n=!1;!n&&(t=String(Math.floor(Math.random()*Math.pow(10,6))),!(n=e.every((function(e){return e.id!==t})))););return t},za=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=Ga(e),o=n&&na.find((function(e){return e.COLOR===n}));return o||(o=function(e){var t=na.slice(12,24),n=Math.floor(Math.random()*t.length);if(!Array.isArray(e)||0===e.length)return t[n];var r=e.slice(-(t.length-1)),o=[],i={};for(t.forEach((function(e,t){i[e.COLOR]=t})),r.forEach((function(e){var t=i[e.color];o.push(t)}));-1!=o.indexOf(n);)n=Math.floor(Math.random()*t.length);return t[n]||t[0]}(e)),{id:r,name:t,color:o.COLOR,textColor:o.TEXT_COLOR}},Va=function(e,t){var n=e.find((function(e){return e.name===t}));return n||(za(e,t)||{})},Wa=function(e,t){return Array.isArray(e)&&t?e.find((function(e){return e.id===t||e.name===t})):null},Ka=function(e,t){if(!t||!Array.isArray(e))return"";var n=Wa(e,t);return n?n.name:""},Xa=function(e,t){if($o.includes(e.key))return t;if(!Array.isArray(t)||0===t.length)return[];var n=Ha(e);return Array.isArray(n)&&0!==n.length?t.map((function(e){return Ka(n,e)})).filter((function(e){return e})):[]},$a=function(e,t){if($o.includes(e.key))return t;if(!Array.isArray(t)||0===t.length)return[];var n=Ha(e);return Array.isArray(n)&&0!==n.length?t.map((function(e){var t=Wa(n,e);return t?t.id:null})).filter((function(e){return e})):[]},Za=function(e,t){if(!Array.isArray(e)||!Array.isArray(t))return[];var n={};return t.forEach((function(e){n[e.email]=e})),e.map((function(e){var t=n[e];return t&&t.name})).filter(Boolean)},Ja=function(e,t){var n=Za(t,e);return Array.isArray(n)&&0!==n.length?n.join(", "):""},Qa="number",es="string",ts="boolean",ns="array",rs=[Si.IS_ANY_OF,Si.IS_NONE_OF],os=[lo.TEXT,lo.FILE_NAME],is=[Si.EMPTY,Si.NOT_EMPTY],as=[ci,ui,yi,xi,di],ss=[ci,ui,yi,xi],ls=function(){return(0,o.A)((function e(){(0,r.A)(this,e)}),null,[{key:"validate",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=e.column_key,o=e.filter_predicate,i=e.filter_term_modifier,a=e.filter_term,s=this.validateColumn(r,t).error_message;if(s)return{error_message:s};var l=t.find((function(e){return e.key===r})),c=this.validatePredicate(o,l).error_message;if(c)return{error_message:c};if(this.isFilterOnlyWithPredicate(o,l))return{error_message:null};var u=this.validateModifier(i,o,l).error_message;if(u)return{error_message:u};if(this.isFilterOnlyWithModifier(i,l))return{error_message:null};if(n){var d=this.validateTerm(a,o,i,l).error_message;if(d)return{error_message:d}}return{error_message:null}}},{key:"validateColumn",value:function(e,t){if(!e)return{error_message:Ei};var n=t.find((function(t){return t.key===e}));return n?this.isValidColumnType(n)?{error_message:null}:{error_message:Li}:{error_message:Ri}}},{key:"validatePredicate",value:function(e,t){if(!e)return{error_message:Ei};var n=t.type;return _i[n].filterPredicateList.includes(e)?{error_message:null}:{error_message:Fi}}},{key:"validatePredicateWithArrayType",value:function(e,t){var n=t.data.array_type;return n===lo.CHECKBOX||n===lo.BOOL?this.validatePredicate(e,{type:lo.CHECKBOX}):!!is.includes(e)||(n===lo.SINGLE_SELECT||n===lo.DEPARTMENT_SINGLE_SELECT?this.validatePredicate(e,{type:lo.MULTIPLE_SELECT}):ho.includes(n)?this.validatePredicate(e,{type:lo.COLLABORATOR}):this.validatePredicate(e,{type:n}))}},{key:"isFilterOnlyWithPredicate",value:function(e,t){if(is.includes(e))return!0;var n=t.type,r=Si.IS_CURRENT_USER_ID,o=Si.INCLUDE_ME;return!(e!==r||!os.includes(n))||!(e!==o||!ho.includes(n))}},{key:"validateModifier",value:function(e,t,n){if(!qa(n))return{error_message:null};if(!e)return{error_message:Ei};if(t===Si.IS_WITHIN){if(Ni.includes(e))return{error_message:null}}else if(Pi.includes(e))return{error_message:null};return{error_message:Ui}}},{key:"isFilterOnlyWithModifier",value:function(e,t){return!!qa(t)&&!as.includes(e)}},{key:"validateTerm",value:function(e,t,n,r){return this.isTermMissing(e)?{error_message:Ei}:this.isValidTerm(e,t,n,r)?{error_message:null}:{error_message:Bi}}},{key:"isTermMissing",value:function(e){return!e&&0!==e&&!1!==e||Array.isArray(e)&&0===e.length}},{key:"isValidTerm",value:function(e,t,n,r){switch(r.type){case lo.TEXT:case lo.GEOLOCATION:case lo.FILE_NAME:return this.isValidTermType(e,es);case lo.NUMBER:return this.isValidTermType(e,Qa);case lo.CHECKBOX:case lo.BOOL:return this.isValidTermType(e,ts);case lo.COLLABORATOR:case lo.CREATOR:case lo.LAST_MODIFIER:return this.isValidTermType(e,ns);case lo.DATE:case lo.CTIME:case lo.MTIME:return ss.includes(n)?this.isValidTermType(e,Qa):this.isValidTermType(e,es);case lo.SINGLE_SELECT:var o=Ha(r);return rs.includes(t)?!!this.isValidTermType(e,ns)&&this.isValidSelectedOptions(e,o):!!this.isValidTermType(e,es)&&!!o.find((function(t){return e===t.id}));case lo.MULTIPLE_SELECT:if(!this.isValidTermType(e,ns))return!1;var i=Ha(r);return this.isValidSelectedOptions(e,i);default:return!1}}},{key:"isValidTermType",value:function(e,t){return t===ns?Array.isArray(e)&&e.length>0:t===lo.NUMBER?typeof e===t||!isNaN(Number(e)):typeof e===t}},{key:"isValidTermWithArrayType",value:function(e,t,n,r){var o=r.data,i=o.array_type,a=o.array_data;return i===lo.SINGLE_SELECT?this.isValidTerm(e,t,n,{type:lo.MULTIPLE_SELECT,data:a}):ho.includes(i)?this.isValidTerm(e,t,n,{type:lo.COLLABORATOR}):this.isValidTerm(e,t,n,{type:i,data:a})}},{key:"isValidColumnType",value:function(e){var t=e.type;return _i.hasOwnProperty(t)}},{key:"isValidSelectedOptions",value:function(e,t){var n=t.filter((function(t){return e.includes(t.id)}));return e.length===n.length}}])}(),cs=[1,1,1,2,2,2,3,3,3,4,4,4],us=/(\[[^[]*\])|([-:/.()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,ds=/\d\d?/,ps=/\d\d/,hs={mm:[ds,Ao],HH:[ds,xo],D:[ds,yo],DD:[ps,yo],M:[ds,vo],MM:[ps,vo],YYYY:[/\d{4}/,go]},fs=["YYYY","MM","M","DD","D"],ms=function(){return(0,o.A)((function e(){(0,r.A)(this,e)}),null,[{key:"format",value:function(e,t){var n=this.getValidDate(e);if(!n)return"";var r=t&&t.toUpperCase(),o=n.getFullYear(),i=n.getMonth()+1,a=n.getDate(),s=i<10?"0".concat(i):i,l=a<10?"0".concat(a):a;switch(r){case"YYYY-MM-DD HH:MM:SS":var c=n.getHours(),u=n.getMinutes(),d=n.getSeconds(),p=c<10?"0".concat(c):c,h=u<10?"0".concat(u):u,f=d<10?"0".concat(d):d;return"".concat(o,"-").concat(s,"-").concat(l," ").concat(p,":").concat(h,":").concat(f);case"YYYY-MM-DD HH:MM":var m=n.getHours(),g=n.getMinutes(),v=m<10?"0".concat(m):m,y=g<10?"0".concat(g):g;return"".concat(o,"-").concat(s,"-").concat(l," ").concat(v,":").concat(y);default:return"".concat(o,"-").concat(s,"-").concat(l)}}},{key:"getDateByGranularity",value:function(e,t){var n=this.getValidDate(e);if(!n)return"";var r=t&&t.toUpperCase(),o=n.getFullYear();switch(r){case"YEAR":return"".concat(o);case"QUARTER":var i=n.getMonth(),a=cs[i];return"".concat(o,"-Q").concat(a);case"MONTH":var s=n.getMonth()+1,l=s<10?"0".concat(s):s;return"".concat(o,"-").concat(l);case"WEEK":var c=n.getDay(),u=n.getDate()+(0===c?-6:1-c),d=new Date(o,n.getMonth(),u),p=d.getMonth()+1,h=d.getDate(),f=p<10?"0".concat(p):p,m=h<10?"0".concat(h):h;return"".concat(d.getFullYear(),"-").concat(f,"-").concat(m);case"DAY":var g=n.getMonth()+1,v=n.getDate(),y=g<10?"0".concat(g):g,x=v<10?"0".concat(v):v;return"".concat(o,"-").concat(y,"-").concat(x);default:return""}}},{key:"isValidDateObject",value:function(e){return e instanceof Date&&!isNaN(e.getTime())}},{key:"getValidDate",value:function(e){if(!e)return null;var t="string"===typeof e,n=e,r=e;return t&&(n.split(" ").length>1||n.includes("T")?r=new Date(e):(n="".concat(e," 00:00:00"),r=new Date(n))),this.isValidDateObject(r)?r:t?(r=new Date(n.replace(/-/g,"/")),this.isValidDateObject(r)?r:null):null}},{key:"parseDateWithFormat",value:function(e,t){if(e.includes("T")){var n=new Date(e);return this.isValidDateObject(n)?n:this.getValidDate(e)}try{var r=this.makeParser(t)(e),o=r.year,i=r.month,a=r.day,s=r.hours,l=r.minutes;if(!o)o=(new Date).getFullYear();var c=new Date("".concat(o,"-").concat(i,"-").concat(a," ").concat(s||"00",":").concat(l||"00"));return this.isValidDateObject(c)?c:this.getValidDate(e)}catch(u){return this.getValidDate(e)}}},{key:"makeParser",value:function(e){var t=(e||fo).match(us),n=t.length;return function(e){for(var r=e.split(" "),o=r[0]||"",i=r[1]||"",a={},s=0;s<n;s++){var l=t[s],c=hs[l];if(c){var u=c[0],d=c[1];if(d){var p=fs.includes(l),h=p?u.exec(o):u.exec(i);if(h){var f=h[0];a[d]=f,p?o=o.replace(f,""):i=i.replace(f,"")}}}}return a}}}])}(),gs=[ni,ri,oi,ii,ai,si,li,ci,ui,di],vs=function(e,t){return Array.isArray(e)&&Array.isArray(t)?e.filter((function(e){var n=ls.validate(e,t).error_message;return!n||n!==Ei})):[]},ys=function(e,t){var n=function(e,t){var n=new Date,r=n.getFullYear(),o=n.getMonth(),i=n.getDate(),a=[31,28,31,30,31,30,31,31,30,31,30,31];switch(a[1]=r%4!==0||r%100===0&&r%400!==0?28:29,e){case ni:return new Date(r,o,i,0,0,0);case ri:return new Date(r,o,i+1);case oi:return new Date(r,o,i-1);case ii:return new Date(r,o,i-7);case ai:return new Date(r,o,i+7);case si:var s=o-1,l=0===o?11:s,c=i>a[l]?a[l]:i;return new Date(r,s,c);case li:var u=o+1,d=11===o?0:u,p=i>a[d]?a[d]:i;return new Date(r,u,p);case ci:return new Date(r,o,i-Number(t));case ui:return new Date(r,o,i+Number(t));case di:return new Date(t);case pi:var h=0!==n.getDay()?n.getDay():7;return{startDate:new Date(r,o,i-h-6),endDate:new Date(r,o,i-h)};case Ai:var f=0!==n.getDay()?n.getDay():7;return{startDate:new Date(r,o,i-f+1),endDate:new Date(r,o,i-f+7)};case mi:var m=0!==n.getDay()?n.getDay():7;return{startDate:new Date(r,o,i-m+8),endDate:new Date(r,o,i-m+14)};case hi:var g=o-1;return{startDate:new Date(r,g,1),endDate:new Date(r,g,a[0===o?11:g])};case Ci:return{startDate:new Date(r,o,1),endDate:new Date(r,o,a[o])};case gi:var v=o+1;return{startDate:new Date(r,v,1),endDate:new Date(r,v,11===o?a[0]:a[v])};case fi:var y=r-1;return{startDate:new Date(y,0,1),endDate:new Date(y,11,31)};case bi:return{startDate:new Date(r,0,1),endDate:new Date(r,11,31)};case vi:var x=r+1;return{startDate:new Date(x,0,1),endDate:new Date(x,11,31)};case yi:return{startDate:new Date(r,o,i+1,0,0,0),endDate:new Date(r,o,i+Number(t))};case xi:return{startDate:new Date(r,o,i-Number(t)),endDate:new Date(r,o,i,0,0,0)};default:return{}}}(e,t);if(gs.includes(e))return ms.format(n);var r=n.startDate,o=n.endDate;return{startDate:r?ms.format(r):"",endDate:o?ms.format(o):""}},xs=function(e){return e.map((function(e){return function(e,t){var n=e.filter_term,r=e.filter_term_modifier,o=e;switch(t.type){case lo.CTIME:case lo.MTIME:case lo.DATE:o.other_date=ys(r,n)}return o}(e,e.column)}))},As=function(e,t,n){var r=n.username,o=n.userId,i=t.column,a=ba(e,i);switch(i.type){case lo.CTIME:case lo.MTIME:case lo.DATE:return function(e,t){var n=t.filter_predicate,r=t.filter_term_modifier,o=t.filter_term,i=t.other_date;switch(n){case Si.IS:return r===di&&!o||ms.format(e)===i;case Si.IS_WITHIN:if(r===di&&!o)return!0;if(!e)return!1;var a=i.startDate,s=i.endDate,l=ms.format(e);return l>=a&&l<=s;case Si.IS_BEFORE:return r===di&&!o||!(!e||!ms.getValidDate(e))&&ms.format(e)<i;case Si.IS_AFTER:return r===di&&!o||!(!e||!ms.getValidDate(e))&&ms.format(e)>i;case Si.IS_ON_OR_BEFORE:return r===di&&!o||!(!e||!ms.getValidDate(e))&&ms.format(e)<=i;case Si.IS_ON_OR_AFTER:return r===di&&!o||!(!e||!ms.getValidDate(e))&&ms.format(e)>=i;case Si.IS_NOT:return r===di&&!o||!(!e||!ms.getValidDate(e))&&ms.format(e)!==i;case Si.EMPTY:return!(e&&ms.getValidDate(e));case Si.NOT_EMPTY:return!(!e||!ms.getValidDate(e));default:return!1}}(a=ms.format(a,Co),t);case lo.FILE_NAME:case lo.TEXT:return function(e,t,n){var r=t.filter_predicate,o=t.filter_term;switch(r){case Si.CONTAINS:return!o||!!e&&e.toString().toLowerCase().indexOf(o.toLowerCase())>-1;case Si.NOT_CONTAIN:return!o||!e||e.toString().toLowerCase().indexOf(o.toLowerCase())<0;case Si.IS:return!o||e===o;case Si.IS_NOT:return!o||e!==o;case Si.EMPTY:return!e;case Si.NOT_EMPTY:return!!e;case Si.IS_CURRENT_USER_ID:return!!n&&e===n;default:return!1}}(a,t,o);case lo.LAST_MODIFIER:case lo.CREATOR:return function(e,t,n){var r=t.filter_predicate,o=t.filter_term;switch(r){case Si.CONTAINS:return!Array.isArray(o)||!!e&&o.findIndex((function(t){return t===e}))>-1;case Si.NOT_CONTAIN:return!Array.isArray(o)||!e||o.findIndex((function(t){return t===e}))<0;case Si.INCLUDE_ME:return e===n;case Si.IS:return!o||(Array.isArray(o)?e===o[0]:e===o);case Si.IS_NOT:return!o||(Array.isArray(o)?e!==o[0]:e!==o);default:return!1}}(a,t,r);case lo.CHECKBOX:return function(e,t){var n=t.filter_term||!1;return("string"===typeof e?"TRUE"===e.toLocaleUpperCase():e||!1)===n}(a,t);case lo.SINGLE_SELECT:return function(e,t){var n=t.filter_predicate,r=t.filter_term;switch(n){case Si.IS:return!r||e===r;case Si.IS_NOT:return!r||e!==r;case Si.IS_ANY_OF:return 0===r.length||r.includes(e);case Si.IS_NONE_OF:return 0===r.length||r.indexOf(e)<0;case Si.EMPTY:return!e;case Si.NOT_EMPTY:return!!e;default:return!1}}(a,t);case lo.MULTIPLE_SELECT:return function(e,t){var n=t.filter_predicate,r=t.filter_term;switch(n){case Si.HAS_ANY_OF:return 0===r.length||Array.isArray(e)&&e.some((function(e){return r.includes(e)}));case Si.HAS_ALL_OF:return 0===r.length||Array.isArray(e)&&r.every((function(t){return e.includes(t)}));case Si.HAS_NONE_OF:return 0===r.length||!Array.isArray(e)||0===e.length||r.every((function(t){return e.indexOf(t)<0}));case Si.IS_EXACTLY:if(0===r.length)return!0;if(!Array.isArray(e))return!1;var o=function(e){return(0,W.A)(new Set(e)).sort()};return o(e).toString()===o(r).toString();case Si.EMPTY:return!Array.isArray(e)||0===e.length;case Si.NOT_EMPTY:return Array.isArray(e)&&e.length>0;default:return!1}}(a,t);case lo.NUMBER:return function(e,t){var n=t.filter_predicate,r=t.filter_term;switch(n){case Si.EQUAL:return!r&&0!==r||!(!e&&0!==e)&&_a(r,e);case Si.NOT_EQUAL:return!r&&0!==r||!e&&0!==e||!_a(r,e);case Si.LESS:return!r&&0!==r||!(!e&&0!==e||_a(e,r))&&e<r;case Si.GREATER:return!r&&0!==r||!(!e&&0!==e||_a(e,r))&&e>r;case Si.LESS_OR_EQUAL:return!r&&0!==r||!(!e&&0!==e)&&(!!_a(e,r)||e<r);case Si.GREATER_OR_EQUAL:return!r&&0!==r||!(!e&&0!==e)&&(_a(e,r)||e>r);case Si.EMPTY:return 0!==e&&(!e||"number"!==typeof e);case Si.NOT_EMPTY:return 0===e||!(!e||"number"!==typeof e);default:return!1}}(a,t);case lo.COLLABORATOR:return function(e,t,n){var r=t.filter_predicate,o=t.filter_term;switch(r){case Si.HAS_ANY_OF:return!Array.isArray(o)||0===o.length||Array.isArray(e)&&o.some((function(t){return e.includes(t)}));case Si.HAS_ALL_OF:return!Array.isArray(o)||0===o.length||Array.isArray(e)&&o.every((function(t){return e.includes(t)}));case Si.HAS_NONE_OF:return!Array.isArray(o)||0===o.length||!Array.isArray(e)||0===e.length||o.every((function(t){return e.indexOf(t)<0}));case Si.IS_EXACTLY:if(!Array.isArray(o)||0===o.length)return!0;if(!Array.isArray(e)||0===e.length)return!1;var i=(0,W.A)(new Set(e));return i.length===o.length&&o.every((function(e){return i.includes(e)}));case Si.EMPTY:return!Array.isArray(e)||0===e.length;case Si.NOT_EMPTY:return Array.isArray(e)&&e.length>0;case Si.INCLUDE_ME:return Array.isArray(e)&&e.indexOf(n)>-1;default:return!1}}(a,t,r);default:return!1}},Cs=function(e,t,n,r){var o=r.username,i=r.userId,a=[],s=xs(t);return n.forEach((function(t){var n=t._id;(function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=r.username,i=void 0===o?"":o,a=r.userId;return t===Oi?n.every((function(t){return As(e,t,{username:i,userId:a})})):t===Ti&&n.some((function(t){return As(e,t,{username:i,userId:a})}))})(t,e,s,{username:o,userId:i})&&a.push(n)})),a},bs=function(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},i=o.username,a=void 0===i?null:i,s=o.userId,l=void 0===s?null:s,c=e.columns,u=[];try{u=function(e,t){if(!Array.isArray(e)||0===e.length)return[];var n=[];return e.forEach((function(e){var r=e.column_key,o=ls.validate(e,t).error_message;if(o){if(o!==Ei)throw new Error(o)}else{var i=t.find((function(e){return e.key===r})),a=(0,Sr.A)((0,Sr.A)({},e),{},{column:i});n.push(a)}})),n}(r,c)}catch(d){return{row_ids:[],error_message:d.message}}return{row_ids:0===u.length?t.map((function(e){return e._id})):Cs(n,u,t,{username:a,userId:l}),error_message:null}},ws=function(e,t){return Array.isArray(e)&&Array.isArray(t)?e.filter((function(e){return function(e,t){if(!e||!Array.isArray(t))return!1;var n=e.column_key,r=t.find((function(e){return e.key===n}));return!!r&&Ji.includes(r.type)}(e,t)})):[]},Ss=function(e,t,n){var r=!e,o=!t;return r&&o?0:r?1:o?-1:e>t?n===ra?1:-1:e<t?n===ra?-1:1:0},Ds=/\d+|\D+/g,ks=/\d/,Ms=function(e,t){if(!e&&!t)return 0;if(!e)return-1;if(!t)return 1;if("string"!==typeof e||"string"!==typeof t)return 0;for(var n,r,o=e.match(Ds),i=t.match(Ds),a=Math.min(o.length,i.length),s=0;s<a;s++){if(n=o[s],r=i[s],ks.test(n)&&ks.test(r)){if((n=parseInt(n))>(r=parseInt(r)))return 1;if(n<r)return-1}if(n!==r)return e.localeCompare(t)}return e.localeCompare(t)},js=function(e,t,n){var r=!e,o=!t;return r&&o?0:r?1:o?-1:t===e?0:n===ra?Ms(e,t):-1*Ms(e,t)},Is=function(e,t,n){var r=e?1:-1,o=t?1:-1;return r>o?n===ra?1:-1:r<o?n===ra?-1:1:0},_s=function(e,t,n){var r=Array.isArray(e)&&e.length?e.join(""):null,o=Array.isArray(t)&&t.length?t.join(""):null;return js(r,o,n)},Ps=function(e,t,n){var r=!e&&0!==e,o=!t&&0!==t;return r&&o?0:r?1:o?-1:e>t?n===ra?1:-1:e<t?n===ra?-1:1:0},Ns=function(e,t,n){var r=n.sort_type,o=n.option_id_index_map,i=o[e],a=o[t],s=!i&&0!==i,l=!a&&0!==a;return s&&l?0:s?1:l?-1:i>a?r===ra?1:-1:i<a?r===ra?-1:1:0},Os=function(e,t){var n=e&&t.find((function(t){return t.key===e.column_key}));return!!n&&ia.includes(n.type)},Ts=function(e,t){return Array.isArray(e)&&Array.isArray(t)?e.filter((function(e){return Os(e,t)})):[]},Es=function(e,t){var n=[];return e.forEach((function(e){var r=t[e];r>-1&&n.push(r)})),n.sort()},Rs=function(e,t,n){var r=n.sort_type,o=n.option_id_index_map,i=!e||0===e.length,a=!t||0===t.length;if(i&&a)return 0;if(i)return 1;if(a)return-1;var s=Es(e,o),l=Es(t,o),c=s.length,u=l.length;if(c===u&&(0===c||s.join("")===l.join("")))return 0;for(var d=Math.min(c,u),p=0;p<d;p++){if(s[p]>l[p])return r===ra?1:-1;if(s[p]<l[p])return r===ra?-1:1}return c>u?r===ra?1:-1:r===ra?-1:1},Ls=function(e,t){var n=t.column,r=t.count_type;switch(n.type){case lo.TEXT:case lo.LAST_MODIFIER:case lo.CREATOR:return e||null;case lo.DATE:case lo.CTIME:case lo.MTIME:return ms.getDateByGranularity(e,r)||null;case lo.NUMBER:return e||0===e?e:null;case lo.CHECKBOX:return!!e;case lo.SINGLE_SELECT:return e||null;case lo.MULTIPLE_SELECT:case lo.COLLABORATOR:return Array.isArray(e)?e:[];case lo.GEOLOCATION:return function(e,t){if(!e)return"";var n=e.province,r=e.city,o=e.district,i=e.country_region;switch(t){case Ki:return r||"";case Xi:return o||"";case $i:return i||"";default:return n||""}}(e,r);default:return null}},Fs=function(e,t){var n=null;return Do[t]?n="string"===typeof e?e:String(e):So[t]&&(n=(0,W.A)(e).sort().toString()),n},Us=function(e,t,n){var r=t[e];return r&&r.index>-1?r.index:(t[e]={},t[e].subgroups={},t[e].index=n,-1)},Bs=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=t[n],i=o.column,a=o.sort_type,s=i.type,l=i.data,c=a||ra,u={};if(s===lo.SINGLE_SELECT||s===lo.MULTIPLE_SELECT){var d=(l||{}).options;Array.isArray(d)&&d.forEach((function(e,t){u[e.id]=t}))}if(e.sort((function(e,t){var n=e.cell_value,o=t.cell_value;if(ia.includes(s)){var i;if(aa.includes(s))i=js(n,o,c);else if(po.includes(s))i=Ss(n,o,c);else if(sa.includes(s))i=Ps(n,o,c);else if(s===lo.CHECKBOX)i=Is(n,o,c);else if(s===lo.COLLABORATOR){var a=n,l=o;r&&(a=Za(a,r),l=Za(l,r)),i=_s(a,l,c)}else s===lo.SINGLE_SELECT?i=Ns(n,o,{sort_type:c,option_id_index_map:u}):s===lo.MULTIPLE_SELECT&&(i=Rs(n,o,{sort_type:c,option_id_index_map:u}));return i}var d=Ca(n),p=Ca(o);return d||p?d?p?0:-1:1:0})),Array.isArray(e[0].subgroups)&&e[0].subgroups.length>0){var p=n+1;e=e.map((function(e){var n=Bs(e.subgroups,t,p,r);return(0,Sr.A)((0,Sr.A)({},e),{},{subgroups:n})}))}return e},Ys=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(0===e.length)return[];if(e.length>1)return function(e,t,n){var r=e.length>3?e.slice(0,3):(0,W.A)(e),o=[],i={};return t.forEach((function(e){for(var t,n,a=e._id,s=0;s<r.length;s++){var l=r[s],c=l.column,u=l.column_key,d=c.type,p=ba(e,c),h=Ls(p,l),f=Fs(h,d),m={cell_value:h,original_cell_value:p,row_ids:null,column_key:u,subgroups:[],summaries:{}};if(0===s){var g=Us(f,i,o.length);n=i[f].subgroups,g<0?(o.push(m),t=o[o.length-1]):t=o[g]}else{var v=Us(f,n,t.subgroups.length);n=n[f].subgroups,v<0?(t.subgroups.push(m),t=t.subgroups[t.subgroups.length-1]):t=t.subgroups[v],s===r.length-1&&(t.row_ids?t.row_ids.push(a):t.row_ids=[a])}}})),o=Bs(o,r,0,n)}(e,t,n);var r=e[0],o=r.column_key,i=r.column,a=i.type,s=[],l={};return t.forEach((function(e){var t=ba(e,i),n=Ls(t,r),c=function(e,t,n){var r=t[e];return r>-1?r:(t[e]=n,-1)}(Fs(n,a),l,s.length);c>-1?s[c].row_ids.push(e._id):s.push({cell_value:n,original_cell_value:t,column_key:o,row_ids:[e._id],subgroups:null,summaries:{}})})),s=Bs(s,e,0,n)},qs=function(e,t,n,r){var o=r.collaborators;if(0===t.length)return[];if(0===n.length)return t;var i=[];try{i=function(e,t){var n=ws(e,t),r=[];return n.forEach((function(e){var n=e.column_key,o=e.count_type,i=t.find((function(e){return n===e.key})),a=i.type,s=(0,Sr.A)((0,Sr.A)({},e),{},{column:i});switch(a){case lo.DATE:case lo.CTIME:case lo.MTIME:s.count_type=o||Hi;break;case lo.GEOLOCATION:s.count_type=o||Wi}r.push(s)})),r}(n,e.columns)}catch(a){i=[]}return Ys(i,t,o)},Hs=function(e){return Array.isArray(e)&&"object"===typeof e[0]},Gs=function(e,t,n,r){var o=r.collaborators,i=e.columns;if(!Array.isArray(t)||0===t.length)return[];var a=t.slice(0),s=function(e,t){var n=Ts(e,t),r=[];return n.forEach((function(e){var n=e.column_key,o=t.find((function(e){return e.key===n})),i=(0,Sr.A)((0,Sr.A)({},e),{},{column:o});switch(o.type){case lo.SINGLE_SELECT:case lo.MULTIPLE_SELECT:var a=Ha(o),s={};a.forEach((function(e,t){s[e.id]=t})),i.option_id_index_map=s}r.push(i)})),r}(n,i);return function(e,t,n){var r=n.collaborators;e.sort((function(e,n){var o=0;return t.forEach((function(t){var i=t.sort_type,a=t.column,s=a.type,l=ba(e,a),c=ba(n,a);if(po.includes(s))o=o||Ss(l,c,i);else if(s===lo.SINGLE_SELECT)o=o||Ns(l,c,t);else if(sa.includes(s))o=o||Ps(l,c,i);else if(s===lo.MULTIPLE_SELECT)o=o||Rs(l,c,t);else if(s===lo.COLLABORATOR){var u=l,d=c;r&&(u=Za(l,r),d=Za(c,r)),o=o||_s(u,d,i)}else o=s===lo.CHECKBOX?o||Is(l,c,i):o||js(l,c,i)})),o}))}(a,s,{collaborators:o}),a.map((function(e){return e._id}))},zs=function(e,t){return e&&e.id_row_map&&t?e.id_row_map[t]:null},Vs=function(e,t){return e&&e.id_row_map&&Array.isArray(t)?t.map((function(t){return e.id_row_map[t]})).filter(Boolean):[]},Ws=function(e,t){return ws(e.groupbys,t).length>0},Ks=function(){var e=navigator.platform;return"Mac68K"===e||"MacPPC"===e||"Macintosh"===e||"MacIntel"===e},Xs=function(e){return e&&"[object Function]"==={}.toString.call(e)},$s=function(e){var t;for(t in e)return!1;return!0},Zs="update-table-rows",Js="local-table-changed",Qs="server-table-changed",el="table-error",tl="open-editor",nl="close-editor",rl="select_cell",ol="select_start",il="select_update",al="select_end",sl="select_none",ll="copy_cells",cl="paste_cells",ul="search-cells",dl="open-select",pl="select_column",hl="drag_enter",fl="collapse_all_groups",ml="expand_all_groups",gl="reload_data",vl="modify_filters",yl="modify_sorts",xl="modify_groupbys",Al="modify_hidden_columns",Cl="view_changed",bl="modify_column_order",wl="saving",Sl="saved",Dl="modify_gallery_columns",kl={FRAGMENT:"application/x-sf-metadata-fragment",HTML:"text/html",TEXT:"text/plain",FILES:"files",DTABLE_FRAGMENT:"sf-metadata-fragment"},Ml=80,jl=16,Il=48,_l=((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)({},lo.CREATOR,!0),lo.LAST_MODIFIER,!0),lo.CTIME,!0),lo.MTIME,!0),lo.FILE_NAME,!0),(0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)({},lo.TEXT,!0),lo.DATE,!0),lo.NUMBER,!0),lo.SINGLE_SELECT,!0),lo.COLLABORATOR,!0),lo.CHECKBOX,!0)),Pl=((0,ro.default)({},lo.TEXT,!0),"group_container"),Nl="row",Ol="btn_insert_row",Tl=[],El=[],Rl="#eaeaea",Ll="deleted_option",Fl=1e3,Ul=1e4,Bl="previewer",Yl=n(95754),ql=function(){var e=(0,s.useState)((function(){var e=localStorage.getItem("sliderValue");return null!==e?parseInt(e,10):0})),t=(0,F.A)(e,2),n=t[0],r=t[1];(0,s.useEffect)((function(){localStorage.setItem("sliderValue",n)}),[n]);var o=(0,s.useCallback)((function(e){var t=parseInt(e.target.value,10);r(t),window.sfMetadataContext.eventBus.dispatch(Dl,t)}),[]),i=(0,s.useCallback)((function(){var e=Math.min(n+1,2);r(e),window.sfMetadataContext.eventBus.dispatch(Dl,e)}),[n]),a=(0,s.useCallback)((function(){var e=Math.max(n-1,-2);r(e),window.sfMetadataContext.eventBus.dispatch(Dl,e)}),[n]);return(0,m.jsxs)("div",{className:"metadata-slider-container",children:[(0,m.jsx)(O.A,{className:"metadata-slider-icon-button",onClick:a,children:(0,m.jsx)(Yl.A,{symbol:"minus_sign",className:"metadata-slider-icon"})}),(0,m.jsx)(P.A,{type:"range",min:"-2",max:"2",step:"1",value:n,onChange:o,className:"metadata-slider"}),(0,m.jsx)(O.A,{className:"metadata-slider-icon-button",onClick:i,children:(0,m.jsx)(Yl.A,{symbol:"plus_sign",className:"metadata-slider-icon"})})]})},Hl=n(55097),Gl=n.n(Hl),zl=n(71791),Vl=n(42119),Wl=kl.FRAGMENT,Kl=kl.HTML,Xl=kl.TEXT;function $l(e,t){return e.types&&e.types.length?e.getData(t):t===Xl&&e.getData("Text")||null}function Zl(e){var t=(e?e.replace(/\r/g,""):"").split("\n"),n=t[0].split("\t").map((function(e,t){return{key:"col".concat(t),type:"text"}})),r=[];return t.forEach((function(e){var t={};e&&(e=e.split("\t")).forEach((function(e,n){t["col".concat(n)]=e})),r.push(t)})),{copiedRecords:r,copiedColumns:n}}var Jl=function(e){var t=e.dataTransfer||e.clipboardData,n=$l(t,Wl),r=$l(t,Kl),o=$l(t,Xl),i=function(e){var t;try{e.items&&e.items.length?t=Array.from(e.items).map((function(e){return"file"===e.kind?e.getAsFile():null})).filter((function(e){return e})):e.files&&e.files.length&&(t=Array.from(e.files))}catch(n){e.files&&e.files.length&&(t=Array.from(e.files))}return t}(t);if(n)return(0,ro.default)((0,ro.default)({},kl.DTABLE_FRAGMENT,JSON.parse(n)),"type",kl.DTABLE_FRAGMENT);if(r){var a=(new DOMParser).parseFromString(r,Kl).querySelector("table");return a?(0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)({},kl.DTABLE_FRAGMENT,function(e){var t=e.querySelectorAll("tr"),n=t[0].querySelectorAll("td"),r=[],o=[];return n.forEach((function(e,t){r.push({key:"col".concat(t),type:"text"})})),t.forEach((function(e){var t={};e.querySelectorAll("td").forEach((function(e,n){t["col".concat(n)]=e.innerText})),o.push(t)})),{copiedRecords:o,copiedColumns:r}}(a)),"html",r),"text",o),"type","html"):(0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)({},kl.DTABLE_FRAGMENT,Zl(o)),"html",r),"text",o),"type","html")}return i&&i.length?(0,ro.default)((0,ro.default)((0,ro.default)({},kl.DTABLE_FRAGMENT,Zl(o)),"files",i),"type","files"):o?(0,ro.default)((0,ro.default)((0,ro.default)({},kl.DTABLE_FRAGMENT,Zl(o)),"text",o),"type","text"):void 0},Ql=function(e){return e&&e.target&&e.target.getAttribute("class")||""},ec="undefined"!==typeof window&&(window.innerWidth<768||null!=navigator.userAgent.toLowerCase().match(/(ipod|ipad|iphone|android|coolpad|mmp|smartphone|midp|wap|xoom|symbian|j2me|blackberry|wince)/i)),tc=function(e,t){return e.split(" ").indexOf(t)>-1?e:e+" "+t},nc=function(e,t){var n=e.split(" "),r=n.indexOf(t);return r<0?e:(n.splice(r,1),n.join(" "))},rc=function(e){return"string"===typeof e?e.trim():""},oc=function(){return(0,o.A)((function e(){(0,r.A)(this,e)}),null,[{key:"getDataType",value:function(e){var t=typeof e;return"object"!==t?t:Object.prototype.toString.call(e).replace(/^\[object (\S+)\]$/,"$1")}},{key:"iterable",value:function(e){return["Object","Array"].includes(this.getDataType(e))}},{key:"isObjectChanged",value:function(e,t){var n=this;if(!this.iterable(e))throw new Error("source should be a Object or Array , but got ".concat(this.getDataType(e)));if(this.getDataType(e)!==this.getDataType(t))return!0;var r=Object.keys(e),o=Object.keys((0,Sr.A)((0,Sr.A)({},e),t));return r.length!==o.length||o.some((function(r){return n.iterable(e[r])?n.isObjectChanged(e[r],t[r]):e[r]!==t[r]}))}},{key:"isSameObject",value:function(e,t){return!e&&!t||!(!e||!t)&&!this.isObjectChanged(e,t)}}])}(),ic=oc,ac="COLUMN_NAME",sc="COLUMN_TYPE",lc="CUSTOM_REGULAR",cc="CUSTOM_CURRENCY",uc=(0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)({},ac,(function(e){var t=e.columnName,n=e.oldColumn,r=e.metadata,o=e.gettext;return t?t.includes(".")?{type:ac,tips:o("Name cannot contain dots")}:t.includes("`")?{type:ac,tips:o("Name cannot contain backtick")}:t.includes("{")||t.includes("}")?{type:ac,tips:o("Name cannot contain curly braces")}:(!n||n&&n.name!==t)&&function(e,t){return Array.isArray(e)&&t?e.find((function(e){return e.name===t})):null}(r.columns,t)?{type:ac,tips:o("There is another property with this name")}:null:{type:ac,tips:o("This is required")}})),sc,(function(e){var t=e.column,n=e.metadata,r=e.gettext;return t.unique&&Ya(n.columns,t.key)?{type:sc,tips:r("Another property has this property type")}:null})),lo.TEXT,(function(e){var t=e.column,n=e.gettext,r=t.format_specification_value;return"custom_format"===t.format_check_type&&r&&!function(e){try{return!!new RegExp(e)}catch(t){return!1}}(r)?{type:lc,tips:n("Invalid regular expression")}:null})),lo.NUMBER,(function(e){var t=e.column,n=e.gettext,r=t.format,o=t.currency_symbol;return"custom_currency"!==r||o?null:{type:cc,tips:n("This is required")}})),dc=n(80045),pc=function(){return(0,o.A)((function e(){var t=this;(0,r.A)(this,e),this.getCollaborators=function(e){var n=t.server+"/api/v2.1/repos/"+e+"/related-users/";return t.req.get(n)},this.modifyRecord=function(e,n,r,o){var i=t.server+"/api/v2.1/repos/"+e+"/metadata/records/",a={records_data:[{record_id:n,record:r,obj_id:o}]};return t.req.put(i,a)},this.modifyRecords=function(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=t.server+"/api/v2.1/repos/"+e+"/metadata/records/",i={records_data:n};return r&&(i.is_copy_paste="true"),t.req.put(o,i)},this.listUserInfo=function(e){var n=t.server+"/api/v2.1/user-list/",r={user_id_list:e};return t._sendPostRequest(n,r,{headers:{"Content-type":"application/json"}})},this.listViews=function(e){var n=t.server+"/api/v2.1/repos/"+e+"/metadata/views/";return t.req.get(n)},this.getView=function(e,n){var r=t.server+"/api/v2.1/repos/"+e+"/metadata/views/"+n+"/";return t.req.get(r)},this.addView=function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"table",o=t.server+"/api/v2.1/repos/"+e+"/metadata/views/",i={name:n,type:r};return t._sendPostRequest(o,i,{headers:{"Content-type":"application/json"}})},this.duplicateView=function(e,n){var r=t.server+"/api/v2.1/repos/"+e+"/metadata/duplicate-view/",o={view_id:n};return t._sendPostRequest(r,o,{headers:{"Content-type":"application/json"}})},this.modifyView=function(e,n,r){var o=t.server+"/api/v2.1/repos/"+e+"/metadata/views/",i={view_id:n,view_data:r};return t.req.put(o,i)},this.deleteView=function(e,n){var r=t.server+"/api/v2.1/repos/"+e+"/metadata/views/",o={view_id:n};return t.req.delete(r,{data:o})},this.moveView=function(e,n,r){var o=t.server+"/api/v2.1/repos/"+e+"/metadata/move-views/",i={view_id:n,target_view_id:r};return t._sendPostRequest(o,i,{headers:{"Content-type":"application/json"}})},this.insertColumn=function(e,n,r,o){var i=o.key,a=o.data,s=t.server+"/api/v2.1/repos/"+e+"/metadata/columns/",l={column_name:n,column_type:r};return i&&(l.column_key=i),a&&(l.column_data=a),t.req.post(s,l)},this.deleteColumn=function(e,n){var r=t.server+"/api/v2.1/repos/"+e+"/metadata/columns/",o={column_key:n};return t.req.delete(r,{data:o})},this.renameColumn=function(e,n,r){var o=t.server+"/api/v2.1/repos/"+e+"/metadata/columns/",i={column_key:n,name:r};return t.req.put(o,i)},this.modifyColumnData=function(e,n,r){var o=t.server+"/api/v2.1/repos/"+e+"/metadata/columns/",i={column_key:n,data:r};return t.req.put(o,i)},this.generateSummary=function(e,n){var r=t.server+"/api/v2.1/repos/"+e+"/metadata/ai/summarize-documents/",o={file_paths_list:n};return t.req.post(r,o)}}),[{key:"init",value:function(e){var t=e.server,n=e.username,r=e.password,o=e.token;return this.server=t,this.username=n,this.password=r,this.token=o,this.token&&this.server&&(this.req=ht.A.create({baseURL:this.server,headers:{Authorization:"Token "+this.token}})),this}},{key:"initForSeahubUsage",value:function(e){var t=e.siteRoot,n=e.xcsrfHeaders;if(t&&"/"===t.charAt(t.length-1)){var r=t.substring(0,t.length-1);this.server=r}else this.server=t;return this.req=ht.A.create({headers:{"X-CSRFToken":n}}),this}},{key:"_sendPostRequest",value:function(e,t){return t.getHeaders?this.req.post(e,t,{headers:t.getHeaders()}):this.req.post(e,t)}},{key:"getMetadataStatus",value:function(e){var t=this.server+"/api/v2.1/repos/"+e+"/metadata/";return this.req.get(t)}},{key:"createMetadata",value:function(e){var t=this.server+"/api/v2.1/repos/"+e+"/metadata/";return this.req.put(t)}},{key:"deleteMetadata",value:function(e){var t=this.server+"/api/v2.1/repos/"+e+"/metadata/";return this.req.delete(t)}},{key:"getMetadata",value:function(e,t){var n=this.server+"/api/v2.1/repos/"+e+"/metadata/records/";return this.req.get(n,{params:t})}},{key:"getMetadataRecordInfo",value:function(e,t,n){var r=this.server+"/api/v2.1/repos/"+e+"/metadata/record/",o={};return t&&(o.parent_dir=t),n&&(o.name=n),this.req.get(r,{params:o})}}])}(),hc=new pc,fc=Ke.Ay.load("sfcsrftoken");hc.initForSeahubUsage({siteRoot:h.Yc,xcsrfHeaders:fc});var mc,gc=hc,vc=function(){return(0,o.A)((function e(){var t=this;(0,r.A)(this,e),this.destroy=function(){t.settings={},t.metadataAPI=null,t.localStorage=null,t.eventBus=null,t.hasInit=!1,t.permission="r"},this.getSetting=function(e){return!1===t.settings[e]?t.settings[e]:t.settings[e]||""},this.setSetting=function(e,n){t.settings[e]=n},this.getUsername=function(){return h.Xh},this.getCollaborators=function(){var e=t.settings.repoID;return t.metadataAPI.getCollaborators(e)},this.getMetadata=function(e){var n=t.settings.repoID;return t.metadataAPI.getMetadata(n,e)},this.getRecord=function(e,n){var r=t.settings.repoID;return t.metadataAPI.getMetadataRecordInfo(r,e,n)},this.getViews=function(){var e=t.settings.repoID;return t.metadataAPI.listViews(e)},this.getView=function(e){var n=t.settings.repoID;return t.metadataAPI.getView(n,e)},this.getPermission=function(){return t.permission},this.canModifyRow=function(e){return"r"!==t.permission},this.canModifyRows=function(){return"r"!==t.permission},this.canModifyColumn=function(e){return"r"!==t.permission&&(!!e.editable&&!($o.includes(e.key)&&!Zo.includes(e.key)))},this.canRenameColumn=function(e){return"r"!==t.permission&&!$o.includes(e.key)},this.canModifyColumnData=function(e){if("r"===t.permission)return!1;var n=e.key;return!$o.includes(n)||Jo.includes(n)},this.canDeleteColumn=function(e){if("r"===t.permission)return!1;var n=e.key;return!$o.includes(n)||Qo.includes(n)},this.canModifyColumnOrder=function(){return"r"!==t.permission},this.canModifyView=function(e){return"r"!==t.permission},this.restoreRows=function(){},this.updateRows=function(){},this.lockRowViaButton=function(){},this.updateRowViaButton=function(){},this.insertColumn=function(e,n,r,o){var i=o.key,a=o.data;return t.metadataAPI.insertColumn(e,n,r,{key:i,data:a})},this.deleteColumn=function(e,n){return t.metadataAPI.deleteColumn(e,n)},this.renameColumn=function(e,n,r){return t.metadataAPI.renameColumn(e,n,r)},this.modifyColumnData=function(e,n,r){return t.metadataAPI.modifyColumnData(e,n,r)},this.modifyRecord=function(e,n,r,o){return t.metadataAPI.modifyRecord(e,n,r,o)},this.modifyRecords=function(e,n,r){return t.metadataAPI.modifyRecords(e,n,r)},this.modifyView=function(e,n,r){return t.metadataAPI.modifyView(e,n,r)},this.getRowsByIds=function(){},this.generateSummary=function(e){var n=t.settings.repoID;return t.metadataAPI.generateSummary(n,e)},this.settings={},this.metadataAPI=null,this.localStorage=null,this.eventBus=null,this.hasInit=!1,this.permission="r",this.collaboratorsCache={}}),[{key:"init",value:function(){var e=(0,ln.A)((0,sn.A)().mark((function e(t){var n,r,o,i,a,s;return(0,sn.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.hasInit){e.next=2;break}return e.abrupt("return");case 2:this.settings=t||{},n=this.settings.repoInfo,this.metadataAPI=gc,r=this.settings,o=r.repoID,i=r.viewID,a=i?"sf-metadata-".concat(o,"-").concat(i):"sf-metadata-".concat(o),this.localStorage=new Aa(a),s=new x,this.eventBus=s,this.permission="admin"!==n.permission&&"rw"!==n.permission?"r":"rw",this.hasInit=!0;case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}])}(),yc=vc,xc=n(36220),Ac=n.n(xc),Cc={MODIFY_RECORD:"modify_record",MODIFY_RECORDS:"modify_records",RESTORE_RECORDS:"restore_records",RELOAD_RECORDS:"reload_records",MODIFY_FILTERS:"modify_filters",MODIFY_SORTS:"modify_sorts",MODIFY_GROUPBYS:"modify_groupbys",MODIFY_HIDDEN_COLUMNS:"modify_hidden_columns",LOCK_RECORD_VIA_BUTTON:"lock_record_via_button",MODIFY_RECORD_VIA_BUTTON:"modify_record_via_button",INSERT_COLUMN:"insert_column",DELETE_COLUMN:"delete_column",RENAME_COLUMN:"rename_column",MODIFY_COLUMN_DATA:"modify_column_data",MODIFY_COLUMN_WIDTH:"modify_column_width",MODIFY_COLUMN_ORDER:"modify_column_order"},bc=(mc={},(0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)(mc,Cc.MODIFY_RECORD,["repo_id","row_id","updates","old_row_data","original_updates","original_old_row_data"]),Cc.MODIFY_RECORDS,["repo_id","row_ids","id_row_updates","id_original_row_updates","id_old_row_data","id_original_old_row_data","is_copy_paste","id_obj_id"]),Cc.RESTORE_RECORDS,["repo_id","rows_data","original_rows","link_infos","upper_row_ids"]),Cc.RELOAD_RECORDS,["repo_id","row_ids"]),Cc.MODIFY_FILTERS,["repo_id","view_id","filter_conjunction","filters","basic_filters"]),Cc.MODIFY_SORTS,["repo_id","view_id","sorts"]),Cc.MODIFY_GROUPBYS,["repo_id","view_id","groupbys"]),Cc.MODIFY_HIDDEN_COLUMNS,["repo_id","view_id","hidden_columns"]),Cc.LOCK_RECORD_VIA_BUTTON,["repo_id","row_id","button_column_key"]),Cc.MODIFY_RECORD_VIA_BUTTON,["repo_id","row_id","updates","old_row_data","original_updates","original_old_row_data","button_column_key"]),(0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)(mc,Cc.INSERT_COLUMN,["repo_id","name","column_type","key","data"]),Cc.RENAME_COLUMN,["repo_id","column_key","new_name","old_name"]),Cc.MODIFY_COLUMN_DATA,["repo_id","column_key","new_data","old_data"]),Cc.DELETE_COLUMN,["repo_id","column_key","column"]),Cc.MODIFY_COLUMN_WIDTH,["column_key","new_width","old_width"]),Cc.MODIFY_COLUMN_ORDER,["repo_id","view_id","new_columns_keys","old_columns_keys"])),wc=[],Sc=[],Dc=[Cc.MODIFY_RECORD,Cc.MODIFY_RECORDS,Cc.MODIFY_FILTERS,Cc.MODIFY_SORTS,Cc.MODIFY_GROUPBYS,Cc.MODIFY_HIDDEN_COLUMNS,Cc.INSERT_COLUMN,Cc.DELETE_COLUMN,Cc.RENAME_COLUMN,Cc.MODIFY_COLUMN_DATA,Cc.MODIFY_COLUMN_WIDTH,Cc.MODIFY_COLUMN_ORDER],kc=[Cc.MODIFY_FILTERS,Cc.MODIFY_SORTS,Cc.MODIFY_GROUPBYS,Cc.MODIFY_HIDDEN_COLUMNS],Mc=[Cc.INSERT_COLUMN,Cc.DELETE_COLUMN,Cc.RENAME_COLUMN,Cc.MODIFY_COLUMN_DATA,Cc.MODIFY_COLUMN_WIDTH,Cc.MODIFY_COLUMN_ORDER],jc=["type","key"];function Ic(e,t){return Array.isArray(t)?t[e]:"undefined"!==typeof Immutable?t.get(e):null}var _c=function(e){return!!e&&!0===e.frozen};function Pc(e,t){return t[e.idx].editable}function Nc(e,t){var n=t[e.idx];return[lo.CHECKBOX].includes(null===n||void 0===n?void 0:n.type)}var Oc=function(e,t){var n=e,r=t,o=n.reduce((function(e,t){return e+=t.width}),0),i=Ml,a=n.filter((function(e){return _c(e)})),s=a.reduce((function(e,t){return e+t.width}),0);return{totalWidth:o,lastFrozenColumnKey:s>0?a[a.length-1].key:null,frozenColumnsWidth:s,columns:n.map((function(e,t){var n=e.width;return e.idx=t,e.left=i,e.width=n,i+=n,e})),allColumns:r}},Tc=function(e,t){switch(e){case Mo:case Oo:return(0,h.AP)("Created time");case jo:case To:return(0,h.AP)("Last modified time");case Io:case Eo:return(0,h.AP)("Creator");case _o:case Ro:return(0,h.AP)("Last modifier");case Po:return"";case No:return(0,h.AP)("Parent folder");case Lo:return(0,h.AP)("File name");case Fo:return(0,h.AP)("File type");case Uo:return(0,h.AP)("Collaborators");case Bo:return(0,h.AP)("File expire time");case Yo:return(0,h.AP)("Document keywords");case qo:return(0,h.AP)("Document summary");case Ho:return(0,h.AP)("Is expired");case Go:return(0,h.AP)("File status");case zo:return(0,h.AP)("Image location");case Wo:return(0,h.AP)("Size");case Xo:return(0,h.AP)("File details");default:return t}},Ec=function(e){var t=e.key,n=e.name;return $o.includes(t)?t:n},Rc=function(e,t){switch(e){case Mo:case Oo:return lo.CTIME;case jo:case To:return lo.MTIME;case Io:case Eo:return lo.CREATOR;case _o:case Ro:return lo.LAST_MODIFIER;case Lo:return lo.FILE_NAME;case Po:return lo.CHECKBOX;case Uo:return lo.COLLABORATOR;case Bo:return lo.DATE;case Yo:return lo.TEXT;case qo:return lo.LONG_TEXT;case Ho:return lo.CHECKBOX;case Go:return lo.SINGLE_SELECT;case zo:return lo.GEOLOCATION;default:return t}},Lc=function(e){var t=e.key,n=e.data;if($o.includes(t)){if(t===Fo)return function(e){var t=e.data,n={_picture:{name:(0,h.AP)("Picture"),color:"#FFFCB5",textColor:"#202428"},_document:{name:(0,h.AP)("Document"),color:"#B7CEF9",textColor:"#202428"},_video:{name:(0,h.AP)("Video"),color:"#9860E5",textColor:"#FFFFFF",borderColor:"#844BD2"},_audio:{name:(0,h.AP)("Audio"),color:"#FBD44A",textColor:"#FFFFFF",borderColor:"#E5C142"},_code:{name:(0,h.AP)("Code"),color:"#4ad8fb",textColor:"#FFFFFF",borderColor:"#4283e5"}},r=(0,Sr.A)({},t);return r.options=Array.isArray(t.options)?t.options.map((function(e){return(0,Sr.A)((0,Sr.A)({},e),n[e.id])})):[],r}(e);if(t===Go)return function(e){var t=e.data,n=(0,Sr.A)({},t),r={_in_progress:{name:(0,h.AP)("In progress"),color:"#EED5FF",textColor:"#202428"},_in_review:{name:(0,h.AP)("In review"),color:"#FFFDCF",textColor:"#202428"},_done:{name:(0,h.AP)("Done"),color:"#59CB74",textColor:"#FFFFFF",borderColor:"#844BD2"}};return n.options=Array.isArray(null===t||void 0===t?void 0:t.options)?t.options.map((function(e){return(0,Sr.A)((0,Sr.A)({},e),r[e.id])})):[],n}(e);if(t===Wo)return function(e){return(0,Sr.A)((0,Sr.A)({},e.data),{},{format:"byte"})}(e)}return e.type===lo.SINGLE_SELECT?(0,Sr.A)((0,Sr.A)({},n),{},{options:(null===n||void 0===n?void 0:n.options)||[]}):e.type===lo.DATE?(0,Sr.A)((0,Sr.A)({},n),{},{format:(null===n||void 0===n?void 0:n.format)||fo}):n},Fc=function(e){if(!Array.isArray(e)||0===e.length)return[];var t=window.sfMetadataContext.localStorage.getItem("columns_width")||{},n=e.map((function(e){var n=e.type,r=e.key,o=(0,dc.A)(e,jc),i=Rc(r,n);return(0,Sr.A)((0,Sr.A)({},o),{},{key:r,type:i,width:t[r]||200})})).filter((function(e){return!ei.includes(e.key)})),r=[];return n.forEach((function(e){if("_name"===e.key)r.unshift(e);else if(e.key===No){var t=r.findIndex((function(e){return e.key===No}));-1===t?r.unshift(e):r.splice(t,0,e)}else r.push(e)})),r};function Uc(e,t,n){return!!e&&(!1!==window.sfMetadataContext.canModifyColumn(e)&&(null!=e.editable&&"function"===typeof e.editable?!0===n&&e.editable(t):!0===n&&!!e.editable))}var Bc=(0,o.A)((function e(t){(0,r.A)(this,e),this.is_frozen=function(e){return e===Lo},this.enable_edit=function(e,t){return $o.includes(e)?Zo.includes(e):t!==lo.LONG_TEXT},this.key=t.key||"",this.name=Tc(this.key,t.name)||"",this.type=t.type||"",this.data=t.data||null,this.width=t.width||200,this.editable=this.enable_edit(this.key,this.type),this.data=Lc(this),this.frozen=this.is_frozen(this.key)||t.frozen||!1})),Yc=Bc,qc=(0,o.A)((function e(t,n){var o=this;(0,r.A)(this,e),this._id=t._id||"",this.type=t.type||"table",this.filters=t.filters||[],this.filter_conjunction=t.filter_conjunction||"Or",this.basic_filters=t.basic_filters&&t.basic_filters.length>0?t.basic_filters:[{column_key:Po,filter_predicate:Si.IS,filter_term:"all"}],this.sorts=t.sorts||[],this.groupbys=t.groupbys||[],this.groups=t.groups,this.hidden_columns=t.hidden_columns||[],this.rows=t.rows||[],this.available_columns=n||[],this.display_available_columns=this.available_columns.filter((function(e){return!ti.includes(e.key)})),this.columns=this.display_available_columns;var i=t.columns_keys||[];if(0===i.length)this.columns_keys=this.display_available_columns.map((function(e){return e.key}));else{var a=i.map((function(e){return Ya(o.display_available_columns,e)})).filter((function(e){return e}));this.display_available_columns.forEach((function(e){Ya(a,e.key)||a.push(e)})),this.columns_keys=a.map((function(e){return e.key})),this.columns=a}}));Sa().extend(Ac());var Hc,Gc=function(){function e(t){var n=this;(0,r.A)(this,e);var o=Gl()(t),i=o.type||o.op_type,a=bc[i];this.op_type=i,a.forEach((function(e){n[e]=o[e]})),this.success_callback=o.success_callback,this.fail_callback=o.fail_callback}return(0,o.A)(e,[{key:"clone",value:function(){return new e(this)}},{key:"apply",value:function(e){return function(e,t){switch(t.op_type){case Cc.MODIFY_RECORD:var n=t.row_id,r=t.original_updates,o=e.rows,i=o.findIndex((function(e){return n===e._id}));if(i<0)return e;var a=Sa()().utc().format(mo),s=window.sfMetadataContext.getUsername(),l=Object.assign({},o[i],r,{_mtime:a,_last_modifier:s});return e.rows[i]=l,e.id_row_map[n]=l,e;case Cc.MODIFY_RECORDS:var c=t.id_original_row_updates,u=t.id_row_updates,d=e.rows,p=Sa()().utc().format(mo),h=window.sfMetadataContext.getUsername(),f=(0,W.A)(d);return d.forEach((function(t,n){var r=t._id,o=c[r],i=u[r];if(i||o){var a=Object.assign({},t,i,o,{_mtime:p,_last_modifier:h});f[n]=a,e.id_row_map[r]=a}})),e.rows=f,e;case Cc.RESTORE_RECORDS:var m=t.original_rows,g=Sa()().utc().format(mo),v=window.sfMetadataContext.getUsername(),y=[];return m.forEach((function(t){var n=(0,Sr.A)((0,Sr.A)({},t),{},{_ctime:g,_mtime:g,_creator:v,_last_modifier:v});y.push(n),e.id_row_map[t._id]=n})),e.rows.push(y),e;case Cc.LOCK_RECORD_VIA_BUTTON:var x=t.row_id,A=e.rows,C=A.findIndex((function(e){return x===e._id}));if(C<0)return e;var b=(0,Sr.A)((0,Sr.A)({},A[C]),{},{_locked:!0});return e.rows[C]=b,e.id_row_map[x]=b,e;case Cc.MODIFY_RECORD_VIA_BUTTON:var w=t.row_id,S=t.original_updates,D=e.rows,k=D.findIndex((function(e){return w===e._id}));if(k<0)return e;var M=Sa()().utc().format(mo),j=window.sfMetadataContext.getUsername(),I=Object.assign({},D[k],S,{_mtime:M,_last_modifier:j});return e.rows[k]=I,e.id_row_map[w]=I,e;case Cc.MODIFY_FILTERS:var _=t.filter_conjunction,P=t.filters,N=t.basic_filters;return e.view.filter_conjunction=_,e.view.filters=P,e.view.basic_filters=N,e;case Cc.MODIFY_SORTS:var O=t.sorts;return e.view.sorts=O,e;case Cc.MODIFY_GROUPBYS:var T=t.groupbys;return e.view.groupbys=T,e;case Cc.MODIFY_HIDDEN_COLUMNS:var E=t.hidden_columns;return e.view.hidden_columns=E,e;case Cc.INSERT_COLUMN:var R=t.column,L=new Yc(R);return e.columns.push(L),e.view=new qc(e.view,e.columns),e;case Cc.DELETE_COLUMN:var F=t.column_key,U=e.columns.slice(0),B=U.findIndex((function(e){return e.key===F}));return-1!==B&&(U.splice(B,1),e.columns=U,e.view=new qc(e.view,e.columns)),e;case Cc.RENAME_COLUMN:var Y=t.column_key,q=t.new_name,H=e.columns.findIndex((function(e){return e.key===Y}));if(-1!==H){var G=new Yc((0,Sr.A)((0,Sr.A)({},e.columns[H]),{},{name:q}));e.columns[H]=G}return e.view=new qc(e.view,e.columns),e;case Cc.MODIFY_COLUMN_DATA:var z=t.column_key,V=t.new_data,K=e.columns.findIndex((function(e){return e.key===z}));if(-1!==K){var X=e.columns[K],$=new Yc((0,Sr.A)((0,Sr.A)({},X),{},{data:(0,Sr.A)((0,Sr.A)({},X.data),V)}));e.columns[K]=$}return e.view=new qc(e.view,e.columns),e;case Cc.MODIFY_COLUMN_WIDTH:var Z=t.column_key,J=t.new_width,Q=e.columns.findIndex((function(e){return e.key===Z}));if(-1!==Q){var ee=e.columns[Q],te=new Yc((0,Sr.A)((0,Sr.A)({},ee),{},{width:J}));e.columns[Q]=te}return e.view=new qc(e.view,e.columns),e;case Cc.MODIFY_COLUMN_ORDER:var ne=t.new_columns_keys;return e.view=new qc((0,Sr.A)((0,Sr.A)({},e.view),{},{columns_keys:ne}),e.columns),e;default:return e}}(e,this)}},{key:"invert",value:function(){return function(e){switch(e.clone().op_type){case Cc.MODIFY_RECORD:var t=e.page_id,n=e.row_id,r=e.updates,o=e.old_row_data,i=e.original_updates,a=e.original_old_row_data;return Vc({type:Cc.MODIFY_RECORD,page_id:t,row_id:n,updates:Gl()(o),old_row_data:Gl()(r),original_updates:Gl()(a),original_old_row_data:Gl()(i)});case Cc.MODIFY_RECORDS:var s=e.page_id,l=e.is_copy_paste,c=e.row_ids,u=e.id_row_updates,d=e.id_original_row_updates,p=e.id_old_row_data,h=e.id_original_old_row_data;return Vc({type:Cc.MODIFY_RECORDS,page_id:s,is_copy_paste:l,row_ids:Gl()(c),id_row_updates:Gl()(p),id_original_row_updates:Gl()(h),id_old_row_data:Gl()(u),id_original_old_row_data:Gl()(d)});case Cc.RESTORE_RECORDS:var f=e.page_id,m=e.rows_data,g=e.original_rows,v=e.link_infos,y=e.upper_row_ids,x=m.map((function(e){return e._id}));return Vc({type:Cc.DELETE_RECORDS,page_id:f,row_ids:x,deleted_rows:Gl()(m),original_deleted_rows:Gl()(g),deleted_link_infos:Gl()(v),upper_row_ids:Gl()(y)})}}(this)}},{key:"set",value:function(e,t){this[e]=t}}])}(),zc=Gc;function Vc(e){return new zc(e)}var Wc=function(){return(0,o.A)((function e(){(0,r.A)(this,e)}),null,[{key:"getFilteredRows",value:function(e,t,n,r){var o=Hs(t)?t:Vs(e,t);return bs(e,o,n,r,{username:h.Xh}).row_ids}},{key:"getSortedRows",value:function(e,t,n,r){var o=r.collaborators,i=Hs(t)?t:Vs(e,t);return Gs(e,i,n,{collaborators:o})}},{key:"getGroupedRows",value:function(e,t,n,r){var o=r.collaborators,i=Hs(t)?t:Vs(e,t);return qs(e,i,n,{collaborators:o})}},{key:"updateSummaries",value:function(e,t){}},{key:"hasRelatedGroupby",value:function(e,t){return e.some((function(e){return t[e.column_key]}))}},{key:"deleteGroupRows",value:function(e,t){var n=this;e.forEach((function(e){var r=e.subgroups,o=e.row_ids;Array.isArray(r)&&r.length>0?n.deleteGroupRows(r,t):o&&(e.row_ids=o.filter((function(e){return!t[e]})))}))}},{key:"run",value:function(e,t){var n=t.collaborators,r=e.rows,o=e.view.groupbys,i=e.view.available_columns||e.columns,a=Ws({groupbys:o},i);if(a){var s=r,l=a?this.getGroupedRows(e,s,o,{collaborators:n}):[],c=Hs(s)?s.map((function(e){return e._id})):s;e.view.rows=c,e.view.groups=l}else e.view.rows=e.rows.map((function(e){return e._id}))}},{key:"updateDataWithModifyRecords",value:function(e,t,n,r){var o=r.collaborators,i=e.view,a=i.available_columns,s=i.groupbys,l=i.rows;Ws({groupbys:s},a)&&this.hasRelatedGroupby(s,t)&&(e.view.groups=this.getGroupedRows(e,l,s,{collaborators:o}))}},{key:"handleReloadedRecords",value:function(e,t,n){var r=t.reduce((function(e,t){return e[t._id]=t,e}),{});e.rows.forEach((function(t,n){var o=t._id,i=r[o],a=Object.assign({},e.rows[n],i);i&&(e.rows[n]=a,e.id_row_map[o]=a)})),this.updateDataWithModifyRecords(),this.updateSummaries()}},{key:"handleNotExistRecords",value:function(e,t){var n=[],r=[];e.rows.forEach((function(o){var i=o._id;t[i]?(n.push(o),delete e.id_row_map[i]):r.push(o)})),e.rows=e.rows.filter((function(e){return!t[e._id]})),e.view.rows=e.rows.filter((function(e){return!t[e]})),this.updateSummaries()}},{key:"syncOperationOnData",value:function(e,t,n){var r=n.collaborators;switch(t.op_type){case Cc.MODIFY_RECORD:case Cc.MODIFY_RECORDS:var o=e.view.available_columns,i=t.id_original_row_updates,a=t.row_ids,s={},l=[];a.forEach((function(e){var t=i[e];t&&l.push.apply(l,(0,W.A)(Object.keys(t)))})),l.forEach((function(e){s[e]||Ya(o,e)&&(s[e]=!0)})),this.updateDataWithModifyRecords(e,s,a,{collaborators:r}),this.updateSummaries();break;case Cc.MODIFY_RECORD_VIA_BUTTON:var c=e.view.available_columns,u=t.original_updates,d={};for(var p in u){Ya(c,p)&&(d[p]=!0)}this.updateDataWithModifyRecords(),this.updateSummaries();break;case Cc.RESTORE_RECORDS:var h=t.rows_data,f=t.upper_row_ids,m=e.view.rows,g=h.map((function(e){return e._id})),v=(0,W.A)(m);Array.isArray(f)&&0!==f.length?f.forEach((function(e,t){var n=g[t],r=v.indexOf(e);r<0?v.push(n):v.splice(r+1,0,n)})):v.push.apply(v,(0,W.A)(g)),e.view.rows=v,this.updateDataWithModifyRecords(e,{collaborators:r}),this.updateSummaries();break;case Cc.MODIFY_GROUPBYS:var y=e.view,x=y.available_columns,A=y.groupbys,C=y.rows;if(!Ws({groupbys:A},x)){e.view.groups=[];break}e.view.groups=this.getGroupedRows(e,C,A,{collaborators:r})}}}])}();Hc=Wc,Wc.hasRelatedFilters=function(e,t){return e.some((function(e){return t[e.column_key]}))},Wc.hasRelatedSort=function(e,t){return e.some((function(e){return t[e.column_key]}))},Wc.deleteEmptyGroups=function(e){return e.filter((function(e){var t=e.subgroups,n=e.row_ids;return t&&t.length>0?0!==Hc.deleteEmptyGroups(t).length:!(!n||0===n.length)}))};var Kc=Wc,Xc=function(){return(0,o.A)((function e(){(0,r.A)(this,e),this.checkReloadRecordsOperation=function(e){return e.op_type===Cc.RELOAD_RECORDS}}),[{key:"applyOperation",value:function(e,t){switch(e.op_type){case Cc.MODIFY_RECORD:var n=e.repo_id,r=[{record_id:e.row_id,record:e.updates}];window.sfMetadataContext.modifyRecords(n,r).then((function(n){t({operation:e})})).catch((function(e){t({error:(0,h.AP)("Failed to modify record")})}));break;case Cc.MODIFY_RECORDS:var o=e.repo_id,i=e.row_ids,a=e.id_row_updates,s=e.is_copy_paste,l=e.id_obj_id,c=i.map((function(e){return{record_id:e,record:a[e],obj_id:l[e]}}));window.sfMetadataContext.modifyRecords(o,c,s).then((function(n){t({operation:e})})).catch((function(e){t({error:(0,h.AP)("Failed to modify records")})}));break;case Cc.RESTORE_RECORDS:var u=e.repo_id,d=e.rows_data;if(!Array.isArray(d)||0===d.length){t({error:(0,h.AP)("Failed to restore records")});break}window.sfMetadataContext.restoreRows(u,d).then((function(n){t({operation:e})})).catch((function(e){t({error:(0,h.AP)("Failed to restore records")})}));break;case Cc.RELOAD_RECORDS:t({operation:e});break;case Cc.INSERT_COLUMN:var p=e.repo_id,f=e.name,m=e.column_type,g=e.key,v=e.data;window.sfMetadataContext.insertColumn(p,f,m,{key:g,data:v}).then((function(n){e.column=n.data.column,t({operation:e})})).catch((function(e){t({error:(0,h.AP)("Failed to insert property")})}));break;case Cc.DELETE_COLUMN:var y=e.repo_id,x=e.column_key;window.sfMetadataContext.deleteColumn(y,x).then((function(n){t({operation:e})})).catch((function(e){t({error:(0,h.AP)("Failed to delete property")})}));break;case Cc.RENAME_COLUMN:var A=e.repo_id,C=e.column_key,b=e.new_name;window.sfMetadataContext.renameColumn(A,C,b).then((function(n){t({operation:e})})).catch((function(e){t({error:(0,h.AP)("Failed to rename property")})}));break;case Cc.MODIFY_COLUMN_DATA:var w=e.repo_id,S=e.column_key,D=e.new_data;window.sfMetadataContext.modifyColumnData(w,S,D).then((function(n){t({operation:e})})).catch((function(e){t({error:(0,h.AP)("Failed to modify property data")})}));break;case Cc.MODIFY_COLUMN_WIDTH:var k=e.column_key,M=e.new_width;try{var j=window.sfMetadataContext.localStorage.getItem("columns_width")||{};window.sfMetadataContext.localStorage.setItem("columns_width",(0,Sr.A)((0,Sr.A)({},j),{},(0,ro.default)({},k,M))),t({operation:e})}catch(V){t({error:(0,h.AP)("Failed to modify property width")})}break;case Cc.MODIFY_COLUMN_ORDER:var I=e.repo_id,_=e.view_id,P=e.new_columns_keys;window.sfMetadataContext.modifyView(I,_,{columns_keys:P}).then((function(n){t({operation:e})})).catch((function(e){t({error:(0,h.AP)("Failed to modify property order")})}));break;case Cc.MODIFY_FILTERS:var N=e.repo_id,O=e.view_id,T=e.filter_conjunction,E=e.filters,R=e.basic_filters;window.sfMetadataContext.modifyView(N,O,{filters:E,filter_conjunction:T,basic_filters:R}).then((function(n){t({operation:e})})).catch((function(e){t({error:(0,h.AP)("Failed to modify filter")})}));break;case Cc.MODIFY_SORTS:var L=e.repo_id,F=e.view_id,U=e.sorts;window.sfMetadataContext.modifyView(L,F,{sorts:U}).then((function(n){t({operation:e})})).catch((function(e){t({error:(0,h.AP)("Failed to modify sort")})}));break;case Cc.MODIFY_GROUPBYS:var B=e.repo_id,Y=e.view_id,q=e.groupbys;window.sfMetadataContext.modifyView(B,Y,{groupbys:q}).then((function(n){t({operation:e})})).catch((function(e){t({error:(0,h.AP)("Failed to modify group")})}));break;case Cc.MODIFY_HIDDEN_COLUMNS:var H=e.repo_id,G=e.view_id,z=e.hidden_columns;window.sfMetadataContext.modifyView(H,G,{hidden_columns:z}).then((function(n){t({operation:e})})).catch((function(e){t({error:(0,h.AP)("Failed to modify hidden properties")})}))}}},{key:"handleReloadRecords",value:function(e,t,n){var r=t.repo_id,o=this.getOperationRelatedColumns(e,t).relatedColumnKeyMap;if(this.checkReloadRecordsOperation(t)){var i=this.getOperatedRowsIds(t);this.asyncReloadRecords(i,r,o,n)}}},{key:"asyncReloadRecords",value:function(e,t,n,r){var o=this;if(Array.isArray(e)&&0!==e.length){var i=(0,W.A)(e),a=i.splice(0,100);window.sfMetadataContext.getRowsByIds(t,a).then((function(e){if(e&&e.data&&e.data.results){var s=e.data.results,l=[],c={},u={};s.length>0&&s.forEach((function(e){l.push(e),c[e._id]=!0})),a.forEach((function(e){c[e]||(u[e]=!0)})),r({reloadedRecords:l,idRecordNotExistMap:u,relatedColumnKeyMap:n}),o.asyncReloadRecords(i,t,n,r)}else o.asyncReloadRecords(i,t,n,r)})).catch((function(e){console.log(e),o.asyncReloadRecords(i,t,n,r)}))}}},{key:"getOperationRelatedColumns",value:function(e,t){var n;switch(t.op_type){case Cc.MODIFY_RECORDS:var r=t.id_original_row_updates;n=this.getRelatedColumnKeysFromRecordUpdates(r);break;case Cc.RELOAD_RECORDS:var o=e.view.available_columns,i={};return o.forEach((function(e){var t=e.key;i[t]=!0})),{relatedColumnKeyMap:i,relatedColumns:o};case Cc.MODIFY_RECORD_VIA_BUTTON:var a=t.row_id,s=t.original_updates;n=this.getRelatedColumnKeysFromRecordUpdates((0,ro.default)({},a,s));break;default:n=[]}return this.getRelatedColumns(n,e)}},{key:"getOperatedRowsIds",value:function(e){switch(e.op_type){case Cc.MODIFY_RECORDS:case Cc.RELOAD_RECORDS:var t=e.row_ids;return Array.isArray(t)?(0,W.A)(t):[];case Cc.MODIFY_RECORD_VIA_BUTTON:var n=e.row_id;return n?[n]:[];default:return[]}}},{key:"getRelatedColumns",value:function(e,t){if(!e||0===e.length)return{relatedColumnKeyMap:{},relatedColumns:[]};var n={},r=[],o=t.view.available_columns;return e.forEach((function(e){if(!n[e]){var t=Ya(o,e);t&&(n[e]=!0,r.push(t))}})),{relatedColumnKeyMap:n,relatedColumns:r}}},{key:"getRelatedColumnKeysFromRecordUpdates",value:function(e){return e?Object.keys(e).reduce((function(t,n){var r=e[n];return r&&t.push.apply(t,(0,W.A)(Object.keys(r))),t}),[]):[]}}])}(),$c=Xc,Zc=(0,o.A)((function e(t){var n=this;(0,r.A)(this,e);var o=t.columns||[];this.columns=o.map((function(e){return new Yc(e)})),this.rows=t.rows||[],this.id_row_map={},this.row_ids=[],this.rows.forEach((function(e){n.row_ids.push(e._id),n.id_row_map[e._id]=e})),this.hasMore=!0,this.recordsCount=this.row_ids.length,this.view=new qc(t.view||{},this.columns)})),Jc=Zc,Qc=function(){return(0,o.A)((function e(t){var n=this;(0,r.A)(this,e),this.destroy=function(){n.viewId="",n.data=null,n.startIndex=0,n.redos=[],n.undos=[],n.pendingOperations=[],n.isSendingOperation=!1},this.initStartIndex=function(){n.startIndex=0},this.sendOperationCallback=function(e,t){var r=t.operation,o=t.error;if(o)return r&&r.fail_callback&&r.fail_callback(),n.context.eventBus.dispatch(el,{error:o}),void n.sendNextOperation(e);Dc.includes(r.op_type)&&(n.handleUndoRedos(e,r),n.data=Gl()(r.apply(n.data)),n.syncOperationOnData(r)),(kc.includes(r.op_type)||Mc.includes(r.op_type))&&window.sfMetadataContext.eventBus.dispatch(Cl,n.data.view),r.success_callback&&r.success_callback(),n.context.eventBus.dispatch(Qs),n.serverOperator.handleReloadRecords(n.data,r,(function(e){var t=e.reloadedRecords,r=e.idRecordNotExistMap,o=e.relatedColumnKeyMap;t.length>0&&Kc.handleReloadedRecords(n.data,t,o),Object.keys(r).length>0&&Kc.handleNotExistRecords(n.data,r),n.context.eventBus.dispatch(Qs)})),n.sendNextOperation(e)},this.insertColumn=function(e,t,r){var o=r.key,i=r.data,a=Cc.INSERT_COLUMN,s=n.createOperation({type:a,repo_id:n.repoId,name:e,column_type:t,key:o,data:i});n.applyOperation(s)},this.deleteColumn=function(e,t){var r=Cc.DELETE_COLUMN,o=n.createOperation({type:r,repo_id:n.repoId,column_key:e});n.applyOperation(o)},this.renameColumn=function(e,t,r){var o=Cc.RENAME_COLUMN,i=n.createOperation({type:o,repo_id:n.repoId,column_key:e,new_name:t,old_name:r});n.applyOperation(i)},this.modifyColumnData=function(e,t,r){var o=Cc.MODIFY_COLUMN_DATA,i=n.createOperation({type:o,repo_id:n.repoId,column_key:e,new_data:t,old_data:r});n.applyOperation(i)},this.modifyColumnWidth=function(e,t){var r=Cc.MODIFY_COLUMN_WIDTH,o=Ya(n.data.columns,e),i=n.createOperation({type:r,repo_id:n.repoId,column_key:e,new_width:t,old_width:o.width});n.applyOperation(i)},this.modifyColumnOrder=function(e,t){var r=Cc.MODIFY_COLUMN_ORDER,o=n.data.view.columns_keys,i=o.indexOf(t),a=o.slice(0);(a=a.filter((function(t){return t!==e}))).splice(i,0,e);var s=n.createOperation({type:r,repo_id:n.repoId,view_id:n.viewId,new_columns_keys:a,old_columns_keys:o});n.applyOperation(s)},this.repoId=t.repoId,this.viewId=t.viewId,this.data=null,this.context=t.context,this.startIndex=0,this.redos=[],this.undos=[],this.pendingOperations=[],this.isSendingOperation=!1,this.isReadonly=!1,this.serverOperator=new $c,this.collaborators=t.collaborators||[]}),[{key:"loadMetadata",value:function(){var e=(0,ln.A)((0,sn.A)().mark((function e(t,n){var r,o,i,a,s,l,c;return(0,sn.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.context.getMetadata({view_id:this.viewId,start:this.startIndex,limit:n});case 2:i=e.sent,a=(null===i||void 0===i||null===(r=i.data)||void 0===r?void 0:r.results)||[],s=Fc(null===i||void 0===i||null===(o=i.data)||void 0===o?void 0:o.metadata),(l=new Jc({rows:a,columns:s,view:t})).view.rows=l.row_ids,c=a.length,l.hasMore=c===n,this.data=l,this.startIndex+=c,Kc.run(this.data,{collaborators:this.collaborators});case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=(0,ln.A)((0,sn.A)().mark((function e(){var t,n,r,o,i=arguments;return(0,sn.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>0&&void 0!==i[0]?i[0]:Fl,e.next=3,this.context.getView(this.viewId);case 3:return r=e.sent,o=(null===r||void 0===r||null===(t=r.data)||void 0===t?void 0:t.view)||{},e.next=7,this.loadMetadata(o,n);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"reload",value:function(){var e=(0,ln.A)((0,sn.A)().mark((function e(){var t,n=arguments;return(0,sn.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:Fl,this.startIndex=0,e.next=4,this.loadMetadata(this.data.view,t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadMore",value:function(){var e=(0,ln.A)((0,sn.A)().mark((function e(t){var n,r,o,i,a,s=this;return(0,sn.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.data){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.context.getMetadata({view_id:this.viewId,start:this.startIndex,limit:t});case 4:if(o=e.sent,i=(null===o||void 0===o||null===(n=o.data)||void 0===n?void 0:n.results)||[],Array.isArray(i)&&0!==i.length){e.next=9;break}return this.hasMore=!1,e.abrupt("return");case 9:(r=this.data.rows).push.apply(r,(0,W.A)(i)),i.forEach((function(e){s.data.row_ids.push(e._id),s.data.id_row_map[e._id]=e})),a=i.length,this.data.hasMore=a===t,this.data.recordsCount=this.data.row_ids.length,this.startIndex=this.startIndex+a,Kc.run(this.data,{collaborators:this.collaborators}),this.context.eventBus.dispatch(Js);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateRowData",value:function(){var e=(0,ln.A)((0,sn.A)().mark((function e(t){var n,r,o;return(0,sn.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.context.getRowsByIds(this.repoId,[t]);case 2:if((n=e.sent)&&n.data){e.next=5;break}return e.abrupt("return");case 5:r=n.data.results[0],o=this.data.rows.findIndex((function(e){return e._id===t})),this.data.id_row_map[t]=r,this.data.rows[o]=r,Kc.run(this.data,{collaborators:this.collaborators});case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createOperation",value:function(e){return new zc(e)}},{key:"applyOperation",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{handleUndo:!0},n=e.op_type;Dc.includes(n)||(this.handleUndoRedos(t,e),this.data=Gl()(e.apply(this.data)),this.syncOperationOnData(e),this.context.eventBus.dispatch(Js)),Sc.includes(n)||this.addPendingOperations(e,t)}},{key:"addPendingOperations",value:function(e,t){this.pendingOperations.push(e),this.startSendOperation(t)}},{key:"startSendOperation",value:function(e){this.isSendingOperation||0===this.pendingOperations.length||(this.isSendingOperation=!0,this.context.eventBus.dispatch(wl),this.sendNextOperation(e))}},{key:"sendNextOperation",value:function(e){if(0===this.pendingOperations.length)return this.isSendingOperation=!1,void this.context.eventBus.dispatch(Sl);var t=this.pendingOperations.shift();this.serverOperator.applyOperation(t,this.sendOperationCallback.bind(this,e))}},{key:"handleUndoRedos",value:function(e,t){var n=e.handleUndo,r=e.asyncUndoRedo;n&&(this.redos.length>0&&(this.redos=[]),this.undos.length>10&&(this.undos=this.undos.slice(-10)),wc.includes(t.op_type)&&this.undos.push(t)),r&&r(t)}},{key:"undoOperation",value:function(){var e=this;if(!this.isReadonly&&0!==this.undos.length){var t=this.undos.pop(),n=t.invert();Dc.includes(n.op_type)?this.applyOperation(n,{handleUndo:!1,asyncUndoRedo:function(n){n.op_type===Cc.INSERT_RECORD&&(t.row_id=n.row_data._id),e.redos.push(t)}}):(this.redos.push(t),this.applyOperation(n,{handleUndo:!1}))}}},{key:"redoOperation",value:function(){var e=this;if(!this.isReadonly&&0!==this.redos.length){var t=this.redos.pop();Dc.includes(t.op_type)?this.applyOperation(t,{handleUndo:!1,asyncUndoRedo:function(n){n.op_type===Cc.INSERT_RECORD&&(t=n),e.undos.push(t)}}):(this.undos.push(t),this.applyOperation(t,{handleUndo:!1}))}}},{key:"syncOperationOnData",value:function(e){Kc.syncOperationOnData(this.data,e,{collaborators:this.collaborators})}},{key:"modifyRecord",value:function(e,t,n,r,o){var i=zs(this.data,e);if(i&&this.context.canModifyRow(i)){var a=Cc.MODIFY_RECORD,s=this.createOperation({type:a,repo_id:this.repoId,row_id:e,updates:t,old_row_data:n,original_updates:r,original_old_row_data:o});this.applyOperation(s)}}},{key:"modifyRecords",value:function(e,t,n,r,o,i){var a=this,s=Vs(this.data,e),l=[],c={},u={},d={},p={},h={};s.forEach((function(e){if(e&&a.context.canModifyRow(e)){var i=e._id;l.push(i),c[i]=t[i],h[i]=e._obj_id,u[i]=n[i],d[i]=r[i],p[i]=o[i]}}));var f=Cc.MODIFY_RECORDS,m=this.createOperation({type:f,repo_id:this.repoId,row_ids:l,id_row_updates:c,id_original_row_updates:u,id_old_row_data:d,id_original_old_row_data:p,is_copy_paste:i,id_obj_id:h});this.applyOperation(m)}},{key:"reloadRecords",value:function(e){var t=Cc.RELOAD_RECORDS,n=this.createOperation({type:t,repo_id:this.repoId,row_ids:e});this.applyOperation(n)}},{key:"lockRecordViaButton",value:function(e,t,n){var r=n.success_callback,o=n.fail_callback,i=Cc.LOCK_RECORD_VIA_BUTTON,a=this.createOperation({type:i,repo_id:this.repoId,row_id:e,button_column_key:t,success_callback:r,fail_callback:o});this.applyOperation(a)}},{key:"modifyRecordViaButton",value:function(e,t,n,r,o,i,a){var s=a.success_callback,l=a.fail_callback;if(zs(this.data,e)){var c=Cc.MODIFY_RECORD_VIA_BUTTON,u=this.createOperation({type:c,repo_id:this.repoId,row_id:e,updates:t,old_row_data:n,original_updates:r,original_old_row_data:o,button_column_key:i,success_callback:s,fail_callback:l});this.applyOperation(u)}}},{key:"modifyFilters",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=Cc.MODIFY_FILTERS,i=this.createOperation({type:o,filter_conjunction:e,filters:t,basic_filters:r,repo_id:this.repoId,view_id:this.viewId,success_callback:function(){n.context.eventBus.dispatch(gl)}});this.applyOperation(i)}},{key:"modifySorts",value:function(e){var t=this,n=Cc.MODIFY_SORTS,r=this.createOperation({type:n,sorts:e,repo_id:this.repoId,view_id:this.viewId,success_callback:function(){t.context.eventBus.dispatch(gl)}});this.applyOperation(r)}},{key:"modifyGroupbys",value:function(e){var t=Cc.MODIFY_GROUPBYS,n=this.createOperation({type:t,groupbys:e,repo_id:this.repoId,view_id:this.viewId});this.applyOperation(n)}},{key:"modifyHiddenColumns",value:function(e){var t=Cc.MODIFY_HIDDEN_COLUMNS,n=this.createOperation({type:t,hidden_columns:e,repo_id:this.repoId,view_id:this.viewId});this.applyOperation(n)}}])}(),eu=Qc,tu=s.createContext(null),nu=function(e){var t=e.repoID,n=e.hideMetadataView,r=e.selectMetadataView,o=e.renameMetadataView,i=e.children,a=(0,s.useMemo)((function(){return window.app.pageOptions.enableMetadataManagement}),[window.app.pageOptions.enableMetadataManagement]),l=(0,s.useState)(!1),c=(0,F.A)(l,2),u=c[0],d=c[1],p=(0,s.useState)(!1),g=(0,F.A)(p,2),v=g[0],y=g[1],x=(0,s.useState)([]),A=(0,F.A)(x,2),C=A[0],b=A[1],w=(0,s.useRef)({}),S=(0,s.useCallback)((function(){var e=window.location,t=e.origin,n=e.pathname,r=e.search;if(new URLSearchParams(r).get("view")){var o="".concat(t).concat(n);window.history.pushState({url:o,path:""},"",o)}}),[]);(0,s.useEffect)((function(){a?gc.getMetadataStatus(t).then((function(e){var t=e.data.enabled;t||S(),d(t)})).catch((function(e){var t=f.Aq.getErrorMsg(e,!0);j.A.danger(t),d(!1)})):S()}),[t,a]);var D=(0,s.useCallback)((function(e){e!==u&&(e?y(!0):(n&&n(),S()),d(e))}),[u,n,S]);(0,s.useEffect)((function(){u?gc.listViews(t).then((function(e){var t=e.data,n=t.navigation,r=t.views;Array.isArray(r)&&r.forEach((function(e){w.current[e._id]=e})),b(n)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)})):(w.current={},b([]))}),[t,u]);var k=(0,s.useCallback)((function(e,n){if(!n){var o={children:[],path:"/"+R.AT.FILE_EXTENDED_PROPERTIES+"/"+e.name,isExpanded:!1,isLoaded:!0,isPreload:!0,object:{file_tags:[],id:R.AT.FILE_EXTENDED_PROPERTIES,name:(0,h.AP)("File extended properties"),type:R.AT.FILE_EXTENDED_PROPERTIES,isDir:function(){return!1}},parentNode:{},key:t,view_id:e._id};r(o)}}),[t,r]),M=(0,s.useCallback)((function(e,n,r,o){gc.addView(t,e,n).then((function(e){var t=e.data.view,n=C.slice(0);n.push({_id:t._id,type:"view"}),w.current[t._id]=t,b(n),k(t),r&&r()})).catch((function(e){o&&o(e)}))}),[C,t,w,k]),I=(0,s.useCallback)((function(e){gc.duplicateView(t,e).then((function(e){var t=e.data.view,n=C.slice(0);n.push({_id:t._id,type:"view"}),w.current[t._id]=t,b(n),k(t)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))}),[C,t,w,k]),_=(0,s.useCallback)((function(e,n){gc.deleteView(t,e).then((function(t){var r=C.filter((function(t){return t._id!==e}));if(delete w.current[e],b(r),n){var o=C.findIndex((function(t){return t._id===e})),i=C[o-1]._id,a=w.current[i];k(a)}})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))}),[t,C,k,w]),P=(0,s.useCallback)((function(e,n,r,i){gc.modifyView(t,e,n).then((function(t){var i=w.current[e];w.current[e]=(0,Sr.A)((0,Sr.A)({},i),n),Object.prototype.hasOwnProperty.call(n,"name")&&o(e,"/"+R.AT.FILE_EXTENDED_PROPERTIES+"/"+n.name),r&&r()})).catch((function(e){i&&i(e)}))}),[t,w,o]),N=(0,s.useCallback)((function(e,n){gc.moveView(t,e,n).then((function(e){var t=e.data.navigation;b(t)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))}),[t]);return(0,m.jsx)(tu.Provider,{value:{enableMetadata:u,updateEnableMetadata:D,showFirstView:v,setShowFirstView:y,navigation:C,viewsMap:w.current,selectView:k,addView:M,duplicateView:I,deleteView:_,updateView:P,moveView:N},children:i})},ru=function(){var e=(0,s.useContext)(tu);if(!e)throw new Error("'MetadataContext' is null");return e},ou=(0,o.A)((function e(t){(0,r.A)(this,e),this.avatar_url=t.avatar_url||"",this.contact_email=t.contact_email||"",this.email=t.email||"",this.name=t.name||"",this.name_pinyin=t.name_pinyin||"",this.id=t.id_in_org||""})),iu=s.createContext(null),au=function(e){var t=e.repoID,n=e.children,r=(0,s.useState)({}),o=(0,F.A)(r,2),i=o[0],a=o[1],l=(0,s.useState)([]),c=(0,F.A)(l,2),u=c[0],d=c[1],p=(0,s.useMemo)((function(){var e=new io({mediaUrl:h.SG,api:gc.listUserInfo}).queryUser;return window.queryUser=e,e}),[]);(0,s.useEffect)((function(){gc.getCollaborators(t).then((function(e){var t,n=Array.isArray(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.user_list)?e.data.user_list.map((function(e){return new ou(e)})):[];d(n)}))}),[t]),(0,s.useEffect)((function(){window.sfMetadata||(window.sfMetadata={},window.sfMetadata.getCollaboratorsFromCache=function(){return Object.values(window.sfMetadata.collaboratorsCache||{})||[]},window.sfMetadata.getCollaborators=function(){return[].concat((0,W.A)(window.sfMetadata.collaborators),(0,W.A)(Object.values(window.sfMetadata.collaboratorsCache||{})||[]))}),window.sfMetadata.collaborators=u,window.sfMetadata.collaboratorsCache=i}),[u,i]);var f=(0,s.useCallback)((function(e){var t=(0,Sr.A)((0,Sr.A)({},i),{},(0,ro.default)({},e.email,e));a(t)}),[i]),g=(0,s.useCallback)((function(e){var t=u&&u.find((function(t){return t.email===e}));if(t)return t;var n="".concat(h.SG,"/avatars/default.png");return"anonymous"===e||"seafevents"===e?t={email:e,name:e,avatar_url:n}:(t=i[e])||(function(e){return/^[A-Za-z0-9]+([-_.][A-Za-z0-9]+)*@([A-Za-z0-9]+[-.])+[A-Za-z0-9]{2,20}$/.test(e)}(e)?null:{email:e,name:e,avatar_url:n})}),[u,i]);return(0,m.jsx)(iu.Provider,{value:{collaborators:u,collaboratorsCache:i,updateCollaboratorsCache:f,getCollaborator:g,queryUser:p},children:n})},su=function(){var e=(0,s.useContext)(iu);if(!e)throw new Error("'CollaboratorsContext' is null");return{collaborators:e.collaborators,collaboratorsCache:e.collaboratorsCache,updateCollaboratorsCache:e.updateCollaboratorsCache,getCollaborator:e.getCollaborator,queryUser:e.queryUser}},lu=["children","repoID","viewID"],cu=s.createContext(null),uu=function(e){var t=e.children,n=e.repoID,r=e.viewID,o=(0,dc.A)(e,lu),i=(0,s.useState)(!0),a=(0,F.A)(i,2),l=a[0],c=a[1],u=(0,s.useState)({rows:[],columns:[]}),d=(0,F.A)(u,2),p=d[0],g=d[1],v=(0,s.useRef)(null),y=su().collaborators,x=ru(),A=x.showFirstView,C=x.setShowFirstView,b=(0,s.useCallback)((function(){g(v.current.data)}),[]),w=(0,s.useCallback)((function(e){j.A.danger(e.error)}),[]),S=(0,s.useCallback)((function(e){g(e)}),[]),D=(0,s.useCallback)((function(){c(!0),v.current.reload(Fl).then((function(){g(v.current.data),c(!1)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))}),[]),k=(0,s.useCallback)((function(e,t,n){window.sfMetadataStore.modifyFilters(t,e,n)}),[]),M=(0,s.useCallback)((function(e){window.sfMetadataStore.modifySorts(e)}),[]),I=(0,s.useCallback)((function(e){window.sfMetadataStore.modifyGroupbys(e)}),[]),_=(0,s.useCallback)((function(e){window.sfMetadataStore.modifyHiddenColumns(e)}),[]),P=(0,s.useCallback)((function(e,t){window.sfMetadataStore.modifyColumnOrder(e,t)}),[]);return(0,s.useEffect)((function(){c(!0);var e=new yc;window.sfMetadataContext=e,window.sfMetadataContext.init((0,Sr.A)((0,Sr.A)({},o),{},{repoID:n,viewID:r})),v.current=new eu({context:window.sfMetadataContext,repoId:n,viewId:r,collaborators:y}),window.sfMetadataStore=v.current,v.current.initStartIndex(),v.current.load(Fl).then((function(){A&&0===v.current.data.rows.length&&j.A.success((0,h.AP)("The files' metadata is being created. This may take a minute or so. Please refresh the page later.")),g(v.current.data),C(!1),c(!1)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}));var t=window.sfMetadataContext.eventBus,i=t.subscribe(Qs,b),a=t.subscribe(Js,b),s=t.subscribe(el,w),l=t.subscribe(Zs,S),u=t.subscribe(gl,D),d=t.subscribe(vl,k),p=t.subscribe(yl,M),m=t.subscribe(xl,I),x=t.subscribe(Al,_),N=t.subscribe(bl,P);return function(){window.sfMetadataContext.destroy(),window.sfMetadataStore.destroy(),i(),a(),s(),l(),u(),d(),p(),m(),x(),N()}}),[n,r]),(0,m.jsx)(cu.Provider,{value:{isLoading:l,metadata:p,store:v.current},children:t})},du=function(){var e=(0,s.useContext)(cu);if(!e)throw new Error("'MetadataContext' is null");return{isLoading:e.isLoading,metadata:e.metadata,store:e.store}},pu=n(15668),hu=(0,s.forwardRef)((function(e,t){var n=e.readOnly,r=e.value,o=(0,s.useState)(""),i=(0,F.A)(o,2),a=i[0],l=i[1],c=(0,s.useState)(r||""),u=(0,F.A)(c,2),d=u[0],p=u[1],f=(0,s.useCallback)((function(e){var t=e.target.value;d!==t&&p(t)}),[d]);return(0,s.useImperativeHandle)(t,(function(){return{getName:function(){return d},setError:function(e){return l(e)}}}),[d]),(0,s.useEffect)((function(){p(r)}),[r]),(0,m.jsxs)(wt.A,{className:D()("sf-metadata-column-settings-item",{"is-invalid":a}),children:[(0,m.jsx)(P.A,{placeholder:(0,h.AP)("Property name"),value:d,onChange:f,readOnly:n,autoFocus:!0}),a&&(0,m.jsx)(pu.A,{children:a})]})})),fu=450,mu=function(e){var t=e.column,n=e.columns,r=e.target,o=e.parentWidth,i=e.onChange,a=e.onToggle,l=(0,s.useRef)(null),c=(0,s.useRef)(null),u=(0,s.useMemo)((function(){if(r){var e=r.getBoundingClientRect(),t=e.top,n=e.left,i={width:fu,left:n+o,top:t,maxHeight:"calc(100% - ".concat(t,"px - 5px)")};return n+fu+o>document.body.offsetWidth&&(i.left=n-fu<=5?5:n-fu),i}}),[r,o]),d=(0,s.useState)(""),p=(0,F.A)(d,2),f=p[0],g=p[1],v=(0,s.useMemo)((function(){var e=f.trim().toLocaleLowerCase();return n.filter((function(t){return t.name.toLocaleLowerCase().indexOf(e)>-1}))}),[f,n]),y=(0,s.useCallback)((function(e){var t=e.target.value;t!==f&&g(t)}),[f]),x=(0,s.useCallback)((function(e){e.stopPropagation()}),[]),A=(0,s.useMemo)((function(){return v.filter((function(e){return"basics"===e.groupby}))}),[v]),C=(0,s.useMemo)((function(){return v.filter((function(e){return"predefined"===e.groupby}))}),[v]),b=(0,s.useCallback)((function(e,t){e&&e.stopPropagation(),e&&e.nativeEvent.stopImmediatePropagation(),i(t)}),[i]);(0,s.useEffect)((function(){setTimeout((function(){var e;null===l||void 0===l||null===(e=l.current)||void 0===e||e.focus()}),1)}),[]);var w=(0,s.useCallback)((function(e){c.current&&(-1!==Ql(e).indexOf("popover")||c.current.contains(e.target)||setTimeout((function(){return a()}),100))}),[c,a]);return(0,s.useEffect)((function(){return document.addEventListener("click",w),function(){document.removeEventListener("click",w)}}),[]),(0,m.jsx)(ne.A,{children:(0,m.jsxs)("div",{className:"sf-metadata-column-types-popover",style:u,ref:c,children:[(0,m.jsx)("div",{className:"search-column-container",children:(0,m.jsx)(P.A,{onChange:y,placeholder:(0,h.AP)("Search property types"),value:f,onClick:x,ref:l})}),v.length>0&&(0,m.jsx)("div",{className:"select-column-wrapper",children:(0,m.jsxs)("div",{className:"select-column-list",children:[C.length>0&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:"select-column-title",children:(0,h.AP)("Predefined properties")}),C.map((function(e){return(0,m.jsxs)("div",{className:D()("select-column-item text-truncate",{active:e.key===t.key}),onClick:function(t){return b(t,e)},children:[(0,m.jsx)(zl.In,{iconName:e.icon}),(0,m.jsx)("span",{children:e.name})]},e.key)}))]}),A.length>0&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:"select-column-title",children:(0,h.AP)("Custom properties")}),A.map((function(e){return(0,m.jsxs)("div",{className:D()("select-column-item text-truncate",{active:e.key===t.key}),onClick:function(t){return b(t,e)},children:[(0,m.jsx)(zl.In,{iconName:e.icon}),(0,m.jsx)("span",{children:e.name})]},e.key)}))]})]})})]})})},gu=[{icon:co[lo.COLLABORATOR],type:lo.COLLABORATOR,name:Tc(Uo),unique:!0,key:Uo,canChangeName:!1,groupby:"predefined"},{icon:co[lo.DATE],type:lo.DATE,name:Tc(Bo),unique:!0,key:Bo,canChangeName:!1,groupby:"predefined"},{icon:co[lo.TEXT],type:lo.TEXT,name:Tc(Yo),unique:!0,key:Yo,canChangeName:!1,groupby:"predefined"},{icon:co[lo.LONG_TEXT],type:lo.LONG_TEXT,name:Tc(qo),unique:!0,key:qo,canChangeName:!1,groupby:"predefined"},{icon:co[lo.CHECKBOX],type:lo.CHECKBOX,name:Tc(Ho),unique:!0,key:Ho,canChangeName:!1,groupby:"predefined"},{icon:co[lo.SINGLE_SELECT],type:lo.SINGLE_SELECT,name:Tc(Go),unique:!0,key:Go,canChangeName:!1,groupby:"predefined"},{icon:co[lo.TEXT],type:lo.TEXT,name:(0,h.AP)("Text"),canChangeName:!0,key:lo.TEXT,groupby:"basics"},{icon:co[lo.LONG_TEXT],type:lo.LONG_TEXT,name:(0,h.AP)("Long text"),canChangeName:!0,key:lo.LONG_TEXT,groupby:"basics"},{icon:co[lo.NUMBER],type:lo.NUMBER,name:(0,h.AP)("Number"),canChangeName:!0,key:lo.NUMBER,groupby:"basics"},{icon:co[lo.COLLABORATOR],type:lo.COLLABORATOR,name:(0,h.AP)("Collaborator"),canChangeName:!0,key:lo.COLLABORATOR,groupby:"basics"},{icon:co[lo.CHECKBOX],type:lo.CHECKBOX,name:(0,h.AP)("Checkbox"),canChangeName:!0,key:lo.CHECKBOX,groupby:"basics"},{icon:co[lo.DATE],type:lo.DATE,name:(0,h.AP)("Date"),canChangeName:!0,key:lo.DATE,groupby:"basics"},{icon:co[lo.SINGLE_SELECT],type:lo.SINGLE_SELECT,name:(0,h.AP)("Single select"),canChangeName:!0,key:lo.SINGLE_SELECT,groupby:"basics"},{icon:co[lo.MULTIPLE_SELECT],type:lo.MULTIPLE_SELECT,name:(0,h.AP)("Multiple select"),canChangeName:!0,key:lo.MULTIPLE_SELECT,groupby:"basics"}],vu=(0,s.forwardRef)((function(e,t){var n=e.parentWidth,r=e.column,o=e.onChange,i=(0,s.useState)(""),a=(0,F.A)(i,2),l=a[0],c=a[1],u=(0,s.useState)(!1),d=(0,F.A)(u,2),p=d[0],f=d[1],g=(0,s.useRef)(null),v=(0,s.useCallback)((function(e){e&&e.stopPropagation(),e&&e.nativeEvent.stopImmediatePropagation(),f(!p)}),[p]),y=(0,s.useCallback)((function(){f(!1)}),[]),x=(0,s.useCallback)((function(e){o(e)}),[o]);return(0,s.useImperativeHandle)(t,(function(){return{setError:function(e){return c(e)},getIsPopoverShow:function(){return p},setPopoverState:function(e){return f(e)}}}),[p]),(0,s.useEffect)((function(){o(gu[6])}),[]),(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(wt.A,{className:D()("sf-metadata-column-settings-item",{"is-invalid":l}),children:[(0,m.jsx)(St.A,{children:(0,h.AP)("Type")}),(0,m.jsxs)("div",{className:D()("sf-metadata-column-type",{"sf-metadata-column-type-focus":p}),ref:g,onClick:v,children:[(0,m.jsxs)("div",{className:"sf-metadata-column-type-info",children:[(0,m.jsx)(zl.In,{iconName:r.icon,className:"mr-2"}),(0,m.jsx)("span",{children:r.name})]}),(0,m.jsx)(zl.In,{iconName:"drop-down"})]}),l&&(0,m.jsx)(pu.A,{children:l})]}),p&&g.current&&(0,m.jsx)(mu,{columns:gu,column:r,target:g.current,parentWidth:n,onChange:x,onToggle:y})]})})),yu=n(99730),xu=function(e){var t=e.value,n=e.onChange,r=(t||{format:"YYYY-MM-DD"}).format,o=(0,s.useMemo)((function(){var e=new Date,t=e.getFullYear(),n=e.getMonth()+1,r=e.getDate(),o=e.getHours(),i=e.getMinutes();return n=n>9?n:"0".concat(n),r=r>9?r:"0".concat(r),o=o>9?o:"0".concat(o),i=i>9?i:"0".concat(i),"".concat(t,"-").concat(n,"-").concat(r," ").concat(o,":").concat(i)}),[]),i=(0,s.useMemo)((function(){return[{label:"".concat((0,h.AP)("ISO")," (").concat(Da(o,"YYYY-MM-DD"),")"),value:"YYYY-MM-DD"},{label:"".concat((0,h.AP)("US")," (").concat(Da(o,"M/D/YYYY"),")"),value:"M/D/YYYY"},{label:"".concat((0,h.AP)("European")," (").concat(Da(o,"DD/MM/YYYY"),")"),value:"DD/MM/YYYY"},{label:"".concat((0,h.AP)("Germany Russia etc")," (").concat(Da(o,"DD.MM.YYYY"),")"),value:"DD.MM.YYYY"}]}),[o]),a=(0,s.useCallback)((function(e){n((0,Sr.A)((0,Sr.A)({},t),{},{format:e}))}),[t,n]),l=(0,s.useCallback)((function(e){var t=r||"YYYY-MM-DD",o=r.split(" ");1===o.length&&(t=r+" HH:mm"),2===o.length&&(t=o[0]),n({format:t})}),[r,n]);(0,s.useEffect)((function(){r||n({format:"YYYY-MM-DD"})}),[]);var c=i.find((function(e){return e.value===r}))||i[0];return(0,m.jsxs)("div",{className:"sf-metadata-column-data-settings sf-metadata-date-column-data-settings",children:[(0,m.jsxs)(wt.A,{className:"",children:[(0,m.jsx)(St.A,{children:(0,h.AP)("Format")}),(0,m.jsx)(zl.Cg,{value:c,options:i,onSelectOption:a})]}),(0,m.jsx)("div",{className:"pb-4",children:(0,m.jsx)(yu.A,{checked:!!r&&r.indexOf("HH:mm")>-1,size:"large",textPosition:"right",className:"sf-metadata-date-column-data-minute w-100",onChange:l,placeholder:(0,h.AP)("Accurate to minute")})})]})},Au=(0,s.forwardRef)((function(e,t){var n=e.column,r=(0,s.useMemo)((function(){return n.type}),[n]),o=(0,s.useState)({}),i=(0,F.A)(o,2),a=i[0],l=i[1];(0,s.useImperativeHandle)(t,(function(){return{getValue:function(){return a},setValue:function(e){return l(e)}}}),[a]);var c=(0,s.useCallback)((function(e){l(e)}),[]);return r===lo.DATE?(0,m.jsx)(xu,{value:a,onChange:c}):null})),Cu=Au,bu={},wu=function(e){var t=e.target,n=e.onChange,r=(0,s.useState)({}),o=(0,F.A)(r,2),i=o[0],a=o[1],l=(0,s.useRef)(null),c=(0,s.useRef)(null),u=(0,s.useRef)(null),d=(0,s.useRef)(null),p=(0,s.useRef)(null),f=du().metadata,g=(0,s.useMemo)((function(){return bu[i.type]||350}),[i]),v=(0,s.useCallback)((function(e){var t;null!==(t=d.current)&&void 0!==t&&t.getIsPopoverShow()||l.current.toggle()}),[d]),y=(0,s.useCallback)((function(e){setTimeout((function(){d.current.setPopoverState(!1)}),100),ic.isSameObject(i,e)||(a(e),e.type!==i.type&&p.current.setValue({}))}),[d,i]),x=(0,s.useCallback)((function(){u.current.setError(""),d.current.setError("");var e=1,t=u.current.getName(),r=uc[ac]({columnName:t,metadata:f,gettext:h.AP});r&&(u.current.setError(r.tips),e=0);var o=uc[sc]({column:i,metadata:f,gettext:h.AP});if(o&&(d.current.setError(o.tips),e=0),0!=e){var a=p.current.getValue();0===Object.keys(a).length&&(a=null,i.unique?i.type===lo.SINGLE_SELECT&&i.key===Go&&(a={options:[{id:"_in_progress",name:"_in_progress"},{id:"_in_review",name:"_in_review"},{id:"_done",name:"_done"}]}):i.type===lo.SINGLE_SELECT||i.type===lo.MULTIPLE_SELECT?a={options:[]}:i.type===lo.DATE&&(a={format:fo})),n(i.unique?i.key:t,i.type,{key:i.unique?i.key:"",data:a}),v()}}),[u,i,f,n,v]);return(0,m.jsx)(Vl.A,{target:t,trigger:"legacy",placement:"bottom-end",hideArrow:!0,toggle:v,fade:!1,ref:l,className:"sf-metadata-column-popover",children:(0,m.jsxs)("div",{className:"sf-metadata-column-popover-inner",ref:c,style:{width:g},children:[(0,m.jsxs)("div",{children:[(0,m.jsx)(hu,{ref:u,readOnly:null===i||void 0===i?void 0:i.unique,value:null!==i&&void 0!==i&&i.unique?i.name:""}),(0,m.jsx)(vu,{ref:d,column:i,onChange:y,parentWidth:g}),(0,m.jsx)(Cu,{ref:p,column:i})]}),(0,m.jsxs)("div",{className:D()("sf-metadata-column-popover-footer",{"sf-metadata-number-column-popover-footer":i.type===lo.NUMBER}),children:[(0,m.jsx)(O.A,{color:"secondary",className:"mr-4",onClick:v,children:(0,h.AP)("Cancel")}),(0,m.jsx)(O.A,{color:"primary",onClick:x,children:(0,h.AP)("Submit")})]})]})})},Su=function(e){var t=e.value,n=e.target,r=e.onToggle,o=e.onSubmit,i=(0,s.useState)(t),a=(0,F.A)(i,2),l=a[0],c=a[1],u=(0,s.useRef)(null),d=du().metadata,p=(0,s.useCallback)((function(e){var t=e.target.value;t!==l&&c(t)}),[l]),f=(0,s.useCallback)((function(){if(l!==t){var e=uc[ac]({columnName:l,metadata:d,gettext:h.AP});e?j.A.danger(e.tips):o(l)}else r()}),[l,t,d,o,r]),g=(0,s.useCallback)((function(e){e.keyCode===R.cK.Enter&&(e.preventDefault(),f())}),[f]),v=(0,s.useCallback)((function(e){e.preventDefault()}),[]);return(0,s.useEffect)((function(){return u.current.focus(),document.addEventListener("keydown",g),function(){document.removeEventListener("keydown",g)}}),[g]),(0,m.jsx)(zl.Rw,{target:n,className:"sf-metadata-rename-column-popover",hide:f,hideWithEsc:r,children:(0,m.jsx)(Yr.A,{className:"p-4",children:(0,m.jsx)(P.A,{value:l,innerRef:u,onClick:v,onChange:p})})})},Du=function(e,t){var n=function(e){for(var t=na.slice(12,24),n=t[Math.floor(Math.random()*t.length)],r=e.slice(-11),o=function(e){return e.color===n.COLOR},i=r.find(o);i;)n=t[Math.floor(Math.random()*t.length)],i=r.find(o);return n}(e),r={name:t,color:n.COLOR,textColor:n.TEXT_COLOR,borderColor:n.BORDER_COLOR};return r.id=Ga(e),r},ku=n(89857),Mu=n(72784),ju=(0,ku.Tl)("sfMetadataSingleSelectOption",{},(function(e){return{connectDropTarget:e.dropTarget()}}))((function(e){var t=e.inputRef,n=e.options;return Array.isArray(n)&&0!==n.length?(0,m.jsx)("div",{className:"sf-metadata-select-options-list",ref:t,children:n}):null})),Iu=(0,Mu.A)(ju),_u=function(e){function t(){var e;(0,r.A)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=(0,i.A)(this,t,[].concat(o))).getValidOptions=function(t){var n,r=e.props.column,o=(null===r||void 0===r||null===(n=r.data)||void 0===n?void 0:n.options)||[],i=[],a={};o.forEach((function(e){return a[e.id]=!0}));for(var s=0;s<t.length;s++)t[s]&&"object"===typeof t[s]&&t[s].name&&t[s].color&&t[s].id&&!a[t[s].id]&&(i.push(t[s]),a[t[s].id]=!0);return i},e.onImportOptionsToggle=function(){e.importOptionsInput.click()},e.importOptionsInputChange=function(){if(e.importOptionsInput.files&&0!==e.importOptionsInput.files.length){var t=new FileReader;t.onload=e.handleImportOptions.bind(e),t.onerror=e.handleImportOptionsError.bind(e),t.readAsText(e.importOptionsInput.files[0])}else j.A.warning((0,h.AP)("Please select a file"))},e.handleImportOptions=function(t){var n,r=[];try{r=JSON.parse(t.target.result)}catch(s){return void j.A.danger((0,h.AP)("The imported options are invalid"))}if(Array.isArray(r)&&0!==r.length){var o=e.getValidOptions(r);if(0!==o.length){var i=e.props.column,a=(null===i||void 0===i||null===(n=i.data)||void 0===n?void 0:n.options)||[];o=[].concat((0,W.A)(a),(0,W.A)(o)),e.props.onImportOptions(o),e.importOptionsInput.value=null,j.A.success((0,h.AP)("Options imported"))}else j.A.warning((0,h.AP)("The imported option already exists"))}else j.A.danger((0,h.AP)("The imported options are invalid"))},e.handleImportOptionsError=function(){j.A.success((0,h.AP)("Failed imported options"))},e}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e,t=this,n=this.props,r=n.column,o=n.onToggle,i=(null===r||void 0===r||null===(e=r.data)||void 0===e?void 0:e.options)||[],a="data:text/json;charset=utf-8,".concat(encodeURIComponent(JSON.stringify(i)));return(0,m.jsxs)("div",{className:"option-editor-footer",children:[(0,m.jsx)("span",{"aria-hidden":"true",className:"sf3-font-help sf3-font option-editor-tips",id:"edit-option-tip"}),(0,m.jsx)(Qe.A,{delay:{show:0,hide:0},target:"edit-option-tip",placement:"bottom",children:(0,h.AP)("Use the import/export function to transfer options quickly. (The export is in JSON format.) By pasting cells, copied from a text column, an Excel or a TXT file, you can also add options quickly.")}),(0,m.jsx)("input",{type:"file",ref:function(e){return t.importOptionsInput=e},accept:".json",className:"d-none",onChange:this.importOptionsInputChange}),(0,m.jsx)("span",{className:"item-text",onClick:this.onImportOptionsToggle,children:(0,h.AP)("Import options")}),i&&i.length>0&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("span",{className:"mx-2",children:"|"}),(0,m.jsx)("a",{href:a,download:"".concat(r.name,"-options.json"),onClick:o,children:(0,m.jsx)("span",{className:"item-text",children:(0,h.AP)("Export options")})})]})]})}}])}(s.Component),Pu=function(e){var t=e.option,n=e.isViewing,r=e.onChange,o=(0,s.useMemo)((function(){return"option-color-".concat(t.id)}),[t]),i=(0,s.useState)(!1),a=(0,F.A)(i,2),l=a[0],c=a[1],u=(0,s.useCallback)((function(){c(!0)}),[]),d=(0,s.useCallback)((function(){c(!1)}),[]),p=(0,s.useCallback)((function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),c(!1);var n=e.target.value;if(n!==(null===t||void 0===t?void 0:t.color)){var o=na.find((function(e){return e.COLOR===n})),i=Object.assign({},t,{color:n,textColor:o.TEXT_COLOR,borderColor:o.BORDER_COLOR});r(i)}}),[t,r]);return(0,s.useEffect)((function(){n||c(!1)}),[n]),(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(zl.Oi,{className:"sf-metadata-edit-option-color",id:o,style:{backgroundColor:(null===t||void 0===t?void 0:t.color)||null},iconName:"drop-down",iconStyle:{fill:(null===t||void 0===t?void 0:t.textColor)||"#666"},onClick:u}),l&&(0,m.jsx)(zl.Rw,{target:o,className:"sf-metadata-edit-option-color-popover",hide:d,hideWithEsc:d,children:(0,m.jsx)("div",{className:"row gutters-xs",onClick:function(e){return e&&e.stopPropagation()},children:na.map((function(e,n){var r=e.COLOR,i=e.BORDER_COLOR,a=e.TEXT_COLOR,s=0===n&&!t||(null===t||void 0===t?void 0:t.color)===r;return(0,m.jsx)("div",{className:"col-auto",children:(0,m.jsxs)("label",{className:"color-select",children:[(0,m.jsx)("input",{name:"color",type:"radio",value:r,className:"sf-metadata-edit-option-color-item-input",defaultChecked:s,onClick:p}),(0,m.jsx)(zl.Oi,{className:D()("sf-metadata-edit-option-color-item-container",{selected:s}),id:o,style:{backgroundColor:r||null,borderColor:i},iconName:"check-mark",iconStyle:{fill:a||"#666"}})]})},e.COLOR)}))})})]})},Nu=function(e){var t=e.isEditing,n=e.option,r=e.onOpen,o=e.onClose,i=e.onToggleFreeze,a=e.onChange,l=(0,s.useState)((null===n||void 0===n?void 0:n.name)||""),c=(0,F.A)(l,2),u=c[0],d=c[1],p=(0,s.useRef)(null),h=(0,s.useCallback)((function(){var e=u.trim();if(e!==n.name&&""!==e){var t=Object.assign({},n,{name:e});a(t,(function(){i(!1),o()}),(function(){r(n.id)}))}}),[u,i,n,a,r,o]),f=(0,s.useCallback)((function(e){p.current&&!p.current.contains(e.target)&&t&&h()}),[t,h]),g=(0,s.useCallback)((function(e){var t=e.target.value;t!==u&&d(t)}),[u]),v=(0,s.useCallback)((function(e){e.keyCode===so().Enter&&(e.preventDefault(),h())}),[h]),y=(0,s.useCallback)((function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),r(n.id)}),[n,r]);return(0,s.useEffect)((function(){return document.addEventListener("mousedown",f),function(){document.addEventListener("mousedown",f)}}),[]),(0,m.jsx)("div",{ref:p,className:"sf-metadata-edit-option-name",style:{width:"calc(100% - 30px)"},children:t?(0,m.jsx)(P.A,{className:"sf-metadata-edit-option-name-input mx-2",type:"text",value:u,onChange:g,onKeyDown:v,onBlur:h,autoFocus:!0}):(0,m.jsx)("div",{className:"sf-metadata-edit-option-name-value text-truncate",onClick:y,title:u,children:u})})},Ou=(0,ku.Tl)("sfMetadataSingleSelectOption",{drop:function(e,t){var n=t.getItem(),r=e.index;if(r!==n.idx){var o={idx:r,data:e.option};e.onMove(n,o)}}},(function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver(),canDrop:t.canDrop(),dragged:t.getItem()}}))((0,ku.I4)("sfMetadataSingleSelectOption",{beginDrag:function(e){return{idx:e.index,data:e.option,mode:"sfMetadataSingleSelectOption"}},endDrag:function(e,t){var n=t.getItem();if(!t.didDrop())return{optionSource:n,optionTarget:{}}},isDragging:function(e,t){var n=e.index;return e.dragged.idx>n}},(function(e,t){return{connectDragSource:e.dragSource(),connectDragPreview:e.dragPreview(),isDragging:t.isDragging()}}))((function(e){var t=e.isOver,n=e.isDragging,r=e.canDrop,o=e.connectDragSource,i=e.connectDragPreview,a=e.connectDropTarget,l=e.isViewing,c=e.isDeleting,u=e.isEditing,d=e.option,p=e.onDelete,h=e.onUpdate,f=e.onMouseLeave,g=e.onMouseEnter,v=e.onToggleFreeze,y=e.onOpenNameEditor,x=e.onCloseNameEditor,A=(0,s.useCallback)((function(e){e.nativeEvent.stopImmediatePropagation(),p(d.id)}),[d,p]),C=(0,s.useCallback)((function(){g(d.id)}),[d,g]);return a(i((0,m.jsxs)("div",{className:D()("sf-metadata-edit-option-container",{"sf-metadata-edit-option-can-drop":t&&r&&!n,"sf-metadata-edit-deleting-option":c,"sf-metadata-edit-option-can-drop-top":t&&r&&n,"sf-metadata-edit-option-viewing":l,"sf-metadata-edit-option-editing":u}),onMouseEnter:function(){return C()},onMouseLeave:f,children:[o((0,m.jsx)("div",{className:"sf-metadata-edit-option-drag-container",children:(0,m.jsx)(zl.In,{iconName:"drag"})})),(0,m.jsxs)("div",{className:"sf-metadata-edit-option-content",children:[(0,m.jsx)(Pu,{option:d,onChange:h,isViewing:l}),(0,m.jsx)(Nu,{option:d,isEditing:u,onChange:h,onToggleFreeze:v,onOpen:y,onClose:x})]}),(0,m.jsx)("div",{id:"sf-metadata-edit-option-more-operation-".concat(d.id),className:"sf-metadata-edit-option-more-operations",children:(l||c)&&(0,m.jsx)(zl.Oi,{className:"sf-metadata-edit-option-operation-item",onClick:A,iconName:"delete"})})]})))}))),Tu=function(e){var t=e.option,n=e.onToggle,r=e.onSubmit,o=e.deleteNumber,i=(0,s.useState)(!1),a=(0,F.A)(i,2),l=a[0],c=a[1],u=(0,s.useCallback)((function(){n()}),[n]),d=(0,s.useCallback)((function(){c(!0),r()}),[r]);return(0,m.jsxs)(zl.Rw,{target:"sf-metadata-edit-option-more-operation-".concat(t.id),className:"sf-metadata-confirm-delete-option-popover",hide:u,hideWithEsc:u,children:[(0,m.jsxs)("div",{className:"sf-metadata-tip-default mt-2 mb-4",children:[(0,h.AP)("{name} rows use this option.").replace("{name}",o)," ",(0,h.AP)("Are you sure you want to delete this option?")]}),(0,m.jsxs)("div",{className:"d-flex justify-content-end",children:[(0,m.jsx)("button",{className:"btn btn-secondary mr-2",onClick:u,children:(0,h.AP)("Cancel")}),(0,m.jsx)("button",{className:"btn btn-primary",disabled:l,onClick:l?function(){}:d,children:l?(0,m.jsx)(zl.Rh,{}):(0,h.AP)("Delete")})]})]})},Eu=function(e){var t=e.target,n=e.column,r=e.onToggle,o=e.onSubmit,i=(0,s.useState)(Ha(n)),a=(0,F.A)(i,2),l=a[0],c=a[1],u=(0,s.useState)(""),d=(0,F.A)(u,2),p=d[0],f=d[1],g=(0,s.useState)(-1),v=(0,F.A)(g,2),y=v[0],x=v[1],A=(0,s.useState)(""),C=(0,F.A)(A,2),b=C[0],w=C[1],S=(0,s.useState)(-1),D=(0,F.A)(S,2),k=D[0],M=D[1],I=(0,s.useState)(0),_=(0,F.A)(I,2),P=_[0],N=_[1],O=(0,s.useRef)(!1),T=(0,s.useRef)(null),E=(0,s.useRef)(!0),R=du().metadata,L=(0,s.useMemo)((function(){var e=p.trim().toLowerCase();return e?l.filter((function(t){var n=t.name;return"string"===typeof n&&n.toLowerCase().includes(e)})):l||[]}),[l,p]),U=(0,s.useCallback)((function(e){o(e.filter((function(e){return e.name}))),c(e)}),[o]),B=(0,s.useCallback)((function(e,t,n){if(l.find((function(t){return t.name===e.name&&t.id!==e.id})))return j.A.danger((0,h.AP)("There is another option with this name")),n&&n(),void(E.current=!1);E.current=!0,t&&t();var r=l.slice(0),o=r.findIndex((function(t){return t.id===e.id}));r.splice(o,1,e),U(r)}),[l,U,E]),Y=(0,s.useCallback)((function(e,t){var n=e.idx,r=t.idx,o=t.data,i=L.splice(n,1)[0],a=l.slice(0).filter((function(e){return e.id!==i.id})),s=a.findIndex((function(e){return e.id===o.id}));r>n&&s++,a.splice(s,0,i),U(a)}),[l,L,U]),q=(0,s.useCallback)((function(){var e=(null===p||void 0===p?void 0:p.trim())||"",t=Du(l,e),n=l.slice(0);n.push(t),U(n),M(e?"":t.id)}),[p,l,U]),H=(0,s.useCallback)((function(e){var t,n=l.filter((function(t){return t.id!==e}));L[L.length-1].id===e&&x((null===(t=L[L.length-2])||void 0===t?void 0:t.id)||"");w(""),U(n)}),[L,l,U]),G=(0,s.useCallback)((function(e){O.current||y===e||x(e)}),[O,y]),z=(0,s.useCallback)((function(){O.current||x("")}),[]),V=(0,s.useCallback)((function(e){O.current=e}),[]),W=(0,s.useCallback)((function(e){E.current&&M(e)}),[E]),K=(0,s.useCallback)((function(){M("")}),[]),X=(0,s.useCallback)((function(e){p!==e&&f(e)}),[p]),$=(0,s.useCallback)((function(){w("")}),[]),Z=(0,s.useCallback)((function(){H(b)}),[b,H]),J=(0,s.useCallback)((function(e){o(e),c(e)}),[o]),Q=(0,s.useCallback)((function(e){var t=function(e,t){return(Ha(e).find((function(e){return e.id===t}))||{}).name}(n,e),r=0;R.rows.forEach((function(e){e[n.name]===t&&r++})),r>0?(w(e),N(r)):(N(0),H(e))}),[R,n,H]),ee=(0,s.useCallback)((function(){return L.length>0?null:p?(0,m.jsx)("div",{className:"none-search-result mt-2",children:(0,h.AP)("No options available")}):(0,m.jsx)("div",{className:"none-search-result mt-2",children:(0,h.AP)("No options")})}),[p,L]),te=(0,s.useCallback)((function(){return Array.isArray(L)?L.map((function(e,t){var n=e.id;return(0,m.jsx)(Ou,{option:e,index:t,isEditing:k===n,isDeleting:b===n,isViewing:y===n,onMove:Y,onUpdate:B,onDelete:Q,onMouseEnter:G,onMouseLeave:z,onToggleFreeze:V,onOpenNameEditor:W,onCloseNameEditor:K},n)})):[]}),[L,k,b,y,Y,B,Q,G,z,V,W,K]);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(zl.Rw,{target:t,className:"sf-metadata-edit-column-options-popover",canHide:!b&&E.current,hide:r,hideWithEsc:r,children:(0,m.jsxs)("div",{className:"sf-metadata-edit-column-options-container",children:[(0,m.jsx)("div",{className:"sf-metadata-edit-column-options-search-container",children:(0,m.jsx)(zl.DO,{className:"sf-metadata-option-search-control",placeholder:(0,h.AP)("Search option"),onChange:X,autoFocus:!0})}),ee(),(0,m.jsx)(Iu,{options:te(),viewingOptionId:y,inputRef:T}),(0,m.jsx)(zl.NC,{className:"sf-metadata-add-option",callBack:q,footerName:(0,h.AP)("Add option"),addIconClassName:"sf-metadata-add-option-icon"}),(0,m.jsx)(_u,{column:n,onToggle:r,onImportOptions:J})]})}),b&&(0,m.jsx)(Tu,{option:l.find((function(e){return e.id===b})),onToggle:$,onSubmit:Z,deleteNumber:P})]})},Ru=((0,ro.default)((0,ro.default)({},lo.TEXT,!0),lo.URL,!0),(0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)({},di,!0),ci,!0),ui,!0),yi,!0),xi,!0),(0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)((0,ro.default)({},Si.IS_ANY_OF,!0),Si.IS_NONE_OF,!0),Si.HAS_ANY_OF,!0),Si.HAS_ALL_OF,!0),Si.HAS_NONE_OF,!0),Si.IS_EXACTLY,!0)),Lu=(0,ro.default)((0,ro.default)({},Si.IS,!0),Si.IS_NOT,!0),Fu=(0,ro.default)((0,ro.default)({},Si.EMPTY,!0),Si.NOT_EMPTY,!0),Uu=[lo.CREATOR,lo.LAST_MODIFIER],Bu=function(e,t){var n=e.type;return!!Uu.includes(n)||!(n!==lo.SINGLE_SELECT||![Si.IS_ANY_OF,Si.IS_NONE_OF].includes(t))},Yu=function(e,t){var n=[Si.CONTAINS,Si.NOT_CONTAIN],r=e.filter_predicate,o=e.filter_term;if(n.includes(r)){o=o?e.filter_term.slice(0):[];var i=t.email,a=o.indexOf(i);a>-1?o.splice(a,1):o.push(i)}else{if(o[0]===t.email)return;o=[t.email]}return Object.assign({},e,{filter_term:o})},qu=function(e,t){var n;if(Ru[e.filter_predicate]){var r=(n=Array.isArray(e.filter_term)?(0,W.A)(e.filter_term):[]).indexOf(t.id);-1===r?n.push(t.id):n.splice(r,1)}else n=t.id;return Object.assign({},e,{filter_term:n})},Hu=function(e,t){var n=e.filter_term?e.filter_term:[],r=n.indexOf(t.id);return r>-1?n.splice(r,1):n.push(t.id),Object.assign({},e,{filter_term:n})},Gu=function(e,t){var n=e.filter_term?e.filter_term.slice(0):[],r=t.email,o=n.indexOf(r);return o>-1?n.splice(o,1):n.push(r),Object.assign({},e,{filter_term:n})},zu=function(e){var t=e.type;return _i[t]||{}},Vu=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=zu(e).filterPredicateList;if(n){var r=n[0],o=Object.assign({},t,{column_key:e.key,filter_predicate:r});if(o.filter_term="",Bu(e,r))return o.filter_term=[],o;if(qa(e)){var i=r===Si.IS_WITHIN?Ni[0]:Pi[0];return o.filter_term_modifier=i,o.filter_term="",o}return o}},Wu=function(){return(0,o.A)((function e(){(0,r.A)(this,e)}),null,[{key:"generatorColumnOption",value:function(e){if(!e)return null;var t=e.type,n=e.name;return{value:{column:e},label:(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("span",{className:"sf-metadata-filter-header-icon",children:(0,m.jsx)(zl.In,{iconName:co[t]})}),(0,m.jsx)("span",{className:"select-option-name",children:n})]})}}},{key:"generatorPredicateOption",value:function(e){return{value:{filterPredicate:e},label:(0,m.jsx)("span",{className:"select-option-name",children:Di[e]})}}},{key:"generatorTermModifierOption",value:function(e){return{value:{filterTermModifier:e},label:(0,m.jsx)("span",{className:"select-option-name",children:wi[e]})}}},{key:"generatorSingleSelectOption",value:function(e,t){return{value:{columnOption:e},label:(0,m.jsxs)("div",{className:"select-option-name single-option-name",children:[(0,m.jsx)("div",{className:"single-select-option",style:{background:e.color,color:e.textColor||null},title:e.name,"aria-label":e.name,children:e.name}),(0,m.jsx)("div",{className:"single-check-icon",children:(null===t||void 0===t?void 0:t.id)===e.id&&(0,m.jsx)(zl.In,{iconName:"check-mark"})})]})}}},{key:"generatorMultipleSelectOption",value:function(e,t){return{value:{columnOption:e},label:(0,m.jsxs)("div",{className:"select-option-name multiple-option-name",children:[(0,m.jsx)("div",{className:"multiple-select-option",style:{background:e.color,color:e.textColor},title:e.name,"aria-label":e.name,children:e.name}),(0,m.jsx)("div",{className:"multiple-check-icon",children:t.indexOf(e.id)>-1&&(0,m.jsx)(zl.In,{iconName:"check-mark"})})]})}}},{key:"generatorConjunctionOptions",value:function(){return[{value:{filterConjunction:"And"},label:(0,m.jsx)("span",{className:"select-option-name",children:(0,h.AP)("And")})},{value:{filterConjunction:"Or"},label:(0,m.jsx)("span",{className:"select-option-name",children:(0,h.AP)("Or")})}]}},{key:"getActiveConjunctionOption",value:function(e){return"And"===e?{value:{filterConjunction:"And"},label:(0,m.jsx)("span",{className:"select-option-name",children:(0,h.AP)("And")})}:{value:{filterConjunction:"Or"},label:(0,m.jsx)("span",{className:"select-option-name",children:(0,h.AP)("Or")})}}}])}(),Ku=Wu,Xu=function(e){var t=e.readOnly,n=e.filterIndex,r=e.filterTerm,o=e.collaborators,i=e.placeholder,a=e.filter_predicate,l=e.onSelectCollaborator,c=(0,s.useMemo)((function(){return[Si.HAS_ANY_OF,Si.HAS_ALL_OF,Si.HAS_NONE_OF,Si.IS_EXACTLY]}),[]),u=(0,s.useMemo)((function(){return c.indexOf(a)>-1}),[c,a]),d=(0,s.useMemo)((function(){return Array.isArray(r)?o.map((function(e){var t=r.findIndex((function(t){return t===e.email}))>-1;return{value:{filterIndex:n,columnOption:e},label:(0,m.jsx)(s.Fragment,{children:(0,m.jsxs)("div",{className:"select-option-name option-collaborator",children:[(0,m.jsx)("div",{className:"collaborator-container",children:(0,m.jsxs)("div",{className:"collaborator",children:[(0,m.jsx)("span",{className:"collaborator-avatar-container",children:(0,m.jsx)("img",{className:"collaborator-avatar",alt:e.name,src:e.avatar_url})}),(0,m.jsx)("span",{className:"collaborator-name text-truncate",style:{maxWidth:"200px"},title:e.name,"aria-label":e.name,children:e.name})]})}),(0,m.jsx)("div",{className:"collaborator-check-icon",children:t&&(0,m.jsx)(zl.In,{iconName:"check-mark"})})]})})}})):[]}),[n,o,r]),p=(0,s.useMemo)((function(){return Array.isArray(r)&&r.length>0&&r.map((function(e){var t=o.find((function(t){return t.email===e}));return t?(0,m.jsxs)("div",{className:"collaborator",children:[(0,m.jsx)("span",{className:"collaborator-avatar-container",children:(0,m.jsx)("img",{className:"collaborator-avatar",alt:t.name,src:t.avatar_url})}),(0,m.jsx)("span",{className:"collaborator-name text-truncate",title:t.name,"aria-label":t.name,children:t.name})]},e):null}))}),[r,o]);return(0,m.jsx)(zl.Cg,{className:"sf-metadata-selector-collaborator",value:p?{label:p}:{},onSelectOption:l,options:d,placeholder:i,readOnly:t,supportMultipleSelect:u,searchable:!0,searchPlaceholder:(0,h.AP)("Search collaborator"),isShowSelected:!1,noOptionsPlaceholder:(0,h.AP)("No collaborators")})},$u=function(e){var t,n=e.value,r=e.filterColumn,o=e.readOnly,i=e.onChange,a=(t=r,t&&t.data&&t.data.format?t.data.format:fo).trim(),s=window.sfMetadataContext.getSetting("lang");return(0,m.jsx)(zl.sv,{isReadOnly:o,format:a,lang:s,value:n,onChange:i,zIndex:1061})},Zu=[Si.EMPTY,Si.NOT_EMPTY],Ju=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).initSelectOptions=function(e){var t=e.filter,r=e.filterColumn,o=(e.value,zu(r)),i=o.filterPredicateList,a=o.filterTermModifierList;n.filterPredicateOptions=i?i.map((function(e){return Ku.generatorPredicateOption(e)})).filter((function(e){return e})):[];var s=t.filter_predicate;qa(r)&&(s===Si.IS_WITHIN&&(a=Ni),n.filterTermModifierOptions=a.map((function(e){return Ku.generatorTermModifierOption(e)})))},n.onDeleteFilter=function(e){e.nativeEvent.stopImmediatePropagation();var t=n.props.index;n.props.deleteFilter(t)},n.resetState=function(e){n.setState({filterTerm:e.filter_term})},n.onSelectConjunction=function(e){n.props.filterConjunction!==e.filterConjunction&&n.props.updateConjunction(e.filterConjunction)},n.onSelectColumn=function(e){var t=n.props,r=t.index,o=t.filter,i=e.column;if(i.key!==o.column_key){var a=Vu(i,o);a&&(n.resetState(a),n.props.updateFilter(r,a))}},n.onSelectPredicate=function(e){var t=n.props,r=t.index,o=t.filter,i=t.filterColumn,a=e.filterPredicate;if(o.filter_predicate!==a){var s=function(e,t,n){var r=Object.assign({},e,{filter_predicate:n}),o=t.type;if(o===lo.CHECKBOX)return r.filter_term=!1,r;if(o===lo.SINGLE_SELECT)return Ru[n]?Ru[e.filter_predicate]!==Ru[n]&&(r.filter_term=[]):Lu[n]?Lu[e.filter_predicate]!==Lu[n]&&(r.filter_term=""):r.filter_term="",r;if([lo.CREATOR,lo.LAST_MODIFIER].includes(o)&&(Lu[e.filter_predicate]===Lu[n]&&n!==Si.INCLUDE_ME||(r.filter_term=[])),Bu(t,n))return(Fu[n]||n===Si.INCLUDE_ME)&&(r.filter_term=[]),r;if(qa(t)){var i=n===Si.IS_WITHIN?Ni[0]:Pi[0];return r.filter_term_modifier=i,r}return r}(o,i,a);n.resetState(s),n.props.updateFilter(r,s)}},n.onSelectTermModifier=function(e){var t=n.props,r=t.index,o=t.filter,i=e.filterTermModifier,a=[di,ci,ui,yi,xi];if(o.filter_term_modifier!==i){var s=o.filter_term;a.indexOf(o.filter_term_modifier)>-1&&(s="");var l=Object.assign({},o,{filter_term_modifier:i,filter_term:s});n.resetState(l),n.props.updateFilter(r,l)}},n.onSelectSingle=function(e){var t=n.props,r=t.index,o=t.filter,i=e.columnOption;if(o.filter_term!==i.id){var a=qu(o,i);n.resetState(a),n.props.updateFilter(r,a)}},n.onSelectMultiple=function(e){var t=n.props,r=t.index,o=t.filter,i=e.columnOption,a=Hu(o,i);n.resetState(a),n.props.updateFilter(r,a)},n.onSelectCollaborator=function(e){var t=n.props,r=t.index,o=t.filter,i=e.columnOption,a=Gu(o,i);n.resetState(a),n.props.updateFilter(r,a)},n.onSelectCreator=function(e){var t=n.props,r=t.index,o=t.filter,i=e.columnOption,a=Yu(o,i);a&&(n.resetState(a),n.props.updateFilter(r,a))},n.onFilterTermCheckboxChanged=function(e){n.onFilterTermChanged(e.target.checked)},n.onFilterTermTextChanged=function(e){n.onFilterTermChanged(e)},n.onFilterTermNumberChanged=function(){var e=n.numberEditor.getValue();n.onFilterTermChanged(Object.values(e)[0])},n.onFilterExactDateChanged=function(e){n.onFilterTermChanged(e)},n.onFilterTermChanged=function(e){var t=n.props,r=t.index,o=t.filter;if(e!==n.state.filterTerm){n.setState({filterTerm:e});var i=Object.assign({},o,{filter_term:e});n.props.updateFilter(r,i)}},n.onMouseEnterRateItem=function(e){n.setState({enterRateItemIndex:e})},n.onMouseLeaveRateItem=function(){n.setState({enterRateItemIndex:0})},n.onChangeRateNumber=function(e){n.onFilterTermChanged(e)},n.getInputComponent=function(e){var t=n.props.readOnly,r=n.state.filterTerm;if("text"===e)return(0,m.jsx)(zl.DO,{value:r,onChange:n.onFilterTermTextChanged,autoFocus:!1,disabled:t,className:"text-truncate"});if("checkbox"===e){var o=n.props.readOnly;return(0,m.jsx)("input",{type:"checkbox",disabled:o,checked:r,onChange:n.onFilterTermCheckboxChanged})}},n.renderConjunction=function(){var e=n.props,t=e.index,r=e.readOnly,o=e.filterConjunction,i=e.conjunctionOptions;switch(t){case 0:return null;case 1:var a=Ku.getActiveConjunctionOption(o);return(0,m.jsx)(zl.Cg,{readOnly:r,value:a,options:i,onSelectOption:n.onSelectConjunction});default:return(0,m.jsx)("span",{className:"selected-conjunction-show",children:(0,h.AP)(o)})}},n.renderMultipleSelectOption=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,r=n.props.filter.filter_predicate,o=!1;[Si.IS_ANY_OF,Si.IS_NONE_OF,Si.HAS_ANY_OF,Si.HAS_ALL_OF,Si.HAS_NONE_OF,Si.IS_EXACTLY].includes(r)&&(o=!0);var i=[];Array.isArray(e)&&Array.isArray(t)&&t.forEach((function(t){var n=e.find((function(e){return e.id===t})),r={margin:"0 10px 0 0"},o=null;n?(o=n.name,r.background=n.color,r.color=n.textColor||null):(r.background=Rl,o=(0,h.AP)(Ll)),i.push((0,m.jsx)("span",{className:"select-option-name multiple-select-option",style:r,title:o,"aria-label":o,children:o},"option_"+t))}));var a=i.length>0?{label:(0,m.jsx)(s.Fragment,{children:i})}:{},l=e.map((function(e){return Ku.generatorMultipleSelectOption(e,t)}));return(0,m.jsx)(zl.Cg,{className:"sf-metadata-selector-multiple-select",value:a,options:l,onSelectOption:n.onSelectMultiple,placeholder:(0,h.AP)("Select option(s)"),searchable:!0,searchPlaceholder:(0,h.AP)("Search option"),noOptionsPlaceholder:(0,h.AP)("No options available"),supportMultipleSelect:o})},n.getAllCollaborators=function(){var e=window.sfMetadata.collaborators,t=window.sfMetadata.collaboratorsCache;return[].concat((0,W.A)(e),(0,W.A)(Object.values(t)))},n.renderFilterTerm=function(e){var t=n.props,r=t.index,o=t.filter,i=t.collaborators,a=t.readOnly,s=e.type,l=o.filter_term,c=o.filter_predicate,u=o.filter_term_modifier;if(Zu.includes(c))return null;if(qa(e))return[di,ci,ui,yi,xi].indexOf(u)>-1?"exact_date"===u?(0,m.jsx)($u,{readOnly:a,onChange:n.onFilterExactDateChanged,value:n.state.filterTerm,filterColumn:e}):n.getInputComponent("text"):null;switch(s){case lo.NUMBER:case lo.FILE_NAME:case lo.TEXT:case lo.URL:return c===Si.IS_CURRENT_USER_ID?null:n.getInputComponent("text");case lo.CREATOR:case lo.LAST_MODIFIER:if(c===Si.INCLUDE_ME)return null;var d=i;return(0,m.jsx)(Xu,{readOnly:a,filterIndex:r,filterTerm:l||[],collaborators:d,onSelectCollaborator:n.onSelectCreator});case lo.CHECKBOX:return n.getInputComponent("checkbox");case lo.SINGLE_SELECT:var p=Ha(e);if([Si.IS_ANY_OF,Si.IS_NONE_OF].includes(c))return n.renderMultipleSelectOption(p,l);var f={label:null};if(l){var g=p.find((function(e){return e.id===l})),v=g?{background:g.color,color:g.textColor||null}:{background:Rl},y=g?g.name:(0,h.AP)("deleted option");f={label:(0,m.jsx)("span",{className:"select-option-name single-select-option",style:v,title:y,"aria-label":y,children:y})}}var x=p.map((function(e){return Ku.generatorSingleSelectOption(e)}));return(0,m.jsx)(zl.Cg,{readOnly:a,className:"sf-metadata-selector-single-select",value:f,options:x||[],onSelectOption:n.onSelectSingle,placeholder:(0,h.AP)("Select an option"),searchable:!0,searchPlaceholder:(0,h.AP)("Search option"),noOptionsPlaceholder:(0,h.AP)("No options available"),isInModal:n.props.isInModal});case lo.COLLABORATOR:if(c===Si.INCLUDE_ME)return null;var A=n.getAllCollaborators();return(0,m.jsx)(Xu,{readOnly:a,filterIndex:r,filterTerm:l||[],filter_predicate:c,collaborators:A,placeholder:(0,h.AP)("Select collaborators"),onSelectCollaborator:n.onSelectCollaborator});case lo.MULTIPLE_SELECT:var C=(e.data||{}).options,b=void 0===C?[]:C;return n.renderMultipleSelectOption(b,l,a);default:return null}},n.isRenderErrorTips=function(){var e=n.props.errMsg;return e&&e!==Ei},n.renderErrorMessage=function(){return n.isRenderErrorTips()?(0,m.jsxs)("div",{className:"ml-2",children:[(0,m.jsx)(zl.Oi,{ref:n.invalidFilterTip,iconName:"exclamation-triangle"}),(0,m.jsx)(Qe.A,{target:n.invalidFilterTip,placement:"bottom",fade:!1,children:(0,h.AP)("Invalid filter")})]}):null},n.state={filterTerm:e.filter.filter_term,enterRateItemIndex:0},n.filterPredicateOptions=null,n.filterTermModifierOptions=null,n.filterToolTip=s.createRef(),n.invalidFilterTip=s.createRef(),n.initSelectOptions(e),n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.props.filter;e.filter!==t&&(this.initSelectOptions(e),this.setState({filterTerm:e.filter.filter_term}))}},{key:"shouldComponentUpdate",value:function(e){var t=this.props;return e.index!==t.index||e.filter!==t.filter||e.filterColumn!==t.filterColumn||e.filterConjunction!==t.filterConjunction||e.conjunctionOptions!==t.conjunctionOptions||e.filterColumnOptions!==t.filterColumnOptions}},{key:"render",value:function(){var e=this.filterPredicateOptions,t=this.filterTermModifierOptions,n=this.props,r=n.filter,o=n.filterColumn,i=n.filterColumnOptions,a=n.readOnly,s=r.filter_predicate,l=r.filter_term_modifier,c=Ku.generatorColumnOption(o),u=Ku.generatorPredicateOption(s),d=null,p=!1;qa(o)?d=Ku.generatorTermModifierOption(l):o.type===lo.CHECKBOX&&(p=!0);var f=!Zu.includes(s);return(0,m.jsxs)("div",{className:"filter-item",children:[!a&&(0,m.jsx)("div",{className:"delete-filter",onClick:this.onDeleteFilter,children:(0,m.jsx)(zl.In,{iconName:"fork-number"})}),(0,m.jsxs)("div",{className:"condition",children:[(0,m.jsx)("div",{className:"filter-conjunction",children:this.renderConjunction()}),(0,m.jsxs)("div",{className:"filter-container",children:[(0,m.jsx)("div",{className:"filter-column",children:(0,m.jsx)(zl.Cg,{readOnly:a,value:c,options:i,onSelectOption:this.onSelectColumn,searchable:!0,searchPlaceholder:(0,h.AP)("Search property"),noOptionsPlaceholder:(0,h.AP)("No results")})}),(0,m.jsx)("div",{className:"filter-predicate ml-2 ".concat(p?"filter-checkbox-predicate":""),children:(0,m.jsx)(zl.Cg,{readOnly:a,value:u,options:e,onSelectOption:this.onSelectPredicate})}),qa(o)&&f&&(0,m.jsx)("div",{className:"filter-term-modifier ml-2",children:(0,m.jsx)(zl.Cg,{readOnly:a,value:d,options:t,onSelectOption:this.onSelectTermModifier})}),(0,m.jsx)("div",{className:"filter-term ml-2",children:this.renderFilterTerm(o)}),this.renderErrorMessage()]})]})]})}}])}(s.Component),Qu=Ju,ed=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).updateFilter=function(e,t){t&&n.props.updateFilter(e,t)},n.deleteFilter=function(e){var t=n.props.scheduleUpdate;n.props.deleteFilter(e,t)},n.updateConjunction=function(e){n.props.modifyFilterConjunction(e)},n.getConjunctionOptions=function(){return n.conjunctionOptions||(n.conjunctionOptions=Ku.generatorConjunctionOptions()),n.conjunctionOptions},n.getFilterColumns=function(){return n.props.columns.filter((function(e){var t=e.type;return Object.prototype.hasOwnProperty.call(_i,t)}))},n.getColumnOptions=function(){if(!n.columnOptions){var e=n.getFilterColumns();n.columnOptions=e.map((function(e){return Ku.generatorColumnOption(e)}))}return n.columnOptions},n.renderFilterItem=function(e,t,r,o){var i=n.props,a=i.readOnly,s=i.filterConjunction,l=i.value,c=n.getConjunctionOptions(),u=n.getColumnOptions();return(0,m.jsx)(Qu,{readOnly:a,index:t,filter:e,errMsg:r,filterColumn:o,filterConjunction:s,conjunctionOptions:c,filterColumnOptions:u,value:l,deleteFilter:n.deleteFilter,updateFilter:n.updateFilter,updateConjunction:n.updateConjunction,collaborators:n.props.collaborators,isPre:n.props.isPre},t)},n.conjunctionOptions=null,n.columnOptions=null,n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.columns!==this.props.columns&&(this.columnOptions=null)}},{key:"render",value:function(){var e=this,t=this.props,n=t.filters,r=t.className,o=t.emptyPlaceholder,i=t.columns,a=0===n.length;return(0,m.jsxs)("div",{className:D()("sf-metadata-filters-list",{"empty-filters-container":a},(0,ro.default)({},r,r)),children:[a&&(0,m.jsx)("div",{className:"empty-filters-list",children:o}),!a&&n.map((function(t,n){var r=t.column_key,o=ls.validate(t,i).error_message,a=Ya(i,r)||{};return e.renderFilterItem(t,n,o,a)}))]})}}])}(s.Component),td=ed,nd=[{value:"file",name:(0,h.AP)("Only files")},{value:"folder",name:(0,h.AP)("Only folders")},{value:"all",name:(0,h.AP)("Files and folders")}],rd=function(e){var t=e.readOnly,n=e.value,r=void 0===n?"all":n,o=e.onChange,i=(0,s.useMemo)((function(){return nd.map((function(e){var t=e.name;return{value:e.value,label:(0,m.jsxs)("div",{className:"select-basic-filter-option",children:[(0,m.jsx)("div",{className:"select-basic-filter-option-name",title:t,"aria-label":t,children:t}),(0,m.jsx)("div",{className:"select-basic-filter-option-check-icon",children:r===e.value&&(0,m.jsx)(zl.In,{iconName:"check-mark"})})]})}}))}),[r]),a=(0,s.useMemo)((function(){var e=nd.find((function(e){return e.value===r}))||nd[2];return{label:(0,m.jsx)("div",{children:e.name})}}),[r]),l=(0,s.useCallback)((function(e){e!==r&&o(e)}),[r,o]);return(0,m.jsx)(zl.Cg,{readOnly:t,className:"sf-metadata-basic-filters-select",value:a,options:i,onSelectOption:l,component:{DropDownIcon:(0,m.jsx)("i",{className:"sf3-font sf3-font-down"})}})},od=function(e){var t=e.readOnly,n=e.filters,r=void 0===n?[]:n,o=e.onChange,i=(0,s.useCallback)((function(e){var t=r.findIndex((function(e){return e.column_key===Po})),n=r[t],i=r.slice(0);i[t]=(0,Sr.A)((0,Sr.A)({},n),{},{filter_term:e}),o(i)}),[r,o]);return(0,m.jsxs)(wt.A,{className:"filter-group p-4",children:[(0,m.jsx)(St.A,{className:"filter-group-name",children:(0,h.AP)("Basic")}),(0,m.jsx)("div",{className:"filter-group-container",children:r.map((function(e){var n=e.column_key,r=e.filter_term;return n===Po?(0,m.jsx)(rd,{readOnly:t,value:r,onChange:i},n):null}))})]})},id=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onHotKey=function(e){(0,ma.default)("esc",e)&&!n.isSelectOpen&&(e.preventDefault(),n.props.hidePopover())},n.setSelectStatus=function(e){n.isSelectOpen=e},n.hideDTablePopover=function(e){if(n.dtablePopoverRef&&!Ql(e).includes("popover")&&!n.dtablePopoverRef.contains(e.target))return n.props.hidePopover(e),e.preventDefault(),e.stopPropagation(),!1},n.update=function(e){if(n.props.isNeedSubmit){n.setState({filters:e,isSubmitDisabled:!1})}else n.setState({filters:e},(function(){var t={filters:e,filter_conjunction:n.state.filterConjunction};n.props.update(t)}))},n.deleteFilter=function(e,t){var r=n.state.filters.slice(0);r.splice(e,1),0===r.length&&t(),n.update(r)},n.updateFilter=function(e,t){var r=n.state.filters.slice(0);r[e]=t,n.update(r)},n.modifyFilterConjunction=function(e){if(n.props.isNeedSubmit){n.setState({filterConjunction:e,isSubmitDisabled:!1})}else n.setState({filterConjunction:e},(function(){var t={filters:n.state.filters,filter_conjunction:e};n.props.update(t)}))},n.addFilter=function(e){var t=n.props.columns,r=t[0];if(_i[r.type]||(r=t.find((function(e){return _i[e.type]}))),r){var o=Vu(r),i=n.state.filters.slice(0);0===i.length&&e(),i.push(o),n.update(i)}},n.onClosePopover=function(){n.props.hidePopover()},n.onSubmitFilters=function(){var e=n.state,t={filters:e.filters,filter_conjunction:e.filterConjunction,basic_filters:e.basicFilters};n.props.update(t),n.props.hidePopover()},n.onPopoverInsideClick=function(e){e.stopPropagation()},n.onBasicFilterChange=function(e){if(n.props.isNeedSubmit){n.setState({basicFilters:e,isSubmitDisabled:!1})}else n.setState({basicFilters:e},(function(){var t={filters:n.state.filters,filter_conjunction:n.state.filterConjunction,basic_filters:e};n.props.update(t)}))},n.state={basicFilters:e.basicFilters,filters:vs(e.filters,e.columns),filterConjunction:e.filterConjunction||"And",isSubmitDisabled:!0},n.isSelectOpen=!1,n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.hideDTablePopover,!0),document.addEventListener("keydown",this.onHotKey),this.unsubscribeOpenSelect=window.sfMetadataContext.eventBus.subscribe(dl,this.setSelectStatus)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.hideDTablePopover,!0),document.removeEventListener("keydown",this.onHotKey),this.unsubscribeOpenSelect()}},{key:"render",value:function(){var e=this,t=this.props,n=t.readOnly,r=t.target,o=t.columns,i=t.placement,a=this.state,s=a.filters,l=a.filterConjunction,c=a.basicFilters,u=o.length>0;return(0,m.jsx)(Vl.A,{placement:i,isOpen:!0,target:r,fade:!1,hideArrow:!0,className:"sf-metadata-filter-popover",boundariesElement:document.body,children:function(t){var r=t.scheduleUpdate;return(0,m.jsxs)("div",{ref:function(t){return e.dtablePopoverRef=t},onClick:e.onPopoverInsideClick,className:e.props.filtersClassName,children:[(0,m.jsx)(od,{filters:c,onChange:e.onBasicFilterChange}),(0,m.jsxs)(wt.A,{className:"filter-group-advanced filter-group mb-0",children:[(0,m.jsx)(St.A,{className:"filter-group-name",children:(0,h.AP)("Advanced")}),(0,m.jsxs)("div",{className:"filter-group-container",children:[(0,m.jsx)(td,{filterConjunction:l,filters:s,columns:o,emptyPlaceholder:(0,h.AP)("No filters"),updateFilter:e.updateFilter,deleteFilter:e.deleteFilter,modifyFilterConjunction:e.modifyFilterConjunction,collaborators:e.props.collaborators,readOnly:n,scheduleUpdate:r,isPre:e.props.isPre}),!n&&(0,m.jsx)(zl.NC,{className:"popover-add-tool ".concat(u?"":"disabled"),callBack:u?function(){return e.addFilter(r)}:function(){},footerName:(0,h.AP)("Add filter"),addIconClassName:"popover-add-icon"})]})]}),!n&&e.props.isNeedSubmit&&(0,m.jsxs)("div",{className:"sf-metadata-popover-footer",children:[(0,m.jsx)(O.A,{className:"mr-2",onClick:e.onClosePopover,children:(0,h.AP)("Cancel")}),(0,m.jsx)(O.A,{color:"primary",disabled:e.state.isSubmitDisabled,onClick:e.onSubmitFilters,children:(0,h.AP)("Submit")})]})]})}})}}])}(s.Component);id.defaultProps={filtersClassName:"",placement:"auto-start"};var ad=id,sd="add_sort",ld="delete_sort",cd="modify_sort_column",ud="modify_sort_type",dd=function(e,t){var n=t.sorts;switch(e){case sd:var r={column_key:null,sort_type:ra};return n.push(r),n;case ld:var o=t.index;return n.splice(o,1),n;case cd:var i=t.index,a={column_key:t.column_key,sort_type:ra};return n[i]=a,n;case ud:var s=t.index,l=t.sort_type,c={column_key:n[s].column_key,sort_type:l};return n[s]=c,n;default:return n}},pd=[{name:(0,h.AP)("Up"),value:ra},{name:(0,h.AP)("Down"),value:oa}],hd=function(e){function t(e){var n;(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).hideDTablePopover=function(e){if(n.sortPopoverRef&&!Ql(e).includes("popover")&&!n.sortPopoverRef.contains(e.target))return n.props.onSortComponentToggle(e),e.preventDefault(),e.stopPropagation(),!1},n.onHotKey=function(e){(0,ma.default)("esc",e)&&!n.isSelectOpen&&(e.preventDefault(),n.props.onSortComponentToggle())},n.setSelectStatus=function(e){n.isSelectOpen=e},n.addSort=function(){var e=n.state.sorts,t=dd(sd,{sorts:e});n.updateSorts(t)},n.deleteSort=function(e,t){e.nativeEvent.stopImmediatePropagation();var r=n.state.sorts.slice(0),o=dd(ld,{sorts:r,index:t});n.updateSorts(o)},n.onSelectColumn=function(e,t){var r=n.state.sorts.slice(0),o=e.column.key;if(o!==r[t].column_key){var i=dd(cd,{sorts:r,index:t,column_key:o});n.updateSorts(i)}},n.onSelectSortType=function(e,t){var r=n.state.sorts.slice(0),o=e.sortType;if(o!==r[t].sort_type){var i=dd(ud,{sorts:r,index:t,sort_type:o});n.updateSorts(i)}},n.updateSorts=function(e){if(n.props.isNeedSubmit){n.setState({sorts:e,isSubmitDisabled:!1})}else n.setState({sorts:e},(function(){n.handleSortAnimation()}))},n.handleSortAnimation=function(){var e={sorts:n.state.sorts};n.props.update(e)},n.onClosePopover=function(){n.props.onSortComponentToggle()},n.onSubmitSorts=function(){var e={sorts:n.state.sorts};n.props.update(e),n.props.onSortComponentToggle()},n.createColumnsOptions=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).filter((function(e){return ia.includes(e.type)})).map((function(e){var t=e.type,n=e.name;return{value:{column:e},label:(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("span",{className:"sf-metadata-filter-header-icon",children:(0,m.jsx)(zl.In,{iconName:co[t]})}),(0,m.jsx)("span",{className:"",children:n})]})}}))},n.createSortTypeOptions=function(){return pd.map((function(e){return{value:{sortType:e.value},label:(0,m.jsx)("span",{className:"select-option-name",children:e.name})}}))},n.renderSortsList=function(){var e=n.props.columns;return n.state.sorts.map((function(t,r){var o=Ya(e,t.column_key)||{};return n.renderSortItem(o,t,r)}))},n.renderSortItem=function(e,t,r){var o=e.name,i=e.type,a=n.props.readOnly,l={label:(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("span",{className:"sf-metadata-filter-header-icon",children:(0,m.jsx)(zl.In,{iconName:co[i]})}),(0,m.jsx)("span",{className:"select-option-name",title:o,"aria-label":o,children:o})]})},c=t.sort_type,u=c&&{label:(0,m.jsx)("span",{className:"select-option-name",children:(0,h.AP)(c)})};return(0,m.jsxs)("div",{className:"sort-item",children:[!a&&(0,m.jsx)("div",{className:"delete-sort",onClick:function(e){return n.deleteSort(e,r)},children:(0,m.jsx)(zl.In,{iconName:"fork-number"})}),(0,m.jsxs)("div",{className:"condition",children:[(0,m.jsx)("div",{className:"sort-column",children:(0,m.jsx)(zl.Cg,{readOnly:a,value:l,onSelectOption:function(e){return n.onSelectColumn(e,r)},options:n.columnsOptions,searchable:!0,searchPlaceholder:(0,h.AP)("Search property"),noOptionsPlaceholder:(0,h.AP)("No results")})}),(0,m.jsx)("div",{className:"sort-predicate ml-2",children:(0,m.jsx)(zl.Cg,{readOnly:a,value:u,onSelectOption:function(e){return n.onSelectSortType(e,r)},options:n.sortTypeOptions})})]})]},"sort-item-"+r)},n.onPopoverInsideClick=function(e){e.stopPropagation()};var o,a,l=n.props,c=l.sorts,u=l.columns;return n.sortTypeOptions=n.createSortTypeOptions(),n.columnsOptions=n.createColumnsOptions(u),n.state={sorts:(o=c,a=u,Array.isArray(o)&&Array.isArray(a)?o.filter((function(e){return!e.column_key||Os(e,a)})):[])},n.isSelectOpen=!1,n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.hideDTablePopover,!0),document.addEventListener("keydown",this.onHotKey),this.unsubscribeOpenSelect=window.sfMetadataContext.eventBus.subscribe(dl,this.setSelectStatus)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.hideDTablePopover,!0),document.removeEventListener("keydown",this.onHotKey),this.unsubscribeOpenSelect()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.columns;t!==this.props.columns&&(this.columnsOptions=this.createColumnsOptions(t))}},{key:"render",value:function(){var e=this,t=this.props,n=t.target,r=t.readOnly,o=function(e){return!e||0===e.length}(this.state.sorts);return(0,m.jsx)(Vl.A,{placement:"bottom-end",isOpen:!0,target:n,fade:!1,hideArrow:!0,className:"sf-metadata-sort-popover",boundariesElement:document.body,children:(0,m.jsxs)("div",{ref:function(t){return e.sortPopoverRef=t},onClick:this.onPopoverInsideClick,children:[(0,m.jsx)("div",{className:"sorts-list ".concat(o?"empty-sorts-container":""),children:o?(0,m.jsx)("div",{className:"empty-sorts-list",children:(0,h.AP)("No sorts")}):this.renderSortsList()}),!r&&(0,m.jsx)(zl.NC,{callBack:this.addSort,footerName:(0,h.AP)("Add sort"),className:"popover-add-tool",addIconClassName:"popover-add-icon"}),this.props.isNeedSubmit&&!r&&(0,m.jsxs)("div",{className:"sf-metadata-popover-footer",children:[(0,m.jsx)(O.A,{className:"mr-2",onClick:this.onClosePopover,children:(0,h.AP)("Cancel")}),(0,m.jsx)(O.A,{color:"primary",disabled:this.state.isSubmitDisabled,onClick:this.onSubmitSorts,children:(0,h.AP)("Submit")})]})]})})}}])}(s.Component);hd.defaultProps={readOnly:!1};var fd=hd,md=[$i,Wi,Ki,Xi],gd=function(e){return qa(e)?Hi:e.type===lo.GEOLOCATION?"country_region"===(e.data||{}).geo_format?md[0]:md[1]:null},vd=function(e){if(qa(e))return!0;var t=e.data||{};return e.type===lo.GEOLOCATION&&(t.geo_format!==Wi&&"country_region"!==t.geo_format)},yd=(0,s.memo)((function(e){var t=e.isOver,n=e.isDragging,r=e.canDrop,o=e.connectDragSource,i=e.connectDragPreview,a=e.connectDropTarget,l=e.showDragBtn,c=e.index,u=e.readOnly,d=e.groupby,p=e.columns,f=e.onDelete,g=e.onUpdate,v=(0,s.useMemo)((function(){return Ya(p,d.column_key)}),[d,p]),y=(0,s.useMemo)((function(){return Array.isArray(p)&&0!==p.length?p.map((function(e){var t=e.type,n=e.name;return{value:{column:e},label:(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("span",{className:"sf-metadata-filter-header-icon",children:(0,m.jsx)(zl.In,{iconName:co[t]})}),(0,m.jsx)("span",{className:"select-option-name",children:n})]})}})):[]}),[p]),x=(0,s.useMemo)((function(){return y.find((function(e){return e.value.column.key===d.column_key}))}),[y,d]),A=(0,s.useMemo)((function(){return[{value:{sortType:ra},label:(0,m.jsx)("span",{className:"select-option-name",children:(0,h.AP)("Up")})},{value:{sortType:oa},label:(0,m.jsx)("span",{className:"select-option-name",children:(0,h.AP)("Down")})}]}),[]),C=(0,s.useMemo)((function(){return A.find((function(e){return e.value.sortType===d.sort_type}))}),[A,d]),b=(0,s.useMemo)((function(){return{"By day":(0,h.AP)("By day"),"By week":(0,h.AP)("By week"),"By month":(0,h.AP)("By month"),"By quarter":(0,h.AP)("By quarter"),"By year":(0,h.AP)("By year")}}),[]),w=(0,s.useMemo)((function(){var e=function(e){var t=[],n={};if(qa(e))t=Qi,n=Vi;else if(e.type===lo.GEOLOCATION){var r=(e.data||{}).geo_format;t=md.filter((function(e){return r===("province_city"===r&&(e===Wi||e===Ki))||e!==$i})),n=Zi}return{granularityList:t,displayGranularity:n}}(Ya(p,d.column_key)),t=e.granularityList,n=e.displayGranularity;return t.map((function(e){return{value:e,label:(0,m.jsx)("span",{className:"select-option-name",children:b[n[e]]})}}))}),[p,d,b]),S=(0,s.useMemo)((function(){var e=d.count_type,t=function(e,t){var n=t||gd(e);return n&&qa(e)?Vi[n]:null}(v,e);if(t)return{label:(0,m.jsx)("span",{className:"select-option-name",children:b[t]})}}),[v,d,b]),k=(0,s.useCallback)((function(e){e.nativeEvent.stopImmediatePropagation(),f(c)}),[c,f]),M=(0,s.useCallback)((function(e){var t=d.column_key;if(e.column.key!==t){var n=ra,r=gd(e.column),o=(0,Sr.A)((0,Sr.A)({},d),{column_key:e.column.key,sort_type:n,count_type:r});g(o,c)}}),[d,c,g]),j=(0,s.useCallback)((function(e){if(e!==d.sort_type){var t=(0,Sr.A)((0,Sr.A)({},d),{},{count_type:e});g(t,c)}}),[d,c,g]),I=(0,s.useCallback)((function(e){var t=d.count_type;if(e.sortType!==t){var n=(0,Sr.A)((0,Sr.A)({},d),{},{sort_type:e.sortType});g(n,c)}}),[d,c,g]);return a(i((0,m.jsxs)("div",{className:D()("groupby-item",{"group-can-drop-top":t&&r&&n},{"group-can-drop":t&&r&&!n}),children:[!u&&(0,m.jsx)("div",{className:"delete-groupby",onClick:k,"aria-label":(0,h.AP)("Delete"),children:(0,m.jsx)(zl.In,{iconName:"fork-number"})}),(0,m.jsxs)("div",{className:"condition",children:[(0,m.jsx)("div",{className:"groupby-column",children:(0,m.jsx)(zl.Cg,{readOnly:u,value:x,options:y,onSelectOption:M,searchable:!0,searchPlaceholder:(0,h.AP)("Search property"),noOptionsPlaceholder:(0,h.AP)("No results")})}),vd(v)&&(0,m.jsx)("div",{className:"groupby-count-type",children:(0,m.jsx)(zl.Cg,{readOnly:u,value:S,onSelectOption:j,options:w})}),(0,m.jsx)("div",{className:"groupby-predicate",children:(!v.key||ia.includes(v.type))&&(0,m.jsx)(zl.Cg,{readOnly:u,value:C,options:A,onSelectOption:I})})]}),!u&&l&&o((0,m.jsx)("div",{className:"groupby-drag",children:(0,m.jsx)(zl.In,{iconName:"drag"})}))]})))}),(function(e,t){return!(e.index!==t.index||!ic.isSameObject(e.groupby,t.groupby)||e.isDragging!==t.isDragging||e.isOver!==t.isOver||e.canDrop!==t.canDrop||e.showDragBtn!==t.showDragBtn)})),xd=(0,ku.Tl)("sfMetadataGroupbyItem",{drop:function(e,t){var n=t.getItem(),r=e.index;if(r!==n.idx){var o={idx:r,data:e.groupby};e.onMove(n,o)}}},(function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver(),canDrop:t.canDrop(),dragged:t.getItem()}}))((0,ku.I4)("sfMetadataGroupbyItem",{beginDrag:function(e){return{idx:e.index,data:e.groupby,mode:"sfMetadataGroupbyItem"}},endDrag:function(e,t){var n=t.getItem();if(!t.didDrop())return{groupSource:n,groupTarget:{}}},isDragging:function(e){var t=e.index;return e.dragged.idx>t}},(function(e,t){return{connectDragSource:e.dragSource(),connectDragPreview:e.dragPreview(),isDragging:t.isDragging()}}))(yd)),Ad=(0,ku.Tl)("sfMetadataGroupbyItem",{},(function(e){return{connectDropTarget:e.dropTarget()}}))((function(e){var t=e.readOnly,n=e.groupbys,r=e.columns,o=e.onDelete,i=e.onUpdate,a=e.onMove,l=(0,s.useMemo)((function(){return!Array.isArray(n)||0===n.length}),[n]),c=(0,s.useMemo)((function(){return!t&&(!(!Array.isArray(n)||0===n.length)&&n.length>1)}),[t,n]);return(0,m.jsxs)("div",{className:D()("groupbys-list",{"empty-groupbys-container":l}),children:[l&&(0,m.jsx)("div",{className:"empty-groupbys-list",children:(0,h.AP)("No groupings applied to this view.")}),!l&&n.map((function(e,n){return(0,m.jsx)(xd,{index:n,readOnly:t,showDragBtn:c,groupby:e,columns:r,onDelete:o,onUpdate:i,onMove:a},n)}))]})})),Cd=(0,Mu.A)(Ad),bd=function(e){var t=e.groupbys,n=e.isNeedSubmit,r=e.readOnly,o=e.hidePopover,i=e.onChange,a=e.target,l=e.placement,c=e.columns,u=(0,s.useState)(t),d=(0,F.A)(u,2),p=d[0],f=d[1],g=(0,s.useState)(!1),v=(0,F.A)(g,2),y=v[0],x=v[1],A=(0,s.useState)(!1),C=(0,s.useRef)(null),b=(0,s.useCallback)((function(e){if(C.current&&!Ql(e).includes("popover")&&!C.current.contains(e.target))return o(e),e.preventDefault(),e.stopPropagation(),!1}),[o]),w=(0,s.useCallback)((function(e){(0,ma.default)("esc",e)&&!A.current&&(e.preventDefault(),o())}),[A,o]),S=(0,s.useCallback)((function(e){A.current=e}),[A]);(0,s.useEffect)((function(){document.addEventListener("click",b,!0),document.addEventListener("keydown",w);var e=window.sfMetadataContext.eventBus.subscribe(dl,S);return function(){document.removeEventListener("click",b,!0),document.removeEventListener("keydown",w),e()}}),[]);var D=(0,s.useCallback)((function(){i(p),o()}),[p,i,o]),k=(0,s.useCallback)((function(e){f(e),n?x(!0):i(e)}),[n,i]),M=(0,s.useCallback)((function(e){e&&e.nativeEvent.stopImmediatePropagation();var t=function(e){var t={};return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).forEach((function(e){var n=e.column_key;n&&(t[n]=!0)})),e.filter((function(e){var n=e.key,r=e.type;return!!Ji.includes(r)&&!t[n]}))}(c);if(Array.isArray(t)&&0!==t.length){var n=function(e){var t=e.find((function(e){return e.type===lo.DATE}))||e.find((function(e){return qa(e)})),n={column_key:null,sort_type:ra};return t&&(n.column_key=t.key,n.count_type=gd(t)),n}(t),r=p.slice(0);r.push(n),k(r)}}),[p,c,k]),j=(0,s.useCallback)((function(e){var t=p.slice(0);t.splice(e,1),k(t)}),[p,k]),I=(0,s.useCallback)((function(e,t){var n=p.slice(0);n[t]=e,k(n)}),[p,k]),_=(0,s.useCallback)((function(e,t){var n=p.slice(0);n.splice(e.idx,1),n.splice(t.idx,0,e.data),k(n)}),[p,k]),P=(0,s.useCallback)((function(){window.sfMetadataContext.eventBus.dispatch(fl)}),[]),N=(0,s.useCallback)((function(){window.sfMetadataContext.eventBus.dispatch(ml)}),[]),T=(0,s.useCallback)((function(e){e.stopPropagation()}),[]);return(0,m.jsx)(Vl.A,{placement:l,isOpen:!0,target:a,fade:!1,hideArrow:!0,className:"sf-metadata-groupbys-popover",boundariesElement:document.body,children:(0,m.jsxs)("div",{ref:C,onClick:T,className:"sf-metadata-groupbys",children:[(0,m.jsx)(Cd,{readOnly:r,groupbys:p,columns:c,onDelete:j,onUpdate:I,onMove:_}),!r&&p.length<3&&(0,m.jsx)(zl.NC,{className:"popover-add-tool",callBack:M,footerName:(0,h.AP)("Add group"),addIconClassName:"popover-add-icon"}),p.length>0&&(0,m.jsxs)("div",{className:"groupbys-tools",children:[(0,m.jsx)("span",{className:"groupbys-tool-item",onClick:P,children:(0,h.AP)("Collapse all")}),(0,m.jsx)("span",{className:"groupbys-tool-item",onClick:N,children:(0,h.AP)("Expand all")})]}),!r&&n&&(0,m.jsxs)("div",{className:"sf-metadata-popover-footer",children:[(0,m.jsx)(O.A,{className:"mr-2",onClick:o,children:(0,h.AP)("Cancel")}),(0,m.jsx)(O.A,{color:"primary",disabled:!y,onClick:D,children:(0,h.AP)("Submit")})]})]})})},wd=(0,ku.Tl)("sfMetadataHiddenColumns",{drop:function(e,t){var n=t.getItem(),r=e.column;if(r.key!==n.key&&n.column.frozen===r.frozen){var o={key:r.key};e.onMove(n.key,o.key)}}},(function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver(),canDrop:t.canDrop(),dragged:t.getItem()}}))((0,ku.I4)("sfMetadataHiddenColumns",{beginDrag:function(e){return{key:e.column.key,column:e.column}},endDrag:function(e,t){var n=t.getItem();if(!t.didDrop())return{source:n,target:{}}},isDragging:function(e){var t=e.columnIndex;return e.currentIndex>t}},(function(e,t){return{connectDragSource:e.dragSource(),connectDragPreview:e.dragPreview(),isDragging:t.isDragging()}}))((function(e){var t=e.isOver,n=e.isDragging,r=e.canDrop,o=e.connectDragSource,i=e.connectDragPreview,a=e.connectDropTarget,l=e.readOnly,c=e.column,u=e.columnIndex,d=e.isHidden,p=e.onChange,h=e.onMouseEnter,f=e.onMouseLeave,g=(0,s.useCallback)((function(){l||p(c.key)}),[l,c,p]);return(0,m.jsx)(m.Fragment,{children:a(i((0,m.jsxs)("div",{className:D()("hide-column-item",{disabled:l,"hide-column-can-drop-top":t&&r&&n,"hide-column-can-drop":t&&r&&!n}),onMouseEnter:function(){return h(u)},onMouseLeave:f,children:[!l&&(0,m.jsx)(m.Fragment,{children:o((0,m.jsx)("div",{className:"drag-hide-column-handle",children:(0,m.jsx)(zl.In,{iconName:"drag"})}))}),(0,m.jsx)(zl.dO,{disabled:l,checked:d,placeholder:(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(zl.In,{iconName:co[c.type]}),(0,m.jsx)("span",{className:"text-truncate",children:c.name})]}),onChange:g,switchClassName:"hide-column-item-switch"})]})))})}))),Sd=(0,ku.Tl)("sfMetadataHiddenColumns",{},(function(e){return{connectDropTarget:e.dropTarget()}}))((function(e){var t=e.readOnly,n=e.columns,r=e.hiddenColumns,o=e.onChange,i=e.modifyColumnOrder,a=(0,s.useState)(-1),l=(0,F.A)(a,2),c=l[0],u=l[1],d=(0,s.useMemo)((function(){return!Array.isArray(n)||0===n.length}),[n]),p=(0,s.useCallback)((function(e){c!==e&&u(e)}),[c]),f=(0,s.useCallback)((function(){u(-1)}),[]);return(0,m.jsxs)("div",{className:D()("hide-columns-list",{"empty-hide-columns-container":d}),children:[d&&(0,m.jsx)("div",{className:"empty-hide-columns-list",children:(0,h.AP)("No properties available to be hidden")}),!d&&n.map((function(e,n){return(0,m.jsx)(wd,{readOnly:t,columnIndex:n,currentIndex:c,isHidden:!r.includes(e.key),column:e,onChange:o,onMove:i,onMouseEnter:p,onMouseLeave:f},e.key)}))]})})),Dd=(0,Mu.A)(Sd),kd=function(e){var t=e.hidePopover,n=e.onChange,r=e.readOnly,o=e.target,i=e.placement,a=e.columns,l=e.hiddenColumns,c=e.modifyColumnOrder,u=(0,s.useState)(""),d=(0,F.A)(u,2),p=d[0],f=d[1],g=(0,s.useState)(l),v=(0,F.A)(g,2),y=v[0],x=v[1],A=(0,s.useMemo)((function(){if(!p)return Array.isArray(a)?a:[];var e=p.trim().toLocaleLowerCase();return a.filter((function(t){return t.name.toLocaleLowerCase().indexOf(e)>-1}))}),[p,a]),C=(0,s.useRef)(null),b=(0,s.useCallback)((function(e){if(C.current&&!Ql(e).includes("popover")&&!C.current.contains(e.target))return t(e),e.preventDefault(),e.stopPropagation(),!1}),[t]),w=(0,s.useCallback)((function(e){(0,ma.default)("esc",e)&&(e.preventDefault(),t())}),[t]);(0,s.useEffect)((function(){return document.addEventListener("click",b,!0),document.addEventListener("keydown",w),function(){document.removeEventListener("click",b,!0),document.removeEventListener("keydown",w)}}),[]);var S=(0,s.useCallback)((function(e){e.stopPropagation()}),[]),D=(0,s.useCallback)((function(e){e.keyCode!==so().ChineseInputMethod&&e.keyCode!==so().Enter&&e.keyCode!==so().LeftArrow&&e.keyCode!==so().RightArrow||e.stopPropagation()}),[]),k=(0,s.useCallback)((function(e){p!==e&&f(e)}),[p]),M=(0,s.useCallback)((function(e){x(e),n(e)}),[n]),j=(0,s.useCallback)((function(e){var t=y.slice(0),n=t.indexOf(e);n>-1?t.splice(n,1):t.push(e),M(t)}),[y,M]),I=(0,s.useCallback)((function(){M(A.map((function(e){return e.key})))}),[A,M]),_=(0,s.useCallback)((function(){M([])}),[M]);return(0,m.jsx)(Vl.A,{placement:i,isOpen:!0,target:o,fade:!1,hideArrow:!0,className:"sf-metadata-hide-columns-popover",boundariesElement:document.body,children:(0,m.jsxs)("div",{ref:C,onClick:S,className:"sf-metadata-hide-columns-container",style:{maxHeight:window.innerHeight-100},children:[(0,m.jsx)("div",{className:"sf-metadata-hide-columns-search-container",children:(0,m.jsx)(zl.DO,{placeholder:(0,h.AP)("Search property"),onKeyDown:D,onChange:k,autoFocus:!0})}),(0,m.jsx)(Dd,{readOnly:r,columns:A,hiddenColumns:y,onChange:j,modifyColumnOrder:c}),!r&&!p&&(0,m.jsxs)("div",{className:"sf-metadata-hide-columns-operations",children:[(0,m.jsx)("div",{className:"sf-metadata-hide-columns-operation px-2",onClick:I,"aria-label":(0,h.AP)("Hide all"),children:(0,h.AP)("Hide all")}),(0,m.jsx)("div",{className:"sf-metadata-hide-columns-operation px-2",onClick:_,"aria-label":(0,h.AP)("Show all"),children:(0,h.AP)("Show all")})]})]})})},Md=function(e){var t=e.readOnly,n=e.columns,r=e.wrapperClass,o=e.filters,i=e.isNeedSubmit,a=e.isPre,l=e.collaborators,c=e.filtersClassName,u=e.target,d=e.filterConjunction,p=e.basicFilters,f=e.modifyFilters,g=(0,s.useState)(!1),v=(0,F.A)(g,2),y=v[0],x=v[1],A=(0,s.useMemo)((function(){return Gl()(vs(o||[],n))}),[o,n]),C=(0,s.useMemo)((function(){return A.length+p.length}),[A,p]),b=(0,s.useMemo)((function(){return 1===C?i?(0,h.AP)("1 preset filter"):(0,h.AP)("1 filter"):C>1?C+" "+(i?(0,h.AP)("Preset filters"):(0,h.AP)("Filters")):i?(0,h.AP)("Preset filter"):(0,h.AP)("Filter")}),[i,C]),w=(0,s.useCallback)((function(){x(!y)}),[y]),S=(0,s.useCallback)((function(e){e.stopPropagation(),(ya(e)||va(e))&&w()}),[w]),k=(0,s.useCallback)((function(e){var t=e||{},r=t.filters,o=t.filter_conjunction,i=t.basic_filters,a=vs(r,n);f(a,o,i)}),[n,f]);if(!n)return null;var M=D()(r,{active:C>0});return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(zl.Oi,{iconName:"filter",size:24,className:M,onClick:w,role:"button",onKeyDown:S,title:b,"aria-label":b,tabIndex:0,id:u}),y&&(0,m.jsx)(ad,{placement:"bottom-end",filtersClassName:c,target:u,readOnly:t,isNeedSubmit:i,columns:n,collaborators:l,filterConjunction:d,filters:A,basicFilters:p,hidePopover:w,update:k,isPre:a})]})};Md.defaultProps={target:"sf-metadata-filter-popover",isNeedSubmit:!1,basicFilters:[]};var jd=Md,Id=function(e){var t=e.target,n=e.sorts,r=e.readOnly,o=e.columns,i=e.isNeedSubmit,a=e.wrapperClass,l=e.modifySorts,c=(0,s.useState)(!1),u=(0,F.A)(c,2),d=u[0],p=u[1],f=(0,s.useMemo)((function(){return Ts(n||[],o)}),[n,o]),g=(0,s.useMemo)((function(){var e=f.length;return 1===e?i?(0,h.AP)("1 preset sort"):(0,h.AP)("1 sort"):e>1?e+" "+(i?(0,h.AP)("preset sorts"):(0,h.AP)("sorts")):i?(0,h.AP)("Preset sort"):(0,h.AP)("Sort")}),[i,f]),v=(0,s.useCallback)((function(){p(!d)}),[d]),y=(0,s.useCallback)((function(e){e.stopPropagation(),(ya(e)||va(e))&&v()}),[v]),x=(0,s.useCallback)((function(e){var t=(e||{}).sorts;l(t)}),[l]);if(!o)return null;var A=D()(a,{active:f.length>0});return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(zl.Oi,{iconName:"sort",size:24,className:A,onClick:v,role:"button",onKeyDown:y,title:g,"aria-label":g,tabIndex:0,id:t}),d&&(0,m.jsx)(fd,{isNeedSubmit:i,readOnly:r,target:t,columns:o,sorts:f,onSortComponentToggle:v,update:x})]})};Id.defaultProps={target:"sf-metadata-sort-popover",isNeedSubmit:!1};var _d=Id,Pd=function(e){var t=e.columns,n=e.readOnly,r=e.isNeedSubmit,o=e.groupbys,i=e.wrapperClass,a=e.target,l=e.modifyGroupbys,c=(0,s.useState)(!1),u=(0,F.A)(c,2),d=u[0],p=u[1],f=(0,s.useMemo)((function(){return t.filter((function(e){return Ji.includes(e.type)}))}),[t]),g=(0,s.useMemo)((function(){return ws(o,f)||[]}),[f,o]),v=(0,s.useMemo)((function(){var e=g?g.length:0;return 1===e?(0,h.AP)("Grouped by 1 property"):e>1?(0,h.AP)("Grouped by xxx properties").replace("xxx",e):(0,h.AP)("Group by")}),[g]),y=(0,s.useCallback)((function(){p(!d)}),[d]),x=(0,s.useCallback)((function(e){e.stopPropagation(),(ya(e)||va(e))&&y()}),[y]),A=(0,s.useCallback)((function(e){var t=ws(e,f);l(t)}),[f,l]),C=D()(i,{active:g.length>0});return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(zl.Oi,{iconName:"group",size:24,className:C,onClick:y,role:"button",onKeyDown:x,title:v,"aria-label":v,tabIndex:0,id:a}),d&&(0,m.jsx)(bd,{isNeedSubmit:r,readOnly:n,groupbys:g,target:a,placement:"bottom-end",columns:f,hidePopover:y,onChange:A})]})};Pd.defaultProps={target:"sf-metadata-groupby-popover",isNeedSubmit:!1};var Nd=Pd,Od=(s.Component,function(e){var t=e.readOnly,n=e.columns,r=e.wrapperClass,o=e.target,i=e.hiddenColumns,a=e.modifyHiddenColumns,l=e.modifyColumnOrder,c=(0,s.useState)(!1),u=(0,F.A)(c,2),d=u[0],p=u[1],f=(0,s.useMemo)((function(){return i.filter((function(e){return n.find((function(t){return t.key===e}))}))}),[n,i]),g=(0,s.useMemo)((function(){var e=f.length;return 1===e?(0,h.AP)("1 hidden property"):e>1?(0,h.AP)("xxx hidden properties").replace("xxx",e):(0,h.AP)("Hide properties")}),[f]),v=(0,s.useCallback)((function(){p(!d)}),[d]),y=(0,s.useCallback)((function(e){e.stopPropagation(),(ya(e)||va(e))&&v()}),[v]),x=(0,s.useCallback)((function(e){a(e)}),[a]),A=D()(r,{active:f.length>0});return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(zl.Oi,{iconName:"hide",size:24,className:A,onClick:v,role:"button",onKeyDown:y,title:g,"aria-label":g,tabIndex:0,id:o}),d&&(0,m.jsx)(kd,{readOnly:t,hiddenColumns:f,target:o,placement:"bottom-end",columns:n,hidePopover:v,onChange:x,modifyColumnOrder:l})]})}),Td=function(e){var t=e.viewId,n=(0,s.useState)(null),r=(0,F.A)(n,2),o=r[0],i=r[1],a=(0,s.useState)([]),l=(0,F.A)(a,2),c=l[0],u=l[1],d=(0,s.useMemo)((function(){return o?o.columns:[]}),[o]),p=(0,s.useCallback)((function(){window.sfMetadataContext.eventBus.dispatch(sl)}),[]),h=(0,s.useCallback)((function(e,t,n){window.sfMetadataContext.eventBus.dispatch(vl,e,t,n)}),[]),f=(0,s.useCallback)((function(e){window.sfMetadataContext.eventBus.dispatch(yl,e)}),[]),g=(0,s.useCallback)((function(e){window.sfMetadataContext.eventBus.dispatch(xl,e)}),[]),v=(0,s.useCallback)((function(e){window.sfMetadataContext.eventBus.dispatch(Al,e)}),[]),y=(0,s.useCallback)((function(e,t){window.sfMetadataContext.eventBus.dispatch(bl,e,t)}),[]),x=(0,s.useCallback)((function(e){i(e)}),[]);if((0,s.useEffect)((function(){var e,t=setInterval((function(){var n;window.sfMetadataContext&&window.sfMetadataStore.data&&(t&&clearInterval(t),t=null,i(window.sfMetadataStore.data.view),u((null===(n=window.sfMetadataStore)||void 0===n?void 0:n.collaborators)||[]),e=window.sfMetadataContext.eventBus.subscribe(Cl,x))}),300);return function(){t&&clearInterval(t),e&&e()}}),[t]),!o)return null;var A=!window.sfMetadataContext.canModifyView(o);return(0,m.jsxs)("div",{className:"sf-metadata-tool",onClick:p,children:[(0,m.jsxs)("div",{className:"sf-metadata-tool-left-operations",children:["image"===o.type&&(0,m.jsx)(ql,{}),(0,m.jsx)(jd,{isNeedSubmit:!0,wrapperClass:"sf-metadata-view-tool-operation-btn sf-metadata-view-tool-filter",filtersClassName:"sf-metadata-filters",target:"sf-metadata-filter-popover",readOnly:A,filterConjunction:o.filter_conjunction,basicFilters:o.basic_filters,filters:o.filters,columns:d,modifyFilters:h,collaborators:c}),(0,m.jsx)(_d,{isNeedSubmit:!0,wrapperClass:"sf-metadata-view-tool-operation-btn sf-metadata-view-tool-sort",target:"sf-metadata-sort-popover",readOnly:A,sorts:o.sorts,columns:d,modifySorts:f}),"image"!==o.type&&(0,m.jsx)(Nd,{isNeedSubmit:!0,wrapperClass:"sf-metadata-view-tool-operation-btn sf-metadata-view-tool-groupby",target:"sf-metadata-groupby-popover",readOnly:A,columns:d,groupbys:o.groupbys,modifyGroupbys:g}),"image"!==o.type&&(0,m.jsx)(Od,{wrapperClass:"sf-metadata-view-tool-operation-btn sf-metadata-view-tool-hide-column",target:"sf-metadata-hide-column-popover",readOnly:A,columns:d.slice(1),hiddenColumns:o.hidden_columns||[],modifyHiddenColumns:v,modifyColumnOrder:y})]}),(0,m.jsx)("div",{className:"sf-metadata-tool-right-operations"})]})},Ed=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).toggleDropdownMenu=function(){n.setState({isDropdownMenuOpen:!n.state.isDropdownMenuOpen})},n.hidePopover=function(e){if(e)for(var t=e.target;t;){if("string"===typeof t.className&&t.className.includes("tag-color-popover"))return;t=t.parentNode}n.setState({isRepoTagDialogOpen:!1})},n.toggleCancel=function(){n.setState({isRepoTagDialogOpen:!1})},n.getMenu=function(){var e=[],t=n.props,r=t.userPerm,o=t.currentPath;if("rw"!==r||f.Aq.isMarkdownFile(o))return e;var i=Dr.A.TAGS;return h.DX&&e.push(i),e},n.onMenuItemClick=function(e){if("Tags"===e.key)n.setState({isRepoTagDialogOpen:!n.state.isRepoTagDialogOpen})},n.onMenuItemKeyDown=function(e,t){"Enter"!=e.key&&"Space"!=e.key||n.onMenuItemClick(t)},n.onSelectSortOption=function(e){var t=e.value.split("-"),r=(0,F.A)(t,2),o=r[0],i=r[1];n.props.sortItems(o,i)},n.state={isRepoTagDialogOpen:!1,isDropdownMenuOpen:!1},n.sortOptions=[{value:"name-asc",text:(0,h.AP)("By name ascending")},{value:"name-desc",text:(0,h.AP)("By name descending")},{value:"time-asc",text:(0,h.AP)("By time ascending")},{value:"time-desc",text:(0,h.AP)("By time descending")}],n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.getMenu(),n=this.state.isDropdownMenuOpen,r=this.props,o=r.repoID,i=r.currentMode,a=r.currentPath,l=r.sortBy,c=r.sortOrder,u=r.viewId,d=Dr.A.PROPERTIES.value,p=a.startsWith("/"+R.AT.FILE_EXTENDED_PROPERTIES+"/"),f=this.sortOptions.map((function(e){return(0,Sr.A)((0,Sr.A)({},e),{},{isSelected:e.value==="".concat(l,"-").concat(c)})}));return p?(0,m.jsx)("div",{className:"dir-tool",children:(0,m.jsx)(Td,{viewId:u})}):(0,m.jsxs)(s.Fragment,{children:[(0,m.jsxs)("div",{className:"dir-tool d-flex",children:[(0,m.jsx)(eo,{currentViewMode:i,switchViewMode:this.props.switchViewMode}),(0,m.jsx)(no,{sortOptions:f,onSelectSortOption:this.onSelectSortOption}),!this.props.isCustomPermission&&(0,m.jsx)("div",{className:"cur-view-path-btn",onClick:function(){return e.props.switchViewMode("detail")},children:(0,m.jsx)("span",{className:"sf3-font sf3-font-info","aria-label":d,title:d})}),t.length>0&&(0,m.jsxs)(de.A,{isOpen:n,toggle:this.toggleDropdownMenu,children:[(0,m.jsx)(pe.A,{tag:"i",id:"cur-folder-more-op-toggle",className:"cur-view-path-btn sf3-font-more sf3-font","data-toggle":"dropdown",title:(0,h.AP)("More operations"),"aria-label":(0,h.AP)("More operations"),"aria-expanded":n}),(0,m.jsx)(Ue.A,{right:!0,children:t.map((function(t,n){return"Divider"===t?(0,m.jsx)(he.A,{divider:!0},n):(0,m.jsx)(he.A,{onClick:e.onMenuItemClick.bind(e,t),onKeyDown:e.onMenuItemKeyDown.bind(e,t),children:t.value},n)}))})]})]}),this.state.isRepoTagDialogOpen&&(0,m.jsx)(kr.A,{popoverClassName:"list-tag-popover",target:"cur-folder-more-op-toggle",hideSeahubPopover:this.hidePopover,hideSeahubPopoverWithEsc:this.hidePopover,canHideSeahubPopover:!0,boundariesElement:document.body,placement:"bottom-end",children:(0,m.jsx)(Jr,{repoID:o,onListTagCancel:this.toggleCancel})})]})}}])}(s.Component),Rd=function(e){var t=e.children,n=e.className,r=(0,s.useState)(300),o=(0,F.A)(r,2),i=o[0],a=o[1],l=(0,s.useState)(!1),c=(0,F.A)(l,2),u=c[0],d=c[1],p=(0,s.useRef)(null),h=(0,s.useRef)(null),f=(0,s.useCallback)((function(e){var t=Math.max(Math.min(window.innerWidth-e.clientX,600),300);i!==t&&(localStorage.setItem("sf_cur_view_detail_width",t),a(t))}),[i]),g=(0,s.useCallback)((function(){window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",g),u&&d(!1)}),[u,f]),v=(0,s.useCallback)((function(){window.addEventListener("mouseup",g),window.addEventListener("mousemove",f),d(!0)}),[g,f]),y=(0,s.useCallback)((function(e){h.current.style.top=e+"px"}),[]),x=(0,s.useCallback)((function(e){if(h.current){var t=p.current.getBoundingClientRect().top,n=e.pageY-t-13;y(n)}}),[y]);return(0,s.useEffect)((function(){var e=localStorage.getItem("sf_cur_view_detail_width"),t=e?parseInt(e):300;a(t)}),[]),(0,m.jsxs)("div",{className:D()("cur-view-detail",n,{"cur-view-detail-small":i<400,"cur-view-detail-large":i>400}),style:{width:i},children:[t,(0,m.jsx)(G,{resizeBarRef:p,dragHandlerRef:h,resizeBarStyle:{left:-1},dragHandlerStyle:{height:z},onResizeMouseDown:v,onResizeMouseOver:x})]})},Ld=n(7439),Fd=function(e){var t=e.className,n=e.children;return(0,m.jsx)("div",{className:D()("detail-body dirent-info",t),children:n})},Ud=function(e){var t=e.readonly,n=e.field,r=e.className,o=e.children,i=(0,s.useMemo)((function(){return"size"===n.type?co[lo.NUMBER]:co[n.type]}),[n]);return(0,m.jsxs)("div",{className:D()("dirent-detail-item",r),children:[(0,m.jsxs)("div",{className:"dirent-detail-item-name",children:[(0,m.jsx)(zl.In,{iconName:i}),(0,m.jsx)("span",{className:"dirent-detail-item-name-value",children:n.name})]}),(0,m.jsx)("div",{className:D()("dirent-detail-item-value",{editable:!t}),children:o})]})};Ud.defaultProps={readonly:!0};var Bd=Ud,Yd=s.memo((function(e){var t=e.currentRepoInfo,n=e.onClose,r=(0,s.useState)(!0),o=(0,F.A)(r,2),i=o[0],a=o[1],l=(0,s.useState)({}),c=(0,F.A)(l,2),u=c[0],d=c[1],p=(0,s.useMemo)((function(){return f.Aq.getLibIconUrl(t)}),[t]),g=(0,s.useMemo)((function(){return{type:lo.NUMBER,name:(0,h.AP)("Files")}}),[]),v=(0,s.useMemo)((function(){return{type:"size",name:(0,h.AP)("Size")}}),[]),y=(0,s.useMemo)((function(){return{type:lo.CREATOR,name:(0,h.AP)("Creator")}}),[]),x=(0,s.useMemo)((function(){return{type:lo.MTIME,name:(0,h.AP)("Last modified time")}}),[]);return(0,s.useEffect)((function(){a(!0),k.e.getRepoInfo(t.repo_id).then((function(e){var t=new Xe(e.data);d(t),a(!1)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))}),[t.repo_id]),(0,m.jsxs)(Rd,{children:[(0,m.jsx)(Ld.A,{title:t.repo_name,icon:p,onClose:n}),(0,m.jsx)(Fd,{children:i?(0,m.jsx)("div",{className:"w-100 h-100 d-flex algin-items-center justify-content-center",children:(0,m.jsx)($.A,{})}):(0,m.jsxs)("div",{className:"detail-content",children:[(0,m.jsx)(Bd,{field:g,value:u.file_count||0,className:"sf-metadata-property-detail-formatter",children:(0,m.jsx)(zl.ZA,{field:g,value:u.file_count||0})}),(0,m.jsx)(Bd,{field:v,value:u.size,className:"sf-metadata-property-detail-formatter",children:(0,m.jsx)(zl.ZA,{field:v,value:u.size})}),(0,m.jsx)(Bd,{field:y,className:"sf-metadata-property-detail-formatter",children:(0,m.jsx)(zl.ZA,{field:y,value:u.owner_email,collaborators:[{name:u.owner_name,contact_email:u.owner_contact_email,email:u.owner_email,avatar_url:u.owner_avatar}]})}),(0,m.jsx)(Bd,{field:x,className:"sf-metadata-property-detail-formatter",children:(0,m.jsx)(zl.ZA,{field:x,value:u.last_modified})})]})})]})}),(function(e,t){return e.currentRepo.repo_id===t.currentRepo.repo_id})),qd=function(e,t){return f.Aq.isMarkdownFile(t)?t:f.Aq.joinPath(t,e.name)};var Hd=function(e){function t(){var e;(0,r.A)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=(0,i.A)(this,t,[].concat(o))).cleanUp=function(){window.removeEventListener("mouseup",e.onMouseUp),window.removeEventListener("mousemove",e.onMouseMove),window.removeEventListener("touchend",e.onMouseUp),window.removeEventListener("touchmove",e.onMouseMove)},e.onMouseDown=function(t){t.preventDefault&&t.preventDefault(),window.addEventListener("mouseup",e.onMouseUp),window.addEventListener("mousemove",e.onMouseMove),window.addEventListener("touchend",e.onMouseUp),window.addEventListener("touchmove",e.onMouseMove)},e.onMouseUp=function(t){e.props.onDragEnd&&e.props.onDragEnd(t),e.cleanUp()},e.onMouseMove=function(t){t.preventDefault&&t.preventDefault(),function(){var e=null}(e.props.onDrag(t))},e}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentWillUnmount",value:function(){this.cleanUp()}},{key:"render",value:function(){return(0,m.jsx)("div",{className:"record-HeaderCell__draggable",onClick:function(e){return e.stopPropagation()},onDrag:this.props.onDrag,onMouseDown:this.onMouseDown,onTouchStart:this.onMouseDown})}}])}(s.Component),Gd=Hd,zd=function(e){var t=e.disabled,n=e.iconName,r=e.target,o=e.title,i=e.tip,a=e.className,l=e.onChange,c=e.onMouseEnter,u=(0,s.useState)(!1),d=(0,F.A)(u,2),p=d[0],h=d[1];(0,s.useEffect)((function(){t&&h(!0)}),[]);var f=(0,s.useCallback)((function(e){e.preventDefault(),e.nativeEvent.stopImmediatePropagation(),e.stopPropagation()}),[]);return t?(0,m.jsx)(m.Fragment,{children:(0,m.jsxs)(he.A,{className:D()("disabled",a),toggle:!0,onClick:f,onMouseEnter:c,id:r,children:[(0,m.jsx)(zl.In,{iconName:n}),(0,m.jsx)("span",{className:"item-text",children:o}),p&&(0,m.jsx)(Qe.A,{placement:"right",target:r,fade:!1,delay:{show:0,hide:0},children:i})]})}):(0,m.jsxs)(he.A,{id:r,onClick:l,onMouseEnter:c,className:a,children:[(0,m.jsx)(zl.In,{iconName:n}),(0,m.jsx)("span",{className:"item-text",children:o})]})};zd.defaultProps={onChange:function(){},onMouseEnter:function(){},disabled:!1,className:""};var Vd=zd,Wd=function(e){var t=e.column,n=e.renameColumn,r=e.modifyColumnData,o=e.deleteColumn,i=(0,s.createRef)(),a=(0,s.createRef)(),l=(0,s.useState)(!1),c=(0,F.A)(l,2),u=c[0],d=c[1],p=(0,s.useState)(!1),f=(0,F.A)(p,2),g=f[0],v=f[1],y=(0,s.useState)(!1),x=(0,F.A)(y,2),A=x[0],C=x[1],b=(0,s.useState)(!1),w=(0,F.A)(b,2),S=w[0],k=w[1],M=(0,s.useMemo)((function(){var e=new Date,t=e.getFullYear(),n=e.getMonth()+1,r=e.getDate(),o=e.getHours(),i=e.getMinutes();return n=n>9?n:"0".concat(n),r=r>9?r:"0".concat(r),o=o>9?o:"0".concat(o),i=i>9?i:"0".concat(i),"".concat(t,"-").concat(n,"-").concat(r," ").concat(o,":").concat(i)}),[]),j=(0,s.useCallback)((function(e){e&&e.preventDefault(),e&&e.stopPropagation();var t=e.target;"string"===t.className&&t.className.includes("disabled")||d(!u)}),[u]),I=(0,s.useCallback)((function(){v(!0)}),[]),_=(0,s.useCallback)((function(){v(!1)}),[]),P=(0,s.useCallback)((function(){k(!0)}),[]),N=(0,s.useCallback)((function(){k(!1)}),[]),O=(0,s.useCallback)((function(e){var n=t.data||{};d(!1),r(t.key,{options:e},{options:n.options||[]})}),[t,r]),T=(0,s.useCallback)((function(e,n){e&&e.stopPropagation();var o=t.data?t.data.format:"";v(!1),d(!1),o!==n&&r(t.key,{format:n},{format:o})}),[t,r]),E=(0,s.useCallback)((function(){o(t.key,t)}),[t,o]),R=(0,s.useCallback)((function(){C(!0)}),[]),L=(0,s.useCallback)((function(){C(!1)}),[]),U=(0,s.useCallback)((function(e){e!==t.name?(n(t.key,e,t.name),C(!1)):C(!1)}),[t,n]),B=(0,s.useCallback)((function(e){if(!e)return(0,m.jsx)(Vd,{disabled:!0,target:"sf-metadata-edit-column-format",title:(0,h.AP)("Edit format settings"),tip:(0,h.AP)("You do not have permission"),iconName:"set-up"});var n=t.data,r=(void 0===n?{}:n).format,o=(void 0===r?fo:r).indexOf("HH:mm")>-1,i=[{label:"".concat((0,h.AP)("ISO")," (").concat(Da(M,D()("YYYY-MM-DD",{"HH:mm":o})),")"),value:D()("YYYY-MM-DD",{"HH:mm":o})},{label:"".concat((0,h.AP)("US")," (").concat(Da(M,D()("M/D/YYYY",{"HH:mm":o})),")"),value:D()("M/D/YYYY",{"HH:mm":o})},{label:"".concat((0,h.AP)("European")," (").concat(Da(M,D()("DD/MM/YYYY",{"HH:mm":o})),")"),value:D()("DD/MM/YYYY",{"HH:mm":o})},{label:"".concat((0,h.AP)("Germany Russia etc")," (").concat(Da(M,D()("DD.MM.YYYY",{"HH:mm":o})),")"),value:D()("DD.MM.YYYY",{"HH:mm":o})}];return(0,m.jsxs)(de.A,{className:"sf-metadata-dropdown-menu w-100",isOpen:g,direction:"right",children:[(0,m.jsxs)(pe.A,{tag:"span",role:"button","data-toggle":"dropdown","aria-expanded":u,className:"dropdown-item sf-metadata-column-dropdown-item d-flex align-items-center",onMouseOver:I,disabled:!0,caret:!0,children:[(0,m.jsx)(zl.In,{iconName:"set-up"}),(0,m.jsx)("span",{className:"item-text",children:(0,h.AP)("Edit format settings")})]}),(0,m.jsx)(Ue.A,{style:{marginLeft:"-16px",transform:"none"},children:i.map((function(e){return(0,m.jsx)(he.A,{className:"sf-metadata-column-dropdown-item",toggle:!1,onClick:function(t){return T(t,e.value)},children:(0,m.jsx)("span",{children:e.label})},e.value)}))})]})}),[M,t,u,g,T,I]),Y=(0,s.useCallback)((function(){var e=t.type,n=window.sfMetadataContext.canModifyColumnData(t),r=window.sfMetadataContext.canDeleteColumn(t),o=window.sfMetadataContext.canRenameColumn(t);return(0,m.jsx)(Ue.A,{ref:i,className:"sf-metadata-column-dropdown-menu",children:(0,m.jsxs)("div",{ref:a,children:[e===lo.SINGLE_SELECT&&(0,m.jsx)(m.Fragment,{children:(0,m.jsx)(Vd,{disabled:!n,target:"sf-metadata-edit-column-options",iconName:"single-select",title:(0,h.AP)("Edit single select"),tip:(0,h.AP)("You do not have permission"),onChange:P})}),e===lo.MULTIPLE_SELECT&&(0,m.jsx)(Vd,{disabled:!n,target:"sf-metadata-edit-column-options",iconName:"multiple-select",title:(0,h.AP)("Edit multiple select"),tip:(0,h.AP)("You do not have permission"),onChange:P}),e===lo.NUMBER&&(0,m.jsx)(Vd,{disabled:!n,target:"sf-metadata-edit-column-format",iconName:"set-up",title:(0,h.AP)("Edit format settings"),tip:(0,h.AP)("You do not have permission"),onChange:P}),e===lo.DATE&&(0,m.jsx)(m.Fragment,{children:B(n)}),[lo.DATE,lo.SINGLE_SELECT,lo.NUMBER,lo.MULTIPLE_SELECT].includes(t.type)&&(0,m.jsx)(he.A,{divider:!0},"divider-item"),(0,m.jsx)(Vd,{disabled:!o,target:"sf-metadata-rename-column",iconName:"rename",title:(0,h.AP)("Rename property"),tip:(0,h.AP)("You do not have permission"),onChange:R,onMouseEnter:_}),(0,m.jsx)(Vd,{disabled:!r,target:"sf-metadata-delete-column",iconName:"delete",title:(0,h.AP)("Delete property"),tip:(0,h.AP)("You do not have permission"),onChange:E,onMouseEnter:_})]})})}),[t,R,_,B,P,i,a,E]);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(de.A,{className:"sf-metadata-dropdown-menu",isOpen:u,toggle:j,children:[(0,m.jsx)(pe.A,{tag:"span",role:"button","data-toggle":"dropdown","aria-expanded":u,title:(0,h.AP)("More operations"),"aria-label":(0,h.AP)("More operations"),tabIndex:0,children:(0,m.jsx)(zl.In,{iconName:"drop-down"})}),u&&!ec&&(0,m.jsx)(zl.Q$,{children:(0,m.jsx)("div",{className:"sf-metadata-dropdown-menu large",children:Y()})})]}),A&&(0,m.jsx)(zl.Q$,{children:(0,m.jsx)(Su,{target:"sf-metadata-column-".concat(t.key),value:t.name,onToggle:L,onSubmit:U})}),S&&(0,m.jsx)(zl.Q$,{children:(0,m.jsx)(Eu,{target:"sf-metadata-column-".concat(t.key),column:t,onToggle:N,onSubmit:O})})]})},Kd={hover:function(e,t,n){var r;if(window.sfMetadataBody){var o=t.getClientOffset().x,i=null===(r=document.querySelector(".sf-metadata-wrapper"))||void 0===r?void 0:r.clientWidth,a=window.innerWidth-i;o>i-200?window.sfMetadataBody.scrollToRight():o<e.frozenColumnsWidth+200+a?window.sfMetadataBody.scrollToLeft():window.sfMetadataBody.clearHorizontalScroll()}},drop:function(e,t){var n=t.getItem(),r=e.column;if(r.key!==n.key&&n.column.frozen===r.frozen){var o={key:r.key};e.onMove(n,o),window.sfMetadataBody.clearHorizontalScroll()}}},Xd=function(e){var t=e.isOver,n=e.isDragging,r=e.canDrop,o=e.connectDragSource,i=e.connectDragPreview,a=e.connectDropTarget,l=e.frozen,c=e.groupOffsetLeft,u=e.isLastFrozenCell,d=e.height,p=e.isHideTriangle,f=e.column,g=e.style,v=e.renameColumn,y=e.deleteColumn,x=e.modifyColumnData,A=e.modifyLocalColumnWidth,C=e.modifyColumnWidth,b=(0,s.useRef)(null),w=(0,s.useMemo)((function(){return!p&&window.sfMetadataContext.canModifyColumn(f)}),[p,f]),S=(0,s.useMemo)((function(){var e=f.left,t=f.width,n=Object.assign({width:t,maxWidth:t,minWidth:t,height:d},g);return l||(n.left=e+c),n}),[l,c,f,d,g]),k=(0,s.useCallback)((function(e){var t=e.pageX||e.touches&&e.touches[0]&&e.touches[0].pageX||e.changedTouches&&e.changedTouches[e.changedTouches.length-1].pageX;return 0===e.pageX&&(t=0),t-b.current.getBoundingClientRect().left}),[]),M=(0,s.useCallback)((function(e){var t=k(e);t>0&&A(f,t)}),[f,k,A]),j=(0,s.useCallback)((function(e){var t=k(e);t>0&&C(f,Math.max(t,50))}),[f,k,C]),I=(0,s.useCallback)((function(e){window.sfMetadataContext.eventBus.dispatch(pl,e)}),[]),_=(0,s.useCallback)((function(e){e.preventDefault(),e.stopPropagation()}),[]),P=f.key,N=f.name,O=f.type,T=uo[O],E=window.sfMetadataContext.canModifyColumnOrder(),R=(0,m.jsxs)("div",{className:D()("sf-metadata-result-table-cell column",{"table-last--frozen":u}),ref:b,style:S,id:"sf-metadata-column-".concat(P),onClick:function(){return I(f,l)},onContextMenu:_,children:[(0,m.jsxs)("div",{className:"sf-metadata-result-column-content sf-metadata-record-header-cell-left d-flex align-items-center text-truncate",children:[(0,m.jsx)("span",{className:"mr-2",id:"header-icon-".concat(P),children:(0,m.jsx)(zl.In,{iconName:co[O],className:"sf-metadata-column-icon"})}),(0,m.jsx)(Qe.A,{placement:"bottom",target:"header-icon-".concat(P),fade:!1,trigger:"hover",children:(0,h.AP)(T)}),(0,m.jsx)("div",{className:"header-name d-flex",children:(0,m.jsx)("span",{title:N,className:D()("header-name-text",{double:56===d}),children:N})})]}),w&&(0,m.jsx)(Wd,{column:f,renameColumn:v,deleteColumn:y,modifyColumnData:x}),(0,m.jsx)(Gd,{onDrag:M,onDragEnd:j})]});return E&&f.key!==Lo?(0,m.jsx)("div",{className:"sf-metadata-record-header-cell",children:a(i(o((0,m.jsx)("div",{style:{opacity:n?.2:1},className:D()("rdg-can-drop",{"rdg-dropping":t&&r}),children:R}))))},P):(0,m.jsx)("div",{className:"sf-metadata-record-header-cell",children:R},P)};Xd.defaultProps={style:null};var $d=(0,ku.Tl)("sfMetadataRecordHeaderCell",Kd,(function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver(),canDrop:t.canDrop(),dragged:t.getItem()}}))((0,ku.I4)("sfMetadataRecordHeaderCell",{beginDrag:function(e){return{key:e.column.key,column:e.column}},endDrag:function(e,t){var n=t.getItem();if(!t.didDrop())return{source:n,target:{}}},isDragging:function(e){var t=e.column;return e.dragged.key===t.key}},(function(e,t){return{connectDragSource:e.dragSource(),connectDragPreview:e.dragPreview(),isDragging:t.isDragging()}}))(Xd)),Zd=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onToggleSelectAll=function(e){var t=n.props,r=t.isMobile,o=t.hasSelectedRecord,i=n.state.isSelectedAll;if(r&&e.preventDefault(),o||i)return n.setState({isSelectedAll:!1}),void n.props.selectNoneRecords();n.setState({isSelectedAll:!0}),n.props.selectAllRecords()},n.state={isSelectedAll:e.isSelectedAll},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props.isSelectedAll;t!==e.isSelectedAll&&this.setState({isSelectedAll:t})}},{key:"render",value:function(){var e=this.props,t=e.isMobile,n=e.hasSelectedRecord,r=this.state.isSelectedAll,o=n&&!r;return(0,m.jsxs)("div",{className:"select-all-checkbox-container",onClick:this.onToggleSelectAll,children:[t?(0,m.jsx)("label",{className:"mobile-select-all-container",children:o?(0,m.jsx)(zl.In,{iconName:"partially-selected"}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("input",{className:"mobile-select-all-checkbox",name:"mobile-select-all-checkbox",type:"checkbox",checked:r,readOnly:!0}),(0,m.jsx)("div",{className:"select-all-checkbox-show"})]})}):(0,m.jsx)(m.Fragment,{children:o?(0,m.jsx)(zl.In,{iconName:"partially-selected"}):(0,m.jsx)("input",{id:"select-all-checkbox",className:"select-all-checkbox",type:"checkbox",name:(0,h.AP)("Select all"),title:(0,h.AP)("Select all"),"aria-label":(0,h.AP)("Select all"),checked:r,readOnly:!0})}),(0,m.jsx)("label",{htmlFor:"select-all-checkbox",name:(0,h.AP)("Select all"),title:(0,h.AP)("Select all"),"aria-label":(0,h.AP)("Select all")})]})}}])}(s.Component),Jd=Zd,Qd=function(e){function t(){return(0,r.A)(this,t),(0,i.A)(this,t,arguments)}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.isMobile,n=e.hasSelectedRecord,r=e.isSelectedAll,o=e.isLastFrozenCell,i=e.groupOffsetLeft,a={height:e.height,width:Ml+i,minWidth:Ml+i};return(0,m.jsx)("div",{className:D()("sf-metadata-result-table-cell column",{"table-last--frozen":o}),style:(0,Sr.A)((0,Sr.A)({},a),{},{backgroundColor:"#f9f9f9"}),children:(0,m.jsx)(Jd,{isMobile:t,hasSelectedRecord:n,isSelectedAll:r,selectNoneRecords:this.props.selectNoneRecords,selectAllRecords:this.props.selectAllRecords})})}}])}(s.Component),ep=Qd,tp=function(e){return e.filter((function(e){return e.frozen}))},np=function(e){var t=e.lastColumn,n=e.height,r=e.groupOffsetLeft,o=(0,s.useMemo)((function(){return"sf-metadata-add-column"}),[]),i=(0,s.useRef)(null),a=(0,s.useMemo)((function(){return{height:n,width:44,minWidth:44,maxWidth:44,left:t.left+t.width+r,position:"absolute"}}),[t,n,r]),l=du().store,c=(0,s.useCallback)((function(){var e;null===i||void 0===i||null===(e=i.current)||void 0===e||e.click()}),[i]),u=(0,s.useCallback)((function(e,t,n){var r=n.key,o=n.data;l.insertColumn(e,t,{key:r,data:o})}),[l]),d=(0,s.useCallback)((function(e){ya(e)&&document.activeElement&&document.activeElement.id===o&&c()}),[o,c]);return(0,s.useEffect)((function(){return document.addEventListener("keydown",d),function(){document.removeEventListener("keydown",d)}}),[]),(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:"sf-metadata-record-header-cell",children:(0,m.jsx)("div",{className:"sf-metadata-result-table-cell column insert-column",style:a,id:o,ref:i,children:(0,m.jsx)(zl.In,{iconName:"add-table"})})}),(0,m.jsx)(wu,{target:o,onChange:u})]})},rp=["isGroupView","containerWidth","hasSelectedRecord","isSelectedAll","lastFrozenColumnKey","groupOffsetLeft","table","columnMetrics","onRef","colOverScanStartIdx","colOverScanEndIdx","selectNoneRecords","selectAllRecords","modifyColumnWidth","modifyColumnOrder"],op=(0,ku.Tl)("sfMetadataRecordHeaderCell",{},(function(e){return{connectDropTarget:e.dropTarget()}}))((function(e){var t=e.isGroupView,n=e.containerWidth,r=e.hasSelectedRecord,o=e.isSelectedAll,i=e.lastFrozenColumnKey,a=e.groupOffsetLeft,l=e.table,c=e.columnMetrics,u=e.onRef,d=e.colOverScanStartIdx,p=e.colOverScanEndIdx,h=e.selectNoneRecords,f=e.selectAllRecords,g=e.modifyColumnWidth,v=e.modifyColumnOrder,y=(0,dc.A)(e,rp),x=(0,s.useState)(null),A=(0,F.A)(x,2),C=A[0],b=A[1],w=(0,s.useMemo)((function(){return l.header_settings||{}}),[l]),S=(0,s.useMemo)((function(){return w&&w.is_hide_triangle}),[w]),D=(0,s.useMemo)((function(){return($s(w)?ea:w.header_height)===ta?56:32}),[w]),k=(0,s.useMemo)((function(){return{width:n,minWidth:"100%",zIndex:4,height:D}}),[n,D]),M=(0,s.useMemo)((function(){return C||c}),[C,c]),j=(0,s.useMemo)((function(){var e=M.columns,n={position:ec?"absolute":"fixed",marginLeft:"0px",height:D,zIndex:1};return(t&&!_c(e[0])||ec)&&(n.position="absolute"),n}),[t,M,D]),I=(0,s.useCallback)((function(e,t){b(function(e,t,n){var r=Gl()(e),o=e.columns.findIndex((function(e){return e.key===t})),i=e.columns[o],a=(0,Sr.A)((0,Sr.A)({},i),{},{width:n});r.columns[o]=a;var s=e.allColumns.findIndex((function(e){return e.key===t}));return r.allColumns[s]=(0,Sr.A)((0,Sr.A)({},e.columns[o]),{},{width:n}),Oc(r.columns,r.allColumns)}(c,e.key,Math.max(t,50)))}),[c]),_=(0,s.useCallback)((function(e,t){b(null),g&&g(e,t)}),[g]),P=(0,s.useCallback)((function(e,t){v&&v(e.key,t.key)}),[v]),N=tp(M.columns),O=M.columns.slice(d,p),T=N.reduce((function(e,t){return e+t.width}),0);return(0,m.jsx)("div",{className:"static-sf-metadata-result-content grid-header",style:{height:D+1},children:(0,m.jsxs)("div",{className:"sf-metadata-result-table-row",style:k,children:[(0,m.jsxs)("div",{className:"frozen-columns d-flex",style:j,ref:function(e){return u(e)},children:[(0,m.jsx)(ep,{isMobile:ec,height:D,hasSelectedRecord:r,isSelectedAll:o,isLastFrozenCell:!i,groupOffsetLeft:a,selectNoneRecords:h,selectAllRecords:f}),N.map((function(e){var t=e.key,n=t===i;return(0,m.jsx)($d,(0,Sr.A)({frozen:!0,height:D,column:e,style:{backgroundColor:"#f9f9f9"},isLastFrozenCell:n,frozenColumnsWidth:T,isHideTriangle:S,modifyLocalColumnWidth:I,modifyColumnWidth:_,onMove:P},y),t)}))]}),O.map((function(e){return(0,m.jsx)($d,(0,Sr.A)({isHideTriangle:S,groupOffsetLeft:a,height:D,column:e,frozenColumnsWidth:T,modifyLocalColumnWidth:I,modifyColumnWidth:_,onMove:P},y),e.key)})),(0,m.jsx)(np,{lastColumn:M.columns[M.columns.length-1],groupOffsetLeft:a,height:D})]})})})),ip=(0,Mu.A)(op),ap=function(e){function t(){var e;(0,r.A)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=(0,i.A)(this,t,[].concat(o))).isSelfScroll=!0,e.setScrollTop=function(t){e.isSelfScroll=!1,e.rightScrollContainer.scrollTop=t},e.onScroll=function(t){if(t.stopPropagation(),e.isSelfScroll){var n=t.target.scrollTop;e.props.onScrollbarScroll(n)}else e.isSelfScroll=!0},e.onMouseUp=function(t){e.props.onScrollbarMouseUp&&e.props.onScrollbarMouseUp(t)},e.getScrollbarStyle=function(){var e=window.sfMetadataBody;return e&&e.resultRef?{height:e.resultRef.scrollHeight}:{}},e.getContainerStyle=function(){var e={},t=window.sfMetadataBody;return t&&t.resultContentRef&&(e.height=t.resultContentRef.clientHeight,e.zIndex=2),e.top=33,e.right=0,e},e.setScrollbarRef=function(t){e.scrollbar=t},e.setContainerRef=function(t){e.rightScrollContainer=t},e}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.getContainerStyle(),t=this.getScrollbarStyle();return(0,m.jsx)("div",{className:"right-scrollbar-container",style:e,ref:this.setContainerRef,onScroll:this.onScroll,onMouseUp:this.onMouseUp,children:(0,m.jsx)("div",{ref:this.setScrollbarRef,className:"right-scrollbar-inner",style:t})})}}])}(s.Component),sp=ap,lp=function(e){function t(){var e;(0,r.A)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=(0,i.A)(this,t,[].concat(o))).isSelfScroll=!0,e.setScrollLeft=function(t){e.isSelfScroll=!1,e.container.scrollLeft=t},e.onScroll=function(t){if(t.stopPropagation(),e.isSelfScroll){var n=t.target.scrollLeft;e.props.onScrollbarScroll(n)}else e.isSelfScroll=!0},e.getScrollbarStyle=function(){return{width:e.props.innerWidth}},e.getContainerStyle=function(){return{zIndex:2}},e.setScrollbarRef=function(t){e.scrollbar=t},e.setContainerRef=function(t){e.container=t},e}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){if(!this.props.innerWidth)return null;var e=this.getContainerStyle(),t=this.getScrollbarStyle();return(0,m.jsx)("div",{className:"horizontal-scrollbar-container",ref:this.setContainerRef,style:e,onScroll:this.onScroll,onMouseUp:this.props.onScrollbarMouseUp,children:(0,m.jsx)("div",{className:"horizontal-scrollbar-inner",ref:this.setScrollbarRef,style:t})})}}])}(s.Component),cp=lp,up=function(e,t,n){return e!==t&&(void 0===e||null===e?(n!==lo.GEOLOCATION||!$s(t))&&((n!==lo.DATE&&n!==lo.NUMBER||null!==t)&&(Array.isArray(t)?0!==t.length:!1!==t&&""!==t)):Array.isArray(e)&&Array.isArray(t)?JSON.stringify(e)!==JSON.stringify(t):"object"===typeof e&&"object"===typeof t&&null!==t?!ic.isSameObject(e,t):e!==t)},dp=function(e){var t=e.isDir,n=e.column,r=e.value,o=(0,s.useCallback)((function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),window.sfMetadataContext.eventBus.dispatch(tl,Bl)}),[]);if(!r)return null;if(n.type===lo.FILE_NAME){var i="sf-metadata-cell-open-file-btn";return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(zl.Oi,{id:i,className:"sf-metadata-cell-operation-btn",size:20,iconName:"open-file",onClick:o}),(0,m.jsx)(Qe.A,{hideArrow:!0,target:i,placement:"bottom",fade:!1,delay:{show:0,hide:0},modifiers:{preventOverflow:{boundariesElement:document.body}},children:(0,h.AP)(t?"Open folder":"Open file")})]})}return null},pp=["readonly","value","field"],hp=function(e){var t=e.readonly,n=e.value,r=e.field,o=(0,dc.A)(e,pp),i=su(),a=i.collaborators,l=i.collaboratorsCache,c=i.updateCollaboratorsCache,u=i.queryUser,d=(0,s.useMemo)((function(){return{collaborators:a,collaboratorsCache:l,updateCollaboratorsCache:c,readonly:t,value:n,field:r,queryUserAPI:u,getFileIconUrl:f.Aq.getFileIconUrl,getFolderIconUrl:f.Aq.getFolderIconUrl}}),[t,n,r,a,l,c,u]);return(0,m.jsx)(zl.ZA,(0,Sr.A)((0,Sr.A)({},d),o))},fp=function(e){var t=e.isCellSelected,n=e.field,r=e.value,o=e.onChange,i=(0,s.useState)(!1),a=(0,F.A)(i,2),l=a[0],c=a[1];(0,s.useEffect)((function(){t||c(!1)}),[t]);var u=(0,s.useCallback)((function(e){e&&e.stopPropagation(),o((0,ro.default)({},n.key,!r))}),[r,n,o]),d=(0,s.useCallback)((function(){l?u():c(!0)}),[l,u]);return(0,m.jsx)("div",{className:"sf-metadata-checkbox-editor",onClick:d,children:(0,m.jsx)("div",{className:"sf-metadata-checkbox-editor-content",onClick:u,children:r&&(0,m.jsx)(zl.In,{iconName:"check-mark"})})})},mp=function(e){var t=e.isCellSelected,n=e.isDir,r=e.field,o=e.value,i=e.onChange;return r.type===lo.CHECKBOX&&window.sfMetadataContext.canModifyColumn(r)?(0,m.jsx)(fp,{isCellSelected:t,value:o,field:r,onChange:i}):(0,m.jsx)(hp,{readonly:!0,value:o,field:r,isDir:n})},gp=s.memo((function(e){var t=e.needBindEvents,n=e.column,r=e.record,o=e.groupRecordIndex,i=e.recordIndex,a=e.cellMetaData,l=e.highlightClassName,c=e.isLastCell,u=e.isLastFrozenCell,d=e.isCellSelected,p=e.bgColor,h=e.frozen,f=e.height,g=(0,s.useMemo)((function(){var e=n.type,t=window.sfMetadataContext.canModifyColumn(n);return D()("sf-metadata-result-table-cell","sf-metadata-result-table-".concat(e,"-cell"),l,{"table-cell-uneditable":!t||!_l[e],"last-cell":c,"table-last--frozen":u,"cell-selected":d})}),[n,l,c,u,d]),v=(0,s.useMemo)((function(){var e=r[Po];return"string"===typeof e?"TRUE"===e.toUpperCase():e}),[r]),y=(0,s.useMemo)((function(){var e=n.left,t={width:n.width,height:f};return h||(t.left=e),p&&(t.backgroundColor=p),t}),[h,f,n,p]),x=(0,s.useCallback)((function(e){var t={idx:n.idx,groupRecordIndex:o,rowIdx:i};Xs(a.onCellClick)&&a.onCellClick(t,e)}),[n,o,i,a]),A=(0,s.useCallback)((function(e){if(Xs(a.onCellDoubleClick)){var t={idx:n.idx,groupRecordIndex:o,rowIdx:i};a.onCellDoubleClick(t,e)}}),[n,o,i,a]),C=(0,s.useCallback)((function(e){if(2!==e.button&&Xs(a.onCellMouseDown)){var t={idx:n.idx,groupRecordIndex:o,rowIdx:i};a.onCellMouseDown(t,e)}}),[n,o,i,a]),b=(0,s.useCallback)((function(e){if(Xs(a.onCellMouseEnter)){var t={idx:n.idx,groupRecordIndex:o,rowIdx:i},r={x:e.clientX,y:e.clientY};a.onCellMouseEnter((0,Sr.A)((0,Sr.A)({},t),{},{mousePosition:r}),e)}}),[n,o,i,a]),w=(0,s.useCallback)((function(e){if(Xs(a.onCellMouseMove)){var t={idx:n.idx,groupRecordIndex:o,rowIdx:i},r={x:e.clientX,y:e.clientY};a.onCellMouseMove((0,Sr.A)((0,Sr.A)({},t),{},{mousePosition:r}),e)}}),[n,o,i,a]),S=(0,s.useCallback)((function(){}),[]),k=(0,s.useCallback)((function(e){e.stopPropagation(),e.preventDefault()}),[]),M=(0,s.useCallback)((function(e){e.preventDefault();var t={idx:n.idx,groupRecordIndex:o,rowIdx:i};Xs(a.onCellContextMenu)&&a.onCellContextMenu(t)}),[a,n,o,i]),j=(0,s.useCallback)((function(){return{onClick:x,onDoubleClick:A,onMouseDown:C,onMouseEnter:b,onMouseMove:w,onMouseLeave:S,onDragOver:k,onContextMenu:M}}),[x,A,C,b,w,S,k,M]),I=(0,s.useCallback)((function(e){var t=n.key,r=n.name;return{oldRowData:$o.includes(t)?(0,ro.default)({},t,e):(0,ro.default)({},r,e),originalOldRowData:(0,ro.default)({},t,e)}}),[n]),_=(0,s.useCallback)((function(e){if(Xs(a.modifyRecord)){var t=n.key,o=n.type,i=n.name,s=ba(r,n);if(up(s,e[t],o)){var l=r._id,c=Object.keys(e)[0],u=$o.includes(t)?e:(0,ro.default)({},i,e[c]),d=I(s),p=d.oldRowData,h=d.originalOldRowData;a.modifyRecord({rowId:l,cellKey:t,updates:u,originalUpdates:e,oldRowData:p,originalOldRowData:h})}}}),[a,r,n,I]),P=ba(r,n),N=t&&j(),O=(0,Sr.A)({className:g,style:y},N);return(0,m.jsxs)("div",(0,Sr.A)((0,Sr.A)({},O),{},{children:[(0,m.jsx)(mp,{isCellSelected:d,isDir:v,value:P,field:n,onChange:_}),d&&(0,m.jsx)(dp,{value:P,column:n,isDir:v})]}),"".concat(r._id,"-").concat(n.key))}),(function(e,t){var n=e.record,r=e.column,o=e.isCellSelected,i=e.isLastCell,a=e.highlightClassName,s=e.height,l=e.bgColor,c=t.record,u=t.highlightClassName,d=t.height,p=t.column,h=t.bgColor,f=n[r.name]||n[r.key],m=c[r.name]||c[r.key];return!(up(f,m,r.type)||n._last_modifier!==c._last_modifier||o!==t.isCellSelected||i!==t.isLastCell||a!==u||s!==d||r.left!==p.left||r.width!==p.width||l!==h||!ic.isSameObject(r.data,p.data)||e.groupRecordIndex!==t.groupRecordIndex||e.recordIndex!==t.recordIndex)}));gp.defaultProps={needBindEvents:!0};var vp=gp,yp=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onCellMouseEnter=function(){n.props.isLocked&&!ec&&(n.timer=setTimeout((function(){n.setState({isLockedRowTooltipShow:!0})}),500))},n.onCellMouseLeave=function(){n.props.isLocked&&!ec&&(n.timer&&(clearTimeout(n.timer),n.timer=null),n.setState({isLockedRowTooltipShow:!1}))},n.getLockedRowTooltip=function(){var e=n.props.recordId;return(0,m.jsx)(U.A,{target:"action-cell-".concat(e),placement:"bottom",isOpen:n.state.isLockedRowTooltipShow,fade:!1,hideArrow:!0,className:"readonly-cell-tooltip",children:(0,h.AP)("The row is locked and cannot be modified")})},n.state={isLockedRowTooltipShow:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.isSelected,n=e.isLastFrozenCell,r=e.index,o=e.height,i=e.recordId,a={height:o,width:Ml,minWidth:Ml};return(0,m.jsxs)("div",{className:D()("sf-metadata-result-table-cell column actions-cell",{"table-last--frozen":n}),id:"action-cell-".concat(i),style:(0,Sr.A)({},a),onMouseEnter:this.onCellMouseEnter,onMouseLeave:this.onCellMouseLeave,children:[!t&&(0,m.jsx)("div",{className:"sf-metadata-result-column-content row-index text-truncate",children:r+1}),(0,m.jsx)("div",{className:"sf-metadata-result-column-content actions-checkbox",children:(0,m.jsxs)("div",{className:"select-cell-checkbox-container",onClick:this.props.onSelectRecord,children:[(0,m.jsx)("input",{id:"select-cell-checkbox-".concat(i),className:"select-cell-checkbox",type:"checkbox",name:"row-selection",checked:t||!1,readOnly:!0}),(0,m.jsx)("label",{htmlFor:"select-cell-checkbox-".concat(i),name:(0,h.AP)("Select"),title:(0,h.AP)("Select"),"aria-label":(0,h.AP)("Select")})]})})]})}}])}(s.Component),xp=yp,Ap=function(e){function t(){var e;(0,r.A)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=(0,i.A)(this,t,[].concat(o))).checkScroll=function(){e.cancelFixFrozenDOMs(e.props.scrollLeft)},e.cancelFixFrozenDOMs=function(t){var n=e.props.isGroupView,r=e.frozenColumns.childElementCount;!e.frozenColumns||r<1||n&&r<2||(e.frozenColumns.style.position="absolute",e.frozenColumns.style.marginLeft=t+"px",e.frozenColumns.style.marginTop="0px")},e.onSelectRecord=function(t){var n=e.props,r=n.groupRecordIndex,o=n.index;e.props.selectNoneCells(),e.props.onSelectRecord({groupRecordIndex:r,recordIndex:o},t)},e.isCellSelected=function(t){var n=e.props,r=n.hasSelectedCell,o=n.selectedPosition;return!!o&&(r&&o.idx===t)},e.reloadCurrentRecord=function(){e.props.reloadRecords([e.props.record._id])},e.getFrozenCells=function(){var t=e.props,n=t.columns,r=t.lastFrozenColumnKey,o=t.groupRecordIndex,i=t.index,a=t.record,s=t.cellMetaData,l=t.isGroupView,c=t.height,u=t.columnColor,d=tp(n);if(0===d.length)return null;var p=a._id;return d.map((function(t,d){var h=t.key,f=e.isCellHighlight(h,p),g=e.isCurrentCellHighlight(h,p)?"cell-current-highlight":f?"cell-highlight":null,v=e.isCellSelected(d),y=e.isLastCell(n,h),x=h===r,A=u&&u[h];return(0,m.jsx)(vp,{frozen:!0,record:a,groupRecordIndex:o,recordIndex:i,isCellSelected:v,isLastCell:y,isLastFrozenCell:x,height:l?c:c-1,column:t,cellMetaData:s,modifyRecord:e.props.modifyRecord,lockRecordViaButton:e.props.lockRecordViaButton,modifyRecordViaButton:e.props.modifyRecordViaButton,reloadCurrentRecord:e.reloadCurrentRecord,highlightClassName:g,bgColor:A},t.key)}))},e.isCellHighlight=function(t,n){var r=e.props.searchResult;if(r){var o=r.matchedRows[n];if(o&&o.includes(t))return!0}return!1},e.isCurrentCellHighlight=function(t,n){var r=e.props.searchResult;if(r){var o=r.currentSelectIndex;if("number"!==typeof o)return!1;var i=r.matchedCells[o];if(!i)return!1;if(i.row===n&&i.column===t)return!0}return!1},e.getColumnCells=function(){var t=e.props,n=t.columns,r=t.colOverScanStartIdx,o=t.colOverScanEndIdx,i=t.groupRecordIndex,a=t.index,s=t.record,l=t.cellMetaData,c=t.isGroupView,u=t.height,d=t.columnColor,p=s._id;return n.slice(r,o).map((function(t){var r=t.key,o=!t.frozen,h=e.isCellSelected(n.findIndex((function(e){return e.key===t.key}))),f=e.isCellHighlight(r,p),g=e.isCurrentCellHighlight(r,p)?"cell-current-highlight":f?"cell-highlight":null,v=e.isLastCell(n,r),y=d&&d[r];return(0,m.jsx)(vp,{record:s,groupRecordIndex:i,recordIndex:a,isCellSelected:h,isLastCell:v,height:c?u:u-1,column:t,needBindEvents:o,cellMetaData:l,modifyRecord:e.props.modifyRecord,lockRecordViaButton:e.props.lockRecordViaButton,modifyRecordViaButton:e.props.modifyRecordViaButton,reloadCurrentRecord:e.reloadCurrentRecord,highlightClassName:g,bgColor:y},t.key)}))},e.getRecordStyle=function(){var t=e.props,n=t.isGroupView,r=t.height,o=t.isLastRecord,i={height:o?r-1:r};if(n){var a=e.props,s=a.top,l=a.left;i.top=s,i.left=l,o&&(i.height=r+1)}return i},e.getFrozenColumnsStyle=function(){var t=e.props,n=t.isGroupView,r=t.lastFrozenColumnKey,o=t.height,i={zIndex:1,height:o-1};return n&&(i.height=o,i.zIndex=2,r||(i.marginLeft="0px")),i},e.handleDragEnter=function(t){t.preventDefault();var n=e.props,r=n.index,o=n.groupRecordIndex;(0,n.cellMetaData.onDragEnter)({overRecordIdx:r,overGroupRecordIndex:o})},e.handleDragOver=function(e){e.preventDefault(),e.dataTransfer.dropEffect="copy"},e.handleDrop=function(e){e.preventDefault()},e}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.checkScroll()}},{key:"shouldComponentUpdate",value:function(e){return e.isGroupView!==this.props.isGroupView||e.hasSelectedCell!==this.props.hasSelectedCell||e.hasSelectedCell&&this.props.selectedPosition.idx!==e.selectedPosition.idx||e.isSelected!==this.props.isSelected||e.groupRecordIndex!==this.props.groupRecordIndex||e.index!==this.props.index||e.isLastRecord!==this.props.isLastRecord||e.lastFrozenColumnKey!==this.props.lastFrozenColumnKey||e.columns!==this.props.columns||e.colOverScanStartIdx!==this.props.colOverScanStartIdx||e.colOverScanEndIdx!==this.props.colOverScanEndIdx||e.record!==this.props.record||e.top!==this.props.top||e.left!==this.props.left||e.height!==this.props.height||e.searchResult!==this.props.searchResult||e.columnColor!==this.props.columnColor}},{key:"isLastCell",value:function(e,t){return e[e.length-1].key===t}},{key:"render",value:function(){var e=this,t=this.props,n=t.isSelected,r=t.isGroupView,o=t.index,i=t.isLastRecord,a=t.lastFrozenColumnKey,s=t.height,l=t.record,c=!!l._locked,u=r?s:s-1,d=this.getFrozenCells(),p=this.getColumnCells();return(0,m.jsxs)("div",{className:D()("sf-metadata-result-table-row",{"sf-metadata-last-table-row":i,"row-selected":n,"row-locked":c}),style:this.getRecordStyle(),onDragEnter:this.handleDragEnter,onDragOver:this.handleDragOver,onDrop:this.handleDrop,children:[(0,m.jsxs)("div",{className:"frozen-columns d-flex",style:this.getFrozenColumnsStyle(),ref:function(t){return e.frozenColumns=t},children:[(0,m.jsx)(xp,{isLocked:c,isSelected:n,recordId:l._id,index:o,onSelectRecord:this.onSelectRecord,isLastFrozenCell:!a,height:u}),d]}),p]})}}])}(s.Component),Cp=Ap,bp=function(e,t,n,r,o,i){var a={};t.forEach((function(e){var t=e.column_key,n=Ya(r,t);a[t]=n}));var s=t.length,l=wp(e,a,n,i,o,s,{parentGroupPath:[],currentLevel:s,isParentGroupVisible:!0}),c=Sp(l,s),u=c.computedGroupRows,d=c.groupRowsHeight;return{groupRows:u,idGroupRowMap:c.idGroupRowMap,groupRowsHeight:d,maxLevel:s}},wp=function(e,t,n,r,o,i,a){var s=a.parentGroupPath,l=a.parentGroupKey,c=a.currentLevel,u=a.isParentGroupVisible,d=[];return e.forEach((function(e,a){var p=[];s.length>0&&p.push.apply(p,(0,W.A)(s)),p.push(a);var h=e.cell_value,f=e.subgroups,m=e.row_ids,g=e.column_key,v=e.summaries,y=e.original_cell_value,x=p.join("-"),A=Dp(x,n),C=(i-c+1)*jl,b="".concat(l||g,"_").concat(h),w={type:Pl,level:c,left:C,key:b,cell_value:h,column_key:g,isExpanded:A,summaries:v,groupPath:p,groupPathString:x,column:t[g],visible:u,original_cell_value:y};if(Array.isArray(f)&&f.length>0){var S,D=wp(f,t,n,r,o,i,{parentGroupPath:p,parentGroupKey:b,currentLevel:c-1,isParentGroupVisible:u&&A}),k=0,M=0;D.forEach((function(e){e.type===Pl&&e.level+1===c&&(k+=e.count||0,M+=(e.height||0)+jl,S||(S=e.first_row_id))})),w.first_row_id=S,w.count=k,w.height=(A?M:0)+Il,d.push(w),d.push.apply(d,(0,W.A)(D))}else if(Array.isArray(m)&&m.length>0){var j=m.length,I=j-1,_=u&&A,P=_?j*o+1:0,N=_&&r?32:0,O=m.map((function(e,t){return{type:Nl,key:"row-".concat(e),rowIdx:t,isLastRow:t===I,visible:_,height:t===I?o+1:o,level:c,rowsLength:j,left:C,rowId:e,groupPath:p,groupPathString:x}}));w.first_row_id=O[0].rowId,w.count=j,w.height=P+N+Il,d.push(w),d.push.apply(d,(0,W.A)(O))}})),d},Sp=function(e,t){var n,r=jl,o=jl,i={},a=e.map((function(a,s){var l=a.type,c=a.level,u=a.height,d=a.visible,p=(0,Sr.A)((0,Sr.A)({},a),{},{top:o,groupRecordIndex:s});if(l===Pl)d&&(c===t&&(r+=u+jl),o+=Il,n=c);else if(l===Nl){var h=a.rowId;i[h]=p,d&&(o+=u)}else l===Ol&&d&&(o+=u);var f=e[s+1];if(f&&f.visible&&f.type===Pl){var m=f.groupPath,g=f.level;m[m.length-1]>0&&(o+=jl),g>n&&(o+=(g-n)*jl)}return p}));return{computedGroupRows:a,groupRowsHeight:r,idGroupRowMap:i}},Dp=function(e,t){return!t||!t[e]},kp=function(e,t){var n=e.groupPath,r=e.groupPathString,o=e.level,i=e.type,a=t.groupPath,s=t.groupPathString,l=t.level;return r===s&&i!==Pl||o<l&&n[0]===a[0]},Mp=function(e,t){return(t.groupRows||[])[e]||{}},jp="upwards",Ip="downwards",_p=function(e){var t=e.selectedPosition,n=e.isGroupView;return(0,e.recordGetterByIndex)({isGroupView:n,groupRecordIndex:t.groupRecordIndex,recordIndex:t.rowIdx})},Pp=function(e){var t=e.selectedPosition,n=e.columns;return Ic(t.idx,n)},Np=function(e){var t=e.selectedPosition,n=e.columns,r=e.isGroupView,o=e.recordGetterByIndex,i=Pp({selectedPosition:t,columns:n}),a=_p({selectedPosition:t,isGroupView:r,recordGetterByIndex:o});return ba(a,i)},Op=function(e,t,n,r){var o=e.idx,i=e.groupRecordIndex,a=e.rowIdx,s=t[o];return!!s&&(!!El.includes(s.type)||!!r({isGroupView:n,groupRecordIndex:i,recordIndex:a}))};var Tp=function(e){var t=e.selectedRange,n=e.columns,r=e.rowHeight,o=e.isGroupView,i=e.groups,a=e.groupMetrics,s=e.groupOffsetLeft,l=e.getRecordTopFromRecordsBody,c=t.topLeft,u=t.bottomRight,d=t.startCell,p=t.cursorCell;if(c.idx<0)return{width:0,left:0,top:0,height:r,zIndex:1};var h,f,m=function(e,t,n){for(var r=0,o=!1,i=e;i<=t;i++){var a=n[i];a&&(r+=a.width,o=o||a.frozen)}return{totalWidth:r,anyColFrozen:o,left:n[e].left}}(c.idx,u.idx,n),g=m.totalWidth,v=m.anyColFrozen,y=m.left;if(o){var x,A,C=d.groupRecordIndex,b=p.groupRecordIndex,w=Mp(C,a),S=Mp(b,a),D=w.groupPathString,k=S.groupPathString;if(C<b?(x=C,A=Ip):(x=b,A=jp),D===k)h=(Math.abs(b-C)+1)*r;else if(A===Ip){var M=function(e,t){if(!Array.isArray(e)||!Array.isArray(t))return null;var n=e[0];if(n<0||n>=t.length)return null;for(var r=1,o=t[n];r<e.length&&o;){var i=o.subgroups,a=e[r];if(!Array.isArray(i)||a<0||a>=i.length)break;o=i[a],r+=1}return o}(w.groupPath,i);h=((M.row_ids||[]).length-w.rowIdx||0)*r}else if(A===jp){var j=w.rowIdx||0;x=C-j,h=(j+1)*r}h+=1,y+=s,f=l(x)}else h=(u.rowIdx-c.rowIdx+1)*r,f=l(c.rowIdx);return{width:g,left:y,top:f,height:h,zIndex:v?3:1}},Ep=function(e){for(var t=e.selectedRange,n=e.isGroupView,r=e.recordGetterByIndex,o=t.topLeft,i=t.bottomRight,a=o.rowIdx,s=o.groupRecordIndex,l=[],c=a,u=i.rowIdx+1;c<u;c++){var d=r({isGroupView:n,groupRecordIndex:s,recordIndex:c});n&&s++,d&&l.push(d)}return l};function Rp(e){return e>47&&e<58||32===e||13===e||e>64&&e<91||e>95&&e<112||e>185&&e<193||e>218&&e<223}function Lp(e){return(!0===e.ctrlKey||!0===e.metaKey)&&"Control"!==e.key}function Fp(e){return e&&e.shiftKey}var Up=["width","height","top","left","zIndex","children","innerRef"],Bp=function(e){function t(){var e;(0,r.A)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=(0,i.A)(this,t,[].concat(o))).getMaskStyle=function(){var t=e.props,n=t.width,r=t.height,o=t.top,i=t.left;return{height:r-1,width:n,zIndex:t.zIndex,position:"absolute",pointerEvents:"none",transform:"translate(".concat(i,"px, ").concat(o,"px)"),outline:0}},e}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidUpdate",value:function(){var e=l.findDOMNode(this);"fixed"===e.style.position&&(e.style.transform="none")}},{key:"render",value:function(){var e=this.props,t=(e.width,e.height,e.top,e.left,e.zIndex,e.children),n=e.innerRef,r=(0,dc.A)(e,Up),o=this.getMaskStyle();return(0,m.jsx)("div",(0,Sr.A)((0,Sr.A)({style:o,"data-test":"cell-mask",ref:n},r),{},{children:t}))}}])}(s.PureComponent),Yp=Bp;var qp=function(e){var t=e.selectedRange,n=e.innerRef,r=e.getSelectedRangeDimensions,o=e.children,i=r(t);return(0,m.jsx)(Yp,(0,Sr.A)((0,Sr.A)({},i),{},{className:"rdg-selected-range",innerRef:n,children:o}))};var Hp=function(e){var t=e.innerRef,n=e.selectedPosition,r=e.getSelectedDimensions,o=e.children,i=r(n);return(0,m.jsx)(Yp,(0,Sr.A)((0,Sr.A)({className:"rdg-selected",tabIndex:"0",innerRef:t},i),{},{children:o}))},Gp=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=(r.data,r.collaborators,e[n]);return t===lo.CTIME||t===lo.MTIME?function(e){if(!e)return null;var t=Sa()(e);return t.isValid()?t.format("YYYY-MM-DD HH:mm:ss"):e}(o):e[n]},zp=function(e,t){var n={};return e.forEach((function(e){n[e.key]=e})),Vp(t,n)};function Vp(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(!e||!t)return{};var r={};return Object.keys(e).forEach((function(o){var i=t[o];if(i){var a=i.name,s=i.type;if(!n||!n.includes(s)){var l=e[o];if(r[a]=l,s===lo.TEXT)r[a]="string"===typeof l?l.trim():""}}})),r}function Wp(e,t){Kp(e,t)||(t.idSelectedRecordMap[e]=!0)}function Kp(e,t){return t.idSelectedRecordMap[e]}function Xp(e){return Object.keys(e.idSelectedRecordMap)}var $p={selectRecord:Wp,selectRecordsById:function(e,t){e.forEach((function(e){Wp(e,t)}))},deselectRecord:function(e,t){Kp(e,t)&&delete t.idSelectedRecordMap[e]},deselectAllRecords:function(e){e.idSelectedRecordMap={}},isRecordSelected:Kp,getSelectedIds:Xp,hasSelectedRecords:function(e){return Xp(e).length>0},isSelectedAll:function(e,t){return 0!==Xp(t).length&&e.every((function(e){return Kp(e,t)}))}};var Zp=kl.TEXT,Jp=kl.FRAGMENT;function Qp(e,t){var n=window.sfMetadata.getCollaborators(),r=e.length-1,o=t.length-1,i="";return e.forEach((function(e,a){t.forEach((function(t,r){var a=t||{},s=a.key,l=a.type,c=a.data;if(l===lo.LONG_TEXT){var u=e[s];i+=u||""}else i+=e&&Gp(e,l,s,{data:c,collaborators:n})||"";r<o&&(i+="\t")})),a<r&&(i+="\n")})),i}function eh(e,t){var n,r,o,i;try{if(n=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,n=[],r=0;r<e.rangeCount;r++)n.push(e.getRangeAt(r));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||n.forEach((function(t){e.addRange(t)})),t&&t.focus()}}(),r=document.createRange(),o=document.getSelection(),(i=document.createElement("span")).textContent=e,i.addEventListener("copy",(function(n){n.stopPropagation(),n.preventDefault();var r=n.dataTransfer||n.clipboardData;r.clearData(),r.setData(Zp,e),r.setData(Jp,t)})),document.body.appendChild(i),r.selectNodeContents(i),o.addRange(r),!document.execCommand("copy"))return!1}catch(a){return!1}finally{i&&document.body.removeChild(i),n()}}var th=function(e){var t=e.type,n=e.selectedRecordIds,r=e.copiedRange,o=e.copiedColumns,i=e.copiedRecords,a=e.copiedTableId,s=e.tableData,l=e.copiedText,c=e.recordGetterById,u=e.isGroupView,d=e.recordGetterByIndex,p=e.event,h=void 0===p?{}:p,f=h.dataTransfer||h.clipboardData;if(t===kl.DTABLE_FRAGMENT){var m=Array.isArray(n)&&n.length>0?function(e,t,n){var r=e.map((function(e){return n(e)}));return Qp(r,t.columns)}(n,s,c):function(e,t,n,r){for(var o=e.topLeft,i=e.bottomRight,a=o.rowIdx,s=o.idx,l=o.groupRecordIndex,c=i.rowIdx,u=i.idx,d=t.columns,p=l,h=[],f=[],m=a;m<=c;m++)h.push(r({isGroupView:n,groupRecordIndex:p,recordIndex:m})),n&&p++;for(var g=s;g<=u;g++)f.push(Ic(g,d));return Qp(h,f)}(r,s,u,d),g={selectedRecordIds:n,copiedRange:r,copiedColumns:o,copiedRecords:i,copiedTableId:a},v=JSON.stringify(g);f?(f.setData(Zp,m),f.setData(Jp,v)):eh(m,v)}else{var y=kl[t.toUpperCase()];f?f.setData(y,l):eh(l,{format:y})}};var nh=function(e){var t=e.draggedRange,n=e.getSelectedRangeDimensions,r=e.getSelectedDimensions,o=t.overRecordIdx,i=t.bottomRight,a=i.idx,s=i.rowIdx,l=i.groupRecordIndex;if(null!==o&&s<o){for(var c=n(t),u=s+1;u<=o;u++){var d=r({idx:a,rowIdx:u,groupRecordIndex:l}).height;c.height+=d}return(0,m.jsx)(Yp,(0,Sr.A)((0,Sr.A)({},c),{},{className:"react-grid-cell-dragged-over-down"}))}return null};var rh=function(e){var t=e.onDragStart,n=e.onDragEnd;return(0,m.jsx)("div",{className:"drag-handle",draggable:"true",onDragStart:t,onDragEnd:n})},oh=function(e){function t(){var e;(0,r.A)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=(0,i.A)(this,t,[].concat(o))).state={isMounted:!1},e.el=document.createElement("div"),e}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.props.target.appendChild(this.el),this.setState({isMounted:!0})}},{key:"componentWillUnmount",value:function(){this.props.target.removeChild(this.el)}},{key:"render",value:function(){return this.state.isMounted?l.createPortal(this.props.children,this.el):null}}])}(s.Component),ih=oh,ah=n(60472),sh=function(e){var t=e.column,n=e.record,r=e.table,o=e.onCommitCancel,i=(0,s.useState)(0),a=(0,F.A)(i,2),l=a[0],c=a[1],u=(0,s.useMemo)((function(){var e=window.sfMetadataContext.getSetting("repoID");return r.rows.filter((function(e){return f.Aq.imageCheck(e[Lo])})).map((function(t){var n,r=t[Lo],o=t[No],i=f.Aq.encodePath(f.Aq.joinPath(o,r)),a="gif"===r.substr(r.lastIndexOf(".")+1).toLowerCase(),s=null===(n=window.sfMetadataContext.getSetting("repoInfo"))||void 0===n?void 0:n.encrypted,l="".concat(h.Yc).concat(s&&!a?"thumbnail":"repo","/").concat(e),c="".concat(l,"/").concat(s&&!a?h.oC:"raw").concat(i);return{name:r,url:"".concat(h.Yc,"lib/").concat(e,"/file").concat(i),src:c}}))}),[r]);(0,s.useEffect)((function(){if(u.length>0){var e=u.findIndex((function(e){return e.name===n[Lo]}));e>-1&&c(e)}}),[u,n]);var d=(0,s.useMemo)((function(){var e=n[Po];return"string"===typeof e?"TRUE"===e.toUpperCase():e}),[n]),p=(0,s.useMemo)((function(){var e=t.key;return n[e]}),[t,n]),g=(0,s.useMemo)((function(){if(d)return"folder";if(!p)return"";var e=p.lastIndexOf(".");return-1===e||p.slice(e).toLowerCase().indexOf(" ")>-1?"":f.Aq.imageCheck(p)?"image":f.Aq.isMarkdownFile(p)?"file":f.Aq.isSdocFile(p)?"sdoc":""}),[d,p]),v=(0,s.useMemo)((function(){var e=n[No];return"/"===e?"":e}),[n]),y=(0,s.useMemo)((function(){return window.sfMetadataContext.getSetting("repoID")}),[]),x=(0,s.useMemo)((function(){return f.Aq.encodePath(f.Aq.joinPath(v,p))}),[v,p]),A=(0,s.useMemo)((function(){return"".concat(h.Yc,"lib/").concat(y,"/file").concat(x)}),[x,y]);return"image"===g?(0,m.jsx)(zl.Q$,{children:(0,m.jsx)(ah.A,{imageItems:u,imageIndex:l,closeImagePopup:o,moveToPrevImage:function(){var e=u.length;c((function(t){return(t+e-1)%e}))},moveToNextImage:function(){var e=u.length;c((function(t){return(t+1)%e}))}})}):(g&&"sdoc"!==g?window.open(window.location.origin+window.location.pathname+f.Aq.encodePath(f.Aq.joinPath(v,p))):window.open(A),null)},lh=n(11942),ch=n.n(lh),uh=(ch().string,ch().number,ch().bool,ch().object,ch().array,function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).getValue=function(){var e=n.props.column,t=n.state.value,r=rc(t)||null;return(0,ro.default)({},e.key,r)},n.updateValue=function(e,t){e!==n.state.value&&n.setState({value:e},(function(){t&&t()}))},n.focusInput=function(){n.input&&n.input.focus()},n.blurInput=function(){n.input&&n.input.blur()},n.onBlur=function(){n.props.onCommit()},n.onPaste=function(e){e.stopPropagation()},n.onCut=function(e){e.stopPropagation()},n.onChange=function(e){e.persist();var t=e.target.value;n.setState({value:t},(function(){n.props.onChange&&n.props.onChange(e)}))},n.onInputKeyDown=function(e){var t=e.currentTarget,r=t.selectionStart,o=t.selectionEnd,i=t.value;e.keyCode===R.cK.Enter?(e.preventDefault(),n.onBlur()):(e.keyCode===R.cK.ChineseInputMethod||e.keyCode===R.cK.LeftArrow&&0===r||e.keyCode===R.cK.RightArrow&&o===i.length)&&e.stopPropagation(),n.props.onKeyDown&&n.props.onKeyDown(e)},n.onClick=function(e){n.props.onInputClick&&n.props.onInputClick(e)},n.onCompositionStart=function(e){n.props.onCompositionStart&&n.props.onCompositionStart(e)},n.onCompositionEnd=function(e){n.props.onCompositionEnd&&n.props.onCompositionEnd(e),n.onChange(e)},n.getInputNode=function(){var e=l.findDOMNode(n.input);return"INPUT"===e.tagName?e:e.querySelector("input:not([type=hidden])")},n.setInputRef=function(e){return n.input=e,n.input},n.onSaveQRCodeValue=function(e){n.setState({value:e}),n.props.onCommit()},n.state={value:e.value||""},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.props,n=t.value,r=t.column,o=e.value;up(n,o,r.type)&&this.setState({value:o||""})}},{key:"render",value:function(){var e=this.props,t=e.column,n=e.readOnly,r=e.className,o=e.placeholder,i=this.state.value;return(0,m.jsx)(m.Fragment,{children:(0,m.jsx)("input",{type:"text",className:D()("sf-metadata-text-editor form-control",r),ref:this.setInputRef,placeholder:o||"",disabled:n,onBlur:this.onBlur,onCut:this.onCut,onPaste:this.onPaste,value:i,name:t.name,title:t.name,"aria-label":t.name,onChange:this.onChange,onKeyDown:this.onInputKeyDown,onClick:this.onClick,onCompositionStart:this.onCompositionStart,onCompositionEnd:this.onCompositionEnd})})}}])}(s.Component)),dh=(0,s.forwardRef)((function(e,t){var n=e.readOnly,r=e.column,o=e.value,i=e.onCommit,a=e.onChange,c=e.selectDownCell,u=(0,s.useMemo)((function(){return r.data||{format:bo}}),[r]),d=(0,s.useState)(""),p=(0,F.A)(d,2),h=p[0],f=p[1],g=(0,s.useRef)(null);(0,s.useEffect)((function(){var e=o||0===o?o:"",t=(null===r||void 0===r?void 0:r.data)||{},n=Ra(e,t)||"";f(n)}),[]);var v=(0,s.useCallback)((function(e){var t=(null===u||void 0===u?void 0:u.format)||bo,n="custom_currency"===t?u.currency_symbol:null,r=e.target.value.trim();if(Ks()||!(r.indexOf(".\u3002")>-1)){var o=La(r,t,n);o!==h&&(f(o),a&&a(e,o))}}),[u,h,a]),y=(0,s.useCallback)((function(){Xs(i)&&i()}),[i]),x=(0,s.useCallback)((function(e){var t=e.currentTarget,n=t.selectionStart,r=t.selectionEnd,o=t.value;e.keyCode===R.cK.Enter||e.keyCode===R.cK.Esc?(e.preventDefault(),y(),Xs(c)&&c()):(e.keyCode===R.cK.LeftArrow&&0===n||e.keyCode===R.cK.RightArrow&&r===o.length)&&e.stopPropagation()}),[y,c]),A=(0,s.useCallback)((function(e){e.stopPropagation()}),[]),C=(0,s.useCallback)((function(e){e.stopPropagation()}),[]);return(0,s.useImperativeHandle)(t,(function(){return{getValue:function(){var e=r.key;return(0,ro.default)({},e,Ua(h,u))},getInputNode:function(){var e=l.findDOMNode(g.current);return"INPUT"===e.tagName?e:e.querySelector("input:not([type=hidden])")}}}),[r,h,u]),(0,m.jsx)("input",{ref:g,type:"text",className:"form-control",value:h,onBlur:y,onPaste:A,onCut:C,onKeyDown:x,onChange:v,style:{textAlign:"right"},disabled:n})})),ph=dh,hh=(0,s.forwardRef)((function(e,t){var n=e.height,r=e.column,o=e.columns,i=e.record,a=e.value,l=e.editorPosition,c=void 0===l?{left:0,top:0}:l,u=e.onCommit,d=e.onPressTab,p=e.modifyColumnData,f=(0,s.useState)(a||""),g=(0,F.A)(f,2),v=g[0],y=g[1],x=(0,s.useState)(""),A=(0,F.A)(x,2),C=A[0],b=A[1],w=(0,s.useState)(-1),S=(0,F.A)(w,2),k=S[0],M=S[1],j=(0,s.useState)(0),I=(0,F.A)(j,2),_=I[0],P=I[1],N=(0,s.useRef)(null),O=(0,s.useRef)(null),T=(0,s.useRef)(null),E=window.sfMetadataContext.canModifyColumnData(r),L=(0,s.useMemo)((function(){var e=Ha(r),t=r.data||{},n=t.cascade_column_key,a=t.cascade_settings;if(n){var s=Ya(o,n);if(s){var l=ba(i,s);if(!l)return[];var c=a[l];return c&&Array.isArray(c)&&0!==c.length?e.filter((function(e){return c.includes(e.id)})):[]}}return e}),[i,r,o]),U=(0,s.useMemo)((function(){if(!C)return L;var e=C.toLowerCase().trim();return e?L.filter((function(t){return t.name&&t.name.toLowerCase().indexOf(e)>-1})):L}),[C,L]),B=(0,s.useMemo)((function(){return!(!E||!C)&&-1===U.findIndex((function(e){return e.name===C}))}),[E,U,C]),Y=(0,s.useMemo)((function(){return{width:r.width,top:n-2}}),[r,n]),q=(0,s.useCallback)((function(){u&&u(v)}),[v,u]),H=(0,s.useCallback)((function(e){C!==e&&b(e)}),[C]),G=(0,s.useCallback)((function(e){e!==v&&(y(e),setTimeout((function(){u&&u(e)}),1))}),[v,u]),z=(0,s.useCallback)((function(e){M(e)}),[]),V=(0,s.useCallback)((function(e){M(-1)}),[]),W=(0,s.useCallback)((function(e){e&&e.stopPropagation(),e&&e.nativeEvent.stopImmediatePropagation();var t=Du(L,(null===C||void 0===C?void 0:C.trim())||""),n=L.slice(0);n.push(t),p(r.key,{options:n},{options:r.data.options||[]}),G(t.id)}),[r,C,L,G,p]),K=(0,s.useCallback)((function(){var e=getComputedStyle(N.current,null),t=getComputedStyle(T.current,null);return Math.floor(parseInt(e.maxHeight)/parseInt(t.height))-1}),[N,T]),X=(0,s.useCallback)((function(e){var t;if(e.preventDefault(),1===U.length?t=U[0]:k>-1&&(t=U[k]),t){var n=t.id;return v===t.id&&(n=null),void G(n)}var r=!1;C&&(r=!(!E||-1!==U.findIndex((function(e){return e.name===C})))),r&&0!==U.length&&W()}),[E,U,k,v,C,G,W]),$=(0,s.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),0!==k&&(M(k-1),k>U.length-_&&(N.current.scrollTop-=30))}),[N,k,_,U,30]),Z=(0,s.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),k!==U.length-1&&(M(k+1),k>=_&&(N.current.scrollTop+=30))}),[N,k,_,U,30]),J=(0,s.useCallback)((function(e){e.keyCode===R.cK.Enter?X(e):e.keyCode===R.cK.UpArrow?$(e):e.keyCode===R.cK.DownArrow?Z(e):e.keyCode===R.cK.Tab&&Xs(d)&&d(e)}),[X,$,Z,d]),Q=(0,s.useCallback)((function(e){e.keyCode!==R.cK.ChineseInputMethod&&e.keyCode!==R.cK.Enter&&e.keyCode!==R.cK.LeftArrow&&e.keyCode!==R.cK.RightArrow||e.stopPropagation()}),[]);(0,s.useEffect)((function(){O.current&&(O.current.getBoundingClientRect().bottom>window.innerHeight&&(O.current.style.top="unset",O.current.style.bottom=c.top+n-window.innerHeight+"px"));return N.current&&T.current&&P(K()),document.addEventListener("keydown",J,!0),function(){document.removeEventListener("keydown",J,!0)}}),[J]),(0,s.useEffect)((function(){var e=0===U.length?-1:0;M(e)}),[U]),(0,s.useImperativeHandle)(t,(function(){return{getValue:function(){var e=r.key;return(0,ro.default)({},e,v)},onBlur:function(){return q()}}}),[r,v,q]);var ee=(0,s.useCallback)((function(){if(0===U.length){var e=C?(0,h.AP)("No options available"):(0,h.AP)("No option");return(0,m.jsx)("span",{className:"none-search-result",children:e})}return U.map((function(e,t){var n=v===e.id||v===e.name;return(0,m.jsx)("div",{className:"sf-metadata-single-select-item",ref:T,children:(0,m.jsxs)("div",{className:D()("single-select-container",{"single-select-container-highlight":t===k}),onMouseDown:function(){return G(n?null:e.id)},onMouseEnter:function(){return z(t)},onMouseLeave:function(){return V(t)},children:[(0,m.jsx)("div",{className:"single-select",children:(0,m.jsx)("span",{className:"single-select-name",style:{backgroundColor:e.color,color:e.textColor||null},title:e.name,"aria-label":e.name,children:e.name})}),(0,m.jsx)("div",{className:"single-select-check-icon",children:n&&(0,m.jsx)(zl.In,{iconName:"check-mark"})})]})},e.id)}))}),[U,C,v,k,z,V,G]);return(0,m.jsxs)("div",{className:"sf-metadata-single-select-editor",style:Y,ref:O,children:[(0,m.jsx)("div",{className:"sf-metadata-search-single-select-options",children:(0,m.jsx)(zl.DO,{placeholder:(0,h.AP)("Search option"),onKeyDown:Q,onChange:H,autoFocus:!0,className:"sf-metadata-search-options"})}),(0,m.jsx)("div",{className:"sf-metadata-single-select-editor-container",ref:N,children:ee()}),B&&(0,m.jsx)(zl.NC,{callBack:W,footerName:"".concat((0,h.AP)("Add option")," ").concat(C),className:"add-search-result"})]})})),fh=hh,mh=function(e){var t=e.value,n=e.options,r=e.onDelete,o=(0,s.useMemo)((function(){if(!Array.isArray(t)||0===t.length)return[];var e=n.filter((function(e){return t.includes(e.id)||t.includes(e.name)})),r=t.filter((function(e){return e&&!n.find((function(t){return t.id===e||t.name===e}))})).map((function(e){return{id:e,name:(0,h.AP)(Ll),color:Rl}}));return[].concat((0,W.A)(e),(0,W.A)(r))}),[n,t]);return(0,m.jsx)("div",{className:"sf-metadata-delete-select-options",children:o.map((function(e){if(!e)return null;var t=e.id,n=e.name,o={display:"inline-flex",padding:"0px 10px",height:"20px",lineHeight:"20px",textAlign:"center",borderRadius:"10px",maxWidth:"250px",fontSize:13,backgroundColor:e.color,color:e.textColor||null,fill:e.textColor||"#666"};return(0,m.jsxs)("div",{className:"sf-metadata-delete-select-option",style:o,children:[(0,m.jsx)("span",{className:"sf-metadata-delete-select-option-name text-truncate",title:n,"aria-label":n,children:n}),(0,m.jsx)(zl.Oi,{className:"sf-metadata-delete-select-remove",onClick:function(e){return r(t,e)},iconName:"x-01"})]},t)}))})},gh=(0,s.forwardRef)((function(e,t){var n=e.height,r=e.saveImmediately,o=e.column,i=e.value,a=e.editorPosition,l=void 0===a?{left:0,top:0}:a,c=e.onCommit,u=e.onPressTab,d=e.modifyColumnData,p=(0,s.useState)($a(o,i)),f=(0,F.A)(p,2),g=f[0],v=f[1],y=(0,s.useState)(""),x=(0,F.A)(y,2),A=x[0],C=x[1],b=(0,s.useState)(-1),w=(0,F.A)(b,2),S=w[0],k=w[1],M=(0,s.useState)(0),j=(0,F.A)(M,2),I=j[0],_=j[1],P=(0,s.useRef)(null),N=(0,s.useRef)(null),O=(0,s.useRef)(null),T=window.sfMetadataContext.canModifyColumnData(o),E=(0,s.useMemo)((function(){return Ha(o)}),[o]),L=(0,s.useMemo)((function(){if(!A)return E;var e=A.toLowerCase().trim();return e?E.filter((function(t){return t.name&&t.name.toLowerCase().indexOf(e)>-1})):E}),[A,E]),U=(0,s.useMemo)((function(){return!(!T||!A)&&-1===L.findIndex((function(e){return e.name===A}))}),[T,L,A]),B=(0,s.useMemo)((function(){return{width:o.width}}),[o]),Y=(0,s.useCallback)((function(){c&&c(g)}),[g,c]),q=(0,s.useCallback)((function(e){A!==e&&C(e)}),[A]),H=(0,s.useCallback)((function(e){var t=g.slice(0),n=g.indexOf(e);n>-1?t.splice(n,1):t.push(e),v(t),r&&c&&c(t)}),[r,g,c]),G=(0,s.useCallback)((function(e){k(e)}),[]),z=(0,s.useCallback)((function(e){k(-1)}),[]),V=(0,s.useCallback)((function(e){e&&e.stopPropagation(),e&&e.nativeEvent.stopImmediatePropagation();var t=Du(E,(null===A||void 0===A?void 0:A.trim())||""),n=E.slice(0);n.push(t),d(o.key,{options:n},{options:o.data.options||[]}),H(t.id)}),[o,A,E,H,d]),W=(0,s.useCallback)((function(e){var t=g.slice(0),n=t.indexOf(e);n>-1&&t.splice(n,1),v(t),r&&c&&c(t)}),[r,g,c]),K=(0,s.useCallback)((function(){var e=getComputedStyle(P.current,null),t=getComputedStyle(O.current,null);return Math.floor(parseInt(e.maxHeight)/parseInt(t.height))-1}),[P,O]),X=(0,s.useCallback)((function(e){var t;if(e.preventDefault(),1===L.length?t=L[0]:S>-1&&(t=L[S]),t){var n=t.id;return g===t.id&&(n=null),void H(n)}var r=!1;A&&(r=!(!T||-1!==L.findIndex((function(e){return e.name===A})))),r&&0!==L.length&&V()}),[T,L,S,g,A,H,V]),$=(0,s.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),0!==S&&(k(S-1),S>L.length-I&&(P.current.scrollTop-=30))}),[P,S,I,L,30]),Z=(0,s.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),S!==L.length-1&&(k(S+1),S>=I&&(P.current.scrollTop+=30))}),[P,S,I,L,30]),J=(0,s.useCallback)((function(e){e.keyCode===R.cK.Enter?X(e):e.keyCode===R.cK.UpArrow?$(e):e.keyCode===R.cK.DownArrow?Z(e):e.keyCode===R.cK.Tab&&Xs(u)&&u(e)}),[X,$,Z,u]),Q=(0,s.useCallback)((function(e){e.keyCode!==R.cK.ChineseInputMethod&&e.keyCode!==R.cK.Enter&&e.keyCode!==R.cK.LeftArrow&&e.keyCode!==R.cK.RightArrow||e.stopPropagation()}),[]);(0,s.useEffect)((function(){N.current&&(N.current.getBoundingClientRect().bottom>window.innerHeight&&(N.current.style.top="unset",N.current.style.bottom=l.top+n-window.innerHeight+"px"));return P.current&&O.current&&_(K()),document.addEventListener("keydown",J,!0),function(){document.removeEventListener("keydown",J,!0)}}),[J]),(0,s.useEffect)((function(){var e=0===L.length?-1:0;k(e)}),[L]),(0,s.useImperativeHandle)(t,(function(){return{getValue:function(){var e=o.key;return(0,ro.default)({},e,g)},onBlur:function(){return Y()}}}),[o,g,Y]);var ee=(0,s.useCallback)((function(){if(0===L.length){var e=A?(0,h.AP)("No options available"):(0,h.AP)("No option");return(0,m.jsx)("span",{className:"none-search-result",children:e})}return L.map((function(e,t){var n=g.includes(e.id);return(0,m.jsx)("div",{className:"sf-metadata-single-select-item",ref:O,children:(0,m.jsxs)("div",{className:D()("single-select-container",{"single-select-container-highlight":t===S}),onMouseDown:function(){return H(e.id)},onMouseEnter:function(){return G(t)},onMouseLeave:function(){return z(t)},children:[(0,m.jsx)("div",{className:"single-select",children:(0,m.jsx)("span",{className:"single-select-name",style:{backgroundColor:e.color,color:e.textColor||null},title:e.name,"aria-label":e.name,children:e.name})}),(0,m.jsx)("div",{className:"single-select-check-icon",children:n&&(0,m.jsx)(zl.In,{iconName:"check-mark"})})]})},e.id)}))}),[L,A,g,S,G,z,H]);return(0,m.jsxs)("div",{className:"sf-metadata-single-select-editor sf-metadata-multiple-select-editor",style:B,ref:N,children:[(0,m.jsx)(mh,{value:g,options:E,onDelete:W}),(0,m.jsx)("div",{className:"sf-metadata-search-single-select-options",children:(0,m.jsx)(zl.DO,{placeholder:(0,h.AP)("Search option"),onKeyDown:Q,onChange:q,autoFocus:!0,className:"sf-metadata-search-options"})}),(0,m.jsx)("div",{className:"sf-metadata-single-select-editor-container",ref:P,children:ee()}),U&&(0,m.jsx)(zl.NC,{callBack:V,footerName:"".concat((0,h.AP)("Add option")," ").concat(A),className:"add-search-result"})]})})),vh=gh,yh=function(e){var t=e.value,n=e.onDelete,r=su().getCollaborator;return(0,m.jsx)("div",{className:"sf-metadata-delete-collaborator",children:Array.isArray(t)&&t.map((function(e){var t=r(e);if(!t)return null;var o=t.name,i=t.avatar_url;return(0,m.jsxs)("div",{className:"collaborator",children:[(0,m.jsx)("span",{className:"collaborator-avatar-container",children:(0,m.jsx)("img",{className:"collaborator-avatar m-0",alt:o,src:i})}),(0,m.jsx)("span",{className:"collaborator-name text-truncate",title:o,"aria-label":o,children:o}),(0,m.jsx)(zl.Oi,{className:"collaborator-remove",onClick:function(t){return n(e,t)},iconName:"x-01"})]},e)}))})},xh=(0,s.forwardRef)((function(e,t){var n=e.height,r=e.saveImmediately,o=void 0!==r&&r,i=e.column,a=e.value,l=e.editorPosition,c=void 0===l?{left:0,top:0}:l,u=e.onCommit,d=e.onPressTab,p=e.onClose,f=(0,s.useState)(a||[]),g=(0,F.A)(f,2),v=g[0],y=g[1],x=(0,s.useState)(""),A=(0,F.A)(x,2),C=A[0],b=A[1],w=(0,s.useState)(-1),S=(0,F.A)(w,2),k=S[0],M=S[1],j=(0,s.useState)(0),I=(0,F.A)(j,2),_=I[0],P=I[1],N=(0,s.useState)(0),O=(0,F.A)(N,2),T=O[0],E=O[1],L=(0,s.useRef)(null),U=(0,s.useRef)(null),B=(0,s.useRef)(null),Y=su().collaborators,q=(0,s.useMemo)((function(){var e=C?C.trim().toLowerCase():"",t=Array.isArray(Y)&&Y.length>0?Y:[];return e?t.filter((function(t){var n=t.name,r=t.name_pinyin,o=void 0===r?"":r;if(n.toString().toLowerCase().indexOf(e)>-1)return!0;if(!o)return!1;var i=o.toString().toLowerCase(),a=e.replace(/ |'/g,"");return i.indexOf(a)>-1||(i.replace(/'/g,"").indexOf(a)>-1||i.split("'").map((function(e){return e&&e.trim()?e.trim().slice(0,1):""})).join("").indexOf(a)>-1)})):t}),[C,Y]),H=(0,s.useCallback)((function(){u&&u()}),[u]),G=(0,s.useCallback)((function(e){C!==e&&b(e)}),[C]),z=(0,s.useCallback)((function(e){var t=v.slice(0),n=t.indexOf(e);n>-1?t.splice(n,1):t.push(e),y(t),o&&u&&u(t)}),[o,v,u]),V=(0,s.useCallback)((function(e){var t=v.slice(0),n=t.indexOf(e);n>-1&&t.splice(n,1),y(t),o&&u&&u(t)}),[o,v,u]),W=(0,s.useCallback)((function(e){M(e)}),[]),K=(0,s.useCallback)((function(e){M(-1)}),[]),X=(0,s.useCallback)((function(){var e=getComputedStyle(L.current,null),t=getComputedStyle(B.current,null);return Math.floor(parseInt(e.maxHeight)/parseInt(t.height))-1}),[L,B]),$=(0,s.useCallback)((function(e){var t;e.preventDefault(),1===q.length?t=q[0]:k>-1&&(t=q[k]),t&&z(t.email)}),[q,k,z]),Z=(0,s.useCallback)((function(e){if(e.preventDefault(),e.stopPropagation(),0===k)return M(q.length-1),void(L.current.scrollTop=0);M(k-1),k>q.length-_&&(L.current.scrollTop-=T)}),[L,k,_,q,T]),J=(0,s.useCallback)((function(e){if(e.preventDefault(),e.stopPropagation(),k===q.length-1)return M(0),void(L.current.scrollTop=0);M(k+1),k>=_&&(L.current.scrollTop+=T)}),[L,k,_,q,T]),Q=(0,s.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),H()}),[H]),ee=(0,s.useCallback)((function(e){e.keyCode===R.cK.Enter?$(e):e.keyCode===R.cK.UpArrow?Z(e):e.keyCode===R.cK.DownArrow?J(e):e.keyCode===R.cK.Tab?Xs(d)&&d(e):e.keyCode===R.cK.Esc&&Q(e)}),[$,Z,J,d,Q]),te=(0,s.useCallback)((function(e){e.keyCode!==R.cK.ChineseInputMethod&&e.keyCode!==R.cK.LeftArrow&&e.keyCode!==R.cK.RightArrow||e.stopPropagation()}),[]);(0,s.useEffect)((function(){U.current&&(U.current.getBoundingClientRect().bottom>window.innerHeight&&(U.current.style.top="unset",U.current.style.bottom=c.top+n-window.innerHeight+"px"));return L.current&&B.current&&(P(X()),E(parseInt(getComputedStyle(B.current,null).height))),document.addEventListener("keydown",ee,!0),function(){document.removeEventListener("keydown",ee,!0)}}),[ee]),(0,s.useEffect)((function(){var e=0===q.length?-1:0;M(e)}),[q]),(0,s.useImperativeHandle)(t,(function(){return{getValue:function(){var e=i.key;return(0,ro.default)({},e,v)},onBlur:function(){return H()},onClose:function(){return p()}}}),[i,v,H,p]);var ne=(0,s.useCallback)((function(){if(0===q.length){var e=C?(0,h.AP)("No collaborators available"):(0,h.AP)("No collaborators");return(0,m.jsx)("span",{className:"none-search-result",children:e})}return q.map((function(e,t){var n=v.includes(e.email);return(0,m.jsx)("div",{className:"sf-metadata-collaborator-item",ref:B,children:(0,m.jsxs)("div",{className:D()("collaborator-container",{"collaborator-container-highlight":t===k}),onMouseDown:function(){return z(e.email)},onMouseEnter:function(){return W(t)},onMouseLeave:function(){return K(t)},children:[(0,m.jsxs)("div",{className:"collaborator",children:[(0,m.jsx)("img",{className:"collaborator-avatar",alt:e.name,src:e.avatar_url}),(0,m.jsx)("span",{className:"collaborator-name",title:e.name,"aria-label":e.name,children:e.name})]}),(0,m.jsx)("div",{className:"collaborator-check-icon",children:n&&(0,m.jsx)(zl.In,{iconName:"check-mark"})})]})},e.email)}))}),[q,C,v,k,W,K,z]),re=c.left+300>window.innerWidth;return(0,m.jsxs)("div",{className:"sf-metadata-collaborator-editor",style:{top:-38,left:re?"unset":0,right:re?-i.width:"unset"},ref:U,children:[(0,m.jsx)(yh,{value:v,onDelete:V}),(0,m.jsx)("div",{className:"sf-metadata-search-collaborator-options",children:(0,m.jsx)(zl.DO,{placeholder:(0,h.AP)("Search collaborators"),onKeyDown:te,onChange:G,autoFocus:!0,className:"sf-metadata-search-collaborators"})}),(0,m.jsx)("div",{className:"sf-metadata-collaborator-editor-container",ref:L,children:ne()})]})})),Ah=xh,Ch=s.forwardRef((function(e,t){switch(e.column.type){case lo.FILE_NAME:return(0,m.jsx)(sh,(0,Sr.A)({ref:t},e));case lo.TEXT:return(0,m.jsx)(uh,(0,Sr.A)({ref:t},e));case lo.DATE:var n=window.sfMetadataContext.getSetting("lang");return(0,m.jsx)(zl.US,(0,Sr.A)((0,Sr.A)({ref:t},e),{},{lang:n}));case lo.NUMBER:return(0,m.jsx)(ph,(0,Sr.A)({ref:t},e));case lo.SINGLE_SELECT:return(0,m.jsx)(fh,(0,Sr.A)({ref:t},e));case lo.MULTIPLE_SELECT:return(0,m.jsx)(vh,(0,Sr.A)({ref:t},e));case lo.COLLABORATOR:return(0,m.jsx)(Ah,(0,Sr.A)({ref:t},e));default:return null}})),bh=function(e){function t(){var e;(0,r.A)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=(0,i.A)(this,t,[].concat(o))).state={isInvalid:!1},e.changeCommitted=!1,e.changeCanceled=!1,e.isKeyExplicitlyHandled=function(t){return Xs(e["onPress"+t])},e.checkAndCall=function(t,n){Xs(e[t])&&e[t](n)},e.onKeyDown=function(t){if(Lp(t))e.checkAndCall("onPressKeyWithCtrl",t);else if(e.isKeyExplicitlyHandled(t.key)){var n="onPress"+t.key;e.checkAndCall(n,t)}else Rp(t.keyCode)&&(t.stopPropagation(),e.checkAndCall("onPressChar",t));e._keysDown=e._keysDown||{},e._keysDown[t.keyCode]=!0,Xs(e.props.onGridKeyDown)&&e.props.onGridKeyDown(t)},e.onScroll=function(e){e.stopPropagation()},e.setEditorRef=function(t){e.editor=t},e.createEditor=function(){var t=e.props,n=t.column,r=t.record,o=t.openEditorMode,i=t.columns,a=t.modifyColumnData,s={ref:e.setEditorRef,readOnly:!Uc(n,r,!0),columns:i,column:e.props.column,value:e.getInitialValue(),mode:o,onCommit:e.commit,onCommitData:e.commitData,onCommitCancel:e.commitCancel,recordMetaData:e.getRecordMetaData(),record:e.props.record,height:e.props.height,onBlur:e.commit,onOverrideKeyDown:e.onKeyDown,modifyColumnData:a};return(0,m.jsx)(Ch,(0,Sr.A)({},s))},e.onPressEnter=function(){},e.onPressTab=function(){e.commit({key:"Tab"})},e.onPressEscape=function(t){e.editorIsSelectOpen()?t.stopPropagation():e.commitCancel()},e.onPressArrowDown=function(t){e.editorHasResults()?t.stopPropagation():e.commit(t)},e.onPressArrowUp=function(t){e.editorHasResults()?t.stopPropagation():e.commit(t)},e.onPressArrowLeft=function(t){e.isCaretAtBeginningOfInput()?e.commit(t):t.stopPropagation()},e.onPressArrowRight=function(t){e.isCaretAtEndOfInput()?e.commit(t):t.stopPropagation()},e.editorHasResults=function(){return!!Xs(e.getEditor().hasResults)&&e.getEditor().hasResults()},e.editorIsSelectOpen=function(){return!!Xs(e.getEditor().isSelectOpen)&&e.getEditor().isSelectOpen()},e.getRecordMetaData=function(){if("function"===typeof e.props.column.getRecordMetaData)return e.props.column.getRecordMetaData(e.props.record,e.props.column)},e.getEditor=function(){return e.editor},e.getInputNode=function(){if(e.getEditor().getInputNode)return e.getEditor().getInputNode()},e.getInitialValue=function(){var t=e.props,n=t.firstEditorKeyDown,r=t.value;return"Enter"===n?r:n||r},e.getContainerClass=function(){return D()({"rdg-editor-container":!0,"table-cell-editor":!0,"has-error":!0===e.state.isInvalid})},e.getOldRowData=function(t){var n=e.props.column,r=n.key,o=n.name,i=t;if(e.getEditor().getOldValue){var a=e.getEditor().getOldValue();i=a[Object.keys(a)[0]]}return{oldRowData:($o.includes(r),(0,ro.default)({},o,i)),originalOldRowData:(0,ro.default)({},r,t)}},e.commit=function(t){var n=e.props,r=n.record,o=n.column,i=o.key,a=o.type,s=ba(r,o),l=e.getEditor().getValue();up(s,l[i],a)?e.commitData(l,!0):e.props.onCommitCancel()},e.commitData=function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.isNewValueValid(t)){var r=e.props,o=r.onCommit,i=r.record,a=r.column,s=a.key,l=a.name;e.changeCommitted=!0;var c=i._id,u=ba(i,a),d=t[Object.keys(t)[0]],p=$o.includes(s)?(0,ro.default)({},s,d):(0,ro.default)({},l,d),h=e.getOldRowData(u);o({rowId:c,cellKey:s,updates:p,originalUpdates:t,oldRowData:h.oldRowData,originalOldRowData:h.originalOldRowData},n)}},e.commitCancel=function(){e.changeCanceled=!0,e.props.onCommitCancel()},e.isNewValueValid=function(t){if(Xs(e.getEditor().validate)){var n=e.getEditor().validate(t);return e.setState({isInvalid:!n}),n}return!0},e.setCaretAtEndOfInput=function(){var t=e.getInputNode(),n=t.value.length;if(t.setSelectionRange)t.setSelectionRange(n,n);else if(t.createTextRange){var r=t.createTextRange();r.moveStart("character",n),r.collapse(),r.select()}},e.isCaretAtBeginningOfInput=function(){var t=e.getInputNode();return t.selectionStart===t.selectionEnd&&0===t.selectionStart},e.isCaretAtEndOfInput=function(){var t=e.getInputNode();return t.selectionStart===t.value.length},e.handleRightClick=function(e){e.stopPropagation()},e.setTextInputFocus=function(){var t=e.props.firstEditorKeyDown,n=e.getInputNode();n.focus(),"INPUT"===n.tagName&&(Rp(t)||n.focus(),n.select())},e.onClickOutside=function(t){var n=Ql(t);n&&n.includes("drag-handle")||(e.commit(),e.props.onCommitCancel(),window.sfMetadataContext.eventBus.dispatch(sl))},e}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this.getInputNode();void 0!==e&&(this.setTextInputFocus(),this.getEditor().disableContainerStyles||(e.className+=" editor-main",e.style.height=this.props.height-1+"px"))}},{key:"componentDidUpdate",value:function(e){e.scrollLeft===this.props.scrollLeft&&e.scrollTop===this.props.scrollTop||this.commitCancel()}},{key:"componentWillUnmount",value:function(){this.changeCommitted||this.changeCanceled||this.commit()}},{key:"render",value:function(){var e=this.props,t=e.width,n={position:"absolute",height:e.height,width:t,left:e.left,top:e.top,zIndex:9};return(0,m.jsx)(zl.ij,{onClickOutside:this.onClickOutside,children:(0,m.jsx)("div",{style:n,className:this.getContainerClass(),onKeyDown:this.onKeyDown,onScroll:this.onScroll,onContextMenu:this.handleRightClick,children:this.createEditor()})})}}])}(s.Component);bh.displayName="EditorContainer";var wh=bh,Sh=[lo.CTIME,lo.MTIME,lo.CREATOR,lo.LAST_MODIFIER,lo.FILE_NAME],Dh=function(e){function t(e){var n;(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).changeCommitted=!1,n.changeCanceled=!1,n.editingRowId=n.props.record._id,n.setEditorRef=function(e){n.editor=e},n.createEditor=function(){var e,t=n.props,r=t.column,o=t.record,i=t.height,a=t.onPressTab,s=t.editorPosition,l=t.columns,c=t.modifyColumnData,u=Uc(r,o,!0)||Sh.includes(r.type),d=n.getInitialValue(u),p={ref:n.setEditorRef,value:d,recordMetaData:n.getRecordMetaData(),onBlur:n.commit,onCommit:n.commit,onCommitData:n.commitData,onCommitCancel:n.commitCancel,onClose:n.closeEditor,onEscape:n.closeEditor,editorContainer:n.getEditorContainer(),modifyColumnData:c,editorPosition:s,record:o,height:i,columns:l,column:r,readOnly:u,onPressTab:a};r.type===lo.DATE&&(p.format=null===r||void 0===r||null===(e=r.data)||void 0===e?void 0:e.format);return(0,m.jsx)(Ch,(0,Sr.A)({},p))},n.getEditorContainer=function(){return n.props.column.type===lo.DATE?document.body:null},n.getRecordMetaData=function(){if("function"===typeof n.props.column.getRecordMetaData){var e=n.props,t=e.record,r=e.column;return n.props.column.getRecordMetaData(t,r)}},n.getEditor=function(){return n.editor},n.getInitialValue=function(e){var t=n.props,r=t.firstEditorKeyDown,o=t.value;return"Enter"===r?o:n.props.column.type===lo.LONG_TEXT?" "===r||e?o:r||o:o},n.getOldRowData=function(e){var t=n.props.column,r=Ec(t),o=t.key,i=t.type,a=e;if(n.getEditor().getOldValue){var s=n.getEditor().getOldValue();a=s[Object.keys(s)[0]]}return i===lo.LONG_TEXT&&(a=n.getEditor().getValue()),{oldRowData:(0,ro.default)({},r,a),originalOldRowData:(0,ro.default)({},o,e)}},n.commit=function(){var e=n.props,t=e.column;if(e.record._id){var r=t.key,o=t.type,i=n.getEditor().getValue(),a=o===lo.DATE?(0,ro.default)({},r,i):i;o===lo.SINGLE_SELECT?a[r]=i[r]?function(e,t){if($o.includes(e.key))return t;var n=Ha(e);return Ka(n,t)}(t,i[r]):"":o===lo.MULTIPLE_SELECT&&(a[r]=i[r]?Xa(t,i[r]):[]),n.commitData(a,!0)}},n.commitData=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=n.props,o=r.onCommit,i=r.column,a=r.record,s=i.key,l=i.type,c=i.name,u=ba(a,i),d=(0,Sr.A)({},e);if(up(u,d[s],l)&&n.isNewValueValid(e)){n.changeCommitted=!0;var p=a._id,h=Object.keys(e)[0],f=e[h],m=$o.includes(s)?(0,ro.default)({},s,f):(0,ro.default)({},c,f);l===lo.LONG_TEXT&&(d[h]=f.text);var g=n.getOldRowData(u);o({rowId:p,cellKey:s,updates:m,originalUpdates:d,oldRowData:g.oldRowData,originalOldRowData:g.originalOldRowData},t)}else t&&"function"===typeof n.editor.onClose&&n.editor.onClose()},n.commitCancel=function(){n.changeCanceled=!0,n.props.onCommitCancel()},n.isNewValueValid=function(e){if(Xs(n.getEditor().validate)){var t=n.getEditor().validate(e);return n.setState({isInvalid:!t}),t}return!0},n.handleRightClick=function(e){e.stopPropagation()},n.closeEditor=function(e){return n.props.column.type!==lo.DATE||e?function(){return n.onClickOutside(e)}:null},n.onClickOutside=function(e){n.commit(),n.props.onCommitCancel(),!e&&window.sfMetadataContext.eventBus.dispatch(sl)};var o=n.props,a=o.column,s=o.width,l=o.height,c=o.left,u=o.top,d={};return a.type!==lo.SINGLE_SELECT&&a.type!==lo.MULTIPLE_SELECT||(d={width:s,height:l}),n.state={isInvalid:!1,style:(0,Sr.A)({position:"absolute",zIndex:9,left:c,top:u},d)},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidUpdate",value:function(e){e.scrollLeft===this.props.scrollLeft&&e.scrollTop===this.props.scrollTop||this.commitCancel()}},{key:"componentWillUnmount",value:function(){this.changeCommitted||this.changeCanceled||this.commit()}},{key:"render",value:function(){return(0,m.jsx)(zl.ij,{onClickOutside:this.onClickOutside,children:(0,m.jsx)("div",{style:this.state.style,className:D()({"has-error":!0===this.state.isInvalid}),onContextMenu:this.handleRightClick,ref:this.props.innerRef,children:this.createEditor()})})}}])}(s.Component);Dh.displayName="PopupEditorContainer";var kh=Dh,Mh=function(e){return(0,m.jsx)(Ch,(0,Sr.A)({},e))},jh=[lo.DATE,lo.COLLABORATOR,lo.SINGLE_SELECT,lo.MULTIPLE_SELECT,lo.LONG_TEXT],Ih=[lo.FILE_NAME],_h=function(e){var t=e.column;if(!t)return null;var n=t.type;return jh.includes(n)?(0,m.jsx)(kh,(0,Sr.A)({},e)):Ih.includes(n)?(0,m.jsx)(Mh,(0,Sr.A)({},e)):(0,m.jsx)(wh,(0,Sr.A)({},e))},Ph=[lo.FILE_NAME],Nh=[lo.CHECKBOX],Oh=function(e){function t(e){var n;(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).throttle=null,n.onColumnSelect=function(e){var t=n.props,r=t.columns,o=t.isGroupView,i=t.recordsCount;if(!o){for(var a=0,s=0;s<r.length;s++)if(e.key===r[s].key){a=s;break}n.setState({selectedPosition:(0,Sr.A)((0,Sr.A)({},n.state.selectedPosition),{},{idx:a,rowIdx:0}),selectedRange:{startCell:{idx:a,rowIdx:0},topLeft:{idx:a,rowIdx:0},bottomRight:{idx:a,rowIdx:i-1},isDragging:!1}})}},n.onOpenEditorEvent=function(e){n.setState({openEditorMode:e},(function(){n.openEditor()}))},n.onCloseEditorEvent=function(){n.state.isEditorEnabled&&n.closeEditor()},n.onSelectCell=function(e,t){var r=n.state,o=r.selectedPosition,i=r.isEditorEnabled,a=t?n.openEditor:function(){return null};i&&n.closeEditor(),n.setState((function(t){var r=(0,Sr.A)((0,Sr.A)({},o),e);return n.isCellWithinBounds(r)?{selectedPosition:r,selectedRange:{topLeft:r,bottomRight:r,startCell:r,cursorCell:r,isDragging:!1}}:t}),a)},n.selectNone=function(){var e={idx:-1,rowIdx:-1,groupRecordIndex:-1};n.setState({selectedPosition:e,selectedRange:{topLeft:e,bottomRight:e,startCell:null,cursorCell:null}}),n.props.selectNone()},n.getSelectedPosition=function(){var e=n.state.selectedRange,t=e.topLeft,r=e.bottomRight;return{top:t.rowIdx,bottom:r.rowIdx,left:t.idx,right:r.idx}},n.getSelectedRange=function(){return n.state.selectedRange},n.selectCell=function(e,t,r){var o={idx:r,groupRecordIndex:e,rowIdx:t};n.setState({selectedPosition:o,selectedRange:{topLeft:o,bottomRight:o,startCell:o,cursorCell:o}})},n.openEditor=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;n.isSelectedCellIsLongText()&&(e&&e.stopPropagation(),e&&e.preventDefault());var t=(e||{}).key,r=n.state,o=r.selectedPosition,i=r.openEditorMode,a=n.props.columns,s=Pp({selectedPosition:o,columns:a}).type;if(Nh.includes(s))return null;(n.isSelectedCellEditable()||i===Bl&&Ph.includes(s))&&!n.state.isEditorEnabled&&n.setState({isEditorEnabled:!0,firstEditorKeyDown:t,editorPosition:n.getEditorPosition()})},n.closeEditor=function(){n.setState({isEditorEnabled:!1,firstEditorKeyDown:null,editorPosition:null,openEditorMode:""})},n.onSelectCellRangeStarted=function(e){if(n.isCellWithinBounds(e)){var t=n.createSingleCellSelectedRange(e,!0);n.setState({selectedRange:t},(function(){Xs(n.props.onCellRangeSelectionStarted)&&n.props.onCellRangeSelectionStarted(n.state.selectedRange)}))}},n.onSelectCellRangeUpdated=function(e,t,r){if((n.state.selectedRange.isDragging||t)&&n.isCellWithinBounds(e)){var o=function(e,t){var n=e.idx,r=e.rowIdx,o=e.groupRecordIndex,i=t.idx,a=t.rowIdx,s=t.groupRecordIndex,l=[n,i].sort((function(e,t){return e-t})),c=[r,a].sort((function(e,t){return e-t})),u=[o,s].sort((function(e,t){return e-t}));return{topLeft:{idx:l[0],rowIdx:c[0],groupRecordIndex:u[0]},bottomRight:{idx:l[1],rowIdx:c[1],groupRecordIndex:u[1]}}}(n.state.selectedRange.startCell||n.state.selectedPosition,e),i=o.topLeft,a=o.bottomRight,s=(0,Sr.A)((0,Sr.A)({startCell:n.state.selectedPosition},n.state.selectedRange),{},{topLeft:i,bottomRight:a,cursorCell:e});n.setState({selectedRange:s},(function(){Xs(n.props.onCellRangeSelectionUpdated)&&n.props.onCellRangeSelectionUpdated(n.state.selectedRange),Xs(r)&&r(n.state.selectedRange)}))}},n.onSelectCellRangeEnded=function(){var e=(0,Sr.A)((0,Sr.A)({},n.state.selectedRange),{},{isDragging:!1});n.setState({selectedRange:e},(function(){Xs(n.props.onCellRangeSelectionCompleted)&&n.props.onCellRangeSelectionCompleted(n.state.selectedRange)}))},n.focus=function(){n.selectionMask&&!n.isFocused()&&n.selectionMask.focus()},n.isFocused=function(){return document.activeElement===n.selectionMask},n.isCellSelected=function(){var e=n.state.selectedPosition;return-1!==e.idx&&-1!==e.rowIdx},n.isCellWithinBounds=function(e){var t=e.idx,r=e.rowIdx,o=n.props,i=o.columns,a=o.recordsCount;return r>=0&&r<a&&t>=0&&t<i.length},n.isSelectedCellEditable=function(){var e=n.props,t=e.enableCellSelect,r=e.columns,o=e.isGroupView,i=e.recordGetterByIndex,a=e.onCheckCellIsEditable,s=function(e){var t=e.enableCellSelect,n=e.selectedPosition,r=e.columns,o=e.isGroupView,i=e.recordGetterByIndex,a=e.onCheckCellIsEditable,s=Pp({selectedPosition:n,columns:r}),l=_p({selectedPosition:n,isGroupView:o,recordGetterByIndex:i});return!!window.sfMetadataContext.canModifyRow(l)&&(!Xs(a)||a((0,Sr.A)({row:l,column:s},n)))&&Uc(s,l,t)}({enableCellSelect:t,columns:r,isGroupView:o,recordGetterByIndex:i,selectedPosition:n.state.selectedPosition,onCheckCellIsEditable:a});return s},n.isSelectedCellIsLongText=function(){var e=n.props.columns,t=n.state.selectedPosition,r=Pp({selectedPosition:t,columns:e});return r&&r.type===lo.LONG_TEXT},n.isGridSelected=function(){return n.isCellWithinBounds(n.state.selectedPosition)},n.getSelectedDimensions=function(e){var t=n.props,r=t.columns,o=t.rowHeight,i=t.isGroupView,a=t.groupOffsetLeft,s=t.getRowTop,l=n.props.getScrollLeft();return(0,Sr.A)({},function(e){var t=e.selectedPosition,n=e.columns,r=e.rowHeight,o=e.scrollLeft,i=e.isGroupView,a=e.groupOffsetLeft,s=e.getRecordTopFromRecordsBody,l=t.idx,c=t.rowIdx,u=t.groupRecordIndex,d={width:0,left:0,top:0,height:r,zIndex:1};if(l>=0){var p=n&&n[l];if(!p)return d;var h,f=p.frozen,m=p.width,g=f?o+p.left:p.left;return i?(g+=a,h=s(u)+1):h=s(c),{width:m,left:g,top:h,height:r,zIndex:f?3:1}}return d}({selectedPosition:e,columns:r,scrollLeft:l,rowHeight:o,isGroupView:i,groupOffsetLeft:a,getRecordTopFromRecordsBody:s}))},n.getSelectedRangeDimensions=function(e){var t=n.props,r=t.columns,o=t.rowHeight,i=t.isGroupView,a=t.groups,s=t.groupMetrics,l=t.groupOffsetLeft,c=t.getRowTop;return(0,Sr.A)({},Tp({selectedRange:e,columns:r,rowHeight:o,isGroupView:i,groups:a,groupMetrics:s,groupOffsetLeft:l,getRecordTopFromRecordsBody:c}))},n.setScrollLeft=function(e,t){var r=n,o=r.selectionMask,i=r.state.selectedPosition;n.setMaskScrollLeft(o,i,e,t)},n.geHeaderHeight=function(){var e=n.props.table.header_settings||{};return(($s(e)?ea:e.header_height)===ta?56:32)+1},n.setMaskScrollLeft=function(e,t,r,o){var i=n.geHeaderHeight();if(e){var a=t.idx,s=t.rowIdx,l=t.groupRecordIndex;if(a>=0&&s>=0){var c=n.props,u=c.columns,d=c.getRowTop,p=c.isGroupView,h=c.groupOffsetLeft,f=u[a];if(!!f.frozen){var m=-o+d(p?l:s)+i,g=f.left;p&&(m+=1,g+=h),e.style.position="fixed",e.style.top=m+"px",e.style.left=g+"px",e.style.transform="none"}}}},n.cancelSetScrollLeft=function(){n.selectionMask&&n.cancelSetMaskScrollLeft(n.selectionMask,n.state.selectedPosition)},n.cancelSetMaskScrollLeft=function(e,t){var r=n.getSelectedDimensions(t),o=r.left,i=r.top;e.style.position="absolute",e.style.top=0,e.style.left=0,e.style.transform="translate(".concat(o,"px, ").concat(i,"px)")},n.getEditorPosition=function(){if(n.selectionMask){var e=n.props.editorPortalTarget,t=n.selectionMask.getBoundingClientRect(),r=t.left,o=t.top;if(e===document.body){var i=document.scrollingElement||document.documentElement;return{left:r+i.scrollLeft,top:o+i.scrollTop}}var a=e.getBoundingClientRect(),s=a.left,l=a.top;return{left:r-s+e.scrollLeft,top:o-l+e.scrollTop}}},n.onCommit=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];n.props.modifyRecord(e),t&&n.closeEditor()},n.onCommitCancel=function(){n.closeEditor()},n.onKeyDown=function(e){var t=e.keyCode;if(Lp(e))n.onPressKeyWithCtrl(e);else if(t===so().Escape)n.onPressEscape(e);else if(t===so().Tab)n.onPressTab(e);else if(n.isKeyboardNavigationEvent(e))n.changeCellFromEvent(e);else if(Rp(t)||t===so().Enter)n.openEditor(e);else if(t===so().Backspace||t===so().Delete){"rdg-selected"===e.target.className&&(e.preventDefault(),n.handleSelectCellsDelete())}},n.handleSelectCellsDelete=function(){var e=n.props,t=e.isGroupView,r=e.recordGetterByIndex,o=e.columns,i=n.state.selectedRange,a=i.topLeft,s=i.bottomRight,l=Ep({selectedRange:i,isGroupView:t,recordGetterByIndex:r}).filter((function(e){return window.sfMetadataContext.canModifyRow(e)}));if(0!==l.length){for(var c=a.idx,u=s.idx,d=[],p=[],h=c;h<=u;h++){var f=o[h];if(!f||wo[f.type]||!window.sfMetadataContext.canModifyColumn(f))break;var m=f.type,g=f.data;d.push(f),m===lo.LINK&&g&&p.push(f)}if(0!==d.length){var v=[],y={},x={},A={},C={},b={},w={};if(l.forEach((function(e){var t=e._id,n={},r={},o={};if(d.forEach((function(t){var o=t.key,i=t.name,a=e[o]||e[i];(a||0===a||Array.isArray(a)&&a.length>0)&&(r[o]=a,n[o]=null)})),Object.keys(o).length>0&&(b[t]=o,w[t]={}),Object.keys(n).length>0){v.push(t);var i=zp(d,n),a=zp(d,r);y[t]=i,x[t]=n,A[t]=a,C[t]=r}})),v.length>0){n.props.updateRecords({recordIds:v,idRecordUpdates:y,idOriginalRecordUpdates:x,idOldRecordData:A,idOriginalOldRecordData:C,isCopyPaste:!0})}}}},n.onCopySelected=function(){n.onCopyCells()},n.onCopy=function(e){e.preventDefault();var t=n.props.recordMetrics,r=$p.getSelectedIds(t);if(r.length>0)n.copyRows(e,r);else{var o=window.getSelection().toString();if(!o&&e.target.value){var i=e.target,a=i.selectionStart,s=i.selectionEnd;o=e.target.value.substring(a,s)}o?n.copyText(e,o):n.isCellMaskActive()&&n.onCopyCells(e)}},n.onPaste=function(e){if(n.isCellMaskActive()&&"r"!==window.sfMetadataContext.getPermission()){var t=n.props,r=t.columns,o=t.isGroupView,i=n.state,a=i.selectedPosition,s=i.selectedRange,l=a.idx,c=a.rowIdx;if(-1!==l&&-1!==c){var u=Jl(e);if(u){var d=u.type,p=u[kl.DTABLE_FRAGMENT],h=0,f=0;if(d===kl.DTABLE_FRAGMENT){var m=p.selectedRecordIds,g=p.copiedRange;if(Array.isArray(m)&&m.length>0)h=m.length,f=r.length;else{var v=g.topLeft,y=g.bottomRight,x=v.idx,A=v.rowIdx,C=y.idx;h=y.rowIdx-A+1,f=C-x+1}}else{var b=p.copiedRecords,w=p.copiedColumns;h=b.length,f=w.length}var S=n.isMultiplePaste(h,f);n.props.paste({copied:p,multiplePaste:S,type:d,pasteRange:s,isGroupView:o}),S||n.setPasteRange(h,f)}}}},n.copyText=function(e,t){th({type:"text",event:e,copiedText:t})},n.copyRows=function(e,t){var r=n.props,o=r.table,i=r.columns,a=r.recordGetterById,s=r.isGroupView,l=r.getCopiedRecordsAndColumnsFromRange,c=t.length;j.A.success(c>1?(0,h.AP)("xxx rows are copied.").replace("xxx",c):(0,h.AP)("1 row is copied."));var u=kl.DTABLE_FRAGMENT,d=l({type:u,copied:{selectedRecordIds:t},isGroupView:s}),p=d.copiedRecords,f=d.copiedColumns,m=o._id;th({type:u,event:e,selectedRecordIds:t,copiedRecords:p,copiedColumns:f,copiedTableId:m,tableData:{columns:i},recordGetterById:a})},n.onCopyCells=function(e){var t=n.props,r=t.table,o=t.columns,i=t.isGroupView,a=t.recordGetterByIndex,s=t.getCopiedRecordsAndColumnsFromRange,l=n.state,c=l.selectedPosition,u=l.selectedRange,d=r._id,p=c.rowIdx,f=c.idx;if(!(p<0||f<0)){var m=u.topLeft,g=u.bottomRight,v=kl.DTABLE_FRAGMENT,y=(g.rowIdx-m.rowIdx+1)*(g.idx-m.idx+1);j.A.success(y>1?(0,h.AP)("xxx cells copied").replace("xxx",y):(0,h.AP)("1 cell copied"));var x=s({type:v,copied:{copiedRange:u},isGroupView:i}),A=x.copiedRecords,C=x.copiedColumns;th({type:v,event:e,copiedRange:(0,Sr.A)({},u),copiedRecords:A,copiedColumns:C,copiedTableId:d,tableData:{columns:o},isGroupView:i,recordGetterByIndex:a})}},n.isMultiplePaste=function(e,t){var r=n.state.selectedRange,o=r.topLeft,i=r.bottomRight,a=o.idx,s=o.rowIdx,l=i.idx,c=i.rowIdx;return Number.isInteger((l-a+1)/t)&&Number.isInteger((c-s+1)/e)},n.setPasteRange=function(e,t){var r=n.props,o=r.recordsCount,i=r.columns,a=n.state,s=a.selectedPosition,l=a.selectedRange,c=l.topLeft,u=c.idx,d=c.rowIdx,p=i.length,h=s.groupRecordIndex,f=u+t-1,m=d+e-1;f>=p&&(f=p-1),m>=o&&(m=o-1);var g={topLeft:c,startCell:s,bottomRight:{idx:f,rowIdx:m,groupRecordIndex:h},cursorCell:{idx:s.idx,rowIdx:s.rowIdx,groupRecordIndex:h}};return n.setState({selectedRange:(0,Sr.A)((0,Sr.A)({},l),g)},(function(){n.focus()})),g},n.onPressKeyWithCtrl=function(){},n.onPressEscape=function(){},n.onPressTab=function(e){n.changeCellFromEvent(e)},n.getLeftInterval=function(){var e=n.props,t=e.isGroupView,r=e.columns,o=e.groupOffsetLeft,i=e.frozenColumnsWidth,a=0;return!!r[0]&&r[0].frozen?(a=o+i,t&&(a+=o)):a=0,a},n.handleVerticalArrowAction=function(e,t){var r=n.props,o=r.isGroupView,i=r.groupMetrics,a=r.rowHeight,s="ArrowDown"===t?1:-1;if(o){for(var l,c=(i.groupRows||[]).length,u=e.groupRecordIndex+s;u>0&&u<c&&(l=Mp(u,i)).type!==Nl;)u+=s;if(!l||l.type!==Nl)return;var d,p=n.props.getGroupCanvasScrollTop()||0,h=l,f=h.rowIdx,m=h.top;return m<=p+16?d=m-16:m+150-p>=window.innerHeight-32-16&&(d=m+150-window.innerHeight+32+a+16),void 0!==d&&n.props.setGroupCanvasScrollTop(d),(0,Sr.A)((0,Sr.A)({},e),{},{rowIdx:f,groupRecordIndex:u})}return(0,Sr.A)((0,Sr.A)({},e),{},{rowIdx:e.rowIdx+s})},n.handleLeftArrowAction=function(e){var t=n.selectionMask;if(t){var r=n.props.columns,o=t.getBoundingClientRect(),i=n.getLeftInterval(),a=r[e.idx-1]?r[e.idx-1].width:0,s=n.props.getTableContentRect(),l=s.left,c=s.right,u=l+130;if(o.x<0||o.x>c)n.props.scrollToColumn(e.idx-1);else if(a>o.x-i-u){var d=a-(o.x-i-u);n.props.setRecordsScrollLeft(n.props.getScrollLeft()-d)}return(0,Sr.A)((0,Sr.A)({},e),{},{idx:0===e.idx?0:e.idx-1})}},n.handleRightArrowAction=function(e){var t=n.selectionMask;if(t){var r=n.props.columns,o=t.getBoundingClientRect(),i=e.idx,a=r[i];if(1===i&&!0===a.frozen)n.props.scrollToColumn(1);else{var s=n.props.getTableContentRect().right,l=r[i+1]?r[i+1].width:0;if(o.x<0||o.x>s)n.props.scrollToColumn(i+1);else if(o.x+o.width+l>s){var c=l-(s-o.x-o.width);n.props.setRecordsScrollLeft(n.props.getScrollLeft()+c)}}return(0,Sr.A)((0,Sr.A)({},e),{},{idx:e.idx+1})}},n.getKeyNavActionFromEvent=function(e){var t=n.props,r=t.getVisibleIndex,o=t.onHitBottomBoundary,i=t.onHitTopBoundary,a=r(),s=a.rowVisibleStartIdx,l=a.rowVisibleEndIdx,c={ArrowDown:{getNext:function(e){return n.handleVerticalArrowAction(e,"ArrowDown")},isCellAtBoundary:function(e){return e.rowIdx>=l-1},onHitBoundary:o},ArrowUp:{getNext:function(e){return n.handleVerticalArrowAction(e,"ArrowUp")},isCellAtBoundary:function(e){return 0!==e.rowIdx&&e.rowIdx<=s},onHitBoundary:i},ArrowRight:{getNext:function(e){return n.handleRightArrowAction(e)},isCellAtBoundary:function(){return!1}},ArrowLeft:{getNext:function(e){return n.handleLeftArrowAction(e)},isCellAtBoundary:function(){return!1}}};return e.keyCode===so().Tab?!0===e.shiftKey?c.ArrowLeft:c.ArrowRight:c[e.key]},n.changeCellFromEvent=function(e){if(e.preventDefault(),(e.keyCode!==so().ChineseInputMethod||!n.state.isEditorEnabled)&&!n.throttle){var t=n.state.selectedPosition,r=n.getKeyNavActionFromEvent(e),o=r.getNext(t);o&&(n.checkIsAtGridBoundary(r,o),n.props.onCellClick(o),n.onSelectCell((0,Sr.A)({},o)),n.throttle=!0,setTimeout((function(){n.throttle=!1}),30))}},n.onFocus=function(){},n.onScroll=function(e){e.stopPropagation()},n.setSelectionMaskRef=function(e){n.selectionMask=e},n.setSelectionRangeMaskRef=function(e){n.selectedRangeMask=e},n.setContainerRef=function(e){n.container=e},n.isCellMaskActive=function(){var e=document.activeElement;return e&&("cell-mask"===e.getAttribute("data-test")||"active-editor"===e.getAttribute("data-test"))},n.handleDragCopy=function(e){var t=n.props,r=t.columns,o=t.groupMetrics,i=t.table,a=i.rows,s=i.id_row_map,l=t.gridUtils,c=t.updateRecords,u=l.getUpdateDraggedRecords(e,r,a,s,o);c((0,Sr.A)((0,Sr.A)({},u),{},{isCopyPaste:!0}))},n.handleDragStart=function(e){var t=n.state.selectedRange,r=t.topLeft,o=t.bottomRight,i=t.startCell,a=t.cursorCell,s=e&&e.target&&e.target.className;if(r.idx>-1&&s){try{e.dataTransfer.setData("text/plain","")}catch(l){e.dataTransfer.setData("text","")}n.setState({draggedRange:{topLeft:r,bottomRight:o,startCell:i,cursorCell:a}})}},n.handleDragEnter=function(e){var t=e.overRecordIdx,r=e.overGroupRecordIndex;null!=n.state.draggedRange&&n.setState((function(e){var n=e.draggedRange;return{draggedRange:(0,Sr.A)((0,Sr.A)({},n),{},{overRecordIdx:t,overGroupRecordIndex:r})}}))},n.handleDragEnd=function(){var e=n.state,t=e.draggedRange,r=e.selectedRange,o=Gl()(r);if(null!==t){var i=t.overRecordIdx,a=t.overGroupRecordIndex,s=t.bottomRight;null!==i&&s.rowIdx<i&&(n.handleDragCopy(t),o.bottomRight.rowIdx=i,o.cursorCell.rowIdx=i,o.bottomRight.groupRecordIndex=a,o.cursorCell.groupRecordIndex=a),n.setState({draggedRange:null,selectedRange:o})}},n.renderSingleCellSelectView=function(){var e=n.props.columns,t=n.state,r=t.isEditorEnabled,o=t.selectedPosition,i=n.isSelectedCellEditable(),a=window.sfMetadataContext.canModifyRows(),s=i&&a,l=(Pp({selectedPosition:o,columns:e})||{}).type;if(r&&l!==lo.RATE&&l!==lo.CHECKBOX&&l!==lo.FILE_NAME)return null;if(!n.isGridSelected())return null;var c={innerRef:n.setSelectionMaskRef,selectedPosition:o,getSelectedDimensions:n.getSelectedDimensions};return(0,m.jsx)(Hp,(0,Sr.A)((0,Sr.A)({},c),{},{children:s?(0,m.jsx)(rh,{onDragStart:n.handleDragStart,onDragEnd:n.handleDragEnd}):null}))},n.renderCellRangeSelectView=function(){var e=n.state.selectedRange,t=n.props,r=t.columns,o=t.rowHeight,i=n.isSelectedCellEditable(),a=window.sfMetadataContext.canModifyRows(),s=i&&a;return[(0,m.jsx)(qp,{innerRef:n.setSelectionRangeMaskRef,selectedRange:e,columns:r,rowHeight:o,getSelectedRangeDimensions:n.getSelectedRangeDimensions,children:s?(0,m.jsx)(rh,{onDragStart:n.handleDragStart,onDragEnd:n.handleDragEnd}):null},"range-mask"),(0,m.jsx)(Hp,{innerRef:n.setSelectionMaskRef,selectedPosition:e.startCell,getSelectedDimensions:n.getSelectedDimensions},"selection-mask")]};var o={idx:-1,rowIdx:-1,groupRecordIndex:-1};return n.state={selectedPosition:o,selectedRange:{topLeft:o,bottomRight:o,startCell:null,cursorCell:null,isDragging:!1},draggedRange:null,isEditorEnabled:!1,openEditorMode:""},n.selectionMask=null,n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=window.sfMetadataContext.eventBus;this.unsubscribeSelectColumn=e.subscribe(pl,this.onColumnSelect),this.unsubscribeDragEnter=e.subscribe(hl,this.handleDragEnter),this.unsubscribeSelectCell=e.subscribe(rl,this.onSelectCell),this.unsubscribeSelectNone=e.subscribe(sl,this.selectNone),this.unsubscribeSelectStart=e.subscribe(ol,this.onSelectCellRangeStarted),this.unsubscribeSelectUpdate=e.subscribe(il,this.onSelectCellRangeUpdated),this.unsubscribeSelectEnd=e.subscribe(al,this.onSelectCellRangeEnded),this.unsubscribeOpenEditorEvent=e.subscribe(tl,this.onOpenEditorEvent),this.unsubscribeCloseEditorEvent=e.subscribe(nl,this.onCloseEditorEvent),this.unsubscribeCopy=e.subscribe(ll,this.onCopy),this.unsubscribePaste=e.subscribe(cl,this.onPaste)}},{key:"componentDidUpdate",value:function(e,t){var n=this.state,r=n.selectedRange,o=n.isEditorEnabled,i=t.selectedRange,a=o!==t.isEditorEnabled&&!o;(r!==i&&(r.topLeft!==i.topLeft||r.bottomRight!==i.bottomRight)||a)&&this.focus()}},{key:"componentWillUnmount",value:function(){this.unsubscribeSelectColumn(),this.unsubscribeSelectCell(),this.unsubscribeSelectStart(),this.unsubscribeSelectUpdate(),this.unsubscribeSelectEnd(),this.unsubscribeOpenEditorEvent(),this.unsubscribeCloseEditorEvent(),this.unsubscribeCopy(),this.unsubscribePaste(),this.setState=function(e,t){}}},{key:"createSingleCellSelectedRange",value:function(e,t){return{topLeft:e,bottomRight:e,startCell:e,cursorCell:e,isDragging:t}}},{key:"isKeyboardNavigationEvent",value:function(e){return null!=this.getKeyNavActionFromEvent(e)}},{key:"checkIsAtGridBoundary",value:function(e,t){var n=e.isCellAtBoundary,r=e.onHitBoundary;n(t)&&r(t)}},{key:"render",value:function(){var e=this.state,t=e.selectedRange,n=e.isEditorEnabled,r=e.draggedRange,o=e.selectedPosition,i=e.firstEditorKeyDown,a=e.openEditorMode,l=e.editorPosition,c=this.props,u=c.table,d=c.columns,p=c.isGroupView,h=c.recordGetterByIndex,f=c.scrollTop,g=c.getScrollLeft,v=c.editorPortalTarget,y=c.contextMenu,x=c.recordMetrics,A=function(e){var t=e.topLeft,n=e.bottomRight;return t.idx===n.idx&&t.rowIdx===n.rowIdx}(t);return(0,m.jsxs)("div",{className:"interaction-mask",ref:this.setContainerRef,onKeyDown:this.onKeyDown,onFocus:this.onFocus,onScroll:this.onScroll,tabIndex:0,"aria-hidden":"true",children:[r&&(0,m.jsx)(nh,{draggedRange:r,getSelectedDimensions:this.getSelectedDimensions,getSelectedRangeDimensions:this.getSelectedRangeDimensions}),A&&this.renderSingleCellSelectView(),!A&&this.renderCellRangeSelectView(),n&&(0,m.jsx)(ih,{target:v,children:(0,m.jsx)(_h,(0,Sr.A)({table:u,columns:d,scrollTop:f,firstEditorKeyDown:i,openEditorMode:a,portalTarget:v,scrollLeft:g(),record:_p({selectedPosition:o,isGroupView:p,recordGetterByIndex:h}),column:Pp({selectedPosition:o,columns:d}),value:Np({selectedPosition:o,columns:d,isGroupView:p,recordGetterByIndex:h}),onCommit:this.onCommit,onCommitCancel:this.onCommitCancel,modifyColumnData:this.props.modifyColumnData,editorPosition:l},(0,Sr.A)((0,Sr.A)({},this.getSelectedDimensions(o)),this.state.editorPosition)))}),(0,s.isValidElement)(y)&&(0,s.cloneElement)(y,{recordMetrics:x,selectedPosition:A?o:null,selectedRange:A?null:t,onClearSelected:this.handleSelectCellsDelete,onCopySelected:this.onCopySelected,getTableContentRect:this.props.getTableContentRect,getTableCanvasContainerRect:this.props.getTableCanvasContainerRect})]})}}])}(s.Component);Oh.defaultProps={enableCellSelect:!0,isGroupView:!1,groupOffsetLeft:0};var Th=Oh,Eh=function(e,t,n){var r=0,o=0,i=Rh(e,t);if(!i)return null;for(var a=0;a<t;a++){var s=Rh(e,a);s&&(s.width&&(r+=s.width),_c(s)&&(o+=s.width))}return ec?r-(n-i.width)/2:r-o},Rh=function(e,t){return Array.isArray(e)?e[t]:"undefined"!==typeof Immutable?e.get(t):void 0},Lh=function(e,t){for(var n=t,r=0;r<e.length;r++){if((n-=e[r].width)<0)return r}},Fh=function(e,t,n){for(var r=t+n,o=0;o<e.length;o++){if((r-=e[o].width)<0)return o-1-1}return e.length-1},Uh=33,Bh=window.innerHeight-174,Yh=Math.max,qh=Math.min,Hh=Math.ceil,Gh=Math.round,zh=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).getVisibleIndex=function(){return{rowVisibleStartIdx:n.rowVisibleStart,rowVisibleEndIdx:n.rowVisibleEnd}},n.getShownRecords=function(){return n.getShownRecordIds().map((function(e){return n.props.recordGetterById(e)}))},n.setRecordVisibleEnd=function(){return Yh(Hh(Bh/Uh),0)},n.setColumnVisibleEnd=function(){for(var e=n.props,t=e.columns,r=e.getScrollLeft,o=0,i=(0,e.getTableContentRect)().width+r(),a=0;a<t.length;a++){if((i-=t[a].width)<0)return a}return o},n.recalculateRenderIndex=function(e){var t=n.state,r=t.startRenderIndex,o=t.endRenderIndex,i=n.resultContentRef.scrollTop,a=Math.max(0,Math.floor(i/Uh)-10),s=n.props.getTableContentRect().height,l=Math.min(Math.ceil((i+s)/Uh)+10,e.length);a!==r&&n.setState({startRenderIndex:a}),l!==o&&n.setState({endRenderIndex:l})},n.getInitEndIndex=function(e){return Math.min(Math.ceil(window.innerHeight/Uh)+10,e.recordsCount)},n.getShownRecordIds=function(){var e=n.props.recordIds,t=n.state,r=t.startRenderIndex,o=t.endRenderIndex;return e.slice(r,o)},n.getRowTop=function(e){return Uh*e},n.getRowHeight=function(){return Uh},n.jumpToRow=function(e){var t=n.props.recordsCount,r=n.getRowHeight(),o=n.resultContentRef.offsetHeight,i=Math.min(e*r,t*r-o);n.setScrollTop(i)},n.scrollToColumn=function(e){var t=n.props,r=t.columns,o=(0,t.getTableContentRect)().width,i=Eh(r,e,o);null!==i&&n.props.setRecordsScrollLeft(i),n.updateColVisibleIndex(i)},n.updateColVisibleIndex=function(e){var t=n.props.columns,r=Lh(t,e),o=Fh(t,window.innerWidth,e);n.columnVisibleStart=r,n.columnVisibleEnd=o},n.setScrollTop=function(e){n.resultContentRef.scrollTop=e},n.setScrollLeft=function(e,t){var r=n.interactionMask;r&&r.setScrollLeft(e,t)},n.cancelSetScrollLeft=function(){var e=n.interactionMask;e&&e.cancelSetScrollLeft()},n.getClientScrollTopOffset=function(e){var t=n.getRowHeight(),r=e.scrollTop%t;return r>0?t-r:0},n.onHitBottomCanvas=function(){var e=n.getRowHeight(),t=n.resultContentRef;t.scrollTop+=e+n.getClientScrollTopOffset(t)},n.onHitTopCanvas=function(){var e=n.getRowHeight(),t=n.resultContentRef;t.scrollTop-=e-n.getClientScrollTopOffset(t)},n.getScrollTop=function(){return n.resultContentRef?n.resultContentRef.scrollTop:0},n.getRecordBodyHeight=function(){return n.resultContentRef?n.resultContentRef.offsetHeight:0},n.onScroll=function(){var e=n.props.recordsCount,t=n.state,r=t.startRenderIndex,o=t.endRenderIndex,i=n.resultContentRef,a=i.offsetHeight,s=i.scrollTop,l=Math.max(0,Math.floor(s/Uh)-10),c=Math.min(Math.ceil((s+n.resultContentRef.offsetHeight)/Uh)+10,e);n.oldScrollTop=s;var u=Hh(n.resultContentRef.offsetHeight/Uh),d=Yh(0,Gh(s/Uh)),p=qh(d+u,e);n.rowVisibleStart=d,n.rowVisibleEnd=p,n.props.cacheScrollTop(s),(Math.abs(l-r)>5||l<5)&&n.setState({startRenderIndex:l}),(Math.abs(c-o)>5||c>e-5)&&n.setState({endRenderIndex:c}),a+s>=n.resultContentRef.scrollHeight&&n.props.scrollToLoadMore(),n.isScrollingRightScrollbar||n.setRightScrollbarScrollTop(n.oldScrollTop),n.clearScrollbarTimer(),n.scrollbarTimer=setTimeout((function(){n.setState({isScrollingRightScrollbar:!1})}),300)},n.onScrollbarScroll=function(e){n.oldScrollTop!==e&&n.setState({isScrollingRightScrollbar:!0},(function(){n.setScrollTop(e)}))},n.onScrollbarMouseUp=function(){n.setState({isScrollingRightScrollbar:!1})},n.setRightScrollbarScrollTop=function(e){n.rightScrollbar&&n.rightScrollbar.setScrollTop(e)},n.selectNoneCells=function(){n.interactionMask&&n.interactionMask.selectNone();var e=n.state.selectedPosition;!e||e.idx<0||e.rowIdx<0||n.selectNone()},n.selectNone=function(){n.setState({selectedPosition:{idx:-1,rowIdx:-1}})},n.selectCell=function(e,t){window.sfMetadataContext.eventBus.dispatch(rl,e,t)},n.selectStart=function(e){window.sfMetadataContext.eventBus.dispatch(ol,e)},n.selectUpdate=function(e,t,n){window.sfMetadataContext.eventBus.dispatch(il,e,t,n)},n.selectEnd=function(){window.sfMetadataContext.eventBus.dispatch(al)},n.onCellClick=function(e,t){var r=n.state.selectedPosition;if(Fp(t)){if(!r||-1===r.idx)return void n.selectCell(e,!1);n.selectUpdate(e,!0)}else{var o=n.props.columns,i=Nc(e,o),a=Op(e,o,!1,n.props.recordGetterByIndex);n.selectCell(e,i&&a)}n.props.onCellClick(e),n.setState({selectedPosition:e})},n.onCellDoubleClick=function(e,t){var r=n.props.columns,o=Pc(e,r),i=Op(e,r,!1,n.props.recordGetterByIndex);n.selectCell(e,o&&i)},n.onCellMouseDown=function(e,t){Fp(t)||(n.selectCell(e),n.selectStart(e),window.addEventListener("mouseup",n.onWindowMouseUp))},n.onCellMouseEnter=function(e){n.selectUpdate(e,!1,n.updateViewableArea)},n.onCellMouseMove=function(e){n.selectUpdate(e,!1,n.updateViewableArea)},n.onWindowMouseUp=function(e){window.removeEventListener("mouseup",n.onWindowMouseUp),Fp(e)||(n.selectEnd(),n.clearHorizontalScroll())},n.onCellRangeSelectionUpdated=function(e){n.props.onCellRangeSelectionUpdated(e)},n.onCellContextMenu=function(e){n.props.onCellContextMenu(e)},n.updateViewableArea=function(e){var t=e.cursorCell.mousePosition,r=t.x,o=t.y,i=100;if(r+i>window.innerWidth)n.scrollToRight();else if(r-i<Ml+n.props.frozenColumnsWidth)n.scrollToLeft();else if(o+i>window.innerHeight-130){var a=n.getScrollTop();n.resultContentRef.scrollTop=a+8,n.clearHorizontalScroll()}else if(o-i<130){var s=n.getScrollTop();s-16>=0&&(n.resultContentRef.scrollTop=s-8),n.clearHorizontalScroll()}else n.clearHorizontalScroll()},n.scrollToRight=function(){n.timer||(n.timer=setInterval((function(){var e=n.props.getScrollLeft();n.props.setRecordsScrollLeft(e+20)}),10))},n.scrollToLeft=function(){n.timer||(n.timer=setInterval((function(){var e=n.props.getScrollLeft();e<=0?n.clearHorizontalScroll():n.props.setRecordsScrollLeft(e-20)}),10))},n.clearHorizontalScroll=function(){n.timer&&(clearInterval(n.timer),n.timer=null)},n.clearScrollbarTimer=function(){n.scrollbarTimer&&(clearTimeout(n.scrollbarTimer),n.scrollbarTimer=null)},n.getCellMetaData=function(){return n.cellMetaData||(n.cellMetaData={onCellClick:n.onCellClick,onCellDoubleClick:n.onCellDoubleClick,onCellMouseDown:n.onCellMouseDown,onCellMouseEnter:n.onCellMouseEnter,onCellMouseMove:n.onCellMouseMove,onDragEnter:n.handleDragEnter,modifyRecord:n.props.modifyRecord,onCellContextMenu:n.onCellContextMenu}),n.cellMetaData},n.handleDragEnter=function(e){var t=e.overRecordIdx,n=e.overGroupRecordIndex;window.sfMetadataContext.eventBus.dispatch(hl,{overRecordIdx:t,overGroupRecordIndex:n})},n.setRightScrollbar=function(e){n.rightScrollbar=e},n.setInteractionMaskRef=function(e){n.interactionMask=e},n.setResultRef=function(e){n.resultRef=e},n.setResultContentRef=function(e){n.resultContentRef=e},n.renderRecords=function(){n.recordFrozenRefs=[];var e=n.props,t=e.recordsCount,r=e.columns,o=e.colOverScanStartIdx,i=e.colOverScanEndIdx,a=e.lastFrozenColumnKey,s=e.recordMetrics,l=e.showCellColoring,c=e.columnColors,u=n.state,d=u.startRenderIndex,p=u.endRenderIndex,h=u.selectedPosition,f=n.getCellMetaData(),g=t-1,v=n.getShownRecordIds(),y=n.props.getScrollLeft(),x=n.getRowHeight(),A=v.map((function(e,t){var u=n.props.recordGetterById(e),p=$p.isRecordSelected(e,s),v=d+t,A=g===v,C=n.props.hasSelectedCell({recordIndex:v},h),b=l?c[e]:{};return(0,m.jsx)(Cp,{ref:function(e){n.recordFrozenRefs.push(e)},isSelected:p,index:v,isLastRecord:A,record:u,columns:r,colOverScanStartIdx:o,colOverScanEndIdx:i,lastFrozenColumnKey:a,scrollLeft:y,height:x,cellMetaData:f,hasSelectedCell:C,selectedPosition:n.state.selectedPosition,selectNoneCells:n.selectNoneCells,onSelectRecord:n.props.onSelectRecord,modifyRecord:n.props.modifyRecord,searchResult:n.props.searchResult,columnColor:b},e||v)})),C=d*Uh,b=(t-p)*Uh;if(C>0){var w={height:C,width:"100%"},S=(0,m.jsx)("div",{className:"d-flex align-items-end",style:w,children:(0,m.jsx)(zl.Rh,{})},"upper-placeholder");A.unshift(S)}if(b>0){var D={height:b,width:"100%"},k=(0,m.jsx)("div",{style:D,children:(0,m.jsx)(zl.Rh,{})},"below-placeholder");A.push(k)}return A},n.state={startRenderIndex:0,endRenderIndex:n.getInitEndIndex(e),activeRecords:[],menuPosition:null,selectedPosition:null,isScrollingRightScrollbar:!1},n.resultContentRef=null,n.resultRef=null,n.recordFrozenRefs=[],n.rowVisibleStart=0,n.rowVisibleEnd=n.setRecordVisibleEnd(),n.columnVisibleStart=0,n.columnVisibleEnd=n.setColumnVisibleEnd(),n.timer=null,n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.props.onRef(this),window.sfMetadataBody=this}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.recordsCount,n=e.recordIds;t===this.props.recordsCount&&n===this.props.recordIds||this.recalculateRenderIndex(n)}},{key:"componentWillUnmount",value:function(){this.clearHorizontalScroll(),this.clearScrollbarTimer(),this.setState=function(e,t){}}},{key:"render",value:function(){return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsxs)("div",{id:"canvas",className:"sf-metadata-result-table-content",ref:this.setResultContentRef,onScroll:this.onScroll,children:[(0,m.jsx)(Th,{ref:this.setInteractionMaskRef,contextMenu:this.props.contextMenu,canAddRow:this.props.canAddRow,table:this.props.table,columns:this.props.columns,recordsCount:this.props.recordsCount,recordMetrics:this.props.recordMetrics,rowHeight:this.getRowHeight(),getRowTop:this.getRowTop,scrollTop:this.oldScrollTop,getScrollLeft:this.props.getScrollLeft,getTableContentRect:this.props.getTableContentRect,getMobileFloatIconStyle:this.props.getMobileFloatIconStyle,onToggleMobileMoreOperations:this.props.onToggleMobileMoreOperations,editorPortalTarget:this.props.editorPortalTarget,onCellRangeSelectionUpdated:this.onCellRangeSelectionUpdated,modifyRecord:this.props.modifyRecord,recordGetterByIndex:this.props.recordGetterByIndex,recordGetterById:this.props.recordGetterById,updateRecords:this.props.updateRecords,paste:this.props.paste,editMobileCell:this.props.editMobileCell,frozenColumnsWidth:this.props.frozenColumnsWidth,selectNone:this.selectNone,getVisibleIndex:this.getVisibleIndex,onHitBottomBoundary:this.onHitBottomCanvas,onHitTopBoundary:this.onHitTopCanvas,onCellClick:this.onCellClick,scrollToColumn:this.scrollToColumn,setRecordsScrollLeft:this.props.setRecordsScrollLeft,gridUtils:this.props.gridUtils,getCopiedRecordsAndColumnsFromRange:this.props.getCopiedRecordsAndColumnsFromRange,modifyColumnData:this.props.modifyColumnData,getTableCanvasContainerRect:this.props.getTableCanvasContainerRect}),(0,m.jsx)("div",{className:"sf-metadata-result-table",style:{width:this.props.totalWidth+Ml},ref:this.setResultRef,children:this.renderRecords()})]}),(0,m.jsx)(sp,{table:this.props.table,ref:this.setRightScrollbar,onScrollbarScroll:this.onScrollbarScroll,onScrollbarMouseUp:this.onScrollbarMouseUp})]})}}])}(s.Component);zh.defaultProps={editorPortalTarget:document.body,scrollToRowIndex:0};var Vh=zh,Wh=function(e){var t=e.column,n=e.cellValue,r=e.originalCellValue,o=(0,s.useMemo)((function(){return"(".concat((0,h.AP)("Empty"),")")}),[]),i=(0,s.useMemo)((function(){return(0,h.AP)("Deleted option")}),[]),a=(0,s.useCallback)((function(){switch(t.type){case lo.CREATOR:case lo.LAST_MODIFIER:return r?(0,m.jsx)(hp,{value:r,field:t}):o;case lo.NUMBER:return n||0===n?n:o;case lo.COLLABORATOR:return Array.isArray(n)&&0!==n.length?(0,m.jsx)(hp,{value:n,field:t}):o;case lo.CHECKBOX:return(0,m.jsx)("input",{className:"checkbox",type:"checkbox",readOnly:!0,checked:n});case lo.SINGLE_SELECT:var e=Ha(t);if(0===e.length||!r)return o;var a=Wa(e,r),s=a?{backgroundColor:a.color,color:a.textColor}:{backgroundColor:Rl},l=a?a.name:i;return(0,m.jsx)("div",{className:"sf-metadata-single-select-option",style:s,title:l,children:l},n);case lo.MULTIPLE_SELECT:var c=Ha(t);if(0===c.length||!Array.isArray(r)||0===r.length)return o;var u=c.filter((function(e){return r.includes(e.id)||r.includes(e.name)})),d=r.filter((function(e){return e&&!c.find((function(t){return t.id===e||t.name===e}))})).map((function(e){return{id:e,name:i,color:Rl}}));return(0,m.jsxs)(m.Fragment,{children:[u.map((function(e){var t={backgroundColor:e.color,color:e.textColor};return(0,m.jsx)("div",{className:"sf-metadata-multiple-select-option",style:t,title:e.name,children:e.name},e.id)})),d.map((function(e){var t={backgroundColor:e.color};return(0,m.jsx)("div",{className:"sf-metadata-multiple-select-option",style:t,title:e.name,children:e.name},e.id)}))]});default:return n||o}}),[t,n,r,o,i]);return(0,m.jsxs)("div",{className:"group-title",children:[(0,m.jsx)("div",{className:"group-column-name",children:t.name}),(0,m.jsx)("div",{className:"group-cell-value",children:a()})]})},Kh=function(e){function t(){return(0,r.A)(this,t),(0,i.A)(this,t,arguments)}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.isExpanded,r=t.firstColumnFrozen,o=t.lastColumnFrozen,i=t.firstColumnKey,a=t.maxLevel,s=t.group,l=t.width,c=s.column,u=s.count,d=s.level,p=s.cell_value,f=s.original_cell_value,g={zIndex:r&&2,height:Il,width:l};return(0,m.jsxs)("div",{ref:function(t){return e.groupHeaderLeft=t},className:D()("group-header-left group-header-cell",{"table-last--frozen":o}),style:g,"data-column_key":i,children:[(0,m.jsx)(zl.Oi,{className:D()("group-toggle-btn",{hide:!n}),iconName:"drop-down",onClick:this.props.onExpandGroupToggle}),(0,m.jsx)(Wh,{column:c||{},originalCellValue:f,cellValue:p}),(0,m.jsx)("div",{className:"group-rows-count",children:(0,m.jsxs)("div",{className:"group-rows-count-content",children:[d===a&&(0,m.jsx)("span",{className:"count-title",children:(0,h.AP)("Count")}),(0,m.jsx)("span",{className:"count-num",children:u})]})})]})}}])}(s.Component),Xh=Kh,$h=function(e){function t(){var e;(0,r.A)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=(0,i.A)(this,t,[].concat(o))).fixedFrozenDOMs=function(t,n){e.leftContainer&&(e.leftContainer.style.position="fixed",e.leftContainer.style.marginLeft="0px",e.leftContainer.style.marginTop=-n+"px")},e.setContainerRef=function(t){e.leftContainer=t},e.cancelFixFrozenDOMs=function(t){e.leftContainer&&(e.leftContainer.style.position="absolute",e.leftContainer.style.marginLeft=t+"px",e.leftContainer.style.marginTop="0px")},e}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.isExpanded,r=t.maxLevel,o=t.group,i=t.formulaRow,a=t.leftPaneWidth,s=t.height,l=t.firstColumnFrozen,c=t.lastColumnFrozen,u=t.firstColumnKey,d={zIndex:l?2:0,width:a,height:s};return(0,m.jsx)("div",{className:"group-container group-container-left",style:d,ref:this.setContainerRef,children:(0,m.jsx)(Xh,{ref:function(t){return e.leftHeader=t},isExpanded:n,firstColumnFrozen:l,lastColumnFrozen:c,firstColumnKey:u,width:a,maxLevel:r,group:o,formulaRow:i,onExpandGroupToggle:this.props.onExpandGroupToggle})})}}])}(s.Component),Zh=$h,Jh=function(e){function t(){var e;(0,r.A)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=(0,i.A)(this,t,[].concat(o))).fixedFrozenDOMs=function(t,n){if(e.headerCell){var r=e.props,o=r.firstColumnWidth,i=r.groupOffsetLeft;e.headerCell.style.position="fixed",e.headerCell.style.marginLeft=Ml+o+i+"px",e.headerCell.style.marginTop=-n+"px"}},e.cancelFixFrozenDOMs=function(t){e.headerCell&&(e.headerCell.style.position="absolute",e.headerCell.style.marginLeft=t+"px",e.headerCell.style.marginTop=0)},e.getStyle=function(){var t=e.props,n=t.offsetLeft,r=t.column,o=t.isExpanded,i={position:"absolute",width:r.width,height:Il-(o?1:2),left:n};return _c(r)&&(i.zIndex=2),i},e}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.column,r=t.isLastFrozenColumn;return(0,m.jsx)("div",{ref:function(t){return e.headerCell=t},className:D()("summary-item group-header-cell",{"table-last--frozen":r}),style:this.getStyle(),"data-column_key":n.key})}}])}(s.PureComponent),Qh=Jh,ef=function(e){function t(){var e;(0,r.A)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=(0,i.A)(this,t,[].concat(o))).headerCells={},e.setHeaderCellRef=function(t){return function(n){e.headerCells[t]=n}},e.fixedFrozenDOMs=function(t,n){e.props.columns.forEach((function(r){var o=e.headerCells[r.key];_c(r)&&o&&o.fixedFrozenDOMs(t,n)}))},e.cancelFixFrozenDOMs=function(t){e.props.columns.forEach((function(n){var r=e.headerCells[n.key];_c(n)&&r&&r.cancelFixFrozenDOMs(t)}))},e.getGroupSummaries=function(){var t=e.props,n=t.group,r=t.isExpanded,o=t.columns,i=t.groupOffsetLeft,a=t.lastFrozenColumnKey,s=t.summaryConfigs,l=o.slice(1),c=o[0]?o[0].width:0,u=0;return l.map((function(t,o){var d=t.key,p=s&&s[d]?s[d]:"Sum",h=n.summaries[d];return 0!==o&&(u+=l[o-1].width),(0,m.jsx)(Qh,{ref:e.setHeaderCellRef(d),firstColumnWidth:c,groupOffsetLeft:i,isLastFrozenColumn:d===a,offsetLeft:u,column:t,isExpanded:r,summary:h,summaryMethod:p},d)}))},e}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return(0,m.jsx)("div",{className:"group-header-right",style:{height:Il},children:this.getGroupSummaries()})}}])}(s.Component),tf=ef,nf=function(e){function t(){var e;(0,r.A)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=(0,i.A)(this,t,[].concat(o))).fixedFrozenDOMs=function(t,n){e.rightHeader&&e.rightHeader.fixedFrozenDOMs(t,n)},e.cancelFixFrozenDOMs=function(t){e.rightHeader&&e.rightHeader.cancelFixFrozenDOMs(t)},e}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.group,r=t.isExpanded,o=t.columns,i=t.summaryConfigs,a=t.rightPaneWidth,s=t.leftPaneWidth,l=t.height,c=t.groupOffsetLeft,u=t.lastFrozenColumnKey,d={left:s,width:a,height:l};return(0,m.jsx)("div",{className:"group-container group-container-right",style:d,children:(0,m.jsx)(tf,{ref:function(t){return e.rightHeader=t},groupOffsetLeft:c,lastFrozenColumnKey:u,group:n,isExpanded:r,columns:o,summaryConfigs:i})})}}])}(s.Component),rf=nf,of=function(e){function t(){var e;(0,r.A)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=(0,i.A)(this,t,[].concat(o))).fixedFrozenDOMs=function(t,n){e.backDrop&&(e.backDrop.style.position="fixed",e.backDrop.style.marginLeft="0px",e.backDrop.style.marginTop=-n+"px"),e.leftContainer&&e.leftContainer.fixedFrozenDOMs(t,n),e.rightContainer&&e.rightContainer.fixedFrozenDOMs(t,n)},e.cancelFixFrozenDOMs=function(t){e.backDrop&&(e.backDrop.style.position="absolute",e.backDrop.style.marginLeft=t-jl+"px",e.backDrop.style.marginTop="0px"),e.leftContainer&&e.leftContainer.cancelFixFrozenDOMs(t),e.rightContainer&&e.rightContainer.cancelFixFrozenDOMs(t)},e.setContainer=function(t){e.group=t},e.setBackDrop=function(t){e.backDrop=t},e.onExpandGroupToggle=function(){var t=e.props.groupPathString;e.props.onExpandGroupToggle(t)},e}return(0,a.A)(t,e),(0,o.A)(t,[{key:"shouldComponentUpdate",value:function(e){return e.groupPathString!==this.props.groupPathString||e.group!==this.props.group||e.width!==this.props.width||e.height!==this.props.height||e.top!==this.props.top||e.columns!==this.props.columns||e.rowHeight!==this.props.rowHeight||e.isExpanded!==this.props.isExpanded||e.scrollLeft!==this.props.scrollLeft||e.lastFrozenColumnKey!==this.props.lastFrozenColumnKey||e.summaryConfigs!==this.props.summaryConfigs}},{key:"componentDidMount",value:function(){this.props.lastFrozenColumnKey&&!ec&&this.checkScroll()}},{key:"checkScroll",value:function(){var e=this.props.scrollLeft;this.cancelFixFrozenDOMs(e)}},{key:"render",value:function(){var e=this,t=this.props,n=t.group,r=t.columns,o=t.width,i=t.isExpanded,a=t.folding,s=t.summaryConfigs,l=t.height,c=t.backdropHeight,u=t.top,d=t.groupOffsetLeft,p=t.lastFrozenColumnKey,h=t.maxLevel,f=n.left,g=n.level,v=1===g,y=D()("group-item","group-level-".concat(g),i?"expanded-group":"folded-group",a?"folding":""),x=r[0]||{},A=_c(x),C=x.width||0,b=Ml+C+(v?0:(g-1)*jl-1),w=o-b,S={height:l,width:o,top:u,left:f},k={height:c,width:b+jl,zIndex:2};return(0,m.jsxs)("div",{className:y,ref:this.setContainer,style:S,children:[g===h&&A&&(0,m.jsx)("div",{className:"group-backdrop",ref:this.setBackDrop,style:k}),(0,m.jsx)(Zh,{ref:function(t){return e.leftContainer=t},group:n,firstColumnFrozen:A,lastColumnFrozen:x.key===p,leftPaneWidth:b,height:l,isExpanded:i,firstColumnKey:x.key,maxLevel:h,onExpandGroupToggle:this.onExpandGroupToggle}),(0,m.jsx)(rf,{ref:function(t){return e.rightContainer=t},group:n,isExpanded:i,leftPaneWidth:b,rightPaneWidth:w,height:l,groupOffsetLeft:d,lastFrozenColumnKey:p,columns:r,summaryConfigs:s})]})}}])}(s.Component),af=of,sf=["startRenderIndex","endRenderIndex"],lf="path_folded_group",cf=Math.max,uf=Math.min,df=function(e){function t(e){var n;(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).getShownRecords=function(){var e=n.state,t=e.startRenderIndex,r=e.endRenderIndex,o=e.groupMetrics;return n.getVisibleGroupRecords(t,r,o.groupRows).map((function(e){return n.props.recordGetterById(e.rowId)})).filter((function(e){return!!e}))},n.getGroupVisibleBoundaries=function(e,t,n,r){var o=n.groupRows,i=n.groupRowsHeight,a=n.maxLevel;if(!Array.isArray(o)||0===o.length)return{startRenderIndex:0,endRenderIndex:0};for(var s=0,l=0,c=Il*a+10*r,u=cf(0,t-(Il*a+10*r)),d=uf(i,t+e+c),p=o.length,h=0;h<p;h++){var f=o[h].top;f<=u&&s++,f<=d&&l++}return{startRenderIndex:s,endRenderIndex:l}},n.setGroupNode=function(e){return function(t){n.groupsNode[e]=t}},n.setResultContentRef=function(e){n.resultContentRef=e},n.setInteractionMaskRef=function(e){n.interactionMask=e},n.setResultRef=function(e){n.resultRef=e},n.setScrollTop=function(e){n.resultContentRef.scrollTop=e},n.setScrollLeft=function(e,t){n.interactionMask&&n.interactionMask.setScrollLeft(e,t)},n.cancelSetScrollLeft=function(){n.interactionMask&&n.interactionMask.cancelSetScrollLeft()},n.setRightScrollbar=function(e){n.rightScrollbar=e},n.setColumnVisibleEnd=function(){for(var e=n.props,t=e.columns,r=e.getScrollLeft,o=0,i=(0,e.getTableContentRect)().width+r(),a=0;a<t.length;a++){if((i-=t[a].width)<0)return a}return o},n.getScrollTop=function(){return n.resultContentRef?n.resultContentRef.scrollTop:0},n.getRowHeight=function(){return 33},n.getRowTop=function(e){var t=n.state.groupMetrics,r=Mp(e,t);return r&&r.top||0},n.jumpToRow=function(e){var t=n.state.groupMetrics,r=n.resultContentRef.offsetHeight,o=n.getRowTop(e),i=Math.min(o,t.groupRowsHeight-r);n.setScrollTop(i)},n.scrollToColumn=function(e){var t=n.props,r=t.columns,o=(0,t.getTableContentRect)().width,i=Eh(r,e,o);null!==i&&n.props.setRecordsScrollLeft(i),n.updateColVisibleIndex(i)},n.updateColVisibleIndex=function(e){var t=n.props.columns,r=Lh(t,e),o=Fh(t,window.innerWidth,e);n.columnVisibleStart=r,n.columnVisibleEnd=o},n.getRecordBodyHeight=function(){return n.resultContentRef?n.resultContentRef.offsetHeight:0},n.updateViewableArea=function(e){var t=e.cursorCell.mousePosition,r=t.x,o=t.y,i=100;if(r+i>window.innerWidth)n.scrollToRight();else if(r-i<Ml+n.props.frozenColumnsWidth)n.scrollToLeft();else if(o+i>window.innerHeight-130){var a=n.getScrollTop();n.resultContentRef.scrollTop=a+8,n.clearHorizontalScroll()}else if(o-i<130){var s=n.getScrollTop();s-16>=0&&(n.resultContentRef.scrollTop=s-8),n.clearHorizontalScroll()}else n.clearHorizontalScroll()},n.scrollToRight=function(){n.scrollTimer||(n.scrollTimer=setInterval((function(){var e=n.props.getScrollLeft();n.props.setRecordsScrollLeft(e+20)}),10))},n.scrollToLeft=function(){n.scrollTimer||(n.scrollTimer=setInterval((function(){var e=n.props.getScrollLeft();e<=0?n.clearHorizontalScroll():n.props.setRecordsScrollLeft(e-20)}),10))},n.clearHorizontalScroll=function(){n.scrollTimer&&(clearInterval(n.scrollTimer),n.scrollTimer=null)},n.clearScrollbarTimer=function(){n.scrollbarTimer&&(clearTimeout(n.scrollbarTimer),n.scrollbarTimer=null)},n.getCellMetaData=function(){return n.cellMetaData||(n.cellMetaData={onCellClick:n.onCellClick,onCellDoubleClick:n.onCellDoubleClick,onCellMouseDown:n.onCellMouseDown,onCellMouseEnter:n.onCellMouseEnter,onCellMouseMove:n.onCellMouseMove,onDragEnter:n.handleDragEnter,modifyRecord:n.props.modifyRecord,onCellContextMenu:n.onCellContextMenu}),n.cellMetaData},n.handleDragEnter=function(e){var t=e.overRecordIdx,n=e.overGroupRecordIndex;window.sfMetadataContext.eventBus.dispatch(hl,{overRecordIdx:t,overGroupRecordIndex:n})},n.getGroupMetrics=function(){return n.state.groupMetrics},n.getGroupRecordByIndex=function(e){var t=n.getGroupMetrics();return Mp(e,t)},n.fixFrozenDoms=function(e,t){(_c(n.props.columns[0])||0!==e)&&Object.keys(n.groupsNode).forEach((function(r){var o=n.groupsNode[r];o&&o.fixedFrozenDOMs(e,t)}))},n.cancelFixFrozenDOMs=function(e){(_c(n.props.columns[0])||0!==e)&&n.groupsNode&&Object.keys(n.groupsNode).forEach((function(t){var r=n.groupsNode[t];r&&r.cancelFixFrozenDOMs(e)}))},n.onResize=function(){var e=window.innerHeight;if(e){var t=n.resultContentRef.scrollTop,r=n.getRowHeight();n.updateScroll({gridHeight:e,scrollTop:t,rowHeight:r})}},n.onScroll=function(){var e=n.resultContentRef,t=e.offsetHeight,r=e.scrollTop;n.oldScrollTop=r,n.props.cacheScrollTop(r),n.updateScroll({scrollTop:r}),t+r>=n.resultContentRef.scrollHeight&&n.props.scrollToLoadMore(),n.isScrollingRightScrollbar||n.setRightScrollbarScrollTop(n.oldScrollTop),n.clearScrollbarTimer(),n.scrollbarTimer=setTimeout((function(){n.setState({isScrollingRightScrollbar:!1})}),300)},n.setRightScrollbarScrollTop=function(e){n.rightScrollbar&&n.rightScrollbar.setScrollTop(e)},n.onScrollbarScroll=function(e){n.oldScrollTop!==e&&n.setState({isScrollingRightScrollbar:!0},(function(){n.setScrollTop(e)}))},n.onScrollbarMouseUp=function(){n.setState({isScrollingRightScrollbar:!1})},n.onCellClick=function(e,t){var r=n.state.selectedPosition;if(Fp(t)){if(!r||-1===r.idx)return void n.selectCell(e,!1);n.selectUpdate(e,!0)}else{var o=n.props.columns,i=Nc(e,o),a=Op(e,o,!0,n.props.recordGetterByIndex);n.selectCell(e,i&&a)}n.props.onCellClick(e),n.setState({selectedPosition:e})},n.onCellDoubleClick=function(e,t){var r=n.props.columns,o=Pc(e,r),i=Op(e,r,!0,n.props.recordGetterByIndex);n.selectCell(e,o&&i)},n.onCellMouseDown=function(e,t){Fp(t)||(n.selectCell(e),n.selectStart(e),window.addEventListener("mouseup",n.onWindowMouseUp))},n.onCellMouseEnter=function(e){n.selectUpdate(e,!1,n.updateViewableArea)},n.onCellMouseMove=function(e){n.selectUpdate(e,!1,n.updateViewableArea)},n.onCellContextMenu=function(e){n.props.onCellContextMenu(e)},n.onWindowMouseUp=function(e){window.removeEventListener("mouseup",n.onWindowMouseUp),Fp(e)||(n.selectEnd(),n.clearHorizontalScroll())},n.onCellRangeSelectionUpdated=function(e){n.props.onCellRangeSelectionUpdated(e)},n.selectNoneCells=function(){n.interactionMask&&n.interactionMask.selectNone();var e=n.state.selectedPosition;!e||e.idx<0||e.rowIdx<0||n.selectNone()},n.selectNone=function(){n.setState({selectedPosition:{idx:-1,rowIdx:-1,groupRecordIndex:-1}})},n.selectCell=function(e,t){window.sfMetadataContext.eventBus.dispatch(rl,e,t)},n.selectStart=function(e){window.sfMetadataContext.eventBus.dispatch(ol,e)},n.selectUpdate=function(e,t,n){window.sfMetadataContext.eventBus.dispatch(il,e,t,n)},n.selectEnd=function(){window.sfMetadataContext.eventBus.dispatch(al)},n.onCloseContextMenu=function(){n.setState({isContextMenuShow:!1,menuPosition:null,activeRecords:[]})},n.getNextScrollState=function(e){var t=e.gridHeight,r=e.scrollTop,o=e.rowHeight,i=e.groupMetrics,a=e.pathFoldedGroupMap,s=t||window.innerHeight,l=o||n.getRowHeight(),c=i||n.state.groupMetrics,u=a||n.state.pathFoldedGroupMap,d=n.getGroupVisibleBoundaries(s,r,c,l);return{startRenderIndex:d.startRenderIndex,endRenderIndex:d.endRenderIndex,groupMetrics:c,pathFoldedGroupMap:u}},n.updateScroll=function(e){var t=e.startRenderIndex,r=e.endRenderIndex,o=(0,dc.A)(e,sf),i=n.getNextScrollState(o);return t&&r&&(i.startRenderIndex=t,i.endRenderIndex=r),n.setState(i),i},n.isParentGroupContainer=function(e,t){var n=e.groupPath,r=e.level,o=e.type,i=t.groupPath,a=t.level;return o===Pl&&r>a&&n[0]===i[0]},n.getPrevGroupContainers=function(e,t,r){if(!e)return[];var o=e.level,i=e.groupRecordIndex,a=e.type;if(0===i||o===r&&a===Pl)return[];for(var s=[],l=i-1;l>-1;){var c=t[l],u=c.type,d=c.level;if(u===Pl){if(o===r){s.push(c);break}if(n.isParentGroupContainer(c,e)&&s.unshift(c),d===r)break}l--}return s},n.getVisibleGroupRecords=function(e,t,r){var o=[],i=r[e],a=n.props.groupbys.length,s=n.getPrevGroupContainers(i,r,a);o.push.apply(o,(0,W.A)(s));for(var l=e,c=[];l<=t;){var u=r[l];u&&u.visible&&(o.push(u),u.type===Nl&&c.push(u)),l++}return o},n.getFoldedGroups=function(){var e=window.sfMetadataContext.localStorage.getItem(lf);return e||{}},n.getVisibleIndex=function(){return{rowVisibleStartIdx:n.rowVisibleStart,rowVisibleEndIdx:n.rowVisibleEnd}},n.updateFoldedGroups=function(e){window.sfMetadataContext.localStorage.setItem(lf,e),n.selectNoneCells()},n.collapseAllGroups=function(){var e=n.state.groupMetrics.groupRows,t={};e.forEach((function(e){var n=e.type,r=e.groupPathString;n===Pl&&(t[r]=!0)})),n.updateFoldedGroups(t);var r=n.props,o=r.groups,i=r.groupbys,a=r.allColumns,s=n.getRowHeight(),l=n.resultContentRef.scrollTop,c=bp(o,i,t,a,s,!1);n.updateScroll({scrollTop:l,rowHeight:s,groupMetrics:c})},n.expandAllGroups=function(){var e={};n.updateFoldedGroups(e);var t=n.props,r=t.groups,o=t.groupbys,i=t.allColumns,a=n.resultContentRef.scrollTop,s=n.getRowHeight(),l=bp(r,o,e,i,s,!1);n.updateScroll({scrollTop:a,rowHeight:s,groupMetrics:l})},n.onExpandGroupToggle=function(e){var t=n.state,r=t.groupMetrics,o=t.pathFoldedGroupMap,i=r.groupRows,a=r.maxLevel,s=i.find((function(t){return t.groupPathString===e&&t.type===Pl}));if(s){var l=s.groupRecordIndex,c=s.groupPath,u=s.height,d=s.isExpanded,p=(0,Sr.A)({},o);d?p[e]=!0:delete p[e];var h=n.props,f=h.groups,m=h.groupbys,g=h.allColumns,v=n.resultContentRef.scrollTop,y=n.getRowHeight(),x=bp(f,m,p,g,y,!1);if(s.count>=50)return n.forbidRecordsAnimation(),n.updateFoldedGroups(p),void n.updateScroll({scrollTop:v,rowHeight:y,groupMetrics:x,pathFoldedGroupMap:p});var A,C=n.getGroupVisibleBoundaries(window.innerHeight,v,x,y),b=C.startRenderIndex,w=C.endRenderIndex;if(d){var S=(A=r).groupRows;if(a>1)for(var D=-(u-Il),k=l-1;k>-1;k--){var M=S[k],j=M.groupPath;if(n.isParentGroupContainer(M,s)&&(M.height=M.height+D),j[0]!==c[0])break}for(var I=l+1;I<S.length;I++){var _=S[I],P=_.groupPath;if(kp(_,s)&&(_.visible=!1),P[0]!==c[0])break}S[l]=(0,Sr.A)((0,Sr.A)({},S[l]),{},{isExpanded:!1,height:Il})}else for(var N=(A=x).groupRows,O=s.top+Il,T=l+1;T<N.length;T++){var E=N[T],R=E.groupPath;if(kp(E,s)&&(E.height=0,E.top=O),R[0]!==c[0])break}n.expandingGroupPathString=e,n.nextPathFoldedGroupMap=p,n.setState({groupMetrics:A,startRenderIndex:b,endRenderIndex:w}),n.updateFoldedGroups(p)}},n.forbidRecordsAnimation=function(){n.disabledAnimation=!0;var e=n.groupRows.className,t=nc(e,"animation");t!==e&&(n.groupRows.className=t)},n.ableRecordsAnimation=function(){n.disabledAnimation=!1;var e=n.groupRows.className,t=tc(e,"animation");t!==e&&(n.groupRows.className=t)},n.openDownloadFilesDialog=function(){var e=n.state,t=e.column,r=e.activeRecords;n.props.cacheDownloadFilesProps(t,r),n.props.openDownloadFilesDialog()},n.checkSupportDownloadFiles=function(){var e=n.state.column,t=n.interactionMask.getSelectedPosition(),r=t.left;return!(t.right>r)&&(e.type===lo.FILE||e.type===lo.IMAGE)},n.renderGroups=function(){var e=n.props,t=e.totalWidth,r=e.containerWidth,o=e.columns,i=e.colOverScanStartIdx,a=e.colOverScanEndIdx,s=e.groupOffsetLeft,l=e.recordMetrics,c=e.summaryConfigs,u=e.lastFrozenColumnKey,d=e.showCellColoring,p=e.columnColors;n.recordFrozenRefs=[];var h=t+Ml,f=n.state,g=f.startRenderIndex,v=f.endRenderIndex,y=f.groupMetrics,x=f.selectedPosition,A=y.groupRows,C=y.maxLevel,b=n.props.getScrollLeft(),w=n.getCellMetaData(),S=n.getVisibleGroupRecords(g,v,A),k=[],M=o.length,j=o[M-1],I=y.groupRowsHeight;S.forEach((function(e){var t=e.type,r=e.level,f=e.key,g=e.left,v=e.top,y=e.isExpanded,A=e.height,S=e.groupPathString,D=e.groupRecordIndex;if(t===Pl){var M=h+2*(r-1)*jl,j=n.expandingGroupPathString===S&&!y,I=A+jl;k.push((0,m.jsx)(af,{ref:n.setGroupNode(S),groupPathString:S,group:e,height:A,backdropHeight:I,width:M,top:v,maxLevel:C,groupOffsetLeft:s,scrollLeft:b,columns:o,summaryConfigs:c,isExpanded:y,folding:j,lastFrozenColumnKey:u,onExpandGroupToggle:n.onExpandGroupToggle},f))}else if(t===Nl){var _=e.rowId,P=e.rowIdx,N=e.isLastRow,O=_&&n.props.recordGetterById(_),T=$p.isRecordSelected(_,l),E=n.props.hasSelectedCell({groupRecordIndex:D},x),R=d?p[_]:{};if(!O)return;k.push((0,m.jsx)(Cp,{isGroupView:!0,ref:function(e){n.recordFrozenRefs.push(e)},isSelected:T,groupRecordIndex:D,index:P,isLastRecord:N,lastFrozenColumnKey:u,record:O,columns:o,colOverScanStartIdx:i,colOverScanEndIdx:a,left:g,top:v,height:A,scrollLeft:b,cellMetaData:w,searchResult:n.props.searchResult,hasSelectedCell:E,selectedPosition:n.state.selectedPosition,selectNoneCells:n.selectNoneCells,onSelectRecord:n.props.onSelectRecord,modifyRecord:n.props.modifyRecord,lockRecordViaButton:n.props.lockRecordViaButton,modifyRecordViaButton:n.props.modifyRecordViaButton,reloadRecords:n.props.reloadRecords,columnColor:R},_||P))}}));var _,P=u===j.key,N=D()("canvas-groups-rows","animation",{"single-column":(_=j,"_name"===_.key),"disabled-add-record":!0,"all-columns-frozen":P,frozen:P||!!u}),O={height:I,width:r+(2*(C-1)+1)*jl};return(0,m.jsx)("div",{className:N,style:O,ref:function(e){return n.groupRows=e},children:k})};var o=e.groups,a=e.groupbys,s=e.allColumns,l=n.getRowHeight(),c=n.getFoldedGroups(),u=bp(o,a,c,s,l,!1),d=n.getGroupVisibleBoundaries(window.innerHeight,0,u,l),p=d.startRenderIndex,h=d.endRenderIndex;return n.state={isContextMenuShow:!1,activeRecords:[],menuPosition:null,groupMetrics:u,startRenderIndex:p,endRenderIndex:h,pathFoldedGroupMap:c,isScrollingRightScrollbar:!1,selectedPosition:null},n.groupsNode={},n.recordFrozenRefs=[],n.rowVisibleStart=p,n.rowVisibleEnd=h,n.columnVisibleStart=0,n.columnVisibleEnd=n.setColumnVisibleEnd(),n.disabledAnimation=!1,n.nextPathFoldedGroupMap=null,n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){window.sfMetadataBody=this,window.addEventListener("resize",this.onResize),this.props.onRef(this),this.unSubscribeCollapseAllGroups=window.sfMetadataContext.eventBus.subscribe(fl,this.collapseAllGroups),this.unSubscribeExpandAllGroups=window.sfMetadataContext.eventBus.subscribe(ml,this.expandAllGroups)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.groupbys,r=t.groups,o=t.allColumns,i=t.searchResult,a=this.resultContentRef.scrollTop,s=this.getRowHeight();if(n!==e.groupbys||r!==e.groups||i!==e.searchResult){var l=window.innerHeight,c=(i||{}).matchedCells,u=Array.isArray(c)&&c.length>0?{}:this.getFoldedGroups(),d=bp(r,n,u,o,s,!1);this.updateScroll({gridHeight:l,scrollTop:a,groupMetrics:d,rowHeight:s})}if(this.disabledAnimation&&this.ableRecordsAnimation(),this.expandingGroupPathString){var p=bp(r,n,this.nextPathFoldedGroupMap,o,s,!1);this.updateScroll({scrollTop:a,groupMetrics:p,pathFoldedGroupMap:this.nextPathFoldedGroupMap}),this.expandingGroupPathString=null,this.nextPathFoldedGroupMap=null}}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onResize),this.unSubscribeCollapseAllGroups(),this.unSubscribeExpandAllGroups(),this.clearHorizontalScroll(),this.clearScrollbarTimer(),this.setState=function(e,t){}}},{key:"render",value:function(){return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsxs)("div",{id:"group-canvas",className:"sf-metadata-result-table-content",ref:this.setResultContentRef,onScroll:this.onScroll,children:[(0,m.jsx)(Th,{isGroupView:!0,ref:this.setInteractionMaskRef,table:this.props.table,columns:this.props.columns,recordsCount:this.props.recordsCount,recordMetrics:this.props.recordMetrics,groups:this.props.groups,groupMetrics:this.state.groupMetrics,rowHeight:this.getRowHeight(),groupOffsetLeft:this.props.groupOffsetLeft,scrollTop:this.oldScrollTop,getRowTop:this.getRowTop,getScrollLeft:this.props.getScrollLeft,getTableContentRect:this.props.getTableContentRect,getMobileFloatIconStyle:this.props.getMobileFloatIconStyle,onToggleMobileMoreOperations:this.props.onToggleMobileMoreOperations,onToggleInsertRecordDialog:this.props.onToggleInsertRecordDialog,editorPortalTarget:this.props.editorPortalTarget,onCellRangeSelectionUpdated:this.onCellRangeSelectionUpdated,modifyRecord:this.props.modifyRecord,recordGetterByIndex:this.props.recordGetterByIndex,recordGetterById:this.props.recordGetterById,updateRecords:this.props.updateRecords,paste:this.props.paste,editMobileCell:this.props.editMobileCell,frozenColumnsWidth:this.props.frozenColumnsWidth,selectNone:this.selectNone,onCellClick:this.onCellClick,getVisibleIndex:this.getVisibleIndex,getGroupCanvasScrollTop:this.getScrollTop,setGroupCanvasScrollTop:this.setScrollTop,scrollToColumn:this.scrollToColumn,setRecordsScrollLeft:this.props.setRecordsScrollLeft,gridUtils:this.props.gridUtils,getCopiedRecordsAndColumnsFromRange:this.props.getCopiedRecordsAndColumnsFromRange,modifyColumnData:this.props.modifyColumnData,getTableCanvasContainerRect:this.props.getTableCanvasContainerRect}),(0,m.jsx)("div",{className:"sf-metadata-result-table",ref:this.setResultRef,children:this.renderGroups()})]}),(0,m.jsx)(sp,{table:this.props.table,ref:this.setRightScrollbar,onScrollbarScroll:this.onScrollbarScroll,onScrollbarMouseUp:this.onScrollbarMouseUp})]})}}])}(s.Component);df.defaultProps={editorPortalTarget:document.body,scrollToRowIndex:0};var pf=df,hf=function(e){function t(){var e;(0,r.A)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=(0,i.A)(this,t,[].concat(o))).onClick=function(){j.A.closeAll(),e.props.load(1e5)},e}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return(0,m.jsxs)("div",{className:"load-all-tip",children:[(0,m.jsx)("span",{children:(0,h.AP)("Loaded 50,000 records.")}),(0,m.jsx)("div",{className:"load-all ml-2",onClick:this.onClick,children:(0,h.AP)("Click to load more")})]})}}])}(s.Component),ff=hf,mf=function(e){function t(){var e;(0,r.A)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=(0,i.A)(this,t,[].concat(o))).ref=null,e.calculateAtBorder=function(){var t,n=e.ref.getBoundingClientRect().bottom,r=e.ref?e.ref.className:"";(t=n>=window.innerHeight?tc(r,"at-border"):nc(r,"at-border"))!==r&&e.ref&&(e.ref.className=t)},e.onClick=function(){if(!e.props.isLoadingMore){var t=e.props.recordsCount<5e4?5e4:1e5;e.props.loadAll(t,(function(t){t?j.A.success((0,m.jsx)(ff,{load:e.props.loadAll}),{duration:5}):j.A.success((0,h.AP)("All records loaded"))}))}},e.setSummaryScrollLeft=function(t){e.summaryItemsRef.scrollLeft=t},e.getSelectedCellsCount=function(e){var t=e.topLeft,n=e.bottomRight;return-1===t.rowIdx?0:(n.idx-t.idx+1)*(n.rowIdx-t.rowIdx+1)},e.getSummaries=function(){var t=e.props,n=t.isGroupView,r=t.hasSelectedRecord,o=t.recordMetrics,i=t.selectedRange,a=t.summaries,s=t.recordGetterByIndex;if(r){var l=$p.getSelectedIds(o),c=l&&l.map((function(t){return e.props.recordGetterById(t)})).filter(Boolean);return e.props.getRecordsSummaries(c)}if(e.getSelectedCellsCount(i)>1){var u=Ep({selectedRange:i,isGroupView:n,recordGetterByIndex:s});return e.props.getRecordsSummaries(u)}return a},e.getSummaryItems=function(){var t=e.props,n=t.columns,r=t.hasMore,o=t.isLoadingMore||r?n.slice(1,n.length):n,i=Ml;return{summaryItems:Array.isArray(o)&&o.map((function(e,t){var n=e.width,r=e.key;return i+=n,(0,m.jsx)("div",{className:"summary-item",style:{width:n}},r)})),totalWidth:i}},e.getRecord=function(){var t=e.props,n=t.hasMore,r=t.hasSelectedRecord,o=t.recordMetrics,i=t.selectedRange,a=t.recordsCount;if(r){var s=$p.getSelectedIds(o).length;return s>1?(0,h.AP)("xxx records selected").replace("xxx",s):(0,h.AP)("1 record selected")}var l=e.getSelectedCellsCount(i);if(l>1)return(0,h.AP)("xxx cells selected").replace("xxx",l);var c=(0,h.AP)("No record");return a>1?c=(0,h.AP)("xxx records").replace("xxx",a):1===a&&(c=(0,h.AP)("1 record")),n&&(c+=" +"),c},e}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.calculateAtBorder)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.calculateAtBorder)}},{key:"componentDidUpdate",value:function(){this.calculateAtBorder()}},{key:"render",value:function(){var e=this,t=this.props,n=t.hasMore,r=t.isLoadingMore,o=t.columns,i=t.groupOffsetLeft,a=this.getSummaryItems(),s=a.summaryItems,l=a.totalWidth,c=(r||n?Ml+o[0].width:Ml)+i;return(0,m.jsxs)("div",{className:"sf-metadata-result-footer",style:{zIndex:4},ref:function(t){return e.ref=t},children:[(0,m.jsxs)("div",{className:"rows-record d-flex text-nowrap",style:{width:c},children:[(0,m.jsx)("span",{children:this.getRecord()}),!r&&n&&(0,m.jsx)("span",{className:"load-all ml-4",onClick:this.onClick,children:(0,h.AP)("Load all")}),r&&(0,m.jsxs)("span",{className:"loading-message ml-4",children:[(0,m.jsx)("span",{className:"mr-2",children:(0,h.AP)("Loading")}),(0,m.jsx)(zl.Rh,{})]})]}),(0,m.jsx)("div",{className:"summaries-pane",children:(0,m.jsx)("div",{className:"summaries-scroll",ref:function(t){return e.summaryItemsRef=t},children:(0,m.jsx)("div",{style:{width:l+44},children:s||""})})})]})}}])}(s.Component),gf=mf,vf="clear-selected",yf="copy-selected",xf="open-parent-folder",Af="open-new-tab",Cf="generate-summary",bf=function(e){var t=e.isGroupView,n=e.selectedRange,r=e.selectedPosition,o=e.recordMetrics,i=e.recordGetterByIndex,a=e.onClearSelected,l=e.onCopySelected,c=e.updateRecords,u=e.getTableContentRect,d=e.getTableCanvasContainerRect,p=(0,s.useRef)(null),g=(0,s.useState)(!1),v=(0,F.A)(g,2),y=v[0],x=v[1],A=(0,s.useState)({top:0,left:0}),C=(0,F.A)(A,2),b=C[0],w=C[1],S=du().metadata,D=(0,s.useMemo)((function(){if(!y)return[];var e="r"===window.sfMetadataContext.getPermission(),a=S.columns,s=Ya(a,qo),l=window.sfMetadataContext.canModifyRow,c=[];if(n){if(!e&&c.push({value:vf,label:(0,h.AP)("Clear selected")}),c.push({value:yf,label:(0,h.AP)("Copy selected")}),s)for(var u=n.topLeft,d=n.bottomRight,p=u.rowIdx;p<=d.rowIdx;p++){var m=i({isGroupView:t,groupRecordIndex:u.groupRecordIndex,recordIndex:p}),g=m[Lo];if(f.Aq.isSdocFile(g)&&l(m)){c.push({value:Cf,label:(0,h.AP)("Generate summary")});break}}return c}var v=Object.keys(o.idSelectedRecordMap);if(v.length>1){if(s){var x=v.filter((function(e){var t=S.id_row_map[e];if(t){var n=t[Lo];return f.Aq.isSdocFile(n)&&l(t)}return!1}));x.length>0&&c.push({value:Cf,label:(0,h.AP)("Generate summary")})}return c}if(!r)return c;var A=r.groupRecordIndex,C=r.rowIdx,b=i({isGroupView:t,groupRecordIndex:A,recordIndex:C});if(!b)return c;var w=b[Po];if(c.push({value:Af,label:w?(0,h.AP)("Open folder in new tab"):(0,h.AP)("Open file in new tab")}),c.push({value:xf,label:(0,h.AP)("Open parent folder")}),s){var D=b[Lo];f.Aq.isSdocFile(D)&&l(b)&&c.push({value:Cf,label:(0,h.AP)("Generate summary")})}return c}),[y,t,r,o,n,S,i]),k=(0,s.useCallback)((function(e){p.current&&!p.current.contains(e.target)&&x(!1)}),[p]),M=(0,s.useCallback)((function(){var e=r.groupRecordIndex,n=r.rowIdx,o=i({isGroupView:t,groupRecordIndex:e,recordIndex:n});if(o){var a,s=window.sfMetadataStore.repoId,l=o[Po],c=o[No],u=o[Lo];a=l?window.location.origin+window.location.pathname+f.Aq.encodePath(f.Aq.joinPath(c,u)):"".concat(h.Yc,"lib/").concat(s,"/file").concat(f.Aq.encodePath(f.Aq.joinPath(c,u))),window.open(a,"_blank")}}),[t,i,r]),I=(0,s.useCallback)((function(e){e.preventDefault(),e.stopPropagation();var n=r.groupRecordIndex,o=r.rowIdx,a=i({isGroupView:t,groupRecordIndex:n,recordIndex:o});if(a){var s=a[No],l=window.location.origin+window.location.pathname+f.Aq.encodePath(s);window.open(l,"_blank")}}),[t,i,r]),_=(0,s.useCallback)((function(){var e=window.sfMetadataContext.canModifyRow,a=Object.keys(o.idSelectedRecordMap),s=qo,l=[],u={},d={};if(n)for(var p=n.topLeft,m=n.bottomRight,g=p.rowIdx;g<=m.rowIdx;g++){var v=i({isGroupView:t,groupRecordIndex:p.groupRecordIndex,recordIndex:g});if(e(v)){var y=v[Lo];if(f.Aq.isSdocFile(y)){var x=v[No];l.push(f.Aq.joinPath(x,y)),u[v[ko]]=(0,ro.default)({},s,v[s]),d[v[ko]]=(0,ro.default)({},s,v[s])}}}else if(a.length>0)a.forEach((function(t){var n=S.id_row_map[t],r=n[Lo];if(f.Aq.isSdocFile(r)&&e(n)){var o=n[No];l.push(f.Aq.joinPath(o,r)),u[n[ko]]=(0,ro.default)({},s,n[s]),d[n[ko]]=(0,ro.default)({},s,n[s])}}));else if(r){var A=r.groupRecordIndex,C=r.rowIdx,b=i({isGroupView:t,groupRecordIndex:A,recordIndex:C}),w=b[Lo];if(f.Aq.isSdocFile(w)&&e(b)){var D=b[No];l.push(f.Aq.joinPath(D,w)),u[b[ko]]=(0,ro.default)({},s,b[s]),d[b[ko]]=(0,ro.default)({},s,b[s])}}0!==l.length&&window.sfMetadataContext.generateSummary(l).then((function(e){var t=e.data.rows,n=[],r={},o={};t.forEach((function(e){var t=e._id,i=e._summary;n.push(t),r[t]=(0,ro.default)({},s,i),o[t]=(0,ro.default)({},s,i)})),c({recordIds:n,idRecordUpdates:r,idOriginalRecordUpdates:o,idOldRecordData:u,idOriginalOldRecordData:d})})).catch((function(e){var t=(0,h.AP)("Failed to generate summary");j.A.danger(t)}))}),[t,n,r,o,S,i,c]),P=(0,s.useCallback)((function(e,t){switch(e.stopPropagation(),t.value){case Af:M();break;case xf:I(e);break;case yf:l&&l();break;case vf:a&&a();break;case Cf:_&&_()}x(!1)}),[M,I,l,a,_]),N=(0,s.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n={top:t,left:e};if(!p.current)return n;var r=p.current.getBoundingClientRect(),o=d(),i=u(),a=i.right,s=i.bottom;return n.top=n.top-o.top,n.left=n.left-o.left,t+r.height>s-10&&(n.top-=r.height),e+r.width>a&&(n.left-=r.width),n.top<0&&(n.top=r.bottom>s?(s-10-r.height)/2:0),n.left<0&&(n.left=r.width<a?(a-r.width)/2:0),n}),[u,d]);return(0,s.useEffect)((function(){var e=function(e){if(e.preventDefault(),!p.current||!p.current.contains(e.target)){x(!0);var t=N(e.clientX,e.clientY);w(t)}};return document.addEventListener("contextmenu",e),function(){document.removeEventListener("contextmenu",e)}}),[]),(0,s.useEffect)((function(){return y?document.addEventListener("mousedown",k):document.removeEventListener("mousedown",k),function(){document.removeEventListener("mousedown",k)}}),[y,k]),y?0===D.length?null:(0,m.jsx)("div",{ref:p,className:"dropdown-menu sf-metadata-contextmenu",style:b,children:D.map((function(e,t){return(0,m.jsx)("button",{className:"dropdown-item sf-metadata-contextmenu-item",onClick:function(t){return P(t,e)},children:e.label},t)}))}):null},wf=function(e){function t(e){var n;(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).createColumnMetrics=function(e){var t=e.columns,n=e.table;return Oc(t,n.columns,n._id)},n.createRowMetrics=function(){arguments.length>0&&void 0!==arguments[0]||n.props;return{idSelectedRecordMap:{}}},n.setScrollLeft=function(e){n.resultContainerRef.scrollLeft=e},n.modifyColumnWidth=function(e,t){n.props.modifyColumnWidth(e.key,t)},n.getScrollPosition=function(){var e=window.sfMetadataContext.localStorage.getItem("scroll_left")+"",t=window.sfMetadataContext.localStorage.getItem("scroll_top")+"";e&&t&&n.bodyRef&&(e=Number(e),t=Number(t),n.bodyRef.setScrollTop(t),n.setScrollLeft(e),n.handleHorizontalScroll(e,t))},n.storeScrollPosition=function(){var e=n.bodyRef.getScrollTop(),t=n.getScrollLeft();window.sfMetadataContext.localStorage.setItem("scroll_left",t),n.storeScrollTop(e)},n.storeScrollTop=function(e){window.sfMetadataContext.localStorage.setItem("scroll_top",e)},n.onContentScroll=function(e){var t=e.target.scrollLeft,r=n.bodyRef.getScrollTop(),o=n.scrollLeft-t,i=n.scrollTop-r;n.scrollLeft=t,0!==i&&(n.scrollTop=r),0!==i||0===o&&0!==t||n.handleHorizontalScroll(t,r),n.storeScrollPosition(),window.sfMetadataContext.eventBus.dispatch(nl)},n.handleHorizontalScroll=function(e,t){var r=n.props.getTableContentRect().width;if(ec)n.updateHorizontalScrollState({scrollLeft:e,columnMetrics:n.state.columnMetrics,gridWidth:r});else{var o,i=n.resultContainerRef?n.resultContainerRef.className:"";(o=e>0?tc(i,"horizontal-scroll"):nc(i,"horizontal-scroll"))!==i&&n.resultContainerRef&&(n.resultContainerRef.className=o),n.lastScrollLeft=e,n.handleFrozenDOMsPosition(e,t),n.recordsFooterRef.setSummaryScrollLeft(e),n.isScrollByScrollbar||n.handleScrollbarScroll(e),n.bodyRef&&n.bodyRef.interactionMask&&n.bodyRef.setScrollLeft(e,t),n.updateHorizontalScrollState({scrollLeft:e,columnMetrics:n.state.columnMetrics,gridWidth:r})}},n.handleFrozenDOMsPosition=function(e,t){var r=n.state.columnMetrics.lastFrozenColumnKey;n.props.isGroupView&&!r||(n.clearSetAbsoluteTimer(),n.setFixed(e,t),n.timer=setTimeout((function(){n.setAbsolute(e,t)}),100))},n.handleScrollbarScroll=function(e){n.horizontalScrollbar&&(n.isScrollByScrollbar?n.isScrollByScrollbar=!1:n.setHorizontalScrollbarScrollLeft(e))},n.onHorizontalScrollbarScroll=function(e){n.isScrollByScrollbar=!0,n.setScrollLeft(e)},n.onHorizontalScrollbarMouseUp=function(){n.isScrollByScrollbar=!1},n.setHorizontalScrollbarScrollLeft=function(e){n.horizontalScrollbar&&n.horizontalScrollbar.setScrollLeft(e)},n.setFixed=function(e,t){n.bodyRef.recordFrozenRefs.forEach((function(e){e&&(e.frozenColumns.style.position="fixed",e.frozenColumns.style.marginLeft="0px",e.frozenColumns.style.marginTop="-"+t+"px")})),n.bodyRef.fixFrozenDoms&&n.bodyRef.fixFrozenDoms(e,t)},n.setAbsolute=function(e){var t=n.props.isGroupView,r=n.state.columnMetrics.lastFrozenColumnKey;t&&!r||(n.bodyRef.recordFrozenRefs.forEach((function(t){t&&(t.frozenColumns.style.position="absolute",t.frozenColumns.style.marginLeft=e+"px",t.frozenColumns.style.marginTop="0px")})),n.bodyRef.cancelFixFrozenDOMs&&n.bodyRef.cancelFixFrozenDOMs(e),n.bodyRef&&n.bodyRef.interactionMask&&n.bodyRef.cancelSetScrollLeft())},n.clearSetAbsoluteTimer=function(){n.timer&&(clearTimeout(n.timer),n.timer=null)},n.getScrollLeft=function(){return ec?0:n.scrollLeft||0},n.getScrollTop=function(){return ec?0:n.scrollTop||0},n.setHorizontalScrollbarRef=function(e){n.horizontalScrollbar=e},n.setResultContainerRef=function(e){n.resultContainerRef=e},n.updateSelectedRange=function(e){n.setState({selectedRange:e})},n.onClickContainer=function(e){var t=Ql(e);(t.includes("sf-metadata-result-content")||t.includes("sf-metadata-result-table-content"))&&window.sfMetadataContext.eventBus.dispatch(nl)},n.onCellClick=function(e){e&&n.updateSelectedRange({topLeft:n.initPosition,bottomRight:n.initPosition}),n.onDeselectAllRecords()},n.onCellRangeSelectionUpdated=function(e){n.onCellClick(),n.updateSelectedRange(e)},n.onCopyCells=function(e){window.sfMetadataContext.eventBus.dispatch(ll,e)},n.onPasteCells=function(e){window.sfMetadataContext.eventBus.dispatch(cl,e)},n.onTouchStart=function(e){if(e.target&&["canvas","group-canvas"].includes(e.target.id)){var t={startX:e.changedTouches[0].clientX,startY:e.changedTouches[0].clientY};n.setState({touchStartPosition:t})}},n.onTouchEnd=function(e){if(e.target&&["canvas","group-canvas"].includes(e.target.id)){var t=e.changedTouches[0],r=t.clientX,o=t.clientY,i=n.state.touchStartPosition;Math.abs(i.startX-r)<5&&Math.abs(i.startY-o)<5&&window.sfMetadataContext.eventBus.dispatch(sl)}},n.onMouseDown=function(e){var t=Ql(e);if(!(t.indexOf("sf-metadata-result-table-cell")>-1)){(["canvas","group-canvas"].includes(e.target.id)||t.includes("sf-metadata-result-content"))&&window.sfMetadataContext.eventBus.dispatch(sl)}},n.selectNone=function(){n.setState({selectedRange:{topLeft:n.initPosition,bottomRight:n.initPosition}}),n.onDeselectAllRecords()},n.selectCell=function(e){n.setState({selectedPosition:e})},n.onSelectRecord=function(e,t){var r=e.groupRecordIndex,o=e.recordIndex;if(t.stopPropagation(),Fp(t))n.selectRecordWithShift({groupRecordIndex:r,recordIndex:o});else{var i=n.props.isGroupView,a=n.state.recordMetrics,s=n.props.recordGetterByIndex({isGroupView:i,groupRecordIndex:r,recordIndex:o});if(s){var l=s._id;if($p.isRecordSelected(l,a))return n.deselectRecord(l),void n.setState({lastRowIdxUiSelected:{groupRecordIndex:-1,recordIndex:-1}});n.selectRecord(l),n.setState({lastRowIdxUiSelected:{groupRecordIndex:r,recordIndex:o}})}}},n.selectRecordWithShift=function(e){var t=e.groupRecordIndex,r=e.recordIndex,o=n.props,i=o.recordIds,a=o.isGroupView,s=n.state,l=s.lastRowIdxUiSelected,c=s.recordMetrics,u=[];if(a){if(!window.sfMetadataBody||!window.sfMetadataBody.getGroupMetrics)return;for(var d=window.sfMetadataBody.getGroupMetrics().groupRows,p=[t,l.groupRecordIndex].sort((function(e,t){return e-t})),h=p[0];h<=p[1];h++){var f=d[h];f.type===Nl&&u.push(f.rowId)}}else{var m=i[r];if(!m)return;var g=l.recordIndex;if(g<0)return n.selectRecord(m),void n.setState({lastRowIdxUiSelected:{groupRecordIndex:-1,recordIndex:r}});if(r===g||$p.isRecordSelected(m,c))return n.deselectRecord(m),void n.setState({lastRowIdxUiSelected:{groupRecordIndex:-1,recordIndex:-1}});u=n.getRecordIdsBetweenRange({start:g,end:r})}0!==u.length&&(n.selectRecordsById(u),n.setState({lastRowIdxUiSelected:{groupRecordIndex:t,recordIndex:r}}))},n.getRecordIdsBetweenRange=function(e){for(var t=e.start,r=e.end,o=n.props.recordIds,i=Math.min(t,r),a=Math.max(t,r),s=[],l=i;l<=a;l++){var c=o[l];c&&s.push(c)}return s},n.selectRecord=function(e){var t=n.state.recordMetrics;if(!$p.isRecordSelected(e,t)){var r=(0,Sr.A)({},t);$p.selectRecord(e,r),n.setState({recordMetrics:r})}},n.selectRecordsById=function(e){var t=n.state.recordMetrics;if(0!==e.filter((function(e){return!$p.isRecordSelected(e,t)})).length){var r=(0,Sr.A)({},t);$p.selectRecordsById(e,r),n.setState({recordMetrics:r})}},n.deselectRecord=function(e){var t=n.state.recordMetrics;if($p.isRecordSelected(e,t)){var r=(0,Sr.A)({},t);$p.deselectRecord(e,r),n.setState({recordMetrics:r})}},n.selectAllRecords=function(){var e=n.props,t=e.recordIds,r=e.isGroupView,o=n.state.recordMetrics,i=(0,Sr.A)({},o),a=[];if(r){if(!window.sfMetadataBody||!window.sfMetadataBody.getGroupMetrics)return;window.sfMetadataBody.getGroupMetrics().groupRows.forEach((function(e){e.type===Nl&&a.push(e.rowId)}))}else a=t;$p.selectRecordsById(a,i),n.setState({recordMetrics:i})},n.onDeselectAllRecords=function(){var e=n.state.recordMetrics;if($p.hasSelectedRecords(e)){var t=(0,Sr.A)({},e);$p.deselectAllRecords(t),n.setState({recordMetrics:t,lastRowIdxUiSelected:{groupRecordIndex:-1,recordIndex:-1}})}},n.hasSelectedCell=function(e,t){var r=e.groupRecordIndex,o=e.recordIndex;if(!t)return!1;var i=n.props.isGroupView,a=t.groupRecordIndex,s=t.rowIdx;return i?r===a:o===s},n.hasSelectedRecord=function(){var e=n.state.recordMetrics;if(!$p.hasSelectedRecords(e))return!1;var t=$p.getSelectedIds(e),r=t&&t.map((function(e){return n.props.recordGetterById(e)})).filter(Boolean);return r&&r.length>0},n.getHorizontalScrollState=function(e){var t=e.gridWidth,n=e.columnMetrics,r=e.scrollLeft,o=n.columns,i=o.length,a=function(e,t,n){var r=function(e,t){for(var n=t,r=e.slice(0),o=0;o<r.length;o++)if((n-=e[o].width)<0)return o}(e,t),o=function(e,t,n){for(var r=t+n,o=0;o<e.length;o++)if((r-=e[o].width)<0)return o-1;return e.length-1}(e,n,t);return{colVisibleStartIdx:r,colVisibleEndIdx:o}}(o,r,t),s=a.colVisibleStartIdx,l=a.colVisibleEndIdx,c=function(e){return Math.max(0,10*Math.floor(e/10)-10)}(s),u=function(e,t){return Math.min(10*Math.ceil(e/10)+10,t)}(l,i);return{colOverScanStartIdx:c,colOverScanEndIdx:u}},n.updateHorizontalScrollState=function(e){var t=e.columnMetrics,r=e.gridWidth,o=e.scrollLeft,i=n.getHorizontalScrollState({columnMetrics:t,gridWidth:r,scrollLeft:o});n.setState(i)},n.isOutSelectedRange=function(e){var t=e.recordIndex,r=e.idx,o=n.state.selectedRange,i=o.topLeft,a=o.bottomRight,s=i.idx,l=i.rowIdx,c=a.idx,u=a.rowIdx;return r<s||r>c||t<l||t>u},n.onCellContextMenu=function(e){var t=e.rowIdx,r=e.idx,o=e.groupRecordIndex,i=n.props,a=i.isGroupView,s=(0,i.recordGetterByIndex)({isGroupView:a,groupRecordIndex:o,recordIndex:t});if(s){var l=n.state.recordMetrics,c=s._id;$p.isRecordSelected(c,l)||n.setState({recordMetrics:n.createRowMetrics()}),n.isOutSelectedRange({recordIndex:t,idx:r})&&window.sfMetadataContext.eventBus.dispatch(rl,e,!1)}},n.getTableCanvasContainerRect=function(){return n.resultContainerRef.getBoundingClientRect()},n.renderRecordsBody=function(e){var t=e.containerWidth,r=n.props,o=r.isGroupView,i=r.recordGetterByIndex,a=r.updateRecords,s=n.state,l=s.recordMetrics,c=s.columnMetrics,u=s.colOverScanStartIdx,d=s.colOverScanEndIdx,p=c.columns,h=c.allColumns,f=c.totalWidth,g=c.lastFrozenColumnKey,v=c.frozenColumnsWidth,y=(0,Sr.A)((0,Sr.A)({},n.props),{},{columns:p,allColumns:h,totalWidth:f,lastFrozenColumnKey:g,frozenColumnsWidth:v,recordMetrics:l,colOverScanStartIdx:u,colOverScanEndIdx:d,contextMenu:(0,m.jsx)(bf,{isGroupView:o,recordGetterByIndex:i,updateRecords:a}),hasSelectedRecord:n.hasSelectedRecord(),getScrollLeft:n.getScrollLeft,getScrollTop:n.getScrollTop,selectNone:n.selectNone,onCellClick:n.onCellClick,onCellRangeSelectionUpdated:n.onCellRangeSelectionUpdated,onSelectRecord:n.onSelectRecord,setRecordsScrollLeft:n.setScrollLeft,hasSelectedCell:n.hasSelectedCell,cacheScrollTop:n.storeScrollTop,onCellContextMenu:n.onCellContextMenu,getTableCanvasContainerRect:n.getTableCanvasContainerRect});return n.props.isGroupView?(0,m.jsx)(pf,(0,Sr.A)((0,Sr.A)({onRef:function(e){return n.bodyRef=e}},y),{},{containerWidth:t,groups:n.props.groups,groupbys:n.props.groupbys,groupOffsetLeft:n.props.groupOffsetLeft})):(0,m.jsx)(Vh,(0,Sr.A)((0,Sr.A)({onRef:function(e){return n.bodyRef=e}},y),{},{recordIds:n.props.recordIds}))},n.scrollTop=0,n.isScrollByScrollbar=!1;var o=window.sfMetadataContext.localStorage.getItem("scroll_left");n.scrollLeft=o?Number(o):0,n.lastScrollLeft=n.scrollLeft,n.initPosition={idx:-1,rowIdx:-1,groupRecordIndex:-1};var a=n.createColumnMetrics(e),s=e.getTableContentRect().width,l=n.getHorizontalScrollState({gridWidth:s,columnMetrics:a,scrollLeft:0});return n.state=(0,Sr.A)({columnMetrics:a,recordMetrics:n.createRowMetrics(),lastRowIdxUiSelected:{groupRecordIndex:-1,recordIndex:-1},touchStartPosition:{},selectedRange:{topLeft:n.initPosition,bottomRight:n.initPosition},selectedPosition:n.initPosition},l),n.isWindows=/windows|win32/i.test(navigator.userAgent),n.isWebkit=navigator.userAgent.toLowerCase().includes("webkit"),n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){document.addEventListener("copy",this.onCopyCells),document.addEventListener("paste",this.onPasteCells),window.isMobile?(window.addEventListener("touchstart",this.onTouchStart),window.addEventListener("touchend",this.onTouchEnd)):document.addEventListener("mousedown",this.onMouseDown),this.unsubscribeSelectNone=window.sfMetadataContext.eventBus.subscribe(sl,this.selectNone),this.unsubscribeSelectCell=window.sfMetadataContext.eventBus.subscribe(rl,this.selectCell),this.getScrollPosition()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t,n=e.columns,r=(0,e.getTableContentRect)().width;if(this.props.columns!==n){var o=this.createColumnMetrics(e);this.updateHorizontalScrollState({columnMetrics:o,scrollLeft:this.lastScrollLeft,gridWidth:r}),this.setState({columnMetrics:o})}else(null===(t=this.props.getTableContentRect())||void 0===t?void 0:t.width)!==r&&this.updateHorizontalScrollState({columnMetrics:this.state.columnMetrics,scrollLeft:this.lastScrollLeft,gridWidth:r})}},{key:"componentWillUnmount",value:function(){document.removeEventListener("copy",this.onCopyCells),document.removeEventListener("paste",this.onPasteCells),window.isMobile?(window.removeEventListener("touchstart",this.onTouchStart),window.removeEventListener("touchend",this.onTouchEnd)):document.removeEventListener("mousedown",this.onMouseDown),this.clearSetAbsoluteTimer(),this.unsubscribeSelectNone(),this.unsubscribeSelectCell(),this.setState=function(e,t){}}},{key:"render",value:function(){var e=this,t=this.props,n=t.recordIds,r=t.recordsCount,o=t.table,i=t.isGroupView,a=t.groupOffsetLeft,l=t.renameColumn,c=t.modifyColumnData,u=t.deleteColumn,d=t.modifyColumnOrder,p=this.state,h=p.recordMetrics,f=p.columnMetrics,g=p.selectedRange,v=p.colOverScanStartIdx,y=p.colOverScanEndIdx,x=f.columns,A=f.totalWidth,C=f.lastFrozenColumnKey,b=A+Ml+44+a,w=this.hasSelectedRecord(),S=$p.isSelectedAll(n,h);return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("div",{className:"sf-metadata-result-container ".concat(this.isWindows?"windows-browser":""),ref:this.setResultContainerRef,onScroll:this.onContentScroll,onClick:this.onClickContainer,children:(0,m.jsxs)("div",{className:"sf-metadata-result-content",style:{width:b},children:[(0,m.jsx)(ip,{onRef:function(t){return e.headerFrozenRef=t},containerWidth:b,table:o,columnMetrics:f,colOverScanStartIdx:v,colOverScanEndIdx:y,hasSelectedRecord:w,isSelectedAll:S,isGroupView:i,groupOffsetLeft:a,lastFrozenColumnKey:C,modifyColumnWidth:this.modifyColumnWidth,selectNoneRecords:this.selectNone,selectAllRecords:this.selectAllRecords,renameColumn:l,deleteColumn:u,modifyColumnData:c,modifyColumnOrder:d}),this.renderRecordsBody({containerWidth:b})]})}),this.isWindows&&this.isWebkit&&(0,m.jsx)(cp,{ref:this.setHorizontalScrollbarRef,innerWidth:A+44,onScrollbarScroll:this.onHorizontalScrollbarScroll,onScrollbarMouseUp:this.onHorizontalScrollbarMouseUp}),(0,m.jsx)(gf,{ref:function(t){return e.recordsFooterRef=t},recordsCount:r,hasMore:this.props.hasMore,columns:x,groupOffsetLeft:a,recordMetrics:h,selectedRange:g,isGroupView:i,hasSelectedRecord:w,isLoadingMore:this.props.isLoadingMore,recordGetterById:this.props.recordGetterById,recordGetterByIndex:this.props.recordGetterByIndex,getRecordsSummaries:function(){},loadAll:this.props.loadAll})]})}}])}(s.Component),Sf=wf,Df=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD";if("string"!==typeof e||!e.trim())return null;var n={};return n=/^[0-9]+$/.test(e)?new Date(Fa(e)):ms.parseDateWithFormat(e,t),t.indexOf("HH:mm")<0?ms.format(n,"YYYY-MM-DD")||null:ms.format(n,"YYYY-MM-DD HH:MM")||null},kf=(0,ro.default)((0,ro.default)({},lo.MULTIPLE_SELECT,[lo.MULTIPLE_SELECT,lo.TEXT,lo.SINGLE_SELECT]),lo.NUMBER,[lo.TEXT,lo.NUMBER]),Mf=/(\d{4})\u5e74(\d{1,2})\u6708(\d{1,2})\u65e5$/;var jf=1e5,If=function(e){var t=e.text;return!!t&&t.length>=jf},_f=function(e){var t=(0,Sr.A)({},e),n=t.text,r=t.preview;return t.text=n?n.slice(0,jf):"",t.preview=r?r.slice(0,jf):"",t};var Pf=function(e,t,n,r){var o=n.type;if(!e||Array.isArray(e)&&0===e.length||!kf[lo.MULTIPLE_SELECT].includes(o))return{selectedOptionIds:t};var i=[];if(o===lo.MULTIPLE_SELECT)i=Ha(n).filter((function(t){return e.includes(t.id)||e.includes(t.name)})).map((function(e){return e.name}));else if(o===lo.TEXT){var a=String(e);1===(i=a.split("\n")).length&&(i=a.split(",")),i=i.map((function(e){return e.trim()})).filter((function(e){return""!==e}))}else if(o===lo.SINGLE_SELECT){i=Ha(n).filter((function(t){return t.id===e})).map((function(e){return e.name}))}if(0===i.length)return{selectedOptionIds:t};var s=Ha(r),l=function(e,t){var n=[],r=[];return t.forEach((function(t){var o=e.find((function(e){return e.name===t}));if(o)r.push(o.id);else{var i=za(e,t);i&&(n.push(i),r.push(i.id))}})),0===n.length?{selectedOptionIds:r}:{cellOptions:n,selectedOptionIds:r}}(s,i);return{pasteOptions:s,newCellOptions:l.cellOptions,selectedOptionIds:l.selectedOptionIds}};function Nf(e,t,n,r,o){var i=r.type,a=r.data,s=n.type,l=n.data;switch(s){case lo.CHECKBOX:return function(e,t,n){switch(n){case lo.CHECKBOX:return"boolean"===typeof e?e:null;case lo.TEXT:return!(!e||"string"!==typeof e||"true"!==e.toLocaleLowerCase());case lo.NUMBER:return e>0;default:return t}}(e,t,i);case lo.NUMBER:return function(e,t,n,r){if(!kf[lo.NUMBER].includes(n))return t;if(0===e)return e;if(!e)return null;switch(n){case lo.NUMBER:case lo.RATE:case lo.DURATION:return e;case lo.TEXT:if(e.includes("%"))return Fa(e,"percent")}var o="string"===typeof e?e:e.toString();return Ua(o,r)}(e,t,i,l);case lo.DATE:return function(e,t,n,r,o){var i=(null===o||void 0===o?void 0:o.format)||fo,a=(null===r||void 0===r?void 0:r.format)||fo;switch(n){case lo.DATE:var s=a.indexOf("HH:mm"),l=i.indexOf("HH:mm");return s>-1&&l>-1||s===l?e:Df(e,i);case lo.CTIME:case lo.MTIME:return Df(e,i);case lo.TEXT:if(e.indexOf("\u5e74")>-1){var c=e.replace(/\s*/g,"");return Mf.test(c)?Df(c.replace(Mf,"$1-$2-$3"),i):""}return Df(e,i);default:return t}}(e,t,i,a,l);case lo.SINGLE_SELECT:return function(e,t,n,r){if(!e)return t;var o;switch(n.type){case lo.SINGLE_SELECT:var i=Ha(n);o=Ka(i,e)||"";break;case lo.MULTIPLE_SELECT:var a=Ha(n),s=e[0];o=Ka(a,s)||"";break;case lo.TEXT:o=e}if(!o)return t;var l=Ha(r),c=Va(l,o);return Qo.includes(r.key)?c.id:c.name}(e,t,r,n);case lo.MULTIPLE_SELECT:return function(e,t,n,r,o){var i=Pf(e,t,n,r),a=i.newCellOptions,s=i.pasteOptions,l=i.selectedOptionIds,c=r;if(a){if(!window.sfMetadataContext.canModifyColumnData(r))return null;var u=[].concat((0,W.A)(s),(0,W.A)(a));c.data||(c.data={}),c.data.options=u,o.modifyColumnData(r.key,{options:u},r.data)}return Xa(c,l)}(e,t,r,n,o);case lo.LONG_TEXT:return function(e,t,n){var r=n.type,o=n.data;switch(r){case lo.LONG_TEXT:var i={text:e};return If(i)?_f(i).text:e||null;case lo.TEXT:return e||null;case lo.NUMBER:return Ra(e,o)||null;case lo.DATE:return Da(e,o.format||fo)||null;default:return t}}(e,t,r);case lo.TEXT:return function(e,t,n){var r=n.type,o=n.data;switch(r){case lo.TEXT:return Ba(e)?String(e):e?"string"===typeof e?e.replace(/\n/g,"").trim():String(e):null;case lo.URL:case lo.EMAIL:case lo.AUTO_NUMBER:return e;case lo.NUMBER:return Ra(e,o);case lo.DATE:return Da(e,o.format||fo);case lo.SINGLE_SELECT:var i=Ha(n);return Ka(i,e)||null;case lo.COLLABORATOR:var a=window.sfMetadata.getCollaborators();return Ja(a,e);case lo.CREATOR:case lo.LAST_MODIFIER:if(!e)return null;var s=window.sfMetadata.getCollaborators();return Ja(s,[e]);default:return t}}(e,t,r);case lo.COLLABORATOR:return function(e,t,n){switch(n){case lo.COLLABORATOR:if(!Array.isArray(e)||0===e.length)return null;var r=window.sfMetadata.getCollaborators(),o={};return r.forEach((function(e){return o[e.email]=!0})),e.filter((function(e){return!!o[e]}));case lo.TEXT:if(!e)return t;var i=e.split(",");if(0===i.length)return t;var a=window.sfMetadata.getCollaborators(),s={};a.forEach((function(e){return s[e.name]=e}));var l=i.map((function(e){var t=s[e];return t?t.email:null})).filter(Boolean);return 0===l.length?t:l;case lo.CREATOR:case lo.LAST_MODIFIER:var c=window.sfMetadata.getCollaborators(),u={};return c.forEach((function(e){return u[e.email]=!0})),e&&u[e]?[e]:null;default:return t}}(e,t,i);default:return t}}var Of=function(e){return e.value},Tf=function(){return(0,o.A)((function e(t,n){(0,r.A)(this,e),this.metadata=t,this.api=n}),[{key:"getCopiedContent",value:function(e){var t=this,n=e.type,r=e.copied,o=e.isGroupView,i=e.columns;if(n===kl.DTABLE_FRAGMENT){var a=r.selectedRecordIds,s=r.copiedRange;if(Array.isArray(a)&&a.length>0)return{copiedRecords:a.map((function(e){return t.api.recordGetterById(e)})),copiedColumns:(0,W.A)(i)};for(var l=[],c=[],u=s.topLeft,d=s.bottomRight,p=u.rowIdx,h=u.idx,f=u.groupRecordIndex,m=d.rowIdx,g=d.idx,v=f,y=p;y<=m;y++)l.push(this.api.recordGetterByIndex({isGroupView:o,groupRecordIndex:v,recordIndex:y})),o&&v++;for(var x=h;x<=g;x++)c.push(Ic(x,i));return{copiedRecords:l,copiedColumns:c}}return{copiedRecords:r.copiedRecords,copiedColumns:r.copiedColumns}}},{key:"paste",value:function(){var e=(0,ln.A)((0,sn.A)().mark((function e(t){var n,r,o,i,a,s,l,c,u,d,p,h,f,m,g,v,y,x,A,C,b,w,S,D,k,M,j,I,_,P,N,O,T,E,R,L,F,U,B,Y,q,H,G,z,V,W;return(0,sn.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.copied,r=t.multiplePaste,o=t.pasteRange,i=t.isGroupView,a=t.columns,s=this.metadata.row_ids,l=o.topLeft,c=o.bottomRight,u=void 0===c?{}:c,d=l.rowIdx,p=l.idx,h=l.groupRecordIndex,f=u.rowIdx,m=u.idx,g=n.copiedRecords,v=n.copiedColumns,y=g.length,x=v.length,A=r?f-d+1:y,C=r?m-p+1:x,b=s.length,!(y>b-d)){e.next=14;break}return e.abrupt("return");case 14:w=[],S={},D={},k={},M={},j=h,I=0;case 21:if(!(I<A)){e.next=59;break}if(_=this.api.recordGetterByIndex({isGroupView:i,groupRecordIndex:j,recordIndex:d+I}),i&&j++,_){e.next=26;break}return e.abrupt("continue",56);case 26:P=_._id,N=g[I%y],O={},T={},E={},R={},L=window.sfMetadataContext,F=L.canModifyRow,U=L.canModifyColumn,B=0;case 35:if(!(B<C)){e.next=55;break}if((Y=Ic(B+p,a))&&F(_)&&U(Y)){e.next=39;break}return e.abrupt("continue",52);case 39:if(q=Ic(B%x,v),H=Ec(Y),G=Ec(q),z=Object.prototype.hasOwnProperty.call(_,H)?ba(_,Y):null,V=Object.prototype.hasOwnProperty.call(N,G)?ba(N,q):null,(W=Nf(V,z,Y,q,this.api))!==z){e.next=48;break}return e.abrupt("continue",52);case 48:O[H]=W,T[Y.key]=W,E[H]=z,R[Y.key]=z;case 52:B++,e.next=35;break;case 55:Object.keys(O).length>0&&(w.push(P),S[P]=O,D[P]=T,k[P]=E,M[P]=R);case 56:I++,e.next=21;break;case 59:if(0!==w.length){e.next=61;break}return e.abrupt("return");case 61:this.api.modifyRecords(w,S,D,k,M,true);case 62:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getLinkedRowsIdsByNameColumn",value:function(e,t,n,r){if(!Array.isArray(e)||0===e.length)return[];var o=String(n),i=e.find((function(e){var t;return(null===(t=e["0000"])||void 0===t?void 0:t.trim())===o.trim()}))||null;if(i)return r[t]=[{display_value:o,row_id:i._id}],[i._id];var a=[];if(o.includes(",")||o.includes("\uff0c")){var s=o.split(/[,\uff0c]/).map((function(e){return e.trim()})).filter((function(e,t,n){return n.indexOf(e)===t}));if(!Array.isArray(s)||0===s.length)return[];r[t]=[],s.forEach((function(n){var o=e.find((function(e){var t;return(null===(t=e["0000"])||void 0===t?void 0:t.trim())===n}))||null;o&&(r[t].push({display_value:n,row_id:o._id}),a.push(o._id))}))}return a}},{key:"getUpdateDraggedRecords",value:function(e,t,n,r,o){for(var i=[],a={},s={},l={},c={},u=e.overRecordIdx,d=e.topLeft,p=e.bottomRight,h=d.idx,f=p.idx,m=p.rowIdx,g=p.groupRecordIndex,v=window.sfMetadataContext,y=v.canModifyRow,x=v.canModifyColumn,A=this.getDraggedRangeMatrix(t,e,n,o,r),C=this.getDraggedRangeRules(A,t,h),b=A[0].length,w=A[0].length,S=g+1,D=m+1;D<=u;D++){var k=void 0;if(S)k=r[Mp(S,o).rowId];else k=n[D];var M=k._id;if(w++,y(k)){i.push(M);for(var j=(D-m-1)%b,I=h;I<=f;I++){var _=t[I],P=_.key,N=_.type,O=Ec(_);if(x(_)&&!Tl.includes(N)){var T=A[I-h][j],E=(0,C[P])({n:w-1,value:T});a[M]=Object.assign({},a[M],(0,ro.default)({},O,E)),s[M]=Object.assign({},s[M],(0,ro.default)({},O,k[O]));var R=a[M],L=s[M];l[M]=Object.assign({},l[M],R),c[M]=Object.assign({},c[M],L)}}S++}}return{recordIds:i,idOriginalRecordUpdates:a,idRecordUpdates:l,idOriginalOldRecordData:s,idOldRecordData:c}}},{key:"getDraggedRangeMatrix",value:function(e,t,n,r,o){for(var i=[],a=t.topLeft,s=t.bottomRight,l=a.idx,c=a.rowIdx,u=a.groupRecordIndex,d=s.idx,p=s.rowIdx,h=l;h<=d;h++){var f=u;i[h-l]=[];for(var m=e[h],g=c;g<=p;g++){var v=void 0;if(f)v=o[Mp(f,r).rowId];else v=n[g];i[h-l][g-c]=ba(v,m),f++}}return i}},{key:"getDraggedRangeRules",value:function(e,t,n){var r=this,o={};return e.forEach((function(e,i){var a=t[i+n],s=a.type,l=a.data,c=a.key,u=Of;if(e.length>1)switch(s){case lo.DATE:var d=l&&l.format&&l.format.indexOf("HH:mm")>-1?"YYYY-MM-DD HH:mm":"YYYY-MM-DD",p=e[0],h=r.getYearTolerance(e);if(h){u=function(e){var t=e.n;return Sa()(p).add(t*h,"years").format(d)};break}var f=r.getMonthTolerance(e);if(f){u=function(e){var t=e.n;return Sa()(p).add(t*f,"months").format(d)};break}var m=r.getDayTolerance(e);if(m){u=function(e){var t=e.n*m+r.getDateStringValue(p);return Sa()(t).format(d)};break}break;case lo.NUMBER:u=r.getLeastSquares(e);break;case lo.TEXT:u=r._getTextRule(e);break;case lo.RATE:u=r.getRatingLeastSquares(e,l);break;default:u=Of}o[c]=u})),o}},{key:"getDateStringValue",value:function(e){var t=Sa()(e);return t.isValid()?t.valueOf():0}},{key:"getYearTolerance",value:function(e){var t=Sa()(e[0]),n=Sa()(e[1]);if(!t.isValid()||!n.isValid())return 0;if(t.month()!==n.month()||t.date()!==n.date()||t.hour()!==n.hour()||t.minute()!==n.minute())return 0;var r=t.year(),o=n.year()-r,i=e.every((function(e,t){var n=Sa()(e);return!!n.isValid()&&n.year()===t*o+r}));return i?o:0}},{key:"getMonthTolerance",value:function(e){var t=Sa()(e[0]),n=Sa()(e[1]);if(!t.isValid()||!n.isValid())return 0;if(t.date()!==n.date()||t.hour()!==n.hour()||t.minute()!==n.minute())return 0;var r=n.month()-t.month()+12*(n.year()-t.year()),o=e.every((function(t,n){var o=n*r,i=Sa()(t);return!!i.isValid()&&i.isSame(Sa()(e[0]).add(o,"month"),"minute")}));return o?r:0}},{key:"getDayTolerance",value:function(e){var t=this,n=this.getDateStringValue(e[0]),r=this.getDateStringValue(e[1])-n,o=e.every((function(e,o){return!!Sa()(e).isValid()&&t.getDateStringValue(e)===o*r+n}));return o?r:0}},{key:"getLeastSquares",value:function(e){var t,n,r,o,i=0,a=0,s=0,l=0,c=0,u=[];return e.forEach((function(e,t){void 0!==e&&null!==e&&""!==e?(c++,i+=t,a+=e,l+=e*t,s+=Math.pow(t,2)):u.push(t)})),c<2?Of:(t=(l-c*(r=i/c)*(o=a/c))/(s-c*Math.pow(r,2)),n=o-t*r,function(r){var o=r.n;return u.length&&u.includes(o%e.length)?"":Number(parseFloat(o*t+n).toFixed(8))})}}])}(),Ef=Tf,Rf=["metadata","modifyRecord","modifyRecords","loadMore","loadAll","searchResult","recordGetterByIndex","recordGetterById","modifyColumnData"],Lf=function(e){var t,n,r=e.metadata,o=e.modifyRecord,i=e.modifyRecords,a=e.loadMore,l=e.loadAll,c=(e.searchResult,e.recordGetterByIndex),u=e.recordGetterById,d=e.modifyColumnData,p=(0,dc.A)(e,Rf),h=(0,s.useMemo)((function(){return new Ef(r,{modifyRecord:o,modifyRecords:i,recordGetterByIndex:c,recordGetterById:u,modifyColumnData:d})}),[r,o,i,c,u,d]),f=(0,s.useMemo)((function(){var e;return((null===r||void 0===r||null===(e=r.view)||void 0===e?void 0:e.groupbys)||[]).length}),[r]),g=(0,s.useMemo)((function(){return f*jl}),[f]),v=(0,s.useMemo)((function(){var e=r.view,t=e.columns,n=e.hidden_columns;return t.filter((function(e){return!n.includes(e.key)}))}),[r]),y=(0,s.useCallback)((function(e){var t=e.type,n=e.copied,r=e.isGroupView;return h.getCopiedContent({type:t,copied:n,isGroupView:r,columns:v})}),[h,v]),x=(0,s.useCallback)((function(e){var t=e.rowId,n=e.updates,r=e.originalUpdates,i=e.oldRowData,a=e.originalOldRowData;o&&o(t,n,i,r,a)}),[o]),A=(0,s.useCallback)((function(e){var t=e.recordIds,n=e.idRecordUpdates,r=e.idOriginalRecordUpdates,o=e.idOldRecordData,a=e.idOriginalOldRecordData,s=e.isCopyPaste;i&&i(t,n,r,o,a,void 0!==s&&s)}),[i]),C=(0,s.useCallback)((function(e){var t=e.type,n=e.copied,r=e.multiplePaste,o=e.pasteRange,i=e.isGroupView;h.paste({type:t,copied:n,multiplePaste:r,pasteRange:o,isGroupView:i,columns:v})}),[h,v]);return(0,m.jsx)("div",{className:D()("table-main-container container-fluid p-0",(0,ro.default)({},"group-level-".concat(f+1),f>0)),children:(0,m.jsx)(Sf,(0,Sr.A)({columns:v,recordIds:r.view.rows||[],groups:r.view.groups,groupbys:r.view.groupbys,recordsCount:(null===r||void 0===r||null===(t=r.view)||void 0===t||null===(n=t.rows)||void 0===n?void 0:n.length)||0,table:r,hasMore:r.hasMore,gridUtils:h,scrollToLoadMore:a,loadAll:l,paste:C,groupOffsetLeft:g,modifyRecord:x,updateRecords:A,getCopiedRecordsAndColumnsFromRange:y,recordGetterById:u,recordGetterByIndex:c,modifyColumnData:d},p))})},Ff=function(){var e=(0,s.useState)(100),t=(0,F.A)(e,2),n=t[0],r=t[1],o=(0,s.useState)(8),i=(0,F.A)(o,2),a=i[0],l=i[1],c=(0,s.useState)(960),u=(0,F.A)(c,2),d=u[0],p=u[1],g=(0,s.useState)((function(){try{var e=localStorage.getItem("sliderValue");return null!==e?Number(e):0}catch(t){return 0}})),v=(0,F.A)(g,2),y=v[0],x=v[1],A=(0,s.useState)(100),C=(0,F.A)(A,2),b=C[0],w=C[1],S=(0,s.useState)([]),D=(0,F.A)(S,2),k=D[0],M=D[1],j=(0,s.useState)(0),I=(0,F.A)(j,2),_=I[0],P=I[1],N=(0,s.useRef)([]),O=(0,s.useRef)(null),T=du(),E=T.isLoading,R=T.metadata,L=window.sfMetadataContext.getSetting("repoID");(0,s.useEffect)((function(){var e=new ResizeObserver((function(){O.current&&p(O.current.offsetWidth)})),t=O.current;return t&&e.observe(t),function(){t&&e.unobserve(t)}}),[]),(0,s.useEffect)((function(){window.sfMetadataContext.eventBus.subscribe(Dl,(function(e){x(e)}))}),[a]),(0,s.useEffect)((function(){var e=(f.Aq.isDesktop()?8:4)-y,t=(d-2*e-2)/e;l(e),r(t)}),[d,y]);var U=(0,s.useMemo)((function(){return R.rows.filter((function(e){return f.Aq.imageCheck(e[Lo])})).map((function(e){var t=e[Lo],n=e[No],r=f.Aq.encodePath(f.Aq.joinPath(n,t)),o=e[Oo].split("T")[0],i="".concat(h.Yc,"thumbnail/").concat(L,"/192").concat(r);return{name:t,url:"".concat(h.Yc,"lib/").concat(L,"/file").concat(r),src:i,date:o}}))}),[R,L]),B=(0,s.useMemo)((function(){return U.reduce((function(e,t){return e[t.date]||(e[t.date]=[]),e[t.date].push(t),e}),{})}),[U]),Y=(0,s.useCallback)((function(){if(!(b>=U.length)&&O.current){var e=O.current,t=e.scrollTop,n=e.scrollHeight;t+e.clientHeight>=n-10&&w((function(e){return Math.min(e+100,U.length)}))}}),[b,U.length]);(0,s.useEffect)((function(){var e=O.current;if(e)return e.addEventListener("scroll",Y),function(){return e.removeEventListener("scroll",Y)}}),[Y]);var q=(0,s.useCallback)((function(){if(!(0===k.length||_>=3)){var e=k.shift();P((function(e){return e+1}));var t=new Image;N.current.push(t),t.src=e.src,t.onload=function(){P((function(e){return e-1})),q()},t.onerror=function(){P((function(e){return e-1})),q()}}}),[k,_]);(0,s.useEffect)((function(){q()}),[k,_,q]),(0,s.useEffect)((function(){return function(){N.current.forEach((function(e){e.onload=null,e.onerror=null})),N.current=[]}}),[]);return E?(0,m.jsx)(zl.Du,{}):(0,m.jsx)("div",{ref:O,className:"metadata-gallery-container",children:Object.keys(B).map((function(e){return(0,m.jsxs)("div",{className:"metadata-gallery-date-group",children:[(0,m.jsx)("div",{className:"metadata-gallery-date-tag",children:e}),(0,m.jsx)("ul",{className:"metadata-gallery-image-list",style:{gridTemplateColumns:"repeat(".concat(a,", 1fr)")},children:B[e].slice(0,b).map((function(e,t){return(0,m.jsx)("li",{tabIndex:t,className:"metadata-gallery-image-item",style:{width:n,height:n},children:(0,m.jsx)("img",{className:"metadata-gallery-grid-image",src:e.src,alt:e.name,onLoad:function(){return t=e,M((function(e){return[].concat((0,W.A)(e),[t])})),void q();var t}})},t)}))})]},e)}))})},Uf=function(){var e=(0,s.useState)(!1),t=(0,F.A)(e,2),n=t[0],r=t[1],o=du(),i=o.isLoading,a=o.metadata,l=o.errorMsg,c=o.store,u=(0,s.useRef)(null),d=(0,s.useCallback)((function(e){if(!e.target.className.includes("editor-main"))return ga(e)?(e.preventDefault(),void window.sfMetadataContext.eventBus.dispatch(ul)):void 0}),[]),p=(0,s.useMemo)((function(){return!(i||!a)&&ws(a.view.groupbys,a.columns).length>0}),[i,a]),g=(0,s.useCallback)((0,ln.A)((0,sn.A)().mark((function e(){var t;return(0,sn.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.hasMore){e.next=2;break}return e.abrupt("return");case 2:return r(!0),e.prev=3,e.next=6,c.loadMore(Fl);case 6:r(!1),e.next=15;break;case 9:return e.prev=9,e.t0=e.catch(3),t=f.Aq.getErrorMsg(e.t0),j.A.danger(t),r(!1),e.abrupt("return");case 15:case"end":return e.stop()}}),e,null,[[3,9]])}))),[a,c]),v=(0,s.useCallback)(function(){var e=(0,ln.A)((0,sn.A)().mark((function e(t,n){var o,i,s;return(0,sn.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.hasMore){e.next=2;break}return e.abrupt("return");case 2:return r(!0),o=a.row_ids.length,i=o%Ul!==0?Ul-o%Ul:Ul,e.prev=5,e.next=8,c.loadMore(i);case 8:r(!1),e.next=17;break;case 11:return e.prev=11,e.t0=e.catch(5),s=f.Aq.getErrorMsg(e.t0),j.A.danger(s),r(!1),e.abrupt("return");case 17:c.data.hasMore&&c.data.row_ids.length<t?v(t,n):("function"===typeof n&&n(c.data.hasMore),r(!1));case 18:case"end":return e.stop()}}),e,null,[[5,11]])})));return function(t,n){return e.apply(this,arguments)}}(),[a,c]),y=(0,s.useCallback)((function(e,t,n,r,o){var i=arguments.length>5&&void 0!==arguments[5]&&arguments[5];c.modifyRecords(e,t,n,r,o,i)}),[c]),x=(0,s.useCallback)((function(e,t,n,r,o){var i=[e],a=(0,ro.default)({},e,t),s=(0,ro.default)({},e,r),l=(0,ro.default)({},e,n),c=(0,ro.default)({},e,o);y(i,a,s,l,c)}),[y]),A=(0,s.useCallback)((function(e){var t=a.row_ids.length,n=[],r=[],o=[],i={};return e.forEach((function(e){return i[e]=e})),a.row_ids.forEach((function(e,s){if(i[e]){var l=0===s?null:a.row_ids[s-1],c=s===t-1?null:a.row_ids[s+1];n.push(e),r.push(l),o.push(c)}})),{rowIdsInOrder:n,upperRowIds:r,belowRowIds:o}}),[a]),C=(0,s.useCallback)((function(e,t,n){c.renameColumn(e,t,n)}),[c]),b=(0,s.useCallback)((function(e,t){c.deleteColumn(e,t)}),[c]),w=(0,s.useCallback)((function(e,t,n){c.modifyColumnData(e,t,n)}),[c]),S=(0,s.useCallback)((function(e,t){c.modifyColumnWidth(e,t)}),[c]),D=(0,s.useCallback)((function(e,t){c.modifyColumnOrder(e,t)}),[c]),k=(0,s.useCallback)((function(e){return a.id_row_map[e]}),[a]),M=(0,s.useCallback)((function(e){var t=a.view.rows[e];return t&&k(t)}),[a,k]),I=(0,s.useCallback)((function(e){if(!window.sfMetadataBody||!window.sfMetadataBody.getGroupRecordByIndex)return null;var t=window.sfMetadataBody.getGroupRecordByIndex(e).rowId;return t&&k(t)}),[k]),_=(0,s.useCallback)((function(e){var t=e.isGroupView,n=e.groupRecordIndex,r=e.recordIndex;return t?I(n):M(r)}),[I,M]),P=(0,s.useCallback)((function(){var e;return(null===u||void 0===u||null===(e=u.current)||void 0===e?void 0:e.getBoundingClientRect())||{x:0,right:window.innerWidth}}),[u]);return(0,s.useEffect)((function(){return document.addEventListener("keydown",d),function(){document.removeEventListener("keydown",d)}}),[]),i?(0,m.jsx)(zl.Du,{}):(0,m.jsx)(m.Fragment,{children:(0,m.jsx)("div",{className:"sf-metadata-wrapper",children:(0,m.jsxs)("div",{className:"sf-metadata-main",children:[l&&(0,m.jsx)("div",{className:"d-center-middle error",children:(0,h.AP)(l)}),!l&&(0,m.jsxs)("div",{className:"sf-metadata-container",ref:u,children:["table"===a.view.type&&(0,m.jsx)(Lf,{isGroupView:p,isLoadingMore:n,loadMore:g,metadata:a,modifyRecord:x,modifyRecords:y,recordGetterById:k,recordGetterByIndex:_,getTableContentRect:P,getAdjacentRowsIds:A,loadAll:v,renameColumn:C,deleteColumn:b,modifyColumnData:w,modifyColumnWidth:S,modifyColumnOrder:D}),"image"===a.view.type&&(0,m.jsx)(Ff,{})]})]})})})},Bf=function(e){var t=e.value,n=e.onChange,r=(0,s.useCallback)((function(e){e&&e.stopPropagation(),n(!t)}),[t,n]);return(0,m.jsx)("div",{className:"sf-metadata-property-detail-editor sf-metadata-checkbox-property-detail-editor",children:(0,m.jsx)("div",{className:"sf-metadata-checkbox-property-detail-editor-content",onClick:r,children:t&&(0,m.jsx)(zl.In,{iconName:"check-mark"})})})},Yf=s.memo((function(e){var t=e.value,n=e.onChange,r=(0,s.useState)(!1),o=(0,F.A)(r,2),i=o[0],a=o[1],l=(0,s.useRef)(null);(0,s.useEffect)((function(){l.current.innerText=t||""}),[t]);var c=(0,s.useCallback)((function(){if(i){var e=l.current.innerText;e!==t&&n(rc(e)||""),a(!1)}}),[i,t,n]),u=(0,s.useCallback)((function(e){e.stopPropagation()}),[]),d=(0,s.useCallback)((function(e){e.stopPropagation()}),[]),p=(0,s.useCallback)((function(e){var t=e.currentTarget,n=t.selectionStart,r=t.selectionEnd,o=t.value;e.keyCode===R.cK.Enter?(e.preventDefault(),c()):(e.keyCode===R.cK.ChineseInputMethod||e.keyCode===R.cK.LeftArrow&&0===n||e.keyCode===R.cK.RightArrow&&r===o.length)&&e.stopPropagation()}),[c]),f=(0,s.useCallback)((function(){i||(a(!0),setTimeout((function(){l.current.focus();var e=document.createRange();e.selectNodeContents(l.current),e.collapse(!1);var t=window.getSelection();t.removeAllRanges(),t.addRange(e)}),1))}),[i]);return(0,m.jsx)(zl.ij,{onClickOutside:c,children:(0,m.jsx)("div",{className:D()("sf-metadata-property-detail-editor sf-metadata-text-property-detail-editor",{formatter:!i}),onClick:f,ref:l,onKeyDown:p,onCut:d,onPaste:u,placeholder:(0,h.AP)("Empty"),contentEditable:i})})}),(function(e,t){return!(up(e.value,t.value,t.field.type)||!ic.isSameObject(e.field,t.field))})),qf=s.memo((function(e){var t=e.value,n=e.field,r=e.onChange,o=(0,s.useState)(""),i=(0,F.A)(o,2),a=i[0],l=i[1],c=(0,s.useRef)(null);(0,s.useEffect)((function(){var e=t||0===t?t:"",r=(null===n||void 0===n?void 0:n.data)||{},o=Ra(e,r)||"";l(o)}),[t,n]);var u=(0,s.useCallback)((function(e){var t,r=(null===n||void 0===n||null===(t=n.data)||void 0===t?void 0:t.format)||bo,o="custom_currency"===r?n.data.currency_symbol:null,i=e.target.value.trim();if(Ks()||!(i.indexOf(".\u3002")>-1)){var s=La(i,r,o);s!==a&&l(s)}}),[n,a]),d=(0,s.useCallback)((function(){var e=Ua(a,n.data);e!==t&&r(e)}),[t,a,n,r]),p=(0,s.useCallback)((function(e){e.stopPropagation()}),[]),f=(0,s.useCallback)((function(e){e.stopPropagation()}),[]),g=(0,s.useCallback)((function(e){var t=e.currentTarget,n=t.selectionStart,r=t.selectionEnd,o=t.value;e.keyCode===R.cK.Enter?(e.preventDefault(),c.current&&c.current.blur()):(e.keyCode===R.cK.ChineseInputMethod||e.keyCode===R.cK.LeftArrow&&0===n||e.keyCode===R.cK.RightArrow&&r===o.length)&&e.stopPropagation()}),[]),v=(0,s.useCallback)((function(e){u(e)}),[u]);return(0,m.jsx)("input",{ref:c,type:"text",className:"sf-metadata-number-property-detail-editor form-control",placeholder:(0,h.AP)("Empty")||"",onBlur:d,onCut:f,onPaste:p,value:a,name:n.name,title:n.name,"aria-label":n.name,onChange:u,onKeyDown:g,onCompositionEnd:v})}),(function(e,t){return!(up(e.value,t.value,t.field.type)||!ic.isSameObject(e.field,t.field))})),Hf=qf,Gf=function(e){var t=e.field,n=e.value,r=e.record,o=e.fields,i=e.onChange,a=e.modifyColumnData,l=(0,s.useRef)(null),c=(0,s.useState)(!1),u=(0,F.A)(c,2),d=u[0],p=u[1],f=(0,s.useMemo)((function(){return Ha(t)}),[t]),g=(0,s.useCallback)((function(e){if(e.target&&!(Ql(e).indexOf("sf-metadata-search-options")>-1)){var t=document.querySelector(".sf-metadata-single-select-editor");t&&(t.contains(e.target)||l.current&&!l.current.contains(e.target)&&d&&p(!1))}}),[d]),v=(0,s.useCallback)((function(e){e.keyCode===so().Esc&&d&&p(!1)}),[d]);(0,s.useEffect)((function(){return document.addEventListener("mousedown",g),document.addEventListener("keydown",v,!0),function(){document.removeEventListener("mousedown",g),document.removeEventListener("keydown",v,!0)}}),[g,v]);var y=(0,s.useCallback)((function(){p(!0)}),[]),x=(0,s.useCallback)((function(e){!e||Wa(f,e)?(i(e),p(!1)):p(!1)}),[f,i]),A=n?Wa(f,n):null,C=(0,s.useCallback)((function(){if(!d)return null;var e=l.current.getBoundingClientRect().width;return(0,m.jsx)(Br.A,{target:l,isOpen:!0,placement:"bottom-end",hideArrow:!0,fade:!1,className:"sf-metadata-property-editor-popover sf-metadata-single-select-property-editor-popover",boundariesElement:document.body,children:(0,m.jsx)(fh,{value:n,column:(0,Sr.A)((0,Sr.A)({},t),{},{width:Math.max(e-2,200)}),columns:o,modifyColumnData:a,record:r,height:2,onCommit:x})})}),[d,x,r,n,a,o,t]);return(0,m.jsxs)("div",{className:"sf-metadata-property-detail-editor sf-metadata-single-select-property-detail-editor",placeholder:(0,h.AP)("Empty"),ref:l,onClick:y,children:[A&&(0,m.jsx)("div",{className:"sf-metadata-single-select-property-value",style:{backgroundColor:A.color,color:A.textColor||null},children:A.name}),C()]})},zf=function(e){var t=e.field,n=e.value,r=e.record,o=e.fields,i=e.onChange,a=e.modifyColumnData,l=(0,s.useRef)(null),c=(0,s.useState)(!1),u=(0,F.A)(c,2),d=u[0],p=u[1],f=(0,s.useMemo)((function(){return Ha(t)}),[t]),g=(0,s.useCallback)((function(e){if(e.target&&!(Ql(e).indexOf("sf-metadata-search-options")>-1)){var t=document.querySelector(".sf-metadata-multiple-select-editor");t&&(t.contains(e.target)||l.current&&!l.current.contains(e.target)&&d&&p(!1))}}),[d]),v=(0,s.useCallback)((function(e){e.keyCode===so().Esc&&d&&p(!1)}),[d]);(0,s.useEffect)((function(){return document.addEventListener("mousedown",g),document.addEventListener("keydown",v,!0),function(){document.removeEventListener("mousedown",g),document.removeEventListener("keydown",v,!0)}}),[g,v]);var y=(0,s.useCallback)((function(){p(!0)}),[]),x=(0,s.useCallback)((function(e,r){r&&r.stopPropagation(),r&&r.nativeEvent&&r.nativeEvent.stopImmediatePropagation();var o=$a(t,n).filter((function(t){return t!==e}));i(o)}),[t,n,i]),A=(0,s.useCallback)((function(e){i(e)}),[i]),C=(0,s.useCallback)((function(){if(!d)return null;var e=l.current.getBoundingClientRect().width;return(0,m.jsx)(Br.A,{target:l,isOpen:!0,placement:"bottom-end",hideArrow:!0,fade:!1,className:"sf-metadata-property-editor-popover sf-metadata-single-select-property-editor-popover sf-metadata-multiple-select-property-editor-popover",boundariesElement:document.body,children:(0,m.jsx)(vh,{saveImmediately:!0,value:n,column:(0,Sr.A)((0,Sr.A)({},t),{},{width:Math.max(e-2,200)}),columns:o,modifyColumnData:a,record:r,onCommit:A})})}),[d,A,r,n,a,o,t]),b=(0,s.useMemo)((function(){if(!Array.isArray(n)||0===n.length)return!0;var e=f.filter((function(e){return n.includes(e.id)||n.includes(e.name)})),t=n.filter((function(e){return e&&!f.find((function(t){return t.id===e||t.name===e}))}));return e.length+t.length===0}),[f,n]);return(0,m.jsxs)("div",{className:"sf-metadata-property-detail-editor sf-metadata-single-select-property-detail-editor sf-metadata-multiple-select-property-detail-editor",placeholder:(0,h.AP)("Empty"),ref:l,onClick:y,children:[!b&&(0,m.jsx)(mh,{value:n,options:f,onDelete:x}),C()]})},Vf=function(e){var t=e.field,n=e.value,r=e.onChange,o=(0,s.useRef)(null),i=(0,s.useState)(!1),a=(0,F.A)(i,2),l=a[0],c=a[1],u=su().getCollaborator,d=(0,s.useCallback)((function(e){if(l&&(e.target&&!(Ql(e).indexOf("sf-metadata-search-collaborators")>-1))){var t=document.querySelector(".sf-metadata-collaborator-editor");t&&t.contains(e.target)||o.current.contains(e.target)||c(!1)}}),[l]),p=(0,s.useCallback)((function(e){e.keyCode===so().Esc&&l&&c(!1)}),[l]);(0,s.useEffect)((function(){return document.addEventListener("mousedown",d),document.addEventListener("keydown",p,!0),function(){document.removeEventListener("mousedown",d),document.removeEventListener("keydown",p,!0)}}),[d,p]);var f=(0,s.useCallback)((function(){c(!0)}),[]),g=(0,s.useCallback)((function(e){r(e)}),[r]),v=(0,s.useCallback)((function(e,t){t&&t.stopPropagation(),t&&t.nativeEvent&&t.nativeEvent.stopImmediatePropagation();var o=n.filter((function(t){return t!==e}));r(o)}),[n,r]),y=(0,s.useCallback)((function(){if(!l)return null;var e=o.current.getBoundingClientRect().width;return(0,m.jsx)(Br.A,{target:o,isOpen:!0,placement:"bottom-end",hideArrow:!0,fade:!1,className:"sf-metadata-property-editor-popover sf-metadata-collaborator-property-editor-popover",boundariesElement:document.body,style:{width:Math.max(e-2,200)},children:(0,m.jsx)(Ah,{saveImmediately:!0,value:n,column:t,height:2,onCommit:g})})}),[l,g,n,t]),x=Array.isArray(n)?n.filter((function(e){return u(e)})):[];return(0,m.jsxs)("div",{className:"sf-metadata-property-detail-editor sf-metadata-collaborator-property-detail-editor",placeholder:(0,h.AP)("Empty"),ref:o,onClick:f,children:[x.length>0&&(0,m.jsx)(yh,{value:n,onDelete:v}),y()]})},Wf=function(e){var t=e.value,n=e.field,r=e.onChange,o=e.lang,i=(0,s.useState)(!1),a=(0,F.A)(i,2),l=a[0],c=a[1],u=(0,s.useMemo)((function(){var e;return(null===n||void 0===n||null===(e=n.data)||void 0===e?void 0:e.format)||fo}),[n]),d=(0,s.useCallback)((function(){c(!0)}),[]),p=(0,s.useCallback)((function(e){r(e)}),[r]),f=(0,s.useCallback)((function(){r(null),c(!1)}),[r]),g=(0,s.useCallback)((function(){c(!1)}),[]);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:"sf-metadata-property-detail-editor sf-metadata-date-property-detail-editor",placeholder:(0,h.AP)("Empty"),onClick:d,children:Da(t,u)}),l&&(0,m.jsx)(zl.US,{lang:o,format:u,value:t,onChange:p,onClose:g,onClear:f})]})},Kf=["field","onChange"],Xf=function(e){var t=e.field,n=e.onChange,r=(0,dc.A)(e,Kf),o=(0,s.useCallback)((function(e){n(t.key,e)}),[t,n]);switch(t.type){case lo.CHECKBOX:return(0,m.jsx)(Bf,(0,Sr.A)((0,Sr.A)({},r),{},{field:t,onChange:o}));case lo.TEXT:return(0,m.jsx)(Yf,(0,Sr.A)((0,Sr.A)({},r),{},{field:t,onChange:o}));case lo.NUMBER:return(0,m.jsx)(Hf,(0,Sr.A)((0,Sr.A)({},r),{},{field:t,onChange:o}));case lo.DATE:return(0,m.jsx)(Wf,(0,Sr.A)((0,Sr.A)({},r),{},{field:t,onChange:o,lang:h.vV}));case lo.SINGLE_SELECT:return(0,m.jsx)(Gf,(0,Sr.A)((0,Sr.A)({},r),{},{field:t,onChange:o}));case lo.MULTIPLE_SELECT:return(0,m.jsx)(zf,(0,Sr.A)((0,Sr.A)({},r),{},{field:t,onChange:o}));case lo.COLLABORATOR:return(0,m.jsx)(Vf,(0,Sr.A)((0,Sr.A)({},r),{},{field:t,onChange:o}));default:return null}},$f=function(e){var t=Object.assign({},(function(e){if(null==e)throw new TypeError("Cannot destructure "+e)}(e),e));return(0,m.jsx)(uu,(0,Sr.A)((0,Sr.A)({},t),{},{children:(0,m.jsx)(Uf,{})}))},Zf=function(e){var t=e.toggle,n=e.submit;return(0,m.jsxs)(p.A,{isOpen:!0,toggle:t,children:[(0,m.jsx)(I.A,{toggle:t,children:(0,h.AP)("Turn off extended properties")}),(0,m.jsx)(_.A,{children:(0,m.jsx)("p",{children:(0,h.AP)("Do you really want to turn off extended properties? Existing properties will all be deleted.")})}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(O.A,{color:"secondary",onClick:t,children:(0,h.AP)("Cancel")}),(0,m.jsx)(O.A,{color:"primary",onClick:n,children:(0,h.AP)("Turn off")})]})]})},Jf=function(e){var t=e.value,n=e.repoID,r=e.toggle,o=e.submit,i=(0,s.useState)(t),a=(0,F.A)(i,2),l=a[0],c=a[1],u=(0,s.useState)(!1),d=(0,F.A)(u,2),g=d[0],v=d[1],y=(0,s.useState)(!1),x=(0,F.A)(y,2),A=x[0],C=x[1],b=(0,s.useCallback)((function(){g||r&&r()}),[g,r]),w=(0,s.useCallback)((function(){l?(v(!0),gc.createMetadata(n).then((function(e){o(!0),r()})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t),v(!1)}))):C(!0)}),[n,l,o,r]),S=(0,s.useCallback)((function(){C(!A)}),[A]),k=(0,s.useCallback)((function(){C(!1),v(!0),gc.deleteMetadata(n).then((function(e){o(!1),r()})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t),v(!1)}))}),[n,o,r]),M=(0,s.useCallback)((function(){c(!l)}),[l]);return(0,m.jsxs)(m.Fragment,{children:[!A&&(0,m.jsxs)(p.A,{className:"metadata-status-management-dialog",isOpen:!0,toggle:b,children:[(0,m.jsx)(I.A,{toggle:b,children:(0,h.AP)("Extended properties management")}),(0,m.jsxs)(_.A,{children:[(0,m.jsx)(yu.A,{checked:l,disabled:g,size:"large",textPosition:"right",className:D()("change-metadata-status-management w-100",{disabled:g}),onChange:M,placeholder:(0,h.AP)("Enable extended properties")}),(0,m.jsx)("div",{className:"tip",children:(0,h.AP)("After enable extended properties for files, you can add different properties to files, like collaborators, file expiring time, file description. You can also create different views for files based extended properties.")})]}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(O.A,{color:"secondary",onClick:b,children:(0,h.AP)("Cancel")}),(0,m.jsx)(O.A,{color:"primary",disabled:t===l||g,onClick:w,children:(0,h.AP)("Submit")})]})]}),A&&(0,m.jsx)(Zf,{toggle:S,submit:k})]})},Qf=n(36402),em=function(e){var t=e.value,n=e.target,r=e.toggle,o=e.onSubmit,i=(0,s.useState)(t||""),a=(0,F.A)(i,2),l=a[0],c=a[1],u=(0,s.useRef)(null),d=(0,s.useCallback)((function(e){c(e.target.value)}),[]),p=(0,s.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),o(l)}),[l,o]);return(0,s.useEffect)((function(){var e=function(e){u.current&&!u.current.contains(e.target)&&r(e)};return u.current&&(u.current.select(),document.addEventListener("mousedown",e)),function(){document.removeEventListener("mousedown",e)}}),[r]),(0,m.jsxs)(Vl.A,{className:"sf-metadata-rename-view-popover",isOpen:!0,toggle:r,target:n,placement:"right-start",hideArrow:!0,fade:!1,boundariesElement:document.body,children:[(0,m.jsx)("div",{className:"sf-metadata-rename-view-popover-header",children:(0,h.AP)("Rename view")}),(0,m.jsx)("div",{className:"seafile-divider dropdown-divider"}),(0,m.jsx)("div",{className:"sf-metadata-rename-view-popover-body",children:(0,m.jsx)(bt.A,{onSubmit:p,children:(0,m.jsx)(P.A,{innerRef:u,className:"sf-metadata-view-input",type:"text",id:"rename-input",name:"rename",value:l,onChange:d,autoFocus:!0})})})]})},tm=[{key:"table",type:"table"},{key:"gallery",type:"image"}],nm=function(e){var t=e.target,n=e.toggle,r=e.onOptionClick,o=(0,s.useRef)(null),i=(0,s.useCallback)((function(e){o.current&&!o.current.contains(e.target)&&n(e)}),[n]);(0,s.useEffect)((function(){return o.current&&document.addEventListener("click",i,!0),function(){document.removeEventListener("click",i,!0)}}),[i]);var a=(0,s.useCallback)((function(e){switch(e){case"table":return(0,h.AP)("Table");case"image":return(0,h.AP)("Gallery");default:return e}}),[]);return(0,m.jsx)(Vl.A,{className:"sf-metadata-addview-popover",isOpen:!0,toggle:n,target:t,placement:"right-start",hideArrow:!0,fade:!1,boundariesElement:document.body,children:(0,m.jsxs)("div",{ref:o,children:[(0,m.jsx)("div",{className:"sf-metadata-addview-popover-header",children:(0,h.AP)("New view")}),(0,m.jsx)("div",{className:"sf-metadata-addview-popover-body",children:tm.map((function(e,t){return(0,m.jsxs)("button",{className:"dropdown-item sf-metadata-addview-popover-item",onClick:function(){return r(e)},children:[(0,m.jsx)("div",{className:"left-icon",children:(0,m.jsx)(Yl.A,{symbol:e.type,className:"metadata-view-icon"})}),(0,m.jsx)("div",{children:a(e.type)})]},t)}))})]})})},rm=function(e){var t=e.canDelete,n=e.userPerm,r=e.isSelected,o=e.view,i=e.onClick,a=e.onDelete,l=e.onCopy,c=e.onUpdate,u=e.onMove,d=(0,s.useState)(!1),p=(0,F.A)(d,2),g=p[0],v=p[1],y=(0,s.useState)(!1),x=(0,F.A)(y,2),A=x[0],C=x[1],b=(0,s.useState)(!1),w=(0,F.A)(b,2),S=w[0],k=w[1],M=(0,s.useState)(!1),j=(0,F.A)(M,2),I=j[0],_=j[1],P=(0,s.useMemo)((function(){return"rw"===n||"admin"===n}),[n]),N=(0,s.useMemo)((function(){return!(f.Aq.isIEBrowser()||!P)}),[P]),O=(0,s.useMemo)((function(){if(!P)return[];var e=[{key:"rename",value:(0,h.AP)("Rename")},{key:"duplicate",value:(0,h.AP)("Duplicate")}];return t&&e.push({key:"delete",value:(0,h.AP)("Delete")}),e}),[P,t]),T=(0,s.useCallback)((function(){A||v(!0)}),[A]),E=(0,s.useCallback)((function(){A||v(!0)}),[A]),R=(0,s.useCallback)((function(){A||v(!1)}),[A]),L=(0,s.useCallback)((function(){C(!0)}),[]),U=(0,s.useCallback)((function(){C(!1),v(!1)}),[]),B=(0,s.useCallback)((function(e){"rename"!==e?"duplicate"!==e?"delete"!==e||a():l():_(!0)}),[a,l]),Y=(0,s.useCallback)((function(e){e.stopPropagation(),_(!1)}),[]),q=(0,s.useCallback)((function(e,t){c({name:e},(function(){_(!1)}),t)}),[c]),H=(0,s.useCallback)((function(e){if(!N)return!1;var t=JSON.stringify({type:"sf-metadata-view",view_id:o._id});e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("application/drag-sf-metadata-view",t)}),[N,o]),G=(0,s.useCallback)((function(e){if(!N)return!1;k(!0)}),[N]),z=(0,s.useCallback)((function(){if(!N)return!1;k(!1)}),[N]),V=(0,s.useCallback)((function(e){if(!N)return!1;e.preventDefault(),e.dataTransfer.dropEffect="move"}),[N]),W=(0,s.useCallback)((function(e){if(!N)return!1;e.stopPropagation(),k(!1);var t=e.dataTransfer.getData("application/drag-sf-metadata-view");if(t){if("sf-metadata-view"!==(t=JSON.parse(t)).type)return!1;t.view_id&&u&&u(t.view_id,o._id)}}),[N,o,u]);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{className:D()("tree-node-inner text-nowrap",{"tree-node-inner-hover":g,"tree-node-hight-light":r,"tree-node-drop":S}),title:(0,h.AP)("File extended properties"),onMouseEnter:T,onMouseOver:E,onMouseLeave:R,onClick:function(){return i(o)},children:[(0,m.jsx)("div",{className:"tree-node-text",draggable:P,onDragStart:H,onDragEnter:G,onDragLeave:z,onDragOver:V,onDrop:W,children:o.name}),(0,m.jsx)("div",{className:"left-icon",children:(0,m.jsx)("div",{className:"tree-node-icon",children:(0,m.jsx)(Yl.A,{symbol:o.type?o.type:"table",className:"metadata-views-icon"})})}),(0,m.jsx)("div",{className:"right-icon",id:"metadata-view-dropdown-item-".concat(o._id),children:g&&(0,m.jsx)(Qf.A,{item:{name:"metadata-view"},toggleClass:"sf3-font sf3-font-more",freezeItem:L,unfreezeItem:U,getMenuList:function(){return O},onMenuItemClick:B,menuStyle:f.Fr?{zIndex:1050}:{}})})]}),I&&(0,m.jsx)(em,{value:o.name,target:"metadata-view-dropdown-item-".concat(o._id),toggle:Y,onSubmit:q})]})},om=function(e){var t=e.userPerm,n=e.currentPath,r=(0,s.useMemo)((function(){return"rw"===t||"admin"===t}),[t]),o=(0,s.useState)(0),i=(0,F.A)(o,2)[1],a=ru(),l=a.showFirstView,c=a.navigation,u=a.viewsMap,d=a.selectView,p=a.addView,f=a.duplicateView,g=a.deleteView,v=a.updateView,y=a.moveView,x=(0,s.useState)(null),A=(0,F.A)(x,2),C=A[0],b=A[1],w=(0,s.useState)(!1),S=(0,F.A)(w,2),D=S[0],k=S[1],M=(0,s.useState)(!1),j=(0,F.A)(M,2),I=j[0],_=j[1],N=(0,s.useRef)(null),O=(0,s.useState)("Untitled"),T=(0,F.A)(O,2),E=T[0],L=T[1];(0,s.useEffect)((function(){var e=window.location,t=e.origin,n=e.pathname,r=e.search,o=new URLSearchParams(r).get("view");if(o){var i=u[o]||"";if(i)return void d(i);var a="".concat(t).concat(n);window.history.pushState({url:a,path:""},"",a)}var s=c.find((function(e){return"view"===e.type})),p=s?u[s._id]:"";l&&p&&d(p)}),[]);var U=(0,s.useCallback)((function(e,t,n,r){v(e,t,(function(){i((function(e){return e+1})),n&&n()}),r)}),[v]),B=function(e){e.stopPropagation(),k(!D)},Y=(0,s.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),p(E,C.type),_(!1),L("Untitled")}),[E,p,C]),q=(0,s.useCallback)((function(e){N.current&&!N.current.contains(e.target)&&_(!1)}),[]);return(0,s.useEffect)((function(){return I&&(N.current.select(),document.addEventListener("click",q)),function(){document.removeEventListener("click",q)}}),[I,N,q]),(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:"tree-view tree metadata-tree-view",children:(0,m.jsx)("div",{className:"tree-node",children:(0,m.jsxs)("div",{className:"children",children:[c.map((function(e,r){var o=u[e._id],i="/"+R.AT.FILE_EXTENDED_PROPERTIES+"/"+o.name,a=n===i;return(0,m.jsx)(rm,{canDelete:0!==r,isSelected:a,userPerm:t,view:o,onClick:function(e){return d(e,a)},onDelete:function(){return g(o._id,a)},onCopy:function(){return f(o._id)},onUpdate:function(e,t,n){return U(o._id,e,t,n)},onMove:y},o._id)})),I&&(0,m.jsxs)(bt.A,{onSubmit:Y,className:"tree-view-inner sf-metadata-view-form",children:[(0,m.jsx)("div",{className:"left-icon",children:(0,m.jsx)(Yl.A,{symbol:C.type,className:"metadata-views-icon"})}),(0,m.jsx)(P.A,{className:"sf-metadata-view-input",innerRef:N,type:"text",id:"add-view-input",name:"add-view",value:E,onChange:function(e){L(e.target.value)},autoFocus:!0})]}),r&&(0,m.jsx)("div",{id:"sf-metadata-view-popover",children:(0,m.jsx)(zl.NC,{className:"sf-metadata-add-view",callBack:B,footerName:(0,h.AP)("Add view"),addIconClassName:"sf-metadata-add-view-icon"})})]})})}),D&&(0,m.jsx)(nm,{target:"sf-metadata-view-popover",toggle:B,onOptionClick:function(e){b(e),_(!0),k(!1)}})]})},im=[ko,Mo,jo,Io,_o,Eo,Oo,Ro,To,No,Lo,Po,Fo,Vo,Wo,Ko,Xo],am=["/_Internal","/images"],sm=["type","key"],lm=function(e){var t=e.repoID,n=e.filePath,r=e.repoInfo,o=e.direntType,i=(0,s.useState)(!0),a=(0,F.A)(i,2),l=a[0],c=a[1],u=(0,s.useState)({record:{},fields:[]}),d=(0,F.A)(u,2),p=d[0],g=d[1],v=(0,s.useMemo)((function(){return"admin"!==r.permission&&"rw"!==r.permission?"r":"rw"}),[r]);(0,s.useEffect)((function(){if(c(!0),am.find((function(e){return n.startsWith(e)})))c(!1);else{var e=f.Aq.getDirName(n),r=f.Aq.getFileName(n),i="file"===o?e:e.slice(0,e.length-r.length-1);i.startsWith("/")||(i="/"+i),gc.getMetadataRecordInfo(t,i,r).then((function(e){var t=e.data,n=t.results,o=t.metadata,i=Array.isArray(n)&&n.length>0?n[0]:{},a=function(e){if(!Array.isArray(e)||0===e.length)return[];var t=e.map((function(e){var t=e.type,n=e.key,r=(0,dc.A)(e,sm);return(0,Sr.A)((0,Sr.A)({},r),{},{key:n,type:Rc(n,t),width:200})})).filter((function(e){return!im.includes(e.key)})),n=[];return t.forEach((function(e){n.push(e)})),n}(o).map((function(e){return new Yc(e)}));f.Aq.imageCheck(r)||(a=a.filter((function(e){return e.key!==zo}))),g({record:i,fields:a}),c(!1)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t),c(!1)}))}}),[t,n,o]);var y=(0,s.useCallback)((function(e,n){var r=p.record,o=p.fields.find((function(t){return t.key===e})),i=Ec(o),a=(0,ro.default)({},i,n);if(Qo.includes(o.key)||o.type!==lo.SINGLE_SELECT)o.type===lo.MULTIPLE_SELECT&&(a=(0,ro.default)({},i,n?Xa(o,n):[]));else{var s=Ha(o);a=(0,ro.default)({},i,Ka(s,n))}gc.modifyRecord(t,r._id,a,r._obj_id).then((function(e){var t=(0,Sr.A)((0,Sr.A)({},p),{},{record:(0,Sr.A)((0,Sr.A)({},r),a)});g(t)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))}),[t,p]),x=(0,s.useCallback)((function(e,n){var r,o=p.fields,i=p.record,a=o.slice(0);gc.modifyColumnData(t,e,n).then((function(t){var n=new Yc(t.data.column),r=o.findIndex((function(t){return t.key===e}));return a[r]=n,n})).then((function(n){var o=Ec(n),a=Ha(n),s=a[a.length-1];if(r=(0,ro.default)({},o,s.id),Qo.includes(e)||n.type!==lo.SINGLE_SELECT){if(n.type===lo.MULTIPLE_SELECT){var l=ba(i,n)||[];r=(0,ro.default)({},o,[].concat((0,W.A)(l),[s.name]))}}else r=(0,ro.default)({},o,Ka(a,s.id));return gc.modifyRecord(t,i._id,r,i._obj_id)})).then((function(e){var t=(0,Sr.A)((0,Sr.A)({},p),{},{record:(0,Sr.A)((0,Sr.A)({},i),r),fields:a});g(t)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))}),[t,p]);if(l)return null;var A=p.fields,C=p.record;return C._id?(0,m.jsx)(m.Fragment,{children:A.map((function(e){var t="rw"===v&&e.editable,n=ba(C,e);return(0,m.jsx)(Bd,{field:e,readonly:!t,children:t?(0,m.jsx)(Xf,{field:e,value:n,onChange:y,fields:A,record:C,modifyColumnData:x}):(0,m.jsx)(hp,{field:e,value:n,emptyTip:(0,h.AP)("Empty"),className:"sf-metadata-property-detail-formatter"})},e.key)}))}):null},cm=function(e){var t=e.repoID,n=e.repoInfo,r=e.dirent,o=e.path,i=e.direntDetail,a=(0,s.useMemo)((function(){return qd(r,o)}),[r,o]),l=ru().enableMetadata,c=(0,s.useMemo)((function(){return{type:lo.MTIME,name:(0,h.AP)("Last modified time")}}),[]);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(Bd,{field:c,className:"sf-metadata-property-detail-formatter",children:(0,m.jsx)(zl.ZA,{field:c,value:i.mtime})}),window.app.pageOptions.enableMetadataManagement&&l&&(0,m.jsx)(lm,{repoID:t,repoInfo:n,filePath:a,direntType:"dir"})]})},um=n(54033),dm=n(50224),pm=s.memo((function(e){var t=e.repoID,n=e.repoInfo,r=e.dirent,o=e.path,i=e.direntDetail,a=e.onFileTagChanged,l=e.repoTags,c=e.fileTagList,u=(0,s.useState)(!1),d=(0,F.A)(u,2),p=d[0],g=d[1],v=ru().enableMetadata,y=(0,s.useMemo)((function(){return qd(r,o)}),[r,o]),x=(0,s.useMemo)((function(){return"detail-list-view-tags-".concat(Ur())}),[]),A=(0,s.useMemo)((function(){return{type:"size",name:(0,h.AP)("Size")}}),[]),C=(0,s.useMemo)((function(){return{type:lo.LAST_MODIFIER,name:(0,h.AP)("Last modifier")}}),[]),b=(0,s.useMemo)((function(){return{type:lo.MTIME,name:(0,h.AP)("Last modified time")}}),[]),w=(0,s.useMemo)((function(){return{type:lo.SINGLE_SELECT,name:(0,h.AP)("Tags")}}),[]),S=(0,s.useCallback)((function(){g(!p)}),[p]),k=(0,s.useCallback)((function(){a(r,y)}),[r,y,a]);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(Bd,{field:A,className:"sf-metadata-property-detail-formatter",children:(0,m.jsx)(zl.ZA,{field:A,value:f.Aq.bytesToSize(i.size)})}),(0,m.jsx)(Bd,{field:C,className:"sf-metadata-property-detail-formatter",children:(0,m.jsx)(zl.ZA,{field:C,value:i.last_modifier_email,collaborators:[{name:i.last_modifier_name,contact_email:i.last_modifier_contact_email,email:i.last_modifier_email,avatar_url:i.last_modifier_avatar}]})}),(0,m.jsx)(Bd,{field:b,className:"sf-metadata-property-detail-formatter",children:(0,m.jsx)(zl.ZA,{field:b,value:i.last_modified})}),window.app.pageOptions.enableFileTags&&!v&&(0,m.jsx)(Bd,{field:w,className:"sf-metadata-property-detail-formatter",children:(0,m.jsx)("div",{className:D()("sf-metadata-property-detail-tags",{"tags-empty":!Array.isArray(c)||0===c.length}),id:x,onClick:S,children:Array.isArray(c)&&c.length>0?(0,m.jsx)(dm.A,{fileTagList:c}):(0,m.jsx)("span",{className:"empty-tip-text",children:(0,h.AP)("Empty")})})}),window.app.pageOptions.enableMetadataManagement&&v&&(0,m.jsx)(lm,{repoID:t,filePath:y,repoInfo:n,direntType:"file"}),p&&(0,m.jsx)(um.A,{repoID:t,repoTags:l,filePath:y,fileTagList:c,toggleCancel:S,onFileTagChanged:k,target:x})]})}),(function(e,t){var n=e.repoID,r=e.repoInfo,o=e.dirent,i=e.path,a=e.direntDetail,s=e.repoTags,l=e.fileTagList;return!(n!==t.repoID||i!==t.path||!ic.isSameObject(r,t.repoInfo)||!ic.isSameObject(o,t.dirent)||!ic.isSameObject(a,t.direntDetail)||s!==t.repoTags||l!==t.fileTagList)})),hm=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).updateDetail=function(e,t,r){var o="file"===t.type?"getFileInfo":"getDirInfo";k.e[o](e,r).then((function(e){n.setState({direntDetail:e.data,dirent:t})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.loadDetail=function(e,t,r){if(t){var o=f.Aq.joinPath(r,t.name);n.updateDetail(e,t,o)}else{var i=f.Aq.getDirName(r);k.e.listDir(e,i).then((function(t){var o=t.data.dirent_list.find((function(e){return e.parent_dir+e.name===r}))||null;o&&(o=new nr.A(o)),n.updateDetail(e,o,r)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))}},n.renderImage=function(){var e=n.state.dirent;if(!e)return null;if(!f.Aq.imageCheck(e.name))return null;var t=n.props,r=t.repoID,o=t.path,i="".concat(h.Yc,"thumbnail/").concat(r,"/1024")+f.Aq.encodePath("".concat("/"===o?"":o,"/").concat(e.name));return(0,m.jsx)("div",{className:"detail-image-thumbnail",children:(0,m.jsx)("img",{src:i,alt:"",className:"thumbnail"})})},n.state={direntDetail:"",dirent:null},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.loadDetail(this.props.repoID,this.props.dirent,this.props.path)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this,n=this.props,r=n.dirent,o=n.path,i=n.repoID,a=n.currentRepoInfo,s=n.repoTags,l=n.fileTags;ic.isSameObject(a,e.currentRepoInfo)&&ic.isSameObject(r,e.dirent)&&JSON.stringify(s||[])===JSON.stringify(e.repoTags||[])&&JSON.stringify(l||[])===JSON.stringify(e.fileTags||[])&&o===e.path&&i===e.repoID||this.setState({dirent:null},(function(){t.loadDetail(e.repoID,e.dirent,e.path)}))}},{key:"render",value:function(){var e=this.state,t=e.dirent,n=e.direntDetail,r=this.props,o=r.repoID,i=r.path,a=r.fileTags,s=(null===t||void 0===t?void 0:t.name)||"",l=f.Aq.getDirentIcon(t);return(0,m.jsxs)(Rd,{children:[(0,m.jsx)(Ld.A,{title:s,icon:l,onClose:this.props.onClose}),(0,m.jsxs)(Fd,{children:[this.renderImage(),t&&n&&(0,m.jsx)("div",{className:"detail-content",children:"file"!==t.type?(0,m.jsx)(cm,{repoID:o,repoInfo:this.props.currentRepoInfo,dirent:t,direntDetail:n,path:this.props.dirent?i+"/"+t.name:i}):(0,m.jsx)(pm,{repoID:o,repoInfo:this.props.currentRepoInfo,dirent:t,path:i,direntDetail:n,repoTags:this.props.repoTags,fileTagList:t?t.file_tags:a,onFileTagChanged:this.props.onFileTagChanged})})]})]})}}])}(s.Component),fm=s.memo((function(e){var t=e.repoID,n=e.path,r=e.dirent,o=e.currentRepoInfo,i=e.repoTags,a=e.fileTags,l=e.onClose,c=e.onFileTagChanged;return(0,s.useEffect)((function(){var e=new yc;return window.sfMetadataContext=e,window.sfMetadataContext.init({repoID:t,mediaUrl:h.SG,repoInfo:o}),function(){window.sfMetadataContext.destroy(),delete window.sfMetadataContext}}),[t,o]),"/"!==n||r?(0,m.jsx)(hm,{repoID:t,path:n,dirent:r,currentRepoInfo:o,repoTags:i,fileTags:a,onFileTagChanged:c,onClose:l}):(0,m.jsx)(Yd,{currentRepoInfo:o,onClose:l})}),(function(e,t){return!(e.repoID!==t.repoID||e.path!==t.path||!ic.isSameObject(e.dirent,t.dirent)||!ic.isSameObject(e.currentRepoInfo,t.currentRepoInfo)||JSON.stringify(e.repoTags||[])!==JSON.stringify(t.repoTags||[])||JSON.stringify(e.fileTags||[])!==JSON.stringify(t.fileTags||[]))})),mm=n(79837),gm=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).handleChange=function(e){e.target.value.trim()?n.setState({isSubmitBtnActive:!0}):n.setState({isSubmitBtnActive:!1}),n.setState({newName:e.target.value})},n.handleSubmit=function(){var e=n.validateInput(),t=e.isValid,r=e.errMessage;if(t)if(n.checkDuplicatedName()){var o=(0,h.AP)('The name "{name}" is already taken. Please choose a different name.');o=o.replace("{name}",f.Aq.HTMLescape(n.state.newName)),n.setState({errMessage:o})}else n.props.onRename(n.state.newName);else n.setState({errMessage:r})},n.handleKeyDown=function(e){"Enter"===e.key&&n.handleSubmit()},n.toggle=function(){n.props.toggleCancel()},n.changeState=function(e){var t=e.object.name;n.setState({newName:t})},n.validateInput=function(){var e=n.state.newName.trim(),t=!0,r="";return e?e.indexOf("/")>-1?{isValid:t=!1,errMessage:r=(0,h.AP)("Name should not include '/'.")}:{isValid:t,errMessage:r}:{isValid:t=!1,errMessage:r=(0,h.AP)("Name is required.")}},n.checkDuplicatedName=function(){return n.props.checkDuplicatedName(n.state.newName)},n.onAfterModelOpened=function(){if(n.newInput.current){var e=n.props.currentNode,t=e.object.type;if(n.newInput.current.focus(),"file"===t){var r=e.object.name.lastIndexOf(".md");n.newInput.current.setSelectionRange(0,r,"forward")}else n.newInput.current.setSelectionRange(0,-1)}},n.state={newName:"",errMessage:"",isSubmitBtnActive:!1},n.newInput=s.createRef(),n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"UNSAFE_componentWillMount",value:function(){this.setState({newName:this.props.currentNode.object.name})}},{key:"componentDidMount",value:function(){var e=this.props.currentNode;this.changeState(e)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.changeState(e.currentNode)}},{key:"render",value:function(){var e=this.props.currentNode.object.type;return(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.toggle,onOpened:this.onAfterModelOpened,children:[(0,m.jsx)(I.A,{toggle:this.toggle,children:"file"===e?(0,h.AP)("Rename File"):(0,h.AP)("Rename Folder")}),(0,m.jsxs)(_.A,{children:[(0,m.jsx)("p",{children:"file"===e?(0,h.AP)("New file name"):(0,h.AP)("New folder name")}),(0,m.jsx)(P.A,{onKeyDown:this.handleKeyDown,innerRef:this.newInput,placeholder:"newName",value:this.state.newName,onChange:this.handleChange}),this.state.errMessage&&(0,m.jsx)(Dt.A,{color:"danger",className:"mt-2",children:this.state.errMessage})]}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(O.A,{color:"secondary",onClick:this.toggle,children:(0,h.AP)("Cancel")}),(0,m.jsx)(O.A,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive,children:(0,h.AP)("Submit")})]})]})}}])}(s.Component),vm=gm,ym=n(70349),xm=n(23931),Am=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).handleSubmit=function(){n.props.isMultipleOperation?n.copyItems():n.copyItem()},n.copyItems=function(){var e=n.state,t=e.repo,r=e.selectedPath,o=(0,h.AP)("Invalid destination path");if(t&&""!==r){var i=n.props.selectedDirentList,a=[];if(i.forEach((function(e){var t=f.Aq.joinPath(n.props.path,e.name);a.push(t)})),a.some((function(e){return e===r})))n.setState({errMessage:o});else{var s="";if(a.some((function(e){var t=r.length>e.length&&r.indexOf(e)>-1;return t&&(s=e),t})))return o=(o=(o=(0,h.AP)("Can not move folder %(src)s to its subfolder %(des)s")).replace("%(src)s",s)).replace("%(des)s",r),void n.setState({errMessage:o});n.props.onItemsCopy(t,r),n.toggle()}}else n.setState({errMessage:o})},n.copyItem=function(){var e=n.state,t=e.repo,r=e.repoID,o=e.selectedPath,i=f.Aq.joinPath(n.props.path,n.props.dirent.name),a=(0,h.AP)("Invalid destination path");if(!t||t.repo_id===r&&""===o)n.setState({errMessage:a});else if(o&&i===o)n.setState({errMessage:a});else{if(o&&o.length>i.length&&o.indexOf(i)>-1)return a=(a=(a=(0,h.AP)("Can not copy folder %(src)s to its subfolder %(des)s")).replace("%(src)s",i)).replace("%(des)s",o),void n.setState({errMessage:a});n.props.onItemCopy(t,n.props.dirent,o,n.props.path),n.toggle()}},n.toggle=function(){n.props.onCancelCopy()},n.onDirentItemClick=function(e,t){n.setState({repo:e,selectedPath:t,errMessage:""})},n.onRepoItemClick=function(e){n.setState({repo:e,selectedPath:"/",errMessage:""})},n.onSelectedMode=function(e){n.setState({mode:e})},n.renderTitle=function(){var e=n.props,t=e.dirent,r=e.isMultipleOperation,o=(0,h.AP)("Copy {placeholder} to");return r?(0,h.AP)("Copy selected item(s) to:"):o.replace("{placeholder}",'<span class="op-target text-truncate mx-1">'.concat(f.Aq.HTMLescape(t.name),"</span>"))},n.state={repo:{repo_id:n.props.repoID},selectedPath:n.props.path,errMessage:"",mode:"only_current_library"},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.dirent,r=t.selectedDirentList,o=t.isMultipleOperation,i=t.repoID,a=t.path,s=this.state,l=s.mode,c=s.errMessage,u=(n||r[0]).permission,d=f.Aq.getUserPermission(u).isCustomPermission,g=function(t){var n=t.mode,r=t.label;return(0,m.jsx)("div",{className:"repo-list-item ".concat(e.state.mode===n?"active":""),onClick:function(){return e.onSelectedMode(n)},children:(0,m.jsx)("span",{className:"library",children:r})})};return(0,m.jsxs)(p.A,{className:"custom-modal",isOpen:!0,toggle:this.toggle,children:[(0,m.jsx)(I.A,{toggle:this.toggle,children:o?this.renderTitle():(0,m.jsx)("div",{dangerouslySetInnerHTML:{__html:this.renderTitle()},className:"d-flex mw-100"})}),(0,m.jsxs)(ym.A,{children:[(0,m.jsxs)(xm.A,{className:"repo-list-col border-right",children:[(0,m.jsx)(g,{mode:"only_current_library",label:(0,h.AP)("Current Library")}),!d&&(0,m.jsx)(g,{mode:"only_other_libraries",label:(0,h.AP)("Other Libraries")}),(0,m.jsx)(g,{mode:"recently_used",label:(0,h.AP)("Recently Used")})]}),(0,m.jsxs)(xm.A,{className:"file-list-col",children:[(0,m.jsxs)(_.A,{children:[(0,m.jsx)(qt.A,{repoID:i,currentPath:a,onDirentItemClick:this.onDirentItemClick,onRepoItemClick:this.onRepoItemClick,mode:l,hideLibraryName:!1}),c&&(0,m.jsx)(Dt.A,{color:"danger",className:"mt-2",children:c})]}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(O.A,{color:"secondary",onClick:this.toggle,children:(0,h.AP)("Cancel")}),(0,m.jsx)(O.A,{color:"primary",onClick:this.handleSubmit,children:(0,h.AP)("Submit")})]})]})]})]})}}])}(s.Component),Cm=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).handleSubmit=function(){n.props.isMultipleOperation?n.moveItems():n.moveItem()},n.moveItems=function(){var e=n.props.repoID,t=n.state,r=t.repo,o=t.selectedPath,i=(0,h.AP)("Invalid destination path");if(r&&""!==o){var a=n.props.selectedDirentList,s=[];if(a.forEach((function(e){var t=f.Aq.joinPath(n.props.path,e.name);s.push(t)})),s.some((function(e){return e===o})))n.setState({errMessage:i});else if(o&&o===n.props.path&&r.repo_id===e)n.setState({errMessage:i});else{var l="";if(s.some((function(e){var t=o.length>e.length&&o.indexOf(e)>-1;return t&&(l=e),t})))return i=(i=(i=(0,h.AP)("Can not move folder %(src)s to its subfolder %(des)s")).replace("%(src)s",l)).replace("%(des)s",o),void n.setState({errMessage:i});n.props.onItemsMove(r,o),n.toggle()}}else n.setState({errMessage:i})},n.moveItem=function(){var e=n.props.repoID,t=n.state,r=t.repo,o=t.selectedPath,i=f.Aq.joinPath(n.props.path,n.props.dirent.name),a=(0,h.AP)("Invalid destination path");if(!r||r.repo_id===e&&""===o)n.setState({errMessage:a});else if(o&&i===o)n.setState({errMessage:a});else if(o&&n.props.path===o&&r.repo_id===e)n.setState({errMessage:a});else{if(o&&o.length>i.length&&o.indexOf(i)>-1)return a=(a=(a=(0,h.AP)("Can not move folder %(src)s to its subfolder %(des)s")).replace("%(src)s",i)).replace("%(des)s",o),void n.setState({errMessage:a});n.props.onItemMove(r,n.props.dirent,o,n.props.path),n.toggle()}},n.toggle=function(){n.props.onCancelMove()},n.onDirentItemClick=function(e,t){n.setState({repo:e,selectedPath:t,errMessage:""})},n.onRepoItemClick=function(e){n.setState({repo:e,selectedPath:"/",errMessage:""})},n.onSelectedMode=function(e){n.setState({mode:e})},n.renderTitle=function(){var e=n.props,t=e.dirent,r=e.isMultipleOperation,o=(0,h.AP)("Move {placeholder} to");return r?(0,h.AP)("Move selected item(s) to:"):o.replace("{placeholder}",'<span class="op-target text-truncate mx-1">'.concat(f.Aq.HTMLescape(t.name),"</span>"))},n.state={repo:{repo_id:n.props.repoID},selectedPath:n.props.path,errMessage:"",mode:"only_current_library"},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.dirent,r=t.selectedDirentList,o=t.isMultipleOperation,i=t.repoID,a=t.path,s=this.state,l=s.mode,c=s.errMessage,u=(n||r[0]).permission,d=f.Aq.getUserPermission(u).isCustomPermission,g=function(t){var n=t.mode,r=t.label;return(0,m.jsx)("div",{className:"repo-list-item ".concat(e.state.mode===n?"active":""),onClick:function(){return e.onSelectedMode(n)},children:(0,m.jsx)("span",{className:"library",children:r})})};return(0,m.jsxs)(p.A,{className:"custom-modal",isOpen:!0,toggle:this.toggle,children:[(0,m.jsx)(I.A,{toggle:this.toggle,children:o?this.renderTitle():(0,m.jsx)("div",{dangerouslySetInnerHTML:{__html:this.renderTitle()},className:"d-flex mw-100"})}),(0,m.jsxs)(ym.A,{children:[(0,m.jsxs)(xm.A,{className:"repo-list-col border-right",children:[(0,m.jsx)(g,{mode:"only_current_library",label:(0,h.AP)("Current Library")}),!d&&(0,m.jsx)(g,{mode:"only_other_libraries",label:(0,h.AP)("Other Libraries")}),(0,m.jsx)(g,{mode:"recently_used",label:(0,h.AP)("Recently Used")})]}),(0,m.jsxs)(xm.A,{className:"file-list-col",children:[(0,m.jsxs)(_.A,{children:[(0,m.jsx)(qt.A,{repoID:i,currentPath:a,onDirentItemClick:this.onDirentItemClick,onRepoItemClick:this.onRepoItemClick,mode:l,hideLibraryName:!1}),c&&(0,m.jsx)(Dt.A,{color:"danger",className:"alert-message",children:c})]}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(O.A,{color:"secondary",onClick:this.toggle,children:(0,h.AP)("Cancel")}),(0,m.jsx)(O.A,{color:"primary",onClick:this.handleSubmit,children:(0,h.AP)("Submit")})]})]})]})]})}}])}(s.Component),bm=function(e){var t=e.title,n=e.children,r=e.moreKey,o=e.moreOperations,i=e.moreOperationClick,a=e.className,l=e.isDisplayFiles,c=(0,s.useState)(!0),u=(0,F.A)(c,2),d=u[0],p=u[1],h=(0,s.useState)(!1),g=(0,F.A)(h,2),v=g[0],y=g[1],x=(0,s.useState)(!1),A=(0,F.A)(x,2),C=A[0],b=A[1],w=(0,s.useMemo)((function(){return Array.isArray(o)&&0!==o.length?o.filter((function(e){return e.key&&e.value})):[]}),[o]),S=(0,s.useCallback)((function(){p(!d)}),[d]),k=(0,s.useCallback)((function(){C||y(!0)}),[C]),M=(0,s.useCallback)((function(){C||y(!0)}),[C]),j=(0,s.useCallback)((function(){C||y(!1)}),[C]),I=(0,s.useCallback)((function(){b(!0)}),[]),_=(0,s.useCallback)((function(){b(!1),y(!1)}),[]);return(0,m.jsxs)("div",{className:D()("tree-section",(0,ro.default)({},a,a)),children:[(0,m.jsxs)("div",{className:D()("tree-section-header",{"tree-section-header-hover":v}),onMouseEnter:k,onMouseOver:M,onMouseLeave:j,children:[(0,m.jsx)("div",{className:"tree-section-header-title",children:t}),(0,m.jsxs)("div",{className:"tree-section-header-operations",children:[w.length>0&&(0,m.jsx)(m.Fragment,{children:(0,m.jsx)("div",{className:"tree-section-header-operation tree-section-more-operation",children:(0,m.jsx)(Qf.A,{item:r,toggleClass:"sf3-font sf3-font-more",freezeItem:I,unfreezeItem:_,getMenuList:function(){return w},onMenuItemClick:i,menuStyle:f.Fr?{zIndex:1050}:{},isDisplayFiles:l})})}),(0,m.jsx)("div",{className:"tree-section-header-operation",onClick:S,children:(0,m.jsx)("i",{className:"sf3-font sf3-font-down ".concat(d?"":"rotate-90")})})]})]}),d&&(0,m.jsx)("div",{className:"tree-section-body",children:n})]})},wm=function(e){var t=e.userPerm,n=e.repoID,r=e.currentPath,o=e.currentRepoInfo,i=(0,s.useMemo)((function(){return window.app.pageOptions.enableMetadataManagement}),[window.app.pageOptions.enableMetadataManagement]),a=(0,s.useState)(!1),l=(0,F.A)(a,2),c=l[0],u=l[1],d=ru(),p=d.enableMetadata,f=d.updateEnableMetadata,g=d.navigation,v=(0,s.useMemo)((function(){return i&&o.is_admin?[{key:"extended-properties",value:(0,h.AP)("Extended properties")}]:[]}),[i,o]),y=(0,s.useCallback)((function(e){"extended-properties"!==e||u(!0)}),[]),x=(0,s.useCallback)((function(){u(!1)}),[]),A=(0,s.useCallback)((function(e){f(e)}),[f]);return i?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(bm,{title:(0,h.AP)("Views"),moreKey:{name:"views"},moreOperations:v,moreOperationClick:y,children:p&&Array.isArray(g)&&g.length>0&&(0,m.jsx)(om,{userPerm:t,currentPath:r})}),c&&(0,m.jsx)(Jf,{value:p,repoID:n,toggle:x,submit:A})]}):null},Sm=function(){return(0,o.A)((function e(){(0,r.A)(this,e)}),[{key:"init",value:function(e){var t=e.server,n=e.username,r=e.password,o=e.token;return this.server=t,this.username=n,this.password=r,this.token=o,this.token&&this.server&&(this.req=ht.A.create({baseURL:this.server,headers:{Authorization:"Token "+this.token}})),this}},{key:"initForSeahubUsage",value:function(e){var t=e.siteRoot,n=e.xcsrfHeaders;if(t&&"/"===t.charAt(t.length-1)){var r=t.substring(0,t.length-1);this.server=r}else this.server=t;return this.req=ht.A.create({headers:{"X-CSRFToken":n}}),this}},{key:"getRepoFolderTrash2",value:function(e,t,n){var r=this.server+"/api/v2.1/repos/"+e+"/trash2/",o={page:t||1,per_page:n};return this.req.get(r,{params:o})}}])}(),Dm=new Sm,km=Ke.Ay.load("sfcsrftoken");Dm.initForSeahubUsage({siteRoot:h.Yc,xcsrfHeaders:km});var Mm=n(68849),jm=n(62376),Im=(n(18291),n(81848),function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).getItems2=function(e){Dm.getRepoFolderTrash2(n.props.repoID,e,n.state.perPage).then((function(t){var r=t.data,o=r.items,i=r.total_count;e||(e=1),n.setState({currentPage:e,hasNextPage:i-e*n.state.perPage>0,isLoading:!1,items:o,more:!1})}))},n.onSearchedClick=function(e){if(!0===e.is_dir){var t=h.Yc+"library/"+e.repo_id+"/"+e.repo_name+e.path;(0,c.oo)(t,{repalce:!0})}else{var n=h.Yc+"lib/"+e.repo_id+"/file"+f.Aq.encodePath(e.path);window.open("about:blank").location.href=n}},n.resetPerPage=function(e){n.setState({perPage:e},(function(){n.getItems2(1)}))},n.cleanTrash=function(){n.toggleCleanTrashDialog()},n.toggleCleanTrashDialog=function(){n.setState({isCleanTrashDialogOpen:!n.state.isCleanTrashDialogOpen})},n.refreshTrash2=function(){n.setState({isLoading:!0,errorMsg:"",items:[],scanStat:null,more:!1,showFolder:!1}),n.getItems2()},n.renderFolder=function(e,t,r){n.setState({showFolder:!0,commitID:e,baseDir:t,folderPath:r,folderItems:[],isLoading:!0}),k.e.listCommitDir(n.props.repoID,e,"".concat(t.substr(0,t.length-1)).concat(r)).then((function(e){n.setState({isLoading:!1,folderItems:e.data.dirent_list})})).catch((function(e){e.response?403==e.response.status?n.setState({isLoading:!1,errorMsg:(0,h.AP)("Permission denied")}):n.setState({isLoading:!1,errorMsg:(0,h.AP)("Error")}):n.setState({isLoading:!1,errorMsg:(0,h.AP)("Please check the network.")})}))},n.state={isLoading:!0,errorMsg:"",items:[],scanStat:null,more:!1,isCleanTrashDialogOpen:!1,trashType:0,isOldTrashDialogOpen:!1,currentPage:1,perPage:100,hasNextPage:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.getItems2()}},{key:"render",value:function(){var e=this.props,t=e.showTrashDialog,n=e.toggleTrashDialog,r=this.state,o=r.isCleanTrashDialogOpen,i=r.showFolder,a=this.props.currentRepoInfo.owner_email===h.Xh||this.props.currentRepoInfo.is_admin,s=this.props.currentRepoInfo.repo_name,l=h.Yc+"repo/"+this.props.repoID+"/trash/",c=(0,h.AP)("{placeholder} Trash");return c=c.replace("{placeholder}",'<span class="op-target text-truncate mx-1">'+f.Aq.HTMLescape(s)+"</span>"),(0,m.jsxs)(p.A,{className:"trash-dialog",isOpen:t,toggle:n,children:[(0,m.jsx)(I.A,{close:(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("a",{className:"trash-dialog-old-page",href:l,children:(0,h.AP)("Visit old version page")}),h.Et&&!i&&a&&(0,m.jsx)("button",{className:"btn btn-secondary clean flex-shrink-0 ml-4",onClick:this.cleanTrash,children:(0,h.AP)("Clean")}),(0,m.jsx)("span",{"aria-hidden":"true",className:"trash-dialog-close-icon sf3-font sf3-font-x-01 ml-4",onClick:n})]}),children:(0,m.jsx)("div",{dangerouslySetInnerHTML:{__html:c}})}),(0,m.jsxs)(_.A,{children:[(0,m.jsx)(_m,{data:this.state,repoID:this.props.repoID,getMore:this.getMore,currentPage:this.state.currentPage,curPerPage:this.state.perPage,hasNextPage:this.state.hasNextPage,renderFolder:this.renderFolder,getListByPage:this.getItems2,resetPerPage:this.resetPerPage}),o&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(Mm.A,{repoID:this.props.repoID,refreshTrash:this.refreshTrash2,toggleDialog:this.toggleCleanTrashDialog})})]})]})}}])}(s.Component)),_m=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).getPreviousPage=function(){n.props.getListByPage(n.props.currentPage-1)},n.getNextPage=function(){n.props.getListByPage(n.props.currentPage+1)},n.theadData=[{width:"5%",text:(0,h.AP)("Name")},{width:"20%",text:""},{width:"40%",text:(0,h.AP)("Original path")},{width:"12%",text:(0,h.AP)("Delete Time")},{width:"13%",text:(0,h.AP)("Size")},{width:"10%",text:""}],n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props.data,n=t.items,r=t.showFolder,o=t.commitID,i=t.baseDir,a=t.folderPath,l=t.folderItems,c=this.props,u=c.curPerPage,d=c.currentPage,p=c.hasNextPage;return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsxs)("table",{className:"table-hover",children:[(0,m.jsx)("thead",{children:(0,m.jsx)("tr",{children:this.theadData.map((function(e,t){return(0,m.jsx)("th",{className:0===t?"pl-4":"",width:e.width,children:e.text},t)}))})}),(0,m.jsx)("tbody",{children:r?l.map((function(t,n){return(0,m.jsx)(Nm,{item:t,repoID:e.props.repoID,commitID:o,baseDir:i,folderPath:a,renderFolder:e.props.renderFolder},n)})):n.map((function(t,n){return(0,m.jsx)(Pm,{repoID:e.props.repoID,item:t,renderFolder:e.props.renderFolder},n)}))})]}),(0,m.jsx)(jm.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:d,hasNextPage:p,curPerPage:u,resetPerPage:this.props.resetPerPage})]})}}])}(s.Component),Pm=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).handleMouseOver=function(){n.setState({isIconShown:!0})},n.handleMouseOut=function(){n.setState({isIconShown:!1})},n.restoreItem=function(e){e.preventDefault();var t=n.props.item,r=t.commit_id,o=t.parent_dir+t.obj_name;(t.is_dir?k.e.restoreFolder(n.props.repoID,r,o):k.e.restoreFile(n.props.repoID,r,o)).then((function(e){n.setState({restored:!0}),j.A.success((0,h.AP)("Successfully restored 1 item."))})).catch((function(e){var t="";t=e.response?e.response.data.error_msg||(0,h.AP)("Error"):(0,h.AP)("Please check the network."),j.A.danger(t)}))},n.renderFolder=function(e){e.preventDefault();var t=n.props.item;n.props.renderFolder(t.commit_id,t.parent_dir,f.Aq.joinPath("/",t.obj_name))},n.state={restored:!1,isIconShown:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.item,t=this.state,n=t.restored,r=t.isIconShown;return n?null:e.is_dir?(0,m.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[(0,m.jsx)("td",{className:"text-center",children:(0,m.jsx)("img",{src:f.Aq.getFolderIconUrl(),alt:(0,h.AP)("Folder"),width:"24"})}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"#",onClick:this.renderFolder,children:e.obj_name})}),(0,m.jsx)("td",{children:e.parent_dir}),(0,m.jsx)("td",{title:X()(e.deleted_time).format("LLLL"),children:X()(e.deleted_time).format("YYYY-MM-DD")}),(0,m.jsx)("td",{}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"#",className:r||f.Fr?"":"invisible",onClick:this.restoreItem,role:"button",children:(0,h.AP)("Restore")})})]}):(0,m.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[(0,m.jsx)("td",{className:"text-center",children:(0,m.jsx)("img",{src:f.Aq.getFileIconUrl(e.obj_name),alt:(0,h.AP)("File"),width:"24"})}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"".concat(h.Yc,"repo/").concat(this.props.repoID,"/trash/files/?obj_id=").concat(e.obj_id,"&commit_id=").concat(e.commit_id,"&base=").concat(encodeURIComponent(e.parent_dir),"&p=").concat(encodeURIComponent("/"+e.obj_name)),target:"_blank",rel:"noreferrer",children:e.obj_name})}),(0,m.jsx)("td",{children:e.parent_dir}),(0,m.jsx)("td",{title:X()(e.deleted_time).format("LLLL"),children:X()(e.deleted_time).format("YYYY-MM-DD")}),(0,m.jsx)("td",{children:f.Aq.bytesToSize(e.size)}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"#",className:r||f.Fr?"":"invisible",onClick:this.restoreItem,role:"button",children:(0,h.AP)("Restore")})})]})}}])}(s.Component),Nm=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).handleMouseOver=function(){n.setState({isIconShown:!0})},n.handleMouseOut=function(){n.setState({isIconShown:!1})},n.renderFolder=function(e){e.preventDefault();var t=n.props.item,r=n.props,o=r.commitID,i=r.baseDir,a=r.folderPath;n.props.renderFolder(o,i,f.Aq.joinPath(a,t.name))},n.state={isIconShown:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.item,t=this.props,n=t.commitID,r=t.baseDir,o=t.folderPath;return"dir"==e.type?(0,m.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,children:[(0,m.jsx)("td",{className:"text-center",children:(0,m.jsx)("img",{src:f.Aq.getFolderIconUrl(),alt:(0,h.AP)("Folder"),width:"24"})}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"#",onClick:this.renderFolder,children:e.name})}),(0,m.jsx)("td",{children:e.parent_dir}),(0,m.jsx)("td",{}),(0,m.jsx)("td",{}),(0,m.jsx)("td",{})]}):(0,m.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,children:[(0,m.jsx)("td",{className:"text-center",children:(0,m.jsx)("img",{src:f.Aq.getFileIconUrl(e.name),alt:(0,h.AP)("File"),width:"24"})}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:"".concat(h.Yc,"repo/").concat(this.props.repoID,"/trash/files/?obj_id=").concat(e.obj_id,"&commit_id=").concat(n,"&base=").concat(encodeURIComponent(r),"&p=").concat(encodeURIComponent(f.Aq.joinPath(o,e.name))),target:"_blank",rel:"noreferrer",children:e.name})}),(0,m.jsx)("td",{children:e.parent_dir}),(0,m.jsx)("td",{}),(0,m.jsx)("td",{children:f.Aq.bytesToSize(e.size)}),(0,m.jsx)("td",{})]})}}])}(s.Component),Om=Im,Tm=function(e){var t=e.userPerm,n=e.repoID,r=e.currentRepoInfo,o=(0,s.useState)(!1),i=(0,F.A)(o,2),a=i[0],l=i[1],c=null,u=h.Yc+"repo/history/"+n+"/";"rw"===t&&(c=h.Yc+"repo/"+n+"/trash/");var d=function(){l(!a)};return(0,m.jsxs)(bm,{title:(0,h.AP)("Others"),className:"dir-others",children:[c&&(0,m.jsxs)("div",{className:"dir-others-item text-nowrap",title:(0,h.AP)("Trash"),onClick:d,children:[(0,m.jsx)("span",{className:"sf3-font-recycle1 sf3-font"}),(0,m.jsx)("span",{className:"dir-others-item-text",children:(0,h.AP)("Trash")})]}),f.Aq.isDesktop()&&(0,m.jsxs)("div",{className:"dir-others-item text-nowrap",title:(0,h.AP)("History"),onClick:function(){return location.href=u},children:[(0,m.jsx)("span",{className:"sf3-font-history sf3-font"}),(0,m.jsx)("span",{className:"dir-others-item-text",children:(0,h.AP)("History")})]}),a&&(0,m.jsx)(Om,{repoID:n,currentRepoInfo:r,showTrashDialog:a,toggleTrashDialog:d})]})},Em=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).initMenuList=function(){var e=n.getMenuList();n.setState({operationList:e})},n.getMenuList=function(){var e=[];return e.push(Dr.A.NEW_FOLDER),e.push(Dr.A.NEW_FILE),e.push(Dr.A.DISPLAY_FILES),e},n.onNodeClick=function(e){var t;n.setState({opNode:e}),f.Aq.imageCheck((null===e||void 0===e||null===(t=e.object)||void 0===t?void 0:t.name)||"")?n.showNodeImagePopup(e):n.props.onNodeClick(e)},n.onMoreOperationClick=function(e){n.onMenuItemClick(e)},n.onMenuItemClick=function(e,t){switch(n.setState({opNode:t}),e){case"New Folder":t?n.onAddFolderToggle():n.onAddFolderToggle("root");break;case"New File":t?n.onAddFileToggle():n.onAddFileToggle("root");break;case"Rename":n.onRenameToggle();break;case"Delete":n.onDeleteNode(t);break;case"Copy":n.onCopyToggle();break;case"Move":n.onMoveToggle();break;case"Open in New Tab":n.onOpenFile(t);break;case"Display files":n.onDisplayFilesToggle()}},n.onAddFileToggle=function(e){if("root"===e){var t=n.props.treeData.root;n.setState({isAddFileDialogShow:!n.state.isAddFileDialogShow,opNode:t})}else n.setState({isAddFileDialogShow:!n.state.isAddFileDialogShow})},n.onAddFolderToggle=function(e){if("root"===e){var t=n.props.treeData.root;n.setState({isAddFolderDialogShow:!n.state.isAddFolderDialogShow,opNode:t})}else n.setState({isAddFolderDialogShow:!n.state.isAddFolderDialogShow})},n.onRenameToggle=function(){n.setState({isRenameDialogShow:!n.state.isRenameDialogShow})},n.onCopyToggle=function(){n.setState({isCopyDialogShow:!n.state.isCopyDialogShow})},n.onMoveToggle=function(){n.setState({isMoveDialogShow:!n.state.isMoveDialogShow})},n.onAddFolderNode=function(e){n.setState({isAddFolderDialogShow:!n.state.isAddFolderDialogShow}),n.props.onAddFolderNode(e)},n.onRenameNode=function(e){n.setState({isRenameDialogShow:!n.state.isRenameDialogShow});var t=n.state.opNode;n.props.onRenameNode(t,e)},n.onDeleteNode=function(e){n.props.onDeleteNode(e)},n.onOpenFile=function(e){var t=h.Yc+"lib/"+n.props.repoID+"/file"+f.Aq.encodePath(e.path);window.open(t,"_blank")},n.onDisplayFilesToggle=function(){n.setState({isDisplayFiles:!n.state.isDisplayFiles})},n.checkDuplicatedName=function(e){var t=n.state.opNode;return(t.parentNode?t.parentNode:t).children.map((function(e){return e.object})).some((function(t){return t.name===e}))},n.showNodeImagePopup=function(e){var t=e.parentNode.children.filter((function(e){return f.Aq.imageCheck(e.object.name)})).map((function(e){return e.object.name}));n.setState({isNodeImagePopupOpen:!0,imageNodeItems:n.prepareImageItems(e),imageIndex:t.indexOf(e.object.name)})},n.prepareImageItems=function(e){var t=e.parentNode.children.filter((function(e){return f.Aq.imageCheck(e.object.name)})),r=!n.props.currentRepoInfo.encrypted;return t.map((function(t){return function(t){var o=t.object.name,i=f.Aq.encodePath(f.Aq.joinPath(e.parentNode.path,o)),a="gif"===o.substr(o.lastIndexOf(".")+1).toLowerCase(),s=n.props.repoID,l="";return l=r&&!a?"".concat(h.Yc,"thumbnail/").concat(s,"/").concat(h.oC).concat(i):"".concat(h.Yc,"repo/").concat(s,"/raw").concat(i),{name:o,url:"".concat(h.Yc,"lib/").concat(s,"/file").concat(i),src:l}}(t)}))},n.closeNodeImagePopup=function(){n.setState({isNodeImagePopupOpen:!1})},n.moveToPrevImage=function(){var e=n.state.imageNodeItems.length;n.setState((function(t){return{imageIndex:(t.imageIndex+e-1)%e}}))},n.moveToNextImage=function(){var e=n.state.imageNodeItems.length;n.setState((function(t){return{imageIndex:(t.imageIndex+1)%e}}))},n.stopTreeScrollPropagation=function(e){e.stopPropagation()},n.renderContent=function(){var e=n.props,t=e.isTreeDataLoading,r=e.userPerm,o=e.treeData,i=e.currentPath,a=e.onNodeExpanded,s=e.onNodeCollapse,l=e.onItemMove,c=e.onItemsMove,u=e.currentRepoInfo,d=e.selectedDirentList,p=e.repoID,f=e.getMenuContainerSize;return(0,m.jsx)(m.Fragment,{children:t?(0,m.jsx)($.A,{}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(bm,{title:(0,h.AP)("Files"),moreKey:{name:"files"},moreOperations:n.state.operationList,moreOperationClick:n.onMoreOperationClick,isDisplayFiles:n.state.isDisplayFiles,children:(0,m.jsx)(mm.A,{userPerm:r,isNodeMenuShow:n.isNodeMenuShow,treeData:o,currentPath:i,onNodeClick:n.onNodeClick,onNodeExpanded:a,onNodeCollapse:s,onMenuItemClick:n.onMenuItemClick,onFreezedItem:n.onFreezedItem,onUnFreezedItem:n.onUnFreezedItem,onItemMove:l,currentRepoInfo:u,selectedDirentList:d,onItemsMove:c,repoID:p,getMenuContainerSize:f,isDisplayFiles:n.state.isDisplayFiles})}),(0,m.jsx)(wm,{repoID:p,currentPath:i,userPerm:r,currentRepoInfo:u}),(0,m.jsx)(Tm,{repoID:p,userPerm:r,currentRepoInfo:u})]})})},n.state={opNode:null,isAddFileDialogShow:!1,isAddFolderDialogShow:!1,isRenameDialogShow:!1,isNodeImagePopupOpen:!1,imageNodeItems:[],imageIndex:0,isCopyDialogShow:!1,isMoveDialogShow:!1,isMultipleOperation:!1,operationList:[],isDisplayFiles:!1},n.isNodeMenuShow=!0,n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.initMenuList()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.setState({opNode:e.currentNode})}},{key:"render",value:function(){var e=this.props.navRate?"0 0 "+100*this.props.navRate+"%":"0 0 25%",t=this.props.inResizing?"none":"";return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("div",{className:"dir-content-nav",role:"navigation",style:{flex:e,userSelect:t},onScroll:this.stopTreeScrollPropagation,children:this.renderContent()}),this.state.isAddFolderDialogShow&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(ur.A,{parentPath:this.state.opNode.path,onAddFolder:this.onAddFolderNode,checkDuplicatedName:this.checkDuplicatedName,addFolderCancel:this.onAddFolderToggle})}),this.state.isAddFileDialogShow&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(dr.A,{parentPath:this.state.opNode.path,onAddFile:this.props.onAddFileNode,checkDuplicatedName:this.checkDuplicatedName,toggleDialog:this.onAddFileToggle})}),this.state.isRenameDialogShow&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(vm,{currentNode:this.state.opNode,onRename:this.onRenameNode,checkDuplicatedName:this.checkDuplicatedName,toggleCancel:this.onRenameToggle})}),this.state.isCopyDialogShow&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(Am,{path:this.state.opNode.parentNode.path,repoID:this.props.repoID,dirent:this.state.opNode.object,onItemCopy:this.props.onItemCopy,repoEncrypted:this.props.currentRepoInfo.encrypted,onCancelCopy:this.onCopyToggle,isMultipleOperation:this.state.isMultipleOperation})}),this.state.isMoveDialogShow&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(Cm,{path:this.state.opNode.parentNode.path,repoID:this.props.repoID,dirent:this.state.opNode.object,onItemMove:this.props.onItemMove,repoEncrypted:this.props.currentRepoInfo.encrypted,onCancelMove:this.onMoveToggle,isMultipleOperation:this.state.isMultipleOperation})}),this.state.isNodeImagePopupOpen&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(ah.A,{imageItems:this.state.imageNodeItems,imageIndex:this.state.imageIndex,closeImagePopup:this.closeNodeImagePopup,moveToPrevImage:this.moveToPrevImage,moveToNextImage:this.moveToNextImage})})]})}}])}(s.Component);Em.defaultProps={navRate:.25};var Rm=Em,Lm=n(84295),Fm=function(e){function t(){var e;(0,r.A)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=(0,i.A)(this,t,[].concat(o))).onEditClick=function(t){t.preventDefault();var n=e.props,r=n.path,o=n.repoID,i=h.Yc+"lib/"+o+"/file"+f.Aq.encodePath(r)+"?mode=edit";window.open(i)},e.onOpenFile=function(t){t.preventDefault();var n=e.props,r=n.path,o=n.repoID,i=h.Yc+"lib/"+o+"/file"+f.Aq.encodePath(r);window.open(i,"_blank")},e}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){if(this.props.hash){var e=this.props.hash;setTimeout((function(){window.location.hash=e}),500)}}},{key:"render",value:function(){if(this.props.isFileLoadedErr)return(0,m.jsx)("div",{className:"message err-tip",children:(0,h.AP)("File does not exist.")});if("__sf-metadata"===this.props.content){var e=this.props,t=e.repoID,n=e.currentRepoInfo,r=e.viewId;return(0,m.jsx)($f,{mediaUrl:h.SG,repoID:t,repoInfo:n,viewID:r})}return(0,m.jsx)(Lm.A,{isTOCShow:!1,isFileLoading:this.props.isFileLoading,markdownContent:this.props.content,lastModified:this.props.lastModified,latestContributor:this.props.latestContributor,onLinkClick:this.props.onLinkClick,repoID:this.props.repoID,path:this.props.path,children:(0,m.jsx)("span",{className:"wiki-open-file position-fixed",onClick:this.onOpenFile,children:(0,m.jsx)("i",{className:"sf3-font sf3-font-expand-arrows-alt"})})})}}])}(s.Component),Um=Fm,Bm=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onCreateNewFile=function(e){n.setState({fileType:e,isCreateFileDialogShow:!n.state.isCreateFileDialogShow})},n.onCreateFileToggle=function(){n.setState({fileType:"",isCreateFileDialogShow:!n.state.isCreateFileDialogShow})},n.checkDuplicatedName=function(){return!1},n.state={fileType:"",isCreateFileDialogShow:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){if(this.props.isDirentListLoading)return(0,m.jsx)($.A,{});var e=this.props.currentRepoInfo;return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsxs)("div",{className:"tip-for-new-file",children:[(0,m.jsx)("p",{className:"text-secondary text-center",children:(0,h.AP)("This folder has no content at this time.")}),(0,m.jsxs)("p",{className:"text-secondary text-center",children:[(0,h.AP)("You can create files quickly")," +"]}),(0,m.jsx)("button",{className:"big-new-file-button",onClick:this.onCreateNewFile.bind(this,".md"),children:"+ Markdown"}),(0,m.jsx)("button",{className:"big-new-file-button",onClick:this.onCreateNewFile.bind(this,".pptx"),children:"+ PPT"}),(0,m.jsx)("br",{}),(0,m.jsx)("button",{className:"big-new-file-button",onClick:this.onCreateNewFile.bind(this,".docx"),children:"+ Word"}),(0,m.jsx)("button",{className:"big-new-file-button",onClick:this.onCreateNewFile.bind(this,".xlsx"),children:"+ Excel"}),(0,m.jsx)("br",{}),h.lU&&!e.encrypted&&(0,m.jsx)("button",{className:"big-new-file-button",onClick:this.onCreateNewFile.bind(this,".sdoc"),children:"+ SeaDoc"})]}),this.state.isCreateFileDialogShow&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(dr.A,{parentPath:this.props.path,fileType:this.state.fileType,onAddFile:this.props.onAddFile,toggleDialog:this.onCreateFileToggle,checkDuplicatedName:this.checkDuplicatedName})})]})}}])}(s.Component),Ym=Bm,qm=n(39143),Hm=n(57354),Gm=n(16670),zm=function(e){function t(){return(0,r.A)(this,t),(0,i.A)(this,t,arguments)}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fileTag,n=e.length,r=e.index,o="file-tag-".concat(t.id,"-").concat(Ur());return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("span",{className:"file-tag",id:o,style:{zIndex:n-r,backgroundColor:t.color}},t.id),(0,m.jsx)(Qe.A,{target:o,placement:"bottom",children:t.name})]})}}])}(s.PureComponent),Vm=function(e){function t(e){var n;(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).toggleOpMenu=function(){n.setState({isOpMenuOpen:!n.state.isOpMenuOpen})},n.onMouseEnter=function(){n.props.isItemFreezed||n.setState({highlight:!0,isOperationShow:!0}),n.state.canDrag&&n.setState({isDragTipShow:!0})},n.onMouseOver=function(){n.props.isItemFreezed||n.setState({highlight:!0,isOperationShow:!0}),n.state.canDrag&&n.setState({isDragTipShow:!0})},n.onMouseLeave=function(){n.props.isItemFreezed||n.setState({highlight:!1,isOperationShow:!1}),n.setState({isDragTipShow:!1})},n.unfreezeItem=function(){n.setState({highlight:!1,isOperationShow:!1}),n.props.unfreezeItem()},n.onItemSelected=function(){n.props.onItemSelected(n.props.dirent)},n.onItemStarred=function(e){var t=n.props.dirent,r=n.props.repoID,o=n.getDirentPath(t);t.starred?k.e.unstarItem(r,o).then((function(){n.props.updateDirent(n.props.dirent,"starred",!1)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)})):k.e.starItem(r,o).then((function(){n.props.updateDirent(n.props.dirent,"starred",!0)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.onDirentClick=function(e){e.stopPropagation(),"TD"==e.target.tagName&&n.props.onDirentClick(n.props.dirent,e)},n.onItemClick=function(e){e.preventDefault();var t=n.props.dirent;n.state.isRenameing||(t.isDir()?n.props.onItemClick(t):n.canPreview&&(f.Aq.imageCheck(t.name)?n.props.showImagePopup(t):n.props.onItemClick(t)))},n.onItemDelete=function(e){e.preventDefault(),e.nativeEvent.stopImmediatePropagation(),n.props.onItemDelete(n.props.dirent)},n.onItemShare=function(e){e.preventDefault(),e.nativeEvent.stopImmediatePropagation(),n.setState({isShareDialogShow:!n.state.isShareDialogShow})},n.exportDocx=function(){var e=window.app.config.serviceURL+"/repo/sdoc_export_to_docx/"+n.props.repoID+"/?file_path="+n.getDirentPath(n.props.dirent);window.location.href=e},n.closeSharedDialog=function(){n.setState({isShareDialogShow:!n.state.isShareDialogShow})},n.onMobileMenuItemClick=function(e){var t=e.target.getAttribute("data-op");n.onMenuItemClick(t,e)},n.onMenuItemClick=function(e,t){switch(e){case"Download":n.onItemDownload(t);break;case"Share":n.onItemShare(t);break;case"Delete":n.onItemDelete(t);break;case"Rename":n.onItemRenameToggle();break;case"Move":n.onItemMoveToggle();break;case"Copy":n.onItemCopyToggle();break;case"Tags":n.onEditFileTagToggle();break;case"Permission":n.onPermissionItem();break;case"Unlock":case"Unfreeze Document":n.onUnlockItem();break;case"Lock":n.onLockItem();break;case"Freeze Document":n.onFreezeDocument();break;case"Convert to Markdown":n.onItemConvert(t,"markdown");break;case"Convert to docx":n.onItemConvert(t,"docx");break;case"Export docx":n.exportDocx();break;case"Convert to sdoc":n.onItemConvert(t,"sdoc");break;case"History":n.onHistory();break;case"Access Log":n.onAccessLog();break;case"Properties":n.props.onDirentClick(n.props.dirent),n.props.showDirentDetail("info");break;case"Open via Client":n.onOpenViaClient();break;case"Convert with ONLYOFFICE":n.onConvertWithONLYOFFICE()}},n.onItemConvert=function(e,t){e.preventDefault(),e.nativeEvent.stopImmediatePropagation(),n.props.onItemConvert(n.props.dirent,t)},n.onEditFileTagToggle=function(){n.setState({isEditFileTagShow:!n.state.isEditFileTagShow})},n.onFileTagChanged=function(){var e=n.getDirentPath(n.props.dirent);n.props.onFileTagChanged(n.props.dirent,e)},n.onItemRenameToggle=function(){n.props.onItemRenameToggle(n.props.dirent),n.setState({isOperationShow:!1,isRenameing:!0,canDrag:!1})},n.onRenameConfirm=function(e){n.props.onItemRename(n.props.dirent,e),n.onRenameCancel()},n.onRenameCancel=function(){n.setState({isRenameing:!1,canDrag:n.canDrag}),n.unfreezeItem()},n.onItemMoveToggle=function(){n.setState({isMoveDialogShow:!n.state.isMoveDialogShow})},n.onItemCopyToggle=function(){n.setState({isCopyDialogShow:!n.state.isCopyDialogShow})},n.onPermissionItem=function(){n.setState({isPermissionDialogOpen:!n.state.isPermissionDialogOpen})},n.onLockItem=function(){var e=n.props.repoID,t=n.getDirentPath(n.props.dirent);k.e.lockfile(e,t).then((function(){n.props.updateDirent(n.props.dirent,"is_locked",!0),n.props.updateDirent(n.props.dirent,"locked_by_me",!0);var e=h.Xh.split("@");n.props.updateDirent(n.props.dirent,"lock_owner_name",e[0])})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.onFreezeDocument=function(){var e=n.props.repoID,t=n.getDirentPath(n.props.dirent);k.e.lockfile(e,t,-1).then((function(){n.props.updateDirent(n.props.dirent,"is_freezed",!0),n.props.updateDirent(n.props.dirent,"is_locked",!0),n.props.updateDirent(n.props.dirent,"locked_by_me",!0);var e=h.Xh.split("@");n.props.updateDirent(n.props.dirent,"lock_owner_name",e[0])})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.onUnlockItem=function(){var e=n.props.repoID,t=n.getDirentPath(n.props.dirent);k.e.unlockfile(e,t).then((function(){n.props.updateDirent(n.props.dirent,"is_locked",!1),n.props.updateDirent(n.props.dirent,"locked_by_me",!1),n.props.updateDirent(n.props.dirent,"lock_owner_name","")})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.onHistory=function(){var e=n.props.repoID,t=n.getDirentPath(n.props.dirent),r=Hm.A.getUrl({type:"file_revisions",repoID:e,filePath:t});location.href=r},n.onAccessLog=function(){var e=n.getDirentPath(n.props.dirent),t=h.Yc+"repo/file-access/"+n.props.repoID+"/?p="+encodeURIComponent(e);window.open(t)},n.onOpenViaClient=function(){var e=n.props.repoID,t=n.getDirentPath(n.props.dirent),r=Hm.A.getUrl({type:"open_via_client",repoID:e,filePath:t});location.href=r},n.onConvertWithONLYOFFICE=function(){var e=n.props.repoID,t=n.getDirentPath(n.props.dirent);k.e.onlyofficeConvert(e,t).then((function(e){n.props.loadDirentList(e.data.parent_dir)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.onItemDownload=function(e){e.preventDefault(),e.nativeEvent.stopImmediatePropagation();var t=n.props.dirent,r=n.props.repoID,o=n.getDirentPath(t);if("dir"===t.type)h.B$?k.e.zipDownload(r,n.props.path,n.props.dirent.name).then((function(e){var t=e.data.zip_token;location.href="".concat(h.IX,"zip/").concat(t)})).catch((function(e){var t=f.Aq.getErrorMsg(e);n.setState({isLoading:!1,errorMsg:t})})):n.setState({isZipDialogOpen:!0});else{var i=Hm.A.getUrl({type:"download_file_url",repoID:r,filePath:o});location.href=i}},n.closeZipDialog=function(){n.setState({isZipDialogOpen:!1})},n.getDirentPath=function(e){var t=n.props.path;return"/"===t?t+e.name:t+"/"+e.name},n.onTagTooltipToggle=function(e){e.stopPropagation(),n.setState({isShowTagTooltip:!n.state.isShowTagTooltip})},n.onItemMove=function(e,t,r,o){n.props.onItemMove(e,t,r,o)},n.onItemDragStart=function(e){if(f.Aq.isIEBrowser()||!n.state.canDrag)return!1;e.dataTransfer.effectAllowed="move";var t=n.props.selectedDirentList;if(t.length>0&&t.includes(n.props.dirent)){n.props.onShowDirentsDraggablePreview(),e.dataTransfer.setDragImage(n.refs.empty_content,0,0);var r=t.map((function(e){var t=n.getDirentPath(e);return{nodeDirent:e,nodeParentPath:n.props.path,nodeRootPath:t}}));return r=JSON.stringify(r),void e.dataTransfer.setData("application/drag-item-info",r)}e.dataTransfer&&e.dataTransfer.setDragImage&&e.dataTransfer.setDragImage(n.refs.drag_icon,15,15);var o=n.getDirentPath(n.props.dirent),i={nodeDirent:n.props.dirent,nodeParentPath:n.props.path,nodeRootPath:o};i=JSON.stringify(i),e.dataTransfer.setData("application/drag-item-info",i)},n.onItemDragEnter=function(e){if(f.Aq.isIEBrowser()||!n.state.canDrag)return!1;"dir"===n.props.dirent.type&&(e.stopPropagation(),n.setState({isDropTipshow:!0}))},n.onItemDragOver=function(e){if(f.Aq.isIEBrowser()||!n.state.canDrag)return!1;"copy"!==e.dataTransfer.dropEffect&&(e.preventDefault(),e.dataTransfer.dropEffect="move")},n.onItemDragLeave=function(e){if(f.Aq.isIEBrowser()||!n.state.canDrag)return!1;"dir"===n.props.dirent.type&&e.stopPropagation(),n.setState({isDropTipshow:!1})},n.onItemDragDrop=function(e){if(f.Aq.isIEBrowser()||!n.state.canDrag)return!1;if(n.setState({isDropTipshow:!1}),!e.dataTransfer.files.length&&"dir"===n.props.dirent.type){e.stopPropagation();var t=e.dataTransfer.getData("application/drag-item-info");if(t=JSON.parse(t),Array.isArray(t)){var r=t.map((function(e){return e.nodeRootPath})),o=f.Aq.joinPath(n.props.path,n.props.dirent.name);if(r.some((function(e){return e===o})))return;n.props.onItemsMove(n.props.currentRepoInfo,o)}else{var i=t,a=i.nodeDirent,s=i.nodeParentPath,l=i.nodeRootPath,c=n.props.dirent;if(a.name!==c.name&&("dir"!==c.type||"dir"!==a.type||s===n.props.path||-1===n.props.path.indexOf(l))){var u=f.Aq.joinPath(n.props.path,n.props.dirent.name);n.onItemMove(n.props.currentRepoInfo,a,u,s)}}}},n.onItemMouseDown=function(e){n.props.onItemMouseDown(e)},n.onItemContextMenu=function(e){var t=n.props.dirent;n.props.onItemContextMenu(e,t)},n.renderItemOperation=function(){var e=n.props,t=e.dirent,r=e.currentRepoInfo,o=e.selectedDirentList,i=!0,a=!0,l=n,c=l.isCustomPermission,u=l.customPermission;if(c){var d=u.permission;i=d.download,a=d.delete}var p=f.Aq.isHasPermissionToShare(r,t.permission,t);return(0,m.jsx)(s.Fragment,{children:o.length>1?(0,m.jsx)(s.Fragment,{children:n.state.isOperationShow&&!t.isSelected&&(0,m.jsxs)("div",{className:"operations",children:[("rw"===t.permission||"r"===t.permission||c&&i)&&(0,m.jsx)("a",{href:"#",className:"op-icon sf3-font sf3-font-download1",title:(0,h.AP)("Download"),role:"button","aria-label":(0,h.AP)("Download"),onClick:n.onItemDownload}),p&&(0,m.jsx)("a",{href:"#",className:"op-icon sf3-font-share sf3-font",title:(0,h.AP)("Share"),role:"button","aria-label":(0,h.AP)("Share"),onClick:n.onItemShare}),("rw"===t.permission||"cloud-edit"===t.permission||c&&a)&&(0,m.jsx)("a",{href:"#",className:"op-icon sf3-font-delete1 sf3-font",title:(0,h.AP)("Delete"),role:"button","aria-label":(0,h.AP)("Delete"),onClick:n.onItemDelete}),(0,m.jsx)(Qf.A,{item:n.props.dirent,isHandleContextMenuEvent:!0,getMenuList:n.props.getDirentItemMenuList,onMenuItemClick:n.onMenuItemClick,unfreezeItem:n.unfreezeItem,freezeItem:n.props.freezeItem})]})}):(0,m.jsx)(s.Fragment,{children:n.state.isOperationShow&&(0,m.jsxs)("div",{className:"operations",children:[("rw"===t.permission||"r"===t.permission||c&&i)&&(0,m.jsx)("a",{href:"#",className:"op-icon sf3-font sf3-font-download1",title:(0,h.AP)("Download"),role:"button","aria-label":(0,h.AP)("Download"),onClick:n.onItemDownload}),p&&(0,m.jsx)("a",{href:"#",className:"op-icon sf3-font-share sf3-font",title:(0,h.AP)("Share"),role:"button","aria-label":(0,h.AP)("Share"),onClick:n.onItemShare}),("rw"===t.permission||"cloud-edit"===t.permission||c&&a)&&(0,m.jsx)("a",{href:"#",className:"op-icon sf3-font-delete1 sf3-font",title:(0,h.AP)("Delete"),role:"button","aria-label":(0,h.AP)("Delete"),onClick:n.onItemDelete}),(0,m.jsx)(Qf.A,{item:n.props.dirent,isHandleContextMenuEvent:!0,getMenuList:n.props.getDirentItemMenuList,onMenuItemClick:n.onMenuItemClick,unfreezeItem:n.unfreezeItem,freezeItem:n.props.freezeItem})]})})})};var o=n.props.dirent,a=f.Aq.getUserPermission(o.permission),l=a.isCustomPermission,c=a.customPermission;if(n.isCustomPermission=l,n.customPermission=c,n.canPreview=!0,n.canDrag="rw"===o.permission,l){var u=c.permission,d=u.preview,p=u.modify;n.canPreview=d||p,n.canDrag=p}return n.state={isOperationShow:!1,highlight:!1,isZipDialogOpen:!1,isMoveDialogShow:!1,isCopyDialogShow:!1,isShareDialogShow:!1,isMultipleOperation:!1,canDrag:n.canDrag,isShowTagTooltip:!1,isDragTipShow:!1,isDropTipshow:!1,isEditFileTagShow:!1,isPermissionDialogOpen:!1,isOpMenuOpen:!1},n.tagListTitleID="tag-list-title-".concat(Ur()),n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.isItemFreezed,r=t.activeDirent,o=t.dirent;e.isItemFreezed===n||n||this.setState({highlight:!1,isOperationShow:r&&r.name===o.name})}},{key:"render",value:function(){var e=this,t=this.props,n=t.path,r=t.dirent,o=t.repoID,i=f.Aq.joinPath(n,r.name),a="";this.props.currentRepoInfo&&(a=h.Yc+"library/"+o+"/"+this.props.currentRepoInfo.repo_name+f.Aq.encodePath(i));var l=h.Yc+"lib/"+o+"/file"+f.Aq.encodePath(i);r.is_sdoc_revision&&r.revision_id&&(l=h.Yc+"lib/"+o+"/revisions/"+r.revision_id+"/");var c=f.Aq.getDirentIcon(r),u=r.isSelected,p=this.state.highlight?"tr-highlight ":"";p+=this.state.isDropTipshow?"tr-drop-effect":"",p+=u?"tr-active":"";var g=r.is_freezed?(0,h.AP)("Frozen by {name}"):(0,h.AP)("locked by {name}");g=g.replace("{name}",r.lock_owner_name);var v=f.Aq.isDesktop(),y=this.state.canDrag,x="".concat(h.SG,"img/file-").concat(r.is_freezed?"freezed-32.svg":"locked-32.png"),A=r.is_freezed?(0,h.AP)("freezed"):(0,h.AP)("locked");return(0,m.jsxs)(s.Fragment,{children:[v?(0,m.jsxs)("tr",{className:p,draggable:y,onFocus:this.onMouseEnter,onMouseEnter:this.onMouseEnter,onMouseOver:this.onMouseOver,onMouseLeave:this.onMouseLeave,onClick:this.onDirentClick,onDragStart:this.onItemDragStart,onDragEnter:this.onItemDragEnter,onDragOver:this.onItemDragOver,onDragLeave:this.onItemDragLeave,onDrop:this.onItemDragDrop,onMouseDown:this.onItemMouseDown,onContextMenu:this.onItemContextMenu,children:[(0,m.jsx)("td",{className:"pl10 ".concat(this.state.isDragTipShow?"tr-drag-effect":""),children:(0,m.jsx)("input",{type:"checkbox",className:"vam",onChange:this.onItemSelected,checked:u,"aria-label":u?(0,h.AP)("Unselect this item"):(0,h.AP)("Select this item")})}),(0,m.jsx)("td",{className:"pl10",children:void 0!==r.starred&&(0,m.jsx)("i",{role:"button","aria-label":r.starred?(0,h.AP)("Unstar"):(0,h.AP)("Star"),onClick:this.onItemStarred,className:"sf3-font ".concat(r.starred?"sf3-font-star":"sf3-font-star-empty")})}),(0,m.jsx)("td",{className:"pl10",children:(0,m.jsxs)("div",{className:"dir-icon",children:[this.canPreview&&r.encoded_thumbnail_src?(0,m.jsx)("img",{ref:"drag_icon",src:"".concat(h.Yc).concat(r.encoded_thumbnail_src),className:"thumbnail cursor-pointer",onClick:this.onItemClick,alt:""}):(0,m.jsx)("img",{ref:"drag_icon",src:c,width:"24",alt:""}),r.is_locked&&(0,m.jsx)("img",{className:"locked",src:x,alt:A,title:g}),(0,m.jsx)("div",{ref:"empty_content",style:{position:"absolute",width:"1px",height:"1px"}})]})}),(0,m.jsxs)("td",{className:"name",children:[this.state.isRenameing&&(0,m.jsx)(Zt.A,{hasSuffix:"dir"!==r.type,name:r.name,onRenameConfirm:this.onRenameConfirm,onRenameCancel:this.onRenameCancel}),!this.state.isRenameing&&(0,m.jsx)(s.Fragment,{children:r.isDir()||this.canPreview?(0,m.jsx)("a",{href:"dir"===r.type?a:l,onClick:this.onItemClick,children:r.name}):(0,m.jsx)("a",{className:"sf-link",onClick:this.onItemClick,children:r.name})})]}),(0,m.jsxs)("td",{className:"tag-list-title",children:["dir"!==r.type&&r.file_tags&&r.file_tags.length>0&&(0,m.jsx)("div",{id:this.tagListTitleID,className:"dirent-item tag-list tag-list-stacked",children:r.file_tags.map((function(e,t){return(0,m.jsx)(zm,{fileTag:e,length:r.file_tags.length,index:t},t)}))}),"dir"!==r.type&&(!r.file_tags||0==r.file_tags.length)&&(0,m.jsx)("div",{id:this.tagListTitleID,className:"dirent-item tag-list tag-list-stacked"})]}),(0,m.jsx)("td",{className:"operation",children:this.renderItemOperation()}),(0,m.jsx)("td",{className:"file-size",children:r.size&&r.size}),(0,m.jsx)("td",{className:"last-update",title:X().unix(r.mtime).format("llll"),children:r.mtime_relative})]}):(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{onClick:this.onItemClick,children:(0,m.jsxs)("div",{className:"dir-icon",children:[this.canPreview&&r.encoded_thumbnail_src?(0,m.jsx)("img",{src:"".concat(h.Yc).concat(r.encoded_thumbnail_src),className:"thumbnail cursor-pointer",alt:""}):(0,m.jsx)("img",{src:c,width:"24",alt:""}),r.is_locked&&(0,m.jsx)("img",{className:"locked",src:x,alt:A,title:g})]})}),(0,m.jsxs)("td",{onClick:this.onItemClick,children:[this.state.isRenameing&&(0,m.jsx)(Zt.A,{hasSuffix:"dir"!==r.type,name:r.name,onRenameConfirm:this.onRenameConfirm,onRenameCancel:this.onRenameCancel}),!this.state.isRenameing&&(0,m.jsx)(s.Fragment,{children:r.isDir()||this.canPreview?(0,m.jsx)("a",{href:"dir"===r.type?a:l,children:r.name}):(0,m.jsx)("a",{className:"sf-link",children:r.name})}),(0,m.jsx)("br",{}),r.size&&(0,m.jsx)("span",{className:"item-meta-info",children:r.size}),(0,m.jsx)("span",{className:"item-meta-info",children:r.mtime_relative})]}),(0,m.jsx)("td",{children:(0,m.jsxs)(de.A,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu,children:[(0,m.jsx)(pe.A,{tag:"i",className:"sf-dropdown-toggle sf3-font sf3-font-more-vertical ml-0",title:(0,h.AP)("More operations"),"aria-label":(0,h.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),(0,m.jsxs)("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu,children:[(0,m.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),(0,m.jsxs)("div",{className:"mobile-operation-menu",children:[void 0!==r.starred&&(0,m.jsx)(he.A,{className:"mobile-menu-item",onClick:this.onItemStarred,children:r.starred?(0,h.AP)("Unstar"):(0,h.AP)("Star")}),this.props.getDirentItemMenuList(r,!0).map((function(t,n){return"Divider"!=t&&"Open via Client"!=t.key?(0,m.jsx)(he.A,{className:"mobile-menu-item","data-op":t.key,onClick:e.onMobileMenuItemClick,children:t.value},n):null}))]})]})]})})]}),this.state.isMoveDialogShow&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(Cm,{path:this.props.path,repoID:this.props.repoID,dirent:this.props.dirent,isMultipleOperation:this.state.isMultipleOperation,onItemMove:this.props.onItemMove,onCancelMove:this.onItemMoveToggle,repoEncrypted:this.props.repoEncrypted})}),this.state.isCopyDialogShow&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(Am,{path:this.props.path,repoID:this.props.repoID,dirent:this.props.dirent,isMultipleOperation:this.state.isMultipleOperation,onItemCopy:this.props.onItemCopy,onCancelCopy:this.onItemCopyToggle,repoEncrypted:this.props.repoEncrypted})}),(0,m.jsx)(d(),{query:"(min-width: 768px)",children:this.state.isEditFileTagShow&&(0,m.jsx)(um.A,{repoID:this.props.repoID,repoTags:this.props.repoTags,fileTagList:r.file_tags,filePath:i,toggleCancel:this.onEditFileTagToggle,onFileTagChanged:this.onFileTagChanged,target:this.tagListTitleID,isEditFileTagShow:this.state.isEditFileTagShow})}),(0,m.jsx)(d(),{query:"(max-width: 767.8px)",children:this.state.isEditFileTagShow&&(0,m.jsx)(xr,{repoID:this.props.repoID,repoTags:this.props.repoTags,fileTagList:r.file_tags,filePath:i,toggleCancel:this.onEditFileTagToggle,onFileTagChanged:this.onFileTagChanged})}),this.state.isZipDialogOpen&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(Gm.A,{repoID:this.props.repoID,path:this.props.path,target:this.props.dirent.name,toggleDialog:this.closeZipDialog})}),this.state.isShareDialogShow&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(Je.A,{itemType:r.type,itemName:r.name,itemPath:i,userPerm:r.permission,repoID:this.props.repoID,repoEncrypted:this.props.repoEncrypted,enableDirPrivateShare:this.props.enableDirPrivateShare,isGroupOwnedRepo:this.props.isGroupOwnedRepo,toggleDialog:this.closeSharedDialog})}),this.state.isPermissionDialogOpen&&(0,m.jsx)(ne.A,{children:(0,m.jsx)($t,{toggleDialog:this.onPermissionItem,repoID:this.props.repoID,folderPath:i,folderName:r.name,isDepartmentRepo:this.props.isGroupOwnedRepo})})]})}}])}(s.Component),Wm=n(29009),Km=n(46757),Xm=function(e){function t(){var e;(0,r.A)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=(0,i.A)(this,t,[].concat(o))).handleDragEnd=function(){e.element.style.opacity=0,e.props.onHideDirentsDraggablePreview()},e.handleDragOver=function(t){if(f.Aq.isIEBrowser())return!1;t.preventDefault(),t.dataTransfer.dropEffect="move",e.element.style.top=t.clientY+"px",e.element.style.left=t.clientX+"px"},e.handleDrop=function(t){e.element.style.opacity=0,e.props.onHideDirentsDraggablePreview()},e}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){document.addEventListener("dragover",this.handleDragOver),document.addEventListener("drop",this.handleDrop),document.addEventListener("dragend",this.handleDragEnd)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("dragover",this.handleDragOver),document.removeEventListener("drop",this.handleDrop),document.removeEventListener("dragend",this.handleDragEnd)}},{key:"render",value:function(){var e=this,t=this.props.selectedDirentList,n={position:"absolute",opacity:1,pointerEvents:"none",display:"block",left:"-9999px",top:"-9999px",zIndex:101,maxHeight:document.documentElement.clientHeight,overflow:"hidden"};return(0,m.jsx)("div",{style:n,ref:function(t){return e.element=t},children:t.map((function(e,t){var n=f.Aq.getDirentIcon(e);return(0,m.jsx)("div",{children:e.encoded_thumbnail_src?(0,m.jsx)("img",{src:"".concat(h.Yc).concat(e.encoded_thumbnail_src),className:"thumbnail cursor-pointer",alt:""}):(0,m.jsx)("img",{src:n,width:"24",alt:""})},t)}))})}}])}(s.Component),$m=Xm,Zm=function(e){function t(e){var n;(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).freezeItem=function(){n.setState({isItemFreezed:!0})},n.unfreezeItem=function(){n.setState({isItemFreezed:!1})},n.onItemRename=function(e,t){if(n.props.direntList.some((function(e){return e.name===t}))){var r=(0,h.AP)('The name "{name}" is already taken. Please choose a different name.');return r=r.replace("{name}",f.Aq.HTMLescape(t)),j.A.danger(r),!1}n.props.onItemRename(e,t)},n.onItemRenameToggle=function(){n.freezeItem()},n.onItemSelected=function(e){n.setState({activeDirent:null}),n.props.onItemSelected(e)},n.onDirentClick=function(e,t){(0,Km.ks)(),n.props.onDirentClick(e,t)},n.sortByName=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortItems("name",t)},n.sortByTime=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortItems("time",t)},n.sortBySize=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortItems("size",t)},n.prepareImageItem=function(e){var t=e.name,r=n.props.repoID,o=f.Aq.encodePath(f.Aq.joinPath(n.props.path,t)),i="".concat(h.Yc,"repo/").concat(r,"/raw").concat(o);return{name:t,url:"".concat(h.Yc,"lib/").concat(r,"/file").concat(o),src:i}},n.showImagePopup=function(e){var t=n.props.fullDirentList.filter((function(e){return f.Aq.imageCheck(e.name)})),r=t.map((function(e){return n.prepareImageItem(e)}));n.setState({isImagePopupOpen:!0,imageItems:r,imageIndex:t.indexOf(e)})},n.moveToPrevImage=function(){var e=n.state.imageItems.length;n.setState((function(t){return{imageIndex:(t.imageIndex+e-1)%e}}))},n.moveToNextImage=function(){var e=n.state.imageItems.length;n.setState((function(t){return{imageIndex:(t.imageIndex+1)%e}}))},n.closeImagePopup=function(){n.setState({isImagePopupOpen:!1})},n.onCreateFileToggle=function(e){n.setState({isCreateFileDialogShow:!n.state.isCreateFileDialogShow,fileType:e||""})},n.onCreateFolderToggle=function(){n.setState({isCreateFolderDialogShow:!n.state.isCreateFolderDialogShow})},n.onAddFolder=function(e){n.setState({isCreateFolderDialogShow:!1}),n.props.onAddFolder(e)},n.checkDuplicatedName=function(e){return n.props.direntList.some((function(t){return t.name===e}))},n.onMoveToggle=function(){n.setState({isMoveDialogShow:!n.state.isMoveDialogShow})},n.onCopyToggle=function(){n.setState({isCopyDialogShow:!n.state.isCopyDialogShow})},n.onItemsDownload=function(){var e=n.props,t=e.path,r=e.repoID,o=e.selectedDirentList;if(o.length){if(1===o.length&&!o[0].isDir()){var i=f.Aq.joinPath(t,o[0].name),a=Hm.A.getUrl({type:"download_file_url",repoID:r,filePath:i});return void(location.href=a)}var s=o.map((function(e){return e.name}));n.setState({isProgressDialogShow:!0,downloadItems:s})}},n.onCloseZipDownloadDialog=function(){n.setState({isProgressDialogShow:!1})},n.onMouseDown=function(e){2!==e.button||e.stopPropagation()},n.handleContextClick=function(e,t,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e.preventDefault(),e.stopPropagation();var i=e.clientX||e.touches&&e.touches[0].pageX,a=e.clientY||e.touches&&e.touches[0].pageY;n.props.posX&&(i-=n.props.posX),n.props.posY&&(a-=n.props.posY),(0,Km.ks)();var s={id:t,position:{x:i,y:a},target:e.target,currentObject:o,menuList:r};0!==r.length&&(0,Km.db)(s)},n.onContainerClick=function(){(0,Km.ks)(),n.props.selectedDirentList.length>0&&n.onDirentClick(null)},n.onContainerMouseDown=function(e){n.onMouseDown(e)},n.onContainerContextMenu=function(e){e.preventDefault();var t=n.props.userPerm,r=f.Aq.getUserPermission(n.props.userPerm),o=r.isCustomPermission,i=r.customPermission;if("admin"===t||"rw"===t||o){var a=Dr.A.NEW_FOLDER,s=Dr.A.NEW_FILE,l=Dr.A.NEW_MARKDOWN_FILE,c=Dr.A.NEW_EXCEL_FILE,u=Dr.A.NEW_POWERPOINT_FILE,d=Dr.A.NEW_WORD_FILE,p=Dr.A.NEW_SEADOC_FILE,m=[a,s,"Divider"],g=n.props.currentRepoInfo;if(h.lU&&!g.encrypted&&m.push(p),m.push(l,c,u,d),0===n.props.selectedDirentList.length){if(o)if(!i.permission.create)return;var v=m;n.handleContextClick(e,"dirent-container-menu",v)}else if(1===n.props.selectedDirentList.length)if(n.state.activeDirent){if(n.onDirentClick(null),e.preventDefault(),e.persist(),o)if(!i.permission.modify)return;setTimeout((function(){var t=m;n.handleContextClick(e,"dirent-container-menu",t)}),0)}else{var y=n.props.selectedDirentList[0],x=n.getDirentItemMenuList(y,!0);n.handleContextClick(e,"dirent-item-menu",x,y)}else{var A=[];if(o){var C=i.permission,b=C.modify,w=C.copy,S=C.download,D=C.delete;b&&A.push(Dr.A.MOVE),w&&A.push(Dr.A.COPY),S&&A.push(Dr.A.DOWNLOAD),D&&A.push(Dr.A.DELETE)}else A=[Dr.A.MOVE,Dr.A.COPY,Dr.A.DOWNLOAD,Dr.A.DELETE];n.handleContextClick(e,"dirents-menu",A)}}},n.onContainerMenuItemClick=function(e){switch(e){case"New Folder":n.onCreateFolderToggle();break;case"New File":n.onCreateFileToggle();break;case"New Markdown File":n.onCreateFileToggle(".md");break;case"New Excel File":n.onCreateFileToggle(".xlsx");break;case"New PowerPoint File":n.onCreateFileToggle(".pptx");break;case"New Word File":n.onCreateFileToggle(".docx");break;case"New SeaDoc File":n.onCreateFileToggle(".sdoc")}(0,Km.ks)()},n.onDirentsMenuItemClick=function(e){switch(e){case"Move":n.onMoveToggle();break;case"Copy":n.onCopyToggle();break;case"Download":n.onItemsDownload();break;case"Delete":n.props.onItemsDelete()}(0,Km.ks)()},n.onThreadMouseDown=function(e){n.onMouseDown(e)},n.onThreadContextMenu=function(e){e.stopPropagation()},n.onItemMouseDown=function(e){n.onMouseDown(e)},n.onItemContextMenu=function(e,t){if(!(n.props.selectedDirentList.length>1)){n.onDirentClick(t);var r=n.getDirentItemMenuList(t,!0);n.handleContextClick(e,"dirent-item-menu",r,t)}},n.setDirentItemRef=function(e){return function(t){n.direntItems[e]=t}},n.onMenuItemClick=function(e,t,r){var o=n.getDirentIndex(t);n.direntItems[o].onMenuItemClick(e,r),(0,Km.ks)()},n.onShowMenu=function(e){n.freezeItem()},n.onHideMenu=function(e){n.unfreezeItem()},n.getDirentIndex=function(e){for(var t=n.props.direntList,r=0,o=0;o<t.length;o++)if(t[o].name===e.name){r=o;break}return r},n.getDirentItemMenuList=function(e,t){var r=n.isRepoOwner,o=n.props.currentRepoInfo;return f.Aq.getDirentOperationList(r,o,e,t)},n.onTableDragEnter=function(e){if(f.Aq.isIEBrowser()||!n.canDrop)return!1;if(n.enteredCounter++,0!==n.enteredCounter){if(n.state.isListDropTipShow)return;n.setState({isListDropTipShow:!0})}},n.onTableDragOver=function(e){if(f.Aq.isIEBrowser()||!n.canDrop)return!1;"copy"!==e.dataTransfer.dropEffect&&(e.preventDefault(),e.dataTransfer.dropEffect="move")},n.onTableDragLeave=function(e){if(f.Aq.isIEBrowser()||!n.canDrop)return!1;n.enteredCounter--,0===n.enteredCounter&&n.setState({isListDropTipShow:!1})},n.tableDrop=function(e){if(f.Aq.isIEBrowser()||!n.canDrop)return!1;if(e.persist(),n.enteredCounter=0,n.setState({isListDropTipShow:!1}),!e.dataTransfer.files.length){var t=e.dataTransfer.getData("application/drag-item-info"),r=t=JSON.parse(t),o=r.nodeDirent,i=r.nodeParentPath,a=r.nodeRootPath;Array.isArray(t)||a!==n.props.path&&i!==n.props.path&&-1===n.props.path.indexOf(a)&&n.props.onItemMove(n.props.currentRepoInfo,o,n.props.path,i)}},n.onShowDirentsDraggablePreview=function(){n.setState({isShowDirentsDraggablePreview:!0})},n.onHideDirentsDraggablePreview=function(){n.setState({isShowDirentsDraggablePreview:!1})},n.state={isItemFreezed:!1,isImagePopupOpen:!1,imageItems:[],imageIndex:0,fileType:"",isCreateFileDialogShow:!1,isCreateFolderDialogShow:!1,isMoveDialogShow:!1,isCopyDialogShow:!1,isProgressDialogShow:!1,downloadItems:[],isMultipleOperation:!0,activeDirent:null,isListDropTipShow:!1,isShowDirentsDraggablePreview:!1},n.enteredCounter=0,n.isRepoOwner=e.currentRepoInfo.owner_email===h.Xh,n.isAdmin=e.currentRepoInfo.is_admin,n.repoEncrypted=e.currentRepoInfo.encrypted,n.clickedDirent=null,n.direntItems=[],n.currentItemRef=null,n.zipToken=null;var o=e.userPerm;n.canDrop="rw"===o;var a=f.Aq.getUserPermission(o),s=a.isCustomPermission,l=a.customPermission;if(s){var c=l.permission.modify;n.canDrop=c}return n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.direntList,r=t.sortBy,o=t.sortOrder;if(this.props.isDirentListLoading)return(0,m.jsx)($.A,{});var i="name"==r,a="time"==r,l="size"==r,c="asc"==o?(0,m.jsx)("span",{className:"sf3-font sf3-font-down rotate-180 d-inline-block"}):(0,m.jsx)("span",{className:"sf3-font sf3-font-down"}),u=f.Aq.isDesktop();return(0,m.jsxs)("div",{className:"table-container ".concat(this.state.isListDropTipShow&&this.canDrop?"table-drop-active":""),onMouseDown:this.onContainerMouseDown,onContextMenu:this.onContainerContextMenu,onClick:this.onContainerClick,onDragEnter:this.onTableDragEnter,onDragOver:this.onTableDragOver,onDragLeave:this.onTableDragLeave,onDrop:this.tableDrop,children:[(0,m.jsxs)("table",{className:"table-hover ".concat(u?"":"table-thead-hidden"),children:[u?(0,m.jsx)("thead",{onMouseDown:this.onThreadMouseDown,onContextMenu:this.onThreadContextMenu,children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"3%",className:"pl10",children:(0,m.jsx)("input",{type:"checkbox",className:"vam",onChange:this.props.onAllItemSelected,checked:this.props.isAllItemSelected,title:this.props.isAllItemSelected?(0,h.AP)("Unselect all items"):(0,h.AP)("Select all items"),"aria-label":this.props.isAllItemSelected?(0,h.AP)("Unselect all items"):(0,h.AP)("Select all items"),disabled:0===n.length})}),(0,m.jsx)("th",{width:"3%",className:"pl10"}),(0,m.jsx)("th",{width:"5%",className:"pl10"}),(0,m.jsx)("th",{width:"39%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByName,children:[(0,h.AP)("Name")," ",i&&c]})}),(0,m.jsx)("th",{width:"6%"}),(0,m.jsx)("th",{width:"18%"}),(0,m.jsx)("th",{width:"11%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortBySize,children:[(0,h.AP)("Size")," ",l&&c]})}),(0,m.jsx)("th",{width:"15%",children:(0,m.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByTime,children:[(0,h.AP)("Last Update")," ",a&&c]})})]})}):(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"12%"}),(0,m.jsx)("th",{width:"80%"}),(0,m.jsx)("th",{width:"8%"})]})}),(0,m.jsx)("tbody",{children:n.map((function(t,n){return(0,m.jsx)(Vm,{ref:e.setDirentItemRef(n),dirent:t,path:e.props.path,repoID:e.props.repoID,currentRepoInfo:e.props.currentRepoInfo,isAdmin:e.isAdmin,isRepoOwner:e.isRepoOwner,repoEncrypted:e.repoEncrypted,enableDirPrivateShare:e.props.enableDirPrivateShare,isGroupOwnedRepo:e.props.isGroupOwnedRepo,onItemClick:e.props.onItemClick,onItemRenameToggle:e.onItemRenameToggle,onItemSelected:e.onItemSelected,onItemDelete:e.props.onItemDelete,onItemRename:e.onItemRename,onItemMove:e.props.onItemMove,onItemCopy:e.props.onItemCopy,onItemConvert:e.props.onItemConvert,updateDirent:e.props.updateDirent,isItemFreezed:e.state.isItemFreezed,freezeItem:e.freezeItem,unfreezeItem:e.unfreezeItem,onDirentClick:e.onDirentClick,showImagePopup:e.showImagePopup,onItemMouseDown:e.onItemMouseDown,onItemContextMenu:e.onItemContextMenu,selectedDirentList:e.props.selectedDirentList,activeDirent:e.state.activeDirent,repoTags:e.props.repoTags,onFileTagChanged:e.props.onFileTagChanged,getDirentItemMenuList:e.getDirentItemMenuList,showDirentDetail:e.props.showDirentDetail,onItemsMove:e.props.onItemsMove,onShowDirentsDraggablePreview:e.onShowDirentsDraggablePreview,loadDirentList:e.props.loadDirentList},n)}))})]}),(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)(Wm.A,{id:"dirent-container-menu",onMenuItemClick:this.onContainerMenuItemClick,getMenuContainerSize:this.props.getMenuContainerSize}),(0,m.jsx)(Wm.A,{id:"dirent-item-menu",onMenuItemClick:this.onMenuItemClick,onShowMenu:this.onShowMenu,onHideMenu:this.onHideMenu,getMenuContainerSize:this.props.getMenuContainerSize}),(0,m.jsx)(Wm.A,{id:"dirents-menu",onMenuItemClick:this.onDirentsMenuItemClick,getMenuContainerSize:this.props.getMenuContainerSize}),this.state.isShowDirentsDraggablePreview&&(0,m.jsx)(ne.A,{children:(0,m.jsx)($m,{selectedDirentList:this.props.selectedDirentList,onHideDirentsDraggablePreview:this.onHideDirentsDraggablePreview,dragStartPosition:this.state.dragStartPosition})}),this.state.isImagePopupOpen&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(ah.A,{imageItems:this.state.imageItems,imageIndex:this.state.imageIndex,closeImagePopup:this.closeImagePopup,moveToPrevImage:this.moveToPrevImage,moveToNextImage:this.moveToNextImage})}),this.state.isCreateFolderDialogShow&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(ur.A,{parentPath:this.props.path,onAddFolder:this.onAddFolder,checkDuplicatedName:this.checkDuplicatedName,addFolderCancel:this.onCreateFolderToggle})}),this.state.isCreateFileDialogShow&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(dr.A,{parentPath:this.props.path,fileType:this.state.fileType,onAddFile:this.props.onAddFile,checkDuplicatedName:this.checkDuplicatedName,toggleDialog:this.onCreateFileToggle})}),this.state.isMoveDialogShow&&(0,m.jsx)(Cm,{path:this.props.path,repoID:this.props.repoID,repoEncrypted:this.props.currentRepoInfo.encrypted,isMultipleOperation:this.state.isMultipleOperation,selectedDirentList:this.props.selectedDirentList,onItemsMove:this.props.onItemsMove,onCancelMove:this.onMoveToggle}),this.state.isCopyDialogShow&&(0,m.jsx)(Am,{path:this.props.path,repoID:this.props.repoID,repoEncrypted:this.props.currentRepoInfo.encrypted,selectedDirentList:this.props.selectedDirentList,isMultipleOperation:this.state.isMultipleOperation,onItemsCopy:this.props.onItemsCopy,onCancelCopy:this.onCopyToggle}),this.state.isProgressDialogShow&&(0,m.jsx)(Gm.A,{repoID:this.props.repoID,path:this.props.path,target:this.state.downloadItems,toggleDialog:this.onCloseZipDownloadDialog})]})]})}}])}(s.Component),Jm=Zm,Qm=function(e){function t(){return(0,r.A)(this,t),(0,i.A)(this,t,arguments)}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return"/"===this.props.path&&0===this.props.direntList.length?(0,m.jsx)(Ym,{path:this.props.path,isDirentListLoading:this.props.isDirentListLoading,onAddFile:this.props.onAddFile,currentRepoInfo:this.props.currentRepoInfo}):(0,m.jsxs)(s.Fragment,{children:[this.props.isRepoInfoBarShow&&(0,m.jsx)(qm.A,{repoID:this.props.repoID,currentPath:this.props.path,usedRepoTags:this.props.usedRepoTags,updateUsedRepoTags:this.props.updateUsedRepoTags,onFileTagChanged:this.props.onFileTagChanged}),(0,m.jsx)(Jm,{path:this.props.path,currentRepoInfo:this.props.currentRepoInfo,repoID:this.props.repoID,isGroupOwnedRepo:this.props.isGroupOwnedRepo,userPerm:this.props.userPerm,enableDirPrivateShare:this.props.enableDirPrivateShare,direntList:this.props.direntList,fullDirentList:this.props.fullDirentList,sortBy:this.props.sortBy,sortOrder:this.props.sortOrder,sortItems:this.props.sortItems,onItemClick:this.props.onItemClick,onItemSelected:this.props.onItemSelected,onItemDelete:this.props.onItemDelete,onItemRename:this.props.onItemRename,onItemMove:this.props.onItemMove,onItemCopy:this.props.onItemCopy,onDirentClick:this.props.onDirentClick,isDirentListLoading:this.props.isDirentListLoading,updateDirent:this.props.updateDirent,isAllItemSelected:this.props.isAllItemSelected,onAllItemSelected:this.props.onAllItemSelected,selectedDirentList:this.props.selectedDirentList,onItemsMove:this.props.onItemsMove,onItemsCopy:this.props.onItemsCopy,onItemConvert:this.props.onItemConvert,onItemsDelete:this.props.onItemsDelete,onAddFile:this.props.onAddFile,onAddFolder:this.props.onAddFolder,repoTags:this.props.repoTags,onFileTagChanged:this.props.onFileTagChanged,showDirentDetail:this.props.showDirentDetail,loadDirentList:this.props.loadDirentList,getMenuContainerSize:this.props.getMenuContainerSize})]})}}])}(s.Component),eg=Qm,tg=n(72517),ng=n.n(tg),rg=function(e){function t(e){var n;(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onItemClick=function(e){e.preventDefault(),e.stopPropagation();var t=n.props.dirent;if(n.clickTimeout)return clearTimeout(n.clickTimeout),n.clickTimeout=null,void n.handleSingleClick(t,e);n.clickTimeout=setTimeout((function(){n.clickTimeout=null,n.handleSingleClick(t,e)}),100)},n.handleSingleClick=function(e,t){n.canPreview&&(!e.isSelected||t.metaKey||t.ctrlKey?n.props.onGridItemClick(e,t):n.handleDoubleClick(e,t))},n.handleDoubleClick=function(e,t){f.Aq.imageCheck(e.name)?n.props.showImagePopup(e):n.props.onItemClick(e)},n.onItemLinkClick=function(e){e.preventDefault();var t=n.props.dirent;t.isDir()?n.props.onItemClick(t):n.canPreview&&n.handleDoubleClick(t,e)},n.onGridItemDragStart=function(e){if(f.Aq.isIEBrowser()||!n.canDrag)return!1;var t=n.props,r=t.selectedDirentList,o=t.path,i=r.length>0?r.map((function(e){return{nodeDirent:e,nodeParentPath:o}})):{nodeDirent:n.props.dirent,nodeParentPath:n.props.path},a=JSON.stringify(i);e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("application/drag-item-info",a)},n.onGridItemDragEnter=function(e){if(f.Aq.isIEBrowser()||!n.canDrag)return!1;"dir"===n.props.dirent.type&&n.setState({isGridDropTipShow:!0})},n.onGridItemDragOver=function(e){if(f.Aq.isIEBrowser()||!n.canDrag)return!1;e.preventDefault(),e.dataTransfer.dropEffect="move"},n.onGridItemDragLeave=function(e){if(f.Aq.isIEBrowser()||!n.canDrag)return!1;n.setState({isGridDropTipShow:!1})},n.onGridItemDragDrop=function(e){if(f.Aq.isIEBrowser()||!n.canDrag)return!1;if(n.setState({isGridDropTipShow:!1}),!e.dataTransfer.files.length){var t=f.Aq.joinPath(n.props.path,n.props.dirent.name),r=e.dataTransfer.getData("application/drag-item-info");if(r=JSON.parse(r),Array.isArray(r)){if(r.some((function(e){return e.nodeDirent.name===n.props.dirent.name})))return;n.props.onItemsMove(n.props.currentRepoInfo,t)}else{var o=r,i=o.nodeDirent,a=o.nodeParentPath,s=n.props.dirent;if(i.name===s.name)return;if("dir"!==s.type)return;n.props.onItemMove(n.props.currentRepoInfo,i,t,a)}}},n.onGridItemMouseDown=function(e){n.props.onGridItemMouseDown(e)},n.getFileUrl=function(e){var t=e.split("/");return-1!==t.indexOf("48")&&t.splice(t.indexOf("48"),1,"192"),t.join("/")},n.onGridItemContextMenu=function(e){var t=n.props.dirent;n.props.onGridItemContextMenu(e,t)},n.getTextRenderWidth=function(e,t){var n=document.createElement("canvas").getContext("2d");return n.font=t||"14px Arial",n.measureText(e).width},n.getRenderedText=function(e){var t=0;e.file_tags&&e.file_tags.length>0&&(t=1===e.file_tags.length?16:16+8*(e.file_tags.length-1));var r=230-t,o="";if(n.getTextRenderWidth(e.name)>r){for(var i=e.name.lastIndexOf("."),a=e.name.slice(0,i-2),s=e.name.slice(i-2),l=0,c=0;c<a.length;c++)if(a.charCodeAt(c)>127?l+=2:l+=1,l>20){a=a.slice(0,c)+"...";break}o=a+s}else o=e.name;return o},n.state={isGridDropTipShow:!1};var o=n.props.dirent,a=f.Aq.getUserPermission(o.permission),s=a.isCustomPermission,l=a.customPermission;if(n.isCustomPermission=s,n.customPermission=l,n.canPreview=!0,n.canDrag="rw"===o.permission,s){var c=l.permission,u=c.preview,d=c.modify;n.canPreview=u||d,n.canDrag=d}return n.clickTimeout=null,n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentWillUnmount",value:function(){this.clickTimeout&&clearTimeout(this.clickTimeout)}},{key:"render",value:function(){var e=this.props,t=e.dirent,n=e.path,r=e.repoID,o=f.Aq.joinPath(n,t.name),i=f.Aq.getDirentIcon(t,!0),a=t.encoded_thumbnail_src?this.getFileUrl(t.encoded_thumbnail_src):"",l="",c="";t.file_tags&&t.file_tags.length>0&&(l=ng()(t.name).slice(0,7),c=t.file_tags.map((function(e){return e.name})).join(" "));var u="";this.props.currentRepoInfo&&(u=h.Yc+"library/"+r+"/"+this.props.currentRepoInfo.repo_name+f.Aq.encodePath(o));var d=h.Yc+"lib/"+r+"/file"+f.Aq.encodePath(o);t.is_sdoc_revision&&t.revision_id&&(d=h.Yc+"lib/"+r+"/revisions/"+t.revision_id+"/");var p="grid-file-img-link cursor-pointer";p+=this.state.isGridDropTipShow?" grid-drop-show":" ";var g=t.is_freezed?(0,h.AP)("Frozen by {name}"):(0,h.AP)("locked by {name}");g=g.replace("{name}",t.lock_owner_name);var v="".concat(h.SG,"img/file-").concat(t.is_freezed?"freezed-32.svg":"locked-32.png"),y=t.is_freezed?(0,h.AP)("freezed"):(0,h.AP)("locked"),x=this.getRenderedText(t);return(0,m.jsx)(s.Fragment,{children:(0,m.jsxs)("li",{className:"grid-item ".concat(t.isSelected?"grid-selected-active":""),onContextMenu:this.onGridItemContextMenu,onMouseDown:this.onGridItemMouseDown,children:[(0,m.jsxs)("div",{className:p,draggable:this.canDrag,onClick:this.onItemClick,onDragStart:this.onGridItemDragStart,onDragEnter:this.onGridItemDragEnter,onDragOver:this.onGridItemDragOver,onDragLeave:this.onGridItemDragLeave,onDrop:this.onGridItemDragDrop,children:[this.canPreview&&t.encoded_thumbnail_src?(0,m.jsx)("img",{src:"".concat(h.Yc).concat(a),ref:this.gridIcon,className:"thumbnail",onClick:this.onItemClick,alt:""}):(0,m.jsx)("img",{src:i,ref:this.gridIcon,width:"96",alt:""}),t.is_locked&&(0,m.jsx)("img",{className:"grid-file-locked-icon",src:v,alt:y,title:g})]}),(0,m.jsxs)("div",{className:"grid-file-name",onDragStart:this.onGridItemDragStart,draggable:this.canDrag,children:["dir"!==t.type&&t.file_tags&&t.file_tags.length>0&&(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("div",{id:"tag-list-title-".concat(l),className:"dirent-item tag-list tag-list-stacked d-inline-block align-middle",children:t.file_tags.map((function(e,n){var r=t.file_tags.length;return(0,m.jsx)("span",{className:"file-tag",style:{zIndex:r-n,backgroundColor:e.color}},e.id)}))}),(0,m.jsx)(Qe.A,{target:"tag-list-title-".concat(l),placement:"bottom",children:c})]}),t.isDir()||this.canPreview?(0,m.jsx)("a",{className:"grid-file-name-link",href:"dir"===t.type?u:d,onClick:this.onItemClick,title:t.name,children:x}):(0,m.jsx)("a",{className:"sf-link grid-file-name-link",onClick:this.onItemClick,title:t.name,children:x})]})]})})}}])}(s.Component),og=rg,ig=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).handleChange=function(e){e.target.value.trim()?n.setState({isSubmitBtnActive:!0}):n.setState({isSubmitBtnActive:!1}),n.setState({newName:e.target.value})},n.handleSubmit=function(){var e=n.validateInput(),t=e.isValid,r=e.errMessage;if(t)if(n.checkDuplicatedName()){var o=(0,h.AP)('The name "{name}" is already taken. Please choose a different name.');o=o.replace("{name}",f.Aq.HTMLescape(n.state.newName)),n.setState({errMessage:o})}else n.props.onRename(n.state.newName),n.props.toggleCancel();else n.setState({errMessage:r})},n.handleKeyDown=function(e){"Enter"===e.key&&(e.preventDefault(),n.handleSubmit())},n.toggle=function(){n.props.toggleCancel()},n.changeState=function(e){var t=e.name;n.setState({newName:t})},n.validateInput=function(){var e=n.state.newName.trim(),t=!0,r="";return e?e.indexOf("/")>-1?{isValid:t=!1,errMessage:r=(0,h.AP)("Name should not include '/'.")}:{isValid:t,errMessage:r}:{isValid:t=!1,errMessage:r=(0,h.AP)("Name is required.")}},n.checkDuplicatedName=function(){return n.props.checkDuplicatedName(n.state.newName)},n.onAfterModelOpened=function(){var e=n.newInput.current;if(e){e.focus();var t=n.state.newName.lastIndexOf(".");t>0?e.setSelectionRange(0,t):e.select()}},n.state={newName:"",errMessage:"",isSubmitBtnActive:!1},n.newInput=s.createRef(),n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"UNSAFE_componentWillMount",value:function(){this.setState({newName:this.props.dirent.name})}},{key:"componentDidMount",value:function(){var e=this.props.dirent;this.changeState(e)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.changeState(e.dirent)}},{key:"render",value:function(){var e=this.props.dirent.type;return(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.toggle,onOpened:this.onAfterModelOpened,children:[(0,m.jsx)(I.A,{toggle:this.toggle,children:"file"===e?(0,h.AP)("Rename File"):(0,h.AP)("Rename Folder")}),(0,m.jsxs)(_.A,{children:[(0,m.jsx)("p",{children:"file"===e?(0,h.AP)("New file name"):(0,h.AP)("New folder name")}),(0,m.jsx)(P.A,{onKeyDown:this.handleKeyDown,innerRef:this.newInput,value:this.state.newName,onChange:this.handleChange}),this.state.errMessage&&(0,m.jsx)(Dt.A,{color:"danger",className:"mt-2",children:this.state.errMessage})]}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(O.A,{color:"secondary",onClick:this.toggle,children:(0,h.AP)("Cancel")}),(0,m.jsx)(O.A,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive,children:(0,h.AP)("Submit")})]})]})}}])}(s.Component),ag=ig,sg=(n(47100),"dirent-grid-container-menu"),lg="grid-item-contextmenu",cg="dirents-menu",ug=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onGridContainerMouseDown=function(e){if(2!==e.button&&0===e.button){if((0,Km.ks)(),n.props.onGridItemClick(null),e.target.closest("img")||e.target.closest("div.grid-file-name"))return;var t=n.containerRef.current.getBoundingClientRect();n.setState({startPoint:{x:e.clientX-t.left,y:e.clientY-t.top},endPoint:{x:e.clientX-t.left,y:e.clientY-t.top},selectedItemsList:[],isSelecting:!1,isMouseDown:!0})}},n.onSelectMouseMove=function(e){if(n.state.isMouseDown){var t=n.containerRef.current.getBoundingClientRect(),r={x:e.clientX-t.left,y:e.clientY-t.top};r.x=Math.max(0,Math.min(r.x,t.width)),r.y=Math.max(0,Math.min(r.y,t.height)),Math.sqrt(Math.pow(r.x-n.state.startPoint.x,2)+Math.pow(r.y-n.state.startPoint.y,2))>5&&n.setState({isSelecting:!0,endPoint:r},(function(){n.determineSelectedItems(),n.autoScroll(e.clientY);var t=new Set(n.state.selectedItemsList.map((function(e){return e.lastChild.lastChild.title}))),r=n.props.direntList.filter((function(e){return t.has(e.name)})).map((function(e){return(0,Sr.A)((0,Sr.A)({},e),{},{isSelected:!0})}));n.props.onSelectedDirentListUpdate(r)}))}},n.onGlobalMouseUp=function(){n.state.isMouseDown&&(clearInterval(n.state.autoScrollInterval),n.setState({isSelecting:!1,isMouseDown:!1,autoScrollInterval:null}))},n.determineSelectedItems=function(){var e=n.state,t=e.startPoint,r=e.endPoint,o=n.containerRef.current,i=o.querySelectorAll(".grid-item"),a=Math.min(t.x,r.x),s=Math.min(t.y,r.y),l=Math.max(t.x,r.x),c=Math.max(t.y,r.y),u=[];i.forEach((function(e){var t=e.getBoundingClientRect(),n=t.left-o.getBoundingClientRect().left,r=t.top-o.getBoundingClientRect().top,i=t.right-o.getBoundingClientRect().left,d=t.bottom-o.getBoundingClientRect().top;n<l&&i>a&&r<c&&d>s&&u.push(e)})),n.setState({selectedItemsList:u})},n.autoScroll=function(e){var t=n.containerRef.current,r=t.getBoundingClientRect(),o=function(){var o={x:n.state.endPoint.x,y:e-r.top+t.scrollTop};n.setState({endPoint:o},(function(){n.determineSelectedItems()}))};if(e<r.top+20){if(!n.state.autoScrollInterval){var i=setInterval((function(){t.scrollTop-=10,o()}),50);n.setState({autoScrollInterval:i})}}else if(e>r.bottom-20){if(!n.state.autoScrollInterval){var a=setInterval((function(){t.scrollTop+=10,o()}),50);n.setState({autoScrollInterval:a})}}else clearInterval(n.state.autoScrollInterval),n.setState({autoScrollInterval:null})},n.onCreateFileToggle=function(e){n.setState({isCreateFileDialogShow:!n.state.isCreateFileDialogShow,fileType:e||""})},n.onGridItemClick=function(e,t){(0,Km.ks)(),n.state.activeDirent!==e&&n.setState({activeDirent:e}),n.props.onGridItemClick(e,t)},n.onMoveToggle=function(){n.setState({isMoveDialogShow:!n.state.isMoveDialogShow})},n.onCopyToggle=function(){n.setState({isCopyDialogShow:!n.state.isCopyDialogShow})},n.onAddFolder=function(e){n.setState({isCreateFolderDialogShow:!1}),n.props.onAddFolder(e)},n.onItemShare=function(e){e.nativeEvent.stopImmediatePropagation(),n.setState({isShareDialogShow:!n.state.isShareDialogShow})},n.closeSharedDialog=function(){n.setState({isShareDialogShow:!n.state.isShareDialogShow})},n.onItemDelete=function(e,t){t.nativeEvent.stopImmediatePropagation(),1!==n.props.selectedDirentList.length?n.props.onItemsDelete():n.props.onItemDelete(e)},n.onItemConvert=function(e,t,r){t.nativeEvent.stopImmediatePropagation(),n.props.onItemConvert(e,r)},n.exportDocx=function(){var e=window.app.config.serviceURL+"/repo/sdoc_export_to_docx/"+n.props.repoID+"/?file_path="+n.getDirentPath(n.props.dirent);window.location.href=e},n.onMenuItemClick=function(e,t,r){switch((0,Km.ks)(),e){case"Download":n.onItemsDownload();break;case"Share":n.onItemShare(r);break;case"Delete":n.onItemDelete(t,r);break;case"Rename":n.onItemRenameToggle();break;case"Move":n.onItemMoveToggle();break;case"Copy":n.onItemCopyToggle();break;case"Unfreeze Document":case"Unlock":n.onUnlockItem(t);break;case"Freeze Document":n.onFreezeDocument(t);break;case"Convert to Markdown":n.onItemConvert(t,r,"markdown");break;case"Convert to docx":n.onItemConvert(t,r,"docx");break;case"Export docx":n.exportDocx();break;case"Convert to sdoc":n.onItemConvert(t,r,"sdoc");break;case"Tags":n.onEditFileTagToggle();break;case"Permission":n.onPermissionItem();break;case"Lock":n.onLockItem(t);break;case"History":n.onHistory(t);break;case"New Folder":n.onCreateFolderToggle(t);break;case"New File":n.onCreateFileToggle("");break;case"New Markdown File":n.onCreateFileToggle(".md");break;case"New Excel File":n.onCreateFileToggle(".xlsx");break;case"New PowerPoint File":n.onCreateFileToggle(".pptx");break;case"New Word File":n.onCreateFileToggle(".docx");break;case"New SeaDoc File":n.onCreateFileToggle(".sdoc");break;case"Access Log":n.onAccessLog(t);break;case"Properties":n.props.showDirentDetail("info");break;case"Open via Client":n.onOpenViaClient(t)}},n.onDirentsMenuItemClick=function(e){switch(e){case"Move":n.onMoveToggle();break;case"Copy":n.onCopyToggle();break;case"Download":n.onItemsDownload();break;case"Delete":n.props.onItemsDelete()}(0,Km.ks)()},n.onEditFileTagToggle=function(){n.setState({isEditFileTagShow:!n.state.isEditFileTagShow})},n.onFileTagChanged=function(){var e=n.state.activeDirent?n.state.activeDirent:"",t=f.Aq.joinPath(n.props.path,e.name);n.props.onFileTagChanged(e,t)},n.getDirentPath=function(e){var t=n.props.path;return"/"===t?t+e.name:t+"/"+e.name},n.closeZipDialog=function(){n.setState({isZipDialogOpen:!1})},n.onItemsDownload=function(){var e=n.props,t=e.path,r=e.repoID,o=e.selectedDirentList;if(1!==o.length||o[0].isDir()){var i=o.map((function(e){return e.name}));n.setState({isZipDialogOpen:!0,downloadItems:i})}else{var a=f.Aq.joinPath(t,o[0].name),s=Hm.A.getUrl({type:"download_file_url",repoID:r,filePath:a});location.href=s}},n.onCreateFolderToggle=function(){n.setState({isCreateFolderDialogShow:!n.state.isCreateFolderDialogShow})},n.onItemRenameToggle=function(){n.setState({isRenameDialogShow:!n.state.isRenameDialogShow})},n.onItemMoveToggle=function(){n.setState({isMoveDialogShow:!n.state.isMoveDialogShow})},n.onItemCopyToggle=function(){n.setState({isCopyDialogShow:!n.state.isCopyDialogShow})},n.onPermissionItem=function(){n.setState({isPermissionDialogOpen:!n.state.isPermissionDialogOpen})},n.onLockItem=function(e){var t=n.props.repoID,r=n.getDirentPath(e);k.e.lockfile(t,r).then((function(){n.props.updateDirent(e,"is_locked",!0),n.props.updateDirent(e,"locked_by_me",!0);var t=h.Xh.split("@");n.props.updateDirent(e,"lock_owner_name",t[0])})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.onFreezeDocument=function(e){var t=n.props.repoID,r=n.getDirentPath(e);k.e.lockfile(t,r,-1).then((function(){n.props.updateDirent(e,"is_freezed",!0),n.props.updateDirent(e,"is_locked",!0),n.props.updateDirent(e,"locked_by_me",!0);var t=h.Xh.split("@");n.props.updateDirent(e,"lock_owner_name",t[0])})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.onUnlockItem=function(e){var t=n.props.repoID,r=n.getDirentPath(e);k.e.unlockfile(t,r).then((function(){n.props.updateDirent(e,"is_locked",!1),n.props.updateDirent(e,"locked_by_me",!1),n.props.updateDirent(e,"lock_owner_name","")})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.onHistory=function(e){var t=n.props.repoID,r=n.getDirentPath(e),o=Hm.A.getUrl({type:"file_revisions",repoID:t,filePath:r});location.href=o},n.onAccessLog=function(e){var t=n.getDirentPath(e),r=h.Yc+"repo/file-access/"+n.props.repoID+"/?p="+encodeURIComponent(t);window.open(r)},n.onOpenViaClient=function(e){var t=n.props.repoID,r=n.getDirentPath(e),o=Hm.A.getUrl({type:"open_via_client",repoID:t,filePath:r});location.href=o},n.onItemRename=function(e){n.props.onItemRename(n.state.activeDirent,e)},n.prepareImageItem=function(e){var t=e.name,r=n.props.repoID,o=f.Aq.encodePath(f.Aq.joinPath(n.props.path,t)),i="".concat(h.Yc,"repo/").concat(r,"/raw").concat(o);return{name:t,url:"".concat(h.Yc,"lib/").concat(r,"/file").concat(o),src:i}},n.showImagePopup=function(e){var t=n.props.fullDirentList.filter((function(e){return f.Aq.imageCheck(e.name)})),r=t.map((function(e){return n.prepareImageItem(e)}));n.setState({isImagePopupOpen:!0,imageItems:r,imageIndex:t.indexOf(e)})},n.closeImagePopup=function(){n.setState({isImagePopupOpen:!1})},n.moveToPrevImage=function(){var e=n.state.imageItems.length;n.setState((function(t){return{imageIndex:(t.imageIndex+e-1)%e}}))},n.moveToNextImage=function(){var e=n.state.imageItems.length;n.setState((function(t){return{imageIndex:(t.imageIndex+1)%e}}))},n.checkDuplicatedName=function(e){return f.Aq.checkDuplicatedNameInList(n.props.direntList,e)},n.onGridItemMouseDown=function(e){e.stopPropagation(),e.button},n.gridContainerClick=function(e){e.stopPropagation(),(0,Km.ks)()},n.onGridContainerContextMenu=function(e){e.preventDefault();var t=function(e){var t=f.Aq.getUserPermission(n.props.userPerm),r=t.isCustomPermission,o=t.customPermission;return!r||o.permission[e]};if(["admin","rw"].includes(n.props.userPerm)){var r=Dr.A.NEW_FOLDER,o=Dr.A.NEW_FILE,i=Dr.A.NEW_MARKDOWN_FILE,a=Dr.A.NEW_EXCEL_FILE,s=Dr.A.NEW_POWERPOINT_FILE,l=Dr.A.NEW_WORD_FILE,c=Dr.A.NEW_SEADOC_FILE,u=[r,o,"Divider"],d=n.props,p=d.currentRepoInfo,m=d.selectedDirentList;if(h.lU&&!p.encrypted&&u.push(c),u.push(i,a,s,l),0===m.length){if(!t("create"))return;n.handleContextClick(e,sg,u)}else if(1===m.length)if(n.state.activeDirent){if(n.props.onGridItemClick(null),e.persist(),!t("modify"))return;setTimeout((function(){n.handleContextClick(e,sg,u)}),0)}else{var g=f.Aq.getDirentOperationList(n.isRepoOwner,p,m[0],!0);n.handleContextClick(e,lg,g,m[0])}else{var v=[];if(!t("modify")&&!t("copy")&&!t("download")&&!t("delete"))return;["move","copy","download","delete"].forEach((function(e){t(e)&&v.push(Dr.A[e.toUpperCase()])})),n.handleContextClick(e,cg,v)}}},n.onGridItemContextMenu=function(e,t){if(!(n.props.selectedDirentList.length>1)){var r=n.getDirentItemMenuList(t,!0);n.handleContextClick(e,"grid-item-contextmenu",r,t),n.props.direntList.filter((function(e){return e.isSelected})).length>1||n.props.onGridItemClick&&n.props.onGridItemClick(t)}},n.handleContextClick=function(e,t,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e.preventDefault(),e.stopPropagation();var i=e.clientX||e.touches&&e.touches[0].pageX,a=e.clientY||e.touches&&e.touches[0].pageY;n.props.posX&&(i-=n.props.posX),n.props.posY&&(a-=n.props.posY),(0,Km.ks)(),n.setState({activeDirent:o});var s={id:t,position:{x:i,y:a},target:e.target,currentObject:o,menuList:r};0!==r.length&&(0,Km.db)(s)},n.getDirentItemMenuList=function(e,t){var r=n.isRepoOwner,o=n.props.currentRepoInfo;return f.Aq.getDirentOperationList(r,o,e,t)},n.renderSelectionBox=function(){var e=n.state,t=e.startPoint,r=e.endPoint;if(!n.state.isSelecting)return null;var o=Math.min(t.x,r.x),i=Math.min(t.y,r.y),a=Math.abs(t.x-r.x),s=Math.abs(t.y-r.y);return(0,m.jsx)("div",{className:"selection-box",style:{left:o,top:i,width:a,height:s}})},n.state={isImagePopupOpen:!1,imageItems:[],imageIndex:0,isShareDialogShow:!1,isMoveDialogShow:!1,isCopyDialogShow:!1,isEditFileTagShow:!1,isZipDialogOpen:!1,isRenameDialogShow:!1,isCreateFolderDialogShow:!1,isCreateFileDialogShow:!1,fileType:"",isPermissionDialogOpen:!1,isMultipleOperation:!0,isGridItemFreezed:!1,activeDirent:null,downloadItems:[],startPoint:{x:0,y:0},endPoint:{x:0,y:0},selectedItemsList:[],isSelecting:!1,isMouseDown:!1,autoScrollInterval:null},n.containerRef=s.createRef(),n.isRepoOwner=e.currentRepoInfo.owner_email===h.Xh,n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){window.addEventListener("mouseup",this.onGlobalMouseUp)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("mouseup",this.onGlobalMouseUp)}},{key:"render",value:function(){var e=this,t=this.props,n=t.direntList,r=t.selectedDirentList,o=t.path,i=this.state.activeDirent?this.state.activeDirent:"",a=f.Aq.joinPath(o,i.name);return this.props.isDirentListLoading?(0,m.jsx)($.A,{}):(0,m.jsxs)(s.Fragment,{children:[(0,m.jsxs)("ul",{className:"grid-view",onClick:this.gridContainerClick,onContextMenu:this.onGridContainerContextMenu,onMouseDown:this.onGridContainerMouseDown,onMouseMove:this.onSelectMouseMove,ref:this.containerRef,children:[0!==n.length&&n.map((function(t,n){return(0,m.jsx)(og,{dirent:t,repoID:e.props.repoID,path:e.props.path,onItemClick:e.props.onItemClick,currentRepoInfo:e.props.currentRepoInfo,showImagePopup:e.showImagePopup,onGridItemContextMenu:e.onGridItemContextMenu,onItemMove:e.props.onItemMove,onItemsMove:e.props.onItemsMove,onGridItemMouseDown:e.onGridItemMouseDown,onGridItemClick:e.onGridItemClick,activeDirent:e.state.activeDirent,selectedDirentList:r},n)})),this.renderSelectionBox()]}),(0,m.jsx)(Wm.A,{id:lg,onMenuItemClick:this.onMenuItemClick,getMenuContainerSize:this.props.getMenuContainerSize}),(0,m.jsx)(Wm.A,{id:sg,onMenuItemClick:this.onMenuItemClick,getMenuContainerSize:this.props.getMenuContainerSize}),(0,m.jsx)(Wm.A,{id:cg,onMenuItemClick:this.onDirentsMenuItemClick,getMenuContainerSize:this.props.getMenuContainerSize}),this.state.isCreateFolderDialogShow&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(ur.A,{parentPath:this.props.path,onAddFolder:this.onAddFolder,checkDuplicatedName:this.checkDuplicatedName,addFolderCancel:this.onCreateFolderToggle})}),this.state.isCreateFileDialogShow&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(dr.A,{parentPath:this.props.path,fileType:this.state.fileType,onAddFile:this.props.onAddFile,checkDuplicatedName:this.checkDuplicatedName,toggleDialog:this.onCreateFileToggle})}),this.state.isMoveDialogShow&&(0,m.jsx)(Cm,{path:this.props.path,repoID:this.props.repoID,repoEncrypted:this.props.currentRepoInfo.encrypted,isMultipleOperation:this.state.isMultipleOperation,selectedDirentList:r,onItemMove:this.props.onItemMove,onItemsMove:this.props.onItemsMove,onCancelMove:this.onMoveToggle,dirent:this.state.activeDirent}),this.state.isZipDialogOpen&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(Gm.A,{repoID:this.props.repoID,path:this.props.path,target:this.state.downloadItems,toggleDialog:this.closeZipDialog})}),this.state.isCopyDialogShow&&(0,m.jsx)(Am,{path:this.props.path,repoID:this.props.repoID,repoEncrypted:this.props.currentRepoInfo.encrypted,isMultipleOperation:this.state.isMultipleOperation,selectedDirentList:r,onItemsCopy:this.props.onItemsCopy,onCancelCopy:this.onCopyToggle}),this.state.isEditFileTagShow&&(0,m.jsx)(xr,{repoID:this.props.repoID,fileTagList:i.file_tags,filePath:a,toggleCancel:this.onEditFileTagToggle,repoTags:this.props.repoTags,onFileTagChanged:this.onFileTagChanged}),this.state.isShareDialogShow&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(Je.A,{itemType:i.type,itemName:i.name,itemPath:a,userPerm:i.permission,repoID:this.props.repoID,repoEncrypted:!1,enableDirPrivateShare:this.props.enableDirPrivateShare,isGroupOwnedRepo:this.props.isGroupOwnedRepo,toggleDialog:this.closeSharedDialog})}),this.state.isRenameDialogShow&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(ag,{dirent:r.length>1?r[r.length-1]:this.state.activeDirent,onRename:this.onItemRename,checkDuplicatedName:this.checkDuplicatedName,toggleCancel:this.onItemRenameToggle})}),this.state.isPermissionDialogOpen&&(0,m.jsx)(ne.A,{children:(0,m.jsx)($t,{toggleDialog:this.onPermissionItem,repoID:this.props.repoID,folderPath:a,folderName:i.name,isDepartmentRepo:this.props.isGroupOwnedRepo})}),this.state.isImagePopupOpen&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(ah.A,{imageItems:this.state.imageItems,imageIndex:this.state.imageIndex,closeImagePopup:this.closeImagePopup,moveToPrevImage:this.moveToPrevImage,moveToNextImage:this.moveToNextImage})})]})}}])}(s.Component),dg=ug,pg=function(e){function t(){return(0,r.A)(this,t),(0,i.A)(this,t,arguments)}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return"/"===this.props.path&&0===this.props.direntList.length?(0,m.jsx)(Ym,{path:this.props.path,isDirentListLoading:this.props.isDirentListLoading,onAddFile:this.props.onAddFile,currentRepoInfo:this.props.currentRepoInfo}):(0,m.jsxs)(s.Fragment,{children:[this.props.isRepoInfoBarShow&&(0,m.jsx)(qm.A,{repoID:this.props.repoID,currentPath:this.props.path,usedRepoTags:this.props.usedRepoTags,updateUsedRepoTags:this.props.updateUsedRepoTags,onFileTagChanged:this.props.onFileTagChanged}),(0,m.jsx)(dg,{path:this.props.path,repoID:this.props.repoID,currentRepoInfo:this.props.currentRepoInfo,isGroupOwnedRepo:this.props.isGroupOwnedRepo,userPerm:this.props.userPerm,enableDirPrivateShare:this.props.enableDirPrivateShare,direntList:this.props.direntList,fullDirentList:this.props.fullDirentList,selectedDirentList:this.props.selectedDirentList,onSelectedDirentListUpdate:this.props.onSelectedDirentListUpdate,onAddFile:this.props.onAddFile,onItemClick:this.props.onItemClick,onItemDelete:this.props.onItemDelete,onItemMove:this.props.onItemMove,onItemCopy:this.props.onItemCopy,onItemConvert:this.props.onItemConvert,onItemsMove:this.props.onItemsMove,onItemsCopy:this.props.onItemsCopy,onItemsDelete:this.props.onItemsDelete,isDirentListLoading:this.props.isDirentListLoading,updateDirent:this.props.updateDirent,onRenameNode:this.props.onRenameNode,showDirentDetail:this.props.showDirentDetail,onGridItemClick:this.props.onGridItemClick,isDirentDetailShow:this.props.isDirentDetailShow,onItemRename:this.props.onItemRename,onAddFolder:this.props.onAddFolder,repoTags:this.props.repoTags,onFileTagChanged:this.props.onFileTagChanged,getMenuContainerSize:this.props.getMenuContainerSize})]})}}])}(s.Component),hg=pg,fg=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onResizeMouseUp=function(){n.state.inResizing&&n.setState({inResizing:!1}),localStorage.setItem("sf_dir_content_nav_rate",n.state.navRate)},n.onResizeMouseDown=function(){n.containerWidth=n.viewModeContainer.current.clientWidth,n.setState({inResizing:!0})},n.onResizeMouseMove=function(e){var t=n.props.isSidePanelFolded?R.xQ+3:window.innerWidth-n.containerWidth,r=(e.nativeEvent.clientX-t)/n.containerWidth;n.setState({navRate:Math.max(Math.min(r,.4),.15)})},n.onResizeMouseOver=function(e){if(n.dragHandlerRef.current){var t=n.resizeBarRef.current.getBoundingClientRect().top,r=e.pageY-t-13;n.setDragHandlerTop(r)}},n.setDragHandlerTop=function(e){n.dragHandlerRef.current.style.top=e+"px"},n.getMenuContainerSize=function(){var e=window;return{width:e.innerWidth,height:e.innerHeight}},n.state={inResizing:!1,navRate:parseFloat(localStorage.getItem("sf_dir_content_nav_rate")||.25)},n.containerWidth=null,n.resizeBarRef=s.createRef(),n.dragHandlerRef=s.createRef(),n.viewModeContainer=s.createRef(),n.dirContentMain=s.createRef(),n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.currentMode,n=e.isTreePanelShown,r=this.state,o=r.navRate,i=r.inResizing,a=i?this.onResizeMouseMove:null,s=i?"none":"",l="1 0 "+100*(1-o)+"%";return(0,m.jsxs)("div",{className:"dir-column-view",onMouseMove:a,onMouseUp:this.onResizeMouseUp,ref:this.viewModeContainer,children:[n&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(Rm,{currentPath:this.props.path,userPerm:this.props.userPerm,isTreeDataLoading:this.props.isTreeDataLoading,treeData:this.props.treeData,currentNode:this.props.currentNode,onNodeClick:this.props.onNodeClick,onNodeCollapse:this.props.onNodeCollapse,onNodeExpanded:this.props.onNodeExpanded,onAddFolderNode:this.props.onAddFolderNode,onAddFileNode:this.props.onAddFileNode,onRenameNode:this.props.onRenameNode,onDeleteNode:this.props.onDeleteNode,repoID:this.props.repoID,navRate:o,inResizing:i,currentRepoInfo:this.props.currentRepoInfo,onItemMove:this.props.onItemMove,onItemCopy:this.props.onItemCopy,selectedDirentList:this.props.selectedDirentList,onItemsMove:this.props.onItemsMove,getMenuContainerSize:this.getMenuContainerSize}),(0,m.jsx)(G,{resizeBarRef:this.resizeBarRef,dragHandlerRef:this.dragHandlerRef,resizeBarStyle:{left:"calc(".concat(o?100*o+"%":"25%"," - 1px)")},dragHandlerStyle:{height:z},onResizeMouseDown:this.onResizeMouseDown,onResizeMouseOver:this.onResizeMouseOver})]}),(0,m.jsx)("div",{className:"dir-content-main",style:{userSelect:s,flex:l},onScroll:this.props.isViewFile?function(){}:this.props.onItemsScroll,ref:this.dirContentMain,children:this.props.isViewFile?(0,m.jsx)(Um,{path:this.props.path,repoID:this.props.repoID,hash:this.props.hash,isFileLoading:this.props.isFileLoading,isFileLoadedErr:this.props.isFileLoadedErr,filePermission:this.props.filePermission,content:this.props.content,viewId:this.props.viewId,currentRepoInfo:this.props.currentRepoInfo,lastModified:this.props.lastModified,latestContributor:this.props.latestContributor,onLinkClick:this.props.onLinkClick}):"list"==t?(0,m.jsx)(eg,{path:this.props.path,repoID:this.props.repoID,currentRepoInfo:this.props.currentRepoInfo,isGroupOwnedRepo:this.props.isGroupOwnedRepo,userPerm:this.props.userPerm,enableDirPrivateShare:this.props.enableDirPrivateShare,isRepoInfoBarShow:this.props.isRepoInfoBarShow,usedRepoTags:this.props.usedRepoTags,updateUsedRepoTags:this.props.updateUsedRepoTags,isDirentListLoading:this.props.isDirentListLoading,direntList:this.props.direntList,fullDirentList:this.props.fullDirentList,sortBy:this.props.sortBy,sortOrder:this.props.sortOrder,sortItems:this.props.sortItems,onAddFolder:this.props.onAddFolder,onAddFile:this.props.onAddFile,onItemClick:this.props.onItemClick,onItemSelected:this.props.onItemSelected,onItemDelete:this.props.onItemDelete,onItemRename:this.props.onItemRename,onItemMove:this.props.onItemMove,onItemCopy:this.props.onItemCopy,onItemConvert:this.props.onItemConvert,onDirentClick:this.props.onDirentClick,updateDirent:this.props.updateDirent,isAllItemSelected:this.props.isAllItemSelected,onAllItemSelected:this.props.onAllItemSelected,selectedDirentList:this.props.selectedDirentList,onItemsMove:this.props.onItemsMove,onItemsCopy:this.props.onItemsCopy,onItemsDelete:this.props.onItemsDelete,repoTags:this.props.repoTags,onFileTagChanged:this.props.onFileTagChanged,showDirentDetail:this.props.showDirentDetail,getMenuContainerSize:this.getMenuContainerSize}):(0,m.jsx)(hg,{path:this.props.path,repoID:this.props.repoID,currentRepoInfo:this.props.currentRepoInfo,isGroupOwnedRepo:this.props.isGroupOwnedRepo,userPerm:this.props.userPerm,enableDirPrivateShare:this.props.enableDirPrivateShare,onRenameNode:this.props.onRenameNode,isRepoInfoBarShow:this.props.isRepoInfoBarShow,repoTags:this.props.repoTags,usedRepoTags:this.props.usedRepoTags,updateUsedRepoTags:this.props.updateUsedRepoTags,isDirentListLoading:this.props.isDirentListLoading,direntList:this.props.direntList,fullDirentList:this.props.fullDirentList,selectedDirentList:this.props.selectedDirentList,onSelectedDirentListUpdate:this.props.onSelectedDirentListUpdate,onAddFile:this.props.onAddFile,onItemClick:this.props.onItemClick,onItemDelete:this.props.onItemDelete,onItemMove:this.props.onItemMove,onItemCopy:this.props.onItemCopy,onItemConvert:this.props.onItemConvert,onItemsMove:this.props.onItemsMove,onItemsCopy:this.props.onItemsCopy,onItemsDelete:this.props.onItemsDelete,updateDirent:this.props.updateDirent,onAddFolder:this.props.onAddFolder,showDirentDetail:this.props.showDirentDetail,onGridItemClick:this.props.onDirentClick,isDirentDetailShow:this.props.isDirentDetailShow,onItemRename:this.props.onItemRename,onFileTagChanged:this.props.onFileTagChanged,getMenuContainerSize:this.getMenuContainerSize})})]})}}])}(s.Component),mg=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onMoveToggle=function(){n.setState({isMoveDialogShow:!n.state.isMoveDialogShow})},n.onCopyToggle=function(){n.setState({isCopyDialogShow:!n.state.isCopyDialogShow})},n.onItemsDelete=function(){n.props.onItemsDelete()},n.onItemsDownload=function(){var e=n.props,t=e.path,r=e.repoID,o=e.selectedDirentList;if(o.length){if(1===o.length&&!o[0].isDir()){var i=f.Aq.joinPath(t,o[0].name),a=Hm.A.getUrl({type:"download_file_url",repoID:r,filePath:i});return void(location.href=a)}if(h.B$){var s=n.props.selectedDirentList.map((function(e){return e.name}));k.e.zipDownload(r,t,s).then((function(e){var t=e.data.zip_token;location.href="".concat(h.IX,"zip/").concat(t)})).catch((function(e){var t=f.Aq.getErrorMsg(e);n.setState({isLoading:!1,errorMsg:t})}))}else n.setState({isZipDialogOpen:!0})}},n.closeZipDialog=function(){n.setState({isZipDialogOpen:!1})},n.checkDuplicatedName=function(e){return f.Aq.checkDuplicatedNameInList(n.props.direntList,e)},n.onItemRename=function(e){var t=n.props.selectedDirentList[0];n.props.onItemRename(t,e)},n.onPermissionItem=function(){n.setState({showLibContentViewDialogs:!n.state.showLibContentViewDialogs,isPermissionDialogOpen:!n.state.isPermissionDialogOpen})},n.onStartRevise=function(e){var t=n.props.repoID,r=n.getDirentPath(e);k.e.sdocStartRevise(t,r).then((function(e){var n=h.Yc+"lib/"+t+"/file"+f.Aq.encodePath(e.data.file_path);window.open(n)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.getDirentMenuList=function(e){var t=n.props.isRepoOwner,r=n.props.currentRepoInfo,o=f.Aq.getDirentOperationList(t,r,e,!0),i=["Move","Copy","Delete","Download"];return o="dir"==e.type?o.filter((function(e,t){return-1==i.indexOf(e.key)&&"Divider"!=e})):o.filter((function(e,t){return-1==i.indexOf(e.key)}))},n.onMenuItemClick=function(e){var t=n.props.selectedDirentList[0];switch(e){case"Share":n.setState({showLibContentViewDialogs:!0,showShareDialog:!0});break;case"Rename":n.setState({showLibContentViewDialogs:!0,isRenameDialogOpen:!0});break;case"Permission":n.onPermissionItem();break;case"Tags":n.listFileTags(t);break;case"Lock":n.lockFile(t);break;case"Unlock":n.unlockFile(t);break;case"History":n.onHistory(t);break;case"Access Log":n.onAccessLog(t);break;case"Properties":n.props.showDirentDetail("info");break;case"Open via Client":n.onOpenViaClient(t)}},n.lockFile=function(e){var t=n.getDirentPath(e);k.e.lockfile(n.props.repoID,t).then((function(t){t.data.is_locked&&(n.props.updateDirent(e,"is_locked",!0),n.props.updateDirent(e,"locked_by_me",!0),n.props.updateDirent(e,"lock_owner_name",h.UU),n.props.unSelectDirent())})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.unlockFile=function(e){var t=n.getDirentPath(e);k.e.unlockfile(n.props.repoID,t).then((function(t){t.data.is_locked||(n.props.updateDirent(e,"is_locked",!1),n.props.updateDirent(e,"locked_by_me",!1),n.props.updateDirent(e,"lock_owner_name",""),n.props.unSelectDirent())})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.onOpenViaClient=function(e){var t=n.getDirentPath(e),r=Hm.A.getUrl({type:"open_via_client",repoID:n.props.repoID,filePath:t});location.href=r},n.onHistory=function(e){var t=n.getDirentPath(e),r=Hm.A.getUrl({type:"file_revisions",repoID:n.props.repoID,filePath:t});location.href=r},n.onAccessLog=function(e){var t=n.getDirentPath(e),r=h.Yc+"repo/file-access/"+n.props.repoID+"/?p="+encodeURIComponent(t);window.open(r)},n.toggleCancel=function(){n.setState({showLibContentViewDialogs:!1,showShareDialog:!1,showEditFileTagDialog:!1,isRenameDialogOpen:!1,isPermissionDialogOpen:!1})},n.listFileTags=function(e){var t=n.getDirentPath(e);k.e.listFileTags(n.props.repoID,t).then((function(e){for(var t=e.data.file_tags,r=0,o=t.length;r<o;r++)t[r].id=t[r].file_tag_id;n.setState({fileTagList:t,showLibContentViewDialogs:!0,showEditFileTagDialog:!0})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.onMenuFileTagChanged=function(){n.listFileTags(n.props.selectedDirentList[0]);for(var e=n.props.selectedDirentList.length,t=0;t<e;t++){var r=n.props.selectedDirentList[t],o=n.getDirentPath(r);n.props.onFilesTagChanged(r,o)}},n.getDirentPath=function(e){if(e)return f.Aq.joinPath(n.props.path,e.name)},n.state={isZipDialogOpen:!1,isMoveDialogShow:!1,isCopyDialogShow:!1,isMultipleOperation:!0,showLibContentViewDialogs:!1,showShareDialog:!1,showEditFileTagDialog:!1,fileTagList:[],multiFileTagList:[],isRenameDialogOpen:!1,isPermissionDialogOpen:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.repoID,n=e.repoTags,r=e.userPerm,o=e.selectedDirentList,i=o[0],a=o.length,l=this.getDirentPath(i),c=f.Aq.getUserPermission(r),u=c.isCustomPermission,d=c.customPermission,p=!1,g=!1,v=!1,y=!1;switch(r){case"rw":case"admin":p=!0,g=!0,v=!0,y=!0;break;case"cloud-edit":p=!0,g=!0,v=!0;break;case"r":g=!0,y=!0}if(u){var x=d.permission;p=x.modify,g=x.copy,y=x.download,v=x.delete}return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsxs)("div",{className:"selected-dirents-toolbar",children:[(0,m.jsxs)("span",{className:"cur-view-path-btn px-2",onClick:this.props.unSelectDirent,children:[(0,m.jsx)("span",{className:"sf3-font-x-01 sf3-font mr-2","aria-label":(0,h.AP)("Unselect"),title:(0,h.AP)("Unselect")}),(0,m.jsxs)("span",{children:[a," ",(0,h.AP)("selected")]})]}),p&&(0,m.jsx)("span",{className:"cur-view-path-btn",onClick:this.onMoveToggle,children:(0,m.jsx)("span",{className:"sf3-font-move1 sf3-font","aria-label":(0,h.AP)("Move"),title:(0,h.AP)("Move")})}),g&&(0,m.jsx)("span",{className:"cur-view-path-btn",onClick:this.onCopyToggle,children:(0,m.jsx)("span",{className:"sf3-font-copy1 sf3-font","aria-label":(0,h.AP)("Copy"),title:(0,h.AP)("Copy")})}),v&&(0,m.jsx)("span",{className:"cur-view-path-btn",onClick:this.onItemsDelete,children:(0,m.jsx)("span",{className:"sf3-font-delete1 sf3-font","aria-label":(0,h.AP)("Delete"),title:(0,h.AP)("Delete")})}),y&&(0,m.jsx)("span",{className:"cur-view-path-btn",onClick:this.onItemsDownload,children:(0,m.jsx)("span",{className:"sf3-font-download1 sf3-font","aria-label":(0,h.AP)("Download"),title:(0,h.AP)("Download")})}),1===a&&(0,m.jsx)(Qf.A,{item:this.props.selectedDirentList[0],toggleClass:"cur-view-path-btn sf3-font-more-vertical sf3-font",onMenuItemClick:this.onMenuItemClick,getMenuList:this.getDirentMenuList})]}),this.state.isMoveDialogShow&&(0,m.jsx)(Cm,{path:this.props.path,repoID:this.props.repoID,repoEncrypted:this.props.repoEncrypted,isMultipleOperation:this.state.isMultipleOperation,selectedDirentList:this.props.selectedDirentList,onItemsMove:this.props.onItemsMove,onCancelMove:this.onMoveToggle}),this.state.isCopyDialogShow&&(0,m.jsx)(Am,{path:this.props.path,repoID:this.props.repoID,repoEncrypted:this.props.repoEncrypted,selectedDirentList:this.props.selectedDirentList,isMultipleOperation:this.state.isMultipleOperation,onItemsCopy:this.props.onItemsCopy,onCancelCopy:this.onCopyToggle}),this.state.isZipDialogOpen&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(Gm.A,{repoID:this.props.repoID,path:this.props.path,target:this.props.selectedDirentList.map((function(e){return e.name})),toggleDialog:this.closeZipDialog})}),this.state.showLibContentViewDialogs&&(0,m.jsxs)(s.Fragment,{children:[this.state.showShareDialog&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(Je.A,{itemType:i.type,itemName:i.name,itemPath:l,userPerm:i.permission,repoID:t,repoEncrypted:this.props.repoEncrypted,enableDirPrivateShare:this.props.enableDirPrivateShare,isGroupOwnedRepo:this.props.isGroupOwnedRepo,toggleDialog:this.toggleCancel})}),this.state.isRenameDialogOpen&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(ag,{dirent:i,onRename:this.onItemRename,checkDuplicatedName:this.checkDuplicatedName,toggleCancel:this.toggleCancel})}),this.state.isPermissionDialogOpen&&(0,m.jsx)(ne.A,{children:(0,m.jsx)($t,{toggleDialog:this.toggleCancel,repoID:t,folderPath:l,folderName:i.name,isDepartmentRepo:this.props.isGroupOwnedRepo})}),this.state.showEditFileTagDialog&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(xr,{repoID:t,repoTags:n,filePath:l,fileTagList:this.state.fileTagList,toggleCancel:this.toggleCancel,onFileTagChanged:this.onMenuFileTagChanged})})]})]})}}])}(s.Component),gg=mg,vg=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onPathClick=function(e){n.props.onMainNavBarClick(e)},n.onItemClick=function(e){n.props.onItemClick(e)},n.onDirentClick=function(e,t){n.setState({currentDirent:e&&e.isActive?null:e}),n.props.onDirentClick(e,t)},n.onItemSelected=function(e){n.setState({currentDirent:e&&e.isActive?null:e}),n.props.onItemSelected(e)},n.onItemDelete=function(e){n.checkCurrentDirent(e),n.props.onItemDelete(e)},n.onItemMove=function(e,t,r,o){n.checkCurrentDirent(t),n.props.onItemMove(e,t,r,o)},n.checkCurrentDirent=function(e){var t=n.state.currentDirent;t&&e.name===t.name&&n.setState({currentDirent:null})},n.onItemsScroll=function(e){var t=e.target;0!==t.scrollTop&&t.scrollTop+t.clientHeight+1>=t.scrollHeight&&n.props.onListContainerScroll()},n.state={currentDirent:null,hasSelectedFile:!1},n.errMessage=(0,m.jsx)("div",{className:"message err-tip",children:(0,h.AP)("Folder does not exist.")}),n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){(e.path===this.props.path&&e.updateDetail===this.props.updateDetail||this.setState({currentDirent:null}),this.state.hasSelectedFile)||e.isDirentSelected&&this.setState({hasSelectedFile:!0})}},{key:"render",value:function(){var e=f.Aq.isDesktop(),t=this.props,n=t.path,r=t.repoID,o=t.usedRepoTags,i=t.isDirentSelected,a=this.state.hasSelectedFile,s=!1;return"/"===n&&e&&0!==o.length&&(s=!0),(0,m.jsxs)("div",{className:"cur-view-container",children:["read-only"===this.props.currentRepoInfo.status&&(0,m.jsx)("div",{className:"readonly-tip-message",children:(0,h.AP)("This library has been set to read-only by admin and cannot be updated.")}),(0,m.jsxs)("div",{className:"cur-view-path lib-cur-view-path",children:[(0,m.jsx)("div",{className:D()("cur-view-path-left",{"w-100":!e,"animation-children":a}),children:i?(0,m.jsx)(gg,{repoID:this.props.repoID,path:this.props.path,userPerm:this.props.userPerm,repoEncrypted:this.props.repoEncrypted,repoTags:this.props.repoTags,selectedDirentList:this.props.selectedDirentList,direntList:this.props.direntList,onItemsMove:this.props.onItemsMove,onItemsCopy:this.props.onItemsCopy,onItemsDelete:this.props.onItemsDelete,onItemRename:this.props.onItemRename,isRepoOwner:this.props.isRepoOwner,currentRepoInfo:this.props.currentRepoInfo,enableDirPrivateShare:this.props.enableDirPrivateShare,updateDirent:this.props.updateDirent,unSelectDirent:this.props.unSelectDirent,onFilesTagChanged:this.props.onFilesTagChanged,showShareBtn:this.props.showShareBtn,isGroupOwnedRepo:this.props.isGroupOwnedRepo,showDirentDetail:this.props.showDirentDetail,currentMode:this.props.currentMode,switchViewMode:this.props.switchViewMode}):(0,m.jsx)(wr,{currentRepoInfo:this.props.currentRepoInfo,repoID:r,repoName:this.props.currentRepoInfo.repo_name,repoEncrypted:this.props.repoEncrypted,isGroupOwnedRepo:this.props.isGroupOwnedRepo,pathPrefix:this.props.pathPrefix,currentPath:this.props.path,userPerm:this.props.userPerm,isViewFile:this.props.isViewFile,onTabNavClick:this.props.onTabNavClick,onPathClick:this.onPathClick,fileTags:this.props.fileTags,direntList:this.props.direntList,sortBy:this.props.sortBy,sortOrder:this.props.sortOrder,sortItems:this.props.sortItems,toggleTreePanel:this.props.toggleTreePanel,enableDirPrivateShare:this.props.enableDirPrivateShare,showShareBtn:this.props.showShareBtn,onAddFolder:this.props.onAddFolder,onAddFile:this.props.onAddFile,onUploadFile:this.props.onUploadFile,onUploadFolder:this.props.onUploadFolder,fullDirentList:this.props.fullDirentList,filePermission:this.props.filePermission,onFileTagChanged:this.props.onToolbarFileTagChanged,repoTags:this.props.repoTags,onItemMove:this.props.onItemMove,isDesktop:e})}),e&&(0,m.jsx)("div",{className:"cur-view-path-right py-1",children:(0,m.jsx)(Ed,{repoID:r,repoName:this.props.currentRepoInfo.repo_name,userPerm:this.props.userPerm,currentPath:n,updateUsedRepoTags:this.props.updateUsedRepoTags,onDeleteRepoTag:this.props.onDeleteRepoTag,currentMode:this.props.currentMode,switchViewMode:this.props.switchViewMode,isCustomPermission:this.props.isCustomPermission,sortBy:this.props.sortBy,sortOrder:this.props.sortOrder,sortItems:this.props.sortItems,viewId:this.props.viewId,viewType:this.props.viewType})})]}),(0,m.jsxs)("div",{className:"cur-view-content lib-content-container",onScroll:this.onItemsScroll,children:[!this.props.pathExist&&this.errMessage,this.props.pathExist&&(0,m.jsx)(fg,{isSidePanelFolded:this.props.isSidePanelFolded,isTreePanelShown:this.props.isTreePanelShown,currentMode:this.props.currentMode,path:this.props.path,repoID:r,currentRepoInfo:this.props.currentRepoInfo,isGroupOwnedRepo:this.props.isGroupOwnedRepo,userPerm:this.props.userPerm,enableDirPrivateShare:this.props.enableDirPrivateShare,isTreeDataLoading:this.props.isTreeDataLoading,treeData:this.props.treeData,currentNode:this.props.currentNode,onNodeClick:this.props.onNodeClick,onNodeCollapse:this.props.onNodeCollapse,onNodeExpanded:this.props.onNodeExpanded,onAddFolderNode:this.props.onAddFolder,onAddFileNode:this.props.onAddFile,onRenameNode:this.props.onRenameNode,onDeleteNode:this.props.onDeleteNode,isViewFile:this.props.isViewFile,isFileLoading:this.props.isFileLoading,isFileLoadedErr:this.props.isFileLoadedErr,hash:this.props.hash,filePermission:this.props.filePermission,content:this.props.content,viewId:this.props.viewId,lastModified:this.props.lastModified,latestContributor:this.props.latestContributor,onLinkClick:this.props.onLinkClick,isRepoInfoBarShow:s,repoTags:this.props.repoTags,usedRepoTags:this.props.usedRepoTags,updateUsedRepoTags:this.props.updateUsedRepoTags,isDirentListLoading:this.props.isDirentListLoading,direntList:this.props.direntList,fullDirentList:this.props.fullDirentList,sortBy:this.props.sortBy,sortOrder:this.props.sortOrder,sortItems:this.props.sortItems,onAddFolder:this.props.onAddFolder,onAddFile:this.props.onAddFile,onItemClick:this.onItemClick,onItemSelected:this.onItemSelected,onItemDelete:this.onItemDelete,onItemRename:this.props.onItemRename,onItemMove:this.onItemMove,onItemCopy:this.props.onItemCopy,onItemConvert:this.props.onItemConvert,onDirentClick:this.onDirentClick,updateDirent:this.props.updateDirent,isAllItemSelected:this.props.isAllDirentSelected,onAllItemSelected:this.props.onAllDirentSelected,selectedDirentList:this.props.selectedDirentList,onSelectedDirentListUpdate:this.props.onSelectedDirentListUpdate,onItemsMove:this.props.onItemsMove,onItemsCopy:this.props.onItemsCopy,onItemsDelete:this.props.onItemsDelete,onFileTagChanged:this.props.onFileTagChanged,showDirentDetail:this.props.showDirentDetail,onItemsScroll:this.onItemsScroll,isDirentDetailShow:this.props.isDirentDetailShow}),this.props.isDirentDetailShow&&(0,m.jsx)(fm,{path:n,repoID:r,currentRepoInfo:this.props.currentRepoInfo,dirent:this.state.currentDirent,repoTags:this.props.repoTags,fileTags:this.props.isViewFile?this.props.fileTags:[],onFileTagChanged:this.props.onFileTagChanged,onClose:this.props.closeDirentDetail})]})]})}}])}(s.Component),yg=n(68238),xg=n.n(yg),Ag="uploading",Cg="error",bg="isSaving",wg="uploaded",Sg=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onUploadCancel=function(e){e.preventDefault(),n.props.onUploadCancel(n.props.resumableFile)},n.onUploadRetry=function(e){e.preventDefault(),n.props.onUploadRetry(n.props.resumableFile)},n.formatFileSize=function(e){return"number"!==typeof e?"":e>=1e9?(e/1e9).toFixed(1)+" G":e>=1e6?(e/1e6).toFixed(1)+" M":e>=1e3?(e/1e3).toFixed(1)+" K":e.toFixed(1)+" B"},n.state={uploadState:Ag},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.resumableFile,n=Ag;t.error?n=Cg:(0!==t.remainingTime||t.isSaved||(n=bg),t.isSaved&&(n=wg)),this.setState({uploadState:n})}},{key:"render",value:function(){var e=this.props.resumableFile,t=Math.round(100*e.progress()),n=e.error;return(0,m.jsxs)("tr",{className:"file-upload-item",children:[(0,m.jsx)("td",{className:"upload-name",children:(0,m.jsx)("div",{className:"ellipsis",children:e.newFileName})}),(0,m.jsx)("td",{children:(0,m.jsx)("span",{className:"file-size",children:this.formatFileSize(e.size)})}),(0,m.jsxs)("td",{className:"upload-progress",children:[(this.state.uploadState===Ag||this.state.uploadState===bg)&&(0,m.jsxs)(s.Fragment,{children:[e.size>=1e8&&(0,m.jsxs)(s.Fragment,{children:[e.isUploading()&&(0,m.jsxs)("div",{className:"progress-container",children:[(0,m.jsx)("div",{className:"progress",children:(0,m.jsx)("div",{className:"progress-bar",role:"progressbar",style:{width:"".concat(t,"%")},"aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"100"})}),-1===e.remainingTime&&(0,m.jsx)("div",{className:"progress-text",children:(0,h.AP)("Preparing to upload...")}),e.remainingTime>0&&(0,m.jsxs)("div",{className:"progress-text",children:[(0,h.AP)("Remaining")," ",f.Aq.formatTime(e.remainingTime)]}),0===e.remainingTime&&(0,m.jsx)("div",{className:"progress-text",children:(0,h.AP)("Saving...")})]}),!e.isUploading()&&(0,m.jsx)("div",{className:"progress-container d-flex align-items-center",children:(0,m.jsx)("div",{className:"progress",children:(0,m.jsx)("div",{className:"progress-bar",role:"progressbar",style:{width:"".concat(t,"%")},"aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"100"})})})]}),e.size<1e8&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:"progress-container d-flex align-items-center",children:(0,m.jsx)("div",{className:"progress",children:(0,m.jsx)("div",{className:"progress-bar",role:"progressbar",style:{width:"".concat(t,"%")},"aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"100"})})}),this.state.uploadState===Ag&&(0,m.jsxs)(m.Fragment,{children:[0==t&&(0,m.jsx)("p",{className:"progress-text mb-0",children:(0,h.AP)("Waiting...")}),t>0&&(0,m.jsx)("p",{className:"progress-text mb-0",children:"".concat((0,h.AP)("Uploading...")," ").concat(t,"%")})]}),this.state.uploadState===bg&&(0,m.jsx)("p",{className:"progress-text mb-0",children:(0,h.AP)("Saving...")})]})]}),this.state.uploadState===wg&&(0,m.jsxs)("div",{className:"d-flex align-items-center",children:[(0,m.jsx)("span",{className:"upload-success-icon sf2-icon-tick mr-2"}),(0,m.jsx)("span",{className:"upload-success-msg",children:(0,h.AP)("Uploaded")})]}),this.state.uploadState===Cg&&(0,m.jsxs)("div",{className:"d-flex align-items-center",children:[(0,m.jsx)("span",{className:"upload-failure-icon sf3-font sf3-font-info mr-2"}),(0,m.jsx)("span",{className:"upload-failure-msg",dangerouslySetInnerHTML:{__html:n}})]})]}),(0,m.jsx)("td",{className:"upload-operation",children:(0,m.jsxs)(s.Fragment,{children:[this.state.uploadState===Ag&&(0,m.jsx)("a",{href:"#",onClick:this.onUploadCancel,role:"button",children:(0,h.AP)("Cancel")}),this.state.uploadState===Cg&&(0,m.jsx)("a",{href:"#",onClick:this.onUploadRetry,role:"button",children:(0,h.AP)("Retry")})]})})]})}}])}(s.Component),Dg=function(e){function t(){return(0,r.A)(this,t),(0,i.A)(this,t,arguments)}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.file;return(0,m.jsxs)("tr",{className:"file-upload-item",children:[(0,m.jsx)("td",{className:"upload-name",children:(0,m.jsx)("div",{className:"ellipsis",title:e.name,children:e.name})}),(0,m.jsx)("td",{children:f.Aq.bytesToSize(e.size)}),(0,m.jsx)("td",{children:(0,m.jsxs)("div",{className:"d-flex align-items-center",children:[(0,m.jsx)("span",{className:"upload-failure-icon sf3-font sf3-font-info mr-2"}),(0,m.jsx)("span",{className:"upload-failure-msg",children:(0,h.AP)("File too large")})]})}),(0,m.jsx)("td",{})]})}}])}(s.Component),kg=Dg,Mg=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onCancelAllUploading=function(){n.props.onCancelAllUploading()},n.onMinimizeUpload=function(e){e.nativeEvent.stopImmediatePropagation(),n.setState({isMinimized:!n.state.isMinimized})},n.onCloseUpload=function(e){e.nativeEvent.stopImmediatePropagation(),n.props.onCloseUploadDialog()},n.state={isMinimized:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e,t=this,n=this.props,r=n.totalProgress,o=n.retryFileList,i=n.uploadBitrate,a=n.uploadFileList,s=n.forbidUploadFileList,l=n.isUploading,c=(0,h.AP)("{uploaded_files_num}/{all_files_num} Files").replace("{uploaded_files_num}",a.filter((function(e){return e.isSaved})).length).replace("{all_files_num}",a.length);if(!l){var u=a.filter((function(e){return e.error})).length+s.length;u>0&&(e=(0,h.AP)("{failed_files_num} file(s) failed to upload").replace("{failed_files_num}",u))}return(0,m.jsxs)("div",{className:"uploader-list-view mw-100",style:{height:this.state.isMinimized?document.querySelector(".uploader-list-header").offsetHeight:"20rem"},children:[(0,m.jsxs)("div",{className:"uploader-list-header flex-shrink-0",children:[(0,m.jsx)("div",{children:l?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("span",{children:(0,h.AP)("File Uploading...")}),(0,m.jsx)("span",{className:"ml-2",children:"".concat(r,"% (").concat(f.Aq.formatBitRate(i),")")}),(0,m.jsx)("div",{className:"progress",children:(0,m.jsx)("div",{className:"progress-bar",role:"progressbar",style:{width:"".concat(r,"%")},"aria-valuenow":r,"aria-valuemin":"0","aria-valuemax":"100"})})]}):(0,m.jsx)(m.Fragment,{children:e?(0,m.jsx)("p",{className:"m-0 error",children:e}):(0,m.jsx)("p",{className:"m-0",children:(0,h.AP)("All files uploaded")})})}),(0,m.jsxs)("div",{className:"upload-dialog-op-container",children:[(0,m.jsx)("span",{className:"sf2-icon-minus upload-dialog-op",onClick:this.onMinimizeUpload}),!l&&(0,m.jsx)("span",{className:"sf2-icon-x1 upload-dialog-op",onClick:this.onCloseUpload})]})]}),(0,m.jsxs)("div",{className:"uploader-list-content",children:[(0,m.jsxs)("div",{className:"d-flex justify-content-between align-items-center border-bottom uploader-content-bar",children:[a.length>0&&(0,m.jsx)("span",{children:c}),(0,m.jsxs)("div",{className:"ml-auto",children:[(0,m.jsx)("button",{className:"btn btn-lg border-0 background-transparent px-0",onClick:this.props.onUploadRetryAll,disabled:0==o.length,children:(0,h.AP)("Retry All")}),(0,m.jsx)("button",{className:"btn btn-lg border-0 background-transparent px-0 ml-3",onClick:this.props.onCancelAllUploading,disabled:!l,children:(0,h.AP)("Cancel All")})]})]}),(0,m.jsxs)("table",{className:"table-thead-hidden",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"40%",children:(0,h.AP)("name")}),(0,m.jsx)("th",{width:"15%",children:(0,h.AP)("size")}),(0,m.jsx)("th",{width:"30%",children:(0,h.AP)("progress")}),(0,m.jsx)("th",{width:"15%",children:(0,h.AP)("state")})]})}),(0,m.jsxs)("tbody",{children:[this.props.forbidUploadFileList.map((function(e,t){return(0,m.jsx)(kg,{file:e},t)})),this.props.uploadFileList.map((function(e,n){return(0,m.jsx)(Sg,{resumableFile:e,onUploadCancel:t.props.onUploadCancel,onUploadRetry:t.props.onUploadRetry},n)}))]})]})]})]})}}])}(s.Component),jg=function(e){function t(){var e;(0,r.A)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=(0,i.A)(this,t,[].concat(o))).toggle=function(t){t.nativeEvent.stopImmediatePropagation(),e.props.cancelFileUpload()},e.replaceRepetitionFile=function(t){t.nativeEvent.stopImmediatePropagation(),e.props.replaceRepetitionFile()},e.uploadFile=function(t){t.nativeEvent.stopImmediatePropagation(),e.props.uploadFile()},e}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.currentResumableFile.fileName;return(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.toggle,children:[(0,m.jsx)(I.A,{toggle:this.toggle,children:(0,m.jsx)("span",{children:(0,h.AP)("Replace file {filename}?").replace("{filename}",e)})}),(0,m.jsxs)(_.A,{children:[(0,m.jsx)("p",{children:(0,h.AP)("A file with the same name already exists in this folder.")}),(0,m.jsx)("p",{children:(0,h.AP)("Replacing it will overwrite its content.")})]}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(O.A,{color:"primary",onClick:this.replaceRepetitionFile,children:(0,h.AP)("Replace")}),(0,m.jsx)(O.A,{color:"primary",onClick:this.uploadFile,children:(0,h.AP)("Don't replace")}),(0,m.jsx)(O.A,{color:"secondary",onClick:this.toggle,children:(0,h.AP)("Cancel")})]})]})}}])}(s.Component),Ig=jg,_g=(n(89183),function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).componentWillUnmount=function(){window.onbeforeunload=null,!0===n.props.dragAndDrop&&n.resumable.disableDropOnDocument()},n.onbeforeunload=function(){if(window.uploader&&window.uploader.isUploadProgressDialogShow&&100!==window.uploader.totalProgress)return""},n.bindCallbackHandler=function(){var e=n.props,t=e.minFileSizeErrorCallback,r=e.fileTypeErrorCallback;n.maxFilesErrorCallback&&(n.resumable.opts.maxFilesErrorCallback=n.maxFilesErrorCallback),t&&(n.resumable.opts.minFileSizeErrorCallback=n.props.minFileSizeErrorCallback),n.maxFileSizeErrorCallback&&(n.resumable.opts.maxFileSizeErrorCallback=n.maxFileSizeErrorCallback),r&&(n.resumable.opts.fileTypeErrorCallback=n.props.fileTypeErrorCallback)},n.bindEventHandler=function(){n.resumable.on("chunkingComplete",n.onChunkingComplete.bind(n)),n.resumable.on("fileAdded",n.onFileAdded.bind(n)),n.resumable.on("filesAddedComplete",n.filesAddedComplete.bind(n)),n.resumable.on("fileProgress",n.onFileProgress.bind(n)),n.resumable.on("fileSuccess",n.onFileUploadSuccess.bind(n)),n.resumable.on("progress",n.onProgress.bind(n)),n.resumable.on("complete",n.onComplete.bind(n)),n.resumable.on("pause",n.onPause.bind(n)),n.resumable.on("fileRetry",n.onFileRetry.bind(n)),n.resumable.on("fileError",n.onFileError.bind(n)),n.resumable.on("error",n.onError.bind(n)),n.resumable.on("beforeCancel",n.onBeforeCancel.bind(n)),n.resumable.on("cancel",n.onCancel.bind(n)),n.resumable.on("dragstart",n.onDragStart.bind(n))},n.maxFilesErrorCallback=function(e,t){var n=h.YX,r=(0,h.AP)("Please upload no more than {maxFiles} files at a time.");r=r.replace("{maxFiles}",n),j.A.danger(r)},n.maxFileSizeErrorCallback=function(e){var t=n.state.forbidUploadFileList;t.push(e),n.setState({forbidUploadFileList:t})},n.onChunkingComplete=function(e){var t="/"===n.props.path?"/":n.props.path+"/",r=e.fileName,o=e.relativePath,i=r===o;if(e.formData={},i)e.formData={parent_dir:t};else{var a=o.slice(0,o.lastIndexOf("/")+1);e.formData={parent_dir:t,relative_path:a}}},n.onFileAdded=function(e,t){var r=n.props.isCustomPermission;if(e.fileName===e.relativePath&&1===t.length){var o=!1;if(!r)for(var i=n.props.direntList,a=0;a<i.length;a++)if("file"===i[a].type&&i[a].name===e.fileName){o=!0;break}if(o)n.setState({isUploadRemindDialogShow:!0,currentResumableFile:e});else{n.setUploadFileList(n.resumable.files);var s=n.props,l=s.repoID,c=s.path;k.e.getFileServerUploadLink(l,c).then((function(t){n.resumable.opts.target=t.data+"?ret-json=1",n.resumableUpload(e)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))}}else if(n.setUploadFileList(n.resumable.files),!n.isUploadLinkLoaded){n.isUploadLinkLoaded=!0;var u=n.props,d=u.repoID,p=u.path;k.e.getFileServerUploadLink(d,p).then((function(e){n.resumable.opts.target=e.data+"?ret-json=1",n.resumable.upload()})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))}},n.resumableUpload=function(e){var t=n.props,r=t.repoID,o=t.path;k.e.getFileUploadedBytes(r,o,e.fileName).then((function(t){var r=t.data.uploadedBytes,o=1024*parseInt(h.QV)*1024||1048576,i=Math.floor(r/o);e.markChunksCompleted(i),n.resumable.upload()})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.filesAddedComplete=function(e,t){n.state.forbidUploadFileList.length>0&&0===t.length&&n.setState({isUploadProgressDialogShow:!0,totalProgress:100})},n.setUploadFileList=function(){var e=n.resumable.files;n.setState({uploadFileList:e,isUploadProgressDialogShow:!0}),f.Aq.registerGlobalVariable("uploader","isUploadProgressDialogShow",!0)},n.onFileProgress=function(e){var t=n.getBitrate(),r=n.state.uploadFileList.map((function(n){if(n.uniqueIdentifier===e.uniqueIdentifier&&t){var r=8*(n.size-n.size*n.progress()),o=Math.floor(r/t);n.remainingTime=o}return n}));n.setState({uploadBitrate:t,uploadFileList:r})},n.getBitrate=function(){var e=0,t=0,r=(new Date).getTime();if(n.resumable.files.forEach((function(t){e+=t.progress()*t.size})),n.timestamp){var o=r-n.timestamp;if(o<n.bitrateInterval)return n.state.uploadBitrate;(e<n.loaded||0===n.loaded)&&(n.loaded=e),t=(e-n.loaded)*(1e3/o)*8}return n.timestamp=r,n.loaded=e,t},n.onProgress=function(){var e=Math.round(100*n.resumable.progress());n.setState({totalProgress:e}),f.Aq.registerGlobalVariable("uploader","totalProgress",e)},n.onFileUploadSuccess=function(e,t){var r=e.formData,o=(new Date).getTime()/1e3;if(t=r.replace?t:JSON.parse(t)[0],r.relative_path){var i=r.relative_path,a=i.slice(0,i.indexOf("/")),s={id:t.id,name:a,type:"dir",mtime:o};n.notifiedFolders.some((function(e){return e.name===s.name}))||(n.notifiedFolders.push(s),n.props.onFileUploadSuccess(s));var l=n.state.uploadFileList.map((function(n){return n.uniqueIdentifier===e.uniqueIdentifier&&(n.newFileName=i+t.name,n.isSaved=!0),n}));n.setState({uploadFileList:l})}else if(r.replace){var c=e.fileName,u={id:t,name:c,type:"file",mtime:o};n.props.onFileUploadSuccess(u);var d=n.state.uploadFileList.map((function(t){return t.uniqueIdentifier===e.uniqueIdentifier&&(t.newFileName=c,t.isSaved=!0),t}));n.setState({uploadFileList:d})}else{var p={id:t.id,type:"file",name:t.name,size:t.size,mtime:o};n.props.onFileUploadSuccess(p);var h=n.state.uploadFileList.map((function(n){return n.uniqueIdentifier===e.uniqueIdentifier&&(n.newFileName=t.name,n.isSaved=!0),n}));n.setState({uploadFileList:h})}},n.getFileServerErrorMessage=function(e){return{"File locked by others.":(0,h.AP)("File is locked by others."),"Invalid filename.":(0,h.AP)("Invalid filename."),"File already exists.":(0,h.AP)("File already exists."),"File size is too large.":(0,h.AP)("File size is too large."),"Out of quota.":(0,h.AP)("Out of quota."),"Internal error.":(0,h.AP)("Internal Server Error")}[e]||e},n.onFileError=function(e,t){var r="";if(t){var o=t.replace(/\n/g,"");o=JSON.parse(o),r=n.getFileServerErrorMessage(o.error)}else r=(0,h.AP)("Network error");var i=n.state.uploadFileList.map((function(t){return t.uniqueIdentifier===e.uniqueIdentifier&&(n.state.retryFileList.push(t),t.error=r),t}));n.loaded=0,n.setState({retryFileList:n.state.retryFileList,uploadFileList:i})},n.onComplete=function(){n.notifiedFolders=[],n.isUploadLinkLoaded=!1},n.onPause=function(){},n.onError=function(e){n.isUploadLinkLoaded=!1,f.Aq.registerGlobalVariable("uploader","totalProgress",100)},n.onFileRetry=function(){},n.onBeforeCancel=function(){},n.onCancel=function(){},n.setHeaders=function(e,t){var n=t.offset,r=t.getOpt("chunkSize"),o=0===e.size?1:e.size,i=0!==n?n*r:0,a=Math.min(o,(n+1)*r)-1;return o-t.endByte<r&&!t.getOpt("forceChunkSize")&&(a=o),{Accept:"application/json; text/javascript, */*; q=0.01","Content-Disposition":'attachment; filename="'+encodeURI(e.fileName)+'"',"Content-Range":"bytes "+i+"-"+a+"/"+o}},n.setQuery=function(e){return e.formData},n.generateUniqueIdentifier=function(e){var t=e.webkitRelativePath||e.relativePath||e.fileName||e.name;return ng()(t+new Date)+t},n.onClick=function(e){e.nativeEvent.stopImmediatePropagation(),e.stopPropagation()},n.onFileUpload=function(){n.uploadInput.current.removeAttribute("webkitdirectory"),n.uploadInput.current.click()},n.onFolderUpload=function(){n.uploadInput.current.setAttribute("webkitdirectory","webkitdirectory"),n.uploadInput.current.click()},n.onDragStart=function(){n.uploadInput.current.setAttribute("webkitdirectory","webkitdirectory")},n.onCloseUploadDialog=function(){n.loaded=0,n.resumable.files=[],n.isUploadLinkLoaded=!1,n.setState({isUploadProgressDialogShow:!1,uploadFileList:[],forbidUploadFileList:[]}),f.Aq.registerGlobalVariable("uploader","isUploadProgressDialogShow",!1)},n.onUploadCancel=function(e){var t=n.state.uploadFileList.filter((function(t){return t.uniqueIdentifier!==e.uniqueIdentifier||(t.cancel(),!1)}));n.resumable.isUploading()||(n.setState({totalProgress:100}),n.loaded=0),n.setState({uploadFileList:t})},n.onCancelAllUploading=function(){var e=n.state.uploadFileList.filter((function(e){return!Math.round(1!==e.progress())||(e.cancel(),!1)}));n.loaded=0,n.setState({totalProgress:100,uploadFileList:e}),n.isUploadLinkLoaded=!1},n.onUploadRetry=function(e){k.e.getFileServerUploadLink(n.props.repoID,n.props.path).then((function(t){n.resumable.opts.target=t.data+"?ret-json=1";var r=n.state.retryFileList.filter((function(t){return t.uniqueIdentifier!==e.uniqueIdentifier})),o=n.state.uploadFileList.map((function(t){return t.uniqueIdentifier===e.uniqueIdentifier&&(t.error=null,n.retryUploadFile(t)),t}));n.setState({retryFileList:r,uploadFileList:o})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.onUploadRetryAll=function(){k.e.getFileServerUploadLink(n.props.repoID,n.props.path).then((function(e){n.resumable.opts.target=e.data+"?ret-json=1",n.state.retryFileList.forEach((function(e){e.error=!1,n.retryUploadFile(e)}));var t=n.state.uploadFileList.slice(0);n.setState({retryFileList:[],uploadFileList:t})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.retryUploadFile=function(e){var t=n.props,r=t.repoID,o=t.path,i=e.fileName;if(!(e.fileName===e.relativePath)){var a=e.formData.relative_path;i=("/"===o?o+a:o+"/"+a)+i}e.bootstrap();var s=!1;e.resumableObj.on("chunkingComplete",(function(){s||k.e.getFileUploadedBytes(r,o,i).then((function(t){var n=t.data.uploadedBytes,r=1024*parseInt(h.QV)*1024||1048576,o=Math.floor(n/r);e.markChunksCompleted(o),e.resumableObj.upload()})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)})),s=!0}))},n.replaceRepetitionFile=function(){var e=n.props,t=e.repoID,r=e.path;k.e.getUpdateLink(t,r).then((function(e){n.resumable.opts.target=e.data;var t=n.resumable.files[n.resumable.files.length-1];t.formData.replace=1,t.formData.target_file=t.formData.parent_dir+t.fileName,n.setState({isUploadRemindDialogShow:!1}),n.setUploadFileList(n.resumable.files),n.resumable.upload()})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.uploadFile=function(){var e=n.resumable.files[n.resumable.files.length-1],t=n.props,r=t.repoID,o=t.path;k.e.getFileServerUploadLink(r,o).then((function(t){n.resumable.opts.target=t.data+"?ret-json=1",n.setState({isUploadRemindDialogShow:!1,isUploadProgressDialogShow:!0,uploadFileList:[].concat((0,W.A)(n.state.uploadFileList),[e])},(function(){n.resumable.upload()})),f.Aq.registerGlobalVariable("uploader","isUploadProgressDialogShow",!0)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.cancelFileUpload=function(){n.resumable.files.pop(),n.setState({isUploadRemindDialogShow:!1})},n.state={retryFileList:[],uploadFileList:[],forbidUploadFileList:[],totalProgress:0,isUploadProgressDialogShow:!1,isUploadRemindDialogShow:!1,currentResumableFile:null,uploadBitrate:0},n.uploadInput=s.createRef(),n.notifiedFolders=[],n.timestamp=null,n.loaded=0,n.bitrateInterval=500,window.onbeforeunload=n.onbeforeunload,n.isUploadLinkLoaded=!1,n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.resumable=new(xg())({target:"",query:this.setQuery||{},fileType:this.props.filetypes,maxFiles:h.YX||void 0,maxFileSize:1e3*h.hn*1e3||void 0,testMethod:this.props.testMethod||"post",testChunks:this.props.testChunks||!1,headers:this.setHeaders||{},withCredentials:this.props.withCredentials||!1,chunkSize:1024*parseInt(h.QV)*1024||1048576,simultaneousUploads:this.props.simultaneousUploads||1,fileParameterName:this.props.fileParameterName,generateUniqueIdentifier:this.generateUniqueIdentifier,forceChunkSize:!0,maxChunkRetries:3,minFileSize:0}),this.resumable.assignBrowse(this.uploadInput.current,!0),!0===this.props.dragAndDrop&&this.resumable.enableDropOnDocument(),this.bindCallbackHandler(),this.bindEventHandler()}},{key:"render",value:function(){return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("div",{className:"file-uploader-container",children:(0,m.jsx)("div",{className:"file-uploader",children:(0,m.jsx)("input",{className:"upload-input",type:"file",ref:this.uploadInput,onClick:this.onClick,"aria-label":(0,h.AP)("Upload")})})}),this.state.isUploadRemindDialogShow&&(0,m.jsx)(Ig,{currentResumableFile:this.state.currentResumableFile,replaceRepetitionFile:this.replaceRepetitionFile,uploadFile:this.uploadFile,cancelFileUpload:this.cancelFileUpload}),this.state.isUploadProgressDialogShow&&(0,m.jsx)(Mg,{retryFileList:this.state.retryFileList,uploadFileList:this.state.uploadFileList,forbidUploadFileList:this.state.forbidUploadFileList,totalProgress:this.state.totalProgress,uploadBitrate:this.state.uploadBitrate,onCloseUploadDialog:this.onCloseUploadDialog,onCancelAllUploading:this.onCancelAllUploading,onUploadCancel:this.onUploadCancel,onUploadRetry:this.onUploadRetry,onUploadRetryAll:this.onUploadRetryAll,isUploading:this.resumable.isUploading()})]})}}])}(s.Component));_g.defaultProps={isCustomPermission:!1};var Pg=_g,Ng=n(88002),Og=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).deleteFolder=function(){n.props.deleteFolder(),n.props.toggleDialog()},n.state={sharedToUserCount:0,sharedToGroupCount:0},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.repoID,r=t.path;k.e.getRepoFolderShareInfo(n,r).then((function(t){e.setState({sharedToUserCount:t.data.shared_user_emails.length,sharedToGroupCount:t.data.shared_group_ids.length})}))}},{key:"render",value:function(){var e=this.state,t=e.sharedToUserCount,n=e.sharedToGroupCount,r=this.props,o=r.path,i=r.toggleDialog,a=f.Aq.getFileName(o),s='<span class="op-target">'+f.Aq.HTMLescape(a)+"</span>",l=(0,h.AP)("Are you sure you want to delete %s ?").replace("%s",s),c="";return(t>0||n>0)&&(c=(0,h.AP)("This folder has been shared to {user_amount} user(s) and {group_amount} group(s).").replace("{user_amount}",t).replace("{group_amount}",n)),(0,m.jsxs)(p.A,{isOpen:!0,toggle:i,children:[(0,m.jsx)(I.A,{toggle:i,children:(0,h.AP)("Delete Folder")}),(0,m.jsxs)(_.A,{children:[(0,m.jsx)("p",{dangerouslySetInnerHTML:{__html:l}}),c&&(0,m.jsx)("p",{className:"error",children:c})]}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(O.A,{color:"secondary",onClick:i,children:(0,h.AP)("Cancel")}),(0,m.jsx)(O.A,{color:"primary",onClick:this.deleteFolder,children:(0,h.AP)("Delete")})]})]})}}])}(s.Component),Tg=n(3866),Eg=function(e){function t(e){var n;(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).showDirentDetail=function(e){e?n.setState({direntDetailPanelTab:e},(function(){n.setState({isDirentDetailShow:!0})})):n.setState({direntDetailPanelTab:"",isDirentDetailShow:!0})},n.toggleDirentDetail=function(){n.setState({direntDetailPanelTab:"",isDirentDetailShow:!n.state.isDirentDetailShow})},n.closeDirentDetail=function(){n.setState({isDirentDetailShow:!1,direntDetailPanelTab:""})},n.calculatePara=function(){var e=(0,ln.A)((0,sn.A)().mark((function e(t){var r,o,i,a,s;return(0,sn.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.repoID,o=t.eventBus,n.unsubscribeEvent=o.subscribe(Tg.T.SEARCH_LIBRARY_CONTENT,n.onSearchedClick),i=n.getPathFromLocation(r),e.prev=3,e.next=6,n.fetchRepoInfo(r);case 6:if(a=e.sent,s=a.owner_email.includes("@seafile_group"),n.setState({treeData:sr.A.buildTree(),currentRepoInfo:a,repoName:a.repo_name,libNeedDecrypt:a.lib_need_decrypt,repoEncrypted:a.encrypted,isGroupOwnedRepo:s,path:i}),n.state.isTreePanelShown&&n.loadSidePanel(i),!a.permission.startsWith("custom-")){e.next=13;break}return e.next=13,n.setCustomPermission(r,a.permission);case 13:n.isNeedUpdateHistoryState=!1,a.lib_need_decrypt||n.loadDirData(i),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(3),n.handleError(e.t0);case 20:case"end":return e.stop()}}),e,null,[[3,17]])})));return function(t){return e.apply(this,arguments)}}(),n.getPathFromLocation=function(e){if(new URLSearchParams(window.location.search).get("view"))return"/".concat(R.AT.FILE_EXTENDED_PROPERTIES);var t=window.location.href.split("?")[0],n=(t=decodeURIComponent(t)).slice(t.indexOf(e)+e.length+1);return(n=n.slice(n.indexOf("/"))).length>1&&n.endsWith("/")&&(n=n.slice(0,-1)),n},n.fetchRepoInfo=function(){var e=(0,ln.A)((0,sn.A)().mark((function e(t){var n;return(0,sn.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.e.getRepoInfo(t);case 2:return n=e.sent,e.abrupt("return",new ir.A(n.data));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.setCustomPermission=function(){var e=(0,ln.A)((0,sn.A)().mark((function e(t,n){var r,o;return(0,sn.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.split("-")[1],e.next=3,k.e.getCustomPermission(t,r);case 3:o=e.sent,window.custom_permission=o.data.permission;case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),n.handleError=function(e){var t=(0,h.AP)("Please check the network.");if(e.response)switch(e.response.status){case 403:t=(0,h.AP)("Permission denied");break;case 404:t=(0,h.AP)("Library share permission not found.");break;default:t=(0,h.AP)("Error")}n.setState({isDirentListLoading:!1,errorMsg:t}),j.A.danger(t)},n.onpopstate=function(e){if(e.state&&e.state.key){if("/"===n.state.path)return;n.loadDirentList("/"),n.setState({path:"/",isViewFile:!1})}else if(e.state&&e.state.path){var t=e.state.path;if(n.state.isTreePanelShown&&f.Aq.isMarkdownFile(t))return void n.showFile(t);n.loadDirentList(t),n.setState({path:t,isViewFile:!1})}},n.onRepoUpdateEvent=function(){var e=new Date;if(!(parseFloat(e-n.lastModifyTime)/1e3<=5)){var t=n.props.repoID,r=n.state,o=r.path,i=r.dirID;n.state.isTreePanelShown?n.state.isViewFile?n.updateColumnMarkdownData(o):k.e.dirMetaData(t,o).then((function(e){e.data.id!==i&&n.loadDirentList(o)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)})):k.e.dirMetaData(t,o).then((function(e){e.data.id!==i&&n.loadDirentList(o)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))}},n.updateUsedRepoTags=function(){var e=n.props.repoID;k.e.listRepoTags(e).then((function(e){var t=[],r=[];e.data.repo_tags.forEach((function(e){var n=new or.A(e);t.push(n),n.fileCount>0&&r.push(n)})),n.setState({repoTags:t,usedRepoTags:r})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.updateColumnMarkdownData=function(e){var t=n.props.repoID;n.setState({path:e,isViewFile:!0}),k.e.getFileInfo(t,e).then((function(r){var o=r.data,i=o.mtime,a=o.permission,s=o.last_modifier_name;k.e.getFileDownloadLink(t,e).then((function(e){k.e.getFileContent(e.data).then((function(e){n.state.content!==e.data&&n.setState({isFileLoading:!0}),n.setState({content:e.data,filePermission:a,latestContributor:s,lastModified:X().unix(i).fromNow(),isFileLoading:!1,isFileLoadedErr:!1})}))}))})).catch((function(){n.setState({isFileLoading:!1,isFileLoadedErr:!0})}))},n.loadDirData=function(e){var t=n.props.repoID;tr.watchRepo(t,n.onRepoUpdateEvent),n.updateUsedRepoTags(),f.Aq.isMarkdownFile(e)?n.handleMarkdownFile(e):n.handleNonMarkdownFile(e)},n.handleMarkdownFile=function(e){k.e.getFileInfo(n.props.repoID,e).then((function(){n.loadSidePanel(e),n.showFile(e)})).catch((function(){n.state.isTreePanelShown&&n.loadSidePanel(e),n.showDir(e)}))},n.handleNonMarkdownFile=function(e){n.state.isTreePanelShown&&n.loadSidePanel(e),e.includes(R.AT.FILE_EXTENDED_PROPERTIES)||n.showDir(e)},n.loadSidePanel=function(e){var t=n.props.repoID;"/"===e||e.includes(R.AT.FILE_EXTENDED_PROPERTIES)?k.e.listDir(t,"/").then((function(e){var t=e.data,r=t.dirent_list,o=t.user_perm,i=n.state.treeData;n.addResponseListToNode(r,i.root),n.setState({isTreeDataLoading:!1,treeData:i,userPerm:o})})).catch((function(){n.setState({isTreeDataLoading:!1})})):n.loadNodeAndParentsByPath(e)},n.showDir=function(e){var t=n.props.repoID;if(n.state.isSessionExpired||n.setState({isDirentListLoading:!0,isViewFile:!1,selectedDirentList:[]}),n.loadDirentList(e),n.resetShowLength(),n.isNeedUpdateHistoryState){var r=n.state.currentRepoInfo,o=h.Yc+"library/"+t+"/"+encodeURIComponent(r.repo_name)+f.Aq.encodePath(e);window.history.pushState({url:o,path:e},e,o)}else n.isNeedUpdateHistoryState=!0},n.showFile=function(e){var t=n.props.repoID;n.state.isTreePanelShown&&k.e.listFileTags(t,e).then((function(e){var t=e.data.file_tags.map((function(e){return new rr.A(e)}));n.setState({fileTags:t})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)})),n.setState({isFileLoading:!0,path:e,isViewFile:!0}),k.e.getFileInfo(t,e).then((function(r){var o=r.data,i=o.mtime,a=o.permission,s=o.last_modifier_name;k.e.getFileDownloadLink(t,e).then((function(e){k.e.getFileContent(e.data).then((function(e){n.setState({content:e.data,filePermission:a,latestContributor:s,lastModified:X().unix(i).fromNow(),isFileLoading:!1,isFileLoadedErr:!1})}))}))})).catch((function(e){var t=f.Aq.getErrorMsg(e,!0);e.response&&403===e.response.status||j.A.danger(t),n.setState({isFileLoading:!1,isFileLoadedErr:!0})}));var r=n.state.currentRepoInfo,o=h.Yc+"library/"+t+"/"+encodeURIComponent(r.repo_name)+f.Aq.encodePath(e);window.history.pushState({url:o,path:e},e,o)},n.showFileMetadata=function(e,t){var r=n.props.repoID,o=n.state.currentRepoInfo;n.setState({path:e,isViewFile:!0,isFileLoading:!1,isFileLoadedErr:!1,content:"__sf-metadata",viewId:t,isDirentDetailShow:!1});var i="".concat(h.Yc,"library/").concat(r,"/").concat(encodeURIComponent(o.repo_name),"/?view=").concat(encodeURIComponent(t));window.history.pushState({url:i,path:""},"",i)},n.hideFileMetadata=function(){n.setState({path:"",isViewFile:!1,isFileLoading:!1,isFileLoadedErr:!1,content:"",viewId:"",isDirentDetailShow:!1})},n.renameMetadataView=function(e,t){var r=n.state,o=r.viewId;"__sf-metadata"===r.content&&o===e&&n.setState({path:t})},n.loadDirentList=function(e){var t=n.props.repoID;k.e.listDir(t,e,{with_thumbnail:!0}).then((function(r){var o=[];r.data.dirent_list.forEach((function(e){var t=new nr.A(e);o.push(t)})),n.setState({pathExist:!0,userPerm:r.data.user_perm,isDirentListLoading:!1,direntList:f.Aq.sortDirents(o,n.state.sortBy,n.state.sortOrder),dirID:r.data.dir_id,path:e,isSessionExpired:!1}),!n.state.repoEncrypted&&o.length&&n.getThumbnails(t,e,n.state.direntList),n.state.currentRepoInfo.is_admin&&(n.foldersSharedOut?n.identifyFoldersSharedOut():(n.foldersSharedOut=[],k.e.getAllRepoFolderShareInfo(t).then((function(e){e.data.share_info_list.forEach((function(e){-1===n.foldersSharedOut.indexOf(e.path)&&n.foldersSharedOut.push(e.path)})),n.identifyFoldersSharedOut()}))))})).catch((function(e){f.Aq.getErrorMsg(e,!0),e.response&&403===e.response.status?n.setState({isDirentListLoading:!1}):n.setState({isDirentListLoading:!1,pathExist:!1})}))},n.identifyFoldersSharedOut=function(){var e=n.state,t=e.path,r=e.direntList;0!=n.foldersSharedOut.length&&(r.forEach((function(e){"dir"==e.type&&-1!==n.foldersSharedOut.indexOf(f.Aq.joinPath(t,e.name)+"/")&&(e.has_been_shared_out=!0)})),n.setState({direntList:r}))},n.onListContainerScroll=function(){var e=n.state.itemsShowLength+100;n.setState({itemsShowLength:e})},n.resetShowLength=function(){n.setState({itemsShowLength:100})},n.shouldDisplayThumbnail=function(e){return(f.Aq.imageCheck(e.name)||h.Nz&&f.Aq.videoCheck(e.name)||h.E7&&f.Aq.pdfCheck(e.name))&&!e.encoded_thumbnail_src},n.getThumbnails=function(e,t,r){var o=r.filter((function(e){return n.shouldDisplayThumbnail(e)}));if(0!=o.length){var i=n,a=o.length,s=function(n){var l=o[n],c=[t,l.name].join("/");k.e.createThumbnail(e,c,48).then((function(e){l.encoded_thumbnail_src=e.data.encoded_thumbnail_src})).catch((function(e){})).then((function(){n<a-1?s(++n):i.setState({direntList:r})}))};s(0)}},n.updateMoveCopyTreeNode=function(e){var t=n.props.repoID,r=n.state.treeData.clone().getNodeByPath(e);if(!r)return!1;var o=r.children.map((function(e){return e.object})).map((function(e){return e.name}));k.e.listDir(t,e).then((function(t){t.data.dirent_list.filter((function(e){return!o.includes(e.name)})).forEach((function(t){n.addNodeToTree(t.name,e,t.type)}))})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.cancelCopyMoveDirent=function(){var e=n.state.asyncCopyMoveTaskId;k.e.cancelCopyMoveOperation(e),n.currentMoveItemName="",n.currentMoveItemPath="";var t=n.state.direntList;n.setState({direntList:t.slice(0)})},n.onMoveProgressDialogToggle=function(){100!==n.state.asyncOperationProgress&&n.cancelCopyMoveDirent(),n.setState({asyncOperationProgress:0,isCopyMoveProgressDialogShow:!1})},n.updateRecentlyUsedRepos=function(e,t){var n=JSON.parse(localStorage.getItem("recently-used-list"))||[],r=[{repo:e,path:t}].concat((0,W.A)(n.filter((function(e){return e.path!==t})))),o=new Set,i=r.filter((function(e){return!o.has(e.path)&&(o.add(e.path),!0)}));i.length>10&&r.pop(),localStorage.setItem("recently-used-list",JSON.stringify(i))},n.onMoveItems=function(e,t){var r=n.props.repoID,o=n.state.selectedDirentList,i=n.getSelectedDirentNames(),a=n.getSelectedDirentPaths();k.e.moveDir(r,e.repo_id,t,n.state.path,i).then((function(s){if(r!==e.repo_id&&n.setState({asyncCopyMoveTaskId:s.data.task_id,asyncOperatedFilesLength:o.length,asyncOperationProgress:0,asyncOperationType:"move",isCopyMoveProgressDialogShow:!0},(function(){n.getAsyncCopyMoveProgress()})),r===e.repo_id){n.state.isTreePanelShown&&n.deleteTreeNodes(a),n.moveDirents(i),n.state.isTreePanelShown&&n.updateMoveCopyTreeNode(t);var l=f.Aq.getMoveSuccessMessage(i);j.A.success(l)}n.updateRecentlyUsedRepos(e,t)})).catch((function(r){if(r.response.data.lib_need_decrypt)n.setState({libNeedDecryptWhenMove:!0,destRepoWhenCopyMove:e,destDirentPathWhenCopyMove:t});else{var o=f.Aq.getErrorMsg(r);o===(0,h.AP)("Error")&&(o=f.Aq.getCopyFailedMessage(i)),j.A.danger(o)}}))},n.onCopyItems=function(e,t){var r=n.props.repoID,o=n.state.selectedDirentList,i=n.getSelectedDirentNames();k.e.copyDir(r,e.repo_id,t,n.state.path,i).then((function(a){if(r!==e.repo_id&&n.setState({asyncCopyMoveTaskId:a.data.task_id,asyncOperatedFilesLength:o.length,asyncOperationProgress:0,asyncOperationType:"copy",isCopyMoveProgressDialogShow:!0},(function(){n.getAsyncCopyMoveProgress()})),r===e.repo_id){n.state.isTreePanelShown&&n.updateMoveCopyTreeNode(t),t===n.state.path&&n.loadDirentList(n.state.path);var s=f.Aq.getCopySuccessfulMessage(i);j.A.success(s)}})).catch((function(r){if(r.response.data.lib_need_decrypt)n.setState({libNeedDecryptWhenCopy:!0,destRepoWhenCopyMove:e,destDirentPathWhenCopyMove:t});else{var o=f.Aq.getErrorMsg(r);o===(0,h.AP)("Error")&&(o=f.Aq.getCopyFailedMessage(i)),j.A.danger(o)}}))},n.restoreDeletedDirents=function(e,t,r){var o=n.props.repoID;r.preventDefault(),j.A.closeAll(),k.e.restoreDirents(o,e,t).then((function(e){var t=e.data,r=t.success,o=t.failed;if(r.forEach((function(e){var t=f.Aq.getFileName(e.path),r=f.Aq.getDirName(e.path);e.is_dir?(n.state.isTreePanelShown&&n.addNodeToTree(t,r,"dir"),r!==n.state.path||n.state.isViewFile||n.addDirent(t,"dir")):(n.state.isTreePanelShown&&n.addNodeToTree(t,r,"file"),r!==n.state.path||n.state.isViewFile||n.addDirent(t,"file"))})),r.length){var i=r.length>1?(0,h.AP)("Restored {name} and {n} other items"):(0,h.AP)("Restored {name}");i=i.replace("{name}",r[0].path.split("/").pop()).replace("{n}",r.length-1),j.A.success(i)}if(o.length){var a=o.length>1?(0,h.AP)("Failed to restore {name} and {n} other items"):(0,h.AP)("Failed to restore {name}");a=a.replace("{name}",o[0].path.split("/").pop()).replace("{n}",o.length-1),j.A.danger(a)}})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.onDeleteItems=function(){var e=n.props.repoID,t=n.getSelectedDirentPaths(),r=n.getSelectedDirentNames();n.setState({updateDetail:!n.state.updateDetail}),k.e.deleteMutipleDirents(e,n.state.path,r).then((function(e){n.state.isTreePanelShown&&n.deleteTreeNodes(t),n.deleteDirents(r);var o="";o=t.length>1?(o=(o=(0,h.AP)("Successfully deleted {name} and {n} other items.")).replace("{name}",r[0])).replace("{n}",r.length-1):(o=(0,h.AP)("Successfully deleted {name}.")).replace("{name}",r[0]);var i=(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("span",{children:o}),(0,m.jsx)("a",{className:"action-link p-0 ml-1",href:"#",onClick:n.restoreDeletedDirents.bind(n,e.data.commit_id,t),children:(0,h.AP)("Undo")})]});j.A.success(i,{duration:5})})).catch((function(e){var t=f.Aq.getErrorMsg(e);t===(0,h.AP)("Error")&&(t=(t=(t=(0,h.AP)("Failed to delete {name} and {n} other items.")).replace("{name}",r[0])).replace("{n}",r.length-1)),j.A.danger(t)}))},n.onAddFolder=function(e){var t=n.props.repoID;k.e.createDir(t,e).then((function(){var t=f.Aq.getFileName(e),r=f.Aq.getDirName(e);n.state.isTreePanelShown&&n.addNodeToTree(t,r,"dir"),r!==n.state.path||n.state.isViewFile||n.addDirent(t,"dir")})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.onAddFile=function(e){var t=n.props.repoID;k.e.createFile(t,e).then((function(t){var r=f.Aq.getFileName(e),o=f.Aq.getDirName(e);n.state.isTreePanelShown&&n.addNodeToTree(r,o,"file"),o!==n.state.path||n.state.isViewFile||n.addDirent(r,"file",t.data.size)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.switchViewMode=function(e){if(e!==n.state.currentMode)if("detail"!==e){Ke.Ay.save("seafile_view_mode",e);var t=n.state.path;if(n.state.isTreePanelShown&&n.state.isViewFile){t=f.Aq.getDirName(t),n.setState({path:t,isViewFile:!1});var r=n.state.currentRepoInfo,o=h.Yc+"library/"+r.repo_id+"/"+encodeURIComponent(r.repo_name)+f.Aq.encodePath(t);window.history.pushState({url:o,path:t},t,o)}n.state.isTreePanelShown&&n.loadSidePanel(n.state.path),n.isNeedUpdateHistoryState=!1,n.setState({currentMode:e}),n.showDir(t)}else n.toggleDirentDetail()},n.onSearchedClick=function(e){e.repo_id!==n.props.repoID&&n.openSearchedNewTab(e);var t=e.is_dir?e.path.slice(0,e.path.length-1):e.path;if(n.state.currentPath!==t)if(n.state.isTreePanelShown){for(var r=-1,o=f.Aq.getPaths(t),i=0;i<o.length;i++){var a=n.state.treeData.getNodeByPath(a);if(!a){r=i;break}}if(-1===r){var s=n.state.treeData.getNodeByPath(t);n.setState({currentNode:s})}else n.loadNodeAndParentsByPath(t);e.is_dir?n.showDir(t):f.Aq.isMarkdownFile(t)?n.showFile(t):n.openSearchedNewTab(e)}else e.is_dir?n.showDir(t):n.openSearchedNewTab(e)},n.openSearchedNewTab=function(e){var t=e.is_dir?e.path.slice(0,e.path.length-1):e.path,n=h.Yc+"lib/"+e.repo_id+"/file"+f.Aq.encodePath(t);f.Aq.isWeChat()?location.href=n:window.open("about:blank").location.href=n},n.onMainNavBarClick=function(e){if(n.resetSelected(),n.state.isTreePanelShown){var t=n.state.treeData.clone(),r=t.getNodeByPath(e);t.expandNode(r),n.setState({treeData:t,currentNode:r})}n.showDir(e)},n.onLinkClick=function(e){var t=e,r=n.props.repoID;if(f.Aq.isInternalMarkdownLink(t,r)){var o=f.Aq.getPathFromInternalMarkdownLink(t,r);n.showFile(o)}else if(f.Aq.isInternalDirLink(t,r)){var i=f.Aq.getPathFromInternalDirLink(t,r);n.showDir(i)}else window.open(t)},n.onMainPanelItemRename=function(e,t){var r=f.Aq.joinPath(n.state.path,e.name);n.renameItem(r,e.isDir(),t)},n.onMainPanelItemDelete=function(e){var t=f.Aq.joinPath(n.state.path,e.name);n.deleteItem(t,e.isDir())},n.onRenameTreeNode=function(e,t){n.renameItem(e.path,e.object.isDir(),t)},n.onDeleteTreeNode=function(e){n.deleteItem(e.path,e.object.isDir())},n.renameItem=function(e,t,r){var o=n.props.repoID;t?k.e.renameDir(o,e,r).then((function(){n.renameItemAjaxCallback(e,r)})).catch((function(t){var n=f.Aq.getErrorMsg(t);if(n===(0,h.AP)("Error")){var r=f.Aq.getFileName(e);n=(0,h.AP)("Renaming {name} failed").replace("{name}",r)}j.A.danger(n)})):k.e.renameFile(o,e,r).then((function(){n.renameItemAjaxCallback(e,r)})).catch((function(t){var n="";if((n=403==t.response.status&&t.response.data&&t.response.data.error_msg?t.response.data.error_msg:f.Aq.getErrorMsg(t))===(0,h.AP)("Error")){var r=f.Aq.getFileName(e);n=(0,h.AP)("Renaming {name} failed").replace("{name}",r)}j.A.danger(n)}))},n.toggleDeleteFolderDialog=function(){n.setState({isDeleteFolderDialogOpen:!n.state.isDeleteFolderDialogOpen})},n.deleteFolder=function(){var e=n.props.repoID,t=n.state.folderToDelete;k.e.deleteDir(e,t).then((function(e){n.deleteItemAjaxCallback(t,!0);var r=f.Aq.getFileName(t),o=(0,h.AP)("Successfully deleted {name}").replace("{name}",r),i=(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("span",{children:o}),(0,m.jsx)("a",{className:"action-link p-0 ml-1",href:"#",onClick:n.restoreDeletedDirents.bind(n,e.data.commit_id,[t]),children:(0,h.AP)("Undo")})]});j.A.success(i,{duration:5})})).catch((function(e){var n=f.Aq.getErrorMsg(e);if(n===(0,h.AP)("Error")){var r=f.Aq.getFileName(t);n=(0,h.AP)("Failed to delete {name}").replace("{name}",r)}j.A.danger(n)}))},n.onMoveItem=function(e,t,r,o){var i=n.props.repoID,a=t.name;o||(o=n.state.path);var s=f.Aq.joinPath(o,a);k.e.moveDir(i,e.repo_id,r,o,a).then((function(t){if(i!==e.repo_id&&n.setState({asyncCopyMoveTaskId:t.data.task_id,asyncOperatedFilesLength:1,asyncOperationProgress:0,asyncOperationType:"move",isCopyMoveProgressDialogShow:!0},(function(){n.currentMoveItemName=a,n.currentMoveItemPath=s,n.getAsyncCopyMoveProgress(a,s)})),n.state.isTreePanelShown&&n.deleteTreeNode(s),i===e.repo_id&&n.state.isTreePanelShown&&n.updateMoveCopyTreeNode(r),n.moveDirent(s,r),i===e.repo_id){var o=(0,h.AP)("Successfully moved {name}.");o=o.replace("{name}",a),j.A.success(o)}n.updateRecentlyUsedRepos(e,r)})).catch((function(i){if(i.response.data.lib_need_decrypt)n.setState({libNeedDecryptWhenMove:!0,destRepoWhenCopyMove:e,destDirentPathWhenCopyMove:r,copyMoveSingleItem:!0,srcDirentWhenCopyMove:t,srcNodeParentPathWhenCopyMove:o});else{var s=f.Aq.getErrorMsg(i);s===(0,h.AP)("Error")&&(s=(s=(0,h.AP)("Failed to move {name}.")).replace("{name}",a)),j.A.danger(s)}}))},n.onCopyItem=function(e,t,r,o){var i=n.props.repoID,a=t.name;o||(o=n.state.path),k.e.copyDir(i,e.repo_id,r,o,a).then((function(t){if(i!==e.repo_id&&n.setState({asyncCopyMoveTaskId:t.data.task_id,asyncOperatedFilesLength:1,asyncOperationProgress:0,asyncOperationType:"copy",isCopyMoveProgressDialogShow:!0},(function(){n.getAsyncCopyMoveProgress()})),i===e.repo_id){n.state.isTreePanelShown&&n.updateMoveCopyTreeNode(r),r===o&&n.loadDirentList(n.state.path);var s=(0,h.AP)("Successfully copied %(name)s.");s=s.replace("%(name)s",a),j.A.success(s)}})).catch((function(i){if(i.response.data.lib_need_decrypt)n.setState({libNeedDecryptWhenCopy:!0,destRepoWhenCopyMove:e,destDirentPathWhenCopyMove:r,copyMoveSingleItem:!0,srcDirentWhenCopyMove:t,srcNodeParentPathWhenCopyMove:o});else{var s=f.Aq.getErrorMsg(i);s===(0,h.AP)("Error")&&(s=(s=(0,h.AP)("Failed to copy %(name)s")).replace("%(name)s",a)),j.A.danger(s)}}))},n.onConvertItem=function(e,t){var r=f.Aq.joinPath(n.state.path,e.name),o=n.props.repoID;j.A.notifyInProgress((0,h.AP)("Converting, please wait..."),{id:"conversion"}),k.e.convertFile(o,r,t).then((function(e){var t=e.data.obj_name,r=e.data.parent_dir+"/"+t,o=f.Aq.getDirName(r);n.state.isTreePanelShown&&n.addNodeToTree(t,o,"file"),n.addDirent(t,"file",e.data.size);var i=(0,h.AP)("Successfully converted the file.");j.A.success(i,{id:"conversion"})})).catch((function(e){var t=f.Aq.getErrorMsg(e);if(t===(0,h.AP)("Error")){var n=f.Aq.getFileName(r);t=(0,h.AP)("Failed to convert {name}.").replace("{name}",n)}j.A.danger(t,{id:"conversion"})}))},n.onDirentClick=function(e,t){var r=n.state,o=r.direntList,i=r.selectedDirentList,a=r.lastSelectedIndex;if(e){var s=o.findIndex((function(t){return t.name===e.name})),l=(0,W.A)(i),c=t&&(t.ctrlKey||t.metaKey),u=t&&t.shiftKey;if(c)l.some((function(t){return t.name===e.name}))?l=l.filter((function(t){return t.name!==e.name})):l.push(e);else if(u&&null!==a){var d=o.findIndex((function(e){return e.name===l[0].name}));if(s<d){var p=o.slice(s,d+1),h=new Set(p.map((function(e){return e.name})));l=[].concat((0,W.A)(l.filter((function(e){return h.has(e.name)}))),(0,W.A)(p))}else if(s>=d&&s<a){var f=o.slice(d,s+1),m=new Set(f.map((function(e){return e.name})));l=l.filter((function(e){return m.has(e.name)}))}else{var g=Math.min(d,s),v=Math.max(d,s),y=o.slice(g,v+1),x=new Set(y.map((function(e){return e.name})));l=[].concat((0,W.A)(l.filter((function(e){return!x.has(e.name)}))),(0,W.A)(y))}}else l=[e];n.setState({direntList:o.map((function(e){return e.isSelected=l.some((function(t){return t.name===e.name})),e})),isDirentSelected:l.length>0,isAllDirentSelected:l.length===o.length,selectedDirentList:l,lastSelectedIndex:s})}else n.setState({direntList:o.map((function(e){return e.isSelected=!1,e})),isDirentSelected:!1,isAllDirentSelected:!1,selectedDirentList:[],lastSelectedIndex:null})},n.onSelectedDirentListUpdate=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;n.setState({direntList:n.state.direntList.map((function(t){return t.isSelected=e.some((function(e){return e.name===t.name})),t})),isDirentSelected:e.length>0,selectedDirentList:e,lastSelectedIndex:t})},n.onItemClick=function(e){n.resetSelected();var t=n.props.repoID,r=f.Aq.joinPath(n.state.path,e.name);if(e.isDir())n.state.isTreePanelShown&&n.loadTreeNodeByPath(r),n.showDir(r);else if(n.state.isTreePanelShown&&f.Aq.isMarkdownFile(r))n.showColumnMarkdownFile(r);else{var o=h.Yc+"lib/"+t+"/file"+f.Aq.encodePath(r);e.is_sdoc_revision&&e.revision_id&&(o=h.Yc+"lib/"+t+"/revisions/"+e.revision_id+"/"),f.Aq.isWeChat()?location.href=o:window.open(o)}},n.onDirentSelected=function(e){var t=n.state.direntList.map((function(t){return t.name===e.name&&(t.isSelected=!t.isSelected),t})),r=t.filter((function(e){return e.isSelected}));r.length?(n.setState({isDirentSelected:!0}),r.length===t.length?n.setState({isAllDirentSelected:!0,direntList:t,selectedDirentList:r}):n.setState({isAllDirentSelected:!1,direntList:t,selectedDirentList:r})):n.setState({isDirentSelected:!1,isAllDirentSelected:!1,direntList:t,selectedDirentList:[]})},n.onAllDirentSelected=function(){n.setState((function(e){var t=!e.isAllDirentSelected,n=e.direntList.map((function(e){return e.isSelected=t,e}));return{isDirentSelected:t,isAllDirentSelected:t,direntList:n,selectedDirentList:t?(0,W.A)(n):[]}}))},n.onFileTagChanged=function(e,t){var r=n.props.repoID;k.e.listFileTags(r,t).then((function(t){var r=t.data.file_tags.map((function(e){return new rr.A(e)}));n.state.isViewFile?n.setState({fileTags:r}):n.updateDirent(e,"file_tags",r)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)})),n.updateUsedRepoTags()},n.onFileUploadSuccess=function(e){if(n.state.direntList.some((function(t){return t.name===e.name&&t.type===e.type}))){var t=n.state.direntList.map((function(t){if(t.name===e.name&&t.type===e.type){var r=X().unix(e.mtime).fromNow();return n.updateDirent(t,"mtime",r)}return t}));n.setState({direntList:t})}else{e.permission=n.state.userPerm;var r=new nr.A(e);n.setState((function(t){return{direntList:"dir"===e.type?[r].concat((0,W.A)(t.direntList)):[].concat((0,W.A)(t.direntList),[r])}})),n.state.isTreePanelShown&&n.addNodeToTree(r.name,n.state.path,r.type),"dir"!==e.type&&n.loadDirentList(n.state.path)}},n.addDirent=function(e,t,r){var o=n.createDirent(e,t,r),i=n.state.direntList;if("dir"===t)i.unshift(o);else{var a=i.length;if(0===a||"dir"===i[a-1].type)i.push(o);else{for(var s=0,l=0;l<=a;l++)if("file"===i[l].type){s=l;break}i.splice(s,0,o)}}n.setState({direntList:i})},n.renameDirent=function(e,t){var r=n.props.repoID,o=f.Aq.getDirName(e),i=f.Aq.joinPath(o,t);if(e===n.state.path){n.setState({path:i});var a=n.state.currentRepoInfo,s=h.Yc+"library/"+r+"/"+encodeURIComponent(a.repo_name)+i;window.history.replaceState({url:s,path:i},i,s)}else if(f.Aq.isChildPath(e,n.state.path)){var l=f.Aq.getFileName(e),c=n.state.direntList.map((function(e){return e.name===l&&(e.name=t),e}));n.setState({direntList:c})}else if(f.Aq.isAncestorPath(e,n.state.path)){var u=f.Aq.renameAncestorPath(n.state.path,e,i);n.setState({path:u});var d=n.state.currentRepoInfo,p=h.Yc+"library/"+r+"/"+encodeURIComponent(d.repo_name)+u;window.history.replaceState({url:p,path:u},u,p)}},n.deleteDirents=function(e){var t=n.state.direntList.filter((function(t){return-1===e.indexOf(t.name)}));n.recalculateSelectedDirents(e,t),n.setState({direntList:t})},n.moveDirent=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=f.Aq.getFileName(e);if(t!==n.state.path){var o=n.state.direntList.filter((function(e){return e.name!==r}));n.recalculateSelectedDirents([r],o),n.setState({direntList:o})}else n.loadDirentList(n.state.path)},n.moveDirents=function(e){var t=n.state.direntList.filter((function(t){return-1===e.indexOf(t.name)}));n.recalculateSelectedDirents(e,t),n.setState({direntList:t,selectedDirentList:[],isDirentSelected:!1,isAllDirentSelected:!1})},n.updateDirent=function(e,t,r){var o=n.state.direntList.map((function(n){return n.name===e.name&&(n[t]=r),n}));n.setState({direntList:o})},n.loadTreeNodeByPath=function(e){var t=n.props.repoID,r=n.state.treeData.clone(),o=r.getNodeByPath(e);o.isLoaded?(r.getNodeByPath(o.parentNode.path).isExpanded=!0,n.setState({treeData:r,currentNode:o})):k.e.listDir(t,o.path).then((function(e){n.addResponseListToNode(e.data.dirent_list,o),r.getNodeByPath(o.parentNode.path).isExpanded=!0,n.setState({treeData:r,currentNode:o})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.loadNodeAndParentsByPath=function(e){var t=n.props.repoID,r=n.state.treeData.clone();f.Aq.isMarkdownFile(e)&&(e=f.Aq.getDirName(e)),k.e.listDir(t,e,{with_parents:!0}).then((function(e){for(var t=e.data,o=t.dirent_list,i=t.user_perm,a={},s=0;s<o.length;s++){var l=o[s],c=l.parent_dir,u="/"===c?"/":c.slice(0,c.length-1);a[u]||(a[u]=[]),a[u].push(l)}for(var d in a){var p=r.getNodeByPath(d);p.isLoaded||n.addResponseListToNode(a[d],p)}n.setState({isTreeDataLoading:!1,treeData:r,userPerm:i})})).catch((function(){n.setState({isLoadFailed:!0})}))},n.onTreeNodeClick=function(e){n.resetSelected();var t,r,o=n.props.repoID;if(n.state.pathExist||n.setState({pathExist:!0}),e.object.isDir()){var i=e.isLoaded;if(!e.isLoaded){var a=n.state.treeData.clone();e=a.getNodeByPath(e.path),k.e.listDir(o,e.path).then((function(t){n.addResponseListToNode(t.data.dirent_list,e),a.collapseNode(e),n.setState({treeData:a})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))}if(i&&e.path===n.state.path)if(e.isExpanded){var s=sr.A.collapseNode(n.state.treeData,e);n.setState({treeData:s})}else{var l=n.state.treeData.clone();e=l.getNodeByPath(e.path),l.expandNode(e),n.setState({treeData:l})}}if(e.path!==n.state.path)if(e.object.isDir())n.showDir(e.path);else if(f.Aq.isMarkdownFile(e.path))e.path!==n.state.path&&n.showColumnMarkdownFile(e.path);else if(f.Aq.isFileMetadata(null===(t=e)||void 0===t||null===(r=t.object)||void 0===r?void 0:r.type))e.path!==n.state.path&&n.showFileMetadata(e.path,e.view_id||"0000");else{var c=h.Yc+"lib/"+o+"/file"+f.Aq.encodePath(e.path),u=e.object;u.is_sdoc_revision&&u.revision_id&&(c=h.Yc+"lib/"+o+"/revisions/"+u.revision_id+"/"),window.open(c)}},n.showColumnMarkdownFile=function(e){var t=n.props.repoID;k.e.getFileInfo(t,e).then((function(r){if(0===r.data.size){var o=window.open("about:blank"),i=h.Yc+"lib/"+t+"/file"+f.Aq.encodePath(e);o.location.href=i}else n.showFile(e)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.onTreeNodeCollapse=function(e){var t=sr.A.collapseNode(n.state.treeData,e);n.setState({treeData:t})},n.onTreeNodeExpanded=function(e){var t=n.props.repoID,r=n.state.treeData.clone();(e=r.getNodeByPath(e.path)).isLoaded?(r.expandNode(e),n.setState({treeData:r})):k.e.listDir(t,e.path).then((function(t){n.addResponseListToNode(t.data.dirent_list,e),n.setState({treeData:r})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.addNodeToTree=function(e,t,r){var o=n.createTreeNode(e,r),i=sr.A.addNodeToParentByPath(n.state.treeData,o,t);n.setState({treeData:i})},n.renameTreeNode=function(e,t){var r=sr.A.renameNodeByPath(n.state.treeData,e,t);n.setState({treeData:r})},n.deleteTreeNode=function(e){var t=sr.A.deleteNodeByPath(n.state.treeData,e);n.setState({treeData:t})},n.deleteTreeNodes=function(e){var t=sr.A.deleteNodeListByPaths(n.state.treeData,e);n.setState({treeData:t})},n.moveTreeNode=function(e,t,r,o){if(n.props.repoID===r.repo_id){var i=sr.A.moveNodeByPath(n.state.treeData,e,t,o);n.setState({treeData:i})}else{var a=sr.A.deleteNodeByPath(n.state.treeData,e);n.setState({treeData:a})}},n.copyTreeNode=function(e,t,r,o){if(n.props.repoID===r.repo_id){var i=sr.A.copyNodeByPath(n.state.treeData,e,t,o);n.setState({treeData:i})}},n.addResponseListToNode=function(e,t){t.isLoaded=!0,t.isExpanded=!0;var n=e.map((function(e){return new nr.A(e)})),r=(n=f.Aq.sortDirents(n,"name","asc")).map((function(e){return new ar.A({object:e})}));t.addChildren(r)},n.getSelectedDirentPaths=function(){var e=[];return n.state.selectedDirentList.forEach((function(t){e.push(f.Aq.joinPath(n.state.path,t.name))})),e},n.getSelectedDirentNames=function(){var e=[];return n.state.selectedDirentList.forEach((function(t){e.push(t.name)})),e},n.resetSelected=function(){n.setState({isDirentSelected:!1,isAllDirentSelected:!1})},n.recalculateSelectedDirents=function(e,t){var r=n.state.selectedDirentList.slice(0);r.length>0&&(r=r.filter((function(t){return!e.includes(t.name)}))),n.setState({selectedDirentList:r,isDirentSelected:r.length>0,isAllDirentSelected:!!t.length&&r.length===t.length})},n.onLibDecryptDialog=function(){n.setState({libNeedDecrypt:!1}),n.loadDirData(n.state.path)},n.onLibDecryptWhenCopyMove=function(){n.state.libNeedDecryptWhenCopy&&(n.state.copyMoveSingleItem?n.onCopyItem(n.state.destRepoWhenCopyMove,n.state.srcDirentWhenCopyMove,n.state.destDirentPathWhenCopyMove,n.state.srcNodeParentPathWhenCopyMove):n.onCopyItems(n.state.destRepoWhenCopyMove,n.state.destDirentPathWhenCopyMove),n.setState({libNeedDecryptWhenCopy:!1,copyMoveSingleItem:!1})),n.state.libNeedDecryptWhenMove&&(n.state.copyMoveSingleItem?n.onMoveItem(n.state.destRepoWhenCopyMove,n.state.srcDirentWhenCopyMove,n.state.destDirentPathWhenCopyMove,n.state.srcNodeParentPathWhenCopyMove):n.onMoveItems(n.state.destRepoWhenCopyMove,n.state.destDirentPathWhenCopyMove),n.setState({libNeedDecryptWhenMove:!1,copyMoveSingleItem:!1}))},n.sortItems=function(e,t){Ke.Ay.save("seafile-repo-dir-sort-by",e),Ke.Ay.save("seafile-repo-dir-sort-order",t),n.setState({sortBy:e,sortOrder:t,items:f.Aq.sortDirents(n.state.direntList,e,t)})},n.onUploadFile=function(e){e.nativeEvent.stopImmediatePropagation(),n.uploader.onFileUpload()},n.onUploadFolder=function(e){e.nativeEvent.stopImmediatePropagation(),n.uploader.onFolderUpload()},n.onToolbarFileTagChanged=function(){var e=n.props.repoID,t=n.state.path;k.e.listFileTags(e,t).then((function(e){var t=e.data.file_tags.map((function(e){return new rr.A(e)}));n.setState({fileTags:t})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.unSelectDirent=function(){var e=n.state.direntList.map((function(e){return e.isSelected=!1,e}));n.setState({isDirentSelected:!1,direntList:e,selectedDirentList:[]});n.onDirentSelected({})},n.onDeleteRepoTag=function(e){var t=n.state.direntList.map((function(t){if(t.file_tags){var n=t.file_tags.filter((function(t){return t.repo_tag_id!==e}));t.file_tags=n}return t}));n.setState({direntList:t}),n.updateUsedRepoTags()},n.handleSubmit=function(e){var t={share_type:"personal",from:n.state.currentRepoInfo.owner_email};k.e.leaveShareRepo(n.props.repoID,t).then((function(e){(0,c.oo)(h.Yc+"shared-libs/")})).catch((function(e){var t=f.Aq.getErrorMsg(e,!0);j.A.danger(t)})),e.preventDefault()},n.toggleTreePanel=function(){n.setState({isTreePanelShown:!n.state.isTreePanelShown},(function(){n.state.isTreePanelShown&&n.loadSidePanel(n.state.path),localStorage.setItem("sf_dir_view_tree_panel_open",String(n.state.isTreePanelShown))}))};var o=!0,a=localStorage.getItem("sf_dir_view_tree_panel_open");return void 0!=a&&(o="true"==a),n.state={currentMode:Ke.Ay.load("seafile_view_mode")||"list",isTreePanelShown:o,path:"",pathExist:!0,isViewFile:!1,hash:"",currentRepoInfo:null,repoName:"",repoEncrypted:!1,libNeedDecrypt:!1,isGroupOwnedRepo:!1,userPerm:"",selectedDirentList:[],lastSelectedIndex:null,fileTags:[],repoTags:[],usedRepoTags:[],isTreeDataLoading:!0,treeData:sr.A.buildTree(),currentNode:null,isFileLoading:!0,isFileLoadedErr:!1,filePermission:"",content:"",lastModified:"",latestContributor:"",isDirentListLoading:!0,direntList:[],isDirentSelected:!1,sortBy:Ke.Ay.load("seafile-repo-dir-sort-by")||"name",sortOrder:Ke.Ay.load("seafile-repo-dir-sort-order")||"asc",isAllDirentSelected:!1,dirID:"",errorMsg:"",isDirentDetailShow:!1,direntDetailPanelTab:"",updateDetail:!1,itemsShowLength:100,isSessionExpired:!1,isCopyMoveProgressDialogShow:!1,isDeleteFolderDialogOpen:!1,asyncCopyMoveTaskId:"",asyncOperationType:"move",asyncOperationProgress:0,asyncOperatedFilesLength:0,viewId:"0000"},n.oldonpopstate=window.onpopstate,window.onpopstate=n.onpopstate,n.lastModifyTime=new Date,n.isNeedUpdateHistoryState=!0,n.currentMoveItemName="",n.currentMoveItemPath="",n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"UNSAFE_componentWillMount",value:function(){var e=window.location.hash;"#"===e.slice(0,1)&&this.setState({hash:e})}},{key:"componentDidMount",value:function(){this.calculatePara(this.props)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.repoID!==this.props.repoID&&this.calculatePara(e)}},{key:"componentWillUnmount",value:function(){window.onpopstate=this.oldonpopstate,tr.unwatchRepo(this.props.repoID,this.onRepoUpdateEvent),this.unsubscribeEvent(),this.props.eventBus.dispatch(Tg.T.CURRENT_LIBRARY_CHANGED,{repoID:"",repoName:"",path:"",isViewFile:!1,isLibView:!1,currentRepoInfo:null})}},{key:"componentDidUpdate",value:function(){this.lastModifyTime=new Date,this.props.eventBus.dispatch(Tg.T.CURRENT_LIBRARY_CHANGED,{repoID:this.props.repoID,repoName:this.state.repoName,currentRepoInfo:this.state.currentRepoInfo,path:this.state.path,isViewFile:this.state.isViewFile,isLibView:!0})}},{key:"getAsyncCopyMoveProgress",value:function(){var e=(0,ln.A)((0,sn.A)().mark((function e(){var t,n,r,o,i,a,s,l,c,u;return(0,sn.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state,n=t.asyncOperationType,r=t.asyncCopyMoveTaskId,e.prev=1,e.next=4,k.e.queryAsyncOperationProgress(r);case 4:if(o=e.sent,!(i=o.data).failed){e.next=12;break}return a=(0,h.AP)("Failed to move files to another library."),"copy"===n&&(a=(0,h.AP)("Failed to copy files to another library.")),j.A.danger(a),this.setState({asyncOperationProgress:0,isCopyMoveProgressDialogShow:!1}),e.abrupt("return");case 12:if(!i.successful){e.next=19;break}return"move"===n&&(this.currentMoveItemName&&this.currentMoveItemPath?(this.state.isTreePanelShown&&this.deleteTreeNode(this.currentMoveItemPath),this.moveDirent(this.currentMoveItemName),this.currentMoveItemName="",this.currentMoveItemPath=""):(this.state.isTreePanelShown&&(s=this.getSelectedDirentPaths(),this.deleteTreeNodes(s)),l=this.getSelectedDirentNames(),this.moveDirents(l))),this.setState({isCopyMoveProgressDialogShow:!1}),c=(0,h.AP)("Successfully moved files to another library."),"copy"===n&&(c=(0,h.AP)("Successfully copied files to another library.")),j.A.success(c),e.abrupt("return");case 19:u=i.total?parseInt((i.done/i.total*100).toFixed(2)):0,this.getAsyncCopyMoveProgress(),this.setState({asyncOperationProgress:u}),e.next=27;break;case 24:e.prev=24,e.t0=e.catch(1),this.setState({asyncOperationProgress:0,isCopyMoveProgressDialogShow:!1});case 27:case"end":return e.stop()}}),e,this,[[1,24]])})));return function(){return e.apply(this,arguments)}}()},{key:"renameItemAjaxCallback",value:function(e,t){this.state.isTreePanelShown&&this.renameTreeNode(e,t),this.renameDirent(e,t)}},{key:"deleteItem",value:function(e,t){var n=this,r=this.props.repoID;t?this.setState({folderToDelete:e},(function(){n.toggleDeleteFolderDialog()})):k.e.deleteFile(r,e).then((function(r){n.deleteItemAjaxCallback(e,t);var o=f.Aq.getFileName(e),i=(0,h.AP)("Successfully deleted {name}").replace("{name}",o),a=(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("span",{children:i}),(0,m.jsx)("a",{className:"action-link p-0 ml-1",href:"#",onClick:n.restoreDeletedDirents.bind(n,r.data.commit_id,[e]),children:(0,h.AP)("Undo")})]});j.A.success(a,{duration:5})})).catch((function(t){var n=f.Aq.getErrorMsg(t);if(n===(0,h.AP)("Error")){var r=f.Aq.getFileName(e);n=(0,h.AP)("Failed to delete {name}").replace("{name}",r)}j.A.danger(n)}))}},{key:"deleteItemAjaxCallback",value:function(e){this.state.isTreePanelShown&&this.deleteTreeNode(e),this.deleteDirent(e)}},{key:"deleteDirent",value:function(e){if(e===this.state.path){var t=f.Aq.getDirName(e);this.showDir(t)}else if(f.Aq.isChildPath(e,this.state.path)){var n=f.Aq.getFileName(e),r=this.state.direntList.filter((function(e){return e.name!==n}));this.recalculateSelectedDirents([n],r),this.setState({direntList:r})}else if(f.Aq.isAncestorPath(e,this.state.path)){var o=f.Aq.getDirName(e);this.showDir(o)}}},{key:"createTreeNode",value:function(e,t){var n=this.createDirent(e,t);return new ar.A({object:n})}},{key:"createDirent",value:function(e,t,n){var r=this.state.userPerm,o={name:e,type:t,mtime:(new Date).getTime()/1e3,size:n,permission:r};return new nr.A(o)}},{key:"render",value:function(){var e=this;if(this.state.libNeedDecrypt)return(0,m.jsx)(ne.A,{children:(0,m.jsx)(lr,{repoID:this.props.repoID,onLibDecryptDialog:this.onLibDecryptDialog})});if(this.state.libNeedDecryptWhenCopy||this.state.libNeedDecryptWhenMove)return(0,m.jsx)(ne.A,{children:(0,m.jsx)(lr,{repoID:this.state.destRepoWhenCopyMove.repo_id,onLibDecryptDialog:this.onLibDecryptWhenCopyMove})});if(this.state.errorMsg)return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("p",{className:"error mt-6 text-center",children:this.state.errorMsg}),(0,m.jsx)("button",{type:"submit",className:"btn btn-primary submit",onClick:this.handleSubmit,children:(0,h.AP)("Leave Share")})]});if(!this.state.currentRepoInfo)return"";var t=!1,n=this.state,r=n.currentRepoInfo,o=n.userPerm,i=n.isCopyMoveProgressDialogShow,a=n.isDeleteFolderDialogOpen,l=f.Aq.isHasPermissionToShare(r,o),c=r.owner_email===h.Xh,u=r.is_virtual,g=r.is_admin;u||!c&&!g||(t=!0);var v=this.state.direntList.filter((function(t,n){return n<e.state.itemsShowLength})),y=!0,x=f.Aq.getUserPermission(o),A=x.isCustomPermission,C=x.customPermission;A&&(y=C.permission.upload);return(0,m.jsx)(nu,{repoID:this.props.repoID,selectMetadataView:this.onTreeNodeClick,renameMetadataView:this.renameMetadataView,hideMetadataView:this.hideFileMetadata,children:(0,m.jsxs)(au,{repoID:this.props.repoID,children:[(0,m.jsxs)("div",{className:"main-panel-center flex-row",children:[(0,m.jsx)(vg,{isSidePanelFolded:this.props.isSidePanelFolded,repoEncrypted:this.state.repoEncrypted,isRepoOwner:c,onFilesTagChanged:this.onFileTagChanged,unSelectDirent:this.unSelectDirent,pathPrefix:this.props.pathPrefix,isTreePanelShown:this.state.isTreePanelShown,toggleTreePanel:this.toggleTreePanel,currentMode:this.state.currentMode,switchViewMode:this.switchViewMode,isCustomPermission:A,path:this.state.path,pathExist:this.state.pathExist,currentRepoInfo:this.state.currentRepoInfo,repoID:this.props.repoID,enableDirPrivateShare:t,userPerm:o,isGroupOwnedRepo:this.state.isGroupOwnedRepo,onTabNavClick:this.props.onTabNavClick,onMainNavBarClick:this.onMainNavBarClick,isViewFile:this.state.isViewFile,hash:this.state.hash,fileTags:this.state.fileTags,isFileLoading:this.state.isFileLoading,isFileLoadedErr:this.state.isFileLoadedErr,filePermission:this.state.filePermission,content:this.state.content,viewId:this.state.viewId,lastModified:this.state.lastModified,latestContributor:this.state.latestContributor,onLinkClick:this.onLinkClick,isTreeDataLoading:this.state.isTreeDataLoading,treeData:this.state.treeData,currentNode:this.state.currentNode,onNodeClick:this.onTreeNodeClick,onNodeCollapse:this.onTreeNodeCollapse,onNodeExpanded:this.onTreeNodeExpanded,onAddFolderNode:this.onAddFolder,onAddFileNode:this.onAddFile,onRenameNode:this.onRenameTreeNode,onDeleteNode:this.onDeleteTreeNode,repoTags:this.state.repoTags,usedRepoTags:this.state.usedRepoTags,updateUsedRepoTags:this.updateUsedRepoTags,isDirentListLoading:this.state.isDirentListLoading,direntList:v,fullDirentList:this.state.direntList,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems,updateDirent:this.updateDirent,onDirentClick:this.onDirentClick,onItemClick:this.onItemClick,onItemSelected:this.onDirentSelected,onItemDelete:this.onMainPanelItemDelete,onItemRename:this.onMainPanelItemRename,onItemMove:this.onMoveItem,onItemCopy:this.onCopyItem,onItemConvert:this.onConvertItem,onAddFolder:this.onAddFolder,onAddFile:this.onAddFile,onFileTagChanged:this.onFileTagChanged,isDirentSelected:this.state.isDirentSelected,isAllDirentSelected:this.state.isAllDirentSelected,onAllDirentSelected:this.onAllDirentSelected,isDirentDetailShow:this.state.isDirentDetailShow,selectedDirent:this.state.selectedDirentList&&this.state.selectedDirentList[0],selectedDirentList:this.state.selectedDirentList,onSelectedDirentListUpdate:this.onSelectedDirentListUpdate,onItemsMove:this.onMoveItems,onItemsCopy:this.onCopyItems,onItemsDelete:this.onDeleteItems,closeDirentDetail:this.closeDirentDetail,showDirentDetail:this.showDirentDetail,direntDetailPanelTab:this.state.direntDetailPanelTab,onDeleteRepoTag:this.onDeleteRepoTag,onToolbarFileTagChanged:this.onToolbarFileTagChanged,updateDetail:this.state.updateDetail,onListContainerScroll:this.onListContainerScroll,loadDirentList:this.loadDirentList,showShareBtn:l,onUploadFile:this.onUploadFile,onUploadFolder:this.onUploadFolder}),y&&this.state.pathExist&&!this.state.isViewFile&&(0,m.jsx)(Pg,{ref:function(t){return e.uploader=t},dragAndDrop:!0,path:this.state.path,repoID:this.props.repoID,direntList:this.state.direntList,onFileUploadSuccess:this.onFileUploadSuccess,isCustomPermission:A})]}),i&&(0,m.jsx)(Ng.A,{type:this.state.asyncOperationType,asyncOperatedFilesLength:this.state.asyncOperatedFilesLength,asyncOperationProgress:this.state.asyncOperationProgress,toggleDialog:this.onMoveProgressDialogToggle}),a&&(0,m.jsx)(Og,{repoID:this.props.repoID,path:this.state.folderToDelete,deleteFolder:this.deleteFolder,toggleDialog:this.toggleDeleteFolderDialog}),(0,m.jsx)(d(),{query:"(max-width: 767.8px)",children:(0,m.jsx)(p.A,{zIndex:"1030",isOpen:!f.Aq.isDesktop()&&this.state.isTreePanelShown,toggle:this.toggleTreePanel,contentClassName:"d-none"})})]})})}}])}(s.Component),Rg=Eg,Lg=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).listGroupMembers=function(e){var t=n.props.groupID,r=n.state,o=r.perPage,i=r.groupMembers;k.e.listGroupMembers(t,e,o).then((function(t){var r=t.data;n.setState({isLoading:!1,isLoadingMore:!1,page:e,hasNextPage:!(r.length<o),groupMembers:i.concat(r)})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t),n.setState({isLoading:!1,isLoadingMore:!1,hasNextPage:!1})}))},n.handleScroll=function(e){var t=n.state,r=t.page,o=t.hasNextPage,i=t.isLoadingMore;if(o&&!i){var a=e.target.clientHeight,s=e.target.scrollHeight;a+e.target.scrollTop+1>=s&&n.setState({isLoadingMore:!0},(function(){n.listGroupMembers(r+1)}))}},n.state={isLoading:!0,isLoadingMore:!1,groupMembers:[],page:1,perPage:100,hasNextPage:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.listGroupMembers(this.state.page)}},{key:"render",value:function(){var e,t=this.state,n=t.isLoading,r=t.hasNextPage,o=t.groupMembers,i=t.perPage;return e=o.length<i?o.length:"".concat(i,"+"),(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.props.toggleDialog,children:[(0,m.jsx)(I.A,{toggle:this.props.toggleDialog,children:"".concat((0,h.AP)("Group members")," (").concat(e,")")}),(0,m.jsx)(_.A,{className:"px-0 group-members-container",onScroll:this.handleScroll,children:n?(0,m.jsx)($.A,{}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("ul",{className:"list-unstyled",children:o.map((function(e,t){return(0,m.jsxs)("li",{className:"group-member px-4 py-2 d-flex align-items-center",children:[(0,m.jsx)("img",{src:e.avatar_url,alt:e.name,className:"avatar"}),(0,m.jsx)("span",{className:"ml-2 text-truncate",title:e.name,children:e.name})]},t)}))}),r&&(0,m.jsx)($.A,{})]})})]})}}])}(s.Component),Fg=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).dismissGroup=function(){var e=n;k.e.deleteGroup(n.props.groupID).then((function(t){e.props.onGroupChanged()})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return(0,m.jsxs)(p.A,{isOpen:this.props.showDismissGroupDialog,toggle:this.props.toggleDismissGroupDialog,children:[(0,m.jsx)(I.A,{children:(0,h.AP)("Delete Group")}),(0,m.jsx)(_.A,{children:(0,m.jsx)("span",{children:(0,h.AP)("Really want to delete this group?")})}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(O.A,{color:"secondary",onClick:this.props.toggleDismissGroupDialog,children:(0,h.AP)("Cancel")}),(0,m.jsx)(O.A,{color:"primary",onClick:this.dismissGroup,children:(0,h.AP)("Delete")})]})]})}}])}(s.Component),Ug=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).handleGroupNameChange=function(e){e.target.value.trim()?n.setState({isSubmitBtnActive:!0}):n.setState({isSubmitBtnActive:!1});var t=e.target.value;n.setState({newGroupName:t})},n.renameGroup=function(){var e=n.state.newGroupName.trim();if(e){var t=n;k.e.renameGroup(n.props.groupID,e).then((function(e){t.props.loadGroup(n.props.groupID),t.props.onGroupChanged(e.data.id)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))}n.setState({newGroupName:""}),n.props.toggleRenameGroupDialog()},n.handleKeyDown=function(e){13===e.keyCode&&n.renameGroup()},n.state={newGroupName:n.props.currentGroupName,isSubmitBtnActive:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return(0,m.jsxs)(p.A,{isOpen:this.props.showRenameGroupDialog,toggle:this.props.toggleRenameGroupDialog,children:[(0,m.jsx)(I.A,{children:(0,h.AP)("Rename Group")}),(0,m.jsxs)(_.A,{children:[(0,m.jsx)("label",{htmlFor:"newGroupName",children:(0,h.AP)("Rename group to")}),(0,m.jsx)(P.A,{type:"text",id:"newGroupName",value:this.state.newGroupName,onChange:this.handleGroupNameChange,onKeyDown:this.handleKeyDown})]}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(O.A,{color:"secondary",onClick:this.props.toggleRenameGroupDialog,children:(0,h.AP)("Cancel")}),(0,m.jsx)(O.A,{color:"primary",onClick:this.renameGroup,disabled:!this.state.isSubmitBtnActive,children:(0,h.AP)("Submit")})]})]})}}])}(s.Component),Bg=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).handleSelectChange=function(e){n.setState({selectedOption:e,errMessage:""}),n.options=[]},n.transferGroup=function(){var e=n.state.selectedOption&&n.state.selectedOption.email;e&&k.e.transferGroup(n.props.groupID,e).then((function(e){n.props.toggleTransferGroupDialog()})).catch((function(e){var t=f.Aq.getErrorMsg(e);n.setState({errMessage:t})}))},n.toggle=function(){n.props.toggleTransferGroupDialog()},n.state={selectedOption:null,errMessage:""},n.options=[],n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.toggle,children:[(0,m.jsx)(I.A,{toggle:this.toggle,children:(0,h.AP)("Transfer Group")}),(0,m.jsxs)(_.A,{children:[(0,m.jsx)("p",{children:(0,h.AP)("Transfer group to")}),(0,m.jsx)(Yt.A,{ref:"userSelect",isMulti:!1,placeholder:(0,h.AP)("Please enter 1 or more character"),onSelectChange:this.handleSelectChange}),(0,m.jsx)("div",{className:"error",children:this.state.errMessage})]}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(O.A,{color:"secondary",onClick:this.toggle,children:(0,h.AP)("Close")}),(0,m.jsx)(O.A,{color:"primary",onClick:this.transferGroup,children:(0,h.AP)("Submit")})]})]})}}])}(s.Component),Yg=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).toggle=function(){n.props.toggleImportMembersDialog()},n.openFileInput=function(){n.fileInputRef.current.click()},n.uploadFile=function(e){if(n.fileInputRef.current.files.length){var t=n.fileInputRef.current.files[0].name;if("xlsx"==t.substr(t.lastIndexOf(".")+1)){var r=n.fileInputRef.current.files[0];n.props.importMembersInBatch(r),n.toggle()}else n.setState({errorMsg:(0,h.AP)("Please choose a .xlsx file.")})}},n.state={errorMsg:""},n.fileInputRef=s.createRef(),n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.state.errorMsg;return(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.toggle,children:[(0,m.jsx)(I.A,{toggle:this.toggle,children:(0,h.AP)("Import members from a .xlsx file")}),(0,m.jsxs)(_.A,{children:[(0,m.jsx)("p",{children:h.Vb}),(0,m.jsx)("p",{children:(0,m.jsx)("a",{className:"text-secondary small",href:"".concat(h.Yc,"api/v2.1/group-members-import-example/"),children:(0,h.AP)("Download an example file")})}),(0,m.jsx)("button",{className:"btn btn-outline-primary",onClick:this.openFileInput,children:(0,h.AP)("Upload file")}),(0,m.jsx)("input",{className:"d-none",type:"file",onChange:this.uploadFile,ref:this.fileInputRef}),e&&(0,m.jsx)(Dt.A,{color:"danger",children:e})]}),(0,m.jsx)(N.A,{children:(0,m.jsx)(O.A,{color:"secondary",onClick:this.toggle,children:(0,h.AP)("Cancel")})})]})}}])}(s.Component),qg=function(e){function t(){return(0,r.A)(this,t),(0,i.A)(this,t,arguments)}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.groupMembers,n=e.changeMember,r=e.deleteMember,o=e.groupID,i=e.isOwner,a=e.isItemFreezed,s=e.toggleItemFreezed;return(0,m.jsxs)(Q.A,{size:"sm",className:"manage-members-table",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"10%"}),(0,m.jsx)("th",{width:"45%",children:(0,h.AP)("Name")}),(0,m.jsx)("th",{width:"35%",children:(0,h.AP)("Role")}),(0,m.jsx)("th",{width:"10%"})]})}),(0,m.jsx)("tbody",{children:t.map((function(e,t){return(0,m.jsx)(Hg,{item:e,changeMember:n,deleteMember:r,groupID:o,isOwner:i,isItemFreezed:a,toggleItemFreezed:s},t)}))})]})}}])}(s.Component),Hg=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onChangeUserRole=function(e){var t="Admin"===e.value?"True":"False";k.e.setGroupAdmin(n.props.groupID,n.props.item.email,t).then((function(e){n.props.changeMember(e.data)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.deleteMember=function(){var e=n.props.item;k.e.deleteGroupMember(n.props.groupID,e.email).then((function(t){n.props.deleteMember(e),j.A.success((0,h.AP)("Successfully deleted {name}.").replace("{name}",e.name))})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.handleMouseOver=function(){n.props.isItemFreezed||n.setState({highlight:!0})},n.handleMouseLeave=function(){n.props.isItemFreezed||n.setState({highlight:!1})},n.translateRole=function(e){return"Admin"===e?(0,h.AP)("Admin"):"Member"===e?(0,h.AP)("Member"):"Owner"===e?(0,h.AP)("Owner"):void 0},n.roleOptions=[{value:"Admin",text:(0,h.AP)("Admin"),isSelected:!1},{value:"Member",text:(0,h.AP)("Member"),isSelected:!1}],n.state={highlight:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.state.highlight,t=this.props,n=t.item,r=t.isOwner,o="Owner"!==n.role&&!0===r||"Member"===n.role&&!1===r,i=n.role;this.roleOptions=this.roleOptions.map((function(e){return e.isSelected=e.value==i,e}));var a=this.roleOptions.filter((function(e){return e.isSelected}))[0];return(0,m.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseLeave:this.handleMouseLeave,className:this.state.highlight?"tr-highlight":"",tabIndex:"0",onFocus:this.handleMouseOver,children:[(0,m.jsx)("th",{scope:"row",children:(0,m.jsx)("img",{className:"avatar",src:n.avatar_url,alt:""})}),(0,m.jsx)("td",{children:n.name}),(0,m.jsxs)("td",{children:[(!1===r||!0===r&&"Owner"===n.role)&&(0,m.jsx)("span",{className:"group-admin",children:this.translateRole(n.role)}),!0===r&&"Owner"!==n.role&&(0,m.jsx)(Fe.A,{isDropdownToggleShown:e,currentSelectedOption:a,options:this.roleOptions,selectOption:this.onChangeUserRole,toggleItemFreezed:this.props.toggleItemFreezed})]}),(0,m.jsx)("td",{children:o&&this.state.highlight&&(0,m.jsx)(en.A,{className:"action-icon sf2-icon-x3",title:(0,h.AP)("Delete"),op:this.deleteMember})})]})}}])}(s.PureComponent),Gg=qg,zg=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).listGroupMembers=function(e){var t=n.props.groupID,r=n.state,o=r.perPage,i=r.groupMembers;k.e.listGroupMembers(t,e,o).then((function(t){var r=t.data;n.setState({isLoading:!1,isLoadingMore:!1,page:e,hasNextPage:!(r.length<o),groupMembers:i.concat(r)})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t),n.setState({isLoading:!1,isLoadingMore:!1,hasNextPage:!1})}))},n.onSelectChange=function(e){n.setState({selectedOption:e,errMessage:[]})},n.addGroupMember=function(){for(var e=[],t=0;t<n.state.selectedOption.length;t++)e.push(n.state.selectedOption[t].email);k.e.addGroupMembers(n.props.groupID,e).then((function(e){var t=e.data.success;n.setState({groupMembers:[].concat(t,n.state.groupMembers),selectedOption:null}),n.refs.userSelect.clearSelect(),e.data.failed.length>0&&n.setState({errMessage:e.data.failed})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.toggleItemFreezed=function(e){n.setState({isItemFreezed:e})},n.handleScroll=function(e){var t=n.state,r=t.page,o=t.hasNextPage,i=t.isLoadingMore;if(o&&!i){var a=e.target.clientHeight,s=e.target.scrollHeight;a+e.target.scrollTop+1>=s&&n.setState({isLoadingMore:!0},(function(){n.listGroupMembers(r+1)}))}},n.changeMember=function(e){n.setState({groupMembers:n.state.groupMembers.map((function(t){return t.email==e.email&&(t=e),t}))})},n.deleteMember=function(e){var t=n.state.groupMembers;t.splice(t.indexOf(e),1),n.setState({groupMembers:t})},n.searchMembers=function(e){var t=n.state.groupMembers,r=e.target.value,o=r.trim().toLowerCase(),i=t.filter((function(e){return e.name.toLowerCase().indexOf(o)>-1}));n.setState({keyword:r,membersFound:i})},n.clearSearch=function(){n.setState({keyword:"",membersFound:[]})},n.onSearchInputFocus=function(){n.setState({searchActive:!0})},n.onSearchInputBlur=function(){n.setState({searchActive:!1})},n.state={isLoading:!0,isLoadingMore:!1,groupMembers:[],page:1,perPage:100,hasNextPage:!1,selectedOption:null,errMessage:[],isItemFreezed:!1,searchActive:!1,keyword:"",membersFound:[]},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.listGroupMembers(this.state.page)}},{key:"render",value:function(){var e=this.state,t=e.isLoading,n=e.hasNextPage,r=e.groupMembers,o=e.keyword,i=e.membersFound,a=e.searchActive;return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("p",{className:"mb-2",children:(0,h.AP)("Add group member")}),(0,m.jsxs)("div",{className:"add-members",children:[(0,m.jsx)(Yt.A,{placeholder:(0,h.AP)("Search users"),onSelectChange:this.onSelectChange,ref:"userSelect",isMulti:!0,className:"add-members-select"}),this.state.selectedOption?(0,m.jsx)(O.A,{color:"primary",onClick:this.addGroupMember,children:(0,h.AP)("Submit")}):(0,m.jsx)(O.A,{color:"primary",disabled:!0,children:(0,h.AP)("Submit")})]}),this.state.errMessage.length>0&&this.state.errMessage.map((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(0,m.jsx)("div",{className:"group-error error",children:e.error_msg},t)})),r.length>10&&(0,m.jsxs)(Ut.A,{className:"search-group-members rounded ".concat(a?"active":""),children:[(0,m.jsx)(fn.A,{children:(0,m.jsx)("i",{className:"sf3-font sf3-font-search","aria-hidden":!0})}),(0,m.jsx)(P.A,{type:"text",className:"input-group-input px-0",placeholder:(0,h.AP)("Search group members"),value:o,onChange:this.searchMembers,onFocus:this.onSearchInputFocus,onBlur:this.onSearchInputBlur}),o&&(0,m.jsx)(fn.A,{children:(0,m.jsx)("i",{className:"sf2-icon-x1","aria-hidden":!0,onClick:this.clearSearch})})]}),(0,m.jsx)("div",{className:"manage-members",onScroll:o.trim()?function(){}:this.handleScroll,children:t?(0,m.jsx)($.A,{}):(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)(Gg,{groupMembers:o.trim()?i:r,changeMember:this.changeMember,deleteMember:this.deleteMember,groupID:this.props.groupID,isOwner:this.props.isOwner,isItemFreezed:this.state.isItemFreezed,toggleItemFreezed:this.toggleItemFreezed}),!o.trim()&&n&&(0,m.jsx)($.A,{})]})})]})}}])}(s.Component),Vg=zg,Wg=function(e){function t(){return(0,r.A)(this,t),(0,i.A)(this,t,arguments)}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.groupID,n=e.isOwner,r=e.toggleManageMembersDialog;return(0,m.jsxs)(p.A,{isOpen:!0,toggle:r,className:"group-manage-members-dialog",children:[(0,m.jsx)(I.A,{toggle:r,children:(0,h.AP)("Manage group members")}),(0,m.jsx)(_.A,{className:"pb-0",children:(0,m.jsx)(Vg,{groupID:t,isOwner:n})})]})}}])}(s.Component),Kg=Wg,Xg=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).leaveGroup=function(){k.e.quitGroup(n.props.groupID,h.Xh).then((function(e){n.props.onGroupChanged()})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.props.toggleLeaveGroupDialog,children:[(0,m.jsx)(I.A,{toggle:this.props.toggleLeaveGroupDialog,children:(0,h.AP)("Leave Group")}),(0,m.jsx)(_.A,{children:(0,m.jsx)("p",{children:(0,h.AP)("Really want to leave this group?")})}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(O.A,{color:"secondary",onClick:this.props.toggleLeaveGroupDialog,children:(0,h.AP)("Cancel")}),(0,m.jsx)(O.A,{color:"primary",onClick:this.leaveGroup,children:(0,h.AP)("Leave")})]})]})}}])}(s.Component),$g=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).loadGroup=function(e){k.e.getGroup(e).then((function(e){var t=new M(e.data),r=n.getEmptyTip(t),o=t.admins.indexOf(h.Xh)>-1,i=t.owner===h.Xh,a=0!==t.parent_group_id;n.setState({emptyTip:r,currentGroup:t,isStaff:o,isDepartmentGroup:a,isOwner:i,currentPage:1,repoList:[]},(function(){n.loadRepos(n.state.currentPage)}))})).catch((function(e){n.setState({isLoading:!1,errMessage:f.Aq.getErrorMsg(e,!0)})}))},n.loadRepos=function(e){var t=n.state.perPage;k.e.listGroupRepos(n.props.groupID,e,t).then((function(r){var o=!0;r.data.length<t&&(o=!1);var i=n.state.repoList,a=r.data.map((function(e){return new Xe(e)}));a.length&&(i=i.concat(a)),n.setState({isLoading:!1,isLoadingMore:!1,currentPage:e,hasNextPage:o,repoList:f.Aq.sortRepos(i,n.state.sortBy,n.state.sortOrder)})})).catch((function(e){n.setState({isLoading:!1,isLoadingMore:!1,errMessage:f.Aq.getErrorMsg(e,!0)})}))},n.getEmptyTip=function(e){var t=null;return e&&(t=0===e.parent_group_id?(0,m.jsx)(J.A,{title:(0,h.AP)("No libraries shared with this group"),text:(0,h.AP)('No libraries have been shared with this group yet. A library shared with a group can be accessed by all group members. You can share a library with a group in "My Libraries". You can also create a new library to be shared with this group by clicking the "New Library" button in the menu bar.')}):-1==e.admins.indexOf(h.Xh)?(0,m.jsx)(J.A,{title:(0,h.AP)("No libraries")}):(0,m.jsx)(J.A,{title:(0,h.AP)("No libraries"),text:(0,h.AP)('You can create libraries by clicking the "New Library" button above.')})),t},n.onCreateRepoToggle=function(){n.setState({isCreateRepoDialogShow:!n.state.isCreateRepoDialogShow})},n.onCreateRepo=function(e,t){var r=n.props.groupID;t&&"department"===t?k.e.createGroupOwnedLibrary(r,e).then((function(e){var t={repo_id:e.data.id,repo_name:e.data.name,owner_name:e.data.group_name,owner_email:e.data.owner,permission:e.data.permission,mtime:e.data.mtime,size:e.data.size,encrypted:e.data.encrypted},r=new Xe(t),o=n.addRepoItem(r);n.setState({repoList:o})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)})):k.e.createGroupRepo(r,e).then((function(e){var t=new Xe(e.data),r=n.addRepoItem(t);n.setState({repoList:r})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)})),n.onCreateRepoToggle()},n.onItemDelete=function(e){var t=n.props.groupID,r=n.state.repoList.filter((function(t){return t.repo_id!==e.repo_id}));n.setState({repoList:r}),n.loadGroup(t)},n.addRepoItem=function(e){var t=n.state.repoList.map((function(e){return e}));return t.unshift(e),t},n.onItemUnshare=function(e){var t=n.state.currentGroup;k.e.unshareRepoToGroup(e.repo_id,t.id).then((function(){var r=n.state.repoList.filter((function(t){return t.repo_id!==e.repo_id}));n.setState({repoList:r}),n.loadGroup(t.id)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.onItemRename=function(e,t){k.e.renameGroupOwnedLibrary(n.props.groupID,e.repo_id,t).then((function(r){var o=n.state.repoList.map((function(n){return n.repo_id===e.repo_id&&(n.repo_name=t),n}));n.setState({repoList:o})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.onMonitorRepo=function(e,t){var r=n.state.repoList.map((function(n){return n.repo_id===e.repo_id&&(n.monitored=t),n}));n.setState({repoList:r})},n.toggleDismissGroupDialog=function(){n.setState({showDismissGroupDialog:!n.state.showDismissGroupDialog,showGroupDropdown:!1})},n.toggleRenameGroupDialog=function(){n.setState({showRenameGroupDialog:!n.state.showRenameGroupDialog,showGroupDropdown:!1})},n.toggleTransferGroupDialog=function(){n.setState({showTransferGroupDialog:!n.state.showTransferGroupDialog,showGroupDropdown:!1})},n.toggleImportMembersDialog=function(){n.setState({showImportMembersDialog:!n.state.showImportMembersDialog})},n.importMembersInBatch=function(e){j.A.notify((0,h.AP)("It may take some time, please wait.")),k.e.importGroupMembersViaFile(n.state.currentGroup.id,e).then((function(e){e.data.failed.forEach((function(e){var t="".concat(e.email,": ").concat(e.error_msg);j.A.danger(t)}))})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.toggleManageMembersDialog=function(){n.setState({showManageMembersDialog:!n.state.showManageMembersDialog,showGroupDropdown:!1})},n.toggleLeaveGroupDialog=function(){n.setState({isLeaveGroupDialogOpen:!n.state.isLeaveGroupDialogOpen,showGroupDropdown:!1})},n.sortItems=function(e,t){Ke.Ay.save("seafile-repo-dir-sort-by",e),Ke.Ay.save("seafile-repo-dir-sort-order",t),n.setState({sortBy:e,sortOrder:t,repoList:f.Aq.sortRepos(n.state.repoList,e,t)})},n.translateRole=function(e){return"Admin"===e?(0,h.AP)("Admin"):"Member"===e?(0,h.AP)("Member"):"Owner"===e?(0,h.AP)("Owner"):void 0},n.toggleSortOptionsDialog=function(){n.setState({isSortOptionsDialogOpen:!n.state.isSortOptionsDialogOpen})},n.handleScroll=function(e){var t=n.state,r=t.currentPage,o=t.hasNextPage,i=t.isLoadingMore;if(o&&!i){var a=e.target.clientHeight,s=e.target.scrollHeight;a+e.target.scrollTop+1>=s&&n.setState({isLoadingMore:!0},(function(){n.loadRepos(r+1)}))}},n.toggleMembersDialog=function(){n.setState({isMembersDialogOpen:!n.state.isMembersDialogOpen})},n.getOpList=function(){var e=n.state,t=e.currentGroup,r=e.isDepartmentGroup,o=e.isStaff,i=e.isOwner,a=[];return(!r&&h._s||r&&o)&&a.push({text:(0,h.AP)("New Library"),onClick:n.onCreateRepoToggle}),a.push({text:(0,h.AP)("Members"),onClick:n.toggleMembersDialog}),t&&((o||i)&&(a.push({text:(0,h.AP)("Rename"),onClick:n.toggleRenameGroupDialog}),i&&a.push({text:(0,h.AP)("Transfer"),onClick:n.toggleTransferGroupDialog}),a.push({text:(0,h.AP)("Import members"),onClick:n.toggleImportMembersDialog}),a.push({text:(0,h.AP)("Manage members"),onClick:n.toggleManageMembersDialog}),i&&a.push({text:(0,h.AP)("Delete group"),onClick:n.toggleDismissGroupDialog})),i||r||a.push({text:(0,h.AP)("Leave group"),onClick:n.toggleLeaveGroupDialog})),a},n.state={isLoading:!0,isLoadingMore:!1,errMessage:"",emptyTip:null,currentGroup:null,currentRepo:null,isStaff:!1,isOwner:!1,sortBy:Ke.Ay.load("seafile-repo-dir-sort-by")||"name",sortOrder:Ke.Ay.load("seafile-repo-dir-sort-order")||"asc",isSortOptionsDialogOpen:!1,repoList:[],currentPage:1,perPage:300,hasNextPage:!1,libraryType:"group",isCreateRepoDialogShow:!1,isDepartmentGroup:!1,showGroupDropdown:!1,showGroupMembersPopover:!1,showRenameGroupDialog:!1,showDismissGroupDialog:!1,showTransferGroupDialog:!1,showImportMembersDialog:!1,showManageMembersDialog:!1,isLeaveGroupDialogOpen:!1,isMembersDialogOpen:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this.props.groupID;this.loadGroup(e)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.groupID!==this.props.groupID&&this.loadGroup(e.groupID)}},{key:"render",value:function(){var e=this.state,t=e.errMessage,n=e.emptyTip,r=e.currentGroup,o=e.isDepartmentGroup,i=e.isMembersDialogOpen,a=0;o&&r.group_quota&&(a=r.group_quota_usage/r.group_quota*100+"%");var l=this.getOpList();return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("div",{className:"main-panel-center flex-row",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)("div",{className:"cur-view-path",children:r&&(0,m.jsxs)(s.Fragment,{children:[(0,m.jsxs)("div",{className:"sf-heading d-flex align-items-center",children:[o&&(0,m.jsx)("span",{className:"sf3-font-department sf3-font nav-icon",title:(0,h.AP)("This is a special group representing a department.")}),(0,m.jsx)("span",{children:r.name}),(0,m.jsx)(Be,{opList:l})]}),(0,m.jsxs)("div",{className:"path-tool",children:[o&&(0,m.jsx)(m.Fragment,{children:r.group_quota>0&&(0,m.jsx)("div",{className:"department-usage-container",children:(0,m.jsxs)("div",{className:"department-usage",children:[(0,m.jsx)("span",{id:"quota-bar",className:"department-quota-bar",children:(0,m.jsx)("span",{id:"quota-usage",className:"usage",style:{width:a}})}),(0,m.jsxs)("span",{className:"department-quota-info",children:[f.Aq.bytesToSize(r.group_quota_usage)," / ",f.Aq.bytesToSize(r.group_quota)]})]})})}),!f.Aq.isDesktop()&&this.state.repoList.length>0&&(0,m.jsx)("span",{className:"sf3-font sf3-font-sort action-icon",onClick:this.toggleSortOptionsDialog}),this.state.isSortOptionsDialogOpen&&(0,m.jsx)(Re,{toggleDialog:this.toggleSortOptionsDialog,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems})]})]})}),(0,m.jsxs)("div",{className:"cur-view-content d-block",onScroll:this.handleScroll,children:[this.state.isLoading&&(0,m.jsx)($.A,{}),!this.state.isLoading&&t&&(0,m.jsx)("div",{className:"error text-center mt-2",children:t}),!this.state.isLoading&&0===this.state.repoList.length&&n,!this.state.isLoading&&this.state.repoList.length>0&&(0,m.jsx)(Wn,{repoList:this.state.repoList,hasNextPage:this.state.hasNextPage,currentGroup:this.state.currentGroup,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems,onItemUnshare:this.onItemUnshare,onItemDelete:this.onItemDelete,onItemRename:this.onItemRename,onMonitorRepo:this.onMonitorRepo})]})]})}),this.state.isCreateRepoDialogShow&&!this.state.isDepartmentGroup&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(En,{libraryType:this.state.libraryType,onCreateToggle:this.onCreateRepoToggle,onCreateRepo:this.onCreateRepo})}),this.state.isCreateRepoDialogShow&&this.state.isDepartmentGroup&&(0,m.jsx)(En,{onCreateToggle:this.onCreateRepoToggle,onCreateRepo:this.onCreateRepo,libraryType:"department"}),i&&(0,m.jsx)(Lg,{groupID:this.props.groupID,toggleDialog:this.toggleMembersDialog}),this.state.showRenameGroupDialog&&(0,m.jsx)(Ug,{showRenameGroupDialog:this.state.showRenameGroupDialog,toggleRenameGroupDialog:this.toggleRenameGroupDialog,loadGroup:this.loadGroup,groupID:this.props.groupID,onGroupChanged:this.props.onGroupChanged,currentGroupName:r.name}),this.state.showDismissGroupDialog&&(0,m.jsx)(Fg,{showDismissGroupDialog:this.state.showDismissGroupDialog,toggleDismissGroupDialog:this.toggleDismissGroupDialog,loadGroup:this.loadGroup,groupID:this.props.groupID,onGroupChanged:this.props.onGroupChanged}),this.state.showTransferGroupDialog&&(0,m.jsx)(Bg,{toggleTransferGroupDialog:this.toggleTransferGroupDialog,groupID:this.props.groupID,onGroupChanged:this.props.onGroupChanged}),this.state.showImportMembersDialog&&(0,m.jsx)(Yg,{toggleImportMembersDialog:this.toggleImportMembersDialog,importMembersInBatch:this.importMembersInBatch}),this.state.showManageMembersDialog&&(0,m.jsx)(Kg,{toggleManageMembersDialog:this.toggleManageMembersDialog,groupID:this.props.groupID,onGroupChanged:this.props.onGroupChanged,isOwner:this.state.isOwner}),this.state.isLeaveGroupDialogOpen&&(0,m.jsx)(Xg,{toggleLeaveGroupDialog:this.toggleLeaveGroupDialog,groupID:this.props.groupID,onGroupChanged:this.props.onGroupChanged})]})}}])}(s.Component),Zg=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).handleInputChange=function(e){var t=e.target.value;n.setState({emails:t}),n.state.errorMsg&&n.setState({errorMsg:""})},n.handleKeyDown=function(e){13===e.keyCode&&(e.preventDefault(),n.handleSubmitInvite())},n.handleSubmitInvite=function(){var e=n.state.emails.trim();if(!e)return n.setState({errorMsg:(0,h.AP)("It is required.")}),!1;for(var t=[],r=0,o=(e=e.split(",")).length;r<o;r++){var i=e[r].trim();i&&t.push(i)}if(!t.length)return n.setState({errorMsg:(0,h.AP)("Email is invalid.")}),!1;n.setState({isSubmitting:!0}),k.e.invitePeople(t).then((function(e){n.props.toggleDialog();var t=e.data.success;if(t.length){var r="";r=1==t.length?(0,h.AP)("Successfully invited %(email).").replace("%(email)",t[0].accepter):(0,h.AP)("Successfully invited %(email) and %(num) other people.").replace("%(email)",t[0].accepter).replace("%(num)",t.length-1),j.A.success(r),n.props.onInvitePeople(t)}var o=e.data.failed;if(o.length)for(var i=0,a=o.length;i<a;i++){var s=o[i].email+": "+o[i].error_msg;j.A.danger(s)}})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t),n.props.toggleDialog()}))},n.state={emails:"",errorMsg:"",isSubmitting:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.state.isSubmitting;return(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.props.toggleDialog,children:[(0,m.jsx)(I.A,{toggle:this.props.toggleDialog,children:(0,h.AP)("Invite Guest")}),(0,m.jsxs)(_.A,{children:[(0,m.jsx)("label",{htmlFor:"emails",children:(0,h.AP)("Emails")}),(0,m.jsx)(P.A,{type:"text",id:"emails",placeholder:(0,h.AP)("Emails, separated by ','"),value:this.state.emails,onChange:this.handleInputChange,onKeyDown:this.handleKeyDown}),(0,m.jsx)("p",{className:"error mt-2",children:this.state.errorMsg})]}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(O.A,{color:"secondary",onClick:this.props.toggleDialog,children:(0,h.AP)("Cancel")}),(0,m.jsx)(O.A,{className:"submit-btn",color:"primary",onClick:this.handleSubmitInvite,disabled:e,children:e?(0,m.jsx)($.A,{}):(0,h.AP)("Submit")})]})]})}}])}(s.Component),Jg=Zg,Qg=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onRevokeInvitation=function(){n.setState({isSubmitting:!0}),k.e.revokeInvitation(n.props.token).then((function(e){n.props.revokeInvitation(),n.props.toggleDialog();var t=(0,h.AP)("Successfully revoked access of user {placeholder}.").replace("{placeholder}",n.props.accepter);j.A.success(t)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t),n.props.toggleDialog()}))},n.state={isSubmitting:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.toggleDialog,t=this.state.isSubmitting,n='<span class="op-target">'+f.Aq.HTMLescape(this.props.accepter)+"</span>",r=(0,h.AP)("Are you sure to revoke access of user {placeholder} ?").replace("{placeholder}",n);return(0,m.jsxs)(p.A,{isOpen:!0,toggle:e,children:[(0,m.jsx)(I.A,{toggle:e,children:(0,h.AP)("Revoke Access")}),(0,m.jsx)(_.A,{children:(0,m.jsx)("p",{dangerouslySetInnerHTML:{__html:r}})}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(O.A,{color:"secondary",onClick:e,children:(0,h.AP)("Cancel")}),(0,m.jsx)(O.A,{className:"submit-btn",color:"primary",onClick:this.onRevokeInvitation,disabled:t,children:t?(0,m.jsx)($.A,{}):(0,h.AP)("Submit")})]})]})}}])}(s.Component),ev=Qg,tv=(n(82106),function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).toggleOpMenu=function(){n.setState({isOpMenuOpen:!n.state.isOpMenuOpen})},n.onMouseEnter=function(){n.setState({isOpIconShown:!0})},n.onMouseLeave=function(){n.setState({isOpIconShown:!1})},n.deleteItem=function(){n.setState({isOpIconShown:!1});var e=n.props.invitation.token;k.e.deleteInvitation(e).then((function(t){n.props.deleteItem(e),j.A.success((0,h.AP)("Successfully deleted 1 item."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t),n.setState({isOpIconShown:!0})}))},n.revokeItem=function(){var e=n.props.invitation.token;n.props.deleteItem(e)},n.toggleRevokeDialog=function(){n.setState({isRevokeDialogOpen:!n.state.isRevokeDialogOpen})},n.state={isOpIconShown:!1,isOpMenuOpen:!1,isRevokeDialogOpen:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.state,t=e.isOpIconShown,n=e.isRevokeDialogOpen,r=this.props.invitation;return(0,m.jsxs)(s.Fragment,{children:[this.props.isDesktop?(0,m.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onFocus:this.onMouseEnter,tabIndex:"0",children:[(0,m.jsx)("td",{children:r.accepter}),(0,m.jsx)("td",{children:X()(r.invite_time).format("YYYY-MM-DD")}),(0,m.jsx)("td",{children:X()(r.expire_time).format("YYYY-MM-DD")}),(0,m.jsx)("td",{children:r.accept_time&&(0,m.jsx)("i",{className:"sf2-icon-tick invite-accept-icon"})}),(0,m.jsx)("td",{children:t&&(r.accept_time?(0,m.jsx)("i",{role:"button",className:"action-icon sf3-font sf3-font-cancel-invitation",title:(0,h.AP)("Revoke Access"),"aria-label":(0,h.AP)("Revoke Access"),onClick:this.toggleRevokeDialog}):(0,m.jsx)("i",{role:"button",className:"action-icon sf2-icon-x3",title:(0,h.AP)("Delete"),"aria-label":(0,h.AP)("Delete"),onClick:this.deleteItem}))})]}):(0,m.jsxs)("tr",{children:[(0,m.jsxs)("td",{children:[r.accepter,(0,m.jsx)("br",{}),(0,m.jsxs)("span",{className:"item-meta-info",children:[X()(r.invite_time).format("YYYY-MM-DD"),(0,m.jsxs)("span",{className:"small",children:["(",(0,h.AP)("Invite Time"),")"]})]}),(0,m.jsxs)("span",{className:"item-meta-info",children:[X()(r.expire_time).format("YYYY-MM-DD"),(0,m.jsxs)("span",{className:"small",children:["(",(0,h.AP)("Expiration"),")"]})]}),(0,m.jsx)("span",{className:"item-meta-info",children:r.accept_time&&(0,h.AP)("Accepted")})]}),(0,m.jsx)("td",{children:(0,m.jsxs)(de.A,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu,children:[(0,m.jsx)(pe.A,{tag:"i",className:"sf-dropdown-toggle sf3-font sf3-font-more-vertical ml-0",title:(0,h.AP)("More operations"),"aria-label":(0,h.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),(0,m.jsxs)("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu,children:[(0,m.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),(0,m.jsx)("div",{className:"mobile-operation-menu",children:r.accept_time?(0,m.jsx)(he.A,{className:"mobile-menu-item",onClick:this.toggleRevokeDialog,children:(0,h.AP)("Revoke Access")}):(0,m.jsx)(he.A,{className:"mobile-menu-item",onClick:this.deleteItem,children:(0,h.AP)("Delete")})})]})]})})]}),n&&(0,m.jsx)(ev,{accepter:r.accepter,token:r.token,revokeInvitation:this.revokeItem,toggleDialog:this.toggleRevokeDialog})]})}}])}(s.Component)),nv=function(e){function t(e){return(0,r.A)(this,t),(0,i.A)(this,t,[e])}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props.data,n=t.loading,r=t.errorMsg,o=t.invitationsList;if(n)return(0,m.jsx)($.A,{});if(r)return(0,m.jsx)("p",{className:"error text-center mt-2",children:r});if(!o.length)return(0,m.jsx)(J.A,{title:(0,h.AP)("No guest invitations"),text:(0,h.AP)('You have not invited any guests yet. A guest can access shared libraries through the web interface allowing more efficient ways to collaborate than through links. You can invite a guest by clicking the "Invite Guest" button in the menu bar.')});var i=f.Aq.isDesktop();return(0,m.jsxs)("table",{className:"table-hover".concat(i?"":" table-thead-hidden"),children:[(0,m.jsx)("thead",{children:i?(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"25%",children:(0,h.AP)("Email")}),(0,m.jsx)("th",{width:"20%",children:(0,h.AP)("Invite Time")}),(0,m.jsx)("th",{width:"20%",children:(0,h.AP)("Expiration")}),(0,m.jsx)("th",{width:"18%",children:(0,h.AP)("Accepted")}),(0,m.jsx)("th",{width:"7%"})]}):(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"92%"}),(0,m.jsx)("th",{width:"8%"})]})}),(0,m.jsx)("tbody",{children:o.map((function(t,n){return(0,m.jsx)(tv,{isDesktop:i,invitation:t,deleteItem:e.props.deleteItem},n)}))})]})}}])}(s.Component),rv=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onInvitePeople=function(e){e.push.apply(e,n.state.invitationsList),n.setState({invitationsList:e})},n.deleteItem=function(e){n.setState({invitationsList:n.state.invitationsList.filter((function(t){return t.token!=e}))})},n.toggleInvitePeopleDialog=function(){n.setState({isInvitePeopleDialogOpen:!n.state.isInvitePeopleDialogOpen})},n.state={loading:!0,errorMsg:"",invitationsList:[],isInvitePeopleDialogOpen:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;k.e.listInvitations().then((function(t){e.setState({invitationsList:t.data,loading:!1})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("div",{className:"main-panel-center flex-row",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)("div",{className:"cur-view-path",children:(0,m.jsxs)("div",{className:"d-flex",children:[(0,m.jsx)("h3",{className:"sf-heading",children:(0,h.AP)("Invite Guest")}),(0,m.jsx)(Be,{opList:[{text:(0,h.AP)("Invite Guest"),onClick:this.toggleInvitePeopleDialog}]})]})}),(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsx)(nv,{data:this.state,deleteItem:this.deleteItem})})]})}),this.state.isInvitePeopleDialogOpen&&(0,m.jsx)(Jg,{onInvitePeople:this.onInvitePeople,toggleDialog:this.toggleInvitePeopleDialog})]})}}])}(s.Component),ov=n(76154),iv=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).inputNewName=function(e){n.setState({name:e.target.value})},n.handleKeyDown=function(e){"Enter"===e.key&&n.handleSubmit()},n.handleSubmit=function(){var e=n.state.name.trim(),t=n.state.selectedOption?n.state.selectedOption.id:null;e&&(n.props.addWiki(e,t),n.props.toggleCancel())},n.toggle=function(){n.props.toggleCancel()},n.handleSelectChange=function(e){n.setState({selectedOption:e})},n.state={name:"",isSubmitBtnActive:!1,selectedOption:null,options:[]},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;h.am&&ov.A.listWikiDepartments().then((function(t){for(var n=t.data.sort((function(e,t){return e.name.toLowerCase()<t.name.toLowerCase()?-1:1})),r=[],o=0;o<n.length;o++){var i={};i.value=n[o].name,i.id=n[o].id,i.email=n[o].email,i.label=n[o].name,r.push(i)}if(e.setState({options:r}),e.props.currentDeptEmail){var a=r.find((function(t){return t.email==e.props.currentDeptEmail}));e.setState({selectedOption:a})}})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))}},{key:"render",value:function(){return(0,m.jsxs)(p.A,{isOpen:!0,autoFocus:!1,toggle:this.toggle,children:[(0,m.jsx)(I.A,{toggle:this.toggle,children:(0,h.AP)("Add Wiki")}),(0,m.jsxs)(_.A,{children:[(0,m.jsx)(St.A,{children:(0,h.AP)("Name")}),(0,m.jsx)(P.A,{onKeyDown:this.handleKeyDown,autoFocus:!0,value:this.state.name,onChange:this.inputNewName}),h.am&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(St.A,{className:"mt-4",children:[(0,h.AP)("Wiki owner")," (",(0,h.AP)("Optional"),")"]}),(0,m.jsx)(Vt.by,{onChange:this.handleSelectChange,options:this.state.options,hideSelectedOptions:!0,placeholder:(0,h.AP)("Select a department"),maxMenuHeight:200,value:this.state.selectedOption,components:{NoOptionsMessage:(0,m.jsx)("div",{style:{margin:"6px 10px",textAlign:"center",color:"hsl(0,0%,50%)"},children:(0,h.AP)("No department")})},noOptionsMessage:function(){return(0,h.AP)("No options available")}})]})]}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(O.A,{color:"secondary",onClick:this.toggle,children:(0,h.AP)("Cancel")}),(0,m.jsx)(O.A,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.name.trim(),children:(0,h.AP)("Submit")})]})]})}}])}(s.Component),av=iv;var sv=function(e){var t=e.handleSubmit,n=e.toggleCancel,r=e.title,o=e.content,i=e.footer;return(0,m.jsxs)(p.A,{isOpen:!0,toggle:n,children:[(0,m.jsx)(I.A,{toggle:n,children:r}),(0,m.jsx)(_.A,{children:o}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(O.A,{color:"secondary",onClick:n,children:(0,h.AP)("Cancel")}),(0,m.jsx)(O.A,{color:"primary",onClick:t,children:i})]})]})},lv=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).handleChange=function(e){n.setState({isSubmitBtnActive:!!e.target.value.trim(),newName:e.target.value})},n.handleSubmit=function(){var e=n.validateInput(),t=e.isValid,r=e.errMessage;t?n.props.onRename(n.state.newName.trim()):n.setState({errMessage:r})},n.handleKeyDown=function(e){"Enter"===e.key&&n.handleSubmit()},n.toggle=function(){n.props.toggleCancel()},n.validateInput=function(){var e=n.state.newName.trim(),t=!0,r="";return e?e.indexOf("/")>-1?{isValid:t=!1,errMessage:r=(0,h.AP)("Name should not include '/'.")}:{isValid:t,errMessage:r}:{isValid:t=!1,errMessage:r=(0,h.AP)("Name is required.")}},n.state={newName:e.wiki.name,errMessage:"",isSubmitBtnActive:!1},n.newInput=s.createRef(),n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return(0,m.jsxs)(p.A,{isOpen:!0,toggle:this.toggle,children:[(0,m.jsx)(I.A,{toggle:this.toggle,children:(0,h.AP)("Rename Wiki")}),(0,m.jsxs)(_.A,{children:[(0,m.jsx)("p",{children:(0,h.AP)("New Wiki name")}),(0,m.jsx)(P.A,{onKeyDown:this.handleKeyDown,innerRef:this.newInput,placeholder:"newName",value:this.state.newName,onChange:this.handleChange}),this.state.errMessage&&(0,m.jsx)(Dt.A,{color:"danger",className:"mt-2",children:this.state.errMessage})]}),(0,m.jsxs)(N.A,{children:[(0,m.jsx)(O.A,{color:"secondary",onClick:this.toggle,children:(0,h.AP)("Cancel")}),(0,m.jsx)(O.A,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive,children:(0,h.AP)("Submit")})]})]})}}])}(s.Component),cv=n(88438),uv=n(72170),dv=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).toggle=function(e){n.state.activeTab!==e&&n.setState({activeTab:e})},n.onAddCustomPermissionToggle=function(){n.toggle("customSharePermission")},n.renderDirContent=function(){if(!n.state.isRepoJudgemented)return(0,m.jsx)($.A,{});var e=n.state.activeTab,t=n.props,r=t.repoEncrypted,o=t.enableDirPrivateShare,i=t.itemType;return r&&(o="library"==i),(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)("div",{className:"share-dialog-side",children:(0,m.jsx)(Tt.A,{pills:!0,children:o&&(0,m.jsxs)(s.Fragment,{children:[h.Ih&&(0,m.jsx)(Et.A,{role:"tab","aria-selected":"shareToUser"===e,"aria-controls":"share-to-user-panel",children:(0,m.jsx)(Rt.A,{className:"shareToUser"===e?"active":"",onClick:n.toggle.bind(n,"shareToUser"),tabIndex:"0",onKeyDown:n.onTabKeyDown,children:(0,h.AP)("Share to user")})}),h.Ih&&(0,m.jsx)(Et.A,{role:"tab","aria-selected":"shareToGroup"===e,"aria-controls":"share-to-group-panel",children:(0,m.jsx)(Rt.A,{className:"shareToGroup"===e?"active":"",onClick:n.toggle.bind(n,"shareToGroup"),tabIndex:"0",onKeyDown:n.onTabKeyDown,children:(0,h.AP)("Share to group")})})]})})}),(0,m.jsx)("div",{className:"share-dialog-main",children:(0,m.jsx)(Lt.A,{activeTab:n.state.activeTab,children:o&&(0,m.jsxs)(s.Fragment,{children:["shareToUser"===e&&h.Ih&&(0,m.jsx)(Ft.A,{tabId:"shareToUser",role:"tabpanel",id:"share-to-user-panel",children:(0,m.jsx)(cv.A,{itemType:n.props.itemType,isGroupOwnedRepo:n.state.isGroupOwnedRepo,itemPath:n.props.itemPath,repoID:n.props.repoID,isRepoOwner:n.state.isRepoOwner,repoType:n.state.repoType,onAddCustomPermissionToggle:n.onAddCustomPermissionToggle})}),"shareToGroup"===e&&h.Ih&&(0,m.jsx)(Ft.A,{tabId:"shareToGroup",role:"tabpanel",id:"share-to-group-panel",children:(0,m.jsx)(uv.A,{itemType:n.props.itemType,isGroupOwnedRepo:n.state.isGroupOwnedRepo,itemPath:n.props.itemPath,repoID:n.props.repoID,isRepoOwner:n.state.isRepoOwner,repoType:n.state.repoType,onAddCustomPermissionToggle:n.onAddCustomPermissionToggle})})]})})})]})},n.onTabKeyDown=function(e){"Enter"!=e.key&&"Space"!=e.key||e.target.click()},n.renderExternalShareMessage=function(){return h.Ts&&"object"===typeof h.Ts?(0,m.jsxs)("div",{className:"external-share-message mt-2",children:[(0,m.jsx)("h6",{children:h.Ts.title}),(0,m.jsx)("p",{style:{fontSize:"14px",color:"#666"},className:"text-wrap m-0",children:h.Ts.content})]}):null},n.state={activeTab:"shareToUser",isRepoJudgemented:!1,isRepoOwner:!1,isGroupOwnedRepo:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.repoID;k.e.getRepoInfo(t).then((function(t){var n=t.data.owner_email.indexOf("@seafile_group")>-1,r=t.data.owner_email===h.Xh;e.setState({isRepoJudgemented:!0,isRepoOwner:r,repoType:t.data.repo_type,isGroupOwnedRepo:n})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))}},{key:"render",value:function(){var e=this.props,t=e.itemType,n=e.itemName;return(0,m.jsx)("div",{children:(0,m.jsxs)(p.A,{isOpen:!0,style:{maxWidth:"760px"},className:"share-dialog",toggle:this.props.toggleDialog,children:[(0,m.jsxs)(I.A,{toggle:this.props.toggleDialog,tag:"div",children:[(0,m.jsxs)("h5",{className:"text-truncate",children:[(0,h.AP)("Share")," ",(0,m.jsx)("span",{className:"op-target",title:n,children:n})]}),this.renderExternalShareMessage()]}),(0,m.jsx)(_.A,{className:"share-dialog-content",role:"tablist",children:"library"===t&&this.renderDirContent()})]})})}}])}(s.Component),pv=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onRenameToggle=function(e){n.setState({isShowRenameDialog:!n.state.isShowRenameDialog})},n.onShareToggle=function(e){n.setState({isShowShareDialog:!n.state.isShowShareDialog})},n.onDeleteToggle=function(e){e.preventDefault(),n.setState({isShowDeleteDialog:!n.state.isShowDeleteDialog})},n.onDeleteCancel=function(){n.setState({isShowDeleteDialog:!n.state.isShowDeleteDialog})},n.deleteWiki=function(){var e=n.props.wiki;n.props.deleteWiki(e),n.setState({isShowDeleteDialog:!n.state.isShowDeleteDialog})},n.onItemUnshare=function(){var e=n.props.wiki;n.props.unshareGroupWiki(e,n.props.group.group_id),n.setState({isShowDeleteDialog:!n.state.isShowDeleteDialog})},n.renameWiki=function(e){n.props.wiki.name!==e&&n.props.renameWiki(n.props.wiki,e),n.setState({isShowRenameDialog:!1})},n.clickWikiCard=function(e){window.open(e)},n.toggleDropDownMenu=function(){n.setState({isItemMenuShow:!n.state.isItemMenuShow})},n.onClickDropdown=function(e){e.preventDefault(),e.stopPropagation()},n.renderAvatar=function(){var e=n.props.wiki,t=e.owner_nickname,r=e.owner_avatar_url;return(0,m.jsxs)("div",{className:"wiki-card-item-avatar-container",children:[(0,m.jsx)("img",{className:"wiki-card-item-avatar",src:r,alt:t}),(0,m.jsx)("span",{className:"wiki-card-item-owner text-truncate",title:t,children:t})]})},n.renderDept=function(){var e=n.props.wiki;return(0,m.jsxs)("div",{className:"wiki-card-item-avatar-container",children:[(0,m.jsx)("span",{className:"sf3-font-department sf3-font nav-icon"}),(0,m.jsx)("span",{className:"wiki-card-item-owner text-truncate",title:e.owner_nickname,children:e.owner_nickname})]})},n.state={isShowDeleteDialog:!1,isShowRenameDialog:!1,isItemMenuShow:!1,isShowShareDialog:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.wiki,n=e.isDepartment,r=e.isShowAvatar,o=!1;t.admins&&(o=t.admins.includes(h.Xh));var i=!1;this.props.group&&(i=t.owner.split("@")[0]===this.props.group.group_id.toString());var a=h.Xh===t.owner,s="v2"!==t.version,l="".concat(h.Yc,"published/").concat(encodeURIComponent(t.slug),"/"),c="".concat(h.Yc,"wikis/").concat(t.id,"/"),u=s?"".concat(t.name," (old version)"):t.name,d=!1,p=!1,f=!1,g=!1,v=!1;return n?o&&(i?(f=!0,p=!0,d=!0):g=!0):o||a?(p=!0,f=!0,d=!0):g=!0,(s||d||p||f||g)&&(v=!0),(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{className:"wiki-card-item ".concat(this.state.isItemMenuShow?"wiki-card-item-menu-open":""),onClick:this.clickWikiCard.bind(this,s?l:c),children:[(0,m.jsxs)("div",{className:"wiki-card-item-top",children:[(0,m.jsx)("span",{className:"sf3-font-wiki sf3-font","aria-hidden":"true"}),v&&(0,m.jsxs)(de.A,{isOpen:this.state.isItemMenuShow,toggle:this.toggleDropDownMenu,onClick:this.onClickDropdown,children:[(0,m.jsx)(pe.A,{tag:"i",role:"button",tabIndex:"0",className:"sf-dropdown-toggle sf3-font-more sf3-font",title:(0,h.AP)("More operations"),"aria-label":(0,h.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isItemMenuShow,"aria-haspopup":!0,style:{minWidth:"0"}}),(0,m.jsxs)(Ue.A,{right:!0,className:"dtable-dropdown-menu",children:[d&&(0,m.jsx)(he.A,{onClick:this.onRenameToggle,children:(0,h.AP)("Rename")}),p&&(0,m.jsx)(he.A,{onClick:this.onShareToggle,children:(0,h.AP)("Share")}),s&&(0,m.jsx)(he.A,{onClick:this.onDeleteToggle,children:(0,h.AP)("Unpublish")}),f&&(0,m.jsx)(he.A,{onClick:this.onDeleteToggle,children:(0,h.AP)("Delete")}),g&&(0,m.jsx)(he.A,{onClick:this.onDeleteToggle,children:(0,h.AP)("Leave")})]})]})]}),(0,m.jsx)("div",{className:"wiki-item-name text-truncate",title:u,"aria-label":u,children:u}),(0,m.jsx)("div",{className:"wiki-item-owner",children:r&&(n?this.renderDept():this.renderAvatar())}),(0,m.jsx)("div",{className:"wiki-item-updated-time",children:X()(t.updated_at).fromNow()})]}),this.state.isShowDeleteDialog&&(0,m.jsxs)(ne.A,{children:[s&&(0,m.jsx)(sv,{toggleCancel:this.onDeleteCancel,handleSubmit:this.deleteWiki,title:(0,h.AP)("Unpublish Wiki"),content:(0,m.jsxs)("p",{children:[(0,h.AP)("Are you sure you want to unpublish Wiki")," ",(0,m.jsx)("b",{children:t.name})," ?"]}),footer:(0,h.AP)("Unpublish")}),n&&i?(0,m.jsx)(sv,{toggleCancel:this.onDeleteCancel,handleSubmit:this.deleteWiki,title:(0,h.AP)("Delete Wiki"),content:(0,m.jsxs)("p",{children:[(0,h.AP)("Are you sure you want to delete Wiki")," ",(0,m.jsx)("b",{children:t.name})," ?"]}),footer:(0,h.AP)("Delete")}):n?(0,m.jsx)(sv,{toggleCancel:this.onDeleteCancel,handleSubmit:this.onItemUnshare,title:(0,h.AP)("Leave Share Wiki"),content:(0,m.jsxs)("p",{children:[(0,h.AP)("Are you sure you want to leave share Wiki")," ",(0,m.jsx)("b",{children:t.name})," ?"]}),footer:(0,h.AP)("Leave")}):a?(0,m.jsx)(sv,{toggleCancel:this.onDeleteCancel,handleSubmit:this.deleteWiki,title:(0,h.AP)("Delete Wiki"),content:(0,m.jsxs)("p",{children:[(0,h.AP)("Are you sure you want to delete Wiki")," ",(0,m.jsx)("b",{children:t.name})," ?"]}),footer:(0,h.AP)("Delete")}):(0,m.jsx)(sv,{toggleCancel:this.onDeleteCancel,handleSubmit:this.deleteWiki,title:(0,h.AP)("Leave Share Wiki"),content:(0,m.jsxs)("p",{children:[(0,h.AP)("Are you sure you want to leave share Wiki")," ",(0,m.jsx)("b",{children:t.name})," ?"]}),footer:(0,h.AP)("Leave")})]}),this.state.isShowRenameDialog&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(lv,{toggleCancel:this.onRenameToggle,onRename:this.renameWiki,wiki:t})}),this.state.isShowShareDialog&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(dv,{itemType:"library",itemName:t.name,itemPath:"/",repoID:t.repo_id,repoEncrypted:!1,enableDirPrivateShare:!0,toggleDialog:this.onShareToggle})})]})}}])}(s.Component);var hv=function(e){return(0,m.jsxs)("div",{className:"wiki-card-item wiki-card-item-add d-flex flex-column align-items-center justify-content-center",onClick:e.toggelAddWikiDialog,children:[(0,m.jsx)("span",{children:"+"}),(0,m.jsx)("span",{children:(0,h.AP)("Add Wiki")})]})},fv=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).getContainerWidth=function(){var e=n.props,t=e.sidePanelRate;return e.isSidePanelFolded?window.innerWidth-R.xQ:window.innerWidth*(1-t)},n.onResize=function(){if(!f.Fr){var e=n.getContainerWidth(),t=Math.floor(e/180),r=(Math.floor((e-16*(t+1))/t)+"px ").repeat(t);n.groupItemsRef.current&&(n.groupItemsRef.current.style.gridTemplateColumns=r)}},n.groupItemsRef=s.createRef(),n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.onResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onResize)}},{key:"render",value:function(){var e=this,t=this.props,n=t.wikis,r=t.title,o=t.isDepartment,i=t.toggelAddWikiDialog,a=t.group,s=this.getContainerWidth(),l=Math.floor(s/180),c=(Math.floor((s-16*(l+1))/l)+"px ").repeat(l),u=!1,d=!1;return a&&(u=!0,d="system admin"===a.owner),(0,m.jsxs)("div",{className:"wiki-card-group mb-4",children:[(0,m.jsxs)("h4",{className:"sf-heading",children:[(0,m.jsx)("span",{className:"sf3-font nav-icon sf3-font-".concat(o&&d?"department":o?"group":"mine"),"aria-hidden":"true"}),r]}),(0,m.jsxs)("div",{className:"wiki-card-group-items",style:{gridTemplateColumns:f.Fr?"48% 48%":c},ref:this.groupItemsRef,children:[n.map((function(t,n){return u?(0,m.jsx)(pv,{group:a,wiki:t,deleteWiki:e.props.deleteWiki,unshareGroupWiki:e.props.unshareGroupWiki,isDepartment:o,isShowAvatar:e.props.isShowAvatar,renameWiki:e.props.renameWiki},n+t.id+t.name):(0,m.jsx)(pv,{wiki:t,deleteWiki:e.props.deleteWiki,unshareGroupWiki:e.props.unshareGroupWiki,isDepartment:o,isShowAvatar:e.props.isShowAvatar,renameWiki:e.props.renameWiki},n+t.id+t.name)})),i&&(0,m.jsx)(hv,{toggelAddWikiDialog:i})]})]})}}])}(s.Component),mv=fv,gv=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).classifyWikis=function(e){for(var t=[],n=[],r=[],o={},i=0;i<e.length;i++)"v1"===e[i].version?t.push(e[i]):e[i].owner===h.Xh?n.push(e[i]):"shared"===e[i].type?r.push(e[i]):(o[e[i].owner]||(o[e[i].owner]=[]),o[e[i].owner].push(e[i]));return{department2WikisMap:o,myWikis:n,v1Wikis:t,sharedWikis:r}},n.state={departmentMap:{}},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;if(h.EL&&h.am){var t={};ov.A.listWikiDepartments().then((function(n){n.data.forEach((function(e){return t[e.id]=!0})),e.setState({departmentMap:t})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))}}},{key:"render",value:function(){var e=this.props.data,t=e.loading,n=e.errorMsg,r=e.wikis,o=e.groupWikis,i=this.props,a=i.toggelAddWikiDialog,s=i.sidePanelRate,l=i.isSidePanelFolded;if(t)return(0,m.jsx)("span",{className:"loading-icon loading-tip"});if(n)return(0,m.jsx)("p",{className:"error text-center",children:n});var c=this.classifyWikis(r),u=c.v1Wikis,d=c.myWikis,p=c.sharedWikis,f=[];for(var g in f.push((0,m.jsx)(mv,{deleteWiki:this.props.deleteWiki,renameWiki:this.props.renameWiki,unshareGroupWiki:this.props.unshareGroupWiki,sidePanelRate:s,isSidePanelFolded:l,wikis:d,title:(0,h.AP)("My Wikis"),isDepartment:!1,isShowAvatar:!1,toggelAddWikiDialog:h.EL?a.bind(this,null):null},"my-Wikis")),f.push((0,m.jsx)(mv,{deleteWiki:this.props.leaveSharedWiki,renameWiki:this.props.renameWiki,unshareGroupWiki:this.props.unshareGroupWiki,wikis:p,title:(0,h.AP)("Shared with me"),isDepartment:!1,isShowAvatar:!1,sidePanelRate:s,isSidePanelFolded:l,toggelAddWikiDialog:null},"shared-Wikis")),o)0!==o[g].wiki_info.length&&f.push((0,m.jsx)(mv,{deleteWiki:this.props.deleteWiki,unshareGroupWiki:this.props.unshareGroupWiki,renameWiki:this.props.renameWiki,sidePanelRate:s,isSidePanelFolded:l,group:o[g],wikis:o[g].wiki_info,title:o[g].group_name,isDepartment:!0,isShowAvatar:!1,toggelAddWikiDialog:h.EL&&this.state.departmentMap[o[g].group_id]?a.bind(this,g):null},"group-Wikis-"+g));return f.push((0,m.jsx)(mv,{deleteWiki:this.props.deleteWiki,renameWiki:this.props.renameWiki,unshareGroupWiki:this.props.unshareGroupWiki,isSidePanelFolded:l,sidePanelRate:s,wikis:u,title:(0,h.AP)("Old Wikis"),isDepartment:!1,isShowAvatar:!0},"old-Wikis")),f}}])}(s.Component),vv=gv,yv=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).getWikis=function(){var e=[],t=[];ov.A.listWikis().then((function(r){(e=e.concat(r.data.data)).map((function(e){return e.version="v1"})),ov.A.listWikis2().then((function(r){var o=r.data.wikis;(t=r.data.group_wikis).forEach((function(e){e.wiki_info.forEach((function(t){t.version="v2",t.admins=e.group_admins}))})),o.map((function(e){return e.version="v2"})),n.setState({loading:!1,wikis:e.concat(o),groupWikis:t})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.clickMenuToggle=function(e){e.preventDefault(),n.onMenuToggle()},n.onMenuToggle=function(){n.setState({isShowAddWikiMenu:!n.state.isShowAddWikiMenu})},n.toggelAddWikiDialog=function(e){n.state.isShowAddDialog?n.setState({isShowAddDialog:!1,currentDeptEmail:""}):n.setState({isShowAddDialog:!0,currentDeptEmail:e})},n.addWiki=function(e,t){ov.A.addWiki2(e,t).then((function(e){var r=n.state.wikis.slice(0),o=n.state.groupWikis,i=e.data;i.version="v2",t?o.filter((function(e){return e.group_id===t&&e.wiki_info.push(i),e})):r.push(i),n.setState({wikis:r,currentDeptEmail:"",groupWikis:o,currentDeptID:""})})).catch((function(e){if(e.response){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}}))},n.deleteWiki=function(e){"v1"===e.version?ov.A.deleteWiki(e.id).then((function(){var t=n.state.wikis.filter((function(t){return t.id!==e.id})),r=n.state.groupWikis.filter((function(t){return t.wiki_info=t.wiki_info.filter((function(t){return t.name!==e.name})),t}));n.setState({wikis:t,groupWikis:r})})).catch((function(e){if(e.response){var t=e.response.data.error_msg;j.A.danger(t)}})):ov.A.deleteWiki2(e.id).then((function(){var t=n.state.wikis.filter((function(t){return t.id!==e.id})),r=n.state.groupWikis.filter((function(t){return t.wiki_info=t.wiki_info.filter((function(t){return t.name!==e.name})),t}));n.setState({wikis:t,groupWikis:r})})).catch((function(e){if(e.response){var t=e.response.data.error_msg;j.A.danger(t)}}))},n.leaveSharedWiki=function(e){if(e.owner.includes("@seafile_group"))k.e.leaveShareGroupOwnedRepo(e.repo_id).then((function(t){var r=n.state.wikis.filter((function(t){return t.name!==e.name}));n.setState({wikis:r})})).catch((function(e){var t=f.Aq.getErrorMsg(e,!0);j.A.danger(t)}));else{var t={share_type:"personal",from:e.owner};k.e.leaveShareRepo(e.repo_id,t).then((function(t){var r=n.state.wikis.filter((function(t){return t.name!==e.name}));n.setState({wikis:r})})).catch((function(e){var t=f.Aq.getErrorMsg(e,!0);j.A.danger(t)}))}},n.unshareGroupWiki=function(e,t){k.e.unshareRepoToGroup(e.repo_id,t).then((function(){var r=n.state.groupWikis.map((function(n){return n.group_id===t?(0,Sr.A)((0,Sr.A)({},n),{},{wiki_info:n.wiki_info.filter((function(t){return t.name!==e.name}))}):n}));n.setState({groupWikis:r})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.renameWiki=function(e,t){"v1"===e.version?ov.A.renameWiki(e.id,t).then((function(){var r=n.state.wikis.map((function(n){return n.id===e.id&&"v1"===n.version&&(n.name=t),n}));n.setState({wikis:r})})).catch((function(e){if(e.response){var t=e.response.data.error_msg;j.A.danger(t)}})):ov.A.renameWiki2(e.id,t).then((function(){n.getWikis()})).catch((function(e){if(e.response){var t=e.response.data.error_msg;j.A.danger(t)}}))},n.toggleDropdownMenu=function(e){e.stopPropagation(),n.setState({isDropdownMenuShown:!n.state.isDropdownMenuShown})},n.state={loading:!0,errorMsg:"",currentDeptEmail:"",wikis:[],groupWikis:[],isShowAddWikiMenu:!1,isShowAddDialog:!1,isDropdownMenuShown:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.getWikis()}},{key:"render",value:function(){var e=this;return(0,m.jsxs)(s.Fragment,{children:[this.state.isShowAddDialog&&(0,m.jsx)(ne.A,{children:(0,m.jsx)(av,{toggleCancel:this.toggelAddWikiDialog,addWiki:this.addWiki,currentDeptEmail:this.state.currentDeptEmail})}),(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",id:"wikis",children:[(0,m.jsx)("div",{className:"cur-view-path",children:(0,m.jsxs)("div",{className:"path-container",children:[(0,m.jsx)("h3",{className:"sf-heading m-0",children:(0,h.AP)("Wikis")}),h.EL&&(0,m.jsxs)(de.A,{direction:"down",className:"add-wiki-dropdown",isOpen:this.state.isDropdownMenuShown,toggle:this.toggleDropdownMenu,onMouseMove:function(e){e.stopPropagation()},children:[(0,m.jsx)(pe.A,{tag:"i",className:"px-1",children:(0,m.jsx)("span",{className:"sf3-font sf3-font-down","aria-hidden":"true"})}),(0,m.jsx)(Ue.A,{positionFixed:!0,children:(0,m.jsx)(he.A,{onClick:function(){e.toggelAddWikiDialog()},children:(0,h.AP)("Add Wiki")})})]})]})}),(this.state.loading||0!==this.state.wikis.length||0!==this.state.groupWikis.length)&&(0,m.jsx)("div",{className:"cur-view-content pb-4",children:(0,m.jsx)(vv,{data:this.state,deleteWiki:this.deleteWiki,leaveSharedWiki:this.leaveSharedWiki,unshareGroupWiki:this.unshareGroupWiki,renameWiki:this.renameWiki,toggelAddWikiDialog:this.toggelAddWikiDialog,sidePanelRate:this.props.sidePanelRate,isSidePanelFolded:this.props.isSidePanelFolded})}),!this.state.loading&&0===this.state.wikis.length&&0===this.state.groupWikis.length&&(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsxs)(J.A,{title:(0,h.AP)("No Wikis"),children:[(0,m.jsx)("p",{className:"empty-tip-text",children:(0,h.AP)("You do not have any wikis yet.")}),(0,m.jsx)("p",{className:"empty-tip-text",children:(0,h.AP)('You can add a wiki by clicking the "Add Wiki" button in the menu.')})]})})]})})]})}}])}(s.Component),xv=yv,Av=function(e){function t(){var e;(0,r.A)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=(0,i.A)(this,t,[].concat(o))).toggle=function(){e.props.toggleDialog()},e}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return(0,m.jsx)(p.A,{isOpen:!0,toggle:this.toggle,children:(0,m.jsxs)(_.A,{children:[(0,m.jsx)("button",{type:"button",className:"close text-gray",onClick:this.toggle,children:(0,m.jsx)("span",{"aria-hidden":"true",children:"\xd7"})}),(0,m.jsxs)("div",{className:"p-2 text-center",children:[(0,m.jsx)("img",{src:"".concat(h.SG,"img/welcome.png"),width:"408",alt:""}),(0,m.jsx)("h3",{id:"dialogTitle",className:"mt-6 mb-4",children:(0,h.AP)("Welcome to {site_name_placeholder}").replace("{site_name_placeholder}",h.pu)}),h._s?(0,m.jsx)("p",{children:(0,h.AP)("{site_name_placeholder} organizes files into libraries. Each library can be synced and shared separately. We have created a personal library for you. You can create more libraries later.").replace("{site_name_placeholder}",h.pu)}):(0,m.jsx)("p",{children:(0,h.AP)("{site_name_placeholder} organizes files into libraries. Each library can be synced and shared separately. However, since you are a guest user now, you can not create libraries.").replace("{site_name_placeholder}",h.pu)})]})]})})}}])}(s.Component),Cv=Av,bv=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onItemUnshare=function(e){var t=n.props.group;k.e.unshareRepoToGroup(e.repo_id,t.id).then((function(){t.repos=t.repos.filter((function(t){return t.repo_id!==e.repo_id})),n.props.updateGroup(t)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.onItemDelete=function(e){var t=n.props.group;t.repos=t.repos.filter((function(t){return t.repo_id!==e.repo_id})),n.props.updateGroup(t)},n.onItemRename=function(e,t){var r=n.props.group;k.e.renameGroupOwnedLibrary(r.id,e.repo_id,t).then((function(r){var o=n.props.group;o.repos=o.repos.map((function(n){return n.repo_id===e.repo_id&&(n.repo_name=t),n})),n.props.updateGroup(o)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.onMonitorRepo=function(e,t){var r=n.props.group;r.repos=r.repos.map((function(n){return n.repo_id===e.repo_id&&(n.monitored=t),n})),n.props.updateGroup(r)},n.toggleCreateRepoDialog=function(){n.setState({isCreateRepoDialogOpen:!n.state.isCreateRepoDialogOpen})},n.onCreateRepo=function(e){var t=n.props.group,r=t.id,o=t.repos;k.e.createGroupOwnedLibrary(r,e).then((function(e){var r={repo_id:e.data.id,repo_name:e.data.name,owner_name:e.data.group_name,owner_email:e.data.owner,permission:e.data.permission,mtime:e.data.mtime,size:e.data.size,encrypted:e.data.encrypted},i=new Xe(r);o.unshift(i),n.props.updateGroup(t)})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)})),n.toggleCreateRepoDialog()},n.state={isCreateRepoDialogOpen:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.inAllLibs,n=void 0!==t&&t,r=e.group,o=e.currentViewMode,i=void 0===o?"list":o,a=r.parent_group_id,s=r.admins,l=(0,m.jsx)("p",{className:"libraries-empty-tip-in-".concat(i,"-mode"),children:(0,h.AP)("No libraries")}),c=0!=a&&s.indexOf(h.Xh)>-1;return(0,m.jsxs)("div",{className:"pb-3",children:[(0,m.jsx)("div",{className:"d-flex justify-content-between mt-3 py-1 ".concat("list"==i?"sf-border-bottom":""),children:(0,m.jsxs)("h4",{className:"sf-heading m-0 d-flex align-items-center",children:[(0,m.jsx)("span",{className:"".concat(0==r.parent_group_id?"sf3-font-group":"sf3-font-department"," sf3-font nav-icon"),"aria-hidden":"true"}),(0,m.jsx)("a",{href:"".concat(h.Yc,"group/").concat(r.id,"/"),title:r.name,className:"ellipsis",children:r.name}),c&&(0,m.jsx)(Be,{opList:[{text:(0,h.AP)("New Library"),onClick:this.toggleCreateRepoDialog}]})]})}),0===r.repos.length?l:(0,m.jsx)(Wn,{inAllLibs:n,theadHidden:!0,isShowRepoOwner:!1,currentGroup:this.props.group,repoList:r.repos,onItemUnshare:this.onItemUnshare,onItemDelete:this.onItemDelete,onItemRename:this.onItemRename,onMonitorRepo:this.onMonitorRepo,currentViewMode:i}),this.state.isCreateRepoDialogOpen&&(0,m.jsx)(En,{onCreateToggle:this.toggleCreateRepoDialog,onCreateRepo:this.onCreateRepo,libraryType:"department"})]})}}])}(s.Component),wv=bv,Sv=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).sortRepos=function(e,t){var r=f.Aq.sortRepos(e,n.state.sortBy,n.state.sortOrder),o=r.filter((function(e){return"mine"===e.type})),i=r.filter((function(e){return"shared"===e.type})),a=r.filter((function(e){return"public"===e.type}));return{allRepoList:r,myRepoList:o,sharedRepoList:i,publicRepoList:a,groupList:t.map((function(e){return e.repos=f.Aq.sortRepos(e.repos,n.state.sortBy,n.state.sortOrder),e}))}},n.toggleSortOptionsDialog=function(){n.setState({isSortOptionsDialogOpen:!n.state.isSortOptionsDialogOpen})},n.onCreateRepo=function(e){n.toggleCreateRepoDialog(),k.e.createMineRepo(e).then((function(e){var t=new Xe({repo_id:e.data.repo_id,repo_name:e.data.repo_name,size:e.data.repo_size,mtime:e.data.mtime,owner_email:e.data.email,encrypted:e.data.encrypted,permission:e.data.permission,storage_name:e.data.storage_name});n.state.repoList.unshift(t),n.setState({repoList:n.state.repoList})})).catch((function(e){var t=f.Aq.getErrorMsg(e);j.A.danger(t)}))},n.onSelectSortOption=function(e){var t=e.value.split("-"),r=(0,F.A)(t,2),o=r[0],i=r[1];n.setState({sortBy:o,sortOrder:i},(function(){localStorage.setItem("sf_repos_sort_by",o),localStorage.setItem("sf_repos_sort_order",i);var e=n.state,t=e.allRepoList,r=e.groupList,a=n.sortRepos(t,r),s=a.allRepoList,l=a.myRepoList,c=a.sharedRepoList,u=a.publicRepoList,d=a.groupList;n.setState({allRepoList:s,groupList:d,sharedRepoList:c,publicRepoList:u,repoList:l})}))},n.sortRepoList=function(e,t){Ke.Ay.save("seafile-repo-dir-sort-by",e),Ke.Ay.save("seafile-repo-dir-sort-order",t),n.setState({sortBy:e,sortOrder:t,repoList:f.Aq.sortRepos(n.state.repoList,e,t)})},n.onTransferRepo=function(e){var t=n.state.repoList.filter((function(t){return t.repo_id!==e}));n.setState({repoList:t})},n.onRenameRepo=function(e,t){var r=n.state.repoList.map((function(n){return n.repo_id===e.repo_id&&(n.repo_name=t),n}));n.setState({repoList:r})},n.onMonitorRepo=function(e,t){var r=n.state.repoList.map((function(n){return n.repo_id===e.repo_id&&(n.monitored=t),n}));n.setState({repoList:r})},n.onDeleteRepo=function(e){var t=n.state.repoList.filter((function(t){return t.repo_id!==e.repo_id}));n.setState({repoList:t})},n.toggleGuideForNewDialog=function(){window.app.pageOptions.guideEnabled=!1,n.setState({isGuideForNewDialogOpen:!1})},n.updateGroup=function(e){var t=n.state.groupList;n.setState({groupList:t.map((function(t){return t.id==e.id&&(t=e),t}))})},n.toggleCreateRepoDialog=function(){n.setState({isCreateRepoDialogOpen:!n.state.isCreateRepoDialogOpen})},n.switchViewMode=function(e){n.setState({currentViewMode:e},(function(){localStorage.setItem("sf_repo_list_view_mode",e)}))},n.sortOptions=[{value:"name-asc",text:(0,h.AP)("By name ascending")},{value:"name-desc",text:(0,h.AP)("By name descending")},{value:"time-asc",text:(0,h.AP)("By time ascending")},{value:"time-desc",text:(0,h.AP)("By time descending")}],n.state={errorMsg:"",isLoading:!0,repoList:[],isSortOptionsDialogOpen:!1,isGuideForNewDialogOpen:window.app.pageOptions.guideEnabled,groupList:[],sharedRepoList:[],publicRepoList:[],isCreateRepoDialogOpen:!1,currentViewMode:localStorage.getItem("sf_repo_list_view_mode")||"list",sortBy:localStorage.getItem("sf_repos_sort_by")||"name",sortOrder:localStorage.getItem("sf_repos_sort_order")||"asc"},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=k.e.listRepos({type:["mine","shared","public"]}),n=k.e.listGroups(!0);Promise.all([t,n]).then((function(t){var n=(0,F.A)(t,2),r=n[0],o=n[1],i=r.data.repos.map((function(e){return new Xe(e)})),a=o.data.map((function(e){var t=new M(e);return t.repos=e.repos.map((function(e){return new Xe(e)})),t})).sort((function(e,t){return e.name.toLowerCase()<t.name.toLowerCase()?-1:1})),s=e.sortRepos(i,a),l=s.allRepoList,c=s.myRepoList,u=s.sharedRepoList,d=s.publicRepoList,p=s.groupList;e.setState({isLoading:!1,allRepoList:l,groupList:p,sharedRepoList:u,publicRepoList:d,repoList:c})})).catch((function(t){e.setState({isLoading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.isLoading,r=t.currentViewMode,o=t.sortBy,i=t.sortOrder,a=f.Aq.isDesktop(),s=this.sortOptions.map((function(e){return(0,Sr.A)((0,Sr.A)({},e),{},{isSelected:e.value=="".concat(o,"-").concat(i)})}));return(0,m.jsx)(m.Fragment,{children:(0,m.jsxs)("div",{className:"main-panel-center flex-row",children:[(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsxs)("div",{className:"cur-view-path",children:[(0,m.jsx)("h3",{className:"sf-heading m-0",children:(0,h.AP)("Files")}),a&&(0,m.jsxs)("div",{className:"d-flex align-items-center",children:[(0,m.jsx)("div",{className:"mr-2",children:(0,m.jsx)(eo,{currentViewMode:r,switchViewMode:this.switchViewMode})}),(0,m.jsx)(no,{sortOptions:s,onSelectSortOption:this.onSelectSortOption})]})]}),n?(0,m.jsx)($.A,{}):(0,m.jsxs)("div",{className:"cur-view-content",id:"files-content-container",children:[f.Aq.isDesktop()&&"list"==r&&(0,m.jsx)("table",{"aria-hidden":!0,className:"my-3",children:(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"4%"}),(0,m.jsx)("th",{width:"3%",children:(0,m.jsx)("span",{className:"sr-only",children:(0,h.AP)("Library Type")})}),(0,m.jsx)("th",{width:"35%",children:(0,h.AP)("Name")}),(0,m.jsx)("th",{width:"10%",children:(0,m.jsx)("span",{className:"sr-only",children:(0,h.AP)("Actions")})}),(0,m.jsx)("th",{width:"14%",children:(0,h.AP)("Size")}),(0,m.jsx)("th",{width:"17%",children:(0,h.AP)("Last Update")}),(0,m.jsx)("th",{width:"17%",children:(0,h.AP)("Owner")})]})})}),h._s&&(0,m.jsxs)("div",{className:"pb-3",children:[(0,m.jsxs)("div",{className:"d-flex justify-content-between mt-3 py-1 ".concat("list"==r?"sf-border-bottom":""),children:[(0,m.jsxs)("h4",{className:"sf-heading m-0 d-flex align-items-center",children:[(0,m.jsx)("span",{className:"sf3-font-mine sf3-font nav-icon","aria-hidden":"true"}),(0,h.AP)("My Libraries"),(0,m.jsx)(Be,{opList:[{text:(0,h.AP)("New Library"),onClick:this.toggleCreateRepoDialog}]})]}),!f.Aq.isDesktop()&&this.state.repoList.length>0&&(0,m.jsx)("span",{className:"sf3-font sf3-font-sort action-icon",onClick:this.toggleSortOptionsDialog})]}),this.state.errorMsg?(0,m.jsx)("p",{className:"error text-center mt-8",children:this.state.errorMsg}):0===this.state.repoList.length?(0,m.jsx)("p",{className:"libraries-empty-tip-in-".concat(r,"-mode"),children:(0,h.AP)("No libraries")}):(0,m.jsx)(Tn,{sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,repoList:this.state.repoList,onRenameRepo:this.onRenameRepo,onDeleteRepo:this.onDeleteRepo,onTransferRepo:this.onTransferRepo,onMonitorRepo:this.onMonitorRepo,onRepoClick:this.onRepoClick,sortRepoList:this.sortRepoList,inAllLibs:!0,currentViewMode:r})]}),(0,m.jsx)("div",{className:"pb-3",children:(0,m.jsx)(ot,{repoList:this.state.sharedRepoList,inAllLibs:!0,currentViewMode:r})}),h.Yi&&(0,m.jsx)("div",{className:"pb-3",children:(0,m.jsx)(Zn,{repoList:this.state.publicRepoList,inAllLibs:!0,currentViewMode:r})}),(0,m.jsx)("div",{className:"group-list-panel",children:this.state.groupList.length>0&&this.state.groupList.map((function(t,n){return(0,m.jsx)(wv,{inAllLibs:!0,group:t,updateGroup:e.updateGroup,currentViewMode:r},n)}))})]})]}),!n&&!this.state.errorMsg&&this.state.isGuideForNewDialogOpen&&(0,m.jsx)(Cv,{toggleDialog:this.toggleGuideForNewDialog}),this.state.isSortOptionsDialogOpen&&(0,m.jsx)(Re,{toggleDialog:this.toggleSortOptionsDialog,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortRepoList}),this.state.isCreateRepoDialogOpen&&(0,m.jsx)(En,{libraryType:"mine",onCreateRepo:this.onCreateRepo,onCreateToggle:this.toggleCreateRepoDialog})]})})}}])}(s.Component),Dv=(n(16322),function(e){function t(e){var n;(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onpopstate=function(e){if(e.state&&e.state.currentTab&&e.state.pathPrefix){var t=e.state,r=t.currentTab,o=t.pathPrefix;n.setState({currentTab:r,pathPrefix:o})}},n.navigateClientUrlToLib=function(){if(window.location.hash&&-1!=window.location.hash.indexOf("common/lib")){var e=window.location.hash.split("/"),t=e[e.length-2],n=h.Yc+"library/"+t+"/";(0,c.oo)(n,{repalce:!0})}},n.onCloseSidePanel=function(){n.setState({isSidePanelClosed:!n.state.isSidePanelClosed})},n.onShowSidePanel=function(){n.setState({isSidePanelClosed:!n.state.isSidePanelClosed})},n.onSearchedClick=function(e){if(!0===e.is_dir){n.setState({currentTab:"",pathPrefix:[]});var t=h.Yc+"library/"+e.repo_id+"/"+e.repo_name+e.path;(0,c.oo)(t,{repalce:!0})}else{var r=h.Yc+"lib/"+e.repo_id+"/file"+f.Aq.encodePath(e.path);if(f.Aq.isWeChat())location.href=r;else window.open("about:blank").location.href=r}},n.onGroupChanged=function(e){setTimeout((function(){var t;t=e?h.Yc+"group/"+e+"/":h.Yc+"libraries/",window.location=t.toString()}),1)},n.tabItemClick=function(e,t){var r=[];(t||n.dirViewPanels.indexOf(e)>-1)&&(r=n.generatorPrefix(e,t)),n.setState({currentTab:e,pathPrefix:r},(function(){var e=n.state,t=e.currentTab,r=e.pathPrefix;window.history.replaceState({currentTab:t,pathPrefix:r},null)})),f.Aq.isDesktop()||n.state.isSidePanelClosed||n.setState({isSidePanelClosed:!0})},n.generatorPrefix=function(e,t){var r=[];if(t){var o={url:h.Yc+"group/"+t+"/",showName:e,name:e,id:t};r.push(o)}else{var i={url:h.Yc+e+"/",showName:n.getTabShowName(e),name:e,id:null};r.push(i)}return r},n.getTabShowName=function(e){switch(e){case"libraries":return"Files";case"my-libs":return"My Libraries";case"shared-libs":return"Shared with me";case"org":return"Shared with all"}},n.toggleSidePanel=function(){n.setState({isSidePanelClosed:!n.state.isSidePanelClosed})},n.toggleFoldSideNav=function(){n.setState({isSidePanelFolded:!n.state.isSidePanelFolded},(function(){localStorage.setItem("sf_user_side_nav_folded",n.state.isSidePanelFolded)}))},n.onResizeMouseUp=function(){n.state.inResizing&&n.setState({inResizing:!1}),localStorage.setItem("sf_side_panel_rate",n.state.sidePanelRate)},n.onResizeMouseDown=function(){n.setState({inResizing:!0})},n.onResizeMouseMove=function(e){var t=e.nativeEvent.clientX/window.innerWidth;n.setState({sidePanelRate:Math.max(Math.min(t,.4),.15)})},n.onResizeMouseOver=function(e){if(n.dragHandlerRef.current){var t=n.resizeBarRef.current.getBoundingClientRect().top,r=e.pageY-t-13;n.setDragHandlerTop(r)}},n.setDragHandlerTop=function(e){n.dragHandlerRef.current.style.top=e+"px"},"/groups/"===window.location.pathname&&(window.location.href=window.location.origin+"/libraries/"),n.state={isSidePanelClosed:!1,isSidePanelFolded:!f.Fr&&("true"==localStorage.getItem("sf_user_side_nav_folded")||!1),currentTab:"",pathPrefix:[],inResizing:!1,sidePanelRate:parseFloat(localStorage.getItem("sf_side_panel_rate")||V)},n.dirViewPanels=["libraries","my-libs","shared-libs","org"],window.onpopstate=n.onpopstate;var o=new x;return n.eventBus=o,n.resizeBarRef=s.createRef(),n.dragHandlerRef=s.createRef(),n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"UNSAFE_componentWillMount",value:function(){f.Aq.isDesktop()||this.setState({isSidePanelClosed:!0})}},{key:"componentDidMount",value:function(){var e;if(this.navigateClientUrlToLib(),location.pathname==h.Yc)e="libraries";else{var t=window.location.href.split("/");e=t[t.length-2]}this.setState({currentTab:e})}},{key:"render",value:function(){var e=this.state,t=e.currentTab,n=e.isSidePanelClosed,r=e.isSidePanelFolded,o=e.sidePanelRate,i=e.inResizing,a={},l={};return r||(a={userSelect:i?"none":"",flex:o?"1 0 ".concat(100*(1-o),"%"):"0 0 ".concat(78,"%")},l={userSelect:i?"none":"",flex:"0 0 ".concat(o?100*o:22,"%")}),(0,m.jsxs)(s.Fragment,{children:[(0,m.jsx)(v,{}),(0,m.jsx)(w,{isSidePanelClosed:n,onCloseSidePanel:this.onCloseSidePanel,onShowSidePanel:this.onShowSidePanel,onSearchedClick:this.onSearchedClick,eventBus:this.eventBus,isSidePanelFolded:r}),(0,m.jsxs)("div",{id:"main",className:"user-panel",onMouseMove:i?this.onResizeMouseMove:null,onMouseUp:this.onResizeMouseUp,children:[(0,m.jsx)(H,{isSidePanelClosed:n,isSidePanelFolded:r,onCloseSidePanel:this.onCloseSidePanel,currentTab:t,tabItemClick:this.tabItemClick,toggleFoldSideNav:this.toggleFoldSideNav,style:l,eventBus:this.eventBus}),f.Aq.isDesktop()&&!r&&(0,m.jsx)(G,{resizeBarRef:this.resizeBarRef,dragHandlerRef:this.dragHandlerRef,resizeBarStyle:{left:"calc(".concat(o?100*o+"%":"".concat(22,"%")," - 1px)")},dragHandlerStyle:{height:z},onResizeMouseDown:this.onResizeMouseDown,onResizeMouseOver:this.onResizeMouseOver}),(0,m.jsx)("div",{className:"main-panel",style:a,children:(0,m.jsxs)(c.Ix,{className:"reach-router",children:[(0,m.jsx)(Sv,{path:h.Yc}),(0,m.jsx)(Sv,{path:h.Yc+"libraries"}),(0,m.jsx)(Un,{path:h.Yc+"my-libs"}),(0,m.jsx)(Hn,{path:h.Yc+"my-libs/deleted/"}),(0,m.jsx)(He,{path:h.Yc+"share-admin-share-links"}),(0,m.jsx)(We,{path:h.Yc+"share-admin-upload-links"}),(0,m.jsx)(Zn,{path:h.Yc+"org/"}),(0,m.jsx)(xv,{path:h.Yc+"published",sidePanelRate:o,isSidePanelFolded:r}),(0,m.jsx)(ve,{path:h.Yc+"starred"}),(0,m.jsx)(rv,{path:h.Yc+"invitations/"}),(0,m.jsx)(le,{path:h.Yc+"dashboard"}),(0,m.jsx)(ue,{path:h.Yc+"my-activities"}),(0,m.jsx)($g,{path:h.Yc+"group/:groupID",onGroupChanged:this.onGroupChanged}),(0,m.jsx)(Ce,{path:h.Yc+"linked-devices"}),(0,m.jsx)(je,{path:h.Yc+"share-admin-libs"}),(0,m.jsx)(Ne,{path:h.Yc+"share-admin-folders"}),(0,m.jsx)(ot,{path:h.Yc+"shared-libs"}),(0,m.jsx)(st,{path:h.Yc+"shared-with-ocm"}),(0,m.jsx)(pt,{path:h.Yc+"ocm-via-webdav"}),(0,m.jsx)(xt,{path:h.Yc+"remote-library/:providerID/:repoID/*",pathPrefix:this.state.pathPrefix,onTabNavClick:this.tabItemClick}),(0,m.jsx)(Rg,{path:h.Yc+"library/:repoID/*",pathPrefix:this.state.pathPrefix,isSidePanelFolded:r,onTabNavClick:this.tabItemClick,eventBus:this.eventBus})]})}),(0,m.jsx)(d(),{query:"(max-width: 767.8px)",children:(0,m.jsx)(p.A,{zIndex:"1030",isOpen:!n,toggle:this.toggleSidePanel,contentClassName:"d-none"})})]})]})}}])}(s.Component));l.render((0,m.jsx)(Dv,{}),document.getElementById("wrapper"))},99730:function(e,t,n){"use strict";n.d(t,{A:function(){return s}});n(9950);var r=n(48738),o=n.n(r),i=n(44414);function a(e){var t=e.onChange,n=e.checked,r=e.placeholder,a=e.disabled,s=e.className,l=e.size,c=e.textPosition,u=e.setRef;return(0,i.jsx)("div",{className:o()("seahub-switch position-relative",s,l),ref:u,children:(0,i.jsxs)("label",{className:"custom-switch",children:[(0,i.jsx)("input",{className:"custom-switch-input",type:"checkbox",checked:n,onChange:t,name:"custom-switch-checkbox",disabled:a}),"left"===c&&(0,i.jsx)("span",{className:"custom-switch-description text-truncate",children:r}),(0,i.jsx)("span",{className:o()("custom-switch-indicator",{disabled:a})}),"right"===c&&(0,i.jsx)("span",{className:"custom-switch-description text-truncate",children:r})]})})}a.defaultProps={textPosition:"left"};var s=a},46757:function(e,t,n){"use strict";n.d(t,{$e:function(){return s},E8:function(){return a},db:function(){return c},ks:function(){return u}});var r=n(26470),o=n.n(r),i=n(31095),a="REACT_CONTEXTMENU_SHOW",s="REACT_CONTEXTMENU_HIDE";function l(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;"function"===typeof window.CustomEvent?n=new window.CustomEvent(e,{detail:t}):(n=document.createEvent("CustomEvent")).initCustomEvent(e,!1,!0,t),r&&(r.dispatchEvent(n),o()(i.M_,t))}function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;l(a,o()({},e,{type:a}),t)}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;l(s,o()({},e,{type:s}),t)}},29009:function(e,t,n){"use strict";var r=n(23029),o=n(92901),i=n(39874),a=n(85501),s=n(9950),l=n(19260),c=n(6030),u=n(33151),d=n(68879),p=n(92795),h=n(46757),f=n(31095),m=n(65604),g=n(44414),v=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).registerHandlers=function(){document.addEventListener("mousedown",n.handleOutsideClick),document.addEventListener("touchstart",n.handleOutsideClick),document.addEventListener("scroll",n.handleHide),document.addEventListener("contextmenu",n.handleHide),document.addEventListener("keydown",n.handleKeyNavigation),window.addEventListener("resize",n.handleHide)},n.unregisterHandlers=function(){document.removeEventListener("mousedown",n.handleOutsideClick),document.removeEventListener("touchstart",n.handleOutsideClick),document.removeEventListener("scroll",n.handleHide),document.removeEventListener("contextmenu",n.handleHide),document.removeEventListener("keydown",n.handleKeyNavigation),window.removeEventListener("resize",n.handleHide)},n.handleShow=function(e){if(e.detail.id===n.props.id){var t=e.detail.position,r=t.x,o=t.y;if(n.props.getMenuContainerSize){var i=n.props.getMenuContainerSize(),a=r-(window.innerWidth-parseFloat(i.width)),s=o-(window.innerHeight-parseFloat(i.height));n.setState({x:a,y:s})}else n.setState({x:r,y:o});var l=e.detail,c=l.currentObject,u=l.menuList;n.setState({isVisible:!0,currentObject:c,menuList:u}),n.registerHandlers(),(0,f._$)(n.props.onShowMenu,e)}},n.handleHide=function(e){!n.state.isVisible||e.detail&&e.detail.id&&e.detail.id!==n.props.id||(n.unregisterHandlers(),n.setState({isVisible:!1}),(0,f._$)(n.props.onHideMenu,e))},n.handleOutsideClick=function(e){n.menu.contains(e.target)||(0,h.ks)()},n.handleMouseLeave=function(e){e.preventDefault()},n.handleContextMenu=function(e){n.handleHide(e)},n.handleKeyNavigation=function(e){!1!==n.state.isVisible&&(e.preventDefault(),n.hideMenu(e))},n.hideMenu=function(e){27!==e.keyCode&&13!==e.keyCode||(0,h.ks)()},n.getMenuPosition=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r={top:t,left:e};if(!n.menu)return r;var o=window,i=o.innerWidth,a=o.innerHeight,s=n.menu.getBoundingClientRect();if(n.props.getMenuContainerSize){var l=n.props.getMenuContainerSize();i=parseFloat(l.width),a=parseFloat(l.height)}return t+s.height>a-10&&(r.top=a-s.height-10),e+s.width>i-10&&(r.left=i-s.width-10),r.left<0&&(r.left=s.width<i?(i-s.width)/2:0),r.top<0&&(r.top=s.height<a?(a-s.height)/2:0),r},n.onMenuItemClick=function(e){e.stopPropagation();var t=m.Aq.getEventData(e,"operation"),r=n.state.currentObject;n.props.onMenuItemClick(t,r,e)},n.onContextMenu=function(e){e.stopPropagation()},n.onDropDownMouseMove=function(e){n.state.isSubMenuShown&&e.target&&"dropdown-item"===e.target.className&&n.setState({isSubMenuShown:!1})},n.toggleSubMenu=function(e){e.stopPropagation(),n.setState({isSubMenuShown:!n.state.isSubMenuShown})},n.toggleSubMenuShown=function(e){n.setState({isSubMenuShown:!0,currentItem:e.key})},n.state={x:0,y:0,isVisible:!1,currentObject:null,menuList:[],isSubMenuShown:!1,currentItem:""},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.listenId=p.A.register(this.handleShow,this.handleHide)}},{key:"componentDidUpdate",value:function(){var e=this;if(this.state.isVisible){var t=window.requestAnimationFrame||setTimeout;t((function(){var n=e.state,r=n.x,o=n.y,i=e.getMenuPosition(r,o),a=i.top,s=i.left;t((function(){e.menu&&(e.menu.style.top="".concat(a,"px"),e.menu.style.left="".concat(s,"px"),e.menu.style.opacity=1,e.menu.style.pointerEvents="auto")}))}))}else{if(!this.menu)return;this.menu.style.opacity=0,this.menu.style.pointerEvents="none"}}},{key:"componentWillUnmount",value:function(){this.listenId&&p.A.unregister(this.listenId),this.unregisterHandlers()}},{key:"render",value:function(){var e=this;return(0,g.jsx)("div",{role:"menu",className:"seafile-contextmenu dropdown-menu",style:{position:"fixed",opacity:0,pointerEvents:"none",display:"block"},ref:function(t){e.menu=t},children:this.state.menuList.map((function(t,n){return"Divider"===t?(0,g.jsx)("div",{className:"seafile-divider dropdown-divider"},n):t.subOpList?(0,g.jsxs)(l.A,{direction:"right",className:"w-100",isOpen:e.state.isSubMenuShown&&e.state.currentItem==t.key,toggle:e.toggleSubMenu,onMouseMove:function(e){e.stopPropagation()},children:[(0,g.jsxs)(c.A,{tag:"div",className:"dropdown-item font-weight-normal rounded-0 d-flex align-items-center",onMouseEnter:e.toggleSubMenuShown.bind(e,t),children:[(0,g.jsx)("span",{className:"mr-auto",children:t.value}),(0,g.jsx)("i",{className:"sf3-font-down sf3-font rotate-270"})]}),(0,g.jsx)(u.A,{children:t.subOpList.map((function(t,n){return"Divider"==t?(0,g.jsx)(d.A,{divider:!0},n):(0,g.jsx)(d.A,{"data-operation":t.key,onClick:e.onMenuItemClick,onContextMenu:e.onContextMenu,children:t.value},n)}))})]},n):(0,g.jsx)("button",{className:"seafile-contextmenu-item dropdown-item","data-operation":t.key,onClick:e.onMenuItemClick,onContextMenu:e.onContextMenu,children:t.value},n)}))})}}])}(s.Component);t.A=v},92795:function(e,t,n){"use strict";var r=n(92901),o=n(23029),i=n(46757),a=n(31095),s=new((0,r.A)((function e(){var t=this;(0,o.A)(this,e),this.handleShowEvent=function(e){for(var n in t.callbacks)(0,a.YP)(t.callbacks,n)&&t.callbacks[n].show(e)},this.handleHideEvent=function(e){for(var n in t.callbacks)(0,a.YP)(t.callbacks,n)&&t.callbacks[n].hide(e)},this.register=function(e,n){var r=(0,a.NF)();return t.callbacks[r]={show:e,hide:n},r},this.unregister=function(e){e&&t.callbacks[e]&&delete t.callbacks[e]},this.callbacks={},a.Sw&&(window.addEventListener(i.E8,this.handleShowEvent),window.addEventListener(i.$e,this.handleHideEvent))})));t.A=s},31095:function(e,t,n){"use strict";function r(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return"function"===typeof e&&e.apply(void 0,n)}function o(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function i(){return Math.random().toString(36).substring(7)}n.d(t,{M_:function(){return a},NF:function(){return i},Sw:function(){return s},YP:function(){return o},_$:function(){return r}});var a={},s=Boolean("undefined"!==typeof window&&window.document&&window.document.createElement)},68849:function(e,t,n){"use strict";var r=n(23029),o=n(92901),i=n(39874),a=n(85501),s=n(9950),l=n(58195),c=n(14113),u=n(99308),d=n(85907),p=n(20015),h=n(40326),f=n(97011),m=n(65604),g=n(4086),v=n(44414),y=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).handleInputChange=function(e){n.setState({inputValue:e})},n.formSubmit=function(){var e=n.state.inputValue,t=n.props.repoID;n.setState({submitBtnDisabled:!0}),f.e.deleteRepoTrash(t,e.value).then((function(e){g.A.success((0,h.AP)("Clean succeeded.")),n.props.refreshTrash(),n.props.toggleDialog()})).catch((function(e){var t=m.Aq.getErrorMsg(e);n.setState({formErrorMsg:t,submitBtnDisabled:!1})}))},n.options=[{label:(0,h.AP)("3 days ago"),value:3},{label:(0,h.AP)("1 week ago"),value:7},{label:(0,h.AP)("1 month ago"),value:30},{label:(0,h.AP)("all"),value:0}],n.state={inputValue:n.options[0],submitBtnDisabled:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.state.formErrorMsg;return(0,v.jsxs)(l.A,{isOpen:!0,centered:!0,toggle:this.props.toggleDialog,children:[(0,v.jsx)(c.A,{toggle:this.props.toggleDialog,children:(0,h.AP)("Clean")}),(0,v.jsx)(u.A,{children:(0,v.jsxs)(s.Fragment,{children:[(0,v.jsx)("p",{children:(0,h.AP)("Clear files in trash and history\uff1a")}),(0,v.jsx)(p.A,{defaultValue:this.options[0],options:this.options,autoFocus:!1,onChange:this.handleInputChange,placeholder:""}),e&&(0,v.jsx)("p",{className:"error m-0 mt-2",children:e})]})}),(0,v.jsx)(d.A,{children:(0,v.jsx)("button",{className:"btn btn-primary",disabled:this.state.submitBtnDisabled,onClick:this.formSubmit,children:(0,h.AP)("Submit")})})]})}}])}(s.Component);t.A=y},21870:function(e,t,n){"use strict";var r=n(23029),o=n(92901),i=n(39874),a=n(85501),s=n(9950),l=n(58195),c=n(14113),u=n(99308),d=n(76152),p=n(55627),h=n(85077),f=n(85907),m=n(18849),g=n(40326),v=n(44414),y=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).toggle=function(){n.props.toggleDialog()},n.executeOperation=function(){n.toggle(),n.props.executeOperation(n.state.isChecked)},n.onInputChange=function(e){n.setState({isChecked:e.target.checked})},n.state={isChecked:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return(0,v.jsxs)(l.A,{isOpen:!0,toggle:this.toggle,children:[(0,v.jsx)(c.A,{toggle:this.toggle,children:(0,g.AP)("Unlink device")}),(0,v.jsxs)(u.A,{children:[(0,v.jsx)("p",{children:(0,g.AP)("Are you sure you want to unlink this device?")}),(0,v.jsx)(d.A,{check:!0,children:(0,v.jsxs)(p.A,{check:!0,children:[(0,v.jsx)(h.A,{type:"checkbox",checked:this.state.isChecked,onChange:this.onInputChange}),(0,v.jsx)("span",{children:(0,g.AP)("Delete files from this device the next time it comes online.")})]})})]}),(0,v.jsxs)(f.A,{children:[(0,v.jsx)(m.A,{color:"secondary",onClick:this.toggle,children:(0,g.AP)("Cancel")}),(0,v.jsx)(m.A,{color:"primary",onClick:this.executeOperation,children:(0,g.AP)("Unlink")})]})]})}}])}(s.Component);t.A=y},88002:function(e,t,n){"use strict";n.d(t,{A:function(){return f}});var r=n(23029),o=n(92901),i=n(39874),a=n(85501),s=n(9950),l=n(58195),c=n(14113),u=n(99308),d=n(40326),p=n(44414),h=function(e){function t(){return(0,r.A)(this,t),(0,i.A)(this,t,arguments)}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.type,n=e.asyncOperationProgress,r=e.asyncOperatedFilesLength,o="move"===t?(0,d.AP)("Move {num} items"):(0,d.AP)("Copy {num} items");o=o.replace("{num}",r);var i={width:n+"%",lineHeight:"40px",textAlign:"left"};return(0,p.jsxs)(l.A,{isOpen:!0,toggle:this.props.toggleDialog,className:"copy-move-dirent-progress-dialog",children:[(0,p.jsx)(c.A,{toggle:this.props.toggleDialog,children:o}),(0,p.jsx)(u.A,{children:(0,p.jsx)("div",{className:"progress",children:(0,p.jsx)("div",{className:"progress-bar pl-2",role:"progressbar",style:i,"aria-valuenow":n,"aria-valuemin":"0","aria-valuemax":"100",children:n+"%"})})})]})}}])}(s.Component),f=h},56999:function(e,t,n){"use strict";var r=n(23029),o=n(92901),i=n(39874),a=n(85501),s=n(9950),l=n(58195),c=n(14113),u=n(99308),d=n(19247),p=n(76152),h=n(55627),f=n(85077),m=n(76115),g=n(85907),v=n(18849),y=n(40326),x=n(65604),A=n(44414),C=function(e){function t(e){var n;(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).isSdocSuffix=function(e){return e.endsWith(".sdoc")},n.handleChange=function(e){e.target.value.trim()?n.setState({isSubmitBtnActive:!0}):n.setState({isSubmitBtnActive:!1}),n.setState({childName:e.target.value})},n.handleSubmit=function(){if(n.state.isSubmitBtnActive){var e=n.checkDuplicatedName(),t=n.state.childName;if(e){var r=(0,y.AP)('The name "{name}" is already taken. Please choose a different name.');r=r.replace("{name}",x.Aq.HTMLescape(t)),n.setState({errMessage:r})}else{var o=n.state.parentPath+t;n.props.onAddFile(o),n.props.toggleDialog()}}},n.handleKeyDown=function(e){"Enter"===e.key&&(n.handleSubmit(),e.preventDefault())},n.checkDuplicatedName=function(){return n.props.checkDuplicatedName(n.state.childName)},n.onAfterModelOpened=function(){n.newInput.current&&(n.newInput.current.focus(),n.newInput.current.setSelectionRange(0,0))};var o=e.fileType,a=void 0===o?"":o;return n.state={parentPath:"",childName:a,errMessage:"",isSubmitBtnActive:!!n.isSdocSuffix(a)},n.newInput=s.createRef(),n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this.props.parentPath;"/"===e[e.length-1]?this.setState({parentPath:e}):this.setState({parentPath:e+"/"})}},{key:"render",value:function(){var e=this.props.toggleDialog;return(0,A.jsxs)(l.A,{isOpen:!0,toggle:e,onOpened:this.onAfterModelOpened,children:[(0,A.jsx)(c.A,{toggle:e,children:(0,y.AP)("New File")}),(0,A.jsxs)(u.A,{children:[(0,A.jsx)(d.A,{children:(0,A.jsxs)(p.A,{children:[(0,A.jsx)(h.A,{for:"fileName",children:(0,y.AP)("Name")}),(0,A.jsx)(f.A,{id:"fileName",onKeyDown:this.handleKeyDown,innerRef:this.newInput,value:this.state.childName,onChange:this.handleChange})]})}),this.state.errMessage&&(0,A.jsx)(m.A,{color:"danger",className:"mt-2",children:this.state.errMessage})]}),(0,A.jsxs)(g.A,{children:[(0,A.jsx)(v.A,{color:"secondary",onClick:e,children:(0,y.AP)("Cancel")}),(0,A.jsx)(v.A,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive,children:(0,y.AP)("Submit")})]})]})}}])}(s.Component);t.A=C},81617:function(e,t,n){"use strict";var r=n(23029),o=n(92901),i=n(39874),a=n(85501),s=n(9950),l=n(58195),c=n(14113),u=n(99308),d=n(19247),p=n(76152),h=n(55627),f=n(85077),m=n(76115),g=n(85907),v=n(18849),y=n(40326),x=n(65604),A=n(44414),C=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).handleChange=function(e){e.target.value.trim()?n.setState({isSubmitBtnActive:!0}):n.setState({isSubmitBtnActive:!1}),n.setState({childName:e.target.value})},n.handleSubmit=function(){if(n.state.isSubmitBtnActive){var e=n.state.childName;if(n.checkDuplicatedName()){var t=(0,y.AP)('The name "{name}" is already taken. Please choose a different name.');t=t.replace("{name}",x.Aq.HTMLescape(e)),n.setState({errMessage:t})}else{var r=n.state.parentPath+e;n.props.onAddFolder(r)}}},n.handleKeyDown=function(e){"Enter"===e.key&&(n.handleSubmit(),e.preventDefault())},n.toggle=function(){n.props.addFolderCancel()},n.checkDuplicatedName=function(){return n.props.checkDuplicatedName(n.state.childName)},n.state={parentPath:"",childName:"",errMessage:"",isSubmitBtnActive:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this.props.parentPath;"/"===e[e.length-1]?this.setState({parentPath:e}):this.setState({parentPath:e+"/"})}},{key:"render",value:function(){return(0,A.jsxs)(l.A,{isOpen:!0,toggle:this.toggle,autoFocus:!1,children:[(0,A.jsx)(c.A,{toggle:this.toggle,children:(0,y.AP)("New Folder")}),(0,A.jsxs)(u.A,{children:[(0,A.jsx)(d.A,{children:(0,A.jsxs)(p.A,{children:[(0,A.jsx)(h.A,{for:"folderName",children:(0,y.AP)("Name")}),(0,A.jsx)(f.A,{id:"folderName",value:this.state.childName,onKeyDown:this.handleKeyDown,onChange:this.handleChange,autoFocus:!0})]})}),this.state.errMessage&&(0,A.jsx)(m.A,{color:"danger",className:"mt-2",children:this.state.errMessage})]}),(0,A.jsxs)(g.A,{children:[(0,A.jsx)(v.A,{color:"secondary",onClick:this.toggle,children:(0,y.AP)("Cancel")}),(0,A.jsx)(v.A,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive,children:(0,y.AP)("Submit")})]})]})}}])}(s.Component);t.A=C},60472:function(e,t,n){"use strict";n.d(t,{A:function(){return F}});var r=n(23029),o=n(92901),i=n(39874),a=n(85501),s=n(9950),l=n(40326),c=n(11942),u=n.n(c),d=n(34806),p=n.n(d);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,k(r.key),r)}}function g(e,t,n){return(t=k(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(){return v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},v.apply(this,arguments)}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}function x(e,t){return x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},x(e,t)}function A(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y(e);if(t){var o=y(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return A(e)}(this,n)}}function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],l=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(u){c=!0,o=u}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return s}}(e,t)||S(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e){return function(e){if(Array.isArray(e))return D(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||S(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){if(e){if("string"===typeof e)return D(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?D(e,t):void 0}}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function k(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}function M(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e)return"";var n=e;return t&&Object.keys(t).forEach((function(e){n=n.replace(e,t[e])})),n}function j(){return"undefined"!==typeof n.g.window?n.g.window.innerWidth:0}function I(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.g.window.self,t=e.document.referrer;if(e===n.g.window.top||!t)return e;var r=function(e){return e.match(/(.*\/\/.*?)(\/|$)/)[1]};return r(e.location.href)===r(t)?I(e.parent):e}var _=300,P=27,N=37,O=39,T=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&x(e,t)}(a,e);var t,r,o,i=C(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),g(A(t=i.call(this,e)),"handleWheel",(function(e){e.preventDefault()})),t.state={isClosing:!e.animationDisabled,shouldAnimate:!1,zoomLevel:0,offsetX:0,offsetY:0,loadErrorStatus:{},rotateDeg:0},t.outerEl=s.createRef(),t.zoomInBtn=s.createRef(),t.zoomOutBtn=s.createRef(),t.caption=s.createRef(),t.closeIfClickInner=t.closeIfClickInner.bind(A(t)),t.handleImageDoubleClick=t.handleImageDoubleClick.bind(A(t)),t.handleImageClick=t.handleImageClick.bind(A(t)),t.handleImageMouseWheel=t.handleImageMouseWheel.bind(A(t)),t.handleKeyInput=t.handleKeyInput.bind(A(t)),t.handleMouseUp=t.handleMouseUp.bind(A(t)),t.handleMouseDown=t.handleMouseDown.bind(A(t)),t.handleMouseMove=t.handleMouseMove.bind(A(t)),t.handleOuterMousewheel=t.handleOuterMousewheel.bind(A(t)),t.handleTouchStart=t.handleTouchStart.bind(A(t)),t.handleTouchMove=t.handleTouchMove.bind(A(t)),t.handleTouchEnd=t.handleTouchEnd.bind(A(t)),t.handlePointerEvent=t.handlePointerEvent.bind(A(t)),t.handleCaptionMousewheel=t.handleCaptionMousewheel.bind(A(t)),t.handleWindowResize=t.handleWindowResize.bind(A(t)),t.handleZoomInButtonClick=t.handleZoomInButtonClick.bind(A(t)),t.handleZoomOutButtonClick=t.handleZoomOutButtonClick.bind(A(t)),t.requestClose=t.requestClose.bind(A(t)),t.requestMoveNext=t.requestMoveNext.bind(A(t)),t.requestMovePrev=t.requestMovePrev.bind(A(t)),t.rotateImage=t.rotateImage.bind(A(t)),t}return t=a,r=[{key:"UNSAFE_componentWillMount",value:function(){this.timeouts=[],this.currentAction=0,this.eventsSource=0,this.pointerList=[],this.preventInnerClose=!1,this.preventInnerCloseTimeout=null,this.keyPressed=!1,this.imageCache={},this.lastKeyDownTime=0,this.resizeTimeout=null,this.wheelActionTimeout=null,this.resetScrollTimeout=null,this.scrollX=0,this.scrollY=0,this.moveStartX=0,this.moveStartY=0,this.moveStartOffsetX=0,this.moveStartOffsetY=0,this.swipeStartX=0,this.swipeStartY=0,this.swipeEndX=0,this.swipeEndY=0,this.pinchTouchList=null,this.pinchDistance=0,this.keyCounter=0,this.moveRequested=!1,this.props.animationDisabled||this.setState({isClosing:!1})}},{key:"componentDidMount",value:function(){var e=this;this.windowContext=I(),this.listeners={resize:this.handleWindowResize,mouseup:this.handleMouseUp,touchend:this.handleTouchEnd,touchcancel:this.handleTouchEnd,pointerdown:this.handlePointerEvent,pointermove:this.handlePointerEvent,pointerup:this.handlePointerEvent,pointercancel:this.handlePointerEvent},Object.keys(this.listeners).forEach((function(t){e.windowContext.addEventListener(t,e.listeners[t])})),document.addEventListener("wheel",this.handleWheel,{passive:!1}),this.loadAllImages()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this,n=!1,r={},o={};this.getSrcTypes().forEach((function(i){t.props[i.name]!==e[i.name]&&(n=!0,r[t.props[i.name]]=!0,o[e[i.name]]=!0)})),(n||this.moveRequested)&&(Object.keys(r).forEach((function(e){!(e in o)&&e in t.imageCache&&(t.imageCache[e].loaded=!1)})),this.moveRequested=!1,this.loadAllImages(e))}},{key:"shouldComponentUpdate",value:function(){return!this.moveRequested}},{key:"componentWillUnmount",value:function(){var e=this;this.didUnmount=!0,Object.keys(this.listeners).forEach((function(t){e.windowContext.removeEventListener(t,e.listeners[t])})),document.removeEventListener("wheel",this.handleWheel,{passive:!1}),this.timeouts.forEach((function(e){return clearTimeout(e)}))}},{key:"setTimeout",value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){var n=this,r=setTimeout((function(){n.timeouts=n.timeouts.filter((function(e){return e!==r})),e()}),t);return this.timeouts.push(r),r}))},{key:"setPreventInnerClose",value:function(){var e=this;this.preventInnerCloseTimeout&&this.clearTimeout(this.preventInnerCloseTimeout),this.preventInnerClose=!0,this.preventInnerCloseTimeout=this.setTimeout((function(){e.preventInnerClose=!1,e.preventInnerCloseTimeout=null}),100)}},{key:"getBestImageForType",value:function(e){var t=this.props[e],n={};if(this.isImageLoaded(t))n=this.getFitSizes(this.imageCache[t].width,this.imageCache[t].height);else{if(!this.isImageLoaded(this.props["".concat(e,"Thumbnail")]))return null;t=this.props["".concat(e,"Thumbnail")],n=this.getFitSizes(this.imageCache[t].width,this.imageCache[t].height,!0)}return{src:t,height:this.imageCache[t].height,width:this.imageCache[t].width,targetHeight:n.height,targetWidth:n.width}}},{key:"getFitSizes",value:function(e,t,n){var r=this.getLightboxRect(),o=r.height-2*this.props.imagePadding,i=r.width-2*this.props.imagePadding;return n||(o=Math.min(o,t),i=Math.min(i,e)),i/o>e/t?{width:e*o/t,height:o}:{width:i,height:t*i/e}}},{key:"getMaxOffsets",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.zoomLevel,t=this.getBestImageForType("mainSrc");if(null===t)return{maxX:0,minX:0,maxY:0,minY:0};var n=this.getLightboxRect(),r=this.getZoomMultiplier(e),o=0,i=0;return{maxX:o=r*t.width-n.width<0?(n.width-r*t.width)/2:(r*t.width-n.width)/2,maxY:i=r*t.height-n.height<0?(n.height-r*t.height)/2:(r*t.height-n.height)/2,minX:-1*o,minY:-1*i}}},{key:"getSrcTypes",value:function(){return[{name:"mainSrc",keyEnding:"i".concat(this.keyCounter)},{name:"mainSrcThumbnail",keyEnding:"t".concat(this.keyCounter)},{name:"nextSrc",keyEnding:"i".concat(this.keyCounter+1)},{name:"nextSrcThumbnail",keyEnding:"t".concat(this.keyCounter+1)},{name:"prevSrc",keyEnding:"i".concat(this.keyCounter-1)},{name:"prevSrcThumbnail",keyEnding:"t".concat(this.keyCounter-1)}]}},{key:"getZoomMultiplier",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.zoomLevel;return Math.pow(1.007,e)}},{key:"getLightboxRect",value:function(){return this.outerEl.current?this.outerEl.current.getBoundingClientRect():{width:j(),height:"undefined"!==typeof n.g.window?n.g.window.innerHeight:0,top:0,right:0,bottom:0,left:0}}},{key:"clearTimeout",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){this.timeouts=this.timeouts.filter((function(t){return t!==e})),clearTimeout(e)}))},{key:"changeZoom",value:function(e,t,n){if(this.props.enableZoom){var r=Math.max(0,Math.min(_,e));if(r!==this.state.zoomLevel)if(0!==r){var o=this.getBestImageForType("mainSrc");if(null!==o){var i=this.getZoomMultiplier(),a=this.getZoomMultiplier(r),s=this.getLightboxRect(),l="undefined"!==typeof t?t-s.left:s.width/2,c="undefined"!==typeof n?n-s.top:s.height/2,u=(s.width-o.width*i)/2,d=(s.height-o.height*i)/2,p=l-(l-(u-this.state.offsetX))/i*a,h=c-(c-(d-this.state.offsetY))/i*a,f=(s.width-o.width*a)/2-p,m=(s.height-o.height*a)/2-h;if(3!==this.currentAction){var g=this.getMaxOffsets();this.state.zoomLevel>r&&(f=Math.max(g.minX,Math.min(g.maxX,f)),m=Math.max(g.minY,Math.min(g.maxY,m)))}this.setState({zoomLevel:r,offsetX:f,offsetY:m})}}else this.setState({zoomLevel:r,offsetX:0,offsetY:0})}}},{key:"closeIfClickInner",value:function(e){!this.preventInnerClose&&e.target.className.search(/\bril-inner\b/)>-1&&this.requestClose(e)}},{key:"handleKeyInput",value:function(e){if(e.stopPropagation(),!this.isAnimating())if("keyup"!==e.type){var t=e.which||e.keyCode,n=new Date;if(!(n.getTime()-this.lastKeyDownTime<this.props.keyRepeatLimit&&t!==P))switch(this.lastKeyDownTime=n.getTime(),t){case P:e.preventDefault(),this.requestClose(e);break;case N:if(!this.props.prevSrc)return;e.preventDefault(),this.keyPressed=!0,this.requestMovePrev(e);break;case O:if(!this.props.nextSrc)return;e.preventDefault(),this.keyPressed=!0,this.requestMoveNext(e)}}else this.lastKeyDownTime-=this.props.keyRepeatKeyupBonus}},{key:"handleOuterMousewheel",value:function(e){var t=this;e.stopPropagation(),this.clearTimeout(this.resetScrollTimeout),this.resetScrollTimeout=this.setTimeout((function(){t.scrollX=0,t.scrollY=0}),300)}},{key:"handleImageMouseWheel",value:function(e){if(parseInt(e.deltaY)!==parseFloat(e.deltaY)){if(Math.abs(e.deltaY)>=Math.abs(e.deltaX)){if(e.stopPropagation(),Math.abs(e.deltaY)<1)return;this.scrollX=0,this.scrollY+=e.deltaY,this.changeZoom(this.state.zoomLevel-e.deltaY,e.clientX,e.clientY)}}else if(Math.abs(e.deltaY)>Math.abs(e.deltaX)){var t=this.state.offsetY+e.deltaY;t=t<0?0:t,this.setState({offsetY:t})}else{var n=this.state.offsetX+e.deltaX;n=n<0?0:n,this.setState({offsetX:n})}}},{key:"handleImageDoubleClick",value:function(e){this.state.zoomLevel>0?this.changeZoom(0,e.clientX,e.clientY):this.changeZoom(this.state.zoomLevel+100,e.clientX,e.clientY)}},{key:"handleImageClick",value:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()}},{key:"shouldHandleEvent",value:function(e){if(this.eventsSource===e)return!0;if(0===this.eventsSource)return this.eventsSource=e,!0;switch(e){case 1:default:return!1;case 2:return this.eventsSource=2,this.filterPointersBySource(),!0;case 3:return 1===this.eventsSource&&(this.eventsSource=3,this.filterPointersBySource(),!0)}}},{key:"addPointer",value:function(e){this.pointerList.push(e)}},{key:"removePointer",value:function(e){this.pointerList=this.pointerList.filter((function(t){return t.id!==e.id}))}},{key:"filterPointersBySource",value:function(){var e=this;this.pointerList=this.pointerList.filter((function(t){return t.source===e.eventsSource}))}},{key:"handleMouseDown",value:function(e){this.shouldHandleEvent(1)&&a.isTargetMatchImage(e.target)&&(this.addPointer(a.parseMouseEvent(e)),this.multiPointerStart(e))}},{key:"handleMouseMove",value:function(e){this.shouldHandleEvent(1)&&this.multiPointerMove(e,[a.parseMouseEvent(e)])}},{key:"handleMouseUp",value:function(e){this.shouldHandleEvent(1)&&(this.removePointer(a.parseMouseEvent(e)),this.multiPointerEnd(e))}},{key:"handlePointerEvent",value:function(e){if(this.shouldHandleEvent(3))switch(e.type){case"pointerdown":a.isTargetMatchImage(e.target)&&(this.addPointer(a.parsePointerEvent(e)),this.multiPointerStart(e));break;case"pointermove":this.multiPointerMove(e,[a.parsePointerEvent(e)]);break;case"pointerup":case"pointercancel":this.removePointer(a.parsePointerEvent(e)),this.multiPointerEnd(e)}}},{key:"handleTouchStart",value:function(e){var t=this;this.shouldHandleEvent(2)&&a.isTargetMatchImage(e.target)&&([].forEach.call(e.changedTouches,(function(e){return t.addPointer(a.parseTouchPointer(e))})),this.multiPointerStart(e))}},{key:"handleTouchMove",value:function(e){this.shouldHandleEvent(2)&&this.multiPointerMove(e,[].map.call(e.changedTouches,(function(e){return a.parseTouchPointer(e)})))}},{key:"handleTouchEnd",value:function(e){var t=this;this.shouldHandleEvent(2)&&([].map.call(e.changedTouches,(function(e){return t.removePointer(a.parseTouchPointer(e))})),this.multiPointerEnd(e))}},{key:"decideMoveOrSwipe",value:function(e){this.state.zoomLevel<=0?this.handleSwipeStart(e):this.handleMoveStart(e)}},{key:"multiPointerStart",value:function(e){switch(this.handleEnd(null),this.pointerList.length){case 1:e.preventDefault(),this.decideMoveOrSwipe(this.pointerList[0]);break;case 2:e.preventDefault(),this.handlePinchStart(this.pointerList)}}},{key:"multiPointerMove",value:function(e,t){switch(this.currentAction){case 1:e.preventDefault(),this.handleMove(t[0]);break;case 2:e.preventDefault(),this.handleSwipe(t[0]);break;case 3:e.preventDefault(),this.handlePinch(t)}}},{key:"multiPointerEnd",value:function(e){switch(0!==this.currentAction&&(this.setPreventInnerClose(),this.handleEnd(e)),this.pointerList.length){case 0:this.eventsSource=0;break;case 1:e.preventDefault(),this.decideMoveOrSwipe(this.pointerList[0]);break;case 2:e.preventDefault(),this.handlePinchStart(this.pointerList)}}},{key:"handleEnd",value:function(e){switch(this.currentAction){case 1:this.handleMoveEnd(e);break;case 2:this.handleSwipeEnd(e);break;case 3:this.handlePinchEnd(e)}}},{key:"handleMoveStart",value:function(e){var t=e.x,n=e.y;this.props.enableZoom&&(this.currentAction=1,this.moveStartX=t,this.moveStartY=n,this.moveStartOffsetX=this.state.offsetX,this.moveStartOffsetY=this.state.offsetY)}},{key:"handleMove",value:function(e){var t=e.x,n=e.y,r=this.moveStartX-t+this.moveStartOffsetX,o=this.moveStartY-n+this.moveStartOffsetY;this.state.offsetX===r&&this.state.offsetY===o||this.setState({offsetX:r,offsetY:o})}},{key:"handleMoveEnd",value:function(){var e=this;this.currentAction=0,this.moveStartX=0,this.moveStartY=0,this.moveStartOffsetX=0,this.moveStartOffsetY=0;var t=this.getMaxOffsets(),n=Math.max(t.minX,Math.min(t.maxX,this.state.offsetX)),r=Math.max(t.minY,Math.min(t.maxY,this.state.offsetY));n===this.state.offsetX&&r===this.state.offsetY||(this.setState({offsetX:n,offsetY:r,shouldAnimate:!0}),this.setTimeout((function(){e.setState({shouldAnimate:!1})}),this.props.animationDuration))}},{key:"handleSwipeStart",value:function(e){var t=e.x,n=e.y;this.currentAction=2,this.swipeStartX=t,this.swipeStartY=n,this.swipeEndX=t,this.swipeEndY=n}},{key:"handleSwipe",value:function(e){var t=e.x,n=e.y;this.swipeEndX=t,this.swipeEndY=n}},{key:"handleSwipeEnd",value:function(e){var t=this.swipeEndX-this.swipeStartX,n=Math.abs(t),r=Math.abs(this.swipeEndY-this.swipeStartY);if(this.currentAction=0,this.swipeStartX=0,this.swipeStartY=0,this.swipeEndX=0,this.swipeEndY=0,!(!e||this.isAnimating()||n<1.5*r)){if(n<200&&n<this.getLightboxRect().width/4)return;t>0&&this.props.prevSrc?(e.preventDefault(),this.requestMovePrev()):t<0&&this.props.nextSrc&&(e.preventDefault(),this.requestMoveNext())}}},{key:"calculatePinchDistance",value:function(){var e=b(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pinchTouchList,2),t=e[0],n=e[1];return Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2))}},{key:"calculatePinchCenter",value:function(){var e=b(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pinchTouchList,2),t=e[0],n=e[1];return{x:t.x-(t.x-n.x)/2,y:t.y-(t.y-n.y)/2}}},{key:"handlePinchStart",value:function(e){this.props.enableZoom&&(this.currentAction=3,this.pinchTouchList=e.map((function(e){return{id:e.id,x:e.x,y:e.y}})),this.pinchDistance=this.calculatePinchDistance())}},{key:"handlePinch",value:function(e){this.pinchTouchList=this.pinchTouchList.map((function(t){for(var n=0;n<e.length;n+=1)if(e[n].id===t.id)return e[n];return t}));var t=this.calculatePinchDistance(),n=this.state.zoomLevel+t-this.pinchDistance;this.pinchDistance=t;var r=this.calculatePinchCenter(this.pinchTouchList),o=r.x,i=r.y;this.changeZoom(n,o,i)}},{key:"handlePinchEnd",value:function(){this.currentAction=0,this.pinchTouchList=null,this.pinchDistance=0}},{key:"handleWindowResize",value:function(){this.clearTimeout(this.resizeTimeout),this.resizeTimeout=this.setTimeout(this.forceUpdate.bind(this),100)}},{key:"handleZoomInButtonClick",value:function(){var e=this.state.zoomLevel+100;this.changeZoom(e),e===_&&this.zoomOutBtn.current.focus()}},{key:"handleZoomOutButtonClick",value:function(){var e=this.state.zoomLevel-100;this.changeZoom(e),0===e&&this.zoomInBtn.current.focus()}},{key:"handleCaptionMousewheel",value:function(e){if(e.stopPropagation(),this.caption.current){var t=this.caption.current.getBoundingClientRect().height,n=this.caption.current,r=n.scrollHeight,o=n.scrollTop;(e.deltaY>0&&t+o>=r||e.deltaY<0&&o<=0)&&e.preventDefault()}}},{key:"isAnimating",value:function(){return this.state.shouldAnimate||this.state.isClosing}},{key:"isImageLoaded",value:function(e){return e&&e in this.imageCache&&this.imageCache[e].loaded}},{key:"loadImage",value:function(e,t,r){var o=this;if(this.isImageLoaded(t))this.setTimeout((function(){r()}),1);else{var i=new n.g.Image;this.props.imageCrossOrigin&&(i.crossOrigin=this.props.imageCrossOrigin),i.onerror=function(n){o.props.onImageLoadError(t,e,n),o.setState((function(t){return{loadErrorStatus:f(f({},t.loadErrorStatus),{},g({},e,!0))}})),r(n)},i.onload=function(){o.props.onImageLoad(t,e,i),o.imageCache[t]={loaded:!0,width:i.width,height:i.height},r()},i.src=t}}},{key:"loadAllImages",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props;this.getSrcTypes().forEach((function(n){var r=n.name;t[r]&&e.state.loadErrorStatus[r]&&e.setState((function(e){return{loadErrorStatus:f(f({},e.loadErrorStatus),{},g({},r,!1))}})),t[r]&&!e.isImageLoaded(t[r])&&e.loadImage(r,t[r],function(t,n){return function(r){r||e.props[t]!==n||e.didUnmount||e.forceUpdate()}}(r,t[r]))}))}},{key:"requestClose",value:function(e){var t=this,n=function(){t.saveRotateImage(),t.props.onCloseRequest(e)};this.props.animationDisabled||"keydown"===e.type&&!this.props.animationOnKeyInput?n():(this.setState({isClosing:!0}),this.setTimeout(n,this.props.animationDuration))}},{key:"requestMove",value:function(e,t){var n=this,r={zoomLevel:0,offsetX:0,offsetY:0};this.props.animationDisabled||this.keyPressed&&!this.props.animationOnKeyInput||(r.shouldAnimate=!0,this.setTimeout((function(){return n.setState({shouldAnimate:!1})}),this.props.animationDuration)),this.keyPressed=!1,this.moveRequested=!0,this.saveRotateImage(),"prev"===e?(this.keyCounter-=1,this.setState(r),this.props.onMovePrevRequest(t)):(this.keyCounter+=1,this.setState(r),this.props.onMoveNextRequest(t))}},{key:"requestMoveNext",value:function(e){this.requestMove("next",e)}},{key:"requestMovePrev",value:function(e){this.requestMove("prev",e)}},{key:"saveRotateImage",value:function(){this.props.onRotateImage&&0!==this.state.rotateDeg&&360!==this.state.rotateDeg&&(this.props.onRotateImage(this.state.rotateDeg),this.setState({rotateDeg:0}))}},{key:"rotateImage",value:function(){var e=this.state.rotateDeg;e=e>=360?this.state.rotateDeg-270:e+90,this.setState({rotateDeg:e})}},{key:"render",value:function(){var e=this,t=this.props,r=t.animationDisabled,o=t.animationDuration,i=t.clickOutsideToClose,l=t.discourageDownloads,c=t.enableZoom,u=t.imageTitle,d=t.nextSrc,h=t.prevSrc,m=t.isDesktop,g=t.toolbarButtons,y=t.reactModalStyle,x=t.onAfterOpen,A=t.imageCrossOrigin,C=t.reactModalProps,b=t.onRotateImage,S=this.state,D=S.zoomLevel,k=S.offsetX,j=S.offsetY,I=S.isClosing,P=S.loadErrorStatus,N=S.rotateDeg,O=this.getLightboxRect(),T={};!r&&this.isAnimating()&&(T=f(f({},T),{},{transition:"transform ".concat(o,"ms")}));var E={};this.getSrcTypes().forEach((function(e){var t=e.name,n=e.keyEnding;E[t]=n}));var R=[],L=function(t,n,r){if(e.props[t]){var o,i=e.getBestImageForType(t),c=f(f({},T),a.getTransform(f(f({},r),i)));if(D>0&&(c.cursor="move"),c.transform="".concat(c.transform," rotate(").concat(N,"deg)"),null===i&&(o=P,Object.keys(o).some((function(e){return o[e]}))))R.push(s.createElement("div",{className:"".concat(n," ril__image ril-errored"),style:c,key:e.props[t]+E[t]},s.createElement("div",{className:"ril__errorContainer"},e.props.imageLoadErrorMessage)));else if(null!==i){var d=i.src;l?(c.backgroundImage="url('".concat(d,"')"),R.push(s.createElement("div",{className:"".concat(n," ril__image ril__imageDiscourager"),onDoubleClick:e.handleImageDoubleClick,onWheel:e.handleImageMouseWheel,style:c,key:d+E[t]},s.createElement("div",{className:"ril-download-blocker ril__downloadBlocker"})))):R.push(s.createElement("img",v({},A?{crossOrigin:A}:{},{className:"".concat(n," ril__image"),onDoubleClick:e.handleImageDoubleClick,onClick:e.handleImageClick,onWheel:e.handleImageMouseWheel,onDragStart:function(e){return e.preventDefault()},style:c,src:d,key:d+E[t],alt:"string"===typeof u?u:M("Image"),draggable:!1})))}else{var p=s.createElement("div",{className:"ril-loading-circle ril__loadingCircle ril__loadingContainer__icon"},w(new Array(12)).map((function(e,t){return s.createElement("div",{key:t,className:"ril-loading-circle-point ril__loadingCirclePoint"})})));R.push(s.createElement("div",{className:"".concat(n," ril__image ril-not-loaded"),style:c,key:e.props[t]+E[t]},s.createElement("div",{className:"ril__loadingContainer"},p)))}}},F=this.getZoomMultiplier();L("nextSrc","ril-image-next ril__imageNext",{x:O.width}),L("mainSrc","ril-image-current",{x:-1*k,y:-1*j,zoom:F}),L("prevSrc","ril-image-prev ril__imagePrev",{x:-1*O.width});var U={overlay:f({zIndex:1e3,backgroundColor:"transparent"},y.overlay),content:f({backgroundColor:"transparent",overflow:"hidden",border:"none",borderRadius:0,padding:0,top:0,left:0,right:0,bottom:0},y.content)};return s.createElement(p(),v({isOpen:!0,onRequestClose:i?this.requestClose:void 0,onAfterOpen:function(){e.outerEl.current&&e.outerEl.current.focus(),x()},style:U,contentLabel:M("Lightbox"),appElement:"undefined"!==typeof n.g.window?n.g.window.document.body:void 0},C),s.createElement("div",{className:"ril-outer ril__outer ril__outerAnimating ".concat(this.props.wrapperClassName," ").concat(I?"ril-closing ril__outerClosing":""),style:{transition:"opacity ".concat(o,"ms"),animationDuration:"".concat(o,"ms"),animationDirection:I?"normal":"reverse"},ref:this.outerEl,onWheel:this.handleOuterMousewheel,onMouseMove:this.handleMouseMove,onMouseDown:this.handleMouseDown,onTouchStart:this.handleTouchStart,onTouchMove:this.handleTouchMove,tabIndex:"-1",onKeyDown:this.handleKeyInput,onKeyUp:this.handleKeyInput},s.createElement("div",{className:"ril-inner ril__inner",onClick:i?this.closeIfClickInner:void 0},R),h&&m&&s.createElement("button",{type:"button",className:"ril-prev-button ril__navButtons ril__navButtonPrev",key:"prev","aria-label":this.props.prevLabel,onClick:this.isAnimating()?void 0:this.requestMovePrev}),d&&m&&s.createElement("button",{type:"button",className:"ril-next-button ril__navButtons ril__navButtonNext",key:"next","aria-label":this.props.nextLabel,onClick:this.isAnimating()?void 0:this.requestMoveNext}),s.createElement("div",{className:"ril-toolbar ril__toolbar"},s.createElement("ul",{className:"ril-toolbar-left ril__toolbarSide ril__toolbarLeftSide"},s.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},s.createElement("span",{className:"ril-toolbar__item__child ril__toolbarItemChild"},u))),s.createElement("ul",{className:"ril-toolbar-right ril__toolbarSide ril__toolbarRightSide"},g&&g.map((function(e,t){return s.createElement("li",{key:"button_".concat(t+1),className:"ril-toolbar__item ril__toolbarItem"},e)})),s.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},s.createElement("button",{type:"button",key:"close","aria-label":this.props.closeLabel,className:"ril-close ril-toolbar__item__child ril__toolbarItemChild ril__builtinButton ril__closeButton",onClick:this.isAnimating()?void 0:this.requestClose})))),s.createElement("div",{onMouseDown:function(e){return e.stopPropagation()},className:"ril-caption ril__caption"},c&&s.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},s.createElement("button",{type:"button",key:"zoom-in","aria-label":this.props.zoomInLabel,className:["ril-zoom-in","ril__toolbarItemChild","ril__builtinButton","ril__zoomInButton"].concat(w(D===_?["ril__builtinButtonDisabled"]:[])).join(" "),ref:this.zoomInBtn,disabled:this.isAnimating()||D===_,onClick:this.isAnimating()||D===_?void 0:this.handleZoomInButtonClick})),c&&s.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},s.createElement("button",{type:"button",key:"zoom-out","aria-label":this.props.zoomOutLabel,className:["ril-zoom-out","ril__toolbarItemChild","ril__builtinButton","ril__zoomOutButton"].concat(w(0===D?["ril__builtinButtonDisabled"]:[])).join(" "),ref:this.zoomOutBtn,disabled:this.isAnimating()||0===D,onClick:this.isAnimating()||0===D?void 0:this.handleZoomOutButtonClick})),b&&s.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},s.createElement("button",{type:"button",className:["ril-rotate","ril__toolbarItemChild","ril__builtinButton","ril__rotateButton","ril_rotateImageButton"].join(" "),onClick:this.rotateImage})))))}}],o=[{key:"isTargetMatchImage",value:function(e){return e&&/ril-image-current/.test(e.className)}},{key:"parseMouseEvent",value:function(e){return{id:"mouse",source:1,x:parseInt(e.clientX,10),y:parseInt(e.clientY,10)}}},{key:"parseTouchPointer",value:function(e){return{id:e.identifier,source:2,x:parseInt(e.clientX,10),y:parseInt(e.clientY,10)}}},{key:"parsePointerEvent",value:function(e){return{id:e.pointerId,source:3,x:parseInt(e.clientX,10),y:parseInt(e.clientY,10)}}},{key:"getTransform",value:function(e){var t=e.x,n=void 0===t?0:t,r=e.y,o=void 0===r?0:r,i=e.zoom,a=void 0===i?1:i,s=e.width,l=e.targetWidth,c=n,u=j();s>u&&(c+=(u-s)/2);var d=a*(l/s);return{transform:"translate3d(".concat(c,"px,").concat(o,"px,0) scale3d(").concat(d,",").concat(d,",1)")}}}],r&&m(t.prototype,r),o&&m(t,o),Object.defineProperty(t,"prototype",{writable:!1}),a}(s.Component);T.propTypes={isDesktop:u().bool,mainSrc:u().string.isRequired,prevSrc:u().string,nextSrc:u().string,mainSrcThumbnail:u().string,prevSrcThumbnail:u().string,nextSrcThumbnail:u().string,onCloseRequest:u().func.isRequired,onMovePrevRequest:u().func,onMoveNextRequest:u().func,onImageLoadError:u().func,onImageLoad:u().func,onAfterOpen:u().func,discourageDownloads:u().bool,animationDisabled:u().bool,animationOnKeyInput:u().bool,animationDuration:u().number,keyRepeatLimit:u().number,keyRepeatKeyupBonus:u().number,imageTitle:u().node,imageCaption:u().node,imageCrossOrigin:u().string,reactModalStyle:u().object,imagePadding:u().number,wrapperClassName:u().string,toolbarButtons:u().arrayOf(u().node),clickOutsideToClose:u().bool,enableZoom:u().bool,reactModalProps:u().shape({}),nextLabel:u().string,prevLabel:u().string,zoomInLabel:u().string,zoomOutLabel:u().string,closeLabel:u().string,imageLoadErrorMessage:u().node,onRotateImage:u().func},T.defaultProps={isDesktop:!0,imageTitle:null,imageCaption:null,toolbarButtons:null,reactModalProps:{},animationDisabled:!1,animationDuration:300,animationOnKeyInput:!1,clickOutsideToClose:!0,closeLabel:"Close lightbox",discourageDownloads:!1,enableZoom:!0,imagePadding:10,imageCrossOrigin:null,keyRepeatKeyupBonus:40,keyRepeatLimit:180,mainSrcThumbnail:null,nextLabel:"Next image",nextSrc:null,nextSrcThumbnail:null,onAfterOpen:function(){},onImageLoadError:function(){},onImageLoad:function(){},onMoveNextRequest:function(){},onMovePrevRequest:function(){},prevLabel:"Previous image",prevSrc:null,prevSrcThumbnail:null,reactModalStyle:{},wrapperClassName:"",zoomInLabel:"Zoom in",zoomOutLabel:"Zoom out",imageLoadErrorMessage:"This image failed to load",onRotateImage:null};var E=T,R=n(44414),L=function(e){function t(){return(0,r.A)(this,t),(0,i.A)(this,t,arguments)}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props.imageItems,t=this.props.imageIndex,n=e.length,r=e[t].name,o="".concat(r," (").concat(t+1,"/").concat(n,")");return(0,R.jsx)(E,{imageTitle:o,mainSrc:e[t].src,nextSrc:e[(t+1)%n].src,prevSrc:e[(t+n-1)%n].src,onCloseRequest:this.props.closeImagePopup,onMovePrevRequest:this.props.moveToPrevImage,onMoveNextRequest:this.props.moveToNextImage,imagePadding:70,imageLoadErrorMessage:(0,l.AP)("The image could not be loaded."),prevLabel:(0,l.AP)("Previous (Left arrow key)"),nextLabel:(0,l.AP)("Next (Right arrow key)"),closeLabel:(0,l.AP)("Close (Esc)"),zoomInLabel:(0,l.AP)("Zoom in"),zoomOutLabel:(0,l.AP)("Zoom out")})}}])}(s.Component),F=L},91611:function(e,t,n){"use strict";var r=n(23029),o=n(92901),i=n(39874),a=n(85501),s=n(9950),l=n(58195),c=n(14113),u=n(99308),d=n(85907),p=n(18849),h=n(25328),f=n(40326),m=n(4086),g=n(44414),v=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).copyToClipboard=function(){(0,h.A)(n.props.link),n.props.toggleDialog(),m.A.success((0,f.AP)("The link is copied to the clipboard."),{duration:2})},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.link,n=e.toggleDialog;return(0,g.jsxs)(l.A,{isOpen:!0,toggle:n,children:[(0,g.jsx)(c.A,{toggle:n,children:(0,f.AP)("Link")}),(0,g.jsx)(u.A,{children:(0,g.jsx)("a",{href:t,children:t})}),(0,g.jsxs)(d.A,{children:[(0,g.jsx)(p.A,{color:"primary",onClick:this.copyToClipboard,children:(0,f.AP)("Copy")}),(0,g.jsx)(p.A,{color:"secondary",onClick:n,children:(0,f.AP)("Close")})]})]})}}])}(s.Component);t.A=v},16670:function(e,t,n){"use strict";var r,o=n(23029),i=n(92901),a=n(39874),s=n(85501),l=n(9950),c=n(58195),u=n(14113),d=n(99308),p=n(40326),h=n(97011),f=n(65604),m=n(81446),g=n(44414),v=function(e){function t(e){var n;return(0,o.A)(this,t),(n=(0,a.A)(this,t,[e])).queryZipProgress=function(){var e=n.state.zipToken;h.e.queryZipProgress(e).then((function(t){var o=t.data;if(1==o.failed){var i;switch(clearInterval(r),o.failed_reason){case"size too large":i=(0,p.AP)("Failed to download. The total size of the files exceeded the limit.");break;case"internal error":i=(0,p.AP)("Internal Server Error");break;default:i=(0,p.AP)("Error")}n.setState({isLoading:!1,errorMsg:i})}else n.setState({zipProgress:0==o.total?"100%":(o.zipped/o.total*100).toFixed(2)+"%"}),o.total==o.zipped&&(clearInterval(r),n.props.toggleDialog(),location.href="".concat(p.IX,"zip/").concat(e))})).catch((function(e){clearInterval(r);var t=f.Aq.getErrorMsg(e);n.setState({isLoading:!1,errorMsg:t})}))},n.cancelZipTask=function(){var e=n.state.zipToken;h.e.cancelZipTask(e).then((function(e){})).catch((function(e){}))},n.toggleDialog=function(){var e=n.state.zipProgress;e&&"100%"!=e&&(clearInterval(r),n.cancelZipTask()),n.props.toggleDialog()},n.state={isLoading:!0,errorMsg:"",zipProgress:null},n}return(0,s.A)(t,e),(0,i.A)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.token,o=t.path,i=t.repoID,a=t.target;(n?a.length?h.e.getShareLinkDirentsZipTask(n,o,a):h.e.getShareLinkZipTask(n,o):h.e.zipDownload(i,o,a)).then((function(t){var n=t.data.zip_token;e.setState({isLoading:!1,errorMsg:"",zipToken:n}),e.queryZipProgress(),r=setInterval(e.queryZipProgress,1e3)})).catch((function(t){var n=f.Aq.getErrorMsg(t);e.setState({isLoading:!1,errorMsg:n})}))}},{key:"render",value:function(){return(0,g.jsxs)(c.A,{isOpen:!0,toggle:this.toggleDialog,children:[(0,g.jsx)(u.A,{toggle:this.toggleDialog,children:(0,p.AP)("Download")}),(0,g.jsx)(d.A,{children:(0,g.jsx)(y,{data:this.state})})]})}}])}(l.Component),y=function(e){function t(){return(0,o.A)(this,t),(0,a.A)(this,t,arguments)}return(0,s.A)(t,e),(0,i.A)(t,[{key:"render",value:function(){var e=this.props.data,t=e.isLoading,n=e.errorMsg,r=e.zipProgress;return t?(0,g.jsx)(m.A,{}):n?(0,g.jsxs)("div",{className:"text-center mt-7 mb-8",children:[(0,g.jsx)("img",{src:"".concat(p.SG,"img/error-tip.png"),alt:"",width:"100"}),(0,g.jsx)("p",{className:"mt-3",children:n})]}):(0,g.jsx)("p",{className:"mt-4 text-center",children:"".concat((0,p.AP)("Packaging...")," ").concat(r)})}}])}(l.Component);t.A=v},36402:function(e,t,n){"use strict";n.d(t,{A:function(){return y}});var r=n(23029),o=n(92901),i=n(39874),a=n(85501),s=n(9950),l=n(92795),c=n(19260),u=n(6030),d=n(33151),p=n(68879),h=n(40326),f=n(65604),m=n(40866),g=n(44414),v=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onShowMenu=function(){},n.onHideMenu=function(){n.state.isItemMenuShow&&(n.setState({isItemMenuShow:!1}),"function"===typeof n.props.unfreezeItem&&n.props.unfreezeItem())},n.onDropdownToggleKeyDown=function(e){"Enter"!=e.key&&"Space"!=e.key||n.onDropdownToggleClick(e)},n.onDropdownToggleClick=function(e){e.preventDefault(),e.stopPropagation(),n.toggleOperationMenu()},n.toggleOperationMenu=function(){n.setState({isItemMenuShow:!n.state.isItemMenuShow},(function(){n.state.isItemMenuShow&&"function"===typeof n.props.freezeItem?n.props.freezeItem():n.state.isItemMenuShow||"function"!==typeof n.props.unfreezeItem||n.props.unfreezeItem()}))},n.onMenuItemKeyDown=function(e){"Enter"!=e.key&&"Space"!=e.key||n.onMenuItemClick(e)},n.onMenuItemClick=function(e){var t,r=null!==(t=f.Aq.getEventData(e,"toggle"))&&void 0!==t?t:e.currentTarget.getAttribute("data-toggle"),o=n.props.item;n.props.onMenuItemClick(r,e,o)},n.onDropDownMouseMove=function(e){n.state.isSubMenuShown&&e.target&&"dropdown-item"===e.target.className&&n.setState({isSubMenuShown:!1})},n.toggleSubMenu=function(e){e.stopPropagation(),n.setState({isSubMenuShown:!n.state.isSubMenuShown})},n.toggleSubMenuShown=function(e){n.setState({isSubMenuShown:!0,currentItem:e.key})},n.state={menuList:[],isItemMenuShow:!1,isSubMenuShown:!1,currentItem:""},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.props.isHandleContextMenuEvent&&(this.listenerId=l.A.register(this.onShowMenu,this.onHideMenu));var e=this.props.item,t=this.props.getMenuList(e);this.setState({menuList:t})}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.item;if(t.name!==this.props.item.name){var n=this.props.getMenuList(t);this.setState({menuList:n})}}},{key:"componentWillUnmount",value:function(){this.props.isHandleContextMenuEvent&&this.listenerId&&l.A.unregister(this.listenerId)}},{key:"render",value:function(){var e=this,t=this.state.menuList,n=this.props,r=n.toggleClass,o=n.toggleChildren,i=n.tagName,a=n.menuStyle;return r="sf-dropdown-toggle "+r,t.length?i&&"button"===i?(0,g.jsxs)(c.A,{isOpen:this.state.isItemMenuShow,toggle:this.onDropdownToggleClick,children:[(0,g.jsx)(u.A,{className:this.props.toggleClass,"data-toggle":"dropdown",title:(0,h.AP)("More operations"),"aria-label":(0,h.AP)("More operations"),"aria-expanded":this.state.isItemMenuShow,onKeyDown:this.onDropdownToggleKeyDown,children:o}),(0,g.jsx)(d.A,{children:t.map((function(t,n){return"Divider"===t?(0,g.jsx)(p.A,{divider:!0},n):(0,g.jsx)(p.A,{"data-toggle":t.key,onClick:e.onMenuItemClick,onKeyDown:e.onMenuItemKeyDown,children:t.value},n)}))})]}):(0,g.jsxs)(c.A,{isOpen:this.state.isItemMenuShow,toggle:this.onDropdownToggleClick,className:"vam",children:[(0,g.jsx)(u.A,{tag:i||"i",role:"button",tabIndex:"0",className:r,title:(0,h.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isItemMenuShow,"aria-label":(0,h.AP)("More operations"),onKeyDown:this.onDropdownToggleKeyDown}),(0,g.jsx)(m.A,{children:(0,g.jsx)(d.A,{style:a,onMouseMove:this.onDropDownMouseMove,children:t.map((function(t,n){return"Divider"===t?(0,g.jsx)(p.A,{divider:!0},n):t.subOpList?(0,g.jsxs)(c.A,{direction:"right",className:"w-100",isOpen:e.state.isSubMenuShown&&e.state.currentItem==t.key,toggle:e.toggleSubMenu,onMouseMove:function(e){e.stopPropagation()},children:[(0,g.jsxs)(u.A,{tag:"div",className:"dropdown-item font-weight-normal rounded-0 d-flex align-items-center pl-5",onMouseEnter:e.toggleSubMenuShown.bind(e,t),children:[(0,g.jsx)("span",{className:"mr-auto",children:t.value}),(0,g.jsx)("i",{className:"sf3-font-down sf3-font rotate-270"})]}),(0,g.jsx)(d.A,{children:t.subOpList.map((function(t,n){return"Divider"==t?(0,g.jsx)(p.A,{divider:!0},n):(0,g.jsx)(p.A,{"data-toggle":t.key,onClick:e.onMenuItemClick,onKeyDown:e.onMenuItemKeyDown,children:t.value},n)}))})]},n):(0,g.jsx)(p.A,{className:"p-0","data-toggle":t.key,onClick:e.onMenuItemClick,onKeyDown:e.onMenuItemKeyDown,children:(0,g.jsxs)("div",{className:"dropdown-item-wrapper",children:[(0,g.jsx)("span",{className:"dropdown-item-tick",children:"Display files"===t.key&&e.props.isDisplayFiles&&(0,g.jsx)("i",{className:"sf2-icon-tick"})}),(0,g.jsx)("span",{className:"dropdown-item-content",children:t.value})]})},n)}))})})]}):""}}])}(s.Component);v.defaultProps={isHandleContextMenuEvent:!0,menuStyle:{},toggleClass:"sf3-font-more sf3-font"};var y=v},50224:function(e,t,n){"use strict";n.d(t,{A:function(){return o}});n(9950);var r=n(44414);var o=function(e){return(0,r.jsx)("ul",{className:"file-tag-list",children:Array.isArray(e.fileTagList)&&e.fileTagList.map((function(e){var t=e.tag_color||e.color,n=e.tag_name||e.name||"";return(0,r.jsx)("li",{style:{backgroundColor:t},className:"file-tag-item",children:(0,r.jsx)("span",{className:"tag-name",title:n,children:n})},e.id)}))})}},54033:function(e,t,n){"use strict";n.d(t,{A:function(){return b}});var r=n(23029),o=n(92901),i=n(39874),a=n(85501),s=n(9950),l=n(40326),c=n(97011),u=n(65604),d=n(4086),p=n(44414);var h=function(e){var t=e.callBack,n=e.footerName,r=e.className,o=e.addIconClassName;return(0,p.jsxs)("div",{className:"add-item-btn ".concat(r||""),onClick:function(e){t(e)},children:[(0,p.jsx)("span",{className:"sf3-font sf3-font-enlarge mr-2 ".concat(o||"")}),(0,p.jsx)("span",{className:"add-new-option",title:n,children:n})]})},f=n(48738),m=n.n(f),g=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onCompositionStart=function(){n.isInputtingChinese=!0},n.onChange=function(e){n.timer&&clearTimeout(n.timer);var t=n.props,r=t.onChange,o=t.wait,i=e.target.value;n.setState({searchValue:i||""},(function(){n.isInputtingChinese||(n.timer=setTimeout((function(){r&&r(n.state.searchValue.trim())}),o))}))},n.onCompositionEnd=function(e){n.isInputtingChinese=!1,n.onChange(e)},n.clearSearch=function(){var e=n.props.clearValue;n.setState({searchValue:""},(function(){e&&e()}))},n.setFocus=function(e){if(n.inputRef!==document.activeElement&&(n.inputRef.focus(),e)){var t=n.state.searchValue.length;n.inputRef.setSelectionRange(0,t)}},n.isFunction=function(e){return e&&"[object Function]"==={}.toString.call(e)},n.renderClear=function(){var e=n.props,t=e.isClearable,r=e.clearClassName,o=e.components,i=void 0===o?{}:o,a=n.state.searchValue;if(!t||!a)return null;var l=i.ClearIndicator;return s.isValidElement(l)?s.cloneElement(l,{clearValue:n.clearSearch}):n.isFunction(l)?(0,p.jsx)(l,{clearValue:n.clearSearch}):(0,p.jsx)("i",{className:m()("search-text-clear input-icon-addon",r),onClick:n.clearSearch,children:"\xd7"})},n.state={searchValue:e.value},n.isInputtingChinese=!1,n.timer=null,n.inputRef=null,n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.autoFocus&&this.inputRef&&this.inputRef!==document.activeElement&&setTimeout((function(){e.inputRef.focus()}),0)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.value!==this.props.value&&this.setState({searchValue:e.value})}},{key:"componentWillUnmount",value:function(){this.timer&&clearTimeout(this.timer),this.timer=null,this.inputRef=null}},{key:"render",value:function(){var e=this,t=this.props,n=t.placeholder,r=t.autoFocus,o=t.className,i=t.onKeyDown,a=t.disabled,l=t.style,c=this.state.searchValue;return(0,p.jsxs)(s.Fragment,{children:[(0,p.jsx)("input",{type:"text",value:c,className:m()("form-control",o),onChange:this.onChange,autoFocus:r,placeholder:n,onCompositionStart:this.onCompositionStart,onCompositionEnd:this.onCompositionEnd,onKeyDown:i,disabled:a,style:l,ref:function(t){return e.inputRef=t}}),this.renderClear()]})}}])}(s.Component);g.defaultProps={wait:100,disabled:!1,value:""};var v=g,y=n(4966),x=function(e){function t(){var e;(0,r.A)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=(0,i.A)(this,t,[].concat(o))).onMouseEnter=function(){e.props.setHighlightIndex(e.props.index)},e.onMouseLeave=function(){e.props.setHighlightIndex(-1)},e.getRepoTagIdList=function(){return(e.props.fileTagList||[]).map((function(e){return e.repo_tag_id}))},e.onEditFileTag=function(){var t=e.props,n=t.repoID,r=t.repoTag,o=t.filePath,i=e.getRepoTagIdList();if(-1===i.indexOf(r.id)){var a=r.id;c.e.addFileTag(n,o,a).then((function(){i=e.getRepoTagIdList(),e.props.onFileTagChanged()})).catch((function(e){var t=u.Aq.getErrorMsg(e);d.A.danger(t)}))}else{for(var s=null,l=e.props.fileTagList,p=0;p<l.length;p++)if(l[p].repo_tag_id===r.id){s=l[p];break}c.e.deleteFileTag(n,s.id).then((function(){i=e.getRepoTagIdList(),e.props.onFileTagChanged()})).catch((function(e){var t=u.Aq.getErrorMsg(e);d.A.danger(t)}))}},e}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.repoTag,n=e.highlightIndex,r=e.index,o=-1!=this.getRepoTagIdList().indexOf(t.id);return(0,p.jsxs)("li",{className:"tag-list-item cursor-pointer px-3 d-flex justify-content-between align-items-center ".concat(n===r?"hl":""),onClick:this.onEditFileTag,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[(0,p.jsx)("div",{className:"tag-item d-flex align-items-center",style:{backgroundColor:t.color},children:(0,p.jsx)("span",{className:"tag-name",children:t.name})}),o&&(0,p.jsx)("i",{className:"sf2-icon-tick tag-selected-icon"})]})}}])}(s.Component),A=x,C=n(13042),b=(n(79627),function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).setHighlightIndex=function(e){n.setState({highlightIndex:e})},n.generateRandomColor=function(){return C.cj[Math.floor(Math.random()*C.cj.length)]},n.createNewTag=function(){var e=n.state.searchVal.trim();if(e){var t=n.generateRandomColor(),r=n.props.repoID;c.e.createRepoTag(r,e,t).then((function(e){var t=e.data.repo_tag;n.onRepoTagCreated(t),n.setState({searchVal:"",highlightIndex:-1})})).catch((function(e){var t=u.Aq.getErrorMsg(e);d.A.danger(t)}))}},n.onRepoTagCreated=function(e){var t=n.props,r=t.repoID,o=t.filePath,i=e.repo_tag_id;c.e.addFileTag(r,o,i).then((function(){n.props.onFileTagChanged(),n.props.onNewRepoTagAdded&&n.props.onNewRepoTagAdded(e)})).catch((function(e){var t=u.Aq.getErrorMsg(e);d.A.danger(t)}))},n.getRepoTagIdList=function(){return(n.props.fileTagList||[]).map((function(e){return e.repo_tag_id}))},n.onEditFileTag=function(e){var t=n.props,r=t.repoID,o=t.filePath,i=n.getRepoTagIdList();if(-1===i.indexOf(e.id))c.e.addFileTag(r,o,e.id).then((function(){i=n.getRepoTagIdList(),n.props.onFileTagChanged()})).catch((function(e){var t=u.Aq.getErrorMsg(e);d.A.danger(t)}));else{for(var a=null,s=n.props.fileTagList,l=0;l<s.length;l++)if(s[l].repo_tag_id===e.id){a=s[l];break}c.e.deleteFileTag(r,a.id).then((function(){i=n.getRepoTagIdList(),n.props.onFileTagChanged()})).catch((function(e){var t=u.Aq.getErrorMsg(e);d.A.danger(t)}))}},n.onKeyDown=function(e){var t=n.props.repoTags;if(e.keyCode===C.cK.ChineseInputMethod||e.keyCode===C.cK.LeftArrow||e.keyCode===C.cK.RightArrow)e.stopPropagation();else if(e.keyCode===C.cK.Enter){var r=n.state.searchVal.trim(),o=t.filter((function(e){return e.name.includes(r)}))[n.state.highlightIndex];o&&n.onEditFileTag(o)}else if(e.keyCode===C.cK.UpArrow)n.state.highlightIndex>-1&&n.setHighlightIndex(n.state.highlightIndex-1);else if(e.keyCode===C.cK.DownArrow){var i=n.state.searchVal.trim(),a=t.filter((function(e){return e.name.includes(i)}));n.state.highlightIndex<a.length&&n.setHighlightIndex(n.state.highlightIndex+1)}},n.onChangeSearch=function(e){n.setState({searchVal:e}),n.setHighlightIndex(-1)},n.state={searchVal:"",highlightIndex:-1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.state.searchVal.trim(),n=this.props.repoTags,r=n.filter((function(e){return e.name.includes(t)})),o=t&&!n.find((function(e){return e.name===t})),i="";return t?0==r.length&&(i=(0,l.AP)("Tag not found")):0==n.length&&(i=(0,l.AP)("No tags")),(0,p.jsxs)(y.A,{popoverClassName:"edit-filetag-popover",target:this.props.target,hideSeahubPopover:this.props.toggleCancel,hideSeahubPopoverWithEsc:this.props.toggleCancel,canHideSeahubPopover:!0,children:[(0,p.jsx)(v,{className:"edit-filetag-popover-input",placeholder:(0,l.AP)("Find a tag"),onKeyDown:this.onKeyDown,onChange:this.onChangeSearch,autoFocus:!0}),i?(0,p.jsx)("div",{className:"tag-not-found my-4 mx-1",children:i}):(0,p.jsx)("ul",{className:"tag-list-container",children:r.map((function(t,n){return(0,p.jsx)(A,{index:n,highlightIndex:e.state.highlightIndex,setHighlightIndex:e.setHighlightIndex,repoTag:t,repoID:e.props.repoID,filePath:e.props.filePath,fileTagList:e.props.fileTagList,onFileTagChanged:e.props.onFileTagChanged},t.id)}))}),o&&(0,p.jsx)(h,{callBack:this.createNewTag,footerName:"".concat((0,l.AP)("Create a new tag")," '").concat(t,"'")})]})}}])}(s.Component))},86274:function(e,t,n){"use strict";var r=n(23029),o=n(92901),i=n(39874),a=n(85501),s=n(9950),l=n(40326),c=n(65604),u=n(4086),d=n(44414),p=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onClick=function(e){n.inputRef.current.contains(e.target)||n.onRenameConfirm()},n.onChange=function(e){n.setState({name:e.target.value})},n.onKeyDown=function(e){e.keyCode===c.Aq.keyCodes.enter?n.onRenameConfirm(e):e.keyCode===c.Aq.keyCodes.esc&&n.onRenameCancel(e),e.nativeEvent.stopImmediatePropagation()},n.onRenameConfirm=function(e){e&&e.nativeEvent.stopImmediatePropagation();var t=n.state.name.trim();if(t!==n.props.name){var r=n.validateInput(),o=r.isValid,i=r.errMessage;o?n.props.onRenameConfirm(t):(u.A.danger(i),n.props.onRenameCancel())}else n.props.onRenameCancel()},n.onRenameCancel=function(e){e.nativeEvent.stopImmediatePropagation(),n.props.onRenameCancel()},n.validateInput=function(){var e=n.state.name.trim(),t=!0,r="";return e?e.indexOf("/")>-1?{isValid:t=!1,errMessage:r=(0,l.AP)("Name should not include '/'.")}:{isValid:t,errMessage:r}:{isValid:t=!1,errMessage:r=(0,l.AP)("Name is required.")}},n.state={name:e.name},n.inputRef=s.createRef(),n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){var e=this;if(this.inputRef.current.focus(),this.props.hasSuffix){var t=this.props.name.lastIndexOf(".");this.inputRef.current.setSelectionRange(0,t,"forward")}else this.inputRef.current.setSelectionRange(0,-1);setTimeout((function(){document.addEventListener("click",e.onClick)}),1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.onClick)}},{key:"render",value:function(){return(0,d.jsx)("div",{className:"rename-container",children:(0,d.jsx)("input",{ref:this.inputRef,value:this.state.name,onChange:this.onChange,onKeyDown:this.onKeyDown})})}}])}(s.Component);t.A=p},39143:function(e,t,n){"use strict";n.d(t,{A:function(){return w}});var r=n(23029),o=n(92901),i=n(39874),a=n(85501),s=n(9950),l=n(40866),c=n(58195),u=n(14113),d=n(99308),p=n(85907),h=n(18849),f=n(59051),m=n.n(f),g=n(40326),v=n(97011),y=n(65604),x=n(4086),A=n(44414),C=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onFileTagChanged=function(e){var t=e.parent_path,r={name:e.filename},o="/"===t?t+e.filename:t+"/"+e.filename;n.props.onFileTagChanged(r,o)},n.onDeleteTaggedFile=function(e){var t=n.props.repoID,r=e.file_tag_id;v.e.deleteFileTag(t,r).then((function(t){n.getTaggedFiles(),n.props.updateUsedRepoTags(),n.props.onFileTagChanged&&!e.file_deleted&&n.onFileTagChanged(e)})).catch((function(e){var t=y.Aq.getErrorMsg(e);x.A.danger(t)}))},n.getTaggedFiles=function(){var e=n.props,t=e.repoID,r=e.currentTag,o=e.shareLinkToken;(o?v.e.getShareLinkTaggedFiles(o,r.id):v.e.listTaggedFiles(t,r.id)).then((function(e){var t=[];void 0!==e.data.tagged_files&&e.data.tagged_files.forEach((function(e){var n=e;t.push(n)})),n.setState({taggedFileList:t})})).catch((function(e){var t=y.Aq.getErrorMsg(e);x.A.danger(t)}))},n.state={taggedFileList:[]},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.getTaggedFiles()}},{key:"render",value:function(){var e=this,t=this.state.taggedFileList;return(0,A.jsxs)(c.A,{isOpen:!0,style:{maxWidth:"678px"},children:[(0,A.jsx)(u.A,{toggle:this.props.onClose,children:(0,g.AP)("Tagged Files")}),(0,A.jsx)(d.A,{className:"dialog-list-container",children:(0,A.jsxs)("table",{children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{width:"50%",className:"ellipsis",children:(0,g.AP)("Name")}),(0,A.jsx)("th",{width:"20%",children:(0,g.AP)("Size")}),(0,A.jsx)("th",{width:"22%",children:(0,g.AP)("Last Update")}),(0,A.jsx)("th",{width:"8%"})]})}),(0,A.jsx)("tbody",{children:t.map((function(t,n){return(0,A.jsx)(b,{repoID:e.props.repoID,taggedFile:t,onDeleteTaggedFile:e.onDeleteTaggedFile,shareLinkToken:e.props.shareLinkToken,enableFileDownload:e.props.enableFileDownload},n)}))})]})}),(0,A.jsx)(p.A,{children:(0,A.jsx)(h.A,{color:"secondary",onClick:this.props.toggleCancel,children:(0,g.AP)("Close")})})]})}}])}(s.Component),b=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onMouseEnter=function(){n.setState({active:!0})},n.onMouseLeave=function(){n.setState({active:!1})},n.deleteFile=function(e){e.preventDefault(),n.props.onDeleteTaggedFile(n.props.taggedFile)},n.state={active:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.taggedFile,n=e.shareLinkToken,r=e.enableFileDownload,o=t.parent_path?y.Aq.joinPath(t.parent_path,t.filename):"",i=n?g.Yc+"d/"+n+"/files/?p="+y.Aq.encodePath(o):g.Yc+"lib/"+this.props.repoID+"/file"+y.Aq.encodePath(o);return(0,A.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onFocus:this.onMouseEnter,children:[t.file_deleted?(0,A.jsx)(s.Fragment,{children:(0,A.jsxs)("td",{colSpan:"3",className:"name",children:[t.filename," ",(0,A.jsx)("span",{style:{color:"red"},children:(0,g.AP)("deleted")})]})}):(0,A.jsxs)(s.Fragment,{children:[(0,A.jsx)("td",{children:(0,A.jsx)("a",{href:i,target:"_blank",className:"d-inline-block w-100 ellipsis",title:t.filename,rel:"noreferrer",children:t.filename})}),(0,A.jsx)("td",{children:y.Aq.bytesToSize(t.size)}),(0,A.jsx)("td",{children:m().unix(t.mtime).fromNow()})]}),(0,A.jsxs)("td",{children:[!n&&(0,A.jsx)("a",{href:"#",role:"button","aria-label":(0,g.AP)("Delete"),title:(0,g.AP)("Delete"),className:"action-icon sf2-icon-x3".concat(this.state.active?"":" invisible"),onClick:this.deleteFile}),n&&r&&(0,A.jsx)("a",{className:"action-icon sf2-icon-download".concat(this.state.active?"":" invisible"),href:"".concat(i,"&dl=1"),title:(0,g.AP)("Download"),"aria-label":(0,g.AP)("Download")})]})]})}}])}(s.Component),w=function(e){function t(e){var n;return(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onListTaggedFiles=function(e){n.setState({currentTag:e,isListTaggedFileShow:!n.state.isListTaggedFileShow})},n.onCloseDialog=function(){n.setState({isListTaggedFileShow:!1})},n.state={currentTag:null,isListTaggedFileShow:!1},n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.repoID,r=t.usedRepoTags,o=t.className;return(0,A.jsxs)("div",{className:"repo-info-bar ".concat(o||""),children:[r.length>0&&(0,A.jsx)("ul",{className:"used-tag-list",children:r.map((function(t){return(0,A.jsxs)("li",{className:"used-tag-item",children:[(0,A.jsx)("span",{className:"used-tag",style:{backgroundColor:t.color}}),(0,A.jsx)("span",{className:"used-tag-name",title:t.name,children:t.name}),(0,A.jsx)("button",{type:"button",className:"used-tag-files border-0 bg-transparent",onClick:e.onListTaggedFiles.bind(e,t),children:t.fileCount>1?t.fileCount+" files":t.fileCount+" file"})]},t.id)}))}),this.state.isListTaggedFileShow&&(0,A.jsx)(l.A,{children:(0,A.jsx)(C,{repoID:n,currentTag:this.state.currentTag,onClose:this.onCloseDialog,toggleCancel:this.onListTaggedFiles,updateUsedRepoTags:this.props.updateUsedRepoTags,onFileTagChanged:this.props.onFileTagChanged,shareLinkToken:this.props.shareLinkToken,enableFileDownload:this.props.enableFileDownload})})]})}}])}(s.Component)},84295:function(e,t,n){"use strict";n.d(t,{A:function(){return v}});var r=n(89379),o=n(23029),i=n(92901),a=n(39874),s=n(85501),l=n(9950),c=n(92203),u=n(28321),d=n(66945),p=n(40326),h=n(65604),f=n(81446),m=n(44414),g=function(e){function t(e){var n;return(0,o.A)(this,t),(n=(0,a.A)(this,t,[e])).onLinkClick=function(e){n.props.onLinkClick(e)},n.changeInlineNode=function(e){var t,r,o=n.props.repoID;if("image"==e.type){if(t=e.data.src,new RegExp(p.xW+"/lib/"+o+"/file.*raw=1").test(t)){var i=t.indexOf("/file"),a=t.indexOf("?");r=t.substring(i+5,a)}else{if(!/^\.\.\/*/.test(t)&&!/^\.\/*/.test(t))return;var s=n.props.path,l=s.slice(0,s.lastIndexOf("/"))+"/"+t;r=h.Aq.pathNormalize(l)}e.data.src=p.xW+"/view-image-via-public-wiki/?slug="+p.yR+"&path="+r}else if("link"==e.type)if(t=e.url,h.Aq.isInternalFileLink(t,o))if(h.Aq.isInternalMarkdownLink(t,o)){var c=h.Aq.getPathFromInternalMarkdownLink(t,o);e.url=p.xW+"/published/"+p.yR+c}else e.url=t.replace(/(.*)lib\/([-0-9a-f]{36})\/file(.*)/g,(function(e,t,n,r){return"".concat(t,"d/").concat(p.Ji,"/files/?p=").concat(r,"&dl=1")}));else if(h.Aq.isInternalDirLink(t,o)){var u=h.Aq.getPathFromInternalDirLink(t,o);e.url=p.xW+"/published/"+p.yR+u}return e},n.modifyValueBeforeRender=function(e){return h.Aq.changeMarkdownNodes(e,n.changeInlineNode)},n.renderMarkdown=function(){var e=n.props,t=e.isTOCShow,o=void 0===t||t,i=e.isWiki,a=e.markdownContent,s=(0,r.A)({isShowOutline:o,mathJaxSource:"".concat(p.SG,"js/mathjax/tex-svg.js"),value:a,scrollRef:n.scrollRef,onLinkClick:n.onLinkClick},i&&{beforeRenderCallback:n.modifyValueBeforeRender});return(0,m.jsx)(u.I18nextProvider,{i18n:d.A,children:(0,m.jsx)(l.Suspense,{fallback:(0,m.jsx)(f.A,{}),children:(0,m.jsx)(c.MarkdownViewer,(0,r.A)({},s))})})},n.scrollRef=l.createRef(),n}return(0,s.A)(t,e),(0,i.A)(t,[{key:"render",value:function(){if(this.props.isFileLoading)return(0,m.jsx)(f.A,{});var e=this.props,t=e.isWiki,n=e.containerClassName,r="wiki-page-container ".concat(void 0===n?"":n),o="wiki-page-content ".concat(t?"":"w-100");return(0,m.jsx)("div",{ref:this.scrollRef,className:r,children:(0,m.jsxs)("div",{className:o,children:[this.props.children,this.renderMarkdown(),(0,m.jsxs)("p",{id:"wiki-page-last-modified",children:[(0,p.AP)("Last modified by")," ",this.props.latestContributor,", ",(0,m.jsx)("span",{children:this.props.lastModified})]})]})})}}])}(l.Component);g.defaultProps={isWiki:!1};var v=g},79837:function(e,t,n){"use strict";n.d(t,{A:function(){return g}});var r=n(23029),o=n(92901),i=n(39874),a=n(85501),s=n(9950),l=n(94634),c=n(40326),u=n(36402),d=n(65604),p=n(44414),h=function(e){function t(e){var n;(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onMouseEnter=function(){n.props.isItemFreezed||n.setState({isShowOperationMenu:!0,isHighlight:!0})},n.onMouseOver=function(){n.props.isItemFreezed||n.setState({isShowOperationMenu:!0,isHighlight:!0})},n.onMouseLeave=function(){n.props.isItemFreezed||n.setState({isShowOperationMenu:!1,isHighlight:!1})},n.onNodeClick=function(){var e=n.props.node.object;if(e.isDir())n.props.onNodeClick(n.props.node);else{var t=d.Aq.getUserPermission(e.permission),r=t.isCustomPermission,o=t.customPermission;if(r){var i=o.permission,a=i.preview,s=i.modify;if(!a&&!s)return}n.props.onNodeClick(n.props.node)}},n.onLoadToggle=function(e){e.stopPropagation();var t=n.props.node;t.isExpanded?n.props.onNodeCollapse(t):n.props.onNodeExpanded(t)},n.onNodeDragStart=function(e){if(d.Aq.isIEBrowser()||!n.canDrag)return!1;n.props.onNodeDragStart(e,n.props.node)},n.onNodeDragEnter=function(e){if(d.Aq.isIEBrowser()||!n.canDrag)return!1;"dir"===n.props.node.object.type&&n.setState({isNodeDropShow:!0}),n.props.onNodeDragEnter(e,n.props.node)},n.onNodeDragMove=function(e){if(d.Aq.isIEBrowser()||!n.canDrag)return!1;n.props.onNodeDragMove(e)},n.onNodeDragLeave=function(e){if(d.Aq.isIEBrowser()||!n.canDrag)return!1;n.setState({isNodeDropShow:!1}),n.props.onNodeDragLeave(e,n.props.node)},n.onNodeDrop=function(e){if(d.Aq.isIEBrowser()||!n.canDrag)return!1;e.stopPropagation(),n.setState({isNodeDropShow:!1}),n.props.onNodeDrop(e,n.props.node)},n.unfreezeItem=function(){n.setState({isShowOperationMenu:!1}),n.props.unfreezeItem()},n.onMenuItemClick=function(e,t,r){n.props.onMenuItemClick(e,r)},n.onItemMouseDown=function(e){e.stopPropagation(),e.button},n.onItemContextMenu=function(e){n.handleContextClick(e)},n.handleContextClick=function(e){n.props.handleContextClick(e,n.props.node),n.setState({isShowOperationMenu:!1})},n.getNodeTypeAndIcon=function(){var e=n.props.node,t="",r="";if("dir"===e.object.type)t=(0,p.jsx)("i",{className:"sf3-font sf3-font-folder"}),r="dir";else{var o=e.object.name.lastIndexOf(".");if(-1===o)t=(0,p.jsx)("i",{className:"sf3-font sf3-font-file"}),r="file";else{var i=e.object.name.slice(o).toLowerCase();".png"===i||".jpg"===i||".jpeg"===i||".gif"===i||".bmp"===i?(t=(0,p.jsx)("i",{className:"sf3-font sf3-font-image"}),r="image"):".md"===i||".markdown"===i?(t=(0,p.jsx)("i",{className:"sf3-font sf3-font-files2"}),r="file"):(t=(0,p.jsx)("i",{className:"sf3-font sf3-font-file"}),r="file")}}return{icon:t,type:r}},n.calculateMenuList=function(e){var t=l.A.NEW_FOLDER,r=l.A.NEW_FILE,o=l.A.COPY,i=l.A.MOVE,a=l.A.RENAME,s=l.A.DELETE,c=l.A.OPEN_VIA_CLIENT,u=[a,s,o,i,c];"dir"===e.object.type&&(u=[t,r,o,i,a,s]);var p=n.props.userPerm,h=d.Aq.getUserPermission(p),f=h.isCustomPermission,m=h.customPermission;if(!f)return u;u=[];var g=m.permission,v=g.create,y=g.modify,x=g.delete,A=g.copy;return"dir"===e.object.type&&v&&u.push(t,r),A&&u.push(o),y&&u.push(i,a),x&&u.push(s),"dir"!==e.object.type&&u.push(c),u},n.renderChildren=function(){var e=n.props.node;return e.hasChildren()?(0,p.jsx)("div",{className:"children",children:e.children.map((function(e){return(0,p.jsx)(t,{node:e,leftIndent:n.props.leftIndent+20,userPerm:n.props.userPerm,currentPath:n.props.currentPath,isNodeMenuShow:n.props.isNodeMenuShow,isItemFreezed:n.props.isItemFreezed,onNodeClick:n.props.onNodeClick,onNodeCollapse:n.props.onNodeCollapse,onNodeExpanded:n.props.onNodeExpanded,freezeItem:n.props.freezeItem,onMenuItemClick:n.props.onMenuItemClick,unfreezeItem:n.unfreezeItem,onNodeDragStart:n.props.onNodeDragStart,onNodeDragMove:n.props.onNodeDragMove,onNodeDrop:n.props.onNodeDrop,onNodeDragEnter:n.props.onNodeDragEnter,onNodeDragLeave:n.props.onNodeDragLeave,handleContextClick:n.props.handleContextClick,isDisplayFiles:n.props.isDisplayFiles},e.path)}))}):""},n.state={isHighlight:!1,isShowOperationMenu:!1,isNodeDropShow:!1};var o=e.userPerm;n.canDrag="rw"===o;var a=d.Aq.getUserPermission(o),s=a.isCustomPermission,c=a.customPermission;if(s){var u=c.permission.modify;n.canDrag=u}return n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.isItemFreezed||this.setState({isShowOperationMenu:!1,isHighlight:!1})}},{key:"render",value:function(){var e=this.props,t=e.currentPath,n=e.node,r=e.isNodeMenuShow,o=e.userPerm,i=e.leftIndent,a=this.getNodeTypeAndIcon(),s=a.type,l=a.icon,h=this.state.isHighlight?"tree-node-inner-hover ":"";if(n.path===t&&(h="tree-node-hight-light"),"/"!==n.path&&"dir"!==s&&!this.props.isDisplayFiles)return"";var f=d.Aq.getUserPermission(o).isCustomPermission;return(0,p.jsxs)("div",{className:"tree-node",children:[(0,p.jsxs)("div",{type:s,className:"tree-node-inner text-nowrap ".concat(h," ").concat("/"===n.path?"hide":""," ").concat(this.state.isNodeDropShow?"tree-node-drop":""),title:n.object.name,onMouseEnter:this.onMouseEnter,onMouseOver:this.onMouseOver,onMouseLeave:this.onMouseLeave,onMouseDown:this.onItemMouseDown,onContextMenu:this.onItemContextMenu,onClick:this.onNodeClick,children:[(0,p.jsx)("div",{className:"tree-node-text",draggable:this.canDrag,onDragStart:this.onNodeDragStart,onDragEnter:this.onNodeDragEnter,onDragLeave:this.onNodeDragLeave,onDragOver:this.onNodeDragMove,onDrop:this.onNodeDrop,style:{paddingLeft:i+5},children:n.object.name}),(0,p.jsxs)("div",{className:"left-icon",style:{left:i-40},children:["dir"===s&&(!n.isLoaded||n.isLoaded&&n.hasChildren())&&(0,p.jsx)("i",{className:"folder-toggle-icon sf3-font sf3-font-down ".concat(n.isExpanded?"":"rotate-270"),onMouseDown:function(e){return e.stopPropagation()},onClick:this.onLoadToggle}),(0,p.jsx)("i",{className:"tree-node-icon",children:l})]}),r&&(0,p.jsx)("div",{className:"right-icon",children:("rw"===o||c.ln||f)&&this.state.isShowOperationMenu&&(0,p.jsx)(u.A,{item:this.props.node,toggleClass:"sf3-font sf3-font-more-vertical",getMenuList:this.calculateMenuList,onMenuItemClick:this.onMenuItemClick,freezeItem:this.props.freezeItem,unfreezeItem:this.unfreezeItem,menuStyle:d.Fr?{zIndex:1050}:{}})})]}),n.isExpanded&&this.renderChildren()]})}}])}(s.Component),f=n(29009),m=n(46757),g=function(e){function t(e){var n;(0,r.A)(this,t),(n=(0,i.A)(this,t,[e])).onItemMove=function(e,t,r,o){n.props.onItemMove(e,t,r,o)},n.onNodeDragStart=function(e,t){if(d.Aq.isIEBrowser())return!1;var n={nodeDirent:t.object,nodeParentPath:t.parentNode.path,nodeRootPath:t.path};n=JSON.stringify(n),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("application/drag-item-info",n)},n.onNodeDragEnter=function(e,t){if(d.Aq.isIEBrowser()||!n.canDrop)return!1;e.persist(),"tree-view tree "===e.target.className&&n.setState({isTreeViewDropTipShow:!0})},n.onNodeDragMove=function(e){if(d.Aq.isIEBrowser()||!n.canDrop)return!1;e.preventDefault(),e.dataTransfer.dropEffect="move"},n.onNodeDragLeave=function(e,t){if(d.Aq.isIEBrowser()||!n.canDrop)return!1;"tree-view tree tree-view-drop"===e.target.className&&n.setState({isTreeViewDropTipShow:!1})},n.onContainerClick=function(e){(0,m.ks)()},n.onNodeClick=function(e){(0,m.ks)(),n.props.onNodeClick(e)},n.onNodeDrop=function(e,t){if(d.Aq.isIEBrowser()||!n.canDrop)return!1;if(!e.dataTransfer.files.length){var r=e.dataTransfer.getData("application/drag-item-info");if(r){var o=r=JSON.parse(r),i=o.nodeDirent,a=o.nodeParentPath,s=o.nodeRootPath,l=t;if(Array.isArray(r))return l?void n.onMoveItems(r,l,n.props.currentRepoInfo,l.path):("/"===r[0].nodeParentPath||n.props.onItemsMove(n.props.currentRepoInfo,"/"),void n.setState({isTreeViewDropTipShow:!1}));if(!l)return"/"===a||n.onItemMove(n.props.currentRepoInfo,i,"/",a),void n.setState({isTreeViewDropTipShow:!1});if("dir"===l.object.type&&a!==l.path&&(a!==l.parentNode.path||l.object.name!==i.name)){if("dir"===l.object.type&&"dir"===i.type)if(l.parentNode.path!==a)if(d.Aq.getPaths(l.path).includes(s))return;n.onItemMove(n.props.currentRepoInfo,i,l.path,a)}}}},n.onMoveItems=function(e,t,r,o){var i=[],a=d.Aq.getPaths(o);(e.forEach((function(e){var t=e.nodeRootPath;i.push(t)})),"dir"===t.object.type)&&(i.some((function(e){return e===o}))||e[0].nodeParentPath&&e[0].nodeParentPath===t.path||i.some((function(e){return a.includes(e)}))||n.props.onItemsMove(r,o))},n.freezeItem=function(){n.setState({isItemFreezed:!0})},n.unfreezeItem=function(){n.setState({isItemFreezed:!1})},n.onMenuItemClick=function(e,t){n.props.onMenuItemClick(e,t),(0,m.ks)()},n.onMouseDown=function(e){e.stopPropagation(),e.button},n.onContextMenu=function(e){e.preventDefault();var t=n.props.currentRepoInfo;if("admin"!==t.permission&&"rw"!==t.permission)return"";n.handleContextClick(e)},n.handleContextClick=function(e,t){if(e.preventDefault(),e.stopPropagation(),n.props.isNodeMenuShow){var r=e.clientX||e.touches&&e.touches[0].pageX,o=e.clientY||e.touches&&e.touches[0].pageY;n.props.posX&&(r-=n.props.posX),n.props.posY&&(o-=n.props.posY),(0,m.ks)();var i=n.getMenuList(t),a={id:"tree-node-contextmenu",position:{x:r,y:o},target:e.target,currentObject:t,menuList:i};(0,m.db)(a)}},n.getMenuList=function(e){var t=[],r=l.A.NEW_FOLDER,o=l.A.NEW_FILE,i=l.A.COPY,a=l.A.MOVE,s=l.A.RENAME,c=l.A.DELETE,u=l.A.OPEN_VIA_CLIENT;if(!e)return[r,o];t="dir"===e.object.type?[r,o,i,a,s,c]:[s,c,i,a,u];var p=n.props.userPerm,h=d.Aq.getUserPermission(p),f=h.isCustomPermission,m=h.customPermission;if(!f)return t;t=[];var g=m.permission,v=g.create,y=g.modify,x=g.delete,A=g.copy;return e?("dir"===e.object.type&&v&&t.push(r,o),A&&t.push(i),y&&t.push(a,s),x&&t.push(c),"dir"!==e.object.type&&t.push(u),t):(v&&t.push(r,o),t)},n.onShowMenu=function(){n.freezeItem()},n.onHideMenu=function(){n.unfreezeItem()},n.state={isItemFreezed:!1,isTreeViewDropTipShow:!1};var o=e.userPerm;n.canDrop="rw"===o;var a=d.Aq.getUserPermission(o),s=a.isCustomPermission,c=a.customPermission;if(s){var u=c.permission.modify;n.canDrop=u}return n}return(0,a.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return(0,p.jsxs)("div",{className:"tree-view tree ".concat(this.state.isTreeViewDropTipShow&&this.canDrop?"tree-view-drop":""),onDrop:this.onNodeDrop,onDragEnter:this.onNodeDragEnter,onDragLeave:this.onNodeDragLeave,onMouseDown:this.onMouseDown,onContextMenu:this.onContextMenu,onClick:this.onContainerClick,children:[(0,p.jsx)(h,{userPerm:this.props.userPerm,node:this.props.treeData.root,currentPath:this.props.currentPath,leftIndent:20,isNodeMenuShow:this.props.isNodeMenuShow,isItemFreezed:this.state.isItemFreezed,onNodeClick:this.onNodeClick,onMenuItemClick:this.props.onMenuItemClick,onNodeExpanded:this.props.onNodeExpanded,onNodeCollapse:this.props.onNodeCollapse,onNodeDragStart:this.onNodeDragStart,freezeItem:this.freezeItem,unfreezeItem:this.unfreezeItem,onNodeDragMove:this.onNodeDragMove,onNodeDrop:this.onNodeDrop,onNodeDragEnter:this.onNodeDragEnter,onNodeDragLeave:this.onNodeDragLeave,handleContextClick:this.handleContextClick,isDisplayFiles:this.props.isDisplayFiles}),(0,p.jsx)(f.A,{id:"tree-node-contextmenu",onMenuItemClick:this.onMenuItemClick,onHideMenu:this.onHideMenu,onShowMenu:this.onShowMenu,getMenuContainerSize:this.props.getMenuContainerSize})]})}}])}(s.Component)},76805:function(e){e.exports={Backspace:8,Tab:9,Enter:13,Shift:16,Ctrl:17,Alt:18,PauseBreak:19,CapsLock:20,Escape:27,Esc:27,Space:32,PageUp:33,PageDown:34,End:35,Home:36,LeftArrow:37,UpArrow:38,RightArrow:39,DownArrow:40,Insert:45,Delete:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,LeftWindowKey:91,RightWindowKey:92,SelectKey:93,NumPad0:96,NumPad1:97,NumPad2:98,NumPad3:99,NumPad4:100,NumPad5:101,NumPad6:102,NumPad7:103,NumPad8:104,NumPad9:105,Multiply:106,Add:107,Subtract:109,DecimalPoint:110,Divide:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F12:123,NumLock:144,ScrollLock:145,SemiColon:186,EqualSign:187,Comma:188,Dash:189,Period:190,ForwardSlash:191,GraveAccent:192,OpenBracket:219,BackSlash:220,CloseBracket:221,SingleQuote:222,ChineseInputMethod:229}},72784:function(e,t,n){"use strict";var r=n(89857),o=n(2009);t.A=(0,r.JY)(o.Ay)},76154:function(e,t,n){"use strict";var r=n(23029),o=n(92901),i=n(58801),a=n(26910),s=n(85520),l=n.n(s),c=n(40326),u=function(){return(0,o.A)((function e(){(0,r.A)(this,e)}),[{key:"init",value:function(e){var t=e.server,n=e.username,r=e.password,o=e.token;return this.server=t,this.username=n,this.password=r,this.token=o,this.token&&this.server&&(this.req=a.A.create({baseURL:this.server,headers:{Authorization:"Token "+this.token}})),this}},{key:"initForSeahubUsage",value:function(e){var t=e.siteRoot,n=e.xcsrfHeaders;if(t&&"/"===t.charAt(t.length-1)){var r=t.substring(0,t.length-1);this.server=r}else this.server=t;return this.req=a.A.create({headers:{"X-CSRFToken":n}}),this}},{key:"_sendPostRequest",value:function(e,t){return t.getHeaders?this.req.post(e,t,{headers:t.getHeaders()}):this.req.post(e,t)}},{key:"listWikiDepartments",value:function(){var e=this.server+"/api/v2.1/departments/";return this.req.get(e,{params:{can_admin:!0}})}},{key:"listWikiDir",value:function(e,t,n){var r=encodeURIComponent(t),o=this.server+"/api/v2.1/wikis/"+e+"/dir/?p="+r;return n&&(o=this.server+"/api/v2.1/wikis/"+e+"/dir/?p="+r+"&with_parents="+n),this.req.get(o)}},{key:"getWikiFileContent",value:function(e,t){var n=encodeURIComponent(t),r=(new Date).getTime(),o=this.server+"/api/v2.1/wikis/"+e+"/content/?p="+n+"&_="+r;return this.req.get(o)}},{key:"listWikis",value:function(e){var t=this.server+"/api/v2.1/wikis/";return e?this.req.get(t,{params:e,paramsSerializer:{serialize:function(e){var t=[];for(var n in e)if(Array.isArray(e[n]))for(var r=0,o=e[n].length;r<o;r++)t.push(n+"="+encodeURIComponent(e[n][r]));else t.push(n+"="+encodeURIComponent(e[n]));return t.join("&")}}}):this.req.get(t)}},{key:"addWiki",value:function(e){var t=this.server+"/api/v2.1/wikis/",n=new(l());return n.append("name",e),this._sendPostRequest(t,n)}},{key:"renameWiki",value:function(e,t){var n=this.server+"/api/v2.1/wikis/"+e+"/",r=new(l());return r.append("wiki_name",t),this._sendPostRequest(n,r)}},{key:"deleteWiki",value:function(e){var t=this.server+"/api/v2.1/wikis/"+e+"/";return this.req.delete(t)}},{key:"listWikis2",value:function(e){var t=this.server+"/api/v2.1/wikis2/";return e?this.req.get(t,{params:e,paramsSerializer:{serialize:function(e){var t=[];for(var n in e)if(Array.isArray(e[n]))for(var r=0,o=e[n].length;r<o;r++)t.push(n+"="+encodeURIComponent(e[n][r]));else t.push(n+"="+encodeURIComponent(e[n]));return t.join("&")}}}):this.req.get(t)}},{key:"addWiki2",value:function(e,t){var n=this.server+"/api/v2.1/wikis2/",r=new(l());return r.append("name",e),t&&r.append("owner",t),this._sendPostRequest(n,r)}},{key:"deleteWiki2",value:function(e){var t=this.server+"/api/v2.1/wiki2/"+e+"/";return this.req.delete(t)}},{key:"updateWiki2Config",value:function(e,t){var n=this.server+"/api/v2.1/wiki2/"+e+"/config/",r={wiki_config:t};return this.req.put(n,r)}},{key:"getWiki2Config",value:function(e){var t=this.server+"/api/v2.1/wiki2/"+e+"/config/";return this.req.get(t)}},{key:"createWiki2Page",value:function(e,t,n){var r=this.server+"/api/v2.1/wiki2/"+e+"/pages/",o=new(l());return o.append("page_name",t),n&&o.append("current_id",n),this._sendPostRequest(r,o)}},{key:"deleteWiki2Page",value:function(e,t){var n=this.server+"/api/v2.1/wiki2/"+e+"/page/"+t+"/";return this.req.delete(n)}},{key:"moveWiki2Page",value:function(e,t,n,r){var o=this.server+"/api/v2.1/wiki2/"+e+"/pages/",i={moved_id:t,target_id:n,move_position:r};return this.req.put(o,i)}},{key:"deleteWiki2Folder",value:function(e,t){var n=this.server+"/api/v2.1/wiki2/"+e+"/folder/"+t+"/";return this.req.delete(n)}},{key:"getWiki2Page",value:function(e,t){var n=this.server+"/api/v2.1/wiki2/"+e+"/page/"+t+"/";return this.req.get(n)}},{key:"renameWiki2",value:function(e,t){var n=this.server+"/api/v2.1/wiki2/"+e+"/",r={wiki_name:t};return this.req.put(n,r)}},{key:"duplicateWiki2Page",value:function(e,t){var n=this.server+"/api/v2.1/wiki2/"+e+"/duplicate-page/",r=new(l());return r.append("page_id",t),this._sendPostRequest(n,r)}},{key:"getWikiTrash",value:function(e,t,n){var r=this.server+"/api/v2.1/wiki2/"+e+"/trash/",o={page:t||1,per_page:n};return this.req.get(r,{params:o})}},{key:"revertTrashPage",value:function(e,t){var n=this.server+"/api/v2.1/wiki2/"+e+"/trash/",r={page_id:t};return this.req.put(n,r)}},{key:"cleanWikiTrash",value:function(e,t){var n=this.server+"/api/v2.1/wiki2/"+e+"/trash/",r={keep_days:t};return this.req.delete(n,{data:r})}}])}(),d=new u,p=i.Ay.load("sfcsrftoken");d.initForSeahubUsage({siteRoot:c.Yc,xcsrfHeaders:p}),t.A=d},58814:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,i=n(18336).default,a=n(29511).default,s=n(24994).default,l=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(9950)),u=s(n(17119)),d=s(n(82894)),p=s(n(39739)),h=n(66327),f=s(n(44956)),m=n(56265);n(43195),n(92356),n(92305),n(63138);var g=(0,f.default)(),v=function(e){function t(e){var n;return r(this,t),(n=i(this,t,[e])).onChange=function(e){e&&(n.setState({value:e}),(0,m.isFunction)(n.props.onChange)&&n.props.onChange(e.format(n.valueSubmitFormat)))},n.getValue=function(){var e=n.state.value;return e?e.format(n.valueSubmitFormat):null},n.getInputNode=function(){var e=u.default.findDOMNode(n);return"INPUT"===e.tagName?e:e.querySelector("input:not([type=hidden])")},n.onOpenChange=function(e){n.setState({open:e},(function(){e||n.props.onClose&&n.props.onClose()}))},n.onReadOnlyFocus=function(){n.setState({open:!0})},n.onBlur=function(e){n.props.onBlur&&n.props.onBlur(e)},n.closeEditor=function(){n.setState({open:!1}),n.onBlur()},n.getCalendarContainer=function(){return document.body},n.handleMouseDown=function(e){e.preventDefault()},n.handleKeyDown=function(e){[37,38,39,40].includes(e.keyCode)?e.stopPropagation():13===e.keyCode&&(e.preventDefault(),n.onBlur("enter"))},n.onClick=function(e){e.stopPropagation();var t=(0,m.getEventClassName)(e);n.showHourAndMinute||"rc-calendar-date"!==t||(n.timer=setTimeout((function(){n.closeEditor()}),1)),n.showHourAndMinute&&"rc-calendar-date"===t&&n.setState({open:!0})},n.onClear=function(){(0,m.isFunction)(n.props.onClear)?n.props.onClear():n.setState({value:null},(function(){n.setState({open:!0})}))},n.onHotKey=function(e){27===e.keyCode&&(e.stopPropagation(),n.props.onClose&&n.props.onClose())},n.getCalendarFormat=function(){if(n.format.indexOf("YYYY-MM-DD")>-1){var e=n.format.replace("YYYY-MM-DD","YYYY-M-D");return[n.format,e]}if(n.format.indexOf("DD/MM/YYYY")>-1){var t=n.format.replace("DD/MM/YYYY","D/M/YYYY");return[n.format,t]}return[n.format]},n.getDefaultMinutesTime=function(){var e=n.props.value;return e?(0,f.default)(e).format("HH:mm"):""},n.onClickRightPanelTime=function(){setTimeout((function(){n.closeEditor()}),1)},n.state={value:null,open:!0},n.format=e.format||"YYYY-MM-DD",n.calendarContainerRef=c.default.createRef(),n.defaultCalendarValue=null,n.showHourAndMinute=n.format.indexOf("HH:mm")>-1,n.valueSubmitFormat=n.showHourAndMinute?"YYYY-MM-DD HH:mm":"YYYY-MM-DD",n}return a(t,e),o(t,[{key:"componentDidMount",value:function(){var e="zh-cn"===this.props.lang;g=e?g.locale("zh-cn"):g.locale("en-gb"),this.defaultCalendarValue=g.clone();var t=this.props.value;if(t&&(0,f.default)(t).isValid()){if("string"===typeof t&&1===t.length&&!isNaN(Number(t,10)))return void(this.timer=setTimeout((function(){var e=document.getElementsByClassName("rc-calendar-input")[0];e&&(e.value=t)}),200));var n=(0,f.default)(t).isValid()?(0,f.default)(t):(0,f.default)(this.defaultCalendarValue);this.setState({value:e?(0,f.default)(n).locale("zh-cn"):(0,f.default)(n).locale("en-gb")})}document.addEventListener("keydown",this.onHotKey,!0)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.onHotKey,!0),this.timer&&(clearTimeout(this.timer),this.timer=null)}},{key:"render",value:function(){var e=this,t=this.props,n=t.isReadOnly,r=t.lang,o=this.state;if(n)return c.default.createElement("input",{className:"ant-calendar-picker-input ant-input form-control",value:o.value?o.value.format(this.format):"",disabled:!0});var i=this.getCalendarFormat(),a=this.getDefaultMinutesTime(),s=c.default.createElement(d.default,{className:"sf-metadata-rc-calendar",locale:(0,h.translateCalendar)(r),style:{zIndex:1001},dateInputPlaceholder:(0,m.gettext)("Enter date"),format:i,defaultValue:this.defaultCalendarValue,showDateInput:!0,focusablePanel:!1,showHourAndMinute:this.showHourAndMinute,onClear:this.onClear,onClickRightPanelTime:this.onClickRightPanelTime,defaultMinutesTime:a});return c.default.createElement("div",{className:"date-picker-container",onKeyDown:function(t){return e.handleKeyDown(t)},onClick:function(t){return e.onClick(t)}},c.default.createElement(p.default,{calendar:s,value:o.value,onChange:this.onChange,getCalendarContainer:this.getCalendarContainer,onOpenChange:this.onOpenChange,open:o.open,style:{zIndex:1001}},(function(t){var n=t.value;return c.default.createElement("span",{tabIndex:"0",onFocus:e.onReadOnlyFocus},c.default.createElement("input",{placeholder:e.format?e.format:(0,m.gettext)("Please select"),tabIndex:"-1",readOnly:!0,className:"ant-calendar-picker-input ant-input form-control",value:n?n.format(e.format):"",onMouseDown:e.handleMouseDown}),c.default.createElement("div",{ref:e.calendarContainerRef}))})))}}])}(c.Component);v.defaultProps={format:"YYYY-MM-DD",lang:"zh-cn",isReadOnly:!1};t.default=v},97157:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,i=n(18336).default,a=n(29511).default,s=n(24994).default,l=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(9950)),u=s(n(82894)),d=s(n(39739)),p=n(66327),h=s(n(44956));n(43195),n(92356),n(92305),n(63138);var f=(0,h.default)(),m=function(e){function t(e){var n;return r(this,t),(n=i(this,t,[e])).handleMouseDown=function(e){e.preventDefault()},n.onChange=function(e){var t=n.props.onChange;n.setState({value:e},(function(){n.state.value&&t(n.state.value.format("YYYY-MM-DD"))}))},n.onClear=function(){n.setState({value:null},(function(){n.setState({open:!0})}))},n.onOpenChange=function(e){n.setState({open:e})},n.onReadOnlyFocus=function(){!n.state.open&&n.state.isMouseDown?n.setState({isMouseDown:!1}):n.setState({open:!0})},n.getCalendarContainer=function(){return n.calendarContainerRef.current},n.getCalendarFormat=function(){if(n.format.indexOf("YYYY-MM-DD")>-1){var e=n.format.replace("YYYY-MM-DD","YYYY-M-D");return[n.format,e]}if(n.format.indexOf("DD/MM/YYYY")>-1){var t=n.format.replace("DD/MM/YYYY","D/M/YYYY");return[n.format,t]}return[n.format]},n.state={open:!1,value:null},n.format=e.format.split(" ")[0],n.calendarContainerRef=c.default.createRef(),n.defaultCalendarValue=null,n}return a(t,e),o(t,[{key:"componentDidMount",value:function(){var e="zh-cn"===this.props.lang;f=e?f.locale("zh-cn"):f.locale("en-gb"),this.defaultCalendarValue=f.clone();var t=this.props.value;if(t&&(0,h.default)(t).isValid()){var n=(0,h.default)(t).isValid()?(0,h.default)(t):(0,h.default)(this.defaultCalendarValue);this.setState({value:e?(0,h.default)(n).locale("zh-cn"):(0,h.default)(n).locale("en-gb")})}}},{key:"render",value:function(){var e=this,t=this.props,n=t.isReadOnly,r=t.lang,o=t.zIndex,i=this.state;if(n)return c.default.createElement("input",{className:"ant-calendar-picker-input ant-input form-control",value:i.value?i.value.format(this.format):"",disabled:!0});var a=this.getCalendarFormat(),s=c.default.createElement(u.default,{className:"sf-metadata-rc-calendar",locale:(0,p.translateCalendar)(r),style:{zIndex:o||1001},dateInputPlaceholder:"please enter date",format:a,defaultValue:this.defaultCalendarValue,showDateInput:!0,focusablePanel:!1,onClear:this.onClear});return c.default.createElement("div",{className:"date-picker-container"},c.default.createElement(d.default,{calendar:s,value:i.value,onChange:this.onChange,getCalendarContainer:this.getCalendarContainer,onOpenChange:this.onOpenChange,open:i.open,style:{zIndex:o||1001}},(function(t){var n=t.value;return c.default.createElement("span",{tabIndex:"0",onFocus:e.onReadOnlyFocus},c.default.createElement("input",{tabIndex:"-1",readOnly:!0,className:"ant-calendar-picker-input ant-input form-control",value:n?n.format(e.format):"",onMouseDown:e.handleMouseDown}),c.default.createElement("div",{ref:e.calendarContainerRef}))})))}}])}(c.Component);m.defaultProps={format:"YYYY-MM-DD",lang:"zh-cn",isReadOnly:!1};t.default=m},49046:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"SfCalendar",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"SfFilterCalendar",{enumerable:!0,get:function(){return i.default}});var o=r(n(58814)),i=r(n(97157))},66327:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.translateCalendar=function(e){var t;switch(e||"en"){case"zh-cn":t=r;break;case"zh-tw":t=o;break;case"en":default:t=i;break;case"fr":t=a;break;case"de":t=s;break;case"es":case"es-ar":case"es-mx":t=l;break;case"pl":t=c;break;case"cs":t=u;break;case"ru":t=d}return t};var r=n(95502),o=n(33850),i=n(37932),a=n(88309),s=n(10507),l=n(1205),c=n(16969),u=n(19550),d=n(36967)},13677:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(9950)),i=r(n(86615)),a=r(n(26984));n(41939);t.default=function(e){return o.default.createElement("div",{className:(0,i.default)("sf-metadata-centered-loading",e.className)},o.default.createElement(a.default,null))}},92178:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,i=n(18336).default,a=n(29511).default,s=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(n(9950)),c=function(e){function t(){var e;return r(this,t),(e=i(this,t,arguments)).isClickedInside=!1,e.handleDocumentClick=function(t){e.isClickedInside?e.isClickedInside=!1:e.props.onClickOutside(t)},e.handleMouseDown=function(){e.isClickedInside=!0},e}return a(t,e),o(t,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.handleDocumentClick)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.handleDocumentClick)}},{key:"render",value:function(){return l.default.cloneElement(l.default.Children.only(this.props.children),{onMouseDownCapture:this.handleMouseDown})}}])}(l.default.Component);t.default=c},57425:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"CellType",{enumerable:!0,get:function(){return o.default}}),t.GEOLOCATION_FORMAT=t.DELETED_OPTION_TIPS=t.DELETED_OPTION_BACKGROUND_COLOR=t.DEFAULT_NUMBER_FORMAT=void 0;var o=r(n(54965));t.GEOLOCATION_FORMAT={LNG_LAT:"lng_lat",COUNTRY_REGION:"country_region",PROVINCE:"province",PROVINCE_CITY:"province_city",PROVINCE_CITY_DISTRICT:"province_city_district",MAP_SELECTION:"map_selection"},t.DEFAULT_NUMBER_FORMAT="number",t.DELETED_OPTION_BACKGROUND_COLOR="#eaeaea",t.DELETED_OPTION_TIPS="Deleted_option"},54965:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={DEFAULT:"default",TEXT:"text",CREATOR:"creator",CTIME:"ctime",LAST_MODIFIER:"last-modifier",MTIME:"mtime",FILE_NAME:"file-name",CHECKBOX:"checkbox",COLLABORATOR:"collaborator",DATE:"date",LONG_TEXT:"long-text",SINGLE_SELECT:"single-select",MULTIPLE_SELECT:"multiple-select",NUMBER:"number",GEOLOCATION:"geolocation"}},18142:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(9950)),i=r(n(35349));n(70238);t.default=function(e){var t=e.callBack,n=e.footerName,r=e.className,a=e.addIconClassName,s=e.hideIcon,l=e.style;return o.default.createElement("div",{className:"sf-metadata-ui add-item-btn ".concat(r||""),style:l,onClick:function(e){t(e)}},!s&&o.default.createElement(i.default,{iconName:"add-table",className:a}),o.default.createElement("span",{className:"text-truncate"},n))}},55859:function(e,t,n){"use strict";var r=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(9950)),i=n(48843),a=n(56265),s=function(e){var t=e.target,n=e.innerClassName,r=e.className,s=e.hideArrow,l=e.modifiers,c=e.placement,u=e.canHide,d=e.hide,p=e.hideWithEsc,h=e.children,f=(0,o.useRef)(null),m=(0,o.useCallback)((function(e){u&&f.current&&e&&-1===(0,a.getEventClassName)(e).indexOf("popover")&&!f.current.contains(e.target)&&d(e)}),[u,d]),g=(0,o.useCallback)((function(e){if(27===e.keyCode&&"function"===typeof p)e.preventDefault(),p();else if(13===e.keyCode){if(u)return;e.stopImmediatePropagation()}}),[u,p]),v=(0,o.useCallback)((function(e){e.preventDefault(),d(e)}),[d]),y=(0,o.useCallback)((function(e){e.stopPropagation()}),[]);return(0,o.useEffect)((function(){return document.addEventListener("click",m),document.addEventListener("keydown",g),window.addEventListener("popstate",v),function(){document.removeEventListener("click",m),document.removeEventListener("keydown",g),window.removeEventListener("popstate",v)}}),[m,g,v]),o.default.createElement(i.Popover,{placement:c,isOpen:!0,target:t,fade:!1,hideArrow:s,innerClassName:n,className:r,modifiers:l},o.default.createElement("div",{ref:f,onClick:y},h))};s.defaultProps={placement:"bottom-start",hideArrow:!0,canHide:!0};t.default=s},71082:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,i=n(18336).default,a=n(29511).default,s=n(24994).default,l=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(9950)),u=s(n(86615)),d=s(n(35349)),p=s(n(20536)),h=s(n(90665)),f=n(56265);n(86954);var m=function(e){function t(e){var n;return r(this,t),(n=i(this,t,[e])).onSelectToggle=function(e){e.preventDefault(),n.state.isShowSelectOptions&&e.stopPropagation();var t=(0,f.getEventClassName)(e);n.props.readOnly||t.indexOf("option-search-control")>-1||"sf-metadata-option-group-search"===t||""!==e.target.value&&n.setState({isShowSelectOptions:!n.state.isShowSelectOptions})},n.onClick=function(e){n.props.isShowSelected&&e.target.className.includes("icon-fork-number")||n.selector.contains(e.target)||n.closeSelect()},n.closeSelect=function(){n.setState({isShowSelectOptions:!1})},n.getSelectedOptionTop=function(){return n.selector?n.selector.getBoundingClientRect().height:38},n.getFilterOptions=function(e){var t=n.props,r=t.options;if(!t.searchable)return r||[];var o=e.trim().toLowerCase();return o?r.filter((function(e){var t=e.value,n=e.name;return"string"===typeof n?n.toLowerCase().indexOf(o)>-1:"object"===typeof t&&(t.column?t.column.name.toLowerCase().indexOf(o)>-1:t.name?t.name.toLowerCase().indexOf(o)>-1:t.columnOption&&t.columnOption.name.toLowerCase().indexOf(o)>-1)})):r||[]},n.renderDropDownIcon=function(){var e=n.props,t=e.readOnly,r=e.component;if(!t){var o=(r||{}).DropDownIcon;return o?c.default.createElement("div",{className:"custom-select-dropdown-icon"},o):c.default.createElement(d.default,{iconName:"drop-down"})}},n.state={isShowSelectOptions:!1},n}return a(t,e),o(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.className,r=t.value,o=t.options,i=t.placeholder,a=t.searchable,s=t.searchPlaceholder,l=t.noOptionsPlaceholder,d=t.readOnly,f=t.isInModal,m=t.addOptionAble,g=t.component;return c.default.createElement("div",{ref:function(t){return e.selector=t},className:(0,u.default)("sf-metadata-select custom-select",{focus:this.state.isShowSelectOptions},{disabled:d},n),onClick:this.onSelectToggle},c.default.createElement("div",{className:"selected-option"},r&&r.label?c.default.createElement("span",{className:"selected-option-show"},r.label):c.default.createElement("span",{className:"select-placeholder"},i),this.renderDropDownIcon()),this.state.isShowSelectOptions&&!f&&c.default.createElement(p.default,{value:r,addOptionAble:m,component:g,isShowSelected:this.props.isShowSelected,top:this.getSelectedOptionTop(),options:o,onSelectOption:this.props.onSelectOption,searchable:a,searchPlaceholder:s,noOptionsPlaceholder:l,onClickOutside:this.onClick,closeSelect:this.closeSelect,getFilterOptions:this.getFilterOptions,supportMultipleSelect:this.props.supportMultipleSelect}),this.state.isShowSelectOptions&&f&&c.default.createElement(h.default,null,c.default.createElement(p.default,{className:n,value:r,addOptionAble:m,component:g,isShowSelected:this.props.isShowSelected,position:this.selector.getBoundingClientRect(),isInModal:f,top:this.getSelectedOptionTop(),options:o,onSelectOption:this.props.onSelectOption,searchable:a,searchPlaceholder:s,noOptionsPlaceholder:l,onClickOutside:this.onClick,closeSelect:this.closeSelect,getFilterOptions:this.getFilterOptions,supportMultipleSelect:this.props.supportMultipleSelect})))}}])}(c.Component);t.default=m},62088:function(e,t,n){"use strict";var r=n(85715).default,o=n(24994).default,i=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=i(n(9950)),s=n(56265),l=o(n(783));t.default=function(e){var t=e.value,n=e.mediaUrl,o=e.api,i=e.collaborators,c=e.collaboratorsCache,u=e.updateCollaboratorsCache,d=(0,a.useState)(null),p=r(d,2),h=p[0],f=p[1];return(0,a.useEffect)((function(){var e=!0;if(!t)return e&&f(null),function(){return e=!1};var r=i&&i.find((function(e){return e.email===t}));if(r)return e&&f(r),function(){return e=!1};var a="".concat(n,"/avatars/default.png");return"anonymous"===t?(r={name:"anonymous",avatar_url:a},e&&f(r),function(){return e=!1}):(r=c[t])?(e&&f(r),function(){return e=!1}):(0,s.isValidEmail)(t)?(o&&o(t,(function(n){r=n[t],u(r),e&&f(r)})),function(){return e=!1}):(u(r={email:t,name:t,avatar_url:a}),e&&f(r),function(){return e=!1})}),[]),h?a.default.createElement(l.default,{collaborator:h}):null}},25217:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(9950)),i=r(n(86615)),a=r(n(35349));n(95399);t.default=function(e){var t=e.value,n=e.className,r=e.children;return t?o.default.createElement("div",{className:(0,i.default)("sf-metadata-ui cell-formatter-container checkbox-formatter",n)},o.default.createElement(a.default,{iconName:"check-mark"})):r}},783:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(9950)),i=r(n(35349));n(41341);t.default=function(e){var t=e.enableDelete,n=void 0!==t&&t,r=e.collaborator,a=e.onDelete;return r?o.default.createElement("div",{className:"sf-metadata-ui collaborator-item"},o.default.createElement("span",{className:"collaborator-avatar"},o.default.createElement("img",{className:"collaborator-avatar-icon",alt:r.name,src:r.avatar_url})),o.default.createElement("span",{className:"collaborator-name"},r.name),n&&o.default.createElement("span",{className:"collaborator-remove",onClick:a},o.default.createElement(i.default,{iconName:"delete"}))):null}},80199:function(e,t,n){"use strict";var r=n(91847).default,o=["value","className","children"],i=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=i(n(9950)),s=i(n(86615)),l=i(n(62088));n(91173);t.default=function(e){var t=e.value,n=e.className,i=e.children,c=r(e,o);return Array.isArray(t)&&0!==t.length?0===t.filter((function(e){return e})).length?i||null:a.default.createElement("div",{className:(0,s.default)("sf-metadata-ui cell-formatter-container collaborators-formatter",n)},t.map((function(e){return a.default.createElement(l.default,Object.assign({key:e},c,{value:e}))}))):i||null}},44314:function(e,t,n){"use strict";var r=n(85715).default,o=n(24994).default,i=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=i(n(9950)),s=o(n(86615)),l=n(56265),c=o(n(783));t.default=function(e){var t=e.value,n=e.mediaUrl,o=e.className,i=e.api,u=e.collaborators,d=void 0===u?[]:u,p=e.collaboratorsCache,h=void 0===p?{}:p,f=e.updateCollaboratorsCache,m=e.children,g=(0,a.useState)(null),v=r(g,2),y=v[0],x=v[1];return(0,a.useEffect)((function(){var e=!0;if(!t)return e&&x(null),function(){return e=!1};var r=d&&d.find((function(e){return e.email===t}));if(r)return e&&x(r),function(){return e=!1};var o="".concat(n,"/avatars/default.png");return"anonymous"===t?(r={name:"anonymous",avatar_url:o},e&&x(r),function(){return e=!1}):(r=h[t])?(e&&x(r),function(){return e=!1}):(0,l.isValidEmail)(t)?(i&&i(t,(function(n){r=n[t],Object.values(n).forEach((function(e){f&&f(e)})),e&&x(r)})),function(){return e=!1}):(r={email:t,name:t,avatar_url:o},f&&f(r),e&&x(r),function(){return e=!1})}),[]),y?a.default.createElement("div",{className:(0,s.default)("sf-metadata-ui cell-formatter-container creator-formatter",o)},a.default.createElement(c.default,{collaborator:y})):m||null}},70794:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(9950)),i=r(n(86615)),a=r(n(84583));t.default=function(e){var t=e.value,n=e.className,r=e.children;if(!t)return r||null;var s=(0,a.default)(t).format("YYYY-MM-DD HH:mm:ss");return o.default.createElement("div",{className:(0,i.default)("sf-metadata-ui cell-formatter-container ctime-formatter",n)},s)}},96388:function(e,t,n){"use strict";var r=n(24994).default,o=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(n(9950)),a=r(n(86615)),s=n(39856);n(35816);t.default=function(e){var t=e.value,n=e.format,r=e.className,o=e.children,l=(0,i.useMemo)((function(){return(0,s.getDateDisplayString)(t,n)}),[t,n]);return l?i.default.createElement("div",{className:(0,a.default)("sf-metadata-ui cell-formatter-container date-formatter",r)},l):o||null}},39276:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(9950));t.default=function(e){var t=e.fieldType,n=e.placeholder;return o.default.createElement("span",{className:"sf-metadata-record-cell-empty sf-metadata-record-".concat(t,"-cell-empty"),placeholder:n})}},78003:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(9950)),i=r(n(86615));n(22257);t.default=function(e){var t=e.value,n=e.isDir,r=e.className,a=e.children,s=e.getFolderIconUrl,l=e.getFileIconUrl;return t?o.default.createElement("div",{className:(0,i.default)("sf-metadata-ui cell-formatter-container file-name-formatter",r)},o.default.createElement("img",{className:"sf-metadata-file-icon",src:n?s():l(t),height:"24",alt:""}),o.default.createElement("span",{className:"sf-metadata-file-name"},t)):a||null}},57399:function(e,t,n){"use strict";var r=n(91847).default,o=["field","value","isSample","queryUserAPI","emptyTip"],i=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=i(n(9950)),s=n(57425),l=i(n(12863)),c=i(n(44314)),u=i(n(70794)),d=i(n(39276)),p=i(n(78003)),h=i(n(96388)),f=i(n(34041)),m=i(n(80199)),g=i(n(25217)),v=i(n(93448)),y=i(n(12532)),x=i(n(98801)),A=i(n(82717));n(16525);t.default=function(e){var t=e.field,n=e.value,i=(e.isSample,e.queryUserAPI),C=e.emptyTip,b=r(e,o),w=(t||{}).type,S="sf-metadata-".concat(w,"-formatter");switch(w){case s.CellType.TEXT:return a.default.createElement(l.default,{value:n,className:S},a.default.createElement(d.default,{fieldType:w,placeholder:C}));case s.CellType.CTIME:case s.CellType.MTIME:return a.default.createElement(u.default,{value:n,className:S},a.default.createElement(d.default,{fieldType:w,placeholder:C}));case s.CellType.CREATOR:case s.CellType.LAST_MODIFIER:return a.default.createElement(c.default,Object.assign({value:n,className:S,api:i},b),a.default.createElement(d.default,{fieldType:w,placeholder:C}));case s.CellType.FILE_NAME:return a.default.createElement(p.default,Object.assign({value:n,className:S},b),a.default.createElement(d.default,{fieldType:w,placeholder:C}));case s.CellType.DATE:var D;return a.default.createElement(h.default,{value:n,format:null===(D=t.data)||void 0===D?void 0:D.format,className:S},a.default.createElement(d.default,{fieldType:w,placeholder:C}));case s.CellType.SINGLE_SELECT:var k;return a.default.createElement(f.default,{value:n,options:(null===(k=t.data)||void 0===k?void 0:k.options)||[],className:S},a.default.createElement(d.default,{fieldType:w,placeholder:C}));case s.CellType.MULTIPLE_SELECT:var M;return a.default.createElement(A.default,{value:n,options:(null===(M=t.data)||void 0===M?void 0:M.options)||[],className:S},a.default.createElement(d.default,{fieldType:w,placeholder:C}));case s.CellType.COLLABORATOR:return a.default.createElement(m.default,Object.assign({value:n,className:S,api:i},b),a.default.createElement(d.default,{fieldType:w,placeholder:C}));case s.CellType.CHECKBOX:return a.default.createElement(g.default,{value:n,className:S},a.default.createElement(d.default,{fieldType:w,placeholder:C}));case s.CellType.GEOLOCATION:var j;return a.default.createElement(v.default,Object.assign({},b,{format:null===(j=t.data)||void 0===j?void 0:j.geo_format,value:n,className:S}),a.default.createElement(d.default,{fieldType:w,placeholder:C}));case s.CellType.LONG_TEXT:return a.default.createElement(y.default,Object.assign({},b,{value:n,className:S}),a.default.createElement(d.default,{fieldType:w,placeholder:C}));case s.CellType.NUMBER:return a.default.createElement(x.default,{value:n,formats:null===t||void 0===t?void 0:t.data,className:S},a.default.createElement(d.default,{fieldType:w,placeholder:C}));default:return a.default.createElement(l.default,{value:n,className:S},a.default.createElement(d.default,{fieldType:w,placeholder:C}))}}},93448:function(e,t,n){"use strict";var r=n(24994).default,o=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(n(9950)),a=r(n(86615)),s=n(39856);t.default=function(e){var t=e.isBaiduMap,n=e.format,r=e.value,o=e.children,l=e.className,c=e.hyphen,u=void 0===c?" ":c,d=(0,i.useMemo)((function(){return"object"!==typeof r?null:(0,s.getGeolocationDisplayString)(r,{geo_format:n},{isBaiduMap:t,hyphen:u})}),[r,n,t,u]);return d?i.default.createElement("div",{className:(0,a.default)("sf-metadata-ui cell-formatter-container geolocation-formatter",l)},d):o||null}},50502:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"CTimeFormatter",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"CheckboxFormatter",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(t,"CollaboratorFormatter",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"CollaboratorsFormatter",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"CreatorFormatter",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"DateFormatter",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"GeolocationFormatter",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(t,"LongTextFormatter",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(t,"MultipleSelectFormatter",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(t,"NumberFormatter",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(t,"SingleSelectFormatter",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"TextFormatter",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"URLFormatter",{enumerable:!0,get:function(){return c.default}}),t.default=void 0;var o=r(n(783)),i=r(n(80199)),a=r(n(44314)),s=r(n(70794)),l=r(n(12863)),c=r(n(43007)),u=r(n(96388)),d=r(n(34041)),p=r(n(25217)),h=r(n(93448)),f=r(n(12532)),m=r(n(98801)),g=r(n(82717)),v=r(n(57399));n(41186);t.default=v.default},12532:function(e,t,n){"use strict";var r=n(85715).default,o=n(24994).default,i=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=i(n(9950)),s=o(n(86615)),l=n(92203),c=o(n(35349)),u=o(n(90665)),d=o(n(21724));n(60784);t.default=function(e){var t=e.value,n=e.className,o=e.previewClassName,i=e.children,p=(0,a.useState)(!1),h=r(p,2),f=h[0],m=h[1],g=(0,a.useRef)(null),v=(0,a.useRef)({}),y=(0,a.useRef)(null),x=(0,a.useRef)(null),A=(0,a.useMemo)((function(){if(!t)return null;var e=typeof t;if("object"===e)return t;if("string"===e){var n=(0,l.getPreviewContent)(t),r=n.previewText,o=n.images,i=n.links,a=n.checklist;return{text:t,preview:r,images:o,links:i,checklist:a}}return null}),[t]);(0,a.useEffect)((function(){return function(){y.current&&clearTimeout(y.current),x.current&&clearTimeout(x.current)}}),[]);var C=(0,a.useCallback)((function(){if(!A)return null;var e=A.links;return Array.isArray(e)&&0!==e.length?a.default.createElement("span",{className:"sf-metadata-long-text-links"},a.default.createElement(c.default,{iconName:"url"}),e.length):null}),[A]),b=(0,a.useCallback)((function(){if(!A)return null;var e=A.checklist;return e&&0!==e.total?a.default.createElement("span",{className:(0,s.default)("sf-metadata-long-text-check-list",{completed:e.completed===e.total})},a.default.createElement(c.default,{iconName:"check-square-solid"}),"".concat(e.completed,"/").concat(e.total)):null}),[A]),w=(0,a.useCallback)((function(){if(!A)return null;var e=A.images;return Array.isArray(e)&&0!==e.length?a.default.createElement("span",{className:"sf-metadata-long-text-images"},a.default.createElement("img",{src:e[0],alt:""}),a.default.createElement("i",{className:"sf-metadata-image-number"},e.length>1?"+"+e.length:null)):null}),[A]),S=(0,a.useCallback)((function(){return A?A.preview:null}),[A]),D=(0,a.useCallback)((function(){if(document.getElementById("modal-wrapper")&&(y.current&&clearTimeout(y.current),y.current=null,A))return f?(x.current&&clearTimeout(x.current),void(x.current=null)):void(y.current=setTimeout((function(){v.current=g.current?g.current.getBoundingClientRect():{},m(!0)}),2e3))}),[f,A,y]),k=(0,a.useCallback)((function(){y.current&&clearTimeout(y.current),y.current=null,x.current=setTimeout((function(){f&&m(!1)}),2e3)}),[f,y]),M=(0,a.useCallback)((function(){x.current&&clearTimeout(x.current),x.current=null}),[x]),j=(0,a.useCallback)((function(){f&&m(!1)}),[f]);return A?a.default.createElement("div",{className:(0,s.default)("sf-metadata-ui cell-formatter-container long-text-formatter",n),onMouseEnter:D,onMouseLeave:k,ref:g},C(),b(),w(),S(),f&&a.default.createElement(u.default,null,a.default.createElement(d.default,{className:o,value:A,targetStyle:v.current,onMouseEnter:M,onMouseLeave:j}))):i||null}},21724:function(e,t,n){"use strict";var r=n(85715).default,o=n(24994).default,i=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=i(n(9950)),s=o(n(86615)),l=o(n(13608));n(71188);var c=a.default.memo((function(e){var t=e.value,n=e.className,o=e.targetStyle,i=e.onMouseEnter,c=e.onMouseLeave,u=(0,a.useRef)(null),d=(0,a.useState)({height:450,opacity:0}),p=r(d,2),h=p[0],f=p[1];(0,a.useEffect)((function(){setTimeout((function(){var e;if(u.current){var n=(null===t||void 0===t||null===(e=t.images)||void 0===e?void 0:e.length)>=2,r=u.current.getBoundingClientRect().height;r=n?450:r,f({height:Math.min(r,450),opacity:1})}}),10)}),[]);var m=(0,a.useCallback)((function(e){i&&i(e)}),[i]),g=(0,a.useCallback)((function(e){c&&c(e)}),[c]),v=(0,a.useMemo)((function(){var e=o.left,t=o.top,n=h.height,r=h.opacity;return e=e-520>0?e-520-12:0,(t-=6)+n>window.innerHeight&&(t=t-n>0?t-n:0),{left:e,top:t,opacity:r}}),[o,h]),y=t?t.text:"";return a.default.createElement("div",{className:(0,s.default)("sf-metadata-long-text-preview",n),style:v,ref:u,onMouseEnter:m,onMouseLeave:g},a.default.createElement("div",{className:"sf-metadata-longtext-container sf-metadata-longtext-container-scroll"},a.default.createElement(l.default,{value:y,showTOC:!1})))}));t.default=c},13608:function(e,t,n){"use strict";var r=n(24994).default,o=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(n(9950)),a=n(92203),s=r(n(29447)),l=i.default.memo((function(e){var t=e.value,n=e.showTOC;return(0,i.useMemo)((function(){if(!window.chrome)return!1;var e=navigator.appVersion.split(" "),t=e.findIndex((function(e){return e.indexOf("Chrome")>=0}));if(-1===t)return!1;var n=e[t];return!(53!==(n=parseInt(n.slice(n.indexOf("/")+1)))||!navigator.appVersion||!navigator.appVersion.includes("WindowsWechat"))}),[])?i.default.createElement(s.default,{value:t}):i.default.createElement(a.MarkdownViewer,{value:t,isShowOutline:n})}));t.default=l},29447:function(e,t,n){"use strict";var r=n(85715).default,o=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(n(9950)),a=n(92203);t.default=function(e){var t=e.value,n=(0,i.useState)(""),o=r(n,2),s=o[0],l=o[1];return(0,i.useEffect)((function(){a.processor.process(t).then((function(e){var t=String(e).replace(/<a /gi,'<a target="_blank" tabindex="-1"');l(t)}))}),[t]),i.default.createElement("div",{className:"sf-metadata-long-text-container article",dangerouslySetInnerHTML:{__html:s}})}},82717:function(e,t,n){"use strict";var r=n(41132).default,o=n(24994).default,i=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=i(n(9950)),s=o(n(86615)),l=o(n(24263)),c=n(57425),u=n(27399);n(77392);t.default=function(e){var t=e.value,n=e.options,o=e.fontSize,i=e.className,d=e.children,p=(0,a.useMemo)((function(){if(!Array.isArray(t)||0===t.length)return[];var e=n.filter((function(e){return t.includes(e.id)||t.includes(e.name)})),o=t.filter((function(e){return e&&!n.find((function(t){return t.id===e||t.name===e}))})).map((function(e){return{id:e,name:(0,u.gettext)(c.DELETED_OPTION_TIPS),color:c.DELETED_OPTION_BACKGROUND_COLOR}}));return[].concat(r(e),r(o))}),[n,t]);return 0===p.length?d||null:a.default.createElement("div",{className:(0,s.default)("sf-metadata-ui cell-formatter-container multiple-select-formatter",i)},p.map((function(e){return a.default.createElement(l.default,{key:e.id,option:e,fontSize:o})})))}},98801:function(e,t,n){"use strict";var r=n(24994).default,o=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(n(9950)),a=r(n(86615)),s=n(56265);t.default=function(e){var t=e.value,n=e.formats,r=e.className,o=e.children,l=(0,i.useMemo)((function(){return(0,s.getNumberDisplayString)(t,n)}),[t,n]);return l?i.default.createElement("div",{className:(0,a.default)("sf-metadata-ui cell-formatter-container text-formatter number-formatter",r)},l):o||null}},24263:function(e,t,n){"use strict";var r=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(9950));n(61945);t.default=function(e){var t=e.option,n=e.fontSize,r=(0,o.useMemo)((function(){return{display:"inline-block",padding:"0px 10px",height:"20px",lineHeight:"20px",textAlign:"center",borderRadius:"10px",maxWidth:"250px",fontSize:n||13,backgroundColor:t.color,color:t.textColor||null}}),[t,n]);return o.default.createElement("div",{className:"sf-metadata-ui-select-option text-truncate",style:r,title:t.name},t.name)}},34041:function(e,t,n){"use strict";var r=n(24994).default,o=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(n(9950)),a=r(n(86615)),s=r(n(24263));n(3627);t.default=function(e){var t=e.value,n=e.options,r=e.fontSize,o=e.className,l=e.children,c=(0,i.useMemo)((function(){return n.find((function(e){return e.id===t||e.name===t}))}),[n,t]);return c?i.default.createElement("div",{className:(0,a.default)("sf-metadata-ui cell-formatter-container single-select-formatter",o)},i.default.createElement(s.default,{option:c,fontSize:r})):l||null}},12863:function(e,t,n){"use strict";var r=n(24994).default,o=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(n(9950)),a=r(n(86615)),s=n(56265);t.default=function(e){var t=e.value,n=e.className,r=e.children,o=(0,i.useMemo)((function(){return"number"===typeof t?t+"":"object"===typeof t?null:"Boolean"===(0,s.getType)(t)?t+"":t}),[t]);return o?i.default.createElement("div",{className:(0,a.default)("sf-metadata-ui cell-formatter-container text-formatter",n)},o):r||null}},43007:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(9950)),i=r(n(86615));n(12081);t.default=function(e){var t=e.value,n=e.className,r=e.children;return t?o.default.createElement("div",{className:(0,i.default)("sf-metadata-ui cell-formatter-container url-formatter",n)},t):r||null}},92544:function(e,t,n){"use strict";var r=n(91847).default,o=["size","className","iconClassName","iconName","iconStyle","onClick"],i=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=i(n(9950)),s=i(n(86615)),l=i(n(35349));n(89156);t.default=function(e){var t=e.size,n=void 0===t?20:t,i=e.className,c=e.iconClassName,u=e.iconName,d=e.iconStyle,p=e.onClick,h=r(e,o);return a.default.createElement("div",Object.assign({className:(0,s.default)("sf-metadata-icon-btn","sf-metadata-icon-btn-".concat(n),i),onClick:p||function(){}},h),a.default.createElement(l.default,{iconName:u,className:c,style:d}))}},35349:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(9950)),i=r(n(86615));n(83695);t.default=function(e){var t=e.className,n=e.iconName,r=e.style;return o.default.createElement("svg",{className:(0,i.default)("sf-metadata-icon","sf-metadata-icon-".concat(n),t),style:r},o.default.createElement("use",{xlinkHref:"#".concat(n)}))}},71791:function(e,t,n){"use strict";var r=n(6305).default,o=n(24994).default;Object.defineProperty(t,"Du",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"ij",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"NC",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"Rw",{enumerable:!0,get:function(){return A.default}}),Object.defineProperty(t,"Cg",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"ZA",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(t,"In",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"Oi",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"Rh",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(t,"Q$",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(t,"DO",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(t,"US",{enumerable:!0,get:function(){return x.SfCalendar}}),Object.defineProperty(t,"sv",{enumerable:!0,get:function(){return x.SfFilterCalendar}}),Object.defineProperty(t,"dO",{enumerable:!0,get:function(){return g.default}}),n(32514);var i=o(n(13677)),a=o(n(92178)),s=o(n(18142)),l=o(n(71082)),c=r(n(50502)),u=o(n(35349)),d=o(n(92544)),p=o(n(26984)),h=o(n(2966)),f=o(n(44798)),m=o(n(29173)),g=o(n(55192)),v=o(n(90665)),y=o(n(89659)),x=n(49046),A=o(n(55859))},46290:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,i=n(6305).default,a=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=a(n(9950)),l=a(n(10865)),c=a(n(742)),u=a(n(63785)),d=a(n(10949)),p=i(n(66602)),h=a(n(83163));if(!String.prototype.defaultMessage){var f=function(e){return this||e||""};String.prototype.defaultMessage=f,String.prototype.d=f}var m=function(){return o((function e(){r(this,e),this.options={currentLocale:null,locales:{},warningHandler:function(){var e;(e=console).warn.apply(e,arguments)},escapeHtml:!0,fallbackLocale:null,debug:!1,dataKey:"data-i18n-key"}}),[{key:"_getFormattedMessage",value:function(e,t){if(this.options.intlGetHook)try{this.options.intlGetHook(e,this.options.currentLocale)}catch(f){console.log("intl get hook error: ",f)}(0,d.default)(e,"key is required");var n=this.options,r=n.locales,o=n.currentLocale,i=n.formats;if(!r||!r[o]){var a='react-intl-universal locales data "'.concat(o,'" not exists.');return o||(a+=" More info: https://github.com/alibaba/react-intl-universal/issues/144#issuecomment-1345193138"),this.options.warningHandler(a),""}var s=this.getDescendantProp(r[o],e);if(null==s){if(!this.options.fallbackLocale)return this.options.warningHandler('react-intl-universal key "'.concat(e,'" not defined in ').concat(o)),"";if(null==(s=this.getDescendantProp(r[this.options.fallbackLocale],e)))return this.options.warningHandler('react-intl-universal key "'.concat(e,'" not defined in ').concat(o," or the fallback locale, ").concat(this.options.fallbackLocale)),""}if(t)for(var u in t=Object.assign({},t)){var p=t[u];!0===this.options.escapeHtml&&("string"===typeof p||p instanceof String)&&p.indexOf("<")>=0&&(p=(0,c.default)(p)),t[u]=p}try{var h;if(t)h=new l.default(s,o,i).format(t);else h=s;return h}catch(m){return this.options.warningHandler("react-intl-universal format message failed for key='".concat(e,"'."),m.message),s}}},{key:"get",value:function(e,t){var n=this._getFormattedMessage(e,t);return this.options.debug?this._getSpanElementMessage(e,n):n}},{key:"getHTML",value:function(e,t){var n=this._getFormattedMessage(e,t);return n?this._getSpanElementMessage(e,n):""}},{key:"formatMessage",value:function(e,t){var n=e.id,r=e.defaultMessage;return this.get(n,t).defaultMessage(r)}},{key:"formatHTMLMessage",value:function(e,t){var n=e.id,r=e.defaultMessage;return this.getHTML(n,t).defaultMessage(r)}},{key:"determineLocale",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.getLocaleFromURL(e)||this.getLocaleFromCookie(e)||this.getLocaleFromLocalStorage(e)||this.getLocaleFromBrowser()}},{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,d.default)(e.currentLocale,"options.currentLocale is required"),(0,d.default)(e.locales,"options.locales is required"),Object.assign(this.options,e),this.options.formats=Object.assign({},this.options.formats,p.defaultFormats),new Promise((function(e,t){e()}))}},{key:"getInitOptions",value:function(){return this.options}},{key:"load",value:function(e){(0,h.default)(this.options.locales,e)}},{key:"getLocaleFromCookie",value:function(e){var t=e.cookieLocaleKey;if(t){var n=u.default.parse(document.cookie);return n&&n[t]}}},{key:"getLocaleFromLocalStorage",value:function(e){var t=e.localStorageLocaleKey;if(t&&window.localStorage)return localStorage.getItem(t)}},{key:"getLocaleFromURL",value:function(e){var t=e.urlLocaleKey;if(t){var n=window.location.search.split("?");if(n.length>=2){var r=new URLSearchParams(n[1]);if(r.has(t))return r.get(t)}}}},{key:"getDescendantProp",value:function(e,t){return e[t]?e[t]:t.split(".").reduce((function(e,t){return void 0!==e?e[t]:e}),e)}},{key:"getLocaleFromBrowser",value:function(){return navigator.language||navigator.userLanguage}},{key:"_getSpanElementMessage",value:function(e,t){var n={dangerouslySetInnerHTML:{__html:t}};this.options.debug&&(n[this.options.dataKey]=e);var r=s.default.createElement("span",n),o=function(){return r};return Object.assign({defaultMessage:o,d:o},r)}}])}();t.default=m},66602:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultFormats=void 0;for(var n=["AFN","EUR","ALL","DZD","USD","AOA","XCD","ARS","AMD","AWG","AUD","AZN","BSD","BHD","BDT","BBD","BYN","BZD","XOF","BMD","INR","BTN","BOB","BOV","BAM","BWP","NOK","BRL","BND","BGN","BIF","CVE","KHR","XAF","CAD","KYD","CLP","CLF","CNY","COP","COU","KMF","CDF","NZD","CRC","HRK","CUP","CUC","ANG","CZK","DKK","DJF","DOP","EGP","SVC","ERN","ETB","FKP","FJD","XPF","GMD","GEL","GHS","GIP","GTQ","GBP","GNF","GYD","HTG","HNL","HKD","HUF","ISK","IDR","XDR","IRR","IQD","ILS","JMD","JPY","JOD","KZT","KES","KPW","KRW","KWD","KGS","LAK","LBP","LSL","ZAR","LRD","LYD","CHF","MOP","MKD","MGA","MWK","MYR","MVR","MRO","MUR","XUA","MXN","MXV","MDL","MNT","MAD","MZN","MMK","NAD","NPR","NIO","NGN","OMR","PKR","PAB","PGK","PYG","PEN","PHP","PLN","QAR","RON","RUB","RWF","SHP","WST","STD","SAR","RSD","SCR","SLL","SGD","XSU","SBD","SOS","SSP","LKR","SDG","SRD","SZL","SEK","CHE","CHW","SYP","TWD","TJS","TZS","THB","TOP","TTD","TND","TRY","TMT","UGX","UAH","AED","USN","UYU","UYI","UZS","VUV","VEF","VND","YER","ZMW","ZWL","XBA","XBB","XBC","XBD","XTS","XXX","XAU","XPD","XPT","XAG"],r={},o=0;o<n.length;o++)r[n[o]]={style:"currency",currency:n[o]};t.defaultFormats={number:r}},5799:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ReactIntlUniversal",{enumerable:!0,get:function(){return o.default}}),t.load=t.init=t.getLocaleFromURL=t.getLocaleFromLocalStorage=t.getLocaleFromCookie=t.getLocaleFromBrowser=t.getInitOptions=t.getHTML=t.getDescendantProp=t.get=t.formatMessage=t.formatHTMLMessage=t.determineLocale=t.default=void 0;var o=r(n(46290)),i=t.default=new o.default;i.ReactIntlUniversal=o.default;t.get=i.get.bind(i),t.getHTML=i.getHTML.bind(i),t.formatMessage=i.formatMessage.bind(i),t.formatHTMLMessage=i.formatHTMLMessage.bind(i),t.determineLocale=i.determineLocale.bind(i),t.init=i.init.bind(i),t.getInitOptions=i.getInitOptions.bind(i),t.load=i.load.bind(i),t.getLocaleFromCookie=i.getLocaleFromCookie.bind(i),t.getLocaleFromLocalStorage=i.getLocaleFromLocalStorage.bind(i),t.getLocaleFromURL=i.getLocaleFromURL.bind(i),t.getDescendantProp=i.getDescendantProp.bind(i),t.getLocaleFromBrowser=i.getLocaleFromBrowser.bind(i)},26984:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return o.default.createElement("span",{className:"sf-metadata-loading-tip sf-metadata-loading-icon"})};var o=r(n(9950));n(65544)},32514:function(e,t,n){"use strict";var r,o,i,a=n(24994).default,s=a(n(5799)),l=a(n(38572)),c=a(n(54788)),u=a(n(2587)),d=a(n(96791)),p=a(n(85086)),h=a(n(91647)),f=a(n(98765)),m={de:l.default,en:c.default,fr:u.default,"zh-cn":f.default,es:d.default,ru:p.default,pt:h.default},g=(null===(r=window)||void 0===r||null===(o=r.app)||void 0===o||null===(i=o.config)||void 0===i?void 0:i.lang)||"zh-cn";s.default.init({currentLocale:g,locales:m})},38572:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={Deleted_option:"Die Option wurde gel\xf6scht."}},54788:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={Deleted_option:"Deleted option"}},96791:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={Deleted_option:"Opciones borradas"}},2587:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={Deleted_option:"L'option a \xe9t\xe9 supprim\xe9e."}},91647:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={Deleted_option:"op\xe7\xe3o exclu\xedda"}},85086:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={deleted_option:"Deleted option"}},98765:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={Deleted_option:"\u5df2\u5220\u9664\u7684\u6807\u7b7e"}},90665:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,i=n(18336).default,a=n(29511).default,s=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(n(9950)),c=s(n(17119)),u=document.getElementById("modal-wrapper"),d=function(e){function t(e){var n;return r(this,t),(n=i(this,t,[e])).el=document.createElement("div"),n}return a(t,e),o(t,[{key:"componentDidMount",value:function(){u.appendChild(this.el)}},{key:"componentWillUnmount",value:function(){u.removeChild(this.el)}},{key:"render",value:function(){return c.default.createPortal(this.props.children,this.el)}}])}(l.default.Component);t.default=d},2966:function(e,t,n){"use strict";var r=n(91847).default,o=["record","columns","openRecord"],i=n(24994).default,a=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=a(n(9950)),l=i(n(50502));n(58986);t.default=function(e){var t,n=e.record,i=e.columns,a=e.openRecord,c=r(e,o),u=(0,s.useCallback)((function(){a&&a(n)}),[n,a]);return s.default.createElement("div",{className:"sf-metadata-record",onClick:u},s.default.createElement("div",{className:"sf-metadata-record-container"},s.default.createElement("div",{className:"sf-metadata-record-header"},s.default.createElement("div",{className:"sf-metadata-record-cell sf-metadata-record-cell-name"},s.default.createElement(l.default,Object.assign({value:n[null===(t=i[0])||void 0===t?void 0:t.key],field:i[0]},c)))),s.default.createElement("div",{className:"sf-metadata-record-content"},i.slice(1).map((function(e){return s.default.createElement("div",{className:"sf-metadata-record-cell",key:e.key,style:{width:e.width||200}},s.default.createElement(l.default,Object.assign({isSample:!0,value:n[e.key],field:e},c)))})))))}},24910:function(e,t,n){"use strict";var r=n(24994).default,o=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(n(9950)),a=n(48843),s=r(n(92544)),l=r(n(35349));n(35174);t.default=function(e){var t=e.field,n=e.fieldIconConfig,r=t.type,o=t.name,c=t.description,u=t.key,d=(0,i.useRef)(null);return i.default.createElement(a.Col,{md:3,className:"d-flex sf-metadata-record-details-item-label"},i.default.createElement("div",{className:"d-flex justify-content-between"},i.default.createElement("div",{className:"field-description-section"},i.default.createElement("span",{className:"header-icon",id:"header-icon-".concat(u)},i.default.createElement(l.default,{iconName:n[r]})),i.default.createElement("span",{className:"field-description-section-field-name"},o||""),c&&i.default.createElement(i.default.Fragment,null,i.default.createElement(s.default,{ref:d,iconName:"description",className:"field-uneditable-tip ml-2"}),d.current&&i.default.createElement(a.UncontrolledTooltip,{target:d.current,fade:!1,placement:"right",modifiers:{preventOverflow:{boundariesElement:document.body}}},c)))))}},44798:function(e,t,n){"use strict";var r=n(85715).default,o=n(91847).default,i=["fields","record","onToggle","fieldIconConfig"],a=n(24994).default,s=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(n(9950)),c=n(48843),u=n(56265),d=a(n(13677)),p=a(n(24910)),h=a(n(50502)),f=a(n(92544));n(90562);t.default=function(e){var t=e.fields,n=e.record,a=e.onToggle,s=e.fieldIconConfig,m=o(e,i),g=(0,l.useState)(!0),v=r(g,2),y=v[0],x=v[1],A=(0,l.useState)(!0),C=r(A,2),b=C[0],w=C[1],S=(0,l.useRef)(null),D=(0,l.useMemo)((function(){return{width:"".concat(window.innerWidth-80,"px"),maxWidth:"".concat(window.innerWidth-80,"px"),marginLeft:"".concat(80,"px"),height:"".concat(100,"px"),marginRight:"".concat(80,"px"),marginTop:"30%",transition:"all .3s"}}),[]),k=(0,l.useMemo)((function(){return{width:800,maxWidth:800,marginLeft:(window.innerWidth-800)/2,height:"calc(100% - 56px)"}}),[]);(0,l.useEffect)((function(){setTimeout((function(){var e=S.current.firstChild,t=k.width,n=k.maxWidth,r=k.marginLeft,o=k.height;e.style.width="".concat(t,"px"),e.style.maxWidth="".concat(n,"px"),e.style.marginLeft="".concat(r,"px"),e.style.height=o,e.style.marginRight="unset",e.style.marginTop="28px",setTimeout((function(){x(!1),e.style.transition="none",w(!1)}),280)}),1)}),[]);var M=(0,l.useCallback)((function(){a()}),[a]),j=(0,l.useCallback)((function(e){var t=e.key,r=e.name;return l.default.createElement(h.default,Object.assign({field:e,value:t.startsWith("_")?n[t]:n[r]},m))}),[n,m]),I=(0,l.useCallback)((function(){return b?l.default.createElement(d.default,null):Array.isArray(t)&&0!==t.length?l.default.createElement(l.default.Fragment,null,t.map((function(e){return l.default.createElement("div",{className:"sf-metadata-record-details-item sf-metadata-record-details-item-field-".concat(e.type),key:e.key},l.default.createElement("div",{className:"pb-4 row"},l.default.createElement(p.default,{field:e,fieldIconConfig:s}),l.default.createElement(c.Col,{md:9,className:"d-flex align-items-center sf-metadata-record-details-item-col"},j(e))))}))):null}),[b,t,s,j]);return l.default.createElement(c.Modal,{isOpen:!0,toggle:M,className:"sf-metadata-record-details-dialog",style:y?D:k,zIndex:1048,contentClassName:"sf-metadata-record-details-content",modalClassName:"sf-metadata-record-details-modal",fade:!1,innerRef:S,keyboard:!1},!y&&l.default.createElement("div",{className:"sf-metadata-record-details"},l.default.createElement(c.ModalHeader,{close:l.default.createElement("div",{className:"header-close-list"},l.default.createElement(f.default,{iconName:"close",size:24,onClick:M}))},l.default.createElement("div",{className:"sf-metadata-record-details-left-btns"},l.default.createElement("div",{className:"sf-metadata-record-details-title text-truncate"},(0,u.gettext)("Details")))),l.default.createElement(c.ModalBody,{className:"sf-metadata-record-details-container"},I())))}},29173:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,i=n(18336).default,a=n(29511).default,s=n(24994).default,l=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(9950)),u=s(n(86615)),d=n(56265),p=function(e){function t(e){var n;return r(this,t),(n=i(this,t,[e])).onCompositionStart=function(){n.isInputtingChinese=!0},n.onChange=function(e){n.timer&&clearTimeout(n.timer);var t=n.props,r=t.onChange,o=t.wait,i=e.target.value;n.setState({searchValue:i||""},(function(){n.isInputtingChinese||(n.timer=setTimeout((function(){r&&r(n.state.searchValue.trim())}),o))}))},n.onCompositionEnd=function(e){n.isInputtingChinese=!1,n.onChange(e)},n.clearSearch=function(){var e=n.props.clearValue;n.setState({searchValue:""},(function(){e&&e()}))},n.setFocus=function(e){if(n.inputRef!==document.activeElement&&(n.inputRef.focus(),e)){var t=n.state.searchValue.length;n.inputRef.setSelectionRange(0,t)}},n.renderClear=function(){var e=n.props,t=e.isClearable,r=e.clearClassName,o=e.components,i=void 0===o?{}:o,a=n.state.searchValue;if(!t||!a)return null;var s=i.ClearIndicator;return c.default.isValidElement(s)?c.default.cloneElement(s,{clearValue:n.clearSearch}):(0,d.isFunction)(s)?c.default.createElement(s,{clearValue:n.clearSearch}):c.default.createElement("i",{className:(0,u.default)("search-text-clear input-icon-addon",r),onClick:n.clearSearch},"\xd7")},n.state={searchValue:e.value},n.isInputtingChinese=!1,n.timer=null,n.inputRef=null,n}return a(t,e),o(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.value!==this.props.value&&this.setState({searchValue:e.value})}},{key:"componentWillUnmount",value:function(){this.timer&&clearTimeout(this.timer),this.timer=null,this.inputRef=null}},{key:"render",value:function(){var e=this,t=this.props,n=t.placeholder,r=t.autoFocus,o=t.className,i=t.onKeyDown,a=t.disabled,s=t.style,l=this.state.searchValue;return c.default.createElement(c.Fragment,null,c.default.createElement("input",{type:"text",value:l,className:(0,u.default)("form-control",o),onChange:this.onChange,autoFocus:r,placeholder:n,onCompositionStart:this.onCompositionStart,onCompositionEnd:this.onCompositionEnd,onKeyDown:i,disabled:a,style:s,ref:function(t){return e.inputRef=t}}),this.renderClear())}}])}(c.Component);p.defaultProps={wait:100,disabled:!1,value:""};t.default=p},59281:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={LeftArrow:37,UpArrow:38,RightArrow:39,DownArrow:40,Enter:13,Tab:9,Escape:27,Esc:27}},20536:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,i=n(18336).default,a=n(29511).default,s=n(24994).default,l=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(9950)),u=s(n(86615)),d=s(n(89251)),p=s(n(29173)),h=s(n(59281)),f=s(n(92178));n(15623);var m=function(e){function t(e){var n;return r(this,t),(n=i(this,t,[e])).resetMenuStyle=function(){var e=n.props,t=e.isInModal,r=e.position,o=n.optionGroupRef.getBoundingClientRect(),i=o.top,a=o.height;if(t)r.y+r.height+a>window.innerHeight&&(n.optionGroupRef.style.top=r.y-a+"px"),n.optionGroupRef.style.opacity=1;else if(a+i>window.innerHeight){n.optionGroupRef.style.top=-1*(a+2)+"px"}},n.onHotKey=function(e){var t=e.keyCode;if(t===h.default.UpArrow)n.onPressUp();else if(t===h.default.DownArrow)n.onPressDown();else if(t===h.default.Enter){var r=n.filterOptions&&n.filterOptions[n.state.activeIndex];r&&(n.props.onSelectOption(r.value),n.props.supportMultipleSelect||n.props.closeSelect())}else t!==h.default.Tab&&t!==h.default.Escape||n.props.closeSelect()},n.onPressUp=function(){n.state.activeIndex>0&&n.setState({activeIndex:n.state.activeIndex-1},(function(){n.scrollContent()}))},n.onPressDown=function(){n.filterOptions&&n.state.activeIndex<n.filterOptions.length-1&&n.setState({activeIndex:n.state.activeIndex+1},(function(){n.scrollContent()}))},n.onMouseDown=function(e){n.props.isInModal&&(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation())},n.scrollContent=function(){var e=n.optionGroupContentRef,t=e.offsetHeight,r=e.scrollTop;n.setState({disableHover:!0}),n.timer=setTimeout((function(){n.setState({disableHover:!1})}),500),32*n.state.activeIndex!==0?32*n.state.activeIndex<r?n.optionGroupContentRef.scrollTop=r-32:32*n.state.activeIndex>t+r&&(n.optionGroupContentRef.scrollTop=r+32):n.optionGroupContentRef.scrollTop=0},n.changeIndex=function(e){n.setState({activeIndex:e})},n.onChangeSearch=function(e){var t=e||"";t!==n.state.searchVal&&n.setState({searchVal:t,activeIndex:-1})},n.renderOptGroup=function(e){var t=n.props,r=t.noOptionsPlaceholder,o=t.onSelectOption;return n.filterOptions=n.props.getFilterOptions(e),0===n.filterOptions.length?c.default.createElement("div",{className:"none-search-result"},r):n.filterOptions.map((function(e,t){var r=e.value.column?e.value.column.key:t,i=n.state.activeIndex===t;return c.default.createElement(d.default,{key:r,index:t,isActive:i,value:e.value,onSelectOption:o,changeIndex:n.changeIndex,supportMultipleSelect:n.props.supportMultipleSelect,disableHover:n.state.disableHover},e.label)}))},n.state={searchVal:"",activeIndex:-1,disableHover:!1},n.filterOptions=null,n.timer=null,n}return a(t,e),o(t,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("keydown",this.onHotKey),setTimeout((function(){e.resetMenuStyle()}),1)}},{key:"componentWillUnmount",value:function(){this.filterOptions=null,this.timer&&clearTimeout(this.timer),window.removeEventListener("keydown",this.onHotKey)}},{key:"render",value:function(){var e=this,t=this.props,n=t.searchable,r=t.searchPlaceholder,o=t.top,i=t.left,a=t.minWidth,s=t.value,l=t.isShowSelected,d=t.isInModal,h=t.position,m=t.className,g=t.addOptionAble,v=(t.component||{}).AddOption,y=this.state.searchVal,x={top:o||0,left:i||0};return a&&(x={top:o||0,left:i||0,minWidth:a}),d&&(x={position:"fixed",left:h.x,top:h.y+h.height,minWidth:h.width,opacity:0}),c.default.createElement(f.default,{onClickOutside:this.props.onClickOutside},c.default.createElement("div",{className:(0,u.default)("sf-metadata-option-group",m?"sf-metadata-option-group-"+m:"",{"pt-0":l,"create-new-sf-metadata-option-group":g}),ref:function(t){return e.optionGroupRef=t},style:x,onMouseDown:this.onMouseDown},l&&c.default.createElement("div",{className:"editor-list-delete mb-2",onClick:function(e){return e.stopPropagation()}},s.label||""),n&&c.default.createElement("div",{className:"sf-metadata-option-group-search"},c.default.createElement(p.default,{className:"option-search-control",placeholder:r,onChange:this.onChangeSearch,autoFocus:!0})),c.default.createElement("div",{className:"sf-metadata-option-group-content",ref:function(t){return e.optionGroupContentRef=t}},this.renderOptGroup(y)),g&&v))}}])}(c.Component);t.default=m},89251:function(e,t,n){"use strict";var r=n(17383).default,o=n(34579).default,i=n(18336).default,a=n(29511).default,s=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(n(9950)),c=function(e){function t(){var e;return r(this,t),(e=i(this,t,arguments)).onSelectOption=function(t,n){e.props.supportMultipleSelect&&n.stopPropagation(),e.props.onSelectOption(t,n)},e.onMouseEnter=function(){e.props.disableHover||e.props.changeIndex(e.props.index)},e.onMouseLeave=function(){e.props.disableHover||e.props.changeIndex(-1)},e}return a(t,e),o(t,[{key:"render",value:function(){return l.default.createElement("div",{className:this.props.isActive?"sf-metadata-option sf-metadata-option-active":"sf-metadata-option",onClick:this.onSelectOption.bind(this,this.props.value),onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},this.props.children)}}])}(l.Component);t.default=c},55192:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(9950));t.default=function(e){var t=e.onChange,n=e.checked,r=e.placeholder,i=e.disabled,a=e.switchClassName;return o.default.createElement("div",{className:"sf-metadata-switch position-relative ".concat(a||"")},o.default.createElement("label",{className:"custom-switch"},o.default.createElement("input",{className:"custom-switch-input",type:"checkbox",checked:n,onChange:t,name:"custom-switch-checkbox",disabled:i}),o.default.createElement("span",{className:"custom-switch-description text-truncate"},r),o.default.createElement("span",{className:"custom-switch-indicator"})))}},39856:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.throttle=t.isValidEmail=t.isMac=t.isFunction=t.getType=t.getNumberDisplayString=t.getGeolocationDisplayString=t.getEventClassName=t.getDateDisplayString=t.debounce=void 0;var o=r(n(84583)),i=n(57425),a=n(97701),s=n(22724);t.debounce=function(e,t){var n=null;return function(){null!==n&&clearTimeout(n),n=setTimeout(e,t)}};t.throttle=function(e,t){var n=null,r=Date.now();return function(){var o=Date.now(),i=t-(o-r),a=arguments;clearTimeout(n),i<=0?(e.apply(this,a),r=Date.now()):n=setTimeout(e,i)}};t.isMac=function(){var e=navigator.platform;return"Mac68K"==e||"MacPPC"==e||"Macintosh"==e||"MacIntel"==e};t.getEventClassName=function(e){return e&&e.target&&e.target.getAttribute("class")||""};t.isValidEmail=function(e){return/^[A-Za-z0-9]+([-_.][A-Za-z0-9]+)*@([A-Za-z0-9]+[-.])+[A-Za-z0-9]{2,20}$/.test(e)};t.isFunction=function(e){return e&&"[object Function]"==={}.toString.call(e)};t.getType=function(e){return Object.prototype.toString.call(e).slice(8,-1)};t.getDateDisplayString=function(e,t){if(!e||"string"!==typeof e)return"";var n=(0,o.default)(e);if(!n.isValid())return e;switch(t){case"D/M/YYYY":case"DD/MM/YYYY":var r=n.format("YYYY-MM-DD").split("-");return"".concat(r[2],"/").concat(r[1],"/").concat(r[0]);case"D/M/YYYY HH:mm":case"DD/MM/YYYY HH:mm":var i=n.format("YYYY-MM-DD HH:mm").split(" "),a=i[0].split("-");return"".concat(a[2],"/").concat(a[1],"/").concat(a[0]," ").concat(i[1]);case"M/D/YYYY":return n.format("M/D/YYYY");case"M/D/YYYY HH:mm":return n.format("M/D/YYYY HH:mm");case"YYYY-MM-DD":default:return n.format("YYYY-MM-DD");case"YYYY-MM-DD HH:mm":return n.format("YYYY-MM-DD HH:mm");case"YYYY-MM-DD HH:mm:ss":return n.format("YYYY-MM-DD HH:mm:ss");case"DD.MM.YYYY":return n.format("DD.MM.YYYY");case"DD.MM.YYYY HH:mm":return n.format("DD.MM.YYYY HH:mm")}};t.getGeolocationDisplayString=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=(n.isBaiduMap,n.hyphen),o=void 0===r?"":r;if(!e)return"";switch((t||{}).geo_format){case i.GEOLOCATION_FORMAT.LNG_LAT:var a=e.lng,s=e.lat;if(!function(e,t){return(e||0===e)&&(t||0===t)}(a,s))return"";var l=function(e){if(!e&&0!==e)return"";if(e<-180||e>180)return"";var t=Math.floor(Math.abs(e)),n=60*(Math.abs(e)-t),r=Math.floor(n),o=Math.round(60*(n-r));return"".concat(e>=0?"E":"W").concat(t,"\xb0").concat(r,"'").concat(o,'"')}(a),c=function(e){if(!e&&0!==e)return"";if(e<-90||e>90)return"";var t=Math.floor(Math.abs(e)),n=60*(Math.abs(e)-t),r=Math.floor(n),o=Math.round(60*(n-r));return"".concat(e>=0?"N":"S").concat(t,"\xb0").concat(r,"'").concat(o,'"')}(s);return"".concat(c,", ").concat(l);case i.GEOLOCATION_FORMAT.COUNTRY_REGION:return e.country_region||"";case i.GEOLOCATION_FORMAT.PROVINCE:return e.province||"";case i.GEOLOCATION_FORMAT.PROVINCE_CITY:var u=e.province,d=e.city;return"".concat(u||"").concat(o).concat(d||"").trim();case i.GEOLOCATION_FORMAT.PROVINCE_CITY_DISTRICT:var p=e.province,h=e.city,f=e.district;return"".concat(p||"").concat(o).concat(h||"").concat(o).concat(f||"").trim();case i.GEOLOCATION_FORMAT.MAP_SELECTION:var m=e.address,g=e.title;return"".concat(m||"").concat(o).concat(g||"").trim();default:var v=e.province,y=e.city,x=e.district,A=e.detail;return v||y||x||A?"".concat(v||"").concat(o).concat(y||"").concat(o).concat(x||"").concat(o).concat(A||"").trim():""}};var l=["bytes","KB","MB","GB","TB","PB"],c={comma:",",dot:".",no:"",space:" "},u=function(e){return"string"!==typeof e?"":e.endsWith("0")?e.replace(/(?:\.0*|(\.\d+?)0+)$/,"$1"):e},d=function(e,t){var n=t.formats,r=t.isCurrency,o=void 0===r||r,i=n||{},l=i.decimal,d=void 0===l?"dot":l,p=i.thousands,h=void 0===p?"no":p,f=i.precision,m=void 0===f?2:f,g=i.enable_precision,v=void 0!==g&&g;if(String(e).includes("e")){if(e<1&&e>-1){var y=e.toFixed(v?m:8);return v||(y=u(y)),0===parseFloat(y)&&y.startsWith("-")?y.substring(1):y}return String(e)}var x=c[d],A=c[h],C=v?m:function(e){if(Number.isInteger(e))return 0;var t=String(e).split(".")[1],n=t?t.length:8;return n>8?8:n}(e),b=parseFloat((0,s.round)(e,C).toFixed(C)),w=b<0,S=Math.trunc(b),D=String(Math.abs((0,a.NPminus)(b,S)).toFixed(C)).slice(1);v||(D=u(D)),o&&(v||(D=2===D.length?D=D.padEnd(3,"0"):(D.substring(0,3)||".").padEnd(3,"0"))),D=D.replace(/./,x);for(var k=[],M=0,j=(S=Math.abs(S).toString()).length-1;j>-1;j--)M+=1,k.unshift(S[j]),M%3||0===j||k.unshift(A);return"".concat(w?"-":"").concat(k.join("")).concat(D)};t.getNumberDisplayString=function(e,t){var n=Object.prototype.toString.call(e);if("[object Number]"!==n)return"[object String]"===n&&e.startsWith("#")?e:"";if(isNaN(e)||e===1/0||e===-1/0)return String(e);var r=(t||{}).format;switch(void 0===r?i.DEFAULT_NUMBER_FORMAT:r){case"number":return d(e,{formats:t,isCurrency:!1});case"percent":return"".concat(d(Number.parseFloat((100*e).toFixed(8)),{formats:t,isCurrency:!1}),"%");case"yuan":return"\uffe5".concat(d(e,{formats:t}));case"dollar":return"$".concat(d(e,{formats:t}));case"euro":return"\u20ac".concat(d(e,{formats:t}));case"custom_currency":return"after"===t.currency_symbol_position?"".concat(d(e,{formats:t})).concat(t.currency_symbol||""):"".concat(t.currency_symbol||"").concat(d(e,{formats:t}));case"byte":if(e<0)return"--";if(0===e)return e+" "+l[0];var o=parseInt(Math.floor(Math.log(e)/Math.log(1e3)),10);return 0===o?e+" "+l[o]:(e/Math.pow(1e3,o)).toFixed(1)+" "+l[o];default:return String(e)}}},44956:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(84583)),i=r(n(27619));o.default.extend(i.default);t.default=o.default},56265:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"debounce",{enumerable:!0,get:function(){return o.debounce}}),Object.defineProperty(t,"getEventClassName",{enumerable:!0,get:function(){return o.getEventClassName}}),Object.defineProperty(t,"getHTML",{enumerable:!0,get:function(){return r.getHTML}}),Object.defineProperty(t,"getNumberDisplayString",{enumerable:!0,get:function(){return o.getNumberDisplayString}}),Object.defineProperty(t,"getType",{enumerable:!0,get:function(){return o.getType}}),Object.defineProperty(t,"gettext",{enumerable:!0,get:function(){return r.gettext}}),Object.defineProperty(t,"isFunction",{enumerable:!0,get:function(){return o.isFunction}}),Object.defineProperty(t,"isMac",{enumerable:!0,get:function(){return o.isMac}}),Object.defineProperty(t,"isValidEmail",{enumerable:!0,get:function(){return o.isValidEmail}}),Object.defineProperty(t,"throttle",{enumerable:!0,get:function(){return o.throttle}});var r=n(27399),o=n(39856)},97701:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NPminus=t.NPdivide=void 0;var n=function(e){var t=e.toString().split(/[eE]/),n=(t[0].split(".")[1]||"").length-+(t[1]||0);return n>0?n:0},r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15;return+parseFloat(Number(e).toPrecision(t))},o=function(e){if(-1===e.toString().indexOf("e"))return Number(e.toString().replace(".",""));var t=n(e);return t>0?r(Number(e)*Math.pow(10,t)):Number(e)},i=function(e,t){var r=o(e),i=o(t),a=n(e)+n(t);return r*i/Math.pow(10,a)};t.NPminus=function(e,t){var r=Math.pow(10,Math.max(n(e),n(t)));return(i(e,r)-i(t,r))/r};t.NPdivide=function(e,t){var a=o(e),s=o(t);return i(a/s,r(Math.pow(10,n(t)-n(e))))}},22724:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.round=t.isNumberEqual=t.isNumber=void 0;t.isNumber=function(e){return(e||0===e)&&"[object Number]"===Object.prototype.toString.call(e)};t.isNumberEqual=function(e,t){return e===t||Math.abs(e-t)<1e-5};t.round=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(0===t)return Math.round(e);var n=Math.pow(10,t),r=e*n;return t>0&&(r=Number.parseFloat(r.toFixed(1))),Math.round(r)/n}},27399:function(e,t,n){"use strict";var r=n(24994).default;Object.defineProperty(t,"__esModule",{value:!0}),t.gettext=t.getHTML=void 0;var o=r(n(5799));t.gettext=function(e,t){return e?o.default.get(e,t)||e:""};t.getHTML=function(e,t){return e?o.default.getHTML(e,t)||e:""}},89659:function(e,t,n){"use strict";var r=n(12897).default,o=n(17383).default,i=n(34579).default,a=n(18336).default,s=n(29511).default,l=n(6305).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=l(n(9950));t.default=function(e){var t;return t=function(t){function n(){return o(this,n),a(this,n,arguments)}return s(n,t),i(n,[{key:"render",value:function(){var t=r({},this.props);return"function"===typeof this.props.getInstance&&(t.ref=this.props.getInstance),c.default.createElement(e,t)}}])}(c.Component),t.displayName="withRef(".concat(e.displayName||e.name||"Component",")"),t}},82894:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Te}});var r=n(7219),o=n(26380),i=n(52889),a=n(5316),s=n(9950),l=n(17119),c=n(11942),u=n.n(c),d=n(91478),p=n(4899),h=n(84583),f=n.n(h),m=function(e){function t(){return(0,o.default)(this,t),(0,i.default)(this,e.apply(this,arguments))}return(0,a.default)(t,e),t.prototype.render=function(){var e=this.props,t=e.value.localeData(),n=e.prefixCls,r=void 0,o=t.weekdaysMin(),i=t.weekdaysShort();e.showWeekNumber&&(r=s.createElement("th",{role:"columnheader",className:n+"-column-header "+n+"-week-number-header"},s.createElement("span",{className:n+"-column-header-inner"},"x")));var a=i.map((function(e,t){return s.createElement("th",{key:t,role:"columnheader",title:e,className:n+"-column-header"},s.createElement("span",{className:n+"-column-header-inner"},o[t]))}));return s.createElement("thead",null,s.createElement("tr",{role:"row"},r,a))},t}(s.Component),g=m,v=n(86615),y=n.n(v),x=6,A=7,C=n(6740),b=n.n(C);f().extend(b());var w={disabledHours:function(){return[]},disabledMinutes:function(){return[]},disabledSeconds:function(){return[]}};function S(e){var t=f()();return t=t.locale(e.locale()).utcOffset(e.utcOffset())}function D(e){return e.format("LL")}function k(e){return D(S(e))}function M(e){var t=e.locale();return e.localeData()["zh-cn"===t?"months":"monthsShort"](e)}function j(e,t){var n=t?t(e):{};return n=(0,r.A)({},w,n)}function I(e,t,n){return(!t||!t(e))&&!(n&&!function(e,t){return function(e,t){var n=!1;if(e){var r=e.hour(),o=e.minute(),i=e.second();n=-1!==t.disabledHours().indexOf(r)||-1!==t.disabledMinutes(r).indexOf(o)||-1!==t.disabledSeconds(r,o).indexOf(i)}return!n}(e,j(e,t))}(e,n))}function _(e,t){return e?(Array.isArray(t)&&(t=t[0]),e.format(t)):""}function P(e,t){return e&&t&&e.isSame(t,"day")}function N(e,t){return e.year()<t.year()?1:e.year()===t.year()&&e.month()<t.month()}function O(e,t){return e.year()>t.year()?1:e.year()===t.year()&&e.month()>t.month()}var T=function(e){function t(){return(0,o.default)(this,t),(0,i.default)(this,e.apply(this,arguments))}return(0,a.default)(t,e),t.prototype.render=function(){var e=this.props,t=e.contentRender,n=e.prefixCls,r=e.selectedValue,o=e.value,i=e.showWeekNumber,a=e.dateRender,l=e.disabledDate,c=e.hoverValue,u=void 0,d=void 0,p=void 0,h=[],f=S(o),m=n+"-cell",g=n+"-week-number-cell",v=n+"-date",C=n+"-today",b=n+"-selected-day",w=n+"-selected-date",k=n+"-selected-start-date",M=n+"-selected-end-date",j=n+"-in-range-cell",I=n+"-last-month-cell",_=n+"-next-month-btn-day",T=n+"-disabled-cell",E=n+"-disabled-cell-first-of-row",R=n+"-disabled-cell-last-of-row",L=n+"-last-day-of-month",F=o.clone(),U=((F=F.date(1)).day()+7-7)%7,B=F.clone();B=B.add(0-U,"days");var Y=0;for(u=0;u<x;u++)for(d=0;d<A;d++)p=B,Y&&(p=(p=p.clone()).add(Y,"days")),h.push(p),Y++;var q,H=[];for(Y=0,u=0;u<x;u++){var G,z=void 0,V=void 0,W=!1,K=[];for(i&&(V=s.createElement("td",{key:h[Y].week(),role:"gridcell",className:g},h[Y].week())),d=0;d<A;d++){var X=null,$=null;p=h[Y],d<A-1&&(X=h[Y+1]),d>0&&($=h[Y-1]);var Z=m,J=!1,Q=!1;P(p,f)&&(Z+=" "+C,z=!0);var ee=N(p,o),te=O(p,o);if(r&&Array.isArray(r)){var ne=c.length?c:r;if(!ee&&!te){var re=ne[0],oe=ne[1];re&&P(p,re)&&(Q=!0,W=!0,Z+=" "+k),(re||oe)&&(P(p,oe)?(Q=!0,W=!0,Z+=" "+M):(null!==re&&void 0!==re||!p.isBefore(oe,"day"))&&(null!==oe&&void 0!==oe||!p.isAfter(re,"day"))?p.isAfter(re,"day")&&p.isBefore(oe,"day")&&(Z+=" "+j):Z+=" "+j)}}else P(p,o)&&(Q=!0,W=!0);P(p,r)&&(Z+=" "+w),ee&&(Z+=" "+I),te&&(Z+=" "+_),p.clone().endOf("month").date()===p.date()&&(Z+=" "+L),l&&l(p,o)&&(J=!0,$&&l($,o)||(Z+=" "+E),X&&l(X,o)||(Z+=" "+R)),Q&&(Z+=" "+b),J&&(Z+=" "+T);var ie=void 0;if(a)ie=a(p,o);else{var ae=t?t(p,o):p.date();ie=s.createElement("div",{key:(q=p,"rc-calendar-"+q.year()+"-"+q.month()+"-"+q.date()),className:v,"aria-selected":Q,"aria-disabled":J},ae)}K.push(s.createElement("td",{key:Y,onClick:J?void 0:e.onSelect.bind(null,p),onMouseEnter:J?void 0:e.onDayHover&&e.onDayHover.bind(null,p)||void 0,role:"gridcell",title:D(p),className:Z},ie)),Y++}H.push(s.createElement("tr",{key:u,role:"row",className:y()((G={},G[n+"-current-week"]=z,G[n+"-active-week"]=W,G))},V,K))}return s.createElement("tbody",{className:n+"-tbody"},H)},t}(s.Component);T.propTypes={contentRender:u().func,dateRender:u().func,disabledDate:u().func,prefixCls:u().string,selectedValue:u().oneOfType([u().object,u().arrayOf(u().object)]),value:u().object,hoverValue:u().any,showWeekNumber:u().bool},T.defaultProps={hoverValue:[]};var E=T,R=function(e){function t(){return(0,o.default)(this,t),(0,i.default)(this,e.apply(this,arguments))}return(0,a.default)(t,e),t.prototype.render=function(){var e=this.props,t=e.prefixCls;return s.createElement("table",{className:t+"-table",cellSpacing:"0",role:"grid"},s.createElement(g,e),s.createElement(E,e))},t}(s.Component),L=R,F=n(59398);function U(e){var t=this.state.value.clone();t=t.month(e),this.setAndSelectValue(t)}var B=function(e){function t(n){(0,o.default)(this,t);var r=(0,i.default)(this,e.call(this,n));return r.state={value:n.value},r}return(0,a.default)(t,e),t.prototype.componentWillReceiveProps=function(e){"value"in e&&this.setState({value:e.value})},t.prototype.setAndSelectValue=function(e){this.setState({value:e}),this.props.onSelect(e)},t.prototype.months=function(){for(var e=this.state.value.clone(),t=[],n=0,r=0;r<4;r++){t[r]=[];for(var o=0;o<3;o++){var i=M(e=e.month(n));t[r][o]={value:n,content:i,title:i},n++}}return t},t.prototype.render=function(){var e=this,t=this.props,n=this.state.value,r=S(n),o=this.months(),i=n.month(),a=t.prefixCls,l=t.locale,c=t.contentRender,u=t.cellRender,d=o.map((function(o,d){var p=o.map((function(o){var d,p=!1;if(t.disabledDate){var h=n.clone();h=h.month(o.value),p=t.disabledDate(h)}var f=((d={})[a+"-cell"]=1,d[a+"-cell-disabled"]=p,d[a+"-selected-cell"]=o.value===i,d[a+"-current-cell"]=r.year()===n.year()&&o.value===r.month(),d),m=void 0;if(u){var g=n.clone();g=g.month(o.value),m=u(g,l)}else{var v=void 0;if(c){var x=n.clone();x=x.month(o.value),v=c(x,l)}else v=o.content;m=s.createElement("a",{className:a+"-month"},v)}return s.createElement("td",{role:"gridcell",key:o.value,onClick:p?null:U.bind(e,o.value),title:o.title,className:y()(f)},m)}));return s.createElement("tr",{key:d,role:"row"},p)}));return s.createElement("table",{className:a+"-table",cellSpacing:"0",role:"grid"},s.createElement("tbody",{className:a+"-tbody"},d))},t}(s.Component);B.defaultProps={onSelect:function(){}},B.propTypes={onSelect:u().func,cellRender:u().func,prefixCls:u().string,value:u().object};var Y=B;function q(e){this.props.changeYear(e)}function H(){}var G=function(e){function t(n){(0,o.default)(this,t);var r=(0,i.default)(this,e.call(this,n));return r.setAndSelectValue=function(e){r.setValue(e),r.props.onSelect(e)},r.setValue=function(e){"value"in r.props&&r.setState({value:e})},r.nextYear=q.bind(r,1),r.previousYear=q.bind(r,-1),r.prefixCls=n.rootPrefixCls+"-month-panel",r.state={value:n.value||n.defaultValue},r}return(0,a.default)(t,e),t.getDerivedStateFromProps=function(e){var t={};return"value"in e&&(t={value:e.value}),t},t.prototype.render=function(){var e=this.props,t=this.state.value,n=e.locale,r=e.cellRender,o=e.contentRender,i=e.renderFooter,a=t.year(),l=this.prefixCls,c=i&&i("month");return s.createElement("div",{className:l,style:e.style},s.createElement("div",null,s.createElement("div",{className:l+"-header"},s.createElement("a",{className:l+"-prev-year-btn",role:"button",onClick:this.previousYear,title:n.previousYear}),s.createElement("a",{className:l+"-year-select",role:"button",onClick:e.onYearPanelShow,title:n.yearSelect},s.createElement("span",{className:l+"-year-select-content"},a),s.createElement("span",{className:l+"-year-select-arrow"},"x")),s.createElement("a",{className:l+"-next-year-btn",role:"button",onClick:this.nextYear,title:n.nextYear})),s.createElement("div",{className:l+"-body"},s.createElement(Y,{disabledDate:e.disabledDate,onSelect:this.setAndSelectValue,locale:n,value:t,cellRender:r,contentRender:o,prefixCls:l})),c&&s.createElement("div",{className:l+"-footer"},c)))},t}(s.Component);G.propTypes={onChange:u().func,disabledDate:u().func,onSelect:u().func,renderFooter:u().func,rootPrefixCls:u().string,value:u().object,defaultValue:u().object},G.defaultProps={onChange:H,onSelect:H},(0,p.polyfill)(G);var z=G;function V(e){var t=this.state.value.clone();t=t.add(e,"year"),this.setState({value:t})}function W(e){var t=this.state.value.clone();t=(t=t.year(e)).month(this.state.value.month()),this.setState({value:t}),this.props.onSelect(t)}var K=function(e){function t(n){(0,o.default)(this,t);var r=(0,i.default)(this,e.call(this,n));return r.prefixCls=n.rootPrefixCls+"-year-panel",r.state={value:n.value||n.defaultValue},r.nextDecade=V.bind(r,10),r.previousDecade=V.bind(r,-10),r}return(0,a.default)(t,e),t.prototype.years=function(){for(var e=this.state.value.year(),t=10*parseInt(e/10,10)-1,n=[],r=0,o=0;o<4;o++){n[o]=[];for(var i=0;i<3;i++){var a=t+r,s=String(a);n[o][i]={content:s,year:a,title:s},r++}}return n},t.prototype.render=function(){var e=this,t=this.props,n=this.state.value,r=t.locale,o=t.renderFooter,i=this.years(),a=n.year(),l=10*parseInt(a/10,10),c=l+9,u=this.prefixCls,d=i.map((function(t,n){var r=t.map((function(t){var n,r=((n={})[u+"-cell"]=1,n[u+"-selected-cell"]=t.year===a,n);return s.createElement("td",{role:"gridcell",title:t.title,key:t.content,onClick:W.bind(e,t.year),className:y()(r)},s.createElement("a",{className:u+"-year"},t.content))}));return s.createElement("tr",{key:n,role:"row"},r)})),p=o&&o("year");return s.createElement("div",{className:this.prefixCls},s.createElement("div",null,s.createElement("div",{className:u+"-header"},s.createElement("a",{className:u+"-prev-decade-btn",role:"button",onClick:this.previousDecade,title:r.previousDecade}),s.createElement("a",{className:u+"-decade-select",role:"button",onClick:t.onDecadePanelShow,title:r.decadeSelect},s.createElement("span",{className:u+"-decade-select-content"},l,"-",c),s.createElement("span",{className:u+"-decade-select-arrow"},"x")),s.createElement("a",{className:u+"-next-decade-btn",role:"button",onClick:this.nextDecade,title:r.nextDecade})),s.createElement("div",{className:u+"-body"},s.createElement("table",{className:u+"-table",cellSpacing:"0",role:"grid"},s.createElement("tbody",{className:u+"-tbody"},d))),p&&s.createElement("div",{className:u+"-footer"},p)))},t}(s.Component),X=K;K.propTypes={rootPrefixCls:u().string,value:u().object,defaultValue:u().object,renderFooter:u().func},K.defaultProps={onSelect:function(){}};function $(e){var t=this.state.value.clone();t=t.add(e,"years"),this.setState({value:t})}function Z(e,t){var n=this.state.value.clone();n=(n=n.year(e)).month(this.state.value.month()),this.props.onSelect(n),t.preventDefault()}var J=function(e){function t(n){(0,o.default)(this,t);var r=(0,i.default)(this,e.call(this,n));return r.state={value:n.value||n.defaultValue},r.prefixCls=n.rootPrefixCls+"-decade-panel",r.nextCentury=$.bind(r,100),r.previousCentury=$.bind(r,-100),r}return(0,a.default)(t,e),t.prototype.render=function(){for(var e=this,t=this.state.value,n=this.props,r=n.locale,o=n.renderFooter,i=t.year(),a=100*parseInt(i/100,10),l=a-10,c=a+99,u=[],d=0,p=this.prefixCls,h=0;h<4;h++){u[h]=[];for(var f=0;f<3;f++){var m=l+10*d,g=l+10*d+9;u[h][f]={startDecade:m,endDecade:g},d++}}var v=o&&o("decade"),x=u.map((function(t,n){var r=t.map((function(t){var n,r=t.startDecade,o=t.endDecade,l=r<a,u=o>c,d=((n={})[p+"-cell"]=1,n[p+"-selected-cell"]=r<=i&&i<=o,n[p+"-last-century-cell"]=l,n[p+"-next-century-cell"]=u,n),h=r+"-"+o,f=void 0;return f=l?e.previousCentury:u?e.nextCentury:Z.bind(e,r),s.createElement("td",{key:r,onClick:f,role:"gridcell",className:y()(d)},s.createElement("a",{className:p+"-decade"},h))}));return s.createElement("tr",{key:n,role:"row"},r)}));return s.createElement("div",{className:this.prefixCls},s.createElement("div",{className:p+"-header"},s.createElement("a",{className:p+"-prev-century-btn",role:"button",onClick:this.previousCentury,title:r.previousCentury}),s.createElement("div",{className:p+"-century"},a,"-",c),s.createElement("a",{className:p+"-next-century-btn",role:"button",onClick:this.nextCentury,title:r.nextCentury})),s.createElement("div",{className:p+"-body"},s.createElement("table",{className:p+"-table",cellSpacing:"0",role:"grid"},s.createElement("tbody",{className:p+"-tbody"},x))),v&&s.createElement("div",{className:p+"-footer"},v))},t}(s.Component),Q=J;function ee(e){var t=this.props.value.clone();t=t.add(e,"months"),this.props.onValueChange(t)}function te(e){var t=this.props.value.clone();t=t.add(e,"years"),this.props.onValueChange(t)}function ne(e,t){return e?t:null}J.propTypes={locale:u().object,value:u().object,defaultValue:u().object,rootPrefixCls:u().string,renderFooter:u().func},J.defaultProps={onSelect:function(){}};var re=function(e){function t(n){(0,o.default)(this,t);var r=(0,i.default)(this,e.call(this,n));return oe.call(r),r.nextMonth=ee.bind(r,1),r.previousMonth=ee.bind(r,-1),r.nextYear=te.bind(r,1),r.previousYear=te.bind(r,-1),r.state={yearPanelReferer:null},r}return(0,a.default)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.prefixCls,r=t.locale,o=t.mode,i=t.value,a=t.showTimePicker,l=t.enableNext,c=t.enablePrev,u=t.disabledMonth,d=t.renderFooter,p=null;return"month"===o&&(p=s.createElement(z,{locale:r,value:i,rootPrefixCls:n,onSelect:this.onMonthSelect,onYearPanelShow:function(){return e.showYearPanel("month")},disabledDate:u,cellRender:t.monthCellRender,contentRender:t.monthCellContentRender,renderFooter:d,changeYear:this.changeYear})),"year"===o&&(p=s.createElement(X,{locale:r,defaultValue:i,rootPrefixCls:n,onSelect:this.onYearSelect,onDecadePanelShow:this.showDecadePanel,renderFooter:d})),"decade"===o&&(p=s.createElement(Q,{locale:r,defaultValue:i,rootPrefixCls:n,onSelect:this.onDecadeSelect,renderFooter:d})),s.createElement("div",{className:n+"-header"},s.createElement("div",{style:{position:"relative"}},ne(c&&!a,s.createElement("a",{className:n+"-prev-year-btn",role:"button",onClick:this.previousYear,title:r.previousYear})),ne(c&&!a,s.createElement("a",{className:n+"-prev-month-btn",role:"button",onClick:this.previousMonth,title:r.previousMonth})),this.monthYearElement(a),ne(l&&!a,s.createElement("a",{className:n+"-next-month-btn",onClick:this.nextMonth,title:r.nextMonth})),ne(l&&!a,s.createElement("a",{className:n+"-next-year-btn",onClick:this.nextYear,title:r.nextYear}))),p)},t}(s.Component);re.propTypes={prefixCls:u().string,value:u().object,onValueChange:u().func,showTimePicker:u().bool,onPanelChange:u().func,locale:u().object,enablePrev:u().any,enableNext:u().any,disabledMonth:u().func,renderFooter:u().func,onMonthSelect:u().func},re.defaultProps={enableNext:1,enablePrev:1,onPanelChange:function(){},onValueChange:function(){}};var oe=function(){var e=this;this.onMonthSelect=function(t){e.props.onPanelChange(t,"date"),e.props.onMonthSelect?e.props.onMonthSelect(t):e.props.onValueChange(t)},this.onYearSelect=function(t){var n=e.state.yearPanelReferer;e.setState({yearPanelReferer:null}),e.props.onPanelChange(t,n),e.props.onValueChange(t)},this.onDecadeSelect=function(t){e.props.onPanelChange(t,"year"),e.props.onValueChange(t)},this.changeYear=function(t){t>0?e.nextYear():e.previousYear()},this.monthYearElement=function(t){var n=e.props,r=n.prefixCls,o=n.locale,i=n.value,a=i.localeData(),l=o.monthBeforeYear,c=r+"-"+(l?"my-select":"ym-select"),u=t?" "+r+"-time-status":"",d=s.createElement("a",{className:r+"-year-select"+u,role:"button",onClick:t?null:function(){return e.showYearPanel("date")},title:t?null:o.yearSelect},i.format(o.yearFormat)),p=s.createElement("a",{className:r+"-month-select"+u,role:"button",onClick:t?null:e.showMonthPanel,title:t?null:o.monthSelect},o.monthFormat?i.format(o.monthFormat):a.monthsShort(i)),h=void 0;t&&(h=s.createElement("a",{className:r+"-day-select"+u,role:"button"},i.format(o.dayFormat)));var f=[];return f=l?[p,h,d]:[d,p,h],s.createElement("span",{className:c},(0,F.A)(f))},this.showMonthPanel=function(){e.props.onPanelChange(null,"month")},this.showYearPanel=function(t){e.setState({yearPanelReferer:t}),e.props.onPanelChange(null,"year")},this.showDecadePanel=function(){e.props.onPanelChange(null,"decade")}},ie=re;function ae(e){var t=e.prefixCls,n=e.locale,r=e.value,o=e.timePicker,i=e.disabled,a=e.disabledDate,l=e.onToday,c=e.text,u=(!c&&o?n.now:c)||n.today,d=a&&!I(S(r),a)||i,p=d?t+"-today-btn-disabled":"";return s.createElement("a",{className:t+"-today-btn "+p,role:"button",onClick:d?null:l,title:k(r)},u)}function se(e){var t=e.prefixCls,n=e.locale,r=e.okDisabled,o=e.onOk,i=t+"-ok-btn";return r&&(i+=" "+t+"-ok-btn-disabled"),s.createElement("a",{className:i,role:"button",onClick:r?null:o},n.ok)}function le(e){var t,n=e.prefixCls,r=e.locale,o=e.showTimePicker,i=e.onOpenTimePicker,a=e.onCloseTimePicker,l=e.timePickerDisabled,c=y()(((t={})[n+"-time-picker-btn"]=!0,t[n+"-time-picker-btn-disabled"]=l,t)),u=null;return l||(u=o?a:i),s.createElement("a",{className:c,role:"button",onClick:u},o?r.dateSelect:r.timeSelect)}var ce=function(e){function t(){return(0,o.default)(this,t),(0,i.default)(this,e.apply(this,arguments))}return(0,a.default)(t,e),t.prototype.onSelect=function(e){this.props.onSelect(e)},t.prototype.getRootDOMNode=function(){return l.findDOMNode(this)},t.prototype.render=function(){var e=this.props,t=e.value,n=e.prefixCls,o=e.showOk,i=e.timePicker,a=e.renderFooter,l=e.mode,c=null,u=a&&a(l);if(e.showToday||i||u){var d,p=void 0;e.showToday&&(p=s.createElement(ae,(0,r.A)({},e,{value:t})));var h=void 0;(!0===o||!1!==o&&e.timePicker)&&(h=s.createElement(se,e));var f=void 0;e.timePicker&&(f=s.createElement(le,e));var m=void 0;(p||f||h||u)&&(m=s.createElement("span",{className:n+"-footer-btn"},u,(0,F.A)([p,f,h])));var g=y()(n+"-footer",((d={})[n+"-footer-show-ok"]=h,d));c=s.createElement("div",{className:g},m)}return c},t}(s.Component);ce.propTypes={prefixCls:u().string,showDateInput:u().bool,disabledTime:u().any,timePicker:u().element,selectedValue:u().any,showOk:u().bool,onSelect:u().func,value:u().object,renderFooter:u().func,defaultValue:u().object,mode:u().string};var ue=ce,de=function(e){function t(n){(0,o.default)(this,t);var r=(0,i.default)(this,e.call(this,n));return r.onSelect=function(e){r.setState({highlightTime:e}),r.props.onSelect(e),r.props.onClickRightPanelTime()},r.getTimes=function(){for(var e=[],t=0;t<24;t++){var n=(String(t)+":00").padStart(5,"0"),r=(String(t)+":30").padStart(5,"0");e.push(n),e.push(r)}return e},r.scrollUp=function(){r.timeRef.current.scrollBy(0,-200)},r.scrollDown=function(){r.timeRef.current.scrollBy(0,200)},r.state={highlightTime:r.props.value||null},r.timeRef=s.createRef(),r.times=r.getTimes(),r}return(0,a.default)(t,e),t.prototype.componentDidMount=function(){var e=this.props.defaultMinutesTime,t=this.times.findIndex((function(t){return t===e})),n=t>-1?t:16;this.timeRef.current.scrollTo(0,34*n)},t.prototype.render=function(){var e=this,t=this.props,n=t.value,r=t.prefixCls,o=t.locale,i=n.format().slice(0,10),a=this.state.highlightTime,l=a?a.format().slice(11,16):null,c=o&&"\u4eca\u5929"===o.today;return s.createElement("div",{className:r+"-right-panel"},s.createElement("div",{className:r+"-right-panel-header",onClick:this.scrollUp},s.createElement("span",null)),s.createElement("div",{className:r+"-right-panel-body",ref:this.timeRef},s.createElement("ul",null,this.times.map((function(t){var n=f()(i+" "+t);return n=c?n.locale("zh-cn"):n.locale("en-gb"),s.createElement("li",{key:t,onClick:e.onSelect.bind(e,n),className:l===t?r+"-selected-time":""},t)})))),s.createElement("div",{className:r+"-right-panel-footer",onClick:this.scrollDown},s.createElement("span",null)))},t}(s.Component);de.propTypes={prefixCls:u().string,value:u().object,onSelect:u().func,onClickRightPanelTime:u().func,locale:u().object,defaultMinutesTime:u().string};var pe=de;function he(e){return e?S(e):f()()}var fe={value:u().object,defaultValue:u().object,onKeyDown:u().func},me={onKeyDown:function(){}};function ge(){}var ve={className:u().string,locale:u().object,style:u().object,visible:u().bool,onSelect:u().func,prefixCls:u().string,onChange:u().func,onOk:u().func},ye={locale:{today:"Today",now:"Now",backToToday:"Back to today",ok:"Ok",clear:"Clear",month:"Month",year:"Year",timeSelect:"select time",dateSelect:"select date",weekSelect:"Choose a week",monthSelect:"Choose a month",yearSelect:"Choose a year",decadeSelect:"Choose a decade",yearFormat:"YYYY",dateFormat:"M/D/YYYY",dayFormat:"D",dateTimeFormat:"M/D/YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Previous month (PageUp)",nextMonth:"Next month (PageDown)",previousYear:"Last year (Control + left)",nextYear:"Next year (Control + right)",previousDecade:"Last decade",nextDecade:"Next decade",previousCentury:"Last century",nextCentury:"Next century"},style:{},visible:!0,prefixCls:"rc-calendar",className:"",onSelect:ge,onChange:ge,onClear:ge,renderFooter:function(){return null},renderSidebar:function(){return null}},xe=void 0,Ae=void 0,Ce=void 0,be=function(e){function t(n){(0,o.default)(this,t);var r=(0,i.default)(this,e.call(this,n));we.call(r);var a=n.selectedValue;return r.state={str:_(a,r.props.format),invalid:!1,hasFocus:!1},r}return(0,a.default)(t,e),t.prototype.componentDidUpdate=function(){!Ce||!this.state.hasFocus||this.state.invalid||0===xe&&0===Ae||Ce.setSelectionRange(xe,Ae)},t.getDerivedStateFromProps=function(e,t){var n={};Ce&&(xe=Ce.selectionStart,Ae=Ce.selectionEnd);var r=e.selectedValue;return t.hasFocus||(n={str:_(r,e.format),invalid:!1}),n},t.getInstance=function(){return Ce},t.prototype.render=function(){var e=this.props,t=this.state,n=t.invalid,r=t.str,o=e.locale,i=e.prefixCls,a=e.placeholder,l=e.clearIcon,c=e.inputMode,u=n?i+"-input-invalid":"";return s.createElement("div",{className:i+"-input-wrap"},s.createElement("div",{className:i+"-date-input-wrap"},s.createElement("input",{ref:this.saveDateInput,className:i+"-input "+u,value:r,disabled:e.disabled,placeholder:a,onChange:this.onInputChange,onKeyDown:this.onKeyDown,onFocus:this.onFocus,onBlur:this.onBlur,inputMode:c})),e.showClear?s.createElement("a",{role:"button",title:o.clear,onClick:this.onClear},l||s.createElement("span",{className:i+"-clear-btn"})):null)},t}(s.Component);be.propTypes={prefixCls:u().string,timePicker:u().object,value:u().object,disabledTime:u().any,format:u().oneOfType([u().string,u().arrayOf(u().string)]),locale:u().object,disabledDate:u().func,onChange:u().func,onClear:u().func,placeholder:u().string,onSelect:u().func,selectedValue:u().object,clearIcon:u().node,inputMode:u().string};var we=function(){var e=this;this.onClear=function(){e.setState({str:""}),e.props.onClear(null)},this.onInputChange=function(t){var n=t.target.value,r=e.props,o=r.disabledDate,i=r.format,a=r.onChange,s=r.selectedValue;if(!n)return a(null),void e.setState({invalid:!1,str:n});var l=f()(n,i,!0);if(l.isValid()){var c=e.props.value.clone();!(c=c.year(l.year()).month(l.month()).date(l.date()).hour(l.hour()).minute(l.minute()).second(l.second()))||o&&o(c)?e.setState({invalid:!0,str:n}):(s!==c||s&&c&&!s.isSame(c))&&(e.setState({invalid:!1,str:n}),a(c))}else e.setState({invalid:!0,str:n})},this.onFocus=function(){e.setState({hasFocus:!0})},this.onBlur=function(){e.setState((function(e,t){return{hasFocus:!1,str:_(t.value,t.format)}}))},this.onKeyDown=function(t){var n=t.keyCode,r=e.props,o=r.onSelect,i=r.value,a=r.disabledDate;n===d.A.ENTER&&o&&((!a||!a(i))&&o(i.clone()),t.preventDefault())},this.getRootDOMNode=function(){return l.findDOMNode(e)},this.focus=function(){Ce&&Ce.focus()},this.saveDateInput=function(e){Ce=e}};(0,p.polyfill)(be);var Se=be;var De=n(43650),ke=n.n(De),Me=n(97676),je=n.n(Me);function Ie(){}f().extend(b()),f().extend(ke()),f().extend(je());var _e=function(e){return!(!f().isDayjs(e)||!e.isValid())&&e},Pe=function(e){function t(n){(0,o.default)(this,t);var r=(0,i.default)(this,e.call(this,n));return Ne.call(r),r.state={mode:r.props.mode||"date",value:_e(n.value)||_e(n.defaultValue)||f()(),selectedValue:n.selectedValue||n.defaultSelectedValue},r}return(0,a.default)(t,e),t.prototype.componentDidMount=function(){this.props.showDateInput&&this.saveFocusElement(Se.getInstance())},t.getDerivedStateFromProps=function(e,t){var n=e.value,r=e.selectedValue,o={};return"mode"in e&&t.mode!==e.mode&&(o={mode:e.mode}),"value"in e&&(o.value=_e(n)||_e(e.defaultValue)||he(t.value)),"selectedValue"in e&&(o.selectedValue=r),o},t.prototype.render=function(){var e=this.props,t=this.state,n=e.locale,o=e.prefixCls,i=e.disabledDate,a=e.dateInputPlaceholder,l=e.timePicker,c=e.onClickRightPanelTime,u=e.disabledTime,d=e.clearIcon,p=e.renderFooter,h=e.inputMode,f=e.showHourAndMinute,m=t.value,g=t.selectedValue,v=t.mode,y="time"===v,x=y&&u&&l?j(g,u):null,A=null;if(l&&y){var C=(0,r.A)({showHour:!0,showSecond:!0,showMinute:!0},l.props,x,{onChange:this.onDateInputChange,value:g,disabledTime:u});void 0!==l.props.defaultValue&&(C.defaultOpenValue=l.props.defaultValue),A=s.cloneElement(l,C)}var b=e.showDateInput?s.createElement(Se,{format:this.getFormat(),key:"date-input",value:m,locale:n,placeholder:a,showClear:!0,disabledTime:u,disabledDate:i,onClear:this.onClear,prefixCls:o,selectedValue:g,onChange:this.onDateInputChange,onSelect:this.onDateInputSelect,clearIcon:d,inputMode:h}):null,w=[];return e.renderSidebar&&w.push(e.renderSidebar()),w.push(s.createElement("div",{className:o+"-panel",key:"panel"},b,s.createElement("div",{className:o+"-date-panel-container"},s.createElement("div",{tabIndex:this.props.focusablePanel?0:void 0,className:o+"-date-panel"},s.createElement(ie,{locale:n,mode:v,value:m,onValueChange:this.setValue,onPanelChange:this.onPanelChange,renderFooter:p,showTimePicker:y,prefixCls:o}),l&&y?s.createElement("div",{className:o+"-time-picker"},s.createElement("div",{className:o+"-time-picker-panel"},A)):null,s.createElement("div",{className:o+"-body"},s.createElement(L,{locale:n,value:m,selectedValue:g,prefixCls:o,dateRender:e.dateRender,onSelect:this.onDateTableSelect,disabledDate:i,showWeekNumber:e.showWeekNumber})),s.createElement(ue,{showOk:e.showOk,mode:v,renderFooter:e.renderFooter,locale:n,prefixCls:o,showToday:e.showToday,disabledTime:u,showTimePicker:y,showDateInput:e.showDateInput,timePicker:l,selectedValue:g,value:m,disabledDate:i,okDisabled:!1!==e.showOk&&(!g||!this.isAllowedDate(g)),onOk:this.onOk,onSelect:this.onSelect,onToday:this.onToday,onOpenTimePicker:this.openTimePicker,onCloseTimePicker:this.closeTimePicker})),f&&s.createElement(pe,{prefixCls:o,value:m,locale:n,onSelect:this.onDateTableSelect,onClickRightPanelTime:c,defaultMinutesTime:this.props.defaultMinutesTime})))),this.renderRoot({children:w,className:e.showWeekNumber?o+"-week-number":""})},t}(s.Component);Pe.propTypes=(0,r.A)({},fe,ve,{prefixCls:u().string,className:u().string,style:u().object,defaultValue:u().object,value:u().object,selectedValue:u().object,defaultSelectedValue:u().object,mode:u().oneOf(["time","date","month","year","decade"]),locale:u().object,showDateInput:u().bool,showWeekNumber:u().bool,showToday:u().bool,showOk:u().bool,showHourAndMinute:u().bool,defaultMinutesTime:u().string,onSelect:u().func,onOk:u().func,onKeyDown:u().func,timePicker:u().element,dateInputPlaceholder:u().any,onClear:u().func,onChange:u().func,onPanelChange:u().func,disabledDate:u().func,disabledTime:u().any,dateRender:u().func,renderFooter:u().func,renderSidebar:u().func,clearIcon:u().node,focusablePanel:u().bool,inputMode:u().string,onBlur:u().func,onClickRightPanelTime:u().func}),Pe.defaultProps=(0,r.A)({},me,ye,{showToday:!0,showDateInput:!0,showHourAndMinute:!1,timePicker:null,onOk:Ie,onPanelChange:Ie,onClickRightPanelTime:Ie,focusablePanel:!0});var Ne=function(){var e=this;this.onPanelChange=function(t,n){var r=e.props,o=e.state;"mode"in r||e.setState({mode:n}),r.onPanelChange(t||o.value,n)},this.onKeyDown=function(t){if("input"!==t.target.nodeName.toLowerCase()){var n=t.keyCode,r=t.ctrlKey||t.metaKey,o=e.props.disabledDate,i=e.state.value;switch(n){case d.A.DOWN:return e.goTime(1,"weeks"),t.preventDefault(),1;case d.A.UP:return e.goTime(-1,"weeks"),t.preventDefault(),1;case d.A.LEFT:return r?e.goTime(-1,"years"):e.goTime(-1,"days"),t.preventDefault(),1;case d.A.RIGHT:return r?e.goTime(1,"years"):e.goTime(1,"days"),t.preventDefault(),1;case d.A.HOME:return e.setValue(e.state.value.clone().startOf("month")),t.preventDefault(),1;case d.A.END:return e.setValue(function(e){return e.clone().endOf("month")}(e.state.value)),t.preventDefault(),1;case d.A.PAGE_DOWN:return e.goTime(1,"month"),t.preventDefault(),1;case d.A.PAGE_UP:return e.goTime(-1,"month"),t.preventDefault(),1;case d.A.ENTER:return o&&o(i)||e.onSelect(i,{source:"keyboard"}),t.preventDefault(),1;default:return e.props.onKeyDown(t),1}}},this.onClear=function(){e.onSelect(null),e.props.onClear()},this.onOk=function(){var t=e.state.selectedValue;e.isAllowedDate(t)&&e.props.onOk(t)},this.onDateInputChange=function(t){e.onSelect(t,{source:"dateInput"})},this.onDateInputSelect=function(t){e.onSelect(t,{source:"dateInputSelect"})},this.onDateTableSelect=function(t){var n,r,o=e.props.timePicker;if(!e.state.selectedValue&&o){var i=o.props.defaultValue;i&&(n=i,r=t,f().isDayjs(n)&&f().isDayjs(r)&&(r=(r=(r=(r=r.hour(n.hour())).minute(n.minute())).second(n.second())).millisecond(n.millisecond())))}e.onSelect(t)},this.onToday=function(){var t=S(e.state.value);e.onSelect(t,{source:"todayButton"})},this.onBlur=function(t){setTimeout((function(){var n=Se.getInstance(),r=e.rootInstance;!r||r.contains(document.activeElement)||n&&n.contains(document.activeElement)||e.props.onBlur&&e.props.onBlur(t)}),0)},this.getRootDOMNode=function(){return l.findDOMNode(e)},this.openTimePicker=function(){e.onPanelChange(null,"time")},this.closeTimePicker=function(){e.onPanelChange(null,"date")},this.goTime=function(t,n){e.setValue(function(e,t,n){return e.clone().add(t,n)}(e.state.value,t,n))}};(0,p.polyfill)(Pe);var Oe=function(e){var t,n;return n=t=function(t){function n(){var e,r,a;(0,o.default)(this,n);for(var l=arguments.length,c=Array(l),u=0;u<l;u++)c[u]=arguments[u];return e=r=(0,i.default)(this,t.call.apply(t,[this].concat(c))),r.onSelect=function(e,t){e&&r.setValue(e),r.setSelectedValue(e,t)},r.renderRoot=function(e){var t,n=r.props,o=n.prefixCls,i=((t={})[o]=1,t[o+"-hidden"]=!n.visible,t[n.className]=!!n.className,t[e.className]=!!e.className,t);return s.createElement("div",{ref:r.saveRoot,className:""+y()(i),style:r.props.style,tabIndex:"0",onKeyDown:r.onKeyDown,onBlur:r.onBlur},e.children)},r.setSelectedValue=function(e,t){"selectedValue"in r.props||r.setState({selectedValue:e}),r.props.onSelect&&r.props.onSelect(e,t)},r.setValue=function(e){var t=r.state.value;"value"in r.props||r.setState({value:e}),(t&&e&&!t.isSame(e)||!t&&e||t&&!e)&&r.props.onChange(e)},r.isAllowedDate=function(e){return I(e,r.props.disabledDate,r.props.disabledTime)},a=e,(0,i.default)(r,a)}return(0,a.default)(n,t),n.getDerivedStateFromProps=function(t,n){if(e.getDerivedStateFromProps)return e.getDerivedStateFromProps(t,n);var r=t.value,o=t.selectedValue,i={};return"value"in t&&(i.value=r||t.defaultValue||he(n.value)),"selectedValue"in t&&(i.selectedValue=o),i},n}(e),t.displayName="CalendarMixinWrapper",t.defaultProps=e.defaultProps,n}(function(e){var t,n;return n=t=function(e){function t(){var n,r,a;(0,o.default)(this,t);for(var s=arguments.length,l=Array(s),c=0;c<s;c++)l[c]=arguments[c];return n=r=(0,i.default)(this,e.call.apply(e,[this].concat(l))),r.getFormat=function(){var e=r.props.format,t=r.props,n=t.locale,o=t.timePicker;return e||(e=o?n.dateTimeFormat:n.dateFormat),e},r.focus=function(){r.focusElement?r.focusElement.focus():r.rootInstance&&r.rootInstance.focus()},r.saveFocusElement=function(e){r.focusElement=e},r.saveRoot=function(e){r.rootInstance=e},a=n,(0,i.default)(r,a)}return(0,a.default)(t,e),t.prototype.shouldComponentUpdate=function(e){return this.props.visible||e.visible},t}(e),t.displayName="CommonMixinWrapper",t.defaultProps=e.defaultProps,t.getDerivedStateFromProps=e.getDerivedStateFromProps,n}(Pe)),Te=Oe},39739:function(e,t,n){"use strict";t.__esModule=!0;var r=f(n(26380)),o=f(n(52889)),i=f(n(5316)),a=f(n(9950)),s=f(n(17119)),l=f(n(11942)),c=n(4899),u=f(n(19699)),d=f(n(13225)),p=f(n(32886)),h=f(n(96490));function f(e){return e&&e.__esModule?e:{default:e}}function m(){}function g(e,t){this[e]=t}var v=function(e){function t(n){(0,r.default)(this,t);var i=(0,o.default)(this,e.call(this,n));y.call(i);var a=void 0;a="open"in n?n.open:n.defaultOpen;var s=n.value||n.defaultValue;return i.saveCalendarRef=g.bind(i,"calendarInstance"),i.state={open:a,value:s},i}return(0,i.default)(t,e),t.prototype.componentDidUpdate=function(e,t){!t.open&&this.state.open&&(this.focusTimeout=setTimeout(this.focusCalendar,0,this))},t.prototype.componentWillUnmount=function(){clearTimeout(this.focusTimeout)},t.getDerivedStateFromProps=function(e){var t={},n=e.value,r=e.open;return"value"in e&&(t.value=n),void 0!==r&&(t.open=r),t},t.prototype.render=function(){var e=this.props,t=e.prefixCls,n=e.placement,r=e.style,o=e.getCalendarContainer,i=e.align,s=e.animation,l=e.disabled,c=e.dropdownClassName,u=e.transitionName,d=e.children,f=this.state;return a.default.createElement(h.default,{popup:this.getCalendarElement(),popupAlign:i,builtinPlacements:p.default,popupPlacement:n,action:l&&!f.open?[]:["click"],destroyPopupOnHide:!0,getPopupContainer:o,popupStyle:r,popupAnimation:s,popupTransitionName:u,popupVisible:f.open,onPopupVisibleChange:this.onVisibleChange,prefixCls:t,popupClassName:c},a.default.cloneElement(d(f,e),{onKeyDown:this.onKeyDown}))},t}(a.default.Component);v.propTypes={animation:l.default.oneOfType([l.default.func,l.default.string]),disabled:l.default.bool,transitionName:l.default.string,onChange:l.default.func,onOpenChange:l.default.func,children:l.default.func,getCalendarContainer:l.default.func,calendar:l.default.element,style:l.default.object,open:l.default.bool,defaultOpen:l.default.bool,prefixCls:l.default.string,placement:l.default.any,value:l.default.oneOfType([l.default.object,l.default.array]),defaultValue:l.default.oneOfType([l.default.object,l.default.array]),align:l.default.object,dateRender:l.default.func,onBlur:l.default.func},v.defaultProps={prefixCls:"rc-calendar-picker",style:{},align:{},placement:"bottomLeft",defaultOpen:!1,onChange:m,onOpenChange:m,onBlur:m};var y=function(){var e=this;this.onCalendarKeyDown=function(t){t.keyCode===d.default.ESC&&(t.stopPropagation(),e.close(e.focus))},this.onCalendarSelect=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.props;"value"in r||e.setState({value:t}),("keyboard"===n.source||"dateInputSelect"===n.source||!r.calendar.props.timePicker&&"dateInput"!==n.source||"todayButton"===n.source)&&e.close(e.focus),r.onChange(t)},this.onKeyDown=function(t){e.state.open||t.keyCode!==d.default.DOWN&&t.keyCode!==d.default.ENTER||(e.open(),t.preventDefault())},this.onCalendarOk=function(){e.close(e.focus)},this.onCalendarClear=function(){e.close(e.focus)},this.onCalendarBlur=function(){e.setOpen(!1)},this.onVisibleChange=function(t){e.setOpen(t)},this.getCalendarElement=function(){var t=e.props,n=e.state,r=t.calendar.props,o=n.value,i=o,s={ref:e.saveCalendarRef,defaultValue:i||r.defaultValue,selectedValue:o,onKeyDown:e.onCalendarKeyDown,onOk:(0,u.default)(r.onOk,e.onCalendarOk),onSelect:(0,u.default)(r.onSelect,e.onCalendarSelect),onClear:(0,u.default)(r.onClear,e.onCalendarClear),onBlur:(0,u.default)(r.onBlur,e.onCalendarBlur)};return a.default.cloneElement(t.calendar,s)},this.setOpen=function(t,n){var r=e.props.onOpenChange;e.state.open!==t&&("open"in e.props||e.setState({open:t},n),r(t))},this.open=function(t){e.setOpen(!0,t)},this.close=function(t){e.setOpen(!1,t)},this.focus=function(){e.state.open||s.default.findDOMNode(e).focus()},this.focusCalendar=function(){e.state.open&&e.calendarInstance&&e.calendarInstance.focus()}};(0,c.polyfill)(v),t.default=v,e.exports=t.default},19550:function(e,t){"use strict";t.__esModule=!0,t.default={today:"Dnes",now:"Nyn\xed",backToToday:"Zp\u011bt na dne\u0161ek",ok:"Ok",clear:"Vymazat",month:"M\u011bs\xedc",year:"Rok",timeSelect:"Vybrat \u010das",dateSelect:"Vybrat datum",monthSelect:"Vyberte m\u011bs\xedc",yearSelect:"Vyberte rok",decadeSelect:"Vyberte dek\xe1du",yearFormat:"YYYY",dateFormat:"D.M.YYYY",dayFormat:"D",dateTimeFormat:"D.M.YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"P\u0159edchoz\xed m\u011bs\xedc (PageUp)",nextMonth:"N\xe1sleduj\xedc\xed (PageDown)",previousYear:"P\u0159edchoz\xed rok (Control + left)",nextYear:"N\xe1sleduj\xedc\xed rok (Control + right)",previousDecade:"P\u0159edchoz\xed dek\xe1da",nextDecade:"N\xe1sleduj\xedc\xed dek\xe1da",previousCentury:"P\u0159edchoz\xed stolet\xed",nextCentury:"N\xe1sleduj\xedc\xed stolet\xed"},e.exports=t.default},10507:function(e,t){"use strict";t.__esModule=!0,t.default={today:"Heute",now:"Jetzt",backToToday:"Zur\xfcck zu Heute",ok:"OK",clear:"Zur\xfccksetzen",month:"Monat",year:"Jahr",timeSelect:"Zeit w\xe4hlen",dateSelect:"Datum w\xe4hlen",monthSelect:"W\xe4hle einen Monat",yearSelect:"W\xe4hle ein Jahr",decadeSelect:"W\xe4hle ein Jahrzehnt",yearFormat:"YYYY",dateFormat:"D.M.YYYY",dayFormat:"D",dateTimeFormat:"D.M.YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Vorheriger Monat (PageUp)",nextMonth:"N\xe4chster Monat (PageDown)",previousYear:"Vorheriges Jahr (Ctrl + left)",nextYear:"N\xe4chstes Jahr (Ctrl + right)",previousDecade:"Vorheriges Jahrzehnt",nextDecade:"N\xe4chstes Jahrzehnt",previousCentury:"Vorheriges Jahrhundert",nextCentury:"N\xe4chstes Jahrhundert"},e.exports=t.default},37932:function(e,t){"use strict";t.__esModule=!0,t.default={today:"Today",now:"Now",backToToday:"Back to today",ok:"Ok",clear:"Clear",month:"Month",year:"Year",timeSelect:"select time",dateSelect:"select date",weekSelect:"Choose a week",monthSelect:"Choose a month",yearSelect:"Choose a year",decadeSelect:"Choose a decade",yearFormat:"YYYY",dateFormat:"M/D/YYYY",dayFormat:"D",dateTimeFormat:"M/D/YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Previous month (PageUp)",nextMonth:"Next month (PageDown)",previousYear:"Last year (Control + left)",nextYear:"Next year (Control + right)",previousDecade:"Last decade",nextDecade:"Next decade",previousCentury:"Last century",nextCentury:"Next century"},e.exports=t.default},1205:function(e,t){"use strict";t.__esModule=!0,t.default={today:"Hoy",now:"Ahora",backToToday:"Volver a hoy",ok:"Aceptar",clear:"Limpiar",month:"Mes",year:"A\xf1o",timeSelect:"Seleccionar hora",dateSelect:"Seleccionar fecha",monthSelect:"Elegir un mes",yearSelect:"Elegir un a\xf1o",decadeSelect:"Elegir una d\xe9cada",yearFormat:"YYYY",dateFormat:"D/M/YYYY",dayFormat:"D",dateTimeFormat:"D/M/YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Mes anterior (PageUp)",nextMonth:"Mes siguiente (PageDown)",previousYear:"A\xf1o anterior (Control + left)",nextYear:"A\xf1o siguiente (Control + right)",previousDecade:"D\xe9cada anterior",nextDecade:"D\xe9cada siguiente",previousCentury:"Siglo anterior",nextCentury:"Siglo siguiente"},e.exports=t.default},88309:function(e,t){"use strict";t.__esModule=!0,t.default={today:"Aujourd'hui",now:"Maintenant",backToToday:"Aujourd'hui",ok:"Ok",clear:"R\xe9tablir",month:"Mois",year:"Ann\xe9e",timeSelect:"S\xe9lectionner l'heure",dateSelect:"S\xe9lectionner la date",monthSelect:"Choisissez un mois",yearSelect:"Choisissez une ann\xe9e",decadeSelect:"Choisissez une d\xe9cennie",yearFormat:"YYYY",dateFormat:"DD/MM/YYYY",dayFormat:"DD",dateTimeFormat:"DD/MM/YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Mois pr\xe9c\xe9dent (PageUp)",nextMonth:"Mois suivant (PageDown)",previousYear:"Ann\xe9e pr\xe9c\xe9dente (Ctrl + gauche)",nextYear:"Ann\xe9e prochaine (Ctrl + droite)",previousDecade:"D\xe9cennie pr\xe9c\xe9dente",nextDecade:"D\xe9cennie suivante",previousCentury:"Si\xe8cle pr\xe9c\xe9dent",nextCentury:"Si\xe8cle suivant"},e.exports=t.default},16969:function(e,t){"use strict";t.__esModule=!0,t.default={today:"Dzisiaj",now:"Teraz",backToToday:"Ustaw dzisiaj",ok:"Ok",clear:"Wyczy\u015b\u0107",month:"Miesi\u0105c",year:"Rok",timeSelect:"Ustaw czas",dateSelect:"Ustaw dat\u0119",monthSelect:"Wybierz miesi\u0105c",yearSelect:"Wybierz rok",decadeSelect:"Wybierz dekad\u0119",yearFormat:"YYYY",dateFormat:"D/M/YYYY",dayFormat:"D",dateTimeFormat:"D/M/YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Poprzedni miesi\u0105c (PageUp)",nextMonth:"Nast\u0119pny miesi\u0105c (PageDown)",previousYear:"Ostatni rok (Ctrl + left)",nextYear:"Nast\u0119pny rok (Ctrl + right)",previousDecade:"Ostatnia dekada",nextDecade:"Nast\u0119pna dekada",previousCentury:"Ostatni wiek",nextCentury:"Nast\u0119pny wiek"},e.exports=t.default},36967:function(e,t){"use strict";t.__esModule=!0,t.default={today:"\u0421\u0435\u0433\u043e\u0434\u043d\u044f",now:"\u0421\u0435\u0439\u0447\u0430\u0441",backToToday:"\u0422\u0435\u043a\u0443\u0449\u0430\u044f \u0434\u0430\u0442\u0430",ok:"Ok",clear:"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c",month:"\u041c\u0435\u0441\u044f\u0446",year:"\u0413\u043e\u0434",timeSelect:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0432\u0440\u0435\u043c\u044f",dateSelect:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0434\u0430\u0442\u0443",monthSelect:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u043c\u0435\u0441\u044f\u0446",yearSelect:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0433\u043e\u0434",decadeSelect:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0434\u0435\u0441\u044f\u0442\u0438\u043b\u0435\u0442\u0438\u0435",yearFormat:"YYYY",dateFormat:"D-M-YYYY",dayFormat:"D",dateTimeFormat:"D-M-YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"\u041f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u0439 \u043c\u0435\u0441\u044f\u0446 (PageUp)",nextMonth:"\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 \u043c\u0435\u0441\u044f\u0446 (PageDown)",previousYear:"\u041f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u0439 \u0433\u043e\u0434 (Control + left)",nextYear:"\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 \u0433\u043e\u0434 (Control + right)",previousDecade:"\u041f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0435\u0435 \u0434\u0435\u0441\u044f\u0442\u0438\u043b\u0435\u0442\u0438\u0435",nextDecade:"\u0421\u043b\u0435\u0434\u0443\u0449\u0435\u0435 \u0434\u0435\u0441\u044f\u0442\u0438\u043b\u0435\u0442\u0438\u0435",previousCentury:"\u041f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u0439 \u0432\u0435\u043a",nextCentury:"\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 \u0432\u0435\u043a"},e.exports=t.default},95502:function(e,t){"use strict";t.__esModule=!0,t.default={today:"\u4eca\u5929",now:"\u6b64\u523b",backToToday:"\u8fd4\u56de\u4eca\u5929",ok:"\u786e\u5b9a",timeSelect:"\u9009\u62e9\u65f6\u95f4",dateSelect:"\u9009\u62e9\u65e5\u671f",weekSelect:"\u9009\u62e9\u5468",clear:"\u6e05\u9664",month:"\u6708",year:"\u5e74",previousMonth:"\u4e0a\u4e2a\u6708 (\u7ffb\u9875\u4e0a\u952e)",nextMonth:"\u4e0b\u4e2a\u6708 (\u7ffb\u9875\u4e0b\u952e)",monthSelect:"\u9009\u62e9\u6708\u4efd",yearSelect:"\u9009\u62e9\u5e74\u4efd",decadeSelect:"\u9009\u62e9\u5e74\u4ee3",yearFormat:"YYYY\u5e74",dayFormat:"D\u65e5",dateFormat:"YYYY\u5e74M\u6708D\u65e5",dateTimeFormat:"YYYY\u5e74M\u6708D\u65e5 HH\u65f6mm\u5206ss\u79d2",previousYear:"\u4e0a\u4e00\u5e74 (Control\u952e\u52a0\u5de6\u65b9\u5411\u952e)",nextYear:"\u4e0b\u4e00\u5e74 (Control\u952e\u52a0\u53f3\u65b9\u5411\u952e)",previousDecade:"\u4e0a\u4e00\u5e74\u4ee3",nextDecade:"\u4e0b\u4e00\u5e74\u4ee3",previousCentury:"\u4e0a\u4e00\u4e16\u7eaa",nextCentury:"\u4e0b\u4e00\u4e16\u7eaa"},e.exports=t.default},33850:function(e,t){"use strict";t.__esModule=!0,t.default={today:"\u4eca\u5929",now:"\u6b64\u523b",backToToday:"\u8fd4\u56de\u4eca\u5929",ok:"\u78ba\u5b9a",timeSelect:"\u9078\u64c7\u6642\u9593",dateSelect:"\u9078\u64c7\u65e5\u671f",clear:"\u6e05\u9664",month:"\u6708",year:"\u5e74",previousMonth:"\u4e0a\u500b\u6708 (\u7ffb\u9801\u4e0a\u9375)",nextMonth:"\u4e0b\u500b\u6708 (\u7ffb\u9801\u4e0b\u9375)",monthSelect:"\u9078\u64c7\u6708\u4efd",yearSelect:"\u9078\u64c7\u5e74\u4efd",decadeSelect:"\u9078\u64c7\u5e74\u4ee3",yearFormat:"YYYY\u5e74",dayFormat:"D\u65e5",dateFormat:"YYYY\u5e74M\u6708D\u65e5",dateTimeFormat:"YYYY\u5e74M\u6708D\u65e5 HH\u6642mm\u5206ss\u79d2",previousYear:"\u4e0a\u4e00\u5e74 (Control\u9375\u52a0\u5de6\u65b9\u5411\u9375)",nextYear:"\u4e0b\u4e00\u5e74 (Control\u9375\u52a0\u53f3\u65b9\u5411\u9375)",previousDecade:"\u4e0a\u4e00\u5e74\u4ee3",nextDecade:"\u4e0b\u4e00\u5e74\u4ee3",previousCentury:"\u4e0a\u4e00\u4e16\u7d00",nextCentury:"\u4e0b\u4e00\u4e16\u7d00"},e.exports=t.default},32886:function(e,t){"use strict";t.__esModule=!0;var n={adjustX:1,adjustY:1},r=[0,0],o={bottomLeft:{points:["tl","tl"],overflow:n,offset:[0,-3],targetOffset:r},bottomRight:{points:["tr","tr"],overflow:n,offset:[0,-3],targetOffset:r},topRight:{points:["br","br"],overflow:n,offset:[0,3],targetOffset:r},topLeft:{points:["bl","bl"],overflow:n,offset:[0,3],targetOffset:r}};t.default=o,e.exports=t.default},86615:function(e,t){var n;!function(){"use strict";var r={}.hasOwnProperty;function o(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var i=typeof n;if("string"===i||"number"===i)e.push(n);else if(Array.isArray(n)){if(n.length){var a=o.apply(null,n);a&&e.push(a)}}else if("object"===i){if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]")){e.push(n.toString());continue}for(var s in n)r.call(n,s)&&n[s]&&e.push(s)}}}return e.join(" ")}e.exports?(o.default=o,e.exports=o):void 0===(n=function(){return o}.apply(t,[]))||(e.exports=n)}()},84583:function(e){e.exports=function(){"use strict";var e=1e3,t=6e4,n=36e5,r="millisecond",o="second",i="minute",a="hour",s="day",l="week",c="month",u="quarter",d="year",p="date",h="Invalid Date",f=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,m=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,g={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},v=function(e,t,n){var r=String(e);return!r||r.length>=t?e:""+Array(t+1-r.length).join(n)+e},y={s:v,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),r=Math.floor(n/60),o=n%60;return(t<=0?"+":"-")+v(r,2,"0")+":"+v(o,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var r=12*(n.year()-t.year())+(n.month()-t.month()),o=t.clone().add(r,c),i=n-o<0,a=t.clone().add(r+(i?-1:1),c);return+(-(r+(n-o)/(i?o-a:a-o))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:c,y:d,w:l,d:s,D:p,h:a,m:i,s:o,ms:r,Q:u}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},x="en",A={};A[x]=g;var C=function(e){return e instanceof D},b=function(e,t,n){var r;if(!e)return x;if("string"==typeof e)A[e]&&(r=e),t&&(A[e]=t,r=e);else{var o=e.name;A[o]=e,r=o}return!n&&r&&(x=r),r||!n&&x},w=function(e,t){if(C(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new D(n)},S=y;S.l=b,S.i=C,S.w=function(e,t){return w(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var D=function(){function g(e){this.$L=b(e.locale,null,!0),this.parse(e)}var v=g.prototype;return v.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(S.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var r=t.match(f);if(r){var o=r[2]-1||0,i=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],o,r[3]||1,r[4]||0,r[5]||0,r[6]||0,i)):new Date(r[1],o,r[3]||1,r[4]||0,r[5]||0,r[6]||0,i)}}return new Date(t)}(e),this.$x=e.x||{},this.init()},v.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},v.$utils=function(){return S},v.isValid=function(){return!(this.$d.toString()===h)},v.isSame=function(e,t){var n=w(e);return this.startOf(t)<=n&&n<=this.endOf(t)},v.isAfter=function(e,t){return w(e)<this.startOf(t)},v.isBefore=function(e,t){return this.endOf(t)<w(e)},v.$g=function(e,t,n){return S.u(e)?this[t]:this.set(n,e)},v.unix=function(){return Math.floor(this.valueOf()/1e3)},v.valueOf=function(){return this.$d.getTime()},v.startOf=function(e,t){var n=this,r=!!S.u(t)||t,u=S.p(e),h=function(e,t){var o=S.w(n.$u?Date.UTC(n.$y,t,e):new Date(n.$y,t,e),n);return r?o:o.endOf(s)},f=function(e,t){return S.w(n.toDate()[e].apply(n.toDate("s"),(r?[0,0,0,0]:[23,59,59,999]).slice(t)),n)},m=this.$W,g=this.$M,v=this.$D,y="set"+(this.$u?"UTC":"");switch(u){case d:return r?h(1,0):h(31,11);case c:return r?h(1,g):h(0,g+1);case l:var x=this.$locale().weekStart||0,A=(m<x?m+7:m)-x;return h(r?v-A:v+(6-A),g);case s:case p:return f(y+"Hours",0);case a:return f(y+"Minutes",1);case i:return f(y+"Seconds",2);case o:return f(y+"Milliseconds",3);default:return this.clone()}},v.endOf=function(e){return this.startOf(e,!1)},v.$set=function(e,t){var n,l=S.p(e),u="set"+(this.$u?"UTC":""),h=(n={},n[s]=u+"Date",n[p]=u+"Date",n[c]=u+"Month",n[d]=u+"FullYear",n[a]=u+"Hours",n[i]=u+"Minutes",n[o]=u+"Seconds",n[r]=u+"Milliseconds",n)[l],f=l===s?this.$D+(t-this.$W):t;if(l===c||l===d){var m=this.clone().set(p,1);m.$d[h](f),m.init(),this.$d=m.set(p,Math.min(this.$D,m.daysInMonth())).$d}else h&&this.$d[h](f);return this.init(),this},v.set=function(e,t){return this.clone().$set(e,t)},v.get=function(e){return this[S.p(e)]()},v.add=function(r,u){var p,h=this;r=Number(r);var f=S.p(u),m=function(e){var t=w(h);return S.w(t.date(t.date()+Math.round(e*r)),h)};if(f===c)return this.set(c,this.$M+r);if(f===d)return this.set(d,this.$y+r);if(f===s)return m(1);if(f===l)return m(7);var g=(p={},p[i]=t,p[a]=n,p[o]=e,p)[f]||1,v=this.$d.getTime()+r*g;return S.w(v,this)},v.subtract=function(e,t){return this.add(-1*e,t)},v.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return n.invalidDate||h;var r=e||"YYYY-MM-DDTHH:mm:ssZ",o=S.z(this),i=this.$H,a=this.$m,s=this.$M,l=n.weekdays,c=n.months,u=function(e,n,o,i){return e&&(e[n]||e(t,r))||o[n].substr(0,i)},d=function(e){return S.s(i%12||12,e,"0")},p=n.meridiem||function(e,t,n){var r=e<12?"AM":"PM";return n?r.toLowerCase():r},f={YY:String(this.$y).slice(-2),YYYY:this.$y,M:s+1,MM:S.s(s+1,2,"0"),MMM:u(n.monthsShort,s,c,3),MMMM:u(c,s),D:this.$D,DD:S.s(this.$D,2,"0"),d:String(this.$W),dd:u(n.weekdaysMin,this.$W,l,2),ddd:u(n.weekdaysShort,this.$W,l,3),dddd:l[this.$W],H:String(i),HH:S.s(i,2,"0"),h:d(1),hh:d(2),a:p(i,a,!0),A:p(i,a,!1),m:String(a),mm:S.s(a,2,"0"),s:String(this.$s),ss:S.s(this.$s,2,"0"),SSS:S.s(this.$ms,3,"0"),Z:o};return r.replace(m,(function(e,t){return t||f[e]||o.replace(":","")}))},v.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},v.diff=function(r,p,h){var f,m=S.p(p),g=w(r),v=(g.utcOffset()-this.utcOffset())*t,y=this-g,x=S.m(this,g);return x=(f={},f[d]=x/12,f[c]=x,f[u]=x/3,f[l]=(y-v)/6048e5,f[s]=(y-v)/864e5,f[a]=y/n,f[i]=y/t,f[o]=y/e,f)[m]||y,h?x:S.a(x)},v.daysInMonth=function(){return this.endOf(c).$D},v.$locale=function(){return A[this.$L]},v.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),r=b(e,t,!0);return r&&(n.$L=r),n},v.clone=function(){return S.w(this.$d,this)},v.toDate=function(){return new Date(this.valueOf())},v.toJSON=function(){return this.isValid()?this.toISOString():null},v.toISOString=function(){return this.$d.toISOString()},v.toString=function(){return this.$d.toUTCString()},g}(),k=D.prototype;return w.prototype=k,[["$ms",r],["$s",o],["$m",i],["$H",a],["$W",s],["$M",c],["$y",d],["$D",p]].forEach((function(e){k[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),w.extend=function(e,t){return e.$i||(e(t,D,w),e.$i=!0),w},w.locale=b,w.isDayjs=C,w.unix=function(e){return w(1e3*e)},w.en=A[x],w.Ls=A,w.p={},w}()},92356:function(e,t,n){e.exports=function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(e),r={name:"en-gb",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekStart:1,yearStart:4,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},ordinal:function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||t[0])+"]"}};return n.default.locale(r,null,!0),r}(n(84583))},43195:function(e,t,n){e.exports=function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(e),r={name:"zh-cn",weekdays:"\u661f\u671f\u65e5_\u661f\u671f\u4e00_\u661f\u671f\u4e8c_\u661f\u671f\u4e09_\u661f\u671f\u56db_\u661f\u671f\u4e94_\u661f\u671f\u516d".split("_"),weekdaysShort:"\u5468\u65e5_\u5468\u4e00_\u5468\u4e8c_\u5468\u4e09_\u5468\u56db_\u5468\u4e94_\u5468\u516d".split("_"),weekdaysMin:"\u65e5_\u4e00_\u4e8c_\u4e09_\u56db_\u4e94_\u516d".split("_"),months:"\u4e00\u6708_\u4e8c\u6708_\u4e09\u6708_\u56db\u6708_\u4e94\u6708_\u516d\u6708_\u4e03\u6708_\u516b\u6708_\u4e5d\u6708_\u5341\u6708_\u5341\u4e00\u6708_\u5341\u4e8c\u6708".split("_"),monthsShort:"1\u6708_2\u6708_3\u6708_4\u6708_5\u6708_6\u6708_7\u6708_8\u6708_9\u6708_10\u6708_11\u6708_12\u6708".split("_"),ordinal:function(e,t){return"W"===t?e+"\u5468":e+"\u65e5"},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY\u5e74M\u6708D\u65e5",LLL:"YYYY\u5e74M\u6708D\u65e5Ah\u70b9mm\u5206",LLLL:"YYYY\u5e74M\u6708D\u65e5ddddAh\u70b9mm\u5206",l:"YYYY/M/D",ll:"YYYY\u5e74M\u6708D\u65e5",lll:"YYYY\u5e74M\u6708D\u65e5 HH:mm",llll:"YYYY\u5e74M\u6708D\u65e5dddd HH:mm"},relativeTime:{future:"%s\u5185",past:"%s\u524d",s:"\u51e0\u79d2",m:"1 \u5206\u949f",mm:"%d \u5206\u949f",h:"1 \u5c0f\u65f6",hh:"%d \u5c0f\u65f6",d:"1 \u5929",dd:"%d \u5929",M:"1 \u4e2a\u6708",MM:"%d \u4e2a\u6708",y:"1 \u5e74",yy:"%d \u5e74"},meridiem:function(e,t){var n=100*e+t;return n<600?"\u51cc\u6668":n<900?"\u65e9\u4e0a":n<1100?"\u4e0a\u5348":n<1300?"\u4e2d\u5348":n<1800?"\u4e0b\u5348":"\u665a\u4e0a"}};return n.default.locale(r,null,!0),r}(n(84583))},27619:function(e){e.exports=function(){"use strict";var e={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},t=/(\[[^[]*\])|([-:/.()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,n=/\d\d/,r=/\d\d?/,o=/\d*[^\s\d-_:/()]+/,i={},a=function(e){return(e=+e)+(e>68?1900:2e3)},s=function(e){return function(t){this[e]=+t}},l=[/[+-]\d\d:?(\d\d)?|Z/,function(e){(this.zone||(this.zone={})).offset=function(e){if(!e)return 0;if("Z"===e)return 0;var t=e.match(/([+-]|\d\d)/g),n=60*t[1]+(+t[2]||0);return 0===n?0:"+"===t[0]?-n:n}(e)}],c=function(e){var t=i[e];return t&&(t.indexOf?t:t.s.concat(t.f))},u=function(e,t){var n,r=i.meridiem;if(r){for(var o=1;o<=24;o+=1)if(e.indexOf(r(o,0,t))>-1){n=o>12;break}}else n=e===(t?"pm":"PM");return n},d={A:[o,function(e){this.afternoon=u(e,!1)}],a:[o,function(e){this.afternoon=u(e,!0)}],S:[/\d/,function(e){this.milliseconds=100*+e}],SS:[n,function(e){this.milliseconds=10*+e}],SSS:[/\d{3}/,function(e){this.milliseconds=+e}],s:[r,s("seconds")],ss:[r,s("seconds")],m:[r,s("minutes")],mm:[r,s("minutes")],H:[r,s("hours")],h:[r,s("hours")],HH:[r,s("hours")],hh:[r,s("hours")],D:[r,s("day")],DD:[n,s("day")],Do:[o,function(e){var t=i.ordinal,n=e.match(/\d+/);if(this.day=n[0],t)for(var r=1;r<=31;r+=1)t(r).replace(/\[|\]/g,"")===e&&(this.day=r)}],M:[r,s("month")],MM:[n,s("month")],MMM:[o,function(e){var t=c("months"),n=(c("monthsShort")||t.map((function(e){return e.substr(0,3)}))).indexOf(e)+1;if(n<1)throw new Error;this.month=n%12||n}],MMMM:[o,function(e){var t=c("months").indexOf(e)+1;if(t<1)throw new Error;this.month=t%12||t}],Y:[/[+-]?\d+/,s("year")],YY:[n,function(e){this.year=a(e)}],YYYY:[/\d{4}/,s("year")],Z:l,ZZ:l};function p(n){var r,o;r=n,o=i&&i.formats;for(var a=(n=r.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function(t,n,r){var i=r&&r.toUpperCase();return n||o[r]||e[r]||o[i].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(e,t,n){return t||n.slice(1)}))}))).match(t),s=a.length,l=0;l<s;l+=1){var c=a[l],u=d[c],p=u&&u[0],h=u&&u[1];a[l]=h?{regex:p,parser:h}:c.replace(/^\[|\]$/g,"")}return function(e){for(var t={},n=0,r=0;n<s;n+=1){var o=a[n];if("string"==typeof o)r+=o.length;else{var i=o.regex,l=o.parser,c=e.substr(r),u=i.exec(c)[0];l.call(t,u),e=e.replace(u,"")}}return function(e){var t=e.afternoon;if(void 0!==t){var n=e.hours;t?n<12&&(e.hours+=12):12===n&&(e.hours=0),delete e.afternoon}}(t),t}}return function(e,t,n){n.p.customParseFormat=!0,e&&e.parseTwoDigitYear&&(a=e.parseTwoDigitYear);var r=t.prototype,o=r.parse;r.parse=function(e){var t=e.date,r=e.utc,a=e.args;this.$u=r;var s=a[1];if("string"==typeof s){var l=!0===a[2],c=!0===a[3],u=l||c,d=a[2];c&&(d=a[2]),i=this.$locale(),!l&&d&&(i=n.Ls[d]),this.$d=function(e,t,n){try{if(["x","X"].indexOf(t)>-1)return new Date(("X"===t?1e3:1)*e);var r=p(t)(e),o=r.year,i=r.month,a=r.day,s=r.hours,l=r.minutes,c=r.seconds,u=r.milliseconds,d=r.zone,h=new Date,f=a||(o||i?1:h.getDate()),m=o||h.getFullYear(),g=0;o&&!i||(g=i>0?i-1:h.getMonth());var v=s||0,y=l||0,x=c||0,A=u||0;return d?new Date(Date.UTC(m,g,f,v,y,x,A+60*d.offset*1e3)):n?new Date(Date.UTC(m,g,f,v,y,x,A)):new Date(m,g,f,v,y,x,A)}catch(e){return new Date("")}}(t,s,r),this.init(),d&&!0!==d&&(this.$L=this.locale(d).$L),u&&t!=this.format(s)&&(this.$d=new Date("")),i={}}else if(s instanceof Array)for(var h=s.length,f=1;f<=h;f+=1){a[1]=s[f-1];var m=n.apply(this,a);if(m.isValid()){this.$d=m.$d,this.$L=m.$L,this.init();break}f===h&&(this.$d=new Date(""))}else o.call(this,e)}}}()},43650:function(e){e.exports=function(){"use strict";return function(e,t,n){var r=t.prototype,o=function(e){return e&&(e.indexOf?e:e.s)},i=function(e,t,n,r,i){var a=e.name?e:e.$locale(),s=o(a[t]),l=o(a[n]),c=s||l.map((function(e){return e.substr(0,r)}));if(!i)return c;var u=a.weekStart;return c.map((function(e,t){return c[(t+(u||0))%7]}))},a=function(){return n.Ls[n.locale()]},s=function(e,t){return e.formats[t]||function(e){return e.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(e,t,n){return t||n.slice(1)}))}(e.formats[t.toUpperCase()])},l=function(){var e=this;return{months:function(t){return t?t.format("MMMM"):i(e,"months")},monthsShort:function(t){return t?t.format("MMM"):i(e,"monthsShort","months",3)},firstDayOfWeek:function(){return e.$locale().weekStart||0},weekdays:function(t){return t?t.format("dddd"):i(e,"weekdays")},weekdaysMin:function(t){return t?t.format("dd"):i(e,"weekdaysMin","weekdays",2)},weekdaysShort:function(t){return t?t.format("ddd"):i(e,"weekdaysShort","weekdays",3)},longDateFormat:function(t){return s(e.$locale(),t)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};r.localeData=function(){return l.bind(this)()},n.localeData=function(){var e=a();return{firstDayOfWeek:function(){return e.weekStart||0},weekdays:function(){return n.weekdays()},weekdaysShort:function(){return n.weekdaysShort()},weekdaysMin:function(){return n.weekdaysMin()},months:function(){return n.months()},monthsShort:function(){return n.monthsShort()},longDateFormat:function(t){return s(e,t)},meridiem:e.meridiem,ordinal:e.ordinal}},n.months=function(){return i(a(),"months")},n.monthsShort=function(){return i(a(),"monthsShort","months",3)},n.weekdays=function(e){return i(a(),"weekdays",null,null,e)},n.weekdaysShort=function(e){return i(a(),"weekdaysShort","weekdays",3,e)},n.weekdaysMin=function(e){return i(a(),"weekdaysMin","weekdays",2,e)}}}()},6740:function(e){e.exports=function(){"use strict";var e="minute",t=/[+-]\d\d(?::?\d\d)?/g,n=/([+-]|\d\d)/g;return function(r,o,i){var a=o.prototype;i.utc=function(e){return new o({date:e,utc:!0,args:arguments})},a.utc=function(t){var n=i(this.toDate(),{locale:this.$L,utc:!0});return t?n.add(this.utcOffset(),e):n},a.local=function(){return i(this.toDate(),{locale:this.$L,utc:!1})};var s=a.parse;a.parse=function(e){e.utc&&(this.$u=!0),this.$utils().u(e.$offset)||(this.$offset=e.$offset),s.call(this,e)};var l=a.init;a.init=function(){if(this.$u){var e=this.$d;this.$y=e.getUTCFullYear(),this.$M=e.getUTCMonth(),this.$D=e.getUTCDate(),this.$W=e.getUTCDay(),this.$H=e.getUTCHours(),this.$m=e.getUTCMinutes(),this.$s=e.getUTCSeconds(),this.$ms=e.getUTCMilliseconds()}else l.call(this)};var c=a.utcOffset;a.utcOffset=function(r,o){var i=this.$utils().u;if(i(r))return this.$u?0:i(this.$offset)?c.call(this):this.$offset;if("string"==typeof r&&null===(r=function(e){void 0===e&&(e="");var r=e.match(t);if(!r)return null;var o=(""+r[0]).match(n)||["-",0,0],i=o[0],a=60*+o[1]+ +o[2];return 0===a?0:"+"===i?a:-a}(r)))return this;var a=Math.abs(r)<=16?60*r:r,s=this;if(o)return s.$offset=a,s.$u=0===r,s;if(0!==r){var l=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(s=this.local().add(a+l,e)).$offset=a,s.$x.$localOffset=l}else s=this.utc();return s};var u=a.format;a.format=function(e){var t=e||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return u.call(this,t)},a.valueOf=function(){var e=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||(new Date).getTimezoneOffset());return this.$d.valueOf()-6e4*e},a.isUTC=function(){return!!this.$u},a.toISOString=function(){return this.toDate().toISOString()},a.toString=function(){return this.toDate().toUTCString()};var d=a.toDate;a.toDate=function(e){return"s"===e&&this.$offset?i(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():d.call(this)};var p=a.diff;a.diff=function(e,t,n){if(e&&this.$u===e.$u)return p.call(this,e,t,n);var r=this.local(),o=i(e).local();return p.call(r,o,t,n)}}}()},97676:function(e){e.exports=function(){"use strict";var e="week",t="year";return function(n,r,o){var i=r.prototype;i.week=function(n){if(void 0===n&&(n=null),null!==n)return this.add(7*(n-this.week()),"day");var r=this.$locale().yearStart||1;if(11===this.month()&&this.date()>25){var i=o(this).startOf(t).add(1,t).date(r),a=o(this).endOf(e);if(i.isBefore(a))return 1}var s=o(this).startOf(t).date(r).startOf(e).subtract(1,"millisecond"),l=this.diff(s,e,!0);return l<0?o(this).startOf("week").week():Math.ceil(l)},i.weeks=function(e){return void 0===e&&(e=null),this.week(e)}}}()},49539:function(e){function t(){}e.exports=function(e,n,r){var o=!1;return r=r||t,i.count=e,0===e?n():i;function i(e,t){if(i.count<=0)throw new Error("after called too many times");--i.count,e?(o=!0,n(e),n=r):0!==i.count||o||n(null,t)}}},95406:function(e){e.exports=function(e,t,n){var r=e.byteLength;if(t=t||0,n=n||r,e.slice)return e.slice(t,n);if(t<0&&(t+=r),n<0&&(n+=r),n>r&&(n=r),t>=r||t>=n||0===r)return new ArrayBuffer(0);for(var o=new Uint8Array(e),i=new Uint8Array(n-t),a=t,s=0;a<n;a++,s++)i[s]=o[a];return i.buffer}},2114:function(e,t,n){"use strict";var r=n(32513),o=[],i=[],a=r.makeRequestCallFromTimer((function(){if(i.length)throw i.shift()}));function s(e){var t;(t=o.length?o.pop():new l).task=e,r(t)}function l(){this.task=null}e.exports=s,l.prototype.call=function(){try{this.task.call()}catch(e){s.onerror?s.onerror(e):(i.push(e),a())}finally{this.task=null,o[o.length]=this}}},32513:function(e,t,n){"use strict";function r(e){i.length||(o(),!0),i[i.length]=e}e.exports=r;var o,i=[],a=0;function s(){for(;a<i.length;){var e=a;if(a+=1,i[e].call(),a>1024){for(var t=0,n=i.length-a;t<n;t++)i[t]=i[t+a];i.length-=a,a=0}}i.length=0,a=0,!1}var l="undefined"!==typeof n.g?n.g:self,c=l.MutationObserver||l.WebKitMutationObserver;function u(e){return function(){var t=setTimeout(r,0),n=setInterval(r,50);function r(){clearTimeout(t),clearInterval(n),e()}}}o="function"===typeof c?function(e){var t=1,n=new c(e),r=document.createTextNode("");return n.observe(r,{characterData:!0}),function(){t=-t,r.data=t}}(s):u(s),r.requestFlush=o,r.makeRequestCallFromTimer=u},64293:function(e){function t(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=t,t.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},t.prototype.reset=function(){this.attempts=0},t.prototype.setMin=function(e){this.ms=e},t.prototype.setMax=function(e){this.max=e},t.prototype.setJitter=function(e){this.jitter=e}},48705:function(e,t){!function(e){"use strict";t.encode=function(t){var n,r=new Uint8Array(t),o=r.length,i="";for(n=0;n<o;n+=3)i+=e[r[n]>>2],i+=e[(3&r[n])<<4|r[n+1]>>4],i+=e[(15&r[n+1])<<2|r[n+2]>>6],i+=e[63&r[n+2]];return o%3===2?i=i.substring(0,i.length-1)+"=":o%3===1&&(i=i.substring(0,i.length-2)+"=="),i},t.decode=function(t){var n,r,o,i,a,s=.75*t.length,l=t.length,c=0;"="===t[t.length-1]&&(s--,"="===t[t.length-2]&&s--);var u=new ArrayBuffer(s),d=new Uint8Array(u);for(n=0;n<l;n+=4)r=e.indexOf(t[n]),o=e.indexOf(t[n+1]),i=e.indexOf(t[n+2]),a=e.indexOf(t[n+3]),d[c++]=r<<2|o>>4,d[c++]=(15&o)<<4|i>>2,d[c++]=(3&i)<<6|63&a;return u}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},4280:function(e){var t="undefined"!==typeof t?t:"undefined"!==typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!==typeof MSBlobBuilder?MSBlobBuilder:"undefined"!==typeof MozBlobBuilder&&MozBlobBuilder,n=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),r=n&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),o=t&&t.prototype.append&&t.prototype.getBlob;function i(e){return e.map((function(e){if(e.buffer instanceof ArrayBuffer){var t=e.buffer;if(e.byteLength!==t.byteLength){var n=new Uint8Array(e.byteLength);n.set(new Uint8Array(t,e.byteOffset,e.byteLength)),t=n.buffer}return t}return e}))}function a(e,n){n=n||{};var r=new t;return i(e).forEach((function(e){r.append(e)})),n.type?r.getBlob(n.type):r.getBlob()}function s(e,t){return new Blob(i(e),t||{})}"undefined"!==typeof Blob&&(a.prototype=Blob.prototype,s.prototype=Blob.prototype),e.exports=n?r?Blob:s:o?a:void 0},1354:function(e){var t=[].slice;e.exports=function(e,n){if("string"==typeof n&&(n=e[n]),"function"!=typeof n)throw new Error("bind() requires a function");var r=t.call(arguments,2);return function(){return n.apply(e,r.concat(t.call(arguments)))}}},19621:function(e){function t(e){if(e)return function(e){for(var n in t.prototype)e[n]=t.prototype[n];return e}(e)}e.exports=t,t.prototype.on=t.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},t.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeAllListeners=t.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var o=0;o<r.length;o++)if((n=r[o])===t||n.fn===t){r.splice(o,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},t.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var o=(n=n.slice(0)).length;r<o;++r)n[r].apply(this,t)}return this},t.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},t.prototype.hasListeners=function(e){return!!this.listeners(e).length}},28960:function(e){e.exports=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},36220:function(e){e.exports=function(){"use strict";var e="minute",t=/[+-]\d\d(?::?\d\d)?/g,n=/([+-]|\d\d)/g;return function(r,o,i){var a=o.prototype;i.utc=function(e){return new o({date:e,utc:!0,args:arguments})},a.utc=function(t){var n=i(this.toDate(),{locale:this.$L,utc:!0});return t?n.add(this.utcOffset(),e):n},a.local=function(){return i(this.toDate(),{locale:this.$L,utc:!1})};var s=a.parse;a.parse=function(e){e.utc&&(this.$u=!0),this.$utils().u(e.$offset)||(this.$offset=e.$offset),s.call(this,e)};var l=a.init;a.init=function(){if(this.$u){var e=this.$d;this.$y=e.getUTCFullYear(),this.$M=e.getUTCMonth(),this.$D=e.getUTCDate(),this.$W=e.getUTCDay(),this.$H=e.getUTCHours(),this.$m=e.getUTCMinutes(),this.$s=e.getUTCSeconds(),this.$ms=e.getUTCMilliseconds()}else l.call(this)};var c=a.utcOffset;a.utcOffset=function(r,o){var i=this.$utils().u;if(i(r))return this.$u?0:i(this.$offset)?c.call(this):this.$offset;if("string"==typeof r&&(r=function(e){void 0===e&&(e="");var r=e.match(t);if(!r)return null;var o=(""+r[0]).match(n)||["-",0,0],i=o[0],a=60*+o[1]+ +o[2];return 0===a?0:"+"===i?a:-a}(r),null===r))return this;var a=Math.abs(r)<=16?60*r:r,s=this;if(o)return s.$offset=a,s.$u=0===r,s;if(0!==r){var l=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(s=this.local().add(a+l,e)).$offset=a,s.$x.$localOffset=l}else s=this.utc();return s};var u=a.format;a.format=function(e){var t=e||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return u.call(this,t)},a.valueOf=function(){var e=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*e},a.isUTC=function(){return!!this.$u},a.toISOString=function(){return this.toDate().toISOString()},a.toString=function(){return this.toDate().toUTCString()};var d=a.toDate;a.toDate=function(e){return"s"===e&&this.$offset?i(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():d.call(this)};var p=a.diff;a.diff=function(e,t,n){if(e&&this.$u===e.$u)return p.call(this,e,t,n);var r=this.local(),o=i(e).local();return p.call(r,o,t,n)}}}()},85505:function(e,t,n){"use strict";t.__esModule=!0;var r,o=n(47416),i=(r=o)&&r.__esModule?r:{default:r},a=function(){function e(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Array.isArray(n[0])&&1===n.length&&(n=n[0]);for(var o=0;o<n.length;o++)if(!i.default(n[o]))throw new Error("Expected a disposable");this.disposables=n,this.isDisposed=!1}return e.prototype.add=function(e){this.isDisposed?e.dispose():this.disposables.push(e)},e.prototype.remove=function(e){if(this.isDisposed)return!1;var t=this.disposables.indexOf(e);return-1!==t&&(this.disposables.splice(t,1),e.dispose(),!0)},e.prototype.dispose=function(){if(!this.isDisposed){for(var e=this.disposables.length,t=new Array(e),n=0;n<e;n++)t[n]=this.disposables[n];this.isDisposed=!0,this.disposables=[],this.length=0;for(n=0;n<e;n++)t[n].dispose()}},e}();t.default=a,e.exports=t.default},58376:function(e,t){"use strict";t.__esModule=!0;var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var r=function(){},o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.isDisposed=!1,this.action=t||r}return n(e,null,[{key:"empty",value:{dispose:r},enumerable:!0}]),e.prototype.dispose=function(){this.isDisposed||(this.action.call(null),this.isDisposed=!0)},e}();t.default=o,e.exports=t.default},47972:function(e,t,n){"use strict";t.__esModule=!0;var r,o=n(47416),i=(r=o)&&r.__esModule?r:{default:r},a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.isDisposed=!1,this.current=null}return e.prototype.getDisposable=function(){return this.current},e.prototype.setDisposable=function(){var e=arguments.length<=0||void 0===arguments[0]?null:arguments[0];if(null!=e&&!i.default(e))throw new Error("Expected either an empty value or a valid disposable");var t=this.isDisposed,n=void 0;t||(n=this.current,this.current=e),n&&n.dispose(),t&&e&&e.dispose()},e.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;var e=this.current;this.current=null,e&&e.dispose()}},e}();t.default=a,e.exports=t.default},86864:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o=r(n(47416));t.isDisposable=o.default;var i=r(n(58376));t.Disposable=i.default;var a=r(n(85505));t.CompositeDisposable=a.default;var s=r(n(47972));t.SerialDisposable=s.default},47416:function(e,t){"use strict";t.__esModule=!0,t.default=function(e){return Boolean(e&&"function"===typeof e.dispose)},e.exports=t.default},91451:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=l(n(79514)),i=l(n(21615)),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(11702)),s=l(n(45426));function l(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var r=(0,o.default)(i.default);this.context=n,this.store=r,this.monitor=new s.default(r),this.registry=this.monitor.registry,this.backend=t(this),r.subscribe(this.handleRefCountChange.bind(this))}return r(e,[{key:"handleRefCountChange",value:function(){var e=this.store.getState().refCount>0;e&&!this.isSetUp?(this.backend.setup(),this.isSetUp=!0):!e&&this.isSetUp&&(this.backend.teardown(),this.isSetUp=!1)}},{key:"getContext",value:function(){return this.context}},{key:"getMonitor",value:function(){return this.monitor}},{key:"getBackend",value:function(){return this.backend}},{key:"getRegistry",value:function(){return this.registry}},{key:"getActions",value:function(){var e=this,t=this.store.dispatch;return Object.keys(a).filter((function(e){return"function"===typeof a[e]})).reduce((function(n,r){var o,i=a[r];return n[r]=(o=i,function(){for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];var a=o.apply(e,r);"undefined"!==typeof a&&t(a)}),n}),{})}}]),e}();t.default=c},45426:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=u(n(10949)),i=u(n(12279)),a=u(n(93482)),s=u(n(85710)),l=n(12482),c=n(64669);function u(e){return e&&e.__esModule?e:{default:e}}var d=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=t,this.registry=new s.default(t)}return r(e,[{key:"subscribeToStateChange",value:function(e){var t=this,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).handlerIds;(0,o.default)("function"===typeof e,"listener must be a function."),(0,o.default)("undefined"===typeof n||(0,i.default)(n),"handlerIds, when specified, must be an array of strings.");var r=this.store.getState().stateId;return this.store.subscribe((function(){var o=t.store.getState(),i=o.stateId;try{i===r||i===r+1&&!(0,c.areDirty)(o.dirtyHandlerIds,n)||e()}finally{r=i}}))}},{key:"subscribeToOffsetChange",value:function(e){var t=this;(0,o.default)("function"===typeof e,"listener must be a function.");var n=this.store.getState().dragOffset;return this.store.subscribe((function(){var r=t.store.getState().dragOffset;r!==n&&(n=r,e())}))}},{key:"canDragSource",value:function(e){var t=this.registry.getSource(e);return(0,o.default)(t,"Expected to find a valid source."),!this.isDragging()&&t.canDrag(this,e)}},{key:"canDropOnTarget",value:function(e){var t=this.registry.getTarget(e);if((0,o.default)(t,"Expected to find a valid target."),!this.isDragging()||this.didDrop())return!1;var n=this.registry.getTargetType(e),r=this.getItemType();return(0,a.default)(n,r)&&t.canDrop(this,e)}},{key:"isDragging",value:function(){return Boolean(this.getItemType())}},{key:"isDraggingSource",value:function(e){var t=this.registry.getSource(e,!0);return(0,o.default)(t,"Expected to find a valid source."),!(!this.isDragging()||!this.isSourcePublic())&&(this.registry.getSourceType(e)===this.getItemType()&&t.isDragging(this,e))}},{key:"isOverTarget",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shallow:!1}).shallow;if(!this.isDragging())return!1;var n=this.registry.getTargetType(e),r=this.getItemType();if(!(0,a.default)(n,r))return!1;var o=this.getTargetIds();if(!o.length)return!1;var i=o.indexOf(e);return t?i===o.length-1:i>-1}},{key:"getItemType",value:function(){return this.store.getState().dragOperation.itemType}},{key:"getItem",value:function(){return this.store.getState().dragOperation.item}},{key:"getSourceId",value:function(){return this.store.getState().dragOperation.sourceId}},{key:"getTargetIds",value:function(){return this.store.getState().dragOperation.targetIds}},{key:"getDropResult",value:function(){return this.store.getState().dragOperation.dropResult}},{key:"didDrop",value:function(){return this.store.getState().dragOperation.didDrop}},{key:"isSourcePublic",value:function(){return this.store.getState().dragOperation.isSourcePublic}},{key:"getInitialClientOffset",value:function(){return this.store.getState().dragOffset.initialClientOffset}},{key:"getInitialSourceClientOffset",value:function(){return this.store.getState().dragOffset.initialSourceClientOffset}},{key:"getClientOffset",value:function(){return this.store.getState().dragOffset.clientOffset}},{key:"getSourceClientOffset",value:function(){return(0,l.getSourceClientOffset)(this.store.getState().dragOffset)}},{key:"getDifferenceFromInitialOffset",value:function(){return(0,l.getDifferenceFromInitialOffset)(this.store.getState().dragOffset)}}]),e}();t.default=d},28838:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return n(e,[{key:"canDrag",value:function(){return!0}},{key:"isDragging",value:function(e,t){return t===e.getSourceId()}},{key:"endDrag",value:function(){}}]),e}();t.default=r},93057:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return n(e,[{key:"canDrop",value:function(){return!0}},{key:"hover",value:function(){}},{key:"drop",value:function(){}}]),e}();t.default=r},85710:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=u(n(10949)),a=u(n(12279)),s=u(n(2114)),l=n(71558),c=u(n(42660));function u(e){return e&&e.__esModule?e:{default:e}}var d="SOURCE",p="TARGET";function h(e,t){t&&(0,a.default)(e)?e.forEach((function(e){return h(e,!1)})):(0,i.default)("string"===typeof e||"symbol"===("undefined"===typeof e?"undefined":o(e)),t?"Type can only be a string, a symbol, or an array of either.":"Type can only be a string or a symbol.")}function f(e){switch(e[0]){case"S":return d;case"T":return p;default:(0,i.default)(!1,"Cannot parse handler ID: "+e)}}var m=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=t,this.types={},this.handlers={},this.pinnedSourceId=null,this.pinnedSource=null}return r(e,[{key:"addSource",value:function(e,t){h(e),function(e){(0,i.default)("function"===typeof e.canDrag,"Expected canDrag to be a function."),(0,i.default)("function"===typeof e.beginDrag,"Expected beginDrag to be a function."),(0,i.default)("function"===typeof e.endDrag,"Expected endDrag to be a function.")}(t);var n=this.addHandler(d,e,t);return this.store.dispatch((0,l.addSource)(n)),n}},{key:"addTarget",value:function(e,t){h(e,!0),function(e){(0,i.default)("function"===typeof e.canDrop,"Expected canDrop to be a function."),(0,i.default)("function"===typeof e.hover,"Expected hover to be a function."),(0,i.default)("function"===typeof e.drop,"Expected beginDrag to be a function.")}(t);var n=this.addHandler(p,e,t);return this.store.dispatch((0,l.addTarget)(n)),n}},{key:"addHandler",value:function(e,t,n){var r=function(e){var t=(0,c.default)().toString();switch(e){case d:return"S"+t;case p:return"T"+t;default:(0,i.default)(!1,"Unknown role: "+e)}}(e);return this.types[r]=t,this.handlers[r]=n,r}},{key:"containsHandler",value:function(e){var t=this;return Object.keys(this.handlers).some((function(n){return t.handlers[n]===e}))}},{key:"getSource",value:function(e,t){return(0,i.default)(this.isSourceId(e),"Expected a valid source ID."),t&&e===this.pinnedSourceId?this.pinnedSource:this.handlers[e]}},{key:"getTarget",value:function(e){return(0,i.default)(this.isTargetId(e),"Expected a valid target ID."),this.handlers[e]}},{key:"getSourceType",value:function(e){return(0,i.default)(this.isSourceId(e),"Expected a valid source ID."),this.types[e]}},{key:"getTargetType",value:function(e){return(0,i.default)(this.isTargetId(e),"Expected a valid target ID."),this.types[e]}},{key:"isSourceId",value:function(e){return f(e)===d}},{key:"isTargetId",value:function(e){return f(e)===p}},{key:"removeSource",value:function(e){var t=this;(0,i.default)(this.getSource(e),"Expected an existing source."),this.store.dispatch((0,l.removeSource)(e)),(0,s.default)((function(){delete t.handlers[e],delete t.types[e]}))}},{key:"removeTarget",value:function(e){var t=this;(0,i.default)(this.getTarget(e),"Expected an existing target."),this.store.dispatch((0,l.removeTarget)(e)),(0,s.default)((function(){delete t.handlers[e],delete t.types[e]}))}},{key:"pinSource",value:function(e){var t=this.getSource(e);(0,i.default)(t,"Expected an existing source."),this.pinnedSourceId=e,this.pinnedSource=t}},{key:"unpinSource",value:function(){(0,i.default)(this.pinnedSource,"No source is pinned at the time."),this.pinnedSourceId=null,this.pinnedSource=null}}]),e}();t.default=m},11702:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.END_DRAG=t.DROP=t.HOVER=t.PUBLISH_DRAG_SOURCE=t.BEGIN_DRAG=void 0;var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.beginDrag=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{publishSource:!0,clientOffset:null},n=t.publishSource,r=t.clientOffset,s=t.getSourceClientOffset;(0,o.default)((0,i.default)(e),"Expected sourceIds to be an array.");var l=this.getMonitor(),u=this.getRegistry();(0,o.default)(!l.isDragging(),"Cannot call beginDrag while dragging.");for(var d=0;d<e.length;d++)(0,o.default)(u.getSource(e[d]),"Expected sourceIds to be registered.");for(var p=null,h=e.length-1;h>=0;h--)if(l.canDragSource(e[h])){p=e[h];break}if(null===p)return;var f=null;r&&((0,o.default)("function"===typeof s,"When clientOffset is provided, getSourceClientOffset must be a function."),f=s(p));var m=u.getSource(p).beginDrag(l,p);(0,o.default)((0,a.default)(m),"Item must be an object."),u.pinSource(p);var g=u.getSourceType(p);return{type:c,itemType:g,item:m,sourceId:p,clientOffset:r,sourceClientOffset:f,isSourcePublic:n}},t.publishDragSource=function(){if(!this.getMonitor().isDragging())return;return{type:u}},t.hover=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.clientOffset,r=void 0===n?null:n;(0,o.default)((0,i.default)(e),"Expected targetIds to be an array.");var a=e.slice(0),l=this.getMonitor(),c=this.getRegistry();(0,o.default)(l.isDragging(),"Cannot call hover while not dragging."),(0,o.default)(!l.didDrop(),"Cannot call hover after drop.");for(var u=0;u<a.length;u++){var p=a[u];(0,o.default)(a.lastIndexOf(p)===u,"Expected targetIds to be unique in the passed array.");var h=c.getTarget(p);(0,o.default)(h,"Expected targetIds to be registered.")}for(var f=l.getItemType(),m=a.length-1;m>=0;m--){var g=a[m],v=c.getTargetType(g);(0,s.default)(v,f)||a.splice(m,1)}for(var y=0;y<a.length;y++){var x=a[y];c.getTarget(x).hover(l,x)}return{type:d,targetIds:a,clientOffset:r}},t.drop=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.getMonitor(),i=this.getRegistry();(0,o.default)(n.isDragging(),"Cannot call drop while not dragging."),(0,o.default)(!n.didDrop(),"Cannot call drop twice during one drag operation.");var s=n.getTargetIds().filter(n.canDropOnTarget,n);s.reverse(),s.forEach((function(s,l){var c=i.getTarget(s).drop(n,s);(0,o.default)("undefined"===typeof c||(0,a.default)(c),"Drop result must either be an object or undefined."),"undefined"===typeof c&&(c=0===l?{}:n.getDropResult()),e.store.dispatch({type:p,dropResult:r({},t,c)})}))},t.endDrag=function(){var e=this.getMonitor(),t=this.getRegistry();(0,o.default)(e.isDragging(),"Cannot call endDrag while not dragging.");var n=e.getSourceId();return t.getSource(n,true).endDrag(e,n),t.unpinSource(),{type:h}};var o=l(n(10949)),i=l(n(12279)),a=l(n(24567)),s=l(n(93482));function l(e){return e&&e.__esModule?e:{default:e}}var c=t.BEGIN_DRAG="dnd-core/BEGIN_DRAG",u=t.PUBLISH_DRAG_SOURCE="dnd-core/PUBLISH_DRAG_SOURCE",d=t.HOVER="dnd-core/HOVER",p=t.DROP="dnd-core/DROP",h=t.END_DRAG="dnd-core/END_DRAG"},71558:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addSource=function(e){return{type:n,sourceId:e}},t.addTarget=function(e){return{type:r,targetId:e}},t.removeSource=function(e){return{type:o,sourceId:e}},t.removeTarget=function(e){return{type:i,targetId:e}};var n=t.ADD_SOURCE="dnd-core/ADD_SOURCE",r=t.ADD_TARGET="dnd-core/ADD_TARGET",o=t.REMOVE_SOURCE="dnd-core/REMOVE_SOURCE",i=t.REMOVE_TARGET="dnd-core/REMOVE_TARGET"},43003:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.default=function(e){return new s(e)};var o,i=n(19208),a=(o=i)&&o.__esModule?o:{default:o};var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.actions=t.getActions()}return r(e,[{key:"setup",value:function(){this.didCallSetup=!0}},{key:"teardown",value:function(){this.didCallTeardown=!0}},{key:"connectDragSource",value:function(){return a.default}},{key:"connectDragPreview",value:function(){return a.default}},{key:"connectDropTarget",value:function(){return a.default}},{key:"simulateBeginDrag",value:function(e,t){this.actions.beginDrag(e,t)}},{key:"simulatePublishDragSource",value:function(){this.actions.publishDragSource()}},{key:"simulateHover",value:function(e,t){this.actions.hover(e,t)}},{key:"simulateDrop",value:function(){this.actions.drop()}},{key:"simulateEndDrag",value:function(){this.actions.endDrag()}}]),e}()},49461:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(91451);Object.defineProperty(t,"DragDropManager",{enumerable:!0,get:function(){return s(r).default}});var o=n(28838);Object.defineProperty(t,"DragSource",{enumerable:!0,get:function(){return s(o).default}});var i=n(93057);Object.defineProperty(t,"DropTarget",{enumerable:!0,get:function(){return s(i).default}});var a=n(43003);function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"createTestBackend",{enumerable:!0,get:function(){return s(a).default}})},64669:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=arguments[1],t=arguments[2];switch(e.type){case i.HOVER:break;case a.ADD_SOURCE:case a.ADD_TARGET:case a.REMOVE_TARGET:case a.REMOVE_SOURCE:return l;case i.BEGIN_DRAG:case i.PUBLISH_DRAG_SOURCE:case i.END_DRAG:case i.DROP:default:return c}var n=e.targetIds,o=t.targetIds,s=(0,r.default)(n,o),u=!1;if(0===s.length){for(var d=0;d<n.length;d++)if(n[d]!==o[d]){u=!0;break}}else u=!0;if(!u)return l;var p=o[o.length-1],h=n[n.length-1];p!==h&&(p&&s.push(p),h&&s.push(h));return s},t.areDirty=function(e,t){if(e===l)return!1;if(e===c||"undefined"===typeof t)return!0;return(0,o.default)(t,e).length>0};var r=s(n(73747)),o=s(n(92437)),i=n(11702),a=n(71558);function s(e){return e&&e.__esModule?e:{default:e}}var l=[],c=[]},12482:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,t=arguments[1];switch(t.type){case o.BEGIN_DRAG:return{initialSourceClientOffset:t.sourceClientOffset,initialClientOffset:t.clientOffset,clientOffset:t.clientOffset};case o.HOVER:return function(e,t){if(e===t)return!0;return e&&t&&e.x===t.x&&e.y===t.y}(e.clientOffset,t.clientOffset)?e:r({},e,{clientOffset:t.clientOffset});case o.END_DRAG:case o.DROP:return i;default:return e}},t.getSourceClientOffset=function(e){var t=e.clientOffset,n=e.initialClientOffset,r=e.initialSourceClientOffset;if(!t||!n||!r)return null;return{x:t.x+r.x-n.x,y:t.y+r.y-n.y}},t.getDifferenceFromInitialOffset=function(e){var t=e.clientOffset,n=e.initialClientOffset;if(!t||!n)return null;return{x:t.x-n.x,y:t.y-n.y}};var o=n(11702),i={initialSourceClientOffset:null,initialClientOffset:null,clientOffset:null}},26688:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,t=arguments[1];switch(t.type){case s.BEGIN_DRAG:return r({},e,{itemType:t.itemType,item:t.item,sourceId:t.sourceId,isSourcePublic:t.isSourcePublic,dropResult:null,didDrop:!1});case s.PUBLISH_DRAG_SOURCE:return r({},e,{isSourcePublic:!0});case s.HOVER:return r({},e,{targetIds:t.targetIds});case l.REMOVE_TARGET:return-1===e.targetIds.indexOf(t.targetId)?e:r({},e,{targetIds:(0,a.default)(e.targetIds,t.targetId)});case s.DROP:return r({},e,{dropResult:t.dropResult,didDrop:!0,targetIds:[]});case s.END_DRAG:return r({},e,{itemType:null,item:null,sourceId:null,dropResult:null,didDrop:!1,isSourcePublic:null,targetIds:[]});default:return e}};var o,i=n(74650),a=(o=i)&&o.__esModule?o:{default:o},s=n(11702),l=n(71558);var c={itemType:null,item:null,sourceId:null,targetIds:[],dropResult:null,didDrop:!1,isSourcePublic:null}},21615:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];return{dirtyHandlerIds:(0,a.default)(e.dirtyHandlerIds,t,e.dragOperation),dragOffset:(0,r.default)(e.dragOffset,t),refCount:(0,i.default)(e.refCount,t),dragOperation:(0,o.default)(e.dragOperation,t),stateId:(0,s.default)(e.stateId)}};var r=l(n(12482)),o=l(n(26688)),i=l(n(4943)),a=l(n(64669)),s=l(n(78571));function l(e){return e&&e.__esModule?e:{default:e}}},4943:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;switch(arguments[1].type){case r.ADD_SOURCE:case r.ADD_TARGET:return e+1;case r.REMOVE_SOURCE:case r.REMOVE_TARGET:return e-1;default:return e}};var r=n(71558)},78571:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e+1}},42660:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return n++};var n=0},93482:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return(0,i.default)(e)?e.some((function(e){return e===t})):e===t};var r,o=n(12279),i=(r=o)&&r.__esModule?r:{default:r}},1382:function(e){e.exports="undefined"!==typeof self?self:"undefined"!==typeof window?window:Function("return this")()},88127:function(e,t,n){e.exports=n(20414),e.exports.parser=n(27867)},20414:function(e,t,n){var r=n(1162),o=n(19621),i=n(92775)("engine.io-client:socket"),a=n(95896),s=n(27867),l=n(20204),c=n(71914);function u(e,t){if(!(this instanceof u))return new u(e,t);t=t||{},e&&"object"===typeof e&&(t=e,e=null),e?(e=l(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=l(t.host).host),this.secure=null!=t.secure?t.secure:"undefined"!==typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.agent=t.agent||!1,this.hostname=t.hostname||("undefined"!==typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!==typeof location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"===typeof this.query&&(this.query=c.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.withCredentials=!1!==t.withCredentials,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.transportOptions=t.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.perMessageDeflate=!1!==t.perMessageDeflate&&(t.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=t.pfx||void 0,this.key=t.key||void 0,this.passphrase=t.passphrase||void 0,this.cert=t.cert||void 0,this.ca=t.ca||void 0,this.ciphers=t.ciphers||void 0,this.rejectUnauthorized=void 0===t.rejectUnauthorized||t.rejectUnauthorized,this.forceNode=!!t.forceNode,this.isReactNative="undefined"!==typeof navigator&&"string"===typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),("undefined"===typeof self||this.isReactNative)&&(t.extraHeaders&&Object.keys(t.extraHeaders).length>0&&(this.extraHeaders=t.extraHeaders),t.localAddress&&(this.localAddress=t.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}e.exports=u,u.priorWebsocketSuccess=!1,o(u.prototype),u.protocol=s.protocol,u.Socket=u,u.Transport=n(44882),u.transports=n(1162),u.parser=n(27867),u.prototype.createTransport=function(e){i('creating transport "%s"',e);var t=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}(this.query);t.EIO=s.protocol,t.transport=e;var n=this.transportOptions[e]||{};return this.id&&(t.sid=this.id),new r[e]({query:t,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,withCredentials:n.withCredentials||this.withCredentials,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0,isReactNative:this.isReactNative})},u.prototype.open=function(){var e;if(this.rememberUpgrade&&u.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout((function(){t.emit("error","No transports available")}),0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(n){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},u.prototype.setTransport=function(e){i("setting transport %s",e.name);var t=this;this.transport&&(i("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",(function(){t.onDrain()})).on("packet",(function(e){t.onPacket(e)})).on("error",(function(e){t.onError(e)})).on("close",(function(){t.onClose("transport close")}))},u.prototype.probe=function(e){i('probing transport "%s"',e);var t=this.createTransport(e,{probe:1}),n=!1,r=this;function o(){if(r.onlyBinaryUpgrades){var o=!this.supportsBinary&&r.transport.supportsBinary;n=n||o}n||(i('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",(function(o){if(!n)if("pong"===o.type&&"probe"===o.data){if(i('probe transport "%s" pong',e),r.upgrading=!0,r.emit("upgrading",t),!t)return;u.priorWebsocketSuccess="websocket"===t.name,i('pausing current transport "%s"',r.transport.name),r.transport.pause((function(){n||"closed"!==r.readyState&&(i("changing transport and sending upgrade packet"),p(),r.setTransport(t),t.send([{type:"upgrade"}]),r.emit("upgrade",t),t=null,r.upgrading=!1,r.flush())}))}else{i('probe transport "%s" failed',e);var a=new Error("probe error");a.transport=t.name,r.emit("upgradeError",a)}})))}function a(){n||(n=!0,p(),t.close(),t=null)}function s(n){var o=new Error("probe error: "+n);o.transport=t.name,a(),i('probe transport "%s" failed because of error: %s',e,n),r.emit("upgradeError",o)}function l(){s("transport closed")}function c(){s("socket closed")}function d(e){t&&e.name!==t.name&&(i('"%s" works - aborting "%s"',e.name,t.name),a())}function p(){t.removeListener("open",o),t.removeListener("error",s),t.removeListener("close",l),r.removeListener("close",c),r.removeListener("upgrading",d)}u.priorWebsocketSuccess=!1,t.once("open",o),t.once("error",s),t.once("close",l),this.once("close",c),this.once("upgrading",d),t.open()},u.prototype.onOpen=function(){if(i("socket open"),this.readyState="open",u.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){i("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},u.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(i('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else i('packet received with socket readyState "%s"',this.readyState)},u.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},u.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout((function(){"closed"!==t.readyState&&t.onClose("ping timeout")}),e||t.pingInterval+t.pingTimeout)},u.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout((function(){i("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)}),e.pingInterval)},u.prototype.ping=function(){var e=this;this.sendPacket("ping",(function(){e.emit("ping")}))},u.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},u.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(i("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},u.prototype.write=u.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},u.prototype.sendPacket=function(e,t,n,r){if("function"===typeof t&&(r=t,t=void 0),"function"===typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var o={type:e,data:t,options:n};this.emit("packetCreate",o),this.writeBuffer.push(o),r&&this.once("flush",r),this.flush()}},u.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var e=this;this.writeBuffer.length?this.once("drain",(function(){this.upgrading?r():t()})):this.upgrading?r():t()}function t(){e.onClose("forced close"),i("socket closing - telling transport to close"),e.transport.close()}function n(){e.removeListener("upgrade",n),e.removeListener("upgradeError",n),t()}function r(){e.once("upgrade",n),e.once("upgradeError",n)}return this},u.prototype.onError=function(e){i("socket error %j",e),u.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},u.prototype.onClose=function(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){i('socket close with reason: "%s"',e);clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0}},u.prototype.filterUpgrades=function(e){for(var t=[],n=0,r=e.length;n<r;n++)~a(this.transports,e[n])&&t.push(e[n]);return t}},44882:function(e,t,n){var r=n(27867),o=n(19621);function i(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.withCredentials=e.withCredentials,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.isReactNative=e.isReactNative,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}e.exports=i,o(i.prototype),i.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},i.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},i.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},i.prototype.send=function(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)},i.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},i.prototype.onData=function(e){var t=r.decodePacket(e,this.socket.binaryType);this.onPacket(t)},i.prototype.onPacket=function(e){this.emit("packet",e)},i.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},1162:function(e,t,n){var r=n(38532),o=n(55154),i=n(83526),a=n(9173);t.polling=function(e){var t=!1,n=!1,a=!1!==e.jsonp;if("undefined"!==typeof location){var s="https:"===location.protocol,l=location.port;l||(l=s?443:80),t=e.hostname!==location.hostname||l!==e.port,n=e.secure!==s}if(e.xdomain=t,e.xscheme=n,"open"in new r(e)&&!e.forceJSONP)return new o(e);if(!a)throw new Error("JSONP disabled");return new i(e)},t.websocket=a},83526:function(e,t,n){var r=n(28241),o=n(28960),i=n(1382);e.exports=u;var a,s=/\n/g,l=/\\n/g;function c(){}function u(e){r.call(this,e),this.query=this.query||{},a||(a=i.___eio=i.___eio||[]),this.index=a.length;var t=this;a.push((function(e){t.onData(e)})),this.query.j=this.index,"function"===typeof addEventListener&&addEventListener("beforeunload",(function(){t.script&&(t.script.onerror=c)}),!1)}o(u,r),u.prototype.supportsBinary=!1,u.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),r.prototype.doClose.call(this)},u.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(t,n):(document.head||document.body).appendChild(t),this.script=t,"undefined"!==typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout((function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)}),100)},u.prototype.doWrite=function(e,t){var n=this;if(!this.form){var r,o=document.createElement("form"),i=document.createElement("textarea"),a=this.iframeId="eio_iframe_"+this.index;o.className="socketio",o.style.position="absolute",o.style.top="-1000px",o.style.left="-1000px",o.target=a,o.method="POST",o.setAttribute("accept-charset","utf-8"),i.name="d",o.appendChild(i),document.body.appendChild(o),this.form=o,this.area=i}function c(){u(),t()}function u(){if(n.iframe)try{n.form.removeChild(n.iframe)}catch(t){n.onError("jsonp polling iframe removal error",t)}try{var e='<iframe src="javascript:0" name="'+n.iframeId+'">';r=document.createElement(e)}catch(t){(r=document.createElement("iframe")).name=n.iframeId,r.src="javascript:0"}r.id=n.iframeId,n.form.appendChild(r),n.iframe=r}this.form.action=this.uri(),u(),e=e.replace(l,"\\\n"),this.area.value=e.replace(s,"\\n");try{this.form.submit()}catch(d){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===n.iframe.readyState&&c()}:this.iframe.onload=c}},55154:function(e,t,n){var r=n(38532),o=n(28241),i=n(19621),a=n(28960),s=n(92775)("engine.io-client:polling-xhr"),l=n(1382);function c(){}function u(e){if(o.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,"undefined"!==typeof location){var t="https:"===location.protocol,n=location.port;n||(n=t?443:80),this.xd="undefined"!==typeof location&&e.hostname!==location.hostname||n!==e.port,this.xs=e.secure!==t}}function d(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.withCredentials=e.withCredentials,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}if(e.exports=u,e.exports.Request=d,a(u,o),u.prototype.supportsBinary=!0,u.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.withCredentials=this.withCredentials,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new d(e)},u.prototype.doWrite=function(e,t){var n="string"!==typeof e&&void 0!==e,r=this.request({method:"POST",data:e,isBinary:n}),o=this;r.on("success",t),r.on("error",(function(e){o.onError("xhr post error",e)})),this.sendXhr=r},u.prototype.doPoll=function(){s("xhr poll");var e=this.request(),t=this;e.on("data",(function(e){t.onData(e)})),e.on("error",(function(e){t.onError("xhr poll error",e)})),this.pollXhr=e},i(d.prototype),d.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new r(e),n=this;try{s("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var o in t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(o)&&t.setRequestHeader(o,this.extraHeaders[o])}catch(i){}if("POST"===this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(i){}try{t.setRequestHeader("Accept","*/*")}catch(i){}"withCredentials"in t&&(t.withCredentials=this.withCredentials),this.requestTimeout&&(t.timeout=this.requestTimeout),this.hasXDR()?(t.onload=function(){n.onLoad()},t.onerror=function(){n.onError(t.responseText)}):t.onreadystatechange=function(){if(2===t.readyState)try{var e=t.getResponseHeader("Content-Type");(n.supportsBinary&&"application/octet-stream"===e||"application/octet-stream; charset=UTF-8"===e)&&(t.responseType="arraybuffer")}catch(i){}4===t.readyState&&(200===t.status||1223===t.status?n.onLoad():setTimeout((function(){n.onError("number"===typeof t.status?t.status:0)}),0))},s("xhr data %s",this.data),t.send(this.data)}catch(i){return void setTimeout((function(){n.onError(i)}),0)}"undefined"!==typeof document&&(this.index=d.requestsCount++,d.requests[this.index]=this)},d.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},d.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},d.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},d.prototype.cleanup=function(e){if("undefined"!==typeof this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=c:this.xhr.onreadystatechange=c,e)try{this.xhr.abort()}catch(t){}"undefined"!==typeof document&&delete d.requests[this.index],this.xhr=null}},d.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type")}catch(n){}e=("application/octet-stream"===t||"application/octet-stream; charset=UTF-8"===t)&&this.xhr.response||this.xhr.responseText}catch(n){this.onError(n)}null!=e&&this.onData(e)},d.prototype.hasXDR=function(){return"undefined"!==typeof XDomainRequest&&!this.xs&&this.enablesXDR},d.prototype.abort=function(){this.cleanup()},d.requestsCount=0,d.requests={},"undefined"!==typeof document)if("function"===typeof attachEvent)attachEvent("onunload",p);else if("function"===typeof addEventListener){addEventListener("onpagehide"in l?"pagehide":"unload",p,!1)}function p(){for(var e in d.requests)d.requests.hasOwnProperty(e)&&d.requests[e].abort()}},28241:function(e,t,n){var r=n(44882),o=n(71914),i=n(27867),a=n(28960),s=n(7479),l=n(92775)("engine.io-client:polling");e.exports=u;var c=null!=new(n(38532))({xdomain:!1}).responseType;function u(e){var t=e&&e.forceBase64;c&&!t||(this.supportsBinary=!1),r.call(this,e)}a(u,r),u.prototype.name="polling",u.prototype.doOpen=function(){this.poll()},u.prototype.pause=function(e){var t=this;function n(){l("paused"),t.readyState="paused",e()}if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(l("we are currently polling - waiting to pause"),r++,this.once("pollComplete",(function(){l("pre-pause polling complete"),--r||n()}))),this.writable||(l("we are currently writing - waiting to pause"),r++,this.once("drain",(function(){l("pre-pause writing complete"),--r||n()})))}else n()},u.prototype.poll=function(){l("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},u.prototype.onData=function(e){var t=this;l("polling got data %s",e);i.decodePayload(e,this.socket.binaryType,(function(e,n,r){if("opening"===t.readyState&&"open"===e.type&&t.onOpen(),"close"===e.type)return t.onClose(),!1;t.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():l('ignoring poll - transport state "%s"',this.readyState))},u.prototype.doClose=function(){var e=this;function t(){l("writing close packet"),e.write([{type:"close"}])}"open"===this.readyState?(l("transport open - closing"),t()):(l("transport not open - deferring close"),this.once("open",t))},u.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")};i.encodePayload(e,this.supportsBinary,(function(e){t.doWrite(e,n)}))},u.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(e[this.timestampParam]=s()),this.supportsBinary||e.sid||(e.b64=1),e=o.encode(e),this.port&&("https"===t&&443!==Number(this.port)||"http"===t&&80!==Number(this.port))&&(n=":"+this.port),e.length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e}},9173:function(e,t,n){var r,o,i=n(93325).hp,a=n(44882),s=n(27867),l=n(71914),c=n(28960),u=n(7479),d=n(92775)("engine.io-client:websocket");if("undefined"!==typeof WebSocket?r=WebSocket:"undefined"!==typeof self&&(r=self.WebSocket||self.MozWebSocket),"undefined"===typeof window)try{o=n(25660)}catch(f){}var p=r||o;function h(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=r&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(p=o),a.call(this,e)}e.exports=h,c(h,a),h.prototype.name="websocket",h.prototype.supportsBinary=!0,h.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,n={};this.isReactNative||(n.agent=this.agent,n.perMessageDeflate=this.perMessageDeflate,n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized),this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?t?new p(e,t):new p(e):new p(e,t,n)}catch(r){return this.emit("error",r)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},h.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},h.prototype.write=function(e){var t=this;this.writable=!1;for(var n=e.length,r=0,o=n;r<o;r++)!function(e){s.encodePacket(e,t.supportsBinary,(function(r){if(!t.usingBrowserWebSocket){var o={};if(e.options&&(o.compress=e.options.compress),t.perMessageDeflate)("string"===typeof r?i.byteLength(r):r.length)<t.perMessageDeflate.threshold&&(o.compress=!1)}try{t.usingBrowserWebSocket?t.ws.send(r):t.ws.send(r,o)}catch(f){d("websocket closed before onclose event")}--n||a()}))}(e[r]);function a(){t.emit("flush"),setTimeout((function(){t.writable=!0,t.emit("drain")}),0)}},h.prototype.onClose=function(){a.prototype.onClose.call(this)},h.prototype.doClose=function(){"undefined"!==typeof this.ws&&this.ws.close()},h.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"===t&&443!==Number(this.port)||"ws"===t&&80!==Number(this.port))&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=u()),this.supportsBinary||(e.b64=1),(e=l.encode(e)).length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e},h.prototype.check=function(){return!!p&&!("__initialize"in p&&this.name===h.prototype.name)}},38532:function(e,t,n){var r=n(15913),o=n(1382);e.exports=function(e){var t=e.xdomain,n=e.xscheme,i=e.enablesXDR;try{if("undefined"!==typeof XMLHttpRequest&&(!t||r))return new XMLHttpRequest}catch(a){}try{if("undefined"!==typeof XDomainRequest&&!n&&i)return new XDomainRequest}catch(a){}if(!t)try{return new(o[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(a){}}},92775:function(e,t,n){var r=n(85224);function o(){var e;try{e=t.storage.debug}catch(n){}return!e&&"undefined"!==typeof r&&"env"in r&&(e={NODE_ENV:"production",PUBLIC_URL:"http://0.0.0.0:3000/assets/bundles",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.DEBUG),e}(t=e.exports=n(49980)).log=function(){return"object"===typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return;var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var o=0,i=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(o++,"%c"===e&&(i=o))})),e.splice(i,0,r)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(n){}},t.load=o,t.useColors=function(){if("undefined"!==typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},t.enable(o())},49980:function(e,t,n){function r(e){var n;function r(){if(r.enabled){var e=r,o=+new Date,i=o-(n||o);e.diff=i,e.prev=n,e.curr=o,n=o;for(var a=new Array(arguments.length),s=0;s<a.length;s++)a[s]=arguments[s];a[0]=t.coerce(a[0]),"string"!==typeof a[0]&&a.unshift("%O");var l=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,(function(n,r){if("%%"===n)return n;l++;var o=t.formatters[r];if("function"===typeof o){var i=a[l];n=o.call(e,i),a.splice(l,1),l--}return n})),t.formatArgs.call(e,a),(r.log||t.log||console.log.bind(console)).apply(e,a)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=function(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}(e),r.destroy=o,"function"===typeof t.init&&t.init(r),t.instances.push(r),r}function o(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var n;t.save(e),t.names=[],t.skips=[];var r=("string"===typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var i=t.instances[n];i.enabled=t.enabled(i.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(55387),t.instances=[],t.names=[],t.skips=[],t.formatters={}},55387:function(e){var t=1e3,n=60*t,r=60*n,o=24*r,i=365.25*o;function a(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}e.exports=function(e,s){s=s||{};var l,c=typeof e;if("string"===c&&e.length>0)return function(e){if((e=String(e)).length>100)return;var a=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!a)return;var s=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return s*i;case"days":case"day":case"d":return s*o;case"hours":case"hour":case"hrs":case"hr":case"h":return s*r;case"minutes":case"minute":case"mins":case"min":case"m":return s*n;case"seconds":case"second":case"secs":case"sec":case"s":return s*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}(e);if("number"===c&&!1===isNaN(e))return s.long?a(l=e,o,"day")||a(l,r,"hour")||a(l,n,"minute")||a(l,t,"second")||l+" ms":function(e){if(e>=o)return Math.round(e/o)+"d";if(e>=r)return Math.round(e/r)+"h";if(e>=n)return Math.round(e/n)+"m";if(e>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},27867:function(e,t,n){var r,o=n(463),i=n(69349),a=n(95406),s=n(49539),l=n(91640);"undefined"!==typeof ArrayBuffer&&(r=n(48705));var c="undefined"!==typeof navigator&&/Android/i.test(navigator.userAgent),u="undefined"!==typeof navigator&&/PhantomJS/i.test(navigator.userAgent),d=c||u;t.protocol=3;var p=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},h=o(p),f={type:"error",data:"parser error"},m=n(4280);function g(e,t,n){for(var r=new Array(e.length),o=s(e.length,n),i=function(e,n,o){t(n,(function(t,n){r[e]=n,o(t,r)}))},a=0;a<e.length;a++)i(a,e[a],o)}t.encodePacket=function(e,n,r,o){"function"===typeof n&&(o=n,n=!1),"function"===typeof r&&(o=r,r=null);var i=void 0===e.data?void 0:e.data.buffer||e.data;if("undefined"!==typeof ArrayBuffer&&i instanceof ArrayBuffer)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var o=e.data,i=new Uint8Array(o),a=new Uint8Array(1+o.byteLength);a[0]=p[e.type];for(var s=0;s<i.length;s++)a[s+1]=i[s];return r(a.buffer)}(e,n,o);if("undefined"!==typeof m&&i instanceof m)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);if(d)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var o=new FileReader;return o.onload=function(){t.encodePacket({type:e.type,data:o.result},n,!0,r)},o.readAsArrayBuffer(e.data)}(e,n,r);var o=new Uint8Array(1);o[0]=p[e.type];var i=new m([o.buffer,e.data]);return r(i)}(e,n,o);if(i&&i.base64)return function(e,n){var r="b"+t.packets[e.type]+e.data.data;return n(r)}(e,o);var a=p[e.type];return void 0!==e.data&&(a+=r?l.encode(String(e.data),{strict:!1}):String(e.data)),o(""+a)},t.encodeBase64Packet=function(e,n){var r,o="b"+t.packets[e.type];if("undefined"!==typeof m&&e.data instanceof m){var i=new FileReader;return i.onload=function(){var e=i.result.split(",")[1];n(o+e)},i.readAsDataURL(e.data)}try{r=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(c){for(var a=new Uint8Array(e.data),s=new Array(a.length),l=0;l<a.length;l++)s[l]=a[l];r=String.fromCharCode.apply(null,s)}return o+=btoa(r),n(o)},t.decodePacket=function(e,n,r){if(void 0===e)return f;if("string"===typeof e){if("b"===e.charAt(0))return t.decodeBase64Packet(e.substr(1),n);if(r&&!1===(e=function(e){try{e=l.decode(e,{strict:!1})}catch(t){return!1}return e}(e)))return f;var o=e.charAt(0);return Number(o)==o&&h[o]?e.length>1?{type:h[o],data:e.substring(1)}:{type:h[o]}:f}o=new Uint8Array(e)[0];var i=a(e,1);return m&&"blob"===n&&(i=new m([i])),{type:h[o],data:i}},t.decodeBase64Packet=function(e,t){var n=h[e.charAt(0)];if(!r)return{type:n,data:{base64:!0,data:e.substr(1)}};var o=r.decode(e.substr(1));return"blob"===t&&m&&(o=new m([o])),{type:n,data:o}},t.encodePayload=function(e,n,r){"function"===typeof n&&(r=n,n=null);var o=i(e);if(n&&o)return m&&!d?t.encodePayloadAsBlob(e,r):t.encodePayloadAsArrayBuffer(e,r);if(!e.length)return r("0:");g(e,(function(e,r){t.encodePacket(e,!!o&&n,!1,(function(e){r(null,function(e){return e.length+":"+e}(e))}))}),(function(e,t){return r(t.join(""))}))},t.decodePayload=function(e,n,r){if("string"!==typeof e)return t.decodePayloadAsBinary(e,n,r);var o;if("function"===typeof n&&(r=n,n=null),""===e)return r(f,0,1);for(var i,a,s="",l=0,c=e.length;l<c;l++){var u=e.charAt(l);if(":"===u){if(""===s||s!=(i=Number(s)))return r(f,0,1);if(s!=(a=e.substr(l+1,i)).length)return r(f,0,1);if(a.length){if(o=t.decodePacket(a,n,!1),f.type===o.type&&f.data===o.data)return r(f,0,1);if(!1===r(o,l+i,c))return}l+=i,s=""}else s+=u}return""!==s?r(f,0,1):void 0},t.encodePayloadAsArrayBuffer=function(e,n){if(!e.length)return n(new ArrayBuffer(0));g(e,(function(e,n){t.encodePacket(e,!0,!0,(function(e){return n(null,e)}))}),(function(e,t){var r=t.reduce((function(e,t){var n;return e+(n="string"===typeof t?t.length:t.byteLength).toString().length+n+2}),0),o=new Uint8Array(r),i=0;return t.forEach((function(e){var t="string"===typeof e,n=e;if(t){for(var r=new Uint8Array(e.length),a=0;a<e.length;a++)r[a]=e.charCodeAt(a);n=r.buffer}o[i++]=t?0:1;var s=n.byteLength.toString();for(a=0;a<s.length;a++)o[i++]=parseInt(s[a]);o[i++]=255;for(r=new Uint8Array(n),a=0;a<r.length;a++)o[i++]=r[a]})),n(o.buffer)}))},t.encodePayloadAsBlob=function(e,n){g(e,(function(e,n){t.encodePacket(e,!0,!0,(function(e){var t=new Uint8Array(1);if(t[0]=1,"string"===typeof e){for(var r=new Uint8Array(e.length),o=0;o<e.length;o++)r[o]=e.charCodeAt(o);e=r.buffer,t[0]=0}var i=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),a=new Uint8Array(i.length+1);for(o=0;o<i.length;o++)a[o]=parseInt(i[o]);if(a[i.length]=255,m){var s=new m([t.buffer,a.buffer,e]);n(null,s)}}))}),(function(e,t){return n(new m(t))}))},t.decodePayloadAsBinary=function(e,n,r){"function"===typeof n&&(r=n,n=null);for(var o=e,i=[];o.byteLength>0;){for(var s=new Uint8Array(o),l=0===s[0],c="",u=1;255!==s[u];u++){if(c.length>310)return r(f,0,1);c+=s[u]}o=a(o,2+c.length),c=parseInt(c);var d=a(o,0,c);if(l)try{d=String.fromCharCode.apply(null,new Uint8Array(d))}catch(m){var p=new Uint8Array(d);d="";for(u=0;u<p.length;u++)d+=String.fromCharCode(p[u])}i.push(d),o=a(o,c)}var h=i.length;i.forEach((function(e,o){r(t.decodePacket(e,n,!0),o,h)}))}},463:function(e){e.exports=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var r in e)n.call(e,r)&&t.push(r);return t}},91640:function(e){var t,n,r,o=String.fromCharCode;function i(e){for(var t,n,r=[],o=0,i=e.length;o<i;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<i?56320==(64512&(n=e.charCodeAt(o++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),o--):r.push(t);return r}function a(e,t){if(e>=55296&&e<=57343){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function s(e,t){return o(e>>t&63|128)}function l(e,t){if(0==(4294967168&e))return o(e);var n="";return 0==(4294965248&e)?n=o(e>>6&31|192):0==(4294901760&e)?(a(e,t)||(e=65533),n=o(e>>12&15|224),n+=s(e,6)):0==(4292870144&e)&&(n=o(e>>18&7|240),n+=s(e,12),n+=s(e,6)),n+=o(63&e|128)}function c(){if(r>=n)throw Error("Invalid byte index");var e=255&t[r];if(r++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function u(e){var o,i;if(r>n)throw Error("Invalid byte index");if(r==n)return!1;if(o=255&t[r],r++,0==(128&o))return o;if(192==(224&o)){if((i=(31&o)<<6|c())>=128)return i;throw Error("Invalid continuation byte")}if(224==(240&o)){if((i=(15&o)<<12|c()<<6|c())>=2048)return a(i,e)?i:65533;throw Error("Invalid continuation byte")}if(240==(248&o)&&(i=(7&o)<<18|c()<<12|c()<<6|c())>=65536&&i<=1114111)return i;throw Error("Invalid UTF-8 detected")}e.exports={version:"2.1.2",encode:function(e,t){for(var n=!1!==(t=t||{}).strict,r=i(e),o=r.length,a=-1,s="";++a<o;)s+=l(r[a],n);return s},decode:function(e,a){var s=!1!==(a=a||{}).strict;t=i(e),n=t.length,r=0;for(var l,c=[];!1!==(l=u(s));)c.push(l);return function(e){for(var t,n=e.length,r=-1,i="";++r<n;)(t=e[r])>65535&&(i+=o((t-=65536)>>>10&1023|55296),t=56320|1023&t),i+=o(t);return i}(c)}}},742:function(e){"use strict";var t=/["'&<>]/;e.exports=function(e){var n,r=""+e,o=t.exec(r);if(!o)return r;var i="",a=0,s=0;for(a=o.index;a<r.length;a++){switch(r.charCodeAt(a)){case 34:n="&quot;";break;case 38:n="&amp;";break;case 39:n="&#39;";break;case 60:n="&lt;";break;case 62:n="&gt;";break;default:continue}s!==a&&(i+=r.substring(s,a)),s=a+1,i+=n}return s!==a?i+r.substring(s,a):i}},69349:function(e,t,n){var r=n(93325).hp,o=n(47994),i=Object.prototype.toString,a="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===i.call(Blob),s="function"===typeof File||"undefined"!==typeof File&&"[object FileConstructor]"===i.call(File);e.exports=function e(t){if(!t||"object"!==typeof t)return!1;if(o(t)){for(var n=0,i=t.length;n<i;n++)if(e(t[n]))return!0;return!1}if("function"===typeof r&&r.isBuffer&&r.isBuffer(t)||"function"===typeof ArrayBuffer&&t instanceof ArrayBuffer||a&&t instanceof Blob||s&&t instanceof File)return!0;if(t.toJSON&&"function"===typeof t.toJSON&&1===arguments.length)return e(t.toJSON(),!0);for(var l in t)if(Object.prototype.hasOwnProperty.call(t,l)&&e(t[l]))return!0;return!1}},47994:function(e){var t={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==t.call(e)}},15913:function(e){try{e.exports="undefined"!==typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},23876:function(e){"use strict";var t={childContextTypes:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},n={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},r=Object.defineProperty,o=Object.getOwnPropertyNames,i=Object.getOwnPropertySymbols,a=Object.getOwnPropertyDescriptor,s=Object.getPrototypeOf,l=s&&s(Object);e.exports=function e(c,u,d){if("string"!==typeof u){if(l){var p=s(u);p&&p!==l&&e(c,p,d)}var h=o(u);i&&(h=h.concat(i(u)));for(var f=0;f<h.length;++f){var m=h[f];if(!t[m]&&!n[m]&&(!d||!d[m])){var g=a(u,m);try{r(c,m,g)}catch(v){}}}return c}return c}},95896:function(e){var t=[].indexOf;e.exports=function(e,n){if(t)return e.indexOf(n);for(var r=0;r<e.length;++r)if(e[r]===n)return r;return-1}},10865:function(e,t,n){"use strict";var r;function o(e){return e.type===r.literal}function i(e){return e.type===r.argument}function a(e){return e.type===r.number}function s(e){return e.type===r.date}function l(e){return e.type===r.time}function c(e){return e.type===r.select}function u(e){return e.type===r.plural}function d(e){return e.type===r.pound}function p(e){return!(!e||"object"!==typeof e||0!==e.type)}function h(e){return!(!e||"object"!==typeof e||1!==e.type)}n.r(t),n.d(t,{IntlMessageFormat:function(){return J},createDefaultFormatters:function(){return Z},default:function(){return Q},formatHTMLMessage:function(){return K},formatToParts:function(){return F},formatToString:function(){return U}}),function(e){e[e.literal=0]="literal",e[e.argument=1]="argument",e[e.number=2]="number",e[e.date=3]="date",e[e.time=4]="time",e[e.select=5]="select",e[e.plural=6]="plural",e[e.pound=7]="pound"}(r||(r={}));var f=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),m=function(){return m=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},m.apply(this,arguments)},g=function(e){function t(n,r,o,i){var a=e.call(this)||this;return a.message=n,a.expected=r,a.found=o,a.location=i,a.name="SyntaxError","function"===typeof Error.captureStackTrace&&Error.captureStackTrace(a,t),a}return f(t,e),t.buildMessage=function(e,t){function n(e){return e.charCodeAt(0).toString(16).toUpperCase()}function r(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function o(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function i(e){switch(e.type){case"literal":return'"'+r(e.text)+'"';case"class":var t=e.parts.map((function(e){return Array.isArray(e)?o(e[0])+"-"+o(e[1]):o(e)}));return"["+(e.inverted?"^":"")+t+"]";case"any":return"any character";case"end":return"end of input";case"other":return e.description}}return"Expected "+function(e){var t,n,r=e.map(i);if(r.sort(),r.length>0){for(t=1,n=1;t<r.length;t++)r[t-1]!==r[t]&&(r[n]=r[t],n++);r.length=n}switch(r.length){case 1:return r[0];case 2:return r[0]+" or "+r[1];default:return r.slice(0,-1).join(", ")+", or "+r[r.length-1]}}(e)+" but "+(((a=t)?'"'+r(a)+'"':"end of input")+" found.");var a},t}(Error);var v=function(e,t){t=void 0!==t?t:{};var n,o={},i={start:ut},a=ut,s=function(e){return e.join("")},l=function(e){return m({type:r.literal,value:e},Ot())},c="#",u=rt("#",!1),d=function(){return m({type:r.pound},Ot())},p=it("argumentElement"),h="{",f=rt("{",!1),v="}",y=rt("}",!1),x=function(e){return m({type:r.argument,value:e},Ot())},A=it("numberSkeletonId"),C=/^['\/{}]/,b=ot(["'","/","{","}"],!1,!1),w={type:"any"},S=it("numberSkeletonTokenOption"),D="/",k=rt("/",!1),M=function(e){return e},j=it("numberSkeletonToken"),I=function(e,t){return{stem:e,options:t}},_=function(e){return m({type:0,tokens:e},Ot())},P="::",N=rt("::",!1),O=function(e){return e},T=function(){return Pt.push("numberArgStyle"),!0},E=function(e){return Pt.pop(),e.replace(/\s*$/,"")},R=",",L=rt(",",!1),F="number",U=rt("number",!1),B=function(e,t,n){return m({type:"number"===t?r.number:"date"===t?r.date:r.time,style:n&&n[2],value:e},Ot())},Y="'",q=rt("'",!1),H=/^[^']/,G=ot(["'"],!0,!1),z=/^[^a-zA-Z'{}]/,V=ot([["a","z"],["A","Z"],"'","{","}"],!0,!1),W=/^[a-zA-Z]/,K=ot([["a","z"],["A","Z"]],!1,!1),X=function(e){return m({type:1,pattern:e},Ot())},$=function(){return Pt.push("dateOrTimeArgStyle"),!0},Z="date",J=rt("date",!1),Q="time",ee=rt("time",!1),te="plural",ne=rt("plural",!1),re="selectordinal",oe=rt("selectordinal",!1),ie="offset:",ae=rt("offset:",!1),se=function(e,t,n,o){return m({type:r.plural,pluralType:"plural"===t?"cardinal":"ordinal",value:e,offset:n?n[2]:0,options:o.reduce((function(e,t){var n=t.id,r=t.value,o=t.location;return n in e&&nt('Duplicate option "'+n+'" in plural element: "'+et()+'"',tt()),e[n]={value:r,location:o},e}),{})},Ot())},le="select",ce=rt("select",!1),ue=function(e,t){return m({type:r.select,value:e,options:t.reduce((function(e,t){var n=t.id,r=t.value,o=t.location;return n in e&&nt('Duplicate option "'+n+'" in select element: "'+et()+'"',tt()),e[n]={value:r,location:o},e}),{})},Ot())},de="=",pe=rt("=",!1),he=function(e){return Pt.push("select"),!0},fe=function(e,t){return Pt.pop(),m({id:e,value:t},Ot())},me=function(e){return Pt.push("plural"),!0},ge=function(e,t){return Pt.pop(),m({id:e,value:t},Ot())},ve=it("whitespace"),ye=/^[\t-\r \x85\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/,xe=ot([["\t","\r"]," ","\x85","\xa0","\u1680",["\u2000","\u200a"],"\u2028","\u2029","\u202f","\u205f","\u3000"],!1,!1),Ae=it("syntax pattern"),Ce=/^[!-\/:-@[-\^`{-~\xA1-\xA7\xA9\xAB\xAC\xAE\xB0\xB1\xB6\xBB\xBF\xD7\xF7\u2010-\u2027\u2030-\u203E\u2041-\u2053\u2055-\u205E\u2190-\u245F\u2500-\u2775\u2794-\u2BFF\u2E00-\u2E7F\u3001-\u3003\u3008-\u3020\u3030\uFD3E\uFD3F\uFE45\uFE46]/,be=ot([["!","/"],[":","@"],["[","^"],"`",["{","~"],["\xa1","\xa7"],"\xa9","\xab","\xac","\xae","\xb0","\xb1","\xb6","\xbb","\xbf","\xd7","\xf7",["\u2010","\u2027"],["\u2030","\u203e"],["\u2041","\u2053"],["\u2055","\u205e"],["\u2190","\u245f"],["\u2500","\u2775"],["\u2794","\u2bff"],["\u2e00","\u2e7f"],["\u3001","\u3003"],["\u3008","\u3020"],"\u3030","\ufd3e","\ufd3f","\ufe45","\ufe46"],!1,!1),we=it("optional whitespace"),Se=it("number"),De="-",ke=rt("-",!1),Me=function(e,t){return t?e?-t:t:0},je=(it("apostrophe"),it("double apostrophes")),Ie="''",_e=rt("''",!1),Pe=function(){return"'"},Ne=function(e,t){return e+t.replace("''","'")},Oe=function(e){return"{"!==e&&!(Nt()&&"#"===e)&&!(Pt.length>1&&"}"===e)},Te="\n",Ee=rt("\n",!1),Re=function(e){return"{"===e||"}"===e||Nt()&&"#"===e},Le=it("argNameOrNumber"),Fe=it("argNumber"),Ue="0",Be=rt("0",!1),Ye=function(){return 0},qe=/^[1-9]/,He=ot([["1","9"]],!1,!1),Ge=/^[0-9]/,ze=ot([["0","9"]],!1,!1),Ve=function(e){return parseInt(e.join(""),10)},We=it("argName"),Ke=0,Xe=0,$e=[{line:1,column:1}],Ze=0,Je=[],Qe=0;if(void 0!==t.startRule){if(!(t.startRule in i))throw new Error("Can't start parsing from rule \""+t.startRule+'".');a=i[t.startRule]}function et(){return e.substring(Xe,Ke)}function tt(){return st(Xe,Ke)}function nt(e,t){throw function(e,t){return new g(e,[],"",t)}(e,t=void 0!==t?t:st(Xe,Ke))}function rt(e,t){return{type:"literal",text:e,ignoreCase:t}}function ot(e,t,n){return{type:"class",parts:e,inverted:t,ignoreCase:n}}function it(e){return{type:"other",description:e}}function at(t){var n,r=$e[t];if(r)return r;for(n=t-1;!$e[n];)n--;for(r={line:(r=$e[n]).line,column:r.column};n<t;)10===e.charCodeAt(n)?(r.line++,r.column=1):r.column++,n++;return $e[t]=r,r}function st(e,t){var n=at(e),r=at(t);return{start:{offset:e,line:n.line,column:n.column},end:{offset:t,line:r.line,column:r.column}}}function lt(e){Ke<Ze||(Ke>Ze&&(Ze=Ke,Je=[]),Je.push(e))}function ct(e,t,n){return new g(g.buildMessage(e,t),e,t,n)}function ut(){return dt()}function dt(){var e,t;for(e=[],t=pt();t!==o;)e.push(t),t=pt();return e}function pt(){var t;return(t=function(){var e,t;e=Ke,(t=ht())!==o&&(Xe=e,t=l(t));return e=t,e}())===o&&(t=function(){var t,n,r,i;Qe++,t=Ke,123===e.charCodeAt(Ke)?(n=h,Ke++):(n=o,0===Qe&&lt(f));n!==o&&wt()!==o&&(r=jt())!==o&&wt()!==o?(125===e.charCodeAt(Ke)?(i=v,Ke++):(i=o,0===Qe&&lt(y)),i!==o?(Xe=t,t=n=x(r)):(Ke=t,t=o)):(Ke=t,t=o);Qe--,t===o&&(n=o,0===Qe&&lt(p));return t}())===o&&(t=function(){var t;t=function(){var t,n,r,i,a,s,l,c,u;t=Ke,123===e.charCodeAt(Ke)?(n=h,Ke++):(n=o,0===Qe&&lt(f));n!==o&&wt()!==o&&(r=jt())!==o&&wt()!==o?(44===e.charCodeAt(Ke)?(i=R,Ke++):(i=o,0===Qe&&lt(L)),i!==o&&wt()!==o?(e.substr(Ke,6)===F?(a=F,Ke+=6):(a=o,0===Qe&&lt(U)),a!==o&&wt()!==o?(s=Ke,44===e.charCodeAt(Ke)?(l=R,Ke++):(l=o,0===Qe&&lt(L)),l!==o&&(c=wt())!==o?(u=function(){var t,n,r;t=Ke,e.substr(Ke,2)===P?(n=P,Ke+=2):(n=o,0===Qe&&lt(N));n!==o?(r=function(){var e,t,n;if(e=Ke,t=[],n=gt(),n!==o)for(;n!==o;)t.push(n),n=gt();else t=o;t!==o&&(Xe=e,t=_(t));return e=t,e}(),r!==o?(Xe=t,t=n=O(r)):(Ke=t,t=o)):(Ke=t,t=o);t===o&&(t=Ke,Xe=Ke,(n=(n=T())?void 0:o)!==o&&(r=ht())!==o?(Xe=t,t=n=E(r)):(Ke=t,t=o));return t}(),u!==o?s=l=[l,c,u]:(Ke=s,s=o)):(Ke=s,s=o),s===o&&(s=null),s!==o&&(l=wt())!==o?(125===e.charCodeAt(Ke)?(c=v,Ke++):(c=o,0===Qe&&lt(y)),c!==o?(Xe=t,t=n=B(r,a,s)):(Ke=t,t=o)):(Ke=t,t=o)):(Ke=t,t=o)):(Ke=t,t=o)):(Ke=t,t=o);return t}(),t===o&&(t=function(){var t,n,r,i,a,s,l,c,u;t=Ke,123===e.charCodeAt(Ke)?(n=h,Ke++):(n=o,0===Qe&&lt(f));n!==o&&wt()!==o&&(r=jt())!==o&&wt()!==o?(44===e.charCodeAt(Ke)?(i=R,Ke++):(i=o,0===Qe&&lt(L)),i!==o&&wt()!==o?(e.substr(Ke,4)===Z?(a=Z,Ke+=4):(a=o,0===Qe&&lt(J)),a===o&&(e.substr(Ke,4)===Q?(a=Q,Ke+=4):(a=o,0===Qe&&lt(ee))),a!==o&&wt()!==o?(s=Ke,44===e.charCodeAt(Ke)?(l=R,Ke++):(l=o,0===Qe&&lt(L)),l!==o&&(c=wt())!==o?(u=function(){var t,n,r;t=Ke,e.substr(Ke,2)===P?(n=P,Ke+=2):(n=o,0===Qe&&lt(N));n!==o?(r=function(){var t,n,r,i;t=Ke,n=Ke,r=[],i=vt(),i===o&&(i=yt());if(i!==o)for(;i!==o;)r.push(i),(i=vt())===o&&(i=yt());else r=o;n=r!==o?e.substring(n,Ke):r;n!==o&&(Xe=t,n=X(n));return t=n,t}(),r!==o?(Xe=t,t=n=O(r)):(Ke=t,t=o)):(Ke=t,t=o);t===o&&(t=Ke,Xe=Ke,(n=(n=$())?void 0:o)!==o&&(r=ht())!==o?(Xe=t,t=n=E(r)):(Ke=t,t=o));return t}(),u!==o?s=l=[l,c,u]:(Ke=s,s=o)):(Ke=s,s=o),s===o&&(s=null),s!==o&&(l=wt())!==o?(125===e.charCodeAt(Ke)?(c=v,Ke++):(c=o,0===Qe&&lt(y)),c!==o?(Xe=t,t=n=B(r,a,s)):(Ke=t,t=o)):(Ke=t,t=o)):(Ke=t,t=o)):(Ke=t,t=o)):(Ke=t,t=o);return t}());return t}())===o&&(t=function(){var t,n,r,i,a,s,l,c,u,d,p;t=Ke,123===e.charCodeAt(Ke)?(n=h,Ke++):(n=o,0===Qe&&lt(f));if(n!==o)if(wt()!==o)if((r=jt())!==o)if(wt()!==o)if(44===e.charCodeAt(Ke)?(i=R,Ke++):(i=o,0===Qe&&lt(L)),i!==o)if(wt()!==o)if(e.substr(Ke,6)===te?(a=te,Ke+=6):(a=o,0===Qe&&lt(ne)),a===o&&(e.substr(Ke,13)===re?(a=re,Ke+=13):(a=o,0===Qe&&lt(oe))),a!==o)if(wt()!==o)if(44===e.charCodeAt(Ke)?(s=R,Ke++):(s=o,0===Qe&&lt(L)),s!==o)if(wt()!==o)if(l=Ke,e.substr(Ke,7)===ie?(c=ie,Ke+=7):(c=o,0===Qe&&lt(ae)),c!==o&&(u=wt())!==o&&(d=St())!==o?l=c=[c,u,d]:(Ke=l,l=o),l===o&&(l=null),l!==o)if((c=wt())!==o){if(u=[],(d=At())!==o)for(;d!==o;)u.push(d),d=At();else u=o;u!==o&&(d=wt())!==o?(125===e.charCodeAt(Ke)?(p=v,Ke++):(p=o,0===Qe&&lt(y)),p!==o?(Xe=t,t=n=se(r,a,l,u)):(Ke=t,t=o)):(Ke=t,t=o)}else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;return t}())===o&&(t=function(){var t,n,r,i,a,s,l,c,u;t=Ke,123===e.charCodeAt(Ke)?(n=h,Ke++):(n=o,0===Qe&&lt(f));if(n!==o)if(wt()!==o)if((r=jt())!==o)if(wt()!==o)if(44===e.charCodeAt(Ke)?(i=R,Ke++):(i=o,0===Qe&&lt(L)),i!==o)if(wt()!==o)if(e.substr(Ke,6)===le?(a=le,Ke+=6):(a=o,0===Qe&&lt(ce)),a!==o)if(wt()!==o)if(44===e.charCodeAt(Ke)?(s=R,Ke++):(s=o,0===Qe&&lt(L)),s!==o)if(wt()!==o){if(l=[],(c=xt())!==o)for(;c!==o;)l.push(c),c=xt();else l=o;l!==o&&(c=wt())!==o?(125===e.charCodeAt(Ke)?(u=v,Ke++):(u=o,0===Qe&&lt(y)),u!==o?(Xe=t,t=n=ue(r,l)):(Ke=t,t=o)):(Ke=t,t=o)}else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;else Ke=t,t=o;return t}())===o&&(t=function(){var t,n;t=Ke,35===e.charCodeAt(Ke)?(n=c,Ke++):(n=o,0===Qe&&lt(u));n!==o&&(Xe=t,n=d());return t=n,t}()),t}function ht(){var e,t,n;if(e=Ke,t=[],(n=Dt())===o&&(n=kt())===o&&(n=Mt()),n!==o)for(;n!==o;)t.push(n),(n=Dt())===o&&(n=kt())===o&&(n=Mt());else t=o;return t!==o&&(Xe=e,t=s(t)),e=t}function ft(){var t,n,r,i,a;if(Qe++,t=Ke,n=[],r=Ke,i=Ke,Qe++,(a=Ct())===o&&(C.test(e.charAt(Ke))?(a=e.charAt(Ke),Ke++):(a=o,0===Qe&&lt(b))),Qe--,a===o?i=void 0:(Ke=i,i=o),i!==o?(e.length>Ke?(a=e.charAt(Ke),Ke++):(a=o,0===Qe&&lt(w)),a!==o?r=i=[i,a]:(Ke=r,r=o)):(Ke=r,r=o),r!==o)for(;r!==o;)n.push(r),r=Ke,i=Ke,Qe++,(a=Ct())===o&&(C.test(e.charAt(Ke))?(a=e.charAt(Ke),Ke++):(a=o,0===Qe&&lt(b))),Qe--,a===o?i=void 0:(Ke=i,i=o),i!==o?(e.length>Ke?(a=e.charAt(Ke),Ke++):(a=o,0===Qe&&lt(w)),a!==o?r=i=[i,a]:(Ke=r,r=o)):(Ke=r,r=o);else n=o;return t=n!==o?e.substring(t,Ke):n,Qe--,t===o&&(n=o,0===Qe&&lt(A)),t}function mt(){var t,n,r;return Qe++,t=Ke,47===e.charCodeAt(Ke)?(n=D,Ke++):(n=o,0===Qe&&lt(k)),n!==o&&(r=ft())!==o?(Xe=t,t=n=M(r)):(Ke=t,t=o),Qe--,t===o&&(n=o,0===Qe&&lt(S)),t}function gt(){var e,t,n,r;if(Qe++,e=Ke,wt()!==o)if((t=ft())!==o){for(n=[],r=mt();r!==o;)n.push(r),r=mt();n!==o?(Xe=e,e=I(t,n)):(Ke=e,e=o)}else Ke=e,e=o;else Ke=e,e=o;return Qe--,e===o&&(0===Qe&&lt(j)),e}function vt(){var t,n,r,i;if(t=Ke,39===e.charCodeAt(Ke)?(n=Y,Ke++):(n=o,0===Qe&&lt(q)),n!==o){if(r=[],(i=Dt())===o&&(H.test(e.charAt(Ke))?(i=e.charAt(Ke),Ke++):(i=o,0===Qe&&lt(G))),i!==o)for(;i!==o;)r.push(i),(i=Dt())===o&&(H.test(e.charAt(Ke))?(i=e.charAt(Ke),Ke++):(i=o,0===Qe&&lt(G)));else r=o;r!==o?(39===e.charCodeAt(Ke)?(i=Y,Ke++):(i=o,0===Qe&&lt(q)),i!==o?t=n=[n,r,i]:(Ke=t,t=o)):(Ke=t,t=o)}else Ke=t,t=o;if(t===o)if(t=[],(n=Dt())===o&&(z.test(e.charAt(Ke))?(n=e.charAt(Ke),Ke++):(n=o,0===Qe&&lt(V))),n!==o)for(;n!==o;)t.push(n),(n=Dt())===o&&(z.test(e.charAt(Ke))?(n=e.charAt(Ke),Ke++):(n=o,0===Qe&&lt(V)));else t=o;return t}function yt(){var t,n;if(t=[],W.test(e.charAt(Ke))?(n=e.charAt(Ke),Ke++):(n=o,0===Qe&&lt(K)),n!==o)for(;n!==o;)t.push(n),W.test(e.charAt(Ke))?(n=e.charAt(Ke),Ke++):(n=o,0===Qe&&lt(K));else t=o;return t}function xt(){var t,n,r,i,a;return t=Ke,wt()!==o&&(n=_t())!==o&&wt()!==o?(123===e.charCodeAt(Ke)?(r=h,Ke++):(r=o,0===Qe&&lt(f)),r!==o?(Xe=Ke,(he(n)?void 0:o)!==o&&(i=dt())!==o?(125===e.charCodeAt(Ke)?(a=v,Ke++):(a=o,0===Qe&&lt(y)),a!==o?(Xe=t,t=fe(n,i)):(Ke=t,t=o)):(Ke=t,t=o)):(Ke=t,t=o)):(Ke=t,t=o),t}function At(){var t,n,r,i,a;return t=Ke,wt()!==o?(n=function(){var t,n,r,i;return t=Ke,n=Ke,61===e.charCodeAt(Ke)?(r=de,Ke++):(r=o,0===Qe&&lt(pe)),r!==o&&(i=St())!==o?n=r=[r,i]:(Ke=n,n=o),(t=n!==o?e.substring(t,Ke):n)===o&&(t=_t()),t}(),n!==o&&wt()!==o?(123===e.charCodeAt(Ke)?(r=h,Ke++):(r=o,0===Qe&&lt(f)),r!==o?(Xe=Ke,(me(n)?void 0:o)!==o&&(i=dt())!==o?(125===e.charCodeAt(Ke)?(a=v,Ke++):(a=o,0===Qe&&lt(y)),a!==o?(Xe=t,t=ge(n,i)):(Ke=t,t=o)):(Ke=t,t=o)):(Ke=t,t=o)):(Ke=t,t=o)):(Ke=t,t=o),t}function Ct(){var t;return Qe++,ye.test(e.charAt(Ke))?(t=e.charAt(Ke),Ke++):(t=o,0===Qe&&lt(xe)),Qe--,t===o&&(0===Qe&&lt(ve)),t}function bt(){var t;return Qe++,Ce.test(e.charAt(Ke))?(t=e.charAt(Ke),Ke++):(t=o,0===Qe&&lt(be)),Qe--,t===o&&(0===Qe&&lt(Ae)),t}function wt(){var t,n,r;for(Qe++,t=Ke,n=[],r=Ct();r!==o;)n.push(r),r=Ct();return t=n!==o?e.substring(t,Ke):n,Qe--,t===o&&(n=o,0===Qe&&lt(we)),t}function St(){var t,n,r;return Qe++,t=Ke,45===e.charCodeAt(Ke)?(n=De,Ke++):(n=o,0===Qe&&lt(ke)),n===o&&(n=null),n!==o&&(r=It())!==o?(Xe=t,t=n=Me(n,r)):(Ke=t,t=o),Qe--,t===o&&(n=o,0===Qe&&lt(Se)),t}function Dt(){var t,n;return Qe++,t=Ke,e.substr(Ke,2)===Ie?(n=Ie,Ke+=2):(n=o,0===Qe&&lt(_e)),n!==o&&(Xe=t,n=Pe()),Qe--,(t=n)===o&&(n=o,0===Qe&&lt(je)),t}function kt(){var t,n,r,i,a,s;if(t=Ke,39===e.charCodeAt(Ke)?(n=Y,Ke++):(n=o,0===Qe&&lt(q)),n!==o)if(r=function(){var t,n,r,i;t=Ke,n=Ke,e.length>Ke?(r=e.charAt(Ke),Ke++):(r=o,0===Qe&&lt(w));r!==o?(Xe=Ke,(i=(i=Re(r))?void 0:o)!==o?n=r=[r,i]:(Ke=n,n=o)):(Ke=n,n=o);t=n!==o?e.substring(t,Ke):n;return t}(),r!==o){for(i=Ke,a=[],e.substr(Ke,2)===Ie?(s=Ie,Ke+=2):(s=o,0===Qe&&lt(_e)),s===o&&(H.test(e.charAt(Ke))?(s=e.charAt(Ke),Ke++):(s=o,0===Qe&&lt(G)));s!==o;)a.push(s),e.substr(Ke,2)===Ie?(s=Ie,Ke+=2):(s=o,0===Qe&&lt(_e)),s===o&&(H.test(e.charAt(Ke))?(s=e.charAt(Ke),Ke++):(s=o,0===Qe&&lt(G)));(i=a!==o?e.substring(i,Ke):a)!==o?(39===e.charCodeAt(Ke)?(a=Y,Ke++):(a=o,0===Qe&&lt(q)),a===o&&(a=null),a!==o?(Xe=t,t=n=Ne(r,i)):(Ke=t,t=o)):(Ke=t,t=o)}else Ke=t,t=o;else Ke=t,t=o;return t}function Mt(){var t,n,r,i;return t=Ke,n=Ke,e.length>Ke?(r=e.charAt(Ke),Ke++):(r=o,0===Qe&&lt(w)),r!==o?(Xe=Ke,(i=(i=Oe(r))?void 0:o)!==o?n=r=[r,i]:(Ke=n,n=o)):(Ke=n,n=o),n===o&&(10===e.charCodeAt(Ke)?(n=Te,Ke++):(n=o,0===Qe&&lt(Ee))),t=n!==o?e.substring(t,Ke):n}function jt(){var t,n;return Qe++,t=Ke,(n=It())===o&&(n=_t()),t=n!==o?e.substring(t,Ke):n,Qe--,t===o&&(n=o,0===Qe&&lt(Le)),t}function It(){var t,n,r,i,a;if(Qe++,t=Ke,48===e.charCodeAt(Ke)?(n=Ue,Ke++):(n=o,0===Qe&&lt(Be)),n!==o&&(Xe=t,n=Ye()),(t=n)===o){if(t=Ke,n=Ke,qe.test(e.charAt(Ke))?(r=e.charAt(Ke),Ke++):(r=o,0===Qe&&lt(He)),r!==o){for(i=[],Ge.test(e.charAt(Ke))?(a=e.charAt(Ke),Ke++):(a=o,0===Qe&&lt(ze));a!==o;)i.push(a),Ge.test(e.charAt(Ke))?(a=e.charAt(Ke),Ke++):(a=o,0===Qe&&lt(ze));i!==o?n=r=[r,i]:(Ke=n,n=o)}else Ke=n,n=o;n!==o&&(Xe=t,n=Ve(n)),t=n}return Qe--,t===o&&(n=o,0===Qe&&lt(Fe)),t}function _t(){var t,n,r,i,a;if(Qe++,t=Ke,n=[],r=Ke,i=Ke,Qe++,(a=Ct())===o&&(a=bt()),Qe--,a===o?i=void 0:(Ke=i,i=o),i!==o?(e.length>Ke?(a=e.charAt(Ke),Ke++):(a=o,0===Qe&&lt(w)),a!==o?r=i=[i,a]:(Ke=r,r=o)):(Ke=r,r=o),r!==o)for(;r!==o;)n.push(r),r=Ke,i=Ke,Qe++,(a=Ct())===o&&(a=bt()),Qe--,a===o?i=void 0:(Ke=i,i=o),i!==o?(e.length>Ke?(a=e.charAt(Ke),Ke++):(a=o,0===Qe&&lt(w)),a!==o?r=i=[i,a]:(Ke=r,r=o)):(Ke=r,r=o);else n=o;return t=n!==o?e.substring(t,Ke):n,Qe--,t===o&&(n=o,0===Qe&&lt(We)),t}var Pt=["root"];function Nt(){return"plural"===Pt[Pt.length-1]}function Ot(){return t&&t.captureLocation?{location:tt()}:{}}if((n=a())!==o&&Ke===e.length)return n;throw n!==o&&Ke<e.length&&lt({type:"end"}),ct(Je,Ze<e.length?e.charAt(Ze):null,Ze<e.length?st(Ze,Ze+1):st(Ze,Ze))},y=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r},x=/(^|[^\\])#/g;function A(e){e.forEach((function(e){(u(e)||c(e))&&Object.keys(e.options).forEach((function(t){for(var n,r=e.options[t],i=-1,a=void 0,s=0;s<r.value.length;s++){var l=r.value[s];if(o(l)&&x.test(l.value)){i=s,a=l;break}}if(a){var c=a.value.replace(x,"$1{"+e.value+", number}"),u=v(c);(n=r.value).splice.apply(n,y([i,1],u))}A(r.value)}))}))}function C(e,t){var n=v(e,t);return t&&!1===t.normalizeHashtagInPlural||A(n),n}var b=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r};function w(e){return JSON.stringify(e.map((function(e){return e&&"object"===typeof e?(t=e,Object.keys(t).sort().map((function(e){var n;return(n={})[e]=t[e],n}))):e;var t})))}var S=function(e,t){return void 0===t&&(t={}),function(){for(var n,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];var i=w(r),a=i&&t[i];return a||(a=new((n=e).bind.apply(n,b([void 0],r))),i&&(t[i]=a)),a}},D=function(){return D=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},D.apply(this,arguments)},k=/(?:[Eec]{1,6}|G{1,5}|[Qq]{1,5}|(?:[yYur]+|U{1,5})|[ML]{1,5}|d{1,2}|D{1,3}|F{1}|[abB]{1,5}|[hkHK]{1,2}|w{1,2}|W{1}|m{1,2}|s{1,2}|[zZOvVxX]{1,4})(?=([^']*'[^']*')*[^']*$)/g;function M(e){var t={};return e.replace(k,(function(e){var n=e.length;switch(e[0]){case"G":t.era=4===n?"long":5===n?"narrow":"short";break;case"y":t.year=2===n?"2-digit":"numeric";break;case"Y":case"u":case"U":case"r":throw new RangeError("`Y/u/U/r` (year) patterns are not supported, use `y` instead");case"q":case"Q":throw new RangeError("`q/Q` (quarter) patterns are not supported");case"M":case"L":t.month=["numeric","2-digit","short","long","narrow"][n-1];break;case"w":case"W":throw new RangeError("`w/W` (week) patterns are not supported");case"d":t.day=["numeric","2-digit"][n-1];break;case"D":case"F":case"g":throw new RangeError("`D/F/g` (day) patterns are not supported, use `d` instead");case"E":t.weekday=4===n?"short":5===n?"narrow":"short";break;case"e":if(n<4)throw new RangeError("`e..eee` (weekday) patterns are not supported");t.weekday=["short","long","narrow","short"][n-4];break;case"c":if(n<4)throw new RangeError("`c..ccc` (weekday) patterns are not supported");t.weekday=["short","long","narrow","short"][n-4];break;case"a":t.hour12=!0;break;case"b":case"B":throw new RangeError("`b/B` (period) patterns are not supported, use `a` instead");case"h":t.hourCycle="h12",t.hour=["numeric","2-digit"][n-1];break;case"H":t.hourCycle="h23",t.hour=["numeric","2-digit"][n-1];break;case"K":t.hourCycle="h11",t.hour=["numeric","2-digit"][n-1];break;case"k":t.hourCycle="h24",t.hour=["numeric","2-digit"][n-1];break;case"j":case"J":case"C":throw new RangeError("`j/J/C` (hour) patterns are not supported, use `h/H/K/k` instead");case"m":t.minute=["numeric","2-digit"][n-1];break;case"s":t.second=["numeric","2-digit"][n-1];break;case"S":case"A":throw new RangeError("`S/A` (second) pattenrs are not supported, use `s` instead");case"z":t.timeZoneName=n<4?"short":"long";break;case"Z":case"O":case"v":case"V":case"X":case"x":throw new RangeError("`Z/O/v/V/X/x` (timeZone) pattenrs are not supported, use `z` instead")}return""})),t}var j=/^\.(?:(0+)(\+|#+)?)?$/g,I=/^(@+)?(\+|#+)?$/g;function _(e){var t={};return e.replace(I,(function(e,n,r){return"string"!==typeof r?(t.minimumSignificantDigits=n.length,t.maximumSignificantDigits=n.length):"+"===r?t.minimumSignificantDigits=n.length:"#"===n[0]?t.maximumSignificantDigits=n.length:(t.minimumSignificantDigits=n.length,t.maximumSignificantDigits=n.length+("string"===typeof r?r.length:0)),""})),t}function P(e){switch(e){case"sign-auto":return{signDisplay:"auto"};case"sign-accounting":return{currencySign:"accounting"};case"sign-always":return{signDisplay:"always"};case"sign-accounting-always":return{signDisplay:"always",currencySign:"accounting"};case"sign-except-zero":return{signDisplay:"exceptZero"};case"sign-accounting-except-zero":return{signDisplay:"exceptZero",currencySign:"accounting"};case"sign-never":return{signDisplay:"never"}}}function N(e){var t=P(e);return t||{}}function O(e){for(var t={},n=0,r=e;n<r.length;n++){var o=r[n];switch(o.stem){case"percent":t.style="percent";continue;case"currency":t.style="currency",t.currency=o.options[0];continue;case"group-off":t.useGrouping=!1;continue;case"precision-integer":t.maximumFractionDigits=0;continue;case"measure-unit":t.style="unit",t.unit=o.options[0].replace(/^(.*?)-/,"");continue;case"compact-short":t.notation="compact",t.compactDisplay="short";continue;case"compact-long":t.notation="compact",t.compactDisplay="long";continue;case"scientific":t=D(D(D({},t),{notation:"scientific"}),o.options.reduce((function(e,t){return D(D({},e),N(t))}),{}));continue;case"engineering":t=D(D(D({},t),{notation:"engineering"}),o.options.reduce((function(e,t){return D(D({},e),N(t))}),{}));continue;case"notation-simple":t.notation="standard";continue;case"unit-width-narrow":t.currencyDisplay="narrowSymbol",t.unitDisplay="narrow";continue;case"unit-width-short":t.currencyDisplay="code",t.unitDisplay="short";continue;case"unit-width-full-name":t.currencyDisplay="name",t.unitDisplay="long";continue;case"unit-width-iso-code":t.currencyDisplay="symbol";continue}if(j.test(o.stem)){if(o.options.length>1)throw new RangeError("Fraction-precision stems only accept a single optional option");o.stem.replace(j,(function(e,n,r){return"."===e?t.maximumFractionDigits=0:"+"===r?t.minimumFractionDigits=r.length:"#"===n[0]?t.maximumFractionDigits=n.length:(t.minimumFractionDigits=n.length,t.maximumFractionDigits=n.length+("string"===typeof r?r.length:0)),""})),o.options.length&&(t=D(D({},t),_(o.options[0])))}else if(I.test(o.stem))t=D(D({},t),_(o.stem));else{var i=P(o.stem);i&&(t=D(D({},t),i))}}return t}var T,E=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),R=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r},L=function(e){function t(t,n){var r=e.call(this,t)||this;return r.variableId=n,r}return E(t,e),t}(Error);function F(e,t,n,r,f,m,g){if(1===e.length&&o(e[0]))return[{type:0,value:e[0].value}];for(var v,y=[],x=0,A=e;x<A.length;x++){var C=A[x];if(o(C))y.push({type:0,value:C.value});else if(d(C))"number"===typeof m&&y.push({type:0,value:n.getNumberFormat(t).format(m)});else{var b=C.value;if(!f||!(b in f))throw new L('The intl string context variable "'+b+'" was not provided to the string "'+g+'"');var w=f[b];if(i(C))w&&"string"!==typeof w&&"number"!==typeof w||(w="string"===typeof w||"number"===typeof w?String(w):""),y.push({type:1,value:w});else if(s(C)){var S="string"===typeof C.style?r.date[C.style]:void 0;y.push({type:0,value:n.getDateTimeFormat(t,S).format(w)})}else if(l(C)){S="string"===typeof C.style?r.time[C.style]:h(C.style)?M(C.style.pattern):void 0;y.push({type:0,value:n.getDateTimeFormat(t,S).format(w)})}else if(a(C)){S="string"===typeof C.style?r.number[C.style]:p(C.style)?O(C.style.tokens):void 0;y.push({type:0,value:n.getNumberFormat(t,S).format(w)})}else if(c(C)){if(!(D=C.options[w]||C.options.other))throw new RangeError('Invalid values for "'+C.value+'": "'+w+'". Options are "'+Object.keys(C.options).join('", "')+'"');y.push.apply(y,F(D.value,t,n,r,f))}else if(u(C)){var D;if(!(D=C.options["="+w])){if(!Intl.PluralRules)throw new L('Intl.PluralRules is not available in this environment.\nTry polyfilling it using "@formatjs/intl-pluralrules"\n');var k=n.getPluralRules(t,{type:C.pluralType}).select(w-(C.offset||0));D=C.options[k]||C.options.other}if(!D)throw new RangeError('Invalid values for "'+C.value+'": "'+w+'". Options are "'+Object.keys(C.options).join('", "')+'"');y.push.apply(y,F(D.value,t,n,r,f,w-(C.offset||0)))}else;}}return(v=y).length<2?v:v.reduce((function(e,t){var n=e[e.length-1];return n&&0===n.type&&0===t.type?n.value+=t.value:e.push(t),e}),[])}function U(e,t,n,r,o,i){var a=F(e,t,n,r,o,void 0,i);return 1===a.length?a[0].value:a.reduce((function(e,t){return e+t.value}),"")}var B="@@",Y=/@@(\d+_\d+)@@/g,q=0;function H(e,t){return e.split(Y).filter(Boolean).map((function(e){return null!=t[e]?t[e]:e})).reduce((function(e,t){return e.length&&"string"===typeof t&&"string"===typeof e[e.length-1]?e[e.length-1]+=t:e.push(t),e}),[])}var G=/(<([0-9a-zA-Z-_]*?)>(.*?)<\/([0-9a-zA-Z-_]*?)>)|(<[0-9a-zA-Z-_]*?\/>)/,z=Date.now()+"@@",V=["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr"];function W(e,t,n){var r=e.tagName,o=e.outerHTML,i=e.textContent,a=e.childNodes;if(!r)return H(i||"",t);r=r.toLowerCase();var s=~V.indexOf(r),l=n[r];if(l&&s)throw new L(r+" is a self-closing tag and can not be used, please use another tag name.");if(!a.length)return[o];var c=Array.prototype.slice.call(a).reduce((function(e,r){return e.concat(W(r,t,n))}),[]);return l?"function"===typeof l?[l.apply(void 0,c)]:[l]:R(["<"+r+">"],c,["</"+r+">"])}function K(e,t,n,r,o,i){var a=F(e,t,n,r,o,void 0,i),s={},l=a.reduce((function(e,t){if(0===t.type)return e+t.value;var n=Date.now()+"_"+ ++q;return s[n]=t.value,e+""+B+n+B}),"");if(!G.test(l))return H(l,s);if(!o)throw new L("Message has placeholders but no values was given");if("undefined"===typeof DOMParser)throw new L("Cannot format XML message without DOMParser");T||(T=new DOMParser);var c=T.parseFromString('<formatted-message id="'+z+'">'+l+"</formatted-message>","text/html").getElementById(z);if(!c)throw new L("Malformed HTML message "+l);var u=Object.keys(o).filter((function(e){return!!c.getElementsByTagName(e).length}));if(!u.length)return H(l,s);var d=u.filter((function(e){return e!==e.toLowerCase()}));if(d.length)throw new L("HTML tag must be lowercased but the following tags are not: "+d.join(", "));return Array.prototype.slice.call(c.childNodes).reduce((function(e,t){return e.concat(W(t,s,o))}),[])}var X=function(){return X=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},X.apply(this,arguments)};function $(e,t){return t?Object.keys(e).reduce((function(n,r){var o,i;return n[r]=(o=e[r],(i=t[r])?X(X(X({},o||{}),i||{}),Object.keys(o).reduce((function(e,t){return e[t]=X(X({},o[t]),i[t]||{}),e}),{})):o),n}),X({},e)):e}function Z(e){return void 0===e&&(e={number:{},dateTime:{},pluralRules:{}}),{getNumberFormat:S(Intl.NumberFormat,e.number),getDateTimeFormat:S(Intl.DateTimeFormat,e.dateTime),getPluralRules:S(Intl.PluralRules,e.pluralRules)}}var J=function(){function e(t,n,r,o){var i=this;if(void 0===n&&(n=e.defaultLocale),this.formatterCache={number:{},dateTime:{},pluralRules:{}},this.format=function(e){return U(i.ast,i.locales,i.formatters,i.formats,e,i.message)},this.formatToParts=function(e){return F(i.ast,i.locales,i.formatters,i.formats,e,void 0,i.message)},this.formatHTMLMessage=function(e){return K(i.ast,i.locales,i.formatters,i.formats,e,i.message)},this.resolvedOptions=function(){return{locale:Intl.NumberFormat.supportedLocalesOf(i.locales)[0]}},this.getAst=function(){return i.ast},"string"===typeof t){if(this.message=t,!e.__parse)throw new TypeError("IntlMessageFormat.__parse must be set to process `message` of type `string`");this.ast=e.__parse(t,{normalizeHashtagInPlural:!1})}else this.ast=t;if(!Array.isArray(this.ast))throw new TypeError("A message must be provided as a String or AST.");this.formats=$(e.formats,r),this.locales=n,this.formatters=o&&o.formatters||Z(this.formatterCache)}return e.defaultLocale=(new Intl.NumberFormat).resolvedOptions().locale,e.__parse=C,e.formats={number:{currency:{style:"currency"},percent:{style:"percent"}},date:{short:{month:"numeric",day:"numeric",year:"2-digit"},medium:{month:"short",day:"numeric",year:"numeric"},long:{month:"long",day:"numeric",year:"numeric"},full:{weekday:"long",month:"long",day:"numeric",year:"numeric"}},time:{short:{hour:"numeric",minute:"numeric"},medium:{hour:"numeric",minute:"numeric",second:"numeric"},long:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"},full:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"}}},e}(),Q=J},83163:function(e,t,n){e=n.nmd(e);var r="__lodash_hash_undefined__",o=9007199254740991,i="[object Arguments]",a="[object AsyncFunction]",s="[object Function]",l="[object GeneratorFunction]",c="[object Null]",u="[object Object]",d="[object Proxy]",p="[object Undefined]",h=/^\[object .+?Constructor\]$/,f=/^(?:0|[1-9]\d*)$/,m={};m["[object Float32Array]"]=m["[object Float64Array]"]=m["[object Int8Array]"]=m["[object Int16Array]"]=m["[object Int32Array]"]=m["[object Uint8Array]"]=m["[object Uint8ClampedArray]"]=m["[object Uint16Array]"]=m["[object Uint32Array]"]=!0,m[i]=m["[object Array]"]=m["[object ArrayBuffer]"]=m["[object Boolean]"]=m["[object DataView]"]=m["[object Date]"]=m["[object Error]"]=m[s]=m["[object Map]"]=m["[object Number]"]=m[u]=m["[object RegExp]"]=m["[object Set]"]=m["[object String]"]=m["[object WeakMap]"]=!1;var g="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,v="object"==typeof self&&self&&self.Object===Object&&self,y=g||v||Function("return this")(),x=t&&!t.nodeType&&t,A=x&&e&&!e.nodeType&&e,C=A&&A.exports===x,b=C&&g.process,w=function(){try{var e=A&&A.require&&A.require("util").types;return e||b&&b.binding&&b.binding("util")}catch(t){}}(),S=w&&w.isTypedArray;var D,k,M=Array.prototype,j=Function.prototype,I=Object.prototype,_=y["__core-js_shared__"],P=j.toString,N=I.hasOwnProperty,O=function(){var e=/[^.]+$/.exec(_&&_.keys&&_.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),T=I.toString,E=P.call(Object),R=RegExp("^"+P.call(N).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),L=C?y.Buffer:void 0,F=y.Symbol,U=y.Uint8Array,B=L?L.allocUnsafe:void 0,Y=(D=Object.getPrototypeOf,k=Object,function(e){return D(k(e))}),q=Object.create,H=I.propertyIsEnumerable,G=M.splice,z=F?F.toStringTag:void 0,V=function(){try{var e=ye(Object,"defineProperty");return e({},"",{}),e}catch(t){}}(),W=L?L.isBuffer:void 0,K=Math.max,X=Date.now,$=ye(y,"Map"),Z=ye(Object,"create"),J=function(){function e(){}return function(t){if(!_e(t))return{};if(q)return q(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function Q(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function ee(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function te(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function ne(e){var t=this.__data__=new ee(e);this.size=t.size}function re(e,t){var n=De(e),r=!n&&Se(e),o=!n&&!r&&Me(e),i=!n&&!r&&!o&&Ne(e),a=n||r||o||i,s=a?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],l=s.length;for(var c in e)!t&&!N.call(e,c)||a&&("length"==c||o&&("offset"==c||"parent"==c)||i&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||xe(c,l))||s.push(c);return s}function oe(e,t,n){(void 0!==n&&!we(e[t],n)||void 0===n&&!(t in e))&&se(e,t,n)}function ie(e,t,n){var r=e[t];N.call(e,t)&&we(r,n)&&(void 0!==n||t in e)||se(e,t,n)}function ae(e,t){for(var n=e.length;n--;)if(we(e[n][0],t))return n;return-1}function se(e,t,n){"__proto__"==t&&V?V(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}Q.prototype.clear=function(){this.__data__=Z?Z(null):{},this.size=0},Q.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Q.prototype.get=function(e){var t=this.__data__;if(Z){var n=t[e];return n===r?void 0:n}return N.call(t,e)?t[e]:void 0},Q.prototype.has=function(e){var t=this.__data__;return Z?void 0!==t[e]:N.call(t,e)},Q.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Z&&void 0===t?r:t,this},ee.prototype.clear=function(){this.__data__=[],this.size=0},ee.prototype.delete=function(e){var t=this.__data__,n=ae(t,e);return!(n<0)&&(n==t.length-1?t.pop():G.call(t,n,1),--this.size,!0)},ee.prototype.get=function(e){var t=this.__data__,n=ae(t,e);return n<0?void 0:t[n][1]},ee.prototype.has=function(e){return ae(this.__data__,e)>-1},ee.prototype.set=function(e,t){var n=this.__data__,r=ae(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},te.prototype.clear=function(){this.size=0,this.__data__={hash:new Q,map:new($||ee),string:new Q}},te.prototype.delete=function(e){var t=ve(this,e).delete(e);return this.size-=t?1:0,t},te.prototype.get=function(e){return ve(this,e).get(e)},te.prototype.has=function(e){return ve(this,e).has(e)},te.prototype.set=function(e,t){var n=ve(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},ne.prototype.clear=function(){this.__data__=new ee,this.size=0},ne.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},ne.prototype.get=function(e){return this.__data__.get(e)},ne.prototype.has=function(e){return this.__data__.has(e)},ne.prototype.set=function(e,t){var n=this.__data__;if(n instanceof ee){var r=n.__data__;if(!$||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new te(r)}return n.set(e,t),this.size=n.size,this};var le,ce=function(e,t,n){for(var r=-1,o=Object(e),i=n(e),a=i.length;a--;){var s=i[le?a:++r];if(!1===t(o[s],s,o))break}return e};function ue(e){return null==e?void 0===e?p:c:z&&z in Object(e)?function(e){var t=N.call(e,z),n=e[z];try{e[z]=void 0;var r=!0}catch(i){}var o=T.call(e);r&&(t?e[z]=n:delete e[z]);return o}(e):function(e){return T.call(e)}(e)}function de(e){return Pe(e)&&ue(e)==i}function pe(e){return!(!_e(e)||function(e){return!!O&&O in e}(e))&&(je(e)?R:h).test(function(e){if(null!=e){try{return P.call(e)}catch(t){}try{return e+""}catch(t){}}return""}(e))}function he(e){if(!_e(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=Ae(e),n=[];for(var r in e)("constructor"!=r||!t&&N.call(e,r))&&n.push(r);return n}function fe(e,t,n,r,o){e!==t&&ce(t,(function(i,a){if(o||(o=new ne),_e(i))!function(e,t,n,r,o,i,a){var s=Ce(e,n),l=Ce(t,n),c=a.get(l);if(c)return void oe(e,n,c);var d=i?i(s,l,n+"",e,t,a):void 0,p=void 0===d;if(p){var h=De(l),f=!h&&Me(l),m=!h&&!f&&Ne(l);d=l,h||f||m?De(s)?d=s:Pe(g=s)&&ke(g)?d=function(e,t){var n=-1,r=e.length;t||(t=Array(r));for(;++n<r;)t[n]=e[n];return t}(s):f?(p=!1,d=function(e,t){if(t)return e.slice();var n=e.length,r=B?B(n):new e.constructor(n);return e.copy(r),r}(l,!0)):m?(p=!1,d=function(e,t){var n=t?function(e){var t=new e.constructor(e.byteLength);return new U(t).set(new U(e)),t}(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}(l,!0)):d=[]:function(e){if(!Pe(e)||ue(e)!=u)return!1;var t=Y(e);if(null===t)return!0;var n=N.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&P.call(n)==E}(l)||Se(l)?(d=s,Se(s)?d=function(e){return function(e,t,n,r){var o=!n;n||(n={});var i=-1,a=t.length;for(;++i<a;){var s=t[i],l=r?r(n[s],e[s],s,n,e):void 0;void 0===l&&(l=e[s]),o?se(n,s,l):ie(n,s,l)}return n}(e,Oe(e))}(s):_e(s)&&!je(s)||(d=function(e){return"function"!=typeof e.constructor||Ae(e)?{}:J(Y(e))}(l))):p=!1}var g;p&&(a.set(l,d),o(d,l,r,i,a),a.delete(l));oe(e,n,d)}(e,t,a,n,fe,r,o);else{var s=r?r(Ce(e,a),i,a+"",e,t,o):void 0;void 0===s&&(s=i),oe(e,a,s)}}),Oe)}function me(e,t){return be(function(e,t,n){return t=K(void 0===t?e.length-1:t,0),function(){for(var r=arguments,o=-1,i=K(r.length-t,0),a=Array(i);++o<i;)a[o]=r[t+o];o=-1;for(var s=Array(t+1);++o<t;)s[o]=r[o];return s[t]=n(a),function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}(e,this,s)}}(e,t,Re),e+"")}var ge=V?function(e,t){return V(e,"toString",{configurable:!0,enumerable:!1,value:(n=t,function(){return n}),writable:!0});var n}:Re;function ve(e,t){var n=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function ye(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return pe(n)?n:void 0}function xe(e,t){var n=typeof e;return!!(t=null==t?o:t)&&("number"==n||"symbol"!=n&&f.test(e))&&e>-1&&e%1==0&&e<t}function Ae(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||I)}function Ce(e,t){if(("constructor"!==t||"function"!==typeof e[t])&&"__proto__"!=t)return e[t]}var be=function(e){var t=0,n=0;return function(){var r=X(),o=16-(r-n);if(n=r,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(ge);function we(e,t){return e===t||e!==e&&t!==t}var Se=de(function(){return arguments}())?de:function(e){return Pe(e)&&N.call(e,"callee")&&!H.call(e,"callee")},De=Array.isArray;function ke(e){return null!=e&&Ie(e.length)&&!je(e)}var Me=W||function(){return!1};function je(e){if(!_e(e))return!1;var t=ue(e);return t==s||t==l||t==a||t==d}function Ie(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=o}function _e(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Pe(e){return null!=e&&"object"==typeof e}var Ne=S?function(e){return function(t){return e(t)}}(S):function(e){return Pe(e)&&Ie(e.length)&&!!m[ue(e)]};function Oe(e){return ke(e)?re(e,!0):he(e)}var Te,Ee=(Te=function(e,t,n){fe(e,t,n)},me((function(e,t){var n=-1,r=t.length,o=r>1?t[r-1]:void 0,i=r>2?t[2]:void 0;for(o=Te.length>3&&"function"==typeof o?(r--,o):void 0,i&&function(e,t,n){if(!_e(n))return!1;var r=typeof t;return!!("number"==r?ke(n)&&xe(t,n.length):"string"==r&&t in n)&&we(n[t],e)}(t[0],t[1],i)&&(o=r<3?void 0:o,r=1),e=Object(e);++n<r;){var a=t[n];a&&Te(e,a,n,o)}return e})));function Re(e){return e}e.exports=Ee},65507:function(e){e.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},83107:function(e,t,n){var r=n(11049);e.exports=function(e,t){return!!(null==e?0:e.length)&&r(e,t,0)>-1}},23259:function(e){e.exports=function(e,t,n){for(var r=-1,o=null==e?0:e.length;++r<o;)if(n(t,e[r]))return!0;return!1}},25901:function(e,t,n){var r=n(36669),o=n(83107),i=n(23259),a=n(61570),s=n(35639),l=n(63445);e.exports=function(e,t,n,c){var u=-1,d=o,p=!0,h=e.length,f=[],m=t.length;if(!h)return f;n&&(t=a(t,s(n))),c?(d=i,p=!1):t.length>=200&&(d=l,p=!1,t=new r(t));e:for(;++u<h;){var g=e[u],v=null==n?g:n(g);if(g=c||0!==g?g:0,p&&v===v){for(var y=m;y--;)if(t[y]===v)continue e;f.push(g)}else d(t,v,c)||f.push(g)}return f}},6993:function(e){e.exports=function(e,t,n,r){for(var o=e.length,i=n+(r?1:-1);r?i--:++i<o;)if(t(e[i],i,e))return i;return-1}},26810:function(e,t,n){var r=n(87518),o=n(97989);e.exports=function e(t,n,i,a,s){var l=-1,c=t.length;for(i||(i=o),s||(s=[]);++l<c;){var u=t[l];n>0&&i(u)?n>1?e(u,n-1,i,a,s):r(s,u):a||(s[s.length]=u)}return s}},11049:function(e,t,n){var r=n(6993),o=n(85381),i=n(97825);e.exports=function(e,t,n){return t===t?i(e,t,n):r(e,o,n)}},96255:function(e,t,n){var r=n(36669),o=n(83107),i=n(23259),a=n(61570),s=n(35639),l=n(63445),c=Math.min;e.exports=function(e,t,n){for(var u=n?i:o,d=e[0].length,p=e.length,h=p,f=Array(p),m=1/0,g=[];h--;){var v=e[h];h&&t&&(v=a(v,s(t))),m=c(v.length,m),f[h]=!n&&(t||d>=120&&v.length>=120)?new r(h&&v):void 0}v=e[0];var y=-1,x=f[0];e:for(;++y<d&&g.length<m;){var A=v[y],C=t?t(A):A;if(A=n||0!==A?A:0,!(x?l(x,C):u(g,C,n))){for(h=p;--h;){var b=f[h];if(!(b?l(b,C):u(e[h],C,n)))continue e}x&&x.push(C),g.push(A)}}return g}},85381:function(e){e.exports=function(e){return e!==e}},80516:function(e,t,n){var r=n(69002),o=n(24295),i=n(1043);e.exports=function(e,t){return i(o(e,t,r),e+"")}},65148:function(e,t,n){var r=n(96800),o=n(88925),i=n(69002),a=o?function(e,t){return o(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:i;e.exports=a},88183:function(e,t,n){var r=n(36669),o=n(83107),i=n(23259),a=n(63445),s=n(3739),l=n(26557);e.exports=function(e,t,n){var c=-1,u=o,d=e.length,p=!0,h=[],f=h;if(n)p=!1,u=i;else if(d>=200){var m=t?null:s(e);if(m)return l(m);p=!1,u=a,f=new r}else f=t?[]:h;e:for(;++c<d;){var g=e[c],v=t?t(g):g;if(g=n||0!==g?g:0,p&&v===v){for(var y=f.length;y--;)if(f[y]===v)continue e;t&&f.push(v),h.push(g)}else u(f,v,n)||(f!==h&&f.push(v),h.push(g))}return h}},31849:function(e,t,n){var r=n(25901),o=n(26810),i=n(88183);e.exports=function(e,t,n){var a=e.length;if(a<2)return a?i(e[0]):[];for(var s=-1,l=Array(a);++s<a;)for(var c=e[s],u=-1;++u<a;)u!=s&&(l[s]=r(l[s]||c,e[u],t,n));return i(o(l,1),t,n)}},77795:function(e,t,n){var r=n(53815);e.exports=function(e){return r(e)?e:[]}},3739:function(e,t,n){var r=n(57887),o=n(19208),i=n(26557),a=r&&1/i(new r([,-0]))[1]==1/0?function(e){return new r(e)}:o;e.exports=a},97989:function(e,t,n){var r=n(4635),o=n(24578),i=n(12279),a=r?r.isConcatSpreadable:void 0;e.exports=function(e){return i(e)||o(e)||!!(a&&e&&e[a])}},99042:function(e,t,n){var r=n(44206),o=n(97840),i=n(97059),a=n(24567);e.exports=function(e,t,n){if(!a(n))return!1;var s=typeof t;return!!("number"==s?o(n)&&i(t,n.length):"string"==s&&t in n)&&r(n[t],e)}},24295:function(e,t,n){var r=n(65507),o=Math.max;e.exports=function(e,t,n){return t=o(void 0===t?e.length-1:t,0),function(){for(var i=arguments,a=-1,s=o(i.length-t,0),l=Array(s);++a<s;)l[a]=i[t+a];a=-1;for(var c=Array(t+1);++a<t;)c[a]=i[a];return c[t]=n(l),r(e,this,c)}}},1043:function(e,t,n){var r=n(65148),o=n(42929)(r);e.exports=o},42929:function(e){var t=Date.now;e.exports=function(e){var n=0,r=0;return function(){var o=t(),i=16-(o-r);if(r=o,i>0){if(++n>=800)return arguments[0]}else n=0;return e.apply(void 0,arguments)}}},97825:function(e){e.exports=function(e,t,n){for(var r=n-1,o=e.length;++r<o;)if(e[r]===t)return r;return-1}},96800:function(e){e.exports=function(e){return function(){return e}}},70210:function(e,t,n){var r=n(80516),o=n(44206),i=n(99042),a=n(31235),s=Object.prototype,l=s.hasOwnProperty,c=r((function(e,t){e=Object(e);var n=-1,r=t.length,c=r>2?t[2]:void 0;for(c&&i(t[0],t[1],c)&&(r=1);++n<r;)for(var u=t[n],d=a(u),p=-1,h=d.length;++p<h;){var f=d[p],m=e[f];(void 0===m||o(m,s[f])&&!l.call(e,f))&&(e[f]=u[f])}return e}));e.exports=c},92437:function(e,t,n){var r=n(61570),o=n(96255),i=n(80516),a=n(77795),s=i((function(e){var t=r(e,a);return t.length&&t[0]===e[0]?o(t):[]}));e.exports=s},53815:function(e,t,n){var r=n(97840),o=n(39248);e.exports=function(e){return o(e)&&r(e)}},19208:function(e){e.exports=function(){}},92177:function(e,t,n){var r=n(26810),o=n(80516),i=n(88183),a=n(53815),s=o((function(e){return i(r(e,1,a,!0))}));e.exports=s},74650:function(e,t,n){var r=n(25901),o=n(80516),i=n(53815),a=o((function(e,t){return i(e)?r(e,t):[]}));e.exports=a},73747:function(e,t,n){var r=n(46860),o=n(80516),i=n(31849),a=n(53815),s=o((function(e){return i(r(e,a))}));e.exports=s},71914:function(e,t){t.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},t.decode=function(e){for(var t={},n=e.split("&"),r=0,o=n.length;r<o;r++){var i=n[r].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}},20204:function(e){var t=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,n=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var r=e,o=e.indexOf("["),i=e.indexOf("]");-1!=o&&-1!=i&&(e=e.substring(0,o)+e.substring(o,i).replace(/:/g,";")+e.substring(i,e.length));for(var a=t.exec(e||""),s={},l=14;l--;)s[n[l]]=a[l]||"";return-1!=o&&-1!=i&&(s.source=r,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s.pathNames=function(e,t){var n=/\/{2,9}/g,r=t.replace(n,"/").split("/");"/"!=t.substr(0,1)&&0!==t.length||r.splice(0,1);"/"==t.substr(t.length-1,1)&&r.splice(r.length-1,1);return r}(0,s.path),s.queryKey=function(e,t){var n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,r){t&&(n[t]=r)})),n}(0,s.query),s}},67999:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSafari=t.isFirefox=void 0;var r,o=n(42434),i=(r=o)&&r.__esModule?r:{default:r};t.isFirefox=(0,i.default)((function(){return/firefox/i.test(navigator.userAgent)})),t.isSafari=(0,i.default)((function(){return Boolean(window.safari)}))},67302:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=a(n(92177)),i=a(n(74650));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.entered=[]}return r(e,[{key:"enter",value:function(e){var t=this.entered.length;return this.entered=(0,o.default)(this.entered.filter((function(t){return document.documentElement.contains(t)&&(!t.contains||t.contains(e))})),[e]),0===t&&this.entered.length>0}},{key:"leave",value:function(e){var t=this.entered.length;return this.entered=(0,i.default)(this.entered.filter((function(e){return document.documentElement.contains(e)})),e),t>0&&0===this.entered.length}},{key:"reset",value:function(){this.entered=[]}}]),e}();t.default=s},73429:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=d(n(70210)),i=d(n(60157)),a=d(n(67302)),s=n(67999),l=n(94041),c=n(60204),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(55077));function d(e){return e&&e.__esModule?e:{default:e}}var p=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.actions=t.getActions(),this.monitor=t.getMonitor(),this.registry=t.getRegistry(),this.context=t.getContext(),this.sourcePreviewNodes={},this.sourcePreviewNodeOptions={},this.sourceNodes={},this.sourceNodeOptions={},this.enterLeaveCounter=new a.default,this.dragStartSourceIds=[],this.dropTargetIds=[],this.dragEnterTargetIds=[],this.currentNativeSource=null,this.currentNativeHandle=null,this.currentDragSourceNode=null,this.currentDragSourceNodeOffset=null,this.currentDragSourceNodeOffsetChanged=!1,this.altKeyPressed=!1,this.mouseMoveTimeoutTimer=null,this.getSourceClientOffset=this.getSourceClientOffset.bind(this),this.handleTopDragStart=this.handleTopDragStart.bind(this),this.handleTopDragStartCapture=this.handleTopDragStartCapture.bind(this),this.handleTopDragEndCapture=this.handleTopDragEndCapture.bind(this),this.handleTopDragEnter=this.handleTopDragEnter.bind(this),this.handleTopDragEnterCapture=this.handleTopDragEnterCapture.bind(this),this.handleTopDragLeaveCapture=this.handleTopDragLeaveCapture.bind(this),this.handleTopDragOver=this.handleTopDragOver.bind(this),this.handleTopDragOverCapture=this.handleTopDragOverCapture.bind(this),this.handleTopDrop=this.handleTopDrop.bind(this),this.handleTopDropCapture=this.handleTopDropCapture.bind(this),this.handleSelectStart=this.handleSelectStart.bind(this),this.endDragIfSourceWasRemovedFromDOM=this.endDragIfSourceWasRemovedFromDOM.bind(this),this.endDragNativeItem=this.endDragNativeItem.bind(this),this.asyncEndDragNativeItem=this.asyncEndDragNativeItem.bind(this),this.isNodeInDocument=this.isNodeInDocument.bind(this)}return r(e,[{key:"setup",value:function(){if(void 0!==this.window){if(this.window.__isReactDndBackendSetUp)throw new Error("Cannot have two HTML5 backends at the same time.");this.window.__isReactDndBackendSetUp=!0,this.addEventListeners(this.window)}}},{key:"teardown",value:function(){void 0!==this.window&&(this.window.__isReactDndBackendSetUp=!1,this.removeEventListeners(this.window),this.clearCurrentDragSourceNode(),this.asyncEndDragFrameId&&this.window.cancelAnimationFrame(this.asyncEndDragFrameId))}},{key:"addEventListeners",value:function(e){e.addEventListener&&(e.addEventListener("dragstart",this.handleTopDragStart),e.addEventListener("dragstart",this.handleTopDragStartCapture,!0),e.addEventListener("dragend",this.handleTopDragEndCapture,!0),e.addEventListener("dragenter",this.handleTopDragEnter),e.addEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.addEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.addEventListener("dragover",this.handleTopDragOver),e.addEventListener("dragover",this.handleTopDragOverCapture,!0),e.addEventListener("drop",this.handleTopDrop),e.addEventListener("drop",this.handleTopDropCapture,!0))}},{key:"removeEventListeners",value:function(e){e.removeEventListener&&(e.removeEventListener("dragstart",this.handleTopDragStart),e.removeEventListener("dragstart",this.handleTopDragStartCapture,!0),e.removeEventListener("dragend",this.handleTopDragEndCapture,!0),e.removeEventListener("dragenter",this.handleTopDragEnter),e.removeEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.removeEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.removeEventListener("dragover",this.handleTopDragOver),e.removeEventListener("dragover",this.handleTopDragOverCapture,!0),e.removeEventListener("drop",this.handleTopDrop),e.removeEventListener("drop",this.handleTopDropCapture,!0))}},{key:"connectDragPreview",value:function(e,t,n){var r=this;return this.sourcePreviewNodeOptions[e]=n,this.sourcePreviewNodes[e]=t,function(){delete r.sourcePreviewNodes[e],delete r.sourcePreviewNodeOptions[e]}}},{key:"connectDragSource",value:function(e,t,n){var r=this;this.sourceNodes[e]=t,this.sourceNodeOptions[e]=n;var o=function(t){return r.handleDragStart(t,e)},i=function(t){return r.handleSelectStart(t,e)};return t.setAttribute("draggable",!0),t.addEventListener("dragstart",o),t.addEventListener("selectstart",i),function(){delete r.sourceNodes[e],delete r.sourceNodeOptions[e],t.removeEventListener("dragstart",o),t.removeEventListener("selectstart",i),t.setAttribute("draggable",!1)}}},{key:"connectDropTarget",value:function(e,t){var n=this,r=function(t){return n.handleDragEnter(t,e)},o=function(t){return n.handleDragOver(t,e)},i=function(t){return n.handleDrop(t,e)};return t.addEventListener("dragenter",r),t.addEventListener("dragover",o),t.addEventListener("drop",i),function(){t.removeEventListener("dragenter",r),t.removeEventListener("dragover",o),t.removeEventListener("drop",i)}}},{key:"getCurrentSourceNodeOptions",value:function(){var e=this.monitor.getSourceId(),t=this.sourceNodeOptions[e];return(0,o.default)(t||{},{dropEffect:this.altKeyPressed?"copy":"move"})}},{key:"getCurrentDropEffect",value:function(){return this.isDraggingNativeItem()?"copy":this.getCurrentSourceNodeOptions().dropEffect}},{key:"getCurrentSourcePreviewNodeOptions",value:function(){var e=this.monitor.getSourceId(),t=this.sourcePreviewNodeOptions[e];return(0,o.default)(t||{},{anchorX:.5,anchorY:.5,captureDraggingState:!1})}},{key:"getSourceClientOffset",value:function(e){return(0,l.getNodeClientOffset)(this.sourceNodes[e])}},{key:"isDraggingNativeItem",value:function(){var e=this.monitor.getItemType();return Object.keys(u).some((function(t){return u[t]===e}))}},{key:"beginDragNativeItem",value:function(e){this.clearCurrentDragSourceNode();var t=(0,c.createNativeDragSource)(e);this.currentNativeSource=new t,this.currentNativeHandle=this.registry.addSource(e,this.currentNativeSource),this.actions.beginDrag([this.currentNativeHandle])}},{key:"asyncEndDragNativeItem",value:function(){this.asyncEndDragFrameId=this.window.requestAnimationFrame(this.endDragNativeItem)}},{key:"endDragNativeItem",value:function(){this.isDraggingNativeItem()&&(this.actions.endDrag(),this.registry.removeSource(this.currentNativeHandle),this.currentNativeHandle=null,this.currentNativeSource=null)}},{key:"isNodeInDocument",value:function(e){return!(!document.body.contains(e)&&!this.window)&&this.window.document.body.contains(e)}},{key:"endDragIfSourceWasRemovedFromDOM",value:function(){var e=this.currentDragSourceNode;this.isNodeInDocument(e)||this.clearCurrentDragSourceNode()&&this.actions.endDrag()}},{key:"setCurrentDragSourceNode",value:function(e){var t=this;this.clearCurrentDragSourceNode(),this.currentDragSourceNode=e,this.currentDragSourceNodeOffset=(0,l.getNodeClientOffset)(e),this.currentDragSourceNodeOffsetChanged=!1;this.mouseMoveTimeoutTimer=setTimeout((function(){return t.mouseMoveTimeoutId=null,t.window.addEventListener("mousemove",t.endDragIfSourceWasRemovedFromDOM,!0)}),1e3)}},{key:"clearCurrentDragSourceNode",value:function(){return!!this.currentDragSourceNode&&(this.currentDragSourceNode=null,this.currentDragSourceNodeOffset=null,this.currentDragSourceNodeOffsetChanged=!1,this.window.clearTimeout(this.mouseMoveTimeoutTimer),this.window.removeEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0),this.mouseMoveTimeoutTimer=null,!0)}},{key:"checkIfCurrentDragSourceRectChanged",value:function(){var e=this.currentDragSourceNode;return!!e&&(!!this.currentDragSourceNodeOffsetChanged||(this.currentDragSourceNodeOffsetChanged=!(0,i.default)((0,l.getNodeClientOffset)(e),this.currentDragSourceNodeOffset),this.currentDragSourceNodeOffsetChanged))}},{key:"handleTopDragStartCapture",value:function(){this.clearCurrentDragSourceNode(),this.dragStartSourceIds=[]}},{key:"handleDragStart",value:function(e,t){this.dragStartSourceIds.unshift(t)}},{key:"handleTopDragStart",value:function(e){var t=this,n=this.dragStartSourceIds;this.dragStartSourceIds=null;var r=(0,l.getEventClientOffset)(e);this.monitor.isDragging()&&this.actions.endDrag(),this.actions.beginDrag(n,{publishSource:!1,getSourceClientOffset:this.getSourceClientOffset,clientOffset:r});var o=e.dataTransfer,i=(0,c.matchNativeItemType)(o);if(this.monitor.isDragging()){if("function"===typeof o.setDragImage){var a=this.monitor.getSourceId(),s=this.sourceNodes[a],u=this.sourcePreviewNodes[a]||s,d=this.getCurrentSourcePreviewNodeOptions(),p={anchorX:d.anchorX,anchorY:d.anchorY},h={offsetX:d.offsetX,offsetY:d.offsetY},f=(0,l.getDragPreviewOffset)(s,u,r,p,h);o.setDragImage(u,f.x,f.y)}try{o.setData("application/json",{})}catch(m){}this.setCurrentDragSourceNode(e.target),this.getCurrentSourcePreviewNodeOptions().captureDraggingState?this.actions.publishDragSource():setTimeout((function(){return t.actions.publishDragSource()}))}else if(i)this.beginDragNativeItem(i);else{if(!(o.types||e.target.hasAttribute&&e.target.hasAttribute("draggable")))return;e.preventDefault()}}},{key:"handleTopDragEndCapture",value:function(){this.clearCurrentDragSourceNode()&&this.actions.endDrag()}},{key:"handleTopDragEnterCapture",value:function(e){if(this.dragEnterTargetIds=[],this.enterLeaveCounter.enter(e.target)&&!this.monitor.isDragging()){var t=e.dataTransfer,n=(0,c.matchNativeItemType)(t);n&&this.beginDragNativeItem(n)}}},{key:"handleDragEnter",value:function(e,t){this.dragEnterTargetIds.unshift(t)}},{key:"handleTopDragEnter",value:function(e){var t=this,n=this.dragEnterTargetIds;(this.dragEnterTargetIds=[],this.monitor.isDragging())&&(this.altKeyPressed=e.altKey,(0,s.isFirefox)()||this.actions.hover(n,{clientOffset:(0,l.getEventClientOffset)(e)}),n.some((function(e){return t.monitor.canDropOnTarget(e)}))&&(e.preventDefault(),e.dataTransfer.dropEffect=this.getCurrentDropEffect()))}},{key:"handleTopDragOverCapture",value:function(){this.dragOverTargetIds=[]}},{key:"handleDragOver",value:function(e,t){this.dragOverTargetIds.unshift(t)}},{key:"handleTopDragOver",value:function(e){var t=this,n=this.dragOverTargetIds;if(this.dragOverTargetIds=[],!this.monitor.isDragging())return e.preventDefault(),void(e.dataTransfer.dropEffect="none");this.altKeyPressed=e.altKey,this.actions.hover(n,{clientOffset:(0,l.getEventClientOffset)(e)}),n.some((function(e){return t.monitor.canDropOnTarget(e)}))?(e.preventDefault(),e.dataTransfer.dropEffect=this.getCurrentDropEffect()):this.isDraggingNativeItem()?(e.preventDefault(),e.dataTransfer.dropEffect="none"):this.checkIfCurrentDragSourceRectChanged()&&(e.preventDefault(),e.dataTransfer.dropEffect="move")}},{key:"handleTopDragLeaveCapture",value:function(e){this.isDraggingNativeItem()&&e.preventDefault(),this.enterLeaveCounter.leave(e.target)&&this.isDraggingNativeItem()&&this.endDragNativeItem()}},{key:"handleTopDropCapture",value:function(e){this.dropTargetIds=[],e.preventDefault(),this.isDraggingNativeItem()&&this.currentNativeSource.mutateItemByReadingDataTransfer(e.dataTransfer),this.enterLeaveCounter.reset()}},{key:"handleDrop",value:function(e,t){this.dropTargetIds.unshift(t)}},{key:"handleTopDrop",value:function(e){var t=this.dropTargetIds;this.dropTargetIds=[],this.actions.hover(t,{clientOffset:(0,l.getEventClientOffset)(e)}),this.actions.drop({dropEffect:this.getCurrentDropEffect()}),this.isDraggingNativeItem()?this.endDragNativeItem():this.endDragIfSourceWasRemovedFromDOM()}},{key:"handleSelectStart",value:function(e){var t=e.target;"function"===typeof t.dragDrop&&("INPUT"===t.tagName||"SELECT"===t.tagName||"TEXTAREA"===t.tagName||t.isContentEditable||(e.preventDefault(),t.dragDrop()))}},{key:"window",get:function(){return this.context&&this.context.window?this.context.window:"undefined"!==typeof window?window:void 0}}]),e}();t.default=p},63531:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var r=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);for(var r=t.length,o=[],i=0;i<r;i++)o.push(i);o.sort((function(e,n){return t[e]<t[n]?-1:1}));for(var a=[],s=[],l=[],c=void 0,u=void 0,d=0;d<r-1;d++)c=t[d+1]-t[d],u=n[d+1]-n[d],s.push(c),a.push(u),l.push(u/c);for(var p=[l[0]],h=0;h<s.length-1;h++){var f=l[h],m=l[h+1];if(f*m<=0)p.push(0);else{c=s[h];var g=s[h+1],v=c+g;p.push(3*v/((v+g)/f+(v+c)/m))}}p.push(l[l.length-1]);for(var y=[],x=[],A=void 0,C=0;C<p.length-1;C++){A=l[C];var b=p[C],w=1/s[C],S=b+p[C+1]-A-A;y.push((A-b-S)*w),x.push(S*w*w)}this.xs=t,this.ys=n,this.c1s=p,this.c2s=y,this.c3s=x}return n(e,[{key:"interpolate",value:function(e){var t=this.xs,n=this.ys,r=this.c1s,o=this.c2s,i=this.c3s,a=t.length-1;if(e===t[a])return n[a];for(var s=0,l=i.length-1,c=void 0;s<=l;){var u=t[c=Math.floor(.5*(s+l))];if(u<e)s=c+1;else{if(!(u>e))return n[c];l=c-1}}var d=e-t[a=Math.max(0,l)],p=d*d;return n[a]+r[a]*d+o[a]*p+i[a]*d*p}}]),e}();t.default=r},60204:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.createNativeDragSource=function(e){var t=l[e],n=t.exposeProperty,r=t.matchesTypes,i=t.getData;return function(){function e(){var t,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.item=(t={},(r={})[n]=r[n]||{},r[n].get=function(){return console.warn("Browser doesn't allow reading \""+n+'" until the drop event.'),null},function(e,t){for(var n in t){var r=t[n];r.configurable=r.enumerable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,n,r)}}(t,r),t)}return o(e,[{key:"mutateItemByReadingDataTransfer",value:function(e){delete this.item[n],this.item[n]=i(e,r)}},{key:"canDrag",value:function(){return!0}},{key:"beginDrag",value:function(){return this.item}},{key:"isDragging",value:function(e,t){return t===e.getSourceId()}},{key:"endDrag",value:function(){}}]),e}()},t.matchNativeItemType=function(e){var t=Array.prototype.slice.call(e.types||[]);return Object.keys(l).filter((function(e){return l[e].matchesTypes.some((function(e){return t.indexOf(e)>-1}))}))[0]||null};var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(55077));function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t,n){var r=t.reduce((function(t,n){return t||e.getData(n)}),null);return null!=r?r:n}var l=(a(r={},i.FILE,{exposeProperty:"files",matchesTypes:["Files"],getData:function(e){return Array.prototype.slice.call(e.files)}}),a(r,i.URL,{exposeProperty:"urls",matchesTypes:["Url","text/uri-list"],getData:function(e,t){return s(e,t,"").split("\n")}}),a(r,i.TEXT,{exposeProperty:"text",matchesTypes:["Text","text/plain"],getData:function(e,t){return s(e,t,"")}}),r)},55077:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FILE="__NATIVE_FILE__",t.URL="__NATIVE_URL__",t.TEXT="__NATIVE_TEXT__"},94041:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNodeClientOffset=l,t.getEventClientOffset=function(e){return{x:e.clientX,y:e.clientY}},t.getDragPreviewOffset=function(e,t,n,r,i){var s=(C=t,"IMG"===C.nodeName&&((0,o.isFirefox)()||!document.documentElement.contains(C))),c=l(s?e:t),u={x:n.x-c.x,y:n.y-c.y},d=e.offsetWidth,p=e.offsetHeight,h=r.anchorX,f=r.anchorY,m=function(e,t,n,r){var i=e?t.width:n,a=e?t.height:r;(0,o.isSafari)()&&e&&(a/=window.devicePixelRatio,i/=window.devicePixelRatio);return{dragPreviewWidth:i,dragPreviewHeight:a}}(s,t,d,p),g=m.dragPreviewWidth,v=m.dragPreviewHeight,y=i.offsetX,x=i.offsetY,A=0===x||x;var C;return{x:0===y||y?y:new a.default([0,.5,1],[u.x,u.x/d*g,u.x+g-d]).interpolate(h),y:A?x:function(){var e=new a.default([0,.5,1],[u.y,u.y/p*v,u.y+v-p]).interpolate(f);return(0,o.isSafari)()&&s&&(e+=(window.devicePixelRatio-1)*v),e}()}};var r,o=n(67999),i=n(63531),a=(r=i)&&r.__esModule?r:{default:r};var s=1;function l(e){var t=e.nodeType===s?e:e.parentElement;if(!t)return null;var n=t.getBoundingClientRect(),r=n.top;return{x:n.left,y:r}}},47535:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){n||((n=new Image).src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==");return n};var n=void 0},2009:function(e,t,n){"use strict";t.Ay=function(e){return new r.default(e)};var r=i(n(73429)),o=i(n(47535));function i(e){return e&&e.__esModule?e:{default:e}}(function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);t.default=e})(n(55077)),o.default},60157:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(e===t)return!0;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(var o=Object.prototype.hasOwnProperty,i=0;i<n.length;i+=1){if(!o.call(t,n[i])||e[n[i]]!==t[n[i]])return!1;if(e[n[i]]!==t[n[i]])return!1}return!0}},45615:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unpackBackendForEs5Users=t.createChildContext=t.CHILD_CONTEXT_TYPES=void 0;var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.default=function(e){p.default.apply(void 0,["DragDropContext","backend"].concat(Array.prototype.slice.call(arguments)));var t=g(e),n=m(t);return function(e){var t,i,l=e.displayName||e.name||"Component",c=(i=t=function(t){function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(i.__proto__||Object.getPrototypeOf(i)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(i,t),o(i,[{key:"getDecoratedComponentInstance",value:function(){return(0,u.default)(this.child,"In order to access an instance of the decorated component it can not be a stateless component."),this.child}},{key:"getManager",value:function(){return n.dragDropManager}},{key:"getChildContext",value:function(){return n}},{key:"render",value:function(){var t=this;return s.default.createElement(e,r({},this.props,{ref:function(e){t.child=e}}))}}]),i}(a.Component),t.DecoratedComponent=e,t.displayName="DragDropContext("+l+")",t.childContextTypes=f,i);return(0,d.default)(c,e)}};var a=n(9950),s=h(a),l=h(n(11942)),c=n(49461),u=h(n(10949)),d=h(n(23876)),p=h(n(33884));function h(e){return e&&e.__esModule?e:{default:e}}var f=t.CHILD_CONTEXT_TYPES={dragDropManager:l.default.object.isRequired},m=t.createChildContext=function(e,t){return{dragDropManager:new c.DragDropManager(e,t)}},g=t.unpackBackendForEs5Users=function(e){var t=e;return"object"===("undefined"===typeof t?"undefined":i(t))&&"function"===typeof t.default&&(t=t.default),(0,u.default)("function"===typeof t,"Expected the backend to be a function or an ES6 module exporting a default function. Read more: http://react-dnd.github.io/react-dnd/docs-drag-drop-context.html"),t}},4142:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o,i,a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(9950),l=n(11942),c=(i=l)&&i.__esModule?i:{default:i},u=n(45615);var d=(o=r=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.backend=(0,u.unpackBackendForEs5Users)(e.backend),r.childContext=(0,u.createChildContext)(r.backend,{window:e&&e.window?e.window:n&&n.window?n.window:"undefined"!==typeof window?window:void 0}),r}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentWillReceiveProps",value:function(e){if(e.backend!==this.props.backend||e.window!==this.props.window)throw new Error("DragDropContextProvider backend and window props must not change.")}},{key:"getChildContext",value:function(){return this.childContext}},{key:"render",value:function(){return s.Children.only(this.props.children)}}]),t}(s.Component),r.propTypes={backend:c.default.oneOfType([c.default.func,c.default.object]).isRequired,children:c.default.element.isRequired,window:c.default.object},r.defaultProps={window:void 0},r.childContextTypes=u.CHILD_CONTEXT_TYPES,r.displayName="DragDropContextProvider",r.contextTypes={window:c.default.object},o);t.default=d},59594:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return f.default.apply(void 0,["DragLayer","collect[, options]"].concat(Array.prototype.slice.call(arguments))),(0,d.default)("function"===typeof e,'Expected "collect" provided as the first argument to DragLayer to be a function that collects props to inject into the component. ',"Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs-drag-layer.html",e),(0,d.default)((0,u.default)(t),'Expected "options" provided as the second argument to DragLayer to be a plain object when specified. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs-drag-layer.html',t),function(n){var u,f,m=t.arePropsEqual,g=void 0===m?h.default:m,v=n.displayName||n.name||"Component",y=(f=u=function(t){function a(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return n.handleChange=n.handleChange.bind(n),n.manager=t.dragDropManager,(0,d.default)("object"===o(n.manager),"Could not find the drag and drop manager in the context of %s. Make sure to wrap the top-level component of your app with DragDropContext. Read more: http://react-dnd.github.io/react-dnd/docs-troubleshooting.html#could-not-find-the-drag-and-drop-manager-in-the-context",v,v),n.state=n.getCurrentState(),n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(a,t),i(a,[{key:"getDecoratedComponentInstance",value:function(){return(0,d.default)(this.child,"In order to access an instance of the decorated component it can not be a stateless component."),this.child}},{key:"shouldComponentUpdate",value:function(e,t){return!g(e,this.props)||!(0,p.default)(t,this.state)}}]),i(a,[{key:"componentDidMount",value:function(){this.isCurrentlyMounted=!0;var e=this.manager.getMonitor();this.unsubscribeFromOffsetChange=e.subscribeToOffsetChange(this.handleChange),this.unsubscribeFromStateChange=e.subscribeToStateChange(this.handleChange),this.handleChange()}},{key:"componentWillUnmount",value:function(){this.isCurrentlyMounted=!1,this.unsubscribeFromOffsetChange(),this.unsubscribeFromStateChange()}},{key:"handleChange",value:function(){if(this.isCurrentlyMounted){var e=this.getCurrentState();(0,p.default)(e,this.state)||this.setState(e)}}},{key:"getCurrentState",value:function(){var t=this.manager.getMonitor();return e(t,this.props)}},{key:"render",value:function(){var e=this;return s.default.createElement(n,r({},this.props,this.state,{ref:function(t){e.child=t}}))}}]),a}(a.Component),u.DecoratedComponent=n,u.displayName="DragLayer("+v+")",u.contextTypes={dragDropManager:l.default.object.isRequired},f);return(0,c.default)(y,n)}};var a=n(9950),s=m(a),l=m(n(11942)),c=m(n(23876)),u=m(n(75461)),d=m(n(10949)),p=m(n(90955)),h=m(n(25199)),f=m(n(33884));function m(e){return e&&e.__esModule?e:{default:e}}},50090:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var p=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};i.default.apply(void 0,["DragSource","type, spec, collect[, options]"].concat(Array.prototype.slice.call(arguments)));var h=e;"function"!==typeof e&&((0,r.default)((0,d.default)(e),'Expected "type" provided as the first argument to DragSource to be a string, or a function that returns a string given the current props. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs-drag-source.html',e),h=function(){return e});(0,r.default)((0,o.default)(t),'Expected "spec" provided as the second argument to DragSource to be a plain object. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs-drag-source.html',t);var f=(0,l.default)(t);return(0,r.default)("function"===typeof n,'Expected "collect" provided as the third argument to DragSource to be a function that returns a plain object of props to inject. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs-drag-source.html',n),(0,r.default)((0,o.default)(p),'Expected "options" provided as the fourth argument to DragSource to be a plain object when specified. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs-drag-source.html',n),function(e){return(0,a.default)({connectBackend:function(e,t){return e.connectDragSource(t)},containerDisplayName:"DragSource",createHandler:f,registerHandler:s.default,createMonitor:c.default,createConnector:u.default,DecoratedComponent:e,getType:h,collect:n,options:p})}};var r=p(n(10949)),o=p(n(75461)),i=p(n(33884)),a=p(n(46131)),s=p(n(12193)),l=p(n(90132)),c=p(n(3088)),u=p(n(64697)),d=p(n(41725));function p(e){return e&&e.__esModule?e:{default:e}}},33453:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var p=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};i.default.apply(void 0,["DropTarget","type, spec, collect[, options]"].concat(Array.prototype.slice.call(arguments)));var h=e;"function"!==typeof e&&((0,r.default)((0,d.default)(e,!0),'Expected "type" provided as the first argument to DropTarget to be a string, an array of strings, or a function that returns either given the current props. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs-drop-target.html',e),h=function(){return e});(0,r.default)((0,o.default)(t),'Expected "spec" provided as the second argument to DropTarget to be a plain object. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs-drop-target.html',t);var f=(0,l.default)(t);return(0,r.default)("function"===typeof n,'Expected "collect" provided as the third argument to DropTarget to be a function that returns a plain object of props to inject. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs-drop-target.html',n),(0,r.default)((0,o.default)(p),'Expected "options" provided as the fourth argument to DropTarget to be a plain object when specified. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs-drop-target.html',n),function(e){return(0,a.default)({connectBackend:function(e,t){return e.connectDropTarget(t)},containerDisplayName:"DropTarget",createHandler:f,registerHandler:s.default,createMonitor:c.default,createConnector:u.default,DecoratedComponent:e,getType:h,collect:n,options:p})}};var r=p(n(10949)),o=p(n(75461)),i=p(n(33884)),a=p(n(46131)),s=p(n(25113)),l=p(n(42768)),c=p(n(40780)),u=p(n(58141)),d=p(n(41725));function p(e){return e&&e.__esModule?e:{default:e}}},27817:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(t===e)return!0;return null!==t&&null!==e&&(0,i.default)(t,e)};var r,o=n(90955),i=(r=o)&&r.__esModule?r:{default:r}},64697:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=void 0,n=void 0,i=void 0,a=void 0,s=void 0,l=void 0,c=void 0;function u(){a&&(a(),a=null),t&&n&&(a=e.connectDragSource(t,n,i))}function d(){c&&(c(),c=null),t&&s&&(c=e.connectDragPreview(t,s,l))}return{receiveHandlerId:function(e){e!==t&&(t=e,u(),d())},hooks:(0,r.default)({dragSource:function(e,t){e===n&&(0,o.default)(t,i)||(n=e,i=t,u())},dragPreview:function(e,t){e===s&&(0,o.default)(t,l)||(s=e,l=t,d())}})}};var r=i(n(60460)),o=i(n(27817));function i(e){return e&&e.__esModule?e:{default:e}}},90132:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.default=function(e){Object.keys(e).forEach((function(t){(0,o.default)(a.indexOf(t)>-1,'Expected the drag source specification to only have some of the following keys: %s. Instead received a specification with an unexpected "%s" key. Read more: http://react-dnd.github.io/react-dnd/docs-drag-source.html',a.join(", "),t),(0,o.default)("function"===typeof e[t],"Expected %s in the drag source specification to be a function. Instead received a specification with %s: %s. Read more: http://react-dnd.github.io/react-dnd/docs-drag-source.html",t,t,e[t])})),s.forEach((function(t){(0,o.default)("function"===typeof e[t],"Expected %s in the drag source specification to be a function. Instead received a specification with %s: %s. Read more: http://react-dnd.github.io/react-dnd/docs-drag-source.html",t,t,e[t])}));var t=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.monitor=e,this.props=null,this.component=null}return r(t,[{key:"receiveProps",value:function(e){this.props=e}},{key:"receiveComponent",value:function(e){this.component=e}},{key:"canDrag",value:function(){return!e.canDrag||e.canDrag(this.props,this.monitor)}},{key:"isDragging",value:function(t,n){return e.isDragging?e.isDragging(this.props,this.monitor):n===t.getSourceId()}},{key:"beginDrag",value:function(){return e.beginDrag(this.props,this.monitor,this.component)}},{key:"endDrag",value:function(){e.endDrag&&e.endDrag(this.props,this.monitor,this.component)}}]),t}();return function(e){return new t(e)}};var o=i(n(10949));i(n(75461));function i(e){return e&&e.__esModule?e:{default:e}}var a=["canDrag","beginDrag","isDragging","endDrag"],s=["beginDrag"]},3088:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.default=function(e){return new c(e)};var o,i=n(10949),a=(o=i)&&o.__esModule?o:{default:o};var s=!1,l=!1,c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.internalMonitor=t.getMonitor()}return r(e,[{key:"receiveHandlerId",value:function(e){this.sourceId=e}},{key:"canDrag",value:function(){(0,a.default)(!s,"You may not call monitor.canDrag() inside your canDrag() implementation. Read more: http://react-dnd.github.io/react-dnd/docs-drag-source-monitor.html");try{return s=!0,this.internalMonitor.canDragSource(this.sourceId)}finally{s=!1}}},{key:"isDragging",value:function(){(0,a.default)(!l,"You may not call monitor.isDragging() inside your isDragging() implementation. Read more: http://react-dnd.github.io/react-dnd/docs-drag-source-monitor.html");try{return l=!0,this.internalMonitor.isDraggingSource(this.sourceId)}finally{l=!1}}},{key:"getItemType",value:function(){return this.internalMonitor.getItemType()}},{key:"getItem",value:function(){return this.internalMonitor.getItem()}},{key:"getDropResult",value:function(){return this.internalMonitor.getDropResult()}},{key:"didDrop",value:function(){return this.internalMonitor.didDrop()}},{key:"getInitialClientOffset",value:function(){return this.internalMonitor.getInitialClientOffset()}},{key:"getInitialSourceClientOffset",value:function(){return this.internalMonitor.getInitialSourceClientOffset()}},{key:"getSourceClientOffset",value:function(){return this.internalMonitor.getSourceClientOffset()}},{key:"getClientOffset",value:function(){return this.internalMonitor.getClientOffset()}},{key:"getDifferenceFromInitialOffset",value:function(){return this.internalMonitor.getDifferenceFromInitialOffset()}}]),e}()},58141:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=void 0,n=void 0,i=void 0,a=void 0;function s(){a&&(a(),a=null),t&&n&&(a=e.connectDropTarget(t,n,i))}return{receiveHandlerId:function(e){e!==t&&(t=e,s())},hooks:(0,r.default)({dropTarget:function(e,t){e===n&&(0,o.default)(t,i)||(n=e,i=t,s())}})}};var r=i(n(60460)),o=i(n(27817));function i(e){return e&&e.__esModule?e:{default:e}}},42768:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.default=function(e){Object.keys(e).forEach((function(t){(0,o.default)(a.indexOf(t)>-1,'Expected the drop target specification to only have some of the following keys: %s. Instead received a specification with an unexpected "%s" key. Read more: http://react-dnd.github.io/react-dnd/docs-drop-target.html',a.join(", "),t),(0,o.default)("function"===typeof e[t],"Expected %s in the drop target specification to be a function. Instead received a specification with %s: %s. Read more: http://react-dnd.github.io/react-dnd/docs-drop-target.html",t,t,e[t])}));var t=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.monitor=e,this.props=null,this.component=null}return r(t,[{key:"receiveProps",value:function(e){this.props=e}},{key:"receiveMonitor",value:function(e){this.monitor=e}},{key:"receiveComponent",value:function(e){this.component=e}},{key:"canDrop",value:function(){return!e.canDrop||e.canDrop(this.props,this.monitor)}},{key:"hover",value:function(){e.hover&&e.hover(this.props,this.monitor,this.component)}},{key:"drop",value:function(){if(e.drop)return e.drop(this.props,this.monitor,this.component)}}]),t}();return function(e){return new t(e)}};var o=i(n(10949));i(n(75461));function i(e){return e&&e.__esModule?e:{default:e}}var a=["canDrop","hover","drop"]},40780:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.default=function(e){return new l(e)};var o,i=n(10949),a=(o=i)&&o.__esModule?o:{default:o};var s=!1,l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.internalMonitor=t.getMonitor()}return r(e,[{key:"receiveHandlerId",value:function(e){this.targetId=e}},{key:"canDrop",value:function(){(0,a.default)(!s,"You may not call monitor.canDrop() inside your canDrop() implementation. Read more: http://react-dnd.github.io/react-dnd/docs-drop-target-monitor.html");try{return s=!0,this.internalMonitor.canDropOnTarget(this.targetId)}finally{s=!1}}},{key:"isOver",value:function(e){return this.internalMonitor.isOverTarget(this.targetId,e)}},{key:"getItemType",value:function(){return this.internalMonitor.getItemType()}},{key:"getItem",value:function(){return this.internalMonitor.getItem()}},{key:"getDropResult",value:function(){return this.internalMonitor.getDropResult()}},{key:"didDrop",value:function(){return this.internalMonitor.didDrop()}},{key:"getInitialClientOffset",value:function(){return this.internalMonitor.getInitialClientOffset()}},{key:"getInitialSourceClientOffset",value:function(){return this.internalMonitor.getInitialSourceClientOffset()}},{key:"getSourceClientOffset",value:function(){return this.internalMonitor.getSourceClientOffset()}},{key:"getClientOffset",value:function(){return this.internalMonitor.getClientOffset()}},{key:"getDifferenceFromInitialOffset",value:function(){return this.internalMonitor.getDifferenceFromInitialOffset()}}]),e}()},46131:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.default=function(e){var t,n,f=e.DecoratedComponent,g=e.createHandler,v=e.createMonitor,y=e.createConnector,x=e.registerHandler,A=e.containerDisplayName,C=e.getType,b=e.collect,w=e.options.arePropsEqual,S=void 0===w?h.default:w,D=f.displayName||f.name||"Component",k=(n=t=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.handleChange=r.handleChange.bind(r),r.handleChildRef=r.handleChildRef.bind(r),(0,u.default)("object"===o(r.context.dragDropManager),"Could not find the drag and drop manager in the context of %s. Make sure to wrap the top-level component of your app with DragDropContext. Read more: http://react-dnd.github.io/react-dnd/docs-troubleshooting.html#could-not-find-the-drag-and-drop-manager-in-the-context",D,D),r.manager=r.context.dragDropManager,r.handlerMonitor=v(r.manager),r.handlerConnector=y(r.manager.getBackend()),r.handler=g(r.handlerMonitor),r.disposable=new c.SerialDisposable,r.receiveProps(e),r.state=r.getCurrentState(),r.dispose(),r}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"getHandlerId",value:function(){return this.handlerId}},{key:"getDecoratedComponentInstance",value:function(){return this.decoratedComponentInstance}},{key:"shouldComponentUpdate",value:function(e,t){return!S(e,this.props)||!(0,p.default)(t,this.state)}}]),i(t,[{key:"componentDidMount",value:function(){this.isCurrentlyMounted=!0,this.disposable=new c.SerialDisposable,this.currentType=null,this.receiveProps(this.props),this.handleChange()}},{key:"componentWillReceiveProps",value:function(e){S(e,this.props)||(this.receiveProps(e),this.handleChange())}},{key:"componentWillUnmount",value:function(){this.dispose(),this.isCurrentlyMounted=!1}},{key:"receiveProps",value:function(e){this.handler.receiveProps(e),this.receiveType(C(e))}},{key:"receiveType",value:function(e){if(e!==this.currentType){this.currentType=e;var t=x(e,this.handler,this.manager),n=t.handlerId,r=t.unregister;this.handlerId=n,this.handlerMonitor.receiveHandlerId(n),this.handlerConnector.receiveHandlerId(n);var o=this.manager.getMonitor().subscribeToStateChange(this.handleChange,{handlerIds:[n]});this.disposable.setDisposable(new c.CompositeDisposable(new c.Disposable(o),new c.Disposable(r)))}}},{key:"handleChange",value:function(){if(this.isCurrentlyMounted){var e=this.getCurrentState();(0,p.default)(e,this.state)||this.setState(e)}}},{key:"dispose",value:function(){this.disposable.dispose(),this.handlerConnector.receiveHandlerId(null)}},{key:"handleChildRef",value:function(e){this.decoratedComponentInstance=e,this.handler.receiveComponent(e)}},{key:"getCurrentState",value:function(){return b(this.handlerConnector.hooks,this.handlerMonitor)}},{key:"render",value:function(){return s.default.createElement(f,r({},this.props,this.state,{ref:m(f)?this.handleChildRef:null}))}}]),t}(a.Component),t.DecoratedComponent=f,t.displayName=A+"("+D+")",t.contextTypes={dragDropManager:l.default.object.isRequired},n);return(0,d.default)(k,f)};var a=n(9950),s=f(a),l=f(n(11942)),c=n(86864),u=(f(n(75461)),f(n(10949))),d=f(n(23876)),p=f(n(90955)),h=f(n(25199));function f(e){return e&&e.__esModule?e:{default:e}}var m=function(e){return Boolean(e&&e.prototype&&"function"===typeof e.prototype.render)}},89857:function(e,t,n){"use strict";var r=n(45615);Object.defineProperty(t,"JY",{enumerable:!0,get:function(){return l(r).default}});var o=n(4142);var i=n(59594);Object.defineProperty(t,"Mf",{enumerable:!0,get:function(){return l(i).default}});var a=n(50090);Object.defineProperty(t,"I4",{enumerable:!0,get:function(){return l(a).default}});var s=n(33453);function l(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"Tl",{enumerable:!0,get:function(){return l(s).default}})},12193:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var r=n.getRegistry(),o=r.addSource(e,t);return{handlerId:o,unregister:function(){r.removeSource(o)}}}},25113:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var r=n.getRegistry(),o=r.addTarget(e,t);return{handlerId:o,unregister:function(){r.removeTarget(o)}}}},33884:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){0}},46977:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=e.ref;if((0,i.default)("string"!==typeof n,"Cannot connect React DnD to an element with an existing string ref. Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. Read more: https://facebook.github.io/react/docs/more-about-refs.html#the-ref-callback-attribute"),!n)return(0,a.cloneElement)(e,{ref:t});return(0,a.cloneElement)(e,{ref:function(e){t(e),n&&n(e)}})};var r,o=n(10949),i=(r=o)&&r.__esModule?r:{default:r},a=n(9950)},41725:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.default=function e(t,n){return"string"===typeof t||"symbol"===("undefined"===typeof t?"undefined":r(t))||n&&(0,a.default)(t)&&t.every((function(t){return e(t,!1)}))};var o,i=n(12279),a=(o=i)&&o.__esModule?o:{default:o}},90955:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(e===t)return!0;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(var o=Object.prototype.hasOwnProperty,i=0;i<n.length;i+=1){if(!o.call(t,n[i])||e[n[i]]!==t[n[i]])return!1;if(e[n[i]]!==t[n[i]])return!1}return!0}},25199:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.default=function(e,t){if(e===t)return!0;if("object"!==("undefined"===typeof e?"undefined":n(e))||null===e||"object"!==("undefined"===typeof t?"undefined":n(t))||null===t)return!1;var r=Object.keys(e),o=Object.keys(t);if(r.length!==o.length)return!1;for(var i=Object.prototype.hasOwnProperty,a=0;a<r.length;a+=1){if(!i.call(t,r[a]))return!1;var s=e[r[a]],l=t[r[a]];if(s!==l||"object"===("undefined"===typeof s?"undefined":n(s))||"object"===("undefined"===typeof l?"undefined":n(l)))return!1}return!0}},60460:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t={};return Object.keys(e).forEach((function(n){var r=function(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if((0,o.isValidElement)(t)){var r=t;!function(e){if("string"===typeof e.type)return;var t=e.type.displayName||e.type.name||"the component";throw new Error("Only native element nodes can now be passed to React DnD connectors.You can either wrap "+t+" into a <div>, or turn it into a drag source or a drop target itself.")}(r);var i=n?function(t){return e(t,n)}:e;return(0,a.default)(r,i)}e(t,n)}}(e[n]);t[n]=function(){return r}})),t};var r,o=n(9950),i=n(46977),a=(r=i)&&r.__esModule?r:{default:r}},79514:function(e,t,n){"use strict";t.__esModule=!0,t.ActionTypes=void 0,t.default=function e(t,n,i){var s;"function"===typeof n&&"undefined"===typeof i&&(i=n,n=void 0);if("undefined"!==typeof i){if("function"!==typeof i)throw new Error("Expected the enhancer to be a function.");return i(e)(t,n)}if("function"!==typeof t)throw new Error("Expected the reducer to be a function.");var l=t,c=n,u=[],d=u,p=!1;function h(){d===u&&(d=u.slice())}function f(){return c}function m(e){if("function"!==typeof e)throw new Error("Expected listener to be a function.");var t=!0;return h(),d.push(e),function(){if(t){t=!1,h();var n=d.indexOf(e);d.splice(n,1)}}}function g(e){if(!(0,r.default)(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if("undefined"===typeof e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(p)throw new Error("Reducers may not dispatch actions.");try{p=!0,c=l(c,e)}finally{p=!1}for(var t=u=d,n=0;n<t.length;n++){(0,t[n])()}return e}return g({type:a.INIT}),(s={dispatch:g,subscribe:m,getState:f,replaceReducer:function(e){if("function"!==typeof e)throw new Error("Expected the nextReducer to be a function.");l=e,g({type:a.INIT})}})[o.default]=function(){var e,t=m;return(e={subscribe:function(e){if("object"!==typeof e)throw new TypeError("Expected the observer to be an object.");function n(){e.next&&e.next(f())}return n(),{unsubscribe:t(n)}}})[o.default]=function(){return this},e},s};var r=i(n(75461)),o=i(n(65292));function i(e){return e&&e.__esModule?e:{default:e}}var a=t.ActionTypes={INIT:"@@redux/INIT"}},46256:function(e,t,n){var r=n(36273),o=n(8404),i=n(92411),a=n(54818)("socket.io-client");e.exports=t=l;var s=t.managers={};function l(e,t){"object"===typeof e&&(t=e,e=void 0),t=t||{};var n,o=r(e),l=o.source,c=o.id,u=o.path,d=s[c]&&u in s[c].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||d?(a("ignoring socket cache for %s",l),n=i(l,t)):(s[c]||(a("new io instance for %s",l),s[c]=i(l,t)),n=s[c]),o.query&&!t.query&&(t.query=o.query),n.socket(o.path,t)}t.protocol=o.protocol,t.connect=l,t.Manager=n(92411),t.Socket=n(29227)},92411:function(e,t,n){var r=n(88127),o=n(29227),i=n(19621),a=n(8404),s=n(99823),l=n(1354),c=n(54818)("socket.io-client:manager"),u=n(95896),d=n(64293),p=Object.prototype.hasOwnProperty;function h(e,t){if(!(this instanceof h))return new h(e,t);e&&"object"===typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new d({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var n=t.parser||a;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}e.exports=h,h.prototype.emitAll=function(){for(var e in this.emit.apply(this,arguments),this.nsps)p.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},h.prototype.updateSocketIds=function(){for(var e in this.nsps)p.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},h.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},i(h.prototype),h.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},h.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},h.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},h.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},h.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},h.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},h.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},h.prototype.open=h.prototype.connect=function(e,t){if(c("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;c("opening %s",this.uri),this.engine=r(this.uri,this.opts);var n=this.engine,o=this;this.readyState="opening",this.skipReconnect=!1;var i=s(n,"open",(function(){o.onopen(),e&&e()})),a=s(n,"error",(function(t){if(c("connect_error"),o.cleanup(),o.readyState="closed",o.emitAll("connect_error",t),e){var n=new Error("Connection error");n.data=t,e(n)}else o.maybeReconnectOnOpen()}));if(!1!==this._timeout){var l=this._timeout;c("connect attempt will timeout after %d",l),0===l&&i.destroy();var u=setTimeout((function(){c("connect attempt timed out after %d",l),i.destroy(),n.close(),n.emit("error","timeout"),o.emitAll("connect_timeout",l)}),l);this.subs.push({destroy:function(){clearTimeout(u)}})}return this.subs.push(i),this.subs.push(a),this},h.prototype.onopen=function(){c("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(s(e,"data",l(this,"ondata"))),this.subs.push(s(e,"ping",l(this,"onping"))),this.subs.push(s(e,"pong",l(this,"onpong"))),this.subs.push(s(e,"error",l(this,"onerror"))),this.subs.push(s(e,"close",l(this,"onclose"))),this.subs.push(s(this.decoder,"decoded",l(this,"ondecoded")))},h.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},h.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},h.prototype.ondata=function(e){this.decoder.add(e)},h.prototype.ondecoded=function(e){this.emit("packet",e)},h.prototype.onerror=function(e){c("error",e),this.emitAll("error",e)},h.prototype.socket=function(e,t){var n=this.nsps[e];if(!n){n=new o(this,e,t),this.nsps[e]=n;var r=this;n.on("connecting",i),n.on("connect",(function(){n.id=r.generateId(e)})),this.autoConnect&&i()}function i(){~u(r.connecting,n)||r.connecting.push(n)}return n},h.prototype.destroy=function(e){var t=u(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},h.prototype.packet=function(e){c("writing packet %j",e);var t=this;e.query&&0===e.type&&(e.nsp+="?"+e.query),t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,(function(n){for(var r=0;r<n.length;r++)t.engine.write(n[r],e.options);t.encoding=!1,t.processPacketQueue()})))},h.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},h.prototype.cleanup=function(){c("cleanup");for(var e=this.subs.length,t=0;t<e;t++){this.subs.shift().destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},h.prototype.close=h.prototype.disconnect=function(){c("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},h.prototype.onclose=function(e){c("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},h.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)c("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();c("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var n=setTimeout((function(){e.skipReconnect||(c("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open((function(t){t?(c("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(c("reconnect success"),e.onreconnect())})))}),t);this.subs.push({destroy:function(){clearTimeout(n)}})}},h.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},99823:function(e){e.exports=function(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}},29227:function(e,t,n){var r=n(8404),o=n(19621),i=n(73802),a=n(99823),s=n(1354),l=n(54818)("socket.io-client:socket"),c=n(71914),u=n(69349);e.exports=h;var d={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},p=o.prototype.emit;function h(e,t,n){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}o(h.prototype),h.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[a(e,"open",s(this,"onopen")),a(e,"packet",s(this,"onpacket")),a(e,"close",s(this,"onclose"))]}},h.prototype.open=h.prototype.connect=function(){return this.connected||(this.subEvents(),this.io.reconnecting||this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting")),this},h.prototype.send=function(){var e=i(arguments);return e.unshift("message"),this.emit.apply(this,e),this},h.prototype.emit=function(e){if(d.hasOwnProperty(e))return p.apply(this,arguments),this;var t=i(arguments),n={type:(void 0!==this.flags.binary?this.flags.binary:u(t))?r.BINARY_EVENT:r.EVENT,data:t,options:{}};return n.options.compress=!this.flags||!1!==this.flags.compress,"function"===typeof t[t.length-1]&&(l("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),this.flags={},this},h.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},h.prototype.onopen=function(){if(l("transport is open - connecting"),"/"!==this.nsp)if(this.query){var e="object"===typeof this.query?c.encode(this.query):this.query;l("sending connect packet with query %s",e),this.packet({type:r.CONNECT,query:e})}else this.packet({type:r.CONNECT})},h.prototype.onclose=function(e){l("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},h.prototype.onpacket=function(e){var t=e.nsp===this.nsp,n=e.type===r.ERROR&&"/"===e.nsp;if(t||n)switch(e.type){case r.CONNECT:this.onconnect();break;case r.EVENT:case r.BINARY_EVENT:this.onevent(e);break;case r.ACK:case r.BINARY_ACK:this.onack(e);break;case r.DISCONNECT:this.ondisconnect();break;case r.ERROR:this.emit("error",e.data)}},h.prototype.onevent=function(e){var t=e.data||[];l("emitting event %j",t),null!=e.id&&(l("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?p.apply(this,t):this.receiveBuffer.push(t)},h.prototype.ack=function(e){var t=this,n=!1;return function(){if(!n){n=!0;var o=i(arguments);l("sending ack %j",o),t.packet({type:u(o)?r.BINARY_ACK:r.ACK,id:e,data:o})}}},h.prototype.onack=function(e){var t=this.acks[e.id];"function"===typeof t?(l("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):l("bad ack %s",e.id)},h.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emitBuffered(),this.emit("connect")},h.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)p.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},h.prototype.ondisconnect=function(){l("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},h.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},h.prototype.close=h.prototype.disconnect=function(){return this.connected&&(l("performing disconnect (%s)",this.nsp),this.packet({type:r.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},h.prototype.compress=function(e){return this.flags.compress=e,this},h.prototype.binary=function(e){return this.flags.binary=e,this}},36273:function(e,t,n){var r=n(20204),o=n(54818)("socket.io-client:url");e.exports=function(e,t){var n=e;t=t||"undefined"!==typeof location&&location,null==e&&(e=t.protocol+"//"+t.host);"string"===typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(o("protocol-less url %s",e),e="undefined"!==typeof t?t.protocol+"//"+e:"https://"+e),o("parse %s",e),n=r(e));n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443"));n.path=n.path||"/";var i=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+i+":"+n.port,n.href=n.protocol+"://"+i+(t&&t.port===n.port?"":":"+n.port),n}},54818:function(e,t,n){var r=n(85224);function o(){var e;try{e=t.storage.debug}catch(n){}return!e&&"undefined"!==typeof r&&"env"in r&&(e={NODE_ENV:"production",PUBLIC_URL:"http://0.0.0.0:3000/assets/bundles",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.DEBUG),e}(t=e.exports=n(95589)).log=function(){return"object"===typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return;var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var o=0,i=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(o++,"%c"===e&&(i=o))})),e.splice(i,0,r)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(n){}},t.load=o,t.useColors=function(){if("undefined"!==typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},t.enable(o())},95589:function(e,t,n){function r(e){var n;function r(){if(r.enabled){var e=r,o=+new Date,i=o-(n||o);e.diff=i,e.prev=n,e.curr=o,n=o;for(var a=new Array(arguments.length),s=0;s<a.length;s++)a[s]=arguments[s];a[0]=t.coerce(a[0]),"string"!==typeof a[0]&&a.unshift("%O");var l=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,(function(n,r){if("%%"===n)return n;l++;var o=t.formatters[r];if("function"===typeof o){var i=a[l];n=o.call(e,i),a.splice(l,1),l--}return n})),t.formatArgs.call(e,a),(r.log||t.log||console.log.bind(console)).apply(e,a)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=function(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}(e),r.destroy=o,"function"===typeof t.init&&t.init(r),t.instances.push(r),r}function o(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var n;t.save(e),t.names=[],t.skips=[];var r=("string"===typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var i=t.instances[n];i.enabled=t.enabled(i.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(80324),t.instances=[],t.names=[],t.skips=[],t.formatters={}},80324:function(e){var t=1e3,n=60*t,r=60*n,o=24*r,i=365.25*o;function a(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}e.exports=function(e,s){s=s||{};var l,c=typeof e;if("string"===c&&e.length>0)return function(e){if((e=String(e)).length>100)return;var a=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!a)return;var s=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return s*i;case"days":case"day":case"d":return s*o;case"hours":case"hour":case"hrs":case"hr":case"h":return s*r;case"minutes":case"minute":case"mins":case"min":case"m":return s*n;case"seconds":case"second":case"secs":case"sec":case"s":return s*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}(e);if("number"===c&&!1===isNaN(e))return s.long?a(l=e,o,"day")||a(l,r,"hour")||a(l,n,"minute")||a(l,t,"second")||l+" ms":function(e){if(e>=o)return Math.round(e/o)+"d";if(e>=r)return Math.round(e/r)+"h";if(e>=n)return Math.round(e/n)+"m";if(e>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},16775:function(e,t,n){var r=n(36173),o=n(91945),i=Object.prototype.toString,a="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===i.call(Blob),s="function"===typeof File||"undefined"!==typeof File&&"[object FileConstructor]"===i.call(File);function l(e,t){if(!e)return e;if(o(e)){var n={_placeholder:!0,num:t.length};return t.push(e),n}if(r(e)){for(var i=new Array(e.length),a=0;a<e.length;a++)i[a]=l(e[a],t);return i}if("object"===typeof e&&!(e instanceof Date)){i={};for(var s in e)i[s]=l(e[s],t);return i}return e}function c(e,t){if(!e)return e;if(e&&!0===e._placeholder){if("number"===typeof e.num&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}if(r(e))for(var n=0;n<e.length;n++)e[n]=c(e[n],t);else if("object"===typeof e)for(var o in e)e[o]=c(e[o],t);return e}t.deconstructPacket=function(e){var t=[],n=e.data,r=e;return r.data=l(n,t),r.attachments=t.length,{packet:r,buffers:t}},t.reconstructPacket=function(e,t){return e.data=c(e.data,t),e.attachments=void 0,e},t.removeBlobs=function(e,t){var n=0,i=e;!function e(l,c,u){if(!l)return l;if(a&&l instanceof Blob||s&&l instanceof File){n++;var d=new FileReader;d.onload=function(){u?u[c]=this.result:i=this.result,--n||t(i)},d.readAsArrayBuffer(l)}else if(r(l))for(var p=0;p<l.length;p++)e(l[p],p,l);else if("object"===typeof l&&!o(l))for(var h in l)e(l[h],h,l)}(i),n||t(i)}},8404:function(e,t,n){var r=n(48898)("socket.io-parser"),o=n(19621),i=n(16775),a=n(36173),s=n(91945);function l(){}t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=l,t.Decoder=d;var c=t.ERROR+'"encode error"';function u(e){var n=""+e.type;if(t.BINARY_EVENT!==e.type&&t.BINARY_ACK!==e.type||(n+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(n+=e.nsp+","),null!=e.id&&(n+=e.id),null!=e.data){var o=function(e){try{return JSON.stringify(e)}catch(t){return!1}}(e.data);if(!1===o)return c;n+=o}return r("encoded %j as %s",e,n),n}function d(){this.reconstructor=null}function p(e){this.reconPack=e,this.buffers=[]}l.prototype.encode=function(e,n){(r("encoding packet %j",e),t.BINARY_EVENT===e.type||t.BINARY_ACK===e.type)?function(e,t){function n(e){var n=i.deconstructPacket(e),r=u(n.packet),o=n.buffers;o.unshift(r),t(o)}i.removeBlobs(e,n)}(e,n):n([u(e)])},o(d.prototype),d.prototype.add=function(e){var n;if("string"===typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");n=function(e){var n=0,o={type:Number(e.charAt(0))};if(null==t.types[o.type])return i="unknown packet type "+o.type,{type:t.ERROR,data:"parser error: "+i};var i;if(t.BINARY_EVENT===o.type||t.BINARY_ACK===o.type){for(var s=n+1;"-"!==e.charAt(++n)&&n!=e.length;);var l=e.substring(s,n);if(l!=Number(l)||"-"!==e.charAt(n))throw new Error("Illegal attachments");o.attachments=Number(l)}if("/"===e.charAt(n+1)){for(s=n+1;++n;){if(","===(u=e.charAt(n)))break;if(n===e.length)break}o.nsp=e.substring(s,n)}else o.nsp="/";var c=e.charAt(n+1);if(""!==c&&Number(c)==c){for(s=n+1;++n;){var u;if(null==(u=e.charAt(n))||Number(u)!=u){--n;break}if(n===e.length)break}o.id=Number(e.substring(s,n+1))}if(e.charAt(++n)){var d=function(e){try{return JSON.parse(e)}catch(t){return!1}}(e.substr(n));if(!function(e,t){switch(e){case 0:return"object"===typeof t;case 1:return void 0===t;case 4:return"string"===typeof t||"object"===typeof t;case 2:case 5:return a(t)&&("string"===typeof t[0]||"number"===typeof t[0]);case 3:case 6:return a(t)}}(o.type,d))throw new Error("invalid payload");o.data=d}return r("decoded %s as %j",e,o),o}(e),t.BINARY_EVENT===n.type||t.BINARY_ACK===n.type?(this.reconstructor=new p(n),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",n)):this.emit("decoded",n)}else{if(!s(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(n=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",n))}},d.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},p.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=i.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},p.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},91945:function(e,t,n){var r=n(93325).hp;e.exports=function(e){return o&&r.isBuffer(e)||i&&(e instanceof ArrayBuffer||a(e))};var o="function"===typeof r&&"function"===typeof r.isBuffer,i="function"===typeof ArrayBuffer,a=function(e){return"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer}},48898:function(e,t,n){var r=n(85224);function o(){var e;try{e=t.storage.debug}catch(n){}return!e&&"undefined"!==typeof r&&"env"in r&&(e={NODE_ENV:"production",PUBLIC_URL:"http://0.0.0.0:3000/assets/bundles",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.DEBUG),e}(t=e.exports=n(96709)).log=function(){return"object"===typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return;var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var o=0,i=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(o++,"%c"===e&&(i=o))})),e.splice(i,0,r)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(n){}},t.load=o,t.useColors=function(){if("undefined"!==typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},t.enable(o())},96709:function(e,t,n){function r(e){var n;function r(){if(r.enabled){var e=r,o=+new Date,i=o-(n||o);e.diff=i,e.prev=n,e.curr=o,n=o;for(var a=new Array(arguments.length),s=0;s<a.length;s++)a[s]=arguments[s];a[0]=t.coerce(a[0]),"string"!==typeof a[0]&&a.unshift("%O");var l=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,(function(n,r){if("%%"===n)return n;l++;var o=t.formatters[r];if("function"===typeof o){var i=a[l];n=o.call(e,i),a.splice(l,1),l--}return n})),t.formatArgs.call(e,a),(r.log||t.log||console.log.bind(console)).apply(e,a)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=function(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}(e),r.destroy=o,"function"===typeof t.init&&t.init(r),t.instances.push(r),r}function o(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var n;t.save(e),t.names=[],t.skips=[];var r=("string"===typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var i=t.instances[n];i.enabled=t.enabled(i.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(77604),t.instances=[],t.names=[],t.skips=[],t.formatters={}},36173:function(e){var t={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==t.call(e)}},77604:function(e){var t=1e3,n=60*t,r=60*n,o=24*r,i=365.25*o;function a(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}e.exports=function(e,s){s=s||{};var l,c=typeof e;if("string"===c&&e.length>0)return function(e){if((e=String(e)).length>100)return;var a=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!a)return;var s=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return s*i;case"days":case"day":case"d":return s*o;case"hours":case"hour":case"hrs":case"hr":case"h":return s*r;case"minutes":case"minute":case"mins":case"min":case"m":return s*n;case"seconds":case"second":case"secs":case"sec":case"s":return s*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}(e);if("number"===c&&!1===isNaN(e))return s.long?a(l=e,o,"day")||a(l,r,"hour")||a(l,n,"minute")||a(l,t,"second")||l+" ms":function(e){if(e>=o)return Math.round(e/o)+"d";if(e>=r)return Math.round(e/r)+"h";if(e>=n)return Math.round(e/n)+"m";if(e>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},65292:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return r}}),e=n.hmd(e);var r=function(e){var t,n=e.Symbol;return"function"===typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable",t}("undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:e)},73802:function(e){e.exports=function(e,t){for(var n=[],r=(t=t||0)||0;r<e.length;r++)n[r-t]=e[r];return n}},7479:function(e){"use strict";var t,n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),r=64,o={},i=0,a=0;function s(e){var t="";do{t=n[e%r]+t,e=Math.floor(e/r)}while(e>0);return t}function l(){var e=s(+new Date);return e!==t?(i=0,t=e):e+"."+s(i++)}for(;a<r;a++)o[n[a]]=a;l.encode=s,l.decode=function(e){var t=0;for(a=0;a<e.length;a++)t=t*r+o[e.charAt(a)];return t},e.exports=l},63138:function(e,t,n){"use strict";n.r(t),t.default={}},41939:function(e,t,n){"use strict";n.r(t),t.default={}},70238:function(e,t,n){"use strict";n.r(t),t.default={}},86954:function(e,t,n){"use strict";n.r(t),t.default={}},95399:function(e,t,n){"use strict";n.r(t),t.default={}},41341:function(e,t,n){"use strict";n.r(t),t.default={}},91173:function(e,t,n){"use strict";n.r(t),t.default={}},35816:function(e,t,n){"use strict";n.r(t),t.default={}},22257:function(e,t,n){"use strict";n.r(t),t.default={}},16525:function(e,t,n){"use strict";n.r(t),t.default={}},41186:function(e,t,n){"use strict";n.r(t),t.default={}},60784:function(e,t,n){"use strict";n.r(t),t.default={}},71188:function(e,t,n){"use strict";n.r(t),t.default={}},77392:function(e,t,n){"use strict";n.r(t),t.default={}},61945:function(e,t,n){"use strict";n.r(t),t.default={}},3627:function(e,t,n){"use strict";n.r(t),t.default={}},12081:function(e,t,n){"use strict";n.r(t),t.default={}},89156:function(e,t,n){"use strict";n.r(t),t.default={}},83695:function(e,t,n){"use strict";n.r(t),t.default={}},65544:function(e,t,n){"use strict";n.r(t),t.default={}},58986:function(e,t,n){"use strict";n.r(t),t.default={}},35174:function(e,t,n){"use strict";n.r(t),t.default={}},90562:function(e,t,n){"use strict";n.r(t),t.default={}},15623:function(e,t,n){"use strict";n.r(t),t.default={}},92305:function(e,t,n){"use strict";n.r(t),t.default={}},47100:function(){},79627:function(e,t,n){"use strict";n.r(t),t.default={}},25660:function(){}},function(e){e.O(0,[4223],(function(){return t=3835,e(e.s=t);var t}));e.O()}]);