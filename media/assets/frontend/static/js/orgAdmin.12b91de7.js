"use strict";(self.webpackChunkseahub_frontend=self.webpackChunkseahub_frontend||[]).push([[8776],{86335:function(e,t,n){n.d(t,{A:function(){return u}});var s=n(60436),r=n(89379),a=n(5544),i=n(9950),o=n(5223),l=n(44414),c=function(e){var t=e.data,n=e.position,s=(0,i.useState)(n),o=(0,a.default)(s,2),c=o[0],d=o[1],u=(0,i.useRef)(null);(0,i.useEffect)((function(){var e=u.current.getBoundingClientRect(),t=e.height,s=e.width,a=n||{},i=a.left,o=a.top,l=(0,r.default)({},n);o+t>window.innerHeight-10&&(l.top="unset",l.bottom=10),i+s>window.innerWidth-10&&(l.left="unset",l.right=10),d(l)}),[n]);var h=t.title,p=t.records;return(0,l.jsxs)("div",{className:"sf-chart-tooltip",ref:u,style:c,children:[(0,l.jsx)("div",{className:"sf-chart-tooltip-title",children:h}),p.map((function(e){return(0,l.jsxs)("div",{className:"sf-chart-tooltip-item",children:[(0,l.jsx)("div",{className:"sf-chart-tooltip-item-marker",style:{backgroundColor:e.color}}),(0,l.jsx)("div",{className:"sf-chart-tooltip-item-name",children:e.name}),(0,l.jsx)("div",{className:"sf-chart-tooltip-item-value",children:e.value})]},e.color)}))]})},d=function(e,t){var n=function(e,t){return Math.max(1,Math.floor(e.length/(t/100)))}(e,t);return e.filter((function(e,t){return t%n===0})).map((function(e){return e.name}))},u=function(e){var t=e.data,n=void 0===t?[]:t,u=e.legends,h=void 0===u?[]:u,p=e.title,g=void 0===p?"":p,m=e.margin,f=void 0===m?{top:60,right:30,bottom:30,left:30}:m,x=e.ySuggestedMax,v=void 0===x?0:x,j=e.getDisplayValue,A=void 0===j?function(e){return e}:j,S=(0,i.useState)({display:!1,position:{x:0,y:0}}),y=(0,a.default)(S,2),N=y[0],w=y[1],D=(0,i.useRef)(null),b=(0,i.useRef)(null),P=(0,i.useRef)([]),k=(0,i.useRef)(null),I=(0,i.useRef)(null),_=(0,i.useRef)(null),C=(0,i.useMemo)((function(){return h.map((function(e){var t=e.key;return(0,r.default)((0,r.default)({},e),{},{values:n.map((function(e){return{key:t,name:e.name,value:e[t]}}))})}))}),[n,h]),M=(0,i.useCallback)((function(e,t){var n=t.height;return o.l78(e).tickSizeOuter(0).tickSize(n).tickFormat("")}),[]),O=(0,i.useCallback)((function(e,t){var n=t.width;return o.V4s(e).ticks(5).tickSize(-n).tickFormat("")}),[]),L=(0,i.useCallback)((function(e,t,r,a){var i=o.T9B(n,(function(e){return Math.max.apply(Math,(0,s.default)(a.map((function(t){return e[t.key]||0}))))}));v&&(i=Math.max(v,i));var l=o.Cmz(0,i,5)[1];r.domain([0,l])}),[v,n]),U=(0,i.useCallback)((function(){var e=.8*D.current.getBoundingClientRect().width,t=.5*e,s={height:t-f.top-f.bottom,width:e-f.left-f.right},r=o.Ltv(b.current).attr("width",e).attr("height",t).append("g").attr("transform","translate(".concat(f.left,", ").concat(f.top,")")),a=n.map((function(e){return e.name}));return{svg:r,x:o.hqK().domain(a).range([0,s.width]).padding(.1),y:o.m4Y().range([s.height,0]),tickValues:d(n,s.width),style:s}}),[n,f]),R=(0,i.useCallback)((function(e,t,n,s){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:500;I.current.transition().duration(r).call(o.l78(t).tickSizeOuter(0).tickValues(s)),_.current.transition().duration(r).call(o.V4s(n).tickSizeInner(0).ticks(5).tickFormat(A))}),[A]),T=(0,i.useCallback)((function(e,t,n,s,r,a){var i=r.height,o=e.append("g").attr("class","axis");I.current=o.append("g").attr("class","axis-x").attr("transform","translate(0, ".concat(i,")")),_.current=o.append("g").attr("class","axis-y"),R(e,t,n,s,0)}),[R]),F=(0,i.useCallback)((function(e,t,n,s,r,a){var i=r.height,o=r.width,l=e.append("g").attr("class","grid"),c=l.append("g").attr("class","grid-x").call(M(t,{height:i})),d=l.append("line").attr("class","grid-x-tip-line d-none").attr("y1",0).attr("y2",i);c.selectAll(".tick").append("rect").attr("class","tick-interaction").attr("x",-2.5).attr("y",0).attr("width",5).attr("height",i).attr("fill","transparent").attr("pointer-events","all").on("mouseover",(function(n,s){var r;if(d.attr("x1",t(s)).attr("x2",t(s)).classed("d-none",!1),e.selectAll(".dot").filter((function(e){return e.name===s})).classed("highlight-dot",!0),(null===(r=k.current)||void 0===r?void 0:r.title)!==s){var a=[];C.forEach((function(e){var t=e.values.find((function(e){return e.name===s}));t&&a.push({color:e.color,name:e.name,value:A(t.value)})})),k.current={records:a,title:s}}w({display:!0,position:{left:n.pageX+10,top:n.pageY+10}})})).on("mouseout",(function(t,n){d.classed("d-none",!0),e.selectAll(".dot").classed("highlight-dot",!1),w({display:!1,position:{left:0,top:0}}),k.current=null})),l.append("g").attr("class","grid-y").call(O(n,{width:o})).selectAll(".tick").classed("d-none",(function(e,t){return 0===t}))}),[C,A,M,O]),E=(0,i.useCallback)((function(e,t,n,s,r,a){r.height,r.width;var i=o.n8j().x((function(e){return t(e.name)||0})).y((function(e){return n(e.value)||0})).curve(o.lUB),l=e.select(".groups").empty()?e.append("g").attr("class","groups"):e.select(".groups"),c=l.selectAll(".group").data(a).enter().append("g").attr("class","group");c.append("path").attr("class","line").attr("d",(function(e){return i(e.values)})).attr("fill","none").attr("stroke",(function(e){return e.color})),c.each((function(e){o.Ltv(this).selectAll(".dot").data(e.values).enter().append("circle").attr("class","dot").attr("cx",(function(e){return t(e.name)||0})).attr("cy",(function(e){return n(e.value)||0})).attr("fill",e.color)})),l.selectAll(".line").classed("fade-line",(function(e){return P.current.includes(e.key)})).attr("d",(function(e){return i(e.values)})).transition().duration(500),l.selectAll(".dot").classed("fade-dot",(function(e){return P.current.includes(e.key)})).attr("cx",(function(e){return t(e.name)||0})).attr("cy",(function(e){return n(e.value)||0})).transition().duration(500),l.exit().remove()}),[]),z=(0,i.useCallback)((function(e,t,n,r,a,i){var l=a.height,c=a.width,d=e.append("text").attr("class","legend-text-measurer").style("visibility","hidden").style("font-size","12px"),u=h.map((function(e){var t=e.name;return d.text(t),d.node().getComputedTextLength()}));d.remove();var p=u.reduce((function(e,t){return e+t}),0)+44*h.length-16,g=(c-p)/2,m=e.append("g").attr("class","legends").selectAll(".legend").data(i).enter().append("g").attr("class","legend").classed("hidden-legend",(function(e){return P.current.includes(e.key)})).on("click",(function(a,i){P.current.includes(i.key)?P.current=P.current.filter((function(e){return e!==i.key})):P.current=[].concat((0,s.default)(P.current),[i.key]),o.Ltv(this).classed("hidden-legend",P.current.includes(i.key)),q(e,t,n,r,{height:l,width:c})}));m.append("rect").attr("x",(function(e,t){return g+u.slice(0,t).reduce((function(e,t){return e+t}),0)+44*t})).attr("y",-20).attr("width",20).attr("height",6).attr("rx",3).attr("fill",(function(e){return e.color})).attr("class","legend-color"),m.append("rect").attr("x",(function(e,t){return g+u.slice(0,t).reduce((function(e,t){return e+t}),0)+44*t+20})).attr("y",-26.5).attr("width",8).attr("height",16.5).attr("class","legend-gap"),m.append("text").attr("x",(function(e,t){return g+u.slice(0,t).reduce((function(e,t){return e+t}),0)+44*t+28})).attr("y",-20).attr("dy","7px").text((function(e){return e.name})).attr("class","legend-text")}),[h,q]),Y=(0,i.useCallback)((function(e,t,n,s,r){r.height;var a=r.width;g&&e.append("text").attr("class","title").attr("x",a/2).attr("y",-40).text(g)}),[g]),q=(0,i.useCallback)((function(e,t,n,s,r){var a=r.width,i=r.height,o=h.filter((function(e){return!P.current.includes(e.key)}));L(e,t,n,o),R(e,t,n,s),e.select(".grid-x").transition().duration(500).call(M(t,{height:i})),e.select(".grid-y").transition().duration(500).call(O(n,{width:a})),E(e,t,n,s,{width:a,height:i},C)}),[h,C,L,R,M,O,E]),B=(0,i.useCallback)((function(e,t,n,s,r){var a=h.filter((function(e){return!P.current.includes(e.key)}));L(e,t,n,a),T(e,t,n,s,r),F(e,t,n,s,r),E(e,t,n,s,r,C),z(e,t,n,s,r,C),Y(e,t,n,s,r)}),[h,C,L,T,F,E,z,Y]),V=(0,i.useCallback)((function(){var e=U(),t=e.svg,n=e.x,s=e.y,r=e.tickValues,a=e.style;B(t,n,s,r,a)}),[U,B]),G=(0,i.useCallback)((function(){b.current&&o.Ltv(b.current).selectAll("*").remove()}),[]),H=(0,i.useCallback)((function(){G(),V()}),[]);return(0,i.useEffect)((function(){return window.addEventListener("resize",H),function(){G(),window.removeEventListener("resize",H)}}),[H]),(0,i.useEffect)((function(){V()}),[]),(0,l.jsxs)("div",{className:"sf-chart w-100 h-100",ref:D,children:[(0,l.jsx)("svg",{ref:b}),N.display&&(0,l.jsx)(c,{data:k.current,position:N.position})]})}},52622:function(e,t,n){var s=n(23029),r=n(92901),a=n(39874),i=n(85501),o=n(9950),l=n(8081),c=n(10877),d=n(6754),u=n(34322),h=n(65604),p=n(40326),g=n(20338),m=n(44414),f=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).submit=function(){n.props.changeGroup2Department(),n.props.toggleDialog()},n.state={selectedOption:null},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e='<span class="op-target">'+h.Aq.HTMLescape(this.props.groupName)+"</span>",t=(0,p.AP)("Are you sure to change group {placeholder} to department ?").replace("{placeholder}",e);return(0,m.jsxs)(l.A,{isOpen:!0,toggle:this.props.toggleDialog,children:[(0,m.jsx)(g.A,{toggle:this.props.toggleDialog,children:(0,p.AP)("Change group to department")}),(0,m.jsx)(c.A,{children:(0,m.jsx)("p",{dangerouslySetInnerHTML:{__html:t}})}),(0,m.jsxs)(d.A,{children:[(0,m.jsx)(u.A,{color:"secondary",onClick:this.props.toggleDialog,children:(0,p.AP)("Cancel")}),(0,m.jsx)(u.A,{color:"primary",onClick:this.submit,children:(0,p.AP)("Submit")})]})]})}}])}(o.Component);t.A=f},61314:function(e,t,n){var s=n(23029),r=n(92901),a=n(39874),i=n(85501),o=n(9950),l=n(5495),c=n(69123),d=n(65276),u=n(34940),h=n(40326),p=n(65604),g=n(44414),m=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).onMenuItemClick=function(e){var t=p.Aq.getEventData(e,"op");n.props.onMenuItemClick(t)},n.onDropdownToggleClick=function(e){n.toggleOperationMenu(e)},n.toggleOperationMenu=function(e){n.setState({isItemMenuShow:!n.state.isItemMenuShow},(function(){n.state.isItemMenuShow?n.props.onFreezedItem():n.props.onUnfreezedItem()}))},n.state={isItemMenuShow:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.operations,s=t.translateOperations;return(0,g.jsxs)(l.A,{isOpen:this.state.isItemMenuShow,toggle:this.toggleOperationMenu,children:[(0,g.jsx)(c.A,{tag:"i",className:"sf3-font sf3-font-more op-icon",title:(0,h.AP)("More operations"),"aria-label":(0,h.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isItemMenuShow}),(0,g.jsx)(d.A,{className:"my-1 mr-2",children:n.map((function(t,n){return(0,g.jsx)(u.A,{"data-op":t,onClick:e.onMenuItemClick,children:s(t)},n)}))})]})}}])}(o.Component);t.A=m},61599:function(e,t,n){var s=n(23029),r=n(92901),a=n(39874),i=n(85501),o=n(9950),l=n(8081),c=n(10877),d=n(40326),u=n(9961),h=n(20338),p=(n(8008),n(44414)),g=function(e){function t(){var e;(0,s.default)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=(0,a.default)(this,t,[].concat(r))).toggle=function(){e.props.toggle()},e}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){return(0,p.jsxs)(l.A,{className:"seahub-io-dialog",isOpen:!0,toggle:this.toggle,children:[(0,p.jsx)(h.A,{toggle:this.toggle,children:(0,d.AP)("Exporting")}),(0,p.jsx)(c.A,{children:(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(u.A,{}),(0,p.jsx)("div",{className:"seahub-io-dialog-parsing-text",children:(0,d.AP)("Exporting...")})]})})]})}}])}(o.Component);t.A=g},15097:function(e,t,n){var s=n(23029),r=n(92901),a=n(39874),i=n(85501),o=n(9950),l=n(8081),c=n(10877),d=n(39708),u=n(79969),h=n(91646),p=n(65488),g=n(6754),m=n(34322),f=n(4086),x=n(40326),v=n(65604),j=n(43825),A=n(2662),S=n(20338),y=n(44414),N=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).onKeyDown=function(e){"Enter"===e.key&&(n.handleSubmit(),e.preventDefault())},n.handleChange=function(e){n.setState({departName:e.target.value},(function(){n.setState({isSubmitBtnActive:!!n.state.departName.trim()})}))},n.handleSubmit=function(){var e=(0,v.yS)(n.state.departName.trim());if(e.isValid){var t=n.props,s=t.orgID,r=t.parentNode,a=r?r.id:-1,i=n.state.departName.trim();(s?A.k.orgAdminAddDepartGroup(s,a,i):j.H.sysAdminAddNewDepartment(a,i)).then((function(e){r?n.props.addDepartment(r,e.data):n.props.setRootNode(e.data),n.props.toggle()})).catch((function(e){var t=v.Aq.getErrorMsg(e);f.A.danger(t)}))}else n.setState({errMessage:e.message})},n.state={departName:"",isSubmitBtnActive:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e,t=this.props.parentNode,n=this.state.isSubmitBtnActive;return e=t?(0,x.AP)("Add department at")+" "+t.name:(0,x.AP)("Create top department"),(0,y.jsxs)(l.A,{isOpen:!0,toggle:this.props.toggle,autoFocus:!1,children:[(0,y.jsx)(S.A,{toggle:this.props.toggle,children:e}),(0,y.jsx)(c.A,{children:(0,y.jsx)(d.A,{children:(0,y.jsxs)(u.A,{children:[(0,y.jsx)(h.A,{for:"departmentName",children:(0,x.AP)("Name")}),(0,y.jsx)(p.A,{id:"departmentName",name:"department-name",onKeyDown:this.onKeyDown,value:this.state.departName,onChange:this.handleChange,autoFocus:!0})]})})}),(0,y.jsxs)(g.A,{children:[(0,y.jsx)(m.A,{color:"secondary",onClick:this.props.toggle,children:(0,x.AP)("Cancel")}),(0,y.jsx)(m.A,{color:"primary",onClick:this.handleSubmit,disabled:!n,children:(0,x.AP)("Submit")})]})]})}}])}(o.Component);t.A=N},47150:function(e,t,n){var s=n(23029),r=n(92901),a=n(39874),i=n(85501),o=n(9950),l=n(8081),c=n(10877),d=n(6754),u=n(34322),h=n(40326),p=n(20338),g=n(44414),m=function(e){function t(){return(0,s.default)(this,t),(0,a.default)(this,t,arguments)}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props,t=e.node,n=e.toggle;return(0,g.jsxs)(l.A,{isOpen:!0,toggle:n,children:[(0,g.jsx)(p.A,{toggle:n,children:(0,h.AP)("Delete department")}),(0,g.jsx)(c.A,{children:(0,g.jsxs)("p",{children:[(0,h.AP)("Are you sure to delete")," ",(0,g.jsx)("b",{children:t.name})," ?"]})}),(0,g.jsxs)(d.A,{children:[(0,g.jsx)(u.A,{color:"secondary",onMouseDown:n,children:(0,h.AP)("Cancel")}),(0,g.jsx)(u.A,{color:"primary",onMouseDown:this.props.onDelete,children:(0,h.AP)("Delete")})]})]})}}])}(o.Component);t.A=m},77474:function(e,t,n){var s=n(23029),r=n(92901),a=n(39874),i=n(85501),o=n(9950),l=n(8081),c=n(10877),d=n(39708),u=n(79969),h=n(91646),p=n(65488),g=n(6754),m=n(34322),f=n(4086),x=n(40326),v=n(65604),j=n(43825),A=n(2662),S=n(20338),y=n(44414),N=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).onKeyDown=function(e){"Enter"===e.key&&(n.handleSubmit(),e.preventDefault())},n.handleChange=function(e){var t=e.target.value;n.setState({departName:t},(function(){n.setState({isSubmitBtnActive:!!n.state.departName.trim()})}))},n.handleSubmit=function(){var e=(0,v.yS)(n.state.departName.trim());if(e.isValid){var t=n.props,s=t.node,r=t.orgID,a=n.state.departName.trim();(r?A.k.orgAdminUpdateDepartGroup(r,s.id,a):j.H.sysAdminRenameDepartment(s.id,a)).then((function(e){n.props.renameDepartment(s,e.data),n.props.toggle()})).catch((function(e){var t=v.Aq.getErrorMsg(e);f.A.danger(t)}))}else n.setState({errMessage:e.message})},n.state={departName:e.node.name,isSubmitBtnActive:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.state.isSubmitBtnActive;return(0,y.jsxs)(l.A,{isOpen:!0,toggle:this.props.toggle,autoFocus:!1,children:[(0,y.jsx)(S.A,{toggle:this.props.toggle,children:(0,x.AP)("Rename")}),(0,y.jsx)(c.A,{children:(0,y.jsx)(d.A,{children:(0,y.jsxs)(u.A,{children:[(0,y.jsx)(h.A,{for:"departmentName",children:(0,x.AP)("Name")}),(0,y.jsx)(p.A,{id:"departmentName",name:"department-name",onKeyDown:this.onKeyDown,value:this.state.departName,onChange:this.handleChange,autoFocus:!0})]})})}),(0,y.jsxs)(g.A,{children:[(0,y.jsx)(m.A,{color:"secondary",onClick:this.props.toggle,children:(0,x.AP)("Cancel")}),(0,y.jsx)(m.A,{color:"primary",onClick:this.handleSubmit,disabled:!e,children:(0,x.AP)("Submit")})]})]})}}])}(o.Component);t.A=N},685:function(e,t,n){n.d(t,{A:function(){return A}});var s=n(23029),r=n(92901),a=n(39874),i=n(85501),o=n(9950),l=n(8081),c=n(10877),d=n(6754),u=n(34322),h=n(4086),p=n(40326),g=n(43825),m=n(2662),f=n(65604),x=n(98361),v=n(20338),j=n(44414),A=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).handleSelectChange=function(e){n.setState({selectedUsers:e})},n.handleSubmit=function(){var e=n.state.selectedUsers.map((function(e){return e.email}));if(0!==e.length){n.setState({errMessage:""});var t=n.props,s=t.nodeId,r=t.orgID;(r?m.k.orgAdminAddGroupMember(r,s,e):g.H.sysAdminAddGroupMember(s,e)).then((function(e){n.setState({selectedUsers:[]}),e.data.failed.length>0&&n.setState({errMsgs:e.data.failed.map((function(e){return e.error_msg}))}),e.data.success.length>0&&(n.props.onMemberChanged(),n.props.toggle())})).catch((function(e){var t=f.Aq.getErrorMsg(e);h.A.danger(t)}))}},n.state={selectedUsers:[],errMsgs:""},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.state.errMsgs;return(0,j.jsxs)(l.A,{isOpen:!0,toggle:this.props.toggle,children:[(0,j.jsx)(v.A,{toggle:this.props.toggle,children:(0,p.AP)("Add members")}),(0,j.jsxs)(c.A,{children:[(0,j.jsx)(x.A,{placeholder:(0,p.AP)("Search users"),onSelectChange:this.handleSelectChange,isMulti:!0,selectedUsers:this.state.selectedUsers}),e.length>0&&(0,j.jsx)("ul",{className:"list-unstyled",children:e.map((function(e,t){return(0,j.jsx)("li",{className:"error mt-2",children:e},t)}))})]}),(0,j.jsxs)(d.A,{children:[(0,j.jsx)(u.A,{color:"secondary",onClick:this.props.toggle,children:(0,p.AP)("Cancel")}),(0,j.jsx)(u.A,{color:"primary",onClick:this.handleSubmit,children:(0,p.AP)("Submit")})]})]})}}])}(o.Component)},96763:function(e,t,n){var s=n(23029),r=n(92901),a=n(39874),i=n(85501),o=n(9950),l=n(40326),c=n(8081),d=n(10877),u=n(6754),h=n(34322),p=n(20338),g=n(44414),m=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).handleInputChange=function(e){n.setState({inputChecked:e.target.checked})},n.unlinkDevice=function(){n.props.toggleDialog(),n.props.unlinkDevice(n.state.inputChecked)},n.state={inputChecked:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.state.inputChecked,t=this.props.toggleDialog;return(0,g.jsxs)(c.A,{isOpen:!0,toggle:t,children:[(0,g.jsx)(p.A,{toggle:t,children:(0,l.AP)("Unlink device")}),(0,g.jsxs)(d.A,{children:[(0,g.jsx)("p",{children:(0,l.AP)("Are you sure you want to unlink this device?")}),l.am&&(0,g.jsxs)("div",{className:"d-flex align-items-center",children:[(0,g.jsx)("input",{id:"delete-files",className:"mr-1",type:"checkbox",checked:e,onChange:this.handleInputChange}),(0,g.jsx)("label",{htmlFor:"delete-files",className:"m-0",children:(0,l.AP)("Delete files from this device the next time it comes online.")})]})]}),(0,g.jsxs)(u.A,{children:[(0,g.jsx)(h.A,{color:"secondary",onClick:t,children:(0,l.AP)("Cancel")}),(0,g.jsx)(h.A,{color:"primary",onClick:this.unlinkDevice,children:(0,l.AP)("Unlink")})]})]})}}])}(o.Component);t.A=m},7039:function(e,t,n){n.d(t,{A:function(){return _}});var s=n(23029),r=n(92901),a=n(39874),i=n(85501),o=n(9950),l=n(4086),c=n(34322),d=n(35077),u=n(3898),h=n(65488),p=n(8081),g=n(10877),m=n(6754),f=n(40326),x=n(65604),v=n(90287),j=n(58801),A=function(){return(0,r.default)((function e(){(0,s.default)(this,e)}),[{key:"init",value:function(e){var t=e.server,n=e.username,s=e.password,r=e.token;return this.server=t,this.username=n,this.password=s,this.token=r,this.token&&this.server&&(this.req=v.A.create({baseURL:this.server,headers:{Authorization:"Token "+this.token}})),this}},{key:"initForSeahubUsage",value:function(e){var t=e.siteRoot,n=e.xcsrfHeaders;if(t&&"/"===t.charAt(t.length-1)){var s=t.substring(0,t.length-1);this.server=s}else this.server=t;return this.req=v.A.create({headers:{"X-CSRFToken":n}}),this}},{key:"getSubscription",value:function(){var e=this.server+"/api/v2.1/subscription/";return this.req.get(e)}},{key:"getSubscriptionPlans",value:function(e){var t=this.server+"/api/v2.1/subscription/plans/",n={payment_type:e};return this.req.get(t,{params:n})}},{key:"getSubscriptionLogs",value:function(){var e=this.server+"/api/v2.1/subscription/logs/";return this.req.get(e)}}])}(),S=new A,y=j.Ay.load("sfcsrftoken");S.initForSeahubUsage({siteRoot:f.Yc,xcsrfHeaders:y});var N=n(9961),w=n(20338),D=(n(16322),n(44414)),b=window.app.pageOptions.isOrgContext,P=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).togglePlan=function(e){n.setState({currentPlan:e},(function(){}))},n.onPay=function(){var e,t,s,r=n.props.paymentType,a=n.state,i=a.currentPlan,o=a.assetQuotaUnitCount,c=a.count;if("paid"===r)s=i.count,e=i.total_amount;else if("extend_time"===r)s=i.count,t=i.asset_quota,e=i.total_amount;else if("add_user"===r)s=c,e=c*i.price_per_user;else{if("buy_quota"!==r)return void l.A.danger((0,f.AP)("Internal Server Error"));t=o*i.asset_quota_unit,e=o*i.price_per_asset_quota_unit}n.props.onPay(i.plan_id,s,t,e)},n.onCountInputChange=function(e){if(n.state.currentPlan.can_custom_count){var t=e.target.value.replace(/^(0+)|[^\d]+/g,"");t<1?t=1:t>9999&&(t=9999),n.setState({count:t})}},n.onAssetQuotaUnitCountInputChange=function(e){if(n.state.currentPlan.can_custom_asset_quota){var t=e.target.value.replace(/^(0+)|[^\d]+/g,"");t<1?t=1:t>9999&&(t=9999),n.setState({assetQuotaUnitCount:t})}},n.renderPaidOrExtendTime=function(){var e=n.props,t=e.plans,s=e.paymentType,r=n.state.currentPlan,a=0;"extend_time"===s&&(a=r.asset_quota-100);var i=r.total_amount,l=i;return(0,D.jsxs)("div",{className:"d-flex flex-column subscription-container",children:[(0,D.jsx)("span",{className:"subscription-subtitle",children:"\u9009\u62e9\u65b9\u6848"}),(0,D.jsx)("dl",{className:"items-dl",children:t.map((function(e,t){var s=e.plan_id===r.plan_id?"plan-selected":"",a="\uffe5"+e.price_per_user;return b&&(a+="/\u6bcf\u7528\u6237"),(0,D.jsxs)("dd",{className:"plan-description-item ".concat(s),onClick:n.togglePlan.bind(n,e),children:[(0,D.jsx)("span",{className:"plan-name",children:e.name}),(0,D.jsx)("span",{className:"plan-description",children:a})]},t)}))}),"extend_time"===s&&a>0&&(0,D.jsxs)(o.Fragment,{children:[(0,D.jsx)("span",{className:"subscription-subtitle",children:"\u589e\u52a0\u7a7a\u95f4"}),(0,D.jsx)("dl",{className:"items-dl",children:(0,D.jsxs)("dd",{className:"order-item order-item-top order-item-bottom subscription-list",children:[(0,D.jsx)("span",{className:"order-into",children:r.asset_quota_unit+"GB x "+a/r.asset_quota_unit}),(0,D.jsx)("span",{className:"order-value",children:"\uffe5"+a/r.asset_quota_unit*r.price_per_asset_quota_unit})]})})]}),(0,D.jsx)("span",{className:"subscription-subtitle",children:"\u65b9\u6848\u6c47\u603b"}),(0,D.jsx)("dl",{className:"items-dl",children:(0,D.jsxs)("div",{children:[(0,D.jsxs)("dd",{className:"order-item order-item-top",children:[(0,D.jsx)("span",{className:"order-into",children:"\u6240\u9009\u65b9\u6848"}),(0,D.jsx)("span",{className:"order-value",children:r.name})]}),b&&(0,D.jsxs)("dd",{className:"order-item",children:[(0,D.jsx)("span",{className:"order-into",children:"\u6210\u5458\u4eba\u6570"}),(0,D.jsx)("span",{className:"order-value",children:r.count+"\u4eba"})]}),(0,D.jsxs)("dd",{className:"order-item",children:[(0,D.jsx)("span",{className:"order-into",children:"\u53ef\u7528\u7a7a\u95f4"}),(0,D.jsx)("span",{className:"order-value",children:"100GB(\u9644\u8d60)"+(a>0?"+"+a+"GB(\u6269\u5145)":"")})]}),(0,D.jsxs)("dd",{className:"order-item order-item-bottom rounded-0",children:[(0,D.jsx)("span",{className:"order-into",children:"\u5230\u671f\u65f6\u95f4"}),(0,D.jsx)("span",{className:"order-value",children:r.new_term_end})]}),(0,D.jsxs)("dd",{className:"order-item order-item-bottom subscription-list",children:[(0,D.jsx)("span",{className:"order-into",children:"\u5b9e\u9645\u652f\u4ed8\u91d1\u989d"}),(0,D.jsxs)("span",{className:"order-price",children:[l!==i&&(0,D.jsx)("span",{style:{fontSize:"small",textDecoration:"line-through",color:"#9a9a9a"},children:"\uffe5"+l}),(0,D.jsx)("span",{children:"\uffe5"+i+" "})]})]})]})}),(0,D.jsx)(c.A,{className:"subscription-submit",color:"primary",onClick:n.onPay,children:"\u63d0\u4ea4\u8ba2\u5355"})]})},n.renderAddUser=function(){var e=n.state,t=e.currentPlan,s=e.count,r="\u65b0\u589e\u7528\u6237",a=s*t.price_per_user,i=a;return(0,D.jsxs)("div",{className:"d-flex flex-column subscription-container price-version-container-header subscription-add-user",children:[(0,D.jsx)("div",{className:"price-version-container-top"}),(0,D.jsx)("h3",{className:"user-quota-plan-name py-5",children:t.name}),(0,D.jsxs)("span",{className:"py-2 mb-0 text-orange font-500 text-center",children:["\xa5 ",(0,D.jsx)("span",{className:"price-version-plan-price",children:t.price})," "+t.description]}),(0,D.jsxs)(d.A,{style:{marginBottom:"5px"},className:"user-numbers",children:[(0,D.jsx)(u.A,{children:r}),(0,D.jsx)(h.A,{className:"py-2",placeholder:r,title:r,type:"number",value:s||1,min:"1",max:"9999",disabled:!t.can_custom_count,onChange:n.onCountInputChange})]}),(0,D.jsxs)("span",{className:"py-2 text-orange mb-0 font-500 price-version-plan-whole-price text-center",children:["\u603b\u4ef7 \xa5 "+i,a!==i&&(0,D.jsx)("span",{style:{fontSize:"small",textDecoration:"line-through",color:"#9a9a9a"},children:" \uffe5"+a})]}),(0,D.jsx)("span",{className:"py-2 mb-0 text-lg-size font-500 price-version-plan-valid-day text-center",children:"\u6709\u6548\u671f\u81f3 "+t.new_term_end}),(0,D.jsx)("span",{className:"subscription-notice text-center py-5",children:"\u6ce8\uff1a\u5f53\u6709\u6548\u671f\u5269\u4f59\u5929\u6570\u5c11\u4e8e\u8ba1\u5212\u4e2d\u7684\u65f6\u5019\uff0c\u589e\u52a0\u7528\u6237\u7684\u4ef7\u683c\u6309\u5929\u6765\u8ba1\u7b97"}),(0,D.jsx)(c.A,{className:"subscription-submit",onClick:n.onPay,color:"primary",children:"\u7acb\u5373\u8d2d\u4e70"})]})},n.renderBuyQuota=function(){var e=n.state,t=e.currentPlan,s=e.assetQuotaUnitCount,r="\u65b0\u589e\u7a7a\u95f4",a=s*t.price_per_asset_quota_unit,i=a;return(0,D.jsxs)("div",{className:"d-flex flex-column subscription-container price-version-container-header subscription-add-space",children:[(0,D.jsx)("div",{className:"price-version-container-top"}),(0,D.jsx)("h3",{className:"user-quota-plan-name py-5",children:t.name}),(0,D.jsxs)("span",{className:"py-2 mb-0 text-orange font-500 text-center",children:["\xa5 ",(0,D.jsx)("span",{className:"price-version-plan-price",children:t.asset_quota_price})," "+t.asset_quota_description]}),(0,D.jsxs)(d.A,{style:{marginBottom:"5px"},className:"space-quota",children:[(0,D.jsx)(u.A,{children:(0,D.jsx)("span",{className:"font-500",children:r})}),(0,D.jsx)(h.A,{className:"py-2",placeholder:r,title:r,type:"number",value:s||1,min:"1",max:"9999",disabled:!t.can_custom_asset_quota,onChange:n.onAssetQuotaUnitCountInputChange}),(0,D.jsx)(u.A,{children:(0,D.jsx)("span",{className:"font-500",children:" x "+t.asset_quota_unit+"GB"})})]}),(0,D.jsxs)("span",{className:"py-4 text-orange mb-0 font-500 price-version-plan-whole-price text-center",children:["\u603b\u4ef7 \xa5 "+i,a!==i&&(0,D.jsx)("span",{style:{fontSize:"small",textDecoration:"line-through",color:"#9a9a9a"},children:" \uffe5"+a})]}),(0,D.jsx)("span",{className:"py-2 mb-0 text-lg-size font-500 price-version-plan-valid-day text-center",children:"\u6709\u6548\u671f\u81f3 "+t.new_term_end}),(0,D.jsx)("span",{className:"subscription-notice text-center py-5",children:"\u6ce8\uff1a\u5f53\u6709\u6548\u671f\u5269\u4f59\u5929\u6570\u5c11\u4e8e\u8ba1\u5212\u4e2d\u7684\u65f6\u5019\uff0c\u589e\u52a0\u7a7a\u95f4\u7684\u4ef7\u683c\u6309\u5929\u6765\u8ba1\u7b97"}),(0,D.jsx)(c.A,{className:"subscription-submit",onClick:n.onPay,color:"primary",children:"\u7acb\u5373\u8d2d\u4e70"})]})},n.state={currentPlan:e.plans[0],assetQuotaUnitCount:1,count:1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props.paymentType;return"paid"===e||"extend_time"===e?this.renderPaidOrExtendTime():"add_user"===e?this.renderAddUser():"buy_quota"===e?this.renderBuyQuota():void l.A.danger((0,f.AP)("Internal Server Error"))}}])}(o.Component),k=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).getPlans=function(){S.getSubscriptionPlans(n.props.paymentType).then((function(e){n.setState({planList:e.data.plan_list,paymentSourceList:e.data.payment_source_list,isLoading:!1})})).catch((function(e){var t=x.Aq.getErrorMsg(e);n.setState({isLoading:!1,errorMsg:t})}))},n.onPay=function(e,t,s,r){n.setState({isWaiting:!0});var a=f.xW+"/subscription/pay/?payment_source="+n.state.paymentSourceList[0]+"&payment_type="+n.props.paymentType+"&plan_id="+e+"&total_amount="+r;t&&(a+="&count="+t),s&&(a+="&asset_quota="+s),window.open(a)},n.onReload=function(){window.location.reload()},n.state={isLoading:!0,isWaiting:!1,planList:[],paymentSourceList:[]},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){this.getPlans()}},{key:"render",value:function(){var e=this.state,t=e.isLoading,n=e.isWaiting,s=e.planList,r=this.props,a=r.toggleDialog,i=r.paymentTypeTrans,o=r.paymentType,l="paid"===o||"extend_time"===o?{width:"560px",maxWidth:"560px"}:{width:"560px"};return t?(0,D.jsxs)(p.A,{isOpen:!0,toggle:a,children:[(0,D.jsx)(w.A,{toggle:a,children:i}),(0,D.jsx)(g.A,{children:(0,D.jsx)(N.A,{})})]}):n?(0,D.jsxs)(p.A,{isOpen:!0,toggle:this.onReload,children:[(0,D.jsx)(w.A,{toggle:this.onReload,children:i}),(0,D.jsx)(g.A,{children:(0,D.jsx)("div",{children:"\u662f\u5426\u5b8c\u6210\u4ed8\u6b3e?"})}),(0,D.jsx)(m.A,{children:(0,D.jsx)("button",{className:"btn btn-outline-primary",onClick:this.onReload,children:"\u662f"})})]}):(0,D.jsxs)(p.A,{isOpen:!0,toggle:a,style:l,children:[(0,D.jsx)(w.A,{toggle:a,children:i}),(0,D.jsx)(g.A,{children:(0,D.jsx)("div",{className:"d-flex justify-content-between",children:(0,D.jsx)(P,{plans:s,onPay:this.onPay,paymentType:this.props.paymentType})})})]})}}])}(o.Component),I=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).getSubscription=function(){S.getSubscription().then((function(e){var t=e.data.subscription,s=e.data.payment_type_list;if(t){var r=t.is_active,a=t.plan;n.setState({isLoading:!1,subscription:t,planName:a.name,userLimit:t.user_limit,assetQuota:r?t.asset_quota:a.asset_quota,termEnd:r?t.term_end:"\u5df2\u8fc7\u671f",paymentTypeList:s})}else n.setState({isLoading:!1,paymentTypeList:s})})).catch((function(e){var t=x.Aq.getErrorMsg(e);n.setState({isLoading:!1,errorMsg:t})}))},n.toggleDialog=function(){n.setState({isDialogOpen:!n.state.isDialogOpen})},n.togglePaymentType=function(e){n.setState({currentPaymentType:e}),n.toggleDialog()},n.paymentTypeTransMap={paid:"\u7acb\u5373\u8d2d\u4e70",extend_time:"\u7acb\u5373\u7eed\u8d39",add_user:"\u589e\u52a0\u7528\u6237",buy_quota:"\u589e\u52a0\u7a7a\u95f4"},n.state={isLoading:!0,errorMsg:"",isDialogOpen:!1,planName:n.props.isOrgContext?"\u56e2\u961f\u7248":"\u4e2a\u4eba\u7248",userLimit:20,assetQuota:1,termEnd:"\u957f\u671f",subscription:null,paymentTypeList:[],currentPaymentType:"",errorMsgCode:""},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){this.getSubscription()}},{key:"render",value:function(){var e=this,t=this.state,n=t.isLoading,s=t.errorMsg,r=t.planName,a=t.userLimit,i=t.assetQuota,l=t.termEnd,c=t.isDialogOpen,d=t.paymentTypeList,u=t.currentPaymentType;return n?(0,D.jsx)(N.A,{}):s?(0,D.jsx)("p",{className:"text-center mt-8 error",children:s}):(0,D.jsxs)(o.Fragment,{children:[(0,D.jsxs)("div",{className:"content position-relative",onScroll:this.props.handleContentScroll,children:[(0,D.jsxs)("div",{id:"current-plan",className:"subscription-info",children:[(0,D.jsx)("h3",{className:"subscription-info-heading",children:"\u5f53\u524d\u7248\u672c"}),(0,D.jsx)("p",{className:"mb-2",children:r})]}),this.props.isOrgContext&&(0,D.jsxs)("div",{id:"user-limit",className:"subscription-info",children:[(0,D.jsx)("h3",{className:"subscription-info-heading",children:"\u7528\u6237\u6570\u9650\u5236"}),(0,D.jsx)("p",{className:"mb-2",children:a})]}),(0,D.jsxs)("div",{id:"asset-quota",className:"subscription-info",children:[(0,D.jsx)("h3",{className:"subscription-info-heading",children:"\u7a7a\u95f4"}),(0,D.jsx)("p",{className:"mb-2",children:i?i+"GB":"1GB"})]}),(0,D.jsxs)("div",{id:"current-subscription-period",className:"subscription-info",children:[(0,D.jsx)("h3",{className:"subscription-info-heading",children:"\u8ba2\u9605\u6709\u6548\u671f"}),(0,D.jsx)("p",{className:"mb-2",children:l})]}),(0,D.jsxs)("div",{id:"product-price",className:"subscription-info",children:[(0,D.jsx)("h3",{className:"subscription-info-heading",children:"\u4e91\u670d\u52a1\u4ed8\u8d39\u65b9\u6848"}),(0,D.jsx)("p",{className:"mb-2",children:(0,D.jsx)("a",{rel:"noopener noreferrer",target:"_blank",href:"https://www.seafile.com/seafile-docs/home/",children:"\u67e5\u770b\u8be6\u60c5"})})]}),d.map((function(t,n){var s=e.paymentTypeTransMap[t];return(0,D.jsx)("button",{className:"btn btn-outline-primary mr-4",onClick:e.togglePaymentType.bind(e,t),children:s},n)})),!this.state.subscription&&(0,D.jsxs)("div",{id:"sales-consultant",className:"subscription-info mt-6",children:[(0,D.jsx)("h3",{className:"subscription-info-heading",children:"\u9500\u552e\u54a8\u8be2"}),(0,D.jsx)("img",{className:"mb-2",src:"/media/img/qr-sale.png",alt:"",width:"112"}),(0,D.jsx)("p",{className:"mb-2",children:"\u5fae\u4fe1\u626b\u7801\u8054\u7cfb\u9500\u552e"})]})]}),c&&(0,D.jsx)(k,{paymentType:u,paymentTypeTrans:this.paymentTypeTransMap[u],isOrgContext:this.props.isOrgContext,toggleDialog:this.toggleDialog})]})}}])}(o.Component),_=I},83970:function(e,t,n){var s=n(23029),r=n(92901),a=n(39874),i=n(85501),o=n(9950),l=n(65488),c=n(8123),d=n(44414),u=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).onInputChange=function(e){var t=e.target.checked,s=t?1:0;n.setState({inputChecked:t}),n.props.saveSetting(n.props.keyText,s)},n.state={inputChecked:n.props.value},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.state.inputChecked,t=this.props,n=t.helpTip,s=t.displayName;return(0,d.jsx)(c.A,{displayName:s,mainClassName:"d-flex",mainContent:(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(l.A,{className:"ml-0",checked:e,type:"checkbox",onChange:this.onInputChange}),(0,d.jsx)("p",{className:"ml-2",children:n})]})})}}])}(o.Component);t.A=u},15263:function(e,t,n){var s=n(9950),r=n(34322),a=n(40326),i=n(8123),o=n(44414);t.A=function(e){var t=(0,s.useRef)(null),n=e.helpTip,l=e.filePath,c=e.fileWidth,d=e.fileHeight,u=e.displayName;return(0,o.jsx)(i.A,{displayName:u,helpTip:n,mainContent:(0,o.jsx)("img",{src:l+"?t="+(new Date).getTime(),alt:u,width:c,height:d,className:"mb-1"}),extraContent:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(r.A,{color:"secondary",onClick:function(){t.current.click()},children:(0,a.AP)("Change")}),(0,o.jsx)("input",{className:"d-none",type:"file",onChange:function(){if(t.current.files.length){var n=t.current.files[0];e.postFile(n,e.keyText)}},ref:t})]})})}},72714:function(e,t,n){n(9950);var s=n(44414);t.A=function(e){var t=e.headingText,n=e.children;return(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("h4",{className:"border-bottom font-weight-normal mb-2 pb-1",children:t}),n]})}},8123:function(e,t,n){n(9950);var s=n(97176),r=n(46114),a=n(91646),i=n(44414);t.A=function(e){var t=e.helpTip,n=e.displayName,o=e.mainContent,l=e.extraContent,c=e.mainClassName,d=void 0===c?"":c;return(0,i.jsxs)(s.A,{className:"my-4",children:[(0,i.jsx)(r.A,{md:"3",children:(0,i.jsx)(a.A,{className:"web-setting-label",children:n})}),(0,i.jsxs)(r.A,{md:"5",className:d,children:[o,t&&(0,i.jsx)("p",{className:"small text-secondary mt-1",children:t})]}),(0,i.jsx)(r.A,{md:"4",children:l})]})}},83755:function(e,t,n){var s=n(23029),r=n(92901),a=n(39874),i=n(85501),o=n(9950),l=n(1352),c=n(14894),d=n(67818),u=n(66945),h=n(40326),p=n(49403),g=n(95754),m=n(44414),f=function(e){function t(){var e;(0,s.default)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=(0,a.default)(this,t,[].concat(r))).getActiveClass=function(t){return e.props.currentTab==t?"active":""},e.tabItemClick=function(t){e.props.tabItemClick(t)},e}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this;return(0,m.jsxs)("div",{className:"side-panel ".concat(this.props.isSidePanelClosed?"":"left-zero"),children:[(0,m.jsx)("div",{className:"side-panel-north",children:(0,m.jsx)(p.A,{onCloseSidePanel:this.props.onCloseSidePanel})}),(0,m.jsx)("div",{className:"side-panel-center",children:(0,m.jsx)("div",{className:"side-nav",children:(0,m.jsxs)("div",{className:"side-nav-con",children:[(0,m.jsx)("h3",{className:"sf-heading",style:{color:"#f7941d"},children:(0,h.AP)("Admin")}),(0,m.jsxs)("ul",{className:"nav nav-pills flex-column nav-container",children:[(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("info")),children:(0,m.jsxs)(c.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("info")),to:h.Yc+"org/info/",onClick:function(){return e.tabItemClick("info")},children:[(0,m.jsx)("span",{className:"sf2-icon-info"}),(0,m.jsx)("span",{className:"nav-text",children:(0,h.AP)("Info")})]})}),(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("statistics-admin")),children:(0,m.jsxs)(c.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("statistics-admin")),to:h.Yc+"org/statistics-admin/file/",onClick:function(){return e.tabItemClick("statistics-admin")},children:[(0,m.jsx)("span",{className:"sf2-icon-histogram"}),(0,m.jsx)("span",{className:"nav-text",children:(0,h.AP)("Statistic")})]})}),(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("deviceadmin")),children:(0,m.jsxs)(c.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("deviceadmin")),to:h.Yc+"org/deviceadmin/desktop-devices/",onClick:function(){return e.tabItemClick("deviceadmin")},children:[(0,m.jsx)("span",{className:"sf2-icon-monitor"}),(0,m.jsx)("span",{className:"nav-text",children:(0,h.AP)("Devices")})]})}),(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("web-settings")),children:(0,m.jsxs)(c.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("web-settings")),to:h.Yc+"org/web-settings/",onClick:function(){return e.tabItemClick("web-settings")},children:[(0,m.jsx)("span",{className:"sf2-icon-cog2"}),(0,m.jsx)("span",{className:"nav-text",children:(0,h.AP)("Settings")})]})}),(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("repoadmin")),children:(0,m.jsxs)(c.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("repoadmin")),to:h.Yc+"org/repoadmin/",onClick:function(){return e.tabItemClick("repoadmin")},children:[(0,m.jsx)("span",{className:"sf2-icon-library"}),(0,m.jsx)("span",{className:"nav-text",children:(0,h.AP)("Libraries")})]})}),(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("users")),children:(0,m.jsxs)(c.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("users")||this.getActiveClass("admins")),to:h.Yc+"org/useradmin/",onClick:function(){return e.tabItemClick("users")},children:[(0,m.jsx)("span",{className:"sf2-icon-user"}),(0,m.jsx)("span",{className:"nav-text",children:(0,h.AP)("Users")})]})}),(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("groupadmin")),children:(0,m.jsxs)(c.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("groupadmin")),to:h.Yc+"org/groupadmin/",onClick:function(){return e.tabItemClick("groupadmin")},children:[(0,m.jsx)("span",{className:"sf2-icon-group"}),(0,m.jsx)("span",{className:"nav-text",children:(0,h.AP)("Groups")})]})}),(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("departmentadmin")),children:(0,m.jsxs)(c.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("departmentadmin")),to:h.Yc+"org/departmentadmin/",onClick:function(){return e.tabItemClick("departmentadmin")},children:[(0,m.jsx)("span",{className:"sf2-icon-organization"}),(0,m.jsx)("span",{className:"nav-text",children:(0,h.AP)("Departments")})]})}),h.n6&&(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("subscription")),children:(0,m.jsxs)(c.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("subscription")),to:h.Yc+"org/subscription/",onClick:function(){return e.tabItemClick("subscription")},children:[(0,m.jsx)(g.A,{symbol:"currency"}),(0,m.jsx)("span",{className:"nav-text",children:"\u4ed8\u8d39\u7ba1\u7406"})]})}),h.RV&&(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("billing")),children:(0,m.jsxs)("a",{href:h.Yc+"billing/",target:"_blank",rel:"noreferrer",className:"nav-link",children:[(0,m.jsx)(g.A,{symbol:"currency"}),(0,m.jsx)("span",{className:"nav-text",children:(0,h.AP)("Billing")})]})}),(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("publinkadmin")),children:(0,m.jsxs)(c.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("publinkadmin")),to:h.Yc+"org/publinkadmin/",onClick:function(){return e.tabItemClick("publinkadmin")},children:[(0,m.jsx)("span",{className:"sf2-icon-link"}),(0,m.jsx)("span",{className:"nav-text",children:(0,h.AP)("Links")})]})}),(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("fileaudit")||this.getActiveClass("file-update")||this.getActiveClass("perm-audit")),children:(0,m.jsxs)(c.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("fileaudit")||this.getActiveClass("file-update")||this.getActiveClass("perm-audit")),to:h.Yc+"org/logadmin/",onClick:function(){return e.tabItemClick("fileaudit")},children:[(0,m.jsx)("span",{className:"sf2-icon-clock"}),(0,m.jsx)("span",{className:"nav-text",children:(0,h.AP)("Logs")})]})}),h.bH&&(0,m.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("SAML config")),children:(0,m.jsxs)(c.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("SAML config")),to:h.Yc+"org/samlconfig/",onClick:function(){return e.tabItemClick("SAML config")},children:[(0,m.jsx)("span",{className:"sf2-icon-cog2"}),(0,m.jsx)("span",{className:"nav-text",children:(0,h.AP)("SAML config")})]})})]})]})})})]})}}])}(o.Component),x=f,v=n(5544),j=n(4159),A=n.n(j),S=n(51925),y=function(e){function t(){return(0,s.default)(this,t),(0,a.default)(this,t,arguments)}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){return(0,m.jsxs)("div",{className:"main-panel-north ".concat(this.props.children?"border-left-show":""),children:[(0,m.jsxs)("div",{className:"cur-view-toolbar",children:[(0,m.jsx)("span",{className:"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none",title:"Side Nav Menu"}),(0,m.jsx)("div",{className:"operation",children:this.props.children})]}),(0,m.jsxs)("div",{className:"common-toolbar",children:[this.props.search&&this.props.search,(0,m.jsx)(S.A,{isAdminPanel:!0})]})]})}}])}(o.Component),N=y,w=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).navItems=[{name:"fileStatistic",urlPart:"statistics-admin/file",text:(0,h.AP)("File")},{name:"storageStatistic",urlPart:"statistics-admin/total-storage",text:(0,h.AP)("Storage")},{name:"usersStatistic",urlPart:"statistics-admin/active-users",text:(0,h.AP)("Users")},{name:"trafficStatistic",urlPart:"statistics-admin/traffic",text:(0,h.AP)("Traffic")},{name:"reportsStatistic",urlPart:"statistics-admin/reports",text:(0,h.AP)("Reports")}],n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props.currentItem;return(0,m.jsx)("div",{className:"cur-view-path tab-nav-container",children:(0,m.jsx)("ul",{className:"nav",children:this.navItems.map((function(t,n){return(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsx)(c.N_,{to:"".concat(h.Yc,"org/").concat(t.urlPart,"/"),className:"nav-link".concat(e==t.name?" active":""),children:t.text})},n)}))})})}}])}(o.Component),D=n(64467),b=n(29343),P=n(34322),k=n(52544),I=n(86547),_=n.n(I),C=n(81139),M=(n(33731),n(9516),n(19617),"YYYY-MM-DD"),O=function(e){function t(e){var n;(0,s.default)(this,t),n=(0,a.default)(this,t,[e]);var r=window.app.config.lang,i=A()();return i="zh-cn"===r?i.locale("zh-cn"):i.locale("en-gb"),n.defaultCalendarValue=i.clone(),n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props,t=(0,m.jsx)(k.A,{defaultValue:this.defaultCalendarValue,disabledDate:e.disabledDate,format:M,locale:(0,C.r)()});return(0,m.jsx)(_(),{calendar:t,value:e.value,onChange:e.onChange,children:function(e){var t=e.value;return(0,m.jsx)("span",{children:(0,m.jsx)("input",{placeholder:"yyyy-mm-dd",tabIndex:"-1",readOnly:!0,value:t&&t.format(M)||"",className:"form-control system-statistic-input"})})}})}}])}(o.Component),L=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).changeActive=function(e){if(n.state.statisticType!==e){var t,s=A()().format("YYYY-MM-DD 00:00:00");switch(e){case"oneWeek":t=A()().subtract(6,"d").format("YYYY-MM-DD 00:00:00");break;case"oneMonth":t=A()().subtract(29,"d").format("YYYY-MM-DD 00:00:00");break;case"oneYear":t=A()().subtract(364,"d").format("YYYY-MM-DD 00:00:00")}n.setState({statisticType:e});n.props.getActivesFiles(t,s,"day")}},n.disabledStartDate=function(e){if(!e)return!1;var t=A()().format(),s=n.state.endValue;return s?s.isBefore(e)||A()(e).format()>t:t<A()(e).format()},n.disabledEndDate=function(e){if(!e)return!1;var t=A()().format(),s=n.state.startValue;return s?e.isBefore(s)||A()(e).format()>t:t<A()(e).format()},n.onChange=function(e,t){n.setState((0,D.default)({},e,t))},n.onSubmit=function(){var e=n.state,t=e.startValue,s=e.endValue;if(t&&s){n.setState({statisticType:"itemButton"});var r=A()(t).format("YYYY-MM-DD 00:00:00"),a=A()(s).format("YYYY-MM-DD 00:00:00");n.props.getActivesFiles(r,a,"day")}},n.state={statisticType:"oneWeek",startValue:null,endValue:null},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){var e=A()().format("YYYY-MM-DD 00:00:00"),t=A()().subtract(6,"d").format("YYYY-MM-DD 00:00:00");this.props.getActivesFiles(t,e,"day")}},{key:"render",value:function(){var e=this.state,t=e.statisticType,n=e.endValue,s=e.startValue;return(0,m.jsxs)(o.Fragment,{children:[this.props.children,(0,m.jsxs)("div",{className:"system-statistic-time-range",children:[(0,m.jsxs)(b.A,{size:"sm",className:"sys-stat-tool",children:[(0,m.jsx)(P.A,{className:"font-weight-normal ".concat("oneWeek"===t?"item-active":""),onClick:this.changeActive.bind(this,"oneWeek"),children:(0,h.AP)("7 Days")}),(0,m.jsx)(P.A,{className:"font-weight-normal ".concat("oneMonth"===t?"item-active":""),onClick:this.changeActive.bind(this,"oneMonth"),children:(0,h.AP)("30 Days")}),(0,m.jsx)(P.A,{className:"font-weight-normal ".concat("oneYear"===t?"item-active":""),onClick:this.changeActive.bind(this,"oneYear"),children:(0,h.AP)("1 Year")})]}),(0,m.jsxs)("div",{className:"system-statistic-input-container",children:[(0,m.jsx)(O,{disabledDate:this.disabledStartDate,value:s,onChange:this.onChange.bind(this,"startValue")}),(0,m.jsx)("span",{className:"system-statistic-connect",children:"-"}),(0,m.jsx)(O,{disabledDate:this.disabledEndDate,value:n,onChange:this.onChange.bind(this,"endValue")}),(0,m.jsx)(P.A,{color:"primary",size:"sm",className:"system-statistic-button",onClick:this.onSubmit,children:(0,h.AP)("Submit")})]})]})]})}}])}(o.Component),U=n(2662),R=n(9961),T=n(65604),F=n(4086),E=n(86335),z=(n(63864),function(){var e=(0,o.useState)(!0),t=(0,v.default)(e,2),n=t[0],s=t[1],r=(0,o.useState)([]),a=(0,v.default)(r,2),i=a[0],l=a[1],c=(0,o.useMemo)((function(){return[{key:"added",color:"#57cd6b",name:(0,h.AP)("Added")},{key:"visited",color:"#fd913a",name:(0,h.AP)("Visited")},{key:"modified",color:"#72c3fc",name:(0,h.AP)("Modified")},{key:"deleted",color:"#f75356",name:(0,h.AP)("Deleted")}]}),[]),d=(0,o.useCallback)((function(e,t,n){s(!0),U.k.orgAdminStatisticFiles(h.Id,e,t,n).then((function(e){var t=Array.isArray(e.data)?e.data.map((function(e){var t=e.added,n=e.deleted,s=e.modified,r=e.visited,a=e.datetime;return{name:A()(a).format("YYYY-MM-DD"),added:t,deleted:n,modified:s,visited:r}})):[];s(!1),l(t)})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))}),[]);return(0,m.jsxs)(o.Fragment,{children:[(0,m.jsx)(N,{}),(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)(w,{currentItem:"fileStatistic"}),(0,m.jsxs)("div",{className:"cur-view-content",children:[(0,m.jsx)(L,{getActivesFiles:d}),n&&(0,m.jsx)(R.A,{}),!n&&i.length>0&&(0,m.jsx)(E.A,{title:(0,h.AP)("File Operations"),data:i,legends:c,ySuggestedMax:10})]})]})]})}),Y=function(){var e=(0,o.useState)(!0),t=(0,v.default)(e,2),n=t[0],s=t[1],r=(0,o.useState)([]),a=(0,v.default)(r,2),i=a[0],l=a[1],c=(0,o.useMemo)((function(){return[{key:"total_storage",name:(0,h.AP)("Total Storage"),color:"#fd913a"}]}),[]),d=(0,o.useMemo)((function(){return 1e7}),[]),u=(0,o.useCallback)((function(e,t,n){s(!0),U.k.orgAdminStatisticStorages(h.Id,e,t,n).then((function(e){var t=Array.isArray(e.data)?e.data.map((function(e){var t=e.total_storage,n=e.datetime;return{name:A()(n).format("YYYY-MM-DD"),total_storage:t}})):[];l(t),s(!1)})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))}),[]),p=(0,o.useCallback)((function(e){return T.Aq.bytesToSize(e)}),[]);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(N,{}),(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)(w,{currentItem:"storageStatistic"}),(0,m.jsxs)("div",{className:"cur-view-content",children:[(0,m.jsx)(L,{getActivesFiles:u}),n&&(0,m.jsx)(R.A,{}),!n&&i.length>0&&(0,m.jsx)(E.A,{title:(0,h.AP)("Total Storage"),legends:c,data:i,margin:{top:60,right:30,bottom:30,left:60},ySuggestedMax:d,getDisplayValue:p})]})]})]})},q=n(65488),B=function(e){function t(e){return(0,s.default)(this,t),(0,a.default)(this,t,[e])}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props,t=e.type,n=e.sortBy,s="asc"==e.sortOrder?(0,m.jsx)("span",{className:"sf3-font sf3-font-down rotate-180 d-inline-block"}):(0,m.jsx)("span",{className:"sf3-font sf3-font-down"});return(0,m.jsxs)("table",{className:"table-hover",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"16%",children:"user"==t?(0,h.AP)("User"):(0,h.AP)("Organization")}),(0,m.jsx)("th",{width:"11%",children:(0,m.jsxs)("div",{className:"d-block table-sort-op cursor-pointer",onClick:this.props.sortItems.bind(this,"sync_file_upload"),children:[(0,h.AP)("Sync Upload")," ","sync_file_upload"===n&&s]})}),(0,m.jsx)("th",{width:"14%",children:(0,m.jsxs)("div",{className:"d-block table-sort-op cursor-pointer",onClick:this.props.sortItems.bind(this,"sync_file_download"),children:[(0,h.AP)("Sync Download")," ","sync_file_download"===n&&s]})}),(0,m.jsx)("th",{width:"11%",children:(0,m.jsxs)("div",{className:"d-block table-sort-op cursor-pointer",onClick:this.props.sortItems.bind(this,"web_file_upload"),children:[(0,h.AP)("Web Upload")," ","web_file_upload"===n&&s]})}),(0,m.jsx)("th",{width:"14%",children:(0,m.jsxs)("div",{className:"d-block table-sort-op cursor-pointer",onClick:this.props.sortItems.bind(this,"web_file_download"),children:[(0,h.AP)("Web Download")," ","web_file_download"===n&&s]})}),(0,m.jsx)("th",{width:"17%",children:(0,m.jsxs)("div",{className:"d-block table-sort-op cursor-pointer",onClick:this.props.sortItems.bind(this,"link_file_upload"),children:[(0,h.AP)("Share link upload")," ","link_file_upload"===n&&s]})}),(0,m.jsx)("th",{width:"17%",children:(0,m.jsxs)("div",{className:"d-block table-sort-op cursor-pointer",onClick:this.props.sortItems.bind(this,"link_file_download"),children:[(0,h.AP)("Share link download")," ","link_file_download"===n&&s]})})]})}),(0,m.jsx)("tbody",{children:this.props.children})]})}}])}(o.Component),V=function(e){function t(){var e;(0,s.default)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=(0,a.default)(this,t,[].concat(r))).trafficName=function(){var t=e.props,n=t.userTrafficItem;switch(t.type){case"user":return n.name?(0,m.jsx)("a",{href:h.Yc+"org/useradmin/info/"+n.email+"/",children:n.name}):(0,m.jsx)("span",{children:"--"});case"org":return(0,m.jsx)("span",{children:n.org_name})}},e}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props.userTrafficItem,t=T.Aq.bytesToSize(e.sync_file_upload),n=T.Aq.bytesToSize(e.sync_file_download),s=T.Aq.bytesToSize(e.web_file_upload),r=T.Aq.bytesToSize(e.web_file_download),a=T.Aq.bytesToSize(e.link_file_upload),i=T.Aq.bytesToSize(e.link_file_download);return(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{children:this.trafficName()}),(0,m.jsx)("td",{children:t}),(0,m.jsx)("td",{children:n}),(0,m.jsx)("td",{children:s}),(0,m.jsx)("td",{children:r}),(0,m.jsx)("td",{children:a}),(0,m.jsx)("td",{children:i})]})}}])}(o.Component),G=V,H=n(62376),Q=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).getPreviousPage=function(){n.getTrafficList(n.state.month,n.state.currentPage-1)},n.getNextPage=function(){n.getTrafficList(n.state.month,n.state.currentPage+1)},n.handleChange=function(e){var t=e.target.value;n.setState({month:t})},n.handleKeyPress=function(e){var t=n.state.month;if("Enter"===e.key){if(!/^([012]\d{3})(0[1-9]|1[012])$/.test(t)){var s=(0,h.AP)("Invalid month, should be yyyymm.");return void n.setState({errorMessage:s})}n.getTrafficList(t,n.initPage),e.target.blur(),e.preventDefault()}},n.getTrafficList=function(e,t){var s=n.state,r=s.perPage,a=s.sortBy,i=s.sortOrder,o="asc"==i?a:"".concat(a,"_").concat(i);n.setState({isLoading:!0,errorMessage:""}),U.k.orgAdminListUserTraffic(h.Id,e,t,r,o).then((function(s){var r=s.data.user_monthly_traffic_list.slice(0);n.setState({month:e,currentPage:t,userTrafficList:r,hasNextPage:s.data.has_next_page,isLoading:!1})})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.sortItems=function(e){n.setState({sortBy:e,sortOrder:"asc"==n.state.sortOrder?"desc":"asc"},(function(){var e=n.state,t=e.month,s=e.currentPage;n.getTrafficList(t,s)}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){return n.getTrafficList(n.initMonth,n.initPage)}))},n.state={userTrafficList:[],hasNextPage:!1,perPage:100,currentPage:1,month:A()().format("YYYYMM"),isLoading:!1,errorMessage:"",sortBy:"link_file_download",sortOrder:"desc"},n.initPage=1,n.initMonth=A()().format("YYYYMM"),n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,s=n.currentPage,r=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||r),currentPage:parseInt(t.get("page")||s)},(function(){e.getTrafficList(e.initMonth,e.state.currentPage)}))}},{key:"render",value:function(){var e=this.state,t=e.isLoading,n=e.errorMessage,s=e.userTrafficList,r=e.currentPage,a=e.hasNextPage,i=e.perPage,l=e.sortBy,c=e.sortOrder;return(0,m.jsxs)(o.Fragment,{children:[(0,m.jsxs)("div",{className:"d-flex align-items-center mt-4",children:[(0,m.jsx)("span",{className:"statistic-reports-tip",children:(0,h.AP)("Month:")}),(0,m.jsx)(q.A,{className:"statistic-reports-input",defaultValue:A()().format("YYYYMM"),onChange:this.handleChange,onKeyPress:this.handleKeyPress}),n&&(0,m.jsx)("div",{className:"error",children:n})]}),t&&(0,m.jsx)(R.A,{}),!t&&(0,m.jsx)(B,{type:"user",sortItems:this.sortItems,sortBy:l,sortOrder:c,children:s.length>0&&s.map((function(e,t){return(0,m.jsx)(G,{userTrafficItem:e,type:"user"},t)}))}),(0,m.jsx)(H.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:r,hasNextPage:a,curPerPage:i,resetPerPage:this.resetPerPage})]})}}])}(o.Component),W=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).changeTabActive=function(e){n.setState({tabActive:e})},n.getActivesFiles=function(e,t,s){U.k.orgAdminStatisticSystemTraffic(h.Id,e,t,s).then((function(e){var t=[],s=[],r=[],a=[],i=e.data;Array.isArray(i)&&i.forEach((function(e){var n=e.datetime,i=A()(n).format("YYYY-MM-DD");s.push({name:i,upload:e["web-file-upload"],download:e["web-file-download"]}),r.push({name:i,upload:e["link-file-upload"],download:e["link-file-download"]}),a.push({name:i,upload:e["sync-file-upload"],download:e["sync-file-download"]}),t.push({name:i,upload:e["link-file-upload"]+e["sync-file-upload"]+e["web-file-upload"],download:e["link-file-download"]+e["sync-file-download"]+e["web-file-download"]})})),n.setState({linkData:r,syncData:a,webData:s,totalData:t,isLoading:!1})})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.getDisplayValue=function(e){return T.Aq.bytesToSize(e)},n.renderCommonTool=function(){var e=n.state.tabActive;return"system"===e?(0,m.jsx)(L,{getActivesFiles:n.getActivesFiles,children:(0,m.jsxs)("div",{className:"statistic-traffic-tab",children:[(0,m.jsx)("div",{className:"statistic-traffic-tab-item ".concat("system"===e?"active":""),onClick:n.changeTabActive.bind(n,"system"),children:(0,h.AP)("System")}),(0,m.jsx)("div",{className:"statistic-traffic-tab-item ".concat("user"===e?"active":""),onClick:n.changeTabActive.bind(n,"user"),children:(0,h.AP)("Users")})]})}):(0,m.jsxs)("div",{className:"statistic-traffic-tab",children:[(0,m.jsx)("div",{className:"statistic-traffic-tab-item ".concat("system"===e?"active":""),onClick:n.changeTabActive.bind(n,"system"),children:(0,h.AP)("System")}),(0,m.jsx)("div",{className:"statistic-traffic-tab-item ".concat("user"===e?"active":""),onClick:n.changeTabActive.bind(n,"user"),children:(0,h.AP)("Users")})]})},n.legends=[{key:"upload",name:(0,h.AP)("Upload"),color:"#fd913a"},{key:"download",name:(0,h.AP)("Download"),color:"#57cd6b"}],n.state={totalData:[],linkData:[],syncData:[],webData:[],isLoading:!0,tabActive:"system"},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.state,t=e.totalData,n=e.linkData,s=e.syncData,r=e.webData,a=e.isLoading,i=e.tabActive;return(0,m.jsxs)(o.Fragment,{children:[(0,m.jsx)(N,{}),(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)(w,{currentItem:"trafficStatistic"}),(0,m.jsxs)("div",{className:"cur-view-content",children:[this.renderCommonTool(),a&&(0,m.jsx)(R.A,{}),!a&&"system"===i&&(0,m.jsxs)("div",{className:"statistic-traffic-chart-container",children:[t.length>0&&(0,m.jsx)("div",{className:"mb-4",children:(0,m.jsx)(E.A,{legends:this.legends,data:t,title:(0,h.AP)("Total Traffic"),ySuggestedMax:1e7,margin:{top:60,right:30,bottom:30,left:60},getDisplayValue:this.getDisplayValue})}),r.length>0&&(0,m.jsx)("div",{className:"mb-4",children:(0,m.jsx)(E.A,{legends:this.legends,data:r,title:(0,h.AP)("Web Traffic"),ySuggestedMax:1e7,margin:{top:60,right:30,bottom:30,left:60},getDisplayValue:this.getDisplayValue})}),n.length>0&&(0,m.jsx)("div",{className:"mb-4",children:(0,m.jsx)(E.A,{legends:this.legends,data:n,title:(0,h.AP)("Share Link Traffic"),ySuggestedMax:1e7,margin:{top:60,right:30,bottom:30,left:60},getDisplayValue:this.getDisplayValue})}),s.length>0&&(0,m.jsx)("div",{className:"mb-4",children:(0,m.jsx)(E.A,{legends:this.legends,data:s,title:(0,h.AP)("Sync Traffic"),ySuggestedMax:1e7,margin:{top:60,right:30,bottom:30,left:60},getDisplayValue:this.getDisplayValue})})]}),!a&&"user"===i&&(0,m.jsx)(Q,{})]})]})]})}}])}(o.Component),K=function(){var e=(0,o.useState)(!0),t=(0,v.default)(e,2),n=t[0],s=t[1],r=(0,o.useState)([]),a=(0,v.default)(r,2),i=a[0],l=a[1],c=(0,o.useMemo)((function(){return[{key:"count",name:(0,h.AP)("Active Users"),color:"#fd913a"}]}),[]),d=(0,o.useMemo)((function(){return 10}),[]),u=(0,o.useCallback)((function(e,t,n){s(!0),U.k.orgAdminStatisticActiveUsers(h.Id,e,t,n).then((function(e){var t=Array.isArray(e.data)?e.data.map((function(e){var t=e.count,n=e.datetime;return{name:A()(n).format("YYYY-MM-DD"),count:t}})):[];l(t),s(!1)})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))}),[]);return(0,m.jsxs)(o.Fragment,{children:[(0,m.jsx)(N,{}),(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)(w,{currentItem:"usersStatistic"}),(0,m.jsxs)("div",{className:"cur-view-content",children:[(0,m.jsx)(L,{getActivesFiles:u}),n&&(0,m.jsx)(R.A,{}),!n&&i.length>0&&(0,m.jsx)(E.A,{title:(0,h.AP)("Active Users"),legends:c,data:i,ySuggestedMax:d})]})]})]})},X=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).handleChange=function(e){var t=e.target.value;n.setState({month:t})},n.onGenerateReports=function(e){var t=h.xW+h.Yc+"api/v2.1/org/"+h.Id+"/admin/statistics/",s=n.state.month;if(s){if("month"===e){if(!/^([012]\d{3})(0[1-9]|1[012])$/.test(s)){var r=(0,h.AP)("Invalid month, should be yyyymm.");return void n.setState({errorMessage:r})}}switch(e){case"month":t+="user-traffic/excel/?month="+s;break;case"storage":t+="user-storage/excel/?"}n.setState({errorMessage:""}),window.location.href=new URL(t)}else{var a=(0,h.AP)("It is required.");n.setState({errorMessage:a})}},n.state={month:A()().format("YYYYMM"),errorMessage:""},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.state.errorMessage;return(0,m.jsxs)(o.Fragment,{children:[(0,m.jsx)(N,{}),(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)(w,{currentItem:"reportsStatistic"}),(0,m.jsxs)("div",{className:"cur-view-content",children:[(0,m.jsxs)("div",{className:"statistic-reports",children:[(0,m.jsx)("div",{className:"statistic-reports-title",children:(0,h.AP)("Monthly User Traffic")}),(0,m.jsxs)("div",{className:"d-flex align-items-center mt-4",children:[(0,m.jsx)("span",{className:"statistic-reports-tip",children:(0,h.AP)("Month:")}),(0,m.jsx)(q.A,{className:"statistic-reports-input",defaultValue:A()().format("YYYYMM"),onChange:this.handleChange}),(0,m.jsx)(P.A,{className:"statistic-reports-submit operation-item",onClick:this.onGenerateReports.bind(this,"month"),children:(0,h.AP)("Create Report")})]}),e&&(0,m.jsx)("div",{className:"error",children:e})]}),(0,m.jsxs)("div",{className:"statistic-reports",children:[(0,m.jsx)("div",{className:"statistic-reports-title",children:(0,h.AP)("User Storage")}),(0,m.jsx)(P.A,{className:"mt-4 operation-item",onClick:this.onGenerateReports.bind(this,"storage"),children:(0,h.AP)("Create Report")})]})]})]})]})}}])}(o.Component),$=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).navItems=[{name:"desktop",urlPart:"desktop-devices",text:(0,h.AP)("Desktop")},{name:"mobile",urlPart:"mobile-devices",text:(0,h.AP)("Mobile")},{name:"errors",urlPart:"devices-errors",text:(0,h.AP)("Errors")}],n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props.currentItem;return(0,m.jsx)("div",{className:"cur-view-path tab-nav-container",children:(0,m.jsx)("ul",{className:"nav",children:this.navItems.map((function(t,n){return(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsx)(c.N_,{to:"".concat(h.Yc,"org/deviceadmin/").concat(t.urlPart,"/"),className:"nav-link".concat(e==t.name?" active":""),children:t.text})},n)}))})})}}])}(o.Component),J=$,Z=n(48738),ee=n.n(Z),te=n(37609),ne=n.n(te),se=n(43066),re=n(96763);A().extend(ne());var ae=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).getPreviousPageDevicesList=function(){n.props.getDevicesListByPage(n.props.pageInfo.current_page-1)},n.getNextPageDevicesList=function(){n.props.getDevicesListByPage(n.props.pageInfo.current_page+1)},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg,s=e.items,r=e.pageInfo,a=e.curPerPage;if(t)return(0,m.jsx)(R.A,{});if(n)return(0,m.jsx)("p",{className:"error text-center",children:n});var i=(0,m.jsx)(se.A,{text:(0,h.AP)("No connected devices")}),l=(0,m.jsxs)(o.Fragment,{children:[(0,m.jsxs)("table",{className:"table-hover",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"19%",children:(0,h.AP)("User")}),(0,m.jsxs)("th",{width:"19%",children:[(0,h.AP)("Platform")," / ",(0,h.AP)("Version")]}),(0,m.jsx)("th",{width:"19%",children:(0,h.AP)("Device Name")}),(0,m.jsx)("th",{width:"19%",children:(0,h.AP)("IP")}),(0,m.jsx)("th",{width:"19%",children:(0,h.AP)("Last Access")}),(0,m.jsx)("th",{width:"5%"})]})}),(0,m.jsx)("tbody",{children:s.map((function(e,t){return(0,m.jsx)(ie,{item:e},t)}))})]}),(0,m.jsx)(H.A,{gotoPreviousPage:this.getPreviousPageDevicesList,gotoNextPage:this.getNextPageDevicesList,currentPage:r.current_page,hasNextPage:r.has_next_page,curPerPage:a,resetPerPage:this.props.resetPerPage})]});return s.length?l:i}}])}(o.Component),ie=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).handleMouseOver=function(){n.setState({isHighlighted:!0,isOpIconShown:!0})},n.handleMouseOut=function(){n.setState({isHighlighted:!1,isOpIconShown:!1})},n.handleUnlink=function(){n.props.item.is_desktop_client?n.toggleUnlinkDeviceDialog():n.unlinkDevice(!0)},n.toggleUnlinkDeviceDialog=function(){n.setState({isUnlinkDeviceDialogOpen:!n.state.isUnlinkDeviceDialogOpen})},n.unlinkDevice=function(e){var t=n.props.item,s=t.platform,r=t.device_id,a=t.user;U.k.orgAdminUnlinkDevice(h.Id,s,r,a,e).then((function(e){n.setState({unlinked:!0});var t=(0,h.AP)("Successfully unlinked the device.");F.A.success(t)})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.state={isHighlighted:!1,unlinked:!1,isOpIconShown:!1,isUnlinkDeviceDialogOpen:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props.item,t=this.state,n=t.unlinked,s=t.isUnlinkDeviceDialogOpen,r=t.isOpIconShown,a=t.isHighlighted;return n?null:(0,m.jsxs)(o.Fragment,{children:[(0,m.jsxs)("tr",{className:ee()({"tr-highlight":a}),onMouseEnter:this.handleMouseOver,onMouseLeave:this.handleMouseOut,children:[(0,m.jsx)("td",{children:e.user_name}),(0,m.jsxs)("td",{children:[e.platform," / ",e.client_version]}),(0,m.jsx)("td",{children:e.device_name}),(0,m.jsx)("td",{children:e.last_login_ip}),(0,m.jsx)("td",{children:(0,m.jsx)("span",{title:A()(e.last_accessed).format("dddd, MMMM D, YYYY h:mm:ss A"),children:A()(e.last_accessed).fromNow()})}),(0,m.jsx)("td",{children:(0,m.jsx)("i",{className:"sf3-font-delete1 sf3-font op-icon ".concat(r?"":"invisible"),title:(0,h.AP)("Unlink"),onClick:this.handleUnlink})})]}),s&&(0,m.jsx)(re.A,{unlinkDevice:this.unlinkDevice,toggleDialog:this.toggleUnlinkDeviceDialog})]})}}])}(o.Component),oe=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).getDevicesListByPage=function(e){var t=n.props.devicesPlatform,s=n.state.perPage;U.k.orgAdminListDevices(h.Id,t,e,s).then((function(e){n.setState({devicesData:e.data.devices,pageInfo:e.data.page_info,loading:!1})})).catch((function(e){n.setState({loading:!1,errorMsg:T.Aq.getErrorMsg(e,!0)})}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){n.getDevicesListByPage(1)}))},n.state={loading:!0,errorMsg:"",devicesData:[],pageInfo:{},perPage:100},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,s=n.currentPage,r=void 0===s?1:s,a=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||a),currentPage:parseInt(t.get("page")||r)},(function(){e.getDevicesListByPage(e.state.currentPage)}))}},{key:"render",value:function(){return(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsx)(ae,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.devicesData,getDevicesListByPage:this.getDevicesListByPage,curPerPage:this.state.perPage,resetPerPage:this.resetPerPage,pageInfo:this.state.pageInfo})})}}])}(o.Component),le=function(e){function t(e){return(0,s.default)(this,t),(0,a.default)(this,t,[e])}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){return(0,m.jsxs)(o.Fragment,{children:[(0,m.jsx)(N,{}),(0,m.jsx)("div",{className:"main-panel-center flex-row",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)(J,{currentItem:"desktop"}),(0,m.jsx)(oe,{devicesPlatform:"desktop"})]})})]})}}])}(o.Component),ce=function(e){function t(e){return(0,s.default)(this,t),(0,a.default)(this,t,[e])}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){return(0,m.jsxs)(o.Fragment,{children:[(0,m.jsx)(N,{}),(0,m.jsx)("div",{className:"main-panel-center flex-row",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)(J,{currentItem:"mobile"}),(0,m.jsx)(oe,{devicesPlatform:"mobile"})]})})]})}}])}(o.Component),de=function(e){function t(){return(0,s.default)(this,t),(0,a.default)(this,t,arguments)}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){return(0,m.jsx)(c.N_,{to:"".concat(h.Yc,"org/useradmin/info/").concat(encodeURIComponent(this.props.email),"/"),children:this.props.name})}}])}(o.Component),ue=de;A().extend(ne());var he=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).getPreviousPageDeviceErrorsList=function(){n.props.getDeviceErrorsListByPage(n.props.pageInfo.current_page-1)},n.getNextPageDeviceErrorsList=function(){n.props.getDeviceErrorsListByPage(n.props.pageInfo.current_page+1)},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg,s=e.items,r=e.pageInfo,a=e.curPerPage;if(t)return(0,m.jsx)(R.A,{});if(n)return(0,m.jsx)("p",{className:"error text-center",children:n});var i=(0,m.jsx)(se.A,{text:(0,h.AP)("No sync errors")}),l=(0,m.jsxs)(o.Fragment,{children:[(0,m.jsxs)("table",{className:"table-hover",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"16%",children:(0,h.AP)("User")}),(0,m.jsxs)("th",{width:"20%",children:[(0,h.AP)("Device")," / ",(0,h.AP)("Version")]}),(0,m.jsx)("th",{width:"16%",children:(0,h.AP)("IP")}),(0,m.jsx)("th",{width:"16%",children:(0,h.AP)("Library")}),(0,m.jsx)("th",{width:"16%",children:(0,h.AP)("Error")}),(0,m.jsx)("th",{width:"16%",children:(0,h.AP)("Time")})]})}),(0,m.jsx)("tbody",{children:s.map((function(e,t){return(0,m.jsx)(pe,{item:e},t)}))})]}),(0,m.jsx)(H.A,{gotoPreviousPage:this.getPreviousPageDeviceErrorsList,gotoNextPage:this.getNextPageDeviceErrorsList,currentPage:r.current_page,hasNextPage:r.has_next_page,curPerPage:a,resetPerPage:this.props.resetPerPage})]});return s.length?l:i}}])}(o.Component),pe=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).handleMouseOver=function(){n.setState({isOpIconShown:!0})},n.handleMouseOut=function(){n.setState({isOpIconShown:!1})},n.state={isOpIconShown:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props.item;return(0,m.jsxs)("tr",{onMouseEnter:this.handleMouseOver,onMouseLeave:this.handleMouseOut,children:[(0,m.jsx)("td",{children:(0,m.jsx)(ue,{email:e.email,name:e.name})}),(0,m.jsxs)("td",{children:[e.device_name," / ",e.client_version]}),(0,m.jsx)("td",{children:e.device_ip}),(0,m.jsx)("td",{children:(0,m.jsx)(c.N_,{to:"".concat(h.Yc,"sysadmin/#libs/").concat(e.repo_id),children:e.repo_name})}),(0,m.jsx)("td",{children:e.error_msg}),(0,m.jsx)("td",{children:(0,m.jsx)("span",{className:"item-meta-info",title:A()(e.last_accessed).format("dddd, MMMM D, YYYY h:mm:ss A"),children:A()(e.error_time).fromNow()})})]})}}])}(o.Component),ge=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).getDeviceErrorsListByPage=function(e){var t=n.state.perPage;U.k.orgAdminListDevicesErrors(h.Id,e,t).then((function(e){n.setState({loading:!1,devicesErrors:e.data.device_errors,pageInfo:e.data.page_info,isCleanBtnShown:e.data.device_errors.length>0})})).catch((function(e){n.setState({loading:!1,errorMsg:T.Aq.getErrorMsg(e,!0)})}))},n.clean=function(){U.k.orgAdminClearDeviceErrors(h.Id).then((function(e){n.setState({devicesErrors:[],isCleanBtnShown:!1});var t=(0,h.AP)("Successfully cleaned all errors.");F.A.success(t)})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){n.getDeviceErrorsListByPage(1)}))},n.state={loading:!0,errorMsg:"",devicesErrors:[],isCleanBtnShown:!1,pageInfo:{},perPage:100},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,s=n.currentPage,r=void 0===s?1:s,a=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||a),currentPage:parseInt(t.get("page")||r)},(function(){e.getDeviceErrorsListByPage(e.state.currentPage)}))}},{key:"render",value:function(){return(0,m.jsxs)(o.Fragment,{children:[this.state.isCleanBtnShown?(0,m.jsx)(N,{children:(0,m.jsx)(P.A,{className:"operation-item",onClick:this.clean,children:(0,h.AP)("Clean")})}):(0,m.jsx)(N,{}),(0,m.jsx)("div",{className:"main-panel-center flex-row",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)(J,{currentItem:"errors"}),(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsx)(he,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.devicesErrors,getDeviceErrorsListByPage:this.getDeviceErrorsListByPage,curPerPage:this.state.perPage,resetPerPage:this.resetPerPage,pageInfo:this.state.pageInfo})})]})})]})}}])}(o.Component),me=n(89379),fe=n(3898),xe=n(72714),ve=n(83970),je=n(15263),Ae=n(35077),Se=n(8123),ye=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).toggleBtns=function(){n.setState({isBtnsShown:!n.state.isBtnsShown})},n.hideBtns=function(e){n.state.isBtnsShown&&(n.props.value!=n.state.value&&n.setState({value:n.props.value}),n.toggleBtns())},n.onInputChange=function(e){n.setState({value:e.target.value})},n.onSubmit=function(e){var t=n.state.value.trim();t!=n.props.value&&n.props.saveSetting(n.props.keyText,t),n.toggleBtns()},n.state={isBtnsShown:!1,value:n.props.value},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.state,t=e.isBtnsShown,n=e.value,s=this.props,r=s.helpTip,a=s.displayName,i=s.inputType,l=s.disabled,c=s.inputAddon;return(0,m.jsx)(Se.A,{displayName:a,helpTip:r,mainContent:l?(0,m.jsx)(q.A,{type:i||"text",className:"textarea"==i?"web-setting-textarea":"",value:n,disabled:!0}):(0,m.jsxs)(Ae.A,{children:[(0,m.jsx)(q.A,{type:i||"text",className:"textarea"==i?"web-setting-textarea":"",onChange:this.onInputChange,onFocus:this.toggleBtns,onBlur:this.hideBtns,value:n}),c&&c]}),extraContent:t?(0,m.jsxs)(o.Fragment,{children:[(0,m.jsx)(P.A,{color:"primary",className:"sf2-icon-tick web-setting-icon-btn web-setting-icon-btn-submit",onMouseDown:this.onSubmit,title:(0,h.AP)("Submit")}),(0,m.jsx)(P.A,{className:"ml-1 sf2-icon-x2 web-setting-icon-btn web-setting-icon-btn-cancel",title:(0,h.AP)("Cancel")})]}):null})}}])}(o.Component),Ne=(n(37696),window.org.pageOptions),we=Ne.sysEnableUserCleanTrash,De=Ne.sysEnableEncryptedLibrary,be=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).updateName=function(e,t){U.k.orgAdminUpdateName(h.Id,t).then((function(e){n.setState({config_dict:e.data}),F.A.success((0,h.AP)("Name updated"))})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.updateLogo=function(e){U.k.orgAdminUpdateLogo(h.Id,e).then((function(e){n.setState({logoPath:e.data.logo_path}),F.A.success((0,h.AP)("Logo updated"))})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.orgSaveSetting=function(e,t){U.k.orgAdminSetSysSettingInfo(h.Id,e,t).then((function(e){F.A.success((0,h.AP)("Setting updated"))})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.orgUpdateUserDefaultQuota=function(e,t){U.k.orgAdminSetOrgUserDefaultQuota(h.Id,parseInt(t)).then((function(e){F.A.success((0,h.AP)("User default quota updated"))})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.state={loading:!0,errorMsg:"",config_dict:null,logoPath:h.VI,file_ext_white_list:"",force_adfs_login:!1,disable_org_encrypted_library:!1,disable_org_user_clean_trash:!1,user_default_quota:0},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){var e=this;U.k.orgAdminGetOrgInfo().then((function(t){var n,s=t.data.user_default_quota;if(-1==s||0==s||s<0)n=0;else{var r=parseInt(Math.floor(Math.log(s)/Math.log(1e3)),10);n=s/Math.pow(1e3,r)}e.setState({loading:!1,config_dict:t.data,file_ext_white_list:t.data.file_ext_white_list,force_adfs_login:t.data.force_adfs_login,disable_org_encrypted_library:t.data.disable_org_encrypted_library,disable_org_user_clean_trash:t.data.disable_org_user_clean_trash,user_default_quota:n})})).catch((function(t){e.setState({loading:!1,errorMsg:T.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this.state,t=e.loading,n=e.errorMsg,s=e.config_dict,r=e.file_ext_white_list,a=e.force_adfs_login,i=e.disable_org_encrypted_library,l=e.disable_org_user_clean_trash,c=e.user_default_quota,d=this.state.logoPath;return d=-1!=d.indexOf("image-view")?d:h.SG+d,(0,m.jsxs)(o.Fragment,{children:[(0,m.jsx)(N,(0,me.default)({},this.props)),(0,m.jsx)("div",{className:"main-panel-center flex-row",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)("div",{className:"cur-view-path",children:(0,m.jsx)("h3",{className:"sf-heading",children:(0,h.AP)("Settings")})}),(0,m.jsxs)("div",{className:"cur-view-content container mw-100",children:[t&&(0,m.jsx)(R.A,{}),n&&(0,m.jsx)("p",{className:"error text-center mt-4",children:n}),!t&&!n&&s&&(0,m.jsxs)(o.Fragment,{children:[(0,m.jsx)("p",{className:"small text-secondary my-4"}),(0,m.jsx)(xe.A,{headingText:(0,h.AP)("Info"),children:(0,m.jsxs)(o.Fragment,{children:[(0,m.jsx)(ye,{saveSetting:this.updateName,displayName:(0,h.AP)("Team name"),keyText:"orgName",value:s.org_name,helpTip:"",disabled:!h.$L}),h.XH&&(0,m.jsx)(je.A,{postFile:this.updateLogo,displayName:"Logo",keyText:"Logo",filePath:d,fileWidth:256,fileHeight:64,helpTip:"logo.png, 256px * 64px"})]})}),(0,m.jsx)(xe.A,{headingText:(0,h.AP)("File Upload"),children:(0,m.jsx)(o.Fragment,{children:(0,m.jsx)(ye,{saveSetting:this.orgSaveSetting,displayName:(0,h.AP)("File extension white list"),keyText:"file_ext_white_list",value:r,helpTip:(0,h.AP)('File extension white list for file upload via web UI and API. For example, "md;txt;docx". Empty means no limit.')})})}),h.bH&&(0,m.jsx)(xe.A,{headingText:(0,h.AP)("User"),children:(0,m.jsx)(ve.A,{saveSetting:this.orgSaveSetting,displayName:(0,h.AP)("Disable SAML user email / password login"),keyText:"force_adfs_login",value:a,helpTip:(0,h.AP)("Force user to use SSO login if SAML account is bound")})}),(we||De)&&(0,m.jsx)(xe.A,{headingText:(0,h.AP)("Library"),children:(0,m.jsxs)(o.Fragment,{children:[De&&(0,m.jsx)(ve.A,{saveSetting:this.orgSaveSetting,displayName:(0,h.AP)("Encrypted library"),keyText:"disable_org_encrypted_library",value:i,helpTip:(0,h.AP)("Not allow user to create encrypted libraries")}),we&&(0,m.jsx)(ve.A,{saveSetting:this.orgSaveSetting,displayName:(0,h.AP)("Disable user clean trash"),keyText:"disable_org_user_clean_trash",value:l,helpTip:(0,h.AP)("Not allow user to clean library trash")})]})}),(0,m.jsx)(xe.A,{headingText:(0,h.AP)("User"),children:(0,m.jsx)(o.Fragment,{children:(0,m.jsx)(ye,{className:"form-control",saveSetting:this.orgUpdateUserDefaultQuota,displayName:(0,h.AP)("User default quota"),value:c,helpTip:(0,h.AP)("Tip: 0 means default limit, the unit is MB"),inputAddon:(0,m.jsx)(fe.A,{children:"MB"})})})})]})]})]})})]})}}])}(o.Component),Pe=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).navItems=[{name:"all",urlPart:"useradmin",text:(0,h.AP)("All")},{name:"admins",urlPart:"useradmin/admins",text:(0,h.AP)("Admin")}],n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props.currentItem;return(0,m.jsx)("div",{className:"cur-view-path tab-nav-container",children:(0,m.jsx)("ul",{className:"nav",children:this.navItems.map((function(t,n){return(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsx)(c.N_,{to:"".concat(h.Yc,"org/").concat(t.urlPart,"/"),className:"nav-link".concat(e==t.name?" active":""),children:t.text})},n)}))})})}}])}(o.Component),ke=Pe,Ie=n(5495),_e=n(69123),Ce=n(65276),Me=n(34940),Oe=n(66149),Le=n(82487),Ue=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).onMouseEnter=function(){n.props.isItemFreezed||n.setState({showMenu:!0,highlight:!0})},n.onMouseLeave=function(){n.props.isItemFreezed||n.setState({showMenu:!1,highlight:!1})},n.toggleDelete=function(){var e=n.props.user.email,t=n.props.user.name;n.props.toggleDelete(e,t)},n.toggleResetPW=function(){var e=n.props.user.email;F.A.success((0,h.AP)("Resetting user's password, please wait for a moment.")),U.k.orgAdminResetOrgUserPassword(h.Id,e).then((function(e){F.A.success(e.data.reset_tip)})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.toggleRevokeAdmin=function(){var e=n.props.user.email;n.props.toggleRevokeAdmin(e)},n.changeStatus=function(e){var t="active"==e.value;t&&F.A.notify((0,h.AP)("It may take some time, please wait.")),n.props.changeStatus(n.props.user.email,t)},n.setUserInactive=function(){n.props.changeStatus(n.props.user.email,!1)},n.onDropdownToggleClick=function(e){n.toggleOperationMenu(e)},n.toggleOperationMenu=function(e){e.stopPropagation(),n.setState({isItemMenuShow:!n.state.isItemMenuShow},(function(){n.state.isItemMenuShow?n.props.onFreezedItem():(n.setState({highlight:!1,showMenu:!1}),n.props.onUnfreezedItem())}))},n.getQuotaTotal=function(e){switch(e){case-1:return(0,h.AP)("Failed");case-2:return"--";default:return T.Aq.formatSize({bytes:e})}},n.translateStatus=function(e){switch(e){case"active":return(0,h.AP)("Active");case"inactive":return(0,h.AP)("Inactive")}},n.toggleConfirmInactiveDialog=function(){n.setState({isConfirmInactiveDialogOpen:!n.state.isConfirmInactiveDialogOpen})},n.state={highlight:!1,showMenu:!1,isItemMenuShow:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this,t=this.state,n=t.highlight,s=t.isConfirmInactiveDialogOpen,r=this.props,a=r.user,i=r.currentTab,o=h.Yc+"org/useradmin/info/"+encodeURIComponent(a.email)+"/",l=a.email!==h.Xh&&this.state.showMenu,c=a.is_active?"active":"inactive";this.statusOptions=["active","inactive"].map((function(t){return{value:t,text:e.translateStatus(t),isSelected:t==c}}));var d=this.statusOptions.filter((function(e){return e.isSelected}))[0],u='<span class="op-target">'+T.Aq.HTMLescape(a.name)+"</span>",p=(0,h.AP)("Are you sure you want to set {user_placeholder} inactive?").replace("{user_placeholder}",u);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:o,children:a.name})}),(0,m.jsx)("td",{children:(0,m.jsx)(Oe.A,{isDropdownToggleShown:n,currentSelectedOption:d,options:this.statusOptions,selectOption:this.changeStatus,toggleItemFreezed:this.props.toggleItemFreezed,operationBeforeSelect:a.is_active?this.toggleConfirmInactiveDialog:void 0})}),(0,m.jsx)("td",{children:"".concat(T.Aq.formatSize({bytes:a.quota_usage})," / ").concat(this.getQuotaTotal(a.quota_total))}),(0,m.jsxs)("td",{children:[a.ctime," /",(0,m.jsx)("br",{}),a.last_login?a.last_login:"--"]}),(0,m.jsx)("td",{className:"text-center cursor-pointer",children:l&&(0,m.jsxs)(Ie.A,{isOpen:this.state.isItemMenuShow,toggle:this.toggleOperationMenu,children:[(0,m.jsx)(_e.A,{tag:"i",className:"op-icon sf3-font-more sf3-font",title:(0,h.AP)("More operations"),"aria-label":(0,h.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isItemMenuShow,onClick:this.onDropdownToggleClick}),(0,m.jsxs)(Ce.A,{children:[(0,m.jsx)(Me.A,{onClick:this.toggleDelete,children:(0,h.AP)("Delete")}),(0,m.jsx)(Me.A,{onClick:this.toggleResetPW,children:(0,h.AP)("ResetPwd")}),"admins"==i&&(0,m.jsx)(Me.A,{onClick:this.toggleRevokeAdmin,children:(0,h.AP)("Revoke Admin")})]})]})})]}),s&&(0,m.jsx)(Le.A,{title:(0,h.AP)("Set user inactive"),message:p,executeOperation:this.setUserInactive,confirmBtnText:(0,h.AP)("Set"),toggleDialog:this.toggleConfirmInactiveDialog})]})}}])}(o.Component),Re=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.toggleItemFreezed=function(e){n.setState({isItemFreezed:e})},n.onChangePageNum=function(e,t){e.preventDefault();var s=n.props.page;1==t?s+=1:s-=1,n.props.initOrgUsersData(s)},n.sortByQuotaUsage=function(e){e.preventDefault(),n.props.sortByQuotaUsage()},n.state={isItemFreezed:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e,t=this,n=this.props,s=n.sortBy,r=n.sortOrder;e=""==s?(0,m.jsx)("span",{className:"sf3-font sf3-font-sort3"}):(0,m.jsx)("span",{className:"sf3-font ".concat("asc"==r?"sf3-font-down rotate-180 d-inline-block":"sf3-font-down")});var a=this.props,i=a.orgUsers,o=a.page,l=a.pageNext;return(0,m.jsxs)("div",{className:"cur-view-content",children:[(0,m.jsxs)("table",{children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"30%",children:(0,h.AP)("Name")}),(0,m.jsx)("th",{width:"15%",children:(0,h.AP)("Status")}),(0,m.jsxs)("th",{width:"20%",children:[(0,m.jsxs)("a",{className:"d-inline-block table-sort-op",href:"#",onClick:this.sortByQuotaUsage,children:[(0,h.AP)("Space Used")," ",e]})," / ",(0,h.AP)("Quota")]}),(0,m.jsxs)("th",{width:"25%",children:[(0,h.AP)("Created At")," / ",(0,h.AP)("Last Login")]}),(0,m.jsx)("th",{width:"10%"})]})}),(0,m.jsx)("tbody",{children:i.map((function(e,n){return(0,m.jsx)(Ue,{user:e,currentTab:"users",isItemFreezed:t.state.isItemFreezed,toggleDelete:t.props.toggleDelete,changeStatus:t.props.changeStatus,onFreezedItem:t.onFreezedItem,onUnfreezedItem:t.onUnfreezedItem,toggleItemFreezed:t.toggleItemFreezed},n)}))})]}),(0,m.jsxs)("div",{className:"paginator",children:[1!=o&&(0,m.jsx)("a",{href:"#",onClick:function(e){return t.onChangePageNum(e,-1)},children:(0,h.AP)("Previous")}),1!=o&&l&&(0,m.jsx)("span",{children:" | "}),l&&(0,m.jsx)("a",{href:"#",onClick:function(e){return t.onChangePageNum(e,1)},children:(0,h.AP)("Next")})]})]})}}])}(o.Component),Te=n(40866),Fe=n(8081),Ee=n(10877),ze=n(46882),Ye=n(6754),qe=n(20338),Be=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).toggle=function(){n.props.toggle()},n.openFileInput=function(){n.fileInputRef.current.click()},n.uploadFile=function(e){if(n.fileInputRef.current.files.length){var t=n.fileInputRef.current.files[0].name;if("xlsx"==t.substr(t.lastIndexOf(".")+1)){var s=n.fileInputRef.current.files[0];n.props.importUsersInBatch(s),n.toggle()}else n.setState({errorMsg:(0,h.AP)("Please choose a .xlsx file.")})}},n.state={errorMsg:""},n.fileInputRef=o.createRef(),n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.state.errorMsg;return(0,m.jsxs)(Fe.A,{isOpen:!0,toggle:this.toggle,children:[(0,m.jsx)(qe.A,{toggle:this.toggle,children:(0,h.AP)("Import users from a .xlsx file")}),(0,m.jsxs)(Ee.A,{children:[(0,m.jsx)("p",{children:(0,m.jsx)("a",{className:"text-secondary small",href:"".concat(h.Yc,"useradmin/batchadduser/example/"),children:(0,h.AP)("Download an example file")})}),(0,m.jsx)("button",{className:"btn btn-outline-primary",onClick:this.openFileInput,children:(0,h.AP)("Upload file")}),(0,m.jsx)("input",{className:"d-none",type:"file",onChange:this.uploadFile,ref:this.fileInputRef}),e&&(0,m.jsx)(ze.A,{color:"danger",children:e})]}),(0,m.jsx)(Ye.A,{children:(0,m.jsx)(P.A,{color:"secondary",onClick:this.toggle,children:(0,h.AP)("Cancel")})})]})}}])}(o.Component),Ve=n(39708),Ge=n(79969),He=n(91646),Qe=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).handleSubmit=function(){if(n.validateInputParams()){var e=n.state,t=e.email,s=e.name,r=e.password;n.setState({isAddingUser:!0}),n.props.handleSubmit(t,s.trim(),r)}},n.togglePasswordVisible=function(){n.setState({isPasswordVisible:!n.state.isPasswordVisible},(function(){n.state.isPasswordVisible?(n.passwdInput.type="password",n.passwdNewInput.type="password"):(n.passwdInput.type="text",n.passwdNewInput.type="text")}))},n.generatePassword=function(){var e=T.Aq.generatePassword(8);n.setState({password:e,newPassword:e,isPasswordVisible:!1},(function(){n.passwdInput.type="text",n.passwdNewInput.type="text"}))},n.inputEmail=function(e){var t=e.target.value.trim();n.setState({email:t})},n.inputName=function(e){var t=e.target.value;n.setState({name:t})},n.inputPassword=function(e){var t=e.target.value.trim();n.setState({password:t},(function(){n.state.isPasswordVisible&&(n.passwdInput.type="password",n.passwdNewInput.type="password")}))},n.inputPasswordNew=function(e){var t=e.target.value.trim();n.setState({newPassword:t},(function(){n.state.isPasswordVisible&&(n.passwdInput.type="password",n.passwdNewInput.type="password")}))},n.toggle=function(){n.props.toggle()},n.state={isPasswordVisible:!0,email:"",name:"",password:"",newPassword:"",errMessage:"",isAddingUser:!1},n.passwdInput=o.createRef(),n.passwdNewInput=o.createRef(),n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"validateInputParams",value:function(){var e;if(!this.state.email.length)return e=(0,h.AP)("email is required"),this.setState({errMessage:e}),!1;if(!this.state.name.trim().length)return e=(0,h.AP)("Name is required"),this.setState({errMessage:e}),!1;var t=this.state.password,n=this.state.newPassword;return t.length?n.length?t===n||(e=(0,h.AP)("Passwords don't match"),this.setState({errMessage:e}),!1):(e=(0,h.AP)("Please enter the password again"),this.setState({errMessage:e}),!1):(e=(0,h.AP)("Please enter password"),this.setState({errMessage:e}),!1)}},{key:"render",value:function(){var e=this;return(0,m.jsxs)(Fe.A,{isOpen:!0,toggle:this.toggle,children:[(0,m.jsx)(qe.A,{toggle:this.toggle,children:(0,h.AP)("Add User")}),(0,m.jsxs)(Ee.A,{children:[(0,m.jsxs)(Ve.A,{children:[(0,m.jsxs)(Ge.A,{children:[(0,m.jsx)(He.A,{for:"userEmail",children:(0,h.AP)("Email")}),(0,m.jsx)(q.A,{id:"userEmail",value:this.state.email||"",onChange:this.inputEmail})]}),(0,m.jsxs)(Ge.A,{children:[(0,m.jsx)(He.A,{for:"userName",children:(0,h.AP)("Name")}),(0,m.jsx)(q.A,{id:"userName",value:this.state.name||"",onChange:this.inputName})]}),(0,m.jsxs)(Ge.A,{children:[(0,m.jsx)(He.A,{for:"userPwd",children:(0,h.AP)("Password")}),(0,m.jsxs)(Ae.A,{className:"passwd",children:[(0,m.jsx)(q.A,{id:"userPwd",innerRef:function(t){e.passwdInput=t},value:this.state.password||"",onChange:this.inputPassword}),(0,m.jsx)(P.A,{onClick:this.togglePasswordVisible,children:(0,m.jsx)("i",{className:"link-operation-icon sf3-font sf3-font-eye".concat(this.state.isPasswordVisible?"-slash":"")})}),(0,m.jsx)(P.A,{onClick:this.generatePassword,children:(0,m.jsx)("i",{className:"link-operation-icon sf3-font sf3-font-magic"})})]})]}),(0,m.jsxs)(Ge.A,{children:[(0,m.jsx)(He.A,{for:"userPwdNew",children:(0,h.AP)("Confirm Password")}),(0,m.jsx)(q.A,{id:"userPwdNew",innerRef:function(t){e.passwdNewInput=t},className:"passwd",value:this.state.newPassword||"",onChange:this.inputPasswordNew})]})]}),this.state.errMessage&&(0,m.jsx)(He.A,{className:"err-message",children:this.state.errMessage})]}),(0,m.jsx)(Ye.A,{children:(0,m.jsx)(P.A,{color:"primary",disabled:this.state.isAddingUser,onClick:this.handleSubmit,className:this.state.isAddingUser?"btn-loading":"",children:(0,h.AP)("Submit")})})]})}}])}(o.Component),We=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).handleSubmit=function(){if(n.validateInputParams()){var e=n.state.email;n.setState({isAddingUser:!0}),n.props.handleSubmit(e.trim())}},n.handleKeyPress=function(e){e.preventDefault(),"Enter"==e.key&&n.handleSubmit(e)},n.inputEmail=function(e){var t=e.target.value.trim();n.setState({email:t})},n.toggle=function(){n.props.toggle()},n.state={email:"",errMessage:"",isAddingUser:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"validateInputParams",value:function(){var e;return!!this.state.email.trim().length||(e=(0,h.AP)("email is required"),this.setState({errMessage:e}),!1)}},{key:"render",value:function(){return(0,m.jsxs)(Fe.A,{isOpen:!0,toggle:this.toggle,children:[(0,m.jsx)(qe.A,{toggle:this.toggle,children:(0,h.AP)("Invite users")}),(0,m.jsxs)(Ee.A,{children:[(0,m.jsx)("p",{children:(0,h.AP)("You can enter multiple emails. An invitation link will be sent to each of them.")}),(0,m.jsx)(Ve.A,{children:(0,m.jsxs)(Ge.A,{children:[(0,m.jsx)(He.A,{for:"emails",children:(0,h.AP)("Emails")}),(0,m.jsx)(q.A,{type:"text",id:"emails",placeholder:(0,h.AP)("Emails, separated by ','"),value:this.state.email||"",onChange:this.inputEmail})]})}),this.state.errMessage&&(0,m.jsx)(He.A,{className:"err-message",children:this.state.errMessage})]}),(0,m.jsx)(Ye.A,{children:(0,m.jsx)(P.A,{color:"primary",disabled:this.state.isAddingUser,onClick:this.handleSubmit,className:this.state.isAddingUser?"btn-loading":"",children:(0,h.AP)("Submit")})})]})}}])}(o.Component),Ke=n(25328),Xe=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).copyLink=function(){(0,Ke.A)(n.props.invitationLink),n.props.toggle();var e=(0,h.AP)("Internal link has been copied to clipboard");F.A.success(e,{duration:2})},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){return(0,m.jsxs)(Fe.A,{isOpen:!0,toggle:this.props.toggle,children:[(0,m.jsx)(qe.A,{toggle:this.props.toggle,children:"\u901a\u8fc7\u5fae\u4fe1\u9080\u8bf7\u7528\u6237"}),(0,m.jsxs)(Ee.A,{children:[(0,m.jsx)("p",{children:"\u8bf7\u5c06\u9080\u8bf7\u94fe\u63a5\u53d1\u9001\u7ed9\u5176\u4ed6\u4eba\uff0c\u8fd9\u6837\u4ed6\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7\u626b\u63cf\u94fe\u63a5\u91cc\u7684\u4e8c\u7ef4\u7801\u6765\u52a0\u5165\u7ec4\u7ec7\u3002"}),(0,m.jsx)("p",{children:this.props.invitationLink})]}),(0,m.jsx)(Ye.A,{children:(0,m.jsx)(P.A,{color:"primary",onClick:this.copyLink,children:(0,h.AP)("Copy")})})]})}}])}(o.Component);A().locale(h.vV),A().extend(ne());var $e=(0,r.default)((function e(t){(0,s.default)(this,e),this.id=t.id,this.name=t.name,this.email=t.email,this.contact_email=t.owner_contact_email,this.is_active=t.is_active,this.quota_usage=t.quota_usage,this.quota_total=t.quota_total,this.last_login=t.last_login?A()(t.last_login).fromNow():"--",this.ctime=A()(t.ctime).format("YYYY-MM-DD HH:mm:ss")})),Je=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).handleInputChange=function(e){n.setState({value:e.target.value})},n.handleKeyDown=function(e){"Enter"==e.key&&(e.preventDefault(),n.handleSubmit())},n.handleSubmit=function(){var e=n.state.value.trim();if(!e)return!1;n.props.submit(e)},n.state={value:""},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){return(0,m.jsxs)("div",{className:"input-icon",children:[(0,m.jsx)("i",{className:"d-flex input-icon-addon sf3-font sf3-font-search"}),(0,m.jsx)("input",{type:"text",className:"form-control search-input h-6 mr-1",style:{width:"15rem"},placeholder:this.props.placeholder,value:this.state.value,onChange:this.handleInputChange,onKeyDown:this.handleKeyDown,autoComplete:"off"})]})}}])}(o.Component),Ze=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).sortByQuotaUsage=function(){n.setState({sortBy:"quota_usage",sortOrder:"asc"==n.state.sortOrder?"desc":"asc",page:1},(function(){var e=new URL(location.href),t=new URLSearchParams(e.search),s=n.state,r=s.page,a=s.sortBy,i=s.sortOrder;t.set("page",r),t.set("order_by",a),t.set("direction",i),e.search=t.toString(),(0,c.oo)(e.toString()),n.initOrgUsersData(r)}))},n.toggleImportOrgUsersDialog=function(){n.setState({isImportOrgUsersDialogOpen:!n.state.isImportOrgUsersDialogOpen})},n.toggleAddOrgUser=function(){n.setState({isShowAddOrgUserDialog:!n.state.isShowAddOrgUserDialog})},n.toggleInviteUserDialog=function(){n.setState({isInviteUserDialogOpen:!n.state.isInviteUserDialogOpen})},n.toggleInviteUserViaWeiXinDialog=function(){n.setState({isInviteUserViaWeiXinDialogOpen:!n.state.isInviteUserViaWeiXinDialogOpen})},n.initOrgUsersData=function(e){var t=n.state,s=t.sortBy,r=t.sortOrder;U.k.orgAdminListOrgUsers(h.Id,"",e,s,r).then((function(e){var t=e.data.user_list.map((function(e){return new $e(e)}));n.setState({orgUsers:t,pageNext:e.data.page_next,page:e.data.page})})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.importOrgUsers=function(e){F.A.notify((0,h.AP)("It may take some time, please wait.")),U.k.orgAdminImportUsersViaFile(h.Id,e).then((function(e){if(e.data.success.length){var t=e.data.success.map((function(e){return void 0==e.institution&&(e.institution=""),new $e(e)}));n.setState({orgUsers:t.concat(n.state.orgUsers)})}e.data.failed.forEach((function(e){var t="".concat(e.email,": ").concat(e.error_msg);F.A.danger(t)}))})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.addOrgUser=function(e,t,s){U.k.orgAdminAddOrgUser(h.Id,e,t,s).then((function(t){var s=new $e(t.data);n.state.orgUsers.unshift(s),n.setState({orgUsers:n.state.orgUsers}),n.toggleAddOrgUser();var r=(0,h.AP)("successfully added user %s.");r=r.replace("%s",e),F.A.success(r)})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t),n.toggleAddOrgUser()}))},n.toggleOrgUsersDelete=function(e,t){U.k.orgAdminDeleteOrgUser(h.Id,e).then((function(s){var r=n.state.orgUsers.filter((function(t){return t.email!=e}));n.setState({orgUsers:r});var a=(0,h.AP)("Deleted user %s");a=a.replace("%s",t),F.A.success(a)})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.inviteOrgUser=function(e){U.k.orgAdminInviteOrgUsers(h.Id,e.split(",")).then((function(e){n.toggleInviteUserDialog();var t=e.data.success.map((function(e){return new $e(e)}));n.setState({orgUsers:t.concat(n.state.orgUsers)}),e.data.success.forEach((function(e){var t=(0,h.AP)("successfully sent email to %s.");t=t.replace("%s",e.email),F.A.success(t)})),e.data.failed.forEach((function(e){var t="".concat(e.email,": ").concat(e.error_msg);F.A.danger(t)}))})).catch((function(e){n.toggleInviteUserDialog();var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.changeStatus=function(e,t){U.k.orgAdminChangeOrgUserStatus(h.Id,e,t).then((function(t){var s=n.state.orgUsers.map((function(n){return n.email==e&&(n.is_active=t.data.is_active),n}));n.setState({orgUsers:s}),F.A.success((0,h.AP)("Edit succeeded."))})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.searchItems=function(e){(0,c.oo)("".concat(h.Yc,"org/useradmin/search-users/?query=").concat(encodeURIComponent(e)))},n.getSearch=function(){return(0,m.jsx)(Je,{placeholder:(0,h.AP)("Search users"),submit:n.searchItems})},n.state={orgUsers:[],page:1,pageNext:!1,sortBy:"",sortOrder:"asc",isShowAddOrgUserDialog:!1,isImportOrgUsersDialogOpen:!1,isInviteUserDialogOpen:!1,isInviteUserViaWeiXinDialogOpen:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,s=n.page,r=n.sortBy,a=n.sortOrder;this.setState({page:parseInt(t.get("page")||s),sortBy:t.get("order_by")||r,sortOrder:t.get("direction")||a},(function(){e.initOrgUsersData(e.state.page)}))}},{key:"render",value:function(){var e,t="btn btn-secondary operation-item";return e=(0,m.jsxs)(o.Fragment,{children:[(0,m.jsx)("button",{className:"btn btn-secondary operation-item",onClick:this.toggleImportOrgUsersDialog,children:(0,h.AP)("Import users")}),(0,m.jsxs)("button",{className:t,title:(0,h.AP)("Add user"),onClick:this.toggleAddOrgUser,children:[(0,m.jsx)("i",{className:"sf3-font sf3-font-enlarge text-secondary mr-1"}),(0,h.AP)("Add user")]}),h.LS&&(0,m.jsxs)("button",{className:t,title:(0,h.AP)("Invite users"),onClick:this.toggleInviteUserDialog,children:[(0,m.jsx)("i",{className:"sf3-font sf3-font-enlarge text-secondary mr-1"}),(0,h.AP)("Invite users")]}),h.mz&&(0,m.jsxs)("button",{className:t,title:"\u901a\u8fc7\u5fae\u4fe1\u9080\u8bf7\u7528\u6237",onClick:this.toggleInviteUserViaWeiXinDialog,children:[(0,m.jsx)("i",{className:"sf3-font sf3-font-enlarge text-secondary mr-1"}),"\u901a\u8fc7\u5fae\u4fe1\u9080\u8bf7\u7528\u6237"]}),this.state.isImportOrgUsersDialogOpen&&(0,m.jsx)(Te.A,{children:(0,m.jsx)(Be,{importUsersInBatch:this.importOrgUsers,toggle:this.toggleImportOrgUsersDialog})}),this.state.isShowAddOrgUserDialog&&(0,m.jsx)(Te.A,{children:(0,m.jsx)(Qe,{handleSubmit:this.addOrgUser,toggle:this.toggleAddOrgUser})}),this.state.isInviteUserDialogOpen&&(0,m.jsx)(Te.A,{children:(0,m.jsx)(We,{handleSubmit:this.inviteOrgUser,toggle:this.toggleInviteUserDialog})}),this.state.isInviteUserViaWeiXinDialogOpen&&(0,m.jsx)(Te.A,{children:(0,m.jsx)(Xe,{invitationLink:h.mz,toggle:this.toggleInviteUserViaWeiXinDialog})})]}),(0,m.jsxs)(o.Fragment,{children:[(0,m.jsx)(N,{children:e,search:this.getSearch()}),(0,m.jsx)("div",{className:"main-panel-center flex-row",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)(ke,{currentItem:"all"}),(0,m.jsx)(Re,{initOrgUsersData:this.initOrgUsersData,toggleDelete:this.toggleOrgUsersDelete,changeStatus:this.changeStatus,orgUsers:this.state.orgUsers,page:this.state.page,pageNext:this.state.pageNext,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortByQuotaUsage:this.sortByQuotaUsage})]})})]})}}])}(o.Component),et=n(46114),tt=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.state={isItemFreezed:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.orgUsers,s=t.changeStatus;return(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsxs)("table",{children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"30%",children:(0,h.AP)("Name")}),(0,m.jsx)("th",{width:"15%",children:(0,h.AP)("Status")}),(0,m.jsxs)("th",{width:"20%",children:[(0,m.jsx)("a",{className:"d-inline-block table-sort-op",href:"#",children:(0,h.AP)("Space Used")})," / ",(0,h.AP)("Quota")]}),(0,m.jsxs)("th",{width:"25%",children:[(0,h.AP)("Created At")," / ",(0,h.AP)("Last Login")]}),(0,m.jsx)("th",{width:"10%"})]})}),(0,m.jsx)("tbody",{children:n.map((function(t,n){return(0,m.jsx)(Ue,{user:t,currentTab:"users",isItemFreezed:e.state.isItemFreezed,toggleDelete:e.props.toggleDelete,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem,changeStatus:s},n)}))})]})})}}])}(o.Component),nt=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).getItems=function(){U.k.orgAdminSearchUser(h.Id,n.state.query.trim()).then((function(e){var t=e.data.user_list.map((function(e){return new $e(e)}));n.setState({orgUsers:t,loading:!1})})).catch((function(e){n.setState({loading:!1,errorMsg:T.Aq.getErrorMsg(e,!0)})}))},n.deleteUser=function(e,t){U.k.orgAdminDeleteOrgUser(h.Id,e).then((function(s){var r=n.state.orgUsers.filter((function(t){return t.email!=e}));n.setState({orgUsers:r});var a=(0,h.AP)("Deleted user %s");a=a.replace("%s",t),F.A.success(a)})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.handleInputChange=function(e){n.setState({query:e.target.value},n.checkSubmitBtnActive)},n.checkSubmitBtnActive=function(){var e=n.state.query;n.setState({isSubmitBtnActive:e.trim()})},n.handleKeyDown=function(e){13===e.keyCode&&(n.state.isSubmitBtnActive&&n.getItems())},n.changeStatus=function(e,t){U.k.orgAdminChangeOrgUserStatus(h.Id,e,t).then((function(t){var s=n.state.orgUsers.map((function(n){return n.email==e&&(n.is_active=t.data.is_active),n}));n.setState({orgUsers:s}),F.A.success((0,h.AP)("Edit succeeded."))})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.state={query:"",orgUsers:[],org_id:"",isSubmitBtnActive:!1,loading:!0,errorMsg:""},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(document.location).searchParams;this.setState({query:t.get("query")||""},(function(){e.getItems()}))}},{key:"render",value:function(){var e=this.state,t=e.query,n=e.isSubmitBtnActive;return(0,m.jsx)(o.Fragment,{children:(0,m.jsx)("div",{className:"main-panel-center flex-row",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)("div",{className:"cur-view-path",children:(0,m.jsx)("h3",{className:"sf-heading",children:(0,h.AP)("Users")})}),(0,m.jsxs)("div",{className:"cur-view-content",children:[(0,m.jsxs)("div",{className:"mt-4 mb-6",children:[(0,m.jsx)("h4",{className:"border-bottom font-weight-normal mb-2 pb-1",children:(0,h.AP)("Search Users")}),(0,m.jsxs)(Ve.A,{tag:"div",children:[(0,m.jsx)(Ge.A,{row:!0,children:(0,m.jsx)(et.A,{sm:5,children:(0,m.jsx)(q.A,{type:"text",name:"query",value:t,placeholder:(0,h.AP)("Search users"),onChange:this.handleInputChange,onKeyDown:this.handleKeyDown})})}),(0,m.jsx)(Ge.A,{row:!0,children:(0,m.jsx)(et.A,{sm:{size:5},children:(0,m.jsx)("button",{className:"btn btn-outline-primary",disabled:!n,onClick:this.getItems,children:(0,h.AP)("Submit")})})})]})]}),(0,m.jsxs)("div",{className:"mt-4 mb-6",children:[(0,m.jsx)("h4",{className:"border-bottom font-weight-normal mb-2 pb-1",children:(0,h.AP)("Result")}),(0,m.jsx)(tt,{toggleDelete:this.deleteUser,changeStatus:this.changeStatus,orgUsers:this.state.orgUsers})]})]})]})})})}}])}(o.Component),st=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.toggleItemFreezed=function(e){n.setState({isItemFreezed:e})},n.state={isItemFreezed:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){this.props.initOrgAdmin()}},{key:"render",value:function(){var e=this,t=this.props.orgAdminUsers;return(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsxs)("table",{children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"30%",children:(0,h.AP)("Name")}),(0,m.jsx)("th",{width:"15%",children:(0,h.AP)("Status")}),(0,m.jsxs)("th",{width:"20%",children:[(0,h.AP)("Space Used")," / ",(0,h.AP)("Quota")]}),(0,m.jsxs)("th",{width:"25%",children:[(0,h.AP)("Created At")," / ",(0,h.AP)("Last Login")]}),(0,m.jsx)("th",{width:"10%"})]})}),(0,m.jsx)("tbody",{children:t.map((function(t,n){return(0,m.jsx)(Ue,{user:t,currentTab:"admins",isItemFreezed:e.state.isItemFreezed,toggleDelete:e.props.toggleDelete,toggleRevokeAdmin:e.props.toggleRevokeAdmin,changeStatus:e.props.changeStatus,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem,toggleItemFreezed:e.toggleItemFreezed},n)}))})]})})}}])}(o.Component),rt=n(98361),at=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).handleSelectChange=function(e){n.setState({selectedUsers:e,errMessage:""}),n.options=[]},n.addOrgAdmin=function(){if(n.state.selectedUsers&&0!==n.state.selectedUsers.length){var e=n.state.selectedUsers[0].email;U.k.orgAdminSetOrgAdmin(h.Id,e,!0).then((function(e){var t=new $e(e.data);n.props.onAddedOrgAdmin(t)})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))}},n.toggle=function(){n.props.toggle()},n.state={selectedUsers:[],errMessage:""},n.options=[],n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){return(0,m.jsxs)(Fe.A,{isOpen:!0,toggle:this.toggle,children:[(0,m.jsx)(qe.A,{toggle:this.toggle,children:(0,h.AP)("Add Admin")}),(0,m.jsxs)(Ee.A,{children:[(0,m.jsx)(rt.A,{isMulti:!1,placeholder:(0,h.AP)("Select a user as admin"),onSelectChange:this.handleSelectChange,selectedUsers:this.state.selectedUsers}),this.state.errMessage&&(0,m.jsx)(ze.A,{color:"danger",className:"mt-2",children:this.state.errMessage})]}),(0,m.jsxs)(Ye.A,{children:[(0,m.jsx)(P.A,{color:"secondary",onClick:this.toggle,children:(0,h.AP)("Close")}),(0,m.jsx)(P.A,{color:"primary",onClick:this.addOrgAdmin,children:(0,h.AP)("Submit")})]})]})}}])}(o.Component),it=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).toggleAddOrgAdmin=function(){n.setState({isShowAddOrgAdminDialog:!n.state.isShowAddOrgAdminDialog})},n.initOrgAdmin=function(){U.k.orgAdminListOrgUsers(h.Id,!0).then((function(e){var t=e.data.user_list.map((function(e){return new $e(e)}));n.setState({orgAdminUsers:t})})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.toggleOrgAdminDelete=function(e,t){U.k.orgAdminDeleteOrgUser(h.Id,e).then((function(s){n.setState({orgAdminUsers:n.state.orgAdminUsers.filter((function(t){return t.email!=e}))});var r=(0,h.AP)("Deleted user %s");r=r.replace("%s",t),F.A.success(r)})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.toggleRevokeAdmin=function(e){U.k.orgAdminSetOrgAdmin(h.Id,e,!1).then((function(t){n.setState({orgAdminUsers:n.state.orgAdminUsers.filter((function(t){return t.email!=e}))});var s=(0,h.AP)("Successfully revoke the admin permission of %s");s=s.replace("%s",t.data.name),F.A.success(s)})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.onAddedOrgAdmin=function(e){n.state.orgAdminUsers.unshift(e),n.setState({orgAdminUsers:n.state.orgAdminUsers});var t=(0,h.AP)("Successfully set %s as admin.");t=t.replace("%s",e.name),F.A.success(t),n.toggleAddOrgAdmin()},n.changeStatus=function(e,t){U.k.orgAdminChangeOrgUserStatus(h.Id,e,t).then((function(t){var s=n.state.orgAdminUsers.map((function(n){return n.email==e&&(n.is_active=t.data.is_active),n}));n.setState({orgAdminUsers:s}),F.A.success((0,h.AP)("Edit succeeded."))})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.state={orgAdminUsers:[],isShowAddOrgAdminDialog:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e;return e=(0,m.jsxs)(o.Fragment,{children:[(0,m.jsxs)("button",{className:"btn btn-secondary operation-item",title:(0,h.AP)("Add admin"),onClick:this.toggleAddOrgAdmin,children:[(0,m.jsx)("i",{className:"sf3-font sf3-font-enlarge text-secondary mr-1"}),(0,h.AP)("Add admin")]}),this.state.isShowAddOrgAdminDialog&&(0,m.jsx)(Te.A,{children:(0,m.jsx)(at,{toggle:this.toggleAddOrgAdmin,onAddedOrgAdmin:this.onAddedOrgAdmin})})]}),(0,m.jsxs)(o.Fragment,{children:[(0,m.jsx)(N,{children:e}),(0,m.jsx)("div",{className:"main-panel-center flex-row",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)(ke,{currentItem:"admins"}),(0,m.jsx)(st,{currentTab:"admins",toggleDelete:this.toggleOrgAdminDelete,toggleRevokeAdmin:this.toggleRevokeAdmin,orgAdminUsers:this.state.orgAdminUsers,initOrgAdmin:this.initOrgAdmin,changeStatus:this.changeStatus})]})})]})}}])}(o.Component),ot=it,lt=function(e){function t(){return(0,s.default)(this,t),(0,a.default)(this,t,arguments)}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props,t=e.email,n=e.currentItem,s="".concat(h.Yc,"org/useradmin/info/").concat(encodeURIComponent(t),"/");return(0,m.jsx)("div",{className:"cur-view-path org-admin-user-nav",children:(0,m.jsxs)("ul",{className:"nav",children:[(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsx)(c.N_,{to:s,className:"nav-link".concat("profile"==n?" active":""),children:(0,h.AP)("Profile")})}),(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsx)(c.N_,{to:"".concat(s,"repos/"),className:"nav-link".concat("owned-repos"==n?" active":""),children:(0,h.AP)("Owned Libraries")})}),(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsx)(c.N_,{to:"".concat(s,"shared-repos/"),className:"nav-link".concat("shared-repos"==n?" active":""),children:(0,h.AP)("Shared Libraries")})})]})})}}])}(o.Component),ct=lt,dt=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).handleInputChange=function(e){n.setState({inputValue:e.target.value})},n.formSubmit=function(){var e=n.props,t=e.orgID,s=e.email,r=n.state.inputValue.trim();n.setState({submitBtnDisabled:!0}),U.k.orgAdminSetOrgUserName(t,s,r).then((function(e){var t=r?e.data.name:"";n.props.updateName(t),n.props.toggleDialog()})).catch((function(e){var t=T.Aq.getErrorMsg(e);n.setState({formErrorMsg:t,submitBtnDisabled:!1})}))},n.state={inputValue:n.props.name,submitBtnDisabled:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.state,t=e.inputValue,n=e.formErrorMsg,s=e.submitBtnDisabled;return(0,m.jsxs)(Fe.A,{isOpen:!0,centered:!0,toggle:this.props.toggleDialog,children:[(0,m.jsx)(qe.A,{toggle:this.props.toggleDialog,children:(0,h.AP)("Set user name")}),(0,m.jsx)(Ee.A,{children:(0,m.jsxs)(o.Fragment,{children:[(0,m.jsx)("input",{type:"text",className:"form-control",value:t,onChange:this.handleInputChange}),n&&(0,m.jsx)("p",{className:"error m-0 mt-2",children:n})]})}),(0,m.jsxs)(Ye.A,{children:[(0,m.jsx)("button",{className:"btn btn-secondary",onClick:this.props.toggleDialog,children:(0,h.AP)("Cancel")}),(0,m.jsx)("button",{className:"btn btn-primary",disabled:s,onClick:this.formSubmit,children:(0,h.AP)("Submit")})]})]})}}])}(o.Component),ut=dt,ht=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).handleInputChange=function(e){n.setState({inputValue:e.target.value})},n.formSubmit=function(){var e=n.props,t=e.orgID,s=e.email,r=n.state.inputValue.trim();n.setState({submitBtnDisabled:!0}),U.k.orgAdminSetOrgUserContactEmail(t,s,r).then((function(e){var t=r?e.data.contact_email:"";n.props.updateContactEmail(t),n.props.toggleDialog()})).catch((function(e){var t=T.Aq.getErrorMsg(e);n.setState({formErrorMsg:t,submitBtnDisabled:!1})}))},n.state={inputValue:n.props.contactEmail,submitBtnDisabled:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.state,t=e.inputValue,n=e.formErrorMsg,s=e.submitBtnDisabled;return(0,m.jsxs)(Fe.A,{isOpen:!0,centered:!0,toggle:this.props.toggleDialog,children:[(0,m.jsx)(qe.A,{toggle:this.props.toggleDialog,children:(0,h.AP)("Set user contact email")}),(0,m.jsx)(Ee.A,{children:(0,m.jsxs)(o.Fragment,{children:[(0,m.jsx)("input",{type:"text",className:"form-control",value:t,onChange:this.handleInputChange}),n&&(0,m.jsx)("p",{className:"error m-0 mt-2",children:n})]})}),(0,m.jsxs)(Ye.A,{children:[(0,m.jsx)("button",{className:"btn btn-secondary",onClick:this.props.toggleDialog,children:(0,h.AP)("Cancel")}),(0,m.jsx)("button",{className:"btn btn-primary",disabled:s,onClick:this.formSubmit,children:(0,h.AP)("Submit")})]})]})}}])}(o.Component),pt=ht,gt=function(e){function t(e){var n;(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).handleInputChange=function(e){n.setState({inputValue:e.target.value})},n.formSubmit=function(){var e=n.props,t=e.orgID,s=e.email,r=n.state.inputValue.trim();if(!r)return n.setState({formErrorMsg:(0,h.AP)("It is required.")}),!1;n.setState({submitBtnDisabled:!0}),U.k.orgAdminSetOrgUserQuota(t,s,r).then((function(e){n.props.updateQuota(e.data.quota_total),n.props.toggleDialog()})).catch((function(e){var t=T.Aq.getErrorMsg(e);n.setState({formErrorMsg:t,submitBtnDisabled:!1})}))};var r=n.props.quotaTotal<0?"":n.props.quotaTotal/1e6;return n.state={inputValue:r,submitBtnDisabled:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.state,t=e.inputValue,n=e.formErrorMsg,s=e.submitBtnDisabled;return(0,m.jsxs)(Fe.A,{isOpen:!0,centered:!0,toggle:this.props.toggleDialog,children:[(0,m.jsx)(qe.A,{toggle:this.props.toggleDialog,children:(0,h.AP)("Set user quota")}),(0,m.jsx)(Ee.A,{children:(0,m.jsxs)(o.Fragment,{children:[(0,m.jsxs)(Ae.A,{children:[(0,m.jsx)("input",{type:"text",className:"form-control",value:t,onChange:this.handleInputChange}),(0,m.jsx)(fe.A,{children:"MB"})]}),(0,m.jsx)("p",{className:"small text-secondary mt-2 mb-2",children:(0,h.AP)("Tip: 0 means default limit")}),n&&(0,m.jsx)("p",{className:"error m-0 mt-2",children:n})]})}),(0,m.jsxs)(Ye.A,{children:[(0,m.jsx)("button",{className:"btn btn-secondary",onClick:this.props.toggleDialog,children:(0,h.AP)("Cancel")}),(0,m.jsx)("button",{className:"btn btn-primary",disabled:s,onClick:this.formSubmit,children:(0,h.AP)("Submit")})]})]})}}])}(o.Component),mt=gt,ft=n(60096),xt=window.org.pageOptions,vt=xt.orgID,jt=xt.orgName,At=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).updateName=function(e){n.setState({name:e})},n.updateContactEmail=function(e){n.setState({contact_email:e})},n.updateQuota=function(e){n.setState({quota_total:e})},n.state={loading:!0,errorMsg:""},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=decodeURIComponent(this.props.email);U.k.orgAdminGetOrgUserInfo(vt,t).then((function(t){e.setState(Object.assign({loading:!1},t.data))})).catch((function(t){e.setState({loading:!1,errorMsg:T.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,m.jsxs)(o.Fragment,{children:[(0,m.jsx)(N,{}),(0,m.jsx)("div",{className:"main-panel-center flex-row",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)(ct,{email:this.props.email,currentItem:"profile"}),(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsx)(St,{data:this.state,updateName:this.updateName,updateContactEmail:this.updateContactEmail,updateQuota:this.updateQuota})})]})})]})}}])}(o.Component),St=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).toggleSetNameDialog=function(){n.setState({isSetNameDialogOpen:!n.state.isSetNameDialogOpen})},n.toggleSetContactEmailDialog=function(){n.setState({isSetContactEmailDialogOpen:!n.state.isSetContactEmailDialogOpen})},n.toggleSetQuotaDialog=function(){n.setState({isSetQuotaDialogOpen:!n.state.isSetQuotaDialogOpen})},n.state={isSetNameDialogOpen:!1,isSetContactEmailDialogOpen:!1,isSetQuotaDialogOpen:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props.data,t=e.loading,n=e.errorMsg,s=e.avatar_url,r=e.email,a=e.contact_email,i=e.name,l=e.quota_total,c=e.quota_usage,d=this.state,u=d.isSetNameDialogOpen,p=d.isSetContactEmailDialogOpen,g=d.isSetQuotaDialogOpen;return t?(0,m.jsx)(R.A,{}):n?(0,m.jsx)("p",{className:"error text-center",children:n}):(0,m.jsxs)(o.Fragment,{children:[(0,m.jsxs)("dl",{children:[(0,m.jsx)("dt",{children:(0,h.AP)("Avatar")}),(0,m.jsx)("dd",{children:(0,m.jsx)("img",{src:s,width:"48",height:"48",className:"rounded",alt:""})}),(0,m.jsx)("dt",{children:"ID"}),(0,m.jsx)("dd",{children:r}),(0,m.jsx)("dt",{children:(0,h.AP)("Name")}),(0,m.jsxs)("dd",{children:[i||"--",(0,m.jsx)(ft.A,{onClick:this.toggleSetNameDialog})]}),(0,m.jsx)("dt",{children:(0,h.AP)("Contact Email")}),(0,m.jsxs)("dd",{children:[a||"--",(0,m.jsx)(ft.A,{onClick:this.toggleSetContactEmailDialog})]}),(0,m.jsx)("dt",{children:(0,h.AP)("Organization")}),(0,m.jsx)("dd",{children:jt}),(0,m.jsx)("dt",{children:(0,h.AP)("Space Used / Quota")}),(0,m.jsxs)("dd",{children:["".concat(T.Aq.bytesToSize(c)).concat(l>0?" / "+T.Aq.bytesToSize(l):""),(0,m.jsx)(ft.A,{onClick:this.toggleSetQuotaDialog})]})]}),u&&(0,m.jsx)(ut,{orgID:vt,email:r,name:i,updateName:this.props.updateName,toggleDialog:this.toggleSetNameDialog}),p&&(0,m.jsx)(pt,{orgID:vt,email:r,contactEmail:a,updateContactEmail:this.props.updateContactEmail,toggleDialog:this.toggleSetContactEmailDialog}),g&&(0,m.jsx)(mt,{orgID:vt,email:r,quotaTotal:l,updateQuota:this.props.updateQuota,toggleDialog:this.toggleSetQuotaDialog})]})}}])}(o.Component),yt=At,Nt=n(73606),wt=window.org.pageOptions.orgID,Dt=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).state={loading:!0,errorMsg:""},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=decodeURIComponent(this.props.email);U.k.orgAdminGetOrgUserOwnedRepos(wt,t).then((function(t){e.setState(Object.assign({loading:!1},t.data))})).catch((function(t){e.setState({loading:!1,errorMsg:T.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,m.jsxs)(o.Fragment,{children:[(0,m.jsx)(N,{}),(0,m.jsx)("div",{className:"main-panel-center flex-row",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)(ct,{email:this.props.email,currentItem:"owned-repos"}),(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsx)(bt,{data:this.state})})]})})]})}}])}(o.Component),bt=function(e){function t(){return(0,s.default)(this,t),(0,a.default)(this,t,arguments)}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props.data,t=e.loading,n=e.errorMsg,s=e.repo_list;return t?(0,m.jsx)(R.A,{}):n?(0,m.jsx)("p",{className:"error text-center",children:n}):(0,m.jsx)(o.Fragment,{children:(0,m.jsxs)("table",{className:"table-hover",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"4%"}),(0,m.jsx)("th",{width:"35%",children:(0,h.AP)("Name")}),(0,m.jsx)("th",{width:"16%",children:(0,h.AP)("Size")}),(0,m.jsx)("th",{width:"25%",children:(0,h.AP)("Last Update")}),(0,m.jsx)("th",{width:"20%"})]})}),(0,m.jsx)("tbody",{children:s.map((function(e,t){return(0,m.jsx)(Pt,{data:e},t)}))})]})})}}])}(o.Component),Pt=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).handleMouseOver=function(){n.setState({isHighlighted:!0,isOpIconShown:!0})},n.handleMouseOut=function(){n.setState({isHighlighted:!1,isOpIconShown:!1})},n.handleDeleteIconClick=function(){n.toggleDeleteRepoDialog()},n.toggleDeleteRepoDialog=function(){n.setState({isDeleteRepoDialogOpen:!n.state.isDeleteRepoDialogOpen})},n.deleteRepo=function(){var e=n.props.data;U.k.orgAdminDeleteOrgRepo(wt,e.repo_id).then((function(t){n.setState({deleted:!0,isRepoDeleted:!0});var s=(0,h.AP)("Successfully deleted {name}.").replace("{name}",e.repo_name);F.A.success(s)})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t),n.setState({isRepoDeleted:!1})}))},n.state={isHighlighted:!1,isOpIconShown:!1,deleted:!1,isDeleteRepoDialogOpen:!1,isRepoDeleted:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.state,t=e.deleted,n=e.isOpIconShown,s=e.isDeleteRepoDialogOpen,r=e.isHighlighted,a=this.props.data;return t?null:(0,m.jsxs)(o.Fragment,{children:[(0,m.jsxs)("tr",{className:ee()({"tr-highlight":r}),onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,children:[(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:T.Aq.getLibIconUrl(a),alt:T.Aq.getLibIconTitle(a),title:T.Aq.getLibIconTitle(a),width:"24"})}),(0,m.jsx)("td",{children:a.repo_name}),(0,m.jsx)("td",{children:T.Aq.bytesToSize(a.size)}),(0,m.jsx)("td",{title:A()(a.last_modified).format("dddd, MMMM D, YYYY h:mm:ss A"),children:A()(a.last_modified).format("YYYY-MM-DD")}),(0,m.jsx)("td",{children:(0,m.jsx)("i",{role:"button",className:"op-icon sf3-font-delete1 sf3-font".concat(n?"":" invisible"),title:(0,h.AP)("Delete"),onClick:this.handleDeleteIconClick})})]}),s&&(0,m.jsx)(Nt.A,{repo:a,isRepoDeleted:this.state.isRepoDeleted,onDeleteRepo:this.deleteRepo,toggle:this.toggleDeleteRepoDialog,isGetShare:!1})]})}}])}(o.Component),kt=Dt,It=window.org.pageOptions.orgID,_t=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).state={loading:!0,errorMsg:""},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=decodeURIComponent(this.props.email);U.k.orgAdminGetOrgUserBesharedRepos(It,t).then((function(t){e.setState(Object.assign({loading:!1},t.data))})).catch((function(t){e.setState({loading:!1,errorMsg:T.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,m.jsxs)(o.Fragment,{children:[(0,m.jsx)(N,{}),(0,m.jsx)("div",{className:"main-panel-center flex-row",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)(ct,{email:this.props.email,currentItem:"shared-repos"}),(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsx)(Ct,{data:this.state})})]})})]})}}])}(o.Component),Ct=function(e){function t(){return(0,s.default)(this,t),(0,a.default)(this,t,arguments)}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props.data,t=e.loading,n=e.errorMsg,s=e.repo_list;return t?(0,m.jsx)(R.A,{}):n?(0,m.jsx)("p",{className:"error text-center",children:n}):(0,m.jsxs)("table",{className:"table-hover",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"4%"}),(0,m.jsx)("th",{width:"30%",children:(0,h.AP)("Name")}),(0,m.jsx)("th",{width:"26%",children:(0,h.AP)("Owner")}),(0,m.jsx)("th",{width:"15%",children:(0,h.AP)("Size")}),(0,m.jsx)("th",{width:"25%",children:(0,h.AP)("Last Update")})]})}),(0,m.jsx)("tbody",{children:s.map((function(e,t){return(0,m.jsx)(Mt,{data:e},t)}))})]})}}])}(o.Component),Mt=function(e){function t(){return(0,s.default)(this,t),(0,a.default)(this,t,arguments)}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props.data;return(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:T.Aq.getLibIconUrl(e),alt:T.Aq.getLibIconTitle(e),title:T.Aq.getLibIconTitle(e),width:"24"})}),(0,m.jsx)("td",{children:e.repo_name}),(0,m.jsx)("td",{children:e.owner_name}),(0,m.jsx)("td",{children:T.Aq.bytesToSize(e.size)}),(0,m.jsx)("td",{title:A()(e.last_modified).format("dddd, MMMM D, YYYY h:mm:ss A"),children:A()(e.last_modified).format("YYYY-MM-DD")})]})}}])}(o.Component),Ot=_t;A().locale(h.vV);var Lt=(0,r.default)((function e(t){(0,s.default)(this,e),this.id=t.id,this.groupName=t.group_name,this.creatorName=t.creator_name,this.creatorEmail=t.creator_email,this.creatorContactEmail=t.creator_contact_email,this.ctime=A()(t.ctime).format("YYYY-MM-DD HH:mm:ss")})),Ut=n(52622),Rt=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).handleInputChange=function(e){n.setState({value:e.target.value})},n.handleKeyDown=function(e){"Enter"==e.key&&(e.preventDefault(),n.handleSubmit())},n.handleSubmit=function(){var e=n.state.value.trim();if(!e)return!1;n.props.submit(e)},n.state={value:""},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){return(0,m.jsxs)("div",{className:"input-icon",children:[(0,m.jsx)("i",{className:"d-flex input-icon-addon sf3-font sf3-font-search"}),(0,m.jsx)("input",{type:"text",className:"form-control search-input h-6 mr-1",style:{width:"15rem"},placeholder:this.props.placeholder,value:this.state.value,onChange:this.handleInputChange,onKeyDown:this.handleKeyDown,autoComplete:"off"})]})}}])}(o.Component),Tt=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).initData=function(e){U.k.orgAdminListOrgGroups(h.Id,e).then((function(e){var t=e.data.groups.map((function(e){return new Lt(e)}));n.setState({orgGroups:t,pageNext:e.data.page_next,page:e.data.page})})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.onChangePageNum=function(e,t){e.preventDefault();var s=n.state.page;1==t?s+=1:s-=1,n.initData(s)},n.onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.deleteGroupItem=function(e){U.k.orgAdminDeleteOrgGroup(h.Id,e.id).then((function(t){n.setState({orgGroups:n.state.orgGroups.filter((function(t){return t.id!=e.id}))});var s=(0,h.AP)("Successfully deleted {name}");s=s.replace("{name}",e.groupName),F.A.success(s)})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.changeGroupItem=function(e){U.k.orgAdminGroup2Department(h.Id,e.id).then((function(t){var s=n.state.orgGroups.map((function(n){return n.id==e.id&&(n=new Lt(t.data)),n}));n.setState({orgGroups:s}),F.A.success((0,h.AP)("Successfully change the group"))})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.searchItems=function(e){(0,c.oo)("".concat(h.Yc,"org/groupadmin/search-groups/?query=").concat(encodeURIComponent(e)))},n.getSearch=function(){return(0,m.jsx)(Rt,{placeholder:(0,h.AP)("Search groups by name"),submit:n.searchItems})},n.state={page:1,pageNext:!1,orgGroups:[],isItemFreezed:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){var e=this.state.page;this.initData(e)}},{key:"render",value:function(){var e=this,t=this.state.orgGroups;return(0,m.jsxs)(o.Fragment,{children:[(0,m.jsx)(N,{search:this.getSearch()}),(0,m.jsx)("div",{className:"main-panel-center flex-row",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)("div",{className:"cur-view-path",children:(0,m.jsx)("h3",{className:"sf-heading",children:(0,h.AP)("All Groups")})}),(0,m.jsxs)("div",{className:"cur-view-content",children:[(0,m.jsxs)("table",{children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"30%",children:(0,h.AP)("Name")}),(0,m.jsx)("th",{width:"35%",children:(0,h.AP)("Creator")}),(0,m.jsx)("th",{width:"23%",children:(0,h.AP)("Created At")}),(0,m.jsx)("th",{width:"12%"})]})}),(0,m.jsx)("tbody",{children:t.map((function(t){return(0,m.jsx)(Ft,{group:t,isItemFreezed:e.state.isItemFreezed,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem,deleteGroupItem:e.deleteGroupItem,changeGroupItem:e.changeGroupItem},t.id)}))})]}),(0,m.jsxs)("div",{className:"paginator",children:[1!=this.state.page&&(0,m.jsx)("a",{href:"#",onClick:function(t){return e.onChangePageNum(t,-1)},children:(0,h.AP)("Previous")}),1!=this.state.page&&this.state.pageNext&&(0,m.jsx)("span",{children:" | "}),this.state.pageNext&&(0,m.jsx)("a",{href:"#",onClick:function(t){return e.onChangePageNum(t,1)},children:(0,h.AP)("Next")})]})]})]})})]})}}])}(o.Component),Ft=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).onMouseEnter=function(){n.props.isItemFreezed||n.setState({showMenu:!0,highlight:!0})},n.onMouseLeave=function(){n.props.isItemFreezed||n.setState({showMenu:!1,highlight:!1})},n.onDropdownToggleClick=function(e){n.toggleOperationMenu(e)},n.toggleOperationMenu=function(e){e.stopPropagation(),n.setState({isItemMenuShow:!n.state.isItemMenuShow},(function(){n.state.isItemMenuShow?n.props.onFreezedItem():(n.setState({highlight:!1,showMenu:!1}),n.props.onUnfreezedItem())}))},n.toggleDelete=function(){n.props.deleteGroupItem(n.props.group)},n.toggleChange=function(){n.props.changeGroupItem(n.props.group)},n.toggleChangeDialog=function(e){e&&e.preventDefault(),n.setState({isChangeDialogOpen:!n.state.isChangeDialogOpen})},n.renderGroupHref=function(e){return h.Yc+"org/groupadmin/"+e.id+"/"},n.renderGroupCreator=function(e){var t=h.Yc+"org/useradmin/info/"+e.creatorEmail+"/";return"system admin"==e.creatorName?(0,m.jsx)("td",{children:" -- "}):(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:t,className:"font-weight-normal",children:e.creatorName})})},n.state={highlight:!1,showMenu:!1,isItemMenuShow:!1,isChangeDialogOpen:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props.group,t="system admin"!=e.creatorName&&this.state.showMenu;return(0,m.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:this.renderGroupHref(e),className:"font-weight-normal",children:e.groupName})}),this.renderGroupCreator(e),(0,m.jsx)("td",{children:e.ctime}),(0,m.jsxs)("td",{className:"text-center cursor-pointer",children:[t&&(0,m.jsxs)(Ie.A,{isOpen:this.state.isItemMenuShow,toggle:this.toggleOperationMenu,children:[(0,m.jsx)(_e.A,{tag:"i",className:"op-icon sf3-font-more sf3-font",title:(0,h.AP)("More operations"),"aria-label":(0,h.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isItemMenuShow,onClick:this.onDropdownToggleClick}),(0,m.jsxs)(Ce.A,{children:[(0,m.jsx)(Me.A,{onClick:this.toggleDelete,children:(0,h.AP)("Delete")}),(0,m.jsx)(Me.A,{onClick:this.toggleChangeDialog,children:(0,h.AP)("Change to department")})]})]}),this.state.isChangeDialogOpen&&(0,m.jsx)(Ut.A,{groupName:e.groupName,changeGroup2Department:this.toggleChange,toggleDialog:this.toggleChangeDialog})]})]})}}])}(o.Component),Et=Tt,zt=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).onMouseEnter=function(){n.props.isItemFreezed||n.setState({showMenu:!0,highlight:!0})},n.onMouseLeave=function(){n.props.isItemFreezed||n.setState({showMenu:!1,highlight:!1})},n.onDropdownToggleClick=function(e){n.toggleOperationMenu(e)},n.toggleOperationMenu=function(e){e.stopPropagation(),n.setState({isItemMenuShow:!n.state.isItemMenuShow},(function(){n.state.isItemMenuShow?n.props.onFreezedItem():(n.setState({highlight:!1,showMenu:!1}),n.props.onUnfreezedItem())}))},n.toggleDelete=function(){n.props.deleteGroupItem(n.props.group)},n.renderGroupHref=function(e){return"system admin"==e.creatorName?h.Yc+"org/departmentadmin/groups/"+e.id+"/":h.Yc+"org/groupadmin/"+e.id+"/"},n.renderGroupCreator=function(e){var t=h.Yc+"org/useradmin/info/"+e.creatorEmail+"/";return"system admin"==e.creatorName?(0,m.jsx)("td",{children:" -- "}):(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:t,className:"font-weight-normal",children:e.creatorName})})},n.state={highlight:!1,showMenu:!1,isItemMenuShow:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props.group,t="system admin"!=e.creatorName&&this.state.showMenu;return(0,m.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:this.renderGroupHref(e),className:"font-weight-normal",children:e.groupName})}),this.renderGroupCreator(e),(0,m.jsx)("td",{children:e.ctime}),(0,m.jsx)("td",{className:"text-center cursor-pointer",children:t&&(0,m.jsxs)(Ie.A,{isOpen:this.state.isItemMenuShow,toggle:this.toggleOperationMenu,children:[(0,m.jsx)(_e.A,{tag:"i",className:"op-icon sf3-font-more sf3-font",title:(0,h.AP)("More operations"),"aria-label":(0,h.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isItemMenuShow,onClick:this.onDropdownToggleClick}),(0,m.jsx)(Ce.A,{children:(0,m.jsx)(Me.A,{onClick:this.toggleDelete,children:(0,h.AP)("Delete")})})]})})]})}}])}(o.Component),Yt=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.state={isItemFreezed:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this,t=this.props.orgGroups;return(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsxs)("table",{children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"30%",children:(0,h.AP)("Name")}),(0,m.jsx)("th",{width:"35%",children:(0,h.AP)("Creator")}),(0,m.jsx)("th",{width:"23%",children:(0,h.AP)("Created At")}),(0,m.jsx)("th",{width:"12%"})]})}),(0,m.jsx)("tbody",{children:t.map((function(t){return(0,m.jsx)(zt,{group:t,isItemFreezed:e.state.isItemFreezed,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem,deleteGroupItem:e.props.toggleDelete},t.id)}))})]})})}}])}(o.Component),qt=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).getItems=function(){U.k.orgAdminSearchGroup(h.Id,n.state.query.trim()).then((function(e){var t=e.data.group_list.map((function(e){return new Lt(e)}));n.setState({orgGroups:t,loading:!1})})).catch((function(e){n.setState({loading:!1,errorMsg:T.Aq.getErrorMsg(e,!0)})}))},n.deleteGroupItem=function(e){U.k.orgAdminDeleteOrgGroup(h.Id,e.id).then((function(t){n.setState({orgGroups:n.state.orgGroups.filter((function(t){return t.id!=e.id}))});var s=(0,h.AP)("Successfully deleted {name}");s=s.replace("{name}",e.groupName),F.A.success(s)})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.handleInputChange=function(e){n.setState({query:e.target.value},n.checkSubmitBtnActive)},n.checkSubmitBtnActive=function(){var e=n.state.query;n.setState({isSubmitBtnActive:e.trim()})},n.handleKeyDown=function(e){13===e.keyCode&&(n.state.isSubmitBtnActive&&n.getItems())},n.state={query:"",orgGroups:[],isSubmitBtnActive:!1,loading:!0,errorMsg:""},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(document.location).searchParams;this.setState({query:t.get("query")||""},(function(){e.getItems()}))}},{key:"render",value:function(){var e=this.state,t=e.query,n=e.isSubmitBtnActive;return(0,m.jsx)(o.Fragment,{children:(0,m.jsx)("div",{className:"main-panel-center flex-row",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)("div",{className:"cur-view-path",children:(0,m.jsx)("h3",{className:"sf-heading",children:(0,h.AP)("Groups")})}),(0,m.jsxs)("div",{className:"cur-view-content",children:[(0,m.jsxs)("div",{className:"mt-4 mb-6",children:[(0,m.jsx)("h4",{className:"border-bottom font-weight-normal mb-2 pb-1",children:(0,h.AP)("Search Groups")}),(0,m.jsxs)(Ve.A,{tag:"div",children:[(0,m.jsx)(Ge.A,{row:!0,children:(0,m.jsx)(et.A,{sm:5,children:(0,m.jsx)(q.A,{type:"text",name:"query",value:t,placeholder:(0,h.AP)("Search groups"),onChange:this.handleInputChange,onKeyDown:this.handleKeyDown})})}),(0,m.jsx)(Ge.A,{row:!0,children:(0,m.jsx)(et.A,{sm:{size:5},children:(0,m.jsx)("button",{className:"btn btn-outline-primary",disabled:!n,onClick:this.getItems,children:(0,h.AP)("Submit")})})})]})]}),(0,m.jsxs)("div",{className:"mt-4 mb-6",children:[(0,m.jsx)("h4",{className:"border-bottom font-weight-normal mb-2 pb-1",children:(0,h.AP)("Result")}),(0,m.jsx)(Yt,{toggleDelete:this.deleteGroupItem,orgGroups:this.state.orgGroups})]})]})]})})})}}])}(o.Component),Bt=function(e){function t(){return(0,s.default)(this,t),(0,a.default)(this,t,arguments)}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props,t=e.groupID,n=e.currentItem,s="".concat(h.Yc,"org/groupadmin/").concat(t,"/");return(0,m.jsx)("div",{className:"cur-view-path org-admin-user-nav",children:(0,m.jsxs)("ul",{className:"nav",children:[(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsx)(c.N_,{to:s,className:"nav-link".concat("info"==n?" active":""),children:(0,h.AP)("Group info")})}),(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsx)(c.N_,{to:"".concat(s,"repos/"),className:"nav-link".concat("repos"==n?" active":""),children:(0,h.AP)("Libraries")})}),(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsx)(c.N_,{to:"".concat(s,"members/"),className:"nav-link".concat("members"==n?" active":""),children:(0,h.AP)("Members")})})]})})}}])}(o.Component),Vt=Bt,Gt=window.org.pageOptions.orgID,Ht=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).state={loading:!0,errorMsg:""},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){var e=this;U.k.orgAdminGetGroup(Gt,this.props.groupID).then((function(t){e.setState(Object.assign({loading:!1},t.data))})).catch((function(t){e.setState({loading:!1,errorMsg:T.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,m.jsxs)(o.Fragment,{children:[(0,m.jsx)(N,{}),(0,m.jsx)("div",{className:"main-panel-center flex-row",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)(Vt,{groupID:this.props.groupID,currentItem:"info"}),(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsx)(Qt,{data:this.state})})]})})]})}}])}(o.Component),Qt=function(e){function t(){return(0,s.default)(this,t),(0,a.default)(this,t,arguments)}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props.data,t=e.loading,n=e.errorMsg,s=e.group_name,r=e.creator_email,a=e.creator_name;return t?(0,m.jsx)(R.A,{}):n?(0,m.jsxs)("div",{className:"w-100 h-100 d-flex flex-column align-items-center justify-content-center text-center",children:[(0,m.jsx)("img",{src:"".concat(h.SG,"img/error-tip.png"),alt:"",width:"100"}),(0,m.jsx)("p",{className:"mt-2",children:n})]}):(0,m.jsxs)("dl",{className:"mt-0",children:[(0,m.jsx)("dt",{children:(0,h.AP)("Name")}),(0,m.jsx)("dd",{children:s}),(0,m.jsx)("dt",{children:(0,h.AP)("Creator")}),(0,m.jsx)("dd",{children:(0,m.jsx)(c.N_,{to:"".concat(h.Yc,"org/useradmin/info/").concat(encodeURIComponent(r),"/"),children:a})})]})}}])}(o.Component),Wt=Ht,Kt=window.org.pageOptions.orgID,Xt=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).state={loading:!0,errorMsg:""},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){var e=this;U.k.orgAdminListGroupRepos(Kt,this.props.groupID).then((function(t){e.setState(Object.assign({loading:!1},t.data))})).catch((function(t){e.setState({loading:!1,errorMsg:T.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,m.jsxs)(o.Fragment,{children:[(0,m.jsx)(N,{}),(0,m.jsx)("div",{className:"main-panel-center flex-row",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)(Vt,{groupID:this.props.groupID,currentItem:"repos"}),(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsx)($t,{data:this.state})})]})})]})}}])}(o.Component),$t=function(e){function t(e){return(0,s.default)(this,t),(0,a.default)(this,t,[e])}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props.data,t=e.loading,n=e.errorMsg,s=e.libraries;return t?(0,m.jsx)(R.A,{}):n?(0,m.jsxs)("div",{className:"w-100 h-100 d-flex flex-column align-items-center justify-content-center text-center",children:[(0,m.jsx)("img",{src:"".concat(h.SG,"img/error-tip.png"),alt:"",width:"100"}),(0,m.jsx)("p",{className:"mt-2",children:n})]}):(0,m.jsx)(o.Fragment,{children:(0,m.jsxs)("table",{children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"4%"}),(0,m.jsx)("th",{width:"35%",children:(0,h.AP)("Name")}),(0,m.jsx)("th",{width:"20%",children:(0,h.AP)("Size")}),(0,m.jsx)("th",{width:"26%",children:(0,h.AP)("Shared By")}),(0,m.jsx)("th",{width:"15%"})]})}),(0,m.jsx)("tbody",{children:s.map((function(e,t){return(0,m.jsx)(Jt,{data:e},t)}))})]})})}}])}(o.Component),Jt=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).handleMouseOver=function(){n.setState({isHighlighted:!0,isOpIconShown:!0})},n.handleMouseOut=function(){n.setState({isHighlighted:!1,isOpIconShown:!1})},n.handleDeleteIconClick=function(){n.toggleDeleteRepoDialog()},n.toggleDeleteRepoDialog=function(){n.setState({isDeleteRepoDialogOpen:!n.state.isDeleteRepoDialogOpen})},n.deleteRepo=function(){var e=n.props.data;U.k.orgAdminDeleteOrgRepo(Kt,e.repo_id).then((function(t){n.setState({deleted:!0,isRepoDeleted:!0});var s=(0,h.AP)("Successfully deleted {name}.").replace("{name}",e.name);F.A.success(s)})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t),n.setState({isRepoDeleted:!1})}))},n.state={isHighlighted:!1,isOpIconShown:!1,deleted:!1,isDeleteRepoDialogOpen:!1,isRepoDeleted:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.state,t=e.deleted,n=e.isOpIconShown,s=e.isDeleteRepoDialogOpen,r=e.isHighlighted,a=this.props.data;return t?null:(0,m.jsxs)(o.Fragment,{children:[(0,m.jsxs)("tr",{className:ee()({"tr-highlight":r}),onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,children:[(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:T.Aq.getLibIconUrl(a),alt:T.Aq.getLibIconTitle(a),title:T.Aq.getLibIconTitle(a),width:"24"})}),(0,m.jsx)("td",{children:a.name}),(0,m.jsx)("td",{children:T.Aq.bytesToSize(a.size)}),(0,m.jsx)("td",{children:(0,m.jsx)(c.N_,{to:"".concat(h.Yc,"org/useradmin/info/").concat(encodeURIComponent(a.shared_by),"/"),children:a.shared_by_name})}),(0,m.jsx)("td",{children:(0,m.jsx)("i",{className:"op-icon sf3-font-delete1 sf3-font".concat(n?"":" invisible"),title:(0,h.AP)("Delete"),onClick:this.handleDeleteIconClick})})]}),s&&(0,m.jsx)(Nt.A,{repo:a,isRepoDeleted:this.state.isRepoDeleted,onDeleteRepo:this.deleteRepo,toggle:this.toggleDeleteRepoDialog,isGetShare:!1})]})}}])}(o.Component),Zt=Xt,en=window.org.pageOptions.orgID,tn=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).state={loading:!0,errorMsg:""},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){var e=this;U.k.orgAdminListGroupMembers(en,this.props.groupID).then((function(t){e.setState(Object.assign({loading:!1},t.data))})).catch((function(t){e.setState({loading:!1,errorMsg:T.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,m.jsxs)(o.Fragment,{children:[(0,m.jsx)(N,{}),(0,m.jsx)("div",{className:"main-panel-center flex-row",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)(Vt,{groupID:this.props.groupID,currentItem:"members"}),(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsx)(nn,{data:this.state})})]})})]})}}])}(o.Component),nn=function(e){function t(e){return(0,s.default)(this,t),(0,a.default)(this,t,[e])}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props.data,t=e.loading,n=e.errorMsg,s=e.members;return t?(0,m.jsx)(R.A,{}):n?(0,m.jsxs)("div",{className:"w-100 h-100 d-flex flex-column align-items-center justify-content-center text-center",children:[(0,m.jsx)("img",{src:"".concat(h.SG,"img/error-tip.png"),alt:"",width:"100"}),(0,m.jsx)("p",{className:"mt-2",children:n})]}):(0,m.jsx)(o.Fragment,{children:(0,m.jsxs)("table",{className:"table-hover",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"10%"}),(0,m.jsx)("th",{width:"50%",children:(0,h.AP)("Name")}),(0,m.jsx)("th",{width:"40%",children:(0,h.AP)("Role")})]})}),(0,m.jsx)("tbody",{children:s.map((function(e,t){return(0,m.jsx)(sn,{data:e},t)}))})]})})}}])}(o.Component),sn=function(e){function t(e){return(0,s.default)(this,t),(0,a.default)(this,t,[e])}return(0,i.default)(t,e),(0,r.default)(t,[{key:"getRoleText",value:function(){switch(this.props.data.role){case"Owner":return(0,h.AP)("Owner");case"Admin":return(0,h.AP)("Admin");case"Member":return(0,h.AP)("Member")}}},{key:"render",value:function(){var e=this.props.data;return(0,m.jsx)(o.Fragment,{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{className:"text-center",children:(0,m.jsx)("img",{src:e.avatar_url,alt:"",className:"avatar",width:"32"})}),(0,m.jsx)("td",{children:(0,m.jsx)(c.N_,{to:"".concat(h.Yc,"org/useradmin/info/").concat(encodeURIComponent(e.email),"/"),children:e.name})}),(0,m.jsx)("td",{children:this.getRoleText()})]})})}}])}(o.Component),rn=tn,an=n(40898),on=(0,r.default)((function e(t){(0,s.default)(this,e),this.repoID=t.repo_id,this.repoName=t.repo_name,this.ownerName=t.owner_name,this.ownerEmail=t.owner_email,this.size=t.size,this.file_count=t.file_count,this.encrypted=t.encrypted,this.isDepartmentRepo=t.is_department_repo,this.groupID=t.group_id})),ln=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).navItems=[{name:"all",urlPart:"repoadmin",text:(0,h.AP)("All")},{name:"trash",urlPart:"repoadmin-trash",text:(0,h.AP)("Trash")}],n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props.currentItem;return(0,m.jsx)("div",{className:"cur-view-path tab-nav-container",children:(0,m.jsx)("ul",{className:"nav",children:this.navItems.map((function(t,n){return(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsx)(c.N_,{to:"".concat(h.Yc,"org/").concat(t.urlPart,"/"),className:"nav-link".concat(e==t.name?" active":""),children:t.text})},n)}))})})}}])}(o.Component),cn=ln,dn=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.getPreviousPageList=function(){n.props.getListByPage(n.props.pageInfo.current_page-1)},n.getNextPageList=function(){n.props.getListByPage(n.props.pageInfo.current_page+1)},n.sortByFileCount=function(e){e.preventDefault(),n.props.sortItems("file_count")},n.sortBySize=function(e){e.preventDefault(),n.props.sortItems("size")},n.state={isItemFreezed:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,s=t.errorMsg,r=t.items,a=t.pageInfo,i=t.curPerPage,l=t.sortBy;if(n)return(0,m.jsx)(R.A,{});if(s)return(0,m.jsx)("p",{className:"error text-center",children:s});var c=(0,m.jsx)(se.A,{text:(0,h.AP)("No libraries")}),d=(0,m.jsx)("span",{className:"sf3-font sf3-font-sort3"}),u=(0,m.jsx)("span",{className:"sf3-font sf3-font-down"}),p=(0,m.jsxs)(o.Fragment,{children:[(0,m.jsxs)("table",{children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"5%"}),(0,m.jsx)("th",{width:"25%",children:(0,h.AP)("Name")}),(0,m.jsx)("th",{width:"15%",children:void 0!=l?(0,m.jsxs)(o.Fragment,{children:[(0,m.jsxs)("a",{className:"d-inline-block table-sort-op",href:"#",onClick:this.sortByFileCount,children:[(0,h.AP)("Files")," ","file_count"==l?u:d]})," / ",(0,m.jsxs)("a",{className:"d-inline-block table-sort-op",href:"#",onClick:this.sortBySize,children:[(0,h.AP)("Size")," ","size"==l?u:d]})]}):(0,h.AP)("Files")/(0,h.AP)("Size")}),(0,m.jsx)("th",{width:"32%",children:"ID"}),(0,m.jsx)("th",{width:"18%",children:(0,h.AP)("Owner")}),(0,m.jsx)("th",{width:"5%"})]})}),(0,m.jsx)("tbody",{children:r.map((function(t,n){return(0,m.jsx)(un,{repo:t,isItemFreezed:e.state.isItemFreezed,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem,onDeleteRepo:e.props.onDeleteRepo,transferRepoItem:e.props.transferRepoItem},n)}))})]}),a&&(0,m.jsx)(H.A,{gotoPreviousPage:this.getPreviousPageList,gotoNextPage:this.getNextPageList,currentPage:a.current_page,hasNextPage:a.has_next_page,curPerPage:i,resetPerPage:this.props.resetPerPage})]});return r.length?p:c}}])}(o.Component),un=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).onMouseEnter=function(){n.props.isItemFreezed||n.setState({showMenu:!0,highlight:!0})},n.onMouseLeave=function(){n.props.isItemFreezed||n.setState({showMenu:!1,highlight:!1})},n.onDropdownToggleClick=function(e){n.toggleOperationMenu(e)},n.toggleOperationMenu=function(e){e.stopPropagation(),n.setState({isItemMenuShow:!n.state.isItemMenuShow},(function(){n.state.isItemMenuShow?n.props.onFreezedItem():(n.setState({highlight:!1,showMenu:!1}),n.props.onUnfreezedItem())}))},n.toggleDelete=function(){n.props.onDeleteRepo(n.props.repo)},n.renderRepoOwnerHref=function(e){return e.isDepartmentRepo?h.Yc+"org/groupadmin/"+e.groupID+"/":h.Yc+"org/useradmin/info/"+e.ownerEmail+"/"},n.toggleTransfer=function(){n.setState({isTransferDialogShow:!n.state.isTransferDialogShow})},n.onTransferRepo=function(e,t){var s=n.props.repo;U.k.orgAdminTransferOrgRepo(h.Id,s.repoID,e,t).then((function(e){var t=e.data,r=t.owner_name,a=t.owner_email;n.props.transferRepoItem(s.repoID,r,a);var i=(0,h.AP)("Successfully transferred the library.");F.A.success(i)})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.state={highlight:!1,showMenu:!1,isItemMenuShow:!1,isTransferDialogShow:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props.repo,t=this.state.showMenu,n=e.encrypted?(0,h.AP)("Encrypted library"):(0,h.AP)("Read-Write library");return(0,m.jsxs)(o.Fragment,{children:[(0,m.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:T.Aq.getLibIconUrl(e),title:n,alt:n,width:"24"})}),(0,m.jsx)("td",{children:e.repoName}),(0,m.jsx)("td",{children:"".concat(e.file_count," / ").concat(T.Aq.bytesToSize(e.size))}),(0,m.jsx)("td",{children:e.repoID}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:this.renderRepoOwnerHref(e),children:e.ownerName})}),(0,m.jsx)("td",{className:"text-center cursor-pointer",children:t&&(0,m.jsxs)(Ie.A,{isOpen:this.state.isItemMenuShow,toggle:this.toggleOperationMenu,children:[(0,m.jsx)(_e.A,{tag:"i",role:"button",className:"op-icon sf3-font-more sf3-font",title:(0,h.AP)("More operations"),"aria-label":(0,h.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isItemMenuShow,onClick:this.onDropdownToggleClick}),(0,m.jsxs)(Ce.A,{children:[(0,m.jsx)(Me.A,{onClick:this.toggleDelete,children:(0,h.AP)("Delete")}),(0,m.jsx)(Me.A,{onClick:this.toggleTransfer,children:(0,h.AP)("Transfer")})]})]})})]}),this.state.isTransferDialogShow&&(0,m.jsx)(Te.A,{children:(0,m.jsx)(an.A,{itemName:e.repoName,onTransferRepo:this.onTransferRepo,toggleDialog:this.toggleTransfer,isOrgAdmin:!0})})]})}}])}(o.Component),hn=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).getReposByPage=function(e){var t=n.state.perPage;U.k.orgAdminListOrgRepos(h.Id,e,t,n.state.sortBy).then((function(e){var t=e.data.repo_list.map((function(e){return new on(e)})),s={};void 0===e.data.page_info?s={current_page:e.data.page,has_next_page:e.data.page_next}:s=e.data.page_info;n.setState({loading:!1,repos:t,pageInfo:s})})).catch((function(e){n.setState({loading:!1,errorMsg:T.Aq.getErrorMsg(e,!0)})}))},n.sortItems=function(e){n.setState({currentPage:1,sortBy:e},(function(){var e=new URL(location.href),t=new URLSearchParams(e.search),s=n.state,r=s.currentPage,a=s.sortBy;t.set("page",r),t.set("order_by",a),e.search=t.toString(),(0,c.oo)(e.toString()),n.getReposByPage(r)}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){n.getReposByPage(1)}))},n.deleteRepoItem=function(e){U.k.orgAdminDeleteOrgRepo(h.Id,e.repoID).then((function(t){n.setState({repos:n.state.repos.filter((function(t){return t.repoID!==e.repoID}))});var s=(0,h.AP)("Successfully deleted {name}");s=s.replace("{name}",e.repoName),F.A.success(s)})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.transferRepoItem=function(e,t,s){n.setState({repos:n.state.repos.map((function(n){return n.repoID==e&&(n.ownerEmail=s,n.ownerName=t),n}))})},n.state={loading:!0,errorMsg:"",repos:[],pageInfo:{},perPage:100,sortBy:""},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,s=n.currentPage,r=void 0===s?1:s,a=n.perPage,i=n.sortBy;this.setState({sortBy:t.get("order_by")||i,perPage:parseInt(t.get("per_page")||a),currentPage:parseInt(t.get("page")||r)},(function(){e.getReposByPage(e.state.currentPage)}))}},{key:"render",value:function(){return(0,m.jsxs)(o.Fragment,{children:[(0,m.jsx)(N,{}),(0,m.jsx)("div",{className:"main-panel-center flex-row",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)(cn,{currentItem:"all"}),(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsx)(dn,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.repos,sortBy:this.state.sortBy,sortItems:this.sortItems,pageInfo:this.state.pageInfo,curPerPage:this.state.perPage,getListByPage:this.getReposByPage,resetPerPage:this.resetPerPage,onDeleteRepo:this.deleteRepoItem,transferRepoItem:this.transferRepoItem})})]})})]})}}])}(o.Component),pn=n(61314);A().extend(ne());var gn=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.getPreviousPageList=function(){n.props.getListByPage(n.props.pageInfo.current_page-1)},n.getNextPageList=function(){n.props.getListByPage(n.props.pageInfo.current_page+1)},n.state={isItemFreezed:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,s=t.errorMsg,r=t.items,a=t.pageInfo,i=t.curPerPage;if(n)return(0,m.jsx)(R.A,{});if(s)return(0,m.jsx)("p",{className:"error text-center mt-4",children:s});var l=(0,m.jsx)(se.A,{text:(0,h.AP)("No deleted libraries")}),c=(0,m.jsxs)(o.Fragment,{children:[(0,m.jsxs)("table",{className:"table-hover",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"5%"}),(0,m.jsx)("th",{width:"43%",children:(0,h.AP)("Name")}),(0,m.jsx)("th",{width:"27%",children:(0,h.AP)("Owner")}),(0,m.jsx)("th",{width:"20%",children:(0,h.AP)("Deleted Time")}),(0,m.jsx)("th",{width:"5%"})]})}),(0,m.jsx)("tbody",{children:r.map((function(t,n){return(0,m.jsx)(mn,{repo:t,isItemFreezed:e.state.isItemFreezed,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem,onDeleteRepo:e.props.onDeleteRepo,onRestoreRepo:e.props.onRestoreRepo},n)}))})]}),a&&(0,m.jsx)(H.A,{gotoPreviousPage:this.getPreviousPageList,gotoNextPage:this.getNextPageList,currentPage:a.current_page,hasNextPage:a.has_next_page,curPerPage:i,resetPerPage:this.props.resetPerPage})]});return r.length?c:l}}])}(o.Component),mn=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).handleMouseOver=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!0,isHighlighted:!0})},n.handleMouseOut=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!1,isHighlighted:!1})},n.onUnfreezedItem=function(){n.setState({isHighlighted:!1,isOpIconShow:!1}),n.props.onUnfreezedItem()},n.onDeleteRepo=function(){var e=n.props.repo;U.k.orgAdminDeleteTrashRepo(h.Id,e.id).then((function(t){n.props.onDeleteRepo(e);var s=(0,h.AP)("Successfully deleted {name}.").replace("{name}",e.name);F.A.success(s)})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.onRestoreRepo=function(){var e=n.props.repo;U.k.orgAdminRestoreTrashRepo(h.Id,e.id).then((function(t){n.props.onRestoreRepo(e);var s=(0,h.AP)("Successfully restored the library.");F.A.success(s)})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.toggleDeleteRepoDialog=function(e){e&&e.preventDefault(),n.setState({isDeleteRepoDialogOpen:!n.state.isDeleteRepoDialogOpen})},n.toggleRestoreRepoDialog=function(e){e&&e.preventDefault(),n.setState({isRestoreRepoDialogOpen:!n.state.isRestoreRepoDialogOpen})},n.translateOperations=function(e){var t="";switch(e){case"Restore":t=(0,h.AP)("Restore");break;case"Delete":t=(0,h.AP)("Delete")}return t},n.onMenuItemClick=function(e){switch(e){case"Restore":n.toggleRestoreRepoDialog();break;case"Delete":n.toggleDeleteRepoDialog()}},n.state={isHighlighted:!1,isOpIconShown:!1,isDeleteRepoDialogOpen:!1,isRestoreRepoDialogOpen:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props.repo,t=this.state,n=t.isHighlighted,s=t.isOpIconShown,r=t.isDeleteRepoDialogOpen,a=t.isRestoreRepoDialogOpen,i=T.Aq.getLibIconUrl(e),l=T.Aq.getLibIconTitle(e),c='<span class="op-target">'+T.Aq.HTMLescape(e.name)+"</span>";return(0,m.jsxs)(o.Fragment,{children:[(0,m.jsxs)("tr",{className:ee()({"tr-highlight":n}),onMouseEnter:this.handleMouseOver,onMouseLeave:this.handleMouseOut,children:[(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:i,title:l,alt:l,width:"24"})}),(0,m.jsx)("td",{children:e.name}),(0,m.jsx)("td",{children:-1==e.owner.indexOf("@seafile_group")?(0,m.jsx)(ue,{email:e.owner,name:e.owner_name}):e.group_name}),(0,m.jsx)("td",{children:A()(e.delete_time).fromNow()}),(0,m.jsx)("td",{children:s&&(0,m.jsx)(pn.A,{operations:["Restore","Delete"],translateOperations:this.translateOperations,onMenuItemClick:this.onMenuItemClick,onFreezedItem:this.props.onFreezedItem,onUnfreezedItem:this.onUnfreezedItem})})]}),r&&(0,m.jsx)(Te.A,{children:(0,m.jsx)(Le.A,{title:(0,h.AP)("Delete Library"),message:(0,h.AP)("Are you sure you want to delete {placeholder} completely?").replace("{placeholder}",c),executeOperation:this.onDeleteRepo,confirmBtnText:(0,h.AP)("Delete"),toggleDialog:this.toggleDeleteRepoDialog})}),a&&(0,m.jsx)(Te.A,{children:(0,m.jsx)(Le.A,{title:(0,h.AP)("Restore Library"),message:(0,h.AP)("Are you sure you want to restore {placeholder}?").replace("{placeholder}",c),executeOperation:this.onRestoreRepo,confirmBtnText:(0,h.AP)("Restore"),toggleDialog:this.toggleRestoreRepoDialog})})]})}}])}(o.Component),fn=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).toggleCleanTrashDialog=function(){n.setState({isCleanTrashDialogOpen:!n.state.isCleanTrashDialogOpen})},n.getReposByPage=function(e){var t=n.state.perPage;U.k.orgAdminListTrashRepos(h.Id,e,t).then((function(e){n.setState({repos:e.data.repos,pageInfo:e.data.page_info,loading:!1})})).catch((function(e){n.setState({loading:!1,errorMsg:T.Aq.getErrorMsg(e,!0)})}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){n.getReposByPage(1)}))},n.onDeleteRepo=function(e){var t=n.state.repos.filter((function(t){return t.id!=e.id}));n.setState({repos:t})},n.onRestoreRepo=function(e){var t=n.state.repos.filter((function(t){return t.id!=e.id}));n.setState({repos:t})},n.cleanTrash=function(){U.k.orgAdminCleanTrashRepo(h.Id).then((function(e){n.setState({repos:[]}),F.A.success((0,h.AP)("Successfully cleared trash."))})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.state={loading:!0,errorMsg:"",repos:[],pageInfo:{},perPage:100,isCleanTrashDialogOpen:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,s=n.currentPage,r=void 0===s?1:s,a=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||a),currentPage:parseInt(t.get("page")||r)},(function(){e.getReposByPage(e.state.currentPage)}))}},{key:"render",value:function(){var e=this.state.isCleanTrashDialogOpen;return(0,m.jsxs)(o.Fragment,{children:[this.state.repos.length?(0,m.jsx)(N,(0,me.default)((0,me.default)({},this.props),{},{children:(0,m.jsx)(P.A,{className:"operation-item",onClick:this.toggleCleanTrashDialog,children:(0,h.AP)("Clean")})})):(0,m.jsx)(N,(0,me.default)({},this.props)),(0,m.jsx)("div",{className:"main-panel-center flex-row",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)(cn,{currentItem:"trash"}),(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsx)(gn,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.repos,pageInfo:this.state.pageInfo,onDeleteRepo:this.onDeleteRepo,onRestoreRepo:this.onRestoreRepo,getListByPage:this.getReposByPage,resetPerPage:this.resetPerPage,curPerPage:this.state.perPage})})]})}),e&&(0,m.jsx)(Le.A,{title:(0,h.AP)("Clear Trash"),message:(0,h.AP)("Are you sure you want to clear trash?"),executeOperation:this.cleanTrash,confirmBtnText:(0,h.AP)("Clear"),toggleDialog:this.toggleCleanTrashDialog})]})}}])}(o.Component),xn=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).state={org_name:"",traffic_this_month:"",traffic_limit:"",storage_quota:0,storage_usage:0,member_quota:0,member_usage:0,active_members:0},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){var e=this;U.k.orgAdminGetOrgInfo().then((function(t){var n=t.data,s=n.org_id,r=n.org_name,a=n.traffic_this_month,i=n.traffic_limit,o=n.member_quota,l=n.member_usage,c=n.active_members,d=n.storage_quota,u=n.storage_usage,h=n.ai_cost,p=n.ai_credit;e.setState({org_id:s,org_name:r,traffic_this_month:a,traffic_limit:i,member_quota:o,member_usage:l,active_members:c,storage_quota:d,storage_usage:u,ai_cost:h,ai_credit:p})}))}},{key:"render",value:function(){var e=this.state,t=e.org_id,n=e.org_name,s=e.traffic_this_month,r=e.traffic_limit,a=e.member_quota,i=e.member_usage,l=e.active_members,c=e.storage_quota,d=e.storage_usage,u=e.ai_cost,p=e.ai_credit,g=s.link_file_download+s.sync_file_download+s.web_file_download;return g=g||0,(0,m.jsxs)(o.Fragment,{children:[(0,m.jsx)(N,{}),(0,m.jsx)("div",{className:"main-panel-center flex-row",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)("div",{className:"cur-view-path",children:(0,m.jsx)("h3",{className:"sf-heading",children:(0,h.AP)("Info")})}),(0,m.jsx)("div",{className:"cur-view-content org-admin-info-content py-4",children:(0,m.jsxs)("div",{className:"d-flex flex-row flex-wrap justify-content-between",children:[(0,m.jsxs)("div",{className:"info-content-item d-flex",children:[(0,m.jsx)("img",{src:"".concat(h.SG,"img/info-organization.png"),alt:"",width:"46",height:"46",className:"info-content-item-img"}),(0,m.jsxs)("div",{children:[(0,m.jsx)("h4",{className:"info-content-item-heading",children:(0,h.AP)("Team name")}),(0,m.jsx)("p",{className:"info-content-name-text",children:n})]})]}),(0,m.jsxs)("div",{className:"info-content-item d-flex",children:[(0,m.jsx)("img",{src:"".concat(h.SG,"img/info-id.png"),alt:"",width:"46",height:"46",className:"info-content-item-img"}),(0,m.jsxs)("div",{children:[(0,m.jsx)("h4",{className:"info-content-item-heading",children:(0,h.AP)("ID")}),(0,m.jsx)("p",{className:"info-content-name-text",children:t})]})]}),(0,m.jsxs)("div",{className:"info-content-item w-100 d-flex justify-content-around",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("h4",{className:"info-content-item-heading",children:(0,h.AP)("Active users")}),(0,m.jsx)("p",{className:"info-content-user-text",children:l})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("h4",{className:"info-content-item-heading",children:(0,h.AP)("Total users")}),(0,m.jsx)("p",{className:"info-content-user-text",children:i})]}),h.i$&&(0,m.jsxs)("div",{children:[(0,m.jsx)("h4",{className:"info-content-item-heading",children:(0,h.AP)("User number limit")}),(0,m.jsx)("p",{className:"info-content-user-text",children:a>0?a:"--"})]})]}),(0,m.jsxs)("div",{className:"info-content-item",children:[(0,m.jsx)("h4",{className:"info-content-item-heading",children:(0,h.AP)("Space used")}),c>0?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("p",{className:"info-content-space-text",children:"".concat((d/c*100).toFixed(2),"%")}),(0,m.jsxs)("div",{className:"progress-container",children:[(0,m.jsx)("div",{className:"progress",children:(0,m.jsx)("div",{className:"progress-bar",role:"progressbar",style:{width:"".concat(d/c*100,"%")},"aria-valuenow":d/c*100,"aria-valuemin":"0","aria-valuemax":"100"})}),(0,m.jsx)("p",{className:"progress-text m-0",children:"".concat(T.Aq.bytesToSize(d)," / ").concat(T.Aq.bytesToSize(c))})]})]}):(0,m.jsx)("p",{children:T.Aq.bytesToSize(d)})]}),(0,m.jsxs)("div",{className:"info-content-item",children:[(0,m.jsx)("h4",{className:"info-content-item-heading",children:(0,h.AP)("Traffic this month")}),r>0?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("p",{className:"info-content-space-text",children:"".concat((g/r*100).toFixed(2),"%")}),(0,m.jsxs)("div",{className:"progress-container",children:[(0,m.jsx)("div",{className:"progress",children:(0,m.jsx)("div",{className:"progress-bar",role:"progressbar",style:{width:"".concat(g/r*100,"%")},"aria-valuenow":g/r*100,"aria-valuemin":"0","aria-valuemax":"100"})}),(0,m.jsx)("p",{className:"progress-text m-0",children:"".concat(T.Aq.bytesToSize(g)," / ").concat(T.Aq.bytesToSize(r))})]})]}):(0,m.jsx)("p",{children:T.Aq.bytesToSize(g)})]}),h.j1&&(0,m.jsxs)("div",{className:"info-content-item",children:[(0,m.jsx)("h4",{className:"info-content-item-heading",children:(0,h.AP)("AI credit used this month")}),(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("p",{className:"info-content-space-text",children:"".concat(p>0?(u/p*100).toFixed(2):"0","%")}),(0,m.jsxs)("div",{className:"progress-container",children:[(0,m.jsx)("div",{className:"progress",children:(0,m.jsx)("div",{className:"progress-bar",role:"progressbar",style:{width:"".concat(u/p*100,"%")},"aria-valuenow":g/r*100,"aria-valuemin":"0","aria-valuemax":"100"})}),(0,m.jsx)("p",{className:"progress-text m-0",children:"".concat(u," / ").concat(p>0?p:"--")})]})]})]})]})})]})})]})}}])}(o.Component),vn=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).copyToClipBoard=function(){(0,Ke.A)(n.props.currentLinkHref);var e=(0,h.AP)("Link has been copied to clipboard");F.A.success(e,{duration:2}),n.props.toggle()},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props.currentLinkHref;return(0,m.jsxs)(Fe.A,{isOpen:!0,toggle:this.props.toggle,children:[(0,m.jsx)(qe.A,{toggle:this.props.toggle,children:(0,h.AP)("Link")}),(0,m.jsx)(Ee.A,{children:(0,m.jsx)("p",{children:(0,m.jsx)("a",{target:"_blank",href:e,rel:"noreferrer",children:e})})}),(0,m.jsxs)(Ye.A,{children:[(0,m.jsx)(P.A,{color:"secondary",onClick:this.props.toggle,children:(0,h.AP)("Cancel")})," ",(0,m.jsx)(P.A,{color:"primary",onClick:this.copyToClipBoard,children:(0,h.AP)("Copy")})]})]})}}])}(o.Component);A().extend(ne());var jn=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).listOrgLinks=function(e){U.k.orgAdminListOrgLinks(e).then((function(e){var t=e.data;n.setState({linkList:t.link_list,page:t.page,pageNext:t.page_next})}))},n.onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.onChangePageNum=function(e,t){e.preventDefault();var s=n.state.page;1===t?s+=1:s-=1,n.listOrgLinks(s)},n.deleteOrgLink=function(e){U.k.orgAdminDeleteOrgLink(e).then((function(e){!0===e.data.success&&n.listOrgLinks(n.state.page)})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.openLinkDialog=function(e){var t;t=e.name.indexOf("/")>-1?h.xW+"/d/"+e.token+"/":h.xW+"/f/"+e.token+"/",n.setState({currentLinkHref:t}),n.toggleLinkDialog()},n.toggleLinkDialog=function(){n.setState({isShowLinkDialog:!n.state.isShowLinkDialog})},n.state={linkList:null,page:1,pageNext:!1,isItemFreezed:!1,isShowLinkDialog:!1,currentLinkHref:""},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){this.listOrgLinks(this.state.page)}},{key:"render",value:function(){var e=this,t=this.state.linkList;return(0,m.jsxs)(o.Fragment,{children:[(0,m.jsx)(N,{}),(0,m.jsx)("div",{className:"main-panel-center flex-row",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)("div",{className:"cur-view-path",children:(0,m.jsx)("h3",{className:"sf-heading",children:(0,h.AP)("All Public Links")})}),(0,m.jsxs)("div",{className:"cur-view-content",children:[(0,m.jsxs)("table",{children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"50%",children:(0,h.AP)("Name")}),(0,m.jsx)("th",{width:"15%",children:(0,h.AP)("Owner")}),(0,m.jsx)("th",{width:"15%",children:(0,h.AP)("Created At")}),(0,m.jsx)("th",{width:"10%",children:(0,h.AP)("Visit count")}),(0,m.jsx)("th",{width:"10%"})]})}),(0,m.jsx)("tbody",{children:t&&t.map((function(t,n){return(0,m.jsx)(o.Fragment,{children:(0,m.jsx)(An,{link:t,isItemFreezed:e.state.isItemFreezed,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem,deleteOrgLink:e.deleteOrgLink,openLinkDialog:e.openLinkDialog})},n)}))})]}),(0,m.jsxs)("div",{className:"paginator",children:[1!==this.state.page&&(0,m.jsx)("a",{href:"#",onClick:function(t){return e.onChangePageNum(t,-1)},children:(0,h.AP)("Previous")}),1!==this.state.page&&this.state.pageNext&&(0,m.jsx)("span",{children:" | "}),this.state.pageNext&&(0,m.jsx)("a",{href:"#",onClick:function(t){return e.onChangePageNum(t,1)},children:(0,h.AP)("Next")})]})]})]})}),this.state.isShowLinkDialog&&(0,m.jsx)(vn,{currentLinkHref:this.state.currentLinkHref,toggle:this.toggleLinkDialog})]})}}])}(o.Component),An=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).onMouseEnter=function(){n.props.isItemFreezed||n.setState({showMenu:!0,highlight:!0})},n.onMouseLeave=function(){n.props.isItemFreezed||n.setState({showMenu:!1,highlight:!1})},n.onDropdownToggleClick=function(e){n.toggleOperationMenu(e)},n.toggleOperationMenu=function(e){e.stopPropagation(),n.setState({isItemMenuShow:!n.state.isItemMenuShow},(function(){n.state.isItemMenuShow?n.props.onFreezedItem():(n.setState({highlight:!1,showMenu:!1}),n.props.onUnfreezedItem())}))},n.state={highlight:!1,showMenu:!1,isItemMenuShow:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props,t=e.link,n=e.deleteOrgLink,s=h.Yc+"org/useradmin/info/"+encodeURIComponent(t.owner_email)+"/";return(0,m.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[(0,m.jsx)("td",{children:t.name}),(0,m.jsx)("td",{children:(0,m.jsx)("a",{href:s,children:t.owner_name})}),(0,m.jsx)("td",{children:A()(t.created_time).fromNow()}),(0,m.jsx)("td",{children:t.view_count}),(0,m.jsx)("td",{className:"cursor-pointer text-center",children:this.state.showMenu&&(0,m.jsxs)(Ie.A,{isOpen:this.state.isItemMenuShow,toggle:this.toggleOperationMenu,children:[(0,m.jsx)(_e.A,{tag:"i",className:"op-icon sf3-font-more sf3-font",title:(0,h.AP)("More operations"),"aria-label":(0,h.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isItemMenuShow,onClick:this.onDropdownToggleClick}),(0,m.jsxs)(Ce.A,{children:[(0,m.jsx)(Me.A,{onClick:n.bind(this,t.token),children:(0,h.AP)("Delete")}),(0,m.jsx)(Me.A,{onClick:this.props.openLinkDialog.bind(this,t),children:(0,h.AP)("View Link")})]})]})})]})}}])}(o.Component),Sn=jn,yn=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).setGroupQuota=function(){var e=n.state.quota;if(e.length&&/^[1-9]\d*$/im.test(e)||-2==e){n.setState({errMessage:""});var t=-2==n.state.quota?n.state.quota:1e6*n.state.quota;U.k.orgAdminSetGroupQuota(h.Id,n.props.group.id,t).then((function(e){n.props.toggle(),n.props.onSetQuota(e.data)})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))}else{var s=(0,h.AP)("Quota is invalid.");n.setState({errMessage:s})}},n.handleChange=function(e){var t=e.target.value.trim();n.setState({quota:t})},n.handleKeyDown=function(e){"Enter"===e.key&&(n.setGroupQuota(),e.preventDefault())},n.state={quota:"",errMessage:""},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props.group,t=T.Aq.bytesToSize(e.quota),n=(0,h.AP)("The current quota for {group_name} is {quota}").replace("{group_name}",e.name).replace("{quota}",t);return(0,m.jsxs)(Fe.A,{isOpen:!0,toggle:this.props.toggle,autoFocus:!1,children:[(0,m.jsx)(qe.A,{toggle:this.props.toggle,children:(0,h.AP)("Set Quota")}),(0,m.jsxs)(Ee.A,{children:[(0,m.jsx)("p",{children:n}),(0,m.jsx)("p",{children:(0,h.AP)("Please enter a new quota")}),(0,m.jsxs)(Ae.A,{children:[(0,m.jsx)(q.A,{onKeyDown:this.handleKeyDown,value:this.state.quota,onChange:this.handleChange,autoFocus:!0}),(0,m.jsx)(fe.A,{addonType:"append",children:"MB"})]}),(0,m.jsxs)("p",{className:"tip",children:[(0,m.jsx)("br",{}),(0,m.jsx)("span",{children:(0,h.AP)("An integer that is greater than 0 or equal to -2.")}),(0,m.jsx)("br",{}),(0,m.jsx)("span",{children:(0,h.AP)("Tip: -2 means no limit.")})]}),this.state.errMessage&&(0,m.jsx)("p",{className:"error",children:this.state.errMessage})]}),(0,m.jsxs)(Ye.A,{children:[(0,m.jsx)(P.A,{color:"secondary",onClick:this.props.toggle,children:(0,h.AP)("Cancel")}),(0,m.jsx)(P.A,{color:"primary",onClick:this.setGroupQuota,children:(0,h.AP)("Submit")})]})]})}}])}(o.Component),Nn=n(15097),wn=n(685),Dn=n(77474),bn=n(47150),Pn=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).handleSubmit=function(){n.validateName()&&U.k.orgAdminAddDepartmentRepo(h.Id,n.props.groupID,n.state.repoName.trim()).then((function(e){n.props.toggle(),n.props.onAddNewRepo(e.data)})).catch((function(e){var t=T.Aq.getErrorMsg(e);n.setState({errMessage:t})}))},n.validateName=function(){var e="";return!!n.state.repoName.trim().length||(e=(0,h.AP)("Name is required"),n.setState({errMessage:e}),!1)},n.handleChange=function(e){n.setState({repoName:e.target.value})},n.handleKeyDown=function(e){"Enter"===e.key&&(n.handleSubmit(),e.preventDefault())},n.state={repoName:"",errMessage:""},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.state.errMessage;return(0,m.jsxs)(Fe.A,{isOpen:!0,toggle:this.props.toggle,autoFocus:!1,children:[(0,m.jsx)(qe.A,{toggle:this.props.toggle,children:(0,h.AP)("New Library")}),(0,m.jsxs)(Ee.A,{children:[(0,m.jsx)(Ve.A,{children:(0,m.jsxs)(Ge.A,{children:[(0,m.jsx)(He.A,{for:"repoName",children:(0,h.AP)("Name")}),(0,m.jsx)(q.A,{id:"repoName",name:"repo-name",onKeyDown:this.handleKeyDown,value:this.state.repoName,onChange:this.handleChange,autoFocus:!0})]})}),e&&(0,m.jsx)(ze.A,{color:"danger",className:"mt-2",children:e})]}),(0,m.jsxs)(Ye.A,{children:[(0,m.jsx)(P.A,{color:"secondary",onClick:this.props.toggle,children:(0,h.AP)("Cancel")}),(0,m.jsx)(P.A,{color:"primary",onClick:this.handleSubmit,children:(0,h.AP)("Submit")})]})]})}}])}(o.Component),kn=n(60436),In=function(){return(0,r.default)((function e(t){(0,s.default)(this,e),this.id=t.id||"",this.name=t.name||"",this.children=t.children||[],this.parentNode=t.parentNode||null,this.orgId=t.orgId||"",this.quota=t.quota||-2}),[{key:"findNodeById",value:function(e){if(this.id===e)return this;for(var t=(0,kn.default)(this.children);t.length>0;){var n=t.shift();if(n.id===e)return n;t.push.apply(t,(0,kn.default)(n.children))}}},{key:"addChildren",value:function(e){var t;(t=this.children).push.apply(t,(0,kn.default)(e))}},{key:"setChildren",value:function(e){this.children=e}},{key:"hasChildren",value:function(){return this.children.length>0}},{key:"deleteChildById",value:function(e){this.children=this.children.filter((function(t){return t.id!==e}))}}])}();var _n=function(e){var t=e.node,n=e.toggleDelete,s=e.toggleRename,r=e.toggleAddMembers,a=e.toggleAddDepartment,i=e.toggleAddLibrary,o=e.toggleSetQuotaDialog;return(0,m.jsxs)(Ce.A,{modifiers:[{name:"preventOverflow",options:{boundary:document.body}}],className:"position-fixed",children:[(0,m.jsx)(Me.A,{onClick:function(){return a(t)},children:(0,h.AP)("Add sub-department")},"".concat(t.id,"-add-department")),(0,m.jsx)(Me.A,{onClick:function(){return i(t)},children:(0,h.AP)("Add Library")},"".concat(t.id,"-add-repo")),(0,m.jsx)(Me.A,{onClick:function(){return r(t)},children:(0,h.AP)("Add members")},"".concat(t.id,"-add-members")),(0,m.jsx)(Me.A,{onClick:function(){return s(t)},children:(0,h.AP)("Rename")},"".concat(t.id,"-rename")),(0,m.jsx)(Me.A,{onClick:function(){return n(t)},children:(0,h.AP)("Delete")},"".concat(t.id,"-delete")),(0,m.jsx)(Me.A,{onClick:function(){return o(t)},children:(0,h.AP)("Set quota")},"".concat(t.id,"-set-quota")),(0,m.jsx)(Me.A,{disabled:!0,children:"".concat((0,h.AP)("Department ID")," : ").concat(t.id)},"".concat(t.id,"-id"))]})},Cn=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).toggleChildren=function(e){e.preventDefault(),e.stopPropagation(),n.state.isChildrenShow?n.setState({isChildrenShow:!1}):n.listSubDepartments()},n.listSubDepartments=function(){var e=n.props.node;n.props.listSubDepartments(e.id,(function(e){Array.isArray(e)&&0===e.length&&n.setState({isShowTreeIcon:!1}),n.setState({isChildrenShow:!0})}))},n.dropdownToggle=function(e){e.stopPropagation(),n.setState({dropdownOpen:!n.state.dropdownOpen})},n.onMouseEnter=function(){n.setState({active:!0})},n.onMouseLeave=function(){n.state.dropdownOpen||n.setState({active:!1})},n.renderTreeNodes=function(e){if(e.length>0)return e.map((function(e){return(0,m.jsx)(t,{node:e,onChangeDepartment:n.props.onChangeDepartment,checkedDepartmentId:n.props.checkedDepartmentId,listSubDepartments:n.props.listSubDepartments,toggleAddDepartment:n.props.toggleAddDepartment,toggleAddMembers:n.props.toggleAddMembers,toggleRename:n.props.toggleRename,toggleDelete:n.props.toggleDelete,toggleAddLibrary:n.props.toggleAddLibrary,toggleSetQuotaDialog:n.props.toggleSetQuotaDialog},e.id)}))},n.changeDept=function(e){var t=n.props,s=t.node,r=t.checkedDepartmentId,a=n.state.isChildrenShow;if(r!==s.id&&n.props.onChangeDepartment(e),r===s.id){if(a)return void n.setState({isChildrenShow:!1});n.listSubDepartments()}},n.state={isShowTreeIcon:!0,isChildrenShow:!1,dropdownOpen:!1,active:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){-1===this.props.node.id&&this.listSubDepartments()}},{key:"render",value:function(){var e=this,t=this.props,n=t.node,s=t.checkedDepartmentId,r=this.state,a=r.isChildrenShow,i=r.dropdownOpen,l=r.active,c=ee()({"tree-node":!0,active:s===n.id});return(0,m.jsxs)(o.Fragment,{children:[(0,m.jsxs)("div",{className:c,onClick:function(){return e.changeDept(n.id)},onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[this.state.isShowTreeIcon?(0,m.jsx)("span",{className:"departments-v2-tree-icon",onClick:function(t){return e.toggleChildren(t)},children:(0,m.jsx)("i",{className:"sf3-font sf3-font-down ".concat(a?"":"rotate-270")})}):(0,m.jsx)("span",{style:{width:24}}),(0,m.jsx)("span",{className:"departments-v2-tree-node-text text-truncate",children:n.name}),l&&(0,m.jsxs)(Ie.A,{isOpen:i,toggle:function(t){return e.dropdownToggle(t)},direction:"down",className:"mr-2",children:[(0,m.jsx)(_e.A,{tag:"span",role:"button",className:"right-icon",title:(0,h.AP)("More operations"),"aria-label":(0,h.AP)("More operations"),"data-toggle":"dropdown",children:(0,m.jsx)("i",{className:"sf3-font sf3-font-more"})}),(0,m.jsx)(_n,{node:n,toggleAddDepartment:this.props.toggleAddDepartment,toggleAddLibrary:this.props.toggleAddLibrary,toggleAddMembers:this.props.toggleAddMembers,toggleSetQuotaDialog:this.props.toggleSetQuotaDialog,toggleRename:this.props.toggleRename,toggleDelete:this.props.toggleDelete})]})]}),this.state.isChildrenShow&&(0,m.jsx)("div",{className:"tree-node-children",children:n.children&&this.renderTreeNodes(n.children)})]})}}])}(o.Component),Mn=function(e){function t(){return(0,s.default)(this,t),(0,a.default)(this,t,arguments)}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.rootNodes,s=t.checkedDepartmentId;return(0,m.jsxs)("div",{className:"departments-tree-panel p-4",children:[n.map((function(t){return(0,m.jsx)(Cn,{node:t,checkedDepartmentId:s,onChangeDepartment:e.props.onChangeDepartment,listSubDepartments:e.props.listSubDepartments,toggleAddDepartment:e.props.toggleAddDepartment,toggleSetQuotaDialog:e.props.toggleSetQuotaDialog,toggleAddLibrary:e.props.toggleAddLibrary,toggleAddMembers:e.props.toggleAddMembers,toggleRename:e.props.toggleRename,toggleDelete:e.props.toggleDelete},t.id)})),(0,m.jsxs)("button",{className:"btn btn-secondary btn-block text-start border-0 font-weight-normal new-dept-btn shadow-none",onClick:function(){e.props.toggleAddDepartment(null)},children:[(0,m.jsx)("i",{className:"sf3-font sf3-font-new new-dept-btn-icon"}),(0,h.AP)("New Department")]})]})}}])}(o.Component),On=Mn,Ln=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).handleMouseEnter=function(){n.props.isItemFreezed||n.setState({highlighted:!0})},n.handleMouseLeave=function(){n.props.isItemFreezed||n.setState({highlighted:!1})},n.setMemberStaff=function(e){n.props.setMemberStaff(n.props.member.email,"Admin"===e.value)},n.deleteMember=function(){var e=n.props.member;n.props.deleteMember(e.email)},n.toggleDropdownMenu=function(){n.setState({isItemMenuShow:!n.state.isItemMenuShow},(function(){n.state.isItemMenuShow&&"function"===typeof n.props.freezeItem?n.props.freezeItem():n.state.isItemMenuShow||"function"!==typeof n.props.unfreezeItem||n.props.unfreezeItem()}))},n.toggleItemFreezed=function(e){e?n.props.freezeItem():(n.props.unfreezeItem(),n.setState({highlighted:!1}))},n.toggleDeleteMemberDialog=function(){n.setState({isDeleteMemberDialogOpen:!n.state.isDeleteMemberDialogOpen})},n.state={highlighted:!1,isItemMenuShow:!1,isDeleteMemberDialogOpen:!1},n.roleOptions=[{value:"Admin",text:(0,h.AP)("Admin"),isSelected:!1},{value:"Member",text:(0,h.AP)("Member"),isSelected:!1}],n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props.member,t=this.state,n=t.highlighted,s=t.isItemMenuShow,r=t.isDeleteMemberDialogOpen;this.roleOptions=this.roleOptions.map((function(t){return t.isSelected=t.value==e.role,t}));var a=this.roleOptions.filter((function(e){return e.isSelected}))[0];return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("tr",{className:"departments-members-item ".concat(n?"tr-highlight":""),onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,m.jsx)("td",{children:(0,m.jsx)("img",{className:"avatar",src:e.avatar_url,alt:""})}),(0,m.jsx)("td",{className:"text-truncate",children:(0,m.jsx)("a",{href:"".concat(h.Yc,"org/useradmin/info/").concat(encodeURIComponent(e.email),"/"),children:e.name})}),(0,m.jsx)("td",{children:(0,m.jsx)(Oe.A,{isDropdownToggleShown:n,currentSelectedOption:a,options:this.roleOptions,selectOption:this.setMemberStaff,toggleItemFreezed:this.toggleItemFreezed})}),(0,m.jsx)("td",{children:e.contact_email}),(0,m.jsx)("td",{children:n&&(0,m.jsxs)(Ie.A,{isOpen:s,toggle:this.toggleDropdownMenu,direction:"down",children:[(0,m.jsx)(_e.A,{tag:"i",role:"button",className:"op-icon sf3-font-more sf3-font",title:(0,h.AP)("More operations"),"aria-label":(0,h.AP)("More operations"),"data-toggle":"dropdown"}),(0,m.jsx)(Ce.A,{children:(0,m.jsx)(Me.A,{onClick:this.toggleDeleteMemberDialog,children:(0,h.AP)("Delete")},"delete")})]})})]}),r&&(0,m.jsx)(Le.A,{title:(0,h.AP)("Delete Member"),message:(0,h.AP)("Are you sure you want to delete {placeholder} ?").replace("{placeholder}",'<span class="op-target">'+T.Aq.HTMLescape(e.name)+"</span>"),executeOperation:this.deleteMember,confirmBtnText:(0,h.AP)("Delete"),toggleDialog:this.toggleDeleteMemberDialog})]})}}])}(o.Component),Un=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).deleteRepo=function(){var e=n.props.repo;U.k.orgAdminDeleteDepartmentRepo(h.Id,n.props.groupID,n.props.repo.repo_id).then((function(t){t.data.success&&n.props.onDeleteRepo(e.repo_id)})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=(0,h.AP)("Are you sure you want to delete {placeholder} ?");return e=e.replace("{placeholder}",'<span class="op-target">'+T.Aq.HTMLescape(this.props.repo.name)+"</span>"),(0,m.jsxs)(Fe.A,{isOpen:!0,toggle:this.props.toggle,children:[(0,m.jsx)(qe.A,{toggle:this.props.toggle,children:(0,h.AP)("Delete Library")}),(0,m.jsx)(Ee.A,{children:(0,m.jsx)("div",{dangerouslySetInnerHTML:{__html:e}})}),(0,m.jsxs)(Ye.A,{children:[(0,m.jsx)(P.A,{color:"secondary",onClick:this.props.toggle,children:(0,h.AP)("Cancel")}),(0,m.jsx)(P.A,{color:"primary",onClick:this.deleteRepo,children:(0,h.AP)("Delete")})]})]})}}])}(o.Component);A().locale(h.vV);var Rn=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).onMouseEnter=function(){n.setState({highlight:!0})},n.onMouseLeave=function(){n.setState({highlight:!1})},n.toggleDeleteDialog=function(){n.setState({isDeleteDialogOpen:!n.state.isDeleteDialogOpen})},n.state={highlight:!1,isDeleteDialogOpen:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props,t=e.repo,n=e.groupID,s=this.state,r=s.highlight,a=s.isDeleteDialogOpen,i=T.Aq.getLibIconUrl(t);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("tr",{className:r?"tr-highlight":"",onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[(0,m.jsx)("td",{children:(0,m.jsx)("img",{src:i,width:"24",alt:(0,h.AP)("icon")})}),(0,m.jsx)("td",{children:t.name}),(0,m.jsxs)("td",{children:[T.Aq.bytesToSize(t.size)," "]}),(0,m.jsx)("td",{className:"cursor-pointer text-center",children:(0,m.jsx)("span",{onClick:this.toggleDeleteDialog,className:"sf3-font-delete1 sf3-font op-icon ".concat(r?"":"vh"),title:"Delete"})})]}),a&&(0,m.jsx)(Te.A,{children:(0,m.jsx)(Un,{toggle:this.toggleDeleteDialog,onDeleteRepo:this.props.onDeleteRepo,repo:t,groupID:n})})]})}}])}(o.Component),Tn=Rn,Fn=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).freezeItem=function(){n.setState({isItemFreezed:!0})},n.unfreezeItem=function(){n.setState({isItemFreezed:!1})},n.getCurrentDepartment=function(){var e=n.props,t=e.rootNodes,s=e.checkedDepartmentId;if(!t)return{};for(var r={},a=(0,kn.default)(t);!r.id&&a.length>0;){var i=a.shift();i.id===s?r=i:i.children&&i.children.length>0&&a.push.apply(a,(0,kn.default)(i.children))}return r},n.sortByName=function(e){e.preventDefault();var t=n.props.sortOrder;t="asc"===t?"desc":"asc",n.props.sortItems("name",t)},n.sortByRole=function(e){e.preventDefault();var t=n.props.sortOrder;t="asc"===t?"desc":"asc",n.props.sortItems("role",t)},n.changeActiveNav=function(e){n.setState({activeNav:e})},n.getRepos=function(e){n.props.getRepos(e,(function(e){n.setState({repos:e})}))},n.dropdownToggle=function(e){e.stopPropagation(),n.setState({dropdownOpen:!n.state.dropdownOpen})},n.onDeleteRepo=function(e){var t=n.state.repos;n.setState({repos:t.filter((function(t){return t.repo_id!=e}))})},n.state={isItemFreezed:!1,activeNav:"members",repos:[],dropdownOpen:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){this.getRepos(this.props.checkedDepartmentId)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.checkedDepartmentId===e.checkedDepartmentId&&this.props.isAddNewRepo===e.isAddNewRepo||this.getRepos(e.checkedDepartmentId)}},{key:"render",value:function(){var e=this,t=this.state,n=t.activeNav,s=t.repos,r=this.props,a=r.membersList,i=r.isMembersListLoading,o=r.sortBy,l=r.sortOrder,c="name"===o,d="role"===o,u=(0,m.jsx)("span",{className:"sort-dirent sf3-font sf3-font-down ".concat("asc"===l?"rotate-180":"")}),p=this.getCurrentDepartment();return(0,m.jsxs)("div",{className:"department-content-main d-flex flex-column",children:[(0,m.jsxs)("div",{className:"cur-view-path justify-content-start",children:[(0,m.jsx)("h4",{className:"sf-heading",children:p.name}),(0,m.jsxs)(Ie.A,{isOpen:this.state.dropdownOpen,toggle:function(t){return e.dropdownToggle(t)},direction:"down",className:"department-dropdown-menu",children:[(0,m.jsx)(_e.A,{tag:"span",role:"button",className:"sf3-font-down sf3-font ml-1 sf-dropdown-toggle",title:(0,h.AP)("More operations"),"aria-label":(0,h.AP)("More operations"),"data-toggle":"dropdown"}),(0,m.jsx)(_n,{node:p,toggleAddDepartment:this.props.toggleAddDepartment,toggleSetQuotaDialog:this.props.toggleSetQuotaDialog,toggleAddLibrary:this.props.toggleAddLibrary,toggleAddMembers:this.props.toggleAddMembers,toggleRename:this.props.toggleRename,toggleDelete:this.props.toggleDelete})]})]}),(0,m.jsx)("div",{className:"cur-view-path tab-nav-container",children:(0,m.jsxs)("ul",{className:"nav",children:[(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsx)("span",{className:"nav-link ".concat("members"===n?"active":""),onClick:function(){return e.changeActiveNav("members")},children:(0,h.AP)("Members")})}),(0,m.jsx)("li",{className:"nav-item",children:(0,m.jsx)("span",{className:"nav-link ".concat("repos"===n?"active":""),onClick:function(){return e.changeActiveNav("repos")},children:(0,h.AP)("Libraries")})})]})}),"members"===n&&(0,m.jsxs)(m.Fragment,{children:[i&&(0,m.jsx)(R.A,{}),!i&&a.length>0&&(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsxs)("table",{children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"60px"}),(0,m.jsxs)("th",{width:"25%",onClick:this.sortByName,children:[(0,h.AP)("Name")," ",c&&u]}),(0,m.jsxs)("th",{width:"23%",onClick:this.sortByRole,children:[(0,h.AP)("Role")," ",d&&u]}),(0,m.jsx)("th",{width:"35%",children:(0,h.AP)("Contact email")}),(0,m.jsx)("th",{width:"calc(17% - 60px)"})]})}),(0,m.jsx)("tbody",{children:a.map((function(t,n){return(0,m.jsx)(Ln,{member:t,deleteMember:e.props.deleteMember,setMemberStaff:e.props.setMemberStaff,unfreezeItem:e.unfreezeItem,freezeItem:e.freezeItem,isItemFreezed:e.state.isItemFreezed},n)}))})]})}),!i&&0===a.length&&(0,m.jsx)(se.A,{text:(0,h.AP)("No members")})]}),"repos"===n&&s.length>0&&(0,m.jsx)("div",{className:"cur-view-content",children:(0,m.jsxs)("table",{children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"5%"}),(0,m.jsx)("th",{width:"50%",children:(0,h.AP)("Name")}),(0,m.jsx)("th",{width:"30%",children:(0,h.AP)("Size")}),(0,m.jsx)("th",{width:"15%"})]})}),(0,m.jsx)("tbody",{children:s.map((function(t,n){return(0,m.jsx)(Tn,{repo:t,groupID:e.props.checkedDepartmentId,onDeleteRepo:e.onDeleteRepo},n)}))})]})}),"repos"===n&&0===s.length&&(0,m.jsx)(se.A,{text:(0,h.AP)("No libraries")})]})}}])}(o.Component),En=(n(2201),function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).onChangeDepartment=function(e){n.setState({checkedDepartmentId:e},n.loadDepartmentMembers(e))},n.loadDepartmentMembers=function(e){-1!==e?(n.setState({isMembersListLoading:!0}),U.k.orgAdminListGroupInfo(h.Id,e,!0).then((function(e){n.setState({membersList:e.data.members,isMembersListLoading:!1})})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))):n.setState({isMembersListLoading:!1,membersList:[]})},n.listSubDepartments=function(e,t){var s=n.state.rootNodes,r=null;s.forEach((function(t){r||(r=t.findNodeById(e))})),r&&U.k.orgAdminListGroupInfo(h.Id,e,!0).then((function(e){var n=e.data.groups.map((function(e){return new In({id:e.id,name:e.name,parentGroupId:e.parent_group_id,orgId:e.org_id,parentNode:r,quota:e.quota})}));r.setChildren(n),t&&t(n)})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.getRepos=function(e,t){U.k.orgAdminListGroupRepos(h.Id,e).then((function(e){t&&t(e.data.libraries)})).catch((function(e){if(e.response&&404===e.response.status)t&&t(null);else{var n=T.Aq.getErrorMsg(e);F.A.danger(n)}}))},n.toggleAddLibrary=function(e){n.setState({operateNode:e,isShowAddRepoDialog:!n.state.isShowAddRepoDialog})},n.toggleAddDepartment=function(e){n.setState({operateNode:e,isAddDepartmentDialogShow:!n.state.isAddDepartmentDialogShow})},n.toggleAddMembers=function(e){n.setState({operateNode:e,isAddMembersDialogShow:!n.state.isAddMembersDialogShow})},n.toggleRename=function(e){n.setState({operateNode:e,isRenameDepartmentDialogShow:!n.state.isRenameDepartmentDialogShow})},n.toggleDelete=function(e){n.setState({operateNode:e,isDeleteDepartmentDialogShow:!n.state.isDeleteDepartmentDialogShow})},n.addDepartment=function(e,t){e.addChildren([new In({id:t.id,name:t.name,parentNode:e,orgId:t.org_id})])},n.setRootNode=function(e){var t=new In({id:e.id,name:e.name,orgId:e.org_id}),s=n.state.rootNodes.slice(0);s.push(t),n.setState({rootNodes:s,checkedDepartmentId:t.id}),n.loadDepartmentMembers(t.id)},n.renameDepartment=function(e,t){e.id=t.id,e.name=t.name},n.onDelete=function(){var e=n.state,t=e.operateNode,s=e.checkedDepartmentId;U.k.orgAdminDeleteDepartGroup(h.Id,t.id).then((function(e){if(n.toggleDelete(),t.parentNode)t.parentNode.deleteChildById(t.id),t.id===s&&-1!==t.parentNode.id&&n.onChangeDepartment(t.parentNode.id);else{var r=n.state.rootNodes.slice(0),a=r.findIndex((function(e){return e.id===t.id}));r.splice(a,1),0===r.length?n.setState({rootNodes:r,checkedDepartmentId:-1}):(n.setState({rootNodes:r,checkedDepartmentId:r[0].id}),n.loadDepartmentMembers(r[0].id))}})).catch((function(e){if(e.response&&400===e.response.status)F.A.danger(e.response.data.error_msg);else{var t=T.Aq.getErrorMsg(e);F.A.danger(t)}}))},n.onMemberChanged=function(){var e=n.state,t=e.checkedDepartmentId,s=e.operateNode;t&&s&&t!==s.id||n.loadDepartmentMembers(s.id)},n.setMemberStaff=function(e,t){var s=n.state,r=s.checkedDepartmentId,a=s.membersList;U.k.orgAdminSetGroupMemberRole(h.Id,r,e,t).then((function(t){var s=t.data,r=a.map((function(t){return t.email===e?s:t}));n.setState({membersList:r})})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.deleteMember=function(e){var t=n.state,s=t.checkedDepartmentId,r=t.membersList;U.k.orgAdminDeleteGroupMember(h.Id,s,e).then((function(t){var s=r.filter((function(t){return t.email!==e}));n.setState({membersList:s})})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.sortMembers=function(e,t,n){var s;switch("".concat(t,"-").concat(n)){case"name-asc":s=function(e,t){return T.Aq.compareTwoWord(e.name,t.name)};break;case"name-desc":s=function(e,t){return-T.Aq.compareTwoWord(e.name,t.name)};break;case"role-asc":s=function(e,t){return"Admin"==e.role?-1:1};break;case"role-desc":s=function(e,t){return"Admin"==e.role?1:-1}}return e.sort((function(e,t){return s(e,t)})),e},n.sortItems=function(e,t){n.setState({sortBy:e,sortOrder:t,membersList:n.sortMembers(n.state.membersList,e,t)})},n.toggleSetQuotaDialog=function(e){n.setState({operateNode:e,isSetQuotaDialogShow:!n.state.isSetQuotaDialogShow})},n.onSetQuota=function(e){var t=n.state.rootNodes.slice(0);n._setQuota(t[0],e),n.setState({rootNodes:t})},n._setQuota=function(e,t){e.id===t.id?e.quota=t.quota:e.children.forEach((function(e){n._setQuota(e,t)}))},n.state={rootNodes:[],checkedDepartmentId:-1,operateNode:null,isAddDepartmentDialogShow:!1,isAddMembersDialogShow:!1,isRenameDepartmentDialogShow:!1,isDeleteDepartmentDialogShow:!1,isShowAddRepoDialog:!1,isSetQuotaDialogShow:!1,membersList:[],isTopDepartmentLoading:!1,isMembersListLoading:!1,sortBy:"name",sortOrder:"asc"},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({isTopDepartmentLoading:!0},(function(){U.k.orgAdminListDepartGroups(h.Id).then((function(t){var n=t.data.data;if(n&&n.length>0){var s=n.map((function(e){return new In({id:e.id,name:e.name,orgId:e.org_id,quota:e.quota})}));e.setState({rootNodes:s,checkedDepartmentId:s[0].id}),e.loadDepartmentMembers(s[0].id)}e.setState({isTopDepartmentLoading:!1})}))}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.rootNodes,s=t.operateNode,r=t.checkedDepartmentId,a=t.isAddDepartmentDialogShow,i=t.isAddMembersDialogShow,l=t.membersList,c=t.isMembersListLoading,d=t.isTopDepartmentLoading,u=t.isRenameDepartmentDialogShow,p=t.isDeleteDepartmentDialogShow,g=t.sortBy,f=t.sortOrder;return(0,m.jsxs)(o.Fragment,{children:[(0,m.jsx)(N,{}),(0,m.jsx)("div",{className:"main-panel-center",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)("div",{className:"cur-view-path",children:(0,m.jsx)("h3",{className:"sf-heading",children:(0,h.AP)("Departments")})}),(0,m.jsxs)("div",{className:"cur-view-content d-flex flex-row p-0",children:[d&&(0,m.jsx)(R.A,{}),!d&&n.length>0&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(On,{rootNodes:n,checkedDepartmentId:r,onChangeDepartment:this.onChangeDepartment,listSubDepartments:this.listSubDepartments,toggleAddDepartment:this.toggleAddDepartment,toggleSetQuotaDialog:this.toggleSetQuotaDialog,toggleAddLibrary:this.toggleAddLibrary,toggleAddMembers:this.toggleAddMembers,toggleRename:this.toggleRename,toggleDelete:this.toggleDelete}),(0,m.jsx)(Fn,{rootNodes:n,checkedDepartmentId:r,membersList:l,isMembersListLoading:c,isAddNewRepo:this.state.isAddNewRepo,setMemberStaff:this.setMemberStaff,deleteMember:this.deleteMember,sortItems:this.sortItems,sortBy:g,sortOrder:f,getRepos:this.getRepos,deleteGroup:this.deleteGroup,createGroup:this.createGroup,toggleAddDepartment:this.toggleAddDepartment,toggleSetQuotaDialog:this.toggleSetQuotaDialog,toggleAddLibrary:this.toggleAddLibrary,toggleAddMembers:this.toggleAddMembers,toggleRename:this.toggleRename,toggleDelete:this.toggleDelete})]}),!d&&0===n.length&&(0,m.jsx)("div",{className:"top-department-button-container h-100 w-100",children:(0,m.jsx)(P.A,{onClick:this.toggleAddDepartment.bind(this,null),children:(0,h.AP)("Enable departments feature")})})]})]})}),i&&(0,m.jsx)(wn.A,{orgID:h.Id,toggle:this.toggleAddMembers,nodeId:s.id,onMemberChanged:this.onMemberChanged}),u&&(0,m.jsx)(Dn.A,{orgID:h.Id,node:s,toggle:this.toggleRename,renameDepartment:this.renameDepartment}),p&&(0,m.jsx)(bn.A,{node:s,toggle:this.toggleDelete,onDelete:this.onDelete}),a&&(0,m.jsx)(Nn.A,{parentNode:s,toggle:this.toggleAddDepartment,addDepartment:this.addDepartment,setRootNode:this.setRootNode,orgID:h.Id}),this.state.isShowAddRepoDialog&&(0,m.jsx)(Pn,{toggle:this.toggleAddLibrary,onAddNewRepo:function(){e.setState({isAddNewRepo:!e.state.isAddNewRepo})},groupID:String(s.id)}),this.state.isSetQuotaDialogShow&&(0,m.jsx)(yn,{group:s,onSetQuota:this.onSetQuota,toggle:this.toggleSetQuotaDialog})]})}}])}(o.Component)),zn=n(71361),Yn=n(61599),qn=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).downloadExcel=function(){if(n.isValidDateStr())switch(n.props.logType){case"fileaudit":n.orgAdminExportLogs("fileaudit");break;case"file-update":n.orgAdminExportLogs("fileupdate");break;case"perm-audit":n.orgAdminExportLogs("permaudit")}},n.queryIOStatus=function(e,t){zn.E.queryIOStatus(e).then((function(s){!0===s.data.is_finished?(n.setState({isShowIODialog:!1}),n.props.toggle(),location.href=h.Yc+"api/v2.1/org/admin/log/export-excel/?task_id="+e+"&log_type="+t):setTimeout((function(){n.queryIOStatus(e,t)}),1e3)})).catch((function(e){n.setState({isShowIODialog:!1}),n.props.toggle(),F.A.danger((0,h.AP)("Failed to export. Please check whether the size of table attachments exceeds the limit."))}))},n.orgAdminExportLogs=function(e){var t=n.state,s=t.startDateStr,r=t.endDateStr,a="";n.setState({isShowIODialog:!0},(function(){U.k.orgAdminExportLogsExcel(h.Id,s,r,e).then((function(e){return a=e.data.task_id,n.setState({taskId:a}),zn.E.queryIOStatus(a)})).then((function(t){!0===t.data.is_finished?(n.setState({isShowIODialog:!1}),n.props.toggle(),location.href=h.Yc+"api/v2.1/org/admin/log/export-excel/?task_id="+a+"&log_type="+e):n.queryIOStatus(a,e)})).catch((function(e){if(e.response&&500===e.response.status){var t=e.response.data?e.response.data.error_msg:null;t&&"Internal Server Error"!==t?F.A.danger(t):F.A.danger((0,h.AP)("Internal Server Error"))}else{var s=T.Aq.getErrorMsg(e);F.A.danger(s)}n.props.toggle()}))}))},n.isValidDateStr=function(){var e=n.state,t=e.startDateStr,s=e.endDateStr;return!!(A()(t,"YYYY-MM-DD",!0).isValid()&&A()(s,"YYYY-MM-DD",!0).isValid()&&A()(t).isBefore(s))||(n.setState({errMsg:(0,h.AP)("Date Invalid.")}),!1)},n.handleStartChange=function(e){var t=e.target.value.trim();n.setState({startDateStr:t,errMsg:""})},n.handleEndChange=function(e){var t=e.target.value.trim();n.setState({endDateStr:t,errMsg:""})},n.onExportToggle=function(e){n.setState({isShowIODialog:!n.state.isShowIODialog}),n.props.toggle()},n.state={loading:!0,startDateStr:"",endDateStr:"",errMsg:"",taskId:"",isShowIODialog:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){return(0,m.jsxs)(o.Fragment,{children:[!this.state.isShowIODialog&&(0,m.jsxs)(Fe.A,{isOpen:!0,toggle:this.props.toggle,autoFocus:!1,children:[(0,m.jsx)(qe.A,{toggle:this.props.toggle,children:(0,h.AP)("Choose date")}),(0,m.jsxs)(Ee.A,{children:[(0,m.jsxs)(Ge.A,{children:[(0,m.jsx)(He.A,{children:(0,h.AP)("Start date")}),(0,m.jsx)(q.A,{value:this.state.startDateStr,onChange:this.handleStartChange,placeholder:"yyyy-mm-dd",autoFocus:!0})]}),(0,m.jsxs)(Ge.A,{children:[(0,m.jsx)(He.A,{children:(0,h.AP)("End date")}),(0,m.jsx)(q.A,{value:this.state.endDateStr,onChange:this.handleEndChange,placeholder:"yyyy-mm-dd"})]}),this.state.errMsg&&(0,m.jsx)(ze.A,{className:"mt-2",color:"danger",children:(0,h.AP)(this.state.errMsg)})]}),(0,m.jsxs)(Ye.A,{children:[(0,m.jsx)(P.A,{color:"secondary",onClick:this.props.toggle,children:(0,h.AP)("Cancel")}),(0,m.jsx)(P.A,{color:"primary",onClick:this.downloadExcel,children:(0,h.AP)("Submit")})]})]}),this.state.isShowIODialog&&(0,m.jsx)(Yn.A,{toggle:this.onExportToggle})]})}}])}(o.Component),Bn=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).toggleExportExcelDialog=function(){n.setState({isExportExcelDialogOpen:!n.state.isExportExcelDialogOpen})},n.tabItemClick=function(e){n.setState({logType:e}),n.props.tabItemClick(e)},n.state={isExportExcelDialogOpen:!1,logType:""},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){var e=window.location.href.split("/"),t=e[e.length-2];"logadmin"===t&&(t="fileaudit"),this.setState({logType:t})}},{key:"render",value:function(){var e=this,t=this.state,n=t.isExportExcelDialogOpen,s=t.logType;return(0,m.jsxs)(o.Fragment,{children:["repo-transfer"===this.props.currentTab||"group-member-audit"===this.props.currentTab?(0,m.jsx)(N,{}):(0,m.jsx)(N,{children:(0,m.jsx)(P.A,{className:"btn btn-secondary operation-item",onClick:this.toggleExportExcelDialog,children:(0,h.AP)("Export Excel")})}),(0,m.jsx)("div",{className:"main-panel-center flex-row",children:(0,m.jsxs)("div",{className:"cur-view-container h-100",children:[(0,m.jsx)("div",{className:"cur-view-path org-user-nav",children:(0,m.jsxs)("ul",{className:"nav",children:[(0,m.jsx)("li",{className:"nav-item",onClick:function(){return e.tabItemClick("fileaudit")},children:(0,m.jsx)(c.N_,{className:"nav-link ".concat("fileaudit"===this.props.currentTab?"active":""),to:h.Yc+"org/logadmin/",title:(0,h.AP)("File Access"),children:(0,h.AP)("File Access")})}),(0,m.jsx)("li",{className:"nav-item",onClick:function(){return e.tabItemClick("file-update")},children:(0,m.jsx)(c.N_,{className:"nav-link ".concat("file-update"===this.props.currentTab?"active":""),to:h.Yc+"org/logadmin/file-update/",title:(0,h.AP)("File Update"),children:(0,h.AP)("File Update")})}),(0,m.jsx)("li",{className:"nav-item",onClick:function(){return e.tabItemClick("perm-audit")},children:(0,m.jsx)(c.N_,{className:"nav-link ".concat("perm-audit"===this.props.currentTab?"active":""),to:h.Yc+"org/logadmin/perm-audit/",title:(0,h.AP)("Permission"),children:(0,h.AP)("Permission")})}),(0,m.jsx)("li",{className:"nav-item",onClick:function(){return e.tabItemClick("repo-transfer")},children:(0,m.jsx)(c.N_,{className:"nav-link ".concat("repo-transfer"===this.props.currentTab?"active":""),to:h.Yc+"org/logadmin/repo-transfer/",title:(0,h.AP)("Repo Transfer"),children:(0,h.AP)("Repo Transfer")})}),(0,m.jsx)("li",{className:"nav-item",onClick:function(){return e.tabItemClick("group-member-audit")},children:(0,m.jsx)(c.N_,{className:"nav-link ".concat("group-member-audit"===this.props.currentTab?"active":""),to:h.Yc+"org/logadmin/group-member-audit/",title:(0,h.AP)("Group Invite"),children:(0,h.AP)("Group Invite")})})]})}),(0,m.jsx)("div",{className:"h-100 o-auto",children:this.props.children})]})}),n&&(0,m.jsx)(Te.A,{children:(0,m.jsx)(qn,{logType:s,toggle:this.toggleExportExcelDialog})})]})}}])}(o.Component);A().locale(h.vV);var Vn=(0,r.default)((function e(t){(0,s.default)(this,e),this.ip=t.ip,this.type=t.type,this.device=t.device,this.repo_id=t.repo_id,this.repo_name=t.repo_name,this.file_name=t.file_name,this.file_path=t.file_path,this.user_name=t.user_name,this.user_email=t.user_email,this.user_contact_email=t.user_contact_email,this.time=A()(t.time).format("YYYY-MM-DD HH:mm:ss")}));A().locale(h.vV);var Gn=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).initData=function(e,t,s){U.k.orgAdminListFileAudit(e,t,s).then((function(e){var t=e.data.log_list.map((function(e){return new Vn(e)}));n.setState({eventList:t,pageNext:e.data.page_next,page:e.data.page,userSelected:e.data.user_selected,repoSelected:e.data.repo_selected})})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.onChangePageNum=function(e,t){e.preventDefault();var s=n.state.page;1==t?s+=1:s-=1;var r=n.state.userSelected,a=n.state.repoSelected;n.initData(r,a,s)},n.filterUser=function(e){n.setState({userSelected:e})},n.filterRepo=function(e){n.setState({repoSelected:e})},n.state={page:1,pageNext:!1,eventList:[],userSelected:"",repoSelected:"",isItemFreezed:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){var e=this.state.page,t=this.state.userSelected,n=this.state.repoSelected;this.initData(t,n,e)}},{key:"render",value:function(){var e=this,t=this.state.eventList;return(0,m.jsxs)("div",{className:"cur-view-content",children:[(this.state.userSelected||this.state.repoSelected)&&(0,m.jsxs)(o.Fragment,{children:[this.state.userSelected&&(0,m.jsxs)("span",{className:"audit-unselect-item",onClick:this.filterUser.bind(this,null),children:[(0,m.jsx)("span",{className:"no-deco",children:this.state.userSelected})," \u2716"]}),this.state.repoSelected&&(0,m.jsxs)("span",{className:"audit-unselect-item",onClick:this.filterRepo.bind(this,null),children:[(0,m.jsx)("span",{className:"no-deco",children:this.state.repoSelected})," \u2716"]})]}),(0,m.jsxs)("table",{children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"24%",children:(0,h.AP)("User")}),(0,m.jsx)("th",{width:"10%",children:(0,h.AP)("Type")}),(0,m.jsx)("th",{width:"13%",children:(0,h.AP)("IP")}),(0,m.jsx)("th",{width:"17%",children:(0,h.AP)("Date")}),(0,m.jsx)("th",{width:"18%",children:(0,h.AP)("Library")}),(0,m.jsx)("th",{width:"18%",children:(0,h.AP)("File")})]})}),(0,m.jsx)("tbody",{children:t.map((function(t,n){return(0,m.jsx)(Hn,{fileEvent:t,isItemFreezed:e.state.isItemFreezed,filterUser:e.filterUser,filterRepo:e.filterRepo,userSelected:e.state.userSelected,repoSelected:e.state.repoSelected},n)}))})]}),(0,m.jsxs)("div",{className:"paginator",children:[1!=this.state.page&&(0,m.jsx)("a",{href:"#",onClick:function(t){return e.onChangePageNum(t,-1)},children:(0,h.AP)("Previous")}),1!=this.state.page&&this.state.pageNext&&(0,m.jsx)("span",{children:" | "}),this.state.pageNext&&(0,m.jsx)("a",{href:"#",onClick:function(t){return e.onChangePageNum(t,1)},children:(0,h.AP)("Next")})]})]})}}])}(o.Component),Hn=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).onMouseEnter=function(){n.props.isItemFreezed||n.setState({showMenu:!0,highlight:!0})},n.onMouseLeave=function(){n.props.isItemFreezed||n.setState({showMenu:!1,highlight:!1})},n.toggleUserDropdown=function(){n.setState({userDropdownOpen:!n.state.userDropdownOpen})},n.renderUser=function(e){return e.user_email?(0,m.jsxs)("span",{children:[(0,m.jsx)("a",{href:h.Yc+"org/useradmin/info/"+e.user_email+"/",children:e.user_name})," ",(0,m.jsxs)(Ie.A,{size:"sm",isOpen:n.state.userDropdownOpen,toggle:n.toggleUserDropdown,className:n.state.highlight?"":"vh",tag:"span",children:[(0,m.jsx)(_e.A,{tag:"i",className:"op-icon sf-dropdown-toggle sf3-font-more sf3-font"}),(0,m.jsx)(Ce.A,{children:(0,m.jsxs)(Me.A,{onClick:n.props.filterUser.bind(n,e.user_email),children:[(0,h.AP)("Only Show")," ",(0,m.jsx)("span",{className:"font-weight-bold",children:e.user_name})]})})]})]}):(0,h.AP)("Anonymous User")},n.renderType=function(e){return-1!=e.indexOf("web")&&(e="web"),-1!=e.indexOf("api")&&(e="api"),-1!=e.indexOf("share-link")&&(e="share link"),e},n.toggleRepoDropdown=function(){n.setState({repoDropdownOpen:!n.state.repoDropdownOpen})},n.renderRepo=function(e){var t="Deleted";return e.repo_name&&(t=e.repo_name),(0,m.jsxs)("span",{children:[(0,m.jsx)("span",{children:t}),e.repo_name&&(0,m.jsxs)(Ie.A,{size:"sm",isOpen:n.state.repoDropdownOpen,toggle:n.toggleRepoDropdown,className:n.state.highlight?"":"vh",children:[(0,m.jsx)(_e.A,{tag:"i",className:"op-icon sf-dropdown-toggle sf3-font-more sf3-font"}),(0,m.jsx)(Ce.A,{children:(0,m.jsxs)(Me.A,{size:"sm",onClick:n.props.filterRepo.bind(n,e.repo_name),children:[(0,h.AP)("Only Show")," ",(0,m.jsx)("span",{className:"font-weight-bold",children:e.repo_name})]})})]})]})},n.state={highlight:!1,showMenu:!1,isItemMenuShow:!1,userDropdownOpen:!1,repoDropdownOpen:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props.fileEvent;return this.props.userSelected&&e.user_email!==this.props.userSelected||this.props.repoSelected&&e.repo_name!==this.props.repoSelected?null:(0,m.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[(0,m.jsx)("td",{children:this.renderUser(e)}),(0,m.jsx)("td",{children:this.renderType(e.type)}),(0,m.jsx)("td",{children:e.ip}),(0,m.jsx)("td",{children:A()(e.time).format("YYYY-MM-DD HH:mm:ss")}),(0,m.jsx)("td",{children:this.renderRepo(e)}),(0,m.jsx)("td",{children:(0,m.jsx)("span",{title:e.file_path,children:e.file_name})})]})}}])}(o.Component),Qn=Gn;A().locale(h.vV);var Wn=(0,r.default)((function e(t){(0,s.default)(this,e),this.repo_id=t.repo_id,this.description=t.description,this.repo_name=t.repo_name,this.user_name=t.user_name,this.user_email=t.user_email,this.repo_encrypted=t.repo_encrypted,this.repo_commit_id=t.repo_commit_id,this.user_contact_email=t.user_contact_email,this.time=A()(t.time).format("YYYY-MM-DD HH:mm:ss")})),Kn=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).renderContentItem=function(e){var t="";t+='<ul class="list-group list-group-flush">';for(var n=0,s=e.length;n<s;n++)t+='<li class="list-group-item">'+e[n]+"</li>";return{__html:t+="</ul>"}},n.renderContent=function(){return n.state.newfile.length>0?(0,m.jsxs)("div",{children:[(0,m.jsx)("h4",{children:(0,h.AP)("New files")}),(0,m.jsx)("p",{children:n.state.time}),(0,m.jsx)("div",{dangerouslySetInnerHTML:n.renderContentItem(n.state.newfile)})]}):n.state.removed.length>0?(0,m.jsxs)("div",{children:[(0,m.jsx)("h4",{children:(0,h.AP)("Deleted files")}),(0,m.jsx)("p",{children:n.state.time}),(0,m.jsx)("div",{dangerouslySetInnerHTML:n.renderContentItem(n.state.removed)})]}):n.state.renamed.length>0?(0,m.jsxs)("div",{children:[(0,m.jsx)("h4",{children:(0,h.AP)("Renamed or Moved files")}),(0,m.jsx)("p",{children:n.state.time}),(0,m.jsx)("div",{dangerouslySetInnerHTML:n.renderContentItem(n.state.renamed)})]}):n.state.modified.length>0?(0,m.jsxs)("div",{children:[(0,m.jsx)("h4",{children:(0,h.AP)("Modified files")}),(0,m.jsx)("p",{children:n.state.time}),(0,m.jsx)("div",{dangerouslySetInnerHTML:n.renderContentItem(n.state.modified)})]}):n.state.newdir.length>0?(0,m.jsxs)("div",{children:[(0,m.jsx)("h4",{children:(0,h.AP)("New directories")}),(0,m.jsx)("p",{children:n.state.time}),(0,m.jsx)("div",{dangerouslySetInnerHTML:n.renderContentItem(n.state.newdir)})]}):n.state.deldir.length>0?(0,m.jsxs)("div",{children:[(0,m.jsx)("h4",{children:(0,h.AP)("Deleted directories")}),(0,m.jsx)("p",{children:n.state.time}),(0,m.jsx)("div",{dangerouslySetInnerHTML:n.renderContentItem(n.state.deldir)})]}):void 0},n.state={time:"",renamed:[],deldir:[],modified:[],newdir:[],newfile:[],removed:[]},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){var e=this;U.k.orgAdminGetFileUpdateDetail(this.props.repoID,this.props.commitID).then((function(t){e.setState({time:t.data.date_time,renamed:e.state.renamed.concat(t.data.renamed),deldir:e.state.deldir.concat(t.data.deldir),modified:e.state.modified.concat(t.data.modified),newdir:e.state.newdir.concat(t.data.newdir),newfile:e.state.newfile.concat(t.data.new),removed:e.state.removed.concat(t.data.removed)})})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))}},{key:"render",value:function(){return(0,m.jsxs)(Fe.A,{isOpen:!0,toggle:this.props.toggleCancel,children:[(0,m.jsx)(qe.A,{toggle:this.props.toggleCancel,children:(0,h.AP)("Modification Details")}),(0,m.jsx)(Ee.A,{children:this.renderContent()})]})}}])}(o.Component);A().locale(h.vV);var Xn=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).initData=function(e,t,s){U.k.orgAdminListFileUpdate(e,t,s).then((function(e){var t=e.data.log_list.map((function(e){return new Wn(e)}));n.setState({eventList:t,pageNext:e.data.page_next,page:e.data.page})})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.onChangePageNum=function(e,t){e.preventDefault();var s=n.state.page;1==t?s+=1:s-=1;var r=n.state.userSelected,a=n.state.repoSelected;n.initData(r,a,s)},n.toggleCancelDetail=function(){n.setState({showDetails:!n.state.showDetails})},n.onDetails=function(e,t){e.preventDefault(),n.setState({showDetails:!n.state.showDetails,repoID:t.repo_id,commitID:t.repo_commit_id})},n.filterUser=function(e){n.setState({userSelected:e})},n.filterRepo=function(e){n.setState({repoSelected:e})},n.state={page:1,pageNext:!1,eventList:[],userSelected:"",repoSelected:"",isItemFreezed:!1,showDetails:!1,repoID:"",commitID:""},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){var e=this.state.page,t=this.state.userSelected,n=this.state.repoSelected;this.initData(t,n,e)}},{key:"render",value:function(){var e=this,t=this.state.eventList;return(0,m.jsxs)("div",{className:"cur-view-content",children:[(this.state.userSelected||this.state.repoSelected)&&(0,m.jsxs)(o.Fragment,{children:[this.state.userSelected&&(0,m.jsxs)("span",{className:"audit-unselect-item",onClick:this.filterUser.bind(this,null),children:[(0,m.jsx)("span",{className:"no-deco",children:this.state.userSelected})," \u2716"]}),this.state.repoSelected&&(0,m.jsxs)("span",{className:"audit-unselect-item",onClick:this.filterRepo.bind(this,null),children:[(0,m.jsx)("span",{className:"no-deco",children:this.state.repoSelected})," \u2716"]})]}),(0,m.jsxs)("table",{children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"25%",children:(0,h.AP)("User")}),(0,m.jsx)("th",{width:"17%",children:(0,h.AP)("Date")}),(0,m.jsx)("th",{width:"25%",children:(0,h.AP)("Library")}),(0,m.jsx)("th",{width:"33%",children:(0,h.AP)("Action")})]})}),(0,m.jsx)("tbody",{children:t.map((function(t,n){return(0,m.jsx)($n,{fileEvent:t,isItemFreezed:e.state.isItemFreezed,onDetails:e.onDetails,filterUser:e.filterUser,filterRepo:e.filterRepo,userSelected:e.state.userSelected,repoSelected:e.state.repoSelected},n)}))})]}),(0,m.jsxs)("div",{className:"paginator",children:[1!=this.state.page&&(0,m.jsx)("a",{href:"#",onClick:function(t){return e.onChangePageNum(t,-1)},children:(0,h.AP)("Previous")}),1!=this.state.page&&this.state.pageNext&&(0,m.jsx)("span",{children:" | "}),this.state.pageNext&&(0,m.jsx)("a",{href:"#",onClick:function(t){return e.onChangePageNum(t,1)},children:(0,h.AP)("Next")})]}),this.state.showDetails&&(0,m.jsx)(Te.A,{children:(0,m.jsx)(Kn,{repoID:this.state.repoID,commitID:this.state.commitID,toggleCancel:this.toggleCancelDetail})})]})}}])}(o.Component),$n=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).onMouseEnter=function(){n.props.isItemFreezed||n.setState({showMenu:!0,highlight:!0})},n.onMouseLeave=function(){n.props.isItemFreezed||n.setState({showMenu:!1,highlight:!1})},n.toggleUserDropdown=function(){n.setState({userDropdownOpen:!n.state.userDropdownOpen})},n.renderUser=function(e){return e.user_email?(0,m.jsxs)("span",{children:[(0,m.jsx)("a",{href:h.Yc+"org/useradmin/info/"+e.user_email+"/",children:e.user_name})," ",(0,m.jsxs)(Ie.A,{size:"sm",isOpen:n.state.userDropdownOpen,toggle:n.toggleUserDropdown,className:n.state.highlight?"":"vh",tag:"span",children:[(0,m.jsx)(_e.A,{tag:"i",className:"op-icon sf-dropdown-toggle sf3-font-more sf3-font"}),(0,m.jsx)(Ce.A,{children:(0,m.jsxs)(Me.A,{onClick:n.props.filterUser.bind(n,e.user_email),children:[(0,h.AP)("Only Show")," ",(0,m.jsx)("span",{className:"font-weight-bold",children:e.user_name})]})})]})]}):(0,h.AP)("Anonymous User")},n.toggleRepoDropdown=function(){n.setState({repoDropdownOpen:!n.state.repoDropdownOpen})},n.renderRepo=function(e){var t="Deleted";return e.repo_name&&(t=e.repo_name),(0,m.jsxs)("span",{children:[(0,m.jsx)("span",{children:t}),e.repo_name&&(0,m.jsxs)(Ie.A,{size:"sm",isOpen:n.state.repoDropdownOpen,toggle:n.toggleRepoDropdown,className:n.state.highlight?"":"vh",children:[(0,m.jsx)(_e.A,{tag:"i",className:"op-icon sf-dropdown-toggle sf3-font-more sf3-font"}),(0,m.jsx)(Ce.A,{children:(0,m.jsxs)(Me.A,{size:"sm",onClick:n.props.filterRepo.bind(n,e.repo_name),children:[(0,h.AP)("Only Show")," ",(0,m.jsx)("span",{className:"font-weight-bold",children:e.repo_name})]})})]})]})},n.renderAction=function(e){return e.repo_encrypted||!e.repo_id?(0,m.jsx)("td",{children:e.description}):(0,m.jsxs)("td",{children:[e.description,(0,m.jsx)("a",{className:"font-weight-normal text-muted ml-1",href:"#",onClick:function(t){return n.props.onDetails(t,e)},children:(0,h.AP)("Details")})]})},n.state={highlight:!1,showMenu:!1,isItemMenuShow:!1,userDropdownOpen:!1,repoDropdownOpen:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props.fileEvent;return this.props.userSelected&&e.user_email!==this.props.userSelected||this.props.repoSelected&&e.repo_name!==this.props.repoSelected?null:(0,m.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[(0,m.jsx)("td",{children:this.renderUser(e)}),(0,m.jsx)("td",{children:A()(e.time).format("YYYY-MM-DD HH:mm:ss")}),(0,m.jsx)("td",{children:this.renderRepo(e)}),this.renderAction(e)]})}}])}(o.Component),Jn=Xn;A().locale(h.vV);var Zn=(0,r.default)((function e(t){(0,s.default)(this,e),this.from_user_name=t.from_user_name,this.from_user_email=t.from_user_email,this.from_user_contact_email=t.from_user_contact_email,this.to_user_email=t.to_user_email,this.to_user_name=t.to_user_name,this.to_user_contact_email=t.to_user_contact_email,this.to_group_name=t.to_group_name,this.to_group_id=t.to_group_id,this.type=t.type,this.repo_id=t.repo_id,this.repo_name=t.repo_name,this.folder_name=t.folder_name,this.folder_path=t.folder_path,this.time=A()(t.time).format("YYYY-MM-DD HH:mm:ss"),this.permission=t.permission}));A().locale(h.vV);var es=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).initData=function(e,t,s){U.k.orgAdminListPermAudit(e,t,s).then((function(e){var t=e.data.log_list.map((function(e){return new Zn(e)}));n.setState({eventList:t,pageNext:e.data.page_next,page:e.data.page})})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.onChangePageNum=function(e,t){e.preventDefault();var s=n.state.page;1==t?s+=1:s-=1,n.initData(s)},n.filterUser=function(e){n.setState({userSelected:e})},n.state={page:1,pageNext:!1,eventList:[],userSelected:"",repoSelected:"",isItemFreezed:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){var e=this.state.page,t=this.state.userSelected,n=this.state.repoSelected;this.initData(t,n,e)}},{key:"render",value:function(){var e=this,t=this.state.eventList;return(0,m.jsxs)("div",{className:"cur-view-content",children:[this.state.userSelected&&(0,m.jsxs)("span",{className:"audit-unselect-item",onClick:this.filterUser.bind(this,null),children:[(0,m.jsx)("span",{className:"no-deco",children:this.state.userSelected})," \u2716"]}),(0,m.jsxs)("table",{children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"18%",children:(0,h.AP)("Share From")}),(0,m.jsx)("th",{width:"15%",children:(0,h.AP)("Share To")}),(0,m.jsx)("th",{width:"8%",children:(0,h.AP)("Actions")}),(0,m.jsx)("th",{width:"13%",children:(0,h.AP)("Permission")}),(0,m.jsx)("th",{width:"15%",children:(0,h.AP)("Library")}),(0,m.jsx)("th",{width:"15%",children:(0,h.AP)("Folder")}),(0,m.jsx)("th",{width:"16%",children:(0,h.AP)("Date")})]})}),(0,m.jsx)("tbody",{children:t.map((function(t,n){return(0,m.jsx)(ts,{permEvent:t,isItemFreezed:e.state.isItemFreezed,filterUser:e.filterUser,userSelected:e.state.userSelected},n)}))})]}),(0,m.jsxs)("div",{className:"paginator",children:[1!=this.state.page&&(0,m.jsx)("a",{href:"#",onClick:function(t){return e.onChangePageNum(t,-1)},children:(0,h.AP)("Previous")}),1!=this.state.page&&this.state.pageNext&&(0,m.jsx)("span",{children:" | "}),this.state.pageNext&&(0,m.jsx)("a",{href:"#",onClick:function(t){return e.onChangePageNum(t,1)},children:(0,h.AP)("Next")})]})]})}}])}(o.Component),ts=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).onMouseEnter=function(){n.props.isItemFreezed||n.setState({showMenu:!0,highlight:!0})},n.onMouseLeave=function(){n.props.isItemFreezed||n.setState({showMenu:!1,highlight:!1})},n.renderFromUser=function(e){return e.from_user_email?(0,m.jsxs)("span",{children:[(0,m.jsx)("a",{href:h.Yc+"org/useradmin/info/"+e.from_user_email+"/",children:e.from_user_name})," ",(0,m.jsxs)(Ie.A,{size:"sm",isOpen:n.state.userDropdownOpen,toggle:n.toggleUserDropdown,className:n.state.highlight?"":"vh",tag:"span",children:[(0,m.jsx)(_e.A,{tag:"i",className:"op-icon sf-dropdown-toggle sf3-font-more sf3-font"}),(0,m.jsx)(Ce.A,{children:(0,m.jsxs)(Me.A,{onClick:n.props.filterUser.bind(n,e.from_user_email),children:[(0,h.AP)("Only Show")," ",(0,m.jsx)("span",{className:"font-weight-bold",children:e.from_user_name})]})})]})]}):(0,h.AP)("Anonymous User")},n.toggleUserDropdown=function(){n.setState({userDropdownOpen:!n.state.userDropdownOpen})},n.renderToUser=function(e){return-1!=e.type.indexOf("public")?(0,m.jsx)("a",{href:h.Yc+"org/",children:(0,h.AP)("Organization")}):-1!=e.type.indexOf("group")?e.to_group_name?(0,m.jsx)("a",{href:h.Yc+"org/groupadmin/"+e.to_group_id+"/",children:e.to_group_name}):"Deleted":-1!=e.type.indexOf("user")?(0,m.jsx)("a",{href:h.Yc+"org/useradmin/info/"+e.to_user_email+"/",children:e.to_user_name}):void 0},n.renderType=function(e){return-1!=e.indexOf("add")&&(e="Add"),-1!=e.indexOf("modify")&&(e="Modify"),-1!=e.indexOf("delete")&&(e="Delete"),e},n.renderRepo=function(e){var t="Deleted";return e.repo_name&&(t=e.repo_name),t},n.renderFolder=function(e){var t="/";return e&&(t=e),t},n.state={highlight:!1,showMenu:!1,isItemMenuShow:!1,userDropdownOpen:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props.permEvent;return this.props.userSelected&&e.from_user_email!==this.props.userSelected?null:(0,m.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[(0,m.jsx)("td",{children:this.renderFromUser(e)}),(0,m.jsx)("td",{children:this.renderToUser(e)}),(0,m.jsx)("td",{children:this.renderType(e.type)}),(0,m.jsx)("td",{children:T.Aq.sharePerms(e.permission)}),(0,m.jsx)("td",{children:this.renderRepo(e)}),(0,m.jsx)("td",{children:this.renderFolder(e.folder_name)}),(0,m.jsx)("td",{children:A()(e.time).format("YYYY-MM-DD HH:mm:ss")})]})}}])}(o.Component),ns=es;A().locale(h.vV);var ss=(0,r.default)((function e(t){(0,s.default)(this,e),this.from_group_id=t.from_group_id,this.from_group_name=t.from_group_name,this.from_type=t.from_type,this.from_user_contact_email=t.from_user_contact_email,this.from_user_email=t.from_user_email,this.from_user_name=t.from_user_name,this.repo_id=t.repo_id,this.repo_name=t.repo_name,this.to_group_id=t.to_group_id,this.to_group_name=t.to_group_name,this.to_type=t.to_type,this.to_user_contact_email=t.to_user_contact_email,this.to_user_email=t.to_user_email,this.to_user_name=t.to_user_name,this.operator_email=t.operator_email,this.operator_name=t.operator_name,this.operator_contact_email=t.operator_contact_email,this.time=A()(t.date).format("YYYY-MM-DD HH:mm:ss")}));A().locale(h.vV);var rs=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).initData=function(e,t){U.k.orgAdminListFileTransfer(e,t).then((function(e){var t=e.data.log_list.map((function(e){return new ss(e)}));n.setState({eventList:t,pageNext:e.data.page_next,page:e.data.page})})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.onChangePageNum=function(e,t){e.preventDefault();var s=n.state.page,r=n.state.perPage;1==t?s+=1:s-=1,n.initData(s,r)},n.state={page:1,perPage:25,pageNext:!1,eventList:[],isItemFreezed:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){var e=this.state.page,t=this.state.perPage;this.initData(e,t)}},{key:"render",value:function(){var e=this,t=this.state.eventList;return(0,m.jsxs)("div",{className:"cur-view-content",children:[(0,m.jsxs)("table",{children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"20%",children:(0,h.AP)("Transfer From")}),(0,m.jsx)("th",{width:"20%",children:(0,h.AP)("Transfer To")}),(0,m.jsx)("th",{width:"20%",children:(0,h.AP)("Operator")}),(0,m.jsx)("th",{width:"25%",children:(0,h.AP)("Library")}),(0,m.jsx)("th",{width:"15%",children:(0,h.AP)("Date")})]})}),(0,m.jsx)("tbody",{children:t.map((function(t,n){return(0,m.jsx)(as,{fileEvent:t,isItemFreezed:e.state.isItemFreezed},n)}))})]}),(0,m.jsxs)("div",{className:"paginator",children:[1!=this.state.page&&(0,m.jsx)("a",{href:"#",onClick:function(t){return e.onChangePageNum(t,-1)},children:(0,h.AP)("Previous")}),1!=this.state.page&&this.state.pageNext&&(0,m.jsx)("span",{children:" | "}),this.state.pageNext&&(0,m.jsx)("a",{href:"#",onClick:function(t){return e.onChangePageNum(t,1)},children:(0,h.AP)("Next")})]})]})}}])}(o.Component),as=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).onMouseEnter=function(){n.props.isItemFreezed||n.setState({showMenu:!0,highlight:!0})},n.onMouseLeave=function(){n.props.isItemFreezed||n.setState({showMenu:!1,highlight:!1})},n.getTransferTo=function(e){switch(e.to_type){case"user":return(0,m.jsx)(ue,{email:e.to_user_email,name:e.to_user_name});case"group":return(0,m.jsx)(c.N_,{to:"".concat(h.Yc,"org/groupadmin/").concat(e.to_group_id,"/"),children:e.to_group_name});default:return(0,h.AP)("Deleted")}},n.getTransferFrom=function(e){switch(e.from_type){case"user":return(0,m.jsx)(ue,{email:e.from_user_email,name:e.from_user_name});case"group":return(0,m.jsx)(c.N_,{to:"".concat(h.Yc,"org/groupadmin/").concat(e.from_group_id,"/"),children:e.from_group_name});default:return(0,h.AP)("Deleted")}},n.getOperator=function(e){return(0,m.jsx)(ue,{email:e.operator_email,name:e.operator_name})},n.state={highlight:!1,showMenu:!1,isItemMenuShow:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props.fileEvent;return(0,m.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[(0,m.jsx)("td",{children:this.getTransferFrom(e)}),(0,m.jsx)("td",{children:this.getTransferTo(e)}),(0,m.jsx)("td",{children:this.getOperator(e)}),(0,m.jsx)("td",{children:e.repo_name?e.repo_name:(0,h.AP)("Deleted")}),(0,m.jsx)("td",{children:A()(e.time).fromNow()})]})}}])}(o.Component),is=rs;A().locale(h.vV);var os=(0,r.default)((function e(t){(0,s.default)(this,e),this.group_id=t.group_id,this.group_name=t.group_name,this.user_contact_email=t.user_contact_email,this.user_email=t.user_email,this.user_name=t.user_name,this.operator_email=t.operator_email,this.operator_name=t.operator_name,this.operator_contact_email=t.operator_contact_email,this.operation=t.operation,this.time=A()(t.date).format("YYYY-MM-DD HH:mm:ss")}));A().locale(h.vV);var ls=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).initData=function(e,t){U.k.orgAdminListGroupInvite(e,t).then((function(e){var t=e.data.log_list.map((function(e){return new os(e)}));n.setState({eventList:t,pageNext:e.data.page_next,page:e.data.page})})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.onChangePageNum=function(e,t){e.preventDefault();var s=n.state.page,r=n.state.perPage;1==t?s+=1:s-=1,n.initData(s,r)},n.state={page:1,perPage:25,pageNext:!1,eventList:[]},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){var e=this.state.page,t=this.state.perPage;this.initData(e,t)}},{key:"render",value:function(){var e=this,t=this.state.eventList;return(0,m.jsxs)("div",{className:"cur-view-content",children:[(0,m.jsxs)("table",{children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{width:"20%",children:(0,h.AP)("User")}),(0,m.jsx)("th",{width:"20%",children:(0,h.AP)("Group")}),(0,m.jsx)("th",{width:"20%",children:(0,h.AP)("Operator")}),(0,m.jsx)("th",{width:"20%",children:(0,h.AP)("Action")}),(0,m.jsx)("th",{width:"20%",children:(0,h.AP)("Date")})]})}),(0,m.jsx)("tbody",{children:t.map((function(e,t){return(0,m.jsx)(cs,{groupEvent:e},t)}))})]}),(0,m.jsxs)("div",{className:"paginator",children:[1!=this.state.page&&(0,m.jsx)("a",{href:"#",onClick:function(t){return e.onChangePageNum(t,-1)},children:(0,h.AP)("Previous")}),1!=this.state.page&&this.state.pageNext&&(0,m.jsx)("span",{children:" | "}),this.state.pageNext&&(0,m.jsx)("a",{href:"#",onClick:function(t){return e.onChangePageNum(t,1)},children:(0,h.AP)("Next")})]})]})}}])}(o.Component),cs=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).handleMouseOver=function(){n.setState({highlight:!0})},n.handleMouseOut=function(){n.setState({highlight:!1})},n.getActionTextByEType=function(e){return-1!=e.indexOf("group_member_add")?(0,h.AP)("Add member"):-1!=e.indexOf("group_member_delete")?(0,h.AP)("Delete member"):""},n.state={highlight:!1},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props.groupEvent;return(0,m.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,children:[(0,m.jsx)("td",{children:(0,m.jsx)(ue,{email:e.user_email,name:e.user_name})}),(0,m.jsx)("td",{children:(0,m.jsx)(c.N_,{to:"".concat(h.Yc,"org/groupadmin/").concat(e.group_id,"/"),children:e.group_name})}),(0,m.jsx)("td",{children:(0,m.jsx)(ue,{email:e.operator_email,name:e.operator_name})}),(0,m.jsx)("td",{children:this.getActionTextByEType(e.operation)}),(0,m.jsx)("td",{children:A()(e.time).fromNow()})]})}}])}(o.Component),ds=ls,us=n(97176),hs=n(67243),ps=n.n(hs),gs=function(e){function t(e){return(0,s.default)(this,t),(0,a.default)(this,t,[e])}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props,t=e.headingText,n=e.children;return(0,m.jsxs)("div",{className:"mb-4",children:[(0,m.jsx)("h4",{className:"border-bottom font-weight-normal mb-2 pb-1",children:t}),n]})}}])}(o.Component),ms=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).toggleBtns=function(){n.setState({isBtnsShown:!n.state.isBtnsShown})},n.hideBtns=function(){n.state.isBtnsShown&&(n.props.value!=n.state.value&&n.setState({value:n.props.value}),n.toggleBtns())},n.onInputChange=function(e){n.setState({value:e.target.value})},n.onSubmit=function(){var e=n.props.changeType,t=n.state.value.trim();t!=n.props.value&&n.props.changeValue(e,t),n.toggleBtns()},n.state={isBtnsShown:!1,value:n.props.value},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.setState({value:e.value})}},{key:"render",value:function(){var e=this.state,t=e.isBtnsShown,n=e.value,s=this.props.displayName,r=this.props.isCertificate?"textarea":"text";return(0,m.jsx)(o.Fragment,{children:(0,m.jsxs)(us.A,{className:"my-4",children:[(0,m.jsx)(et.A,{md:"3",children:(0,m.jsx)(He.A,{className:"web-setting-label",children:s})}),(0,m.jsxs)(et.A,{md:"5",children:[(0,m.jsxs)(Ae.A,{children:[(0,m.jsx)(q.A,{type:r,value:n,onChange:this.onInputChange,onFocus:this.toggleBtns,onBlur:this.hideBtns}),this.props.domainVerified&&(0,m.jsx)(P.A,{color:"success",className:"border-0",children:(0,h.AP)("Verified")})]}),this.props.isCertificate&&(0,m.jsxs)("p",{className:"small text-secondary mt-1",children:[(0,h.AP)("Copy the IdP's certificate and paste it here. The certificate format is as follows:"),(0,m.jsx)("br",{}),"-----BEGIN CERTIFICATE-----",(0,m.jsx)("br",{}),"xxxxxxxxxxxxxxxxxxxx",(0,m.jsx)("br",{}),"-----END CERTIFICATE-----"]})]}),(0,m.jsx)(et.A,{md:"4",children:t&&(0,m.jsxs)(o.Fragment,{children:[(0,m.jsx)(P.A,{color:"primary",className:"sf2-icon-tick web-setting-icon-btn web-setting-icon-btn-submit",onMouseDown:this.onSubmit,title:(0,h.AP)("Submit")}),(0,m.jsx)(P.A,{className:"ml-1 sf2-icon-x2 web-setting-icon-btn web-setting-icon-btn-cancel",title:(0,h.AP)("Cancel")})]})})]})})}}])}(o.Component),fs=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).updateSamlConfig=function(e,t){var s=null,r=null,a=null;"metadataUrl"===e&&(s=t),"domain"===e&&(r=t),"idpCertificate"===e&&(a=t),U.k.orgAdminUpdateSamlConfig(h.Id,s,r,a).then((function(e){n.setState({samlConfigID:e.data.saml_config.id,metadataUrl:e.data.saml_config.metadata_url,domain:e.data.saml_config.domain||"",dnsTxt:e.data.saml_config.dns_txt||"",domainVerified:e.data.saml_config.domain_verified||!1,idpCertificate:e.data.saml_config.idp_certificate||""}),F.A.success((0,h.AP)("SAML config updated"))})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.verifyDomain=function(){var e=n.state.domain;U.k.orgAdminVerifyDomain(h.Id,e).then((function(e){n.setState({domainVerified:e.data.domain_verified}),F.A.success((0,h.AP)("Domain verified"))})).catch((function(e){var t=T.Aq.getErrorMsg(e);F.A.danger(t)}))},n.onCopyValue=function(e){ps()(e),F.A.success((0,h.AP)("Copied"))},n.state={loading:!0,errorMsg:"",samlConfigID:"",metadataUrl:"",domain:"",dnsTxt:"",domainVerified:!1,idpCertificate:""},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){var e=this;U.k.orgAdminGetSamlConfig(h.Id).then((function(t){e.setState({loading:!1,samlConfigID:t.data.saml_config.id,metadataUrl:t.data.saml_config.metadata_url||"",domain:t.data.saml_config.domain||"",dnsTxt:t.data.saml_config.dns_txt||"",domainVerified:t.data.saml_config.domain_verified||!1,idpCertificate:t.data.saml_config.idp_certificate||""})})).catch((function(t){e.setState({loading:!1,errorMsg:T.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this.state,t=e.loading,n=e.errorMsg,s=e.metadataUrl,r=e.domain,a=e.dnsTxt,i=e.domainVerified,l=e.idpCertificate,c="".concat(h.xW,"/org/custom/").concat(h.Id,"/saml2/metadata/"),d="".concat(h.xW,"/org/custom/").concat(h.Id,"/saml2/acs/"),u="".concat(h.xW,"/org/custom/").concat(h.Id,"/saml2/ls/");return(0,m.jsxs)(o.Fragment,{children:[(0,m.jsx)(N,{}),(0,m.jsx)("div",{className:"main-panel-center flex-row",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)("div",{className:"cur-view-path",children:(0,m.jsx)("h3",{className:"sf-heading",children:(0,h.AP)("SAML config")})}),(0,m.jsxs)("div",{className:"cur-view-content container mw-100",children:[t&&(0,m.jsx)(R.A,{}),n&&(0,m.jsx)("p",{className:"error text-center mt-4",children:n}),!t&&!n&&(0,m.jsxs)(o.Fragment,{children:[(0,m.jsxs)(gs,{headingText:(0,h.AP)("Configure your Identity Provider"),children:[(0,m.jsx)("p",{className:"text-secondary mt-1",children:(0,h.AP)("Use these values to configure your Identity Provider")}),(0,m.jsxs)(o.Fragment,{children:[(0,m.jsxs)(us.A,{className:"my-4",children:[(0,m.jsx)(et.A,{md:"3",children:(0,m.jsx)(He.A,{className:"web-setting-label",children:"Identifier (Entity ID)"})}),(0,m.jsx)(et.A,{md:"5",children:(0,m.jsxs)(Ae.A,{children:[(0,m.jsx)(q.A,{type:"text",readOnly:!0,value:c}),(0,m.jsx)(P.A,{color:"primary",onClick:this.onCopyValue.bind(this,c),className:"border-0",children:(0,h.AP)("Copy")})]})})]}),(0,m.jsxs)(us.A,{className:"my-4",children:[(0,m.jsx)(et.A,{md:"3",children:(0,m.jsx)(He.A,{className:"web-setting-label",children:"Reply URL (Assertion Consumer Service URL)"})}),(0,m.jsx)(et.A,{md:"5",children:(0,m.jsxs)(Ae.A,{children:[(0,m.jsx)(q.A,{type:"text",readOnly:!0,value:d}),(0,m.jsx)(P.A,{color:"primary",onClick:this.onCopyValue.bind(this,d),className:"border-0",children:(0,h.AP)("Copy")})]})})]}),(0,m.jsxs)(us.A,{className:"my-4",children:[(0,m.jsx)(et.A,{md:"3",children:(0,m.jsx)(He.A,{className:"web-setting-label",children:"Sign on URL"})}),(0,m.jsx)(et.A,{md:"5",children:(0,m.jsxs)(Ae.A,{children:[(0,m.jsx)(q.A,{type:"text",readOnly:!0,value:h.xW}),(0,m.jsx)(P.A,{color:"primary",onClick:this.onCopyValue.bind(this,h.xW),className:"border-0",children:(0,h.AP)("Copy")})]})})]}),(0,m.jsxs)(us.A,{className:"my-4",children:[(0,m.jsx)(et.A,{md:"3",children:(0,m.jsx)(He.A,{className:"web-setting-label",children:"Logout URL"})}),(0,m.jsx)(et.A,{md:"5",children:(0,m.jsxs)(Ae.A,{children:[(0,m.jsx)(q.A,{type:"text",readOnly:!0,value:u}),(0,m.jsx)(P.A,{color:"primary",onClick:this.onCopyValue.bind(this,u),className:"border-0",children:(0,h.AP)("Copy")})]})})]})]})]}),(0,m.jsxs)(gs,{headingText:(0,h.AP)("Configure Seafile"),children:[(0,m.jsx)("p",{className:"text-secondary mt-1",children:(0,h.AP)("Use information from your Identity Provider to configure Seafile")}),(0,m.jsxs)(o.Fragment,{children:[(0,m.jsx)(ms,{value:s,changeType:"metadataUrl",changeValue:this.updateSamlConfig,displayName:"SAML App Federation Metadata URL"}),(0,m.jsx)(ms,{value:l,changeType:"idpCertificate",changeValue:this.updateSamlConfig,displayName:(0,h.AP)("Certificate"),isCertificate:!0})]})]}),(0,m.jsxs)(gs,{headingText:(0,h.AP)("Verify Domain"),children:[(0,m.jsx)("p",{className:"text-secondary mt-1",children:(0,h.AP)("Create a DNS TXT record to confirm the ownership of your Email Domain.")}),(0,m.jsxs)(o.Fragment,{children:[(0,m.jsx)(ms,{value:r,changeType:"domain",changeValue:this.updateSamlConfig,displayName:(0,h.AP)("Email Domain"),domainVerified:i}),(0,m.jsxs)(us.A,{className:"my-4",children:[(0,m.jsx)(et.A,{md:"3",children:(0,m.jsx)(He.A,{className:"web-setting-label",children:(0,h.AP)("DNS TXT Value")})}),(0,m.jsxs)(et.A,{md:"5",children:[(0,m.jsxs)(Ae.A,{children:[(0,m.jsx)(q.A,{type:"text",readOnly:!0,value:a}),a&&!i&&(0,m.jsx)(P.A,{color:"primary",onClick:this.onCopyValue.bind(this,a),className:"border-0",children:(0,h.AP)("Copy")})]}),a&&!i&&(0,m.jsx)("p",{className:"small text-secondary mt-1",children:(0,h.AP)("Copy the domain DNS TXT and add it to your domain's DNS records, then click the button to verify domain ownership. You must verify the ownership of domain before Single Sign-On.")})]}),(0,m.jsx)(et.A,{md:"4",children:r&&a&&!i&&(0,m.jsx)(P.A,{color:"secondary",onClick:this.verifyDomain,children:(0,h.AP)("Verify")})})]})]})]})]})]})]})})]})}}])}(o.Component),xs=n(7039),vs=function(e){function t(){return(0,s.default)(this,t),(0,a.default)(this,t,arguments)}return(0,i.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){return(0,m.jsxs)(o.Fragment,{children:[(0,m.jsx)(N,{onCloseSidePanel:this.props.onCloseSidePanel}),(0,m.jsx)("div",{className:"main-panel-center flex-row",children:(0,m.jsxs)("div",{className:"cur-view-container",children:[(0,m.jsx)("div",{className:"cur-view-path",children:(0,m.jsx)("h2",{className:"sf-heading",children:"\u4ed8\u8d39\u7ba1\u7406"})}),(0,m.jsx)("div",{className:"pt-2 h-100 o-auto",children:(0,m.jsx)(xs.A,{isOrgContext:!0})})]})})]})}}])}(o.Component),js=vs,As=(n(16322),n(18291),function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,a.default)(this,t,[e])).onCloseSidePanel=function(){n.setState({isSidePanelClosed:!n.state.isSidePanelClosed})},n.tabItemClick=function(e){n.setState({currentTab:e})},n.state={isSidePanelClosed:!1,currentTab:"users"},n}return(0,i.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){var e=window.location.href.split("/"),t=e[e.length-2];-1!=location.href.indexOf("".concat(h.Yc,"org/useradmin"))&&(t="users"),-1!=location.href.indexOf("".concat(h.Yc,"org/statistics-admin/"))&&(t="statistics-admin"),-1!=location.href.indexOf("".concat(h.Yc,"org/deviceadmin/"))&&(t="deviceadmin"),-1!=location.href.indexOf("".concat(h.Yc,"org/groupadmin"))&&(t="groupadmin"),-1!=location.href.indexOf("".concat(h.Yc,"org/departmentadmin"))&&(t="departmentadmin"),-1!=location.href.indexOf("".concat(h.Yc,"org/logadmin/"))&&"logadmin"===t&&(t="fileaudit"),this.setState({currentTab:t})}},{key:"render",value:function(){var e=this.state,t=e.isSidePanelClosed,n=e.currentTab;return(0,m.jsxs)("div",{id:"main",className:"org-admin",children:[(0,m.jsx)(x,{isSidePanelClosed:t,onCloseSidePanel:this.onCloseSidePanel,currentTab:n,tabItemClick:this.tabItemClick}),(0,m.jsx)("div",{className:"main-panel",children:(0,m.jsxs)(c.Ix,{className:"reach-router",children:[(0,m.jsx)(xn,{path:h.Yc+"org/info/"}),(0,m.jsx)(z,{path:h.Yc+"org/statistics-admin/file/"}),(0,m.jsx)(Y,{path:h.Yc+"org/statistics-admin/total-storage/"}),(0,m.jsx)(K,{path:h.Yc+"org/statistics-admin/active-users/"}),(0,m.jsx)(W,{path:h.Yc+"org/statistics-admin/traffic/"}),(0,m.jsx)(X,{path:h.Yc+"org/statistics-admin/reports/"}),(0,m.jsx)(le,{path:h.Yc+"org/deviceadmin/desktop-devices/"}),(0,m.jsx)(ce,{path:h.Yc+"org/deviceadmin/mobile-devices/"}),(0,m.jsx)(ge,{path:h.Yc+"org/deviceadmin/devices-errors/"}),(0,m.jsx)(be,{path:h.Yc+"org/web-settings"}),(0,m.jsx)(js,{path:h.Yc+"org/subscription",onCloseSidePanel:this.onCloseSidePanel}),(0,m.jsx)(Ze,{path:h.Yc+"org/useradmin"}),(0,m.jsx)(nt,{path:h.Yc+"org/useradmin/search-users"}),(0,m.jsx)(ot,{path:h.Yc+"org/useradmin/admins/"}),(0,m.jsx)(yt,{path:h.Yc+"org/useradmin/info/:email/"}),(0,m.jsx)(kt,{path:h.Yc+"org/useradmin/info/:email/repos/"}),(0,m.jsx)(Ot,{path:h.Yc+"org/useradmin/info/:email/shared-repos/"}),(0,m.jsx)(Et,{path:h.Yc+"org/groupadmin"}),(0,m.jsx)(qt,{path:h.Yc+"org/groupadmin/search-groups"}),(0,m.jsx)(Wt,{path:h.Yc+"org/groupadmin/:groupID/"}),(0,m.jsx)(Zt,{path:h.Yc+"org/groupadmin/:groupID/repos/"}),(0,m.jsx)(rn,{path:h.Yc+"org/groupadmin/:groupID/members/"}),(0,m.jsx)(hn,{path:h.Yc+"org/repoadmin"}),(0,m.jsx)(fn,{path:h.Yc+"org/repoadmin-trash"}),(0,m.jsx)(Sn,{path:h.Yc+"org/publinkadmin"}),(0,m.jsx)(En,{path:h.Yc+"org/departmentadmin/"}),(0,m.jsxs)(Bn,{path:h.Yc+"org/logadmin",currentTab:n,tabItemClick:this.tabItemClick,children:[(0,m.jsx)(Qn,{path:"/"}),(0,m.jsx)(Jn,{path:"file-update"}),(0,m.jsx)(ns,{path:"perm-audit"}),(0,m.jsx)(is,{path:"repo-transfer"}),(0,m.jsx)(ds,{path:"group-member-audit"})]}),h.bH&&(0,m.jsx)(fs,{path:h.Yc+"org/samlconfig/"})]})})]})}}])}(o.Component));(0,l.createRoot)(document.getElementById("wrapper")).render((0,m.jsx)(d.I18nextProvider,{value:u.A,children:(0,m.jsx)(c.dP,{history:c.W7,children:(0,m.jsx)(As,{})})}))},37696:function(){},2201:function(){},63864:function(){}},function(e){e.O(0,[4223],(function(){return t=83755,e(e.s=t);var t}));e.O()}]);