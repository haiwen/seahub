"use strict";(self.webpackChunkseahub_frontend=self.webpackChunkseahub_frontend||[]).push([[319],{91188:function(e,t,i){var n=i(15671),a=i(43144),o=i(60136),s=i(29388),r=i(47313),l=i(42995),c=i(12756),h=i(12213),d=i(61805),u=i(46417),p=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(){return(0,n.Z)(this,i),t.apply(this,arguments)}return(0,a.Z)(i,[{key:"render",value:function(){var e=this.props,t=e.type,i=e.asyncOperationProgress,n=e.asyncOperatedFilesLength,a="move"===t?(0,d.ih)("Move {num} items"):(0,d.ih)("Copy {num} items");a=a.replace("{num}",n);var o={width:i+"%",lineHeight:"40px",textAlign:"left"};return(0,u.jsxs)(l.Z,{isOpen:!0,toggle:this.props.toggleDialog,children:[(0,u.jsx)(c.Z,{toggle:this.props.toggleDialog,children:a}),(0,u.jsx)(h.Z,{style:{minHeight:"80px"},children:(0,u.jsx)("div",{className:"progress",style:{height:"40px"},children:(0,u.jsx)("div",{className:"progress-bar pl-2",role:"progressbar",style:o,"aria-valuenow":i,"aria-valuemin":"0","aria-valuemax":"100",children:i+"%"})})})]})}}]),i}(r.Component);t.Z=p},40207:function(e,t,i){i.d(t,{Z:function(){return U}});var n=i(15671),a=i(43144),o=i(60136),s=i(29388),r=i(47313),l=i(61805),c=i(75192),h=i.n(c),d=i(9284),u=i.n(d);function p(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function m(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?p(Object(i),!0).forEach((function(t){g(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):p(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function f(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,C(n.key),n)}}function g(e,t,i){return(t=C(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function v(){return v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},v.apply(this,arguments)}function b(e){return b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},b(e)}function y(e,t){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},y(e,t)}function x(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function S(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=b(e);if(t){var a=b(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return x(e)}(this,i)}}function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var n,a,o,s,r=[],l=!0,c=!1;try{if(o=(i=i.call(e)).next,0===t){if(Object(i)!==i)return;l=!1}else for(;!(l=(n=o.call(i)).done)&&(r.push(n.value),r.length!==t);l=!0);}catch(h){c=!0,a=h}finally{try{if(!l&&null!=i.return&&(s=i.return(),Object(s)!==s))return}finally{if(c)throw a}}return r}}(e,t)||j(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e){return function(e){if(Array.isArray(e))return I(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||j(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){if(e){if("string"===typeof e)return I(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?I(e,t):void 0}}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function C(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}function D(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e)return"";var i=e;return t&&Object.keys(t).forEach((function(e){i=i.replace(e,t[e])})),i}function M(){return"undefined"!==typeof i.g.window?i.g.window.innerWidth:0}function _(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.g.window.self,t=e.document.referrer;if(e===i.g.window.top||!t)return e;var n=function(e){return e.match(/(.*\/\/.*?)(\/|$)/)[1]};return n(e.location.href)===n(t)?_(e.parent):e}var F=300,P=27,Z=37,L=39,N=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(s,e);var t,n,a,o=S(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),g(x(t=o.call(this,e)),"handleWheel",(function(e){e.preventDefault()})),t.state={isClosing:!e.animationDisabled,shouldAnimate:!1,zoomLevel:0,offsetX:0,offsetY:0,loadErrorStatus:{},rotateDeg:0},t.outerEl=r.createRef(),t.zoomInBtn=r.createRef(),t.zoomOutBtn=r.createRef(),t.caption=r.createRef(),t.closeIfClickInner=t.closeIfClickInner.bind(x(t)),t.handleImageDoubleClick=t.handleImageDoubleClick.bind(x(t)),t.handleImageClick=t.handleImageClick.bind(x(t)),t.handleImageMouseWheel=t.handleImageMouseWheel.bind(x(t)),t.handleKeyInput=t.handleKeyInput.bind(x(t)),t.handleMouseUp=t.handleMouseUp.bind(x(t)),t.handleMouseDown=t.handleMouseDown.bind(x(t)),t.handleMouseMove=t.handleMouseMove.bind(x(t)),t.handleOuterMousewheel=t.handleOuterMousewheel.bind(x(t)),t.handleTouchStart=t.handleTouchStart.bind(x(t)),t.handleTouchMove=t.handleTouchMove.bind(x(t)),t.handleTouchEnd=t.handleTouchEnd.bind(x(t)),t.handlePointerEvent=t.handlePointerEvent.bind(x(t)),t.handleCaptionMousewheel=t.handleCaptionMousewheel.bind(x(t)),t.handleWindowResize=t.handleWindowResize.bind(x(t)),t.handleZoomInButtonClick=t.handleZoomInButtonClick.bind(x(t)),t.handleZoomOutButtonClick=t.handleZoomOutButtonClick.bind(x(t)),t.requestClose=t.requestClose.bind(x(t)),t.requestMoveNext=t.requestMoveNext.bind(x(t)),t.requestMovePrev=t.requestMovePrev.bind(x(t)),t.rotateImage=t.rotateImage.bind(x(t)),t}return t=s,n=[{key:"UNSAFE_componentWillMount",value:function(){this.timeouts=[],this.currentAction=0,this.eventsSource=0,this.pointerList=[],this.preventInnerClose=!1,this.preventInnerCloseTimeout=null,this.keyPressed=!1,this.imageCache={},this.lastKeyDownTime=0,this.resizeTimeout=null,this.wheelActionTimeout=null,this.resetScrollTimeout=null,this.scrollX=0,this.scrollY=0,this.moveStartX=0,this.moveStartY=0,this.moveStartOffsetX=0,this.moveStartOffsetY=0,this.swipeStartX=0,this.swipeStartY=0,this.swipeEndX=0,this.swipeEndY=0,this.pinchTouchList=null,this.pinchDistance=0,this.keyCounter=0,this.moveRequested=!1,this.props.animationDisabled||this.setState({isClosing:!1})}},{key:"componentDidMount",value:function(){var e=this;this.windowContext=_(),this.listeners={resize:this.handleWindowResize,mouseup:this.handleMouseUp,touchend:this.handleTouchEnd,touchcancel:this.handleTouchEnd,pointerdown:this.handlePointerEvent,pointermove:this.handlePointerEvent,pointerup:this.handlePointerEvent,pointercancel:this.handlePointerEvent},Object.keys(this.listeners).forEach((function(t){e.windowContext.addEventListener(t,e.listeners[t])})),document.addEventListener("wheel",this.handleWheel,{passive:!1}),this.loadAllImages()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this,i=!1,n={},a={};this.getSrcTypes().forEach((function(o){t.props[o.name]!==e[o.name]&&(i=!0,n[t.props[o.name]]=!0,a[e[o.name]]=!0)})),(i||this.moveRequested)&&(Object.keys(n).forEach((function(e){!(e in a)&&e in t.imageCache&&(t.imageCache[e].loaded=!1)})),this.moveRequested=!1,this.loadAllImages(e))}},{key:"shouldComponentUpdate",value:function(){return!this.moveRequested}},{key:"componentWillUnmount",value:function(){var e=this;this.didUnmount=!0,Object.keys(this.listeners).forEach((function(t){e.windowContext.removeEventListener(t,e.listeners[t])})),document.removeEventListener("wheel",this.handleWheel,{passive:!1}),this.timeouts.forEach((function(e){return clearTimeout(e)}))}},{key:"setTimeout",value:function(e){function t(t,i){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){var i=this,n=setTimeout((function(){i.timeouts=i.timeouts.filter((function(e){return e!==n})),e()}),t);return this.timeouts.push(n),n}))},{key:"setPreventInnerClose",value:function(){var e=this;this.preventInnerCloseTimeout&&this.clearTimeout(this.preventInnerCloseTimeout),this.preventInnerClose=!0,this.preventInnerCloseTimeout=this.setTimeout((function(){e.preventInnerClose=!1,e.preventInnerCloseTimeout=null}),100)}},{key:"getBestImageForType",value:function(e){var t=this.props[e],i={};if(this.isImageLoaded(t))i=this.getFitSizes(this.imageCache[t].width,this.imageCache[t].height);else{if(!this.isImageLoaded(this.props["".concat(e,"Thumbnail")]))return null;t=this.props["".concat(e,"Thumbnail")],i=this.getFitSizes(this.imageCache[t].width,this.imageCache[t].height,!0)}return{src:t,height:this.imageCache[t].height,width:this.imageCache[t].width,targetHeight:i.height,targetWidth:i.width}}},{key:"getFitSizes",value:function(e,t,i){var n=this.getLightboxRect(),a=n.height-2*this.props.imagePadding,o=n.width-2*this.props.imagePadding;return i||(a=Math.min(a,t),o=Math.min(o,e)),o/a>e/t?{width:e*a/t,height:a}:{width:o,height:t*o/e}}},{key:"getMaxOffsets",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.zoomLevel,t=this.getBestImageForType("mainSrc");if(null===t)return{maxX:0,minX:0,maxY:0,minY:0};var i=this.getLightboxRect(),n=this.getZoomMultiplier(e),a=0,o=0;return{maxX:a=n*t.width-i.width<0?(i.width-n*t.width)/2:(n*t.width-i.width)/2,maxY:o=n*t.height-i.height<0?(i.height-n*t.height)/2:(n*t.height-i.height)/2,minX:-1*a,minY:-1*o}}},{key:"getSrcTypes",value:function(){return[{name:"mainSrc",keyEnding:"i".concat(this.keyCounter)},{name:"mainSrcThumbnail",keyEnding:"t".concat(this.keyCounter)},{name:"nextSrc",keyEnding:"i".concat(this.keyCounter+1)},{name:"nextSrcThumbnail",keyEnding:"t".concat(this.keyCounter+1)},{name:"prevSrc",keyEnding:"i".concat(this.keyCounter-1)},{name:"prevSrcThumbnail",keyEnding:"t".concat(this.keyCounter-1)}]}},{key:"getZoomMultiplier",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.zoomLevel;return Math.pow(1.007,e)}},{key:"getLightboxRect",value:function(){return this.outerEl.current?this.outerEl.current.getBoundingClientRect():{width:M(),height:"undefined"!==typeof i.g.window?i.g.window.innerHeight:0,top:0,right:0,bottom:0,left:0}}},{key:"clearTimeout",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){this.timeouts=this.timeouts.filter((function(t){return t!==e})),clearTimeout(e)}))},{key:"changeZoom",value:function(e,t,i){if(this.props.enableZoom){var n=Math.max(0,Math.min(F,e));if(n!==this.state.zoomLevel)if(0!==n){var a=this.getBestImageForType("mainSrc");if(null!==a){var o=this.getZoomMultiplier(),s=this.getZoomMultiplier(n),r=this.getLightboxRect(),l="undefined"!==typeof t?t-r.left:r.width/2,c="undefined"!==typeof i?i-r.top:r.height/2,h=(r.width-a.width*o)/2,d=(r.height-a.height*o)/2,u=l-(l-(h-this.state.offsetX))/o*s,p=c-(c-(d-this.state.offsetY))/o*s,m=(r.width-a.width*s)/2-u,f=(r.height-a.height*s)/2-p;if(3!==this.currentAction){var g=this.getMaxOffsets();this.state.zoomLevel>n&&(m=Math.max(g.minX,Math.min(g.maxX,m)),f=Math.max(g.minY,Math.min(g.maxY,f)))}this.setState({zoomLevel:n,offsetX:m,offsetY:f})}}else this.setState({zoomLevel:n,offsetX:0,offsetY:0})}}},{key:"closeIfClickInner",value:function(e){!this.preventInnerClose&&e.target.className.search(/\bril-inner\b/)>-1&&this.requestClose(e)}},{key:"handleKeyInput",value:function(e){if(e.stopPropagation(),!this.isAnimating())if("keyup"!==e.type){var t=e.which||e.keyCode,i=new Date;if(!(i.getTime()-this.lastKeyDownTime<this.props.keyRepeatLimit&&t!==P))switch(this.lastKeyDownTime=i.getTime(),t){case P:e.preventDefault(),this.requestClose(e);break;case Z:if(!this.props.prevSrc)return;e.preventDefault(),this.keyPressed=!0,this.requestMovePrev(e);break;case L:if(!this.props.nextSrc)return;e.preventDefault(),this.keyPressed=!0,this.requestMoveNext(e)}}else this.lastKeyDownTime-=this.props.keyRepeatKeyupBonus}},{key:"handleOuterMousewheel",value:function(e){var t=this;e.stopPropagation(),this.clearTimeout(this.resetScrollTimeout),this.resetScrollTimeout=this.setTimeout((function(){t.scrollX=0,t.scrollY=0}),300)}},{key:"handleImageMouseWheel",value:function(e){if(parseInt(e.deltaY)!==parseFloat(e.deltaY)){if(Math.abs(e.deltaY)>=Math.abs(e.deltaX)){if(e.stopPropagation(),Math.abs(e.deltaY)<1)return;this.scrollX=0,this.scrollY+=e.deltaY,this.changeZoom(this.state.zoomLevel-e.deltaY,e.clientX,e.clientY)}}else if(Math.abs(e.deltaY)>Math.abs(e.deltaX)){var t=this.state.offsetY+e.deltaY;t=t<0?0:t,this.setState({offsetY:t})}else{var i=this.state.offsetX+e.deltaX;i=i<0?0:i,this.setState({offsetX:i})}}},{key:"handleImageDoubleClick",value:function(e){this.state.zoomLevel>0?this.changeZoom(0,e.clientX,e.clientY):this.changeZoom(this.state.zoomLevel+100,e.clientX,e.clientY)}},{key:"handleImageClick",value:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()}},{key:"shouldHandleEvent",value:function(e){if(this.eventsSource===e)return!0;if(0===this.eventsSource)return this.eventsSource=e,!0;switch(e){case 1:default:return!1;case 2:return this.eventsSource=2,this.filterPointersBySource(),!0;case 3:return 1===this.eventsSource&&(this.eventsSource=3,this.filterPointersBySource(),!0)}}},{key:"addPointer",value:function(e){this.pointerList.push(e)}},{key:"removePointer",value:function(e){this.pointerList=this.pointerList.filter((function(t){return t.id!==e.id}))}},{key:"filterPointersBySource",value:function(){var e=this;this.pointerList=this.pointerList.filter((function(t){return t.source===e.eventsSource}))}},{key:"handleMouseDown",value:function(e){this.shouldHandleEvent(1)&&s.isTargetMatchImage(e.target)&&(this.addPointer(s.parseMouseEvent(e)),this.multiPointerStart(e))}},{key:"handleMouseMove",value:function(e){this.shouldHandleEvent(1)&&this.multiPointerMove(e,[s.parseMouseEvent(e)])}},{key:"handleMouseUp",value:function(e){this.shouldHandleEvent(1)&&(this.removePointer(s.parseMouseEvent(e)),this.multiPointerEnd(e))}},{key:"handlePointerEvent",value:function(e){if(this.shouldHandleEvent(3))switch(e.type){case"pointerdown":s.isTargetMatchImage(e.target)&&(this.addPointer(s.parsePointerEvent(e)),this.multiPointerStart(e));break;case"pointermove":this.multiPointerMove(e,[s.parsePointerEvent(e)]);break;case"pointerup":case"pointercancel":this.removePointer(s.parsePointerEvent(e)),this.multiPointerEnd(e)}}},{key:"handleTouchStart",value:function(e){var t=this;this.shouldHandleEvent(2)&&s.isTargetMatchImage(e.target)&&([].forEach.call(e.changedTouches,(function(e){return t.addPointer(s.parseTouchPointer(e))})),this.multiPointerStart(e))}},{key:"handleTouchMove",value:function(e){this.shouldHandleEvent(2)&&this.multiPointerMove(e,[].map.call(e.changedTouches,(function(e){return s.parseTouchPointer(e)})))}},{key:"handleTouchEnd",value:function(e){var t=this;this.shouldHandleEvent(2)&&([].map.call(e.changedTouches,(function(e){return t.removePointer(s.parseTouchPointer(e))})),this.multiPointerEnd(e))}},{key:"decideMoveOrSwipe",value:function(e){this.state.zoomLevel<=0?this.handleSwipeStart(e):this.handleMoveStart(e)}},{key:"multiPointerStart",value:function(e){switch(this.handleEnd(null),this.pointerList.length){case 1:e.preventDefault(),this.decideMoveOrSwipe(this.pointerList[0]);break;case 2:e.preventDefault(),this.handlePinchStart(this.pointerList)}}},{key:"multiPointerMove",value:function(e,t){switch(this.currentAction){case 1:e.preventDefault(),this.handleMove(t[0]);break;case 2:e.preventDefault(),this.handleSwipe(t[0]);break;case 3:e.preventDefault(),this.handlePinch(t)}}},{key:"multiPointerEnd",value:function(e){switch(0!==this.currentAction&&(this.setPreventInnerClose(),this.handleEnd(e)),this.pointerList.length){case 0:this.eventsSource=0;break;case 1:e.preventDefault(),this.decideMoveOrSwipe(this.pointerList[0]);break;case 2:e.preventDefault(),this.handlePinchStart(this.pointerList)}}},{key:"handleEnd",value:function(e){switch(this.currentAction){case 1:this.handleMoveEnd(e);break;case 2:this.handleSwipeEnd(e);break;case 3:this.handlePinchEnd(e)}}},{key:"handleMoveStart",value:function(e){var t=e.x,i=e.y;this.props.enableZoom&&(this.currentAction=1,this.moveStartX=t,this.moveStartY=i,this.moveStartOffsetX=this.state.offsetX,this.moveStartOffsetY=this.state.offsetY)}},{key:"handleMove",value:function(e){var t=e.x,i=e.y,n=this.moveStartX-t+this.moveStartOffsetX,a=this.moveStartY-i+this.moveStartOffsetY;this.state.offsetX===n&&this.state.offsetY===a||this.setState({offsetX:n,offsetY:a})}},{key:"handleMoveEnd",value:function(){var e=this;this.currentAction=0,this.moveStartX=0,this.moveStartY=0,this.moveStartOffsetX=0,this.moveStartOffsetY=0;var t=this.getMaxOffsets(),i=Math.max(t.minX,Math.min(t.maxX,this.state.offsetX)),n=Math.max(t.minY,Math.min(t.maxY,this.state.offsetY));i===this.state.offsetX&&n===this.state.offsetY||(this.setState({offsetX:i,offsetY:n,shouldAnimate:!0}),this.setTimeout((function(){e.setState({shouldAnimate:!1})}),this.props.animationDuration))}},{key:"handleSwipeStart",value:function(e){var t=e.x,i=e.y;this.currentAction=2,this.swipeStartX=t,this.swipeStartY=i,this.swipeEndX=t,this.swipeEndY=i}},{key:"handleSwipe",value:function(e){var t=e.x,i=e.y;this.swipeEndX=t,this.swipeEndY=i}},{key:"handleSwipeEnd",value:function(e){var t=this.swipeEndX-this.swipeStartX,i=Math.abs(t),n=Math.abs(this.swipeEndY-this.swipeStartY);if(this.currentAction=0,this.swipeStartX=0,this.swipeStartY=0,this.swipeEndX=0,this.swipeEndY=0,!(!e||this.isAnimating()||i<1.5*n)){if(i<200&&i<this.getLightboxRect().width/4)return;t>0&&this.props.prevSrc?(e.preventDefault(),this.requestMovePrev()):t<0&&this.props.nextSrc&&(e.preventDefault(),this.requestMoveNext())}}},{key:"calculatePinchDistance",value:function(){var e=k(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pinchTouchList,2),t=e[0],i=e[1];return Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2))}},{key:"calculatePinchCenter",value:function(){var e=k(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pinchTouchList,2),t=e[0],i=e[1];return{x:t.x-(t.x-i.x)/2,y:t.y-(t.y-i.y)/2}}},{key:"handlePinchStart",value:function(e){this.props.enableZoom&&(this.currentAction=3,this.pinchTouchList=e.map((function(e){return{id:e.id,x:e.x,y:e.y}})),this.pinchDistance=this.calculatePinchDistance())}},{key:"handlePinch",value:function(e){this.pinchTouchList=this.pinchTouchList.map((function(t){for(var i=0;i<e.length;i+=1)if(e[i].id===t.id)return e[i];return t}));var t=this.calculatePinchDistance(),i=this.state.zoomLevel+t-this.pinchDistance;this.pinchDistance=t;var n=this.calculatePinchCenter(this.pinchTouchList),a=n.x,o=n.y;this.changeZoom(i,a,o)}},{key:"handlePinchEnd",value:function(){this.currentAction=0,this.pinchTouchList=null,this.pinchDistance=0}},{key:"handleWindowResize",value:function(){this.clearTimeout(this.resizeTimeout),this.resizeTimeout=this.setTimeout(this.forceUpdate.bind(this),100)}},{key:"handleZoomInButtonClick",value:function(){var e=this.state.zoomLevel+100;this.changeZoom(e),e===F&&this.zoomOutBtn.current.focus()}},{key:"handleZoomOutButtonClick",value:function(){var e=this.state.zoomLevel-100;this.changeZoom(e),0===e&&this.zoomInBtn.current.focus()}},{key:"handleCaptionMousewheel",value:function(e){if(e.stopPropagation(),this.caption.current){var t=this.caption.current.getBoundingClientRect().height,i=this.caption.current,n=i.scrollHeight,a=i.scrollTop;(e.deltaY>0&&t+a>=n||e.deltaY<0&&a<=0)&&e.preventDefault()}}},{key:"isAnimating",value:function(){return this.state.shouldAnimate||this.state.isClosing}},{key:"isImageLoaded",value:function(e){return e&&e in this.imageCache&&this.imageCache[e].loaded}},{key:"loadImage",value:function(e,t,n){var a=this;if(this.isImageLoaded(t))this.setTimeout((function(){n()}),1);else{var o=new i.g.Image;this.props.imageCrossOrigin&&(o.crossOrigin=this.props.imageCrossOrigin),o.onerror=function(i){a.props.onImageLoadError(t,e,i),a.setState((function(t){return{loadErrorStatus:m(m({},t.loadErrorStatus),{},g({},e,!0))}})),n(i)},o.onload=function(){a.props.onImageLoad(t,e,o),a.imageCache[t]={loaded:!0,width:o.width,height:o.height},n()},o.src=t}}},{key:"loadAllImages",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props;this.getSrcTypes().forEach((function(i){var n=i.name;t[n]&&e.state.loadErrorStatus[n]&&e.setState((function(e){return{loadErrorStatus:m(m({},e.loadErrorStatus),{},g({},n,!1))}})),t[n]&&!e.isImageLoaded(t[n])&&e.loadImage(n,t[n],function(t,i){return function(n){n||e.props[t]!==i||e.didUnmount||e.forceUpdate()}}(n,t[n]))}))}},{key:"requestClose",value:function(e){var t=this,i=function(){t.saveRotateImage(),t.props.onCloseRequest(e)};this.props.animationDisabled||"keydown"===e.type&&!this.props.animationOnKeyInput?i():(this.setState({isClosing:!0}),this.setTimeout(i,this.props.animationDuration))}},{key:"requestMove",value:function(e,t){var i=this,n={zoomLevel:0,offsetX:0,offsetY:0};this.props.animationDisabled||this.keyPressed&&!this.props.animationOnKeyInput||(n.shouldAnimate=!0,this.setTimeout((function(){return i.setState({shouldAnimate:!1})}),this.props.animationDuration)),this.keyPressed=!1,this.moveRequested=!0,this.saveRotateImage(),"prev"===e?(this.keyCounter-=1,this.setState(n),this.props.onMovePrevRequest(t)):(this.keyCounter+=1,this.setState(n),this.props.onMoveNextRequest(t))}},{key:"requestMoveNext",value:function(e){this.requestMove("next",e)}},{key:"requestMovePrev",value:function(e){this.requestMove("prev",e)}},{key:"saveRotateImage",value:function(){this.props.onRotateImage&&0!==this.state.rotateDeg&&360!==this.state.rotateDeg&&(this.props.onRotateImage(this.state.rotateDeg),this.setState({rotateDeg:0}))}},{key:"rotateImage",value:function(){var e=this.state.rotateDeg;e=e>=360?this.state.rotateDeg-270:e+90,this.setState({rotateDeg:e})}},{key:"render",value:function(){var e=this,t=this.props,n=t.animationDisabled,a=t.animationDuration,o=t.clickOutsideToClose,l=t.discourageDownloads,c=t.enableZoom,h=t.imageTitle,d=t.nextSrc,p=t.prevSrc,f=t.isDesktop,g=t.toolbarButtons,b=t.reactModalStyle,y=t.onAfterOpen,x=t.imageCrossOrigin,S=t.reactModalProps,k=t.onRotateImage,j=this.state,I=j.zoomLevel,C=j.offsetX,M=j.offsetY,_=j.isClosing,P=j.loadErrorStatus,Z=j.rotateDeg,L=this.getLightboxRect(),N={};!n&&this.isAnimating()&&(N=m(m({},N),{},{transition:"transform ".concat(a,"ms")}));var O={};this.getSrcTypes().forEach((function(e){var t=e.name,i=e.keyEnding;O[t]=i}));var T=[],E=function(t,i,n){if(e.props[t]){var a,o=e.getBestImageForType(t),c=m(m({},N),s.getTransform(m(m({},n),o)));if(I>0&&(c.cursor="move"),c.transform="".concat(c.transform," rotate(").concat(Z,"deg)"),null===o&&(a=P,Object.keys(a).some((function(e){return a[e]}))))T.push(r.createElement("div",{className:"".concat(i," ril__image ril-errored"),style:c,key:e.props[t]+O[t]},r.createElement("div",{className:"ril__errorContainer"},e.props.imageLoadErrorMessage)));else if(null!==o){var d=o.src;l?(c.backgroundImage="url('".concat(d,"')"),T.push(r.createElement("div",{className:"".concat(i," ril__image ril__imageDiscourager"),onDoubleClick:e.handleImageDoubleClick,onWheel:e.handleImageMouseWheel,style:c,key:d+O[t]},r.createElement("div",{className:"ril-download-blocker ril__downloadBlocker"})))):T.push(r.createElement("img",v({},x?{crossOrigin:x}:{},{className:"".concat(i," ril__image"),onDoubleClick:e.handleImageDoubleClick,onClick:e.handleImageClick,onWheel:e.handleImageMouseWheel,onDragStart:function(e){return e.preventDefault()},style:c,src:d,key:d+O[t],alt:"string"===typeof h?h:D("Image"),draggable:!1})))}else{var u=r.createElement("div",{className:"ril-loading-circle ril__loadingCircle ril__loadingContainer__icon"},w(new Array(12)).map((function(e,t){return r.createElement("div",{key:t,className:"ril-loading-circle-point ril__loadingCirclePoint"})})));T.push(r.createElement("div",{className:"".concat(i," ril__image ril-not-loaded"),style:c,key:e.props[t]+O[t]},r.createElement("div",{className:"ril__loadingContainer"},u)))}}},U=this.getZoomMultiplier();E("nextSrc","ril-image-next ril__imageNext",{x:L.width}),E("mainSrc","ril-image-current",{x:-1*C,y:-1*M,zoom:U}),E("prevSrc","ril-image-prev ril__imagePrev",{x:-1*L.width});var z={overlay:m({zIndex:1e3,backgroundColor:"transparent"},b.overlay),content:m({backgroundColor:"transparent",overflow:"hidden",border:"none",borderRadius:0,padding:0,top:0,left:0,right:0,bottom:0},b.content)};return r.createElement(u(),v({isOpen:!0,onRequestClose:o?this.requestClose:void 0,onAfterOpen:function(){e.outerEl.current&&e.outerEl.current.focus(),y()},style:z,contentLabel:D("Lightbox"),appElement:"undefined"!==typeof i.g.window?i.g.window.document.body:void 0},S),r.createElement("div",{className:"ril-outer ril__outer ril__outerAnimating ".concat(this.props.wrapperClassName," ").concat(_?"ril-closing ril__outerClosing":""),style:{transition:"opacity ".concat(a,"ms"),animationDuration:"".concat(a,"ms"),animationDirection:_?"normal":"reverse"},ref:this.outerEl,onWheel:this.handleOuterMousewheel,onMouseMove:this.handleMouseMove,onMouseDown:this.handleMouseDown,onTouchStart:this.handleTouchStart,onTouchMove:this.handleTouchMove,tabIndex:"-1",onKeyDown:this.handleKeyInput,onKeyUp:this.handleKeyInput},r.createElement("div",{className:"ril-inner ril__inner",onClick:o?this.closeIfClickInner:void 0},T),p&&f&&r.createElement("button",{type:"button",className:"ril-prev-button ril__navButtons ril__navButtonPrev",key:"prev","aria-label":this.props.prevLabel,onClick:this.isAnimating()?void 0:this.requestMovePrev}),d&&f&&r.createElement("button",{type:"button",className:"ril-next-button ril__navButtons ril__navButtonNext",key:"next","aria-label":this.props.nextLabel,onClick:this.isAnimating()?void 0:this.requestMoveNext}),r.createElement("div",{className:"ril-toolbar ril__toolbar"},r.createElement("ul",{className:"ril-toolbar-left ril__toolbarSide ril__toolbarLeftSide"},r.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},r.createElement("span",{className:"ril-toolbar__item__child ril__toolbarItemChild"},h))),r.createElement("ul",{className:"ril-toolbar-right ril__toolbarSide ril__toolbarRightSide"},g&&g.map((function(e,t){return r.createElement("li",{key:"button_".concat(t+1),className:"ril-toolbar__item ril__toolbarItem"},e)})),r.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},r.createElement("button",{type:"button",key:"close","aria-label":this.props.closeLabel,className:"ril-close ril-toolbar__item__child ril__toolbarItemChild ril__builtinButton ril__closeButton",onClick:this.isAnimating()?void 0:this.requestClose})))),r.createElement("div",{onMouseDown:function(e){return e.stopPropagation()},className:"ril-caption ril__caption"},c&&r.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},r.createElement("button",{type:"button",key:"zoom-in","aria-label":this.props.zoomInLabel,className:["ril-zoom-in","ril__toolbarItemChild","ril__builtinButton","ril__zoomInButton"].concat(w(I===F?["ril__builtinButtonDisabled"]:[])).join(" "),ref:this.zoomInBtn,disabled:this.isAnimating()||I===F,onClick:this.isAnimating()||I===F?void 0:this.handleZoomInButtonClick})),c&&r.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},r.createElement("button",{type:"button",key:"zoom-out","aria-label":this.props.zoomOutLabel,className:["ril-zoom-out","ril__toolbarItemChild","ril__builtinButton","ril__zoomOutButton"].concat(w(0===I?["ril__builtinButtonDisabled"]:[])).join(" "),ref:this.zoomOutBtn,disabled:this.isAnimating()||0===I,onClick:this.isAnimating()||0===I?void 0:this.handleZoomOutButtonClick})),k&&r.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},r.createElement("button",{type:"button",className:["ril-rotate","ril__toolbarItemChild","ril__builtinButton","ril__rotateButton","ril_rotateImageButton"].join(" "),onClick:this.rotateImage})))))}}],a=[{key:"isTargetMatchImage",value:function(e){return e&&/ril-image-current/.test(e.className)}},{key:"parseMouseEvent",value:function(e){return{id:"mouse",source:1,x:parseInt(e.clientX,10),y:parseInt(e.clientY,10)}}},{key:"parseTouchPointer",value:function(e){return{id:e.identifier,source:2,x:parseInt(e.clientX,10),y:parseInt(e.clientY,10)}}},{key:"parsePointerEvent",value:function(e){return{id:e.pointerId,source:3,x:parseInt(e.clientX,10),y:parseInt(e.clientY,10)}}},{key:"getTransform",value:function(e){var t=e.x,i=void 0===t?0:t,n=e.y,a=void 0===n?0:n,o=e.zoom,s=void 0===o?1:o,r=e.width,l=e.targetWidth,c=i,h=M();r>h&&(c+=(h-r)/2);var d=s*(l/r);return{transform:"translate3d(".concat(c,"px,").concat(a,"px,0) scale3d(").concat(d,",").concat(d,",1)")}}}],n&&f(t.prototype,n),a&&f(t,a),Object.defineProperty(t,"prototype",{writable:!1}),s}(r.Component);N.propTypes={isDesktop:h().bool,mainSrc:h().string.isRequired,prevSrc:h().string,nextSrc:h().string,mainSrcThumbnail:h().string,prevSrcThumbnail:h().string,nextSrcThumbnail:h().string,onCloseRequest:h().func.isRequired,onMovePrevRequest:h().func,onMoveNextRequest:h().func,onImageLoadError:h().func,onImageLoad:h().func,onAfterOpen:h().func,discourageDownloads:h().bool,animationDisabled:h().bool,animationOnKeyInput:h().bool,animationDuration:h().number,keyRepeatLimit:h().number,keyRepeatKeyupBonus:h().number,imageTitle:h().node,imageCaption:h().node,imageCrossOrigin:h().string,reactModalStyle:h().object,imagePadding:h().number,wrapperClassName:h().string,toolbarButtons:h().arrayOf(h().node),clickOutsideToClose:h().bool,enableZoom:h().bool,reactModalProps:h().shape({}),nextLabel:h().string,prevLabel:h().string,zoomInLabel:h().string,zoomOutLabel:h().string,closeLabel:h().string,imageLoadErrorMessage:h().node,onRotateImage:h().func},N.defaultProps={isDesktop:!0,imageTitle:null,imageCaption:null,toolbarButtons:null,reactModalProps:{},animationDisabled:!1,animationDuration:300,animationOnKeyInput:!1,clickOutsideToClose:!0,closeLabel:"Close lightbox",discourageDownloads:!1,enableZoom:!0,imagePadding:10,imageCrossOrigin:null,keyRepeatKeyupBonus:40,keyRepeatLimit:180,mainSrcThumbnail:null,nextLabel:"Next image",nextSrc:null,nextSrcThumbnail:null,onAfterOpen:function(){},onImageLoadError:function(){},onImageLoad:function(){},onMoveNextRequest:function(){},onMovePrevRequest:function(){},prevLabel:"Previous image",prevSrc:null,prevSrcThumbnail:null,reactModalStyle:{},wrapperClassName:"",zoomInLabel:"Zoom in",zoomOutLabel:"Zoom out",imageLoadErrorMessage:"This image failed to load",onRotateImage:null};var O=N,T=i(46417),E=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(){return(0,n.Z)(this,i),t.apply(this,arguments)}return(0,a.Z)(i,[{key:"render",value:function(){var e=this.props.imageItems,t=this.props.imageIndex,i=e.length,n=e[t].name,a="".concat(n," (").concat(t+1,"/").concat(i,")");return(0,T.jsx)(O,{imageTitle:a,mainSrc:e[t].src,nextSrc:e[(t+1)%i].src,prevSrc:e[(t+i-1)%i].src,onCloseRequest:this.props.closeImagePopup,onMovePrevRequest:this.props.moveToPrevImage,onMoveNextRequest:this.props.moveToNextImage,imagePadding:70,imageLoadErrorMessage:(0,l.ih)("The image could not be loaded."),prevLabel:(0,l.ih)("Previous (Left arrow key)"),nextLabel:(0,l.ih)("Next (Right arrow key)"),closeLabel:(0,l.ih)("Close (Esc)"),zoomInLabel:(0,l.ih)("Zoom in"),zoomOutLabel:(0,l.ih)("Zoom out")})}}]),i}(r.Component),U=E},23396:function(e,t,i){var n,a=i(15671),o=i(43144),s=i(60136),r=i(29388),l=i(47313),c=i(42995),h=i(12756),d=i(12213),u=i(61805),p=i(4514),m=i(83854),f=i(51282),g=i(46417),v=function(e){(0,s.Z)(i,e);var t=(0,r.Z)(i);function i(e){var o;return(0,a.Z)(this,i),(o=t.call(this,e)).queryZipProgress=function(){var e=o.state.zipToken;p.I.queryZipProgress(e).then((function(t){var i=t.data;if(1==i.failed){var a;switch(clearInterval(n),i.failed_reason){case"size too large":a=(0,u.ih)("Failed to download. The total size of the files exceeded the limit.");break;case"internal error":a=(0,u.ih)("Internal Server Error");break;default:a=(0,u.ih)("Error")}o.setState({isLoading:!1,errorMsg:a})}else o.setState({zipProgress:0==i.total?"100%":(i.zipped/i.total*100).toFixed(2)+"%"}),i.total==i.zipped&&(clearInterval(n),o.props.toggleDialog(),location.href="".concat(u.gc,"zip/").concat(e))})).catch((function(e){clearInterval(n);var t=m.c.getErrorMsg(e);o.setState({isLoading:!1,errorMsg:t})}))},o.cancelZipTask=function(){var e=o.state.zipToken;p.I.cancelZipTask(e).then((function(e){})).catch((function(e){}))},o.toggleDialog=function(){var e=o.state.zipProgress;e&&"100%"!=e&&(clearInterval(n),o.cancelZipTask()),o.props.toggleDialog()},o.state={isLoading:!0,errorMsg:"",zipProgress:null},o}return(0,o.Z)(i,[{key:"componentDidMount",value:function(){var e=this,t=this.props,i=t.token,a=t.path,o=t.repoID,s=t.target;(i?s.length?p.I.getShareLinkDirentsZipTask(i,a,s):p.I.getShareLinkZipTask(i,a):p.I.zipDownload(o,a,s)).then((function(t){var i=t.data.zip_token;e.setState({isLoading:!1,errorMsg:"",zipToken:i}),e.queryZipProgress(),n=setInterval(e.queryZipProgress,1e3)})).catch((function(t){var i=m.c.getErrorMsg(t);e.setState({isLoading:!1,errorMsg:i})}))}},{key:"render",value:function(){return(0,g.jsxs)(c.Z,{isOpen:!0,toggle:this.toggleDialog,children:[(0,g.jsx)(h.Z,{toggle:this.toggleDialog,children:(0,u.ih)("Download")}),(0,g.jsx)(d.Z,{children:(0,g.jsx)(b,{data:this.state})})]})}}]),i}(l.Component),b=function(e){(0,s.Z)(i,e);var t=(0,r.Z)(i);function i(){return(0,a.Z)(this,i),t.apply(this,arguments)}return(0,o.Z)(i,[{key:"render",value:function(){var e=this.props.data,t=e.isLoading,i=e.errorMsg,n=e.zipProgress;return t?(0,g.jsx)(f.Z,{}):i?(0,g.jsxs)("div",{className:"text-center mt-7 mb-8",children:[(0,g.jsx)("img",{src:"".concat(u.si,"img/error-tip.png"),alt:"",width:"100"}),(0,g.jsx)("p",{className:"mt-3",children:i})]}):(0,g.jsx)("p",{className:"mt-4 text-center",children:"".concat((0,u.ih)("Packaging...")," ").concat(n)})}}]),i}(l.Component);t.Z=v},43916:function(e,t,i){i.d(t,{Z:function(){return D}});var n=i(15671),a=i(43144),o=i(60136),s=i(29388),r=i(47313),l=i(68164),c=i(42995),h=i(12756),d=i(12213),u=i(7764),p=i(21303),m=i(70816),f=i.n(m),g=i(61805),v=i(4514),b=i(83854),y=i(68396),x=i(46417),S=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var a;return(0,n.Z)(this,i),(a=t.call(this,e)).onFileTagChanged=function(e){var t=e.parent_path,i={name:e.filename},n="/"===t?t+e.filename:t+"/"+e.filename;a.props.onFileTagChanged(i,n)},a.onDeleteTaggedFile=function(e){var t=a.props.repoID,i=e.file_tag_id;v.I.deleteFileTag(t,i).then((function(t){a.getTaggedFiles(),a.props.updateUsedRepoTags(),a.props.onFileTagChanged&&!e.file_deleted&&a.onFileTagChanged(e)})).catch((function(e){var t=b.c.getErrorMsg(e);y.Z.danger(t)}))},a.getTaggedFiles=function(){var e=a.props,t=e.repoID,i=e.currentTag,n=e.shareLinkToken;(n?v.I.getShareLinkTaggedFiles(n,i.id):v.I.listTaggedFiles(t,i.id)).then((function(e){var t=[];void 0!==e.data.tagged_files&&e.data.tagged_files.forEach((function(e){var i=e;t.push(i)})),a.setState({taggedFileList:t})})).catch((function(e){var t=b.c.getErrorMsg(e);y.Z.danger(t)}))},a.state={taggedFileList:[]},a}return(0,a.Z)(i,[{key:"componentDidMount",value:function(){this.getTaggedFiles()}},{key:"render",value:function(){var e=this,t=this.state.taggedFileList;return(0,x.jsxs)(c.Z,{isOpen:!0,style:{maxWidth:"678px"},children:[(0,x.jsx)(h.Z,{toggle:this.props.onClose,children:(0,g.ih)("Tagged Files")}),(0,x.jsx)(d.Z,{className:"dialog-list-container",children:(0,x.jsxs)("table",{children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"50%",className:"ellipsis",children:(0,g.ih)("Name")}),(0,x.jsx)("th",{width:"20%",children:(0,g.ih)("Size")}),(0,x.jsx)("th",{width:"22%",children:(0,g.ih)("Last Update")}),(0,x.jsx)("th",{width:"8%"})]})}),(0,x.jsx)("tbody",{children:t.map((function(t,i){return(0,x.jsx)(k,{repoID:e.props.repoID,taggedFile:t,onDeleteTaggedFile:e.onDeleteTaggedFile,shareLinkToken:e.props.shareLinkToken,enableFileDownload:e.props.enableFileDownload},i)}))})]})}),(0,x.jsx)(u.Z,{children:(0,x.jsx)(p.Z,{color:"secondary",onClick:this.props.toggleCancel,children:(0,g.ih)("Close")})})]})}}]),i}(r.Component),k=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var a;return(0,n.Z)(this,i),(a=t.call(this,e)).onMouseEnter=function(){a.setState({active:!0})},a.onMouseLeave=function(){a.setState({active:!1})},a.deleteFile=function(e){e.preventDefault(),a.props.onDeleteTaggedFile(a.props.taggedFile)},a.state={active:!1},a}return(0,a.Z)(i,[{key:"render",value:function(){var e=this.props,t=e.taggedFile,i=e.shareLinkToken,n=e.enableFileDownload,a=t.parent_path?b.c.joinPath(t.parent_path,t.filename):"",o=i?g.ze+"d/"+i+"/files/?p="+b.c.encodePath(a):g.ze+"lib/"+this.props.repoID+"/file"+b.c.encodePath(a);return(0,x.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onFocus:this.onMouseEnter,children:[t.file_deleted?(0,x.jsx)(r.Fragment,{children:(0,x.jsxs)("td",{colSpan:"3",className:"name",children:[t.filename," ",(0,x.jsx)("span",{style:{color:"red"},children:(0,g.ih)("deleted")})]})}):(0,x.jsxs)(r.Fragment,{children:[(0,x.jsx)("td",{children:(0,x.jsx)("a",{href:o,target:"_blank",className:"d-inline-block w-100 ellipsis",title:t.filename,rel:"noreferrer",children:t.filename})}),(0,x.jsx)("td",{children:b.c.bytesToSize(t.size)}),(0,x.jsx)("td",{children:f().unix(t.mtime).fromNow()})]}),(0,x.jsxs)("td",{children:[!i&&(0,x.jsx)("a",{href:"#",role:"button","aria-label":(0,g.ih)("Delete"),title:(0,g.ih)("Delete"),className:"action-icon sf2-icon-x3".concat(this.state.active?"":" invisible"),onClick:this.deleteFile}),i&&n&&(0,x.jsx)("a",{className:"action-icon sf2-icon-download".concat(this.state.active?"":" invisible"),href:"".concat(o,"&dl=1"),title:(0,g.ih)("Download"),"aria-label":(0,g.ih)("Download")})]})]})}}]),i}(r.Component),w=i(14658),j=(0,a.Z)((function e(t){(0,n.Z)(this,e),this.created=t.created_at,this.createdStr=f()(new Date(t.created_at).getTime()).format("YYYY-MM-DD HH:mm"),this.id=t.id,this.ownerNickname=t.owner_nickname,this.originRepoID=t.origin_repo_id,this.draftFilePath=t.draft_file_path})),I=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var a;return(0,n.Z)(this,i),(a=t.call(this,e)).onDeleteDraftItem=function(e){w.Z.deleteDraft(e.id).then((function(){var t=a.state.drafts.filter((function(t){return t.id!==e.id}));a.setState({drafts:t});var i=(0,g.ih)("Successfully deleted draft %(draft)s.");i=i.replace("%(draft)s",e.draftFilePath),y.Z.success(i)})).catch((function(){var t=(0,g.ih)("Failed to delete draft %(draft)s.");t=t.replace("%(draft)s",e.draftFilePath),y.Z.danger(t)}))},a.toggle=function(){a.props.toggle()},a.state={drafts:[]},a}return(0,a.Z)(i,[{key:"componentDidMount",value:function(){var e=this;v.I.listRepoDrafts(this.props.repoID).then((function(t){var i=t.data.drafts.map((function(e){return new j(e)}));e.setState({drafts:i})}))}},{key:"render",value:function(){var e=this;return(0,x.jsxs)(c.Z,{isOpen:!0,toggle:this.toggle,children:[(0,x.jsx)(h.Z,{toggle:this.toggle,children:(0,g.ih)("Drafts")}),(0,x.jsx)(d.Z,{className:"dialog-list-container",children:(0,x.jsxs)("table",{children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"50%",className:"ellipsis",children:(0,g.ih)("Name")}),(0,x.jsx)("th",{width:"20%",children:(0,g.ih)("Owner")}),(0,x.jsx)("th",{width:"20%",children:(0,g.ih)("Last Update")}),(0,x.jsx)("th",{width:"10%"})]})}),(0,x.jsx)("tbody",{children:this.state.drafts.map((function(t,i){return(0,x.jsx)(C,{draftItem:t,onDeleteDraftItem:e.onDeleteDraftItem},i)}))})]})}),(0,x.jsx)(u.Z,{children:(0,x.jsx)(p.Z,{color:"secondary",onClick:this.toggle,children:(0,g.ih)("Close")})})]})}}]),i}(r.Component),C=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var a;return(0,n.Z)(this,i),(a=t.call(this,e)).onMouseEnter=function(){a.setState({active:!0})},a.onMouseLeave=function(){a.setState({active:!1})},a.state={active:!1},a}return(0,a.Z)(i,[{key:"render",value:function(){var e=this.props.draftItem,t=g.ze+"drafts/"+e.id+"/",i=this.state.active?"action-icon sf2-icon-x3":"action-icon vh sf2-icon-x3";return(0,x.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[(0,x.jsx)("td",{className:"name",children:(0,x.jsx)("a",{href:t,target:"_blank",rel:"noreferrer",children:b.c.getFileName(e.draftFilePath)})}),(0,x.jsx)("td",{children:e.ownerNickname}),(0,x.jsx)("td",{children:f()(e.createdStr).fromNow()}),(0,x.jsx)("td",{children:(0,x.jsx)("i",{className:i,onClick:this.props.onDeleteDraftItem.bind(this,e)})})]})}}]),i}(r.Component),D=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var a;return(0,n.Z)(this,i),(a=t.call(this,e)).onListTaggedFiles=function(e){a.setState({currentTag:e,isListTaggedFileShow:!a.state.isListTaggedFileShow})},a.onCloseDialog=function(){a.setState({isListTaggedFileShow:!1})},a.toggleDrafts=function(){a.setState({showRepoDrafts:!a.state.showRepoDrafts})},a.state={currentTag:null,isListTaggedFileShow:!1,showRepoDrafts:!1},a}return(0,a.Z)(i,[{key:"render",value:function(){var e=this,t=this.props,i=t.repoID,n=t.usedRepoTags,a=t.draftCounts,o=t.className;return void 0===a&&(a=0),(0,x.jsxs)("div",{className:"repo-info-bar ".concat(o||""),children:[n.length>0&&(0,x.jsx)("ul",{className:"used-tag-list",children:n.map((function(t){return(0,x.jsxs)("li",{className:"used-tag-item",children:[(0,x.jsx)("span",{className:"used-tag",style:{backgroundColor:t.color}}),(0,x.jsx)("span",{className:"used-tag-name",title:t.name,children:t.name}),(0,x.jsx)("button",{type:"button",className:"used-tag-files border-0 bg-transparent",onClick:e.onListTaggedFiles.bind(e,t),children:t.fileCount>1?t.fileCount+" files":t.fileCount+" file"})]},t.id)}))}),this.state.isListTaggedFileShow&&(0,x.jsx)(l.Z,{children:(0,x.jsx)(S,{repoID:i,currentTag:this.state.currentTag,onClose:this.onCloseDialog,toggleCancel:this.onListTaggedFiles,updateUsedRepoTags:this.props.updateUsedRepoTags,onFileTagChanged:this.props.onFileTagChanged,shareLinkToken:this.props.shareLinkToken,enableFileDownload:this.props.enableFileDownload})}),this.state.showRepoDrafts&&(0,x.jsx)(l.Z,{children:(0,x.jsx)(I,{toggle:this.toggleDrafts,repoID:this.props.repoID})})]})}}]),i}(r.Component)},14472:function(e,t,i){var n=i(74165),a=i(15861),o=i(15671),s=i(43144),r=i(97326),l=i(60136),c=i(29388),h=i(47313),d=i(92534),u=i.n(d),p=i(1168),m=i(21303),f=i(13380),g=i(25417),v=i(57124),b=i(48128),y=i(70816),x=i.n(y),S=i(93190),k=i(61805),w=i(83854),j=i(4514),I=i(51282),C=i(68396),D=i(68164),M=i(23396),_=i(40207),F=i(93433),P=i(57313),Z=i.n(P),L=i(46417),N="uploading",O="error",T="isSaving",E="uploaded",U=function(e){(0,l.Z)(i,e);var t=(0,c.Z)(i);function i(e){var n;return(0,o.Z)(this,i),(n=t.call(this,e)).onUploadCancel=function(e){e.preventDefault(),n.props.onUploadCancel(n.props.resumableFile)},n.onUploadRetry=function(e){e.preventDefault(),n.props.onUploadRetry(n.props.resumableFile)},n.formatFileSize=function(e){return"number"!==typeof e?"":e>=1e9?(e/1e9).toFixed(1)+" G":e>=1e6?(e/1e6).toFixed(1)+" M":e>=1e3?(e/1e3).toFixed(1)+" K":e.toFixed(1)+" B"},n.state={uploadState:N},n}return(0,s.Z)(i,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.resumableFile,i=N;t.error?i=O:(0!==t.remainingTime||t.isSaved||(i=T),t.isSaved&&(i=E)),this.setState({uploadState:i})}},{key:"render",value:function(){var e=this.props.resumableFile,t=Math.round(100*e.progress()),i=e.error,n=e.newFileName,a=this.formatFileSize(e.size);return(0,L.jsxs)("tr",{className:"file-upload-item",children:[(0,L.jsx)("td",{className:"upload-name",children:(0,L.jsx)("div",{className:"ellipsis",title:n,children:n})}),(0,L.jsx)("td",{className:"ellipsis",children:(0,L.jsx)("span",{className:"file-size",title:a,children:a})}),(0,L.jsxs)("td",{className:"upload-progress ellipsis",children:[(this.state.uploadState===N||this.state.uploadState===T)&&(0,L.jsxs)(h.Fragment,{children:[e.size>=1e8&&(0,L.jsxs)(h.Fragment,{children:[e.isUploading()&&(0,L.jsxs)("div",{className:"progress-container",children:[(0,L.jsx)("div",{className:"progress",children:(0,L.jsx)("div",{className:"progress-bar",role:"progressbar",style:{width:"".concat(t,"%")},"aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"100"})}),-1===e.remainingTime&&(0,L.jsx)("div",{className:"progress-text",children:(0,k.ih)("Preparing to upload...")}),e.remainingTime>0&&(0,L.jsxs)("div",{className:"progress-text",children:[(0,k.ih)("Remaining")," ",w.c.formatTime(e.remainingTime)]}),0===e.remainingTime&&(0,L.jsx)("div",{className:"progress-text",children:(0,k.ih)("Indexing...")})]}),!e.isUploading()&&(0,L.jsx)("div",{className:"progress-container d-flex align-items-center",children:(0,L.jsx)("div",{className:"progress",children:(0,L.jsx)("div",{className:"progress-bar",role:"progressbar",style:{width:"".concat(t,"%")},"aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"100"})})})]}),e.size<1e8&&(0,L.jsx)("div",{className:"progress-container d-flex align-items-center",children:(0,L.jsx)("div",{className:"progress",children:(0,L.jsx)("div",{className:"progress-bar",role:"progressbar",style:{width:"".concat(t,"%")},"aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"100"})})})]}),this.state.uploadState===O&&(0,L.jsx)("div",{className:"message err-message ml-0",dangerouslySetInnerHTML:{__html:i}})]}),(0,L.jsx)("td",{className:"upload-operation ellipsis",children:(0,L.jsxs)(h.Fragment,{children:[this.state.uploadState===N&&(0,L.jsx)("a",{href:"#",onClick:this.onUploadCancel,children:(0,k.ih)("Cancel")}),this.state.uploadState===O&&(0,L.jsx)("a",{href:"#",onClick:this.onUploadRetry,children:(0,k.ih)("Retry")}),this.state.uploadState===T&&(0,L.jsx)("span",{className:"saving",children:(0,k.ih)("Saving...")}),this.state.uploadState===E&&(0,L.jsx)("span",{className:"uploaded",children:(0,k.ih)("Uploaded")})]})})]})}}]),i}(h.Component),z=function(e){(0,l.Z)(i,e);var t=(0,c.Z)(i);function i(){return(0,o.Z)(this,i),t.apply(this,arguments)}return(0,s.Z)(i,[{key:"render",value:function(){var e=this.props.file,t=(0,k.ih)("Please upload files less than {placeholder}M").replace("{placeholder}",k.Og);return(0,L.jsxs)("tr",{className:"file-upload-item",children:[(0,L.jsx)("td",{className:"upload-name",children:(0,L.jsx)("div",{className:"ellipsis",title:e.name,children:e.name})}),(0,L.jsx)("td",{colSpan:3,className:"error",children:t})]})}}]),i}(h.Component),R=z,A=function(e){(0,l.Z)(i,e);var t=(0,c.Z)(i);function i(e){var n;return(0,o.Z)(this,i),(n=t.call(this,e)).onCancelAllUploading=function(){n.props.onCancelAllUploading()},n.onMinimizeUpload=function(e){e.nativeEvent.stopImmediatePropagation(),n.setState({isMinimized:!n.state.isMinimized})},n.onCloseUpload=function(e){e.nativeEvent.stopImmediatePropagation(),n.props.onCloseUploadDialog()},n.state={isMinimized:!1},n}return(0,s.Z)(i,[{key:"render",value:function(){var e=this,t=w.c.formatBitRate(this.props.uploadBitrate),i=(0,k.ih)("File Upload"),n=(0,k.ih)("File Uploading...")+" "+this.props.totalProgress+"% ("+t+")",a=(0,L.jsx)("span",{className:"sf2-icon-minus",onClick:this.onMinimizeUpload}),o=(0,L.jsxs)(h.Fragment,{children:[(0,L.jsx)("span",{className:"sf2-icon-minus",onClick:this.onMinimizeUpload}),(0,L.jsx)("span",{className:"sf2-icon-x1",onClick:this.onCloseUpload})]}),s=this.props,r=s.totalProgress,l=s.allFilesUploaded,c=s.retryFileList;return(0,L.jsxs)("div",{className:"uploader-list-view mw-100",style:{height:this.state.isMinimized?"2.25rem":"20rem"},children:[(0,L.jsxs)("div",{className:"uploader-list-header",children:[(0,L.jsx)("div",{className:"title",children:100===r?i:n}),(0,L.jsx)("div",{className:"uploader-options",children:100===r||l?o:a})]}),(0,L.jsxs)("div",{className:"uploader-list-content",children:[(0,L.jsxs)("div",{className:"text-right mt-2",children:[c.length>0?(0,L.jsx)("span",{className:"cursor-pointer",onClick:this.props.onUploadRetryAll,children:(0,k.ih)("Retry All")}):(0,L.jsx)("span",{className:"cursor-pointer disabled-link",children:(0,k.ih)("Retry All")}),l?(0,L.jsx)("span",{className:"cursor-pointer ml-3 disabled-link",children:(0,k.ih)("Cancel All")}):(0,L.jsx)("span",{className:"cursor-pointer ml-3",onClick:this.onCancelAllUploading,children:(0,k.ih)("Cancel All")})]}),(0,L.jsxs)("table",{className:"table-thead-hidden",children:[(0,L.jsx)("thead",{children:(0,L.jsxs)("tr",{children:[(0,L.jsx)("th",{width:"30%",children:(0,k.ih)("name")}),(0,L.jsx)("th",{width:"20%",children:(0,k.ih)("size")}),(0,L.jsx)("th",{width:"30%",children:(0,k.ih)("progress")}),(0,L.jsx)("th",{width:"20%",children:(0,k.ih)("state")})]})}),(0,L.jsxs)("tbody",{children:[this.props.forbidUploadFileList.map((function(e,t){return(0,L.jsx)(R,{file:e},t)})),this.props.uploadFileList.map((function(t,i){return(0,L.jsx)(U,{resumableFile:t,onUploadCancel:e.props.onUploadCancel,onUploadRetry:e.props.onUploadRetry},i)}))]})]})]})]})}}]),i}(h.Component),B=(i(87575),function(e){(0,l.Z)(i,e);var t=(0,c.Z)(i);function i(e){var n;return(0,o.Z)(this,i),(n=t.call(this,e)).componentWillUnmount=function(){window.onbeforeunload=null,!0===n.props.dragAndDrop&&n.resumable.disableDropOnDocument()},n.onbeforeunload=function(){if(window.uploader&&window.uploader.isUploadProgressDialogShow&&100!==window.uploader.totalProgress)return""},n.bindCallbackHandler=function(){var e=n.props,t=e.minFileSizeErrorCallback,i=e.fileTypeErrorCallback;n.maxFilesErrorCallback&&(n.resumable.opts.maxFilesErrorCallback=n.maxFilesErrorCallback),t&&(n.resumable.opts.minFileSizeErrorCallback=n.props.minFileSizeErrorCallback),n.maxFileSizeErrorCallback&&(n.resumable.opts.maxFileSizeErrorCallback=n.maxFileSizeErrorCallback),i&&(n.resumable.opts.fileTypeErrorCallback=n.props.fileTypeErrorCallback)},n.bindEventHandler=function(){n.resumable.on("chunkingComplete",n.onChunkingComplete.bind((0,r.Z)(n))),n.resumable.on("fileAdded",n.onFileAdded.bind((0,r.Z)(n))),n.resumable.on("filesAddedComplete",n.filesAddedComplete.bind((0,r.Z)(n))),n.resumable.on("fileProgress",n.onFileProgress.bind((0,r.Z)(n))),n.resumable.on("fileSuccess",n.onFileUploadSuccess.bind((0,r.Z)(n))),n.resumable.on("progress",n.onProgress.bind((0,r.Z)(n))),n.resumable.on("complete",n.onComplete.bind((0,r.Z)(n))),n.resumable.on("pause",n.onPause.bind((0,r.Z)(n))),n.resumable.on("fileRetry",n.onFileRetry.bind((0,r.Z)(n))),n.resumable.on("fileError",n.onFileError.bind((0,r.Z)(n))),n.resumable.on("error",n.onError.bind((0,r.Z)(n))),n.resumable.on("beforeCancel",n.onBeforeCancel.bind((0,r.Z)(n))),n.resumable.on("cancel",n.onCancel.bind((0,r.Z)(n))),n.resumable.on("dragstart",n.onDragStart.bind((0,r.Z)(n)))},n.maxFilesErrorCallback=function(e,t){var i=k.dd,n=(0,k.ih)("Please upload no more than {maxFiles} files at a time.");n=n.replace("{maxFiles}",i),C.Z.danger(n)},n.maxFileSizeErrorCallback=function(e){var t=n.state.forbidUploadFileList;t.push(e),n.setState({forbidUploadFileList:t})},n.onChunkingComplete=function(e){!0===n.state.allFilesUploaded&&n.setState({allFilesUploaded:!1});var t="/"===n.props.path?"/":n.props.path+"/",i=e.fileName,a=e.relativePath,o=i===a;if(e.formData={},o)e.formData={parent_dir:t};else{var s=a.slice(0,a.lastIndexOf("/")+1);e.formData={parent_dir:t,relative_path:s}}},n.onFileAdded=function(e,t){if(e.fileName===e.relativePath&&1===t.length){n.setUploadFileList(n.resumable.files);var i=n.props,a=i.token,o=i.relativePath;j.I.sharedLinkGetFileUploadUrl(a,o).then((function(t){n.resumable.opts.target=t.data.upload_link+"?ret-json=1",n.resumableUpload(e)})).catch((function(e){var t=w.c.getErrorMsg(e);C.Z.danger(t)}))}else if(n.setUploadFileList(n.resumable.files),!n.isUploadLinkLoaded){n.isUploadLinkLoaded=!0;var s=n.props,r=s.token,l=s.relativePath;j.I.sharedLinkGetFileUploadUrl(r,l).then((function(e){n.resumable.opts.target=e.data.upload_link+"?ret-json=1",n.resumable.upload()})).catch((function(e){var t=w.c.getErrorMsg(e);C.Z.danger(t)}))}},n.resumableUpload=function(e){var t=n.props,i=t.repoID,a=t.path;j.I.getFileUploadedBytes(i,a,e.fileName).then((function(t){var i=t.data.uploadedBytes,a=1024*parseInt(k.pL)*1024||1048576,o=Math.floor(i/a);e.markChunksCompleted(o),n.resumable.upload()})).catch((function(e){var t=w.c.getErrorMsg(e);C.Z.danger(t)}))},n.filesAddedComplete=function(e,t){n.state.forbidUploadFileList.length>0&&0===t.length&&n.setState({isUploadProgressDialogShow:!0,totalProgress:100})},n.setUploadFileList=function(){var e=n.resumable.files;n.setState({uploadFileList:e,isUploadProgressDialogShow:!0}),w.c.registerGlobalVariable("uploader","isUploadProgressDialogShow",!0)},n.onFileProgress=function(e){var t=n.getBitrate(),i=n.state.uploadFileList.map((function(i){if(i.uniqueIdentifier===e.uniqueIdentifier&&t){var n=8*(i.size-i.size*i.progress()),a=Math.floor(n/t);i.remainingTime=a}return i}));n.setState({uploadBitrate:t,uploadFileList:i})},n.getBitrate=function(){var e=0,t=0,i=(new Date).getTime();if(n.resumable.files.forEach((function(t){e+=t.progress()*t.size})),n.timestamp){var a=i-n.timestamp;if(a<n.bitrateInterval)return n.state.uploadBitrate;(e<n.loaded||0===n.loaded)&&(n.loaded=e),t=(e-n.loaded)*(1e3/a)*8}return n.timestamp=i,n.loaded=e,t},n.onProgress=function(){var e=Math.round(100*n.resumable.progress());n.setState({totalProgress:e}),w.c.registerGlobalVariable("uploader","totalProgress",e)},n.onFileUploadSuccess=function(e,t){var i=e.formData,a=(new Date).getTime()/1e3;t=i.replace?t:JSON.parse(t)[0],i.relative_path;var o={id:t.id,type:"file",name:t.name,size:t.size,mtime:a};n.props.onFileUploadSuccess(o);var s=n.state.uploadFileList.map((function(i){return i.uniqueIdentifier===e.uniqueIdentifier&&(i.newFileName=t.name,i.isSaved=!0),i}));n.setState({uploadFileList:s})},n.onFileError=function(e,t){var i="";if(t){var a=t.replace(/\n/g,"");a=JSON.parse(a),"File locked by others."===(i=a.error)&&(i=(0,k.ih)("File is locked by others.")),"Internal error."===i&&(i=(0,k.ih)("Internal Server Error"))}else i=(0,k.ih)("Network error");var o=n.state.uploadFileList.map((function(t){return t.uniqueIdentifier===e.uniqueIdentifier&&(n.state.retryFileList.push(t),t.error=i),t}));n.loaded=0,n.setState({retryFileList:n.state.retryFileList,uploadFileList:o})},n.onComplete=function(){n.notifiedFolders=[],n.isUploadLinkLoaded=!1,n.setState({allFilesUploaded:!0})},n.onPause=function(){},n.onError=function(e){n.isUploadLinkLoaded=!1,w.c.registerGlobalVariable("uploader","totalProgress",100)},n.onFileRetry=function(){},n.onBeforeCancel=function(){},n.onCancel=function(){},n.setHeaders=function(e,t){var i=t.offset,n=t.getOpt("chunkSize"),a=0===e.size?1:e.size,o=0!==i?i*n:0,s=Math.min(a,(i+1)*n)-1;return a-t.endByte<n&&!t.getOpt("forceChunkSize")&&(s=a),{Accept:"application/json; text/javascript, */*; q=0.01","Content-Disposition":'attachment; filename="'+encodeURI(e.fileName)+'"',"Content-Range":"bytes "+o+"-"+s+"/"+a}},n.setQuery=function(e){return e.formData},n.generateUniqueIdentifier=function(e){var t=e.webkitRelativePath||e.relativePath||e.fileName||e.name;return u()(t+new Date)+t},n.onClick=function(e){e.nativeEvent.stopImmediatePropagation(),e.stopPropagation()},n.onFileUpload=function(){n.uploadInput.current.removeAttribute("webkitdirectory"),n.uploadInput.current.click()},n.onFolderUpload=function(){n.uploadInput.current.setAttribute("webkitdirectory","webkitdirectory"),n.uploadInput.current.click()},n.onDragStart=function(){n.uploadInput.current.setAttribute("webkitdirectory","webkitdirectory")},n.onCloseUploadDialog=function(){n.loaded=0,n.resumable.files=[],n.isUploadLinkLoaded=!1,n.setState({isUploadProgressDialogShow:!1,uploadFileList:[],forbidUploadFileList:[]}),w.c.registerGlobalVariable("uploader","isUploadProgressDialogShow",!1)},n.onUploadCancel=function(e){var t=n.state.uploadFileList.filter((function(t){return t.uniqueIdentifier!==e.uniqueIdentifier||(t.cancel(),!1)}));n.resumable.isUploading()||(n.setState({totalProgress:"100",allFilesUploaded:!0}),n.loaded=0),n.setState({uploadFileList:t})},n.onCancelAllUploading=function(){var e=n.state.uploadFileList.filter((function(e){return!Math.round(1!==e.progress())||(e.cancel(),!1)}));n.loaded=0,n.setState({allFilesUploaded:!0,totalProgress:"100",uploadFileList:e}),n.isUploadLinkLoaded=!1},n.onUploadRetry=function(e){var t=n.props,i=t.token,a=t.relativePath;j.I.sharedLinkGetFileUploadUrl(i,a).then((function(t){n.resumable.opts.target=t.data.upload_link+"?ret-json=1";var i=n.state.retryFileList.filter((function(t){return t.uniqueIdentifier!==e.uniqueIdentifier})),a=n.state.uploadFileList.map((function(t){return t.uniqueIdentifier===e.uniqueIdentifier&&(t.error=null,n.retryUploadFile(t)),t}));n.setState({retryFileList:i,uploadFileList:a})})).catch((function(e){var t=w.c.getErrorMsg(e);C.Z.danger(t)}))},n.onUploadRetryAll=function(){var e=n.props,t=e.token,i=e.relativePath;j.I.sharedLinkGetFileUploadUrl(t,i).then((function(e){n.resumable.opts.target=e.data.upload_link+"?ret-json=1",n.state.retryFileList.forEach((function(e){e.error=!1,n.retryUploadFile(e)}));var t=n.state.uploadFileList.slice(0);n.setState({retryFileList:[],uploadFileList:t})})).catch((function(e){var t=w.c.getErrorMsg(e);C.Z.danger(t)}))},n.retryUploadFile=function(e){var t=n.props,i=t.repoID,a=t.path,o=e.fileName;if(!(e.fileName===e.relativePath)){var s=e.formData.relative_path;o=("/"===a?a+s:a+"/"+s)+o}e.bootstrap();var r=!1;e.resumableObj.on("chunkingComplete",(function(){r||j.I.getFileUploadedBytes(i,a,o).then((function(t){var i=t.data.uploadedBytes,n=1024*parseInt(k.pL)*1024||1048576,a=Math.floor(i/n);e.markChunksCompleted(a),e.resumableObj.upload()})).catch((function(e){var t=w.c.getErrorMsg(e);C.Z.danger(t)})),r=!0}))},n.uploadFile=function(){var e=n.resumable.files[n.resumable.files.length-1],t=n.props,i=t.token,a=t.relativePath;j.I.sharedLinkGetFileUploadUrl(i,a).then((function(t){n.resumable.opts.target=t.data.upload_link+"?ret-json=1",n.setState({isUploadRemindDialogShow:!1,isUploadProgressDialogShow:!0,uploadFileList:[].concat((0,F.Z)(n.state.uploadFileList),[e])},(function(){n.resumable.upload()})),w.c.registerGlobalVariable("uploader","isUploadProgressDialogShow",!0)})).catch((function(e){var t=w.c.getErrorMsg(e);C.Z.danger(t)}))},n.cancelFileUpload=function(){n.resumable.files.pop(),n.setState({isUploadRemindDialogShow:!1})},n.state={retryFileList:[],uploadFileList:[],forbidUploadFileList:[],totalProgress:0,isUploadProgressDialogShow:!1,isUploadRemindDialogShow:!1,currentResumableFile:null,uploadBitrate:0,allFilesUploaded:!1},n.uploadInput=h.createRef(),n.notifiedFolders=[],n.timestamp=null,n.loaded=0,n.bitrateInterval=500,window.onbeforeunload=n.onbeforeunload,n.isUploadLinkLoaded=!1,n}return(0,s.Z)(i,[{key:"componentDidMount",value:function(){this.resumable=new(Z())({target:"",query:this.setQuery||{},fileType:this.props.filetypes,maxFiles:k.dd||void 0,maxFileSize:1e3*k.Og*1e3||void 0,testMethod:this.props.testMethod||"post",testChunks:this.props.testChunks||!1,headers:this.setHeaders||{},withCredentials:this.props.withCredentials||!1,chunkSize:1024*parseInt(k.pL)*1024||1048576,simultaneousUploads:this.props.simultaneousUploads||1,fileParameterName:this.props.fileParameterName,generateUniqueIdentifier:this.generateUniqueIdentifier,forceChunkSize:!0,maxChunkRetries:3,minFileSize:0}),this.resumable.assignBrowse(this.uploadInput.current,!0),!0===this.props.dragAndDrop&&this.resumable.enableDropOnDocument(),this.bindCallbackHandler(),this.bindEventHandler()}},{key:"render",value:function(){return(0,L.jsxs)(h.Fragment,{children:[(0,L.jsx)("div",{className:"file-uploader-container",children:(0,L.jsx)("div",{className:"file-uploader",children:(0,L.jsx)("input",{className:"upload-input",type:"file",ref:this.uploadInput,onClick:this.onClick})})}),this.state.isUploadProgressDialogShow&&(0,L.jsx)(A,{retryFileList:this.state.retryFileList,uploadFileList:this.state.uploadFileList,forbidUploadFileList:this.state.forbidUploadFileList,totalProgress:this.state.totalProgress,uploadBitrate:this.state.uploadBitrate,allFilesUploaded:this.state.allFilesUploaded,onCloseUploadDialog:this.onCloseUploadDialog,onCancelAllUploading:this.onCancelAllUploading,onUploadCancel:this.onUploadCancel,onUploadRetry:this.onUploadRetry,onUploadRetryAll:this.onUploadRetryAll})]})}}]),i}(h.Component)),q=B,Y=i(42995),X=i(12756),W=i(12213),H=i(93869),K=i(7764),G=i(62150),V=function(e){(0,l.Z)(i,e);var t=(0,c.Z)(i);function i(e){var n;return(0,o.Z)(this,i),(n=t.call(this,e)).onSaveSharedFile=function(){n.props.handleSaveSharedDir(n.state.repo.repo_id,n.state.selectedPath)},n.onDirentItemClick=function(e,t,i){"dir"===i.type?n.setState({repo:e,selectedPath:t}):n.setState({repo:null,selectedPath:""})},n.onRepoItemClick=function(e){n.setState({repo:e,selectedPath:"/"})},n.state={repo:null,selectedPath:"",errMessage:""},n}return(0,s.Z)(i,[{key:"render",value:function(){return(0,L.jsxs)(Y.Z,{isOpen:!0,className:"sf-save-file",toggle:this.props.toggleCancel,children:[(0,L.jsx)(X.Z,{toggle:this.props.toggleCancel,children:(0,k.ih)("Save to:")}),(0,L.jsxs)(W.Z,{children:[(0,L.jsx)(G.Z,{isShowFile:!1,onDirentItemClick:this.onDirentItemClick,onRepoItemClick:this.onRepoItemClick,mode:"only_all_repos"}),this.state.errMessage&&(0,L.jsx)(H.Z,{color:"danger",children:this.state.errMessage})]}),(0,L.jsxs)(K.Z,{children:[(0,L.jsx)(m.Z,{color:"secondary",onClick:this.props.toggleCancel,children:(0,k.ih)("Cancel")}),this.state.selectedPath?(0,L.jsx)(m.Z,{color:"primary",onClick:this.onSaveSharedFile,children:(0,k.ih)("Submit")}):(0,L.jsx)(m.Z,{color:"primary",disabled:!0,children:(0,k.ih)("Submit")})]})]})}}]),i}(h.Component),$=i(91188),Q=i(43916),J=i(69443);i(62012);x().locale(window.app.config.lang);var ee=window.app.pageOptions.name,te=window.shared.pageOptions,ie=te.token,ne=te.dirName,ae=te.dirPath,oe=te.sharedBy,se=te.repoID,re=te.relativePath,le=te.mode,ce=te.thumbnailSize,he=te.zipped,de=te.trafficOverLimit,ue=te.canDownload,pe=te.noQuota,me=te.canUpload,fe=te.enableVideoThumbnail,ge=!de&&ue,ve=function(e){(0,l.Z)(i,e);var t=(0,c.Z)(i);function i(e){var n;return(0,o.Z)(this,i),(n=t.call(this,e)).sortItems=function(e,t){n.setState({sortBy:e,sortOrder:t,items:w.c.sortDirentsInSharedDir(n.state.items,e,t)})},n.getThumbnails=function(){var e=n.state.items.filter((function(e){return!e.is_dir&&(w.c.imageCheck(e.file_name)||fe&&w.c.videoCheck(e.file_name))&&!e.encoded_thumbnail_src}));if(0!=e.length){var t=e.length,i=(0,r.Z)(n);!function n(a){var o=e[a];j.I.getShareLinkThumbnail(ie,o.file_path,ce).then((function(e){o.encoded_thumbnail_src=e.data.encoded_thumbnail_src})).catch((function(e){})).then((function(){a<t-1?n(++a):i.setState({items:i.state.items})}))}(0)}},n.renderPath=function(){return(0,L.jsxs)(h.Fragment,{children:[he.map((function(e,t){return t!=he.length-1?(0,L.jsxs)(h.Fragment,{children:[(0,L.jsx)("a",{href:"?p=".concat(encodeURIComponent(e.path),"&mode=").concat(le),className:"mx-1 ellipsis",title:e.name,children:e.name}),(0,L.jsx)("span",{children:" / "})]},t):null})),(0,L.jsx)("span",{className:"ml-1 ellipsis",title:he[he.length-1].name,children:he[he.length-1].name})]})},n.zipDownloadFolder=function(e){k.Zb?j.I.getShareLinkZipTask(ie,e).then((function(e){var t=e.data.zip_token;location.href="".concat(k.gc,"zip/").concat(t)})).catch((function(e){var t=w.c.getErrorMsg(e);n.setState({isLoading:!1,errorMsg:t})})):n.setState({isZipDialogOpen:!0,zipFolderPath:e})},n.zipDownloadSelectedItems=function(){if(k.Zb){var e=n.state.items.filter((function(e){return e.isSelected})).map((function(e){return e.file_name||e.folder_name}));j.I.getShareLinkDirentsZipTask(ie,re,e).then((function(e){var t=e.data.zip_token;location.href="".concat(k.gc,"zip/").concat(t)})).catch((function(e){var t=w.c.getErrorMsg(e);n.setState({isLoading:!1,errorMsg:t})}))}else n.setState({isZipDialogOpen:!0,zipFolderPath:re,selectedItems:n.state.items.filter((function(e){return e.isSelected})).map((function(e){return e.file_name||e.folder_name}))})},n.saveSelectedItems=function(){n.setState({isSaveSharedDirDialogShow:!0,itemsForSave:n.state.items.filter((function(e){return e.isSelected})).map((function(e){return e.file_name||e.folder_name}))})},n.saveAllItems=function(){n.setState({isSaveSharedDirDialogShow:!0,itemsForSave:n.state.items.map((function(e){return e.file_name||e.folder_name}))})},n.toggleSaveSharedDirCancel=function(){n.setState({isSaveSharedDirDialogShow:!1,itemsForSave:[]})},n.handleSaveSharedDir=function(e,t){var i=n.state.itemsForSave;j.I.saveSharedDir(e,t,ie,re,i).then((function(e){n.setState({isSaveSharedDirDialogShow:!1,itemsForSave:[],isCopyMoveProgressDialogShow:!0,asyncCopyMoveTaskId:e.data.task_id,asyncOperatedFilesLength:i.length},(function(){n.getAsyncCopyMoveProgress()}))})).catch((function(e){var t=w.c.getErrorMsg(e);n.setState({errMessage:t})}))},n.onProgressDialogToggle=function(){if(100!==n.state.asyncOperationProgress){var e=n.state.asyncCopyMoveTaskId;j.I.cancelCopyMoveOperation(e)}n.setState({asyncOperationProgress:0,isCopyMoveProgressDialogShow:!1})},n.closeZipDialog=function(){n.setState({isZipDialogOpen:!1,zipFolderPath:"",selectedItems:[]})},n.prepareImageItem=function(e){var t=e.file_name,i="gif"==t.substr(t.lastIndexOf(".")+1).toLowerCase(),n="".concat(k.ze,"d/").concat(ie,"/files/?p=").concat(encodeURIComponent(e.file_path));return{name:t,url:n,src:i?"".concat(n,"&raw=1"):"".concat(k.ze,"thumbnail/").concat(ie,"/").concat(k.fp).concat(w.c.encodePath(e.file_path))}},n.showImagePopup=function(e){var t=n.state.items.filter((function(e){return!e.is_dir&&w.c.imageCheck(e.file_name)})),i=t.map((function(e){return n.prepareImageItem(e)}));n.setState({isImagePopupOpen:!0,imageItems:i,imageIndex:t.indexOf(e)})},n.closeImagePopup=function(){n.setState({isImagePopupOpen:!1})},n.moveToPrevImage=function(){var e=n.state.imageItems.length;n.setState((function(t){return{imageIndex:(t.imageIndex+e-1)%e}}))},n.moveToNextImage=function(){var e=n.state.imageItems.length;n.setState((function(t){return{imageIndex:(t.imageIndex+1)%e}}))},n.toggleAllSelected=function(){n.setState((function(e){return{isAllItemsSelected:!e.isAllItemsSelected,items:n.state.items.map((function(t){return t.isSelected=!e.isAllItemsSelected,t}))}}))},n.toggleItemSelected=function(e,t){n.setState({items:n.state.items.map((function(i){return i===e&&(i.isSelected=t),i}))},(function(){n.setState({isAllItemsSelected:!n.state.items.some((function(e){return!e.isSelected}))})}))},n.onUploadFile=function(e){e.nativeEvent.stopImmediatePropagation(),n.uploader.onFileUpload()},n.onFileUploadSuccess=function(e){var t=e.name,i=e.size,a={isSelected:!1,file_name:t,file_path:w.c.joinPath(re,t),is_dir:!1,last_modified:x()().format(),size:i},o=n.state.items.filter((function(e){return e.is_dir})),s=Array.from(n.state.items);s.splice(o.length,0,a),n.setState({items:s}),j.I.shareLinksUploadDone(ie,w.c.joinPath(ae,t))},n.getShareLinkRepoTags=function(){j.I.getShareLinkRepoTags(ie).then((function(e){var t=[];e.data.repo_tags.forEach((function(e){var i=new J.Z(e);i.fileCount>0&&t.push(i)})),n.setState({usedRepoTags:t}),0!=t.length&&"/"==re&&n.setState({isRepoInfoBarShow:!0})})).catch((function(e){var t=w.c.getErrorMsg(e);C.Z.danger(t)}))},n.state={isLoading:!0,errorMsg:"",items:[],isAllItemsSelected:!1,selectedItems:[],sortBy:"name",sortOrder:"asc",isZipDialogOpen:!1,zipFolderPath:"",usedRepoTags:[],isRepoInfoBarShow:!1,isSaveSharedDirDialogShow:!1,itemsForSave:[],asyncCopyMoveTaskId:"",asyncOperationProgress:0,asyncOperatedFilesLength:0,isCopyMoveProgressDialogShow:!1,isImagePopupOpen:!1,imageItems:[],imageIndex:0},n}return(0,s.Z)(i,[{key:"componentDidMount",value:function(){var e=this;de&&C.Z.danger((0,k.ih)("File download is disabled: the share link traffic of owner is used up."),{duration:3}),j.I.listSharedDir(ie,re,ce).then((function(t){var i=t.data.dirent_list.map((function(e){return e.isSelected=!1,e}));e.setState({isLoading:!1,errorMsg:"",items:w.c.sortDirentsInSharedDir(i,e.state.sortBy,e.state.sortOrder)}),e.getThumbnails()})).catch((function(t){var i=w.c.getErrorMsg(t);e.setState({isLoading:!1,errorMsg:i})})),this.getShareLinkRepoTags()}},{key:"getAsyncCopyMoveProgress",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){var t,i,a,o,s,r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.asyncCopyMoveTaskId,e.prev=1,e.next=4,j.I.queryAsyncOperationProgress(t);case 4:if(i=e.sent,!(a=i.data).failed){e.next=11;break}return o=(0,k.ih)("Failed to copy files to another library."),C.Z.danger(o),this.setState({asyncOperationProgress:0,isCopyMoveProgressDialogShow:!1}),e.abrupt("return");case 11:if(!a.successful){e.next=16;break}return this.setState({asyncOperationProgress:0,isCopyMoveProgressDialogShow:!1}),s=(0,k.ih)("Successfully copied files to another library."),C.Z.success(s),e.abrupt("return");case 16:r=a.total?parseInt((a.done/a.total*100).toFixed(2)):0,this.getAsyncCopyMoveProgress(),this.setState({asyncOperationProgress:r}),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(1),this.setState({asyncOperationProgress:0,isCopyMoveProgressDialogShow:!1});case 24:case"end":return e.stop()}}),e,this,[[1,21]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=w.c.isDesktop(),i="btn btn-secondary btn-icon sf-view-mode-btn";return(0,L.jsxs)(h.Fragment,{children:[(0,L.jsxs)("div",{className:"h-100 d-flex flex-column",children:[(0,L.jsxs)("div",{className:"top-header d-flex justify-content-between",children:[(0,L.jsx)("a",{href:k.ze,children:(0,L.jsx)("img",{src:k.si+k.j1,height:k.AN,width:k.Bv,title:k.y7,alt:"logo"})}),ee&&(0,L.jsx)(S.Z,{})]}),(0,L.jsx)("div",{className:"o-auto",children:(0,L.jsxs)("div",{className:"shared-dir-view-main",children:[(0,L.jsx)("h2",{className:"h3",children:ne}),(0,L.jsxs)("p",{children:[(0,k.ih)("Shared by: "),oe]}),(0,L.jsxs)("div",{className:"d-flex justify-content-between align-items-center op-bar",children:[(0,L.jsxs)("p",{className:"m-0 mr-4 ellipsis d-flex align-items-center",children:[(0,L.jsx)("span",{className:"flex-none",children:(0,k.ih)("Current path: ")}),this.renderPath()]}),(0,L.jsxs)("div",{className:"flex-none",children:[t&&(0,L.jsxs)("div",{className:"view-mode btn-group",children:[(0,L.jsx)("a",{href:"?p=".concat(encodeURIComponent(re),"&mode=list"),className:"".concat(i," sf2-icon-list-view ").concat("list"==le?"current-mode":""),title:(0,k.ih)("List"),"aria-label":(0,k.ih)("List")}),(0,L.jsx)("a",{href:"?p=".concat(encodeURIComponent(re),"&mode=grid"),className:"".concat(i," sf2-icon-grid-view ").concat("grid"==le?"current-mode":""),title:(0,k.ih)("Grid"),"aria-label":(0,k.ih)("Grid")})]}),me&&(0,L.jsx)(m.Z,{disabled:pe,title:pe?(0,k.ih)("The owner of this library has run out of space."):"",onClick:this.onUploadFile,className:"ml-2 shared-dir-op-btn shared-dir-upload-btn",children:(0,k.ih)("Upload")}),ge&&(0,L.jsx)(h.Fragment,{children:this.state.items.some((function(e){return e.isSelected}))?(0,L.jsxs)(h.Fragment,{children:[(0,L.jsx)(m.Z,{color:"success",onClick:this.zipDownloadSelectedItems,className:"ml-2 shared-dir-op-btn",children:(0,k.ih)("ZIP Selected Items")}),ue&&ee&&ee!==oe&&(0,L.jsx)(m.Z,{color:"success",onClick:this.saveSelectedItems,className:"ml-2 shared-dir-op-btn",children:(0,k.ih)("Save Selected Items")})]}):(0,L.jsxs)(h.Fragment,{children:[(0,L.jsx)(m.Z,{color:"success",onClick:this.zipDownloadFolder.bind(this,re),className:"ml-2 shared-dir-op-btn",children:(0,k.ih)("ZIP")}),ue&&ee&&ee!==oe&&(0,L.jsx)(m.Z,{color:"success",onClick:this.saveAllItems,className:"ml-2 shared-dir-op-btn",children:(0,k.ih)("Save")})]})})]})]}),!pe&&me&&(0,L.jsx)(q,{ref:function(t){return e.uploader=t},dragAndDrop:!1,token:ie,path:"/"===ae?ae:ae.replace(/\/+$/,""),relativePath:"/"===re?re:re.replace(/\/+$/,""),repoID:se,onFileUploadSuccess:this.onFileUploadSuccess}),this.state.isRepoInfoBarShow&&(0,L.jsx)(Q.Z,{repoID:se,currentPath:"/",usedRepoTags:this.state.usedRepoTags,shareLinkToken:ie,enableFileDownload:ge,className:"mx-0"}),(0,L.jsx)(be,{isDesktop:t,isLoading:this.state.isLoading,errorMsg:this.state.errorMsg,items:this.state.items,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems,isAllItemsSelected:this.state.isAllItemsSelected,toggleAllSelected:this.toggleAllSelected,toggleItemSelected:this.toggleItemSelected,zipDownloadFolder:this.zipDownloadFolder,showImagePopup:this.showImagePopup})]})})]}),this.state.isZipDialogOpen&&(0,L.jsx)(D.Z,{children:(0,L.jsx)(M.Z,{token:ie,path:this.state.zipFolderPath,target:this.state.selectedItems,toggleDialog:this.closeZipDialog})}),this.state.isSaveSharedDirDialogShow&&(0,L.jsx)(V,{sharedToken:ie,parentDir:re,items:this.state.itemsForSave,toggleCancel:this.toggleSaveSharedDirCancel,handleSaveSharedDir:this.handleSaveSharedDir}),this.state.isCopyMoveProgressDialogShow&&(0,L.jsx)($.Z,{type:"copy",asyncOperatedFilesLength:this.state.asyncOperatedFilesLength,asyncOperationProgress:this.state.asyncOperationProgress,toggleDialog:this.onProgressDialogToggle}),this.state.isImagePopupOpen&&(0,L.jsx)(D.Z,{children:(0,L.jsx)(_.Z,{imageItems:this.state.imageItems,imageIndex:this.state.imageIndex,closeImagePopup:this.closeImagePopup,moveToPrevImage:this.moveToPrevImage,moveToNextImage:this.moveToNextImage})})]})}}]),i}(h.Component),be=function(e){(0,l.Z)(i,e);var t=(0,c.Z)(i);function i(e){var n;return(0,o.Z)(this,i),(n=t.call(this,e)).sortByName=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortItems("name",t)},n.sortByTime=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortItems("time",t)},n.sortBySize=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortItems("size",t)},n}return(0,s.Z)(i,[{key:"render",value:function(){var e=this,t=this.props,i=t.isDesktop,n=t.isLoading,a=t.errorMsg,o=t.items,s=t.sortBy,r=t.sortOrder,l=t.isAllItemsSelected;if(n)return(0,L.jsx)(I.Z,{});if(a)return(0,L.jsx)("p",{className:"error mt-6 text-center",children:a});var c=(0,L.jsx)("tbody",{children:o.map((function(t,n){return(0,L.jsx)(ye,{isDesktop:i,item:t,zipDownloadFolder:e.props.zipDownloadFolder,showImagePopup:e.props.showImagePopup,toggleItemSelected:e.props.toggleItemSelected},n)}))});if(!i)return(0,L.jsxs)("table",{className:"table-hover table-thead-hidden",children:[(0,L.jsx)("thead",{children:(0,L.jsxs)("tr",{children:[(0,L.jsx)("th",{width:"12%"}),(0,L.jsx)("th",{width:"80%"}),(0,L.jsx)("th",{width:"8%"})]})}),c]});var h=(0,L.jsx)("span",{className:"fas ".concat("asc"==r?"fa-caret-up":"fa-caret-down")});return"list"==le?(0,L.jsxs)("table",{className:"table-hover",children:[(0,L.jsx)("thead",{children:(0,L.jsxs)("tr",{children:[ge&&(0,L.jsx)("th",{width:"3%",className:"text-center",children:(0,L.jsx)("input",{type:"checkbox",checked:l,onChange:this.props.toggleAllSelected})}),(0,L.jsx)("th",{width:"5%"}),(0,L.jsx)("th",{width:ge?"50%":"53%",children:(0,L.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByName,children:[(0,k.ih)("Name")," ","name"==s&&h]})}),(0,L.jsx)("th",{width:"8%"}),(0,L.jsx)("th",{width:"14%",children:(0,L.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortBySize,children:[(0,k.ih)("Size")," ","size"==s&&h]})}),(0,L.jsx)("th",{width:"13%",children:(0,L.jsxs)("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByTime,children:[(0,k.ih)("Last Update")," ","time"==s&&h]})}),(0,L.jsx)("th",{width:"7%"})]})}),c]}):(0,L.jsx)("ul",{className:"grid-view",children:o.map((function(t,i){return(0,L.jsx)(xe,{item:t,zipDownloadFolder:e.props.zipDownloadFolder,showImagePopup:e.props.showImagePopup},i)}))})}}]),i}(h.Component),ye=function(e){(0,l.Z)(i,e);var t=(0,c.Z)(i);function i(e){var n;return(0,o.Z)(this,i),(n=t.call(this,e)).toggleOpMenu=function(){n.setState({isOpMenuOpen:!n.state.isOpMenuOpen})},n.handleMouseOver=function(){n.setState({isIconShown:!0})},n.handleMouseOut=function(){n.setState({isIconShown:!1})},n.zipDownloadFolder=function(e){e.preventDefault(),n.props.zipDownloadFolder.bind((0,r.Z)(n),n.props.item.folder_path)()},n.handleFileClick=function(e){var t=n.props.item;w.c.imageCheck(t.file_name)&&(e.preventDefault(),n.props.showImagePopup(t))},n.toggleItemSelected=function(e){n.props.toggleItemSelected(n.props.item,e.target.checked)},n.state={isIconShown:!1,isOpMenuOpen:!1},n}return(0,s.Z)(i,[{key:"render",value:function(){var e=this.props,t=e.item,i=e.isDesktop,n=this.state.isIconShown,a="",o="";if(t.file_tags&&t.file_tags.length>0&&(a=u()(t.file_name).slice(0,7),o=t.file_tags.map((function(e){return e.tag_name})).join(" ")),t.is_dir)return i?(0,L.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[ge&&(0,L.jsx)("td",{className:"text-center",children:(0,L.jsx)("input",{type:"checkbox",checked:t.isSelected,onChange:this.toggleItemSelected})}),(0,L.jsx)("td",{className:"text-center",children:(0,L.jsx)("img",{src:w.c.getFolderIconUrl(),alt:"",width:"24"})}),(0,L.jsx)("td",{children:(0,L.jsx)("a",{href:"?p=".concat(encodeURIComponent(t.folder_path.substr(0,t.folder_path.length-1)),"&mode=").concat(le),children:t.folder_name})}),(0,L.jsx)("td",{}),(0,L.jsx)("td",{}),(0,L.jsx)("td",{title:x()(t.last_modified).format("llll"),children:x()(t.last_modified).fromNow()}),(0,L.jsx)("td",{children:ge&&(0,L.jsx)("a",{role:"button",className:"action-icon sf2-icon-download".concat(n?"":" invisible"),href:"#",onClick:this.zipDownloadFolder,title:(0,k.ih)("Download"),"aria-label":(0,k.ih)("Download")})})]}):(0,L.jsxs)("tr",{children:[(0,L.jsx)("td",{className:"text-center",children:(0,L.jsx)("img",{src:w.c.getFolderIconUrl(),alt:"",width:"24"})}),(0,L.jsxs)("td",{children:[(0,L.jsx)("a",{href:"?p=".concat(encodeURIComponent(t.folder_path.substr(0,t.folder_path.length-1)),"&mode=").concat(le),children:t.folder_name}),(0,L.jsx)("br",{}),(0,L.jsx)("span",{className:"item-meta-info",children:x()(t.last_modified).fromNow()})]}),(0,L.jsx)("td",{children:ge&&(0,L.jsxs)(f.Z,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu,children:[(0,L.jsx)(g.Z,{tag:"i",className:"sf-dropdown-toggle fa fa-ellipsis-v ml-0",title:(0,k.ih)("More operations"),"aria-label":(0,k.ih)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),(0,L.jsxs)("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu,children:[(0,L.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),(0,L.jsx)("div",{className:"mobile-operation-menu",children:(0,L.jsx)(v.Z,{className:"mobile-menu-item",onClick:this.zipDownloadFolder,children:(0,k.ih)("Download")})})]})]})})]});var s="".concat(k.ze,"d/").concat(ie,"/files/?p=").concat(encodeURIComponent(t.file_path)),r=t.encoded_thumbnail_src?"".concat(k.ze).concat(t.encoded_thumbnail_src):"";return i?(0,L.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[ge&&(0,L.jsx)("td",{className:"text-center",children:(0,L.jsx)("input",{type:"checkbox",checked:t.isSelected,onChange:this.toggleItemSelected})}),(0,L.jsx)("td",{className:"text-center",children:r?(0,L.jsx)("img",{className:"thumbnail",src:r,alt:""}):(0,L.jsx)("img",{src:w.c.getFileIconUrl(t.file_name),alt:"",width:"24"})}),(0,L.jsx)("td",{children:(0,L.jsx)("a",{href:s,onClick:this.handleFileClick,children:t.file_name})}),(0,L.jsx)("td",{className:"tag-list-title",children:t.file_tags&&t.file_tags.length>0&&(0,L.jsxs)(h.Fragment,{children:[(0,L.jsx)("div",{id:"tag-list-title-".concat(a),className:"dirent-item tag-list tag-list-stacked",children:t.file_tags.map((function(e,i){var n=t.file_tags.length;return(0,L.jsx)("span",{className:"file-tag",style:{zIndex:n-i,backgroundColor:e.tag_color}},e.file_tag_id)}))}),(0,L.jsx)(b.Z,{target:"tag-list-title-".concat(a),placement:"bottom",children:o})]})}),(0,L.jsx)("td",{children:w.c.bytesToSize(t.size)}),(0,L.jsx)("td",{title:x()(t.last_modified).format("llll"),children:x()(t.last_modified).fromNow()}),(0,L.jsx)("td",{children:ge&&(0,L.jsx)("a",{className:"action-icon sf2-icon-download".concat(n?"":" invisible"),href:"".concat(s,"&dl=1"),title:(0,k.ih)("Download"),"aria-label":(0,k.ih)("Download")})})]}):(0,L.jsxs)("tr",{children:[(0,L.jsx)("td",{className:"text-center",children:r?(0,L.jsx)("img",{className:"thumbnail",src:r,alt:""}):(0,L.jsx)("img",{src:w.c.getFileIconUrl(t.file_name),alt:"",width:"24"})}),(0,L.jsxs)("td",{children:[(0,L.jsx)("a",{href:s,onClick:this.handleFileClick,children:t.file_name}),(0,L.jsx)("br",{}),(0,L.jsx)("span",{className:"item-meta-info",children:w.c.bytesToSize(t.size)}),(0,L.jsx)("span",{className:"item-meta-info",children:x()(t.last_modified).fromNow()})]}),(0,L.jsx)("td",{children:ge&&(0,L.jsxs)(f.Z,{isOpen:this.state.isOpMenuOpen,toggle:this.toggleOpMenu,children:[(0,L.jsx)(g.Z,{tag:"i",className:"sf-dropdown-toggle fa fa-ellipsis-v ml-0",title:(0,k.ih)("More operations"),"aria-label":(0,k.ih)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isOpMenuOpen}),(0,L.jsxs)("div",{className:this.state.isOpMenuOpen?"":"d-none",onClick:this.toggleOpMenu,children:[(0,L.jsx)("div",{className:"mobile-operation-menu-bg-layer"}),(0,L.jsx)("div",{className:"mobile-operation-menu",children:(0,L.jsx)(v.Z,{className:"mobile-menu-item",tag:"a",href:"".concat(s,"&dl=1"),children:(0,k.ih)("Download")})})]})]})})]})}}]),i}(h.Component),xe=function(e){(0,l.Z)(i,e);var t=(0,c.Z)(i);function i(e){var n;return(0,o.Z)(this,i),(n=t.call(this,e)).handleMouseOver=function(){n.setState({isIconShown:!0})},n.handleMouseOut=function(){n.setState({isIconShown:!1})},n.zipDownloadFolder=function(e){e.preventDefault(),n.props.zipDownloadFolder.bind((0,r.Z)(n),n.props.item.folder_path)()},n.handleFileClick=function(e){var t=n.props.item;w.c.imageCheck(t.file_name)&&(e.preventDefault(),n.props.showImagePopup(t))},n.state={isIconShown:!1},n}return(0,s.Z)(i,[{key:"render",value:function(){var e=this.props.item,t=this.state.isIconShown;if(e.is_dir){var i="?p=".concat(encodeURIComponent(e.folder_path.substr(0,e.folder_path.length-1)),"&mode=").concat(le);return(0,L.jsxs)("li",{className:"grid-item",onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[(0,L.jsx)("a",{href:i,className:"grid-file-img-link d-block",children:(0,L.jsx)("img",{src:w.c.getFolderIconUrl(!1,192),alt:"",width:"96",height:"96"})}),(0,L.jsx)("a",{href:i,className:"grid-file-name grid-file-name-link",children:e.folder_name}),ge&&(0,L.jsx)("a",{role:"button",className:"action-icon sf2-icon-download".concat(t?"":" invisible"),href:"#",onClick:this.zipDownloadFolder,title:(0,k.ih)("Download"),"aria-label":(0,k.ih)("Download")})]})}var n="".concat(k.ze,"d/").concat(ie,"/files/?p=").concat(encodeURIComponent(e.file_path)),a=e.encoded_thumbnail_src?"".concat(k.ze).concat(e.encoded_thumbnail_src):"";return(0,L.jsxs)("li",{className:"grid-item",onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onFocus:this.handleMouseOver,children:[(0,L.jsx)("a",{href:n,className:"grid-file-img-link d-block",onClick:this.handleFileClick,children:a?(0,L.jsx)("img",{className:"thumbnail",src:a,alt:""}):(0,L.jsx)("img",{src:w.c.getFileIconUrl(e.file_name,192),alt:"",width:"96",height:"96"})}),(0,L.jsx)("a",{href:n,className:"grid-file-name grid-file-name-link",onClick:this.handleFileClick,children:e.file_name}),ge&&(0,L.jsx)("a",{className:"action-icon sf2-icon-download".concat(t?"":" invisible"),href:"".concat(n,"&dl=1"),title:(0,k.ih)("Download"),"aria-label":(0,k.ih)("Download")})]})}}]),i}(h.Component);p.render((0,L.jsx)(ve,{}),document.getElementById("wrapper"))},62012:function(){}},function(e){e.O(0,[351],(function(){return t=14472,e(e.s=t);var t}));e.O()}]);