/*! For license information please see sysAdmin.1a15333e.js.LICENSE.txt */
"use strict";(self.webpackChunkseahub_frontend=self.webpackChunkseahub_frontend||[]).push([[7583],{52622:function(e,t,n){var i=n(23029),s=n(92901),a=n(39874),r=n(85501),o=n(9950),l=n(8081),c=n(10877),d=n(6754),u=n(34322),h=n(65604),g=n(40326),p=n(20338),f=n(44414),m=function(e){function t(e){var n;return(0,i.default)(this,t),(n=(0,a.default)(this,t,[e])).submit=function(){n.props.changeGroup2Department(),n.props.toggleDialog()},n.state={selectedOption:null},n}return(0,r.default)(t,e),(0,s.default)(t,[{key:"render",value:function(){var e='<span class="op-target">'+h.Aq.HTMLescape(this.props.groupName)+"</span>",t=(0,g.AP)("Are you sure to change group {placeholder} to department ?").replace("{placeholder}",e);return(0,f.jsxs)(l.A,{isOpen:!0,toggle:this.props.toggleDialog,children:[(0,f.jsx)(p.A,{toggle:this.props.toggleDialog,children:(0,g.AP)("Change group to department")}),(0,f.jsx)(c.A,{children:(0,f.jsx)("p",{dangerouslySetInnerHTML:{__html:t}})}),(0,f.jsxs)(d.A,{children:[(0,f.jsx)(u.A,{color:"secondary",onClick:this.props.toggleDialog,children:(0,g.AP)("Cancel")}),(0,f.jsx)(u.A,{color:"primary",onClick:this.submit,children:(0,g.AP)("Submit")})]})]})}}])}(o.Component);t.A=m},61314:function(e,t,n){var i=n(23029),s=n(92901),a=n(39874),r=n(85501),o=n(9950),l=n(5495),c=n(69123),d=n(65276),u=n(34940),h=n(40326),g=n(65604),p=n(44414),f=function(e){function t(e){var n;return(0,i.default)(this,t),(n=(0,a.default)(this,t,[e])).onMenuItemClick=function(e){var t=g.Aq.getEventData(e,"op");n.props.onMenuItemClick(t)},n.onDropdownToggleClick=function(e){n.toggleOperationMenu(e)},n.toggleOperationMenu=function(e){n.setState({isItemMenuShow:!n.state.isItemMenuShow},(function(){n.state.isItemMenuShow?n.props.onFreezedItem():n.props.onUnfreezedItem()}))},n.state={isItemMenuShow:!1},n}return(0,r.default)(t,e),(0,s.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.operations,i=t.translateOperations;return(0,p.jsxs)(l.A,{isOpen:this.state.isItemMenuShow,toggle:this.toggleOperationMenu,children:[(0,p.jsx)(c.A,{tag:"i",className:"sf3-font sf3-font-more op-icon",title:(0,h.AP)("More operations"),"aria-label":(0,h.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.isItemMenuShow}),(0,p.jsx)(d.A,{className:"my-1 mr-2",children:n.map((function(t,n){return(0,p.jsx)(u.A,{"data-op":t,onClick:e.onMenuItemClick,children:i(t)},n)}))})]})}}])}(o.Component);t.A=f},61599:function(e,t,n){var i=n(23029),s=n(92901),a=n(39874),r=n(85501),o=n(9950),l=n(8081),c=n(10877),d=n(40326),u=n(9961),h=n(20338),g=(n(8008),n(44414)),p=function(e){function t(){var e;(0,i.default)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=(0,a.default)(this,t,[].concat(s))).toggle=function(){e.props.toggle()},e}return(0,r.default)(t,e),(0,s.default)(t,[{key:"render",value:function(){return(0,g.jsxs)(l.A,{className:"seahub-io-dialog",isOpen:!0,toggle:this.toggle,children:[(0,g.jsx)(h.A,{toggle:this.toggle,children:(0,d.AP)("Exporting")}),(0,g.jsx)(c.A,{children:(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(u.A,{}),(0,g.jsx)("div",{className:"seahub-io-dialog-parsing-text",children:(0,d.AP)("Exporting...")})]})})]})}}])}(o.Component);t.A=p},91611:function(e,t,n){var i=n(23029),s=n(92901),a=n(39874),r=n(85501),o=n(9950),l=n(8081),c=n(10877),d=n(6754),u=n(34322),h=n(25328),g=n(40326),p=n(4086),f=n(20338),m=n(44414),v=function(e){function t(e){var n;return(0,i.default)(this,t),(n=(0,a.default)(this,t,[e])).copyToClipboard=function(){(0,h.A)(n.props.link),n.props.toggleDialog(),p.A.success((0,g.AP)("The link is copied to the clipboard."),{duration:2})},n}return(0,r.default)(t,e),(0,s.default)(t,[{key:"render",value:function(){var e=this.props,t=e.link,n=e.toggleDialog;return(0,m.jsxs)(l.A,{isOpen:!0,toggle:n,children:[(0,m.jsx)(f.A,{toggle:n,children:(0,g.AP)("Link")}),(0,m.jsx)(c.A,{children:(0,m.jsx)("a",{href:t,children:t})}),(0,m.jsxs)(d.A,{children:[(0,m.jsx)(u.A,{color:"primary",onClick:this.copyToClipboard,children:(0,g.AP)("Copy")}),(0,m.jsx)(u.A,{color:"secondary",onClick:n,children:(0,g.AP)("Close")})]})]})}}])}(o.Component);t.A=v},15097:function(e,t,n){var i=n(23029),s=n(92901),a=n(39874),r=n(85501),o=n(9950),l=n(8081),c=n(10877),d=n(39708),u=n(79969),h=n(91646),g=n(65488),p=n(6754),f=n(34322),m=n(4086),v=n(40326),x=n(65604),A=n(43825),y=n(2662),P=n(20338),b=n(44414),j=function(e){function t(e){var n;return(0,i.default)(this,t),(n=(0,a.default)(this,t,[e])).onKeyDown=function(e){"Enter"===e.key&&(n.handleSubmit(),e.preventDefault())},n.handleChange=function(e){n.setState({departName:e.target.value},(function(){n.setState({isSubmitBtnActive:!!n.state.departName.trim()})}))},n.handleSubmit=function(){var e=(0,x.yS)(n.state.departName.trim());if(e.isValid){var t=n.props,i=t.orgID,s=t.parentNode,a=s?s.id:-1,r=n.state.departName.trim();(i?y.k.orgAdminAddDepartGroup(i,a,r):A.H.sysAdminAddNewDepartment(a,r)).then((function(e){s?n.props.addDepartment(s,e.data):n.props.setRootNode(e.data),n.props.toggle()})).catch((function(e){var t=x.Aq.getErrorMsg(e);m.A.danger(t)}))}else n.setState({errMessage:e.message})},n.state={departName:"",isSubmitBtnActive:!1},n}return(0,r.default)(t,e),(0,s.default)(t,[{key:"render",value:function(){var e,t=this.props.parentNode,n=this.state.isSubmitBtnActive;return e=t?(0,v.AP)("Add department at")+" "+t.name:(0,v.AP)("Create top department"),(0,b.jsxs)(l.A,{isOpen:!0,toggle:this.props.toggle,autoFocus:!1,children:[(0,b.jsx)(P.A,{toggle:this.props.toggle,children:e}),(0,b.jsx)(c.A,{children:(0,b.jsx)(d.A,{children:(0,b.jsxs)(u.A,{children:[(0,b.jsx)(h.A,{for:"departmentName",children:(0,v.AP)("Name")}),(0,b.jsx)(g.A,{id:"departmentName",name:"department-name",onKeyDown:this.onKeyDown,value:this.state.departName,onChange:this.handleChange,autoFocus:!0})]})})}),(0,b.jsxs)(p.A,{children:[(0,b.jsx)(f.A,{color:"secondary",onClick:this.props.toggle,children:(0,v.AP)("Cancel")}),(0,b.jsx)(f.A,{color:"primary",onClick:this.handleSubmit,disabled:!n,children:(0,v.AP)("Submit")})]})]})}}])}(o.Component);t.A=j},47150:function(e,t,n){var i=n(23029),s=n(92901),a=n(39874),r=n(85501),o=n(9950),l=n(8081),c=n(10877),d=n(6754),u=n(34322),h=n(40326),g=n(20338),p=n(44414),f=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,t,arguments)}return(0,r.default)(t,e),(0,s.default)(t,[{key:"render",value:function(){var e=this.props,t=e.node,n=e.toggle;return(0,p.jsxs)(l.A,{isOpen:!0,toggle:n,children:[(0,p.jsx)(g.A,{toggle:n,children:(0,h.AP)("Delete department")}),(0,p.jsx)(c.A,{children:(0,p.jsxs)("p",{children:[(0,h.AP)("Are you sure to delete")," ",(0,p.jsx)("b",{children:t.name})," ?"]})}),(0,p.jsxs)(d.A,{children:[(0,p.jsx)(u.A,{color:"secondary",onMouseDown:n,children:(0,h.AP)("Cancel")}),(0,p.jsx)(u.A,{color:"primary",onMouseDown:this.props.onDelete,children:(0,h.AP)("Delete")})]})]})}}])}(o.Component);t.A=f},77474:function(e,t,n){var i=n(23029),s=n(92901),a=n(39874),r=n(85501),o=n(9950),l=n(8081),c=n(10877),d=n(39708),u=n(79969),h=n(91646),g=n(65488),p=n(6754),f=n(34322),m=n(4086),v=n(40326),x=n(65604),A=n(43825),y=n(2662),P=n(20338),b=n(44414),j=function(e){function t(e){var n;return(0,i.default)(this,t),(n=(0,a.default)(this,t,[e])).onKeyDown=function(e){"Enter"===e.key&&(n.handleSubmit(),e.preventDefault())},n.handleChange=function(e){var t=e.target.value;n.setState({departName:t},(function(){n.setState({isSubmitBtnActive:!!n.state.departName.trim()})}))},n.handleSubmit=function(){var e=(0,x.yS)(n.state.departName.trim());if(e.isValid){var t=n.props,i=t.node,s=t.orgID,a=n.state.departName.trim();(s?y.k.orgAdminUpdateDepartGroup(s,i.id,a):A.H.sysAdminRenameDepartment(i.id,a)).then((function(e){n.props.renameDepartment(i,e.data),n.props.toggle()})).catch((function(e){var t=x.Aq.getErrorMsg(e);m.A.danger(t)}))}else n.setState({errMessage:e.message})},n.state={departName:e.node.name,isSubmitBtnActive:!1},n}return(0,r.default)(t,e),(0,s.default)(t,[{key:"render",value:function(){var e=this.state.isSubmitBtnActive;return(0,b.jsxs)(l.A,{isOpen:!0,toggle:this.props.toggle,autoFocus:!1,children:[(0,b.jsx)(P.A,{toggle:this.props.toggle,children:(0,v.AP)("Rename")}),(0,b.jsx)(c.A,{children:(0,b.jsx)(d.A,{children:(0,b.jsxs)(u.A,{children:[(0,b.jsx)(h.A,{for:"departmentName",children:(0,v.AP)("Name")}),(0,b.jsx)(g.A,{id:"departmentName",name:"department-name",onKeyDown:this.onKeyDown,value:this.state.departName,onChange:this.handleChange,autoFocus:!0})]})})}),(0,b.jsxs)(p.A,{children:[(0,b.jsx)(f.A,{color:"secondary",onClick:this.props.toggle,children:(0,v.AP)("Cancel")}),(0,b.jsx)(f.A,{color:"primary",onClick:this.handleSubmit,disabled:!e,children:(0,v.AP)("Submit")})]})]})}}])}(o.Component);t.A=j},43226:function(e,t,n){var i=n(23029),s=n(92901),a=n(39874),r=n(85501),o=n(9950),l=n(8081),c=n(10877),d=n(39708),u=n(79969),h=n(35077),g=n(65488),p=n(3898),f=n(6754),m=n(34322),v=n(40326),x=n(20338),A=n(44414),y=function(e){function t(e){var n;return(0,i.default)(this,t),(n=(0,a.default)(this,t,[e])).toggle=function(){n.props.toggle()},n.handleQuotaChange=function(e){var t=e.target.value;n.setState({quota:t,isSubmitBtnActive:""!=t.trim()})},n.handleKeyDown=function(e){"Enter"==e.key&&(n.handleSubmit(),e.preventDefault())},n.handleSubmit=function(){n.props.updateQuota(n.state.quota.trim()),n.toggle()},n.state={quota:"",isSubmitBtnActive:!1},n}return(0,r.default)(t,e),(0,s.default)(t,[{key:"render",value:function(){var e=this.state,t=e.quota,n=e.isSubmitBtnActive;return(0,A.jsxs)(l.A,{isOpen:!0,toggle:this.toggle,children:[(0,A.jsx)(x.A,{toggle:this.toggle,children:(0,v.AP)("Set Quota")}),(0,A.jsx)(c.A,{children:(0,A.jsx)(d.A,{children:(0,A.jsxs)(u.A,{children:[(0,A.jsxs)(h.A,{children:[(0,A.jsx)(g.A,{type:"text",className:"form-control",value:t,onKeyDown:this.handleKeyDown,onChange:this.handleQuotaChange}),(0,A.jsx)(p.A,{children:"MB"})]}),(0,A.jsxs)("p",{className:"small text-secondary mt-2 mb-2",children:[(0,v.AP)("An integer that is greater than or equal to 0."),(0,A.jsx)("br",{}),(0,v.AP)("Tip: 0 means default limit")]})]})})}),(0,A.jsxs)(f.A,{children:[(0,A.jsx)(m.A,{color:"secondary",onClick:this.toggle,children:(0,v.AP)("Cancel")}),(0,A.jsx)(m.A,{color:"primary",onClick:this.handleSubmit,disabled:!n,children:(0,v.AP)("Submit")})]})]})}}])}(o.Component);t.A=y},685:function(e,t,n){n.d(t,{A:function(){return y}});var i=n(23029),s=n(92901),a=n(39874),r=n(85501),o=n(9950),l=n(8081),c=n(10877),d=n(6754),u=n(34322),h=n(4086),g=n(40326),p=n(43825),f=n(2662),m=n(65604),v=n(98361),x=n(20338),A=n(44414),y=function(e){function t(e){var n;return(0,i.default)(this,t),(n=(0,a.default)(this,t,[e])).handleSelectChange=function(e){n.setState({selectedUsers:e})},n.handleSubmit=function(){var e=n.state.selectedUsers.map((function(e){return e.email}));if(0!==e.length){n.setState({errMessage:""});var t=n.props,i=t.nodeId,s=t.orgID;(s?f.k.orgAdminAddGroupMember(s,i,e):p.H.sysAdminAddGroupMember(i,e)).then((function(e){n.setState({selectedUsers:[]}),e.data.failed.length>0&&n.setState({errMsgs:e.data.failed.map((function(e){return e.error_msg}))}),e.data.success.length>0&&(n.props.onMemberChanged(),n.props.toggle())})).catch((function(e){var t=m.Aq.getErrorMsg(e);h.A.danger(t)}))}},n.state={selectedUsers:[],errMsgs:""},n}return(0,r.default)(t,e),(0,s.default)(t,[{key:"render",value:function(){var e=this.state.errMsgs;return(0,A.jsxs)(l.A,{isOpen:!0,toggle:this.props.toggle,children:[(0,A.jsx)(x.A,{toggle:this.props.toggle,children:(0,g.AP)("Add members")}),(0,A.jsxs)(c.A,{children:[(0,A.jsx)(v.A,{placeholder:(0,g.AP)("Search users"),onSelectChange:this.handleSelectChange,isMulti:!0,selectedUsers:this.state.selectedUsers}),e.length>0&&(0,A.jsx)("ul",{className:"list-unstyled",children:e.map((function(e,t){return(0,A.jsx)("li",{className:"error mt-2",children:e},t)}))})]}),(0,A.jsxs)(d.A,{children:[(0,A.jsx)(u.A,{color:"secondary",onClick:this.props.toggle,children:(0,g.AP)("Cancel")}),(0,A.jsx)(u.A,{color:"primary",onClick:this.handleSubmit,children:(0,g.AP)("Submit")})]})]})}}])}(o.Component)},96763:function(e,t,n){var i=n(23029),s=n(92901),a=n(39874),r=n(85501),o=n(9950),l=n(40326),c=n(8081),d=n(10877),u=n(6754),h=n(34322),g=n(20338),p=n(44414),f=function(e){function t(e){var n;return(0,i.default)(this,t),(n=(0,a.default)(this,t,[e])).handleInputChange=function(e){n.setState({inputChecked:e.target.checked})},n.unlinkDevice=function(){n.props.toggleDialog(),n.props.unlinkDevice(n.state.inputChecked)},n.state={inputChecked:!1},n}return(0,r.default)(t,e),(0,s.default)(t,[{key:"render",value:function(){var e=this.state.inputChecked,t=this.props.toggleDialog;return(0,p.jsxs)(c.A,{isOpen:!0,toggle:t,children:[(0,p.jsx)(g.A,{toggle:t,children:(0,l.AP)("Unlink device")}),(0,p.jsxs)(d.A,{children:[(0,p.jsx)("p",{children:(0,l.AP)("Are you sure you want to unlink this device?")}),l.am&&(0,p.jsxs)("div",{className:"d-flex align-items-center",children:[(0,p.jsx)("input",{id:"delete-files",className:"mr-1",type:"checkbox",checked:e,onChange:this.handleInputChange}),(0,p.jsx)("label",{htmlFor:"delete-files",className:"m-0",children:(0,l.AP)("Delete files from this device the next time it comes online.")})]})]}),(0,p.jsxs)(u.A,{children:[(0,p.jsx)(h.A,{color:"secondary",onClick:t,children:(0,l.AP)("Cancel")}),(0,p.jsx)(h.A,{color:"primary",onClick:this.unlinkDevice,children:(0,l.AP)("Unlink")})]})]})}}])}(o.Component);t.A=f},83970:function(e,t,n){var i=n(23029),s=n(92901),a=n(39874),r=n(85501),o=n(9950),l=n(65488),c=n(8123),d=n(44414),u=function(e){function t(e){var n;return(0,i.default)(this,t),(n=(0,a.default)(this,t,[e])).onInputChange=function(e){var t=e.target.checked,i=t?1:0;n.setState({inputChecked:t}),n.props.saveSetting(n.props.keyText,i)},n.state={inputChecked:n.props.value},n}return(0,r.default)(t,e),(0,s.default)(t,[{key:"render",value:function(){var e=this.state.inputChecked,t=this.props,n=t.helpTip,i=t.displayName;return(0,d.jsx)(c.A,{displayName:i,mainClassName:"d-flex",mainContent:(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(l.A,{className:"ml-0",checked:e,type:"checkbox",onChange:this.onInputChange}),(0,d.jsx)("p",{className:"ml-2",children:n})]})})}}])}(o.Component);t.A=u},15263:function(e,t,n){var i=n(9950),s=n(34322),a=n(40326),r=n(8123),o=n(44414);t.A=function(e){var t=(0,i.useRef)(null),n=e.helpTip,l=e.filePath,c=e.fileWidth,d=e.fileHeight,u=e.displayName;return(0,o.jsx)(r.A,{displayName:u,helpTip:n,mainContent:(0,o.jsx)("img",{src:l+"?t="+(new Date).getTime(),alt:u,width:c,height:d,className:"mb-1"}),extraContent:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.A,{color:"secondary",onClick:function(){t.current.click()},children:(0,a.AP)("Change")}),(0,o.jsx)("input",{className:"d-none",type:"file",onChange:function(){if(t.current.files.length){var n=t.current.files[0];e.postFile(n,e.keyText)}},ref:t})]})})}},72714:function(e,t,n){n(9950);var i=n(44414);t.A=function(e){var t=e.headingText,n=e.children;return(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("h4",{className:"border-bottom font-weight-normal mb-2 pb-1",children:t}),n]})}},8123:function(e,t,n){n(9950);var i=n(97176),s=n(46114),a=n(91646),r=n(44414);t.A=function(e){var t=e.helpTip,n=e.displayName,o=e.mainContent,l=e.extraContent,c=e.mainClassName,d=void 0===c?"":c;return(0,r.jsxs)(i.A,{className:"my-4",children:[(0,r.jsx)(s.A,{md:"3",children:(0,r.jsx)(a.A,{className:"web-setting-label",children:n})}),(0,r.jsxs)(s.A,{md:"5",className:d,children:[o,t&&(0,r.jsx)("p",{className:"small text-secondary mt-1",children:t})]}),(0,r.jsx)(s.A,{md:"4",children:l})]})}},54525:function(e,t,n){var i=n(89379),s=n(23029),a=n(92901),r=n(39874),o=n(85501),l=n(9950),c=n(1352),d=n(53496),u=n(8081),h=n(14894),g=n(67818),p=n(40326),f=n(65604),m=n(66945),v=n(49403),x=n(44414),A=function(e){function t(){var e;(0,s.default)(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=(0,r.default)(this,t,[].concat(i))).getActiveClass=function(t){return e.props.currentTab==t?"active":""},e}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this;return(0,x.jsxs)("div",{className:"side-panel ".concat(this.props.isSidePanelClosed?"":"left-zero"),children:[(0,x.jsx)("div",{className:"side-panel-north",children:(0,x.jsx)(v.A,{onCloseSidePanel:this.props.onCloseSidePanel})}),(0,x.jsx)("div",{className:"side-panel-center",children:(0,x.jsx)("div",{className:"side-nav",children:(0,x.jsxs)("div",{className:"side-nav-con",children:[(0,x.jsx)("h3",{className:"sf-heading",children:(0,p.AP)("System Admin")}),(0,x.jsxs)("ul",{className:"nav nav-pills flex-column nav-container",children:[p.Tr&&(0,x.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("info")),children:(0,x.jsxs)(h.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("info")),to:p.Yc+"sys/info/",onClick:function(){return e.props.tabItemClick("info")},children:[(0,x.jsx)("span",{className:"sf2-icon-info","aria-hidden":"true"}),(0,x.jsx)("span",{className:"nav-text",children:(0,p.AP)("Info")})]})}),(p.am||!p.Ez)&&p.m$&&(0,x.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("statistic")),children:(0,x.jsxs)(h.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("statistic")),to:p.Yc+"sys/statistics/file/",onClick:function(){return e.props.tabItemClick("statistic")},children:[(0,x.jsx)("span",{className:"sf2-icon-histogram","aria-hidden":"true"}),(0,x.jsx)("span",{className:"nav-text",children:(0,p.AP)("Statistic")})]})}),p.Iw&&(0,x.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("devices")),children:(0,x.jsxs)(h.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("devices")),to:p.Yc+"sys/desktop-devices/",onClick:function(){return e.props.tabItemClick("devices")},children:[(0,x.jsx)("span",{className:"sf2-icon-monitor","aria-hidden":"true"}),(0,x.jsx)("span",{className:"nav-text",children:(0,p.AP)("Devices")})]})}),p.sh&&p.s4&&(0,x.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("web-settings")),children:(0,x.jsxs)(h.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("web-settings")),to:p.Yc+"sys/web-settings/",onClick:function(){return e.props.tabItemClick("web-settings")},children:[(0,x.jsx)("span",{className:"sf2-icon-cog2","aria-hidden":"true"}),(0,x.jsx)("span",{className:"nav-text",children:(0,p.AP)("Settings")})]})}),p.$j&&(0,x.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("libraries")),children:(0,x.jsxs)(h.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("libraries")),to:p.Yc+"sys/all-libraries/",onClick:function(){return e.props.tabItemClick("libraries")},children:[(0,x.jsx)("span",{className:"sf2-icon-library","aria-hidden":"true"}),(0,x.jsx)("span",{className:"nav-text",children:(0,p.AP)("Libraries")})]})}),p.jR&&(0,x.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("users")),children:(0,x.jsxs)(h.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("users")),to:p.Yc+"sys/users/",onClick:function(){return e.props.tabItemClick("users")},children:[(0,x.jsx)("span",{className:"sf2-icon-user","aria-hidden":"true"}),(0,x.jsx)("span",{className:"nav-text",children:(0,p.AP)("Users")})]})}),p.XV&&(0,x.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("groups")),children:(0,x.jsxs)(h.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("groups")),to:p.Yc+"sys/groups/",onClick:function(){return e.props.tabItemClick("groups")},children:[(0,x.jsx)("span",{className:"sf2-icon-group","aria-hidden":"true"}),(0,x.jsx)("span",{className:"nav-text",children:(0,p.AP)("Groups")})]})}),p.am&&p.XV&&(0,x.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("departments")),children:(0,x.jsxs)(h.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("departments")),to:p.Yc+"sys/departments/",onClick:function(){return e.props.tabItemClick("departments")},children:[(0,x.jsx)("span",{className:"sf2-icon-organization","aria-hidden":"true"}),(0,x.jsx)("span",{className:"nav-text",children:(0,p.AP)("Departments")})]})}),p.wA&&p.Iw&&(0,x.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("organizations")),children:(0,x.jsxs)(h.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("organizations")),to:p.Yc+"sys/organizations/",onClick:function(){return e.props.tabItemClick("organizations")},children:[(0,x.jsx)("span",{className:"sf2-icon-organization","aria-hidden":"true"}),(0,x.jsx)("span",{className:"nav-text",children:(0,p.AP)("Organizations")})]})}),p.am&&p.Oq&&p.Iw&&(0,x.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("institutions")),children:(0,x.jsxs)(h.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("institutions")),to:p.Yc+"sys/institutions/",onClick:function(){return e.props.tabItemClick("institutions")},children:[(0,x.jsx)("span",{className:"sf2-icon-organization","aria-hidden":"true"}),(0,x.jsx)("span",{className:"nav-text",children:(0,p.AP)("Institutions")})]})}),p.Iw&&(0,x.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("notifications")),children:(0,x.jsxs)(h.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("notifications")),to:p.Yc+"sys/notifications/",onClick:function(){return e.props.tabItemClick("notifications")},children:[(0,x.jsx)("span",{className:"sf2-icon-msgs","aria-hidden":"true"}),(0,x.jsx)("span",{className:"nav-text",children:(0,p.AP)("Notifications")})]})}),p.Iw&&(0,x.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("links")),children:(0,x.jsxs)(h.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("links")),to:p.Yc+"sys/share-links/",onClick:function(){return e.props.tabItemClick("links")},children:[(0,x.jsx)("span",{className:"sf2-icon-link","aria-hidden":"true"}),(0,x.jsx)("span",{className:"nav-text",children:(0,p.AP)("Links")})]})}),p.w4&&p.ju&&(0,x.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("logs")),children:(0,x.jsxs)(h.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("logs")),to:p.Yc+"sys/logs/login",onClick:function(){return e.props.tabItemClick("logs")},children:[(0,x.jsx)("span",{className:"sf2-icon-clock","aria-hidden":"true"}),(0,x.jsx)("span",{className:"nav-text",children:(0,p.AP)("Logs")})]})}),p.am&&p.Iw&&p.n5&&(0,x.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("file-scan-records")),children:(0,x.jsxs)(h.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("file-scan-records")),to:p.Yc+"sys/file-scan-records/",onClick:function(){return e.props.tabItemClick("file-scan-records")},children:[(0,x.jsx)("span",{className:"sf2-icon-security","aria-hidden":"true"}),(0,x.jsx)("span",{className:"nav-text",children:(0,p.AP)("File Scan")})]})}),p.am&&p.Iw&&(0,x.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("virus-files")),children:(0,x.jsxs)(h.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("virus-files")),to:p.Yc+"sys/virus-files/all/",onClick:function(){return e.props.tabItemClick("virus-files")},children:[(0,x.jsx)("span",{className:"sf2-icon-security","aria-hidden":"true"}),(0,x.jsx)("span",{className:"nav-text",children:(0,p.AP)("Virus Scan")})]})}),p.am&&p.JC&&p.Iw&&(0,x.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("invitations")),children:(0,x.jsxs)(h.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("invitations")),to:p.Yc+"sys/invitations/",onClick:function(){return e.props.tabItemClick("invitations")},children:[(0,x.jsx)("span",{className:"sf2-icon-invite","aria-hidden":"true"}),(0,x.jsx)("span",{className:"nav-text",children:(0,p.AP)("Invitations")})]})}),p.Iw&&p.a8&&(0,x.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("termsandconditions")),children:(0,x.jsxs)(h.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("termsandconditions")),to:p.Yc+"sys/terms-and-conditions/",onClick:function(){return e.props.tabItemClick("termsandconditions")},children:[(0,x.jsx)("span",{className:"sf2-icon-wiki","aria-hidden":"true"}),(0,x.jsx)("span",{className:"nav-text",children:(0,p.AP)("Terms and Conditions")})]})}),p.am&&p.hP&&(0,x.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("adminLogs")),children:(0,x.jsxs)(h.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("adminLogs")),to:p.Yc+"sys/admin-logs/operation",onClick:function(){return e.props.tabItemClick("adminLogs")},children:[(0,x.jsx)("span",{className:"sf2-icon-admin-log","aria-hidden":"true"}),(0,x.jsx)("span",{className:"nav-text",children:(0,p.AP)("Admin Logs")})]})}),p.Iw&&p.Lp&&(0,x.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("work-weixin")),children:(0,x.jsxs)(h.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("work-weixin")),to:p.Yc+"sys/work-weixin/",onClick:function(){return e.props.tabItemClick("work-weixin")},children:[(0,x.jsx)("span",{className:"sf3-font-enterprise-wechat sf3-font","aria-hidden":"true"}),(0,x.jsx)("span",{className:"nav-text",children:"\u4f01\u4e1a\u5fae\u4fe1\u96c6\u6210"})]})}),p.Iw&&p.MT&&(0,x.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("dingtalk")),children:(0,x.jsxs)(h.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("dingtalk")),to:p.Yc+"sys/dingtalk/",onClick:function(){return e.props.tabItemClick("dingtalk")},children:[(0,x.jsx)("span",{className:"sf3-font-dingtalk sf3-font","aria-hidden":"true"}),(0,x.jsx)("span",{className:"nav-text",children:"\u9489\u9489\u96c6\u6210"})]})}),p.Iw&&p.DY&&(0,x.jsx)("li",{className:"nav-item ".concat(this.getActiveClass("abuse-reports")),children:(0,x.jsxs)(h.N_,{className:"nav-link ellipsis ".concat(this.getActiveClass("abuse-reports")),to:p.Yc+"sys/abuse-reports/",onClick:function(){return e.props.tabItemClick("abuse-reports")},children:[(0,x.jsx)("span",{className:"sf2-icon-monitor","aria-hidden":"true"}),(0,x.jsx)("span",{className:"nav-text",children:(0,p.AP)("Abuse Reports")})]})})]})]})})})]})}}])}(l.Component),y=A,P=function(e){function t(){return(0,s.default)(this,t),(0,r.default)(this,t,arguments)}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){return(0,x.jsx)("div",{className:"main-panel",children:this.props.children})}}])}(l.Component),b=P,j=n(34322),S=n(43825),k=n(4086),D=n(9961),_=n(32043),w=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).uploadLicenseFile=function(e){if(n.fileInput.current.files.length){var t=n.fileInput.current.files[0];S.H.sysAdminUploadLicense(t).then((function(e){var t=n.state.sysInfo;Object.assign(t,e.data,{with_license:!0}),n.setState({sysInfo:t})})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))}},n.openFileInput=function(){n.fileInput.current.click()},n.renderLicenseDescString=function(e,t,n){return"life-time"==e?"zh-cn"==window.app.config.lang?"\u6c38\u4e45\u6388\u6743\u7ed9 "+t+"\uff0c\u6280\u672f\u652f\u6301\u670d\u52a1\u81f3 "+n+" \u5230\u671f":(0,p.AP)("licensed to {placeholder_license_to}, upgrade service expired in {placeholder_license_expiration}").replace("{placeholder_license_to}",t).replace("{placeholder_license_expiration}",n):(0,p.AP)("licensed to {placeholder_license_to}, expires on {placeholder_license_expiration}").replace("{placeholder_license_to}",t).replace("{placeholder_license_expiration}",n)},n.state={loading:!0,errorMsg:"",sysInfo:{}},n.fileInput=l.createRef(),n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this;S.H.sysAdminGetSysInfo().then((function(t){e.setState({loading:!1,sysInfo:t.data})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this.state.sysInfo,t=e.license_mode,n=e.license_to,s=e.license_expiration,a=e.org_count,r=e.repos_count,o=e.total_files_count,c=e.total_storage,d=e.total_devices_count,u=e.current_connected_devices_count,h=e.license_maxusers,g=e.multi_tenancy_enabled,m=e.active_users_count,v=e.users_count,A=e.groups_count,y=e.with_license,P=this.state,b=P.loading,S=P.errorMsg;return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container system-admin-info",children:[(0,x.jsx)("div",{className:"cur-view-path",children:(0,x.jsx)("h3",{className:"sf-heading",children:(0,p.AP)("Info")})}),(0,x.jsxs)("div",{className:"cur-view-content",children:[b&&(0,x.jsx)(D.A,{}),S&&(0,x.jsx)("p",{className:"error text-center mt-4",children:S}),!b&&!S&&(0,x.jsxs)("dl",{className:"flex-1 m-0",children:[(0,x.jsx)("dt",{className:"info-item-heading",children:(0,p.AP)("System Info")}),p.am?(0,x.jsxs)("dd",{className:"info-item-content",children:[(0,p.AP)("Professional Edition"),y&&" "+this.renderLicenseDescString(t,n,s),(0,x.jsx)("br",{}),p.gv&&(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(j.A,{type:"button",className:"mt-2",onClick:this.openFileInput,children:(0,p.AP)("Upload license")}),(0,x.jsx)("input",{className:"d-none",type:"file",onChange:this.uploadLicenseFile,ref:this.fileInput})]})]}):(0,x.jsxs)("dd",{className:"info-item-content",children:[(0,p.AP)("Community Edition"),(0,x.jsx)("a",{className:"ml-1",href:"https://manual.seafile.com/latest/setup/migrate_ce_to_pro_with_docker/",target:"_blank",rel:"noreferrer",children:(0,p.AP)("Upgrade to Pro Edition")})]}),(0,x.jsx)("dt",{className:"info-item-heading",children:(0,p.AP)("Version")}),(0,x.jsx)("dd",{className:"info-item-content",children:p.si}),(0,x.jsxs)("dt",{className:"info-item-heading",children:[(0,p.AP)("Libraries")," / ",(0,p.AP)("Files")]}),(0,x.jsxs)("dd",{className:"info-item-content",children:[r," / ",o]}),(0,x.jsx)("dt",{className:"info-item-heading",children:(0,p.AP)("Storage Used")}),(0,x.jsx)("dd",{className:"info-item-content",children:f.Aq.bytesToSize(c)}),(0,x.jsxs)("dt",{className:"info-item-heading",children:[(0,p.AP)("Total Devices")," / ",(0,p.AP)("Current Connected Devices")]}),(0,x.jsxs)("dd",{className:"info-item-content",children:[d," / ",u]}),p.am?(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("dt",{className:"info-item-heading",children:[(0,p.AP)("Activated Users")," / ",(0,p.AP)("Total Users")," / ",(0,p.AP)("Limits")]}),(0,x.jsxs)("dd",{className:"info-item-content",children:[m," / ",v," / ",y?h:"--"]})]}):(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("dt",{className:"info-item-heading",children:[(0,p.AP)("Activated Users")," / ",(0,p.AP)("Total Users")]}),(0,x.jsxs)("dd",{className:"info-item-content",children:[m," / ",v]})]}),(0,x.jsx)("dt",{className:"info-item-heading",children:(0,p.AP)("Groups")}),(0,x.jsx)("dd",{className:"info-item-content",children:A}),g&&(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)("dt",{className:"info-item-heading",children:(0,p.AP)("Organizations")}),(0,x.jsx)("dd",{className:"info-item-content",children:a})]})]})]})]})})]})}}])}(l.Component),I=w,N=n(4159),M=n.n(N),C=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).navItems=[{name:"fileStatistic",urlPart:"statistics/file",text:(0,p.AP)("File")},{name:"storageStatistic",urlPart:"statistics/storage",text:(0,p.AP)("Storage")},{name:"usersStatistic",urlPart:"statistics/user",text:(0,p.AP)("Users")},{name:"trafficStatistic",urlPart:"statistics/traffic",text:(0,p.AP)("Traffic")},{name:"reportsStatistic",urlPart:"statistics/reports",text:(0,p.AP)("Reports")},{name:"metricsStatistic",urlPart:"statistics/metrics",text:(0,p.AP)("Metrics")}],n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.currentItem;return(0,x.jsx)("div",{className:"cur-view-path tab-nav-container",children:(0,x.jsx)("ul",{className:"nav",children:this.navItems.map((function(t,n){return(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(h.N_,{to:"".concat(p.Yc,"sys/").concat(t.urlPart,"/"),className:"nav-link".concat(e==t.name?" active":""),children:t.text})},n)}))})})}}])}(l.Component),L=n(64467),O=n(29343),T=n(52544),R=n(86547),U=n.n(R),F=n(81139),E=(n(33731),n(9516),n(19617),"YYYY-MM-DD"),z=function(e){function t(e){var n;(0,s.default)(this,t),n=(0,r.default)(this,t,[e]);var i=window.app.config.lang,a=M()();return a="zh-cn"===i?a.locale("zh-cn"):a.locale("en-gb"),n.defaultCalendarValue=a.clone(),n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props,t=(0,x.jsx)(T.A,{defaultValue:this.defaultCalendarValue,disabledDate:e.disabledDate,format:E,locale:(0,F.r)()});return(0,x.jsx)(U(),{calendar:t,value:e.value,onChange:e.onChange,children:function(e){var t=e.value;return(0,x.jsx)("span",{children:(0,x.jsx)("input",{placeholder:"yyyy-mm-dd",tabIndex:"-1",readOnly:!0,value:t&&t.format(E)||"",className:"form-control system-statistic-input"})})}})}}])}(l.Component),B=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).changeActive=function(e){if(n.state.statisticType!==e){var t,i=M()().format("YYYY-MM-DD 00:00:00");switch(e){case"oneWeek":t=M()().subtract(6,"d").format("YYYY-MM-DD 00:00:00");break;case"oneMonth":t=M()().subtract(29,"d").format("YYYY-MM-DD 00:00:00");break;case"oneYear":t=M()().subtract(364,"d").format("YYYY-MM-DD 00:00:00")}n.setState({statisticType:e});n.props.getActiviesFiles(t,i,"day")}},n.disabledStartDate=function(e){if(!e)return!1;var t=M()().format(),i=n.state.endValue;return i?i.isBefore(e)||M()(e).format()>t:t<M()(e).format()},n.disabledEndDate=function(e){if(!e)return!1;var t=M()().format(),i=n.state.startValue;return i?e.isBefore(i)||M()(e).format()>t:t<M()(e).format()},n.onChange=function(e,t){n.setState((0,L.default)({},e,t))},n.onSubmit=function(){var e=n.state,t=e.startValue,i=e.endValue;if(t&&i){n.setState({statisticType:"itemButton"});var s=M()(t).format("YYYY-MM-DD 00:00:00"),a=M()(i).format("YYYY-MM-DD 00:00:00");n.props.getActiviesFiles(s,a,"day")}},n.state={statisticType:"oneWeek",startValue:null,endValue:null},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=M()().format("YYYY-MM-DD 00:00:00"),t=M()().subtract(6,"d").format("YYYY-MM-DD 00:00:00");this.props.getActiviesFiles(t,e,"day")}},{key:"render",value:function(){var e=this.state,t=e.statisticType,n=e.endValue,i=e.startValue;return(0,x.jsxs)(l.Fragment,{children:[this.props.children,(0,x.jsxs)("div",{className:"system-statistic-time-range",children:[(0,x.jsxs)(O.A,{size:"sm",className:"sys-stat-tool",children:[(0,x.jsx)(j.A,{className:"font-weight-normal ".concat("oneWeek"===t?"item-active":""),onClick:this.changeActive.bind(this,"oneWeek"),children:(0,p.AP)("7 Days")}),(0,x.jsx)(j.A,{className:"font-weight-normal ".concat("oneMonth"===t?"item-active":""),onClick:this.changeActive.bind(this,"oneMonth"),children:(0,p.AP)("30 Days")}),(0,x.jsx)(j.A,{className:"font-weight-normal ".concat("oneYear"===t?"item-active":""),onClick:this.changeActive.bind(this,"oneYear"),children:(0,p.AP)("1 Year")})]}),(0,x.jsxs)("div",{className:"system-statistic-input-container",children:[(0,x.jsx)(z,{disabledDate:this.disabledStartDate,value:i,onChange:this.onChange.bind(this,"startValue")}),(0,x.jsx)("span",{className:"system-statistic-connect",children:"-"}),(0,x.jsx)(z,{disabledDate:this.disabledEndDate,value:n,onChange:this.onChange.bind(this,"endValue")}),(0,x.jsx)(j.A,{color:"primary",size:"sm",className:"system-statistic-button",onClick:this.onSubmit,children:(0,p.AP)("Submit")})]})]})]})}}])}(l.Component),H=n(35298),q=n(66187);H.t1.register(H.PP,H.kc,H.FN,H.No,H.hE,H.m_,H.s$);var Y=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).titleCallback=function(e,t){return t.datasets[e.datasetIndex].label+": "+f.Aq.bytesToSize(e.yLabel)},n.ticksCallback=function(e,t,n){return f.Aq.bytesToSize(e)},n.state={data:{},options:{}},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.labels,n=e.filesData,i=e.isTitleCallback,s=e.isTicksCallback,a=e.suggestedMaxNumbers,r=e.isLegendStatus,o=e.chartTitle,l=this,c={labels:t,datasets:n},d={plugins:{title:{display:!0,font:{weight:"bold",size:20},align:"center",text:o,color:"#666"}},elements:{line:{fill:!1,tension:0,borderWidth:2}},legend:{display:r,labels:{usePointStyle:!0}},tooltips:{callbacks:{label:function(e,t){return i?l.titleCallback(e,t):t.datasets[e.datasetIndex].label+": "+e.yLabel}}},layout:{padding:{right:100}},scales:{y:{display:!0,beginAtZero:!0,suggestedMax:a,ticks:{callback:function(e,t,n){return s?l.ticksCallback(e,t,n):e}}},x:{display:!0,ticks:{maxTicksLimit:20}}}};this.setState({data:c,options:d})}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t={labels:e.labels,datasets:e.filesData};this.setState({data:t})}},{key:"render",value:function(){var e=this.state,t=e.data,n=e.options;return 0===Object.keys(t).length&&0===Object.keys(n).length?(0,x.jsx)(D.A,{}):(0,x.jsx)(x.Fragment,{children:(0,x.jsx)(q.N1,{data:t,options:n})})}}])}(l.Component),V=(n(63864),function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).getActiviesFiles=function(e,t,i){var s=n.state.filesData;S.H.sysAdminStatisticFiles(e,t,i).then((function(e){var t=[],i=[],a=[],r=[],o=[],l=e.data;if(Array.isArray(l)){l.forEach((function(e){t.push(M()(e.datetime).format("YYYY-MM-DD")),i.push(e.added),a.push(e.deleted),o.push(e.modified),r.push(e.visited)}));var c={label:(0,p.AP)("Added"),data:i,borderColor:"#57cd6b",backgroundColor:"#57cd6b"},d={label:(0,p.AP)("Visited"),data:r,borderColor:"#fd913a",backgroundColor:"#fd913a"},u={label:(0,p.AP)("Modified"),data:o,borderColor:"#72c3fc",backgroundColor:"#72c3fc"},h={label:(0,p.AP)("Deleted"),data:a,borderColor:"#f75356",backgroundColor:"#f75356"};s=[d,c,u,h]}n.setState({filesData:s,labels:t,isLoading:!1})})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.state={filesData:[],labels:[],isLoading:!0},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.state,t=e.labels,n=e.filesData,s=e.isLoading;return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(C,{currentItem:"fileStatistic"}),(0,x.jsxs)("div",{className:"cur-view-content",children:[(0,x.jsx)(B,{getActiviesFiles:this.getActiviesFiles}),s&&(0,x.jsx)(D.A,{}),!s&&t.length>0&&(0,x.jsx)(Y,{labels:t,filesData:n,suggestedMaxNumbers:10,isLegendStatus:!0,chartTitle:(0,p.AP)("File Operations")})]})]})]})}}])}(l.Component)),G=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).getActiviesFiles=function(e,t,i){var s=n.state.filesData;S.H.sysAdminStatisticStorages(e,t,i).then((function(e){var t=[],i=[],a=e.data;if(Array.isArray(a)){a.forEach((function(e){t.push(M()(e.datetime).format("YYYY-MM-DD")),i.push(e.total_storage)}));var r={label:(0,p.AP)("Total Storage"),data:i,borderColor:"#fd913a",backgroundColor:"#fd913a"};s=[r]}n.setState({filesData:s,labels:t,isLoading:!1})})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.state={filesData:[],labels:[],isLoading:!0},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.state,t=e.labels,n=e.filesData,s=e.isLoading;return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(C,{currentItem:"storageStatistic"}),(0,x.jsxs)("div",{className:"cur-view-content",children:[(0,x.jsx)(B,{getActiviesFiles:this.getActiviesFiles}),s&&(0,x.jsx)(D.A,{}),!s&&t.length>0&&(0,x.jsx)(Y,{labels:t,filesData:n,suggestedMaxNumbers:1e7,isTitleCallback:!0,isTicksCallback:!0,isLegendStatus:!1,chartTitle:(0,p.AP)("Total Storage")})]})]})]})}}])}(l.Component),W=n(65488),Q=function(e){function t(e){return(0,s.default)(this,t),(0,r.default)(this,t,[e])}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props,t=e.type,n=e.sortBy,i="asc"==e.sortOrder?(0,x.jsx)("span",{className:"sf3-font sf3-font-down rotate-180 d-inline-block"}):(0,x.jsx)("span",{className:"sf3-font sf3-font-down"});return(0,x.jsxs)("table",{className:"table-hover",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"16%",children:"user"==t?(0,p.AP)("User"):(0,p.AP)("Organization")}),(0,x.jsx)("th",{width:"11%",children:(0,x.jsxs)("div",{className:"d-block table-sort-op cursor-pointer",onClick:this.props.sortItems.bind(this,"sync_file_upload"),children:[(0,p.AP)("Sync Upload")," ","sync_file_upload"===n&&i]})}),(0,x.jsx)("th",{width:"14%",children:(0,x.jsxs)("div",{className:"d-block table-sort-op cursor-pointer",onClick:this.props.sortItems.bind(this,"sync_file_download"),children:[(0,p.AP)("Sync Download")," ","sync_file_download"===n&&i]})}),(0,x.jsx)("th",{width:"11%",children:(0,x.jsxs)("div",{className:"d-block table-sort-op cursor-pointer",onClick:this.props.sortItems.bind(this,"web_file_upload"),children:[(0,p.AP)("Web Upload")," ","web_file_upload"===n&&i]})}),(0,x.jsx)("th",{width:"14%",children:(0,x.jsxs)("div",{className:"d-block table-sort-op cursor-pointer",onClick:this.props.sortItems.bind(this,"web_file_download"),children:[(0,p.AP)("Web Download")," ","web_file_download"===n&&i]})}),(0,x.jsx)("th",{width:"17%",children:(0,x.jsxs)("div",{className:"d-block table-sort-op cursor-pointer",onClick:this.props.sortItems.bind(this,"link_file_upload"),children:[(0,p.AP)("Share link upload")," ","link_file_upload"===n&&i]})}),(0,x.jsx)("th",{width:"17%",children:(0,x.jsxs)("div",{className:"d-block table-sort-op cursor-pointer",onClick:this.props.sortItems.bind(this,"link_file_download"),children:[(0,p.AP)("Share link download")," ","link_file_download"===n&&i]})})]})}),(0,x.jsx)("tbody",{children:this.props.children})]})}}])}(l.Component),K=function(e){function t(){var e;(0,s.default)(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=(0,r.default)(this,t,[].concat(i))).trafficName=function(){var t=e.props,n=t.userTrafficItem;switch(t.type){case"user":return n.name?(0,x.jsx)("a",{href:p.Yc+"sys/users/"+n.email+"/",children:n.name}):(0,x.jsx)("span",{children:"--"});case"org":return n.org_name?(0,x.jsx)("a",{href:p.Yc+"sys/organizations/"+n.org_id+"/info/",children:n.org_name}):(0,x.jsx)("span",{children:"--"})}},e}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.userTrafficItem,t=f.Aq.bytesToSize(e.sync_file_upload),n=f.Aq.bytesToSize(e.sync_file_download),i=f.Aq.bytesToSize(e.web_file_upload),s=f.Aq.bytesToSize(e.web_file_download),a=f.Aq.bytesToSize(e.link_file_upload),r=f.Aq.bytesToSize(e.link_file_download);return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:this.trafficName()}),(0,x.jsx)("td",{children:t}),(0,x.jsx)("td",{children:n}),(0,x.jsx)("td",{children:i}),(0,x.jsx)("td",{children:s}),(0,x.jsx)("td",{children:a}),(0,x.jsx)("td",{children:r})]})}}])}(l.Component),$=K,X=n(62376),Z=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).getPreviousPage=function(){n.getTrafficList(n.state.month,n.state.currentPage-1)},n.getNextPage=function(){n.getTrafficList(n.state.month,n.state.currentPage+1)},n.handleChange=function(e){var t=e.target.value;n.setState({month:t})},n.handleKeyPress=function(e){var t=n.state.month;if("Enter"===e.key){if(!/^([012]\d{3})(0[1-9]|1[012])$/.test(t)){var i=(0,p.AP)("Invalid month, should be yyyymm.");return void n.setState({errorMessage:i})}n.getTrafficList(t,n.initPage),e.target.blur(),e.preventDefault()}},n.getTrafficList=function(e,t){var i=n.state,s=i.perPage,a=i.sortBy,r=i.sortOrder,o="asc"==r?a:"".concat(a,"_").concat(r);n.setState({isLoading:!0,errorMessage:""}),S.H.sysAdminListOrgTraffic(e,t,s,o).then((function(i){var s=i.data.org_monthly_traffic_list.slice(0);n.setState({month:e,currentPage:t,orgTrafficList:s,hasNextPage:i.data.has_next_page,isLoading:!1})})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.sortItems=function(e){n.setState({sortBy:e,sortOrder:"asc"==n.state.sortOrder?"desc":"asc"},(function(){var e=n.state,t=e.month,i=e.currentPage;n.getTrafficList(t,i)}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){return n.getTrafficList(n.initMonth,n.initPage)}))},n.state={orgTrafficList:[],perPage:100,currentPage:1,hasNextPage:!1,month:M()().format("YYYYMM"),isLoading:!1,errorMessage:"",sortBy:"link_file_download",sortOrder:"desc"},n.initPage=1,n.initMonth=M()().format("YYYYMM"),n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,i=n.currentPage,s=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||s),currentPage:parseInt(t.get("page")||i)},(function(){e.getTrafficList(e.initMonth,e.state.currentPage)}))}},{key:"render",value:function(){var e=this.state,t=e.isLoading,n=e.errorMessage,i=e.orgTrafficList,s=e.currentPage,a=e.hasNextPage,r=e.perPage,o=e.sortBy,c=e.sortOrder;return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("div",{className:"d-flex align-items-center mt-4",children:[(0,x.jsx)("span",{className:"statistic-reports-tip",children:(0,p.AP)("Month:")}),(0,x.jsx)(W.A,{className:"statistic-reports-input",defaultValue:M()().format("YYYYMM"),onChange:this.handleChange,onKeyPress:this.handleKeyPress}),n&&(0,x.jsx)("div",{className:"error",children:n})]}),t&&(0,x.jsx)(D.A,{}),!t&&(0,x.jsx)(Q,{type:"org",sortItems:this.sortItems,sortBy:o,sortOrder:c,children:i.length>0&&i.map((function(e,t){return(0,x.jsx)($,{userTrafficItem:e,type:"org"},t)}))}),(0,x.jsx)(X.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:s,hasNextPage:a,curPerPage:r,resetPerPage:this.resetPerPage})]})}}])}(l.Component),J=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).getPreviousPage=function(){n.getTrafficList(n.state.month,n.state.currentPage-1)},n.getNextPage=function(){n.getTrafficList(n.state.month,n.state.currentPage+1)},n.handleChange=function(e){var t=e.target.value;n.setState({month:t})},n.handleKeyPress=function(e){var t=n.state.month;if("Enter"===e.key){if(!/^([012]\d{3})(0[1-9]|1[012])$/.test(t)){var i=(0,p.AP)("Invalid month, should be yyyymm.");return void n.setState({errorMessage:i})}n.getTrafficList(t,n.initPage),e.target.blur(),e.preventDefault()}},n.getTrafficList=function(e,t){var i=n.state,s=i.perPage,a=i.sortBy,r=i.sortOrder,o="asc"==r?a:"".concat(a,"_").concat(r);n.setState({isLoading:!0,errorMessage:""}),S.H.sysAdminListUserTraffic(e,t,s,o).then((function(i){var s=i.data.user_monthly_traffic_list.slice(0);n.setState({month:e,currentPage:t,userTrafficList:s,hasNextPage:i.data.has_next_page,isLoading:!1})})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.sortItems=function(e){n.setState({sortBy:e,sortOrder:"asc"==n.state.sortOrder?"desc":"asc"},(function(){var e=n.state,t=e.month,i=e.currentPage;n.getTrafficList(t,i)}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){return n.getTrafficList(n.initMonth,n.initPage)}))},n.state={userTrafficList:[],hasNextPage:!1,perPage:100,currentPage:1,month:M()().format("YYYYMM"),isLoading:!1,errorMessage:"",sortBy:"link_file_download",sortOrder:"desc"},n.initPage=1,n.initMonth=M()().format("YYYYMM"),n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,i=n.currentPage,s=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||s),currentPage:parseInt(t.get("page")||i)},(function(){e.getTrafficList(e.initMonth,e.state.currentPage)}))}},{key:"render",value:function(){var e=this.state,t=e.isLoading,n=e.errorMessage,i=e.userTrafficList,s=e.currentPage,a=e.hasNextPage,r=e.perPage,o=e.sortBy,c=e.sortOrder;return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("div",{className:"d-flex align-items-center mt-4",children:[(0,x.jsx)("span",{className:"statistic-reports-tip",children:(0,p.AP)("Month:")}),(0,x.jsx)(W.A,{className:"statistic-reports-input",defaultValue:M()().format("YYYYMM"),onChange:this.handleChange,onKeyPress:this.handleKeyPress}),n&&(0,x.jsx)("div",{className:"error",children:n})]}),t&&(0,x.jsx)(D.A,{}),!t&&(0,x.jsx)(Q,{type:"user",sortItems:this.sortItems,sortBy:o,sortOrder:c,children:i.length>0&&i.map((function(e,t){return(0,x.jsx)($,{userTrafficItem:e,type:"user"},t)}))}),(0,x.jsx)(X.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:s,hasNextPage:a,curPerPage:r,resetPerPage:this.resetPerPage})]})}}])}(l.Component),ee=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).changeTabActive=function(e){n.setState({tabActive:e})},n.getActiviesFiles=function(e,t,i){S.H.sysAdminStatisticTraffic(e,t,i).then((function(e){var t=[],i=[],s=[],a=[],r=[],o=[],l=[],c=[],d=[],u=e.data;if(Array.isArray(u)){u.forEach((function(e){t.push(M()(e.datetime).format("YYYY-MM-DD")),a.push(e["link-file-upload"]),r.push(e["link-file-download"]),o.push(e["sync-file-upload"]),l.push(e["sync-file-download"]),c.push(e["web-file-upload"]),d.push(e["web-file-download"]),i.push(e["link-file-upload"]+e["sync-file-upload"]+e["web-file-upload"]),s.push(e["link-file-download"]+e["sync-file-download"]+e["web-file-download"])}));var h=[{label:(0,p.AP)("Upload"),data:a,borderColor:"#fd913a",backgroundColor:"#fd913a"},{label:(0,p.AP)("Download"),data:r,borderColor:"#57cd6b",backgroundColor:"#57cd6b"}],g=[{label:(0,p.AP)("Upload"),data:o,borderColor:"#fd913a",backgroundColor:"#fd913a"},{label:(0,p.AP)("Download"),data:l,borderColor:"#57cd6b",backgroundColor:"#57cd6b"}],f=[{label:(0,p.AP)("Upload"),data:c,borderColor:"#fd913a",backgroundColor:"#fd913a"},{label:(0,p.AP)("Download"),data:d,borderColor:"#57cd6b",backgroundColor:"#57cd6b"}],m=[{label:(0,p.AP)("Upload"),data:i,borderColor:"#fd913a",backgroundColor:"#fd913a"},{label:(0,p.AP)("Download"),data:s,borderColor:"#57cd6b",backgroundColor:"#57cd6b"}];n.setState({linkData:h,syncData:g,webData:f,filesData:m,labels:t,isLoading:!1})}})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.renderCommonTool=function(){var e=n.state.tabActive;return"system"===e?(0,x.jsx)(B,{getActiviesFiles:n.getActiviesFiles,children:(0,x.jsxs)("div",{className:"statistic-traffic-tab",children:[(0,x.jsx)("div",{className:"statistic-traffic-tab-item ".concat("system"===e?"active":""),onClick:n.changeTabActive.bind(n,"system"),children:(0,p.AP)("System")}),(0,x.jsx)("div",{className:"statistic-traffic-tab-item ".concat("user"===e?"active":""),onClick:n.changeTabActive.bind(n,"user"),children:(0,p.AP)("Users")}),(0,x.jsx)("div",{className:"statistic-traffic-tab-item ".concat("organizations"===e?"active":""),onClick:n.changeTabActive.bind(n,"organizations"),children:(0,p.AP)("Organizations")})]})}):(0,x.jsxs)("div",{className:"statistic-traffic-tab",children:[(0,x.jsx)("div",{className:"statistic-traffic-tab-item ".concat("system"===e?"active":""),onClick:n.changeTabActive.bind(n,"system"),children:(0,p.AP)("System")}),(0,x.jsx)("div",{className:"statistic-traffic-tab-item ".concat("user"===e?"active":""),onClick:n.changeTabActive.bind(n,"user"),children:(0,p.AP)("Users")}),(0,x.jsx)("div",{className:"statistic-traffic-tab-item ".concat("organizations"===e?"active":""),onClick:n.changeTabActive.bind(n,"organizations"),children:(0,p.AP)("Organizations")})]})},n.state={filesData:[],linkData:[],syncData:[],webData:[],labels:[],isLoading:!0,tabActive:"system"},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.state,t=e.labels,n=e.filesData,s=e.linkData,a=e.syncData,r=e.webData,o=e.isLoading,c=e.tabActive;return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(C,{currentItem:"trafficStatistic"}),(0,x.jsxs)("div",{className:"cur-view-content",children:[this.renderCommonTool(),o&&(0,x.jsx)(D.A,{}),!o&&"system"===c&&(0,x.jsxs)("div",{className:"statistic-traffic-chart-container",children:[(0,x.jsx)("div",{className:"mb-4",children:t.length>0&&(0,x.jsx)(Y,{labels:t,filesData:n,chartTitle:(0,p.AP)("Total Traffic"),suggestedMaxNumbers:1e7,isTitleCallback:!0,isTicksCallback:!0,isLegendStatus:!0})}),(0,x.jsx)("div",{className:"mb-4",children:t.length>0&&(0,x.jsx)(Y,{labels:t,filesData:r,chartTitle:(0,p.AP)("Web Traffic"),suggestedMaxNumbers:1e7,isTitleCallback:!0,isTicksCallback:!0,isLegendStatus:!0})}),(0,x.jsx)("div",{className:"mb-4",children:t.length>0&&(0,x.jsx)(Y,{labels:t,filesData:s,chartTitle:(0,p.AP)("Share Link Traffic"),suggestedMaxNumbers:1e7,isTitleCallback:!0,isTicksCallback:!0,isLegendStatus:!0})}),(0,x.jsx)("div",{className:"mb-4",children:t.length>0&&(0,x.jsx)(Y,{labels:t,filesData:a,chartTitle:(0,p.AP)("Sync Traffic"),suggestedMaxNumbers:1e7,isTitleCallback:!0,isTicksCallback:!0,isLegendStatus:!0})})]}),!o&&"user"===c&&(0,x.jsx)(J,{}),!o&&"organizations"===c&&(0,x.jsx)(Z,{})]})]})]})}}])}(l.Component),te=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).getActiviesFiles=function(e,t,i){var s=n.state.filesData;S.H.sysAdminStatisticActiveUsers(e,t,i).then((function(e){var t=[],i=[],a=e.data;if(Array.isArray(a)){a.forEach((function(e){t.push(M()(e.datetime).format("YYYY-MM-DD")),i.push(e.count)}));var r={label:(0,p.AP)("Active Users"),data:i,borderColor:"#fd913a",backgroundColor:"#fd913a"};s=[r]}n.setState({filesData:s,labels:t,isLoading:!1})})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.state={filesData:[],labels:[],isLoading:!0},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.state,t=e.labels,n=e.filesData,s=e.isLoading;return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(C,{currentItem:"usersStatistic"}),(0,x.jsxs)("div",{className:"cur-view-content",children:[(0,x.jsx)(B,{getActiviesFiles:this.getActiviesFiles}),s&&(0,x.jsx)(D.A,{}),!s&&t.length>0&&(0,x.jsx)(Y,{labels:t,filesData:n,suggestedMaxNumbers:10,isLegendStatus:!1,chartTitle:(0,p.AP)("Active Users")})]})]})]})}}])}(l.Component),ne=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleChange=function(e){var t=e.target.value;n.setState({month:t})},n.onGenerateReports=function(e){var t=p.Yc+"api/v2.1/admin/statistics/",i=n.state.month;if(i){if("month"===e){if(!/^([012]\d{3})(0[1-9]|1[012])$/.test(i)){var s=(0,p.AP)("Invalid month, should be yyyymm.");return void n.setState({errorMessage:s})}}switch(e){case"month":t+="system-user-traffic/excel/?month="+i;break;case"storage":t+="system-user-storage/excel/?"}n.setState({errorMessage:""}),window.location.href=new URL(t)}else{var a=(0,p.AP)("It is required.");n.setState({errorMessage:a})}},n.state={month:M()().format("YYYYMM"),errorMessage:""},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.state.errorMessage;return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(C,{currentItem:"reportsStatistic"}),(0,x.jsxs)("div",{className:"cur-view-content",children:[(0,x.jsxs)("div",{className:"statistic-reports",children:[(0,x.jsx)("div",{className:"statistic-reports-title",children:(0,p.AP)("Monthly User Traffic")}),(0,x.jsxs)("div",{className:"d-flex align-items-center mt-4",children:[(0,x.jsx)("span",{className:"statistic-reports-tip",children:(0,p.AP)("Month:")}),(0,x.jsx)(W.A,{className:"statistic-reports-input",defaultValue:M()().format("YYYYMM"),onChange:this.handleChange}),(0,x.jsx)(j.A,{className:"statistic-reports-submit operation-item",onClick:this.onGenerateReports.bind(this,"month"),children:(0,p.AP)("Create Report")})]}),e&&(0,x.jsx)("div",{className:"error",children:e})]}),(0,x.jsxs)("div",{className:"statistic-reports",children:[(0,x.jsx)("div",{className:"statistic-reports-title",children:(0,p.AP)("User Storage")}),(0,x.jsx)(j.A,{className:"mt-4 operation-item",onClick:this.onGenerateReports.bind(this,"storage"),children:(0,p.AP)("Create Report")})]})]})]})]})}}])}(l.Component),ie=n(5544),se=n(36755),ae=n(10467),re=n(24591),oe=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).toggleTooltip=function(e){n.setState((function(t){return{tooltipOpen:t.tooltipOpen===e?null:e}}))},n.handleRowHover=function(e){n.setState({hoveredRow:e})},n.handleRowLeave=function(){n.setState({hoveredRow:null})},n.state={hoveredRow:null,tooltipOpen:null},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.componentName,i=t.metrics,s=this.state,a=s.hoveredRow,r=s.tooltipOpen;return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("tr",{className:"component-header",children:(0,x.jsx)("td",{colSpan:"4",children:(0,x.jsx)("div",{className:"component-title",children:(0,x.jsx)("span",{children:n})})})}),i.map((function(t){return t.data_points.map((function(n,i){var s="".concat(t.name,"-").concat(n.labels.node,"-").concat(i);return(0,x.jsxs)("tr",{className:"metric-row",children:[(0,x.jsx)("td",{onMouseEnter:function(){return e.handleRowHover(s)},onMouseLeave:e.handleRowLeave,children:(0,x.jsx)("div",{className:"metric-info",children:(0,x.jsxs)("div",{className:"metric-name",children:[t.name.substring(t.name.indexOf("_")+1),t.help&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("i",{className:"sf3-font-help sf3-font",id:s,"aria-hidden":"true",style:{visibility:a===s?"visible":"hidden"}}),(0,x.jsx)(re.A,{placement:"right",isOpen:r===s&&a===s,toggle:function(){return e.toggleTooltip(s)},target:s,delay:{show:200,hide:0},fade:!0,className:"metric-tooltip",hideArrow:!0,children:t.help})]})]})})}),(0,x.jsx)("td",{children:n.labels.node}),(0,x.jsx)("td",{className:"metric-value",children:n.value}),(0,x.jsx)("td",{children:(0,x.jsx)("span",{className:"collected-time",children:M()(n.labels.collected_at).format("YYYY-MM-DD HH:mm:ss")})})]},s)}))}))]})}}])}(l.Component),le=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).groupMetricsByComponent=function(e){var t={};return e.forEach((function(e){e.data_points&&e.data_points.length>0&&e.data_points.forEach((function(n){var s=n.labels.component||"Other";t[s]||(t[s]=[]);var a=t[s].find((function(t){return t.name===e.name}));a?a.data_points.push(n):t[s].push((0,i.default)((0,i.default)({},e),{},{data_points:[n]}))}))})),t},n.getMetrics=(0,ae.default)((0,se.default)().mark((function e(){var t,i;return(0,se.default)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({loading:!0}),e.prev=1,e.next=4,S.H.sysAdminStatisticMetrics();case 4:t=e.sent,i=n.groupMetricsByComponent(t.data.metrics),n.setState({metrics:t.data.metrics,groupedMetrics:i,loading:!1}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),n.setState({error:"Failed to get metric data",loading:!1});case 12:case"end":return e.stop()}}),e,null,[[1,9]])}))),n.state={metrics:[],loading:!0,error:null,groupedMetrics:{}},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){this.getMetrics()}},{key:"render",value:function(){var e=this.state,t=e.groupedMetrics,n=e.loading,s=e.error;return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsxs)("div",{className:"",children:[(0,x.jsx)(C,{currentItem:"metricsStatistic"}),(0,x.jsx)("div",{className:"cur-metrics-content",children:n?(0,x.jsx)("div",{className:"loading-icon loading-tip"}):s?(0,x.jsx)("div",{className:"error text-danger",children:s}):(0,x.jsx)("div",{className:"metrics-container",children:(0,x.jsx)("div",{className:"card",children:(0,x.jsx)("div",{className:"card-body",children:(0,x.jsxs)("table",{className:"table table-striped mb-0",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"40%",children:(0,p.AP)("Metrics")}),(0,x.jsx)("th",{width:"20%",children:(0,p.AP)("Node")}),(0,x.jsx)("th",{width:"15%",children:(0,p.AP)("Value")}),(0,x.jsx)("th",{width:"25%",children:(0,p.AP)("Collected time")})]})}),(0,x.jsx)("tbody",{children:Object.entries(t).map((function(e){var t=(0,ie.default)(e,2),n=t[0],i=t[1];return(0,x.jsx)(oe,{componentName:n,metrics:i},n)}))})]})})})})})]})]})}}])}(l.Component);document.head.insertAdjacentHTML("beforeend","\n  <style>\n    .cur-metrics-content {\n      padding: 10px 16px;\n      border: none;\n    }\n\n    .cur-metrics-content .card {\n      margin-bottom: 20px;\n    }\n\n    .component-metrics-card .card-header {\n      background-color: #fff;\n      padding: 16px 20px;\n    }\n    \n    .metric-info {\n      display: flex;\n      flex-direction: column;\n    }\n    \n    .metric-name {\n      font-size: 14px;\n    }\n\n    .metrics-container {\n      padding: 0;\n    }\n    \n    .metrics-container .loading-tip {\n      margin: 100px auto;\n      text-align: center;\n    }\n\n    .card {\n      box-shadow: none;\n      border: none;\n    }\n\n    .card-body {\n      border: none;\n      padding: 0;\n    }\n\n    .component-header {\n      background-color: #fafafa !important;\n    }\n\n    .component-header td {\n      padding-top: 24px !important;\n      padding-bottom: 2px !important;\n      }\n\n    .component-title {\n      color: #212529;\n      font-size: 16px;\n      font-weight: 500;\n    }\n\n    .metric-row td {\n      padding: 0;\n      font-size: 14px;\n    }\n\n    .metrics-container .table {\n      margin-bottom: 0;\n      border: none;\n    }\n\n    .metrics-container .table td {\n      vertical-align: middle;\n      background-color: #fff;\n      border-bottom: 1px solid #e8e8e8;\n      padding-left: 8px;\n    }\n\n    .metrics-container .table th {\n      background-color: #fff;\n      border-bottom: 1px solid #e8e8e8;\n      color: #666;\n      font-size: 14px;\n    }\n\n    .sf3-font-help {\n      font-size: 14px;\n      color: #666;\n      margin-left: 4px;\n      opacity: 0.7;\n      transition: opacity 0.2s;\n\n    }\n  </style>\n");var ce=le,de=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).navItems=[{name:"desktop",urlPart:"desktop-devices",text:(0,p.AP)("Desktop")},{name:"mobile",urlPart:"mobile-devices",text:(0,p.AP)("Mobile")}],p.am&&n.navItems.push({name:"errors",urlPart:"device-errors",text:(0,p.AP)("Errors")}),n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.currentItem;return(0,x.jsx)("div",{className:"cur-view-path tab-nav-container",children:(0,x.jsx)("ul",{className:"nav",children:this.navItems.map((function(t,n){return(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(h.N_,{to:"".concat(p.Yc,"sys/").concat(t.urlPart,"/"),className:"nav-link".concat(e==t.name?" active":""),children:t.text})},n)}))})})}}])}(l.Component),ue=de,he=n(37609),ge=n.n(he),pe=n(48738),fe=n.n(pe),me=n(43066),ve=n(96763);M().extend(ge());var xe=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).getPreviousPageDevicesList=function(){n.props.getDevicesListByPage(n.props.pageInfo.current_page-1)},n.getNextPageDevicesList=function(){n.props.getDevicesListByPage(n.props.pageInfo.current_page+1)},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg,i=e.items,s=e.pageInfo,a=e.curPerPage;if(t)return(0,x.jsx)(D.A,{});if(n)return(0,x.jsx)("p",{className:"error text-center",children:n});var r=(0,x.jsx)(me.A,{text:(0,p.AP)("No connected devices")}),o=(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("table",{className:"table-hover",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"19%",children:(0,p.AP)("User")}),(0,x.jsxs)("th",{width:"19%",children:[(0,p.AP)("Platform")," / ",(0,p.AP)("Version")]}),(0,x.jsx)("th",{width:"19%",children:(0,p.AP)("Device Name")}),(0,x.jsx)("th",{width:"19%",children:(0,p.AP)("IP")}),(0,x.jsx)("th",{width:"19%",children:(0,p.AP)("Last Access")}),(0,x.jsx)("th",{width:"5%"})]})}),(0,x.jsx)("tbody",{children:i.map((function(e,t){return(0,x.jsx)(Ae,{item:e},t)}))})]}),(0,x.jsx)(X.A,{gotoPreviousPage:this.getPreviousPageDevicesList,gotoNextPage:this.getNextPageDevicesList,currentPage:s.current_page,hasNextPage:s.has_next_page,curPerPage:a,resetPerPage:this.props.resetPerPage})]});return i.length?o:r}}])}(l.Component),Ae=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleMouseOver=function(){n.setState({isHighlighted:!0,isOpIconShown:!0})},n.handleMouseOut=function(){n.setState({isHighlighted:!1,isOpIconShown:!1})},n.handleUnlink=function(){n.props.item.is_desktop_client?n.toggleUnlinkDeviceDialog():n.unlinkDevice(!0)},n.toggleUnlinkDeviceDialog=function(){n.setState({isUnlinkDeviceDialogOpen:!n.state.isUnlinkDeviceDialogOpen})},n.unlinkDevice=function(e){var t=n.props.item,i=t.platform,s=t.device_id,a=t.user;S.H.sysAdminUnlinkDevice(i,s,a,e).then((function(e){n.setState({unlinked:!0});var t=(0,p.AP)("Successfully unlinked the device.");k.A.success(t)})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.state={unlinked:!1,isHighlighted:!1,isOpIconShown:!1,isUnlinkDeviceDialogOpen:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.item,t=this.state,n=t.unlinked,i=t.isUnlinkDeviceDialogOpen,s=t.isHighlighted,a=t.isOpIconShown;return n?null:(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("tr",{className:fe()({"tr-highlight":s}),onMouseEnter:this.handleMouseOver,onMouseLeave:this.handleMouseOut,onFocus:this.onMouseEnter,children:[(0,x.jsx)("td",{children:e.user_name}),(0,x.jsxs)("td",{children:[e.platform," / ",e.client_version]}),(0,x.jsx)("td",{children:e.device_name}),(0,x.jsx)("td",{children:e.last_login_ip}),(0,x.jsx)("td",{children:(0,x.jsx)("span",{title:M()(e.last_accessed).format("dddd, MMMM D, YYYY h:mm:ss A"),children:M()(e.last_accessed).fromNow()})}),(0,x.jsx)("td",{children:(0,x.jsx)("i",{className:"sf3-font-delete1 sf3-font op-icon ".concat(a?"":"invisible"),title:(0,p.AP)("Unlink"),onClick:this.handleUnlink})})]}),i&&(0,x.jsx)(ve.A,{unlinkDevice:this.unlinkDevice,toggleDialog:this.toggleUnlinkDeviceDialog})]})}}])}(l.Component),ye=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).getDevicesListByPage=function(e){var t=n.props.devicesPlatform,i=n.state.perPage;S.H.sysAdminListDevices(t,e,i).then((function(e){n.setState({devicesData:e.data.devices,pageInfo:e.data.page_info,loading:!1})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){n.getDevicesListByPage(1)}))},n.state={loading:!0,errorMsg:"",devicesData:[],pageInfo:{},perPage:100},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,i=n.currentPage,s=void 0===i?1:i,a=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||a),currentPage:parseInt(t.get("page")||s)},(function(){e.getDevicesListByPage(e.state.currentPage)}))}},{key:"render",value:function(){return(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsx)(xe,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.devicesData,getDevicesListByPage:this.getDevicesListByPage,curPerPage:this.state.perPage,resetPerPage:this.resetPerPage,pageInfo:this.state.pageInfo})})}}])}(l.Component),Pe=function(e){function t(e){return(0,s.default)(this,t),(0,r.default)(this,t,[e])}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(ue,{currentItem:"desktop"}),(0,x.jsx)(ye,{devicesPlatform:"desktop"})]})})]})}}])}(l.Component),be=function(e){function t(e){return(0,s.default)(this,t),(0,r.default)(this,t,[e])}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(ue,{currentItem:"mobile"}),(0,x.jsx)(ye,{devicesPlatform:"mobile"})]})})]})}}])}(l.Component),je=function(e){function t(){return(0,s.default)(this,t),(0,r.default)(this,t,arguments)}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){return(0,x.jsx)(h.N_,{to:"".concat(p.Yc,"sys/users/").concat(encodeURIComponent(this.props.email),"/"),children:this.props.name})}}])}(l.Component),Se=je;M().extend(ge());var ke=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).getPreviousPageDeviceErrorsList=function(){n.props.getDeviceErrorsListByPage(n.props.pageInfo.current_page-1)},n.getNextPageDeviceErrorsList=function(){n.props.getDeviceErrorsListByPage(n.props.pageInfo.current_page+1)},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg,i=e.items,s=e.pageInfo,a=e.curPerPage;if(t)return(0,x.jsx)(D.A,{});if(n)return(0,x.jsx)("p",{className:"error text-center",children:n});var r=(0,x.jsx)(me.A,{text:(0,p.AP)("No sync errors")}),o=(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("table",{className:"table-hover",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"16%",children:(0,p.AP)("User")}),(0,x.jsxs)("th",{width:"20%",children:[(0,p.AP)("Device")," / ",(0,p.AP)("Version")]}),(0,x.jsx)("th",{width:"16%",children:(0,p.AP)("IP")}),(0,x.jsx)("th",{width:"16%",children:(0,p.AP)("Library")}),(0,x.jsx)("th",{width:"16%",children:(0,p.AP)("Error")}),(0,x.jsx)("th",{width:"16%",children:(0,p.AP)("Time")})]})}),(0,x.jsx)("tbody",{children:i.map((function(e,t){return(0,x.jsx)(De,{item:e},t)}))})]}),(0,x.jsx)(X.A,{gotoPreviousPage:this.getPreviousPageDeviceErrorsList,gotoNextPage:this.getNextPageDeviceErrorsList,currentPage:s.current_page,hasNextPage:s.has_next_page,curPerPage:a,resetPerPage:this.props.resetPerPage})]});return i.length?o:r}}])}(l.Component),De=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleMouseOver=function(){n.setState({isOpIconShown:!0})},n.handleMouseOut=function(){n.setState({isOpIconShown:!1})},n.state={isOpIconShown:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.item;return(0,x.jsxs)("tr",{onMouseEnter:this.handleMouseOver,onMouseLeave:this.handleMouseOut,children:[(0,x.jsx)("td",{children:(0,x.jsx)(Se,{email:e.email,name:e.name})}),(0,x.jsxs)("td",{children:[e.device_name," / ",e.client_version]}),(0,x.jsx)("td",{children:e.device_ip}),(0,x.jsx)("td",{children:(0,x.jsx)(h.N_,{to:"".concat(p.Yc,"sysadmin/#libs/").concat(e.repo_id),children:e.repo_name})}),(0,x.jsx)("td",{children:e.error_msg}),(0,x.jsx)("td",{children:(0,x.jsx)("span",{className:"item-meta-info",title:M()(e.last_accessed).format("dddd, MMMM D, YYYY h:mm:ss A"),children:M()(e.error_time).fromNow()})})]})}}])}(l.Component),_e=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).getDeviceErrorsListByPage=function(e){var t=n.state.perPage;S.H.sysAdminListDeviceErrors(e,t).then((function(e){n.setState({loading:!1,devicesErrors:e.data.device_errors,pageInfo:e.data.page_info,isCleanBtnShown:e.data.device_errors.length>0})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.clean=function(){S.H.sysAdminClearDeviceErrors().then((function(e){n.setState({devicesErrors:[],isCleanBtnShown:!1});var t=(0,p.AP)("Successfully cleaned all errors.");k.A.success(t)})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){n.getDeviceErrorsListByPage(1)}))},n.state={loading:!0,errorMsg:"",devicesErrors:[],isCleanBtnShown:!1,pageInfo:{},perPage:100},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,i=n.currentPage,s=void 0===i?1:i,a=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||a),currentPage:parseInt(t.get("page")||s)},(function(){e.getDeviceErrorsListByPage(e.state.currentPage)}))}},{key:"render",value:function(){return(0,x.jsxs)(l.Fragment,{children:[this.state.isCleanBtnShown?(0,x.jsx)(_.A,(0,i.default)((0,i.default)({},this.props),{},{children:(0,x.jsx)(j.A,{className:"operation-item",onClick:this.clean,children:(0,p.AP)("Clean")})})):(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(ue,{currentItem:"errors"}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsx)(ke,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.devicesErrors,getDeviceErrorsListByPage:this.getDeviceErrorsListByPage,curPerPage:this.state.perPage,resetPerPage:this.resetPerPage,pageInfo:this.state.pageInfo})})]})})]})}}])}(l.Component),we=n(43226),Ie=n(10877),Ne=n(46882),Me=n(6754),Ce=n(20338),Le=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).toggle=function(){n.props.toggle()},n.openFileInput=function(){n.fileInputRef.current.click()},n.uploadFile=function(e){if(n.fileInputRef.current.files.length){var t=n.fileInputRef.current.files[0].name;if("xlsx"==t.substr(t.lastIndexOf(".")+1)){var i=n.fileInputRef.current.files[0];n.props.importUserInBatch(i),n.toggle()}else n.setState({errorMsg:(0,p.AP)("Please choose a .xlsx file.")})}},n.state={errorMsg:""},n.fileInputRef=l.createRef(),n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.state.errorMsg;return(0,x.jsxs)(u.A,{isOpen:!0,toggle:this.toggle,children:[(0,x.jsx)(Ce.A,{toggle:this.toggle,children:(0,p.AP)("Import users from a .xlsx file")}),(0,x.jsxs)(Ie.A,{children:[(0,x.jsx)("p",{children:(0,x.jsx)("a",{className:"text-secondary small",href:"".concat(p.Yc,"useradmin/batchadduser/example/"),children:(0,p.AP)("Download an example file")})}),(0,x.jsx)("button",{className:"btn btn-outline-primary",onClick:this.openFileInput,children:(0,p.AP)("Upload file")}),(0,x.jsx)("input",{className:"d-none",type:"file",onChange:this.uploadFile,ref:this.fileInputRef}),e&&(0,x.jsx)(Ne.A,{color:"danger",children:e})]}),(0,x.jsx)(Me.A,{children:(0,x.jsx)(j.A,{color:"secondary",onClick:this.toggle,children:(0,p.AP)("Cancel")})})]})}}])}(l.Component),Oe=n(39708),Te=n(79969),Re=n(91646),Ue=n(35077),Fe=n(98702),Ee=function(e){function t(){var e;(0,s.default)(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=(0,r.default)(this,t,[].concat(i))).translateRoles=function(e){switch(e){case"default":return(0,p.AP)("Default");case"guest":return(0,p.AP)("Guest");default:return e}},e}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){return(0,x.jsx)(Fe.A,{isTextMode:this.props.isTextMode,isEditIconShow:this.props.isEditIconShow,options:this.props.roleOptions,currentOption:this.props.currentRole,onOptionChanged:this.props.onRoleChanged,translateOption:this.translateRoles})}}])}(l.Component),ze=Ee,Be=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).checkSubmitBtnActive=function(){var e=n.state,t=e.email,i=e.password,s=e.passwordAgain,a=!0;a=!!(t.trim()&&i.trim()&&s.trim()),n.setState({isSubmitBtnActive:a})},n.toggle=function(){n.props.toggleDialog()},n.togglePasswordVisible=function(){n.setState({isPasswordVisible:!n.state.isPasswordVisible})},n.inputPassword=function(e){var t=e.target.value;n.setState({password:t,errorMsg:""},n.checkSubmitBtnActive)},n.inputPasswordAgain=function(e){var t=e.target.value;n.setState({passwordAgain:t,errorMsg:""},n.checkSubmitBtnActive)},n.generatePassword=function(){var e=f.Aq.generatePassword(8);n.setState({password:e,passwordAgain:e},n.checkSubmitBtnActive)},n.inputEmail=function(e){var t=e.target.value;n.setState({email:t},n.checkSubmitBtnActive)},n.inputName=function(e){var t=e.target.value;n.setState({name:t})},n.updateRole=function(e){n.setState({role:e})},n.handleSubmit=function(){var e=n.state,t=e.email,i=e.password,s=e.passwordAgain,a=e.name,r=e.role;if(i==s){var o={email:t.trim(),name:a.trim(),password:i.trim()};n.props.showRole&&(o.role=r),n.props.addUser(o),n.toggle()}else n.setState({errorMsg:(0,p.AP)("Passwords do not match.")})},n.state={errorMsg:"",isPasswordVisible:!1,password:"",passwordAgain:"",email:"",name:"",role:"default",isSubmitBtnActive:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props,t=e.dialogTitle,n=e.showRole,i=this.state,s=i.errorMsg,a=i.isPasswordVisible,r=i.email,o=i.name,l=i.role,c=i.password,d=i.passwordAgain,h=i.isSubmitBtnActive;return(0,x.jsxs)(u.A,{isOpen:!0,toggle:this.toggle,children:[(0,x.jsx)(Ce.A,{toggle:this.toggle,children:t||(0,p.AP)("Add Member")}),(0,x.jsxs)(Ie.A,{children:[(0,x.jsxs)(Oe.A,{autoComplete:"off",children:[(0,x.jsxs)(Te.A,{children:[(0,x.jsx)(Re.A,{children:(0,p.AP)("Email")}),(0,x.jsx)(W.A,{value:r,onChange:this.inputEmail})]}),(0,x.jsxs)(Te.A,{children:[(0,x.jsx)(Re.A,{children:(0,p.AP)("Name(optional)")}),(0,x.jsx)(W.A,{type:"text",value:o,onChange:this.inputName})]}),n&&(0,x.jsxs)(Te.A,{children:[(0,x.jsxs)(Re.A,{children:[(0,p.AP)("Role"),(0,x.jsx)("span",{className:"small text-secondary ml-1 sf3-font sf3-font-tips",title:(0,p.AP)("You can also add a user as a guest, who will not be allowed to create libraries and groups.")})]}),(0,x.jsx)(ze,{isTextMode:!1,isEditIconShow:!1,currentRole:l,roleOptions:this.props.availableRoles,onRoleChanged:this.updateRole})]}),(0,x.jsxs)(Te.A,{children:[(0,x.jsx)(Re.A,{children:(0,p.AP)("Password")}),(0,x.jsxs)(Ue.A,{children:[(0,x.jsx)(W.A,{autoComplete:"new-password",type:a?"text":"password",value:c||"",onChange:this.inputPassword}),(0,x.jsx)(j.A,{className:"mt-0",onClick:this.togglePasswordVisible,children:(0,x.jsx)("i",{className:"link-operation-icon sf3-font sf3-font-eye".concat(this.state.isPasswordVisible?"":"-slash")})}),(0,x.jsx)(j.A,{className:"mt-0",onClick:this.generatePassword,children:(0,x.jsx)("i",{className:"link-operation-icon sf3-font sf3-font-magic"})})]})]}),(0,x.jsxs)(Te.A,{children:[(0,x.jsx)(Re.A,{children:(0,p.AP)("Password again")}),(0,x.jsx)(W.A,{type:a?"text":"password",value:d||"",onChange:this.inputPasswordAgain})]})]}),s&&(0,x.jsx)(Ne.A,{color:"danger",children:s})]}),(0,x.jsxs)(Me.A,{children:[(0,x.jsx)(j.A,{color:"secondary",onClick:this.toggle,children:(0,p.AP)("Cancel")}),(0,x.jsx)(j.A,{color:"primary",onClick:this.handleSubmit,disabled:!h,children:(0,p.AP)("Submit")})]})]})}}])}(l.Component),He=n(98361),qe=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).toggle=function(){n.props.toggle()},n.handleSelectChange=function(e){n.setState({selectedUsers:e,isSubmitBtnActive:e.length>0})},n.handleSubmit=function(){n.props.addAdminInBatch(n.state.selectedUsers.map((function(e){return e.email}))),n.toggle()},n.state={selectedUsers:[],isSubmitBtnActive:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){return(0,x.jsxs)(u.A,{isOpen:!0,toggle:this.toggle,children:[(0,x.jsx)(Ce.A,{toggle:this.toggle,children:(0,p.AP)("Add Admin")}),(0,x.jsx)(Ie.A,{children:(0,x.jsx)(He.A,{isMulti:!0,placeholder:(0,p.AP)("Search users"),onSelectChange:this.handleSelectChange,selectedUsers:this.state.selectedUsers})}),(0,x.jsxs)(Me.A,{children:[(0,x.jsx)(j.A,{color:"secondary",onClick:this.toggle,children:(0,p.AP)("Cancel")}),(0,x.jsx)(j.A,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive,children:(0,p.AP)("Submit")})]})]})}}])}(l.Component),Ye=n(82487),Ve=(0,a.default)((function e(t){(0,s.default)(this,e),this.email=t.email,this.name=t.name,this.contact_email=t.contact_email,this.login_id=t.login_id,this.last_login=t.last_login,this.last_access_time=t.last_access_time,this.create_time=t.create_time,this.is_active=t.is_active,this.is_staff=t.is_staff,this.department=t.department,this.quota_total=t.quota_total,this.quota_usage=t.quota_usage,this.role=t.role,this.institution=t.institution,t.org_id&&(this.org_id=t.org_id),t.org_name&&(this.org_name=t.org_name),this.isSelected=!1})),Ge=(0,a.default)((function e(t){(0,s.default)(this,e),this.email=t.email,this.name=t.name,this.contact_email=t.contact_email,this.login_id=t.login_id,this.last_login=t.last_login,this.last_access_time=t.last_access_time,this.create_time=t.create_time,this.is_active=t.is_active,this.is_staff=t.is_staff,this.quota_total=t.quota_total,this.quota_usage=t.quota_usage,this.admin_role=t.admin_role,this.isSelected=!1})),We=n(33320),Qe=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).navItems=[{name:"database",urlPart:"users",text:(0,p.AP)("Database")}],p.eB&&n.navItems.push({name:"ldap",urlPart:"users/ldap",text:(0,p.AP)("LDAP")},{name:"ldap-imported",urlPart:"users/ldap-imported",text:(0,p.AP)("LDAP(imported)")}),p.gv&&n.navItems.push({name:"admin",urlPart:"users/admins",text:(0,p.AP)("Admin")}),n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.currentItem;return(0,x.jsx)("div",{className:"cur-view-path tab-nav-container",children:(0,x.jsx)("ul",{className:"nav",children:this.navItems.map((function(t,n){return(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(h.N_,{to:"".concat(p.Yc,"sys/").concat(t.urlPart,"/"),className:"nav-link".concat(e==t.name?" active":""),children:t.text})},n)}))})})}}])}(l.Component),Ke=Qe,$e=n(66149),Xe=window.sysadmin.pageOptions.availableRoles,Ze=function(e){function t(){var e;(0,s.default)(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=(0,r.default)(this,t,[].concat(i))).translateRole=function(e){switch(e){case"":return(0,p.AP)("All");case"default":return(0,p.AP)("Default");case"guest":return(0,p.AP)("Guest");default:return e}},e.selectStatusOption=function(t){e.props.onStatusChange(t.value)},e.selectRoleOption=function(t){e.props.onRoleChange(t.value)},e}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.isActive,i=t.role;this.statusOptions=[{value:"",text:(0,p.AP)("All")},{value:"1",text:(0,p.AP)("Active")},{value:"0",text:(0,p.AP)("Inactive")}].map((function(e){return e.isSelected=n==e.value,e}));var s=this.statusOptions.filter((function(e){return e.isSelected}))[0];this.roleOptions=[""].concat(Xe).map((function(t){return{value:t,text:e.translateRole(t),isSelected:t==i}}));var a=this.roleOptions.filter((function(e){return e.isSelected}))[0]||{value:i,text:this.translateRole(i),isSelected:!0};return(0,x.jsxs)("div",{className:"users-filter-bar mt-4 mb-2 d-flex align-items-center",children:[(0,x.jsx)("span",{className:"filter-item mr-2",children:"".concat((0,p.AP)("Status"),":")}),(0,x.jsx)($e.A,{isDropdownToggleShown:!0,currentSelectedOption:s,options:this.statusOptions,selectOption:this.selectStatusOption}),(0,x.jsx)("span",{className:"filter-item mr-2 ml-4",children:"".concat((0,p.AP)("Role"),":")}),(0,x.jsx)($e.A,{isDropdownToggleShown:!0,currentSelectedOption:a,options:this.roleOptions,selectOption:this.selectRoleOption})]})}}])}(l.Component),Je=Ze,et=n(61314),tt=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleOptionChange=function(e){n.setState({keepSharing:"true"===e.target.value})},n.submit=function(){n.props.onSubmit(n.state.keepSharing),n.props.toggleDialog()},n.state={keepSharing:!0},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){return(0,x.jsxs)(u.A,{isOpen:!0,toggle:this.props.toggleDialog,children:[(0,x.jsx)(Ce.A,{toggle:this.props.toggleDialog,children:(0,p.AP)("Set user inactive")}),(0,x.jsx)(Ie.A,{children:(0,x.jsx)(Oe.A,{children:(0,x.jsxs)(Te.A,{tag:"fieldset",children:[(0,x.jsx)("p",{children:(0,p.AP)("Do you want to keep the sharing relationships?")}),(0,x.jsx)(Te.A,{check:!0,children:(0,x.jsxs)(Re.A,{check:!0,children:[(0,x.jsx)(W.A,{type:"radio",name:"keepSharing",value:"true",checked:!0===this.state.keepSharing,onChange:this.handleOptionChange,className:"mr-2"}),(0,p.AP)("Keep sharing")]})}),(0,x.jsx)(Te.A,{check:!0,children:(0,x.jsxs)(Re.A,{check:!0,children:[(0,x.jsx)(W.A,{type:"radio",name:"keepSharing",value:"false",checked:!1===this.state.keepSharing,onChange:this.handleOptionChange,className:"mr-2"}),(0,p.AP)("Do not keep sharing")]})})]})})}),(0,x.jsxs)(Me.A,{children:[(0,x.jsx)(j.A,{color:"secondary",onClick:this.props.toggleDialog,children:(0,p.AP)("Cancel")}),(0,x.jsx)(j.A,{color:"primary",onClick:this.submit,children:(0,p.AP)("Submit")})]})]})}}])}(l.Component),nt=window.sysadmin.pageOptions,it=nt.availableRoles,st=nt.availableAdminRoles,at=nt.institutions;M().extend(ge());var rt=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).toggleItemFreezed=function(e){n.setState({isItemFreezed:e})},n.onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.getPreviousPage=function(){n.props.getListByPage(n.props.currentPage-1)},n.getNextPage=function(){n.props.getListByPage(n.props.currentPage+1)},n.sortByQuotaUsage=function(e){e.preventDefault(),n.props.sortByQuotaUsage()},n.state={isItemFreezed:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.isAdmin,i=t.loading,s=t.errorMsg,a=t.items,r=t.isAllUsersSelected,o=t.curPerPage,c=t.hasNextPage,d=t.currentPage,u=t.sortBy,h=t.sortOrder;if(i)return(0,x.jsx)(D.A,{});if(s)return(0,x.jsx)("p",{className:"error text-center mt-4",children:s});var g,f=[];g=""==u?(0,x.jsx)("span",{className:"sf3-font sf3-font-sort3"}):(0,x.jsx)("span",{className:"sf3-font ".concat("asc"==h?"sf3-font-down rotate-180 d-inline-block":"sf3-font-down")});var m=(0,p.AP)("Space Used"),v=void 0!=u?(0,x.jsxs)("a",{className:"d-inline-block table-sort-op",href:"#",onClick:this.sortByQuotaUsage,children:[m," ",g]}):m,A=(0,x.jsxs)(l.Fragment,{children:[v," / ".concat((0,p.AP)("Quota"))]}),y="".concat((0,p.AP)("Name")," / ").concat((0,p.AP)("Contact Email")),P="".concat((0,p.AP)("Created At")," / ").concat((0,p.AP)("Last Login")," / ").concat((0,p.AP)("Last Access"));p.am?f.push({width:"20%",text:y},{width:"15%",text:(0,p.AP)("Status")},{width:"15%",text:(0,p.AP)("Role")}):f.push({width:"30%",text:y},{width:"20%",text:(0,p.AP)("Status")}),p.Oq&&!n?f.push({width:"14%",text:A},{width:"14%",text:(0,p.AP)("Institution")},{width:"14%",text:P},{width:"5%",text:""}):f.push({width:"20%",text:A},{width:"22%",text:P},{width:"5%",text:""});var b=(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("table",{children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"3%",className:"pl-2",children:(0,x.jsx)("input",{type:"checkbox",className:"vam",onChange:this.props.toggleSelectAllUsers,checked:r})}),f.map((function(e,t){return(0,x.jsx)("th",{width:e.width,children:e.text},t)}))]})}),(0,x.jsx)("tbody",{children:a.map((function(t,n){return n<e.props.curPerPage?(0,x.jsx)(ot,{item:t,isItemFreezed:e.state.isItemFreezed,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem,toggleItemFreezed:e.toggleItemFreezed,updateUser:e.props.updateUser,deleteUser:e.props.deleteUser,updateAdminRole:e.props.updateAdminRole,revokeAdmin:e.props.revokeAdmin,onUserSelected:e.props.onUserSelected,isAdmin:e.props.isAdmin,isLDAPImported:e.props.isLDAPImported},n):null}))})]}),!this.props.isAdmin&&!this.props.isSearchResult&&(0,x.jsx)(X.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:d,hasNextPage:c,curPerPage:o,resetPerPage:this.props.resetPerPage})]});return(0,x.jsx)("div",{children:a.length?b:(0,x.jsx)(me.A,{text:(0,p.AP)("No users")})})}}])}(l.Component),ot=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleMouseEnter=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!0,highlight:!0})},n.handleMouseLeave=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!1,highlight:!1})},n.onUnfreezedItem=function(){n.setState({highlight:!1,isOpIconShow:!1}),n.props.onUnfreezedItem()},n.toggleSetQuotaDialog=function(){n.setState({isSetQuotaDialogOpen:!n.state.isSetQuotaDialogOpen})},n.toggleDeleteUserDialog=function(){n.setState({isDeleteUserDialogOpen:!n.state.isDeleteUserDialogOpen})},n.toggleResetUserPasswordDialog=function(){n.setState({isResetUserPasswordDialogOpen:!n.state.isResetUserPasswordDialogOpen})},n.toggleRevokeAdminDialog=function(){n.setState({isRevokeAdminDialogOpen:!n.state.isRevokeAdminDialogOpen})},n.toggleConfirmInactiveDialog=function(e){"active"!==(null===e||void 0===e?void 0:e.value)&&n.setState({isConfirmInactiveDialogOpen:!n.state.isConfirmInactiveDialogOpen})},n.onUserSelected=function(){n.props.onUserSelected(n.props.item)},n.updateStatus=function(e){var t="active"==e.value;t&&k.A.notify((0,p.AP)("It may take some time, please wait.")),n.props.updateUser(n.props.item.email,"is_active",t)},n.setUserInactive=function(e){n.props.updateUser(n.props.item.email,"is_active",!1,{keep_sharing:e}),n.toggleConfirmInactiveDialog()},n.updateRole=function(e){n.props.updateUser(n.props.item.email,"role",e.value)},n.updateAdminRole=function(e){n.props.updateAdminRole(n.props.item.email,e.value)},n.translateRole=function(e){switch(e){case"default":return(0,p.AP)("Default");case"guest":return(0,p.AP)("Guest");default:return e}},n.translateAdminRole=function(e){switch(e){case"default_admin":return(0,p.AP)("Default Admin");case"system_admin":return(0,p.AP)("System Admin");case"daily_admin":return(0,p.AP)("Daily Admin");case"audit_admin":return(0,p.AP)("Audit Admin");default:return e}},n.translateStatus=function(e){switch(e){case"active":return(0,p.AP)("Active");case"inactive":return(0,p.AP)("Inactive")}},n.updateInstitution=function(e){n.props.updateUser(n.props.item.email,"institution",e.value)},n.updateQuota=function(e){n.props.updateUser(n.props.item.email,"quota_total",e)},n.deleteUser=function(){k.A.notify((0,p.AP)("It may take some time, please wait.")),n.props.deleteUser(n.props.item.email,n.props.item.name)},n.resetPassword=function(){k.A.notify((0,p.AP)("It may take some time, please wait.")),S.H.sysAdminResetUserPassword(n.props.item.email).then((function(e){k.A.success(e.data.reset_tip)})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.revokeAdmin=function(){var e=n.props.item;n.props.revokeAdmin(e.email,e.name)},n.getMenuOperations=function(){var e=n.props,t=e.isAdmin,i=e.isLDAPImported,s=e.isSearchResult,a=e.item,r=["Delete"];return(!i||s&&"db"==a.source)&&r.push("Reset Password"),t&&(r=["Revoke Admin"]),r},n.translateOperations=function(e){var t="";switch(e){case"Delete":t=(0,p.AP)("Delete");break;case"Reset Password":t=(0,p.AP)("Reset Password");break;case"Revoke Admin":t=(0,p.AP)("Revoke Admin")}return t},n.onMenuItemClick=function(e){switch(e){case"Delete":n.toggleDeleteUserDialog();break;case"Reset Password":n.toggleResetUserPasswordDialog();break;case"Revoke Admin":n.toggleRevokeAdminDialog()}},n.state={isOpIconShown:!1,highlight:!1,isSetQuotaDialogOpen:!1,isDeleteUserDialogOpen:!1,isResetUserPasswordDialogOpen:!1,isRevokeAdminDialogOpen:!1,isConfirmInactiveDialogOpen:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.item,i=t.isAdmin,s=this.state,a=s.highlight,r=s.isOpIconShown,o=s.isSetQuotaDialogOpen,c=s.isDeleteUserDialogOpen,d=s.isResetUserPasswordDialogOpen,u=s.isRevokeAdminDialogOpen,g=s.isConfirmInactiveDialogOpen,m='<span class="op-target">'+f.Aq.HTMLescape(n.name)+"</span>",v=(0,p.AP)("Are you sure you want to delete {placeholder} ?").replace("{placeholder}",m),A=(0,p.AP)("Are you sure you want to reset the password of {placeholder} ?").replace("{placeholder}",m),y=(0,p.AP)("Are you sure you want to revoke the admin permission of {placeholder} ?").replace("{placeholder}",m),P=n.is_active?"active":"inactive";this.statusOptions=["active","inactive"].map((function(t){return{value:t,text:e.translateStatus(t),isSelected:t==P}}));var b,j,S,k=this.statusOptions.filter((function(e){return e.isSelected}))[0];if(i){var D=n.admin_role;this.adminRoleOptions=st.map((function(t){return{value:t,text:e.translateAdminRole(t),isSelected:t==D}})),b=this.adminRoleOptions.filter((function(e){return e.isSelected}))[0]}else{var _=n.role;this.roleOptions=it.map((function(t){return{value:t,text:e.translateRole(t),isSelected:t==_}})),j=this.roleOptions.filter((function(e){return e.isSelected}))[0]||{value:_,text:this.translateRole(_),isSelected:!0}}if(p.Oq&&!i){var w=n.institution;this.instOptions=at.map((function(e){return{value:e,text:e,isSelected:e==w}})),S=this.instOptions.filter((function(e){return e.isSelected}))[0]}return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,x.jsx)("td",{className:"pl-2",children:(0,x.jsx)("input",{type:"checkbox",className:"vam",onChange:this.onUserSelected,checked:n.isSelected})}),(0,x.jsxs)("td",{children:[(0,x.jsx)(Se,{email:n.email,name:n.name}),n.contact_email&&(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)("br",{}),n.contact_email]}),n.org_id&&(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)("br",{}),(0,x.jsxs)(h.N_,{to:"".concat(p.Yc,"sys/organizations/").concat(n.org_id,"/info/"),children:["(",n.org_name,")"]})]})]}),(0,x.jsx)("td",{children:(0,x.jsx)($e.A,{isDropdownToggleShown:a,currentSelectedOption:k,options:this.statusOptions,selectOption:this.updateStatus,toggleItemFreezed:this.props.toggleItemFreezed,operationBeforeSelect:n.is_active?this.toggleConfirmInactiveDialog:void 0})}),p.am&&(0,x.jsx)("td",{children:i?(0,x.jsx)($e.A,{isDropdownToggleShown:a,currentSelectedOption:b,options:this.adminRoleOptions,selectOption:this.updateAdminRole,toggleItemFreezed:this.props.toggleItemFreezed}):(0,x.jsx)($e.A,{isDropdownToggleShown:a,currentSelectedOption:j,options:this.roleOptions,selectOption:this.updateRole,toggleItemFreezed:this.props.toggleItemFreezed})}),(0,x.jsxs)("td",{children:["".concat(f.Aq.bytesToSize(n.quota_usage)," / ").concat(n.quota_total>0?f.Aq.bytesToSize(n.quota_total):"--"),(0,x.jsx)("i",{title:(0,p.AP)("Edit"),className:"sf3-font sf3-font-rename op-icon ml-1 ".concat(r?"":"invisible"),onClick:this.toggleSetQuotaDialog})]}),p.Oq&&!i&&(0,x.jsx)("td",{children:(0,x.jsx)($e.A,{isDropdownToggleShown:a&&at.length>0,currentSelectedOption:S,options:this.instOptions,selectOption:this.updateInstitution,toggleItemFreezed:this.props.toggleItemFreezed})}),(0,x.jsxs)("td",{children:["".concat(n.create_time?M()(n.create_time).format("YYYY-MM-DD HH:mm"):"--"," /"),(0,x.jsx)("br",{}),"".concat(n.last_login?M()(n.last_login).fromNow():"--"),(0,x.jsx)("br",{}),"".concat(n.last_access_time?M()(n.last_access_time).fromNow():"--")]}),(0,x.jsx)("td",{children:n.email!=p.Xh&&r&&(0,x.jsx)(et.A,{operations:this.getMenuOperations(),translateOperations:this.translateOperations,onMenuItemClick:this.onMenuItemClick,onFreezedItem:this.props.onFreezedItem,onUnfreezedItem:this.onUnfreezedItem})})]}),o&&(0,x.jsx)(we.A,{toggle:this.toggleSetQuotaDialog,updateQuota:this.updateQuota}),c&&(0,x.jsx)(Ye.A,{title:(0,p.AP)("Delete User"),message:v,executeOperation:this.deleteUser,confirmBtnText:(0,p.AP)("Delete"),toggleDialog:this.toggleDeleteUserDialog}),d&&(0,x.jsx)(Ye.A,{title:(0,p.AP)("Reset Password"),message:A,executeOperation:this.resetPassword,confirmBtnText:(0,p.AP)("Reset"),toggleDialog:this.toggleResetUserPasswordDialog}),u&&(0,x.jsx)(Ye.A,{title:(0,p.AP)("Revoke Admin"),message:y,executeOperation:this.revokeAdmin,confirmBtnText:(0,p.AP)("Revoke"),toggleDialog:this.toggleRevokeAdminDialog}),g&&(0,x.jsx)(tt,{toggleDialog:this.toggleConfirmInactiveDialog,onSubmit:this.setUserInactive})]})}}])}(l.Component),lt=rt,ct=window.sysadmin.pageOptions.availableRoles,dt=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).toggleImportUserDialog=function(){n.setState({isImportUserDialogOpen:!n.state.isImportUserDialogOpen})},n.toggleAddUserDialog=function(){n.setState({isAddUserDialogOpen:!n.state.isAddUserDialogOpen})},n.toggleBatchSetQuotaDialog=function(){n.setState({isBatchSetQuotaDialogOpen:!n.state.isBatchSetQuotaDialogOpen})},n.toggleBatchDeleteUserDialog=function(){n.setState({isBatchDeleteUserDialogOpen:!n.state.isBatchDeleteUserDialogOpen})},n.onUserSelected=function(e){var t=!1,i=[],s=n.state.userList.map((function(n){return n.email===e.email&&(n.isSelected=!n.isSelected),1==n.isSelected?(t=!0,i.push(n)):i=i.filter((function(e){return e.email!=n.email})),n}));n.setState({userList:s,hasUserSelected:t,selectedUserList:i})},n.toggleSelectAllUsers=function(){if(n.state.isAllUsersSelected){var e=n.state.userList.map((function(e){return e.isSelected=!1,e}));n.setState({userList:e,hasUserSelected:!1,isAllUsersSelected:!1,selectedUserList:[]})}else{var t=n.state.userList.map((function(e){return e.isSelected=!0,e}));n.setState({userList:t,hasUserSelected:!0,isAllUsersSelected:!0,selectedUserList:t})}},n.getUserList=function(){S.H.sysAdminListAdmins().then((function(e){var t=e.data.admin_user_list.map((function(e){return new Ge(e)}));n.setState({userList:t,loading:!1})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.getUsersListByPage=function(e){var t=n.state,i=t.perPage,s=t.sortBy,a=t.sortOrder,r=t.is_active,o=t.role,l=n.props.isLDAPImported;S.H.sysAdminListUsers(e,i,l,s,a,r,o).then((function(t){var s=t.data.data.map((function(e){return new Ve(e)}));n.setState({userList:s,loading:!1,hasNextPage:f.Aq.hasNextPage(e,i,t.data.total_count),currentPage:e})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.updateURLSearchParams=function(e){var t=new URL(location.href),n=new URLSearchParams(t.search);for(var i in e)n.set(i,e[i]);t.search=n.toString(),(0,h.oo)(t.toString())},n.onStatusChange=function(e){n.setState({is_active:e,currentPage:1},(function(){var t=n.state,i=t.currentPage,s=t.perPage;n.updateURLSearchParams({page:i,per_page:s,is_active:e}),n.getUsersListByPage(i)}))},n.onRoleChange=function(e){n.setState({role:e,currentPage:1},(function(){var t=n.state,i=t.currentPage,s=t.perPage;n.updateURLSearchParams({page:i,per_page:s,role:e}),n.getUsersListByPage(i)}))},n.sortByQuotaUsage=function(){n.setState({sortBy:"quota_usage",sortOrder:"asc"==n.state.sortOrder?"desc":"asc",currentPage:1},(function(){var e=n.state,t=e.currentPage,i=e.perPage,s=e.sortBy,a=e.sortOrder;n.updateURLSearchParams({page:t,per_page:i,order_by:s,direction:a}),n.getUsersListByPage(t)}))},n.deleteUser=function(e,t){S.H.sysAdminDeleteUser(e).then((function(i){var s=n.state.userList.filter((function(t){return t.email!=e}));n.setState({userList:s});var a=(0,p.AP)("Deleted user %s");a=a.replace("%s",t),k.A.success(a)})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.setUserQuotaInBatch=function(e){var t=n.state.selectedUserList.map((function(e){return e.email}));S.H.sysAdminSetUserQuotaInBatch(t,e).then((function(e){var t=n.state.userList.map((function(t){return e.data.success.forEach((function(e){t.email==e.email&&(t.quota_total=e.quota_total)})),t}));n.setState({userList:t})})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.deleteUserInBatch=function(){var e=n.state.selectedUserList.map((function(e){return e.email}));S.H.sysAdminDeleteUserInBatch(e).then((function(t){if(t.data.success.length){var i=n.state.userList.filter((function(e){return!t.data.success.some((function(t){return t.email==e.email}))}));n.setState({userList:i,hasUserSelected:e.length!=t.data.success.length});var s=t.data.success.length,a=1==s?(0,p.AP)("Successfully deleted 1 user."):(0,p.AP)("Successfully deleted {user_number_placeholder} users.").replace("{user_number_placeholder}",s);k.A.success(a)}t.data.failed.forEach((function(e){var t="".concat(e.email,": ").concat(e.error_msg);k.A.danger(t)}))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.importUserInBatch=function(e){k.A.notify((0,p.AP)("It may take some time, please wait.")),S.H.sysAdminImportUserViaFile(e).then((function(e){if(e.data.success.length){var t=e.data.success.map((function(e){return void 0==e.institution&&(e.institution=""),new Ve(e)}));n.setState({userList:t.concat(n.state.userList)})}e.data.failed.forEach((function(e){var t="".concat(e.email,": ").concat(e.error_msg);k.A.danger(t)}))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.addUser=function(e){k.A.notify((0,p.AP)("It may take some time, please wait."));var t=e.email,i=e.name,s=e.role,a=e.password;S.H.sysAdminAddUser(t,i,s,a).then((function(e){var t=n.state.userList;t.unshift(e.data),n.setState({userList:t}),k.A.success(e.data.add_user_tip)})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){n.getUsersListByPage(1)}))},n.updateUser=function(e,t,i){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};S.H.sysAdminUpdateUser(e,t,i,s).then((function(s){var a=n.state.userList.map((function(n){return n.email==e&&(n[t]=s.data[t]),n}));n.setState({userList:a});var r="is_active"==t&&i?s.data.update_status_tip:(0,p.AP)("Edit succeeded");k.A.success(r)})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.updateAdminRole=function(e,t){S.H.sysAdminUpdateAdminRole(e,t).then((function(t){var i=n.state.userList.map((function(n){return n.email==e&&(n.admin_role=t.data.role),n}));n.setState({userList:i}),k.A.success((0,p.AP)("Edit succeeded"))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.revokeAdmin=function(e,t){S.H.sysAdminUpdateUser(e,"is_staff",!1).then((function(i){var s=n.state.userList.filter((function(t){return t.email!=e}));n.setState({userList:s}),k.A.success((0,p.AP)("Successfully revoked the admin permission of {placeholder}.").replace("{placeholder}",t))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.getOperationsForAll=function(){var e=n.props,t=e.isAdmin,i=e.isLDAPImported;return t?(0,x.jsx)(j.A,{className:"btn btn-secondary operation-item",onClick:n.toggleBatchAddAdminDialog,children:(0,p.AP)("Add Admin")}):i?(0,x.jsx)("a",{className:"btn btn-secondary operation-item",href:"".concat(p.Yc,"sys/useradmin/export-excel/"),children:(0,p.AP)("Export Excel")}):(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(j.A,{className:"btn btn-secondary operation-item",onClick:n.toggleImportUserDialog,children:(0,p.AP)("Import Users")}),(0,x.jsx)(j.A,{className:"btn btn-secondary operation-item",onClick:n.toggleAddUserDialog,children:(0,p.AP)("Add User")}),(0,x.jsx)("a",{className:"btn btn-secondary operation-item",href:"".concat(p.Yc,"sys/useradmin/export-excel/"),children:(0,p.AP)("Export Excel")})]})},n.getCurrentNavItem=function(){var e=n.props,t=e.isAdmin,i=e.isLDAPImported,s="database";return t?s="admin":i&&(s="ldap-imported"),s},n.toggleBatchAddAdminDialog=function(){n.setState({isBatchAddAdminDialogOpen:!n.state.isBatchAddAdminDialogOpen})},n.addAdminInBatch=function(e){S.H.sysAdminAddAdminInBatch(e).then((function(e){var t=e.data.success.map((function(e){return new Ge(e)}));n.setState({userList:t.concat(n.state.userList)}),e.data.failed.forEach((function(e){var t="".concat(e.email,": ").concat(e.error_msg);k.A.danger(t)}))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.getSearch=function(){return n.props.isAdmin?null:(0,x.jsx)(We.A,{placeholder:(0,p.AP)("Search users"),submit:n.searchItems})},n.searchItems=function(e){(0,h.oo)("".concat(p.Yc,"sys/search-users/?query=").concat(encodeURIComponent(e)))},n.state={loading:!0,errorMsg:"",userList:[],hasNextPage:!1,currentPage:1,perPage:100,hasUserSelected:!1,selectedUserList:[],isAllUsersSelected:!1,isImportUserDialogOpen:!1,isAddUserDialogOpen:!1,isBatchSetQuotaDialogOpen:!1,isBatchDeleteUserDialogOpen:!1,isBatchAddAdminDialogOpen:!1,is_active:"",role:""},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this;if(this.props.isAdmin)this.getUserList();else{var t=new URL(window.location).searchParams,n=this.state,i=n.currentPage,s=n.perPage,a=n.sortBy,r=void 0===a?"":a,o=n.sortOrder,l=void 0===o?"asc":o,c=n.is_active,d=n.role;this.setState({perPage:parseInt(t.get("per_page")||s),currentPage:parseInt(t.get("page")||i),sortBy:t.get("order_by")||r,sortOrder:t.get("direction")||l,is_active:t.get("is_active")||c,role:t.get("role")||d},(function(){e.getUsersListByPage(e.state.currentPage)}))}}},{key:"render",value:function(){var e=this.props,t=e.isAdmin,n=e.isLDAPImported,s=this.state,a=s.is_active,r=s.role,o=s.hasUserSelected,c=s.isImportUserDialogOpen,d=s.isAddUserDialogOpen,u=s.isBatchDeleteUserDialogOpen,h=s.isBatchSetQuotaDialogOpen,g=s.isBatchAddAdminDialogOpen,f=this.getCurrentNavItem();return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)((0,i.default)({search:this.getSearch()},this.props),{},{children:o?(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(j.A,{className:"btn btn-secondary operation-item",onClick:this.toggleBatchSetQuotaDialog,children:(0,p.AP)("Set Quota")}),(0,x.jsx)(j.A,{className:"btn btn-secondary operation-item",onClick:this.toggleBatchDeleteUserDialog,children:(0,p.AP)("Delete Users")})]}):this.getOperationsForAll()})),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(Ke,{currentItem:f}),(0,x.jsxs)("div",{className:"cur-view-content",children:["database"==f&&(0,x.jsx)(Je,{isActive:a,role:r,onStatusChange:this.onStatusChange,onRoleChange:this.onRoleChange}),(0,x.jsx)(lt,{isAdmin:t,isLDAPImported:n,loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.userList,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortByQuotaUsage:this.sortByQuotaUsage,currentPage:this.state.currentPage,hasNextPage:this.state.hasNextPage,curPerPage:this.state.perPage,resetPerPage:this.resetPerPage,getListByPage:this.getUsersListByPage,updateUser:this.updateUser,deleteUser:this.deleteUser,updateAdminRole:this.updateAdminRole,revokeAdmin:this.revokeAdmin,onUserSelected:this.onUserSelected,isAllUsersSelected:this.isAllUsersSelected,toggleSelectAllUsers:this.toggleSelectAllUsers})]})]})}),c&&(0,x.jsx)(Le,{toggle:this.toggleImportUserDialog,importUserInBatch:this.importUserInBatch}),d&&(0,x.jsx)(Be,{dialogTitle:(0,p.AP)("Add User"),showRole:p.am,availableRoles:ct,addUser:this.addUser,toggleDialog:this.toggleAddUserDialog}),h&&(0,x.jsx)(we.A,{toggle:this.toggleBatchSetQuotaDialog,updateQuota:this.setUserQuotaInBatch}),u&&(0,x.jsx)(Ye.A,{title:(0,p.AP)("Delete Users"),message:(0,p.AP)("Are you sure you want to delete the selected user(s) ?"),executeOperation:this.deleteUserInBatch,confirmBtnText:(0,p.AP)("Delete"),toggleDialog:this.toggleBatchDeleteUserDialog}),g&&(0,x.jsx)(qe,{addAdminInBatch:this.addAdminInBatch,toggle:this.toggleBatchAddAdminDialog})]})}}])}(l.Component),ut=dt,ht=function(e){function t(){return(0,s.default)(this,t),(0,r.default)(this,t,arguments)}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){return(0,x.jsx)(ut,(0,i.default)({isAdmin:!0},this.props))}}])}(l.Component),gt=ht,pt=function(e){function t(){return(0,s.default)(this,t),(0,r.default)(this,t,arguments)}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){return(0,x.jsx)(ut,(0,i.default)({isLDAPImported:!0},this.props))}}])}(l.Component),ft=pt;M().extend(ge());var mt=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).getPreviousPage=function(){n.props.getListByPage(n.props.currentPage-1)},n.getNextPage=function(){n.props.getListByPage(n.props.currentPage+1)},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg,i=e.items,s=e.curPerPage,a=e.hasNextPage,r=e.currentPage;if(t)return(0,x.jsx)(D.A,{});if(n)return(0,x.jsx)("p",{className:"error text-center mt-4",children:n});var o=(0,x.jsx)(me.A,{text:(0,p.AP)("No users")}),c=(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("table",{className:"table-hover",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"40%",children:(0,p.AP)("Email")}),(0,x.jsxs)("th",{width:"30%",children:[(0,p.AP)("Space Used")," / ",(0,p.AP)("Quota")]}),(0,x.jsx)("th",{width:"30%",children:(0,p.AP)("Last Login")})]})}),(0,x.jsx)("tbody",{children:i.map((function(e,t){return(0,x.jsx)(vt,{item:e},t)}))})]}),(0,x.jsx)(X.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:r,hasNextPage:a,curPerPage:s,resetPerPage:this.props.resetPerPage})]});return i.length?c:o}}])}(l.Component),vt=function(e){function t(){return(0,s.default)(this,t),(0,r.default)(this,t,arguments)}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.item;return(0,x.jsx)(l.Fragment,{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:(0,x.jsx)(Se,{email:e.email,name:e.email})}),(0,x.jsx)("td",{children:"".concat(f.Aq.bytesToSize(e.quota_usage)," / ").concat(e.quota_total>0?f.Aq.bytesToSize(e.quota_total):"--")}),(0,x.jsx)("td",{children:e.last_login?M()(e.last_login).fromNow():"--"})]})})}}])}(l.Component),xt=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).getUsersListByPage=function(e){var t=n.state.perPage;S.H.sysAdminListLDAPUsers(e,t).then((function(t){n.setState({loading:!1,userList:t.data.ldap_user_list,hasNextPage:t.data.has_next_page,currentPage:e})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){n.getUsersListByPage(1)}))},n.state={loading:!0,errorMsg:"",userList:{},hasNextPage:!1,currentPage:1,perPage:100},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,i=n.currentPage,s=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||s),currentPage:parseInt(t.get("page")||i)},(function(){e.getUsersListByPage(e.state.currentPage)}))}},{key:"render",value:function(){return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(Ke,{currentItem:"ldap"}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsx)(mt,{resetPerPage:this.resetPerPage,loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.userList,currentPage:this.state.currentPage,hasNextPage:this.state.hasNextPage,curPerPage:this.state.perPage,getListByPage:this.getUsersListByPage})})]})})]})}}])}(l.Component),At=xt,yt=n(46114),Pt=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).toggleBatchSetQuotaDialog=function(){n.setState({isBatchSetQuotaDialogOpen:!n.state.isBatchSetQuotaDialogOpen})},n.toggleBatchDeleteUserDialog=function(){n.setState({isBatchDeleteUserDialogOpen:!n.state.isBatchDeleteUserDialogOpen})},n.onUserSelected=function(e){var t=!1,i=[],s=n.state.userList.map((function(n){return n.email===e.email&&(n.isSelected=!n.isSelected),1==n.isSelected?(t=!0,i.push(n)):i=i.filter((function(e){return e.email!=n.email})),n}));n.setState({userList:s,hasUserSelected:t,selectedUserList:i})},n.toggleSelectAllUsers=function(){if(n.state.isAllUsersSelected){var e=n.state.userList.map((function(e){return e.isSelected=!1,e}));n.setState({userList:e,hasUserSelected:!1,isAllUsersSelected:!1,selectedUserList:[]})}else{var t=n.state.userList.map((function(e){return e.isSelected=!0,e}));n.setState({userList:t,hasUserSelected:!0,isAllUsersSelected:!0,selectedUserList:t})}},n.getItems=function(e){S.H.sysAdminSearchUsers(n.state.query.trim(),e,n.state.perPage).then((function(e){n.setState({userList:e.data.user_list,loading:!1,pageInfo:e.data.page_info})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){n.getItems(1)}))},n.deleteUser=function(e,t){S.H.sysAdminDeleteUser(e).then((function(i){var s=n.state.userList.filter((function(t){return t.email!=e}));n.setState({userList:s});var a=(0,p.AP)("Deleted user %s");a=a.replace("%s",t),k.A.success(a)})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.setUserQuotaInBatch=function(e){var t=n.state.selectedUserList.map((function(e){return e.email}));S.H.sysAdminSetUserQuotaInBatch(t,e).then((function(e){var t=n.state.userList.map((function(t){return e.data.success.forEach((function(e){t.email==e.email&&(t.quota_total=e.quota_total)})),t}));n.setState({userList:t})})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.deleteUserInBatch=function(){var e=n.state.selectedUserList.map((function(e){return e.email}));S.H.sysAdminDeleteUserInBatch(e).then((function(t){if(t.data.success.length){var i=n.state.userList.filter((function(e){return!t.data.success.some((function(t){return t.email==e.email}))}));n.setState({userList:i,hasUserSelected:e.length!=t.data.success.length});var s=t.data.success.length,a=1==s?(0,p.AP)("Successfully deleted 1 user."):(0,p.AP)("Successfully deleted {user_number_placeholder} users.").replace("{user_number_placeholder}",s);k.A.success(a)}t.data.failed.forEach((function(e){var t="".concat(e.email,": ").concat(e.error_msg);k.A.danger(t)}))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.updateUser=function(e,t,i,s){S.H.sysAdminUpdateUser(e,t,i,s).then((function(s){var a=n.state.userList.map((function(n){return n.email==e&&(n[t]=s.data[t]),n}));n.setState({userList:a});var r="is_active"==t&&i?s.data.update_status_tip:(0,p.AP)("Edit succeeded");k.A.success(r)})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.updateAdminRole=function(e,t){S.H.sysAdminUpdateAdminRole(e,t).then((function(t){var i=n.state.userList.map((function(n){return n.email==e&&(n.admin_role=t.data.role),n}));n.setState({userList:i}),k.A.success((0,p.AP)("Edit succeeded"))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.revokeAdmin=function(e,t){S.H.sysAdminUpdateUser(e,"is_staff",!1).then((function(i){var s=n.state.userList.filter((function(t){return t.email!=e}));n.setState({userList:s}),k.A.success((0,p.AP)("Successfully revoked the admin permission of {placeholder}.").replace("{placeholder}",t))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.handleInputChange=function(e){n.setState({query:e.target.value},n.checkSubmitBtnActive)},n.checkSubmitBtnActive=function(){var e=n.state.query;n.setState({isSubmitBtnActive:e.trim()})},n.getPreviousPageList=function(){n.getItems(n.state.pageInfo.current_page-1)},n.getNextPageList=function(){n.getItems(n.state.pageInfo.current_page+1)},n.handleKeyDown=function(e){13===e.keyCode&&(n.state.isSubmitBtnActive&&n.getItems(1))},n.state={query:"",isSubmitBtnActive:!1,loading:!0,errorMsg:"",userList:[],pageInfo:{has_next_page:!1,current_page:1},currentPage:1,perPage:100,hasUserSelected:!1,selectedUserList:[],isAllUsersSelected:!1,isBatchSetQuotaDialogOpen:!1,isBatchDeleteUserDialogOpen:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(document.location).searchParams,n=this.state,i=n.currentPage,s=n.perPage;this.setState({query:t.get("query")||"",currentPage:parseInt(t.get("page")||i),perPage:parseInt(t.get("per_page")||s)},(function(){e.getItems(e.state.currentPage)}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.query,s=t.isSubmitBtnActive,a=this.state,r=a.hasUserSelected,o=a.isBatchDeleteUserDialogOpen,c=a.isBatchSetQuotaDialogOpen;return(0,x.jsxs)(l.Fragment,{children:[r?(0,x.jsx)(_.A,(0,i.default)((0,i.default)({},this.props),{},{children:(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(j.A,{className:"btn btn-secondary operation-item",onClick:this.toggleBatchSetQuotaDialog,children:(0,p.AP)("Set Quota")}),(0,x.jsx)(j.A,{className:"btn btn-secondary operation-item",onClick:this.toggleBatchDeleteUserDialog,children:(0,p.AP)("Delete Users")})]})})):(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)("div",{className:"cur-view-path",children:(0,x.jsx)("h3",{className:"sf-heading",children:(0,p.AP)("Users")})}),(0,x.jsxs)("div",{className:"cur-view-content",children:[(0,x.jsxs)("div",{className:"mt-4 mb-6",children:[(0,x.jsx)("h4",{className:"border-bottom font-weight-normal mb-2 pb-1",children:(0,p.AP)("Search Users")}),(0,x.jsxs)(Oe.A,{tag:"div",children:[(0,x.jsx)(Te.A,{row:!0,children:(0,x.jsx)(yt.A,{sm:5,children:(0,x.jsx)(W.A,{type:"text",name:"query",value:n,placeholder:(0,p.AP)("Search users"),onChange:this.handleInputChange,onKeyDown:this.handleKeyDown})})}),(0,x.jsx)(Te.A,{row:!0,children:(0,x.jsx)(yt.A,{sm:{size:5},children:(0,x.jsx)("button",{className:"btn btn-outline-primary",disabled:!s,onClick:function(){return e.getItems(1)},children:(0,p.AP)("Submit")})})})]})]}),(0,x.jsxs)("div",{className:"mt-4 mb-6",children:[(0,x.jsx)("h4",{className:"border-bottom font-weight-normal mb-2 pb-1",children:(0,p.AP)("Result")}),(0,x.jsx)(lt,{isLDAPImported:!1,isAdmin:!1,isSearchResult:!0,loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.userList,curPerPage:this.state.perPage,updateUser:this.updateUser,deleteUser:this.deleteUser,updateAdminRole:this.updateAdminRole,revokeAdmin:this.revokeAdmin,onUserSelected:this.onUserSelected,isAllUsersSelected:this.isAllUsersSelected,toggleSelectAllUsers:this.toggleSelectAllUsers})]})]})]})}),c&&(0,x.jsx)(we.A,{toggle:this.toggleBatchSetQuotaDialog,updateQuota:this.setUserQuotaInBatch}),o&&(0,x.jsx)(Ye.A,{title:(0,p.AP)("Delete Users"),message:(0,p.AP)("Are you sure you want to delete the selected user(s) ?"),executeOperation:this.deleteUserInBatch,confirmBtnText:(0,p.AP)("Delete"),toggleDialog:this.toggleBatchDeleteUserDialog}),this.state.pageInfo&&(0,x.jsx)(X.A,{gotoPreviousPage:this.getPreviousPageList,gotoNextPage:this.getNextPageList,currentPage:this.state.pageInfo.current_page,hasNextPage:this.state.pageInfo.has_next_page,curPerPage:this.state.perPage,resetPerPage:this.resetPerPage})]})}}])}(l.Component),bt=Pt,jt=n(60096),St=n(3898),kt=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).toggle=function(){n.props.toggle()},n.handleRateLimitChange=function(e){var t=e.target.value;n.setState({rateLimit:t,isSubmitBtnActive:""!=t.trim()})},n.handleKeyDown=function(e){"Enter"==e.key&&(n.handleSubmit(),e.preventDefault())},n.handleSubmit=function(){n.props.updateUploadDownloadRateLimit(n.props.uploadOrDownload,n.state.rateLimit.trim()),n.toggle()},n.state={rateLimit:"",isSubmitBtnActive:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.state,t=e.rateLimit,n=e.isSubmitBtnActive;return(0,x.jsxs)(u.A,{isOpen:!0,toggle:this.toggle,children:[(0,x.jsx)(Ce.A,{toggle:this.toggle,children:"upload"==this.props.uploadOrDownload?(0,p.AP)("Set Upload Rate Limit"):(0,p.AP)("Set Download Rate Limit")}),(0,x.jsx)(Ie.A,{children:(0,x.jsx)(Oe.A,{children:(0,x.jsxs)(Te.A,{children:[(0,x.jsxs)(Ue.A,{children:[(0,x.jsx)(W.A,{type:"text",className:"form-control",value:t,onKeyDown:this.handleKeyDown,onChange:this.handleRateLimitChange}),(0,x.jsx)(St.A,{children:"kB/s"})]}),(0,x.jsxs)("p",{className:"small text-secondary mt-2 mb-2",children:[(0,p.AP)("An integer that is greater than or equal to 0."),(0,x.jsx)("br",{}),(0,p.AP)("Tip: 0 means default limit")]})]})})}),(0,x.jsxs)(Me.A,{children:[(0,x.jsx)(j.A,{color:"secondary",onClick:this.toggle,children:(0,p.AP)("Cancel")}),(0,x.jsx)(j.A,{color:"primary",onClick:this.handleSubmit,disabled:!n,children:(0,p.AP)("Submit")})]})]})}}])}(l.Component),Dt=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleInputChange=function(e){var t=e.target.value;n.setState({value:t})},n.handleKeyDown=function(e){"Enter"==e.key&&(n.handleSubmit(),e.preventDefault())},n.handleSubmit=function(){n.props.updateValue(n.state.value.trim()),n.props.toggleDialog()},n.state={value:n.props.value,isSubmitBtnActive:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.toggleDialog;return(0,x.jsxs)(u.A,{isOpen:!0,toggle:e,children:[(0,x.jsx)(Ce.A,{toggle:e,children:this.props.dialogTitle}),(0,x.jsx)(Ie.A,{children:(0,x.jsx)(Oe.A,{children:(0,x.jsx)(Te.A,{children:(0,x.jsx)(W.A,{type:"text",value:this.state.value,onKeyDown:this.handleKeyDown,onChange:this.handleInputChange})})})}),(0,x.jsxs)(Me.A,{children:[(0,x.jsx)(j.A,{color:"secondary",onClick:e,children:(0,p.AP)("Cancel")}),(0,x.jsx)(j.A,{color:"primary",onClick:this.handleSubmit,children:(0,p.AP)("Submit")})]})]})}}])}(l.Component),_t=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).navItems=[{name:"info",urlPart:"",text:(0,p.AP)("Info")},{name:"owned-repos",urlPart:"owned-libraries",text:(0,p.AP)("Owned Libraries")},{name:"shared-repos",urlPart:"shared-libraries",text:(0,p.AP)("Shared Libraries")},{name:"links",urlPart:"shared-links",text:(0,p.AP)("Shared Links")},{name:"groups",urlPart:"groups",text:(0,p.AP)("Groups")}],n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props,t=e.currentItem,n=e.email,i=e.userName;return(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{className:"cur-view-path",children:(0,x.jsxs)("h3",{className:"sf-heading",children:[(0,x.jsx)(h.N_,{to:"".concat(p.Yc,"sys/users/"),children:(0,p.AP)("Users")})," / ",i]})}),(0,x.jsx)("ul",{className:"nav border-bottom mx-4",children:this.navItems.map((function(e,i){return(0,x.jsx)("li",{className:"nav-item mr-2",children:(0,x.jsx)(h.N_,{to:"".concat(p.Yc,"sys/users/").concat(encodeURIComponent(n),"/").concat(e.urlPart),className:"nav-link ".concat(t==e.name?" active":""),children:e.text})},i)}))})]})}}])}(l.Component),wt=_t,It=window.sysadmin.pageOptions,Nt=It.twoFactorAuthEnabled,Mt=It.availableRoles,Ct=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).toggleSetQuotaDialog=function(){n.setState({isSetQuotaDialogOpen:!n.state.isSetQuotaDialogOpen})},n.toggleSetUserUploadRateLimitDialog=function(){n.setState({isSetUserUploadRateLimitDialogOpen:!n.state.isSetUserUploadRateLimitDialogOpen})},n.toggleSetUserDownloadRateLimitDialog=function(){n.setState({isSetUserDownloadRateLimitDialogOpen:!n.state.isSetUserDownloadRateLimitDialogOpen})},n.updateQuota=function(e){n.props.updateUser("quota_total",e)},n.updateUploadDownloadRateLimit=function(e,t){"upload"==e&&n.props.updateUser("upload_rate_limit",t),"download"==e&&n.props.updateUser("download_rate_limit",t)},n.toggleDialog=function(e,t){n.setState({currentKey:e,dialogTitle:t,isUpdateUserDialogOpen:!n.state.isUpdateUserDialogOpen})},n.toggleSetNameDialog=function(){n.toggleDialog("name",(0,p.AP)("Set Name"))},n.toggleSetUserLoginIDDialog=function(){n.toggleDialog("login_id",(0,p.AP)("Set Login ID"))},n.toggleSetUserContactEmailDialog=function(){n.toggleDialog("contact_email",(0,p.AP)("Set Contact Email"))},n.updateValue=function(e){n.props.updateUser(n.state.currentKey,e)},n.toggleUpdateUserDialog=function(){n.toggleDialog("","")},n.state={currentKey:"",dialogTitle:"",isSetQuotaDialogOpen:!1,isSetUserUploadRateLimitDialogOpen:!1,isSetUserDownloadRateLimitDialogOpen:!1,isUpdateUserDialogOpen:!1,highlight:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg,i=this.state.highlight;if(t)return(0,x.jsx)(D.A,{});if(n)return(0,x.jsx)("p",{className:"error text-center mt-4",children:n});var s=this.props.userInfo,a=this.state,r=a.currentKey,o=a.dialogTitle,l=a.isSetQuotaDialogOpen,c=a.isUpdateUserDialogOpen,d=a.isSetUserUploadRateLimitDialogOpen,u=a.isSetUserDownloadRateLimitDialogOpen;return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("dl",{className:"m-0",children:[(0,x.jsx)("dt",{className:"info-item-heading",children:(0,p.AP)("Avatar")}),(0,x.jsx)("dd",{className:"info-item-content",children:(0,x.jsx)("img",{src:s.avatar_url,alt:s.name,width:"80",className:"rounded"})}),(0,x.jsx)("dt",{className:"info-item-heading",children:(0,p.AP)("Email")}),(0,x.jsx)("dd",{className:"info-item-content",children:s.email}),s.org_name&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("dt",{className:"info-item-heading",children:(0,p.AP)("Organization")}),(0,x.jsx)("dd",{className:"info-item-content",children:s.org_name})]}),(0,x.jsx)("dt",{className:"info-item-heading",children:(0,p.AP)("Name")}),(0,x.jsxs)("dd",{className:"info-item-content",children:[s.name||"--",(0,x.jsx)(jt.A,{onClick:this.toggleSetNameDialog})]}),(0,x.jsx)("dt",{className:"info-item-heading",children:(0,p.AP)("Login ID")}),(0,x.jsxs)("dd",{className:"info-item-content",children:[s.login_id||"--",(0,x.jsx)(jt.A,{onClick:this.toggleSetUserLoginIDDialog})]}),(0,x.jsx)("dt",{className:"info-item-heading",children:(0,p.AP)("Contact Email")}),(0,x.jsxs)("dd",{className:"info-item-content",children:[s.contact_email||"--",(0,x.jsx)(jt.A,{onClick:this.toggleSetUserContactEmailDialog})]}),(0,x.jsx)("dt",{className:"info-item-heading",children:(0,p.AP)("Role")}),(0,x.jsx)("dd",{className:"info-item-content",children:(0,x.jsx)($e.A,{isDropdownToggleShown:i,currentSelectedOption:this.props.currentSelectedRoleOption,options:this.props.roleOptions,selectOption:this.props.updateRole,toggleItemFreezed:this.props.toggleItemFreezed})}),(0,x.jsx)("dt",{className:"info-item-heading",children:(0,p.AP)("Space Used / Quota")}),(0,x.jsxs)("dd",{className:"info-item-content",children:["".concat(f.Aq.bytesToSize(s.quota_usage)," / ").concat(s.quota_total>0?f.Aq.bytesToSize(s.quota_total):"--"),(0,x.jsx)(jt.A,{onClick:this.toggleSetQuotaDialog})]}),p.am&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("dt",{className:"info-item-heading",children:(0,p.AP)("Upload Rate Limit")}),(0,x.jsxs)("dd",{className:"info-item-content",children:[s.upload_rate_limit>0?s.upload_rate_limit+" kB/s":"--",(0,x.jsx)(jt.A,{onClick:this.toggleSetUserUploadRateLimitDialog})]}),(0,x.jsx)("dt",{className:"info-item-heading",children:(0,p.AP)("Download Rate Limit")}),(0,x.jsxs)("dd",{className:"info-item-content",children:[s.download_rate_limit>0?s.download_rate_limit+" kB/s":"--",(0,x.jsx)(jt.A,{onClick:this.toggleSetUserDownloadRateLimitDialog})]})]}),Nt&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("dt",{className:"info-item-heading",children:(0,p.AP)("Two-Factor Authentication")}),(0,x.jsxs)("dd",{className:"info-item-content",children:[s.has_default_device?(0,x.jsxs)(Te.A,{children:[(0,x.jsx)("p",{className:"mb-1",children:(0,p.AP)("Status: enabled")}),(0,x.jsx)(j.A,{onClick:this.props.disable2FA,children:(0,p.AP)("Disable Two-Factor Authentication")})]}):(0,x.jsx)(Te.A,{children:(0,x.jsx)(j.A,{disabled:!0,children:(0,p.AP)("Disable Two-Factor Authentication")})}),(0,x.jsx)(Te.A,{check:!0,children:(0,x.jsxs)(Re.A,{check:!0,children:[(0,x.jsx)(W.A,{type:"checkbox",checked:s.is_force_2fa,onChange:this.props.toggleForce2fa}),(0,x.jsx)("span",{children:(0,p.AP)("Force Two-Factor Authentication")})]})})]})]})]}),l&&(0,x.jsx)(we.A,{updateQuota:this.updateQuota,toggle:this.toggleSetQuotaDialog}),p.am&&d&&(0,x.jsx)(kt,{uploadOrDownload:"upload",updateUploadDownloadRateLimit:this.updateUploadDownloadRateLimit,toggle:this.toggleSetUserUploadRateLimitDialog}),p.am&&u&&(0,x.jsx)(kt,{uploadOrDownload:"download",updateUploadDownloadRateLimit:this.updateUploadDownloadRateLimit,toggle:this.toggleSetUserDownloadRateLimitDialog}),c&&(0,x.jsx)(Dt,{dialogTitle:o,value:s[r],updateValue:this.updateValue,toggleDialog:this.toggleUpdateUserDialog})]})}}])}(l.Component),Lt=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).updateUser=function(e,t){var i=n.state.userInfo.email;S.H.sysAdminUpdateUser(i,e,t).then((function(t){var i=n.state.userInfo;i[e]=t.data[e],n.setState({userInfo:i}),k.A.success((0,p.AP)("Edit succeeded"))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.updateRole=function(e){n.updateUser("role",e.value)},n.disable2FA=function(){var e=n.state.userInfo.email;S.H.sysAdminDeleteTwoFactorAuth(e).then((function(e){var t=n.state.userInfo;t.has_default_device=!1,n.setState({userInfo:t})})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.toggleForce2fa=function(e){var t=n.state.userInfo.email,i=e.target.checked;S.H.sysAdminSetForceTwoFactorAuth(t,i).then((function(e){var t=n.state.userInfo;t.is_force_2fa=i,n.setState({userInfo:t})})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.translateRole=function(e){switch(e){case"default":return(0,p.AP)("Default");case"guest":return(0,p.AP)("Guest");default:return e}},n.state={loading:!0,errorMsg:"",userInfo:{}},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=decodeURIComponent(this.props.email);S.H.sysAdminGetUser(t).then((function(t){e.setState({loading:!1,userInfo:t.data})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e,t=this,n=this.state.userInfo,s=n.role;return this.roleOptions=Mt.map((function(e){return{value:e,text:t.translateRole(e),isSelected:e==s}})),e=this.roleOptions.filter((function(e){return e.isSelected}))[0]||{value:s,text:this.translateRole(s),isSelected:!0},(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(wt,{currentItem:"info",email:this.props.email,userName:n.name}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsx)(Ct,{loading:this.state.loading,errorMsg:this.state.errorMsg,userInfo:this.state.userInfo,roleOptions:this.roleOptions,currentSelectedRoleOption:e,updateRole:this.updateRole,updateUser:this.updateUser,disable2FA:this.disable2FA,toggleForce2fa:this.toggleForce2fa})})]})})]})}}])}(l.Component),Ot=n(40898),Tt=window.sysadmin.pageOptions.enableSysAdminViewRepo;M().extend(ge());var Rt=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.state={isItemFreezed:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,i=t.errorMsg,s=t.items;if(n)return(0,x.jsx)(D.A,{});if(i)return(0,x.jsx)("p",{className:"error text-center mt-4",children:i});var a=(0,x.jsx)(me.A,{text:(0,p.AP)("No libraries")}),r=(0,x.jsx)(l.Fragment,{children:(0,x.jsxs)("table",{children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"5%"}),(0,x.jsx)("th",{width:"35%",children:(0,p.AP)("Name")}),(0,x.jsx)("th",{width:"30%",children:(0,p.AP)("Size")}),(0,x.jsx)("th",{width:"25%",children:(0,p.AP)("Last Update")}),(0,x.jsx)("th",{width:"5%"})]})}),(0,x.jsx)("tbody",{children:s.map((function(t,n){return(0,x.jsx)(Ut,{item:t,isItemFreezed:e.state.isItemFreezed,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem,deleteRepo:e.props.deleteRepo,transferRepo:e.props.transferRepo},n)}))})]})});return s.length?r:a}}])}(l.Component),Ut=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleMouseEnter=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!0,highlight:!0})},n.handleMouseLeave=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!1,highlight:!1})},n.onUnfreezedItem=function(){n.setState({highlight:!1,isOpIconShow:!1}),n.props.onUnfreezedItem()},n.toggleDeleteDialog=function(){n.setState({isDeleteDialogOpen:!n.state.isDeleteDialogOpen})},n.deleteRepo=function(){n.props.deleteRepo(n.props.item.id)},n.toggleTransferDialog=function(){n.setState({isTransferDialogOpen:!n.state.isTransferDialogOpen})},n.transferRepo=function(e,t){n.props.transferRepo(n.props.item.id,e,t)},n.renderRepoName=function(){var e=n.props.item;return e.name?p.am&&Tt&&!e.encrypted?(0,x.jsx)(h.N_,{to:"".concat(p.Yc,"sys/libraries/").concat(e.id,"/"),children:e.name}):e.name:(0,p.AP)("Broken ({repo_id_placeholder})").replace("{repo_id_placeholder}",e.id)},n.translateOperations=function(e){var t="";switch(e){case"Delete":t=(0,p.AP)("Delete");break;case"Transfer":t=(0,p.AP)("Transfer")}return t},n.onMenuItemClick=function(e){switch(e){case"Delete":n.toggleDeleteDialog();break;case"Transfer":n.toggleTransferDialog()}},n.state={isOpIconShown:!1,highlight:!1,isDeleteDialogOpen:!1,isTransferDialogOpen:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.item,t=this.state,n=t.isOpIconShown,i=t.isDeleteDialogOpen,s=t.isTransferDialogOpen,a=f.Aq.getLibIconUrl(e),r=f.Aq.getLibIconTitle(e),o='<span class="op-target">'+f.Aq.HTMLescape(e.name)+"</span>",c=(0,p.AP)("Are you sure you want to delete {placeholder} ?").replace("{placeholder}",o);return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,x.jsx)("td",{children:(0,x.jsx)("img",{src:a,title:r,alt:r,width:"24"})}),(0,x.jsx)("td",{children:this.renderRepoName()}),(0,x.jsx)("td",{children:f.Aq.bytesToSize(e.size)}),(0,x.jsx)("td",{children:M()(e.last_modified).fromNow()}),(0,x.jsx)("td",{children:n&&(0,x.jsx)(et.A,{operations:["Delete","Transfer"],translateOperations:this.translateOperations,onMenuItemClick:this.onMenuItemClick,onFreezedItem:this.props.onFreezedItem,onUnfreezedItem:this.onUnfreezedItem})})]}),i&&(0,x.jsx)(Ye.A,{title:(0,p.AP)("Delete Library"),message:c,executeOperation:this.deleteRepo,confirmBtnText:(0,p.AP)("Delete"),toggleDialog:this.toggleDeleteDialog}),s&&(0,x.jsx)(Ot.A,{itemName:e.name,onTransferRepo:this.transferRepo,canTransferToDept:!1,toggleDialog:this.toggleTransferDialog})]})}}])}(l.Component),Ft=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).deleteRepo=function(e){S.H.sysAdminDeleteRepo(e).then((function(t){var i=n.state.repoList.filter((function(t){return t.id!=e}));n.setState({repoList:i}),k.A.success((0,p.AP)("Successfully deleted 1 item."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.transferRepo=function(e,t,i){S.H.sysAdminTransferRepo(e,t,i).then((function(t){var i=n.state.repoList.filter((function(t){return t.id!=e}));n.setState({repoList:i});var s=(0,p.AP)("Successfully transferred the library.");k.A.success(s)})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.state={loading:!0,errorMsg:"",userInfo:{},repoList:[]},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=decodeURIComponent(this.props.email);S.H.sysAdminGetUser(t).then((function(t){e.setState({userInfo:t.data})})),S.H.sysAdminListReposByOwner(t).then((function(t){e.setState({loading:!1,repoList:t.data.repos})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(wt,{currentItem:"owned-repos",email:this.props.email,userName:this.state.userInfo.name}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsx)(Rt,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.repoList,deleteRepo:this.deleteRepo,transferRepo:this.transferRepo})})]})})]})}}])}(l.Component),Et=window.sysadmin.pageOptions.enableSysAdminViewRepo;M().extend(ge());var zt=function(e){function t(){return(0,s.default)(this,t),(0,r.default)(this,t,arguments)}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg,i=e.items;if(t)return(0,x.jsx)(D.A,{});if(n)return(0,x.jsx)("p",{className:"error text-center mt-4",children:n});var s=(0,x.jsxs)("table",{children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"5%"}),(0,x.jsx)("th",{width:"35%",children:(0,p.AP)("Name")}),(0,x.jsx)("th",{width:"20%",children:(0,p.AP)("Share From")}),(0,x.jsx)("th",{width:"20%",children:(0,p.AP)("Size")}),(0,x.jsx)("th",{width:"20%",children:(0,p.AP)("Last Update")})]})}),(0,x.jsx)("tbody",{children:i.map((function(e,t){return(0,x.jsx)(Bt,{item:e},t)}))})]});return i.length?s:(0,x.jsx)(me.A,{text:(0,p.AP)("No libraries")})}}])}(l.Component),Bt=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleMouseOver=function(){n.setState({isHighlighted:!0})},n.handleMouseOut=function(){n.setState({isHighlighted:!1})},n.renderRepoName=function(){var e=n.props.item;return e.name?p.am&&Et&&!e.encrypted?(0,x.jsx)(h.N_,{to:"".concat(p.Yc,"sys/libraries/").concat(e.id,"/"),children:e.name}):e.name:(0,p.AP)("Broken ({repo_id_placeholder})").replace("{repo_id_placeholder}",e.id)},n.getOwnerLink=function(){var e,t=n.props.item,i=t.owner_email.indexOf("@seafile_group");if(-1==i)e=(0,x.jsx)(Se,{email:t.owner_email,name:t.owner_name});else{var s=t.owner_email.substring(0,i);e=(0,x.jsx)(h.N_,{to:"".concat(p.Yc,"sys/groups/").concat(s,"/libraries/"),children:t.owner_name})}return e},n.state={isHighlighted:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.item,t=f.Aq.getLibIconUrl(e),n=f.Aq.getLibIconTitle(e),i=this.state.isHighlighted;return(0,x.jsxs)("tr",{className:fe()({"tr-highlight":i}),onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,children:[(0,x.jsx)("td",{children:(0,x.jsx)("img",{src:t,title:n,alt:n,width:"24"})}),(0,x.jsx)("td",{children:this.renderRepoName()}),(0,x.jsx)("td",{children:this.getOwnerLink()}),(0,x.jsx)("td",{children:f.Aq.bytesToSize(e.size)}),(0,x.jsx)("td",{children:M()(e.last_modify).fromNow()})]})}}])}(l.Component),Ht=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).state={loading:!0,errorMsg:"",userInfo:{},repoList:[]},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=decodeURIComponent(this.props.email);S.H.sysAdminGetUser(t).then((function(t){e.setState({userInfo:t.data})})),S.H.sysAdminListShareInRepos(t).then((function(t){e.setState({loading:!1,repoList:t.data.repo_list})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(wt,{currentItem:"shared-repos",email:this.props.email,userName:this.state.userInfo.name}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsx)(zt,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.repoList})})]})})]})}}])}(l.Component),qt=Ht,Yt=n(91611),Vt=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.state={isItemFreezed:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,i=t.errorMsg,s=t.items;if(n)return(0,x.jsx)(D.A,{});if(i)return(0,x.jsx)("p",{className:"error text-center mt-4",children:i});var a=(0,x.jsx)(me.A,{text:(0,p.AP)("No shared links")}),r=(0,x.jsx)(l.Fragment,{children:(0,x.jsxs)("table",{children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"5%"}),(0,x.jsx)("th",{width:"30%",children:(0,p.AP)("Name")}),(0,x.jsx)("th",{width:"20%",children:(0,p.AP)("Size")}),(0,x.jsx)("th",{width:"20%",children:(0,p.AP)("Type")}),(0,x.jsx)("th",{width:"20%",children:(0,p.AP)("Visits")}),(0,x.jsx)("th",{width:"5%"})]})}),(0,x.jsx)("tbody",{children:s.map((function(t,n){return(0,x.jsx)(Gt,{item:t,isItemFreezed:e.state.isItemFreezed,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem,deleteItem:e.props.deleteItem},n)}))})]})});return s.length?r:a}}])}(l.Component),Gt=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleMouseEnter=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!0,highlight:!0})},n.handleMouseLeave=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!1,highlight:!1})},n.onUnfreezedItem=function(){n.setState({highlight:!1,isOpIconShow:!1}),n.props.onUnfreezedItem()},n.toggleLinkDialog=function(){n.setState({isLinkDialogOpen:!n.state.isLinkDialogOpen})},n.deleteItem=function(){n.props.deleteItem(n.props.item)},n.translateOperations=function(e){var t="";switch(e){case"View":t=(0,p.AP)("View");break;case"Delete":t=(0,p.AP)("Delete")}return t},n.onMenuItemClick=function(e){switch(e){case"View":n.toggleLinkDialog();break;case"Delete":n.deleteItem()}},n.getRoleText=function(){var e;switch(n.props.item.role){case"Owner":e=(0,p.AP)("Owner");break;case"Admin":e=(0,p.AP)("Admin");break;case"Member":e=(0,p.AP)("Member")}return e},n.getIconUrl=function(){var e=n.props.item;return"upload"==e.type||e.is_dir?f.Aq.getFolderIconUrl():f.Aq.getFileIconUrl(e.obj_name)},n.state={isOpIconShown:!1,highlight:!1,isLinkDialogOpen:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.item,t=this.state,n=t.isOpIconShown,i=t.isLinkDialogOpen;return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,x.jsx)("td",{children:(0,x.jsx)("img",{src:this.getIconUrl(),alt:"",width:"24"})}),(0,x.jsx)("td",{children:"/"==e.obj_name?e.repo_name:e.obj_name}),"upload"==e.type?(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)("td",{}),(0,x.jsx)("td",{children:(0,p.AP)("Upload")})]}):(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)("td",{children:e.is_dir?null:f.Aq.bytesToSize(e.size)}),(0,x.jsx)("td",{children:(0,p.AP)("Download")})]}),(0,x.jsx)("td",{children:e.view_cnt}),(0,x.jsx)("td",{children:n&&(0,x.jsx)(et.A,{operations:["View","Delete"],translateOperations:this.translateOperations,onMenuItemClick:this.onMenuItemClick,onFreezedItem:this.props.onFreezedItem,onUnfreezedItem:this.onUnfreezedItem})})]}),i&&(0,x.jsx)(Yt.A,{link:e.link,toggleDialog:this.toggleLinkDialog})]})}}])}(l.Component),Wt=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).deleteItem=function(e){var t=e.type,i=e.token;"download"==t?S.H.sysAdminDeleteShareLink(i).then((function(e){var t=n.state.shareLinkItems.filter((function(e){return e.token!=i}));n.setState({shareLinkItems:t}),k.A.success((0,p.AP)("Successfully deleted 1 item."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)})):S.H.sysAdminDeleteUploadLink(i).then((function(e){var t=n.state.uploadLinkItems.filter((function(e){return e.token!=i}));n.setState({uploadLinkItems:t}),k.A.success((0,p.AP)("Successfully deleted 1 item."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.state={loading:!0,errorMsg:"",userInfo:{},uploadLinkItems:[],shareLinkItems:[]},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=decodeURIComponent(this.props.email);S.H.sysAdminGetUser(t).then((function(t){e.setState({userInfo:t.data})})),S.H.sysAdminListShareLinksByUser(t).then((function(t){var n=t.data.share_link_list.map((function(e){return e.type="download",e}));n.sort((function(e,t){return e.is_dir?-1:1})),e.setState({loading:!1,shareLinkItems:n})})),S.H.sysAdminListUploadLinksByUser(t).then((function(t){var n=t.data.upload_link_list.map((function(e){return e.type="upload",e}));e.setState({loading:!1,uploadLinkItems:n})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this.state,t=e.shareLinkItems,n=e.uploadLinkItems;return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(wt,{currentItem:"links",email:this.props.email,userName:this.state.userInfo.name}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsx)(Vt,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:[].concat(n,t),deleteItem:this.deleteItem})})]})})]})}}])}(l.Component),Qt=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.state={isItemFreezed:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,i=t.errorMsg,s=t.items;if(n)return(0,x.jsx)(D.A,{});if(i)return(0,x.jsx)("p",{className:"error text-center mt-4",children:i});var a=(0,x.jsx)(me.A,{text:(0,p.AP)("No groups")}),r=(0,x.jsx)(l.Fragment,{children:(0,x.jsxs)("table",{children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"35%",children:(0,p.AP)("Name")}),(0,x.jsx)("th",{width:"30%",children:(0,p.AP)("Role")}),(0,x.jsx)("th",{width:"35%",children:(0,p.AP)("Created At")})]})}),(0,x.jsx)("tbody",{children:s.map((function(t,n){return(0,x.jsx)(Kt,{item:t,isItemFreezed:e.state.isItemFreezed,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem},n)}))})]})});return s.length?r:a}}])}(l.Component),Kt=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleMouseEnter=function(){n.props.isItemFreezed||n.setState({highlight:!0})},n.handleMouseLeave=function(){n.props.isItemFreezed||n.setState({highlight:!1})},n.onUnfreezedItem=function(){n.setState({highlight:!1,isOpIconShow:!1}),n.props.onUnfreezedItem()},n.getRoleText=function(){var e;switch(n.props.item.role){case"Owner":e=(0,p.AP)("Owner");break;case"Admin":e=(0,p.AP)("Admin");break;case"Member":e=(0,p.AP)("Member")}return e},n.state={highlight:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.item,t="".concat(p.Yc,"sys/groups/").concat(e.id,"/libraries/");return(0,x.jsx)(l.Fragment,{children:(0,x.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,x.jsx)("td",{children:(0,x.jsx)(h.N_,{to:t,children:e.name})}),(0,x.jsx)("td",{children:this.getRoleText()}),(0,x.jsx)("td",{children:M()(e.created_at).format("YYYY-MM-DD HH:mm")})]})})}}])}(l.Component),$t=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).state={loading:!0,errorMsg:"",userInfo:{},items:[]},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=decodeURIComponent(this.props.email);S.H.sysAdminGetUser(t).then((function(t){e.setState({userInfo:t.data})})),S.H.sysAdminListGroupsJoinedByUser(t).then((function(t){e.setState({loading:!1,items:t.data.group_list})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(wt,{currentItem:"groups",email:this.props.email,userName:this.state.userInfo.name}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsx)(Qt,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.items})})]})})]})}}])}(l.Component),Xt=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleRepoNameChange=function(e){var t=e.target.value;n.setState({repoName:t,isSubmitBtnActive:t.trim()})},n.handleSubmit=function(){var e=n.state,t=e.repoName,i=e.selectedUsers;n.props.createRepo(t.trim(),i[0].email),n.toggle()},n.handleSelectChange=function(e){n.setState({selectedUsers:e})},n.handleKeyDown=function(e){"Enter"===e.key&&(n.handleSubmit(),e.preventDefault())},n.toggle=function(){n.props.toggleDialog()},n.state={repoName:"",selectedUsers:[],errMessage:"",isSubmitBtnActive:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){return(0,x.jsxs)(u.A,{isOpen:!0,toggle:this.toggle,autoFocus:!1,children:[(0,x.jsx)(Ce.A,{toggle:this.toggle,children:(0,p.AP)("New Library")}),(0,x.jsxs)(Ie.A,{children:[(0,x.jsxs)(Oe.A,{children:[(0,x.jsxs)(Te.A,{children:[(0,x.jsx)(Re.A,{for:"repoName",children:(0,p.AP)("Name")}),(0,x.jsx)(W.A,{id:"repoName",onKeyDown:this.handleKeyDown,value:this.state.repoName,onChange:this.handleRepoNameChange,autoFocus:!0})]}),(0,x.jsxs)(Te.A,{children:[(0,x.jsxs)(Re.A,{for:"userSelect",children:[(0,p.AP)("Owner"),(0,x.jsx)("span",{className:"small text-secondary ml-1",children:(0,p.AP)("(If left blank, owner will be admin)")})]}),(0,x.jsx)(He.A,{id:"userSelect",isMulti:!1,placeholder:(0,p.AP)("Select a user"),onSelectChange:this.handleSelectChange,selectedUsers:this.state.selectedUsers})]})]}),this.state.errMessage&&(0,x.jsx)(Ne.A,{color:"danger",children:this.state.errMessage})]}),(0,x.jsxs)(Me.A,{children:[(0,x.jsx)(j.A,{color:"secondary",onClick:this.toggle,children:(0,p.AP)("Cancel")}),(0,x.jsx)(j.A,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive,children:(0,p.AP)("Submit")})]})]})}}])}(l.Component),Zt=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).navItems=[{name:"all",urlPart:"all-libraries",text:(0,p.AP)("All")},{name:"wikis",urlPart:"all-wikis",text:(0,p.AP)("Wikis")},{name:"system",urlPart:"system-library",text:(0,p.AP)("System")},{name:"trash",urlPart:"trash-libraries",text:(0,p.AP)("Trash")}],n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.currentItem;return(0,x.jsx)("div",{className:"cur-view-path tab-nav-container",children:(0,x.jsx)("ul",{className:"nav",children:this.navItems.map((function(t,n){return(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(h.N_,{to:"".concat(p.Yc,"sys/").concat(t.urlPart,"/"),className:"nav-link".concat(e==t.name?" active":""),children:t.text})},n)}))})})}}])}(l.Component),Jt=Zt,en=n(40866),tn=n(73606),nn=n(78125),sn=n(35746),an=n(55909),rn=n(38906),on=n(10322),ln=n(89470),cn=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).onMouseEnter=function(){n.setState({isOperationShow:!0})},n.onMouseLeave=function(){n.setState({isOperationShow:!1})},n.deleteShareItem=function(){var e=n.props.item;n.props.deleteShareItem(e.user_email)},n.onChangeUserPermission=function(e){var t=n.props.item;n.props.onChangeUserPermission(t,e)},n.state={isOperationShow:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.item,t=f.Aq.getSharedPermission(e);return(0,x.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[(0,x.jsx)("td",{className:"name",children:e.user_name}),(0,x.jsx)("td",{children:(0,x.jsx)(ln.A,{repoID:e.repo_id,isTextMode:!0,autoFocus:!0,isEditIconShow:this.state.isOperationShow,currentPermission:t,permissions:this.props.permissions,onPermissionChanged:this.onChangeUserPermission,isSysAdmin:!0})}),(0,x.jsx)("td",{children:(0,x.jsx)("span",{className:"sf2-icon-x3 action-icon ".concat(this.state.isOperationShow?"":"hide"),onClick:this.deleteShareItem,title:(0,p.AP)("Delete")})})]})}}])}(l.Component),dn=function(e){function t(){return(0,s.default)(this,t),(0,r.default)(this,t,arguments)}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this,t=this.props.items;return(0,x.jsx)("tbody",{children:t.map((function(t,n){return(0,x.jsx)(cn,{item:t,permissions:e.props.permissions,deleteShareItem:e.props.deleteShareItem,onChangeUserPermission:e.props.onChangeUserPermission},n)}))})}}])}(l.Component),un=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleSelectChange=function(e){n.setState({selectedUsers:e}),n.options=[]},n.setPermission=function(e){n.setState({permission:e})},n.shareToUser=function(){var e=[],t=n.props.repoID;if(n.state.selectedUsers&&n.state.selectedUsers.length>0)for(var i=0;i<n.state.selectedUsers.length;i++)e[i]=n.state.selectedUsers[i].email;S.H.sysAdminAddRepoSharedItem(t,"user",e,n.state.permission).then((function(e){var t=[];if(e.data.failed.length>0)for(var i=0;i<e.data.failed.length;i++)t[i]=e.data.failed[i];var s=e.data.success;n.setState({errorMsg:t,sharedItems:n.state.sharedItems.concat(s),selectedUsers:[],permission:"rw"})})).catch((function(e){if(e.response){var t=(0,p.AP)("Library can not be shared to owner."),i=[];i.push(t),n.setState({errorMsg:i,selectedUsers:[]})}}))},n.deleteShareItem=function(e){var t=n.props.repoID;S.H.sysAdminDeleteRepoSharedItem(t,"user",e).then((function(t){n.setState({sharedItems:n.state.sharedItems.filter((function(t){return t.user_email!==e}))})})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.onChangeUserPermission=function(e,t){var i=n.props.repoID,s=e.user_email;S.H.sysAdminUpdateRepoSharedItemPermission(i,"user",s,t).then((function(){n.updateSharedItems(e,t)})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.updateSharedItems=function(e,t){var i=e.user_name,s=n.state.sharedItems.map((function(e){var n=e.user_name;return i===n&&(e.permission=t,e.is_admin="admin"===t),e}));n.setState({sharedItems:s})},n.state={selectedUsers:[],errorMsg:[],permission:"rw",sharedItems:[],isLoading:!0},n.options=[],n.permissions=["rw","r"],p.am&&n.permissions.push("admin","cloud-edit","preview"),n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.repoID;S.H.sysAdminListRepoSharedItems(t,"user").then((function(t){0!==t.data.length?e.setState({sharedItems:t.data,isLoading:!1}):e.setState({isLoading:!1})})).catch((function(t){e.setState({isLoading:!1});var n=f.Aq.getErrorMsg(t);k.A.danger(n)}))}},{key:"render",value:function(){var e=this.state.sharedItems;return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("table",{children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"50%",children:(0,p.AP)("User")}),(0,x.jsx)("th",{width:"35%",children:(0,p.AP)("Permission")}),(0,x.jsx)("th",{width:"15%"})]})}),(0,x.jsxs)("tbody",{children:[(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:(0,x.jsx)(He.A,{isMulti:!0,placeholder:(0,p.AP)("Search users"),onSelectChange:this.handleSelectChange,selectedUsers:this.state.selectedUsers})}),(0,x.jsx)("td",{children:(0,x.jsx)(ln.A,{repoID:this.props.repoID,isTextMode:!1,isEditIconShow:!1,currentPermission:this.state.permission,permissions:this.permissions,onPermissionChanged:this.setPermission,isSysAdmin:!0})}),(0,x.jsx)("td",{children:(0,x.jsx)(j.A,{color:"primary",onClick:this.shareToUser,children:(0,p.AP)("Submit")})})]}),this.state.errorMsg.length>0&&this.state.errorMsg.map((function(e,t){var n="";return n=e.email?e.email+": "+e.error_msg:e,(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:3,children:(0,x.jsx)("p",{className:"error",children:n})})},t)}))]})]}),(0,x.jsx)("div",{className:"share-list-container",children:this.state.isLoading?(0,x.jsx)(D.A,{}):(0,x.jsx)(x.Fragment,{children:0===this.state.sharedItems.length?(0,x.jsx)(me.A,{text:(0,p.AP)("No share link"),className:"mt-8 mb-8"}):(0,x.jsxs)("table",{className:"table-thead-hidden",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"50%",children:(0,p.AP)("User")}),(0,x.jsx)("th",{width:"35%",children:(0,p.AP)("Permission")}),(0,x.jsx)("th",{width:"15%"})]})}),(0,x.jsx)(dn,{items:e,permissions:this.permissions,deleteShareItem:this.deleteShareItem,onChangeUserPermission:this.onChangeUserPermission})]})})})]})}}])}(l.Component),hn=un,gn=n(97011),pn=n(78405),fn=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).onMouseEnter=function(){n.setState({isOperationShow:!0})},n.onMouseLeave=function(){n.setState({isOperationShow:!1})},n.deleteShareItem=function(){var e=n.props.item;n.props.deleteShareItem(e.group_id)},n.onChangeUserPermission=function(e){var t=n.props.item;n.props.onChangeUserPermission(t,e)},n.state={isOperationShow:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.item,t=f.Aq.getSharedPermission(e);return(0,x.jsxs)("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[(0,x.jsx)("td",{className:"name",children:e.group_name}),(0,x.jsx)("td",{children:(0,x.jsx)(ln.A,{repoID:e.repo_id,isTextMode:!0,autoFocus:!0,isEditIconShow:this.state.isOperationShow,currentPermission:t,permissions:this.props.permissions,onPermissionChanged:this.onChangeUserPermission,isSysAdmin:!0})}),(0,x.jsx)("td",{children:(0,x.jsx)("span",{className:"sf2-icon-x3 action-icon ".concat(this.state.isOperationShow?"":"hide"),onClick:this.deleteShareItem,title:(0,p.AP)("Delete")})})]})}}])}(l.Component),mn=function(e){function t(){return(0,s.default)(this,t),(0,r.default)(this,t,arguments)}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this,t=this.props.items;return(0,x.jsx)("tbody",{children:t.map((function(t,n){return(0,x.jsx)(fn,{item:t,permissions:e.props.permissions,deleteShareItem:e.props.deleteShareItem,onChangeUserPermission:e.props.onChangeUserPermission},n)}))})}}])}(l.Component),vn=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).loadOptions=function(){gn.e.shareableGroups().then((function(e){n.options=[];for(var t=0;t<e.data.length;t++){var i={};i.name=e.data[t].name,i.value=e.data[t].name,i.id=e.data[t].id,i.label=e.data[t].name,n.options.push(i)}})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.onSelectOption=function(e){var t=n.state.selectedOptions.slice(0),i=t.findIndex((function(t){return t.id===e.id}));i>-1?t.splice(i,1):t.push(e),n.setState({selectedOptions:t})},n.onDeleteOption=function(e){var t=n.state.selectedOptions.slice(0),i=t.findIndex((function(t){return t.id===e.id}));i>-1&&t.splice(i,1),n.setState({selectedOptions:t})},n.listSharedGroups=function(){var e=n.props.repoID;S.H.sysAdminListRepoSharedItems(e,"group").then((function(e){0!==e.data.length?n.setState({sharedItems:e.data,isLoading:!1}):n.setState({isLoading:!1})})).catch((function(e){n.setState({isLoading:!1});var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.setPermission=function(e){n.setState({permission:e})},n.shareToGroup=function(){var e=n.props.repoID,t=n.state.selectedOptions;if(0!==t.length){var i=t.map((function(e){return e.id}));S.H.sysAdminAddRepoSharedItem(e,"group",i,n.state.permission).then((function(e){var t=[];if(e.data.failed.length>0)for(var i=0;i<e.data.failed.length;i++)t[i]=e.data.failed[i];var s=e.data.success;n.setState({errorMsg:t,sharedItems:n.state.sharedItems.concat(s),selectedOptions:[],permission:"rw"})})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))}},n.deleteShareItem=function(e){var t=n.props.repoID;S.H.sysAdminDeleteRepoSharedItem(t,"group",e).then((function(){n.setState({sharedItems:n.state.sharedItems.filter((function(t){return t.group_id!==e}))})})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.onChangeUserPermission=function(e,t){var i=n.props.repoID,s=e.group_id;S.H.sysAdminUpdateRepoSharedItemPermission(i,"group",s,t).then((function(){n.updateSharedItems(e,t)})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.updateSharedItems=function(e,t){var i=e.group_id,s=n.state.sharedItems.map((function(e){var n=e.group_id;return i===n&&(e.permission=t,e.is_admin="admin"===t),e}));n.setState({sharedItems:s})},n.state={selectedOptions:[],errorMsg:[],permission:"rw",sharedItems:[],isLoading:!0},n.options=[],n.permissions=["rw","r"],p.am&&n.permissions.push("admin","cloud-edit","preview"),n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){this.loadOptions(),this.listSharedGroups()}},{key:"render",value:function(){return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("table",{children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"50%",children:(0,p.AP)("Group")}),(0,x.jsx)("th",{width:"35%",children:(0,p.AP)("Permission")}),(0,x.jsx)("th",{width:"15%"})]})}),(0,x.jsxs)("tbody",{children:[(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:(0,x.jsx)(pn.A,{selectedOptions:this.state.selectedOptions,options:this.options,onSelectOption:this.onSelectOption,onDeleteOption:this.onDeleteOption,searchPlaceholder:(0,p.AP)("Search groups"),noOptionsPlaceholder:(0,p.AP)("No results"),isInModal:!0})}),(0,x.jsx)("td",{children:(0,x.jsx)(ln.A,{repoID:this.props.repoID,isTextMode:!1,isEditIconShow:!1,currentPermission:this.state.permission,permissions:this.permissions,onPermissionChanged:this.setPermission,isSysAdmin:!0})}),(0,x.jsx)("td",{children:(0,x.jsx)(j.A,{color:"primary",onClick:this.shareToGroup,children:(0,p.AP)("Submit")})})]}),this.state.errorMsg.length>0&&this.state.errorMsg.map((function(e,t){var n=e.group_name+": "+e.error_msg;return(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:3,children:(0,x.jsx)("p",{className:"error",children:n})})},t)}))]})]}),(0,x.jsx)("div",{className:"share-list-container",children:this.state.isLoading?(0,x.jsx)(D.A,{}):(0,x.jsx)(x.Fragment,{children:0===this.state.sharedItems.length?(0,x.jsx)(me.A,{text:(0,p.AP)("No share link"),className:"mt-8 mb-8"}):(0,x.jsxs)("table",{className:"table-thead-hidden",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"50%",children:(0,p.AP)("Group")}),(0,x.jsx)("th",{width:"35%",children:(0,p.AP)("Permission")}),(0,x.jsx)("th",{width:"15%"})]})}),(0,x.jsx)(mn,{items:this.state.sharedItems,permissions:this.permissions,deleteShareItem:this.deleteShareItem,onChangeUserPermission:this.onChangeUserPermission})]})})})]})}}])}(l.Component),xn=(n(59625),function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).getInitialActiveTab=function(){return"shareToUser"},n.toggle=function(e){n.state.activeTab!==e&&n.setState({activeTab:e})},n.renderDirContent=function(){var e=n.state.activeTab,t=n.props,i=t.enableDirPrivateShare,s=t.isGroupOwnedRepo;return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)("div",{className:"share-dialog-side",children:(0,x.jsx)(nn.A,{pills:!0,children:i&&(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(sn.A,{children:(0,x.jsx)(an.A,{className:"shareToUser"===e?"active":"",onClick:n.toggle.bind(n,"shareToUser"),children:(0,p.AP)("Share to user")})}),(0,x.jsx)(sn.A,{children:(0,x.jsx)(an.A,{className:"shareToGroup"===e?"active":"",onClick:n.toggle.bind(n,"shareToGroup"),children:(0,p.AP)("Share to group")})})]})})}),(0,x.jsx)("div",{className:"share-dialog-main",children:(0,x.jsx)(rn.A,{activeTab:n.state.activeTab,children:i&&(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(on.A,{tabId:"shareToUser",children:(0,x.jsx)(hn,{itemType:"library",isGroupOwnedRepo:s,itemPath:n.props.itemPath,repoID:n.props.repoID,isRepoOwner:n.state.isRepoOwner})}),(0,x.jsx)(on.A,{tabId:"shareToGroup",children:(0,x.jsx)(vn,{itemType:"library",isGroupOwnedRepo:s,itemPath:n.props.itemPath,repoID:n.props.repoID,isRepoOwner:n.state.isRepoOwner})})]})})})]})},n.state={activeTab:n.getInitialActiveTab(),isRepoOwner:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){return(0,x.jsx)("div",{children:(0,x.jsxs)(u.A,{isOpen:!0,style:p.zG,className:"share-dialog",toggle:this.props.toggleDialog,children:[(0,x.jsxs)(Ce.A,{toggle:this.props.toggleDialog,children:[(0,p.AP)("Share")," ",(0,x.jsx)("span",{className:"op-target",title:this.props.itemName,children:this.props.itemName})]}),(0,x.jsx)(Ie.A,{className:"share-dialog-content",children:this.renderDirContent()})]})})}}])}(l.Component)),An=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).submit=function(){var e=n.state.keepDays;n.state.autoHistory&&(e=n.state.expireDays);var t=n.props.repoID;if(n.state.autoHistory&&Number(e)<=0)n.setState({errorInfo:(0,p.AP)("Please enter a non-negative integer")});else{var i=(0,p.AP)("Successfully set library history.");S.H.sysAdminUpdateRepoHistorySetting(t,parseInt(e)).then((function(e){k.A.success(i),n.setState({keepDays:e.data.keep_days}),n.props.toggleDialog()})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))}},n.handleKeyDown=function(e){"Enter"===e.key&&(n.submit(),e.preventDefault())},n.onChange=function(e){var t=e.target.value;n.setState({keepDays:t,expireDays:t})},n.setLimitDays=function(e){"allHistory"===e?n.setState({keepDays:-1}):"noHistory"===e?n.setState({keepDays:0}):n.setState({disabled:!1}),n.setState({allHistory:"allHistory"===e,noHistory:"noHistory"===e,autoHistory:"autoHistory"===e})},n.state={keepDays:-1,expireDays:30,disabled:!0,allHistory:!0,noHistory:!1,autoHistory:!1,errorInfo:""},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this;S.H.sysAdminGetRepoHistorySetting(this.props.repoID).then((function(t){e.setState({keepDays:t.data.keep_days,allHistory:t.data.keep_days<0,noHistory:0===t.data.keep_days,autoHistory:t.data.keep_days>0,disabled:!(t.data.keep_days>0),expireDays:t.data.keep_days>0?t.data.keep_days:30})})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))}},{key:"render",value:function(){var e=this,t=this.props.itemName,n=(0,p.AP)("{placeholder} History Setting");return n=n.replace("{placeholder}",'<span class="op-target text-truncate mx-1">'+f.Aq.HTMLescape(t)+"</span>"),(0,x.jsxs)(u.A,{isOpen:!0,toggle:this.props.toggleDialog,children:[(0,x.jsx)(Ce.A,{toggle:this.props.toggleDialog,children:(0,x.jsx)("span",{dangerouslySetInnerHTML:{__html:n},className:"d-flex mw-100"})}),(0,x.jsx)(Ie.A,{children:(0,x.jsxs)(Oe.A,{children:[(0,x.jsxs)(Te.A,{check:!0,children:[(0,x.jsx)(W.A,{type:"radio",name:"radio1",checked:this.state.allHistory,onChange:function(){e.setLimitDays("allHistory")}})," ",(0,x.jsx)(Re.A,{children:(0,p.AP)("Keep full history")})]}),(0,x.jsxs)(Te.A,{check:!0,children:[(0,x.jsx)(W.A,{type:"radio",name:"radio1",checked:this.state.noHistory,onChange:function(){e.setLimitDays("noHistory")}})," ",(0,x.jsx)(Re.A,{children:(0,p.AP)("Don't keep history")})]}),(0,x.jsxs)(Te.A,{check:!0,children:[(0,x.jsx)(W.A,{type:"radio",name:"radio1",checked:this.state.autoHistory,onChange:function(){e.setLimitDays("autoHistory")}})," ",(0,x.jsx)(Re.A,{children:(0,p.AP)("Only keep a period of history:")}),(0,x.jsx)(W.A,{type:"text",className:"expire-input",value:this.state.expireDays,onChange:this.onChange,disabled:this.state.disabled,onKeyDown:this.handleKeyDown})," ",(0,x.jsx)(Re.A,{children:(0,x.jsx)("span",{children:(0,p.AP)("days")})})]}),this.state.errorInfo&&(0,x.jsx)(Ne.A,{color:"danger",children:this.state.errorInfo})]})}),(0,x.jsxs)(Me.A,{children:[(0,x.jsx)(j.A,{color:"secondary",onClick:this.props.toggleDialog,children:(0,p.AP)("Cancel")}),(0,x.jsx)(j.A,{color:"primary",onClick:this.submit,children:(0,p.AP)("Submit")})]})]})}}])}(l.Component),yn=window.sysadmin.pageOptions.enableSysAdminViewRepo,Pn=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.getPreviousPageList=function(){n.props.getListByPage(n.props.pageInfo.current_page-1)},n.getNextPageList=function(){n.props.getListByPage(n.props.pageInfo.current_page+1)},n.sortByFileCount=function(e){e.preventDefault(),n.props.sortItems("file_count")},n.sortBySize=function(e){e.preventDefault(),n.props.sortItems("size")},n.state={isItemFreezed:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,i=t.errorMsg,s=t.items,a=t.pageInfo,r=t.curPerPage,o=t.sortBy;if(n)return(0,x.jsx)(D.A,{});if(i)return(0,x.jsx)("p",{className:"error text-center",children:i});var c=(0,x.jsx)(me.A,{text:(0,p.AP)("No libraries")}),d=(0,x.jsx)("span",{className:"sf3-font sf3-font-sort3"}),u=(0,x.jsx)("span",{className:"sf3-font sf3-font-down"}),h=(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("table",{children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"5%"}),(0,x.jsx)("th",{width:"25%",children:(0,p.AP)("Name")}),(0,x.jsx)("th",{width:"15%",children:void 0!=o?(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("a",{className:"d-inline-block table-sort-op",href:"#",onClick:this.sortByFileCount,children:[(0,p.AP)("Files")," ","file_count"==o?u:d]})," / ",(0,x.jsxs)("a",{className:"d-inline-block table-sort-op",href:"#",onClick:this.sortBySize,children:[(0,p.AP)("Size")," ","size"==o?u:d]})]}):(0,x.jsxs)(x.Fragment,{children:[(0,p.AP)("Files")," / ",(0,p.AP)("Size")]})}),(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)("th",{width:"32%",children:"ID"}),(0,x.jsx)("th",{width:"18%",children:(0,p.AP)("Owner")}),(0,x.jsx)("th",{width:"5%"})]})]})}),(0,x.jsx)("tbody",{children:s.map((function(t,n){return(0,x.jsx)(bn,{repo:t,isItemFreezed:e.state.isItemFreezed,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem,onDeleteRepo:e.props.onDeleteRepo,onTransferRepo:e.props.onTransferRepo,isWiki:e.props.isWiki},n)}))})]}),a&&(0,x.jsx)(X.A,{gotoPreviousPage:this.getPreviousPageList,gotoNextPage:this.getNextPageList,currentPage:a.current_page,hasNextPage:a.has_next_page,curPerPage:r,resetPerPage:this.props.resetPerPage})]});return s.length?h:c}}])}(l.Component),bn=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).onDeleteRepo=function(e){S.H.sysAdminDeleteRepo(e.id).then((function(t){n.props.onDeleteRepo(e),n.setState({isDeleteDialogOpen:!1,isRepoDeleted:!0});var i=(0,p.AP)("Successfully deleted {name}.").replace("{name}",e.name);k.A.success(i)})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t),n.setState({isRepoDeleted:!1})}))},n.onTransferRepo=function(e,t){S.H.sysAdminTransferRepo(n.props.repo.id,e,t).then((function(e){n.props.onTransferRepo(e.data);var t=(0,p.AP)("Successfully transferred the library.");k.A.success(t)})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.handleMouseOver=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!0,highlight:!0})},n.handleMouseOut=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!1,highlight:!1})},n.onUnfreezedItem=function(){n.setState({highlight:!1,isOpIconShow:!1}),n.props.onUnfreezedItem()},n.onMenuItemClick=function(e){switch(e){case"Share":n.toggleShareDialog();break;case"Delete":n.toggleDeleteDialog();break;case"Transfer":n.toggleTransferDialog();break;case"History Setting":n.toggleHistorySettingDialog()}},n.toggleShareDialog=function(){n.setState({isShareDialogOpen:!n.state.isShareDialogOpen})},n.toggleDeleteDialog=function(){n.setState({isDeleteDialogOpen:!n.state.isDeleteDialogOpen})},n.toggleTransferDialog=function(){n.setState({isTransferDialogOpen:!n.state.isTransferDialogOpen})},n.toggleHistorySettingDialog=function(){n.setState({isHistorySettingDialogOpen:!n.state.isHistorySettingDialogOpen})},n.renderRepoName=function(){var e=n.props.repo;return e.name?p.am&&yn&&!e.encrypted?(0,x.jsx)(h.N_,{to:"".concat(p.Yc,"sys/libraries/").concat(e.id,"/"),children:e.name}):e.name:"--"},n.translateOperations=function(e){var t="";switch(e){case"Share":t=(0,p.AP)("Share");break;case"Delete":t=(0,p.AP)("Delete");break;case"Transfer":t=(0,p.AP)("Transfer");break;case"History Setting":t=(0,p.AP)("History Setting")}return t},n.getOperations=function(){var e=n.props.repo;if(n.props.isWiki)return["Delete"];var t=["Delete","Transfer"];return-1!=e.owner_email.indexOf("@seafile_group")?t=["Transfer"]:(e.encrypted||t.push("Share"),t.push("History Setting"),t)},n.state={isOpIconShown:!1,highlight:!1,isShareDialogOpen:!1,isDeleteDialogOpen:!1,isTransferDialogOpen:!1,isHistorySettingDialogOpen:!1,isRepoDeleted:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e,t=this.props.repo,n=this.state,i=n.isOpIconShown,s=n.isShareDialogOpen,a=n.isDeleteDialogOpen,r=n.isTransferDialogOpen,o=n.isHistorySettingDialogOpen,c=f.Aq.getLibIconUrl(t),d=f.Aq.getLibIconTitle(t),u=t.owner_email.indexOf("@seafile_group"),g=-1!=u;g&&(e=t.owner_email.substring(0,u));var m="";return this.props.isWiki&&(m=this.renderRepoName(),t.is_published&&(m=(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("span",{children:m}),(0,x.jsx)("a",{href:t.public_url,target:"_blank",rel:"noreferrer",children:"(Published)"})]}))),(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.handleMouseOver,onMouseLeave:this.handleMouseOut,children:[(0,x.jsx)("td",{children:(0,x.jsx)("img",{src:c,title:d,alt:d,width:"24"})}),this.props.isWiki?(0,x.jsx)("td",{children:m}):(0,x.jsx)("td",{children:this.renderRepoName()}),(0,x.jsx)("td",{children:"".concat(t.file_count," / ").concat(f.Aq.bytesToSize(t.size))}),(0,x.jsx)("td",{children:t.id}),(0,x.jsx)("td",{children:g?(0,x.jsx)(h.N_,{to:"".concat(p.Yc,"sys/groups/").concat(e,"/libraries/"),children:t.owner_name}):(0,x.jsx)(Se,{email:t.owner_email,name:t.owner_name})}),(0,x.jsx)("td",{children:i&&(0,x.jsx)(et.A,{operations:this.getOperations(),translateOperations:this.translateOperations,onMenuItemClick:this.onMenuItemClick,onFreezedItem:this.props.onFreezedItem,onUnfreezedItem:this.onUnfreezedItem})})]}),s&&(0,x.jsx)(en.A,{children:(0,x.jsx)(xn,{itemName:t.name,itemPath:"/",repoID:t.id,isGroupOwnedRepo:g,repoEncrypted:t.encrypted,enableDirPrivateShare:!0,userPerm:t.permission,toggleDialog:this.toggleShareDialog})}),a&&(0,x.jsx)(en.A,{children:(0,x.jsx)(tn.A,{repo:t,isRepoDeleted:this.state.isRepoDeleted,onDeleteRepo:this.onDeleteRepo,toggle:this.toggleDeleteDialog,isGetShare:!1})}),r&&(0,x.jsx)(en.A,{children:(0,x.jsx)(Ot.A,{itemName:t.name,onTransferRepo:this.onTransferRepo,toggleDialog:this.toggleTransferDialog,isSysAdmin:!0})}),o&&(0,x.jsx)(en.A,{children:(0,x.jsx)(An,{repoID:t.id,itemName:t.name,toggleDialog:this.toggleHistorySettingDialog})})]})}}])}(l.Component),jn=Pn,Sn=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).toggleCreateRepoDialog=function(){n.setState({isCreateRepoDialogOpen:!n.state.isCreateRepoDialogOpen})},n.getReposByPage=function(e){var t=n.state,i=t.perPage,s=t.sortBy;S.H.sysAdminListAllRepos(e,i,s).then((function(e){n.setState({loading:!1,repos:e.data.repos,pageInfo:e.data.page_info})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.sortItems=function(e){n.setState({currentPage:1,sortBy:e},(function(){var e=new URL(location.href),t=new URLSearchParams(e.search),i=n.state,s=i.currentPage,a=i.sortBy;t.set("page",s),t.set("order_by",a),e.search=t.toString(),(0,h.oo)(e.toString()),n.getReposByPage(s)}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){n.getReposByPage(1)}))},n.createRepo=function(e,t){S.H.sysAdminCreateRepo(e,t).then((function(e){n.state.repos.unshift(e.data),n.setState({repos:n.state.repos})})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.onDeleteRepo=function(e){var t=n.state.repos.filter((function(t){return t.id!=e.id}));n.setState({repos:t})},n.onTransferRepo=function(e){var t=n.state.repos.map((function(t){return t.id==e.id?e:t}));n.setState({repos:t})},n.getSearch=function(){return(0,x.jsx)(We.A,{placeholder:(0,p.AP)("Search libraries by name or ID"),submit:n.searchRepos})},n.searchRepos=function(e){n.getValueLength(e)<3?k.A.notify((0,p.AP)("Required at least three letters.")):(0,h.oo)("".concat(p.Yc,"sys/search-libraries/?name_or_id=").concat(encodeURIComponent(e)))},n.state={loading:!0,errorMsg:"",repos:[],pageInfo:{},perPage:100,sortBy:"",isCreateRepoDialogOpen:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,i=n.currentPage,s=void 0===i?1:i,a=n.perPage,r=n.sortBy;this.setState({sortBy:t.get("order_by")||r,perPage:parseInt(t.get("per_page")||a),currentPage:parseInt(t.get("page")||s)},(function(){e.getReposByPage(e.state.currentPage)}))}},{key:"getValueLength",value:function(e){for(var t,n=0,i=0,s=e.length;i<s;i++)10===(t=e.charCodeAt(i))?n+=2:t<127?n+=1:t>=128&&t<=2047?n+=2:t>=2048&&t<=65535&&(n+=3);return n}},{key:"render",value:function(){var e=this.state.isCreateRepoDialogOpen;return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)((0,i.default)({search:this.getSearch()},this.props),{},{children:(0,x.jsxs)(j.A,{className:"btn btn-secondary operation-item",onClick:this.toggleCreateRepoDialog,children:[(0,x.jsx)("i",{className:"sf3-font sf3-font-enlarge text-secondary mr-1"}),(0,p.AP)("New Library")]})})),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(Jt,{currentItem:"all"}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsx)(jn,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.repos,sortBy:this.state.sortBy,sortItems:this.sortItems,pageInfo:this.state.pageInfo,curPerPage:this.state.perPage,getListByPage:this.getReposByPage,resetPerPage:this.resetPerPage,onDeleteRepo:this.onDeleteRepo,onTransferRepo:this.onTransferRepo})})]})}),e&&(0,x.jsx)(Xt,{createRepo:this.createRepo,toggleDialog:this.toggleCreateRepoDialog})]})}}])}(l.Component),kn=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).getWikisByPage=function(e){var t=n.state,i=t.perPage,s=t.sortBy;S.H.sysAdminListAllWikis(e,i,s).then((function(e){n.setState({loading:!1,wikis:e.data.wikis,pageInfo:e.data.page_info})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.sortItems=function(e){n.setState({currentPage:1,sortBy:e},(function(){var e=new URL(location.href),t=new URLSearchParams(e.search),i=n.state,s=i.currentPage,a=i.sortBy;t.set("page",s),t.set("order_by",a),e.search=t.toString(),(0,h.oo)(e.toString()),n.getWikisByPage(s)}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){n.getWikisByPage(1)}))},n.onDeleteWiki=function(e){var t=n.state.wikis.filter((function(t){return t.id!=e.id}));n.setState({wikis:t})},n.onTransferWiki=function(e){var t=n.state.wikis.map((function(t){return t.id==e.id?e:t}));n.setState({wikis:t})},n.state={loading:!0,errorMsg:"",wikis:[],pageInfo:{},perPage:100,sortBy:""},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,i=n.currentPage,s=void 0===i?1:i,a=n.perPage,r=n.sortBy;this.setState({sortBy:t.get("order_by")||r,perPage:parseInt(t.get("per_page")||a),currentPage:parseInt(t.get("page")||s)},(function(){e.getWikisByPage(e.state.currentPage)}))}},{key:"render",value:function(){return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(Jt,{currentItem:"wikis"}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsx)(jn,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.wikis,sortBy:this.state.sortBy,sortItems:this.sortItems,pageInfo:this.state.pageInfo,curPerPage:this.state.perPage,getListByPage:this.getWikisByPage,resetPerPage:this.resetPerPage,onDeleteRepo:this.onDeleteWiki,onTransferRepo:this.onTransferWiki,isWiki:!0})})]})})]})}}])}(l.Component),Dn=function(e){function t(){return(0,s.default)(this,t),(0,r.default)(this,t,arguments)}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg,i=e.items;return t?(0,x.jsx)(D.A,{}):n?(0,x.jsx)("p",{className:"error text-center",children:n}):(0,x.jsx)(l.Fragment,{children:(0,x.jsxs)("table",{className:"table-hover",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"33%",children:(0,p.AP)("Name")}),(0,x.jsx)("th",{width:"34%",children:"ID"}),(0,x.jsx)("th",{width:"33%",children:(0,p.AP)("Description")})]})}),(0,x.jsx)("tbody",{children:i.map((function(e,t){return(0,x.jsx)(_n,{item:e},t)}))})]})})}}])}(l.Component),_n=function(e){function t(){return(0,s.default)(this,t),(0,r.default)(this,t,arguments)}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.item;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:(0,x.jsx)(h.N_,{to:"".concat(p.Yc,"sys/libraries/").concat(e.id,"/"),children:e.name})}),(0,x.jsx)("td",{children:e.id}),(0,x.jsx)("td",{children:e.description})]})}}])}(l.Component),wn=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).state={loading:!0,errorMsg:"",items:[]},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this;S.H.sysAdminGetSystemRepoInfo().then((function(t){var n=[];n.push(t.data),e.setState({items:n,loading:!1})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(Jt,{currentItem:"system"}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsx)(Dn,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.items})})]})})]})}}])}(l.Component),In=window.sysadmin.pageOptions.trashReposExpireDays;M().extend(ge());var Nn=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.getPreviousPageList=function(){n.props.getListByPage(n.props.pageInfo.current_page-1)},n.getNextPageList=function(){n.props.getListByPage(n.props.pageInfo.current_page+1)},n.state={isItemFreezed:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,i=t.errorMsg,s=t.items,a=t.pageInfo,r=t.curPerPage;if(n)return(0,x.jsx)(D.A,{});if(i)return(0,x.jsx)("p",{className:"error text-center mt-4",children:i});var o=(0,x.jsx)(me.A,{text:(0,p.AP)("No deleted libraries")}),c=(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)("p",{className:"mt-4 small text-secondary",children:(0,p.AP)("Tip: libraries deleted {trashReposExpireDays} days ago will be cleaned automatically.").replace("{trashReposExpireDays}",In)}),(0,x.jsxs)("table",{className:"table-hover",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"5%"}),(0,x.jsx)("th",{width:"43%",children:(0,p.AP)("Name")}),(0,x.jsx)("th",{width:"27%",children:(0,p.AP)("Owner")}),(0,x.jsx)("th",{width:"20%",children:(0,p.AP)("Deleted Time")}),(0,x.jsx)("th",{width:"5%"})]})}),(0,x.jsx)("tbody",{children:s.map((function(t,n){return(0,x.jsx)(Mn,{repo:t,isItemFreezed:e.state.isItemFreezed,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem,onDeleteRepo:e.props.onDeleteRepo,onRestoreRepo:e.props.onRestoreRepo},n)}))})]}),a&&(0,x.jsx)(X.A,{gotoPreviousPage:this.getPreviousPageList,gotoNextPage:this.getNextPageList,currentPage:a.current_page,hasNextPage:a.has_next_page,curPerPage:r,resetPerPage:this.props.resetPerPage})]});return s.length?c:o}}])}(l.Component),Mn=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleMouseOver=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!0,isHighlighted:!0})},n.handleMouseOut=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!1,isHighlighted:!1})},n.onUnfreezedItem=function(){n.setState({isHighlighted:!1,isOpIconShow:!1}),n.props.onUnfreezedItem()},n.onDeleteRepo=function(){var e=n.props.repo;S.H.sysAdminDeleteTrashRepo(e.id).then((function(t){n.props.onDeleteRepo(e);var i=(0,p.AP)("Successfully deleted {name}.").replace("{name}",e.name);k.A.success(i)})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.onRestoreRepo=function(){var e=n.props.repo;S.H.sysAdminRestoreTrashRepo(e.id).then((function(t){n.props.onRestoreRepo(e);var i=(0,p.AP)("Successfully restored the library.");k.A.success(i)})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.toggleDeleteRepoDialog=function(e){e&&e.preventDefault(),n.setState({isDeleteRepoDialogOpen:!n.state.isDeleteRepoDialogOpen})},n.toggleRestoreRepoDialog=function(e){e&&e.preventDefault(),n.setState({isRestoreRepoDialogOpen:!n.state.isRestoreRepoDialogOpen})},n.translateOperations=function(e){var t="";switch(e){case"Restore":t=(0,p.AP)("Restore");break;case"Delete":t=(0,p.AP)("Delete")}return t},n.onMenuItemClick=function(e){switch(e){case"Restore":n.toggleRestoreRepoDialog();break;case"Delete":n.toggleDeleteRepoDialog()}},n.state={isHighlighted:!1,isOpIconShown:!1,isDeleteRepoDialogOpen:!1,isRestoreRepoDialogOpen:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.repo,t=this.state,n=t.isOpIconShown,i=t.isDeleteRepoDialogOpen,s=t.isRestoreRepoDialogOpen,a=t.isHighlighted,r=f.Aq.getLibIconUrl(e),o=f.Aq.getLibIconTitle(e),c='<span class="op-target">'+f.Aq.HTMLescape(e.name)+"</span>";return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("tr",{className:fe()({"tr-highlight":a}),onMouseEnter:this.handleMouseOver,onMouseLeave:this.handleMouseOut,children:[(0,x.jsx)("td",{children:(0,x.jsx)("img",{src:r,title:o,alt:o,width:"24"})}),(0,x.jsx)("td",{children:e.name}),(0,x.jsx)("td",{children:-1==e.owner.indexOf("@seafile_group")?(0,x.jsx)(Se,{email:e.owner,name:e.owner_name}):e.group_name}),(0,x.jsx)("td",{children:M()(e.delete_time).fromNow()}),(0,x.jsx)("td",{children:n&&(0,x.jsx)(et.A,{operations:["Restore","Delete"],translateOperations:this.translateOperations,onMenuItemClick:this.onMenuItemClick,onFreezedItem:this.props.onFreezedItem,onUnfreezedItem:this.onUnfreezedItem})})]}),i&&(0,x.jsx)(en.A,{children:(0,x.jsx)(Ye.A,{title:(0,p.AP)("Delete Library"),message:(0,p.AP)("Are you sure you want to delete {placeholder} completely?").replace("{placeholder}",c),executeOperation:this.onDeleteRepo,confirmBtnText:(0,p.AP)("Delete"),toggleDialog:this.toggleDeleteRepoDialog})}),s&&(0,x.jsx)(en.A,{children:(0,x.jsx)(Ye.A,{title:(0,p.AP)("Restore Library"),message:(0,p.AP)("Are you sure you want to restore {placeholder}?").replace("{placeholder}",c),executeOperation:this.onRestoreRepo,confirmBtnText:(0,p.AP)("Restore"),toggleDialog:this.toggleRestoreRepoDialog})})]})}}])}(l.Component),Cn=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).toggleCleanTrashDialog=function(){n.setState({isCleanTrashDialogOpen:!n.state.isCleanTrashDialogOpen})},n.getReposByPage=function(e){var t=n.state.perPage;S.H.sysAdminListTrashRepos(e,t).then((function(e){n.setState({repos:e.data.repos,pageInfo:e.data.page_info,loading:!1})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){n.getReposByPage(1)}))},n.onDeleteRepo=function(e){var t=n.state.repos.filter((function(t){return t.id!=e.id}));n.setState({repos:t})},n.onRestoreRepo=function(e){var t=n.state.repos.filter((function(t){return t.id!=e.id}));n.setState({repos:t})},n.cleanTrash=function(){S.H.sysAdminCleanTrashRepos().then((function(e){n.setState({repos:[]}),k.A.success((0,p.AP)("Successfully cleared trash."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.getSearch=function(){return(0,x.jsx)(We.A,{placeholder:(0,p.AP)("Search libraries by owner"),submit:n.searchRepos})},n.searchRepos=function(e){S.H.sysAdminSearchTrashRepos(e).then((function(e){n.setState({repos:e.data.repos,pageInfo:null,errorMsg:"",loading:!1})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.state={loading:!0,errorMsg:"",repos:[],pageInfo:{},perPage:100,isCleanTrashDialogOpen:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,i=n.currentPage,s=void 0===i?1:i,a=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||a),currentPage:parseInt(t.get("page")||s)},(function(){e.getReposByPage(e.state.currentPage)}))}},{key:"render",value:function(){var e=this.state.isCleanTrashDialogOpen;return(0,x.jsxs)(l.Fragment,{children:[this.state.repos.length?(0,x.jsx)(_.A,(0,i.default)((0,i.default)({},this.props),{},{children:(0,x.jsx)(j.A,{className:"operation-item",onClick:this.toggleCleanTrashDialog,children:(0,p.AP)("Clean")})})):(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(Jt,{currentItem:"trash"}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsx)(Nn,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.repos,pageInfo:this.state.pageInfo,onDeleteRepo:this.onDeleteRepo,onRestoreRepo:this.onRestoreRepo,getListByPage:this.getReposByPage,resetPerPage:this.resetPerPage,curPerPage:this.state.perPage})})]})}),e&&(0,x.jsx)(Ye.A,{title:(0,p.AP)("Clear Trash"),message:(0,p.AP)("Are you sure you want to clear trash?"),executeOperation:this.cleanTrash,confirmBtnText:(0,p.AP)("Clear"),toggleDialog:this.toggleCleanTrashDialog})]})}}])}(l.Component),Ln=Cn,On=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).getRepos=function(e){var t=n.state,i=t.name,s=t.perPage;n.getValueLength(i)<3?k.A.notify((0,p.AP)("Required at least three letters.")):S.H.sysAdminSearchRepos(i,e,s).then((function(e){n.setState({loading:!1,errorMsg:"",repos:e.data.repo_list,pageInfo:e.data.page_info})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.searchRepos=function(){var e=n.state.currentPage;n.getRepos(e)},n.onDeleteRepo=function(e){var t=n.state.repos.filter((function(t){return t.id!=e.id}));n.setState({repos:t})},n.onTransferRepo=function(e){var t=n.state.repos.map((function(t){return t.id==e.id?e:t}));n.setState({repos:t})},n.handleNameInputChange=function(e){n.setState({name:e.target.value,currentPage:1},n.checkSubmitBtnActive)},n.checkSubmitBtnActive=function(){var e=n.state.name;n.setState({isSubmitBtnActive:e.trim()})},n.handleKeyDown=function(e){13===e.keyCode&&(n.state.isSubmitBtnActive&&n.searchRepos())},n.resetPerPage=function(e){n.setState({perPage:e,currentPage:1},(function(){n.searchRepos()}))},n.state={name:"",currentPage:1,perPage:100,isSubmitBtnActive:!1,loading:!0,errorMsg:"",repos:[],pageInfo:{}},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(document.location).searchParams,n=this.state,i=n.currentPage,s=n.perPage;this.setState({name:t.get("name_or_id")||"",perPage:parseInt(t.get("per_page")||s),currentPage:parseInt(t.get("page")||i)},(function(){e.getRepos(e.state.currentPage)}))}},{key:"getValueLength",value:function(e){for(var t,n=0,i=0,s=e.length;i<s;i++)10===(t=e.charCodeAt(i))?n+=2:t<127?n+=1:t>=128&&t<=2047?n+=2:t>=2048&&t<=65535&&(n+=3);return n}},{key:"render",value:function(){var e=this.state,t=e.name,n=e.isSubmitBtnActive;return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)("div",{className:"cur-view-path",children:(0,x.jsx)("h3",{className:"sf-heading",children:(0,p.AP)("Libraries")})}),(0,x.jsxs)("div",{className:"cur-view-content",children:[(0,x.jsxs)("div",{className:"mt-4 mb-6",children:[(0,x.jsx)("h4",{className:"border-bottom font-weight-normal mb-2 pb-1",children:(0,p.AP)("Search Libraries")}),(0,x.jsx)("p",{className:"text-secondary small",children:(0,p.AP)("Tip: you can search by keyword in name or ID.")}),(0,x.jsxs)(Oe.A,{tag:"div",children:[(0,x.jsxs)(Te.A,{row:!0,children:[(0,x.jsx)(Re.A,{for:"name",sm:1,children:(0,p.AP)("Name or ID")}),(0,x.jsx)(yt.A,{sm:5,children:(0,x.jsx)(W.A,{type:"text",name:"name",id:"name",value:t,onChange:this.handleNameInputChange,onKeyDown:this.handleKeyDown})})]}),(0,x.jsx)(Te.A,{row:!0,children:(0,x.jsx)(yt.A,{sm:{size:5,offset:1},children:(0,x.jsx)("button",{className:"btn btn-outline-primary",disabled:!n,onClick:this.searchRepos,children:(0,p.AP)("Submit")})})})]})]}),(0,x.jsxs)("div",{className:"mt-4 mb-6",children:[(0,x.jsx)("h4",{className:"border-bottom font-weight-normal mb-2 pb-1",children:(0,p.AP)("Result")}),(0,x.jsx)(jn,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.repos,pageInfo:this.state.pageInfo,curPerPage:this.state.perPage,getListByPage:this.getRepos,resetPerPage:this.resetPerPage,onDeleteRepo:this.onDeleteRepo,onTransferRepo:this.onTransferRepo})]})]})]})})]})}}])}(l.Component),Tn=n(90287),Rn=n(81617),Un=function(){return(0,a.default)((function e(t){(0,s.default)(this,e),this.name=t.obj_name,this.mtime=t.last_update,this.size=t.file_size,this.is_file=t.is_file}),[{key:"isDir",value:function(){return!this.is_file}}])}(),Fn=function(e){function t(){var e;(0,s.default)(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=(0,r.default)(this,t,[].concat(i))).onPathClick=function(t){var n=f.Aq.getEventData(t,"path");e.props.onPathClick(n)},e.turnPathToLink=function(t){var n=(t="/"===t[t.length-1]?t.slice(0,t.length-1):t).split("/"),i="";return n.map((function(t,s){return""===t?null:s===n.length-1?(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)("span",{className:"path-split",children:"/"}),(0,x.jsx)("span",{className:"path-file-name",children:t})]},s):(i+="/"+t,(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)("span",{className:"path-split",children:"/"}),(0,x.jsx)("a",{className:"path-link","data-path":i,onClick:e.onPathClick,children:t})]},s))}))},e}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props,t=e.isSystemRepo,n=e.currentPath,i=e.repoName,s=this.turnPathToLink(n);return(0,x.jsxs)("div",{className:"path-container",children:[t?(0,x.jsx)("a",{href:"".concat(p.Yc,"sys/system-library/"),children:(0,p.AP)("System")}):(0,x.jsx)("a",{href:"".concat(p.Yc,"sys/all-libraries/"),children:(0,p.AP)("All")}),(0,x.jsx)("span",{className:"path-split",children:"/"}),"/"===n||""===n?(0,x.jsx)("span",{className:"path-repo-name",children:i}):(0,x.jsx)("a",{className:"path-link","data-path":"/",onClick:this.onPathClick,children:i}),s]})}}])}(l.Component),En=Fn;M().extend(ge());var zn=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleMouseOver=function(){n.setState({isHighlighted:!0,isOpIconShown:!0})},n.handleMouseOut=function(){n.setState({isHighlighted:!1,isOpIconShown:!1})},n.openFolder=function(){n.props.openFolder(n.props.dirent)},n.deleteDirent=function(){n.props.deleteDirent(n.props.dirent)},n.downloadDirent=function(){n.props.downloadDirent(n.props.dirent)},n.state={isHighlighted:!1,isOpIconShown:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.state,t=e.isOpIconShown,n=e.isHighlighted,i=this.props,s=i.dirent,a=i.fromSystemRepo,r=f.Aq.getDirentIcon(s);return(0,x.jsx)(l.Fragment,{children:(0,x.jsxs)("tr",{className:fe()({"tr-highlight":n}),onMouseEnter:this.handleMouseOver,onMouseLeave:this.handleMouseOut,children:[(0,x.jsx)("td",{className:"text-center",children:(0,x.jsx)("img",{src:r,width:"24",alt:""})}),(0,x.jsx)("td",{children:s.is_file?s.name:(0,x.jsx)(h.N_,{to:"#",onClick:this.openFolder,children:s.name})}),(0,x.jsxs)("td",{children:[t&&a&&(0,x.jsx)("i",{className:"op-icon sf3-font-delete1 sf3-font",title:(0,p.AP)("Delete"),onClick:this.deleteDirent}),t&&s.is_file&&(0,x.jsx)("i",{className:"op-icon sf3-font sf3-font-download1",title:(0,p.AP)("Download"),onClick:this.downloadDirent})]}),(0,x.jsx)("td",{children:s.size}),(0,x.jsx)("td",{children:M()(s.mtime).fromNow()})]})})}}])}(l.Component),Bn=function(e){function t(){return(0,s.default)(this,t),(0,r.default)(this,t,arguments)}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,i=t.errorMsg,s=t.direntList;return n?(0,x.jsx)(D.A,{}):i?(0,x.jsx)("p",{className:"error text-center mt-4",children:i}):(0,x.jsx)(l.Fragment,{children:(0,x.jsxs)("table",{className:"table-hover",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"5%"}),(0,x.jsx)("th",{width:"55%",children:(0,p.AP)("Name")}),(0,x.jsx)("th",{width:"10%"}),(0,x.jsx)("th",{width:"15%",children:(0,p.AP)("Size")}),(0,x.jsx)("th",{width:"15%",children:(0,p.AP)("Last Update")})]})}),(0,x.jsx)("tbody",{children:s.map((function(t,n){return(0,x.jsx)(zn,{dirent:t,openFolder:e.props.openFolder,deleteDirent:e.props.deleteDirent,downloadDirent:e.props.downloadDirent,fromSystemRepo:e.props.fromSystemRepo},n)}))})]})})}}])}(l.Component),Hn=Bn,qn=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).onPathClick=function(e){n.loadDirentList(e)},n.toggleNewFolderDialog=function(){n.setState({isNewFolderDialogOpen:!n.state.isNewFolderDialogOpen})},n.createNewFolder=function(e){var t=f.Aq.getFileName(e);S.H.sysAdminCreateSysRepoFolder(n.props.repoID,n.state.path,t).then((function(e){var t=new Un(e.data),i=n.state.direntList;i.unshift(t),n.setState({direntList:i}),n.toggleNewFolderDialog()})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.openFolder=function(e){var t=f.Aq.joinPath(n.state.path,e.name);e.is_file||n.loadDirentList(t)},n.loadDirentList=function(e){var t=n.props.repoID;S.H.sysAdminListRepoDirents(t,e).then((function(i){var s=i.data,a=s.is_system_library,r=s.repo_name,o=s.dirent_list,l=[];o.forEach((function(e){var t=new Un(e);l.push(t)})),n.setState({loading:!1,repoName:r,isSystemRepo:a,direntList:l,path:e},(function(){var i=p.Yc+"sys/libraries/"+t+"/"+encodeURIComponent(n.state.repoName)+f.Aq.encodePath(e);window.history.replaceState({url:i,path:e},e,i)}))})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.deleteDirent=function(e){var t=f.Aq.joinPath(n.state.path,e.name);S.H.sysAdminDeleteRepoDirent(n.props.repoID,t).then((function(t){k.A.success((0,p.AP)("Successfully deleted 1 item."));var i=n.state.direntList.filter((function(t){return t.name!=e.name}));n.setState({direntList:i})})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.downloadDirent=function(e){var t=f.Aq.joinPath(n.state.path,e.name);S.H.sysAdminGetRepoFileDownloadURL(n.props.repoID,t).then((function(e){location.href=e.data.download_url})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.openFileInput=function(){n.fileInput.current.click()},n.onFileInputChange=function(){if(n.fileInput.current.files.length){var e=n.fileInput.current.files[0],t=n.state.path;S.H.sysAdminGetSysRepoItemUploadURL(t).then((function(i){var s=new FormData;s.append("parent_dir",t),s.append("file",e),Tn.A.post(i.data.upload_link,s).then((function(e){var t=e.data[0],i=new Un({is_file:!0,obj_name:t.name,file_size:f.Aq.bytesToSize(t.size),last_update:(new Date).getTime()}),s=n.state.direntList,a=s.filter((function(e){return!e.is_file}));s.splice(a.length,0,i),n.setState({direntList:s})}))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))}},n.checkDuplicatedName=function(e){return n.state.direntList.some((function(t){return t.name===e}))},n.state={loading:!0,errorMsg:"",isSystemRepo:!1,repoName:"",path:"",direntList:[],isNewFolderDialogOpen:!1},n.fileInput=l.createRef(),n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){this.loadDirentList("/")}},{key:"render",value:function(){var e=this.state,t=e.loading,n=e.errorMsg,s=e.repoName,a=e.direntList,r=e.isSystemRepo,o=e.path,c=e.isNewFolderDialogOpen,d=this.props.repoID;return(0,x.jsxs)(l.Fragment,{children:[r?(0,x.jsx)(_.A,(0,i.default)((0,i.default)({},this.props),{},{children:(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)("input",{className:"d-none",type:"file",onChange:this.onFileInputChange,ref:this.fileInput}),(0,x.jsx)(j.A,{className:"operation-item",onClick:this.openFileInput,children:(0,p.AP)("Upload")}),(0,x.jsx)(j.A,{className:"operation-item",onClick:this.toggleNewFolderDialog,children:(0,p.AP)("New Folder")})]})})):(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)("div",{className:"cur-view-path align-items-center",children:(0,x.jsx)(En,{isSystemRepo:r,repoID:d,repoName:s,currentPath:o,onPathClick:this.onPathClick})}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsx)(Hn,{loading:t,errorMsg:n,fromSystemRepo:r,direntList:a,openFolder:this.openFolder,deleteDirent:this.deleteDirent,downloadDirent:this.downloadDirent})})]})}),c&&(0,x.jsx)(Rn.A,{parentPath:o,checkDuplicatedName:this.checkDuplicatedName,onAddFolder:this.createNewFolder,addFolderCancel:this.toggleNewFolderDialog})]})}}])}(l.Component),Yn=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleRepoNameChange=function(e){e.target.value.trim()?n.setState({isSubmitBtnActive:!0}):n.setState({isSubmitBtnActive:!1}),n.setState({groupName:e.target.value})},n.handleSubmit=function(){var e=n.state.groupName.trim();n.props.createGroup(e,n.state.selectedUsers[0].email)},n.handleSelectChange=function(e){n.setState({selectedUsers:e})},n.handleKeyDown=function(e){"Enter"===e.key&&(n.handleSubmit(),e.preventDefault())},n.toggle=function(){n.props.toggleDialog()},n.state={groupName:"",selectedUsers:[],errMessage:"",isSubmitBtnActive:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){return(0,x.jsxs)(u.A,{isOpen:!0,toggle:this.toggle,autoFocus:!1,children:[(0,x.jsx)(Ce.A,{toggle:this.toggle,children:(0,p.AP)("New Group")}),(0,x.jsxs)(Ie.A,{children:[(0,x.jsx)(Oe.A,{children:(0,x.jsxs)(Te.A,{children:[(0,x.jsx)(Re.A,{for:"groupName",children:(0,p.AP)("Name")}),(0,x.jsx)(W.A,{id:"groupName",onKeyDown:this.handleKeyDown,value:this.state.groupName,onChange:this.handleRepoNameChange,autoFocus:!0}),(0,x.jsxs)(Re.A,{className:"mt-2",children:[(0,p.AP)("Owner"),(0,x.jsx)("span",{className:"small text-secondary ml-1",children:(0,p.AP)("(If left blank, owner will be admin)")})]}),(0,x.jsx)(He.A,{isMulti:!1,placeholder:(0,p.AP)("Select a user"),onSelectChange:this.handleSelectChange,selectedUsers:this.state.selectedUsers})]})}),this.state.errMessage&&(0,x.jsx)(Ne.A,{color:"danger",children:this.state.errMessage})]}),(0,x.jsxs)(Me.A,{children:[(0,x.jsx)(j.A,{color:"secondary",onClick:this.toggle,children:(0,p.AP)("Cancel")}),(0,x.jsx)(j.A,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive,children:(0,p.AP)("Submit")})]})]})}}])}(l.Component),Vn=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleSelectChange=function(e){n.setState({selectedUsers:e,submitBtnDisabled:null==e})},n.submit=function(){if(n.state.selectedUsers){var e=n.state.selectedUsers[0].email;n.props.transferGroup(e),n.props.toggleDialog()}},n.state={selectedUsers:[],submitBtnDisabled:!0},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.state.submitBtnDisabled,t='<span class="op-target">'+f.Aq.HTMLescape(this.props.groupName)+"</span>",n=(0,p.AP)("Transfer Group {placeholder} to").replace("{placeholder}",t);return(0,x.jsxs)(u.A,{isOpen:!0,toggle:this.props.toggleDialog,children:[(0,x.jsx)(Ce.A,{toggle:this.props.toggleDialog,children:(0,x.jsx)("span",{dangerouslySetInnerHTML:{__html:n}})}),(0,x.jsx)(Ie.A,{children:(0,x.jsx)(He.A,{isMulti:!1,placeholder:(0,p.AP)("Select a user"),onSelectChange:this.handleSelectChange,selectedUsers:this.state.selectedUsers})}),(0,x.jsxs)(Me.A,{children:[(0,x.jsx)(j.A,{color:"secondary",onClick:this.props.toggleDialog,children:(0,p.AP)("Cancel")}),(0,x.jsx)(j.A,{color:"primary",onClick:this.submit,disabled:e,children:(0,p.AP)("Submit")})]})]})}}])}(l.Component),Gn=n(52622);M().extend(ge());var Wn=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.getPreviousPage=function(){n.props.getListByPage(n.props.pageInfo.current_page-1)},n.getNextPage=function(){n.props.getListByPage(n.props.pageInfo.current_page+1)},n.state={isItemFreezed:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,i=t.errorMsg,s=t.items,a=t.pageInfo,r=t.curPerPage;if(n)return(0,x.jsx)(D.A,{});if(i)return(0,x.jsx)("p",{className:"error text-center mt-4",children:i});var o=(0,x.jsx)(me.A,{text:(0,p.AP)("No groups")}),c=(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("table",{children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"35%",children:(0,p.AP)("Name")}),(0,x.jsx)("th",{width:"40%",children:(0,p.AP)("Owner")}),(0,x.jsx)("th",{width:"20%",children:(0,p.AP)("Created At")}),(0,x.jsx)("th",{width:"5%"})]})}),(0,x.jsx)("tbody",{children:s.map((function(t,n){return(0,x.jsx)(Qn,{item:t,isItemFreezed:e.state.isItemFreezed,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem,deleteGroup:e.props.deleteGroup,transferGroup:e.props.transferGroup,changeGroup2Department:e.props.changeGroup2Department},n)}))})]}),a&&(0,x.jsx)(X.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:a.current_page,hasNextPage:a.has_next_page,curPerPage:r,resetPerPage:this.props.resetPerPage})]});return s.length?c:o}}])}(l.Component),Qn=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleMouseEnter=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!0,highlight:!0})},n.handleMouseLeave=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!1,highlight:!1})},n.onUnfreezedItem=function(){n.setState({highlight:!1,isOpIconShow:!1}),n.props.onUnfreezedItem()},n.onMenuItemClick=function(e){switch(e){case"Delete":n.toggleDeleteDialog();break;case"Transfer":n.toggleTransferDialog();break;case"Change":n.toggleChangeDialog()}},n.toggleDeleteDialog=function(e){e&&e.preventDefault(),n.setState({isDeleteDialogOpen:!n.state.isDeleteDialogOpen})},n.toggleTransferDialog=function(e){e&&e.preventDefault(),n.setState({isTransferDialogOpen:!n.state.isTransferDialogOpen})},n.toggleChangeDialog=function(e){e&&e.preventDefault(),n.setState({isChangeDialogOpen:!n.state.isChangeDialogOpen})},n.deleteGroup=function(){n.props.deleteGroup(n.props.item.id)},n.transferGroup=function(e){n.props.transferGroup(n.props.item.id,e)},n.changeGroup=function(){n.props.changeGroup2Department(n.props.item.id)},n.translateOperations=function(e){var t="";switch(e){case"Delete":t=(0,p.AP)("Delete");break;case"Transfer":t=(0,p.AP)("Transfer");break;case"Change":t=(0,p.AP)("Change to department")}return t},n.state={isOpIconShown:!1,highlight:!1,isDeleteDialogOpen:!1,isTransferDialogOpen:!1,isChangeDialogOpen:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.item,t=this.state,n=t.isOpIconShown,i=t.isDeleteDialogOpen,s=t.isTransferDialogOpen,a=t.isChangeDialogOpen,r='<span class="op-target">'+f.Aq.HTMLescape(e.name)+"</span>",o=(0,p.AP)("Are you sure you want to delete {placeholder} ?").replace("{placeholder}",r),c="".concat(p.Yc,"sys/groups/").concat(e.id,"/libraries/"),d=[];return d=p.am?["Delete","Transfer","Change"]:["Delete","Transfer"],(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,x.jsx)("td",{children:(0,x.jsx)(h.N_,{to:c,children:e.name})}),(0,x.jsx)("td",{children:"system admin"==e.owner?"--":(0,x.jsx)(Se,{email:e.owner,name:e.owner_name})}),(0,x.jsx)("td",{children:(0,x.jsx)("span",{title:M()(e.created_at).format("dddd, MMMM D, YYYY h:mm:ss A"),children:M()(e.created_at).fromNow()})}),(0,x.jsx)("td",{children:n&&"system admin"!=e.owner&&(0,x.jsx)(et.A,{operations:d,translateOperations:this.translateOperations,onMenuItemClick:this.onMenuItemClick,onFreezedItem:this.props.onFreezedItem,onUnfreezedItem:this.onUnfreezedItem})})]}),i&&(0,x.jsx)(Ye.A,{title:(0,p.AP)("Delete Group"),message:o,executeOperation:this.deleteGroup,confirmBtnText:(0,p.AP)("Delete"),toggleDialog:this.toggleDeleteDialog}),s&&(0,x.jsx)(Vn,{groupName:e.name,transferGroup:this.transferGroup,toggleDialog:this.toggleTransferDialog}),a&&(0,x.jsx)(Gn.A,{groupName:e.name,changeGroup2Department:this.changeGroup,toggleDialog:this.toggleChangeDialog})]})}}])}(l.Component),Kn=Wn,$n=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).toggleCreateGroupDialog=function(){n.setState({isCreateGroupDialogOpen:!n.state.isCreateGroupDialogOpen})},n.getGroupListByPage=function(e){S.H.sysAdminListAllGroups(e,n.state.perPage).then((function(e){n.setState({loading:!1,groupList:e.data.groups,pageInfo:e.data.page_info})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){n.getGroupListByPage(1)}))},n.createGroup=function(e,t){S.H.sysAdminCreateNewGroup(e,t).then((function(e){var t=n.state.groupList;t.unshift(e.data),n.setState({groupList:t}),n.toggleCreateGroupDialog()})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.deleteGroup=function(e){S.H.sysAdminDismissGroupByID(e).then((function(t){var i=n.state.groupList.filter((function(t){return t.id!=e}));n.setState({groupList:i}),k.A.success((0,p.AP)("Successfully deleted 1 item."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.transferGroup=function(e,t){S.H.sysAdminTransferGroup(t,e).then((function(t){var i=n.state.groupList.map((function(n){return n.id==e&&(n=t.data),n}));n.setState({groupList:i}),k.A.success((0,p.AP)("Successfully transferred the group."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.changeGroup2Department=function(e){S.H.sysAdminGroup2Department(e).then((function(t){var i=n.state.groupList.map((function(n){return n.id==e&&(n=t.data),n}));n.setState({groupList:i}),k.A.success((0,p.AP)("Successfully change the group"))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.getSearch=function(){return(0,x.jsx)(We.A,{placeholder:(0,p.AP)("Search groups by name"),submit:n.searchGroups})},n.searchGroups=function(e){(0,h.oo)("".concat(p.Yc,"sys/search-groups/?name=").concat(encodeURIComponent(e)))},n.state={loading:!0,errorMsg:"",groupList:[],pageInfo:{},perPage:100,isCreateGroupDialogOpen:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,i=n.currentPage,s=void 0===i?1:i,a=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||a),currentPage:parseInt(t.get("page")||s)},(function(){e.getGroupListByPage(e.state.currentPage)}))}},{key:"render",value:function(){var e=this.state.isCreateGroupDialogOpen;return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)((0,i.default)({search:this.getSearch()},this.props),{},{children:(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(j.A,{className:"operation-item",onClick:this.toggleCreateGroupDialog,children:(0,p.AP)("New Group")}),(0,x.jsx)("a",{className:"btn btn-secondary operation-item",href:"".concat(p.Yc,"sys/groupadmin/export-excel/"),children:(0,p.AP)("Export Excel")})]})})),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)("div",{className:"cur-view-path",children:(0,x.jsx)("h3",{className:"sf-heading",children:(0,p.AP)("Groups")})}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsx)(Kn,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.groupList,pageInfo:this.state.pageInfo,deleteGroup:this.deleteGroup,transferGroup:this.transferGroup,changeGroup2Department:this.changeGroup2Department,getListByPage:this.getGroupListByPage,resetPerPage:this.resetPerPage,curPerPage:this.state.perPage})})]})}),e&&(0,x.jsx)(Yn,{createGroup:this.createGroup,toggleDialog:this.toggleCreateGroupDialog})]})}}])}(l.Component),Xn=$n,Zn=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).getGroups=function(){var e=n.state.name;S.H.sysAdminSearchGroups(e).then((function(e){n.setState({loading:!1,groupList:e.data.group_list})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.deleteGroup=function(e){S.H.sysAdminDismissGroupByID(e).then((function(t){var i=n.state.groupList.filter((function(t){return t.id!=e}));n.setState({groupList:i}),k.A.success((0,p.AP)("Successfully deleted 1 item."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.transferGroup=function(e,t){S.H.sysAdminTransferGroup(t,e).then((function(t){var i=n.state.groupList.map((function(n){return n.id==e&&(n=t.data),n}));n.setState({groupList:i}),k.A.success((0,p.AP)("Successfully transferred the group."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.handleNameInputChange=function(e){n.setState({name:e.target.value},n.checkSubmitBtnActive)},n.checkSubmitBtnActive=function(){var e=n.state.name;n.setState({isSubmitBtnActive:e.trim()})},n.handleKeyDown=function(e){13===e.keyCode&&(n.state.isSubmitBtnActive&&n.getGroups())},n.state={name:"",isSubmitBtnActive:!1,loading:!0,errorMsg:"",groupList:[],pageInfo:null},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=new URL(document.location).searchParams;this.setState({name:e.get("name")||""},this.getGroups)}},{key:"render",value:function(){var e=this.state,t=e.name,n=e.isSubmitBtnActive;return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)("div",{className:"cur-view-path",children:(0,x.jsx)("h3",{className:"sf-heading",children:(0,p.AP)("Groups")})}),(0,x.jsxs)("div",{className:"cur-view-content",children:[(0,x.jsxs)("div",{className:"mt-4 mb-6",children:[(0,x.jsx)("h4",{className:"border-bottom font-weight-normal mb-2 pb-1",children:(0,p.AP)("Search Groups")}),(0,x.jsx)("p",{className:"text-secondary small",children:(0,p.AP)("Tip: you can search by keyword in name.")}),(0,x.jsxs)(Oe.A,{tag:"div",children:[(0,x.jsxs)(Te.A,{row:!0,children:[(0,x.jsx)(Re.A,{for:"name",sm:1,children:(0,p.AP)("Name")}),(0,x.jsx)(yt.A,{sm:5,children:(0,x.jsx)(W.A,{type:"text",name:"name",id:"name",value:t,onChange:this.handleNameInputChange,onKeyDown:this.handleKeyDown})})]}),(0,x.jsx)(Te.A,{row:!0,children:(0,x.jsx)(yt.A,{sm:{size:5,offset:1},children:(0,x.jsx)("button",{className:"btn btn-outline-primary",disabled:!n,onClick:this.getGroups,children:(0,p.AP)("Submit")})})})]})]}),(0,x.jsxs)("div",{className:"mt-4 mb-6",children:[(0,x.jsx)("h4",{className:"border-bottom font-weight-normal mb-2 pb-1",children:(0,p.AP)("Result")}),(0,x.jsx)(Kn,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.groupList,deleteGroup:this.deleteGroup,transferGroup:this.transferGroup})]})]})]})})]})}}])}(l.Component),Jn=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).navItems=[{name:"repos",urlPart:"groups/"+n.props.groupID+"/libraries",text:(0,p.AP)("Libraries")},{name:"members",urlPart:"groups/"+n.props.groupID+"/members",text:(0,p.AP)("Members")}],n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props,t=e.groupName,n=e.currentItem;return(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{className:"cur-view-path",children:(0,x.jsxs)("h3",{className:"sf-heading",children:[(0,x.jsx)(h.N_,{to:"".concat(p.Yc,"sys/groups/"),children:(0,p.AP)("Groups")})," / ",t]})}),(0,x.jsx)("ul",{className:"nav border-bottom mx-4",children:this.navItems.map((function(e,t){return(0,x.jsx)("li",{className:"nav-item mr-2",children:(0,x.jsx)(h.N_,{to:"".concat(p.Yc,"sys/").concat(e.urlPart,"/"),className:"nav-link ".concat(n==e.name?" active":""),children:e.text})},t)}))})]})}}])}(l.Component),ei=Jn,ti=window.sysadmin.pageOptions.enableSysAdminViewRepo,ni=function(e){function t(e){return(0,s.default)(this,t),(0,r.default)(this,t,[e])}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,i=t.errorMsg,s=t.items;if(n)return(0,x.jsx)(D.A,{});if(i)return(0,x.jsx)("p",{className:"error text-center mt-4",children:i});var a=(0,x.jsx)(me.A,{text:(0,p.AP)("No libraries")}),r=(0,x.jsx)(l.Fragment,{children:(0,x.jsxs)("table",{children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"5%"}),(0,x.jsx)("th",{width:"30%",children:(0,p.AP)("Name")}),(0,x.jsx)("th",{width:"30%",children:(0,p.AP)("Size")}),(0,x.jsx)("th",{width:"25%",children:(0,p.AP)("Shared By")}),(0,x.jsx)("th",{width:"10%"})]})}),(0,x.jsx)("tbody",{children:s.map((function(t,n){return(0,x.jsx)(ii,{item:t,unshareRepo:e.props.unshareRepo},n)}))})]})});return s.length?r:a}}])}(l.Component),ii=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleMouseEnter=function(){n.setState({isHighlighted:!0,isOpIconShown:!0})},n.handleMouseLeave=function(){n.setState({isHighlighted:!1,isOpIconShown:!1})},n.toggleUnshareRepoDialog=function(){n.setState({isUnshareRepoDialogOpen:!n.state.isUnshareRepoDialogOpen})},n.unshareRepo=function(){var e=n.props.item;n.props.unshareRepo(e.repo_id,e.name),n.toggleUnshareRepoDialog()},n.renderRepoName=function(){var e=n.props.item,t=e;return t.id=e.repo_id,t.name?p.am&&ti&&!t.encrypted?(0,x.jsx)("a",{href:"".concat(p.Yc,"sys/libraries/").concat(t.id,"/"),children:t.name}):t.name:"--"},n.state={isHighlighted:!1,isOpIconShown:!1,isUnshareRepoDialogOpen:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.state,t=e.isOpIconShown,n=e.isUnshareRepoDialogOpen,i=e.isHighlighted,s=this.props.item,a=f.Aq.getLibIconUrl(s),r=f.Aq.getLibIconTitle(s),o='<span class="op-target">'+f.Aq.HTMLescape(s.name)+"</span>",c=(0,p.AP)("Are you sure you want to unshare {placeholder} ?").replace("{placeholder}",o);return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("tr",{className:fe()({"tr-highlight":i}),onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,x.jsx)("td",{children:(0,x.jsx)("img",{src:a,title:r,alt:r,width:"24"})}),(0,x.jsx)("td",{children:this.renderRepoName()}),(0,x.jsx)("td",{children:f.Aq.bytesToSize(s.size)}),(0,x.jsx)("td",{children:(0,x.jsx)(Se,{email:s.shared_by,name:s.shared_by_name})}),(0,x.jsx)("td",{children:(0,x.jsx)("i",{role:"button",className:"op-icon sf2-icon-x3 ".concat(t?"":"invisible"),title:(0,p.AP)("Unshare"),onClick:this.toggleUnshareRepoDialog})})]}),n&&(0,x.jsx)(Ye.A,{title:(0,p.AP)("Unshare Library"),message:c,executeOperation:this.unshareRepo,confirmBtnText:(0,p.AP)("Unshare"),toggleDialog:this.toggleUnshareRepoDialog})]})}}])}(l.Component),si=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).unshareRepo=function(e,t){S.H.sysAdminUnshareRepoFromGroup(n.props.groupID,e).then((function(i){var s=n.state.repoList.filter((function(t){return t.repo_id!=e}));n.setState({repoList:s});var a=(0,p.AP)("Successfully unshared library {placeholder}").replace("{placeholder}",t);k.A.success(a)})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.state={loading:!0,errorMsg:"",groupName:"",repoList:[]},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this;S.H.sysAdminListGroupRepos(this.props.groupID).then((function(t){e.setState({loading:!1,repoList:t.data.libraries,groupName:t.data.group_name})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(ei,{groupID:this.props.groupID,groupName:this.state.groupName,currentItem:"repos"}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsx)(ni,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.repoList,unshareRepo:this.unshareRepo})})]})})]})}}])}(l.Component),ai=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleSelectChange=function(e){n.setState({selectedUsers:e,isSubmitBtnDisabled:!e.length})},n.addMembers=function(){var e=n.state.selectedUsers.map((function(e){return e.email}));n.props.addMembers(e),n.props.toggle()},n.state={selectedUsers:[],isSubmitBtnDisabled:!0},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.state.isSubmitBtnDisabled;return(0,x.jsxs)(u.A,{isOpen:!0,toggle:this.props.toggle,children:[(0,x.jsx)(Ce.A,{toggle:this.props.toggle,children:(0,p.AP)("Add Member")}),(0,x.jsx)(Ie.A,{children:(0,x.jsx)(He.A,{isMulti:!0,placeholder:(0,p.AP)("Search users"),onSelectChange:this.handleSelectChange,selectedUsers:this.state.selectedUsers})}),(0,x.jsxs)(Me.A,{children:[(0,x.jsx)(j.A,{color:"secondary",onClick:this.props.toggle,children:(0,p.AP)("Cancel")}),(0,x.jsx)(j.A,{color:"primary",onClick:this.addMembers,disabled:e,children:(0,p.AP)("Submit")})]})]})}}])}(l.Component),ri=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).toggleItemFreezed=function(e){n.setState({isItemFreezed:e})},n.getPreviousPageList=function(){n.props.getListByPage(n.props.pageInfo.current_page-1)},n.getNextPageList=function(){n.props.getListByPage(n.props.pageInfo.current_page+1)},n.state={isItemFreezed:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,i=t.errorMsg,s=t.items,a=t.pageInfo,r=t.curPerPage;if(n)return(0,x.jsx)(D.A,{});if(i)return(0,x.jsx)("p",{className:"error text-center mt-4",children:i});var o=(0,x.jsx)(me.A,{text:(0,p.AP)("No members")}),c=(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("table",{children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"5%"}),(0,x.jsx)("th",{width:"55%",children:(0,p.AP)("Name")}),(0,x.jsx)("th",{width:"30%",children:(0,p.AP)("Role")}),(0,x.jsx)("th",{width:"10%"})]})}),(0,x.jsx)("tbody",{children:s.map((function(t,n){return(0,x.jsx)(oi,{item:t,isItemFreezed:e.state.isItemFreezed,toggleItemFreezed:e.toggleItemFreezed,removeMember:e.props.removeMember,updateMemberRole:e.props.updateMemberRole},n)}))})]}),a&&(0,x.jsx)(X.A,{gotoPreviousPage:this.getPreviousPageList,gotoNextPage:this.getNextPageList,currentPage:a.current_page,hasNextPage:a.has_next_page,curPerPage:r,resetPerPage:this.props.resetPerPage})]});return s.length?c:o}}])}(l.Component),oi=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleMouseEnter=function(){n.props.isItemFreezed||n.setState({highlighted:!0})},n.handleMouseLeave=function(){n.props.isItemFreezed||n.setState({highlighted:!1})},n.toggleDeleteDialog=function(e){e&&e.preventDefault(),n.setState({isDeleteDialogOpen:!n.state.isDeleteDialogOpen})},n.removeMember=function(){var e=n.props.item;n.props.removeMember(e.email,e.name),n.toggleDeleteDialog()},n.updateMemberRole=function(e){n.props.updateMemberRole(n.props.item.email,e.value)},n.roleOptions=[{value:"Admin",text:(0,p.AP)("Admin"),isSelected:!1},{value:"Member",text:(0,p.AP)("Member"),isSelected:!1}],n.state={highlighted:!1,isDeleteDialogOpen:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.state,t=e.highlighted,n=e.isDeleteDialogOpen,i=this.props.item,s='<span class="op-target">'+f.Aq.HTMLescape(i.name)+"</span>",a=(0,p.AP)("Are you sure you want to remove {placeholder} ?").replace("{placeholder}",s),r=i.role;this.roleOptions=this.roleOptions.map((function(e){return e.isSelected=e.value==r,e}));var o=this.roleOptions.filter((function(e){return e.isSelected}))[0];return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("tr",{className:t?"tr-highlight":"",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,x.jsx)("td",{children:(0,x.jsx)("img",{src:i.avatar_url,alt:"",className:"rounded-circle",width:"24"})}),(0,x.jsx)("td",{children:(0,x.jsx)(Se,{email:i.email,name:i.name})}),(0,x.jsx)("td",{children:"Owner"==i.role?(0,p.AP)("Owner"):(0,x.jsx)($e.A,{isDropdownToggleShown:t,currentSelectedOption:o,options:this.roleOptions,selectOption:this.updateMemberRole,toggleItemFreezed:this.props.toggleItemFreezed})}),(0,x.jsx)("td",{children:"Owner"!=i.role&&(0,x.jsx)("i",{role:"button",className:"op-icon sf2-icon-x3 ".concat(t?"":"invisible"),title:(0,p.AP)("Remove"),onClick:this.toggleDeleteDialog})})]}),n&&(0,x.jsx)(Ye.A,{title:(0,p.AP)("Remove Member"),message:a,executeOperation:this.removeMember,confirmBtnText:(0,p.AP)("Remove"),toggleDialog:this.toggleDeleteDialog})]})}}])}(l.Component),li=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).getListByPage=function(e){var t=n.state.perPage;S.H.sysAdminListGroupMembers(n.props.groupID,e,t).then((function(e){n.setState({loading:!1,memberList:e.data.members,groupName:e.data.group_name,pageInfo:e.data.page_info})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){n.getListByPage(1)}))},n.toggleAddMemberDialog=function(){n.setState({isAddMemberDialogOpen:!n.state.isAddMemberDialogOpen})},n.addMembers=function(e){S.H.sysAdminAddGroupMember(n.props.groupID,e).then((function(e){var t=e.data.success;t.length&&(n.setState({memberList:t.concat(n.state.memberList)}),t.forEach((function(e){var t=(0,p.AP)("Successfully added {email_placeholder}").replace("{email_placeholder}",e.email);k.A.success(t)}))),e.data.failed.forEach((function(e){var t=(0,p.AP)("Failed to add {email_placeholder}: {error_msg_placeholder}").replace("{email_placeholder}",e.email).replace("{error_msg_placeholder}",e.error_msg);k.A.danger(t,{duration:3})}))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.removeMember=function(e,t){S.H.sysAdminDeleteGroupMember(n.props.groupID,e).then((function(i){var s=n.state.memberList.filter((function(t){return t.email!=e}));n.setState({memberList:s}),k.A.success((0,p.AP)("Successfully removed {placeholder}.").replace("{placeholder}",t))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.updateMemberRole=function(e,t){var i="Admin"==t;S.H.sysAdminUpdateGroupMemberRole(n.props.groupID,e,i).then((function(i){var s=n.state.memberList.map((function(n){return n.email==e&&(n.role=t),n}));n.setState({memberList:s})})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.state={loading:!0,errorMsg:"",groupName:"",memberList:[],pageInfo:{},currentPage:1,perPage:100,isAddMemberDialogOpen:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,i=n.currentPage,s=n.perPage;this.setState({currentPage:parseInt(t.get("page")||i),perPage:parseInt(t.get("per_page")||s)},(function(){e.getListByPage(e.state.currentPage)}))}},{key:"render",value:function(){var e=this.state.isAddMemberDialogOpen;return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)((0,i.default)({},this.props),{},{children:(0,x.jsx)(j.A,{className:"btn btn-secondary operation-item",onClick:this.toggleAddMemberDialog,children:(0,p.AP)("Add Member")})})),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(ei,{currentItem:"members",groupID:this.props.groupID,groupName:this.state.groupName}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsx)(ri,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.memberList,removeMember:this.removeMember,updateMemberRole:this.updateMemberRole,pageInfo:this.state.pageInfo,curPerPage:this.state.perPage,getListByPage:this.getListByPage,resetPerPage:this.resetPerPage})})]})}),e&&(0,x.jsx)(ai,{addMembers:this.addMembers,toggle:this.toggleAddMemberDialog})]})}}])}(l.Component),ci=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).setGroupQuota=function(){var e=n.state.quota;if(e.length&&/^[1-9]\d*$/im.test(e)||-2==e){n.setState({errMessage:""});var t=-2==n.state.quota?n.state.quota:1e6*n.state.quota;S.H.sysAdminUpdateDepartmentQuota(n.props.group.id,t).then((function(e){n.props.toggle(),n.props.onSetQuota(e.data)})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))}else{var i=(0,p.AP)("Quota is invalid.");n.setState({errMessage:i})}},n.handleChange=function(e){var t=e.target.value.trim();n.setState({quota:t})},n.handleKeyDown=function(e){"Enter"===e.key&&(n.setGroupQuota(),e.preventDefault())},n.state={quota:"",errMessage:""},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.group,t=f.Aq.bytesToSize(e.quota),n=(0,p.AP)("The current quota for {group_name} is {quota}").replace("{group_name}",e.name).replace("{quota}",t);return(0,x.jsxs)(u.A,{isOpen:!0,toggle:this.props.toggle,autoFocus:!1,children:[(0,x.jsx)(Ce.A,{toggle:this.props.toggle,children:(0,p.AP)("Set Quota")}),(0,x.jsxs)(Ie.A,{children:[(0,x.jsx)("p",{children:n}),(0,x.jsx)("p",{children:(0,p.AP)("Please enter a new quota")}),(0,x.jsxs)(Ue.A,{children:[(0,x.jsx)(W.A,{onKeyDown:this.handleKeyDown,value:this.state.quota,onChange:this.handleChange,autoFocus:!0}),(0,x.jsx)(St.A,{children:"MB"})]}),(0,x.jsxs)("p",{className:"tip",children:[(0,x.jsx)("br",{}),(0,x.jsx)("span",{children:(0,p.AP)("An integer that is greater than 0 or equal to -2.")}),(0,x.jsx)("br",{}),(0,x.jsx)("span",{children:(0,p.AP)("Tip: -2 means no limit.")})]}),this.state.errMessage&&(0,x.jsx)("p",{className:"error",children:this.state.errMessage})]}),(0,x.jsxs)(Me.A,{children:[(0,x.jsx)(j.A,{color:"secondary",onClick:this.props.toggle,children:(0,p.AP)("Cancel")}),(0,x.jsx)(j.A,{color:"primary",onClick:this.setGroupQuota,children:(0,p.AP)("Submit")})]})]})}}])}(l.Component),di=n(15097),ui=n(685),hi=n(77474),gi=n(47150),pi=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleSubmit=function(){n.validateName()&&S.H.sysAdminAddRepoInDepartment(n.props.groupID,n.state.repoName.trim()).then((function(e){n.props.toggle(),n.props.onAddNewRepo(e.data)})).catch((function(e){var t=f.Aq.getErrorMsg(e);n.setState({errMessage:t})}))},n.validateName=function(){var e="";return!!n.state.repoName.trim().length||(e=(0,p.AP)("Name is required"),n.setState({errMessage:e}),!1)},n.handleChange=function(e){n.setState({repoName:e.target.value})},n.handleKeyDown=function(e){"Enter"===e.key&&(n.handleSubmit(),e.preventDefault())},n.state={repoName:"",errMessage:""},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){return(0,x.jsxs)(u.A,{isOpen:!0,toggle:this.props.toggle,autoFocus:!1,children:[(0,x.jsx)(Ce.A,{toggle:this.props.toggle,children:(0,p.AP)("New Library")}),(0,x.jsxs)(Ie.A,{children:[(0,x.jsx)(Oe.A,{children:(0,x.jsxs)(Te.A,{children:[(0,x.jsx)(Re.A,{for:"repoName",children:(0,p.AP)("Name")}),(0,x.jsx)(W.A,{id:"repoName",onKeyDown:this.handleKeyDown,value:this.state.repoName,onChange:this.handleChange,autoFocus:!0})]})}),this.state.errMessage&&(0,x.jsx)("p",{className:"error",children:this.state.errMessage})]}),(0,x.jsxs)(Me.A,{children:[(0,x.jsx)(j.A,{color:"secondary",onClick:this.props.toggle,children:(0,p.AP)("Cancel")}),(0,x.jsx)(j.A,{color:"primary",onClick:this.handleSubmit,children:(0,p.AP)("Submit")})]})]})}}])}(l.Component),fi=n(60436),mi=function(){return(0,a.default)((function e(t){(0,s.default)(this,e),this.id=t.id||"",this.name=t.name||"",this.children=t.children||[],this.parentNode=t.parentNode||null,this.orgId=t.orgId||"",this.quota=t.quota||-2}),[{key:"findNodeById",value:function(e){if(this.id===e)return this;for(var t=(0,fi.default)(this.children);t.length>0;){var n=t.shift();if(n.id===e)return n;t.push.apply(t,(0,fi.default)(n.children))}}},{key:"addChildren",value:function(e){var t;(t=this.children).push.apply(t,(0,fi.default)(e))}},{key:"setChildren",value:function(e){this.children=e}},{key:"hasChildren",value:function(){return this.children.length>0}},{key:"deleteChildById",value:function(e){this.children=this.children.filter((function(t){return t.id!==e}))}}])}(),vi=n(5495),xi=n(69123),Ai=n(65276),yi=n(34940);var Pi=function(e){var t=e.node,n=e.toggleDelete,i=e.toggleRename,s=e.toggleAddMembers,a=e.toggleAddDepartment,r=e.toggleAddLibrary,o=e.toggleSetQuotaDialog;return(0,x.jsxs)(Ai.A,{modifiers:[{name:"preventOverflow",options:{boundary:document.body}}],className:"position-fixed",children:[(0,x.jsx)(yi.A,{onClick:function(){return a(t)},children:(0,p.AP)("Add sub-department")},"".concat(t.id,"-add-department")),(0,x.jsx)(yi.A,{onClick:function(){return r(t)},children:(0,p.AP)("Add Library")},"".concat(t.id,"-add-repo")),(0,x.jsx)(yi.A,{onClick:function(){return s(t)},children:(0,p.AP)("Add members")},"".concat(t.id,"-add-members")),(0,x.jsx)(yi.A,{onClick:function(){return i(t)},children:(0,p.AP)("Rename")},"".concat(t.id,"-rename")),(0,x.jsx)(yi.A,{onClick:function(){return n(t)},children:(0,p.AP)("Delete")},"".concat(t.id,"-delete")),(0,x.jsx)(yi.A,{onClick:function(){return o(t)},children:(0,p.AP)("Set quota")},"".concat(t.id,"-set-quota")),(0,x.jsx)(yi.A,{disabled:!0,children:"".concat((0,p.AP)("Department ID")," : ").concat(t.id)},"".concat(t.id,"-id"))]})},bi=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).toggleChildren=function(e){e.preventDefault(),e.stopPropagation(),n.state.isChildrenShow?n.setState({isChildrenShow:!1}):n.listSubDepartments()},n.listSubDepartments=function(){var e=n.props.node;n.props.listSubDepartments(e.id,(function(e){Array.isArray(e)&&0===e.length&&n.setState({isShowTreeIcon:!1}),n.setState({isChildrenShow:!0})}))},n.dropdownToggle=function(e){e.stopPropagation(),n.setState({dropdownOpen:!n.state.dropdownOpen})},n.onMouseEnter=function(){n.setState({active:!0})},n.onMouseLeave=function(){n.state.dropdownOpen||n.setState({active:!1})},n.renderTreeNodes=function(e){if(e.length>0)return e.map((function(e){return(0,x.jsx)(t,{node:e,onChangeDepartment:n.props.onChangeDepartment,checkedDepartmentId:n.props.checkedDepartmentId,listSubDepartments:n.props.listSubDepartments,toggleAddDepartment:n.props.toggleAddDepartment,toggleSetQuotaDialog:n.props.toggleSetQuotaDialog,toggleAddMembers:n.props.toggleAddMembers,toggleRename:n.props.toggleRename,toggleDelete:n.props.toggleDelete,toggleAddLibrary:n.props.toggleAddLibrary},e.id)}))},n.changeDept=function(e){var t=n.props,i=t.node,s=t.checkedDepartmentId,a=n.state.isChildrenShow;if(s!==i.id&&n.props.onChangeDepartment(e),s===i.id){if(a)return void n.setState({isChildrenShow:!1});n.listSubDepartments()}},n.state={isShowTreeIcon:!0,isChildrenShow:!1,dropdownOpen:!1,active:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){-1===this.props.node.id&&this.listSubDepartments()}},{key:"render",value:function(){var e=this,t=this.props,n=t.node,i=t.checkedDepartmentId,s=this.state,a=s.isChildrenShow,r=s.dropdownOpen,o=s.active,c=fe()({"tree-node":!0,active:i===n.id});return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("div",{className:c,onClick:function(){return e.changeDept(n.id)},onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[this.state.isShowTreeIcon?(0,x.jsx)("span",{className:"departments-v2-tree-icon",onClick:function(t){return e.toggleChildren(t)},children:(0,x.jsx)("i",{className:"sf3-font sf3-font-down ".concat(a?"":"rotate-270")})}):(0,x.jsx)("span",{style:{width:24}}),(0,x.jsx)("span",{className:"departments-v2-tree-node-text text-truncate",children:n.name}),o&&(0,x.jsxs)(vi.A,{isOpen:r,toggle:function(t){return e.dropdownToggle(t)},direction:"down",className:"mr-2",children:[(0,x.jsx)(xi.A,{tag:"span",role:"button",className:"right-icon",title:(0,p.AP)("More operations"),"aria-label":(0,p.AP)("More operations"),"data-toggle":"dropdown",children:(0,x.jsx)("i",{className:"sf3-font sf3-font-more"})}),(0,x.jsx)(Pi,{node:n,toggleAddDepartment:this.props.toggleAddDepartment,toggleSetQuotaDialog:this.props.toggleSetQuotaDialog,toggleAddLibrary:this.props.toggleAddLibrary,toggleAddMembers:this.props.toggleAddMembers,toggleRename:this.props.toggleRename,toggleDelete:this.props.toggleDelete})]})]}),this.state.isChildrenShow&&(0,x.jsx)("div",{className:"tree-node-children",children:n.children&&this.renderTreeNodes(n.children)})]})}}])}(l.Component),ji=function(e){function t(){return(0,s.default)(this,t),(0,r.default)(this,t,arguments)}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.rootNodes,i=t.checkedDepartmentId;return(0,x.jsxs)("div",{className:"departments-tree-panel p-4",children:[n.map((function(t){return(0,x.jsx)(bi,{node:t,checkedDepartmentId:i,onChangeDepartment:e.props.onChangeDepartment,listSubDepartments:e.props.listSubDepartments,toggleAddDepartment:e.props.toggleAddDepartment,toggleSetQuotaDialog:e.props.toggleSetQuotaDialog,toggleAddLibrary:e.props.toggleAddLibrary,toggleAddMembers:e.props.toggleAddMembers,toggleRename:e.props.toggleRename,toggleDelete:e.props.toggleDelete},t.id)})),(0,x.jsxs)("button",{className:"btn btn-secondary btn-block text-start border-0 font-weight-normal new-dept-btn shadow-none",onClick:function(){e.props.toggleAddDepartment(null)},children:[(0,x.jsx)("i",{className:"sf3-font sf3-font-new new-dept-btn-icon"}),(0,p.AP)("New Department")]})]})}}])}(l.Component),Si=ji,ki=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).deleteRepo=function(){S.H.sysAdminDeleteRepoInDepartment(n.props.groupID,n.props.repo.repo_id).then((function(e){e.data.success&&(n.props.onRepoChanged(),n.props.toggle())})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.repo,t=(0,p.AP)("Are you sure you want to delete {placeholder} ?");return t=t.replace("{placeholder}",'<span class="op-target">'+f.Aq.HTMLescape(e.name||e.repo_name)+"</span>"),(0,x.jsxs)(u.A,{isOpen:!0,toggle:this.props.toggle,children:[(0,x.jsx)(Ce.A,{toggle:this.props.toggle,children:(0,p.AP)("Delete Library")}),(0,x.jsx)(Ie.A,{children:(0,x.jsx)("div",{dangerouslySetInnerHTML:{__html:t}})}),(0,x.jsxs)(Me.A,{children:[(0,x.jsx)(j.A,{color:"secondary",onClick:this.props.toggle,children:(0,p.AP)("Cancel")}),(0,x.jsx)(j.A,{color:"primary",onClick:this.deleteRepo,children:(0,p.AP)("Delete")})]})]})}}])}(l.Component),Di=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).onMouseEnter=function(){n.props.isItemFreezed||n.setState({highlighted:!0})},n.onMouseLeave=function(){n.props.isItemFreezed||n.setState({highlighted:!1})},n.setMemberStaff=function(e){n.props.setMemberStaff(n.props.member.email,"Admin"===e.value)},n.deleteMember=function(){var e=n.props.member;n.props.deleteMember(e.email)},n.toggleDropdownMenu=function(){n.setState({isItemMenuShow:!n.state.isItemMenuShow},(function(){n.state.isItemMenuShow&&"function"===typeof n.props.freezeItem?n.props.freezeItem():n.state.isItemMenuShow||"function"!==typeof n.props.unfreezeItem||n.props.unfreezeItem()}))},n.toggleItemFreezed=function(e){e?n.props.freezeItem():(n.props.unfreezeItem(),n.setState({highlighted:!1}))},n.toggleDeleteMemberDialog=function(){n.setState({isDeleteMemberDialogOpen:!n.state.isDeleteMemberDialogOpen})},n.state={highlighted:!1,isItemMenuShow:!1},n.roleOptions=[{value:"Admin",text:(0,p.AP)("Admin"),isSelected:!1},{value:"Member",text:(0,p.AP)("Member"),isSelected:!1}],n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.member,t=this.state,n=t.highlighted,i=t.isItemMenuShow,s=t.isDeleteMemberDialogOpen;this.roleOptions=this.roleOptions.map((function(t){return t.isSelected=t.value==e.role,t}));var a=this.roleOptions.filter((function(e){return e.isSelected}))[0];return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("tr",{className:"departments-members-item ".concat(n?"tr-highlight":""),onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[(0,x.jsx)("td",{children:(0,x.jsx)("img",{className:"avatar",src:e.avatar_url,alt:""})}),(0,x.jsx)("td",{className:"text-truncate",children:(0,x.jsx)("a",{href:"".concat(p.Yc,"sys/users/").concat(encodeURIComponent(e.email),"/"),children:e.name})}),(0,x.jsx)("td",{children:(0,x.jsx)($e.A,{isDropdownToggleShown:n,currentSelectedOption:a,options:this.roleOptions,selectOption:this.setMemberStaff,toggleItemFreezed:this.toggleItemFreezed})}),(0,x.jsx)("td",{children:e.contact_email}),(0,x.jsx)("td",{children:n&&(0,x.jsxs)(vi.A,{isOpen:i,toggle:this.toggleDropdownMenu,direction:"down",children:[(0,x.jsx)(xi.A,{tag:"i",role:"button",className:"op-icon sf3-font sf3-font-more",title:(0,p.AP)("More operations"),"aria-label":(0,p.AP)("More operations"),"data-toggle":"dropdown"}),(0,x.jsx)(Ai.A,{children:(0,x.jsx)(yi.A,{onClick:this.toggleDeleteMemberDialog,children:(0,p.AP)("Delete")})})]})})]}),s&&(0,x.jsx)(Ye.A,{title:(0,p.AP)("Delete Member"),message:(0,p.AP)("Are you sure you want to delete {placeholder} ?").replace("{placeholder}",'<span class="op-target">'+f.Aq.HTMLescape(e.name)+"</span>"),executeOperation:this.deleteMember,confirmBtnText:(0,p.AP)("Delete"),toggleDialog:this.toggleDeleteMemberDialog})]})}}])}(l.Component),_i=window.sysadmin.pageOptions.enableSysAdminViewRepo,wi=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).onMouseEnter=function(){n.setState({highlight:!0})},n.onMouseLeave=function(){n.setState({highlight:!1})},n.state={highlight:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.repo,t=e.name||e.repo_name,n=this.state.highlight,i=f.Aq.getLibIconUrl(e);return(0,x.jsxs)("tr",{className:n?"tr-highlight":"",onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[(0,x.jsx)("td",{children:(0,x.jsx)("img",{src:i,width:"24",alt:""})}),(0,x.jsx)("td",{children:_i?(0,x.jsx)("a",{href:"".concat(p.Yc,"sys/libraries/").concat(e.repo_id,"/").concat(encodeURIComponent(t),"/"),children:t}):(0,x.jsx)("span",{children:t})}),(0,x.jsx)("td",{children:f.Aq.bytesToSize(e.size)}),(0,x.jsx)("td",{className:"cursor-pointer text-center",onClick:this.props.showDeleteRepoDialog.bind(this,e),children:(0,x.jsx)("span",{className:"sf3-font-delete1 sf3-font op-icon ".concat(n?"":"vh"),title:(0,p.AP)("Delete")})})]})}}])}(l.Component),Ii=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).showDeleteRepoDialog=function(e){n.setState({showDeleteRepoDialog:!0,deletedRepo:e})},n.toggleCancel=function(){n.setState({showDeleteRepoDialog:!1,deletedRepo:{}})},n.onRepoChanged=function(){n.getRepos(n.props.checkedDepartmentId)},n.freezeItem=function(){n.setState({isItemFreezed:!0})},n.unfreezeItem=function(){n.setState({isItemFreezed:!1})},n.getCurrentDepartment=function(){var e=n.props,t=e.rootNodes,i=e.checkedDepartmentId;if(!t)return{};for(var s={},a=(0,fi.default)(t);!s.id&&a.length>0;){var r=a.shift();r.id===i?s=r:r.children&&r.children.length>0&&a.push.apply(a,(0,fi.default)(r.children))}return s},n.sortByName=function(e){e.preventDefault();var t=n.props.sortOrder;t="asc"===t?"desc":"asc",n.props.sortItems("name",t)},n.sortByRole=function(e){e.preventDefault();var t=n.props.sortOrder;t="asc"===t?"desc":"asc",n.props.sortItems("role",t)},n.changeActiveNav=function(e){n.setState({activeNav:e})},n.getRepos=function(e){n.props.getRepos(e,(function(e){n.setState({repos:e})}))},n.dropdownToggle=function(e){e.stopPropagation(),n.setState({dropdownOpen:!n.state.dropdownOpen})},n.state={isItemFreezed:!1,activeNav:"members",repos:[],deletedRepo:{},showDeleteRepoDialog:!1,dropdownOpen:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){this.getRepos(this.props.checkedDepartmentId)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.checkedDepartmentId===e.checkedDepartmentId&&this.props.isAddNewRepo===e.isAddNewRepo||this.getRepos(e.checkedDepartmentId)}},{key:"render",value:function(){var e=this,t=this.state,n=t.activeNav,i=t.repos,s=this.props,a=s.membersList,r=s.isMembersListLoading,o=s.sortBy,l=s.sortOrder,c="name"===o,d="role"===o,u=(0,x.jsx)("span",{className:"sort-dirent sf3-font sf3-font-down ".concat("asc"===l?"rotate-180":"")}),h=this.getCurrentDepartment();return(0,x.jsxs)("div",{className:"department-content-main d-flex flex-column",children:[(0,x.jsxs)("div",{className:"cur-view-path justify-content-start",children:[(0,x.jsx)("h4",{className:"sf-heading",children:h.name}),(0,x.jsxs)(vi.A,{isOpen:this.state.dropdownOpen,toggle:function(t){return e.dropdownToggle(t)},direction:"down",className:"department-dropdown-menu",children:[(0,x.jsx)(xi.A,{tag:"span",role:"button",className:"sf3-font-down sf3-font ml-1 sf-dropdown-toggle",title:(0,p.AP)("More operations"),"aria-label":(0,p.AP)("More operations"),"data-toggle":"dropdown"}),(0,x.jsx)(Pi,{node:h,toggleAddDepartment:this.props.toggleAddDepartment,toggleSetQuotaDialog:this.props.toggleSetQuotaDialog,toggleAddLibrary:this.props.toggleAddLibrary,toggleAddMembers:this.props.toggleAddMembers,toggleRename:this.props.toggleRename,toggleDelete:this.props.toggleDelete})]})]}),(0,x.jsx)("div",{className:"cur-view-path tab-nav-container",children:(0,x.jsxs)("ul",{className:"nav",children:[(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)("span",{className:"nav-link ".concat("members"===n?"active":""),onClick:function(){return e.changeActiveNav("members")},children:(0,p.AP)("Members")})}),(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)("span",{className:"nav-link ".concat("repos"===n?"active":""),onClick:function(){return e.changeActiveNav("repos")},children:(0,p.AP)("Libraries")})})]})}),"members"===n&&(0,x.jsx)("div",{className:"cur-view-content",children:r?(0,x.jsx)(D.A,{}):0==a.length?(0,x.jsx)(me.A,{text:(0,p.AP)("No members")}):(0,x.jsxs)("div",{className:"w-xs-250",children:[(0,x.jsxs)("table",{children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"10%"}),(0,x.jsxs)("th",{width:"25%",onClick:this.sortByName,children:[(0,p.AP)("Name")," ",c&&u]}),(0,x.jsxs)("th",{width:"25%",onClick:this.sortByRole,children:[(0,p.AP)("Role")," ",d&&u]}),(0,x.jsx)("th",{width:"30%",children:(0,p.AP)("Contact email")}),(0,x.jsx)("th",{width:"10%"})]})}),(0,x.jsx)("tbody",{children:a.map((function(t,n){return(0,x.jsx)(Di,{member:t,deleteMember:e.props.deleteMember,setMemberStaff:e.props.setMemberStaff,unfreezeItem:e.unfreezeItem,freezeItem:e.freezeItem,isItemFreezed:e.state.isItemFreezed},n)}))})]}),this.props.currentPageInfo&&(0,x.jsx)(X.A,{gotoPreviousPage:this.props.getPreviousPageList,gotoNextPage:this.props.getNextPageList,currentPage:this.props.currentPageInfo.current_page,hasNextPage:this.props.currentPageInfo.has_next_page,curPerPage:this.props.perPage,resetPerPage:this.props.resetPerPage,noURLUpdate:!0})]})}),"repos"===n&&(0,x.jsx)("div",{className:"cur-view-content",children:0==i.length?(0,x.jsx)(me.A,{text:(0,p.AP)("No libraries")}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("table",{children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"5%"}),(0,x.jsx)("th",{width:"50%",children:(0,p.AP)("Name")}),(0,x.jsx)("th",{width:"30%",children:(0,p.AP)("Size")}),(0,x.jsx)("th",{width:"15%"})]})}),(0,x.jsx)("tbody",{children:i.map((function(t,n){return(0,x.jsx)(wi,{repo:t,showDeleteRepoDialog:e.showDeleteRepoDialog},n)}))})]}),this.state.showDeleteRepoDialog&&(0,x.jsx)(en.A,{children:(0,x.jsx)(ki,{toggle:this.toggleCancel,onRepoChanged:this.onRepoChanged,repo:this.state.deletedRepo,groupID:this.props.checkedDepartmentId})})]})})]})}}])}(l.Component),Ni=Ii,Mi=(n(2201),function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).onChangeDepartment=function(e){n.setState({checkedDepartmentId:e},n.loadDepartmentMembers(e))},n.loadDepartmentMembers=function(e){if(-1!==e){n.setState({isMembersListLoading:!0});var t=n.state,i=t.currentPage,s=t.perPage;S.H.sysAdminListGroupMembers(e,i,s).then((function(e){var t=e.data,i=t.members,s=t.page_info;n.setState({membersList:i,currentPageInfo:s,isMembersListLoading:!1})})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))}else n.setState({isMembersListLoading:!1,membersList:[]})},n.getPreviousPageList=function(){var e=n.state,t=e.checkedDepartmentId,i=e.currentPageInfo.current_page;n.setState({currentPage:i-1},(function(){n.loadDepartmentMembers(t)}))},n.getNextPageList=function(){var e=n.state,t=e.checkedDepartmentId,i=e.currentPageInfo.current_page;n.setState({currentPage:i+1},(function(){n.loadDepartmentMembers(t)}))},n.resetPerPage=function(e){n.setState({perPage:e,currentPage:1},(function(){var e=n.state.checkedDepartmentId;n.loadDepartmentMembers(e)}))},n.listSubDepartments=function(e,t){var i=n.state.rootNodes,s=null;i.forEach((function(t){s||(s=t.findNodeById(e))})),s&&S.H.sysAdminGetDepartmentInfo(e).then((function(e){var n=e.data.groups.map((function(e){return new mi({id:e.id,name:e.name,parentGroupId:e.parent_group_id,orgId:e.org_id,parentNode:s,quota:e.quota})}));s.setChildren(n),t&&t(n)})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.getRepos=function(e,t){S.H.sysAdminListGroupRepos(e).then((function(e){t&&t(e.data.libraries)})).catch((function(e){if(e.response&&404===e.response.status)t&&t(null);else{var n=f.Aq.getErrorMsg(e);k.A.danger(n)}}))},n.toggleAddLibrary=function(e){n.setState({operateNode:e,isShowAddRepoDialog:!n.state.isShowAddRepoDialog})},n.toggleAddDepartment=function(e){n.setState({operateNode:e,isAddDepartmentDialogShow:!n.state.isAddDepartmentDialogShow})},n.toggleSetQuotaDialog=function(e){n.setState({operateNode:e,isSetQuotaDialogShow:!n.state.isSetQuotaDialogShow})},n.toggleAddMembers=function(e){n.setState({operateNode:e,isAddMembersDialogShow:!n.state.isAddMembersDialogShow})},n.toggleRename=function(e){n.setState({operateNode:e,isRenameDepartmentDialogShow:!n.state.isRenameDepartmentDialogShow})},n.toggleDelete=function(e){n.setState({operateNode:e,isDeleteDepartmentDialogShow:!n.state.isDeleteDepartmentDialogShow})},n.addDepartment=function(e,t){e.addChildren([new mi({id:t.id,name:t.name,parentNode:e,orgId:t.org_id})])},n.setRootNode=function(e){var t=new mi({id:e.id,name:e.name,orgId:e.org_id}),i=n.state.rootNodes.slice(0);i.push(t),n.setState({rootNodes:i,checkedDepartmentId:t.id}),n.loadDepartmentMembers(t.id)},n.renameDepartment=function(e,t){e.id=t.id,e.name=t.name},n.onDelete=function(){var e=n.state,t=e.operateNode,i=e.checkedDepartmentId;S.H.sysAdminDeleteDepartment(t.id).then((function(){if(n.toggleDelete(),t.parentNode)t.parentNode.deleteChildById(t.id),t.id===i&&-1!==t.parentNode.id&&n.onChangeDepartment(t.parentNode.id);else{var e=n.state.rootNodes.slice(0),s=e.findIndex((function(e){return e.id===t.id}));e.splice(s,1),0===e.length?n.setState({rootNodes:e,checkedDepartmentId:-1}):(n.setState({rootNodes:e,checkedDepartmentId:e[0].id}),n.loadDepartmentMembers(e[0].id))}})).catch((function(e){if(e.response&&400===e.response.status)k.A.danger(e.response.data.error_msg);else{var t=f.Aq.getErrorMsg(e);k.A.danger(t)}}))},n.onMemberChanged=function(){var e=n.state,t=e.checkedDepartmentId,i=e.operateNode;t&&i&&t!==i.id||n.loadDepartmentMembers(i.id)},n.setMemberStaff=function(e,t){var i=n.state,s=i.checkedDepartmentId,a=i.membersList;S.H.sysAdminUpdateGroupMemberRole(s,e,t).then((function(t){var i=t.data,s=a.map((function(t){return t.email===e?i:t}));n.setState({membersList:s})})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.deleteMember=function(e){var t=n.state,i=t.checkedDepartmentId,s=t.membersList;S.H.sysAdminDeleteGroupMember(i,e).then((function(){var t=s.filter((function(t){return t.email!==e}));n.setState({membersList:t})})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.sortMembers=function(e,t,n){var i;switch("".concat(t,"-").concat(n)){case"name-asc":i=function(e,t){return f.Aq.compareTwoWord(e.name,t.name)};break;case"name-desc":i=function(e,t){return-f.Aq.compareTwoWord(e.name,t.name)};break;case"role-asc":i=function(e,t){return"Admin"==e.role?-1:1};break;case"role-desc":i=function(e,t){return"Admin"==e.role?1:-1}}return e.sort((function(e,t){return i(e,t)})),e},n.sortItems=function(e,t){n.setState({sortBy:e,sortOrder:t,membersList:n.sortMembers(n.state.membersList,e,t)})},n.onSetQuota=function(e){var t=n.state.rootNodes.slice(0);n._setQuota(t[0],e),n.setState({rootNodes:t})},n._setQuota=function(e,t){e.id===t.id?e.quota=t.quota:e.children.forEach((function(e){n._setQuota(e,t)}))},n.state={rootNodes:[],checkedDepartmentId:-1,operateNode:null,isSetQuotaDialogShow:!1,isAddDepartmentDialogShow:!1,isAddMembersDialogShow:!1,isRenameDepartmentDialogShow:!1,isDeleteDepartmentDialogShow:!1,isShowAddRepoDialog:!1,membersList:[],isTopDepartmentLoading:!1,isMembersListLoading:!1,sortBy:"name",sortOrder:"asc",currentPageInfo:null,currentPage:1,perPage:100},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({isTopDepartmentLoading:!0},(function(){S.H.sysAdminListAllDepartments().then((function(t){var n=t.data.data;if(n&&n.length>0){var i=n.map((function(e){return new mi({id:e.id,name:e.name,orgId:e.org_id,quota:e.quota})}));e.setState({rootNodes:i,checkedDepartmentId:i[0].id}),e.loadDepartmentMembers(i[0].id)}e.setState({isTopDepartmentLoading:!1})}))}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.rootNodes,s=t.operateNode,a=t.checkedDepartmentId,r=t.isAddDepartmentDialogShow,o=t.isAddMembersDialogShow,c=t.membersList,d=t.isMembersListLoading,u=t.isTopDepartmentLoading,h=t.isRenameDepartmentDialogShow,g=t.isDeleteDepartmentDialogShow,f=t.sortBy,m=t.sortOrder;return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsx)("div",{className:"main-panel-center",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)("div",{className:"cur-view-path",children:(0,x.jsx)("h3",{className:"sf-heading",children:(0,p.AP)("Departments")})}),(0,x.jsxs)("div",{className:"cur-view-content d-flex flex-row p-0",children:[u&&(0,x.jsx)(D.A,{}),!u&&n.length>0&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(Si,{rootNodes:n,checkedDepartmentId:a,onChangeDepartment:this.onChangeDepartment,listSubDepartments:this.listSubDepartments,toggleAddDepartment:this.toggleAddDepartment,toggleSetQuotaDialog:this.toggleSetQuotaDialog,toggleAddLibrary:this.toggleAddLibrary,toggleAddMembers:this.toggleAddMembers,toggleRename:this.toggleRename,toggleDelete:this.toggleDelete}),(0,x.jsx)(Ni,{rootNodes:n,checkedDepartmentId:a,membersList:c,isMembersListLoading:d,isAddNewRepo:this.state.isAddNewRepo,setMemberStaff:this.setMemberStaff,deleteMember:this.deleteMember,sortItems:this.sortItems,sortBy:f,sortOrder:m,getRepos:this.getRepos,deleteGroup:this.deleteGroup,createGroup:this.createGroup,toggleAddDepartment:this.toggleAddDepartment,toggleSetQuotaDialog:this.toggleSetQuotaDialog,toggleAddLibrary:this.toggleAddLibrary,toggleAddMembers:this.toggleAddMembers,toggleRename:this.toggleRename,toggleDelete:this.toggleDelete,getPreviousPageList:this.getPreviousPageList,getNextPageList:this.getNextPageList,resetPerPage:this.resetPerPage,currentPageInfo:this.state.currentPageInfo,perPage:this.state.perPage})]}),!u&&0===n.length&&(0,x.jsx)("div",{className:"top-department-button-container h-100 w-100",children:(0,x.jsx)(j.A,{onClick:this.toggleAddDepartment.bind(this,null),children:(0,p.AP)("Enable departments feature")})})]})]})}),o&&(0,x.jsx)(ui.A,{toggle:this.toggleAddMembers,nodeId:s.id,onMemberChanged:this.onMemberChanged}),h&&(0,x.jsx)(hi.A,{node:s,toggle:this.toggleRename,renameDepartment:this.renameDepartment}),g&&(0,x.jsx)(gi.A,{node:s,toggle:this.toggleDelete,onDelete:this.onDelete}),r&&(0,x.jsx)(di.A,{parentNode:s,toggle:this.toggleAddDepartment,addDepartment:this.addDepartment,setRootNode:this.setRootNode}),this.state.isShowAddRepoDialog&&(0,x.jsx)(pi,{toggle:this.toggleAddLibrary,onAddNewRepo:function(){e.setState({isAddNewRepo:!e.state.isAddNewRepo})},groupID:String(s.id)}),this.state.isSetQuotaDialogShow&&(0,x.jsx)(ci,{group:s,onSetQuota:this.onSetQuota,toggle:this.toggleSetQuotaDialog})]})}}])}(l.Component)),Ci=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).navItems=[{name:"shareLinks",urlPart:"share-links",text:(0,p.AP)("Share Links")},{name:"uploadLinks",urlPart:"upload-links",text:(0,p.AP)("Upload Links")}],n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.currentItem;return(0,x.jsx)("div",{className:"cur-view-path tab-nav-container",children:(0,x.jsx)("ul",{className:"nav",children:this.navItems.map((function(t,n){return(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(h.N_,{to:"".concat(p.Yc,"sys/").concat(t.urlPart,"/"),className:"nav-link".concat(e==t.name?" active":""),children:t.text})},n)}))})})}}])}(l.Component),Li=Ci;M().extend(ge());var Oi=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).getPreviousPage=function(){n.props.getShareLinksByPage(n.props.currentPage-1)},n.getNextPage=function(){n.props.getShareLinksByPage(n.props.currentPage+1)},n.sortByTime=function(e){e.preventDefault(),n.props.sortItems("ctime")},n.sortByCount=function(e){e.preventDefault(),n.props.sortItems("view_cnt")},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,i=t.errorMsg,s=t.items,a=t.perPage,r=t.currentPage,o=t.hasNextPage,c=t.sortBy,d=t.sortOrder;if(n)return(0,x.jsx)(D.A,{});if(i)return(0,x.jsx)("p",{className:"error text-center",children:i});var u=(0,x.jsx)(me.A,{text:(0,p.AP)("No share links")}),h=(0,x.jsx)("span",{className:"sf3-font sf3-font-sort3"}),g=(0,x.jsx)("span",{className:"sf3-font ".concat("asc"==d?"sf3-font-down rotate-180 d-inline-block":"sf3-font-down")}),f=(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("table",{className:"table-hover",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"18%",children:(0,p.AP)("Name")}),(0,x.jsx)("th",{width:"18%",children:(0,p.AP)("Token")}),(0,x.jsx)("th",{width:"18%",children:(0,p.AP)("Owner")}),(0,x.jsx)("th",{width:"15%",children:(0,x.jsxs)("a",{className:"d-inline-block table-sort-op",href:"#",onClick:this.sortByTime,children:[(0,p.AP)("Created At")," ","ctime"==c?g:h]})}),(0,x.jsx)("th",{width:"10%",children:(0,x.jsxs)("a",{className:"d-inline-block table-sort-op",href:"#",onClick:this.sortByCount,children:[(0,p.AP)("Visit count")," ","view_cnt"==c?g:h]})}),(0,x.jsx)("th",{width:"11%",children:(0,p.AP)("Expiration")}),(0,x.jsx)("th",{width:"10%"})]})}),s&&(0,x.jsx)("tbody",{children:s.map((function(t,n){return(0,x.jsx)(Ti,{item:t,deleteShareLink:e.props.deleteShareLink},n)}))})]}),(0,x.jsx)(X.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:r,hasNextPage:o,curPerPage:a,resetPerPage:this.props.resetPerPage})]});return s.length?f:u}}])}(l.Component),Ti=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleMouseOver=function(){n.setState({isHighlighted:!0,isOpIconShown:!0})},n.handleMouseOut=function(){n.setState({isHighlighted:!1,isOpIconShown:!1})},n.deleteShareLink=function(){n.props.deleteShareLink(n.props.item.token)},n.renderExpiration=function(){var e=n.props.item;if(!e.expire_date)return"--";var t=M()(e.expire_date).format("YYYY-MM-DD"),i=M()(e.expire_date).format("YYYY-MM-DD HH:mm:ss");return(0,x.jsx)("span",{className:e.is_expired?"error":"",title:i,children:t})},n.state={isHighlighted:!1,isOpIconShown:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.state,t=e.isOpIconShown,n=e.isHighlighted,i=this.props.item;return(0,x.jsxs)("tr",{className:fe()({"tr-highlight":n}),onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,children:[(0,x.jsx)("td",{children:i.obj_name}),(0,x.jsx)("td",{children:i.token}),(0,x.jsx)("td",{children:(0,x.jsx)(Se,{email:i.creator_email,name:i.creator_name})}),(0,x.jsx)("td",{children:M()(i.ctime).fromNow()}),(0,x.jsx)("td",{children:i.view_cnt}),(0,x.jsx)("td",{children:this.renderExpiration()}),(0,x.jsx)("td",{children:(0,x.jsx)("i",{className:"op-icon sf3-font-delete1 sf3-font ".concat(t?"":"invisible"),title:(0,p.AP)("Remove"),onClick:this.deleteShareLink})})]})}}])}(l.Component),Ri=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).getShareLinksByPage=function(e){var t=n.state,i=t.perPage,s=t.sortBy,a=t.sortOrder;S.H.sysAdminListShareLinks(e,i,s,a).then((function(t){n.setState({shareLinkList:t.data.share_link_list,loading:!1,currentPage:e,hasNextPage:f.Aq.hasNextPage(e,i,t.data.count)})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.sortItems=function(e){n.setState({currentPage:1,sortBy:e,sortOrder:"asc"==n.state.sortOrder?"desc":"asc"},(function(){var e=new URL(location.href),t=new URLSearchParams(e.search),i=n.state,s=i.currentPage,a=i.sortBy,r=i.sortOrder;t.set("page",s),t.set("order_by",a),t.set("direction",r),e.search=t.toString(),(0,h.oo)(e.toString()),n.getShareLinksByPage(s)}))},n.deleteShareLink=function(e){S.H.sysAdminDeleteShareLink(e).then((function(t){var i=n.state.shareLinkList.filter((function(t){return t.token!=e}));n.setState({shareLinkList:i})})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){return n.getShareLinksByPage(n.initPage)}))},n.state={loading:!0,errorMsg:"",shareLinkList:[],perPage:100,currentPage:1,hasNextPage:!1,sortBy:"",sortOrder:"asc"},n.initPage=1,n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,i=n.currentPage,s=n.perPage,a=n.sortBy,r=n.sortOrder;this.setState({perPage:parseInt(t.get("per_page")||s),currentPage:parseInt(t.get("page")||i),sortBy:t.get("order_by")||a,sortOrder:t.get("direction")||r},(function(){e.getShareLinksByPage(e.state.currentPage)}))}},{key:"render",value:function(){var e=this.state,t=e.shareLinkList,n=e.currentPage,s=e.perPage,a=e.hasNextPage;return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(Li,{currentItem:"shareLinks"}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsx)(Oi,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:t,currentPage:n,perPage:s,hasNextPage:a,getShareLinksByPage:this.getShareLinksByPage,resetPerPage:this.resetPerPage,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems,deleteShareLink:this.deleteShareLink})})]})})]})}}])}(l.Component);M().extend(ge());var Ui=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).getPreviousPage=function(){n.props.getUploadLinksByPage(n.props.currentPage-1)},n.getNextPage=function(){n.props.getUploadLinksByPage(n.props.currentPage+1)},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,i=t.errorMsg,s=t.items,a=t.perPage,r=t.currentPage,o=t.hasNextPage;if(n)return(0,x.jsx)(D.A,{});if(i)return(0,x.jsx)("p",{className:"error text-center",children:i});var c=(0,x.jsx)(me.A,{text:(0,p.AP)("No upload links")}),d=(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("table",{className:"table-hover",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"18%",children:(0,p.AP)("Name")}),(0,x.jsx)("th",{width:"18%",children:(0,p.AP)("Token")}),(0,x.jsx)("th",{width:"18%",children:(0,p.AP)("Owner")}),(0,x.jsx)("th",{width:"15%",children:(0,p.AP)("Created At")}),(0,x.jsx)("th",{width:"10%",children:(0,p.AP)("Visit count")}),(0,x.jsx)("th",{width:"11%",children:(0,p.AP)("Expiration")}),(0,x.jsx)("th",{width:"10%"})]})}),s&&(0,x.jsx)("tbody",{children:s.map((function(t,n){return(0,x.jsx)(Fi,{item:t,deleteUploadLink:e.props.deleteUploadLink},n)}))})]}),(0,x.jsx)(X.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:r,hasNextPage:o,curPerPage:a,resetPerPage:this.props.resetPerPage})]});return s.length?d:c}}])}(l.Component),Fi=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleMouseOver=function(){n.setState({isHighlighted:!0,isOpIconShown:!0})},n.handleMouseOut=function(){n.setState({isHighlighted:!1,isOpIconShown:!1})},n.deleteUploadLink=function(){n.props.deleteUploadLink(n.props.item.token)},n.renderExpiration=function(){var e=n.props.item;if(!e.expire_date)return"--";var t=M()(e.expire_date).format("YYYY-MM-DD"),i=M()(e.expire_date).format("YYYY-MM-DD HH:mm:ss");return(0,x.jsx)("span",{className:e.is_expired?"error":"",title:i,children:t})},n.state={isHighlighted:!1,isOpIconShown:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.state,t=e.isOpIconShown,n=e.isHighlighted,i=this.props.item;return(0,x.jsx)(l.Fragment,{children:(0,x.jsxs)("tr",{className:fe()({"tr-highlight":n}),onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,children:[(0,x.jsx)("td",{children:i.path}),(0,x.jsx)("td",{children:i.token}),(0,x.jsx)("td",{children:(0,x.jsx)(Se,{email:i.creator_email,name:i.creator_name})}),(0,x.jsx)("td",{children:M()(i.ctime).fromNow()}),(0,x.jsx)("td",{children:i.view_cnt}),(0,x.jsx)("td",{children:this.renderExpiration()}),(0,x.jsx)("td",{children:(0,x.jsx)("i",{className:"op-icon sf3-font-delete1 sf3-font ".concat(t?"":"invisible"),title:(0,p.AP)("Remove"),onClick:this.deleteUploadLink})})]})})}}])}(l.Component),Ei=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).getUploadLinksByPage=function(e){var t=n.state.perPage;S.H.sysAdminListAllUploadLinks(e,t).then((function(i){n.setState({uploadLinkList:i.data.upload_link_list,loading:!1,currentPage:e,hasNextPage:f.Aq.hasNextPage(e,t,i.data.count)})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.deleteUploadLink=function(e){S.H.sysAdminDeleteUploadLink(e).then((function(t){var i=n.state.uploadLinkList.filter((function(t){return t.token!=e}));n.setState({uploadLinkList:i})})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){return n.getUploadLinksByPage(n.initPage)}))},n.state={loading:!0,errorMsg:"",uploadLinkList:[],perPage:100,currentPage:1,hasNextPage:!1},n.initPage=1,n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,i=n.currentPage,s=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||s),currentPage:parseInt(t.get("page")||i)},(function(){e.getUploadLinksByPage(e.state.currentPage)}))}},{key:"render",value:function(){var e=this.state,t=e.uploadLinkList,n=e.currentPage,s=e.perPage,a=e.hasNextPage;return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(Li,{currentItem:"uploadLinks"}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsx)(Ui,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:t,currentPage:n,perPage:s,hasNextPage:a,getUploadLinksByPage:this.getUploadLinksByPage,resetPerPage:this.resetPerPage,deleteUploadLink:this.deleteUploadLink})})]})})]})}}])}(l.Component),zi=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).checkSubmitBtnActive=function(){var e=n.state,t=e.name,i=e.email,s=e.password,a=e.passwordAgain,r=!0;r=""!=t.trim()&&""!=i.trim()&&""!=s.trim()&&""!=a.trim(),n.setState({isSubmitBtnActive:r})},n.toggle=function(){n.props.toggleDialog()},n.inputPassword=function(e){var t=e.target.value;n.setState({password:t},n.checkSubmitBtnActive)},n.inputPasswordAgain=function(e){var t=e.target.value;n.setState({passwordAgain:t},n.checkSubmitBtnActive)},n.inputEmail=function(e){var t=e.target.value;n.setState({email:t},n.checkSubmitBtnActive)},n.inputName=function(e){var t=e.target.value;n.setState({name:t},n.checkSubmitBtnActive)},n.handleSubmit=function(){var e=n.state,t=e.name,i=e.email,s=e.password;if(s==e.passwordAgain){var a={orgName:t.trim(),ownerEmail:i.trim(),password:s.trim()};n.props.addOrg(a),n.toggle()}else n.setState({errorMsg:(0,p.AP)("Passwords do not match.")})},n.state={name:"",email:"",password:"",passwordAgain:"",errorMsg:"",isSubmitBtnActive:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.state,t=e.errorMsg,n=e.password,i=e.passwordAgain,s=e.email,a=e.name,r=e.isSubmitBtnActive;return(0,x.jsxs)(u.A,{isOpen:!0,toggle:this.toggle,children:[(0,x.jsx)(Ce.A,{toggle:this.toggle,children:(0,p.AP)("Add Organization")}),(0,x.jsxs)(Ie.A,{children:[(0,x.jsxs)(Oe.A,{autoComplete:"off",children:[(0,x.jsxs)(Te.A,{children:[(0,x.jsx)(Re.A,{children:(0,p.AP)("Name")}),(0,x.jsx)(W.A,{value:a,onChange:this.inputName})]}),(0,x.jsxs)(Te.A,{children:[(0,x.jsxs)(Re.A,{children:[(0,p.AP)("Owner"),(0,x.jsx)("span",{className:"small text-secondary ml-1 sf3-font sf3-font-tips",title:(0,p.AP)("Owner can use admin panel in an organization, must be a new account.")})]}),(0,x.jsx)(W.A,{value:s,onChange:this.inputEmail})]}),(0,x.jsxs)(Te.A,{children:[(0,x.jsx)(Re.A,{children:(0,p.AP)("Password")}),(0,x.jsx)(W.A,{type:"password",value:n,onChange:this.inputPassword})]}),(0,x.jsxs)(Te.A,{children:[(0,x.jsx)(Re.A,{children:(0,p.AP)("Password again")}),(0,x.jsx)(W.A,{type:"password",value:i,onChange:this.inputPasswordAgain})]})]}),t&&(0,x.jsx)(Ne.A,{color:"danger",children:t})]}),(0,x.jsxs)(Me.A,{children:[(0,x.jsx)(j.A,{color:"secondary",onClick:this.toggle,children:(0,p.AP)("Cancel")}),(0,x.jsx)(j.A,{color:"primary",onClick:this.handleSubmit,disabled:!r,children:(0,p.AP)("Submit")})]})]})}}])}(l.Component),Bi=window.sysadmin.pageOptions.availableRoles,Hi=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).toggleItemFreezed=function(e){n.setState({isItemFreezed:e})},n.getPreviousPage=function(){n.props.getListByPage(n.props.currentPage-1)},n.getNextPage=function(){n.props.getListByPage(n.props.currentPage+1)},n.state={isItemFreezed:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,i=t.errorMsg,s=t.items,a="".concat((0,p.AP)("Created At")," / ").concat((0,p.AP)("Last Access"));if(n)return(0,x.jsx)(D.A,{});if(i)return(0,x.jsx)("p",{className:"error text-center mt-4",children:i});var r=(0,x.jsx)(me.A,{text:(0,p.AP)("No organizations")}),o=(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("table",{children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"15%",children:(0,p.AP)("Name")}),(0,x.jsx)("th",{width:"15%",children:(0,p.AP)("Creator")}),(0,x.jsx)("th",{width:"10%",children:(0,p.AP)("Status")}),(0,x.jsx)("th",{width:"20%",children:(0,p.AP)("Role")}),(0,x.jsx)("th",{width:"15%",children:(0,p.AP)("Space Used")}),(0,x.jsx)("th",{width:"20%",children:a}),(0,x.jsx)("th",{width:"5%"})]})}),(0,x.jsx)("tbody",{children:s.map((function(t,n){return(0,x.jsx)(qi,{item:t,updateRole:e.props.updateRole,updateStatus:e.props.updateStatus,deleteOrg:e.props.deleteOrg,isItemFreezed:e.state.isItemFreezed,toggleItemFreezed:e.toggleItemFreezed},n)}))})]}),this.props.currentPage&&(0,x.jsx)(X.A,{currentPage:this.props.currentPage,hasNextPage:this.props.hasNextPage,curPerPage:this.props.curPerPage,resetPerPage:this.props.resetPerPage,gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage})]});return s.length?o:r}}])}(l.Component),qi=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleMouseEnter=function(){n.props.isItemFreezed||n.setState({highlighted:!0})},n.handleMouseLeave=function(){n.props.isItemFreezed||n.setState({highlighted:!1})},n.toggleDeleteDialog=function(e){e&&e.preventDefault(),n.setState({isDeleteDialogOpen:!n.state.isDeleteDialogOpen},(function(){n.state.isDeleteDialogOpen&&S.H.sysAdminGetOrg(n.props.item.org_id).then((function(e){var t='<span class="op-target">'+f.Aq.HTMLescape(e.data.org_name)+"</span>",i='<span class="op-target">'+f.Aq.HTMLescape(e.data.users_count)+"</span>",s='<span class="op-target">'+f.Aq.HTMLescape(e.data.repos_count)+"</span>",a=(0,p.AP)("Are you sure you want to delete {placeholder} ?").replace("{placeholder}",t)+"<br/>"+(0,p.AP)("{userCount} user(s) and {repoCount} libraries of this organization will also be deleted.").replace("{userCount}",i).replace("{repoCount}",s);n.setState({deleteDialogMsg:a})})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))}))},n.toggleConfirmInactiveDialog=function(){n.setState({isConfirmInactiveDialogOpen:!n.state.isConfirmInactiveDialogOpen})},n.translateStatus=function(e){switch(e){case"active":return(0,p.AP)("Active");case"inactive":return(0,p.AP)("Inactive")}},n.updateStatus=function(e){var t="active"==e.value;t&&k.A.notify((0,p.AP)("It may take some time, please wait.")),n.props.updateStatus(n.props.item.org_id,t)},n.setOrgInactive=function(){n.props.updateStatus(n.props.item.org_id,!1)},n.translateRole=function(e){switch(e){case"default":return(0,p.AP)("Default");case"guest":return(0,p.AP)("Guest");default:return e}},n.updateRole=function(e){n.props.updateRole(n.props.item.org_id,e.value)},n.deleteOrg=function(){k.A.notify((0,p.AP)("It may take some time, please wait.")),n.props.deleteOrg(n.props.item.org_id)},n.state={highlighted:!1,isDeleteDialogOpen:!1,deleteDialogMsg:"",isConfirmInactiveDialogOpen:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this,t=this.props.item,n=this.state,i=n.highlighted,s=n.isDeleteDialogOpen,a=n.deleteDialogMsg,r=n.isConfirmInactiveDialogOpen,o=t.role;this.roleOptions=Bi.map((function(t){return{value:t,text:e.translateRole(t),isSelected:t==o}}));var c=this.roleOptions.filter((function(e){return e.isSelected}))[0],d=t.is_active?"active":"inactive";this.statusOptions=["active","inactive"].map((function(t){return{value:t,text:e.translateStatus(t),isSelected:t==d}}));var u=this.statusOptions.filter((function(e){return e.isSelected}))[0],g=(0,p.AP)("Are you sure you want to set {user_placeholder} inactive?").replace("{user_placeholder}",f.Aq.HTMLescape(t.org_name));return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("tr",{className:i?"tr-highlight":"",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,x.jsx)("td",{children:(0,x.jsx)(h.N_,{to:"".concat(p.Yc,"sys/organizations/").concat(t.org_id,"/info/"),children:t.org_name})}),(0,x.jsx)("td",{children:(0,x.jsx)(Se,{email:t.creator_email,name:t.creator_name})}),(0,x.jsx)("td",{children:(0,x.jsx)($e.A,{isDropdownToggleShown:i,currentSelectedOption:u,options:this.statusOptions,selectOption:this.updateStatus,toggleItemFreezed:this.props.toggleItemFreezed,operationBeforeSelect:t.is_active?this.toggleConfirmInactiveDialog:void 0})}),(0,x.jsx)("td",{children:(0,x.jsx)($e.A,{isDropdownToggleShown:i,currentSelectedOption:c,options:this.roleOptions,selectOption:this.updateRole,toggleItemFreezed:this.props.toggleItemFreezed})}),(0,x.jsx)("td",{children:"".concat(f.Aq.bytesToSize(t.quota_usage)," / ").concat(t.quota>0?f.Aq.bytesToSize(t.quota):"--")}),(0,x.jsxs)("td",{children:["".concat(M()(t.ctime).format("YYYY-MM-DD HH:mm:ss")," /"),(0,x.jsx)("br",{}),"".concat(t.last_activity_time?M()(t.last_activity_time).fromNow():"--"," ")]}),(0,x.jsx)("td",{children:(0,x.jsx)("i",{className:"op-icon sf3-font-delete1 sf3-font ".concat(i?"":"invisible"),title:(0,p.AP)("Delete"),onClick:this.toggleDeleteDialog})})]}),s&&(0,x.jsx)(Ye.A,{title:(0,p.AP)("Delete Organization"),message:a,executeOperation:this.deleteOrg,confirmBtnText:(0,p.AP)("Delete"),toggleDialog:this.toggleDeleteDialog}),r&&(0,x.jsx)(Ye.A,{title:(0,p.AP)("Set organization inactive"),message:g,executeOperation:this.setOrgInactive,confirmBtnText:(0,p.AP)("Set"),toggleDialog:this.toggleConfirmInactiveDialog})]})}}])}(l.Component),Yi=Hi,Vi=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).getItemsByPage=function(e){var t=n.state.perPage;S.H.sysAdminListOrgs(e,t).then((function(i){n.setState({loading:!1,orgList:i.data.organizations,currentPage:e,hasNextPage:f.Aq.hasNextPage(e,t,i.data.total_count)})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){n.getItemsByPage(1)}))},n.toggleAddOrgDialog=function(){n.setState({isAddOrgDialogOpen:!n.state.isAddOrgDialogOpen})},n.updateStatus=function(e,t){var i={};i.isActive=t,S.H.sysAdminUpdateOrg(e,i).then((function(i){var s=n.state.orgList.map((function(n){return n.org_id==e&&(n.is_active=t),n}));n.setState({orgList:s}),k.A.success((0,p.AP)("Edit succeeded"))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.updateRole=function(e,t){var i={};i.role=t,S.H.sysAdminUpdateOrg(e,i).then((function(i){var s=n.state.orgList.map((function(n){return n.org_id==e&&(n.role=t),n}));n.setState({orgList:s}),k.A.success((0,p.AP)("Edit succeeded"))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.addOrg=function(e){var t=e.orgName,i=e.ownerEmail,s=e.password;S.H.sysAdminAddOrg(t,i,s).then((function(e){var t=n.state.orgList;t.unshift(e.data),n.setState({orgList:t})})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.deleteOrg=function(e){S.H.sysAdminDeleteOrg(e).then((function(t){var i=n.state.orgList.filter((function(t){return t.org_id!=e}));n.setState({orgList:i}),k.A.success((0,p.AP)("Successfully deleted 1 item."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.getSearch=function(){return(0,x.jsx)(We.A,{placeholder:(0,p.AP)("Search organizations"),submit:n.searchItems})},n.searchItems=function(e){(0,h.oo)("".concat(p.Yc,"sys/search-organizations/?query=").concat(encodeURIComponent(e)))},n.state={loading:!0,errorMsg:"",orgList:[],currentPage:1,perPage:100,hasNextPage:!1,isAddOrgDialogOpen:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,i=n.currentPage,s=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||s),currentPage:parseInt(t.get("page")||i)},(function(){e.getItemsByPage(e.state.currentPage)}))}},{key:"render",value:function(){var e=this.state.isAddOrgDialogOpen;return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)((0,i.default)({search:this.getSearch()},this.props),{},{children:(0,x.jsx)(j.A,{className:"btn btn-secondary operation-item",onClick:this.toggleAddOrgDialog,children:(0,p.AP)("Add Organization")})})),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)("div",{className:"cur-view-path",children:(0,x.jsx)("h3",{className:"sf-heading",children:(0,p.AP)("Organizations")})}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsx)(Yi,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.orgList,currentPage:this.state.currentPage,hasNextPage:this.state.hasNextPage,curPerPage:this.state.perPage,resetPerPage:this.resetPerPage,getListByPage:this.getItemsByPage,updateRole:this.updateRole,updateStatus:this.updateStatus,deleteOrg:this.deleteOrg})})]})}),e&&(0,x.jsx)(zi,{addOrg:this.addOrg,toggleDialog:this.toggleAddOrgDialog})]})}}])}(l.Component),Gi=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).getItems=function(){S.H.sysAdminSearchOrgs(n.state.query.trim()).then((function(e){n.setState({loading:!1,orgList:e.data.organization_list})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.updateRole=function(e,t){var i={};i.role=t,S.H.sysAdminUpdateOrg(e,i).then((function(i){var s=n.state.orgList.map((function(n){return n.org_id==e&&(n.role=t),n}));n.setState({orgList:s}),k.A.success((0,p.AP)("Edit succeeded"))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.deleteOrg=function(e){S.H.sysAdminDeleteOrg(e).then((function(t){var i=n.state.orgList.filter((function(t){return t.org_id!=e}));n.setState({orgList:i}),k.A.success((0,p.AP)("Successfully deleted 1 item."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.handleInputChange=function(e){n.setState({query:e.target.value},n.checkSubmitBtnActive)},n.checkSubmitBtnActive=function(){var e=n.state.query;n.setState({isSubmitBtnActive:e.trim()})},n.handleKeyDown=function(e){13===e.keyCode&&(n.state.isSubmitBtnActive&&n.getItems())},n.state={query:"",isSubmitBtnActive:!1,loading:!0,errorMsg:"",orgList:[]},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=new URL(document.location).searchParams;this.setState({query:e.get("query")||""},this.getItems)}},{key:"render",value:function(){var e=this.state,t=e.query,n=e.isSubmitBtnActive;return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)("div",{className:"cur-view-path",children:(0,x.jsx)("h3",{className:"sf-heading",children:(0,p.AP)("Organizations")})}),(0,x.jsxs)("div",{className:"cur-view-content",children:[(0,x.jsxs)("div",{className:"mt-4 mb-6",children:[(0,x.jsx)("h4",{className:"border-bottom font-weight-normal mb-2 pb-1",children:(0,p.AP)("Search Organizations")}),(0,x.jsx)("p",{className:"text-secondary small",children:(0,p.AP)("Tip: you can search by keyword in name.")}),(0,x.jsxs)(Oe.A,{tag:"div",children:[(0,x.jsxs)(Te.A,{row:!0,children:[(0,x.jsx)(Re.A,{for:"name",sm:1,children:(0,p.AP)("Name")}),(0,x.jsx)(yt.A,{sm:5,children:(0,x.jsx)(W.A,{type:"text",name:"query",id:"name",value:t,onChange:this.handleInputChange,onKeyDown:this.handleKeyDown})})]}),(0,x.jsx)(Te.A,{row:!0,children:(0,x.jsx)(yt.A,{sm:{size:5,offset:1},children:(0,x.jsx)("button",{className:"btn btn-outline-primary",disabled:!n,onClick:this.getItems,children:(0,p.AP)("Submit")})})})]})]}),(0,x.jsxs)("div",{className:"mt-4 mb-6",children:[(0,x.jsx)("h4",{className:"border-bottom font-weight-normal mb-2 pb-1",children:(0,p.AP)("Result")}),(0,x.jsx)(Yi,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.orgList,updateRole:this.updateRole,deleteOrg:this.deleteOrg})]})]})]})})]})}}])}(l.Component),Wi=n(97176),Qi=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).toggle=function(){n.props.toggle()},n.handleInputChange=function(e){var t=e.target.value;n.setState({name:t,isSubmitBtnActive:""!=t.trim()})},n.handleKeyDown=function(e){"Enter"==e.key&&(n.handleSubmit(),e.preventDefault())},n.handleSubmit=function(){n.props.updateName(n.state.name.trim()),n.toggle()},n.state={name:n.props.name,isSubmitBtnActive:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.state,t=e.name,n=e.isSubmitBtnActive;return(0,x.jsxs)(u.A,{isOpen:!0,toggle:this.toggle,children:[(0,x.jsx)(Ce.A,{toggle:this.toggle,children:(0,p.AP)("Set Name")}),(0,x.jsx)(Ie.A,{children:(0,x.jsx)(Oe.A,{children:(0,x.jsx)(Te.A,{children:(0,x.jsx)(W.A,{type:"text",value:t,onKeyDown:this.handleKeyDown,onChange:this.handleInputChange})})})}),(0,x.jsxs)(Me.A,{children:[(0,x.jsx)(j.A,{color:"secondary",onClick:this.toggle,children:(0,p.AP)("Cancel")}),(0,x.jsx)(j.A,{color:"primary",onClick:this.handleSubmit,disabled:!n,children:(0,p.AP)("Submit")})]})]})}}])}(l.Component),Ki=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).toggle=function(){n.props.toggle()},n.handleInputChange=function(e){var t=e.target.value;n.setState({value:t,isSubmitBtnActive:""!=t.trim()})},n.handleKeyDown=function(e){"Enter"==e.key&&(n.handleSubmit(),e.preventDefault())},n.handleSubmit=function(){n.props.updateValue(n.state.value.trim()),n.toggle()},n.state={value:n.props.value,isSubmitBtnActive:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.state,t=e.value,n=e.isSubmitBtnActive;return(0,x.jsxs)(u.A,{isOpen:!0,toggle:this.toggle,children:[(0,x.jsx)(Ce.A,{toggle:this.toggle,children:(0,p.AP)("Set max number of members")}),(0,x.jsx)(Ie.A,{children:(0,x.jsx)(Oe.A,{children:(0,x.jsx)(Te.A,{children:(0,x.jsx)(W.A,{type:"text",className:"form-control",value:t,onKeyDown:this.handleKeyDown,onChange:this.handleInputChange})})})}),(0,x.jsxs)(Me.A,{children:[(0,x.jsx)(j.A,{color:"secondary",onClick:this.toggle,children:(0,p.AP)("Cancel")}),(0,x.jsx)(j.A,{color:"primary",onClick:this.handleSubmit,disabled:!n,children:(0,p.AP)("Submit")})]})]})}}])}(l.Component),$i=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).navItems=[{name:"info",urlPart:"info",text:(0,p.AP)("Info")},{name:"users",urlPart:"users",text:(0,p.AP)("Members")},{name:"groups",urlPart:"groups",text:(0,p.AP)("Groups")},{name:"repos",urlPart:"libraries",text:(0,p.AP)("Libraries")}],n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props,t=e.currentItem,n=e.orgID,i=e.orgName;return(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{className:"cur-view-path",children:(0,x.jsxs)("h3",{className:"sf-heading",children:[(0,x.jsx)(h.N_,{to:"".concat(p.Yc,"sys/organizations/"),children:(0,p.AP)("Organizations")})," / ",i]})}),(0,x.jsx)("ul",{className:"nav border-bottom mx-4",children:this.navItems.map((function(e,i){return(0,x.jsx)("li",{className:"nav-item mr-2",children:(0,x.jsx)(h.N_,{to:"".concat(p.Yc,"sys/organizations/").concat(n,"/").concat(e.urlPart,"/"),className:"nav-link ".concat(t==e.name?" active":""),children:e.text})},i)}))})]})}}])}(l.Component),Xi=$i,Zi=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).toggleSetQuotaDialog=function(){n.setState({isSetQuotaDialogOpen:!n.state.isSetQuotaDialogOpen})},n.toggleSetNameDialog=function(){n.setState({isSetNameDialogOpen:!n.state.isSetNameDialogOpen})},n.toggleSetMaxUserNumberDialog=function(){n.setState({isSetMaxUserNumberDialogOpen:!n.state.isSetMaxUserNumberDialogOpen})},n.state={isSetQuotaDialogOpen:!1,isSetNameDialogOpen:!1,isSetMaxUserNumberDialogOpen:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg;if(t)return(0,x.jsx)(D.A,{});if(n)return(0,x.jsx)("p",{className:"error text-center",children:n});var i=this.props.orgInfo,s=i.org_name,a=i.users_count,r=i.max_user_number,o=i.groups_count,l=i.quota,c=i.quota_usage,d=i.enable_saml_login,u=i.metadata_url,h=i.domain,g=this.state,m=g.isSetQuotaDialogOpen,v=g.isSetNameDialogOpen,A=g.isSetMaxUserNumberDialogOpen;return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("dl",{className:"m-0",children:[(0,x.jsx)("dt",{className:"info-item-heading",children:(0,p.AP)("Name")}),(0,x.jsxs)("dd",{className:"info-item-content",children:[s,(0,x.jsx)(jt.A,{onClick:this.toggleSetNameDialog})]}),(0,x.jsx)("dt",{className:"info-item-heading",children:(0,p.AP)("Number of members")}),(0,x.jsx)("dd",{className:"info-item-content",children:a}),r&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("dt",{className:"info-item-heading",children:(0,p.AP)("Max number of members")}),(0,x.jsxs)("dd",{className:"info-item-content",children:[r,(0,x.jsx)(jt.A,{onClick:this.toggleSetMaxUserNumberDialog})]})]}),(0,x.jsx)("dt",{className:"info-item-heading",children:(0,p.AP)("Number of groups")}),(0,x.jsx)("dd",{className:"info-item-content",children:o}),(0,x.jsx)("dt",{className:"info-item-heading",children:(0,p.AP)("Space Used")}),(0,x.jsxs)("dd",{className:"info-item-content",children:["".concat(f.Aq.bytesToSize(c)," / ").concat(l>0?f.Aq.bytesToSize(l):"--"),(0,x.jsx)(jt.A,{onClick:this.toggleSetQuotaDialog})]}),d&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("dt",{className:"info-item-heading",children:(0,p.AP)("SAML Config")}),(0,x.jsx)("dd",{className:"info-item-content",children:(0,x.jsxs)(Wi.A,{className:"my-4",children:[(0,x.jsx)(yt.A,{md:"4",children:"Identifier (Entity ID)"}),(0,x.jsx)(yt.A,{md:"6",children:"".concat(p.xW,"/org/custom/").concat(this.props.orgID,"/saml2/metadata/")})]})}),(0,x.jsx)("dd",{className:"info-item-content",children:(0,x.jsxs)(Wi.A,{className:"my-4",children:[(0,x.jsx)(yt.A,{md:"4",children:"Reply URL (Assertion Consumer Service URL)"}),(0,x.jsx)(yt.A,{md:"6",children:"".concat(p.xW,"/org/custom/").concat(this.props.orgID,"/saml2/acs/")})]})}),(0,x.jsx)("dd",{className:"info-item-content",children:(0,x.jsxs)(Wi.A,{className:"my-4",children:[(0,x.jsx)(yt.A,{md:"4",children:"SAML App Federation Metadata URL"}),(0,x.jsx)(yt.A,{md:"6",children:u})]})}),(0,x.jsx)("dd",{className:"info-item-content",children:(0,x.jsxs)(Wi.A,{className:"my-4",children:[(0,x.jsx)(yt.A,{md:"4",children:(0,p.AP)("Email Domain")}),(0,x.jsx)(yt.A,{md:"6",children:h})]})})]})]}),m&&(0,x.jsx)(we.A,{updateQuota:this.props.updateQuota,toggle:this.toggleSetQuotaDialog}),v&&(0,x.jsx)(Qi,{name:s,updateName:this.props.updateName,toggle:this.toggleSetNameDialog}),A&&(0,x.jsx)(Ki,{value:r,updateValue:this.props.updateMaxUserNumber,toggle:this.toggleSetMaxUserNumberDialog})]})}}])}(l.Component),Ji=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).updateQuota=function(e){var t={quota:e};S.H.sysAdminUpdateOrg(n.props.orgID,t).then((function(e){var t=Object.assign(n.state.orgInfo,{quota:e.data.quota});n.setState({orgInfo:t}),k.A.success((0,p.AP)("Successfully set quota."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.updateName=function(e){var t={orgName:e};S.H.sysAdminUpdateOrg(n.props.orgID,t).then((function(e){var t=Object.assign(n.state.orgInfo,{org_name:e.data.org_name});n.setState({orgInfo:t}),k.A.success((0,p.AP)("Successfully set name."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.updateMaxUserNumber=function(e){var t={maxUserNumber:e};S.H.sysAdminUpdateOrg(n.props.orgID,t).then((function(e){var t=Object.assign(n.state.orgInfo,{max_user_number:e.data.max_user_number});n.setState({orgInfo:t}),k.A.success((0,p.AP)("Successfully set max number of members."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.state={loading:!0,errorMsg:"",orgInfo:{}},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this;S.H.sysAdminGetOrg(this.props.orgID).then((function(t){e.setState({loading:!1,orgInfo:t.data})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this.state.orgInfo;return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(Xi,{currentItem:"info",orgID:this.props.orgID,orgName:e.org_name}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsx)(Zi,{orgID:this.props.orgID,loading:this.state.loading,errorMsg:this.state.errorMsg,orgInfo:this.state.orgInfo,updateQuota:this.updateQuota,updateName:this.updateName,updateMaxUserNumber:this.updateMaxUserNumber})})]})})]})}}])}(l.Component);M().extend(ge());var es=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).toggleItemFreezed=function(e){n.setState({isItemFreezed:e})},n.onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.state={isItemFreezed:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,i=t.errorMsg,s=t.items;if(n)return(0,x.jsx)(D.A,{});if(i)return(0,x.jsx)("p",{className:"error text-center mt-4",children:i});var a=(0,x.jsx)(me.A,{text:(0,p.AP)("No members")}),r=(0,x.jsx)(l.Fragment,{children:(0,x.jsxs)("table",{children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"25%",children:(0,p.AP)("Name")}),(0,x.jsx)("th",{width:"15%",children:(0,p.AP)("Status")}),(0,x.jsx)("th",{width:"15%",children:(0,p.AP)("Role")}),(0,x.jsx)("th",{width:"15%",children:(0,p.AP)("Space Used")}),(0,x.jsxs)("th",{width:"25%",children:[(0,p.AP)("Created At")," / ",(0,p.AP)("Last Login")]}),(0,x.jsx)("th",{width:"5%"})]})}),(0,x.jsx)("tbody",{children:s.map((function(t,n){return(0,x.jsx)(ts,{item:t,isItemFreezed:e.state.isItemFreezed,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem,toggleItemFreezed:e.toggleItemFreezed,updateStatus:e.props.updateStatus,updateMembership:e.props.updateMembership,deleteUser:e.props.deleteUser},n)}))})]})});return s.length?r:a}}])}(l.Component),ts=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleMouseEnter=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!0,highlight:!0})},n.handleMouseLeave=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!1,highlight:!1})},n.onUnfreezedItem=function(){n.setState({highlight:!1,isOpIconShow:!1}),n.props.onUnfreezedItem()},n.onMenuItemClick=function(e){switch(e){case"Delete":n.toggleDeleteDialog();break;case"Reset Password":n.toggleResetPasswordDialog()}},n.toggleDeleteDialog=function(e){e&&e.preventDefault(),n.setState({isDeleteDialogOpen:!n.state.isDeleteDialogOpen})},n.toggleResetPasswordDialog=function(e){e&&e.preventDefault(),n.setState({isResetPasswordDialogOpen:!n.state.isResetPasswordDialogOpen})},n.toggleConfirmInactiveDialog=function(e){"active"!==(null===e||void 0===e?void 0:e.value)&&n.setState({isConfirmInactiveDialogOpen:!n.state.isConfirmInactiveDialogOpen})},n.updateStatus=function(e){n.props.updateStatus(n.props.item.email,e.value)},n.setUserInactive=function(e){n.props.updateStatus(n.props.item.email,"inactive",{keepSharing:e})},n.updateMembership=function(e){n.props.updateMembership(n.props.item.email,e.value)},n.deleteUser=function(){var e=n.props.item;n.props.deleteUser(e.org_id,e.email)},n.resetPassword=function(){S.H.sysAdminResetUserPassword(n.props.item.email).then((function(e){k.A.success(e.data.reset_tip)})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.translateOperations=function(e){var t="";switch(e){case"Delete":t=(0,p.AP)("Delete");break;case"Reset Password":t=(0,p.AP)("Reset Password")}return t},n.translateStatus=function(e){switch(e){case"active":return(0,p.AP)("Active");case"inactive":return(0,p.AP)("Inactive")}},n.translateMembership=function(e){switch(e){case"Admin":return(0,p.AP)("Admin");case"Member":return(0,p.AP)("Member")}},n.state={isOpIconShown:!1,highlight:!1,isDeleteDialogOpen:!1,isResetPasswordDialogOpen:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this,t=this.props.item,n=this.state,i=n.highlight,s=n.isOpIconShown,a=n.isDeleteDialogOpen,r=n.isResetPasswordDialogOpen,o=n.isConfirmInactiveDialogOpen,c='<span class="op-target">'+f.Aq.HTMLescape(t.name)+"</span>",d=(0,p.AP)("Are you sure you want to delete {placeholder} ?").replace("{placeholder}",c),u=(0,p.AP)("Are you sure you want to reset the password of {placeholder} ?").replace("{placeholder}",c),h=t.active?"active":"inactive";this.statusOptions=["active","inactive"].map((function(t){return{value:t,text:e.translateStatus(t),isSelected:t==h}}));var g=this.statusOptions.filter((function(e){return e.isSelected}))[0],m=t.is_org_staff?"Admin":"Member";this.membershipOptions=["Admin","Member"].map((function(t){return{value:t,text:e.translateMembership(t),isSelected:t==m}}));var v=this.membershipOptions.filter((function(e){return e.isSelected}))[0];return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,x.jsx)("td",{children:(0,x.jsx)(Se,{email:t.email,name:t.name})}),(0,x.jsx)("td",{children:(0,x.jsx)($e.A,{isDropdownToggleShown:i,currentSelectedOption:g,options:this.statusOptions,selectOption:this.updateStatus,toggleItemFreezed:this.props.toggleItemFreezed,operationBeforeSelect:t.active?this.toggleConfirmInactiveDialog:void 0})}),(0,x.jsx)("td",{children:(0,x.jsx)($e.A,{isDropdownToggleShown:i,currentSelectedOption:v,options:this.membershipOptions,selectOption:this.updateMembership,toggleItemFreezed:this.props.toggleItemFreezed})}),(0,x.jsx)("td",{children:"".concat(f.Aq.bytesToSize(t.quota_usage)," / ").concat(t.quota_total>0?f.Aq.bytesToSize(t.quota_total):"--")}),(0,x.jsxs)("td",{children:[M()(t.create_time).format("YYYY-MM-DD HH:mm:ss")," / ",t.last_login?M()(t.last_login).fromNow():"--"]}),(0,x.jsx)("td",{children:s&&t.email!=p.Xh&&(0,x.jsx)(et.A,{operations:["Delete","Reset Password"],translateOperations:this.translateOperations,onMenuItemClick:this.onMenuItemClick,onFreezedItem:this.props.onFreezedItem,onUnfreezedItem:this.onUnfreezedItem})})]}),a&&(0,x.jsx)(Ye.A,{title:(0,p.AP)("Delete Member"),message:d,executeOperation:this.deleteUser,confirmBtnText:(0,p.AP)("Delete"),toggleDialog:this.toggleDeleteDialog}),r&&(0,x.jsx)(Ye.A,{title:(0,p.AP)("Reset Password"),message:u,executeOperation:this.resetPassword,confirmBtnText:(0,p.AP)("Reset"),toggleDialog:this.toggleResetPasswordDialog}),o&&(0,x.jsx)(tt,{toggleDialog:this.toggleConfirmInactiveDialog,onSubmit:this.setUserInactive})]})}}])}(l.Component),ns=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).toggleAddUserDialog=function(){n.setState({isAddUserDialogOpen:!n.state.isAddUserDialogOpen})},n.addUser=function(e){var t=e.email,i=e.name,s=e.password;S.H.sysAdminAddOrgUser(n.props.orgID,t,i,s).then((function(e){var t=n.state.userList;t.unshift(e.data),n.setState({userList:t})})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.deleteUser=function(e,t){S.H.sysAdminDeleteOrgUser(e,t).then((function(e){var i=n.state.userList.filter((function(e){return e.email!=t}));n.setState({userList:i}),k.A.success((0,p.AP)("Successfully deleted 1 item."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.updateStatus=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s="active"==t;S.H.sysAdminUpdateOrgUser(n.props.orgID,e,"active",s,i).then((function(t){var i=n.state.userList.map((function(n){return n.email==e&&(n.active=t.data.active),n}));n.setState({userList:i})})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.updateMembership=function(e,t){var i="Admin"==t;S.H.sysAdminUpdateOrgUser(n.props.orgID,e,"is_org_staff",i).then((function(t){var i=n.state.userList.map((function(n){return n.email==e&&(n.is_org_staff=t.data.is_org_staff),n}));n.setState({userList:i})})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.state={loading:!0,errorMsg:"",orgName:"",userList:[],isAddUserDialogOpen:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this;S.H.sysAdminGetOrg(this.props.orgID).then((function(t){e.setState({orgName:t.data.org_name})})),S.H.sysAdminListOrgUsers(this.props.orgID).then((function(t){e.setState({loading:!1,userList:t.data.users})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this.state,t=e.isAddUserDialogOpen,n=e.orgName;return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)((0,i.default)({},this.props),{},{children:(0,x.jsx)(j.A,{className:"btn btn-secondary operation-item",onClick:this.toggleAddUserDialog,children:(0,p.AP)("Add Member")})})),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(Xi,{currentItem:"users",orgID:this.props.orgID,orgName:n}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsx)(es,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.userList,updateStatus:this.updateStatus,updateMembership:this.updateMembership,deleteUser:this.deleteUser})})]})}),t&&(0,x.jsx)(Be,{addUser:this.addUser,toggleDialog:this.toggleAddUserDialog})]})}}])}(l.Component),is=ns,ss=function(e){function t(e){return(0,s.default)(this,t),(0,r.default)(this,t,[e])}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,i=t.errorMsg,s=t.items;if(n)return(0,x.jsx)(D.A,{});if(i)return(0,x.jsx)("p",{className:"error text-center mt-4",children:i});var a=(0,x.jsx)(me.A,{text:(0,p.AP)("No groups")}),r=(0,x.jsx)(l.Fragment,{children:(0,x.jsxs)("table",{className:"table-hover",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"30%",children:(0,p.AP)("Name")}),(0,x.jsx)("th",{width:"30%",children:(0,p.AP)("Creator")}),(0,x.jsx)("th",{width:"30%",children:(0,p.AP)("Created At")}),(0,x.jsx)("th",{width:"10%"})]})}),(0,x.jsx)("tbody",{children:s.map((function(t,n){return(0,x.jsx)(as,{item:t,deleteGroup:e.props.deleteGroup},n)}))})]})});return s.length?r:a}}])}(l.Component),as=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleMouseEnter=function(){n.setState({isHighlighted:!0,isOpIconShown:!0})},n.handleMouseLeave=function(){n.setState({isHighlighted:!1,isOpIconShown:!1})},n.toggleDeleteDialog=function(){n.setState({isDeleteDialogOpen:!n.state.isDeleteDialogOpen})},n.deleteGroup=function(){n.toggleDeleteDialog(),n.props.deleteGroup(n.props.item.group_id)},n.state={isHighlighted:!1,isOpIconShown:!1,isDeleteDialogOpen:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.item,t=this.state,n=t.isOpIconShown,i=t.isDeleteDialogOpen,s=t.isHighlighted,a='<span class="op-target">'+f.Aq.HTMLescape(e.group_name)+"</span>",r=(0,p.AP)("Are you sure you want to delete {placeholder} ?").replace("{placeholder}",a),o="".concat(p.Yc,"sys/groups/").concat(e.group_id,"/libraries/");return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("tr",{className:fe()({"tr-highlight":s}),onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,x.jsx)("td",{children:(0,x.jsx)("a",{href:o,children:e.group_name})}),(0,x.jsx)("td",{children:(0,x.jsx)(Se,{email:e.creator_email,name:e.creator_name})}),(0,x.jsx)("td",{children:M()(e.created_at).format("YYYY-MM-DD HH:mm:ss")}),(0,x.jsx)("td",{children:(0,x.jsx)("i",{className:"op-icon sf3-font-delete1 sf3-font ".concat(n?"":"invisible"),title:(0,p.AP)("Delete"),onClick:this.toggleDeleteDialog})})]}),i&&(0,x.jsx)(Ye.A,{title:(0,p.AP)("Delete Group"),message:r,executeOperation:this.deleteGroup,confirmBtnText:(0,p.AP)("Delete"),toggleDialog:this.toggleDeleteDialog})]})}}])}(l.Component),rs=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).deleteGroup=function(e){S.H.sysAdminDismissGroupByID(e).then((function(t){var i=n.state.groupList.filter((function(t){return t.group_id!=e}));n.setState({groupList:i}),k.A.success((0,p.AP)("Successfully deleted 1 item."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.state={loading:!0,errorMsg:"",orgName:"",groupList:[]},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this;S.H.sysAdminGetOrg(this.props.orgID).then((function(t){e.setState({orgName:t.data.org_name})})),S.H.sysAdminListOrgGroups(this.props.orgID).then((function(t){e.setState({loading:!1,groupList:t.data.group_list})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(Xi,{currentItem:"groups",orgID:this.props.orgID,orgName:this.state.orgName}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsx)(ss,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.groupList,deleteGroup:this.deleteGroup})})]})})]})}}])}(l.Component),os=function(e){function t(){return(0,s.default)(this,t),(0,r.default)(this,t,arguments)}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,i=t.errorMsg,s=t.items;if(n)return(0,x.jsx)(D.A,{});if(i)return(0,x.jsx)("p",{className:"error text-center mt-4",children:i});var a=(0,x.jsx)(me.A,{text:(0,p.AP)("No libraries")}),r=(0,x.jsx)(l.Fragment,{children:(0,x.jsxs)("table",{children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"5%"}),(0,x.jsx)("th",{width:"30%",children:(0,p.AP)("Name")}),(0,x.jsx)("th",{width:"35%",children:"ID"}),(0,x.jsx)("th",{width:"20%",children:(0,p.AP)("Owner")}),(0,x.jsx)("th",{width:"10%"})]})}),(0,x.jsx)("tbody",{children:s.map((function(t,n){return(0,x.jsx)(ls,{item:t,deleteRepo:e.props.deleteRepo},n)}))})]})});return s.length?r:a}}])}(l.Component),ls=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleMouseEnter=function(){n.setState({isHighlighted:!0,isOpIconShown:!0})},n.handleMouseLeave=function(){n.setState({isHighlighted:!1,isOpIconShown:!1})},n.toggleDeleteDialog=function(e){e&&e.preventDefault(),n.setState({isDeleteDialogOpen:!n.state.isDeleteDialogOpen})},n.deleteRepo=function(){n.props.deleteRepo(n.props.item.repo_id)},n.state={isHighlighted:!1,isOpIconShown:!1,isDeleteDialogOpen:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.item,t=this.state,n=t.isOpIconShown,i=t.isDeleteDialogOpen,s=t.isHighlighted,a=f.Aq.getLibIconUrl(e),r=f.Aq.getLibIconTitle(e),o='<span class="op-target">'+f.Aq.HTMLescape(e.repo_name)+"</span>",c=(0,p.AP)("Are you sure you want to delete {placeholder} ?").replace("{placeholder}",o);return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("tr",{className:fe()({"tr-highlight":s}),onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,x.jsx)("td",{children:(0,x.jsx)("img",{src:a,title:r,alt:r,width:"24"})}),(0,x.jsx)("td",{children:e.repo_name}),(0,x.jsx)("td",{children:e.repo_id}),(0,x.jsx)("td",{children:e.owner_email?-1==e.owner_email.indexOf("@seafile_group")?(0,x.jsx)(Se,{email:e.owner_email,name:e.owner_name}):e.owner_name:"--"}),(0,x.jsx)("td",{children:(0,x.jsx)("i",{className:"op-icon sf3-font-delete1 sf3-font ".concat(n?"":"invisible"),title:(0,p.AP)("Delete"),onClick:this.toggleDeleteDialog})})]}),i&&(0,x.jsx)(Ye.A,{title:(0,p.AP)("Delete Library"),message:c,executeOperation:this.deleteRepo,confirmBtnText:(0,p.AP)("Delete"),toggleDialog:this.toggleDeleteDialog})]})}}])}(l.Component),cs=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).deleteRepo=function(e){S.H.sysAdminDeleteRepo(e).then((function(t){var i=n.state.repoList.filter((function(t){return t.repo_id!=e}));n.setState({repoList:i}),k.A.success((0,p.AP)("Successfully deleted 1 item."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.state={loading:!0,errorMsg:"",orgName:"",repoList:[]},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this;S.H.sysAdminGetOrg(this.props.orgID).then((function(t){e.setState({orgName:t.data.org_name})})),S.H.sysAdminListOrgRepos(this.props.orgID).then((function(t){e.setState({loading:!1,repoList:t.data.repo_list})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(Xi,{currentItem:"repos",orgID:this.props.orgID,orgName:this.state.orgName}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsx)(os,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.repoList,deleteRepo:this.deleteRepo})})]})})]})}}])}(l.Component),ds=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleChange=function(e){var t=e.target.value;n.setState({value:t,isSubmitBtnActive:""!=t.trim()})},n.handleSubmit=function(){n.toggle(),n.props.addInstitution(n.state.value.trim())},n.toggle=function(){n.props.toggle()},n.state={value:"",isSubmitBtnActive:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){return(0,x.jsxs)(u.A,{isOpen:!0,toggle:this.toggle,children:[(0,x.jsx)(Ce.A,{toggle:this.toggle,children:(0,p.AP)("Add institution")}),(0,x.jsx)(Ie.A,{children:(0,x.jsxs)(Oe.A,{children:[(0,x.jsx)("p",{children:(0,p.AP)("Name")}),(0,x.jsx)(Te.A,{children:(0,x.jsx)(W.A,{name:"institution-name",value:this.state.value,onChange:this.handleChange})})]})}),(0,x.jsx)(Me.A,{children:(0,x.jsx)(j.A,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive,children:(0,p.AP)("Submit")})})]})}}])}(l.Component);M().extend(ge());var us=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).getPreviousPage=function(){n.props.getInstitutionsByPage(n.props.currentPage-1)},n.getNextPage=function(){n.props.getInstitutionsByPage(n.props.currentPage+1)},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,i=t.errorMsg,s=t.items,a=t.perPage,r=t.currentPage,o=t.hasNextPage;if(n)return(0,x.jsx)(D.A,{});if(i)return(0,x.jsx)("p",{className:"error text-center mt-4",children:i});var c=(0,x.jsx)(me.A,{text:(0,p.AP)("No institutions")}),d=(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("table",{className:"table-hover",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"75%",children:(0,p.AP)("Name")}),(0,x.jsx)("th",{width:"20%",children:(0,p.AP)("Created At")}),(0,x.jsx)("th",{width:"5%"})]})}),(0,x.jsx)("tbody",{children:s.map((function(t,n){return(0,x.jsx)(hs,{item:t,deleteInstitution:e.props.deleteInstitution},n)}))})]}),(0,x.jsx)(X.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:r,hasNextPage:o,curPerPage:a,resetPerPage:this.props.resetPerPage})]});return s.length?d:c}}])}(l.Component),hs=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleMouseEnter=function(){n.setState({isHighlighted:!0,isOpIconShown:!0})},n.handleMouseLeave=function(){n.setState({isHighlighted:!1,isOpIconShown:!1})},n.toggleDeleteDialog=function(e){e&&e.preventDefault(),n.setState({isDeleteDialogOpen:!n.state.isDeleteDialogOpen})},n.deleteInstitution=function(){n.props.deleteInstitution(n.props.item.id)},n.state={isHighlighted:!1,isOpIconShown:!1,isDeleteDialogOpen:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.item,t=this.state,n=t.isOpIconShown,i=t.isDeleteDialogOpen,s=t.isHighlighted,a='<span class="op-target">'+f.Aq.HTMLescape(e.name)+"</span>",r=(0,p.AP)("Are you sure you want to delete {placeholder} ?").replace("{placeholder}",a);return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("tr",{className:fe()({"tr-highlight":s}),onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,x.jsx)("td",{children:(0,x.jsx)(h.N_,{to:"".concat(p.Yc,"sys/institutions/").concat(e.id,"/info/"),children:e.name})}),(0,x.jsx)("td",{children:M()(e.ctime).fromNow()}),(0,x.jsx)("td",{children:(0,x.jsx)("i",{className:"op-icon sf3-font-delete1 sf3-font ".concat(n?"":"invisible"),title:(0,p.AP)("Delete"),onClick:this.toggleDeleteDialog})})]}),i&&(0,x.jsx)(Ye.A,{title:(0,p.AP)("Delete Institution"),message:r,executeOperation:this.deleteInstitution,confirmBtnText:(0,p.AP)("Delete"),toggleDialog:this.toggleDeleteDialog})]})}}])}(l.Component),gs=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).getInstitutionsByPage=function(e){var t=n.state.perPage;S.H.sysAdminListInstitutions(e,t).then((function(i){n.setState({loading:!1,institutionList:i.data.institution_list,currentPage:e,hasNextPage:f.Aq.hasNextPage(e,t,i.data.total_count)})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){return n.getInstitutionsByPage(n.initPage)}))},n.toggleAddInstitutionDialog=function(){n.setState({isAddInstitutionDialogOpen:!n.state.isAddInstitutionDialogOpen})},n.addInstitution=function(e){S.H.sysAdminAddInstitution(e).then((function(e){var t=n.state.institutionList;t.push(e.data),n.setState({institutionList:t})})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.deleteInstitution=function(e){S.H.sysAdminDeleteInstitution(e).then((function(t){var i=n.state.institutionList.filter((function(t){return t.id!=e}));n.setState({institutionList:i}),k.A.success((0,p.AP)("Successfully deleted 1 item."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.state={loading:!0,errorMsg:"",institutionList:[],perPage:100,currentPage:1,hasNextPage:!1,isAddInstitutionDialogOpen:!1},n.initPage=1,n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,i=n.currentPage,s=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||s),currentPage:parseInt(t.get("page")||i)},(function(){e.getInstitutionsByPage(e.state.currentPage)}))}},{key:"render",value:function(){var e=this.state,t=e.isAddInstitutionDialogOpen,n=e.hasNextPage,s=e.currentPage,a=e.perPage;return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)((0,i.default)({},this.props),{},{children:(0,x.jsx)(j.A,{className:"btn btn-secondary operation-item",onClick:this.toggleAddInstitutionDialog,children:(0,p.AP)("Add Institution")})})),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)("div",{className:"cur-view-path",children:(0,x.jsx)("h3",{className:"sf-heading",children:(0,p.AP)("Institutions")})}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsx)(us,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.institutionList,deleteInstitution:this.deleteInstitution,currentPage:s,perPage:a,hasNextPage:n,getInstitutionsByPage:this.getInstitutionsByPage,resetPerPage:this.resetPerPage})})]})}),t&&(0,x.jsx)(ds,{addInstitution:this.addInstitution,toggle:this.toggleAddInstitutionDialog})]})}}])}(l.Component),ps=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).navItems=[{name:"info",urlPart:"info",text:(0,p.AP)("Info")},{name:"members",urlPart:"members",text:(0,p.AP)("Members")},{name:"admins",urlPart:"admins",text:(0,p.AP)("Admins")}],n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props,t=e.currentItem,n=e.institutionID,i=e.institutionName;return(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{className:"cur-view-path",children:(0,x.jsxs)("h3",{className:"sf-heading",children:[(0,x.jsx)(h.N_,{to:"".concat(p.Yc,"sys/institutions/"),children:(0,p.AP)("Institutions")})," / ",i]})}),(0,x.jsx)("ul",{className:"nav border-bottom mx-4",children:this.navItems.map((function(e,i){return(0,x.jsx)("li",{className:"nav-item mr-2",children:(0,x.jsx)(h.N_,{to:"".concat(p.Yc,"sys/institutions/").concat(n,"/").concat(e.urlPart,"/"),className:"nav-link ".concat(t==e.name?" active":""),children:e.text})},i)}))})]})}}])}(l.Component),fs=ps,ms=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).toggleSetQuotaDialog=function(){n.setState({isSetQuotaDialogOpen:!n.state.isSetQuotaDialogOpen})},n.state={isSetQuotaDialogOpen:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg,i=e.institutionInfo;if(t)return(0,x.jsx)(D.A,{});if(n)return(0,x.jsx)("p",{className:"error text-center",children:n});var s=i.name,a=i.user_count,r=i.quota_total,o=i.quota_used,l=this.state.isSetQuotaDialogOpen;return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("dl",{className:"m-0",children:[(0,x.jsx)("dt",{className:"info-item-heading",children:(0,p.AP)("Name")}),(0,x.jsx)("dd",{className:"info-item-content",children:s}),(0,x.jsx)("dt",{className:"info-item-heading",children:(0,p.AP)("Number of members")}),(0,x.jsx)("dd",{className:"info-item-content",children:a}),(0,x.jsx)("dt",{className:"info-item-heading",children:(0,p.AP)("Space Used")}),(0,x.jsxs)("dd",{className:"info-item-content",children:["".concat(f.Aq.bytesToSize(o)," / ").concat(r>0?f.Aq.bytesToSize(r):"--"),(0,x.jsx)(jt.A,{onClick:this.toggleSetQuotaDialog})]})]}),l&&(0,x.jsx)(we.A,{updateQuota:this.props.updateQuota,toggle:this.toggleSetQuotaDialog})]})}}])}(l.Component),vs=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).updateQuota=function(e){S.H.sysAdminUpdateInstitution(n.props.institutionID,e).then((function(e){var t=Object.assign(n.state.institutionInfo,{quota_total:e.data.quota_total});n.setState({institutionInfo:t}),k.A.success((0,p.AP)("Successfully set quota."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.state={loading:!0,errorMsg:"",institutionInfo:{}},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this;S.H.sysAdminGetInstitution(this.props.institutionID).then((function(t){e.setState({loading:!1,institutionInfo:t.data})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this.state.institutionInfo;return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(fs,{currentItem:"info",institutionID:this.props.institutionID,institutionName:e.name}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsx)(ms,{loading:this.state.loading,errorMsg:this.state.errorMsg,institutionInfo:this.state.institutionInfo,updateQuota:this.updateQuota})})]})})]})}}])}(l.Component),xs=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleSelectChange=function(e){n.setState({selectedUsers:e})},n.handleSubmit=function(){if(n.state.selectedUsers){var e=n.state.selectedUsers.map((function(e){return e.email}));n.props.addUser(e)}},n.state={selectedUsers:[]},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){return(0,x.jsxs)(u.A,{isOpen:!0,toggle:this.props.toggle,children:[(0,x.jsx)(Ce.A,{toggle:this.props.toggle,children:(0,p.AP)("Add Member")}),(0,x.jsx)(Ie.A,{children:(0,x.jsx)(He.A,{placeholder:(0,p.AP)("Search users"),onSelectChange:this.handleSelectChange,isMulti:!0,className:"org-add-member-select",selectedUsers:this.state.selectedUsers})}),(0,x.jsxs)(Me.A,{children:[(0,x.jsx)(j.A,{color:"primary",onClick:this.handleSubmit,children:(0,p.AP)("Submit")}),(0,x.jsx)(j.A,{color:"secondary",onClick:this.props.toggle,children:(0,p.AP)("Cancel")})]})]})}}])}(l.Component);M().extend(ge());var As=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.getPreviousPage=function(){n.props.getInstitutionUsersByPage(n.props.currentPage-1)},n.getNextPage=function(){n.props.getInstitutionUsersByPage(n.props.currentPage+1)},n.state={isItemFreezed:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,i=t.errorMsg,s=t.items,a=t.perPage,r=t.currentPage,o=t.hasNextPage;if(n)return(0,x.jsx)(D.A,{});if(i)return(0,x.jsx)("p",{className:"error text-center mt-4",children:i});var c=(0,x.jsx)(me.A,{text:(0,p.AP)("No members")}),d=(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("table",{children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"25%",children:(0,p.AP)("Name")}),(0,x.jsx)("th",{width:"10%",children:(0,p.AP)("Status")}),(0,x.jsx)("th",{width:"20%",children:(0,p.AP)("Space Used")}),(0,x.jsxs)("th",{width:"40%",children:[(0,p.AP)("Created At")," / ",(0,p.AP)("Last Login")]}),(0,x.jsx)("th",{width:"5%"})]})}),(0,x.jsx)("tbody",{children:s.map((function(t,n){return(0,x.jsx)(ys,{item:t,isItemFreezed:e.state.isItemFreezed,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem,setAdmin:e.props.setAdmin,deleteUser:e.props.deleteUser},n)}))})]}),(0,x.jsx)(X.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:r,hasNextPage:o,curPerPage:a,resetPerPage:this.props.resetPerPage})]});return s.length?d:c}}])}(l.Component),ys=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleMouseEnter=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!0,highlight:!0})},n.handleMouseLeave=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!1,highlight:!1})},n.onUnfreezedItem=function(){n.setState({highlight:!1,isOpIconShow:!1}),n.props.onUnfreezedItem()},n.toggleSetAdminDialog=function(e){e&&e.preventDefault(),n.setState({isSetAdminDialogOpen:!n.state.isSetAdminDialogOpen})},n.setAdmin=function(){n.props.setAdmin(n.props.item.email)},n.onMenuItemClick=function(e){switch(e){case"Delete":n.props.deleteUser(n.props.item.email);break;case"Set Admin":n.toggleSetAdminDialog()}},n.getOperations=function(){var e=[];return n.props.item.is_institution_admin||e.push("Set Admin"),e.push("Delete"),e},n.translateOperations=function(e){var t="";switch(e){case"Delete":t=(0,p.AP)("Delete");break;case"Set Admin":t=(0,p.AP)("Set Admin")}return t},n.state={isOpIconShown:!1,highlight:!1,isSetAdminDialogOpen:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.item,t=this.state,n=t.isOpIconShown,i=t.isSetAdminDialogOpen,s='<span class="op-target">'+f.Aq.HTMLescape(e.name)+"</span>",a=(0,p.AP)("Are you sure you want to set {placeholder} as Admin?").replace("{placeholder}",s);return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,x.jsx)("td",{children:(0,x.jsx)(Se,{email:e.email,name:e.name})}),(0,x.jsx)("td",{children:e.is_active?(0,p.AP)("Active"):(0,p.AP)("Inactive")}),(0,x.jsx)("td",{children:"".concat(f.Aq.bytesToSize(e.quota_usage)," / ").concat(e.quota_total>0?f.Aq.bytesToSize(e.quota_total):"--")}),(0,x.jsxs)("td",{children:[M()(e.create_time).format("YYYY-MM-DD HH:mm:ss")," / ",e.last_login?M()(e.last_login).fromNow():"--"]}),(0,x.jsx)("td",{children:n&&(0,x.jsx)(et.A,{operations:this.getOperations(),translateOperations:this.translateOperations,onMenuItemClick:this.onMenuItemClick,onFreezedItem:this.props.onFreezedItem,onUnfreezedItem:this.onUnfreezedItem})})]}),i&&(0,x.jsx)(Ye.A,{title:(0,p.AP)("Set Admin"),message:a,executeOperation:this.setAdmin,toggleDialog:this.toggleSetAdminDialog,confirmBtnText:(0,p.AP)("Set Admin")})]})}}])}(l.Component),Ps=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).getInstitutionUsersByPage=function(e){var t=n.state.perPage;S.H.sysAdminListInstitutionUsers(n.props.institutionID,e,t).then((function(i){n.setState({loading:!1,userList:i.data.user_list,currentPage:e,hasNextPage:f.Aq.hasNextPage(e,t,i.data.total_count)})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.setAdmin=function(e){S.H.sysAdminUpdateInstitutionUser(n.props.institutionID,e,!0).then((function(t){var i=n.state.userList.map((function(t){return t.email==e&&(t.is_institution_admin=!0),t}));n.setState({userList:i}),k.A.success((0,p.AP)("Admin updated"))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.toggleAddUserDialog=function(){n.setState({isAddUserDialogOpen:!n.state.isAddUserDialogOpen})},n.resetPerPage=function(e){n.setState({perPage:e},(function(){return n.getInstitutionUsersByPage(n.initPage)}))},n.addUser=function(e){S.H.sysAdminAddInstitutionUserBatch(n.props.institutionID,e).then((function(e){n.toggleAddUserDialog();var t=e.data.success,i=e.data.failed;if(t.length){var s=n.state.userList.concat(t);n.setState({userList:s})}i.forEach((function(e){k.A.danger(e.error_msg)}))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.deleteUser=function(e){S.H.sysAdminDeleteInstitutionUser(n.props.institutionID,e).then((function(t){var i=n.state.userList.filter((function(t){return t.email!=e}));n.setState({userList:i}),k.A.success((0,p.AP)("User deleted"))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.state={loading:!0,errorMsg:"",institutionName:"",userList:[],perPage:100,currentPage:1,hasNextPage:!1,isAddUserDialogOpen:!1},n.initPage=1,n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this;S.H.sysAdminGetInstitution(this.props.institutionID).then((function(t){e.setState({institutionName:t.data.name})}));var t=new URL(window.location).searchParams,n=this.state,i=n.currentPage,s=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||s),currentPage:parseInt(t.get("page")||i)},(function(){e.getInstitutionUsersByPage(e.state.currentPage)}))}},{key:"render",value:function(){var e=this.state,t=e.isAddUserDialogOpen,n=e.institutionName,s=e.hasNextPage,a=e.currentPage,r=e.perPage;return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)((0,i.default)({},this.props),{},{children:(0,x.jsx)(j.A,{className:"btn btn-secondary operation-item",onClick:this.toggleAddUserDialog,children:(0,p.AP)("Add Member")})})),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(fs,{currentItem:"members",institutionID:this.props.institutionID,institutionName:n}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsx)(As,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.userList,setAdmin:this.setAdmin,deleteUser:this.deleteUser,currentPage:a,perPage:r,hasNextPage:s,getInstitutionUsersByPage:this.getInstitutionUsersByPage,resetPerPage:this.resetPerPage})})]})}),t&&(0,x.jsx)(xs,{addUser:this.addUser,toggle:this.toggleAddUserDialog})]})}}])}(l.Component);M().extend(ge());var bs=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.state={isItemFreezed:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,i=t.errorMsg,s=t.items;if(n)return(0,x.jsx)(D.A,{});if(i)return(0,x.jsx)("p",{className:"error text-center mt-4",children:i});var a=(0,x.jsx)(me.A,{text:(0,p.AP)("No admins")}),r=(0,x.jsx)(l.Fragment,{children:(0,x.jsxs)("table",{children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"25%",children:(0,p.AP)("Name")}),(0,x.jsx)("th",{width:"10%",children:(0,p.AP)("Status")}),(0,x.jsx)("th",{width:"20%",children:(0,p.AP)("Space Used")}),(0,x.jsxs)("th",{width:"40%",children:[(0,p.AP)("Created At")," / ",(0,p.AP)("Last Login")]}),(0,x.jsx)("th",{width:"5%"})]})}),(0,x.jsx)("tbody",{children:s.map((function(t,n){return(0,x.jsx)(js,{item:t,isItemFreezed:e.state.isItemFreezed,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem,revokeAdmin:e.props.revokeAdmin,deleteUser:e.props.deleteUser},n)}))})]})});return s.length?r:a}}])}(l.Component),js=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleMouseEnter=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!0,highlight:!0})},n.handleMouseLeave=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!1,highlight:!1})},n.onUnfreezedItem=function(){n.setState({highlight:!1,isOpIconShow:!1}),n.props.onUnfreezedItem()},n.toggleRevokeAdminDialog=function(e){e&&e.preventDefault(),n.setState({isRevokeAdminDialogOpen:!n.state.isRevokeAdminDialogOpen})},n.revokeAdmin=function(){n.props.revokeAdmin(n.props.item)},n.onMenuItemClick=function(e){if("Revoke Admin"===e)n.toggleRevokeAdminDialog()},n.translateOperations=function(e){var t="";if("Revoke Admin"===e)t=(0,p.AP)("Revoke Admin");return t},n.state={isOpIconShown:!1,highlight:!1,isRevokeAdminDialogOpen:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.item,t=this.state,n=t.isOpIconShown,i=t.isRevokeAdminDialogOpen,s='<span class="op-target">'+f.Aq.HTMLescape(e.name)+"</span>",a=(0,p.AP)("Are you sure you want to revoke the admin permission of {placeholder} ?").replace("{placeholder}",s);return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,x.jsx)("td",{children:(0,x.jsx)(Se,{email:e.email,name:e.name})}),(0,x.jsx)("td",{children:e.is_active?(0,p.AP)("Active"):(0,p.AP)("Inactive")}),(0,x.jsx)("td",{children:"".concat(f.Aq.bytesToSize(e.quota_usage)," / ").concat(e.quota_total>0?f.Aq.bytesToSize(e.quota_total):"--")}),(0,x.jsxs)("td",{children:[M()(e.create_time).format("YYYY-MM-DD HH:mm:ss")," / ",e.last_login?M()(e.last_login).fromNow():"--"]}),(0,x.jsx)("td",{children:n&&(0,x.jsx)(et.A,{operations:["Revoke Admin"],translateOperations:this.translateOperations,onMenuItemClick:this.onMenuItemClick,onFreezedItem:this.props.onFreezedItem,onUnfreezedItem:this.onUnfreezedItem})})]}),i&&(0,x.jsx)(Ye.A,{title:(0,p.AP)("Revoke Admin"),message:a,executeOperation:this.revokeAdmin,confirmBtnText:(0,p.AP)("Revoke"),toggleDialog:this.toggleRevokeAdminDialog})]})}}])}(l.Component),Ss=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).revokeAdmin=function(e){var t=e.email,i=e.name;S.H.sysAdminUpdateInstitutionUser(n.props.institutionID,t,!1).then((function(e){var s=n.state.userList.filter((function(e){return e.email!=t}));n.setState({userList:s}),k.A.success((0,p.AP)("Successfully revoked the admin permission of {placeholder}.").replace("{placeholder}",i))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.deleteUser=function(e){S.H.sysAdminDeleteInstitutionUser(n.props.institutionID,e).then((function(t){var i=n.state.userList.filter((function(t){return t.email!=e}));n.setState({userList:i}),k.A.success((0,p.AP)("User deleted"))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.state={loading:!0,errorMsg:"",institutionName:"",userList:[],isAddUserDialogOpen:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this;S.H.sysAdminGetInstitution(this.props.institutionID).then((function(t){e.setState({institutionName:t.data.name})})),S.H.sysAdminListInstitutionAdmins(this.props.institutionID).then((function(t){e.setState({loading:!1,userList:t.data.user_list})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this.state.institutionName;return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(fs,{currentItem:"admins",institutionID:this.props.institutionID,institutionName:e}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsx)(bs,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.userList,revokeAdmin:this.revokeAdmin,deleteUser:this.deleteUser})})]})})]})}}])}(l.Component),ks=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).navItems=[{name:"loginLogs",urlPart:"logs/login",text:(0,p.AP)("Login")},{name:"fileAccessLogs",urlPart:"logs/file-access",text:(0,p.AP)("File Access")},{name:"fileUpdateLogs",urlPart:"logs/file-update",text:(0,p.AP)("File Update")},{name:"sharePermissionLogs",urlPart:"logs/share-permission",text:(0,p.AP)("Permission")},{name:"fileTransfer",urlPart:"logs/repo-transfer",text:(0,p.AP)("Repo Transfer")},{name:"groupMember",urlPart:"logs/group-member-audit",text:(0,p.AP)("Group Member")}],n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.currentItem;return(0,x.jsx)("div",{className:"cur-view-path tab-nav-container",children:(0,x.jsx)("ul",{className:"nav",children:this.navItems.map((function(t,n){return(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(h.N_,{to:"".concat(p.Yc,"sys/").concat(t.urlPart,"/"),className:"nav-link".concat(e==t.name?" active":""),children:t.text})},n)}))})})}}])}(l.Component),Ds=ks,_s=n(71361),ws=n(61599),Is=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).downloadExcel=function(){if(n.isValidDateStr())switch(n.props.logType){case"login":n.sysExportLogs("loginadmin");break;case"fileAccess":n.sysExportLogs("fileaudit");break;case"fileUpdate":n.sysExportLogs("fileupdate");break;case"sharePermission":n.sysExportLogs("permaudit")}},n.queryIOStatus=function(e,t){_s.E.queryIOStatus(e).then((function(i){!0===i.data.is_finished?(n.setState({isShowIODialog:!1}),n.props.toggle(),location.href=p.Yc+"sys/log/export-excel/?task_id="+e+"&log_type="+t):setTimeout((function(){n.queryIOStatus(e,t)}),1e3)})).catch((function(e){n.setState({isShowIODialog:!1}),k.A.danger((0,p.AP)("Failed to export. Please check whether the size of table attachments exceeds the limit."))}))},n.sysExportLogs=function(e){var t=n.state,i=t.startDateStr,s=t.endDateStr,a="";n.setState({isShowIODialog:!0},(function(){S.H.sysAdminExportLogsExcel(i,s,e).then((function(e){return a=e.data.task_id,n.setState({taskId:a}),_s.E.queryIOStatus(a)})).then((function(t){!0===t.data.is_finished?(n.setState({isShowIODialog:!1}),n.props.toggle(),location.href=p.Yc+"sys/log/export-excel/?task_id="+a+"&log_type="+e):n.queryIOStatus(a,e)})).catch((function(e){if(e.response&&500===e.response.status){var t=e.response.data?e.response.data.error_msg:null;t&&"Internal Server Error"!==t?k.A.danger(t):k.A.danger((0,p.AP)("Internal Server Error"))}else{var i=f.Aq.getErrorMsg(e);k.A.danger(i)}n.setState({isShowIODialog:!1}),n.props.toggle()}))}))},n.isValidDateStr=function(){var e=n.state,t=e.startDateStr,i=e.endDateStr;return!!(M()(t,"YYYY-MM-DD",!0).isValid()&&M()(i,"YYYY-MM-DD",!0).isValid()&&M()(t).isBefore(i))||(n.setState({errMsg:(0,p.AP)("Date Invalid.")}),!1)},n.handleStartChange=function(e){var t=e.target.value.trim();n.setState({startDateStr:t,errMsg:""})},n.handleEndChange=function(e){var t=e.target.value.trim();n.setState({endDateStr:t,errMsg:""})},n.onExportToggle=function(e){n.setState({isShowIODialog:!n.state.isShowIODialog}),n.props.toggle()},n.state={loading:!0,startDateStr:"",endDateStr:"",errMsg:"",taskId:"",isShowIODialog:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){return(0,x.jsxs)(l.Fragment,{children:[!this.state.isShowIODialog&&(0,x.jsxs)(u.A,{isOpen:!0,toggle:this.props.toggle,autoFocus:!1,children:[(0,x.jsx)(Ce.A,{toggle:this.props.toggle,children:(0,p.AP)("Choose date")}),(0,x.jsxs)(Ie.A,{children:[(0,x.jsxs)(Te.A,{children:[(0,x.jsx)(Re.A,{children:(0,p.AP)("Start date")}),(0,x.jsx)(W.A,{value:this.state.startDateStr,onChange:this.handleStartChange,placeholder:"yyyy-mm-dd",autoFocus:!0})]}),(0,x.jsxs)(Te.A,{children:[(0,x.jsx)(Re.A,{children:(0,p.AP)("End date")}),(0,x.jsx)(W.A,{value:this.state.endDateStr,onChange:this.handleEndChange,placeholder:"yyyy-mm-dd"})]}),this.state.errMsg&&(0,x.jsx)(Ne.A,{className:"mt-2",color:"danger",children:(0,p.AP)(this.state.errMsg)})]}),(0,x.jsxs)(Me.A,{children:[(0,x.jsx)(j.A,{color:"secondary",onClick:this.props.toggle,children:(0,p.AP)("Cancel")}),(0,x.jsx)(j.A,{color:"primary",onClick:this.downloadExcel,children:(0,p.AP)("Submit")})]})]}),this.state.isShowIODialog&&(0,x.jsx)(ws.A,{toggle:this.onExportToggle})]})}}])}(l.Component),Ns=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleClickOutside=function(e){n.props.isOpen&&!n.userSelector.contains(e.target)&&n.props.onToggle()},n.onToggleClick=function(e){e.stopPropagation(),n.props.onToggle()},n.onQueryChange=function(e){var t=e.target.value;n.setState({query:t}),n.handleSearchUser(t)},n.handleSearchUser=function(e){e.trim()?(n.setState({isLoading:!0}),n.finalValue=e,setTimeout((function(){n.finalValue===e&&(n.props.searchUsersFunc&&n.props.searchUsersFunc(e).then((function(t){var i=t.data.user_list||t.data.users||[];n.setState({searchResults:i,isLoading:!1},(function(){n.props.searchGroupsFunc&&n.props.searchGroupsFunc(e).then((function(e){var t=e.data.group_list||e.data.groups||[];n.setState({searchResults:[].concat((0,fi.default)(i),(0,fi.default)(t))})}))}))})).catch((function(e){n.setState({isLoading:!1});var t=f.Aq.getErrorMsg(e);k.A.danger(t)})),n.props.searchGroupsFunc&&!n.props.searchUsersFunc&&n.props.searchGroupsFunc(e).then((function(e){var t=e.data.group_list||e.data.groups||[];n.setState({searchResults:t,isLoading:!1})})))}),500)):n.setState({searchResults:[]})},n.toggleSelectItem=function(e,t){e.stopPropagation(),n.props.onSelect(t,!1)},n.state={query:"",searchResults:[],isLoading:!1},n.dropdownRef=l.createRef(),n.finalValue="",n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.handleClickOutside)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.handleClickOutside)}},{key:"render",value:function(){var e=this,t=this.state,n=t.query,i=t.isLoading,s=t.searchResults,a=this.props,r=a.selectedItems,o=a.isOpen,l=n.trim()?s:this.props.items;return(0,x.jsxs)("div",{className:"position-relative d-inline-block ml-2",ref:this.dropdownRef,children:[(0,x.jsxs)("span",{className:"cur-activity-modifiers d-inline-block p-2 rounded",onClick:this.onToggleClick,children:[r.length>0?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("span",{children:this.props.componentName+":"}),(0,x.jsx)("span",{className:"d-inline-block ml-1",children:r.map((function(e){return e.name})).join(", ")})]}):this.props.componentName,(0,x.jsx)("i",{className:"sf3-font sf3-font-down ml-2 toggle-icon"})]}),o&&(0,x.jsxs)("div",{className:"position-absolute activity-modifier-selector-container rounded shadow",ref:function(t){return e.userSelector=t},children:[(0,x.jsx)("ul",{className:"activity-selected-modifiers px-3 py-1 list-unstyled",children:r.map((function(t,n){return(0,x.jsxs)("li",{className:"activity-selected-modifier",children:[(0,x.jsx)("img",{src:t.avatar_url,className:"avatar w-5 h-5",alt:""}),(0,x.jsx)("span",{className:"activity-user-name ml-2",children:t.name}),(0,x.jsx)("i",{className:"sf2-icon-close unselect-activity-user ml-2",onClick:function(n){e.toggleSelectItem(n,t)}})]},n)}))}),(0,x.jsx)("div",{className:"px-3 pt-3",children:(0,x.jsx)(W.A,{type:"text",placeholder:(0,p.AP)("Find users"),value:n,onChange:this.onQueryChange})}),(0,x.jsx)("ul",{className:"activity-user-list list-unstyled p-3 o-auto",children:i?(0,x.jsx)("li",{className:"text-center",children:(0,p.AP)("Loading...")}):0===l.length?(0,x.jsx)("li",{className:"text-center",children:n?(0,p.AP)("User not found"):(0,p.AP)("Enter characters to start searching")}):l.map((function(t,n){var i=r.some((function(e){return t.email&&e.email===t.email||t.id&&e.id===t.id}));return(0,x.jsxs)("li",{className:"activity-user-item h-6 p-1 rounded d-flex justify-content-between align-items-center",onClick:function(n){e.toggleSelectItem(n,t)},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("img",{src:t.avatar_url,className:"avatar w-5 h-5",alt:""}),(0,x.jsx)("span",{className:"activity-user-name ml-2",children:t.name})]}),i&&(0,x.jsx)("i",{className:"sf2-icon-tick text-gray font-weight-bold"})]},n)}))})]})]})}}])}(l.Component),Ms=Ns;M().extend(ge());var Cs=function(e){function t(){var e;(0,s.default)(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=(0,r.default)(this,t,[].concat(i))).getPreviousPage=function(){e.props.getLogsByPage(e.props.currentPage-1)},e.getNextPage=function(){e.props.getLogsByPage(e.props.currentPage+1)},e}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg,i=e.items,s=e.perPage,a=e.currentPage,r=e.hasNextPage;if(t)return(0,x.jsx)(D.A,{});if(n)return(0,x.jsx)("p",{className:"error text-center",children:n});var o=(0,x.jsx)(me.A,{text:(0,p.AP)("No login logs")}),c=(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("table",{className:"table-hover",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"25%",children:(0,p.AP)("Name")}),(0,x.jsx)("th",{width:"25%",children:(0,p.AP)("IP")}),(0,x.jsx)("th",{width:"25%",children:(0,p.AP)("Status")}),(0,x.jsx)("th",{width:"25%",children:(0,p.AP)("Time")})]})}),i&&(0,x.jsx)("tbody",{children:i.map((function(e,t){return(0,x.jsx)(Ls,{item:e},t)}))})]}),(0,x.jsx)(X.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:a,hasNextPage:r,curPerPage:s,resetPerPage:this.props.resetPerPage})]});return i.length?c:o}}])}(l.Component),Ls=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleMouseOver=function(){n.setState({isOpIconShown:!0})},n.handleMouseOut=function(){n.setState({isOpIconShown:!1})},n.state={isOpIconShown:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.item;return(0,x.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,children:[(0,x.jsx)("td",{children:(0,x.jsx)(Se,{email:e.email,name:e.name})}),(0,x.jsx)("td",{children:e.login_ip}),(0,x.jsx)("td",{children:e.log_success?(0,p.AP)("Success"):(0,p.AP)("Failed")}),(0,x.jsx)("td",{children:M()(e.login_time).fromNow()})]})}}])}(l.Component),Os=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).toggleExportExcelDialog=function(){n.setState({isExportExcelDialogOpen:!n.state.isExportExcelDialogOpen})},n.getLogsByPage=function(e){var t=n.state,i=t.perPage,s=t.selectedUsers.map((function(e){return e.email}));S.H.sysAdminListLoginLogs(e,i,{email:s}).then((function(t){n.setState({logList:t.data.login_log_list,loading:!1,currentPage:e,hasNextPage:f.Aq.hasNextPage(e,i,t.data.total_count)})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){return n.getLogsByPage(n.initPage)}))},n.handleUserFilter=function(e){var t,i=n.state.selectedUsers;null===e?t=i:t=i.find((function(t){return t.email===e.email}))?i.filter((function(t){return t.email!==e.email})):[].concat((0,fi.default)(i),[e]);n.setState({selectedUsers:t,currentPage:1})},n.toggleUserSelector=function(){var e=n.state.isUserSelectorOpen;n.setState({isUserSelectorOpen:!e},(function(){n.state.isUserSelectorOpen||n.getLogsByPage(1)}))},n.searchUsers=function(e){return S.H.sysAdminSearchUsers(e)},n.state={loading:!0,errorMsg:"",logList:[],perPage:100,currentPage:1,hasNextPage:!1,isExportExcelDialogOpen:!1,availableUsers:[],selectedUsers:[],isUserSelectorOpen:!1},n.initPage=1,n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,i=n.currentPage,s=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||s),currentPage:parseInt(t.get("page")||i)},(function(){e.getLogsByPage(e.state.currentPage)}))}},{key:"render",value:function(){var e=this.state,t=e.logList,n=e.currentPage,s=e.perPage,a=e.hasNextPage,r=e.isExportExcelDialogOpen,o=e.availableUsers,c=e.selectedUsers;return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)((0,i.default)({},this.props),{},{children:(0,x.jsx)(j.A,{className:"btn btn-secondary operation-item",onClick:this.toggleExportExcelDialog,children:(0,p.AP)("Export Excel")})})),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(Ds,{currentItem:"loginLogs"}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(Ms,{componentName:(0,p.AP)("Users"),items:o,selectedItems:c,onSelect:this.handleUserFilter,isOpen:this.state.isUserSelectorOpen,onToggle:this.toggleUserSelector,searchUsersFunc:this.searchUsers}),(0,x.jsx)(Cs,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:t,currentPage:n,perPage:s,hasNextPage:a,getLogsByPage:this.getLogsByPage,resetPerPage:this.resetPerPage})]})})]})}),r&&(0,x.jsx)(en.A,{children:(0,x.jsx)(Is,{logType:"login",toggle:this.toggleExportExcelDialog})})]})}}])}(l.Component),Ts=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleClickOutside=function(e){n.props.isOpen&&!n.repoSelector.contains(e.target)&&n.props.onToggle()},n.onToggleClick=function(e){e.stopPropagation(),n.props.onToggle()},n.onQueryChange=function(e){var t=e.target.value;n.setState({query:t}),n.searchRepos(t)},n.searchRepos=function(e){n.finalValue=e,e.length>0?(n.setState({isLoading:!0}),setTimeout((function(){n.finalValue===e&&n.props.searchReposFunc(e).then((function(e){var t=e.data.repo_list||e.data.repos||[];n.setState({searchResults:t,isLoading:!1})})).catch((function(e){n.setState({isLoading:!1});var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))}),500)):n.setState({searchResults:[]})},n.toggleSelectItem=function(e,t){e.stopPropagation(),n.props.onSelect(t,!1)},n.state={query:"",isLoading:!1,searchResults:[]},n.dropdownRef=l.createRef(),n.finalValue="",n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.handleClickOutside)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.handleClickOutside)}},{key:"render",value:function(){var e=this,t=this.state,n=t.query,i=t.isLoading,s=t.searchResults,a=this.props,r=a.selectedItems,o=a.isOpen,l=n.trim()?s:this.props.items;return(0,x.jsxs)("div",{className:"position-relative d-inline-block",ref:this.dropdownRef,children:[(0,x.jsxs)("span",{className:"cur-activity-modifiers d-inline-block p-2 rounded",onClick:this.onToggleClick,children:[r.length>0?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("span",{children:[(0,p.AP)("Libraries"),":"]}),(0,x.jsx)("span",{className:"d-inline-block ml-1",children:r.map((function(e){return e.name})).join(", ")})]}):(0,p.AP)("Libraries"),(0,x.jsx)("i",{className:"sf3-font sf3-font-down ml-2 toggle-icon"})]}),o&&(0,x.jsxs)("div",{className:"position-absolute activity-modifier-selector-container rounded shadow",ref:function(t){return e.repoSelector=t},children:[(0,x.jsx)("ul",{className:"activity-selected-modifiers px-3 py-1 list-unstyled",children:r.map((function(t,n){return(0,x.jsxs)("li",{className:"activity-selected-modifier",children:[(0,x.jsx)("i",{className:"fas fa-folder"}),(0,x.jsx)("span",{className:"activity-user-name ml-2",children:t.name}),(0,x.jsx)("i",{className:"sf2-icon-close unselect-activity-user ml-2",onClick:function(n){e.toggleSelectItem(n,t)}})]},n)}))}),(0,x.jsx)("div",{className:"px-3 pt-3",children:(0,x.jsx)(W.A,{type:"text",placeholder:(0,p.AP)("Find libraries"),value:n,onChange:this.onQueryChange})}),(0,x.jsx)("ul",{className:"activity-user-list list-unstyled p-3 o-auto",children:i?(0,x.jsx)("li",{className:"text-center",children:(0,p.AP)("Loading...")}):0===l.length?(0,x.jsx)("li",{className:"text-center",children:n?(0,p.AP)("Library not found"):(0,p.AP)("Enter characters to start searching")}):l.map((function(t,n){var i=r.some((function(e){return e.id===t.id}));return(0,x.jsxs)("li",{className:"activity-user-item h-6 p-1 rounded d-flex justify-content-between align-items-center",onClick:function(n){e.toggleSelectItem(n,t)},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("i",{className:"fas fa-folder"}),(0,x.jsx)("span",{className:"activity-user-name ml-2",children:t.name})]}),i&&(0,x.jsx)("i",{className:"sf2-icon-tick text-gray font-weight-bold"})]},n)}))})]})]})}}])}(l.Component),Rs=Ts;M().extend(ge());var Us=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).getPreviousPage=function(){n.props.getLogsByPage(n.props.currentPage-1)},n.getNextPage=function(){n.props.getLogsByPage(n.props.currentPage+1)},n.toggleFreezeItem=function(e){n.setState({isItemFreezed:e})},n.state={isItemFreezed:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,i=t.errorMsg,s=t.items,a=t.perPage,r=t.currentPage,o=t.hasNextPage;if(n)return(0,x.jsx)(D.A,{});if(i)return(0,x.jsx)("p",{className:"error text-center",children:i});var c=(0,x.jsx)(me.A,{text:(0,p.AP)("No file access logs")}),d=(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("table",{children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"20%",children:(0,p.AP)("Name")}),(0,x.jsx)("th",{width:"10%",children:(0,p.AP)("Type")}),(0,x.jsxs)("th",{width:"20%",children:[(0,p.AP)("IP")," / ",(0,p.AP)("Device")]}),(0,x.jsx)("th",{width:"20%",children:(0,p.AP)("Date")}),(0,x.jsx)("th",{width:"15%",children:(0,p.AP)("Library")}),(0,x.jsxs)("th",{width:"15%",children:[(0,p.AP)("File")," / ",(0,p.AP)("Folder")]})]})}),s&&(0,x.jsx)("tbody",{children:s.map((function(t,n){return(0,x.jsx)(Fs,{item:t,isFreezed:e.state.isItemFreezed,toggleFreezeItem:e.toggleFreezeItem},n)}))})]}),(0,x.jsx)(X.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:r,hasNextPage:o,curPerPage:a,resetPerPage:this.props.resetPerPage})]});return s.length?d:c}}])}(l.Component),Fs=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleMouseEnter=function(){n.props.isFreezed||n.setState({isHighlighted:!0})},n.handleMouseLeave=function(){n.props.isFreezed||n.setState({isHighlighted:!1})},n.toggleFreezeItem=function(e){n.props.toggleFreezeItem(e),e||n.setState({isHighlighted:!1})},n.state={isHighlighted:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.state.isHighlighted,t=this.props.item;return(0,x.jsxs)("tr",{className:e?"tr-highlight":"",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,x.jsx)("td",{children:(0,x.jsx)(Se,{email:t.email,name:t.name})}),(0,x.jsx)("td",{children:t.event_type}),(0,x.jsxs)("td",{children:[t.ip," / ",t.device||"--"]}),(0,x.jsx)("td",{children:M()(t.time).fromNow()}),(0,x.jsx)("td",{children:t.repo_name?t.repo_name:(0,p.AP)("Deleted")}),(0,x.jsx)("td",{children:t.file_or_dir_name})]})}}])}(l.Component),Es=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).toggleExportExcelDialog=function(){n.setState({isExportExcelDialogOpen:!n.state.isExportExcelDialogOpen})},n.getLogsByPage=function(e){var t=n.state,i=t.perPage,s=t.selectedUsers,a=t.selectedRepos,r=s.map((function(e){return e.email})),o=a.map((function(e){return e.id}));S.H.sysAdminListFileAccessLogs(e,i,{email:r,repo:o}).then((function(t){n.setState({logList:t.data.file_access_log_list,loading:!1,currentPage:e,hasNextPage:t.data.has_next_page})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){return n.getLogsByPage(n.initPage)}))},n.updateURL=function(e){var t=new URL(location.href),n=new URLSearchParams(t.search);for(var i in e)null==e[i]?n.delete(i):n.set(i,e[i]);t.search=n.toString(),(0,h.oo)(t.toString())},n.handleUserFilter=function(e){var t,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=n.state.selectedUsers;null===e?t=s:t=s.find((function(t){return t.email===e.email}))?s.filter((function(t){return t.email!==e.email})):[].concat((0,fi.default)(s),[e]);n.setState({selectedUsers:t,currentPage:1},(function(){i&&n.getLogsByPage(1)}))},n.handleRepoFilter=function(e){var t,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=n.state.selectedRepos;null===e?t=[]:t=s.find((function(t){return t.id===e.id}))?s.filter((function(t){return t.id!==e.id})):[].concat((0,fi.default)(s),[e]);n.setState({selectedRepos:t,currentPage:1},(function(){i&&n.getLogsByPage(1)}))},n.handleSelectorToggle=function(e){var t=n.state.openSelector===e;n.setState({openSelector:t?null:e},(function(){t&&n.getLogsByPage(1)}))},n.searchUsers=function(e){return S.H.sysAdminSearchUsers(e)},n.searchRepos=function(e){return S.H.sysAdminSearchRepos(e)},n.state={loading:!0,errorMsg:"",logList:[],perPage:100,currentPage:1,hasNextPage:!1,isExportExcelDialogOpen:!1,availableUsers:[],selectedUsers:[],availableRepos:[],selectedRepos:[],openSelector:null},n.initPage=1,n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,i=n.currentPage,s=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||s),currentPage:parseInt(t.get("page")||i)},(function(){e.getLogsByPage(e.state.currentPage)}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.logList,s=t.currentPage,a=t.perPage,r=t.hasNextPage,o=t.isExportExcelDialogOpen,c=t.availableUsers,d=t.selectedUsers,u=t.availableRepos,h=t.selectedRepos,g=t.openSelector;return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)((0,i.default)({},this.props),{},{children:(0,x.jsx)(j.A,{className:"btn btn-secondary operation-item",onClick:this.toggleExportExcelDialog,children:(0,p.AP)("Export Excel")})})),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(Ds,{currentItem:"fileAccessLogs"}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("div",{className:"d-flex align-items-center mb-2",children:[(0,x.jsx)(Ms,{componentName:(0,p.AP)("Users"),items:c,selectedItems:d,onSelect:this.handleUserFilter,isOpen:"user"===g,onToggle:function(){return e.handleSelectorToggle("user")},searchUsersFunc:this.searchUsers}),(0,x.jsx)("div",{className:"mx-3"}),(0,x.jsx)(Rs,{items:u,selectedItems:h,onSelect:this.handleRepoFilter,isOpen:"repo"===g,onToggle:function(){return e.handleSelectorToggle("repo")},searchReposFunc:this.searchRepos})]}),(0,x.jsx)(Us,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:n,currentPage:s,perPage:a,hasNextPage:r,getLogsByPage:this.getLogsByPage,resetPerPage:this.resetPerPage})]})})]})}),o&&(0,x.jsx)(en.A,{children:(0,x.jsx)(Is,{logType:"fileAccess",toggle:this.toggleExportExcelDialog})})]})}}])}(l.Component),zs=Es,Bs=n(33e3);M().extend(ge());var Hs=function(e){function t(){var e;(0,s.default)(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=(0,r.default)(this,t,[].concat(i))).getPreviousPage=function(){e.props.getLogsByPage(e.props.currentPage-1)},e.getNextPage=function(){e.props.getLogsByPage(e.props.currentPage+1)},e}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg,i=e.items,s=e.perPage,a=e.currentPage,r=e.hasNextPage;if(t)return(0,x.jsx)(D.A,{});if(n)return(0,x.jsx)("p",{className:"error text-center",children:n});var o=(0,x.jsx)(me.A,{text:(0,p.AP)("No file update logs")}),c=(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("table",{className:"table-hover",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"25%",children:(0,p.AP)("Name")}),(0,x.jsx)("th",{width:"25%",children:(0,p.AP)("Date")}),(0,x.jsx)("th",{width:"25%",children:(0,p.AP)("Library")}),(0,x.jsx)("th",{width:"25%",children:(0,p.AP)("Action")})]})}),i&&(0,x.jsx)("tbody",{children:i.map((function(e,t){return(0,x.jsx)(qs,{item:e},t)}))})]}),(0,x.jsx)(X.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:a,hasNextPage:r,curPerPage:s,resetPerPage:this.props.resetPerPage})]});return i.length?c:o}}])}(l.Component),qs=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleMouseOver=function(){n.setState({isOpIconShown:!0})},n.handleMouseOut=function(){n.setState({isOpIconShown:!1})},n.toggleCommitDetailsDialog=function(){n.setState({isCommitDetailsDialogOpen:!n.state.isCommitDetailsDialogOpen})},n.showCommitDetails=function(e){e.preventDefault(),n.setState({isCommitDetailsDialogOpen:!n.state.isCommitDetailsDialogOpen})},n.state={isOpIconShown:!1,isCommitDetailsDialogOpen:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.item;return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,children:[(0,x.jsx)("td",{children:(0,x.jsx)(Se,{email:e.email,name:e.name})}),(0,x.jsx)("td",{children:M()(e.time).fromNow()}),(0,x.jsx)("td",{children:e.repo_name?e.repo_name:(0,p.AP)("Deleted")}),(0,x.jsxs)("td",{children:[e.file_operation,e.repo_name&&!e.repo_encrypted&&(0,x.jsx)("a",{className:"ml-1",href:"#",onClick:this.showCommitDetails,children:(0,p.AP)("Details")})]})]}),this.state.isCommitDetailsDialogOpen&&(0,x.jsx)(en.A,{children:(0,x.jsx)(Bs.A,{repoID:e.repo_id,commitID:e.commit_id,commitTime:e.time,toggleDialog:this.toggleCommitDetailsDialog})})]})}}])}(l.Component),Ys=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).toggleExportExcelDialog=function(){n.setState({isExportExcelDialogOpen:!n.state.isExportExcelDialogOpen})},n.getLogsByPage=function(e){var t=n.state,i=t.perPage,s=t.selectedUsers,a=t.selectedRepos,r=s.map((function(e){return e.email})),o=a.map((function(e){return e.id}));S.H.sysAdminListFileUpdateLogs(e,i,{email:r,repo:o}).then((function(t){n.setState({logList:t.data.file_update_log_list,loading:!1,currentPage:e,hasNextPage:t.data.has_next_page})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){return n.getLogsByPage(n.initPage)}))},n.handleUserFilter=function(e){var t,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=n.state.selectedUsers;null===e?t=s:t=s.find((function(t){return t.email===e.email}))?s.filter((function(t){return t.email!==e.email})):[].concat((0,fi.default)(s),[e]);n.setState({selectedUsers:t,currentPage:1},(function(){i&&n.getLogsByPage(1)}))},n.handleSelectorToggle=function(e){var t=n.state.openSelector===e;n.setState({openSelector:t?null:e},(function(){t&&n.getLogsByPage(1)}))},n.handleRepoFilter=function(e){var t,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=n.state.selectedRepos;null===e?t=s:t=s.find((function(t){return t.id===e.id}))?s.filter((function(t){return t.id!==e.id})):[].concat((0,fi.default)(s),[e]);n.setState({selectedRepos:t,currentPage:1},(function(){i&&n.getLogsByPage(1)}))},n.searchUsers=function(e){return S.H.sysAdminSearchUsers(e)},n.searchRepos=function(e){return S.H.sysAdminSearchRepos(e)},n.state={loading:!0,errorMsg:"",logList:[],perPage:100,currentPage:1,hasNextPage:!1,isExportExcelDialogOpen:!1,availableUsers:[],selectedUsers:[],availableRepos:[],selectedRepos:[],openSelector:null},n.initPage=1,n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,i=n.currentPage,s=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||s),currentPage:parseInt(t.get("page")||i)},(function(){e.getLogsByPage(e.state.currentPage)}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.logList,s=t.currentPage,a=t.perPage,r=t.hasNextPage,o=t.isExportExcelDialogOpen,c=t.availableUsers,d=t.selectedUsers,u=t.availableRepos,h=t.selectedRepos;return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)((0,i.default)({},this.props),{},{children:(0,x.jsx)(j.A,{className:"btn btn-secondary operation-item",onClick:this.toggleExportExcelDialog,children:(0,p.AP)("Export Excel")})})),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(Ds,{currentItem:"fileUpdateLogs"}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("div",{className:"d-flex align-items-center mb-2",children:[(0,x.jsx)(Ms,{componentName:(0,p.AP)("Users"),items:c,selectedItems:d,onSelect:this.handleUserFilter,isOpen:"user"===this.state.openSelector,onToggle:function(){return e.handleSelectorToggle("user")},searchUsersFunc:this.searchUsers}),(0,x.jsx)("div",{className:"mx-3"}),(0,x.jsx)(Rs,{items:u,selectedItems:h,onSelect:this.handleRepoFilter,isOpen:"repo"===this.state.openSelector,onToggle:function(){return e.handleSelectorToggle("repo")},searchReposFunc:this.searchRepos})]}),(0,x.jsx)(Hs,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:n,currentPage:s,perPage:a,hasNextPage:r,getLogsByPage:this.getLogsByPage,resetPerPage:this.resetPerPage})]})})]})}),o&&(0,x.jsx)(en.A,{children:(0,x.jsx)(Is,{logType:"fileUpdate",toggle:this.toggleExportExcelDialog})})]})}}])}(l.Component),Vs=Ys;M().extend(ge());var Gs=function(e){function t(){var e;(0,s.default)(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=(0,r.default)(this,t,[].concat(i))).getPreviousPage=function(){e.props.getLogsByPage(e.props.currentPage-1)},e.getNextPage=function(){e.props.getLogsByPage(e.props.currentPage+1)},e}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg,i=e.items,s=e.perPage,a=e.currentPage,r=e.hasNextPage;if(t)return(0,x.jsx)(D.A,{});if(n)return(0,x.jsx)("p",{className:"error text-center",children:n});var o=(0,x.jsx)(me.A,{text:(0,p.AP)("No permission logs")}),c=(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("table",{className:"table-hover",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"15%",children:(0,p.AP)("Share From")}),(0,x.jsx)("th",{width:"15%",children:(0,p.AP)("Share To")}),(0,x.jsx)("th",{width:"10%",children:(0,p.AP)("Actions")}),(0,x.jsx)("th",{width:"13%",children:(0,p.AP)("Permission")}),(0,x.jsx)("th",{width:"20%",children:(0,p.AP)("Library")}),(0,x.jsx)("th",{width:"12%",children:(0,p.AP)("Folder")}),(0,x.jsx)("th",{width:"15%",children:(0,p.AP)("Date")})]})}),i&&(0,x.jsx)("tbody",{children:i.map((function(e,t){return(0,x.jsx)(Ws,{item:e},t)}))})]}),(0,x.jsx)(X.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:a,hasNextPage:r,curPerPage:s,resetPerPage:this.props.resetPerPage})]});return i.length?c:o}}])}(l.Component),Ws=function(e){function t(){var e;(0,s.default)(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=(0,r.default)(this,t,[].concat(i))).getActionTextByEType=function(e){return-1!=e.indexOf("add")?(0,p.AP)("Add"):-1!=e.indexOf("modify")?(0,p.AP)("Modify"):-1!=e.indexOf("delete")?(0,p.AP)("Delete"):""},e.getShareTo=function(e){switch(e.share_type){case"user":return(0,x.jsx)(Se,{email:e.to_user_email,name:e.to_user_name});case"group":case"department":return(0,x.jsx)(h.N_,{to:"".concat(p.Yc,"sys/groups/").concat(e.to_group_id,"/libraries/"),children:e.to_group_name});case"all":return(0,x.jsx)(h.N_,{to:"".concat(p.Yc,"org/"),children:(0,p.AP)("All")});default:return(0,p.AP)("Deleted")}},e}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.item;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:(0,x.jsx)(Se,{email:e.from_user_email,name:e.from_user_name})}),(0,x.jsx)("td",{children:this.getShareTo(e)}),(0,x.jsx)("td",{children:this.getActionTextByEType(e.etype)}),(0,x.jsx)("td",{children:f.Aq.sharePerms(e.permission)}),(0,x.jsx)("td",{children:e.repo_name?e.repo_name:(0,p.AP)("Deleted")}),(0,x.jsx)("td",{children:e.folder}),(0,x.jsx)("td",{children:M()(e.date).fromNow()})]})}}])}(l.Component),Qs=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).toggleExportExcelDialog=function(){n.setState({isExportExcelDialogOpen:!n.state.isExportExcelDialogOpen})},n.getLogsByPage=function(e){var t=n.state,i=t.perPage,s=t.selectedFromUsers,a=t.selectedToUsers,r=t.selectedToGroups,o=t.selectedRepos,l={from_email:s.map((function(e){return e.email})),to_email:a.map((function(e){return e.email})),to_group:r.map((function(e){return e.id})),repo:o.map((function(e){return e.id}))};S.H.sysAdminListSharePermissionLogs(e,i,l).then((function(t){n.setState({logList:t.data.share_permission_log_list,loading:!1,currentPage:e,hasNextPage:t.data.has_next_page})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){return n.getLogsByPage(n.initPage)}))},n.handleFromUserFilter=function(e){var t,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=n.state.selectedFromUsers;null===e?t=s:t=s.find((function(t){return t.email===e.email}))?s.filter((function(t){return t.email!==e.email})):[].concat((0,fi.default)(s),[e]);n.setState({selectedFromUsers:t,currentPage:1},(function(){i&&n.getLogsByPage(1)}))},n.handleToUserFilter=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=n.state,s=i.selectedToUsers,a=i.selectedToGroups,r=s,o=a;null===e?(r=s,o=a):e.email?r=s.find((function(t){return t.email===e.email}))?s.filter((function(t){return t.email!==e.email})):[].concat((0,fi.default)(s),[e]):o=a.find((function(t){return t.id===e.id}))?a.filter((function(t){return t.id!==e.id})):[].concat((0,fi.default)(a),[e]);n.setState({selectedToUsers:r,selectedToGroups:o,currentPage:1},(function(){t&&n.getLogsByPage(1)}))},n.handleSelectorToggle=function(e){var t=n.state.openSelector===e;n.setState({openSelector:t?null:e},(function(){t&&n.getLogsByPage(1)}))},n.handleRepoFilter=function(e){var t,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=n.state.selectedRepos;null===e?t=s:t=s.find((function(t){return t.id===e.id}))?s.filter((function(t){return t.id!==e.id})):[].concat((0,fi.default)(s),[e]);n.setState({selectedRepos:t,currentPage:1},(function(){i&&n.getLogsByPage(1)}))},n.searchUsers=function(e){return S.H.sysAdminSearchUsers(e)},n.searchRepos=function(e){return S.H.sysAdminSearchRepos(e)},n.searchGroups=function(e){return S.H.sysAdminSearchGroups(e)},n.state={loading:!0,errorMsg:"",logList:[],perPage:100,currentPage:1,hasNextPage:!1,isExportExcelDialogOpen:!1,availableUsers:[],selectedFromUsers:[],selectedToUsers:[],selectedToGroups:[],availableRepos:[],selectedRepos:[],openSelector:null},n.initPage=1,n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,i=n.currentPage,s=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||s),currentPage:parseInt(t.get("page")||i)},(function(){e.getLogsByPage(e.state.currentPage)}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.logList,s=t.currentPage,a=t.perPage,r=t.hasNextPage,o=t.isExportExcelDialogOpen,c=t.availableUsers,d=t.selectedFromUsers,u=t.selectedToUsers,h=t.selectedToGroups,g=t.availableRepos,f=t.selectedRepos,m=t.openSelector;return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)((0,i.default)({},this.props),{},{children:(0,x.jsx)(j.A,{className:"btn btn-secondary operation-item",onClick:this.toggleExportExcelDialog,children:(0,p.AP)("Export Excel")})})),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(Ds,{currentItem:"sharePermissionLogs"}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("div",{className:"d-flex align-items-center mb-2",children:[(0,x.jsx)(Ms,{componentName:(0,p.AP)("Share From"),items:c,selectedItems:d,onSelect:this.handleFromUserFilter,isOpen:"fromUser"===m,onToggle:function(){return e.handleSelectorToggle("fromUser")},searchUsersFunc:this.searchUsers}),(0,x.jsx)(Ms,{componentName:(0,p.AP)("Share To"),items:c,selectedItems:[].concat((0,fi.default)(u),(0,fi.default)(h)),onSelect:this.handleToUserFilter,isOpen:"toUser"===m,onToggle:function(){return e.handleSelectorToggle("toUser")},searchUsersFunc:this.searchUsers,searchGroupsFunc:this.searchGroups}),(0,x.jsx)("div",{className:"mx-3"}),(0,x.jsx)(Rs,{items:g,selectedItems:f,onSelect:this.handleRepoFilter,isOpen:"repo"===m,onToggle:function(){return e.handleSelectorToggle("repo")},searchReposFunc:this.searchRepos})]}),(0,x.jsx)(Gs,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:n,currentPage:s,perPage:a,hasNextPage:r,getLogsByPage:this.getLogsByPage,resetPerPage:this.resetPerPage})]})})]})}),o&&(0,x.jsx)(en.A,{children:(0,x.jsx)(Is,{logType:"sharePermission",toggle:this.toggleExportExcelDialog})})]})}}])}(l.Component),Ks=Qs;M().extend(ge());var $s=function(e){function t(){var e;(0,s.default)(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=(0,r.default)(this,t,[].concat(i))).getPreviousPage=function(){e.props.getLogsByPage(e.props.currentPage-1)},e.getNextPage=function(){e.props.getLogsByPage(e.props.currentPage+1)},e}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg,i=e.items,s=e.perPage,a=e.currentPage,r=e.hasNextPage;if(t)return(0,x.jsx)(D.A,{});if(n)return(0,x.jsx)("p",{className:"error text-center",children:n});var o=(0,x.jsx)(me.A,{text:(0,p.AP)("No transfer logs")}),c=(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("table",{className:"table-hover",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"20%",children:(0,p.AP)("Transfer From")}),(0,x.jsx)("th",{width:"20%",children:(0,p.AP)("Transfer To")}),(0,x.jsx)("th",{width:"20%",children:(0,p.AP)("Operator")}),(0,x.jsx)("th",{width:"25%",children:(0,p.AP)("Library")}),(0,x.jsx)("th",{width:"15%",children:(0,p.AP)("Date")})]})}),i&&(0,x.jsx)("tbody",{children:i.map((function(e,t){return(0,x.jsx)(Xs,{item:e},t)}))})]}),(0,x.jsx)(X.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:a,hasNextPage:r,curPerPage:s,resetPerPage:this.props.resetPerPage})]});return i.length?c:o}}])}(l.Component),Xs=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleMouseOver=function(){n.setState({isOpIconShown:!0})},n.handleMouseOut=function(){n.setState({isOpIconShown:!1})},n.getTransferTo=function(e){switch(e.to_type){case"user":return(0,x.jsx)(Se,{email:e.to_user_email,name:e.to_user_name});case"group":return(0,x.jsx)(h.N_,{to:"".concat(p.Yc,"sys/groups/").concat(e.to_group_id,"/libraries/"),children:e.to_group_name});default:return(0,p.AP)("Deleted")}},n.getTransferFrom=function(e){switch(e.from_type){case"user":return(0,x.jsx)(Se,{email:e.from_user_email,name:e.from_user_name});case"group":return(0,x.jsx)(h.N_,{to:"".concat(p.Yc,"sys/groups/").concat(e.from_group_id,"/libraries/"),children:e.from_group_name});default:return(0,p.AP)("Deleted")}},n.getOperator=function(e){return(0,x.jsx)(Se,{email:e.operator_email,name:e.operator_name})},n.state={isOpIconShown:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.item;return(0,x.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,children:[(0,x.jsx)("td",{children:this.getTransferFrom(e)}),(0,x.jsx)("td",{children:this.getTransferTo(e)}),(0,x.jsx)("td",{children:this.getOperator(e)}),(0,x.jsx)("td",{children:e.repo_name?e.repo_name:(0,p.AP)("Deleted")}),(0,x.jsx)("td",{children:M()(e.date).fromNow()})]})}}])}(l.Component),Zs=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).getLogsByPage=function(e){var t=n.state,i=t.perPage,s=t.selectedFromUsers,a=t.selectedToUsers,r=t.selectedToGroups,o=t.selectedOperators,l=t.selectedRepos,c={from_email:s.filter((function(e){return e.email})).map((function(e){return e.email})),from_group:s.filter((function(e){return!e.email})).map((function(e){return e.id})),to_email:a.map((function(e){return e.email})),to_group:r.map((function(e){return e.to_group_id||e.id})),operator_email:o.map((function(e){return e.email})),repo:l.map((function(e){return e.id}))};S.H.sysAdminListFileTransferLogs(e,i,c).then((function(t){n.setState({logList:t.data.repo_transfer_log_list,loading:!1,currentPage:e,hasNextPage:t.data.has_next_page})})).catch((function(t){n.setState({loading:!1,currentPage:e,errorMsg:f.Aq.getErrorMsg(t,!0)})}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){return n.getLogsByPage(n.initPage)}))},n.handleFromUserFilter=function(e){var t,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=n.state.selectedFromUsers;if(null===e)t=s;else if(e.email){t=s.find((function(t){return t.email===e.email}))?s.filter((function(t){return t.email!==e.email})):[].concat((0,fi.default)(s),[e])}else{var a=e.id;if(s.find((function(e){return e.id===a})))t=s.filter((function(e){return e.id!==a}));else{var r={id:a,name:e.name,from_group_id:a,from_group_name:e.name};t=[].concat((0,fi.default)(s),[r])}}n.setState({selectedFromUsers:t,currentPage:1},(function(){i&&n.getLogsByPage(1)}))},n.handleToUserFilter=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=n.state,s=i.selectedToUsers,a=i.selectedToGroups,r=s,o=a;if(null===e)r=s,o=a;else if(e.email){r=s.find((function(t){return t.email===e.email}))?s.filter((function(t){return t.email!==e.email})):[].concat((0,fi.default)(s),[e])}else{var l=e.to_group_id||e.id,c=e.to_group_name||e.name;if(a.find((function(e){return(e.to_group_id||e.id)===l})))o=a.filter((function(e){return(e.to_group_id||e.id)!==l}));else{var d={id:l,name:c,to_group_id:l,to_group_name:c};o=[].concat((0,fi.default)(a),[d])}}n.setState({selectedToUsers:r,selectedToGroups:o,currentPage:1},(function(){t&&n.getLogsByPage(1)}))},n.handleOperatorFilter=function(e){var t,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=n.state.selectedOperators;null===e?t=s:t=s.find((function(t){return t.email===e.email}))?s.filter((function(t){return t.email!==e.email})):[].concat((0,fi.default)(s),[e]);n.setState({selectedOperators:t,currentPage:1},(function(){i&&n.getLogsByPage(1)}))},n.handleSelectorToggle=function(e){var t=n.state.openSelector===e;n.setState({openSelector:t?null:e},(function(){t&&n.getLogsByPage(1)}))},n.handleRepoFilter=function(e){var t,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=n.state.selectedRepos;null===e?t=[]:t=s.find((function(t){return t.id===e.id}))?s.filter((function(t){return t.id!==e.id})):[].concat((0,fi.default)(s),[e]);n.setState({selectedRepos:t,currentPage:1},(function(){i&&n.getLogsByPage(1)}))},n.searchUsers=function(e){return S.H.sysAdminSearchUsers(e)},n.searchGroups=function(e){return S.H.sysAdminSearchGroups(e)},n.searchRepos=function(e){return S.H.sysAdminSearchRepos(e)},n.state={loading:!0,errorMsg:"",logList:[],perPage:100,currentPage:1,hasNextPage:!1,availableUsers:[],selectedFromUsers:[],selectedToUsers:[],selectedToGroups:[],selectedOperators:[],openSelector:null,availableRepos:[],selectedRepos:[]},n.initPage=1,n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,i=n.currentPage,s=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||s),currentPage:parseInt(t.get("page")||i)},(function(){e.getLogsByPage(e.state.currentPage)}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.logList,s=t.currentPage,a=t.perPage,r=t.hasNextPage,o=t.availableUsers,c=t.selectedFromUsers,d=t.selectedToUsers,u=t.selectedToGroups,h=t.selectedOperators,g=t.availableRepos,f=t.selectedRepos,m=t.openSelector,v=[].concat((0,fi.default)(d),(0,fi.default)(u.map((function(e){return{id:e.to_group_id||e.id,name:e.to_group_name||e.name,to_group_id:e.to_group_id||e.id,to_group_name:e.to_group_name||e.name}}))));return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(Ds,{currentItem:"fileTransfer"}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("div",{className:"d-flex align-items-center mb-2",children:[(0,x.jsx)(Ms,{componentName:(0,p.AP)("Transfer From"),items:o,selectedItems:c,onSelect:this.handleFromUserFilter,isOpen:"fromUser"===m,onToggle:function(){return e.handleSelectorToggle("fromUser")},searchUsersFunc:this.searchUsers,searchGroupsFunc:this.searchGroups}),(0,x.jsx)(Ms,{componentName:(0,p.AP)("Transfer To"),items:o,selectedItems:v,onSelect:this.handleToUserFilter,isOpen:"toUser"===m,onToggle:function(){return e.handleSelectorToggle("toUser")},searchUsersFunc:this.searchUsers,searchGroupsFunc:this.searchGroups}),(0,x.jsx)(Ms,{componentName:(0,p.AP)("Operator"),items:o,selectedItems:h,onSelect:this.handleOperatorFilter,isOpen:"operator"===m,onToggle:function(){return e.handleSelectorToggle("operator")},searchUsersFunc:this.searchUsers}),(0,x.jsx)("div",{className:"mx-3"}),(0,x.jsx)(Rs,{items:g,selectedItems:f,onSelect:this.handleRepoFilter,isOpen:"repo"===m,onToggle:function(){return e.handleSelectorToggle("repo")},searchReposFunc:this.searchRepos})]}),(0,x.jsx)($s,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:n,currentPage:s,perPage:a,hasNextPage:r,getLogsByPage:this.getLogsByPage,resetPerPage:this.resetPerPage})]})})]})})]})}}])}(l.Component),Js=Zs;M().extend(ge());var ea=function(e){function t(){var e;(0,s.default)(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=(0,r.default)(this,t,[].concat(i))).getPreviousPage=function(){e.props.getLogsByPage(e.props.currentPage-1)},e.getNextPage=function(){e.props.getLogsByPage(e.props.currentPage+1)},e}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg,i=e.items,s=e.perPage,a=e.currentPage,r=e.hasNextPage;if(t)return(0,x.jsx)(D.A,{});if(n)return(0,x.jsx)("p",{className:"error text-center",children:n});var o=(0,x.jsx)(me.A,{text:(0,p.AP)("No group invite logs")}),c=(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("table",{className:"table-hover",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"20%",children:(0,p.AP)("User")}),(0,x.jsx)("th",{width:"20%",children:(0,p.AP)("Group")}),(0,x.jsx)("th",{width:"20%",children:(0,p.AP)("Operator")}),(0,x.jsx)("th",{width:"25%",children:(0,p.AP)("Action")}),(0,x.jsx)("th",{width:"15%",children:(0,p.AP)("Date")})]})}),i&&(0,x.jsx)("tbody",{children:i.map((function(e,t){return(0,x.jsx)(ta,{item:e},t)}))})]}),(0,x.jsx)(X.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:a,hasNextPage:r,curPerPage:s,resetPerPage:this.props.resetPerPage})]});return i.length?c:o}}])}(l.Component),ta=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleMouseOver=function(){n.setState({isOpIconShown:!0})},n.handleMouseOut=function(){n.setState({isOpIconShown:!1})},n.getGroupName=function(e){return e.group_name?(0,x.jsx)(h.N_,{to:"".concat(p.Yc,"sys/groups/").concat(e.group_id,"/libraries/"),children:e.group_name}):(0,p.AP)("Deleted")},n.getActionTextByEType=function(e){return-1!=e.indexOf("group_member_add")?(0,p.AP)("Add member"):-1!=e.indexOf("group_member_delete")?(0,p.AP)("Delete member"):""},n.state={isOpIconShown:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.item;return(0,x.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,children:[(0,x.jsx)("td",{children:(0,x.jsx)(Se,{email:e.user_email,name:e.user_name})}),(0,x.jsx)("td",{children:this.getGroupName(e)}),(0,x.jsx)("td",{children:(0,x.jsx)(Se,{email:e.operator_email,name:e.operator_name})}),(0,x.jsx)("td",{children:this.getActionTextByEType(e.operation)}),(0,x.jsx)("td",{children:M()(e.date).fromNow()})]})}}])}(l.Component),na=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).getLogsByPage=function(e){var t=n.state,i=t.perPage,s=t.selectedUsers,a=t.selectedOperators,r=t.selectedGroups,o={user_email:s.map((function(e){return e.email})),operator_email:a.map((function(e){return e.email})),group_id:r.map((function(e){return e.id}))};S.H.sysAdminListGroupInviteLogs(e,i,o).then((function(t){n.setState({logList:t.data.group_invite_log_list,loading:!1,currentPage:e,hasNextPage:t.data.has_next_page})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.handleUserFilter=function(e){var t,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=n.state.selectedUsers;null===e?t=s:t=s.find((function(t){return t.email===e.email}))?s.filter((function(t){return t.email!==e.email})):[].concat((0,fi.default)(s),[e]);n.setState({selectedUsers:t,currentPage:1},(function(){i&&n.getLogsByPage(1)}))},n.handleOperatorFilter=function(e){var t,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=n.state.selectedOperators;null===e?t=s:t=s.find((function(t){return t.email===e.email}))?s.filter((function(t){return t.email!==e.email})):[].concat((0,fi.default)(s),[e]);n.setState({selectedOperators:t,currentPage:1},(function(){i&&n.getLogsByPage(1)}))},n.handleGroupFilter=function(e){var t,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=n.state.selectedGroups;null===e?t=s:t=s.find((function(t){return t.id===e.id}))?s.filter((function(t){return t.id!==e.id})):[].concat((0,fi.default)(s),[e]);n.setState({selectedGroups:t,currentPage:1},(function(){i&&n.getLogsByPage(1)}))},n.handleSelectorToggle=function(e){var t=n.state.openSelector===e;n.setState({openSelector:t?null:e},(function(){t&&n.getLogsByPage(1)}))},n.searchUsers=function(e){return S.H.sysAdminSearchUsers(e)},n.searchGroups=function(e){return S.H.sysAdminSearchGroups(e)},n.resetPerPage=function(e){n.setState({perPage:e},(function(){return n.getLogsByPage(n.initPage)}))},n.state={loading:!0,errorMsg:"",logList:[],perPage:100,currentPage:1,hasNextPage:!1,availableUsers:[],selectedUsers:[],selectedOperators:[],selectedGroups:[],openSelector:null},n.initPage=1,n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,i=n.currentPage,s=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||s),currentPage:parseInt(t.get("page")||i)},(function(){e.getLogsByPage(e.state.currentPage)}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.logList,s=t.currentPage,a=t.perPage,r=t.hasNextPage,o=t.availableUsers,c=t.selectedUsers,d=t.selectedOperators,u=t.selectedGroups,h=t.openSelector;return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(Ds,{currentItem:"groupMember"}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("div",{className:"d-flex align-items-center mb-2",children:[(0,x.jsx)(Ms,{componentName:(0,p.AP)("Member"),items:o,selectedItems:c,onSelect:this.handleUserFilter,isOpen:"user"===h,onToggle:function(){return e.handleSelectorToggle("user")},searchUsersFunc:this.searchUsers}),(0,x.jsx)(Ms,{componentName:(0,p.AP)("Group"),items:o,selectedItems:u,onSelect:this.handleGroupFilter,isOpen:"group"===h,onToggle:function(){return e.handleSelectorToggle("group")},searchGroupsFunc:this.searchGroups}),(0,x.jsx)(Ms,{componentName:(0,p.AP)("Operator"),items:o,selectedItems:d,onSelect:this.handleOperatorFilter,isOpen:"operator"===h,onToggle:function(){return e.handleSelectorToggle("operator")},searchUsersFunc:this.searchUsers})]}),(0,x.jsx)(ea,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:n,currentPage:s,perPage:a,hasNextPage:r,getLogsByPage:this.getLogsByPage,resetPerPage:this.resetPerPage})]})})]})})]})}}])}(l.Component),ia=na,sa=n(72714),aa=n(83970),ra=n(15263),oa=n(8123),la=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).toggleBtns=function(){n.setState({isBtnsShown:!n.state.isBtnsShown})},n.hideBtns=function(e){n.state.isBtnsShown&&(n.props.value!=n.state.value&&n.setState({value:n.props.value}),n.toggleBtns())},n.onInputChange=function(e){n.setState({value:e.target.value})},n.onSubmit=function(e){var t=n.state.value.trim();t!=n.props.value&&n.props.saveSetting(n.props.keyText,t),n.toggleBtns()},n.state={isBtnsShown:!1,value:n.props.value},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.setState({value:e.value})}},{key:"render",value:function(){var e=this.state,t=e.isBtnsShown,n=e.value,i=this.props,s=i.helpTip,a=i.displayName,r=i.inputType;return(0,x.jsx)(oa.A,{displayName:a,helpTip:s,mainContent:(0,x.jsx)(W.A,{type:r||"text",className:"textarea"==r?"web-setting-textarea":"",onChange:this.onInputChange,onFocus:this.toggleBtns,onBlur:this.hideBtns,value:n}),extraContent:t?(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(j.A,{color:"primary",className:"sf2-icon-tick web-setting-icon-btn web-setting-icon-btn-submit",onMouseDown:this.onSubmit,title:(0,p.AP)("Submit")}),(0,x.jsx)(j.A,{className:"ml-1 sf2-icon-x2 web-setting-icon-btn web-setting-icon-btn-cancel",title:(0,p.AP)("Cancel")})]}):null})}}])}(l.Component),ca=(n(37696),function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).saveSetting=function(e,t){S.H.sysAdminSetSysSettingInfo(e,t).then((function(e){n.setState({config_dict:e.data}),k.A.success((0,p.AP)("System settings updated"))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.postFile=function(e,t){var i;"Logo"==t?i=S.H.sysAdminUpdateLogo(e):"Favicon"==t?i=S.H.sysAdminUpdateFavicon(e):"loginBGImage"==t&&(i=S.H.sysAdminUpdateLoginBG(e)),i.then((function(e){"Logo"==t?n.setState({logoPath:e.data.logo_path}):"Favicon"==t?n.setState({faviconPath:e.data.favicon_path}):"loginBGImage"==t&&n.setState({loginBGPath:e.data.login_bg_image_path}),k.A.success((0,p.AP)("System settings updated"))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.state={loading:!0,errorMsg:"",config_dict:null,logoPath:p.SG+p.VI,faviconPath:p.SG+p.M$,loginBGPath:p.SG+p.sO},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this;S.H.sysAdminGetSysSettingInfo().then((function(t){e.setState({loading:!1,config_dict:t.data})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this.state,t=e.loading,n=e.errorMsg,s=e.config_dict,a=e.logoPath,r=e.faviconPath,o=e.loginBGPath;return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)("div",{className:"cur-view-path",children:(0,x.jsx)("h3",{className:"sf-heading",children:(0,p.AP)("Settings")})}),(0,x.jsxs)("div",{className:"cur-view-content container mw-100",children:[t&&(0,x.jsx)(D.A,{}),n&&(0,x.jsx)("p",{className:"error text-center mt-4",children:n}),!t&&!n&&s&&(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)("p",{className:"small text-secondary my-4",children:(0,p.AP)("Note: Settings via web interface are saved in database table (seahub-db/constance_config). They have a higher priority over the settings in config files.")}),(0,x.jsx)(sa.A,{headingText:(0,p.AP)("Branding"),children:(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(la,{saveSetting:this.saveSetting,displayName:(0,p.AP)("Site title"),keyText:"SITE_TITLE",value:s.SITE_TITLE,helpTip:(0,p.AP)("Site title shown in a browser tab")}),(0,x.jsx)(la,{saveSetting:this.saveSetting,displayName:(0,p.AP)("Site name"),keyText:"SITE_NAME",value:s.SITE_NAME,helpTip:(0,p.AP)("Site name used in email sending")}),(0,x.jsx)(ra.A,{postFile:this.postFile,displayName:(0,p.AP)("Logo"),keyText:"Logo",filePath:a,fileWidth:256,fileHeight:64,helpTip:"logo.png, 256px * 64px"}),(0,x.jsx)(ra.A,{postFile:this.postFile,displayName:(0,p.AP)("Favicon"),keyText:"Favicon",filePath:r,fileWidth:32,fileHeight:32,helpTip:"favicon.ico, 32px * 32px"}),(0,x.jsx)(ra.A,{postFile:this.postFile,displayName:(0,p.AP)("Login background image"),keyText:"loginBGImage",filePath:o,fileWidth:240,fileHeight:160,helpTip:"login-bg.jpg, 2400px * 1600px"}),(0,x.jsx)(aa.A,{saveSetting:this.saveSetting,displayName:(0,p.AP)("Enable branding CSS"),keyText:"ENABLE_BRANDING_CSS",value:s.ENABLE_BRANDING_CSS,helpTip:(0,p.AP)("Use custom CSS")}),(0,x.jsx)(la,{inputType:"textarea",saveSetting:this.saveSetting,displayName:(0,p.AP)("Custom CSS"),keyText:"CUSTOM_CSS",value:s.CUSTOM_CSS,helpTip:""})]})}),(0,x.jsx)(sa.A,{headingText:(0,p.AP)("User"),children:(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(aa.A,{saveSetting:this.saveSetting,displayName:(0,p.AP)("Allow new registrations"),keyText:"ENABLE_SIGNUP",value:s.ENABLE_SIGNUP,helpTip:(0,p.AP)("Allow new user registrations. Uncheck this to prevent anyone from creating a new account.")}),(0,x.jsx)(aa.A,{saveSetting:this.saveSetting,displayName:(0,p.AP)("Activate after registration"),keyText:"ACTIVATE_AFTER_REGISTRATION",value:s.ACTIVATE_AFTER_REGISTRATION,helpTip:(0,p.AP)("Activate user immediately after registration. If unchecked, a user need to be activated by administrator or via activation email")}),(0,x.jsx)(aa.A,{saveSetting:this.saveSetting,displayName:(0,p.AP)("Send activation email"),keyText:"REGISTRATION_SEND_MAIL",value:s.REGISTRATION_SEND_MAIL,helpTip:(0,p.AP)("Send activation Email after user registration.")}),(0,x.jsx)(la,{saveSetting:this.saveSetting,displayName:(0,p.AP)("Keep sign in"),keyText:"LOGIN_REMEMBER_DAYS",value:s.LOGIN_REMEMBER_DAYS,helpTip:(0,p.AP)("Number of days that keep user sign in.")}),(0,x.jsx)(la,{saveSetting:this.saveSetting,displayName:(0,p.AP)("Login attempt limit"),keyText:"LOGIN_ATTEMPT_LIMIT",value:s.LOGIN_ATTEMPT_LIMIT,helpTip:(0,p.AP)("The maximum number of failed login attempts before showing CAPTCHA.")}),(0,x.jsx)(aa.A,{saveSetting:this.saveSetting,displayName:(0,p.AP)("Freeze user on login failed"),keyText:"FREEZE_USER_ON_LOGIN_FAILED",value:s.FREEZE_USER_ON_LOGIN_FAILED,helpTip:(0,p.AP)("Freeze user account when failed login attempts exceed limit.")})]})}),(0,x.jsx)(sa.A,{headingText:(0,p.AP)("Groups"),children:(0,x.jsx)(aa.A,{saveSetting:this.saveSetting,displayName:(0,p.AP)("Enable\xa0sharing\xa0to\xa0all\xa0groups"),keyText:"ENABLE_SHARE_TO_ALL_GROUPS",value:s.ENABLE_SHARE_TO_ALL_GROUPS,helpTip:(0,p.AP)("Enable users to share libraries to any groups in the system.")})}),(0,x.jsx)(sa.A,{headingText:(0,p.AP)("Password"),children:(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(aa.A,{saveSetting:this.saveSetting,displayName:(0,p.AP)("Strong password"),keyText:"USER_STRONG_PASSWORD_REQUIRED",value:s.USER_STRONG_PASSWORD_REQUIRED,helpTip:(0,p.AP)("Force user to use a strong password when sign up or change password.")}),(0,x.jsx)(aa.A,{saveSetting:this.saveSetting,displayName:(0,p.AP)("Force password change"),keyText:"FORCE_PASSWORD_CHANGE",value:s.FORCE_PASSWORD_CHANGE,helpTip:(0,p.AP)("Force user to change password when account is newly added or reset by admin")}),(0,x.jsx)(aa.A,{saveSetting:this.saveSetting,displayName:(0,p.AP)("Enable two factor authentication"),keyText:"ENABLE_TWO_FACTOR_AUTH",value:s.ENABLE_TWO_FACTOR_AUTH,helpTip:(0,p.AP)("Enable two factor authentication")})]})}),(0,x.jsx)(sa.A,{headingText:(0,p.AP)("Library"),children:(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(aa.A,{saveSetting:this.saveSetting,displayName:(0,p.AP)("Library history"),keyText:"ENABLE_REPO_HISTORY_SETTING",value:s.ENABLE_REPO_HISTORY_SETTING,helpTip:(0,p.AP)("Allow users to change library history settings")}),(0,x.jsx)(aa.A,{saveSetting:this.saveSetting,displayName:(0,p.AP)("Encrypted library"),keyText:"ENABLE_ENCRYPTED_LIBRARY",value:s.ENABLE_ENCRYPTED_LIBRARY,helpTip:(0,p.AP)("Allow users to create encrypted libraries")}),(0,x.jsx)(la,{saveSetting:this.saveSetting,displayName:(0,p.AP)("Library password minimum length"),keyText:"REPO_PASSWORD_MIN_LENGTH",value:s.REPO_PASSWORD_MIN_LENGTH,helpTip:(0,p.AP)("The least number of characters an encrypted library password should include.")}),(0,x.jsx)(aa.A,{saveSetting:this.saveSetting,displayName:(0,p.AP)("Share/upload link force password"),keyText:"SHARE_LINK_FORCE_USE_PASSWORD",value:s.SHARE_LINK_FORCE_USE_PASSWORD,helpTip:(0,p.AP)("Force users to use password when generating share/upload link.")}),(0,x.jsx)(la,{saveSetting:this.saveSetting,displayName:(0,p.AP)("Share/upload link password minimum length"),keyText:"SHARE_LINK_PASSWORD_MIN_LENGTH",value:s.SHARE_LINK_PASSWORD_MIN_LENGTH,helpTip:(0,p.AP)("The least number of characters a share/upload link password should include.")}),(0,x.jsx)(la,{saveSetting:this.saveSetting,displayName:(0,p.AP)("Share/upload link password strength level"),keyText:"SHARE_LINK_PASSWORD_STRENGTH_LEVEL",value:s.SHARE_LINK_PASSWORD_STRENGTH_LEVEL,helpTip:(0,p.AP)("The level(1-4) of a share/upload link password's strength. For example, '3' means password must have at least 3 of the following: num, upper letter, lower letter and other symbols")}),(0,x.jsx)(aa.A,{saveSetting:this.saveSetting,displayName:(0,p.AP)("Enable users to clean trash"),keyText:"ENABLE_USER_CLEAN_TRASH",value:s.ENABLE_USER_CLEAN_TRASH,helpTip:(0,p.AP)("Allow users to clean library trash")})]})}),(0,x.jsx)(sa.A,{headingText:(0,p.AP)("Online Preview"),children:(0,x.jsx)(la,{inputType:"textarea",saveSetting:this.saveSetting,displayName:(0,p.AP)("Text file extensions"),keyText:"TEXT_PREVIEW_EXT",value:s.TEXT_PREVIEW_EXT,helpTip:(0,p.AP)("Extensions of text files that can be online previewed, each suffix is separated by a comma.")})}),(0,x.jsx)(sa.A,{headingText:(0,p.AP)("Sync"),children:(0,x.jsx)(aa.A,{saveSetting:this.saveSetting,displayName:(0,p.AP)("Disable sync with any folder"),keyText:"DISABLE_SYNC_WITH_ANY_FOLDER",value:s.DISABLE_SYNC_WITH_ANY_FOLDER,helpTip:(0,p.AP)("If turn on, the desktop clients will not be able to sync a folder outside the default Seafile folder.")})}),p.am&&(0,x.jsx)(sa.A,{headingText:(0,p.AP)("Terms"),children:(0,x.jsx)(aa.A,{saveSetting:this.saveSetting,displayName:(0,p.AP)("Enable terms and conditions"),keyText:"ENABLE_TERMS_AND_CONDITIONS",value:s.ENABLE_TERMS_AND_CONDITIONS,helpTip:(0,p.AP)("Enable system admin to add Terms and Conditions, and all users will have to accept the terms.")})})]})]})]})})]})}}])}(l.Component)),da=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleChange=function(e){var t=e.target.value;n.setState({value:t,isSubmitBtnActive:""!=t.trim()})},n.handleSubmit=function(){n.toggle(),n.props.addNotification(n.state.value.trim())},n.toggle=function(){n.props.toggle()},n.state={value:"",isSubmitBtnActive:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){return(0,x.jsxs)(u.A,{isOpen:!0,toggle:this.toggle,children:[(0,x.jsx)(Ce.A,{toggle:this.toggle,children:(0,p.AP)("Add new notification")}),(0,x.jsx)(Ie.A,{children:(0,x.jsx)(Oe.A,{children:(0,x.jsx)(Te.A,{children:(0,x.jsx)(W.A,{type:"textarea",value:this.state.value,onChange:this.handleChange})})})}),(0,x.jsxs)(Me.A,{children:[(0,x.jsx)(j.A,{color:"secondary",onClick:this.toggle,children:(0,p.AP)("Cancel")}),(0,x.jsx)(j.A,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive,children:(0,p.AP)("Submit")})]})]})}}])}(l.Component),ua=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.state={isItemFreezed:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,i=t.errorMsg,s=t.items;if(n)return(0,x.jsx)(D.A,{});if(i)return(0,x.jsx)("p",{className:"error text-center mt-4",children:i});var a=(0,x.jsx)(me.A,{text:(0,p.AP)("No notifications")}),r=(0,x.jsxs)("table",{children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"95%",children:(0,p.AP)("Notification Detail")}),(0,x.jsx)("th",{width:"5%"})]})}),(0,x.jsx)("tbody",{children:s.map((function(t,n){return(0,x.jsx)(ha,{item:t,isItemFreezed:e.state.isItemFreezed,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem,deleteNotification:e.props.deleteNotification,setToCurrent:e.props.setToCurrent},n)}))})]});return s.length?r:a}}])}(l.Component),ha=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleMouseEnter=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!0,highlight:!0})},n.handleMouseLeave=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!1,highlight:!1})},n.onUnfreezedItem=function(){n.setState({highlight:!1,isOpIconShow:!1}),n.props.onUnfreezedItem()},n.toggleDeleteDialog=function(e){e&&e.preventDefault(),n.setState({isDeleteDialogOpen:!n.state.isDeleteDialogOpen})},n.deleteNotification=function(){n.props.deleteNotification(n.props.item.id),n.toggleDeleteDialog()},n.setToCurrent=function(){n.props.setToCurrent(n.props.item.id)},n.onMenuItemClick=function(e){switch(e){case"Set to current":n.setToCurrent();break;case"Delete":n.toggleDeleteDialog()}},n.translateOperations=function(e){var t="";switch(e){case"Set to current":t=(0,p.AP)("Set to current");break;case"Delete":t=(0,p.AP)("Delete")}return t},n.getOperations=function(){var e=[];return n.props.item.is_current||e.push("Set to current"),e.push("Delete"),e},n.state={isOpIconShown:!1,highlight:!1,isDeleteDialogOpen:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.item,t=this.state,n=t.isOpIconShown,i=t.isDeleteDialogOpen;return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,x.jsxs)("td",{children:[e.msg,e.is_current&&(0,x.jsx)("span",{className:"small text-orange",children:(0,p.AP)("(current notification)")})]}),(0,x.jsx)("td",{children:n&&(0,x.jsx)(et.A,{operations:this.getOperations(),translateOperations:this.translateOperations,onMenuItemClick:this.onMenuItemClick,onFreezedItem:this.props.onFreezedItem,onUnfreezedItem:this.onUnfreezedItem})})]}),i&&(0,x.jsx)(Ye.A,{title:(0,p.AP)("Delete Notification"),message:(0,p.AP)("Are you sure you want to delete the notification ?"),toggleDialog:this.toggleDeleteDialog,executeOperation:this.deleteNotification,confirmBtnText:(0,p.AP)("Delete")})]})}}])}(l.Component),ga=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).toggleAddNotificationDialog=function(){n.setState({isAddNotificationDialogOpen:!n.state.isAddNotificationDialogOpen})},n.addNotification=function(e){S.H.sysAdminAddSysNotification(e).then((function(e){var t=n.state.notificationList;t.unshift(e.data.notification),n.setState({notificationList:t})})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.deleteNotification=function(e){S.H.sysAdminDeleteSysNotification(e).then((function(t){var i=n.state.notificationList.filter((function(t){return t.id!=e}));n.setState({notificationList:i}),k.A.success((0,p.AP)("Successfully deleted 1 item."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.setToCurrent=function(e){S.H.sysAdminSetSysNotificationToCurrent(e).then((function(t){var i=n.state.notificationList.map((function(t){return t.id==e?t.is_current=!0:t.is_current=!1,t}));n.setState({notificationList:i})})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.state={loading:!0,errorMsg:"",notificationList:[],isAddNotificationDialogOpen:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this;S.H.sysAdminListAllSysNotifications().then((function(t){e.setState({loading:!1,notificationList:t.data.notifications})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this.state.isAddNotificationDialogOpen;return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)((0,i.default)({},this.props),{},{children:(0,x.jsx)(j.A,{className:"btn btn-secondary operation-item",onClick:this.toggleAddNotificationDialog,children:(0,p.AP)("Add new notification")})})),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)("div",{className:"cur-view-path",children:(0,x.jsx)("h3",{className:"sf-heading",children:(0,p.AP)("All Notifications")})}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsx)(ua,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.notificationList,deleteNotification:this.deleteNotification,setToCurrent:this.setToCurrent})})]})}),e&&(0,x.jsx)(da,{addNotification:this.addNotification,toggle:this.toggleAddNotificationDialog})]})}}])}(l.Component),pa=function(e){function t(){return(0,s.default)(this,t),(0,r.default)(this,t,arguments)}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg,i=e.records;return t?(0,x.jsx)("span",{className:"loading-icon loading-tip"}):n?(0,x.jsx)("p",{className:"error text-center",children:n}):(0,x.jsxs)("table",{width:"100%",className:"table table-hover table-vcenter",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"16%",children:(0,p.AP)("Library")}),(0,x.jsx)("th",{width:"30%",children:"ID"}),(0,x.jsx)("th",{width:"30%",children:(0,p.AP)("Path")}),(0,x.jsx)("th",{width:"12%",children:(0,p.AP)("Label")}),(0,x.jsx)("th",{width:"12%",children:(0,p.AP)("Suggestion")})]})}),(0,x.jsx)("tbody",{children:i.map((function(e,t){return(0,x.jsx)(fa,{record:e},t)}))})]})}}])}(l.Component),fa=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).state={},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.record;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:e.repo_name}),(0,x.jsx)("td",{children:e.repo_id}),(0,x.jsx)("td",{children:e.path}),(0,x.jsx)("td",{children:e.detail.label}),(0,x.jsx)("td",{children:e.detail.suggestion})]})}}])}(l.Component),ma=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).state={loading:!0,errorMsg:"",records:[]},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this;S.H.sysAdminListFileScanRecords().then((function(t){e.setState({loading:!1,records:t.data.record_list})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsx)("div",{className:"main-panel-center",children:(0,x.jsxs)("div",{className:"cur-view-container",id:"content-scan-records",children:[(0,x.jsx)("div",{className:"cur-view-path",children:(0,x.jsx)("h3",{className:"sf-heading",children:(0,p.AP)("Content Scan Records")})}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsx)(pa,{loading:this.state.loading,errorMsg:this.state.errorMsg,records:this.state.records})})]})})]})}}])}(l.Component),va=n(55097),xa=n.n(va),Aa=n(94700),ya=function(e){function t(e){return(0,s.default)(this,t),(0,r.default)(this,t,[e])}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.newUsersTempObj,i=t.checkedDepartmentId,s=t.isMembersListLoading,a=t.canCheckUserIds,r=this.props.membersList.map((function(t,s){var a=t.avatar;return a=t.avatar&&t.avatar.length>0?t.avatar.substring(0,t.avatar.length-1)+"100":p.Yc+"media/avatars/default.png",(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:!t.email&&(0,x.jsx)("input",{type:"checkbox",className:"vam",onChange:function(){return e.props.onUserChecked(t)},checked:t.userid in n?"checked":""})}),(0,x.jsx)("td",{children:(0,x.jsx)("img",{className:"avatar",src:a,alt:""})}),(0,x.jsx)("td",{children:t.name}),(0,x.jsx)("td",{children:t.mobile}),(0,x.jsx)("td",{children:t.contact_email}),(0,x.jsx)("td",{children:t.email&&(0,x.jsx)("i",{className:"sf2-icon-tick"})})]},i.toString()+t.userid)}));return(0,x.jsxs)("div",{className:"dir-content-main",children:[s&&(0,x.jsx)(D.A,{}),!s&&this.props.membersList.length>0&&(0,x.jsxs)(Aa.A,{hover:!0,children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"5%",children:a.length>0&&(0,x.jsx)("input",{type:"checkbox",className:"vam",checked:this.props.isCheckedAll,onChange:function(){return e.props.onAllUsersChecked()}})}),(0,x.jsx)("th",{width:"10%"}),(0,x.jsx)("th",{width:"20%",children:"\u540d\u79f0"}),(0,x.jsx)("th",{width:"20%",children:"\u624b\u673a\u53f7"}),(0,x.jsx)("th",{width:"30%",children:"\u90ae\u7bb1"}),(0,x.jsx)("th",{width:"15%",children:"\u5df2\u6dfb\u52a0"})]})}),(0,x.jsx)("tbody",{children:r})]}),!s&&0===this.props.membersList.length&&(0,x.jsxs)("div",{className:"message empty-tip text-center",children:[(0,x.jsx)("img",{src:"".concat(p.Yc,"media/img/member-list-empty-2x.png"),alt:""}),(0,x.jsx)("h4",{children:"\u6210\u5458\u5217\u8868\u4e3a\u7a7a"})]})]})}}])}(l.Component),Pa=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).toggleChildren=function(e){e.preventDefault(),e.stopPropagation(),n.setState({isChildrenShow:!n.state.isChildrenShow})},n.dropdownToggle=function(e){e.stopPropagation(),n.setState({dropdownOpen:!n.state.dropdownOpen})},n.onMouseEnter=function(){n.setState({active:!0})},n.onMouseLeave=function(){n.state.dropdownOpen||n.setState({active:!1})},n.importDepartmentDialogToggle=function(e){n.setState({active:!1}),n.props.importDepartmentDialogToggle(e)},n.renderTreeNodes=function(e){if(e.length>0)return e.map((function(e){return(0,x.jsx)(t,{department:e,isChildrenShow:n.state.isChildrenShow,onChangeDepartment:n.props.onChangeDepartment,checkedDepartmentId:n.props.checkedDepartmentId,importDepartmentDialogToggle:n.importDepartmentDialogToggle},e.id)}))},n.changeDept=function(e){var t=n.props,i=t.department,s=t.checkedDepartmentId;n.props.onChangeDepartment(e),s!==i.id||n.state.isChildrenShow||n.setState({isChildrenShow:!0})},n.state={isChildrenShow:!1,dropdownOpen:!1,active:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){0===this.props.index&&(this.setState({isChildrenShow:!0}),this.props.onChangeDepartment(this.props.department.id))}},{key:"render",value:function(){var e=this,t=this.props,n=t.isChildrenShow,i=t.department,s=t.checkedDepartmentId,a=fe()({"folder-toggle-icon sf3-font sf3-font-down rotate-270":i.children&&this.state.isChildrenShow,"folder-toggle-icon sf3-font sf3-font-down":i.children&&!this.state.isChildrenShow}),r=fe()({"tree-node-inner":!0,"tree-node-inner-hover":this.state.active,"tree-node-hight-light":s===i.id});return(0,x.jsxs)(l.Fragment,{children:[n&&(0,x.jsxs)("div",{className:r,onClick:function(){return e.changeDept(i.id)},onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[(0,x.jsx)("span",{className:"tree-node-icon",onClick:function(t){return e.toggleChildren(t)},children:(0,x.jsx)("i",{className:a})}),(0,x.jsx)("span",{className:"tree-node-text",children:i.name}),p.am&&(0,x.jsxs)(vi.A,{isOpen:this.state.dropdownOpen,toggle:function(t){return e.dropdownToggle(t)},direction:"down",style:this.state.active?{}:{opacity:0},children:[(0,x.jsx)(xi.A,{tag:"span",className:"cursor-pointer right-icon",title:(0,p.AP)("More operations"),"aria-label":(0,p.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.dropdownOpen,children:(0,x.jsx)("i",{className:"sf3-font sf3-font-more"})}),(0,x.jsx)(Ai.A,{className:"drop-list",children:(0,x.jsx)(yi.A,{onClick:this.importDepartmentDialogToggle.bind(this,i),id:i.id,children:"\u5bfc\u5165\u90e8\u95e8"})})]})]}),this.state.isChildrenShow&&(0,x.jsx)("div",{className:"department-children",children:i.children&&this.renderTreeNodes(i.children)})]})}}])}(l.Component),ba=Pa,ja=function(e){function t(){return(0,s.default)(this,t),(0,r.default)(this,t,arguments)}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this,t=this.props.departmentsTree;return(0,x.jsx)("div",{className:"dir-content-nav",children:(0,x.jsx)("div",{className:"tree-view p-4",children:this.props.isTreeLoading?(0,x.jsx)(D.A,{}):(0,x.jsx)(x.Fragment,{children:t.length>0&&t.map((function(t,n){return(0,x.jsx)(ba,{index:n,department:t,isChildrenShow:!0,onChangeDepartment:e.props.onChangeDepartment,checkedDepartmentId:e.props.checkedDepartmentId,importDepartmentDialogToggle:e.props.importDepartmentDialogToggle},t.id)}))})})})}}])}(l.Component),Sa=ja,ka=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).toggle=function(){n.props.importDepartmentDialogToggle(null)},n.handleSubmit=function(){n.props.onImportDepartmentSubmit(),n.setState({isLoading:!0})},n.state={isLoading:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props,t=e.departmentsCount,n=e.membersCount,i=e.departmentName;return(0,x.jsxs)(u.A,{isOpen:!0,toggle:this.toggle,children:[(0,x.jsxs)(Ce.A,{toggle:this.toggle,children:[(0,x.jsx)("span",{children:"\u5bfc\u5165\u90e8\u95e8 "}),(0,x.jsx)("span",{className:"op-target",title:i,children:i})]}),(0,x.jsxs)(Ie.A,{children:[(0,x.jsxs)("p",{children:["\u5c06\u8981\u5bfc\u5165 ",(0,x.jsx)("strong",{children:t})," \u4e2a\u90e8\u95e8\uff0c\u5176\u4e2d\u5305\u62ec ",(0,x.jsx)("strong",{children:n})," \u4e2a\u6210\u5458"]}),this.state.isLoading&&(0,x.jsx)(D.A,{})]}),(0,x.jsxs)(Me.A,{children:[(0,x.jsx)(j.A,{color:"secondary",onClick:this.toggle,children:"\u53d6\u6d88"}),(0,x.jsx)(j.A,{color:"primary",onClick:this.handleSubmit,children:"\u5bfc\u5165"})]})]})}}])}(l.Component),Da=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).getDepartmentsTree=function(e){for(var t=[],n=[],i=0;i<e.length;i++)-1===t.indexOf(e[i].id)&&t.push(e[i].id),-1===n.indexOf(e[i].parentid)&&n.push(e[i].parentid);var s=n.filter((function(e){return-1!==t.indexOf(e)})),a=n.concat(s).filter((function(e){return-1===n.indexOf(e)||-1===s.indexOf(e)})),r=xa()(e);return r.filter((function(e){var t=r.filter((function(t){return e.id===t.parentid}));return t.length>0&&(e.children=t),-1!==a.indexOf(e.parentid)}))},n.getWorkWeixinDepartmentsList=function(e){S.H.sysAdminListWorkWeixinDepartments(e).then((function(t){if(t.data.department||!t.data.errmsg)if(e)n.setState({importDepartmentChildrenCount:t.data.department.length,importDepartmentMembersCount:n.state.membersTempObj[e].length});else{var i=n.getDepartmentsTree(t.data.department);n.setState({isTreeLoading:!1,departmentsTree:i})}else k.A.danger(t.data.errmsg)})).catch((function(e){n.handleError(e),n.setState({isTreeLoading:!1,isMembersListLoading:!1}),e.response&&403===e.response.status&&(window.location=p.Yc+"sys/useradmin/")}))},n.getWorkWeixinDepartmentMembersList=function(e){n.setState({isMembersListLoading:!0}),S.H.sysAdminListWorkWeixinDepartmentMembers(e,{fetch_child:!0}).then((function(t){var i=n.state.membersTempObj;i[e]=t.data.userlist;var s=n.getCanCheckUserIds(t.data.userlist);n.setState({membersTempObj:i,membersList:t.data.userlist,isMembersListLoading:!1,canCheckUserIds:s})})).catch((function(e){n.setState({isMembersListLoading:!1}),n.handleError(e)}))},n.getCanCheckUserIds=function(e){var t=[];return e.forEach((function(e){e.email||t.push(e.userid)})),t},n.onChangeDepartment=function(e){if(n.setState({newUsersTempObj:{},isCheckedAll:!1,checkedDepartmentId:e}),e in n.state.membersTempObj){var t=n.getCanCheckUserIds(n.state.membersTempObj[e]);n.setState({membersList:n.state.membersTempObj[e],canCheckUserIds:t})}else n.getWorkWeixinDepartmentMembersList(e)},n.onUserChecked=function(e){if(-1!==n.state.canCheckUserIds.indexOf(e.userid)){var t=n.state.newUsersTempObj;e.userid in t?(delete t[e.userid],n.state.isCheckedAll&&n.setState({isCheckedAll:!1})):(t[e.userid]=e,Object.keys(t).length===n.state.canCheckUserIds.length&&n.setState({isCheckedAll:!0})),n.setState({newUsersTempObj:t})}},n.onAllUsersChecked=function(){n.setState({isCheckedAll:!n.state.isCheckedAll},(function(){if(n.state.isCheckedAll){for(var e={},t=n.state.membersList.filter((function(e){return-1!==n.state.canCheckUserIds.indexOf(e.userid)})),i=0;i<t.length;i++)e[t[i].userid]=t[i];n.setState({newUsersTempObj:e})}else n.setState({newUsersTempObj:{}})}))},n.onSubmit=function(){var e=n.state.newUsersTempObj;if("{}"!==JSON.stringify(e)){var t=[];for(var i in e)t.push(e[i]);0!==t.length?S.H.sysAdminAddWorkWeixinUsersBatch(t).then((function(e){if(n.setState({newUsersTempObj:{},isCheckedAll:!1}),e.data.success&&n.handleSubmitSuccess(e.data.success),e.data.failed)for(var t=e.data.failed,i=0;i<t.length;i++)k.A.danger(t[i].name+" "+t[i].error_msg,{duration:3})})).catch((function(e){n.handleError(e)})):k.A.danger("\u672a\u9009\u62e9\u6210\u5458",{duration:3})}},n.handleSubmitSuccess=function(e){for(var t=n.state,i=t.membersTempObj,s=t.membersList,a=t.canCheckUserIds,r=0;r<e.length;r++){var o=e[r],l=o.userid,c=o.name,d=o.email;k.A.success(c+" \u6210\u529f\u5bfc\u5165",{duration:1}),-1!==a.indexOf(l)&&a.splice(a.indexOf(l),1);for(var u=0;u<s.length;u++)if(s[u].userid===l){s[u].email=d;break}for(var h in i)for(var g=0;g<i[h].length;g++)if(i[h][g].userid===l){i[h][g].email=d;break}}n.setState({membersTempObj:i,membersList:s,canCheckUserIds:a})},n.importDepartmentDialogToggle=function(e){n.setState({isImportDepartmentDialogShow:!n.state.isImportDepartmentDialogShow,importDepartment:e},(function(){e&&n.getWorkWeixinDepartmentsList(e.id)}))},n.onImportDepartmentSubmit=function(){var e=n.state.importDepartment;e&&S.H.sysAdminImportWorkWeixinDepartment(e.id).then((function(t){n.setState({isMembersListLoading:!0,checkedDepartmentId:e.id,membersTempObj:{},membersList:[],newUsersTempObj:{},isCheckedAll:!1,canCheckUserIds:[]}),n.getWorkWeixinDepartmentMembersList(e.id),n.importDepartmentDialogToggle(null),t.data.success&&n.handleImportDepartmentSubmitSuccess(t.data.success),t.data.failed&&n.handleImportDepartmentSubmitFailed(t.data.failed)})).catch((function(e){n.handleError(e)}))},n.handleImportDepartmentSubmitSuccess=function(e){for(var t=0,n=e.length;t<n;t++){var i=e[t],s="department"===i.type?"\u90e8\u95e8 "+i.department_name+" \u5bfc\u5165\u6210\u529f":i.api_user_name+" \u5bfc\u5165\u6210\u529f";k.A.success(s,{duration:3})}},n.handleImportDepartmentSubmitFailed=function(e){for(var t=0,n=e.length;t<n;t++){var i=e[t],s="department"===i.type?i.department_name:i.api_user_name;k.A.danger(s+" "+i.msg,{duration:3})}},n.handleError=function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)},n.state={isTreeLoading:!0,isMembersListLoading:!0,departmentsTree:[],checkedDepartmentId:0,membersTempObj:{},membersList:[],newUsersTempObj:{},isCheckedAll:!1,canCheckUserIds:[],isImportDepartmentDialogShow:!1,importDepartment:null,importDepartmentChildrenCount:0,importDepartmentMembersCount:0},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){this.getWorkWeixinDepartmentsList(null)}},{key:"render",value:function(){var e=this.state,t=e.isImportDepartmentDialogShow,n=e.isTreeLoading,s=e.importDepartment,a=e.importDepartmentChildrenCount,r=e.importDepartmentMembersCount,o=!(!p.am||!t||n||!s);return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)((0,i.default)({},this.props),{},{children:(0,x.jsx)(j.A,{className:"operation-item",onClick:this.onSubmit,children:"\u5bfc\u5165\u7528\u6237"})})),(0,x.jsx)("div",{className:"main-panel-center",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)("div",{className:"cur-view-path",children:(0,x.jsx)("h3",{className:"sf-heading",children:"\u4f01\u4e1a\u5fae\u4fe1\u96c6\u6210"})}),(0,x.jsxs)("div",{className:"cur-view-content d-flex flex-row p-0",children:[(0,x.jsx)(Sa,{departmentsTree:this.state.departmentsTree,isTreeLoading:this.state.isTreeLoading,onChangeDepartment:this.onChangeDepartment,checkedDepartmentId:this.state.checkedDepartmentId,importDepartmentDialogToggle:this.importDepartmentDialogToggle}),(0,x.jsx)("div",{className:"dir-content-resize"}),(0,x.jsx)(ya,{isMembersListLoading:this.state.isMembersListLoading,membersList:this.state.membersList,checkedDepartmentId:this.state.checkedDepartmentId,newUsersTempObj:this.state.newUsersTempObj,onUserChecked:this.onUserChecked,onAllUsersChecked:this.onAllUsersChecked,isCheckedAll:this.state.isCheckedAll,canCheckUserIds:this.state.canCheckUserIds})]})]})}),o&&(0,x.jsx)(ka,{importDepartmentDialogToggle:this.importDepartmentDialogToggle,onImportDepartmentSubmit:this.onImportDepartmentSubmit,departmentsCount:a,membersCount:r,departmentName:s.name})]})}}])}(l.Component),_a=function(e){function t(e){return(0,s.default)(this,t),(0,r.default)(this,t,[e])}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.newUsersTempObj,i=t.checkedDepartmentId,s=t.isMembersListLoading,a=t.canCheckUserIds,r=this.props.membersList.map((function(t,s){var a=t.avatar;return a=t.avatar&&t.avatar.length>0?t.avatar:p.Yc+"media/avatars/default.png",(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:!t.email&&(0,x.jsx)("input",{type:"checkbox",className:"vam",onChange:function(){return e.props.onUserChecked(t)},checked:t.userid in n?"checked":""})}),(0,x.jsx)("td",{children:(0,x.jsx)("img",{className:"avatar",src:a,alt:""})}),(0,x.jsx)("td",{children:t.name}),(0,x.jsx)("td",{children:t.mobile}),(0,x.jsx)("td",{children:t.contact_email}),(0,x.jsx)("td",{children:t.email&&(0,x.jsx)("i",{className:"sf2-icon-tick"})})]},i.toString()+t.userid)}));return(0,x.jsxs)("div",{className:"dir-content-main",children:[s&&(0,x.jsx)(D.A,{}),!s&&this.props.membersList.length>0&&(0,x.jsxs)(Aa.A,{hover:!0,children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"5%",children:a.length>0&&(0,x.jsx)("input",{type:"checkbox",className:"vam",checked:this.props.isCheckedAll,onChange:function(){return e.props.onAllUsersChecked()}})}),(0,x.jsx)("th",{width:"10%"}),(0,x.jsx)("th",{width:"20%",children:"\u540d\u79f0"}),(0,x.jsx)("th",{width:"20%",children:"\u624b\u673a\u53f7"}),(0,x.jsx)("th",{width:"30%",children:"\u90ae\u7bb1"}),(0,x.jsx)("th",{width:"15%",children:"\u5df2\u6dfb\u52a0"})]})}),(0,x.jsx)("tbody",{children:r})]}),!s&&0===this.props.membersList.length&&(0,x.jsxs)("div",{className:"message empty-tip text-center",children:[(0,x.jsx)("img",{src:"".concat(p.Yc,"media/img/member-list-empty-2x.png"),alt:""}),(0,x.jsx)("h4",{children:"\u6210\u5458\u5217\u8868\u4e3a\u7a7a"})]})]})}}])}(l.Component),wa=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).toggleChildren=function(e){e.preventDefault(),e.stopPropagation(),n.setState({isChildrenShow:!n.state.isChildrenShow})},n.dropdownToggle=function(e){e.stopPropagation(),n.setState({dropdownOpen:!n.state.dropdownOpen})},n.onMouseEnter=function(){n.setState({active:!0})},n.onMouseLeave=function(){n.state.dropdownOpen||n.setState({active:!1})},n.importDepartmentDialogToggle=function(e){n.setState({active:!1}),n.props.importDepartmentDialogToggle(e)},n.renderTreeNodes=function(e){if(e.length>0)return e.map((function(e){return(0,x.jsx)(t,{department:e,isChildrenShow:n.state.isChildrenShow,onChangeDepartment:n.props.onChangeDepartment,checkedDepartmentId:n.props.checkedDepartmentId,importDepartmentDialogToggle:n.importDepartmentDialogToggle},e.id)}))},n.changeDept=function(e){var t=n.props,i=t.department,s=t.checkedDepartmentId;n.props.onChangeDepartment(e),s!==i.id||n.state.isChildrenShow||n.setState({isChildrenShow:!0})},n.state={isChildrenShow:!1,dropdownOpen:!1,active:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){0===this.props.index&&(this.setState({isChildrenShow:!0}),this.props.onChangeDepartment(this.props.department.id))}},{key:"render",value:function(){var e=this,t=this.props,n=t.isChildrenShow,i=t.department,s=t.checkedDepartmentId,a=fe()({"folder-toggle-icon sf3-font sf3-font-down rotate-270":i.children&&this.state.isChildrenShow,"folder-toggle-icon sf3-font sf3-font-down":i.children&&!this.state.isChildrenShow}),r=fe()({"tree-node-inner":!0,"tree-node-inner-hover":this.state.active,"tree-node-hight-light":s===i.id});return(0,x.jsxs)(l.Fragment,{children:[n&&(0,x.jsxs)("div",{className:r,onClick:function(){return e.changeDept(i.id)},onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[(0,x.jsx)("span",{className:"tree-node-icon",onClick:function(t){return e.toggleChildren(t)},children:(0,x.jsx)("i",{className:a})}),(0,x.jsx)("span",{className:"tree-node-text",children:i.name}),p.am&&(0,x.jsxs)(vi.A,{isOpen:this.state.dropdownOpen,toggle:function(t){return e.dropdownToggle(t)},direction:"down",style:this.state.active?{}:{opacity:0},children:[(0,x.jsx)(xi.A,{tag:"span",className:"cursor-pointer right-icon",title:(0,p.AP)("More operations"),"aria-label":(0,p.AP)("More operations"),"data-toggle":"dropdown","aria-expanded":this.state.dropdownOpen,children:(0,x.jsx)("i",{className:"sf3-font sf3-font-more"})}),(0,x.jsx)(Ai.A,{className:"drop-list",children:(0,x.jsx)(yi.A,{onClick:this.importDepartmentDialogToggle.bind(this,i),id:i.id,children:"\u5bfc\u5165\u90e8\u95e8"})})]})]}),this.state.isChildrenShow&&(0,x.jsx)("div",{className:"department-children",children:i.children&&this.renderTreeNodes(i.children)})]})}}])}(l.Component),Ia=wa,Na=function(e){function t(){return(0,s.default)(this,t),(0,r.default)(this,t,arguments)}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this,t=this.props.departmentsTree;return(0,x.jsx)("div",{className:"dir-content-nav",children:(0,x.jsx)("div",{className:"tree-view p-4",children:this.props.isTreeLoading?(0,x.jsx)(D.A,{}):(0,x.jsx)(x.Fragment,{children:t.length>0&&t.map((function(t,n){return(0,x.jsx)(Ia,{index:n,department:t,isChildrenShow:!0,onChangeDepartment:e.props.onChangeDepartment,checkedDepartmentId:e.props.checkedDepartmentId,importDepartmentDialogToggle:e.props.importDepartmentDialogToggle},t.id)}))})})})}}])}(l.Component),Ma=Na,Ca=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).toggle=function(){n.props.importDepartmentDialogToggle(null)},n.handleSubmit=function(){n.props.onImportDepartmentSubmit(),n.setState({isLoading:!0})},n.state={isLoading:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props,t=e.departmentsCount,n=e.membersCount,i=e.departmentName;return(0,x.jsxs)(u.A,{isOpen:!0,toggle:this.toggle,children:[(0,x.jsxs)(Ce.A,{toggle:this.toggle,children:[(0,x.jsx)("span",{children:"\u5bfc\u5165\u90e8\u95e8 "}),(0,x.jsx)("span",{className:"op-target",title:i,children:i})]}),(0,x.jsxs)(Ie.A,{children:[(0,x.jsxs)("p",{children:["\u5c06\u8981\u5bfc\u5165 ",(0,x.jsx)("strong",{children:t})," \u4e2a\u90e8\u95e8\uff0c\u5176\u4e2d\u5305\u62ec ",(0,x.jsx)("strong",{children:n})," \u4e2a\u6210\u5458"]}),this.state.isLoading&&(0,x.jsx)(D.A,{})]}),(0,x.jsxs)(Me.A,{children:[(0,x.jsx)(j.A,{color:"secondary",onClick:this.toggle,children:"\u53d6\u6d88"}),(0,x.jsx)(j.A,{color:"primary",onClick:this.handleSubmit,children:"\u5bfc\u5165"})]})]})}}])}(l.Component),La=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).getDepartmentsTree=function(e){for(var t=[],n=[],i=0;i<e.length;i++)-1===t.indexOf(e[i].id)&&t.push(e[i].id),-1===n.indexOf(e[i].parentid)&&n.push(e[i].parentid);var s=n.filter((function(e){return-1!==t.indexOf(e)})),a=n.concat(s).filter((function(e){return-1===n.indexOf(e)||-1===s.indexOf(e)})),r=xa()(e);return r.filter((function(e){var t=r.filter((function(t){return e.id===t.parentid}));return t.length>0&&(e.children=t),-1!==a.indexOf(e.parentid)}))},n.getDingtalkDepartmentsList=function(e){S.H.sysAdminListDingtalkDepartments(e).then((function(t){if(t.data.department||!t.data.errmsg)if(e)n.setState({importDepartmentChildrenCount:t.data.department.length,importDepartmentMembersCount:n.state.membersTempObj[e].length});else{var i=n.getDepartmentsTree(t.data.department);n.setState({isTreeLoading:!1,departmentsTree:i})}else k.A.danger(t.data.errmsg)})).catch((function(e){n.handleError(e),n.setState({isTreeLoading:!1,isMembersListLoading:!1}),e.response&&403===e.response.status&&(window.location=p.Yc+"sys/useradmin/")}))},n.getDingtalkDepartmentMembersList=function(e){n.setState({isMembersListLoading:!0}),S.H.sysAdminListDingtalkDepartmentMembers(e).then((function(t){var i=n.state.membersTempObj;i[e]=t.data.userlist;var s=n.getCanCheckUserIds(t.data.userlist);n.setState({membersTempObj:i,membersList:t.data.userlist,isMembersListLoading:!1,canCheckUserIds:s})})).catch((function(e){n.setState({isMembersListLoading:!1}),n.handleError(e)}))},n.getCanCheckUserIds=function(e){var t=[];return e.forEach((function(e){e.email||t.push(e.userid)})),t},n.onChangeDepartment=function(e){if(n.setState({newUsersTempObj:{},isCheckedAll:!1,checkedDepartmentId:e}),e in n.state.membersTempObj){var t=n.getCanCheckUserIds(n.state.membersTempObj[e]);n.setState({membersList:n.state.membersTempObj[e],canCheckUserIds:t})}else n.getDingtalkDepartmentMembersList(e)},n.onUserChecked=function(e){if(-1!==n.state.canCheckUserIds.indexOf(e.userid)){var t=n.state.newUsersTempObj;e.userid in t?(delete t[e.userid],n.state.isCheckedAll&&n.setState({isCheckedAll:!1})):(t[e.userid]=e,Object.keys(t).length===n.state.canCheckUserIds.length&&n.setState({isCheckedAll:!0})),n.setState({newUsersTempObj:t})}},n.onAllUsersChecked=function(){n.setState({isCheckedAll:!n.state.isCheckedAll},(function(){if(n.state.isCheckedAll){for(var e={},t=n.state.membersList.filter((function(e){return-1!==n.state.canCheckUserIds.indexOf(e.userid)})),i=0;i<t.length;i++)e[t[i].userid]=t[i];n.setState({newUsersTempObj:e})}else n.setState({newUsersTempObj:{}})}))},n.onSubmit=function(){var e=n.state.newUsersTempObj;if("{}"!==JSON.stringify(e)){var t=[];for(var i in e)t.push(e[i]);0!==t.length?S.H.sysAdminAddDingtalkUsersBatch(t).then((function(e){if(n.setState({newUsersTempObj:{},isCheckedAll:!1}),e.data.success&&n.handleSubmitSuccess(e.data.success),e.data.failed)for(var t=e.data.failed,i=0;i<t.length;i++)k.A.danger(t[i].name+" "+t[i].error_msg,{duration:3})})).catch((function(e){n.handleError(e)})):k.A.danger("\u672a\u9009\u62e9\u6210\u5458",{duration:3})}},n.handleSubmitSuccess=function(e){for(var t=n.state,i=t.membersTempObj,s=t.membersList,a=t.canCheckUserIds,r=0;r<e.length;r++){var o=e[r],l=o.userid,c=o.name,d=o.email;k.A.success(c+" \u6210\u529f\u5bfc\u5165",{duration:1}),-1!==a.indexOf(l)&&a.splice(a.indexOf(l),1);for(var u=0;u<s.length;u++)if(s[u].userid===l){s[u].email=d;break}for(var h in i)for(var g=0;g<i[h].length;g++)if(i[h][g].userid===l){i[h][g].email=d;break}}n.setState({membersTempObj:i,membersList:s,canCheckUserIds:a})},n.importDepartmentDialogToggle=function(e){n.setState({isImportDepartmentDialogShow:!n.state.isImportDepartmentDialogShow,importDepartment:e},(function(){e&&n.getDingtalkDepartmentsList(e.id)}))},n.onImportDepartmentSubmit=function(){var e=n.state.importDepartment;e&&S.H.sysAdminImportDingtalkDepartment(e.id).then((function(t){n.setState({isMembersListLoading:!0,checkedDepartmentId:e.id,membersTempObj:{},membersList:[],newUsersTempObj:{},isCheckedAll:!1,canCheckUserIds:[]}),n.getDingtalkDepartmentMembersList(e.id),n.importDepartmentDialogToggle(null),t.data.success&&n.handleImportDepartmentSubmitSuccess(t.data.success),t.data.failed&&n.handleImportDepartmentSubmitFailed(t.data.failed)})).catch((function(e){n.handleError(e)}))},n.handleImportDepartmentSubmitSuccess=function(e){for(var t=0,n=e.length;t<n;t++){var i=e[t],s="department"===i.type?"\u90e8\u95e8 "+i.department_name+" \u5bfc\u5165\u6210\u529f":i.api_user_name+" \u5bfc\u5165\u6210\u529f";k.A.success(s,{duration:3})}},n.handleImportDepartmentSubmitFailed=function(e){for(var t=0,n=e.length;t<n;t++){var i=e[t],s="department"===i.type?i.department_name:i.api_user_name;k.A.danger(s+" "+i.msg,{duration:3})}},n.handleError=function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)},n.state={isTreeLoading:!0,isMembersListLoading:!0,departmentsTree:[],checkedDepartmentId:0,membersTempObj:{},membersList:[],newUsersTempObj:{},isCheckedAll:!1,canCheckUserIds:[],isImportDepartmentDialogShow:!1,importDepartment:null,importDepartmentChildrenCount:0,importDepartmentMembersCount:0},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){this.getDingtalkDepartmentsList(null)}},{key:"render",value:function(){var e=this.state,t=e.isImportDepartmentDialogShow,n=e.isTreeLoading,s=e.importDepartment,a=e.importDepartmentChildrenCount,r=e.importDepartmentMembersCount,o=!(!p.am||!t||n||!s);return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)((0,i.default)({},this.props),{},{children:(0,x.jsx)(j.A,{className:"operation-item",onClick:this.onSubmit,children:"\u5bfc\u5165\u7528\u6237"})})),(0,x.jsx)("div",{className:"main-panel-center",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)("div",{className:"cur-view-path",children:(0,x.jsx)("h3",{className:"sf-heading",children:"\u9489\u9489\u96c6\u6210"})}),(0,x.jsxs)("div",{className:"cur-view-content d-flex flex-row p-0",children:[(0,x.jsx)(Ma,{departmentsTree:this.state.departmentsTree,isTreeLoading:this.state.isTreeLoading,onChangeDepartment:this.onChangeDepartment,checkedDepartmentId:this.state.checkedDepartmentId,importDepartmentDialogToggle:this.importDepartmentDialogToggle}),(0,x.jsx)("div",{className:"dir-content-resize"}),(0,x.jsx)(_a,{isMembersListLoading:this.state.isMembersListLoading,membersList:this.state.membersList,checkedDepartmentId:this.state.checkedDepartmentId,newUsersTempObj:this.state.newUsersTempObj,onUserChecked:this.onUserChecked,onAllUsersChecked:this.onAllUsersChecked,isCheckedAll:this.state.isCheckedAll,canCheckUserIds:this.state.canCheckUserIds})]})]})}),o&&(0,x.jsx)(Ca,{importDepartmentDialogToggle:this.importDepartmentDialogToggle,onImportDepartmentSubmit:this.onImportDepartmentSubmit,departmentsCount:a,membersCount:r,departmentName:s.name})]})}}])}(l.Component);M().extend(ge());var Oa=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.getPreviousPage=function(){n.props.getItemsByPage(n.props.currentPage-1)},n.getNextPage=function(){n.props.getItemsByPage(n.props.currentPage+1)},n.state={isItemFreezed:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,i=t.errorMsg,s=t.items,a=t.curPerPage,r=t.hasNextPage,o=t.currentPage;if(n)return(0,x.jsx)(D.A,{});if(i)return(0,x.jsx)("p",{className:"error text-center mt-4",children:i});var c=(0,x.jsx)(me.A,{text:(0,p.AP)("No invitations")}),d=(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("table",{children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"20%",children:(0,p.AP)("Inviter")}),(0,x.jsx)("th",{width:"20%",children:(0,p.AP)("Accepter")}),(0,x.jsx)("th",{width:"9%",children:(0,p.AP)("Type")}),(0,x.jsx)("th",{width:"14%",children:(0,p.AP)("Invited at")}),(0,x.jsx)("th",{width:"14%",children:(0,p.AP)("Accepted at")}),(0,x.jsx)("th",{width:"18%",children:(0,p.AP)("Expired at")}),(0,x.jsx)("th",{width:"5%"})]})}),(0,x.jsx)("tbody",{children:s.map((function(t,n){return(0,x.jsx)(Ta,{item:t,isItemFreezed:e.state.isItemFreezed,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem,deleteItem:e.props.deleteItem},n)}))})]}),(0,x.jsx)(X.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:o,hasNextPage:r,curPerPage:a,resetPerPage:this.props.resetPerPage})]});return s.length?d:c}}])}(l.Component),Ta=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleMouseEnter=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!0,highlight:!0})},n.handleMouseLeave=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!1,highlight:!1})},n.onUnfreezedItem=function(){n.setState({highlight:!1,isOpIconShow:!1}),n.props.onUnfreezedItem()},n.deleteItem=function(){n.props.deleteItem(n.props.item)},n.translateOperations=function(e){var t="";if("Delete"===e)t=(0,p.AP)("Delete");return t},n.onMenuItemClick=function(e){if("Delete"===e)n.deleteItem()},n.getInviteTypeText=function(){var e="";switch(n.props.item.invite_type){case"Guest":case"guest":e=(0,p.AP)("Guest");break;case"Default":case"default":e=(0,p.AP)("Default");break;case"org":e=(0,p.AP)("Organization")}return e},n.state={isOpIconShown:!1,highlight:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.item,t=this.state.isOpIconShown;return(0,x.jsx)(l.Fragment,{children:(0,x.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,x.jsx)("td",{children:(0,x.jsx)(Se,{email:e.inviter_email,name:e.inviter_name})}),(0,x.jsx)("td",{children:e.accept_time?(0,x.jsx)(Se,{email:e.accepter_email,name:e.accepter_name}):e.accepter_email}),(0,x.jsx)("td",{children:this.getInviteTypeText()}),(0,x.jsx)("td",{children:(0,x.jsx)("span",{title:M()(e.invite_time).format("dddd, MMMM D, YYYY h:mm:ss A"),children:M()(e.invite_time).fromNow()})}),(0,x.jsx)("td",{children:e.accept_time?(0,x.jsx)("span",{title:M()(e.accept_time).format("dddd, MMMM D, YYYY h:mm:ss A"),children:M()(e.accept_time).fromNow()}):"--"}),(0,x.jsx)("td",{children:e.is_expired?(0,x.jsx)("span",{className:"text-red",children:M()(e.expire_time).format("YYYY-MM-DD HH:mm")}):M()(e.expire_time).format("YYYY-MM-DD HH:mm")}),(0,x.jsx)("td",{children:t&&(0,x.jsx)(et.A,{operations:["Delete"],translateOperations:this.translateOperations,onMenuItemClick:this.onMenuItemClick,onFreezedItem:this.props.onFreezedItem,onUnfreezedItem:this.onUnfreezedItem})})]})})}}])}(l.Component),Ra=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).getItemsByPage=function(e){var t=n.state.perPage;S.H.sysAdminListInvitations(e,t).then((function(i){n.setState({loading:!1,items:i.data.invitation_list,hasNextPage:f.Aq.hasNextPage(e,t,i.data.total_count),currentPage:e})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.deleteItem=function(e){var t=e.token;S.H.sysAdminDeleteInvitation(t).then((function(e){var i=n.state.items.filter((function(e){return e.token!=t}));n.setState({items:i}),k.A.success((0,p.AP)("Successfully deleted 1 item."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.deleteItemInBatch=function(){S.H.sysAdminDeleteExpiredInvitations().then((function(e){var t=n.state.items,i=n.state.items.filter((function(e){return!e.is_expired||e.accept_time}));i.length<t.length&&(n.setState({items:i}),k.A.success((0,p.AP)("Operation succeeded.")))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){n.getItemsByPage(1)}))},n.state={loading:!0,errorMsg:"",items:[],totalItemCount:0,hasNextPage:!1,currentPage:1,perPage:100},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,i=n.currentPage,s=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||s),currentPage:parseInt(t.get("page")||i)},(function(){e.getItemsByPage(e.state.currentPage)}))}},{key:"render",value:function(){return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)((0,i.default)({},this.props),{},{children:(0,x.jsx)(j.A,{className:"btn btn-secondary operation-item",onClick:this.deleteItemInBatch,children:(0,p.AP)("Delete Expired Invitations")})})),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)("div",{className:"cur-view-path",children:(0,x.jsx)("h3",{className:"sf-heading",children:(0,p.AP)("Invitations")})}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsx)(Oa,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:this.state.items,currentPage:this.state.currentPage,hasNextPage:this.state.hasNextPage,curPerPage:this.state.perPage,resetPerPage:this.resetPerPage,getItemsByPage:this.getItemsByPage,deleteItem:this.deleteItem})})]})})]})}}])}(l.Component),Ua=n(67604),Fa=n(92203),Ea=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).onKeyDown=function(e){e.stopPropagation()},n.toggle=function(){if(n.state.isValueChanged){var e=n.getCurrentContent();n.props.onCommit(e)}n.props.onCloseEditorDialog()},n.onContentChanged=function(){return n.setState({isValueChanged:!0})},n.getCurrentContent=function(){return n.editorRef.current.getValue()},n.setSimpleEditorRef=function(e){n.simpleEditor=e},n.state={isValueChanged:!1},n.editorRef=l.createRef(),n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props,t=e.content,n=e.title,i=void 0===n?(0,p.AP)("Terms"):n;return(0,x.jsxs)(u.A,{isOpen:!0,toggle:this.toggle,onKeyDown:this.onKeyDown,wrapClassName:"conditions-editor-dialog-wrapper",className:"conditions-editor-dialog",contentClassName:"conditions-editor-dialog-content",size:"lg",style:{width:770},children:[(0,x.jsx)(Ce.A,{className:"conditions-editor-dialog-title",toggle:this.toggle,children:i}),(0,x.jsx)(Ie.A,{className:"conditions-editor-dialog-main",children:(0,x.jsx)(Fa.SimpleEditor,{ref:this.editorRef,value:t||"",onContentChanged:this.onContentChanged})})]})}}])}(l.Component),za=Ea,Ba=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleNameChange=function(e){n.setState({name:e.target.value})},n.handleVersionNumberChange=function(e){n.setState({versionNumber:e.target.value.trim()})},n.handleTextChange=function(e){n.setState({text:e.target.value.trim()})},n.setActive=function(){n.setState({isActive:!0})},n.setInActive=function(){n.setState({isActive:!1})},n.addTerm=function(){var e=n.state,t=e.name,i=e.versionNumber,s=e.text,a=e.isActive;""!==t?""!==i?isNaN(i)?n.setState({errMsg:(0,p.AP)("Version Number must be a number.")}):""!==s?n.props.isUpdate?n.props.updateTerm(t,i,s,a):n.props.addTerm(t,i,s,a):n.setState({errMsg:(0,p.AP)("Text is required.")}):n.setState({errMsg:(0,p.AP)("Version Number is required.")}):n.setState({errMsg:(0,p.AP)("Name is required.")})},n.onContentClick=function(){n.setState({isConditionsEditorDialogShow:!n.state.isConditionsEditorDialogShow})},n.onCloseEditorDialog=function(){n.setState({isConditionsEditorDialogShow:!1})},n.onUpdateContent=function(e){n.setState({text:e})},n.state={name:"",versionNumber:"",text:"",isActive:!0,errorMsg:"",isConditionsEditorDialogShow:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this.props.oldTermObj;e&&this.setState({name:e.name,versionNumber:e.version_number,text:e.text,isActive:!(""===e.activate_time)})}},{key:"render",value:function(){var e=this.props.isUpdate?(0,p.AP)("Update Terms and Conditions"):(0,p.AP)("Add Terms and Conditions");return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)(u.A,{isOpen:!0,toggle:this.props.toggle,children:[(0,x.jsx)(Ce.A,{toggle:this.props.toggle,children:e}),(0,x.jsxs)(Ie.A,{children:[(0,x.jsxs)(Te.A,{children:[(0,x.jsx)(Re.A,{for:"name",children:(0,p.AP)("Name")}),(0,x.jsx)(W.A,{id:"name",value:this.state.name,onChange:this.handleNameChange})]}),(0,x.jsxs)(Te.A,{children:[(0,x.jsx)(Re.A,{children:(0,p.AP)("Version Number")}),(0,x.jsx)(W.A,{value:this.state.versionNumber,onChange:this.handleVersionNumberChange})]}),(0,x.jsxs)(Te.A,{className:"form-content",children:[(0,x.jsx)(Re.A,{children:(0,p.AP)("Text")}),(0,x.jsx)(Ua.A,{content:this.state.text,onContentClick:this.onContentClick})]}),(0,x.jsxs)(Te.A,{tag:"fieldset",children:[(0,x.jsx)(Re.A,{children:(0,p.AP)("Activated")}),(0,x.jsx)(Te.A,{check:!0,children:(0,x.jsxs)(Re.A,{check:!0,children:[(0,x.jsx)(W.A,{type:"radio",checked:this.state.isActive,onChange:this.setActive})," ",(0,p.AP)("On")]})}),(0,x.jsx)(Te.A,{check:!0,children:(0,x.jsxs)(Re.A,{check:!0,children:[(0,x.jsx)(W.A,{type:"radio",checked:!this.state.isActive,onChange:this.setInActive})," ",(0,p.AP)("Off")]})})]}),this.state.errMsg&&(0,x.jsx)(Ne.A,{color:"danger",children:this.state.errMsg})]}),(0,x.jsx)(Me.A,{children:(0,x.jsx)(j.A,{color:"primary",onClick:this.addTerm,children:(0,p.AP)("Submit")})})]}),this.state.isConditionsEditorDialogShow&&(0,x.jsx)(za,{content:this.state.text,onCommit:this.onUpdateContent,onCloseEditorDialog:this.onCloseEditorDialog})]})}}])}(l.Component),Ha=Ba,qa=/\[.+\]\(\S+\)|<img src=(\S+).+\/>|!\[\]\(\S+\)|<\S+>/g,Ya=/^<img src="(\S+)" .+\/>/,Va=/^!\[\]\((\S+)\)/,Ga=/^\[.+\]\(\S+\)/,Wa=/^<\S+>$/,Qa=function(e){for(var t="",n=e.replace(qa,""),i=0;i<n.length&&("#"===n[i]||("\n"===n[i]?t+=" ":t+=n[i],30!==t.length));i++);var s=e.match(qa);if(s){var a=function(e){var t={links:[],images:[]};return e.forEach((function(e){if(e.search(Ga)>=0||e.search(Wa)>=0)t.links.push(e);else{var n=e.match(Ya),i=e.match(Va);n?t.images.push(n[1]):i&&t.images.push(i[1])}})),t}(s);return{previewText:t,images:a.images,links:a.links}}return{previewText:t,images:[],links:[]}},Ka=function(e){function t(){var e;(0,s.default)(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=(0,r.default)(this,t,[].concat(i))).toggle=function(){e.props.onClosePreviewDialog()},e}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props,t=e.title,n=void 0===t?(0,p.AP)("Terms"):t,i=e.content;return(0,x.jsxs)(u.A,{isOpen:!0,size:"lg",style:{width:600},wrapClassName:"conditions-perview-wrapper",toggle:this.toggle,children:[(0,x.jsx)(Ce.A,{toggle:this.toggle,children:n}),(0,x.jsx)(Ie.A,{children:(0,x.jsx)(Ua.A,{content:i})})]})}}])}(l.Component),$a=Ka;M().extend(ge());var Xa=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleMouseEnter=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!0,isHighlighted:!0})},n.handleMouseLeave=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!1,isHighlighted:!1})},n.toggleUpdateDialog=function(e){n.setState({isUpdateDialogOpen:!n.state.isUpdateDialogOpen})},n.toggleDeleteDialog=function(e){n.setState({isDeleteDialogOpen:!n.state.isDeleteDialogOpen})},n.toggleTermsContentDialog=function(e){n.setState({isTermsPreviewDialogOpen:!n.state.isTermsPreviewDialogOpen})},n.onMenuItemClick=function(e){switch(e){case"Update":n.toggleUpdateDialog();break;case"Delete":n.toggleDeleteDialog()}},n.onUnfreezedItem=function(){n.setState({isHighlighted:!1,isOpIconShow:!1}),n.props.onUnfreezedItem()},n.deleteTerm=function(){n.props.deleteTerm(n.props.item.id),n.toggleDeleteDialog()},n.updateTerm=function(e,t,i,s){n.props.updateTerm(n.props.item.id,e,t,i,s),n.toggleUpdateDialog()},n.translateOperations=function(e){var t="";switch(e){case"Update":t=(0,p.AP)("Update");break;case"Delete":t=(0,p.AP)("Delete")}return t},n.state={itemContent:"...",isHighlighted:!1,isOpIconShown:!1,isUpdateDialogOpen:!1,isDeleteDialogOpen:!1,isTermsPreviewDialogOpen:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.item.text;Fa.processor.process(t).then((function(t){var n=String(t);e.setState({itemContent:n})}))}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this;if(e.item.text!==this.props.item.text){var n=e.item.text;Fa.processor.process(n).then((function(e){var n=String(e);t.setState({itemContent:n})}))}}},{key:"render",value:function(){var e=this.props.item,t=this.state,n=t.isDeleteDialogOpen,i=t.isUpdateDialogOpen,s=t.isTermsPreviewDialogOpen,a=t.isHighlighted,r=Qa(e.text),o='<span class="op-target">'+f.Aq.HTMLescape(e.name)+"</span>",c=(0,p.AP)("Are you sure you want to delete {placeholder} ?").replace("{placeholder}",o);return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("tr",{className:fe()({"tr-highlight":a}),onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,x.jsx)("td",{children:e.name}),(0,x.jsx)("td",{children:e.version_number}),(0,x.jsx)("td",{className:"ellipsis",children:(0,x.jsx)("a",{href:"#",onClick:this.toggleTermsContentDialog,children:r.previewText})}),(0,x.jsx)("td",{children:M()(e.ctime).fromNow()}),(0,x.jsx)("td",{children:e.activate_time?M()(e.activate_time).fromNow():"--"}),(0,x.jsx)("td",{children:this.state.isOpIconShown&&(0,x.jsx)(et.A,{operations:["Update","Delete"],translateOperations:this.translateOperations,onMenuItemClick:this.onMenuItemClick,onFreezedItem:this.props.onFreezedItem,onUnfreezedItem:this.onUnfreezedItem})})]}),n&&(0,x.jsx)(en.A,{children:(0,x.jsx)(Ye.A,{title:(0,p.AP)("Delete T&C"),message:c,toggleDialog:this.toggleDeleteDialog,executeOperation:this.deleteTerm,confirmBtnText:(0,p.AP)("Delete")})}),i&&(0,x.jsx)(en.A,{children:(0,x.jsx)(Ha,{updateTerm:this.updateTerm,toggle:this.toggleUpdateDialog,isUpdate:!0,oldTermObj:e})}),s&&(0,x.jsx)(en.A,{children:(0,x.jsx)($a,{content:e.text,onClosePreviewDialog:this.toggleTermsContentDialog})})]})}}])}(l.Component),Za=Xa,Ja=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.state={isItemFreezed:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,i=t.errorMsg,s=t.items;if(n)return(0,x.jsx)(D.A,{});if(i)return(0,x.jsx)("p",{className:"error text-center",children:i});var a=(0,x.jsx)(me.A,{text:(0,p.AP)("No terms and conditions")}),r=(0,x.jsx)(l.Fragment,{children:(0,x.jsxs)("table",{className:"table-hover",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"20%",children:(0,p.AP)("Name")}),(0,x.jsx)("th",{width:"10%",children:(0,p.AP)("Version")}),(0,x.jsx)("th",{width:"25%",children:(0,p.AP)("Text")}),(0,x.jsx)("th",{width:"20%",children:(0,p.AP)("Created")}),(0,x.jsx)("th",{width:"20%",children:(0,p.AP)("Activated")}),(0,x.jsx)("th",{width:"5%"})]})}),s&&(0,x.jsx)("tbody",{children:s.map((function(t,n){return(0,x.jsx)(Za,{item:t,isItemFreezed:e.state.isItemFreezed,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem,deleteTerm:e.props.deleteTerm,updateTerm:e.props.updateTerm},n)}))})]})});return s.length?r:a}}])}(l.Component),er=Ja,tr=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).toggleAddTermDialog=function(){n.setState({isAddTermDialogOpen:!n.state.isAddTermDialogOpen})},n.addTerm=function(e,t,n,i){S.H.sysAdminAddTermAndCondition(e,t,n,i).then((function(e){location.reload()})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.updateTerm=function(e,t,i,s,a){S.H.sysAdminUpdateTermAndCondition(e,t,i,s,a).then((function(t){var i=n.state.termList.map((function(n){return n.id==e?t.data:n}));n.setState({termList:i}),k.A.success((0,p.AP)("Update succeeded."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.deleteTerm=function(e){S.H.sysAdminDeleteTermAndCondition(e).then((function(t){var i=n.state.termList.filter((function(t){return t.id!=e}));n.setState({termList:i}),k.A.success((0,p.AP)("Successfully deleted 1 item."))})).catch((function(e){var t=f.Aq.getErrorMsg(e);k.A.danger(t)}))},n.state={loading:!0,errorMsg:"",termList:[],isAddTermDialogOpen:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this;S.H.sysAdminListTermsAndConditions().then((function(t){e.setState({termList:t.data.term_and_condition_list,loading:!1})})).catch((function(t){e.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(t,!0)})}))}},{key:"render",value:function(){var e=this.state,t=e.termList,n=e.isAddTermDialogOpen;return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)((0,i.default)({},this.props),{},{children:(0,x.jsx)(j.A,{className:"btn btn-secondary operation-item",onClick:this.toggleAddTermDialog,children:(0,p.AP)("Add")})})),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)("div",{className:"cur-view-path",children:(0,x.jsx)("h3",{className:"sf-heading",children:(0,p.AP)("Terms and Conditions")})}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsx)(er,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:t,deleteTerm:this.deleteTerm,updateTerm:this.updateTerm})})]})}),n&&(0,x.jsx)(en.A,{children:(0,x.jsx)(Ha,{isUpdate:!1,addTerm:this.addTerm,toggle:this.toggleAddTermDialog})})]})}}])}(l.Component),nr=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).navItems=[{name:"all",urlPart:"all",text:(0,p.AP)("All")},{name:"unhandled",urlPart:"unhandled",text:(0,p.AP)("Unhandled")}],n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.currentItem;return(0,x.jsx)("div",{className:"cur-view-path tab-nav-container",children:(0,x.jsx)("ul",{className:"nav",children:this.navItems.map((function(t,n){return(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(h.N_,{to:"".concat(p.Yc,"sys/virus-files/").concat(t.urlPart,"/"),className:"nav-link".concat(e==t.name?" active":""),children:t.text})},n)}))})})}}])}(l.Component),ir=nr,sr=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleMouseEnter=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!0,highlight:!0})},n.handleMouseLeave=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!1,highlight:!1})},n.onUnfreezedItem=function(){n.setState({highlight:!1,isOpIconShow:!1}),n.props.onUnfreezedItem()},n.onMenuItemClick=function(e){n.props.handleFile(n.props.virusFile.virus_id,e)},n.translateOperations=function(e){var t="";switch(e){case"delete":t=(0,p.AP)("Delete");break;case"ignore":t=(0,p.AP)("Ignore");break;case"do-not-ignore":t=(0,p.AP)("Don't ignore")}return t},n.state={highlight:!1,isOpIconShown:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.virusFile,t="",n=[];return e.has_deleted?t=(0,x.jsx)("span",{className:"text-green",children:(0,p.AP)("Deleted")}):e.has_ignored?(t=(0,x.jsx)("span",{className:"text-orange",children:(0,p.AP)("Ignored")}),n=["do-not-ignore"]):(t=(0,x.jsx)("span",{className:"text-red",children:(0,p.AP)("Unhandled")}),n=["delete","ignore"]),(0,x.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,x.jsx)("td",{children:e.repo_name}),(0,x.jsx)("td",{children:e.repo_owner}),(0,x.jsx)("td",{children:e.file_path}),(0,x.jsx)("td",{children:t}),(0,x.jsx)("td",{children:n.length>0&&this.state.isOpIconShown&&(0,x.jsx)(et.A,{operations:n,translateOperations:this.translateOperations,onMenuItemClick:this.onMenuItemClick,onFreezedItem:this.props.onFreezedItem,onUnfreezedItem:this.onUnfreezedItem})})]})}}])}(l.Component),ar=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.getPreviousPage=function(){n.props.getListByPage(n.props.currentPage-1)},n.getNextPage=function(){n.props.getListByPage(n.props.currentPage+1)},n.state={isItemFreezed:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,i=t.errorMsg,s=t.virusFiles,a=t.curPerPage,r=t.hasNextPage,o=t.currentPage;return n?(0,x.jsx)(D.A,{}):i?(0,x.jsx)("p",{className:"error text-center mt-4",children:i}):(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("table",{children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"27%",children:(0,p.AP)("Library")}),(0,x.jsx)("th",{width:"25%",children:(0,p.AP)("Owner")}),(0,x.jsx)("th",{width:"28%",children:(0,p.AP)("Virus File")}),(0,x.jsx)("th",{width:"15%",children:(0,p.AP)("Status")}),(0,x.jsx)("th",{width:"5%"})]})}),(0,x.jsx)("tbody",{children:s.map((function(t,n){return(0,x.jsx)(sr,{virusFile:t,isItemFreezed:e.state.isItemFreezed,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem,handleFile:e.props.handleFile},n)}))})]}),s.length>0&&(0,x.jsx)(X.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:o,hasNextPage:r,curPerPage:a,resetPerPage:this.props.resetPerPage})]})}}])}(l.Component),rr=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).getListByPage=function(e){var t=n.state.perPage;S.H.sysAdminListVirusFiles(e,t).then((function(e){var t=e.data;n.setState({loading:!1,virusFiles:t.virus_file_list,hasNextPage:t.has_next_page})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){n.getListByPage(1)}))},n.handleFile=function(e,t){var i;switch(t){case"delete":i=S.H.sysAdminDeleteVirusFile(e);break;case"ignore":i=S.H.sysAdminToggleIgnoreVirusFile(e,!0);break;case"do-not-ignore":i=S.H.sysAdminToggleIgnoreVirusFile(e,!1)}i.then((function(i){n.setState({virusFiles:n.state.virusFiles.map((function(n){return n.virus_id==e&&("delete"==t?n.has_deleted=!0:n=i.data.virus_file),n}))})})).catch((function(e){k.A.danger(f.Aq.getErrorMsg(e))}))},n.state={loading:!0,errorMsg:"",virusFiles:[],currentPage:1,perPage:100,hasNextPage:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,i=n.currentPage,s=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||s),currentPage:parseInt(t.get("page")||i)},(function(){e.getListByPage(e.state.currentPage)}))}},{key:"render",value:function(){return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsx)("div",{className:"main-panel-center",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(ir,{currentItem:"all"}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsx)(ar,{loading:this.state.loading,errorMsg:this.state.errorMsg,virusFiles:this.state.virusFiles,currentPage:this.state.currentPage,hasNextPage:this.state.hasNextPage,curPerPage:this.state.perPage,resetPerPage:this.resetPerPage,getListByPage:this.getListByPage,handleFile:this.handleFile})})]})})]})}}])}(l.Component),or=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).handleMouseEnter=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!0,highlight:!0})},n.handleMouseLeave=function(){n.props.isItemFreezed||n.setState({isOpIconShown:!1,highlight:!1})},n.onUnfreezedItem=function(){n.setState({highlight:!1,isOpIconShow:!1}),n.props.onUnfreezedItem()},n.onMenuItemClick=function(e){n.props.handleFile(n.props.virusFile.virus_id,e)},n.translateOperations=function(e){var t="";switch(e){case"delete":t=(0,p.AP)("Delete");break;case"ignore":t=(0,p.AP)("Ignore");break;case"do-not-ignore":t=(0,p.AP)("Don't ignore")}return t},n.toggleItemSelected=function(e){n.props.toggleItemSelected(n.props.virusFile,e.target.checked)},n.state={highlight:!1,isOpIconShown:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.virusFile,t="",n=[];return e.has_deleted?t=(0,x.jsx)("span",{className:"text-green",children:(0,p.AP)("Deleted")}):e.has_ignored?(t=(0,x.jsx)("span",{className:"text-orange",children:(0,p.AP)("Ignored")}),n=["do-not-ignore"]):(t=(0,x.jsx)("span",{className:"text-red",children:(0,p.AP)("Unhandled")}),n=["delete","ignore"]),(0,x.jsxs)("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,x.jsx)("td",{className:"text-center",children:(0,x.jsx)("input",{type:"checkbox",checked:e.isSelected,onChange:this.toggleItemSelected})}),(0,x.jsx)("td",{children:e.repo_name}),(0,x.jsx)("td",{children:e.repo_owner}),(0,x.jsx)("td",{children:e.file_path}),(0,x.jsx)("td",{children:t}),(0,x.jsx)("td",{children:n.length>0&&this.state.isOpIconShown&&(0,x.jsx)(et.A,{operations:n,translateOperations:this.translateOperations,onMenuItemClick:this.onMenuItemClick,onFreezedItem:this.props.onFreezedItem,onUnfreezedItem:this.onUnfreezedItem})})]})}}])}(l.Component),lr=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).onFreezedItem=function(){n.setState({isItemFreezed:!0})},n.onUnfreezedItem=function(){n.setState({isItemFreezed:!1})},n.getPreviousPage=function(){n.props.getListByPage(n.props.currentPage-1)},n.getNextPage=function(){n.props.getListByPage(n.props.currentPage+1)},n.state={isItemFreezed:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.loading,i=t.errorMsg,s=t.virusFiles,a=t.curPerPage,r=t.hasNextPage,o=t.currentPage,c=t.isAllItemsSelected;return n?(0,x.jsx)(D.A,{}):i?(0,x.jsx)("p",{className:"error text-center mt-4",children:i}):(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("table",{children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"3%",className:"text-center",children:(0,x.jsx)("input",{type:"checkbox",checked:c,onChange:this.props.toggleAllSelected})}),(0,x.jsx)("th",{width:"24%",children:(0,p.AP)("Library")}),(0,x.jsx)("th",{width:"25%",children:(0,p.AP)("Owner")}),(0,x.jsx)("th",{width:"28%",children:(0,p.AP)("Virus File")}),(0,x.jsx)("th",{width:"15%",children:(0,p.AP)("Status")}),(0,x.jsx)("th",{width:"5%"})]})}),(0,x.jsx)("tbody",{children:s.map((function(t,n){return(0,x.jsx)(or,{virusFile:t,isItemFreezed:e.state.isItemFreezed,onFreezedItem:e.onFreezedItem,onUnfreezedItem:e.onUnfreezedItem,handleFile:e.props.handleFile,toggleItemSelected:e.props.toggleItemSelected},n)}))})]}),s.length>0&&(0,x.jsx)(X.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:o,hasNextPage:r,curPerPage:a,resetPerPage:this.props.resetPerPage})]})}}])}(l.Component),cr=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).getListByPage=function(e){var t=n.state.perPage;S.H.sysAdminListVirusFiles(e,t,!1).then((function(e){var t=e.data,i=t.virus_file_list.map((function(e){return e.isSelected=!1,e}));n.setState({loading:!1,virusFiles:i,hasNextPage:t.has_next_page})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){n.getListByPage(1)}))},n.handleFile=function(e,t){var i;switch(t){case"delete":i=S.H.sysAdminDeleteVirusFile(e);break;case"ignore":i=S.H.sysAdminToggleIgnoreVirusFile(e,!0);break;case"do-not-ignore":i=S.H.sysAdminToggleIgnoreVirusFile(e,!1)}i.then((function(i){n.setState({virusFiles:n.state.virusFiles.map((function(n){return n.virus_id==e&&("delete"==t?n.has_deleted=!0:n=i.data.virus_file),n}))})})).catch((function(e){k.A.danger(f.Aq.getErrorMsg(e))}))},n.toggleAllSelected=function(){n.setState((function(e){return{isAllItemsSelected:!e.isAllItemsSelected,virusFiles:n.state.virusFiles.map((function(t){return t.isSelected=!e.isAllItemsSelected,t}))}}))},n.toggleItemSelected=function(e,t){n.setState({virusFiles:n.state.virusFiles.map((function(n){return n===e&&(n.isSelected=t),n}))},(function(){n.setState({isAllItemsSelected:!n.state.virusFiles.some((function(e){return!e.isSelected}))})}))},n.handleSelectedItems=function(e){var t=n.state.virusFiles.filter((function(t){return"delete-virus"==e?t.isSelected&&!t.has_deleted:t.isSelected&&!t.has_ignored})).map((function(e){return e.virus_id}));S.H.sysAdminBatchProcessVirusFiles(t,e).then((function(t){var i=n.state.virusFiles;t.data.success.forEach((function(t){var n=i.find((function(e){return e.virus_id==t.virus_id}));"delete-virus"==e?n.has_deleted=!0:n.has_ignored=!0})),n.setState({virusFiles:i}),t.data.failed.forEach((function(t){var n=i.find((function(e){return e.virus_id==t.virus_id})),s="delete-virus"==e?(0,p.AP)("Failed to delete %(virus_file) from library %(library): %(error_msg)"):(0,p.AP)("Failed to ignore %(virus_file) from library %(library): %(error_msg)");s=s.replace("%(virus_file)",n.file_path).replace("%(library)",n.repo_name).replace("%(error_msg)",t.error_msg),k.A.danger(s)}))})).catch((function(e){k.A.danger(f.Aq.getErrorMsg(e))}))},n.deleteSelectedItems=function(){n.handleSelectedItems("delete-virus")},n.ignoreSelectedItems=function(){n.handleSelectedItems("ignore-virus")},n.state={loading:!0,errorMsg:"",virusFiles:[],isAllItemsSelected:!1,selectedItems:[],currentPage:1,perPage:100,hasNextPage:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,i=n.currentPage,s=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||s),currentPage:parseInt(t.get("page")||i)},(function(){e.getListByPage(e.state.currentPage)}))}},{key:"render",value:function(){return(0,x.jsxs)(l.Fragment,{children:[this.state.virusFiles.some((function(e){return e.isSelected}))?(0,x.jsx)(_.A,(0,i.default)((0,i.default)({},this.props),{},{children:(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(j.A,{onClick:this.deleteSelectedItems,className:"operation-item",children:(0,p.AP)("Delete")}),(0,x.jsx)(j.A,{onClick:this.ignoreSelectedItems,className:"operation-item",children:(0,p.AP)("Ignore")})]})})):(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsx)("div",{className:"main-panel-center",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(ir,{currentItem:"unhandled"}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsx)(lr,{loading:this.state.loading,errorMsg:this.state.errorMsg,virusFiles:this.state.virusFiles,currentPage:this.state.currentPage,hasNextPage:this.state.hasNextPage,curPerPage:this.state.perPage,resetPerPage:this.resetPerPage,getListByPage:this.getListByPage,handleFile:this.handleFile,isAllItemsSelected:this.state.isAllItemsSelected,toggleAllSelected:this.toggleAllSelected,toggleItemSelected:this.toggleItemSelected})})]})})]})}}])}(l.Component),dr=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).navItems=[{name:"adminOperationLogs",urlPart:"admin-logs/operation",text:(0,p.AP)("Admin Operation Logs")},{name:"adminLoginLogs",urlPart:"admin-logs/login",text:(0,p.AP)("Admin Login Logs")}],n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.currentItem;return(0,x.jsx)("div",{className:"cur-view-path tab-nav-container",children:(0,x.jsx)("ul",{className:"nav",children:this.navItems.map((function(t,n){return(0,x.jsx)("li",{className:"nav-item",children:(0,x.jsx)(h.N_,{to:"".concat(p.Yc,"sys/").concat(t.urlPart,"/"),className:"nav-link".concat(e==t.name?" active":""),children:t.text})},n)}))})})}}])}(l.Component);M().extend(ge());var ur=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).getPreviousPage=function(){n.props.getLogsByPage(n.props.currentPage-1)},n.getNextPage=function(){n.props.getLogsByPage(n.props.currentPage+1)},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg,i=e.items,s=e.perPage,a=e.currentPage,r=e.hasNextPage;if(t)return(0,x.jsx)(D.A,{});if(n)return(0,x.jsx)("p",{className:"error text-center",children:n});var o=(0,x.jsx)(me.A,{text:(0,p.AP)("No Admin operation logs")}),c=(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("table",{className:"table-hover",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"20%",children:(0,p.AP)("Name")}),(0,x.jsx)("th",{width:"15%",children:(0,p.AP)("Operation")}),(0,x.jsx)("th",{width:"50%",children:(0,p.AP)("Detail")}),(0,x.jsx)("th",{width:"15%",children:(0,p.AP)("Time")})]})}),i&&(0,x.jsx)("tbody",{children:i.map((function(e,t){return(0,x.jsx)(hr,{item:e},t)}))})]}),(0,x.jsx)(X.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:a,hasNextPage:r,curPerPage:s,resetPerPage:this.props.resetPerPage})]});return i.length?c:o}}])}(l.Component),hr=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).getOperationText=function(e){switch(e){case"repo_create":return(0,p.AP)("Create Library");case"repo_delete":return(0,p.AP)("Delete Library");case"repo_transfer":return(0,p.AP)("Transfer Library");case"group_create":return(0,p.AP)("Create Group");case"group_transfer":return(0,p.AP)("Transfer Group");case"group_delete":return(0,p.AP)("Delete Group");case"user_add":return(0,p.AP)("Add User");case"user_delete":return(0,p.AP)("Delete User");case"user_migrate":return(0,p.AP)("Migrate User");case"group_member_add":return(0,p.AP)("Add User to Group");case"group_member_delete":return(0,p.AP)("Delete User from Group");default:return""}},n.getOperationDetail=function(e){var t=e.detail,n="";t.owner&&(n=p.Yc+"sys/users/"+encodeURIComponent(t.owner)+"/");var i="";t.email&&(i=p.Yc+"sys/users/"+encodeURIComponent(t.email)+"/");var s="",a="",r="";switch("repo_create"!=e.operation&&"repo_delete"!=e.operation&&"repo_transfer"!=e.operation||(a=p.Yc+"sys/libraries/"+t.id+"/"+encodeURIComponent(t.name)+"/"),"group_create"!=e.operation&&"group_delete"!=e.operation&&"group_transfer"!=e.operation||(r=p.Yc+"sys/groups/"+t.id+"/libraries/"),e.operation){case"repo_create":return s=(0,p.AP)("Created library {library_name} with {owner} as its owner").replace("{owner}",'<a href="'+n+'">'+t.owner+"</a>"),s=p.am&&p.ZD?s.replace("{library_name}",'<a href="'+a+'">'+f.Aq.HTMLescape(t.name)+"</a>"):s.replace("{library_name}",'<span class="font-weight-bold">'+f.Aq.HTMLescape(t.name)+"</span>");case"repo_delete":return s=(0,p.AP)("Deleted library {library_name}").replace("{library_name}",'<span class="font-weight-bold">'+f.Aq.HTMLescape(t.name)+"</span>");case"repo_transfer":return s=(0,p.AP)("Transferred library {library_name} from {user_from} to {user_to}").replace("{user_from}",'<span class="font-weight-bold">'+t.from+"</span>").replace("{user_to}",'<span class="font-weight-bold">'+t.to+"</span>"),s=p.am&&p.ZD?s.replace("{library_name}",'<a href="'+a+'">'+f.Aq.HTMLescape(t.name)+"</a>"):s.replace("{library_name}",'<span class="font-weight-bold">'+f.Aq.HTMLescape(t.name)+"</span>");case"group_create":return s=(0,p.AP)("Created group {group_name}").replace("{group_name}",'<a href="'+r+'">'+t.name+"</a>");case"group_transfer":return s=(0,p.AP)("Transferred group {group_name} from {user_from} to {user_to}").replace("{user_from}",'<span class="font-weight-bold">'+t.from+"</span>").replace("{user_to}",'<span class="font-weight-bold">'+t.to+"</span>").replace("{group_name}",'<a href="'+r+'">'+t.name+"</a>");case"group_delete":return s=(0,p.AP)("Deleted group {group_name}").replace("{group_name}",'<span class="font-weight-bold">'+t.name+"</span>");case"user_add":return s=(0,p.AP)("Added user {user}").replace("{user}",'<a href="'+i+'">'+t.email+"</a>");case"user_delete":return s=(0,p.AP)("Deleted user {user}").replace("{user}",'<span class="font-weight-bold">'+t.email+"</span>");case"user_migrate":return s=(0,p.AP)("User migrate from {user_from} to {user_to}").replace("{user_from}",'<span class="font-weight-bold">'+t.from+"</span>").replace("{user_to}",'<span class="font-weight-bold">'+t.to+"</span>");case"group_member_add":return s=(0,p.AP)("Added user {user} to group {group}").replace("{user}",'<span class="font-weight-bold">'+t.user+"</span>").replace("{group}",'<span class="font-weight-bold">'+t.name+"</span>");case"group_member_delete":return s=(0,p.AP)("Deleted user {user} from group {group}").replace("{user}",'<span class="font-weight-bold">'+t.user+"</span>").replace("{group}",'<span class="font-weight-bold">'+t.name+"</span>");default:return""}},n.state={isOpIconShown:!1},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.item;return(0,x.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,children:[(0,x.jsx)("td",{children:(0,x.jsx)(Se,{email:e.email,name:e.name})}),(0,x.jsx)("td",{children:this.getOperationText(e.operation)}),(0,x.jsx)("td",{children:(0,x.jsx)("span",{dangerouslySetInnerHTML:{__html:this.getOperationDetail(e)}})}),(0,x.jsx)("td",{children:M()(e.datetime).fromNow()})]})}}])}(l.Component),gr=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).getLogsByPage=function(e){var t=n.state.perPage;S.H.sysAdminListAdminLogs(e,t).then((function(i){n.setState({logList:i.data.data,loading:!1,currentPage:e,hasNextPage:f.Aq.hasNextPage(e,t,i.data.total_count)})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){return n.getLogsByPage(n.initPage)}))},n.state={loading:!0,errorMsg:"",logList:[],perPage:100,currentPage:1,hasNextPage:!1},n.initPage=1,n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,i=n.currentPage,s=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||s),currentPage:parseInt(t.get("page")||i)},(function(){e.getLogsByPage(e.state.currentPage)}))}},{key:"render",value:function(){var e=this.state,t=e.logList,n=e.currentPage,s=e.perPage,a=e.hasNextPage;return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(dr,{currentItem:"adminOperationLogs"}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsx)(ur,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:t,currentPage:n,perPage:s,hasNextPage:a,getLogsByPage:this.getLogsByPage,resetPerPage:this.resetPerPage})})]})})]})}}])}(l.Component);M().extend(ge());var pr=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).getPreviousPage=function(){n.props.getLogsByPage(n.props.currentPage-1)},n.getNextPage=function(){n.props.getLogsByPage(n.props.currentPage+1)},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props,t=e.loading,n=e.errorMsg,i=e.items,s=e.perPage,a=e.currentPage,r=e.hasNextPage;if(t)return(0,x.jsx)(D.A,{});if(n)return(0,x.jsx)("p",{className:"error text-center",children:n});var o=(0,x.jsx)(me.A,{text:(0,p.AP)("No Admin login logs")}),c=(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)("table",{className:"table-hover",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"25%",children:(0,p.AP)("Name")}),(0,x.jsx)("th",{width:"25%",children:(0,p.AP)("IP")}),(0,x.jsx)("th",{width:"25%",children:(0,p.AP)("Status")}),(0,x.jsx)("th",{width:"25%",children:(0,p.AP)("Time")})]})}),i&&(0,x.jsx)("tbody",{children:i.map((function(e,t){return(0,x.jsx)(fr,{item:e},t)}))})]}),(0,x.jsx)(X.A,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:a,hasNextPage:r,curPerPage:s,resetPerPage:this.props.resetPerPage})]});return i.length?c:o}}])}(l.Component),fr=function(e){function t(e){return(0,s.default)(this,t),(0,r.default)(this,t,[e])}return(0,o.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props.item;return(0,x.jsxs)("tr",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,children:[(0,x.jsx)("td",{children:(0,x.jsx)(Se,{email:e.email,name:e.name})}),(0,x.jsx)("td",{children:e.login_ip}),(0,x.jsx)("td",{children:e.login_success?(0,p.AP)("Success"):(0,p.AP)("Failed")}),(0,x.jsx)("td",{children:M()(e.login_time).fromNow()})]})}}])}(l.Component),mr=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).getLogsByPage=function(e){var t=n.state.perPage;S.H.sysAdminListAdminLoginLogs(e,t).then((function(i){n.setState({logList:i.data.data,loading:!1,currentPage:e,hasNextPage:f.Aq.hasNextPage(e,t,i.data.total_count)})})).catch((function(e){n.setState({loading:!1,errorMsg:f.Aq.getErrorMsg(e,!0)})}))},n.resetPerPage=function(e){n.setState({perPage:e},(function(){return n.getLogsByPage(n.initPage)}))},n.state={loading:!0,errorMsg:"",logList:[],perPage:100,currentPage:1,hasNextPage:!1},n.initPage=1,n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,n=this.state,i=n.currentPage,s=n.perPage;this.setState({perPage:parseInt(t.get("per_page")||s),currentPage:parseInt(t.get("page")||i)},(function(){e.getLogsByPage(e.state.currentPage)}))}},{key:"render",value:function(){var e=this.state,t=e.logList,n=e.currentPage,s=e.perPage,a=e.hasNextPage;return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsx)("div",{className:"main-panel-center flex-row",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)(dr,{currentItem:"adminLoginLogs"}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsx)(pr,{loading:this.state.loading,errorMsg:this.state.errorMsg,items:t,currentPage:n,perPage:s,hasNextPage:a,getLogsByPage:this.getLogsByPage,resetPerPage:this.resetPerPage})})]})})]})}}])}(l.Component),vr=function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).listAbuseReports=function(){S.H.sysAdminListAbuseReports().then((function(e){n.setState({abuseReportList:e.data.abuse_report_list})})).catch((function(e){n.handleError(e)}))},n.updateAbuseReport=function(e,t){S.H.sysAdminUpdateAbuseReport(e,t).then((function(e){var i=n.state.abuseReportList.map((function(n,i){return n.id===t&&(n.handled=e.data.handled),n}));n.setState({abuseReportList:i})})).catch((function(e){n.handleError(e)}))},n.handleError=function(e){e.response?k.A.danger(e.response.data.error_msg||e.response.data.detail||(0,p.AP)("Error"),{duration:3}):k.A.danger((0,p.AP)("Please check the network."),{duration:3})},n.state={abuseReportList:[]},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){this.listAbuseReports()}},{key:"render",value:function(){var e=this,t=this.state.abuseReportList.map((function(t,n){var i=(!t.handled).toString(),s=t.id,a=p.Yc+"lib/"+t.repo_id+"/file"+t.file_path;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:t.repo_name}),(0,x.jsx)("td",{children:(0,x.jsx)("a",{href:a,target:"_blank",rel:"noreferrer",children:t.file_path})}),(0,x.jsx)("td",{children:t.reporter}),(0,x.jsx)("td",{children:t.abuse_type}),(0,x.jsx)("td",{children:t.description}),(0,x.jsx)("td",{children:M()(t.time).format("YYYY-MM-DD")}),(0,x.jsx)("td",{children:(0,x.jsx)("p",{onClick:e.updateAbuseReport.bind(e,i,s),className:"op-target ellipsis ellipsis-op-target cursor-pointer",children:(0,p.AP)(t.handled.toString())})})]},n)}));return(0,x.jsxs)(l.Fragment,{children:[(0,x.jsx)(_.A,(0,i.default)({},this.props)),(0,x.jsx)("div",{className:"main-panel-center",children:(0,x.jsxs)("div",{className:"cur-view-container",children:[(0,x.jsx)("div",{className:"cur-view-path",children:(0,x.jsx)("h3",{className:"sf-heading",children:(0,p.AP)("Abuse Reports")})}),(0,x.jsx)("div",{className:"cur-view-content",children:(0,x.jsxs)("table",{className:"table-hover",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{width:"20%",children:(0,p.AP)("Library")}),(0,x.jsx)("th",{width:"20%",children:(0,p.AP)("File")}),(0,x.jsx)("th",{width:"10%",children:(0,p.AP)("Reporter")}),(0,x.jsx)("th",{width:"15%",children:(0,p.AP)("Abuse Type")}),(0,x.jsx)("th",{width:"20%",children:(0,p.AP)("Description")}),(0,x.jsx)("th",{width:"10%",children:(0,p.AP)("Time")}),(0,x.jsx)("th",{width:"5%",children:(0,p.AP)("Handled")})]})}),(0,x.jsx)("tbody",{children:t})]})})]})})]})}}])}(l.Component),xr=(n(16322),n(18291),function(e){function t(e){var n;return(0,s.default)(this,t),(n=(0,r.default)(this,t,[e])).getCurrentTabForPageList=function(e){for(var t,n,i="".concat(p.Yc,"sys/"),s=0,a=e.length;s<a;s++){t=e[s].urlPartList,n=e[s].tab;for(var r=0,o=t.length;r<o;r++)if(-1!=location.href.indexOf("".concat(i).concat(t[r])))return n}},n.onCloseSidePanel=function(){n.setState({isSidePanelClosed:!n.state.isSidePanelClosed})},n.tabItemClick=function(e){n.setState({currentTab:e}),f.Aq.isDesktop()||n.state.isSidePanelClosed||n.setState({isSidePanelClosed:!0})},n.toggleSidePanel=function(){n.setState({isSidePanelClosed:!n.state.isSidePanelClosed})},n.state={isSidePanelClosed:!1,currentTab:"file-scan"},n}return(0,o.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=window.location.href.split("/"),t=e[e.length-2],n=this.getCurrentTabForPageList([{tab:"devices",urlPartList:["desktop-devices","mobile-devices","device-errors"]},{tab:"libraries",urlPartList:["all-libraries","search-libraries","system-library","trash-libraries","libraries/"]},{tab:"statistic",urlPartList:["statistics/file","statistics/storage","statistics/user","statistics/traffic","statistics/reports","statistics/metrics"]},{tab:"users",urlPartList:["users/","search-users/"]},{tab:"groups",urlPartList:["groups/","search-groups/"]},{tab:"organizations",urlPartList:["organizations/","search-organizations/"]},{tab:"links",urlPartList:["share-links/","upload-links/"]},{tab:"institutions",urlPartList:["institutions/"]},{tab:"termsandconditions",urlPartList:["terms-and-conditions/"]},{tab:"departments",urlPartList:["departments/"]},{tab:"logs",urlPartList:["logs/"]},{tab:"virus-files",urlPartList:["virus-files/"]},{tab:"adminLogs",urlPartList:["admin-logs/"]}]);t=n||t,this.setState({currentTab:t})}},{key:"UNSAFE_componentWillMount",value:function(){f.Aq.isDesktop()||this.setState({isSidePanelClosed:!0})}},{key:"render",value:function(){var e=this.state,t=e.currentTab,n=e.isSidePanelClosed,s={toggleSidePanel:this.toggleSidePanel};return(0,x.jsxs)("div",{id:"main",className:"sys-admin",children:[(0,x.jsx)(y,{isSidePanelClosed:n,onCloseSidePanel:this.onCloseSidePanel,currentTab:t,tabItemClick:this.tabItemClick}),(0,x.jsx)(b,{children:(0,x.jsxs)(h.Ix,{className:"reach-router",children:[(0,x.jsx)(I,(0,i.default)({path:p.Yc+"sys/info"},s)),(0,x.jsx)(V,(0,i.default)({path:p.Yc+"sys/statistics/file"},s)),(0,x.jsx)(G,(0,i.default)({path:p.Yc+"sys/statistics/storage"},s)),(0,x.jsx)(te,(0,i.default)({path:p.Yc+"sys/statistics/user"},s)),(0,x.jsx)(ee,(0,i.default)({path:p.Yc+"sys/statistics/traffic"},s)),(0,x.jsx)(ne,(0,i.default)({path:p.Yc+"sys/statistics/reports"},s)),(0,x.jsx)(ce,(0,i.default)({path:p.Yc+"sys/statistics/metrics"},s)),(0,x.jsx)(Pe,(0,i.default)({path:p.Yc+"sys/desktop-devices"},s)),(0,x.jsx)(be,(0,i.default)({path:p.Yc+"sys/mobile-devices"},s)),(0,x.jsx)(_e,(0,i.default)({path:p.Yc+"sys/device-errors"},s)),(0,x.jsx)(Sn,(0,i.default)({path:p.Yc+"sys/all-libraries"},s)),(0,x.jsx)(kn,(0,i.default)({path:p.Yc+"sys/all-wikis"},s)),(0,x.jsx)(wn,(0,i.default)({path:p.Yc+"sys/system-library"},s)),(0,x.jsx)(Ln,(0,i.default)({path:p.Yc+"sys/trash-libraries"},s)),(0,x.jsx)(On,(0,i.default)({path:p.Yc+"sys/search-libraries"},s)),(0,x.jsx)(qn,(0,i.default)({path:p.Yc+"sys/libraries/:repoID/*"},s)),(0,x.jsx)(ca,(0,i.default)({path:p.Yc+"sys/web-settings"},s)),(0,x.jsx)(ga,(0,i.default)({path:p.Yc+"sys/notifications"},s)),(0,x.jsx)(Xn,(0,i.default)({path:p.Yc+"sys/groups"},s)),(0,x.jsx)(Zn,(0,i.default)({path:p.Yc+"sys/search-groups"},s)),(0,x.jsx)(si,(0,i.default)({path:p.Yc+"sys/groups/:groupID/libraries"},s)),(0,x.jsx)(li,(0,i.default)({path:p.Yc+"sys/groups/:groupID/members"},s)),(0,x.jsx)(Mi,(0,i.default)({path:p.Yc+"sys/departments/"},s)),(0,x.jsx)(Ri,(0,i.default)({path:p.Yc+"sys/share-links"},s)),(0,x.jsx)(Ei,(0,i.default)({path:p.Yc+"sys/upload-links"},s)),(0,x.jsx)(Vi,(0,i.default)({path:p.Yc+"sys/organizations"},s)),(0,x.jsx)(Gi,(0,i.default)({path:p.Yc+"sys/search-organizations"},s)),(0,x.jsx)(Ji,(0,i.default)({path:p.Yc+"sys/organizations/:orgID/info"},s)),(0,x.jsx)(is,(0,i.default)({path:p.Yc+"sys/organizations/:orgID/users"},s)),(0,x.jsx)(rs,(0,i.default)({path:p.Yc+"sys/organizations/:orgID/groups"},s)),(0,x.jsx)(cs,(0,i.default)({path:p.Yc+"sys/organizations/:orgID/libraries"},s)),(0,x.jsx)(gs,(0,i.default)({path:p.Yc+"sys/institutions"},s)),(0,x.jsx)(vs,(0,i.default)({path:p.Yc+"sys/institutions/:institutionID/info"},s)),(0,x.jsx)(Ps,(0,i.default)({path:p.Yc+"sys/institutions/:institutionID/members"},s)),(0,x.jsx)(Ss,(0,i.default)({path:p.Yc+"sys/institutions/:institutionID/admins"},s)),(0,x.jsx)(Os,(0,i.default)({path:p.Yc+"sys/logs/login"},s)),(0,x.jsx)(zs,(0,i.default)({path:p.Yc+"sys/logs/file-access"},s)),(0,x.jsx)(Js,(0,i.default)({path:p.Yc+"sys/logs/repo-transfer"},s)),(0,x.jsx)(ia,(0,i.default)({path:p.Yc+"sys/logs/group-member-audit"},s)),(0,x.jsx)(Vs,(0,i.default)({path:p.Yc+"sys/logs/file-update"},s)),(0,x.jsx)(Ks,(0,i.default)({path:p.Yc+"sys/logs/share-permission"},s)),(0,x.jsx)(gr,(0,i.default)({path:p.Yc+"sys/admin-logs/operation"},s)),(0,x.jsx)(mr,(0,i.default)({path:p.Yc+"sys/admin-logs/login"},s)),(0,x.jsx)(ut,(0,i.default)({path:p.Yc+"sys/users"},s)),(0,x.jsx)(gt,(0,i.default)({path:p.Yc+"sys/users/admins"},s)),(0,x.jsx)(ft,(0,i.default)({path:p.Yc+"sys/users/ldap-imported"},s)),(0,x.jsx)(At,(0,i.default)({path:p.Yc+"sys/users/ldap"},s)),(0,x.jsx)(bt,(0,i.default)({path:p.Yc+"sys/search-users"},s)),(0,x.jsx)(Lt,(0,i.default)({path:p.Yc+"sys/users/:email"},s)),(0,x.jsx)(Ft,(0,i.default)({path:p.Yc+"sys/users/:email/owned-libraries"},s)),(0,x.jsx)(qt,(0,i.default)({path:p.Yc+"sys/users/:email/shared-libraries"},s)),(0,x.jsx)(Wt,(0,i.default)({path:p.Yc+"sys/users/:email/shared-links"},s)),(0,x.jsx)($t,(0,i.default)({path:p.Yc+"sys/users/:email/groups"},s)),(0,x.jsx)(Ra,(0,i.default)({path:p.Yc+"sys/invitations"},s)),(0,x.jsx)(tr,(0,i.default)({path:p.Yc+"sys/terms-and-conditions/"},s)),(0,x.jsx)(rr,(0,i.default)({path:p.Yc+"sys/virus-files/all"},s)),(0,x.jsx)(cr,(0,i.default)({path:p.Yc+"sys/virus-files/unhandled"},s)),(0,x.jsx)(ma,(0,i.default)({path:p.Yc+"sys/file-scan-records"},s)),(0,x.jsx)(Da,(0,i.default)({path:p.Yc+"sys/work-weixin"},s)),(0,x.jsx)(La,(0,i.default)({path:p.Yc+"sys/dingtalk"},s)),(0,x.jsx)(vr,(0,i.default)({path:p.Yc+"sys/abuse-reports"},s))]})}),(0,x.jsx)(d.Ay,{query:"(max-width: 767.8px)",children:(0,x.jsx)(u.A,{zIndex:"1030",isOpen:!n,toggle:this.toggleSidePanel,contentClassName:"d-none"})})]})}}])}(l.Component));(0,c.createRoot)(document.getElementById("wrapper")).render((0,x.jsx)(g.I18nextProvider,{value:m.A,children:(0,x.jsx)(h.dP,{history:h.W7,children:(0,x.jsx)(xr,{})})}))},32043:function(e,t,n){var i=n(23029),s=n(92901),a=n(39874),r=n(85501),o=n(9950),l=n(51925),c=n(40326),d=n(44414),u=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,t,arguments)}return(0,r.default)(t,e),(0,s.default)(t,[{key:"render",value:function(){return(0,d.jsxs)("div",{className:"main-panel-north ".concat(this.props.children?"border-left-show":""),children:[(0,d.jsxs)("div",{className:"cur-view-toolbar",children:[(0,d.jsx)("span",{className:"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none",title:(0,c.AP)("Side Nav Menu"),onClick:this.props.toggleSidePanel}),(0,d.jsx)("div",{className:"operation",children:this.props.children})]}),(0,d.jsxs)("div",{className:"common-toolbar",children:[this.props.search&&this.props.search,(0,d.jsx)(l.A,{isAdminPanel:!0})]})]})}}])}(o.Component);t.A=u},33320:function(e,t,n){var i=n(23029),s=n(92901),a=n(39874),r=n(85501),o=n(9950),l=n(44414),c=function(e){function t(e){var n;return(0,i.default)(this,t),(n=(0,a.default)(this,t,[e])).handleInputChange=function(e){n.setState({value:e.target.value})},n.handleKeyDown=function(e){"Enter"==e.key&&(e.preventDefault(),n.handleSubmit())},n.handleSubmit=function(){var e=n.state.value.trim();if(!e)return!1;n.props.submit(e)},n.state={value:""},n}return(0,r.default)(t,e),(0,s.default)(t,[{key:"render",value:function(){return(0,l.jsxs)("div",{className:"input-icon",children:[(0,l.jsx)("i",{className:"d-flex input-icon-addon sf3-font sf3-font-search"}),(0,l.jsx)("input",{type:"text",className:"form-control search-input h-6 mr-1",style:{width:"17rem"},placeholder:this.props.placeholder,value:this.state.value,onChange:this.handleInputChange,onKeyDown:this.handleKeyDown,autoComplete:"off"})]})}}])}(o.Component);t.A=c},37696:function(){},2201:function(){},63864:function(){},35298:function(e,t,n){n.d(t,{PP:function(){return Ea},t1:function(){return Vs},s$:function(){return Aa},ZT:function(){return ui},No:function(){return ra},kc:function(){return qa},FN:function(){return la},hE:function(){return Pa},m_:function(){return Ra}});var i=n(89379),s=n(39874),a=n(5182),r=n(85501),o=n(5544),l=n(24765),c=n(64467),d=n(60436),u=n(23029),h=n(92901);function g(e){return e+.5|0}var p=function(e,t,n){return Math.max(Math.min(e,n),t)};function f(e){return p(g(2.55*e),0,255)}function m(e){return p(g(255*e),0,255)}function v(e){return p(g(e/2.55)/100,0,1)}function x(e){return p(g(100*e),0,100)}var A={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},y=(0,d.default)("0123456789ABCDEF"),P=function(e){return y[15&e]},b=function(e){return y[(240&e)>>4]+y[15&e]},j=function(e){return(240&e)>>4===(15&e)};function S(e){var t=function(e){return j(e.r)&&j(e.g)&&j(e.b)&&j(e.a)}(e)?P:b;return e?"#"+t(e.r)+t(e.g)+t(e.b)+function(e,t){return e<255?t(e):""}(e.a,t):void 0}var k=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function D(e,t,n){var i=t*Math.min(n,1-n),s=function(t){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(t+e/30)%12;return n-i*Math.max(Math.min(s-3,9-s,1),-1)};return[s(0),s(8),s(4)]}function _(e,t,n){var i=function(i){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(i+e/60)%6;return n-n*t*Math.max(Math.min(s,4-s,1),0)};return[i(5),i(3),i(1)]}function w(e,t,n){var i,s=D(e,1,.5);for(t+n>1&&(t*=i=1/(t+n),n*=i),i=0;i<3;i++)s[i]*=1-t-n,s[i]+=t;return s}function I(e){var t,n,i,s=e.r/255,a=e.g/255,r=e.b/255,o=Math.max(s,a,r),l=Math.min(s,a,r),c=(o+l)/2;return o!==l&&(i=o-l,n=c>.5?i/(2-o-l):i/(o+l),t=function(e,t,n,i,s){return e===s?(t-n)/i+(t<n?6:0):t===s?(n-e)/i+2:(e-t)/i+4}(s,a,r,i,o),t=60*t+.5),[0|t,n||0,c]}function N(e,t,n,i){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,n,i)).map(m)}function M(e,t,n){return N(D,e,t,n)}function C(e){return(e%360+360)%360}function L(e){var t,n=k.exec(e),i=255;if(n){n[5]!==t&&(i=n[6]?f(+n[5]):m(+n[5]));var s=C(+n[2]),a=+n[3]/100,r=+n[4]/100;return{r:(t="hwb"===n[1]?function(e,t,n){return N(w,e,t,n)}(s,a,r):"hsv"===n[1]?function(e,t,n){return N(_,e,t,n)}(s,a,r):M(s,a,r))[0],g:t[1],b:t[2],a:i}}}var O,T={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},R={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function U(e){O||((O=function(){var e,t,n,i,s,a={},r=Object.keys(R),o=Object.keys(T);for(e=0;e<r.length;e++){for(i=s=r[e],t=0;t<o.length;t++)n=o[t],s=s.replace(n,T[n]);n=parseInt(R[i],16),a[s]=[n>>16&255,n>>8&255,255&n]}return a}()).transparent=[0,0,0,0]);var t=O[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:4===t.length?t[3]:255}}var F=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;var E=function(e){return e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055},z=function(e){return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)};function B(e,t,n){if(e){var i=I(e);i[t]=Math.max(0,Math.min(i[t]+i[t]*n,0===t?360:1)),i=M(i),e.r=i[0],e.g=i[1],e.b=i[2]}}function H(e,t){return e?Object.assign(t||{},e):e}function q(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=m(e[3]))):(t=H(e,{r:0,g:0,b:0,a:1})).a=m(t.a),t}function Y(e){return"r"===e.charAt(0)?function(e){var t,n,i,s=F.exec(e),a=255;if(s){if(s[7]!==t){var r=+s[7];a=s[8]?f(r):p(255*r,0,255)}return t=+s[1],n=+s[3],i=+s[5],{r:t=255&(s[2]?f(t):p(t,0,255)),g:n=255&(s[4]?f(n):p(n,0,255)),b:i=255&(s[6]?f(i):p(i,0,255)),a:a}}}(e):L(e)}var V=function(){function e(t){if((0,u.default)(this,e),t instanceof e)return t;var n,i=typeof t;"object"===i?n=q(t):"string"===i&&(n=function(e){var t,n=e.length;return"#"===e[0]&&(4===n||5===n?t={r:255&17*A[e[1]],g:255&17*A[e[2]],b:255&17*A[e[3]],a:5===n?17*A[e[4]]:255}:7!==n&&9!==n||(t={r:A[e[1]]<<4|A[e[2]],g:A[e[3]]<<4|A[e[4]],b:A[e[5]]<<4|A[e[6]],a:9===n?A[e[7]]<<4|A[e[8]]:255})),t}(t)||U(t)||Y(t)),this._rgb=n,this._valid=!!n}return(0,h.default)(e,[{key:"valid",get:function(){return this._valid}},{key:"rgb",get:function(){var e=H(this._rgb);return e&&(e.a=v(e.a)),e},set:function(e){this._rgb=q(e)}},{key:"rgbString",value:function(){return this._valid?(e=this._rgb)&&(e.a<255?"rgba(".concat(e.r,", ").concat(e.g,", ").concat(e.b,", ").concat(v(e.a),")"):"rgb(".concat(e.r,", ").concat(e.g,", ").concat(e.b,")")):void 0;var e}},{key:"hexString",value:function(){return this._valid?S(this._rgb):void 0}},{key:"hslString",value:function(){return this._valid?function(e){if(e){var t=I(e),n=t[0],i=x(t[1]),s=x(t[2]);return e.a<255?"hsla(".concat(n,", ").concat(i,"%, ").concat(s,"%, ").concat(v(e.a),")"):"hsl(".concat(n,", ").concat(i,"%, ").concat(s,"%)")}}(this._rgb):void 0}},{key:"mix",value:function(e,t){if(e){var n,i=this.rgb,s=e.rgb,a=t===n?.5:t,r=2*a-1,o=i.a-s.a,l=((r*o===-1?r:(r+o)/(1+r*o))+1)/2;n=1-l,i.r=255&l*i.r+n*s.r+.5,i.g=255&l*i.g+n*s.g+.5,i.b=255&l*i.b+n*s.b+.5,i.a=a*i.a+(1-a)*s.a,this.rgb=i}return this}},{key:"interpolate",value:function(e,t){return e&&(this._rgb=function(e,t,n){var i=z(v(e.r)),s=z(v(e.g)),a=z(v(e.b));return{r:m(E(i+n*(z(v(t.r))-i))),g:m(E(s+n*(z(v(t.g))-s))),b:m(E(a+n*(z(v(t.b))-a))),a:e.a+n*(t.a-e.a)}}(this._rgb,e._rgb,t)),this}},{key:"clone",value:function(){return new e(this.rgb)}},{key:"alpha",value:function(e){return this._rgb.a=m(e),this}},{key:"clearer",value:function(e){return this._rgb.a*=1-e,this}},{key:"greyscale",value:function(){var e=this._rgb,t=g(.3*e.r+.59*e.g+.11*e.b);return e.r=e.g=e.b=t,this}},{key:"opaquer",value:function(e){return this._rgb.a*=1+e,this}},{key:"negate",value:function(){var e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}},{key:"lighten",value:function(e){return B(this._rgb,2,e),this}},{key:"darken",value:function(e){return B(this._rgb,2,-e),this}},{key:"saturate",value:function(e){return B(this._rgb,1,e),this}},{key:"desaturate",value:function(e){return B(this._rgb,1,-e),this}},{key:"rotate",value:function(e){return function(e,t){var n=I(e);n[0]=C(n[0]+t),n=M(n),e.r=n[0],e.g=n[1],e.b=n[2]}(this._rgb,e),this}}])}();function G(){}var W=function(){var e=0;return function(){return e++}}();function Q(e){return null===e||void 0===e}function K(e){if(Array.isArray&&Array.isArray(e))return!0;var t=Object.prototype.toString.call(e);return"[object"===t.slice(0,7)&&"Array]"===t.slice(-6)}function $(e){return null!==e&&"[object Object]"===Object.prototype.toString.call(e)}function X(e){return("number"===typeof e||e instanceof Number)&&isFinite(+e)}function Z(e,t){return X(e)?e:t}function J(e,t){return"undefined"===typeof e?t:e}var ee=function(e,t){return"string"===typeof e&&e.endsWith("%")?parseFloat(e)/100*t:+e};function te(e,t,n){if(e&&"function"===typeof e.call)return e.apply(n,t)}function ne(e,t,n,i){var s,a,r;if(K(e))if(a=e.length,i)for(s=a-1;s>=0;s--)t.call(n,e[s],s);else for(s=0;s<a;s++)t.call(n,e[s],s);else if($(e))for(a=(r=Object.keys(e)).length,s=0;s<a;s++)t.call(n,e[r[s]],r[s])}function ie(e,t){var n,i,s,a;if(!e||!t||e.length!==t.length)return!1;for(n=0,i=e.length;n<i;++n)if(s=e[n],a=t[n],s.datasetIndex!==a.datasetIndex||s.index!==a.index)return!1;return!0}function se(e){if(K(e))return e.map(se);if($(e)){for(var t=Object.create(null),n=Object.keys(e),i=n.length,s=0;s<i;++s)t[n[s]]=se(e[n[s]]);return t}return e}function ae(e){return-1===["__proto__","prototype","constructor"].indexOf(e)}function re(e,t,n,i){if(ae(e)){var s=t[e],a=n[e];$(s)&&$(a)?oe(s,a,i):t[e]=se(a)}}function oe(e,t,n){var i=K(t)?t:[t],s=i.length;if(!$(e))return e;for(var a,r=(n=n||{}).merger||re,o=0;o<s;++o)if($(a=i[o]))for(var l=Object.keys(a),c=0,d=l.length;c<d;++c)r(l[c],e,a,n);return e}function le(e,t){return oe(e,t,{merger:ce})}function ce(e,t,n){if(ae(e)){var i=t[e],s=n[e];$(i)&&$(s)?le(i,s):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=se(s))}}var de={"":function(e){return e},x:function(e){return e.x},y:function(e){return e.y}};function ue(e){var t=function(e){var t,n=e.split("."),i=[],s="",a=(0,l.default)(n);try{for(a.s();!(t=a.n()).done;)(s+=t.value).endsWith("\\")?s=s.slice(0,-1)+".":(i.push(s),s="")}catch(r){a.e(r)}finally{a.f()}return i}(e);return function(e){var n,i=(0,l.default)(t);try{for(i.s();!(n=i.n()).done;){var s=n.value;if(""===s)break;e=e&&e[s]}}catch(a){i.e(a)}finally{i.f()}return e}}function he(e,t){return(de[t]||(de[t]=ue(t)))(e)}function ge(e){return e.charAt(0).toUpperCase()+e.slice(1)}var pe=function(e){return"undefined"!==typeof e},fe=function(e){return"function"===typeof e},me=function(e,t){if(e.size!==t.size)return!1;var n,i=(0,l.default)(e);try{for(i.s();!(n=i.n()).done;){var s=n.value;if(!t.has(s))return!1}}catch(a){i.e(a)}finally{i.f()}return!0};var ve=Math.PI,xe=2*ve,Ae=xe+ve,ye=Number.POSITIVE_INFINITY,Pe=ve/180,be=ve/2,je=ve/4,Se=2*ve/3,ke=Math.log10,De=Math.sign;function _e(e,t,n){return Math.abs(e-t)<n}function we(e){var t=Math.round(e);e=_e(e,t,e/1e3)?t:e;var n=Math.pow(10,Math.floor(ke(e))),i=e/n;return(i<=1?1:i<=2?2:i<=5?5:10)*n}function Ie(e){return!isNaN(parseFloat(e))&&isFinite(e)}function Ne(e,t,n){var i,s,a;for(i=0,s=e.length;i<s;i++)a=e[i][n],isNaN(a)||(t.min=Math.min(t.min,a),t.max=Math.max(t.max,a))}function Me(e){return e*(ve/180)}function Ce(e){return e*(180/ve)}function Le(e){if(X(e)){for(var t=1,n=0;Math.round(e*t)/t!==e;)t*=10,n++;return n}}function Oe(e,t){var n=t.x-e.x,i=t.y-e.y,s=Math.sqrt(n*n+i*i),a=Math.atan2(i,n);return a<-.5*ve&&(a+=xe),{angle:a,distance:s}}function Te(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function Re(e,t){return(e-t+Ae)%xe-ve}function Ue(e){return(e%xe+xe)%xe}function Fe(e,t,n,i){var s=Ue(e),a=Ue(t),r=Ue(n),o=Ue(a-s),l=Ue(r-s),c=Ue(s-a),d=Ue(s-r);return s===a||s===r||i&&a===r||o>l&&c<d}function Ee(e,t,n){return Math.max(t,Math.min(n,e))}function ze(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-6;return e>=Math.min(t,n)-i&&e<=Math.max(t,n)+i}function Be(e,t,n){n=n||function(n){return e[n]<t};for(var i,s=e.length-1,a=0;s-a>1;)n(i=a+s>>1)?a=i:s=i;return{lo:a,hi:s}}var He=function(e,t,n,i){return Be(e,n,i?function(i){var s=e[i][t];return s<n||s===n&&e[i+1][t]===n}:function(i){return e[i][t]<n})},qe=function(e,t,n){return Be(e,n,(function(i){return e[i][t]>=n}))};var Ye=["push","pop","shift","splice","unshift"];function Ve(e,t){var n=e._chartjs;if(n){var i=n.listeners,s=i.indexOf(t);-1!==s&&i.splice(s,1),i.length>0||(Ye.forEach((function(t){delete e[t]})),delete e._chartjs)}}function Ge(e){var t=new Set(e);return t.size===e.length?e:Array.from(t)}var We="undefined"===typeof window?function(e){return e()}:window.requestAnimationFrame;function Qe(e,t){var n=[],i=!1;return function(){for(var s=arguments.length,a=new Array(s),r=0;r<s;r++)a[r]=arguments[r];n=a,i||(i=!0,We.call(window,(function(){i=!1,e.apply(t,n)})))}}var Ke=function(e){return"start"===e?"left":"end"===e?"right":"center"},$e=function(e,t,n){return"start"===e?t:"end"===e?n:(t+n)/2};function Xe(e,t,n){var i=t.length,s=0,a=i;if(e._sorted){var r=e.iScale,o=e._parsed,l=r.axis,c=r.getUserBounds(),d=c.min,u=c.max,h=c.minDefined,g=c.maxDefined;h&&(s=Ee(Math.min(He(o,l,d).lo,n?i:He(t,l,r.getPixelForValue(d)).lo),0,i-1)),a=g?Ee(Math.max(He(o,r.axis,u,!0).hi+1,n?0:He(t,l,r.getPixelForValue(u),!0).hi+1),s,i)-s:i-s}return{start:s,count:a}}function Ze(e){var t=e.xScale,n=e.yScale,i=e._scaleRanges,s={xmin:t.min,xmax:t.max,ymin:n.min,ymax:n.max};if(!i)return e._scaleRanges=s,!0;var a=i.xmin!==t.min||i.xmax!==t.max||i.ymin!==n.min||i.ymax!==n.max;return Object.assign(i,s),a}var Je=function(e){return 0===e||1===e},et=function(e,t,n){return-Math.pow(2,10*(e-=1))*Math.sin((e-t)*xe/n)},tt=function(e,t,n){return Math.pow(2,-10*e)*Math.sin((e-t)*xe/n)+1},nt={linear:function(e){return e},easeInQuad:function(e){return e*e},easeOutQuad:function(e){return-e*(e-2)},easeInOutQuad:function(e){return(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1)},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return(e-=1)*e*e+1},easeInOutCubic:function(e){return(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return-((e-=1)*e*e*e-1)},easeInOutQuart:function(e){return(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},easeInQuint:function(e){return e*e*e*e*e},easeOutQuint:function(e){return(e-=1)*e*e*e*e+1},easeInOutQuint:function(e){return(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},easeInSine:function(e){return 1-Math.cos(e*be)},easeOutSine:function(e){return Math.sin(e*be)},easeInOutSine:function(e){return-.5*(Math.cos(ve*e)-1)},easeInExpo:function(e){return 0===e?0:Math.pow(2,10*(e-1))},easeOutExpo:function(e){return 1===e?1:1-Math.pow(2,-10*e)},easeInOutExpo:function(e){return Je(e)?e:e<.5?.5*Math.pow(2,10*(2*e-1)):.5*(2-Math.pow(2,-10*(2*e-1)))},easeInCirc:function(e){return e>=1?e:-(Math.sqrt(1-e*e)-1)},easeOutCirc:function(e){return Math.sqrt(1-(e-=1)*e)},easeInOutCirc:function(e){return(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},easeInElastic:function(e){return Je(e)?e:et(e,.075,.3)},easeOutElastic:function(e){return Je(e)?e:tt(e,.075,.3)},easeInOutElastic:function(e){var t=.1125;return Je(e)?e:e<.5?.5*et(2*e,t,.45):.5+.5*tt(2*e-1,t,.45)},easeInBack:function(e){var t=1.70158;return e*e*((t+1)*e-t)},easeOutBack:function(e){var t=1.70158;return(e-=1)*e*((t+1)*e+t)+1},easeInOutBack:function(e){var t=1.70158;return(e/=.5)<1?e*e*((1+(t*=1.525))*e-t)*.5:.5*((e-=2)*e*((1+(t*=1.525))*e+t)+2)},easeInBounce:function(e){return 1-nt.easeOutBounce(1-e)},easeOutBounce:function(e){var t=7.5625,n=2.75;return e<1/n?t*e*e:e<2/n?t*(e-=1.5/n)*e+.75:e<2.5/n?t*(e-=2.25/n)*e+.9375:t*(e-=2.625/n)*e+.984375},easeInOutBounce:function(e){return e<.5?.5*nt.easeInBounce(2*e):.5*nt.easeOutBounce(2*e-1)+.5}};function it(e){if(e&&"object"===typeof e){var t=e.toString();return"[object CanvasPattern]"===t||"[object CanvasGradient]"===t}return!1}function st(e){return it(e)?e:new V(e)}function at(e){return it(e)?e:new V(e).saturate(.5).darken(.1).hexString()}var rt=["x","y","borderWidth","radius","tension"],ot=["color","borderColor","backgroundColor"];var lt=new Map;function ct(e,t,n){return function(e,t){t=t||{};var n=e+JSON.stringify(t),i=lt.get(n);return i||(i=new Intl.NumberFormat(e,t),lt.set(n,i)),i}(t,n).format(e)}var dt={values:function(e){return K(e)?e:""+e},numeric:function(e,t,n){if(0===e)return"0";var i,s=this.chart.options.locale,a=e;if(n.length>1){var r=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(r<1e-4||r>1e15)&&(i="scientific"),a=function(e,t){var n=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;Math.abs(n)>=1&&e!==Math.floor(e)&&(n=e-Math.floor(e));return n}(e,n)}var o=ke(Math.abs(a)),l=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),c={notation:i,minimumFractionDigits:l,maximumFractionDigits:l};return Object.assign(c,this.options.ticks.format),ct(e,s,c)},logarithmic:function(e,t,n){if(0===e)return"0";var i=n[t].significand||e/Math.pow(10,Math.floor(ke(e)));return[1,2,3,5,10,15].includes(i)||t>.8*n.length?dt.numeric.call(this,e,t,n):""}};var ut={formatters:dt};var ht=Object.create(null),gt=Object.create(null);function pt(e,t){if(!t)return e;for(var n=t.split("."),i=0,s=n.length;i<s;++i){var a=n[i];e=e[a]||(e[a]=Object.create(null))}return e}function ft(e,t,n){return"string"===typeof t?oe(pt(e,t),n):oe(pt(e,""),t)}var mt=function(){return(0,h.default)((function e(t,n){(0,u.default)(this,e),this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=function(e){return e.chart.platform.getDevicePixelRatio()},this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=function(e,t){return at(t.backgroundColor)},this.hoverBorderColor=function(e,t){return at(t.borderColor)},this.hoverColor=function(e,t){return at(t.color)},this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(n)}),[{key:"set",value:function(e,t){return ft(this,e,t)}},{key:"get",value:function(e){return pt(this,e)}},{key:"describe",value:function(e,t){return ft(gt,e,t)}},{key:"override",value:function(e,t){return ft(ht,e,t)}},{key:"route",value:function(e,t,n,i){var s=pt(this,e),a=pt(this,n),r="_"+t;Object.defineProperties(s,(0,c.default)((0,c.default)({},r,{value:s[t],writable:!0}),t,{enumerable:!0,get:function(){var e=this[r],t=a[i];return $(e)?Object.assign({},t,e):J(e,t)},set:function(e){this[r]=e}}))}},{key:"apply",value:function(e){var t=this;e.forEach((function(e){return e(t)}))}}])}(),vt=new mt({_scriptable:function(e){return!e.startsWith("on")},_indexable:function(e){return"events"!==e},hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[function(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:function(e){return"onProgress"!==e&&"onComplete"!==e&&"fn"!==e}}),e.set("animations",{colors:{type:"color",properties:ot},numbers:{type:"number",properties:rt}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:function(e){return 0|e}}}}})},function(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})},function(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:function(e,t){return t.lineWidth},tickColor:function(e,t){return t.color},offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:ut.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:function(e){return!e.startsWith("before")&&!e.startsWith("after")&&"callback"!==e&&"parser"!==e},_indexable:function(e){return"borderDash"!==e&&"tickBorderDash"!==e&&"dash"!==e}}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:function(e){return"backdropPadding"!==e&&"callback"!==e},_indexable:function(e){return"backdropPadding"!==e}})}]);function xt(e,t,n,i,s){var a=t[s];return a||(a=t[s]=e.measureText(s).width,n.push(s)),a>i&&(i=a),i}function At(e,t,n,i){var s=(i=i||{}).data=i.data||{},a=i.garbageCollect=i.garbageCollect||[];i.font!==t&&(s=i.data={},a=i.garbageCollect=[],i.font=t),e.save(),e.font=t;var r,o,l,c,d,u=0,h=n.length;for(r=0;r<h;r++)if(void 0===(c=n[r])||null===c||K(c)){if(K(c))for(o=0,l=c.length;o<l;o++)void 0===(d=c[o])||null===d||K(d)||(u=xt(e,s,a,u,d))}else u=xt(e,s,a,u,c);e.restore();var g=a.length/2;if(g>n.length){for(r=0;r<g;r++)delete s[a[r]];a.splice(0,g)}return u}function yt(e,t,n){var i=e.currentDevicePixelRatio,s=0!==n?Math.max(n/2,.5):0;return Math.round((t-s)*i)/i+s}function Pt(e,t){(t||e)&&((t=t||e.getContext("2d")).save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore())}function bt(e,t,n,i){jt(e,t,n,i,null)}function jt(e,t,n,i,s){var a,r,o,l,c,d,u,h,g=t.pointStyle,p=t.rotation,f=t.radius,m=(p||0)*Pe;if(g&&"object"===typeof g&&("[object HTMLImageElement]"===(a=g.toString())||"[object HTMLCanvasElement]"===a))return e.save(),e.translate(n,i),e.rotate(m),e.drawImage(g,-g.width/2,-g.height/2,g.width,g.height),void e.restore();if(!(isNaN(f)||f<=0)){switch(e.beginPath(),g){default:s?e.ellipse(n,i,s/2,f,0,0,xe):e.arc(n,i,f,0,xe),e.closePath();break;case"triangle":d=s?s/2:f,e.moveTo(n+Math.sin(m)*d,i-Math.cos(m)*f),m+=Se,e.lineTo(n+Math.sin(m)*d,i-Math.cos(m)*f),m+=Se,e.lineTo(n+Math.sin(m)*d,i-Math.cos(m)*f),e.closePath();break;case"rectRounded":l=f-(c=.516*f),r=Math.cos(m+je)*l,u=Math.cos(m+je)*(s?s/2-c:l),o=Math.sin(m+je)*l,h=Math.sin(m+je)*(s?s/2-c:l),e.arc(n-u,i-o,c,m-ve,m-be),e.arc(n+h,i-r,c,m-be,m),e.arc(n+u,i+o,c,m,m+be),e.arc(n-h,i+r,c,m+be,m+ve),e.closePath();break;case"rect":if(!p){l=Math.SQRT1_2*f,d=s?s/2:l,e.rect(n-d,i-l,2*d,2*l);break}m+=je;case"rectRot":u=Math.cos(m)*(s?s/2:f),r=Math.cos(m)*f,o=Math.sin(m)*f,h=Math.sin(m)*(s?s/2:f),e.moveTo(n-u,i-o),e.lineTo(n+h,i-r),e.lineTo(n+u,i+o),e.lineTo(n-h,i+r),e.closePath();break;case"crossRot":m+=je;case"cross":u=Math.cos(m)*(s?s/2:f),r=Math.cos(m)*f,o=Math.sin(m)*f,h=Math.sin(m)*(s?s/2:f),e.moveTo(n-u,i-o),e.lineTo(n+u,i+o),e.moveTo(n+h,i-r),e.lineTo(n-h,i+r);break;case"star":u=Math.cos(m)*(s?s/2:f),r=Math.cos(m)*f,o=Math.sin(m)*f,h=Math.sin(m)*(s?s/2:f),e.moveTo(n-u,i-o),e.lineTo(n+u,i+o),e.moveTo(n+h,i-r),e.lineTo(n-h,i+r),m+=je,u=Math.cos(m)*(s?s/2:f),r=Math.cos(m)*f,o=Math.sin(m)*f,h=Math.sin(m)*(s?s/2:f),e.moveTo(n-u,i-o),e.lineTo(n+u,i+o),e.moveTo(n+h,i-r),e.lineTo(n-h,i+r);break;case"line":r=s?s/2:Math.cos(m)*f,o=Math.sin(m)*f,e.moveTo(n-r,i-o),e.lineTo(n+r,i+o);break;case"dash":e.moveTo(n,i),e.lineTo(n+Math.cos(m)*(s?s/2:f),i+Math.sin(m)*f);break;case!1:e.closePath()}e.fill(),t.borderWidth>0&&e.stroke()}}function St(e,t,n){return n=n||.5,!t||e&&e.x>t.left-n&&e.x<t.right+n&&e.y>t.top-n&&e.y<t.bottom+n}function kt(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function Dt(e){e.restore()}function _t(e,t,n,i,s){if(!t)return e.lineTo(n.x,n.y);if("middle"===s){var a=(t.x+n.x)/2;e.lineTo(a,t.y),e.lineTo(a,n.y)}else"after"===s!==!!i?e.lineTo(t.x,n.y):e.lineTo(n.x,t.y);e.lineTo(n.x,n.y)}function wt(e,t,n,i){if(!t)return e.lineTo(n.x,n.y);e.bezierCurveTo(i?t.cp1x:t.cp2x,i?t.cp1y:t.cp2y,i?n.cp2x:n.cp1x,i?n.cp2y:n.cp1y,n.x,n.y)}function It(e,t,n,i,s){if(s.strikethrough||s.underline){var a=e.measureText(i),r=t-a.actualBoundingBoxLeft,o=t+a.actualBoundingBoxRight,l=n-a.actualBoundingBoxAscent,c=n+a.actualBoundingBoxDescent,d=s.strikethrough?(l+c)/2:c;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=s.decorationWidth||2,e.moveTo(r,d),e.lineTo(o,d),e.stroke()}}function Nt(e,t){var n=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=n}function Mt(e,t,n,i,s){var a,r,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},l=K(t)?t:[t],c=o.strokeWidth>0&&""!==o.strokeColor;for(e.save(),e.font=s.string,function(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),Q(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}(e,o),a=0;a<l.length;++a)r=l[a],o.backdrop&&Nt(e,o.backdrop),c&&(o.strokeColor&&(e.strokeStyle=o.strokeColor),Q(o.strokeWidth)||(e.lineWidth=o.strokeWidth),e.strokeText(r,n,i,o.maxWidth)),e.fillText(r,n,i,o.maxWidth),It(e,n,i,r,o),i+=Number(s.lineHeight);e.restore()}function Ct(e,t){var n=t.x,i=t.y,s=t.w,a=t.h,r=t.radius;e.arc(n+r.topLeft,i+r.topLeft,r.topLeft,1.5*ve,ve,!0),e.lineTo(n,i+a-r.bottomLeft),e.arc(n+r.bottomLeft,i+a-r.bottomLeft,r.bottomLeft,ve,be,!0),e.lineTo(n+s-r.bottomRight,i+a),e.arc(n+s-r.bottomRight,i+a-r.bottomRight,r.bottomRight,be,0,!0),e.lineTo(n+s,i+r.topRight),e.arc(n+s-r.topRight,i+r.topRight,r.topRight,0,-be,!0),e.lineTo(n+r.topLeft,i)}var Lt=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,Ot=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function Tt(e,t){var n=(""+e).match(Lt);if(!n||"normal"===n[1])return 1.2*t;switch(e=+n[2],n[3]){case"px":return e;case"%":e/=100}return t*e}function Rt(e,t){var n,i={},s=$(t),a=s?Object.keys(t):t,r=$(e)?s?function(n){return J(e[n],e[t[n]])}:function(t){return e[t]}:function(){return e},o=(0,l.default)(a);try{for(o.s();!(n=o.n()).done;){var c=n.value;i[c]=+r(c)||0}}catch(d){o.e(d)}finally{o.f()}return i}function Ut(e){return Rt(e,{top:"y",right:"x",bottom:"y",left:"x"})}function Ft(e){return Rt(e,["topLeft","topRight","bottomLeft","bottomRight"])}function Et(e){var t=Ut(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function zt(e,t){e=e||{},t=t||vt.font;var n=J(e.size,t.size);"string"===typeof n&&(n=parseInt(n,10));var i=J(e.style,t.style);i&&!(""+i).match(Ot)&&(console.warn('Invalid font style specified: "'+i+'"'),i=void 0);var s={family:J(e.family,t.family),lineHeight:Tt(J(e.lineHeight,t.lineHeight),n),size:n,style:i,weight:J(e.weight,t.weight),string:""};return s.string=function(e){return!e||Q(e.size)||Q(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}(s),s}function Bt(e,t,n,i){var s,a,r,o=!0;for(s=0,a=e.length;s<a;++s)if(void 0!==(r=e[s])&&(void 0!==t&&"function"===typeof r&&(r=r(t),o=!1),void 0!==n&&K(r)&&(r=r[n%r.length],o=!1),void 0!==r))return i&&!o&&(i.cacheable=!1),r}function Ht(e,t){return Object.assign(Object.create(e),t)}function qt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[""],n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){return e[0]},s=(arguments.length>2?arguments[2]:void 0)||e;"undefined"===typeof n&&(n=en("_fallback",e));var a=(0,c.default)((0,c.default)((0,c.default)((0,c.default)((0,c.default)((0,c.default)((0,c.default)({},Symbol.toStringTag,"Object"),"_cacheable",!0),"_scopes",e),"_rootScopes",s),"_fallback",n),"_getTarget",i),"override",(function(i){return qt([i].concat((0,d.default)(e)),t,s,n)}));return new Proxy(a,{deleteProperty:function(t,n){return delete t[n],delete t._keys,delete e[0][n],!0},get:function(n,i){return Qt(n,i,(function(){return function(e,t,n,i){var s,a,r=(0,l.default)(t);try{for(r.s();!(a=r.n()).done;){var o=a.value;if("undefined"!==typeof(s=en(Gt(o,e),n)))return Wt(e,s)?Zt(n,i,e,s):s}}catch(c){r.e(c)}finally{r.f()}}(i,t,e,n)}))},getOwnPropertyDescriptor:function(e,t){return Reflect.getOwnPropertyDescriptor(e._scopes[0],t)},getPrototypeOf:function(){return Reflect.getPrototypeOf(e[0])},has:function(e,t){return tn(e).includes(t)},ownKeys:function(e){return tn(e)},set:function(e,t,n){var s=e._storage||(e._storage=i());return e[t]=s[t]=n,delete e._keys,!0}})}function Yt(e,t,n,i){var s={_cacheable:!1,_proxy:e,_context:t,_subProxy:n,_stack:new Set,_descriptors:Vt(e,i),setContext:function(t){return Yt(e,t,n,i)},override:function(s){return Yt(e.override(s),t,n,i)}};return new Proxy(s,{deleteProperty:function(t,n){return delete t[n],delete e[n],!0},get:function(e,t,n){return Qt(e,t,(function(){return function(e,t,n){var i=e._proxy,s=e._context,a=e._subProxy,r=e._descriptors,o=i[t];fe(o)&&r.isScriptable(t)&&(o=function(e,t,n,i){var s=n._proxy,a=n._context,r=n._subProxy,o=n._stack;if(o.has(e))throw new Error("Recursion detected: "+Array.from(o).join("->")+"->"+e);o.add(e);var l=t(a,r||i);o.delete(e),Wt(e,l)&&(l=Zt(s._scopes,s,e,l));return l}(t,o,e,n));K(o)&&o.length&&(o=function(e,t,n,i){var s=n._proxy,a=n._context,r=n._subProxy,o=n._descriptors;if("undefined"!==typeof a.index&&i(e))return t[a.index%t.length];if($(t[0])){var c=t,d=s._scopes.filter((function(e){return e!==c}));t=[];var u,h=(0,l.default)(c);try{for(h.s();!(u=h.n()).done;){var g=Zt(d,s,e,u.value);t.push(Yt(g,a,r&&r[e],o))}}catch(p){h.e(p)}finally{h.f()}}return t}(t,o,e,r.isIndexable));Wt(t,o)&&(o=Yt(o,s,a&&a[t],r));return o}(e,t,n)}))},getOwnPropertyDescriptor:function(t,n){return t._descriptors.allKeys?Reflect.has(e,n)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,n)},getPrototypeOf:function(){return Reflect.getPrototypeOf(e)},has:function(t,n){return Reflect.has(e,n)},ownKeys:function(){return Reflect.ownKeys(e)},set:function(t,n,i){return e[n]=i,delete t[n],!0}})}function Vt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{scriptable:!0,indexable:!0},n=e._scriptable,i=void 0===n?t.scriptable:n,s=e._indexable,a=void 0===s?t.indexable:s,r=e._allKeys;return{allKeys:void 0===r?t.allKeys:r,scriptable:i,indexable:a,isScriptable:fe(i)?i:function(){return i},isIndexable:fe(a)?a:function(){return a}}}var Gt=function(e,t){return e?e+ge(t):t},Wt=function(e,t){return $(t)&&"adapters"!==e&&(null===Object.getPrototypeOf(t)||t.constructor===Object)};function Qt(e,t,n){if(Object.prototype.hasOwnProperty.call(e,t)||"constructor"===t)return e[t];var i=n();return e[t]=i,i}function Kt(e,t,n){return fe(e)?e(t,n):e}var $t=function(e,t){return!0===e?t:"string"===typeof e?he(t,e):void 0};function Xt(e,t,n,i,s){var a,r=(0,l.default)(t);try{for(r.s();!(a=r.n()).done;){var o=a.value,c=$t(n,o);if(c){e.add(c);var d=Kt(c._fallback,n,s);if("undefined"!==typeof d&&d!==n&&d!==i)return d}else if(!1===c&&"undefined"!==typeof i&&n!==i)return null}}catch(u){r.e(u)}finally{r.f()}return!1}function Zt(e,t,n,i){var s=t._rootScopes,a=Kt(t._fallback,n,i),r=[].concat((0,d.default)(e),(0,d.default)(s)),o=new Set;o.add(i);var l=Jt(o,r,n,a||n,i);return null!==l&&(("undefined"===typeof a||a===n||null!==(l=Jt(o,r,a,l,i)))&&qt(Array.from(o),[""],s,a,(function(){return function(e,t,n){var i=e._getTarget();t in i||(i[t]={});var s=i[t];if(K(s)&&$(n))return n;return s||{}}(t,n,i)})))}function Jt(e,t,n,i,s){for(;n;)n=Xt(e,t,n,i,s);return n}function en(e,t){var n,i=(0,l.default)(t);try{for(i.s();!(n=i.n()).done;){var s=n.value;if(s){var a=s[e];if("undefined"!==typeof a)return a}}}catch(r){i.e(r)}finally{i.f()}}function tn(e){var t=e._keys;return t||(t=e._keys=function(e){var t,n=new Set,i=(0,l.default)(e);try{for(i.s();!(t=i.n()).done;){var s,a=t.value,r=(0,l.default)(Object.keys(a).filter((function(e){return!e.startsWith("_")})));try{for(r.s();!(s=r.n()).done;){var o=s.value;n.add(o)}}catch(c){r.e(c)}finally{r.f()}}}catch(c){i.e(c)}finally{i.f()}return Array.from(n)}(e._scopes)),t}function nn(e,t,n,i){var s,a,r,o,l=e.iScale,c=this._parsing.key,d=void 0===c?"r":c,u=new Array(i);for(s=0,a=i;s<a;++s)o=t[r=s+n],u[s]={r:l.parse(he(o,d),r)};return u}var sn=Number.EPSILON||1e-14,an=function(e,t){return t<e.length&&!e[t].skip&&e[t]},rn=function(e){return"x"===e?"y":"x"};function on(e,t,n,i){var s=e.skip?t:e,a=t,r=n.skip?t:n,o=Te(a,s),l=Te(r,a),c=o/(o+l),d=l/(o+l),u=i*(c=isNaN(c)?0:c),h=i*(d=isNaN(d)?0:d);return{previous:{x:a.x-u*(r.x-s.x),y:a.y-u*(r.y-s.y)},next:{x:a.x+h*(r.x-s.x),y:a.y+h*(r.y-s.y)}}}function ln(e){var t,n,i,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"x",a=rn(s),r=e.length,o=Array(r).fill(0),l=Array(r),c=an(e,0);for(t=0;t<r;++t)if(n=i,i=c,c=an(e,t+1),i){if(c){var d=c[s]-i[s];o[t]=0!==d?(c[a]-i[a])/d:0}l[t]=n?c?De(o[t-1])!==De(o[t])?0:(o[t-1]+o[t])/2:o[t-1]:o[t]}!function(e,t,n){for(var i,s,a,r,o,l=e.length,c=an(e,0),d=0;d<l-1;++d)o=c,c=an(e,d+1),o&&c&&(_e(t[d],0,sn)?n[d]=n[d+1]=0:(i=n[d]/t[d],s=n[d+1]/t[d],(r=Math.pow(i,2)+Math.pow(s,2))<=9||(a=3/Math.sqrt(r),n[d]=i*a*t[d],n[d+1]=s*a*t[d])))}(e,o,l),function(e,t){for(var n,i,s,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"x",r=rn(a),o=e.length,l=an(e,0),c=0;c<o;++c)if(i=s,s=l,l=an(e,c+1),s){var d=s[a],u=s[r];i&&(n=(d-i[a])/3,s["cp1".concat(a)]=d-n,s["cp1".concat(r)]=u-n*t[c]),l&&(n=(l[a]-d)/3,s["cp2".concat(a)]=d+n,s["cp2".concat(r)]=u+n*t[c])}}(e,l,s)}function cn(e,t,n){return Math.max(Math.min(e,n),t)}function dn(e,t,n,i,s){var a,r,o,l;if(t.spanGaps&&(e=e.filter((function(e){return!e.skip}))),"monotone"===t.cubicInterpolationMode)ln(e,s);else{var c=i?e[e.length-1]:e[0];for(a=0,r=e.length;a<r;++a)l=on(c,o=e[a],e[Math.min(a+1,r-(i?0:1))%r],t.tension),o.cp1x=l.previous.x,o.cp1y=l.previous.y,o.cp2x=l.next.x,o.cp2y=l.next.y,c=o}t.capBezierPoints&&function(e,t){var n,i,s,a,r,o=St(e[0],t);for(n=0,i=e.length;n<i;++n)r=a,a=o,o=n<i-1&&St(e[n+1],t),a&&(s=e[n],r&&(s.cp1x=cn(s.cp1x,t.left,t.right),s.cp1y=cn(s.cp1y,t.top,t.bottom)),o&&(s.cp2x=cn(s.cp2x,t.left,t.right),s.cp2y=cn(s.cp2y,t.top,t.bottom)))}(e,n)}function un(){return"undefined"!==typeof window&&"undefined"!==typeof document}function hn(e){var t=e.parentNode;return t&&"[object ShadowRoot]"===t.toString()&&(t=t.host),t}function gn(e,t,n){var i;return"string"===typeof e?(i=parseInt(e,10),-1!==e.indexOf("%")&&(i=i/100*t.parentNode[n])):i=e,i}var pn=function(e){return e.ownerDocument.defaultView.getComputedStyle(e,null)};var fn=["top","right","bottom","left"];function mn(e,t,n){var i={};n=n?"-"+n:"";for(var s=0;s<4;s++){var a=fn[s];i[a]=parseFloat(e[t+"-"+a+n])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}function vn(e,t){if("native"in e)return e;var n=t.canvas,i=t.currentDevicePixelRatio,s=pn(n),a="border-box"===s.boxSizing,r=mn(s,"padding"),o=mn(s,"border","width"),l=function(e,t){var n,i,s=e.touches,a=s&&s.length?s[0]:e,r=a.offsetX,o=a.offsetY,l=!1;if(function(e,t,n){return(e>0||t>0)&&(!n||!n.shadowRoot)}(r,o,e.target))n=r,i=o;else{var c=t.getBoundingClientRect();n=a.clientX-c.left,i=a.clientY-c.top,l=!0}return{x:n,y:i,box:l}}(e,n),c=l.x,d=l.y,u=l.box,h=r.left+(u&&o.left),g=r.top+(u&&o.top),p=t.width,f=t.height;return a&&(p-=r.width+o.width,f-=r.height+o.height),{x:Math.round((c-h)/p*n.width/i),y:Math.round((d-g)/f*n.height/i)}}var xn=function(e){return Math.round(10*e)/10};function An(e,t,n,i){var s=pn(e),a=mn(s,"margin"),r=gn(s.maxWidth,e,"clientWidth")||ye,o=gn(s.maxHeight,e,"clientHeight")||ye,l=function(e,t,n){var i,s;if(void 0===t||void 0===n){var a=e&&hn(e);if(a){var r=a.getBoundingClientRect(),o=pn(a),l=mn(o,"border","width"),c=mn(o,"padding");t=r.width-c.width-l.width,n=r.height-c.height-l.height,i=gn(o.maxWidth,a,"clientWidth"),s=gn(o.maxHeight,a,"clientHeight")}else t=e.clientWidth,n=e.clientHeight}return{width:t,height:n,maxWidth:i||ye,maxHeight:s||ye}}(e,t,n),c=l.width,d=l.height;if("content-box"===s.boxSizing){var u=mn(s,"border","width"),h=mn(s,"padding");c-=h.width+u.width,d-=h.height+u.height}return c=Math.max(0,c-a.width),d=Math.max(0,i?c/i:d-a.height),c=xn(Math.min(c,r,l.maxWidth)),d=xn(Math.min(d,o,l.maxHeight)),c&&!d&&(d=xn(c/2)),(void 0!==t||void 0!==n)&&i&&l.height&&d>l.height&&(d=l.height,c=xn(Math.floor(d*i))),{width:c,height:d}}function yn(e,t,n){var i=t||1,s=Math.floor(e.height*i),a=Math.floor(e.width*i);e.height=Math.floor(e.height),e.width=Math.floor(e.width);var r=e.canvas;return r.style&&(n||!r.style.height&&!r.style.width)&&(r.style.height="".concat(e.height,"px"),r.style.width="".concat(e.width,"px")),(e.currentDevicePixelRatio!==i||r.height!==s||r.width!==a)&&(e.currentDevicePixelRatio=i,r.height=s,r.width=a,e.ctx.setTransform(i,0,0,i,0,0),!0)}var Pn=function(){var e=!1;try{var t={get passive(){return e=!0,!1}};un()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch(n){}return e}();function bn(e,t){var n=function(e,t){return pn(e).getPropertyValue(t)}(e,t),i=n&&n.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function jn(e,t,n,i){return{x:e.x+n*(t.x-e.x),y:e.y+n*(t.y-e.y)}}function Sn(e,t,n,i){return{x:e.x+n*(t.x-e.x),y:"middle"===i?n<.5?e.y:t.y:"after"===i?n<1?e.y:t.y:n>0?t.y:e.y}}function kn(e,t,n,i){var s={x:e.cp2x,y:e.cp2y},a={x:t.cp1x,y:t.cp1y},r=jn(e,s,n),o=jn(s,a,n),l=jn(a,t,n),c=jn(r,o,n),d=jn(o,l,n);return jn(c,d,n)}function Dn(e,t,n){return e?function(e,t){return{x:function(n){return e+e+t-n},setWidth:function(e){t=e},textAlign:function(e){return"center"===e?e:"right"===e?"left":"right"},xPlus:function(e,t){return e-t},leftForLtr:function(e,t){return e-t}}}(t,n):{x:function(e){return e},setWidth:function(e){},textAlign:function(e){return e},xPlus:function(e,t){return e+t},leftForLtr:function(e,t){return e}}}function _n(e,t){var n,i;"ltr"!==t&&"rtl"!==t||(i=[(n=e.canvas.style).getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",t,"important"),e.prevTextDirection=i)}function wn(e,t){void 0!==t&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function In(e){return"angle"===e?{between:Fe,compare:Re,normalize:Ue}:{between:ze,compare:function(e,t){return e-t},normalize:function(e){return e}}}function Nn(e){var t=e.start,n=e.end,i=e.count;return{start:t%i,end:n%i,loop:e.loop&&(n-t+1)%i===0,style:e.style}}function Mn(e,t,n){if(!n)return[e];for(var i,s,a,r=n.property,o=n.start,l=n.end,c=t.length,d=In(r),u=d.compare,h=d.between,g=d.normalize,p=function(e,t,n){var i,s,a=n.property,r=n.start,o=n.end,l=In(a),c=l.between,d=l.normalize,u=t.length,h=e.start,g=e.end,p=e.loop;if(p){for(h+=u,g+=u,i=0,s=u;i<s&&c(d(t[h%u][a]),r,o);++i)h--,g--;h%=u,g%=u}return g<h&&(g+=u),{start:h,end:g,loop:p,style:e.style}}(e,t,n),f=p.start,m=p.end,v=p.loop,x=p.style,A=[],y=!1,P=null,b=function(){return y||h(o,a,i)&&0!==u(o,a)},j=function(){return!y||0===u(l,i)||h(l,a,i)},S=f,k=f;S<=m;++S)(s=t[S%c]).skip||(i=g(s[r]))!==a&&(y=h(i,o,l),null===P&&b()&&(P=0===u(i,o)?S:k),null!==P&&j()&&(A.push(Nn({start:P,end:S,loop:v,count:c,style:x})),P=null),k=S,a=i);return null!==P&&A.push(Nn({start:P,end:m,loop:v,count:c,style:x})),A}function Cn(e,t){for(var n=[],i=e.segments,s=0;s<i.length;s++){var a=Mn(i[s],e.points,t);a.length&&n.push.apply(n,(0,d.default)(a))}return n}function Ln(e,t,n,i){return i&&i.setContext&&n?function(e,t,n,i){var s=e._chart.getContext(),a=On(e.options),r=e._datasetIndex,o=e.options.spanGaps,c=n.length,d=[],u=a,h=t[0].start,g=h;function p(e,t,i,s){var a=o?-1:1;if(e!==t){for(e+=c;n[e%c].skip;)e-=a;for(;n[t%c].skip;)t+=a;e%c!==t%c&&(d.push({start:e%c,end:t%c,loop:i,style:s}),u=s,h=t%c)}}var f,m=(0,l.default)(t);try{for(m.s();!(f=m.n()).done;){var v=f.value;h=o?h:v.start;var x=n[h%c],A=void 0;for(g=h+1;g<=v.end;g++){var y=n[g%c];Tn(A=On(i.setContext(Ht(s,{type:"segment",p0:x,p1:y,p0DataIndex:(g-1)%c,p1DataIndex:g%c,datasetIndex:r}))),u)&&p(h,g-1,v.loop,u),x=y,u=A}h<g-1&&p(h,g-1,v.loop,u)}}catch(P){m.e(P)}finally{m.f()}return d}(e,t,n,i):t}function On(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function Tn(e,t){if(!t)return!1;var n=[],i=function(e,t){return it(t)?(n.includes(t)||n.push(t),n.indexOf(t)):t};return JSON.stringify(e,i)!==JSON.stringify(t,i)}var Rn=function(){return(0,h.default)((function e(){(0,u.default)(this,e),this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}),[{key:"_notify",value:function(e,t,n,i){var s=t.listeners[i],a=t.duration;s.forEach((function(i){return i({chart:e,initial:t.initial,numSteps:a,currentStep:Math.min(n-t.start,a)})}))}},{key:"_refresh",value:function(){var e=this;this._request||(this._running=!0,this._request=We.call(window,(function(){e._update(),e._request=null,e._running&&e._refresh()})))}},{key:"_update",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),n=0;this._charts.forEach((function(i,s){if(i.running&&i.items.length){for(var a,r=i.items,o=r.length-1,l=!1;o>=0;--o)(a=r[o])._active?(a._total>i.duration&&(i.duration=a._total),a.tick(t),l=!0):(r[o]=r[r.length-1],r.pop());l&&(s.draw(),e._notify(s,i,t,"progress")),r.length||(i.running=!1,e._notify(s,i,t,"complete"),i.initial=!1),n+=r.length}})),this._lastDate=t,0===n&&(this._running=!1)}},{key:"_getAnims",value:function(e){var t=this._charts,n=t.get(e);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,n)),n}},{key:"listen",value:function(e,t,n){this._getAnims(e).listeners[t].push(n)}},{key:"add",value:function(e,t){var n;t&&t.length&&(n=this._getAnims(e).items).push.apply(n,(0,d.default)(t))}},{key:"has",value:function(e){return this._getAnims(e).items.length>0}},{key:"start",value:function(e){var t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((function(e,t){return Math.max(e,t._duration)}),0),this._refresh())}},{key:"running",value:function(e){if(!this._running)return!1;var t=this._charts.get(e);return!!(t&&t.running&&t.items.length)}},{key:"stop",value:function(e){var t=this._charts.get(e);if(t&&t.items.length){for(var n=t.items,i=n.length-1;i>=0;--i)n[i].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}}},{key:"remove",value:function(e){return this._charts.delete(e)}}])}(),Un=new Rn,Fn="transparent",En={boolean:function(e,t,n){return n>.5?t:e},color:function(e,t,n){var i=st(e||Fn),s=i.valid&&st(t||Fn);return s&&s.valid?s.mix(i,n).hexString():t},number:function(e,t,n){return e+(t-e)*n}},zn=function(){return(0,h.default)((function e(t,n,i,s){(0,u.default)(this,e);var a=n[i];s=Bt([t.to,s,a,t.from]);var r=Bt([t.from,a,s]);this._active=!0,this._fn=t.fn||En[t.type||typeof r],this._easing=nt[t.easing]||nt.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=n,this._prop=i,this._from=r,this._to=s,this._promises=void 0}),[{key:"active",value:function(){return this._active}},{key:"update",value:function(e,t,n){if(this._active){this._notify(!1);var i=this._target[this._prop],s=n-this._start,a=this._duration-s;this._start=n,this._duration=Math.floor(Math.max(a,e.duration)),this._total+=s,this._loop=!!e.loop,this._to=Bt([e.to,t,i,e.from]),this._from=Bt([e.from,i,t])}}},{key:"cancel",value:function(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}},{key:"tick",value:function(e){var t,n=e-this._start,i=this._duration,s=this._prop,a=this._from,r=this._loop,o=this._to;if(this._active=a!==o&&(r||n<i),!this._active)return this._target[s]=o,void this._notify(!0);n<0?this._target[s]=a:(t=n/i%2,t=r&&t>1?2-t:t,t=this._easing(Math.min(1,Math.max(0,t))),this._target[s]=this._fn(a,o,t))}},{key:"wait",value:function(){var e=this._promises||(this._promises=[]);return new Promise((function(t,n){e.push({res:t,rej:n})}))}},{key:"_notify",value:function(e){for(var t=e?"res":"rej",n=this._promises||[],i=0;i<n.length;i++)n[i][t]()}}])}(),Bn=function(){return(0,h.default)((function e(t,n){(0,u.default)(this,e),this._chart=t,this._properties=new Map,this.configure(n)}),[{key:"configure",value:function(e){if($(e)){var t=Object.keys(vt.animation),n=this._properties;Object.getOwnPropertyNames(e).forEach((function(i){var s=e[i];if($(s)){for(var a={},r=0,o=t;r<o.length;r++){var l=o[r];a[l]=s[l]}(K(s.properties)&&s.properties||[i]).forEach((function(e){e!==i&&n.has(e)||n.set(e,a)}))}}))}}},{key:"_animateOptions",value:function(e,t){var n=t.options,i=function(e,t){if(!t)return;var n=e.options;if(!n)return void(e.options=t);n.$shared&&(e.options=n=Object.assign({},n,{$shared:!1,$animations:{}}));return n}(e,n);if(!i)return[];var s=this._createAnimations(i,n);return n.$shared&&function(e,t){for(var n=[],i=Object.keys(t),s=0;s<i.length;s++){var a=e[i[s]];a&&a.active()&&n.push(a.wait())}return Promise.all(n)}(e.options.$animations,n).then((function(){e.options=n}),(function(){})),s}},{key:"_createAnimations",value:function(e,t){var n,i=this._properties,s=[],a=e.$animations||(e.$animations={}),r=Object.keys(t),o=Date.now();for(n=r.length-1;n>=0;--n){var l=r[n];if("$"!==l.charAt(0))if("options"!==l){var c=t[l],u=a[l],h=i.get(l);if(u){if(h&&u.active()){u.update(h,c,o);continue}u.cancel()}h&&h.duration?(a[l]=u=new zn(h,e,l,c),s.push(u)):e[l]=c}else s.push.apply(s,(0,d.default)(this._animateOptions(e,t)))}return s}},{key:"update",value:function(e,t){if(0!==this._properties.size){var n=this._createAnimations(e,t);return n.length?(Un.add(this._chart,n),!0):void 0}Object.assign(e,t)}}])}();function Hn(e,t){var n=e&&e.options||{},i=n.reverse,s=void 0===n.min?t:0,a=void 0===n.max?t:0;return{start:i?a:s,end:i?s:a}}function qn(e,t){var n,i,s=[],a=e._getSortedDatasetMetas(t);for(n=0,i=a.length;n<i;++n)s.push(a[n].index);return s}function Yn(e,t,n){var i,s,a,r,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=e.keys,c="single"===o.mode;if(null!==t){var d=!1;for(i=0,s=l.length;i<s;++i){if((a=+l[i])===n){if(d=!0,o.all)continue;break}X(r=e.values[a])&&(c||0===t||De(t)===De(r))&&(t+=r)}return d||o.all?t:0}}function Vn(e,t){var n=e&&e.options.stacked;return n||void 0===n&&void 0!==t.stack}function Gn(e,t,n){var i=e[t]||(e[t]={});return i[n]||(i[n]={})}function Wn(e,t,n,i){var s,a=(0,l.default)(t.getMatchingVisibleMetas(i).reverse());try{for(a.s();!(s=a.n()).done;){var r=s.value,o=e[r.index];if(n&&o>0||!n&&o<0)return r.index}}catch(c){a.e(c)}finally{a.f()}return null}function Qn(e,t){for(var n,i=e.chart,s=e._cachedMeta,a=i._stacks||(i._stacks={}),r=s.iScale,o=s.vScale,l=s.index,c=r.axis,d=o.axis,u=function(e,t,n){return"".concat(e.id,".").concat(t.id,".").concat(n.stack||n.type)}(r,o,s),h=t.length,g=0;g<h;++g){var p=t[g],f=p[c],m=p[d];(n=(p._stacks||(p._stacks={}))[d]=Gn(a,u,f))[l]=m,n._top=Wn(n,o,!0,s.type),n._bottom=Wn(n,o,!1,s.type),(n._visualValues||(n._visualValues={}))[l]=m}}function Kn(e,t){var n=e.scales;return Object.keys(n).filter((function(e){return n[e].axis===t})).shift()}function $n(e,t){var n=e.controller.index,i=e.vScale&&e.vScale.axis;if(i){t=t||e._parsed;var s,a=(0,l.default)(t);try{for(a.s();!(s=a.n()).done;){var r=s.value._stacks;if(!r||void 0===r[i]||void 0===r[i][n])return;delete r[i][n],void 0!==r[i]._visualValues&&void 0!==r[i]._visualValues[n]&&delete r[i]._visualValues[n]}}catch(o){a.e(o)}finally{a.f()}}}var Xn=function(e){return"reset"===e||"none"===e},Zn=function(e,t){return t?e:Object.assign({},e)},Jn=function(){return(0,h.default)((function e(t,n){(0,u.default)(this,e),this.chart=t,this._ctx=t.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=(this instanceof e?this.constructor:void 0).datasetElementType,this.dataElementType=(this instanceof e?this.constructor:void 0).dataElementType,this.initialize()}),[{key:"initialize",value:function(){var e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=Vn(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}},{key:"updateIndex",value:function(e){this.index!==e&&$n(this._cachedMeta),this.index=e}},{key:"linkScales",value:function(){var e=this.chart,t=this._cachedMeta,n=this.getDataset(),i=function(e,t,n,i){return"x"===e?t:"r"===e?i:n},s=t.xAxisID=J(n.xAxisID,Kn(e,"x")),a=t.yAxisID=J(n.yAxisID,Kn(e,"y")),r=t.rAxisID=J(n.rAxisID,Kn(e,"r")),o=t.indexAxis,l=t.iAxisID=i(o,s,a,r),c=t.vAxisID=i(o,a,s,r);t.xScale=this.getScaleForId(s),t.yScale=this.getScaleForId(a),t.rScale=this.getScaleForId(r),t.iScale=this.getScaleForId(l),t.vScale=this.getScaleForId(c)}},{key:"getDataset",value:function(){return this.chart.data.datasets[this.index]}},{key:"getMeta",value:function(){return this.chart.getDatasetMeta(this.index)}},{key:"getScaleForId",value:function(e){return this.chart.scales[e]}},{key:"_getOtherScale",value:function(e){var t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}},{key:"reset",value:function(){this._update("reset")}},{key:"_destroy",value:function(){var e=this._cachedMeta;this._data&&Ve(this._data,this),e._stacked&&$n(e)}},{key:"_dataCheck",value:function(){var e,t,n=this.getDataset(),i=n.data||(n.data=[]),s=this._data;if($(i)){var a=this._cachedMeta;this._data=function(e,t){var n,i,s,a=t.iScale,r=t.vScale,o="x"===a.axis?"x":"y",l="x"===r.axis?"x":"y",d=Object.keys(e),u=new Array(d.length);for(n=0,i=d.length;n<i;++n)s=d[n],u[n]=(0,c.default)((0,c.default)({},o,s),l,e[s]);return u}(i,a)}else if(s!==i){if(s){Ve(s,this);var r=this._cachedMeta;$n(r),r._parsed=[]}i&&Object.isExtensible(i)&&(t=this,(e=i)._chartjs?e._chartjs.listeners.push(t):(Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),Ye.forEach((function(t){var n="_onData"+ge(t),i=e[t];Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:function(){for(var t=arguments.length,s=new Array(t),a=0;a<t;a++)s[a]=arguments[a];var r=i.apply(this,s);return e._chartjs.listeners.forEach((function(e){"function"===typeof e[n]&&e[n].apply(e,s)})),r}})})))),this._syncList=[],this._data=i}}},{key:"addElements",value:function(){var e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}},{key:"buildOrUpdateElements",value:function(e){var t=this._cachedMeta,n=this.getDataset(),i=!1;this._dataCheck();var s=t._stacked;t._stacked=Vn(t.vScale,t),t.stack!==n.stack&&(i=!0,$n(t),t.stack=n.stack),this._resyncElements(e),(i||s!==t._stacked)&&(Qn(this,t._parsed),t._stacked=Vn(t.vScale,t))}},{key:"configure",value:function(){var e=this.chart.config,t=e.datasetScopeKeys(this._type),n=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}},{key:"parse",value:function(e,t){var n,i,s,a=this._cachedMeta,r=this._data,o=a.iScale,l=a._stacked,c=o.axis,d=0===e&&t===r.length||a._sorted,u=e>0&&a._parsed[e-1];if(!1===this._parsing)a._parsed=r,a._sorted=!0,s=r;else{s=K(r[e])?this.parseArrayData(a,r,e,t):$(r[e])?this.parseObjectData(a,r,e,t):this.parsePrimitiveData(a,r,e,t);for(n=0;n<t;++n)a._parsed[n+e]=i=s[n],d&&((null===i[c]||u&&i[c]<u[c])&&(d=!1),u=i);a._sorted=d}l&&Qn(this,s)}},{key:"parsePrimitiveData",value:function(e,t,n,i){var s,a,r,o=e.iScale,l=e.vScale,d=o.axis,u=l.axis,h=o.getLabels(),g=o===l,p=new Array(i);for(s=0,a=i;s<a;++s)r=s+n,p[s]=(0,c.default)((0,c.default)({},d,g||o.parse(h[r],r)),u,l.parse(t[r],r));return p}},{key:"parseArrayData",value:function(e,t,n,i){var s,a,r,o,l=e.xScale,c=e.yScale,d=new Array(i);for(s=0,a=i;s<a;++s)o=t[r=s+n],d[s]={x:l.parse(o[0],r),y:c.parse(o[1],r)};return d}},{key:"parseObjectData",value:function(e,t,n,i){var s,a,r,o,l=e.xScale,c=e.yScale,d=this._parsing,u=d.xAxisKey,h=void 0===u?"x":u,g=d.yAxisKey,p=void 0===g?"y":g,f=new Array(i);for(s=0,a=i;s<a;++s)o=t[r=s+n],f[s]={x:l.parse(he(o,h),r),y:c.parse(he(o,p),r)};return f}},{key:"getParsed",value:function(e){return this._cachedMeta._parsed[e]}},{key:"getDataElement",value:function(e){return this._cachedMeta.data[e]}},{key:"applyStack",value:function(e,t,n){var i=this.chart,s=this._cachedMeta,a=t[e.axis];return Yn({keys:qn(i,!0),values:t._stacks[e.axis]._visualValues},a,s.index,{mode:n})}},{key:"updateRangeFromParsed",value:function(e,t,n,i){var s=n[t.axis],a=null===s?NaN:s,r=i&&n._stacks[t.axis];i&&r&&(i.values=r,a=Yn(i,s,this._cachedMeta.index)),e.min=Math.min(e.min,a),e.max=Math.max(e.max,a)}},{key:"getMinMax",value:function(e,t){var n,i,s=this._cachedMeta,a=s._parsed,r=s._sorted&&e===s.iScale,o=a.length,l=this._getOtherScale(e),c=function(e,t,n){return e&&!t.hidden&&t._stacked&&{keys:qn(n,!0),values:null}}(t,s,this.chart),d={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},u=function(e){var t=e.getUserBounds(),n=t.min,i=t.max,s=t.minDefined,a=t.maxDefined;return{min:s?n:Number.NEGATIVE_INFINITY,max:a?i:Number.POSITIVE_INFINITY}}(l),h=u.min,g=u.max;function p(){var t=(i=a[n])[l.axis];return!X(i[e.axis])||h>t||g<t}for(n=0;n<o&&(p()||(this.updateRangeFromParsed(d,e,i,c),!r));++n);if(r)for(n=o-1;n>=0;--n)if(!p()){this.updateRangeFromParsed(d,e,i,c);break}return d}},{key:"getAllParsedValues",value:function(e){var t,n,i,s=this._cachedMeta._parsed,a=[];for(t=0,n=s.length;t<n;++t)X(i=s[t][e.axis])&&a.push(i);return a}},{key:"getMaxOverflow",value:function(){return!1}},{key:"getLabelAndValue",value:function(e){var t=this._cachedMeta,n=t.iScale,i=t.vScale,s=this.getParsed(e);return{label:n?""+n.getLabelForValue(s[n.axis]):"",value:i?""+i.getLabelForValue(s[i.axis]):""}}},{key:"_update",value:function(e){var t=this._cachedMeta;this.update(e||"default"),t._clip=function(e){var t,n,i,s;return $(e)?(t=e.top,n=e.right,i=e.bottom,s=e.left):t=n=i=s=e,{top:t,right:n,bottom:i,left:s,disabled:!1===e}}(J(this.options.clip,function(e,t,n){if(!1===n)return!1;var i=Hn(e,n),s=Hn(t,n);return{top:s.end,right:i.end,bottom:s.start,left:i.start}}(t.xScale,t.yScale,this.getMaxOverflow())))}},{key:"update",value:function(e){}},{key:"draw",value:function(){var e,t=this._ctx,n=this.chart,i=this._cachedMeta,s=i.data||[],a=n.chartArea,r=[],o=this._drawStart||0,l=this._drawCount||s.length-o,c=this.options.drawActiveElementsOnTop;for(i.dataset&&i.dataset.draw(t,a,o,l),e=o;e<o+l;++e){var d=s[e];d.hidden||(d.active&&c?r.push(d):d.draw(t,a))}for(e=0;e<r.length;++e)r[e].draw(t,a)}},{key:"getStyle",value:function(e,t){var n=t?"active":"default";return void 0===e&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(e||0,n)}},{key:"getContext",value:function(e,t,n){var i,s=this.getDataset();if(e>=0&&e<this._cachedMeta.data.length){var a=this._cachedMeta.data[e];i=a.$context||(a.$context=function(e,t,n){return Ht(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:n,index:t,mode:"default",type:"data"})}(this.getContext(),e,a)),i.parsed=this.getParsed(e),i.raw=s.data[e],i.index=i.dataIndex=e}else i=this.$context||(this.$context=function(e,t){return Ht(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}(this.chart.getContext(),this.index)),i.dataset=s,i.index=i.datasetIndex=this.index;return i.active=!!t,i.mode=n,i}},{key:"resolveDatasetElementOptions",value:function(e){return this._resolveElementOptions(this.datasetElementType.id,e)}},{key:"resolveDataElementOptions",value:function(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}},{key:"_resolveElementOptions",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",i=arguments.length>2?arguments[2]:void 0,s="active"===n,a=this._cachedDataOpts,r=e+"-"+n,o=a[r],l=this.enableOptionSharing&&pe(i);if(o)return Zn(o,l);var c=this.chart.config,d=c.datasetElementScopeKeys(this._type,e),u=s?["".concat(e,"Hover"),"hover",e,""]:[e,""],h=c.getOptionScopes(this.getDataset(),d),g=Object.keys(vt.elements[e]),p=c.resolveNamedOptions(h,g,(function(){return t.getContext(i,s,n)}),u);return p.$shared&&(p.$shared=l,a[r]=Object.freeze(Zn(p,l))),p}},{key:"_resolveAnimations",value:function(e,t,n){var i,s=this.chart,a=this._cachedDataOpts,r="animation-".concat(t),o=a[r];if(o)return o;if(!1!==s.options.animation){var l=this.chart.config,c=l.datasetAnimationScopeKeys(this._type,t),d=l.getOptionScopes(this.getDataset(),c);i=l.createResolver(d,this.getContext(e,n,t))}var u=new Bn(s,i&&i.animations);return i&&i._cacheable&&(a[r]=Object.freeze(u)),u}},{key:"getSharedOptions",value:function(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}},{key:"includeOptions",value:function(e,t){return!t||Xn(e)||this.chart._animationsDisabled}},{key:"_getSharedOptions",value:function(e,t){var n=this.resolveDataElementOptions(e,t),i=this._sharedOptions,s=this.getSharedOptions(n),a=this.includeOptions(t,s)||s!==i;return this.updateSharedOptions(s,t,n),{sharedOptions:s,includeOptions:a}}},{key:"updateElement",value:function(e,t,n,i){Xn(i)?Object.assign(e,n):this._resolveAnimations(t,i).update(e,n)}},{key:"updateSharedOptions",value:function(e,t,n){e&&!Xn(t)&&this._resolveAnimations(void 0,t).update(e,n)}},{key:"_setStyle",value:function(e,t,n,i){e.active=i;var s=this.getStyle(t,i);this._resolveAnimations(t,n,i).update(e,{options:!i&&this.getSharedOptions(s)||s})}},{key:"removeHoverStyle",value:function(e,t,n){this._setStyle(e,n,"active",!1)}},{key:"setHoverStyle",value:function(e,t,n){this._setStyle(e,n,"active",!0)}},{key:"_removeDatasetHoverStyle",value:function(){var e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}},{key:"_setDatasetHoverStyle",value:function(){var e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}},{key:"_resyncElements",value:function(e){var t,n=this._data,i=this._cachedMeta.data,s=(0,l.default)(this._syncList);try{for(s.s();!(t=s.n()).done;){var a=(0,o.default)(t.value,3),r=a[0],c=a[1],d=a[2];this[r](c,d)}}catch(p){s.e(p)}finally{s.f()}this._syncList=[];var u=i.length,h=n.length,g=Math.min(h,u);g&&this.parse(0,g),h>u?this._insertElements(u,h-u,e):h<u&&this._removeElements(h,u-h)}},{key:"_insertElements",value:function(e,t){var n,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=this._cachedMeta,a=s.data,r=e+t,o=function(e){for(e.length+=t,n=e.length-1;n>=r;n--)e[n]=e[n-t]};for(o(a),n=e;n<r;++n)a[n]=new this.dataElementType;this._parsing&&o(s._parsed),this.parse(e,t),i&&this.updateElements(a,e,t,"reset")}},{key:"updateElements",value:function(e,t,n,i){}},{key:"_removeElements",value:function(e,t){var n=this._cachedMeta;if(this._parsing){var i=n._parsed.splice(e,t);n._stacked&&$n(n,i)}n.data.splice(e,t)}},{key:"_sync",value:function(e){if(this._parsing)this._syncList.push(e);else{var t=(0,o.default)(e,3),n=t[0],i=t[1],s=t[2];this[n](i,s)}this.chart._dataChanges.push([this.index].concat((0,d.default)(e)))}},{key:"_onDataPush",value:function(){var e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}},{key:"_onDataPop",value:function(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}},{key:"_onDataShift",value:function(){this._sync(["_removeElements",0,1])}},{key:"_onDataSplice",value:function(e,t){t&&this._sync(["_removeElements",e,t]);var n=arguments.length-2;n&&this._sync(["_insertElements",e,n])}},{key:"_onDataUnshift",value:function(){this._sync(["_insertElements",0,arguments.length])}}])}();function ei(e){var t,n,i,s,a=e.iScale,r=function(e,t){if(!e._cache.$bar){for(var n=e.getMatchingVisibleMetas(t),i=[],s=0,a=n.length;s<a;s++)i=i.concat(n[s].controller.getAllParsedValues(e));e._cache.$bar=Ge(i.sort((function(e,t){return e-t})))}return e._cache.$bar}(a,e.type),o=a._length,l=function(){32767!==i&&-32768!==i&&(pe(s)&&(o=Math.min(o,Math.abs(i-s)||o)),s=i)};for(t=0,n=r.length;t<n;++t)i=a.getPixelForValue(r[t]),l();for(s=void 0,t=0,n=a.ticks.length;t<n;++t)i=a.getPixelForTick(t),l();return o}function ti(e,t,n,i){return K(e)?function(e,t,n,i){var s=n.parse(e[0],i),a=n.parse(e[1],i),r=Math.min(s,a),o=Math.max(s,a),l=r,c=o;Math.abs(r)>Math.abs(o)&&(l=o,c=r),t[n.axis]=c,t._custom={barStart:l,barEnd:c,start:s,end:a,min:r,max:o}}(e,t,n,i):t[n.axis]=n.parse(e,i),t}function ni(e,t,n,i){var s,a,r,o,l=e.iScale,c=e.vScale,d=l.getLabels(),u=l===c,h=[];for(s=n,a=n+i;s<a;++s)o=t[s],(r={})[l.axis]=u||l.parse(d[s],s),h.push(ti(o,r,c,s));return h}function ii(e){return e&&void 0!==e.barStart&&void 0!==e.barEnd}function si(e,t,n,i){var s=t.borderSkipped,a={};if(s)if(!0!==s){var r=function(e){var t,n,i,s,a;return e.horizontal?(t=e.base>e.x,n="left",i="right"):(t=e.base<e.y,n="bottom",i="top"),t?(s="end",a="start"):(s="start",a="end"),{start:n,end:i,reverse:t,top:s,bottom:a}}(e),o=r.start,l=r.end,c=r.reverse,d=r.top,u=r.bottom;"middle"===s&&n&&(e.enableBorderRadius=!0,(n._top||0)===i?s=d:(n._bottom||0)===i?s=u:(a[ai(u,o,l,c)]=!0,s=d)),a[ai(s,o,l,c)]=!0,e.borderSkipped=a}else e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};else e.borderSkipped=a}function ai(e,t,n,i){var s,a,r;return i?(r=n,e=ri(e=(s=e)===(a=t)?r:s===r?a:s,n,t)):e=ri(e,t,n),e}function ri(e,t,n){return"start"===e?t:"end"===e?n:e}function oi(e,t,n){var i=t.inflateAmount;e.inflateAmount="auto"===i?1===n?.33:0:i}(0,c.default)(Jn,"defaults",{}),(0,c.default)(Jn,"datasetElementType",null),(0,c.default)(Jn,"dataElementType",null);var li=function(e){function t(){return(0,u.default)(this,t),(0,s.default)(this,t,arguments)}return(0,r.default)(t,e),(0,h.default)(t,[{key:"parsePrimitiveData",value:function(e,t,n,i){return ni(e,t,n,i)}},{key:"parseArrayData",value:function(e,t,n,i){return ni(e,t,n,i)}},{key:"parseObjectData",value:function(e,t,n,i){var s,a,r,o,l=e.iScale,c=e.vScale,d=this._parsing,u=d.xAxisKey,h=void 0===u?"x":u,g=d.yAxisKey,p=void 0===g?"y":g,f="x"===l.axis?h:p,m="x"===c.axis?h:p,v=[];for(s=n,a=n+i;s<a;++s)o=t[s],(r={})[l.axis]=l.parse(he(o,f),s),v.push(ti(he(o,m),r,c,s));return v}},{key:"updateRangeFromParsed",value:function(e,n,i,s){(0,a.A)(t,"updateRangeFromParsed",this,3)([e,n,i,s]);var r=i._custom;r&&n===this._cachedMeta.vScale&&(e.min=Math.min(e.min,r.min),e.max=Math.max(e.max,r.max))}},{key:"getMaxOverflow",value:function(){return 0}},{key:"getLabelAndValue",value:function(e){var t=this._cachedMeta,n=t.iScale,i=t.vScale,s=this.getParsed(e),a=s._custom,r=ii(a)?"["+a.start+", "+a.end+"]":""+i.getLabelForValue(s[i.axis]);return{label:""+n.getLabelForValue(s[n.axis]),value:r}}},{key:"initialize",value:function(){this.enableOptionSharing=!0,(0,a.A)(t,"initialize",this,3)([]),this._cachedMeta.stack=this.getDataset().stack}},{key:"update",value:function(e){var t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}},{key:"updateElements",value:function(e,t,n,i){for(var s="reset"===i,a=this.index,r=this._cachedMeta.vScale,o=r.getBasePixel(),l=r.isHorizontal(),c=this._getRuler(),d=this._getSharedOptions(t,i),u=d.sharedOptions,h=d.includeOptions,g=t;g<t+n;g++){var p=this.getParsed(g),f=s||Q(p[r.axis])?{base:o,head:o}:this._calculateBarValuePixels(g),m=this._calculateBarIndexPixels(g,c),v=(p._stacks||{})[r.axis],x={horizontal:l,base:f.base,enableBorderRadius:!v||ii(p._custom)||a===v._top||a===v._bottom,x:l?f.head:m.center,y:l?m.center:f.head,height:l?m.size:Math.abs(f.size),width:l?Math.abs(f.size):m.size};h&&(x.options=u||this.resolveDataElementOptions(g,e[g].active?"active":i));var A=x.options||e[g].options;si(x,A,v,a),oi(x,A,c.ratio),this.updateElement(e[g],g,x,i)}}},{key:"_getStacks",value:function(e,t){var n,i=this._cachedMeta.iScale,s=i.getMatchingVisibleMetas(this._type).filter((function(e){return e.controller.options.grouped})),a=i.options.stacked,r=[],o=this._cachedMeta.controller.getParsed(t),c=o&&o[i.axis],d=function(e){var t=e._parsed.find((function(e){return e[i.axis]===c})),n=t&&t[e.vScale.axis];if(Q(n)||isNaN(n))return!0},u=(0,l.default)(s);try{for(u.s();!(n=u.n()).done;){var h=n.value;if((void 0===t||!d(h))&&((!1===a||-1===r.indexOf(h.stack)||void 0===a&&void 0===h.stack)&&r.push(h.stack),h.index===e))break}}catch(g){u.e(g)}finally{u.f()}return r.length||r.push(void 0),r}},{key:"_getStackCount",value:function(e){return this._getStacks(void 0,e).length}},{key:"_getStackIndex",value:function(e,t,n){var i=this._getStacks(e,n),s=void 0!==t?i.indexOf(t):-1;return-1===s?i.length-1:s}},{key:"_getRuler",value:function(){var e,t,n=this.options,i=this._cachedMeta,s=i.iScale,a=[];for(e=0,t=i.data.length;e<t;++e)a.push(s.getPixelForValue(this.getParsed(e)[s.axis],e));var r=n.barThickness;return{min:r||ei(i),pixels:a,start:s._startPixel,end:s._endPixel,stackCount:this._getStackCount(),scale:s,grouped:n.grouped,ratio:r?1:n.categoryPercentage*n.barPercentage}}},{key:"_calculateBarValuePixels",value:function(e){var t,n,i=this._cachedMeta,s=i.vScale,a=i._stacked,r=i.index,o=this.options,l=o.base,c=o.minBarLength,d=l||0,u=this.getParsed(e),h=u._custom,g=ii(h),p=u[s.axis],f=0,m=a?this.applyStack(s,u,a):p;m!==p&&(f=m-p,m=p),g&&(p=h.barStart,m=h.barEnd-h.barStart,0!==p&&De(p)!==De(h.barEnd)&&(f=0),f+=p);var v=Q(l)||g?f:l,x=s.getPixelForValue(v);if(n=(t=this.chart.getDataVisibility(e)?s.getPixelForValue(f+m):x)-x,Math.abs(n)<c){n=function(e,t,n){return 0!==e?De(e):(t.isHorizontal()?1:-1)*(t.min>=n?1:-1)}(n,s,d)*c,p===d&&(x-=n/2);var A=s.getPixelForDecimal(0),y=s.getPixelForDecimal(1),P=Math.min(A,y),b=Math.max(A,y);t=(x=Math.max(Math.min(x,b),P))+n,a&&!g&&(u._stacks[s.axis]._visualValues[r]=s.getValueForPixel(t)-s.getValueForPixel(x))}if(x===s.getPixelForValue(d)){var j=De(n)*s.getLineWidthForValue(d)/2;x+=j,n-=j}return{size:n,base:x,head:t,center:t+n/2}}},{key:"_calculateBarIndexPixels",value:function(e,t){var n,i,s=t.scale,a=this.options,r=a.skipNull,o=J(a.maxBarThickness,1/0);if(t.grouped){var l=r?this._getStackCount(e):t.stackCount,c="flex"===a.barThickness?function(e,t,n,i){var s=t.pixels,a=s[e],r=e>0?s[e-1]:null,o=e<s.length-1?s[e+1]:null,l=n.categoryPercentage;null===r&&(r=a-(null===o?t.end-t.start:o-a)),null===o&&(o=a+a-r);var c=a-(a-Math.min(r,o))/2*l;return{chunk:Math.abs(o-r)/2*l/i,ratio:n.barPercentage,start:c}}(e,t,a,l):function(e,t,n,i){var s,a,r=n.barThickness;return Q(r)?(s=t.min*n.categoryPercentage,a=n.barPercentage):(s=r*i,a=1),{chunk:s/i,ratio:a,start:t.pixels[e]-s/2}}(e,t,a,l),d=this._getStackIndex(this.index,this._cachedMeta.stack,r?e:void 0);n=c.start+c.chunk*d+c.chunk/2,i=Math.min(o,c.chunk*c.ratio)}else n=s.getPixelForValue(this.getParsed(e)[s.axis],e),i=Math.min(o,t.min*t.ratio);return{base:n-i/2,head:n+i/2,center:n,size:i}}},{key:"draw",value:function(){for(var e=this._cachedMeta,t=e.vScale,n=e.data,i=n.length,s=0;s<i;++s)null===this.getParsed(s)[t.axis]||n[s].hidden||n[s].draw(this._ctx)}}])}(Jn);(0,c.default)(li,"id","bar"),(0,c.default)(li,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),(0,c.default)(li,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});var ci=function(e){function t(){return(0,u.default)(this,t),(0,s.default)(this,t,arguments)}return(0,r.default)(t,e),(0,h.default)(t,[{key:"initialize",value:function(){this.enableOptionSharing=!0,(0,a.A)(t,"initialize",this,3)([])}},{key:"parsePrimitiveData",value:function(e,n,i,s){for(var r=(0,a.A)(t,"parsePrimitiveData",this,3)([e,n,i,s]),o=0;o<r.length;o++)r[o]._custom=this.resolveDataElementOptions(o+i).radius;return r}},{key:"parseArrayData",value:function(e,n,i,s){for(var r=(0,a.A)(t,"parseArrayData",this,3)([e,n,i,s]),o=0;o<r.length;o++){var l=n[i+o];r[o]._custom=J(l[2],this.resolveDataElementOptions(o+i).radius)}return r}},{key:"parseObjectData",value:function(e,n,i,s){for(var r=(0,a.A)(t,"parseObjectData",this,3)([e,n,i,s]),o=0;o<r.length;o++){var l=n[i+o];r[o]._custom=J(l&&l.r&&+l.r,this.resolveDataElementOptions(o+i).radius)}return r}},{key:"getMaxOverflow",value:function(){for(var e=this._cachedMeta.data,t=0,n=e.length-1;n>=0;--n)t=Math.max(t,e[n].size(this.resolveDataElementOptions(n))/2);return t>0&&t}},{key:"getLabelAndValue",value:function(e){var t=this._cachedMeta,n=this.chart.data.labels||[],i=t.xScale,s=t.yScale,a=this.getParsed(e),r=i.getLabelForValue(a.x),o=s.getLabelForValue(a.y),l=a._custom;return{label:n[e]||"",value:"("+r+", "+o+(l?", "+l:"")+")"}}},{key:"update",value:function(e){var t=this._cachedMeta.data;this.updateElements(t,0,t.length,e)}},{key:"updateElements",value:function(e,t,n,i){for(var s="reset"===i,a=this._cachedMeta,r=a.iScale,o=a.vScale,l=this._getSharedOptions(t,i),c=l.sharedOptions,d=l.includeOptions,u=r.axis,h=o.axis,g=t;g<t+n;g++){var p=e[g],f=!s&&this.getParsed(g),m={},v=m[u]=s?r.getPixelForDecimal(.5):r.getPixelForValue(f[u]),x=m[h]=s?o.getBasePixel():o.getPixelForValue(f[h]);m.skip=isNaN(v)||isNaN(x),d&&(m.options=c||this.resolveDataElementOptions(g,p.active?"active":i),s&&(m.options.radius=0)),this.updateElement(p,g,m,i)}}},{key:"resolveDataElementOptions",value:function(e,n){var i=this.getParsed(e),s=(0,a.A)(t,"resolveDataElementOptions",this,3)([e,n]);s.$shared&&(s=Object.assign({},s,{$shared:!1}));var r=s.radius;return"active"!==n&&(s.radius=0),s.radius+=J(i&&i._custom,r),s}}])}(Jn);(0,c.default)(ci,"id","bubble"),(0,c.default)(ci,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),(0,c.default)(ci,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});var di=function(e){function t(e,n){var i;return(0,u.default)(this,t),(i=(0,s.default)(this,t,[e,n])).enableOptionSharing=!0,i.innerRadius=void 0,i.outerRadius=void 0,i.offsetX=void 0,i.offsetY=void 0,i}return(0,r.default)(t,e),(0,h.default)(t,[{key:"linkScales",value:function(){}},{key:"parse",value:function(e,t){var n=this.getDataset().data,i=this._cachedMeta;if(!1===this._parsing)i._parsed=n;else{var s,a,r=function(e){return+n[e]};if($(n[e])){var o=this._parsing.key,l=void 0===o?"value":o;r=function(e){return+he(n[e],l)}}for(s=e,a=e+t;s<a;++s)i._parsed[s]=r(s)}}},{key:"_getRotation",value:function(){return Me(this.options.rotation-90)}},{key:"_getCircumference",value:function(){return Me(this.options.circumference)}},{key:"_getRotationExtents",value:function(){for(var e=xe,t=-xe,n=0;n<this.chart.data.datasets.length;++n)if(this.chart.isDatasetVisible(n)&&this.chart.getDatasetMeta(n).type===this._type){var i=this.chart.getDatasetMeta(n).controller,s=i._getRotation(),a=i._getCircumference();e=Math.min(e,s),t=Math.max(t,s+a)}return{rotation:e,circumference:t-e}}},{key:"update",value:function(e){var t,n,i=this.chart.chartArea,s=this._cachedMeta,a=s.data,r=this.getMaxBorderWidth()+this.getMaxOffset(a)+this.options.spacing,o=Math.max((Math.min(i.width,i.height)-r)/2,0),l=Math.min((t=this.options.cutout,n=o,"string"===typeof t&&t.endsWith("%")?parseFloat(t)/100:+t/n),1),c=this._getRingWeight(this.index),d=this._getRotationExtents(),u=d.circumference,h=function(e,t,n){var i=1,s=1,a=0,r=0;if(t<xe){var o=e,l=o+t,c=Math.cos(o),d=Math.sin(o),u=Math.cos(l),h=Math.sin(l),g=function(e,t,i){return Fe(e,o,l,!0)?1:Math.max(t,t*n,i,i*n)},p=function(e,t,i){return Fe(e,o,l,!0)?-1:Math.min(t,t*n,i,i*n)},f=g(0,c,u),m=g(be,d,h),v=p(ve,c,u),x=p(ve+be,d,h);i=(f-v)/2,s=(m-x)/2,a=-(f+v)/2,r=-(m+x)/2}return{ratioX:i,ratioY:s,offsetX:a,offsetY:r}}(d.rotation,u,l),g=h.ratioX,p=h.ratioY,f=h.offsetX,m=h.offsetY,v=(i.width-r)/g,x=(i.height-r)/p,A=Math.max(Math.min(v,x)/2,0),y=ee(this.options.radius,A),P=(y-Math.max(y*l,0))/this._getVisibleDatasetWeightTotal();this.offsetX=f*y,this.offsetY=m*y,s.total=this.calculateTotal(),this.outerRadius=y-P*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-P*c,0),this.updateElements(a,0,a.length,e)}},{key:"_circumference",value:function(e,t){var n=this.options,i=this._cachedMeta,s=this._getCircumference();return t&&n.animation.animateRotate||!this.chart.getDataVisibility(e)||null===i._parsed[e]||i.data[e].hidden?0:this.calculateCircumference(i._parsed[e]*s/xe)}},{key:"updateElements",value:function(e,t,n,i){var s,a="reset"===i,r=this.chart,o=r.chartArea,l=r.options.animation,c=(o.left+o.right)/2,d=(o.top+o.bottom)/2,u=a&&l.animateScale,h=u?0:this.innerRadius,g=u?0:this.outerRadius,p=this._getSharedOptions(t,i),f=p.sharedOptions,m=p.includeOptions,v=this._getRotation();for(s=0;s<t;++s)v+=this._circumference(s,a);for(s=t;s<t+n;++s){var x=this._circumference(s,a),A=e[s],y={x:c+this.offsetX,y:d+this.offsetY,startAngle:v,endAngle:v+x,circumference:x,outerRadius:g,innerRadius:h};m&&(y.options=f||this.resolveDataElementOptions(s,A.active?"active":i)),v+=x,this.updateElement(A,s,y,i)}}},{key:"calculateTotal",value:function(){var e,t=this._cachedMeta,n=t.data,i=0;for(e=0;e<n.length;e++){var s=t._parsed[e];null===s||isNaN(s)||!this.chart.getDataVisibility(e)||n[e].hidden||(i+=Math.abs(s))}return i}},{key:"calculateCircumference",value:function(e){var t=this._cachedMeta.total;return t>0&&!isNaN(e)?xe*(Math.abs(e)/t):0}},{key:"getLabelAndValue",value:function(e){var t=this._cachedMeta,n=this.chart,i=n.data.labels||[],s=ct(t._parsed[e],n.options.locale);return{label:i[e]||"",value:s}}},{key:"getMaxBorderWidth",value:function(e){var t,n,i,s,a,r=0,o=this.chart;if(!e)for(t=0,n=o.data.datasets.length;t<n;++t)if(o.isDatasetVisible(t)){e=(i=o.getDatasetMeta(t)).data,s=i.controller;break}if(!e)return 0;for(t=0,n=e.length;t<n;++t)"inner"!==(a=s.resolveDataElementOptions(t)).borderAlign&&(r=Math.max(r,a.borderWidth||0,a.hoverBorderWidth||0));return r}},{key:"getMaxOffset",value:function(e){for(var t=0,n=0,i=e.length;n<i;++n){var s=this.resolveDataElementOptions(n);t=Math.max(t,s.offset||0,s.hoverOffset||0)}return t}},{key:"_getRingWeightOffset",value:function(e){for(var t=0,n=0;n<e;++n)this.chart.isDatasetVisible(n)&&(t+=this._getRingWeight(n));return t}},{key:"_getRingWeight",value:function(e){return Math.max(J(this.chart.data.datasets[e].weight,1),0)}},{key:"_getVisibleDatasetWeightTotal",value:function(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}])}(Jn);(0,c.default)(di,"id","doughnut"),(0,c.default)(di,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),(0,c.default)(di,"descriptors",{_scriptable:function(e){return"spacing"!==e},_indexable:function(e){return"spacing"!==e&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}}),(0,c.default)(di,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels:function(e){var t=e.data;if(t.labels.length&&t.datasets.length){var n=e.legend.options.labels,i=n.pointStyle,s=n.color;return t.labels.map((function(t,n){var a=e.getDatasetMeta(0).controller.getStyle(n);return{text:t,fillStyle:a.backgroundColor,strokeStyle:a.borderColor,fontColor:s,lineWidth:a.borderWidth,pointStyle:i,hidden:!e.getDataVisibility(n),index:n}}))}return[]}},onClick:function(e,t,n){n.chart.toggleDataVisibility(t.index),n.chart.update()}}}});var ui=function(e){function t(){return(0,u.default)(this,t),(0,s.default)(this,t,arguments)}return(0,r.default)(t,e),(0,h.default)(t,[{key:"initialize",value:function(){this.enableOptionSharing=!0,this.supportsDecimation=!0,(0,a.A)(t,"initialize",this,3)([])}},{key:"update",value:function(e){var t=this._cachedMeta,n=t.dataset,i=t.data,s=void 0===i?[]:i,a=t._dataset,r=this.chart._animationsDisabled,o=Xe(t,s,r),l=o.start,c=o.count;this._drawStart=l,this._drawCount=c,Ze(t)&&(l=0,c=s.length),n._chart=this.chart,n._datasetIndex=this.index,n._decimated=!!a._decimated,n.points=s;var d=this.resolveDatasetElementOptions(e);this.options.showLine||(d.borderWidth=0),d.segment=this.options.segment,this.updateElement(n,void 0,{animated:!r,options:d},e),this.updateElements(s,l,c,e)}},{key:"updateElements",value:function(e,t,n,i){for(var s="reset"===i,a=this._cachedMeta,r=a.iScale,o=a.vScale,l=a._stacked,c=a._dataset,d=this._getSharedOptions(t,i),u=d.sharedOptions,h=d.includeOptions,g=r.axis,p=o.axis,f=this.options,m=f.spanGaps,v=f.segment,x=Ie(m)?m:Number.POSITIVE_INFINITY,A=this.chart._animationsDisabled||s||"none"===i,y=t+n,P=e.length,b=t>0&&this.getParsed(t-1),j=0;j<P;++j){var S=e[j],k=A?S:{};if(j<t||j>=y)k.skip=!0;else{var D=this.getParsed(j),_=Q(D[p]),w=k[g]=r.getPixelForValue(D[g],j),I=k[p]=s||_?o.getBasePixel():o.getPixelForValue(l?this.applyStack(o,D,l):D[p],j);k.skip=isNaN(w)||isNaN(I)||_,k.stop=j>0&&Math.abs(D[g]-b[g])>x,v&&(k.parsed=D,k.raw=c.data[j]),h&&(k.options=u||this.resolveDataElementOptions(j,S.active?"active":i)),A||this.updateElement(S,j,k,i),b=D}}}},{key:"getMaxOverflow",value:function(){var e=this._cachedMeta,t=e.dataset,n=t.options&&t.options.borderWidth||0,i=e.data||[];if(!i.length)return n;var s=i[0].size(this.resolveDataElementOptions(0)),a=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(n,s,a)/2}},{key:"draw",value:function(){var e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),(0,a.A)(t,"draw",this,3)([])}}])}(Jn);(0,c.default)(ui,"id","line"),(0,c.default)(ui,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),(0,c.default)(ui,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});var hi=function(e){function t(e,n){var i;return(0,u.default)(this,t),(i=(0,s.default)(this,t,[e,n])).innerRadius=void 0,i.outerRadius=void 0,i}return(0,r.default)(t,e),(0,h.default)(t,[{key:"getLabelAndValue",value:function(e){var t=this._cachedMeta,n=this.chart,i=n.data.labels||[],s=ct(t._parsed[e].r,n.options.locale);return{label:i[e]||"",value:s}}},{key:"parseObjectData",value:function(e,t,n,i){return nn.bind(this)(e,t,n,i)}},{key:"update",value:function(e){var t=this._cachedMeta.data;this._updateRadius(),this.updateElements(t,0,t.length,e)}},{key:"getMinMax",value:function(){var e=this,t=this._cachedMeta,n={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return t.data.forEach((function(t,i){var s=e.getParsed(i).r;!isNaN(s)&&e.chart.getDataVisibility(i)&&(s<n.min&&(n.min=s),s>n.max&&(n.max=s))})),n}},{key:"_updateRadius",value:function(){var e=this.chart,t=e.chartArea,n=e.options,i=Math.min(t.right-t.left,t.bottom-t.top),s=Math.max(i/2,0),a=(s-Math.max(n.cutoutPercentage?s/100*n.cutoutPercentage:1,0))/e.getVisibleDatasetCount();this.outerRadius=s-a*this.index,this.innerRadius=this.outerRadius-a}},{key:"updateElements",value:function(e,t,n,i){var s,a="reset"===i,r=this.chart,o=r.options.animation,l=this._cachedMeta.rScale,c=l.xCenter,d=l.yCenter,u=l.getIndexAngle(0)-.5*ve,h=u,g=360/this.countVisibleElements();for(s=0;s<t;++s)h+=this._computeAngle(s,i,g);for(s=t;s<t+n;s++){var p=e[s],f=h,m=h+this._computeAngle(s,i,g),v=r.getDataVisibility(s)?l.getDistanceFromCenterForValue(this.getParsed(s).r):0;h=m,a&&(o.animateScale&&(v=0),o.animateRotate&&(f=m=u));var x={x:c,y:d,innerRadius:0,outerRadius:v,startAngle:f,endAngle:m,options:this.resolveDataElementOptions(s,p.active?"active":i)};this.updateElement(p,s,x,i)}}},{key:"countVisibleElements",value:function(){var e=this,t=this._cachedMeta,n=0;return t.data.forEach((function(t,i){!isNaN(e.getParsed(i).r)&&e.chart.getDataVisibility(i)&&n++})),n}},{key:"_computeAngle",value:function(e,t,n){return this.chart.getDataVisibility(e)?Me(this.resolveDataElementOptions(e,t).angle||n):0}}])}(Jn);(0,c.default)(hi,"id","polarArea"),(0,c.default)(hi,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),(0,c.default)(hi,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels:function(e){var t=e.data;if(t.labels.length&&t.datasets.length){var n=e.legend.options.labels,i=n.pointStyle,s=n.color;return t.labels.map((function(t,n){var a=e.getDatasetMeta(0).controller.getStyle(n);return{text:t,fillStyle:a.backgroundColor,strokeStyle:a.borderColor,fontColor:s,lineWidth:a.borderWidth,pointStyle:i,hidden:!e.getDataVisibility(n),index:n}}))}return[]}},onClick:function(e,t,n){n.chart.toggleDataVisibility(t.index),n.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});var gi=function(e){function t(){return(0,u.default)(this,t),(0,s.default)(this,t,arguments)}return(0,r.default)(t,e),(0,h.default)(t)}(di);(0,c.default)(gi,"id","pie"),(0,c.default)(gi,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});var pi=function(e){function t(){return(0,u.default)(this,t),(0,s.default)(this,t,arguments)}return(0,r.default)(t,e),(0,h.default)(t,[{key:"getLabelAndValue",value:function(e){var t=this._cachedMeta.vScale,n=this.getParsed(e);return{label:t.getLabels()[e],value:""+t.getLabelForValue(n[t.axis])}}},{key:"parseObjectData",value:function(e,t,n,i){return nn.bind(this)(e,t,n,i)}},{key:"update",value:function(e){var t=this._cachedMeta,n=t.dataset,i=t.data||[],s=t.iScale.getLabels();if(n.points=i,"resize"!==e){var a=this.resolveDatasetElementOptions(e);this.options.showLine||(a.borderWidth=0);var r={_loop:!0,_fullLoop:s.length===i.length,options:a};this.updateElement(n,void 0,r,e)}this.updateElements(i,0,i.length,e)}},{key:"updateElements",value:function(e,t,n,i){for(var s=this._cachedMeta.rScale,a="reset"===i,r=t;r<t+n;r++){var o=e[r],l=this.resolveDataElementOptions(r,o.active?"active":i),c=s.getPointPositionForValue(r,this.getParsed(r).r),d=a?s.xCenter:c.x,u=a?s.yCenter:c.y,h={x:d,y:u,angle:c.angle,skip:isNaN(d)||isNaN(u),options:l};this.updateElement(o,r,h,i)}}}])}(Jn);(0,c.default)(pi,"id","radar"),(0,c.default)(pi,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),(0,c.default)(pi,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});var fi=function(e){function t(){return(0,u.default)(this,t),(0,s.default)(this,t,arguments)}return(0,r.default)(t,e),(0,h.default)(t,[{key:"getLabelAndValue",value:function(e){var t=this._cachedMeta,n=this.chart.data.labels||[],i=t.xScale,s=t.yScale,a=this.getParsed(e),r=i.getLabelForValue(a.x),o=s.getLabelForValue(a.y);return{label:n[e]||"",value:"("+r+", "+o+")"}}},{key:"update",value:function(e){var t=this._cachedMeta,n=t.data,i=void 0===n?[]:n,s=this.chart._animationsDisabled,a=Xe(t,i,s),r=a.start,o=a.count;if(this._drawStart=r,this._drawCount=o,Ze(t)&&(r=0,o=i.length),this.options.showLine){this.datasetElementType||this.addElements();var l=t.dataset,c=t._dataset;l._chart=this.chart,l._datasetIndex=this.index,l._decimated=!!c._decimated,l.points=i;var d=this.resolveDatasetElementOptions(e);d.segment=this.options.segment,this.updateElement(l,void 0,{animated:!s,options:d},e)}else this.datasetElementType&&(delete t.dataset,this.datasetElementType=!1);this.updateElements(i,r,o,e)}},{key:"addElements",value:function(){var e=this.options.showLine;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),(0,a.A)(t,"addElements",this,3)([])}},{key:"updateElements",value:function(e,t,n,i){for(var s="reset"===i,a=this._cachedMeta,r=a.iScale,o=a.vScale,l=a._stacked,c=a._dataset,d=this.resolveDataElementOptions(t,i),u=this.getSharedOptions(d),h=this.includeOptions(i,u),g=r.axis,p=o.axis,f=this.options,m=f.spanGaps,v=f.segment,x=Ie(m)?m:Number.POSITIVE_INFINITY,A=this.chart._animationsDisabled||s||"none"===i,y=t>0&&this.getParsed(t-1),P=t;P<t+n;++P){var b=e[P],j=this.getParsed(P),S=A?b:{},k=Q(j[p]),D=S[g]=r.getPixelForValue(j[g],P),_=S[p]=s||k?o.getBasePixel():o.getPixelForValue(l?this.applyStack(o,j,l):j[p],P);S.skip=isNaN(D)||isNaN(_)||k,S.stop=P>0&&Math.abs(j[g]-y[g])>x,v&&(S.parsed=j,S.raw=c.data[P]),h&&(S.options=u||this.resolveDataElementOptions(P,b.active?"active":i)),A||this.updateElement(b,P,S,i),y=j}this.updateSharedOptions(u,i,d)}},{key:"getMaxOverflow",value:function(){var e=this._cachedMeta,t=e.data||[];if(!this.options.showLine){for(var n=0,i=t.length-1;i>=0;--i)n=Math.max(n,t[i].size(this.resolveDataElementOptions(i))/2);return n>0&&n}var s=e.dataset,a=s.options&&s.options.borderWidth||0;if(!t.length)return a;var r=t[0].size(this.resolveDataElementOptions(0)),o=t[t.length-1].size(this.resolveDataElementOptions(t.length-1));return Math.max(a,r,o)/2}}])}(Jn);(0,c.default)(fi,"id","scatter"),(0,c.default)(fi,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),(0,c.default)(fi,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});function mi(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}var vi={_date:function(){function e(t){(0,u.default)(this,e),(0,c.default)(this,"options",void 0),this.options=t||{}}return(0,h.default)(e,[{key:"init",value:function(){}},{key:"formats",value:function(){return mi()}},{key:"parse",value:function(){return mi()}},{key:"format",value:function(){return mi()}},{key:"add",value:function(){return mi()}},{key:"diff",value:function(){return mi()}},{key:"startOf",value:function(){return mi()}},{key:"endOf",value:function(){return mi()}}],[{key:"override",value:function(t){Object.assign(e.prototype,t)}}])}()};function xi(e,t,n,i){var s=e.controller,a=e.data,r=e._sorted,o=s._cachedMeta.iScale;if(o&&t===o.axis&&"r"!==t&&r&&a.length){var l=o._reversePixels?qe:He;if(!i)return l(a,t,n);if(s._sharedOptions){var c=a[0],d="function"===typeof c.getRange&&c.getRange(t);if(d){var u=l(a,t,n-d),h=l(a,t,n+d);return{lo:u.lo,hi:h.hi}}}}return{lo:0,hi:a.length-1}}function Ai(e,t,n,i,s){for(var a=e.getSortedVisibleDatasetMetas(),r=n[t],o=0,l=a.length;o<l;++o)for(var c=a[o],d=c.index,u=c.data,h=xi(a[o],t,r,s),g=h.lo,p=h.hi,f=g;f<=p;++f){var m=u[f];m.skip||i(m,d,f)}}function yi(e,t,n,i,s){var a=[];if(!s&&!e.isPointInArea(t))return a;return Ai(e,n,t,(function(n,r,o){(s||St(n,e.chartArea,0))&&n.inRange(t.x,t.y,i)&&a.push({element:n,datasetIndex:r,index:o})}),!0),a}function Pi(e,t,n,i,s,a){var r=[],o=function(e){var t=-1!==e.indexOf("x"),n=-1!==e.indexOf("y");return function(e,i){var s=t?Math.abs(e.x-i.x):0,a=n?Math.abs(e.y-i.y):0;return Math.sqrt(Math.pow(s,2)+Math.pow(a,2))}}(n),l=Number.POSITIVE_INFINITY;return Ai(e,n,t,(function(n,c,d){var u=n.inRange(t.x,t.y,s);if(!i||u){var h=n.getCenterPoint(s);if(!!a||e.isPointInArea(h)||u){var g=o(t,h);g<l?(r=[{element:n,datasetIndex:c,index:d}],l=g):g===l&&r.push({element:n,datasetIndex:c,index:d})}}})),r}function bi(e,t,n,i,s,a){return a||e.isPointInArea(t)?"r"!==n||i?Pi(e,t,n,i,s,a):function(e,t,n,i){var s=[];return Ai(e,n,t,(function(e,n,a){var r=e.getProps(["startAngle","endAngle"],i),o=r.startAngle,l=r.endAngle;Fe(Oe(e,{x:t.x,y:t.y}).angle,o,l)&&s.push({element:e,datasetIndex:n,index:a})})),s}(e,t,n,s):[]}function ji(e,t,n,i,s){var a=[],r="x"===n?"inXRange":"inYRange",o=!1;return Ai(e,n,t,(function(e,i,l){e[r]&&e[r](t[n],s)&&(a.push({element:e,datasetIndex:i,index:l}),o=o||e.inRange(t.x,t.y,s))})),i&&!o?[]:a}var Si={evaluateInteractionItems:Ai,modes:{index:function(e,t,n,i){var s=vn(t,e),a=n.axis||"x",r=n.includeInvisible||!1,o=n.intersect?yi(e,s,a,i,r):bi(e,s,a,!1,i,r),l=[];return o.length?(e.getSortedVisibleDatasetMetas().forEach((function(e){var t=o[0].index,n=e.data[t];n&&!n.skip&&l.push({element:n,datasetIndex:e.index,index:t})})),l):[]},dataset:function(e,t,n,i){var s=vn(t,e),a=n.axis||"xy",r=n.includeInvisible||!1,o=n.intersect?yi(e,s,a,i,r):bi(e,s,a,!1,i,r);if(o.length>0){var l=o[0].datasetIndex,c=e.getDatasetMeta(l).data;o=[];for(var d=0;d<c.length;++d)o.push({element:c[d],datasetIndex:l,index:d})}return o},point:function(e,t,n,i){return yi(e,vn(t,e),n.axis||"xy",i,n.includeInvisible||!1)},nearest:function(e,t,n,i){var s=vn(t,e),a=n.axis||"xy",r=n.includeInvisible||!1;return bi(e,s,a,n.intersect,i,r)},x:function(e,t,n,i){return ji(e,vn(t,e),"x",n.intersect,i)},y:function(e,t,n,i){return ji(e,vn(t,e),"y",n.intersect,i)}}},ki=["left","top","right","bottom"];function Di(e,t){return e.filter((function(e){return e.pos===t}))}function _i(e,t){return e.filter((function(e){return-1===ki.indexOf(e.pos)&&e.box.axis===t}))}function wi(e,t){return e.sort((function(e,n){var i=t?n:e,s=t?e:n;return i.weight===s.weight?i.index-s.index:i.weight-s.weight}))}function Ii(e,t){var n,i,s,a=function(e){var t,n={},i=(0,l.default)(e);try{for(i.s();!(t=i.n()).done;){var s=t.value,a=s.stack,r=s.pos,o=s.stackWeight;if(a&&ki.includes(r)){var c=n[a]||(n[a]={count:0,placed:0,weight:0,size:0});c.count++,c.weight+=o}}}catch(d){i.e(d)}finally{i.f()}return n}(e),r=t.vBoxMaxWidth,o=t.hBoxMaxHeight;for(n=0,i=e.length;n<i;++n){var c=(s=e[n]).box.fullSize,d=a[s.stack],u=d&&s.stackWeight/d.weight;s.horizontal?(s.width=u?u*r:c&&t.availableWidth,s.height=o):(s.width=r,s.height=u?u*o:c&&t.availableHeight)}return a}function Ni(e,t,n,i){return Math.max(e[n],t[n])+Math.max(e[i],t[i])}function Mi(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function Ci(e,t,n,i){var s=n.pos,a=n.box,r=e.maxPadding;if(!$(s)){n.size&&(e[s]-=n.size);var o=i[n.stack]||{size:0,count:1};o.size=Math.max(o.size,n.horizontal?a.height:a.width),n.size=o.size/o.count,e[s]+=n.size}a.getPadding&&Mi(r,a.getPadding());var l=Math.max(0,t.outerWidth-Ni(r,e,"left","right")),c=Math.max(0,t.outerHeight-Ni(r,e,"top","bottom")),d=l!==e.w,u=c!==e.h;return e.w=l,e.h=c,n.horizontal?{same:d,other:u}:{same:u,other:d}}function Li(e,t){var n=t.maxPadding;function i(e){var i={left:0,top:0,right:0,bottom:0};return e.forEach((function(e){i[e]=Math.max(t[e],n[e])})),i}return i(e?["left","right"]:["top","bottom"])}function Oi(e,t,n,i){var s,a,r,o,l,c,d=[];for(s=0,a=e.length,l=0;s<a;++s){(o=(r=e[s]).box).update(r.width||t.w,r.height||t.h,Li(r.horizontal,t));var u=Ci(t,n,r,i),h=u.same,g=u.other;l|=h&&d.length,c=c||g,o.fullSize||d.push(r)}return l&&Oi(d,t,n,i)||c}function Ti(e,t,n,i,s){e.top=n,e.left=t,e.right=t+i,e.bottom=n+s,e.width=i,e.height=s}function Ri(e,t,n,i){var s,a=n.padding,r=t.x,o=t.y,c=(0,l.default)(e);try{for(c.s();!(s=c.n()).done;){var d=s.value,u=d.box,h=i[d.stack]||{count:1,placed:0,weight:1},g=d.stackWeight/h.weight||1;if(d.horizontal){var p=t.w*g,f=h.size||u.height;pe(h.start)&&(o=h.start),u.fullSize?Ti(u,a.left,o,n.outerWidth-a.right-a.left,f):Ti(u,t.left+h.placed,o,p,f),h.start=o,h.placed+=p,o=u.bottom}else{var m=t.h*g,v=h.size||u.width;pe(h.start)&&(r=h.start),u.fullSize?Ti(u,r,a.top,v,n.outerHeight-a.bottom-a.top):Ti(u,r,t.top+h.placed,v,m),h.start=r,h.placed+=m,r=u.right}}}catch(x){c.e(x)}finally{c.f()}t.x=r,t.y=o}var Ui=function(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw:function(e){t.draw(e)}}]},e.boxes.push(t)},Fi=function(e,t){var n=e.boxes?e.boxes.indexOf(t):-1;-1!==n&&e.boxes.splice(n,1)},Ei=function(e,t,n){t.fullSize=n.fullSize,t.position=n.position,t.weight=n.weight},zi=function(e,t,n,i){if(e){var s=Et(e.options.layout.padding),a=Math.max(t-s.width,0),r=Math.max(n-s.height,0),o=function(e){var t=function(e){var t,n,i,s,a,r,o=[];for(t=0,n=(e||[]).length;t<n;++t){var l=i=e[t];s=l.position;var c=l.options;a=c.stack;var d=c.stackWeight;r=void 0===d?1:d,o.push({index:t,box:i,pos:s,horizontal:i.isHorizontal(),weight:i.weight,stack:a&&s+a,stackWeight:r})}return o}(e),n=wi(t.filter((function(e){return e.box.fullSize})),!0),i=wi(Di(t,"left"),!0),s=wi(Di(t,"right")),a=wi(Di(t,"top"),!0),r=wi(Di(t,"bottom")),o=_i(t,"x"),l=_i(t,"y");return{fullSize:n,leftAndTop:i.concat(a),rightAndBottom:s.concat(l).concat(r).concat(o),chartArea:Di(t,"chartArea"),vertical:i.concat(s).concat(l),horizontal:a.concat(r).concat(o)}}(e.boxes),l=o.vertical,c=o.horizontal;ne(e.boxes,(function(e){"function"===typeof e.beforeLayout&&e.beforeLayout()}));var d=l.reduce((function(e,t){return t.box.options&&!1===t.box.options.display?e:e+1}),0)||1,u=Object.freeze({outerWidth:t,outerHeight:n,padding:s,availableWidth:a,availableHeight:r,vBoxMaxWidth:a/2/d,hBoxMaxHeight:r/2}),h=Object.assign({},s);Mi(h,Et(i));var g=Object.assign({maxPadding:h,w:a,h:r,x:s.left,y:s.top},s),p=Ii(l.concat(c),u);Oi(o.fullSize,g,u,p),Oi(l,g,u,p),Oi(c,g,u,p)&&Oi(l,g,u,p),function(e){var t=e.maxPadding;function n(n){var i=Math.max(t[n]-e[n],0);return e[n]+=i,i}e.y+=n("top"),e.x+=n("left"),n("right"),n("bottom")}(g),Ri(o.leftAndTop,g,u,p),g.x+=g.w,g.y+=g.h,Ri(o.rightAndBottom,g,u,p),e.chartArea={left:g.left,top:g.top,right:g.left+g.w,bottom:g.top+g.h,height:g.h,width:g.w},ne(o.chartArea,(function(t){var n=t.box;Object.assign(n,e.chartArea),n.update(g.w,g.h,{left:0,top:0,right:0,bottom:0})}))}},Bi=function(){return(0,h.default)((function e(){(0,u.default)(this,e)}),[{key:"acquireContext",value:function(e,t){}},{key:"releaseContext",value:function(e){return!1}},{key:"addEventListener",value:function(e,t,n){}},{key:"removeEventListener",value:function(e,t,n){}},{key:"getDevicePixelRatio",value:function(){return 1}},{key:"getMaximumSize",value:function(e,t,n,i){return t=Math.max(0,t||e.width),n=n||e.height,{width:t,height:Math.max(0,i?Math.floor(t/i):n)}}},{key:"isAttached",value:function(e){return!0}},{key:"updateConfig",value:function(e){}}])}(),Hi=function(e){function t(){return(0,u.default)(this,t),(0,s.default)(this,t,arguments)}return(0,r.default)(t,e),(0,h.default)(t,[{key:"acquireContext",value:function(e){return e&&e.getContext&&e.getContext("2d")||null}},{key:"updateConfig",value:function(e){e.options.animation=!1}}])}(Bi),qi="$chartjs",Yi={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Vi=function(e){return null===e||""===e};var Gi=!!Pn&&{passive:!0};function Wi(e,t,n){e&&e.canvas&&e.canvas.removeEventListener(t,n,Gi)}function Qi(e,t){var n,i=(0,l.default)(e);try{for(i.s();!(n=i.n()).done;){var s=n.value;if(s===t||s.contains(t))return!0}}catch(a){i.e(a)}finally{i.f()}}function Ki(e,t,n){var i=e.canvas,s=new MutationObserver((function(e){var t,s=!1,a=(0,l.default)(e);try{for(a.s();!(t=a.n()).done;){var r=t.value;s=(s=s||Qi(r.addedNodes,i))&&!Qi(r.removedNodes,i)}}catch(o){a.e(o)}finally{a.f()}s&&n()}));return s.observe(document,{childList:!0,subtree:!0}),s}function $i(e,t,n){var i=e.canvas,s=new MutationObserver((function(e){var t,s=!1,a=(0,l.default)(e);try{for(a.s();!(t=a.n()).done;){var r=t.value;s=(s=s||Qi(r.removedNodes,i))&&!Qi(r.addedNodes,i)}}catch(o){a.e(o)}finally{a.f()}s&&n()}));return s.observe(document,{childList:!0,subtree:!0}),s}var Xi=new Map,Zi=0;function Ji(){var e=window.devicePixelRatio;e!==Zi&&(Zi=e,Xi.forEach((function(t,n){n.currentDevicePixelRatio!==e&&t()})))}function es(e,t,n){var i=e.canvas,s=i&&hn(i);if(s){var a=Qe((function(e,t){var i=s.clientWidth;n(e,t),i<s.clientWidth&&n()}),window),r=new ResizeObserver((function(e){var t=e[0],n=t.contentRect.width,i=t.contentRect.height;0===n&&0===i||a(n,i)}));return r.observe(s),function(e,t){Xi.size||window.addEventListener("resize",Ji),Xi.set(e,t)}(e,a),r}}function ts(e,t,n){n&&n.disconnect(),"resize"===t&&function(e){Xi.delete(e),Xi.size||window.removeEventListener("resize",Ji)}(e)}function ns(e,t,n){var i=e.canvas,s=Qe((function(t){null!==e.ctx&&n(function(e,t){var n=Yi[e.type]||e.type,i=vn(e,t),s=i.x,a=i.y;return{type:n,chart:t,native:e,x:void 0!==s?s:null,y:void 0!==a?a:null}}(t,e))}),e);return function(e,t,n){e&&e.addEventListener(t,n,Gi)}(i,t,s),s}var is=function(e){function t(){return(0,u.default)(this,t),(0,s.default)(this,t,arguments)}return(0,r.default)(t,e),(0,h.default)(t,[{key:"acquireContext",value:function(e,t){var n=e&&e.getContext&&e.getContext("2d");return n&&n.canvas===e?(function(e,t){var n=e.style,i=e.getAttribute("height"),s=e.getAttribute("width");if(e[qi]={initial:{height:i,width:s,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",Vi(s)){var a=bn(e,"width");void 0!==a&&(e.width=a)}if(Vi(i))if(""===e.style.height)e.height=e.width/(t||2);else{var r=bn(e,"height");void 0!==r&&(e.height=r)}}(e,t),n):null}},{key:"releaseContext",value:function(e){var t=e.canvas;if(!t[qi])return!1;var n=t[qi].initial;["height","width"].forEach((function(e){var i=n[e];Q(i)?t.removeAttribute(e):t.setAttribute(e,i)}));var i=n.style||{};return Object.keys(i).forEach((function(e){t.style[e]=i[e]})),t.width=t.width,delete t[qi],!0}},{key:"addEventListener",value:function(e,t,n){this.removeEventListener(e,t);var i=e.$proxies||(e.$proxies={}),s={attach:Ki,detach:$i,resize:es}[t]||ns;i[t]=s(e,t,n)}},{key:"removeEventListener",value:function(e,t){var n=e.$proxies||(e.$proxies={}),i=n[t];i&&(({attach:ts,detach:ts,resize:ts}[t]||Wi)(e,t,i),n[t]=void 0)}},{key:"getDevicePixelRatio",value:function(){return window.devicePixelRatio}},{key:"getMaximumSize",value:function(e,t,n,i){return An(e,t,n,i)}},{key:"isAttached",value:function(e){var t=e&&hn(e);return!(!t||!t.isConnected)}}])}(Bi);var ss=function(){return(0,h.default)((function e(){(0,u.default)(this,e),(0,c.default)(this,"x",void 0),(0,c.default)(this,"y",void 0),(0,c.default)(this,"active",!1),(0,c.default)(this,"options",void 0),(0,c.default)(this,"$animations",void 0)}),[{key:"tooltipPosition",value:function(e){var t=this.getProps(["x","y"],e);return{x:t.x,y:t.y}}},{key:"hasValue",value:function(){return Ie(this.x)&&Ie(this.y)}},{key:"getProps",value:function(e,t){var n=this,i=this.$animations;if(!t||!i)return this;var s={};return e.forEach((function(e){s[e]=i[e]&&i[e].active()?i[e]._to:n[e]})),s}}])}();function as(e,t){var n=e.options.ticks,i=function(e){var t=e.options.offset,n=e._tickSize(),i=e._length/n+(t?0:1),s=e._maxLength/n;return Math.floor(Math.min(i,s))}(e),s=Math.min(n.maxTicksLimit||i,i),a=n.major.enabled?function(e){var t,n,i=[];for(t=0,n=e.length;t<n;t++)e[t].major&&i.push(t);return i}(t):[],r=a.length,o=a[0],l=a[r-1],c=[];if(r>s)return function(e,t,n,i){var s,a=0,r=n[0];for(i=Math.ceil(i),s=0;s<e.length;s++)s===r&&(t.push(e[s]),r=n[++a*i])}(t,c,a,r/s),c;var d=function(e,t,n){var i=function(e){var t,n,i=e.length;if(i<2)return!1;for(n=e[0],t=1;t<i;++t)if(e[t]-e[t-1]!==n)return!1;return n}(e),s=t.length/n;if(!i)return Math.max(s,1);for(var a=function(e){var t,n=[],i=Math.sqrt(e);for(t=1;t<i;t++)e%t===0&&(n.push(t),n.push(e/t));return i===(0|i)&&n.push(i),n.sort((function(e,t){return e-t})).pop(),n}(i),r=0,o=a.length-1;r<o;r++){var l=a[r];if(l>s)return l}return Math.max(s,1)}(a,t,s);if(r>0){var u,h,g=r>1?Math.round((l-o)/(r-1)):null;for(rs(t,c,d,Q(g)?0:o-g,o),u=0,h=r-1;u<h;u++)rs(t,c,d,a[u],a[u+1]);return rs(t,c,d,l,Q(g)?t.length:l+g),c}return rs(t,c,d),c}function rs(e,t,n,i,s){var a,r,o,l=J(i,0),c=Math.min(J(s,e.length),e.length),d=0;for(n=Math.ceil(n),s&&(n=(a=s-i)/Math.floor(a/n)),o=l;o<0;)d++,o=Math.round(l+d*n);for(r=Math.max(l,0);r<c;r++)r===o&&(t.push(e[r]),d++,o=Math.round(l+d*n))}(0,c.default)(ss,"defaults",{}),(0,c.default)(ss,"defaultRoutes",void 0);var os=function(e,t,n){return"top"===t||"left"===t?e[t]+n:e[t]-n},ls=function(e,t){return Math.min(t||e,e)};function cs(e,t){for(var n=[],i=e.length/t,s=e.length,a=0;a<s;a+=i)n.push(e[Math.floor(a)]);return n}function ds(e,t,n){var i,s=e.ticks.length,a=Math.min(t,s-1),r=e._startPixel,o=e._endPixel,l=1e-6,c=e.getPixelForTick(a);if(!(n&&(i=1===s?Math.max(c-r,o-c):0===t?(e.getPixelForTick(1)-c)/2:(c-e.getPixelForTick(a-1))/2,(c+=a<t?i:-i)<r-l||c>o+l)))return c}function us(e){return e.drawTicks?e.tickLength:0}function hs(e,t){if(!e.display)return 0;var n=zt(e.font,t),i=Et(e.padding);return(K(e.text)?e.text.length:1)*n.lineHeight+i.height}function gs(e,t,n){var i=Ke(e);return(n&&"right"!==t||!n&&"right"===t)&&(i=function(e){return"left"===e?"right":"right"===e?"left":e}(i)),i}var ps=function(e){function t(e){var n;return(0,u.default)(this,t),(n=(0,s.default)(this,t)).id=e.id,n.type=e.type,n.options=void 0,n.ctx=e.ctx,n.chart=e.chart,n.top=void 0,n.bottom=void 0,n.left=void 0,n.right=void 0,n.width=void 0,n.height=void 0,n._margins={left:0,right:0,top:0,bottom:0},n.maxWidth=void 0,n.maxHeight=void 0,n.paddingTop=void 0,n.paddingBottom=void 0,n.paddingLeft=void 0,n.paddingRight=void 0,n.axis=void 0,n.labelRotation=void 0,n.min=void 0,n.max=void 0,n._range=void 0,n.ticks=[],n._gridLineItems=null,n._labelItems=null,n._labelSizes=null,n._length=0,n._maxLength=0,n._longestTextCache={},n._startPixel=void 0,n._endPixel=void 0,n._reversePixels=!1,n._userMax=void 0,n._userMin=void 0,n._suggestedMax=void 0,n._suggestedMin=void 0,n._ticksLength=0,n._borderValue=0,n._cache={},n._dataLimitsCached=!1,n.$context=void 0,n}return(0,r.default)(t,e),(0,h.default)(t,[{key:"init",value:function(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}},{key:"parse",value:function(e,t){return e}},{key:"getUserBounds",value:function(){var e=this._userMin,t=this._userMax,n=this._suggestedMin,i=this._suggestedMax;return e=Z(e,Number.POSITIVE_INFINITY),t=Z(t,Number.NEGATIVE_INFINITY),n=Z(n,Number.POSITIVE_INFINITY),i=Z(i,Number.NEGATIVE_INFINITY),{min:Z(e,n),max:Z(t,i),minDefined:X(e),maxDefined:X(t)}}},{key:"getMinMax",value:function(e){var t,n=this.getUserBounds(),i=n.min,s=n.max,a=n.minDefined,r=n.maxDefined;if(a&&r)return{min:i,max:s};for(var o=this.getMatchingVisibleMetas(),l=0,c=o.length;l<c;++l)t=o[l].controller.getMinMax(this,e),a||(i=Math.min(i,t.min)),r||(s=Math.max(s,t.max));return{min:Z(i=r&&i>s?s:i,Z(s=a&&i>s?i:s,i)),max:Z(s,Z(i,s))}}},{key:"getPadding",value:function(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}},{key:"getTicks",value:function(){return this.ticks}},{key:"getLabels",value:function(){var e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}},{key:"getLabelItems",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.chart.chartArea;return this._labelItems||(this._labelItems=this._computeLabelItems(e))}},{key:"beforeLayout",value:function(){this._cache={},this._dataLimitsCached=!1}},{key:"beforeUpdate",value:function(){te(this.options.beforeUpdate,[this])}},{key:"update",value:function(e,t,n){var i=this.options,s=i.beginAtZero,a=i.grace,r=i.ticks,o=r.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=function(e,t,n){var i=e.min,s=e.max,a=ee(t,(s-i)/2),r=function(e,t){return n&&0===e?0:e+t};return{min:r(i,-Math.abs(a)),max:r(s,a)}}(this,a,s),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();var l=o<this.ticks.length;this._convertTicksToLabels(l?cs(this.ticks,o):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),r.display&&(r.autoSkip||"auto"===r.source)&&(this.ticks=as(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}},{key:"configure",value:function(){var e,t,n=this.options.reverse;this.isHorizontal()?(e=this.left,t=this.right):(e=this.top,t=this.bottom,n=!n),this._startPixel=e,this._endPixel=t,this._reversePixels=n,this._length=t-e,this._alignToPixels=this.options.alignToPixels}},{key:"afterUpdate",value:function(){te(this.options.afterUpdate,[this])}},{key:"beforeSetDimensions",value:function(){te(this.options.beforeSetDimensions,[this])}},{key:"setDimensions",value:function(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}},{key:"afterSetDimensions",value:function(){te(this.options.afterSetDimensions,[this])}},{key:"_callHooks",value:function(e){this.chart.notifyPlugins(e,this.getContext()),te(this.options[e],[this])}},{key:"beforeDataLimits",value:function(){this._callHooks("beforeDataLimits")}},{key:"determineDataLimits",value:function(){}},{key:"afterDataLimits",value:function(){this._callHooks("afterDataLimits")}},{key:"beforeBuildTicks",value:function(){this._callHooks("beforeBuildTicks")}},{key:"buildTicks",value:function(){return[]}},{key:"afterBuildTicks",value:function(){this._callHooks("afterBuildTicks")}},{key:"beforeTickToLabelConversion",value:function(){te(this.options.beforeTickToLabelConversion,[this])}},{key:"generateTickLabels",value:function(e){var t,n,i,s=this.options.ticks;for(t=0,n=e.length;t<n;t++)(i=e[t]).label=te(s.callback,[i.value,t,e],this)}},{key:"afterTickToLabelConversion",value:function(){te(this.options.afterTickToLabelConversion,[this])}},{key:"beforeCalculateLabelRotation",value:function(){te(this.options.beforeCalculateLabelRotation,[this])}},{key:"calculateLabelRotation",value:function(){var e,t,n,i=this.options,s=i.ticks,a=ls(this.ticks.length,i.ticks.maxTicksLimit),r=s.minRotation||0,o=s.maxRotation,l=r;if(!this._isVisible()||!s.display||r>=o||a<=1||!this.isHorizontal())this.labelRotation=r;else{var c=this._getLabelSizes(),d=c.widest.width,u=c.highest.height,h=Ee(this.chart.width-d,0,this.maxWidth);d+6>(e=i.offset?this.maxWidth/a:h/(a-1))&&(e=h/(a-(i.offset?.5:1)),t=this.maxHeight-us(i.grid)-s.padding-hs(i.title,this.chart.options.font),n=Math.sqrt(d*d+u*u),l=Ce(Math.min(Math.asin(Ee((c.highest.height+6)/e,-1,1)),Math.asin(Ee(t/n,-1,1))-Math.asin(Ee(u/n,-1,1)))),l=Math.max(r,Math.min(o,l))),this.labelRotation=l}}},{key:"afterCalculateLabelRotation",value:function(){te(this.options.afterCalculateLabelRotation,[this])}},{key:"afterAutoSkip",value:function(){}},{key:"beforeFit",value:function(){te(this.options.beforeFit,[this])}},{key:"fit",value:function(){var e={width:0,height:0},t=this.chart,n=this.options,i=n.ticks,s=n.title,a=n.grid,r=this._isVisible(),o=this.isHorizontal();if(r){var l=hs(s,t.options.font);if(o?(e.width=this.maxWidth,e.height=us(a)+l):(e.height=this.maxHeight,e.width=us(a)+l),i.display&&this.ticks.length){var c=this._getLabelSizes(),d=c.first,u=c.last,h=c.widest,g=c.highest,p=2*i.padding,f=Me(this.labelRotation),m=Math.cos(f),v=Math.sin(f);if(o){var x=i.mirror?0:v*h.width+m*g.height;e.height=Math.min(this.maxHeight,e.height+x+p)}else{var A=i.mirror?0:m*h.width+v*g.height;e.width=Math.min(this.maxWidth,e.width+A+p)}this._calculatePadding(d,u,v,m)}}this._handleMargins(),o?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}},{key:"_calculatePadding",value:function(e,t,n,i){var s=this.options,a=s.ticks,r=a.align,o=a.padding,l=s.position,c=0!==this.labelRotation,d="top"!==l&&"x"===this.axis;if(this.isHorizontal()){var u=this.getPixelForTick(0)-this.left,h=this.right-this.getPixelForTick(this.ticks.length-1),g=0,p=0;c?d?(g=i*e.width,p=n*t.height):(g=n*e.height,p=i*t.width):"start"===r?p=t.width:"end"===r?g=e.width:"inner"!==r&&(g=e.width/2,p=t.width/2),this.paddingLeft=Math.max((g-u+o)*this.width/(this.width-u),0),this.paddingRight=Math.max((p-h+o)*this.width/(this.width-h),0)}else{var f=t.height/2,m=e.height/2;"start"===r?(f=0,m=e.height):"end"===r&&(f=t.height,m=0),this.paddingTop=f+o,this.paddingBottom=m+o}}},{key:"_handleMargins",value:function(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}},{key:"afterFit",value:function(){te(this.options.afterFit,[this])}},{key:"isHorizontal",value:function(){var e=this.options,t=e.axis,n=e.position;return"top"===n||"bottom"===n||"x"===t}},{key:"isFullSize",value:function(){return this.options.fullSize}},{key:"_convertTicksToLabels",value:function(e){var t,n;for(this.beforeTickToLabelConversion(),this.generateTickLabels(e),t=0,n=e.length;t<n;t++)Q(e[t].label)&&(e.splice(t,1),n--,t--);this.afterTickToLabelConversion()}},{key:"_getLabelSizes",value:function(){var e=this._labelSizes;if(!e){var t=this.options.ticks.sampleSize,n=this.ticks;t<n.length&&(n=cs(n,t)),this._labelSizes=e=this._computeLabelSizes(n,n.length,this.options.ticks.maxTicksLimit)}return e}},{key:"_computeLabelSizes",value:function(e,t,n){var i,s,a,r,o,l,c,d,u,h,g,p=this.ctx,f=this._longestTextCache,m=[],v=[],x=Math.floor(t/ls(t,n)),A=0,y=0;for(i=0;i<t;i+=x){if(r=e[i].label,o=this._resolveTickFontOptions(i),p.font=l=o.string,c=f[l]=f[l]||{data:{},gc:[]},d=o.lineHeight,u=h=0,Q(r)||K(r)){if(K(r))for(s=0,a=r.length;s<a;++s)Q(g=r[s])||K(g)||(u=xt(p,c.data,c.gc,u,g),h+=d)}else u=xt(p,c.data,c.gc,u,r),h=d;m.push(u),v.push(h),A=Math.max(u,A),y=Math.max(h,y)}!function(e,t){ne(e,(function(e){var n,i=e.gc,s=i.length/2;if(s>t){for(n=0;n<s;++n)delete e.data[i[n]];i.splice(0,s)}}))}(f,t);var P=m.indexOf(A),b=v.indexOf(y),j=function(e){return{width:m[e]||0,height:v[e]||0}};return{first:j(0),last:j(t-1),widest:j(P),highest:j(b),widths:m,heights:v}}},{key:"getLabelForValue",value:function(e){return e}},{key:"getPixelForValue",value:function(e,t){return NaN}},{key:"getValueForPixel",value:function(e){}},{key:"getPixelForTick",value:function(e){var t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}},{key:"getPixelForDecimal",value:function(e){this._reversePixels&&(e=1-e);var t=this._startPixel+e*this._length;return Ee(this._alignToPixels?yt(this.chart,t,0):t,-32768,32767)}},{key:"getDecimalForPixel",value:function(e){var t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}},{key:"getBasePixel",value:function(){return this.getPixelForValue(this.getBaseValue())}},{key:"getBaseValue",value:function(){var e=this.min,t=this.max;return e<0&&t<0?t:e>0&&t>0?e:0}},{key:"getContext",value:function(e){var t=this.ticks||[];if(e>=0&&e<t.length){var n=t[e];return n.$context||(n.$context=function(e,t,n){return Ht(e,{tick:n,index:t,type:"tick"})}(this.getContext(),e,n))}return this.$context||(this.$context=Ht(this.chart.getContext(),{scale:this,type:"scale"}))}},{key:"_tickSize",value:function(){var e=this.options.ticks,t=Me(this.labelRotation),n=Math.abs(Math.cos(t)),i=Math.abs(Math.sin(t)),s=this._getLabelSizes(),a=e.autoSkipPadding||0,r=s?s.widest.width+a:0,o=s?s.highest.height+a:0;return this.isHorizontal()?o*n>r*i?r/n:o/i:o*i<r*n?o/n:r/i}},{key:"_isVisible",value:function(){var e=this.options.display;return"auto"!==e?!!e:this.getMatchingVisibleMetas().length>0}},{key:"_computeGridLineItems",value:function(e){var t,n,i,s,a,r,o,l,c,d,u,h,g=this.axis,p=this.chart,f=this.options,m=f.grid,v=f.position,x=f.border,A=m.offset,y=this.isHorizontal(),P=this.ticks.length+(A?1:0),b=us(m),j=[],S=x.setContext(this.getContext()),k=S.display?S.width:0,D=k/2,_=function(e){return yt(p,e,k)};if("top"===v)t=_(this.bottom),r=this.bottom-b,l=t-D,d=_(e.top)+D,h=e.bottom;else if("bottom"===v)t=_(this.top),d=e.top,h=_(e.bottom)-D,r=t+D,l=this.top+b;else if("left"===v)t=_(this.right),a=this.right-b,o=t-D,c=_(e.left)+D,u=e.right;else if("right"===v)t=_(this.left),c=e.left,u=_(e.right)-D,a=t+D,o=this.left+b;else if("x"===g){if("center"===v)t=_((e.top+e.bottom)/2+.5);else if($(v)){var w=Object.keys(v)[0],I=v[w];t=_(this.chart.scales[w].getPixelForValue(I))}d=e.top,h=e.bottom,l=(r=t+D)+b}else if("y"===g){if("center"===v)t=_((e.left+e.right)/2);else if($(v)){var N=Object.keys(v)[0],M=v[N];t=_(this.chart.scales[N].getPixelForValue(M))}o=(a=t-D)-b,c=e.left,u=e.right}var C=J(f.ticks.maxTicksLimit,P),L=Math.max(1,Math.ceil(P/C));for(n=0;n<P;n+=L){var O=this.getContext(n),T=m.setContext(O),R=x.setContext(O),U=T.lineWidth,F=T.color,E=R.dash||[],z=R.dashOffset,B=T.tickWidth,H=T.tickColor,q=T.tickBorderDash||[],Y=T.tickBorderDashOffset;void 0!==(i=ds(this,n,A))&&(s=yt(p,i,U),y?a=o=c=u=s:r=l=d=h=s,j.push({tx1:a,ty1:r,tx2:o,ty2:l,x1:c,y1:d,x2:u,y2:h,width:U,color:F,borderDash:E,borderDashOffset:z,tickWidth:B,tickColor:H,tickBorderDash:q,tickBorderDashOffset:Y}))}return this._ticksLength=P,this._borderValue=t,j}},{key:"_computeLabelItems",value:function(e){var t,n,i,s,a,r,o,l,c,d,u,h=this.axis,g=this.options,p=g.position,f=g.ticks,m=this.isHorizontal(),v=this.ticks,x=f.align,A=f.crossAlign,y=f.padding,P=f.mirror,b=us(g.grid),j=b+y,S=P?-y:j,k=-Me(this.labelRotation),D=[],_="middle";if("top"===p)a=this.bottom-S,r=this._getXAxisLabelAlignment();else if("bottom"===p)a=this.top+S,r=this._getXAxisLabelAlignment();else if("left"===p){var w=this._getYAxisLabelAlignment(b);r=w.textAlign,s=w.x}else if("right"===p){var I=this._getYAxisLabelAlignment(b);r=I.textAlign,s=I.x}else if("x"===h){if("center"===p)a=(e.top+e.bottom)/2+j;else if($(p)){var N=Object.keys(p)[0],M=p[N];a=this.chart.scales[N].getPixelForValue(M)+j}r=this._getXAxisLabelAlignment()}else if("y"===h){if("center"===p)s=(e.left+e.right)/2-j;else if($(p)){var C=Object.keys(p)[0],L=p[C];s=this.chart.scales[C].getPixelForValue(L)}r=this._getYAxisLabelAlignment(b).textAlign}"y"===h&&("start"===x?_="top":"end"===x&&(_="bottom"));var O=this._getLabelSizes();for(t=0,n=v.length;t<n;++t){i=v[t].label;var T=f.setContext(this.getContext(t));o=this.getPixelForTick(t)+f.labelOffset,c=(l=this._resolveTickFontOptions(t)).lineHeight;var R=(d=K(i)?i.length:1)/2,U=T.color,F=T.textStrokeColor,E=T.textStrokeWidth,z=r;m?(s=o,"inner"===r&&(z=t===n-1?this.options.reverse?"left":"right":0===t?this.options.reverse?"right":"left":"center"),u="top"===p?"near"===A||0!==k?-d*c+c/2:"center"===A?-O.highest.height/2-R*c+c:-O.highest.height+c/2:"near"===A||0!==k?c/2:"center"===A?O.highest.height/2-R*c:O.highest.height-d*c,P&&(u*=-1),0===k||T.showLabelBackdrop||(s+=c/2*Math.sin(k))):(a=o,u=(1-d)*c/2);var B=void 0;if(T.showLabelBackdrop){var H=Et(T.backdropPadding),q=O.heights[t],Y=O.widths[t],V=u-H.top,G=0-H.left;switch(_){case"middle":V-=q/2;break;case"bottom":V-=q}switch(r){case"center":G-=Y/2;break;case"right":G-=Y;break;case"inner":t===n-1?G-=Y:t>0&&(G-=Y/2)}B={left:G,top:V,width:Y+H.width,height:q+H.height,color:T.backdropColor}}D.push({label:i,font:l,textOffset:u,options:{rotation:k,color:U,strokeColor:F,strokeWidth:E,textAlign:z,textBaseline:_,translation:[s,a],backdrop:B}})}return D}},{key:"_getXAxisLabelAlignment",value:function(){var e=this.options,t=e.position,n=e.ticks;if(-Me(this.labelRotation))return"top"===t?"left":"right";var i="center";return"start"===n.align?i="left":"end"===n.align?i="right":"inner"===n.align&&(i="inner"),i}},{key:"_getYAxisLabelAlignment",value:function(e){var t,n,i=this.options,s=i.position,a=i.ticks,r=a.crossAlign,o=a.mirror,l=a.padding,c=e+l,d=this._getLabelSizes().widest.width;return"left"===s?o?(n=this.right+l,"near"===r?t="left":"center"===r?(t="center",n+=d/2):(t="right",n+=d)):(n=this.right-c,"near"===r?t="right":"center"===r?(t="center",n-=d/2):(t="left",n=this.left)):"right"===s?o?(n=this.left+l,"near"===r?t="right":"center"===r?(t="center",n-=d/2):(t="left",n-=d)):(n=this.left+c,"near"===r?t="left":"center"===r?(t="center",n+=d/2):(t="right",n=this.right)):t="right",{textAlign:t,x:n}}},{key:"_computeLabelArea",value:function(){if(!this.options.ticks.mirror){var e=this.chart,t=this.options.position;return"left"===t||"right"===t?{top:0,left:this.left,bottom:e.height,right:this.right}:"top"===t||"bottom"===t?{top:this.top,left:0,bottom:this.bottom,right:e.width}:void 0}}},{key:"drawBackground",value:function(){var e=this.ctx,t=this.options.backgroundColor,n=this.left,i=this.top,s=this.width,a=this.height;t&&(e.save(),e.fillStyle=t,e.fillRect(n,i,s,a),e.restore())}},{key:"getLineWidthForValue",value:function(e){var t=this.options.grid;if(!this._isVisible()||!t.display)return 0;var n=this.ticks.findIndex((function(t){return t.value===e}));return n>=0?t.setContext(this.getContext(n)).lineWidth:0}},{key:"drawGrid",value:function(e){var t,n,i=this.options.grid,s=this.ctx,a=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e)),r=function(e,t,n){n.width&&n.color&&(s.save(),s.lineWidth=n.width,s.strokeStyle=n.color,s.setLineDash(n.borderDash||[]),s.lineDashOffset=n.borderDashOffset,s.beginPath(),s.moveTo(e.x,e.y),s.lineTo(t.x,t.y),s.stroke(),s.restore())};if(i.display)for(t=0,n=a.length;t<n;++t){var o=a[t];i.drawOnChartArea&&r({x:o.x1,y:o.y1},{x:o.x2,y:o.y2},o),i.drawTicks&&r({x:o.tx1,y:o.ty1},{x:o.tx2,y:o.ty2},{color:o.tickColor,width:o.tickWidth,borderDash:o.tickBorderDash,borderDashOffset:o.tickBorderDashOffset})}}},{key:"drawBorder",value:function(){var e=this.chart,t=this.ctx,n=this.options,i=n.border,s=n.grid,a=i.setContext(this.getContext()),r=i.display?a.width:0;if(r){var o,l,c,d,u=s.setContext(this.getContext(0)).lineWidth,h=this._borderValue;this.isHorizontal()?(o=yt(e,this.left,r)-r/2,l=yt(e,this.right,u)+u/2,c=d=h):(c=yt(e,this.top,r)-r/2,d=yt(e,this.bottom,u)+u/2,o=l=h),t.save(),t.lineWidth=a.width,t.strokeStyle=a.color,t.beginPath(),t.moveTo(o,c),t.lineTo(l,d),t.stroke(),t.restore()}}},{key:"drawLabels",value:function(e){if(this.options.ticks.display){var t=this.ctx,n=this._computeLabelArea();n&&kt(t,n);var i,s=this.getLabelItems(e),a=(0,l.default)(s);try{for(a.s();!(i=a.n()).done;){var r=i.value,o=r.options,c=r.font;Mt(t,r.label,0,r.textOffset,c,o)}}catch(d){a.e(d)}finally{a.f()}n&&Dt(t)}}},{key:"drawTitle",value:function(){var e=this.ctx,t=this.options,n=t.position,i=t.title,s=t.reverse;if(i.display){var a=zt(i.font),r=Et(i.padding),o=i.align,l=a.lineHeight/2;"bottom"===n||"center"===n||$(n)?(l+=r.bottom,K(i.text)&&(l+=a.lineHeight*(i.text.length-1))):l+=r.top;var c=function(e,t,n,i){var s,a,r,o=e.top,l=e.left,c=e.bottom,d=e.right,u=e.chart,h=u.chartArea,g=u.scales,p=0,f=c-o,m=d-l;if(e.isHorizontal()){if(a=$e(i,l,d),$(n)){var v=Object.keys(n)[0],x=n[v];r=g[v].getPixelForValue(x)+f-t}else r="center"===n?(h.bottom+h.top)/2+f-t:os(e,n,t);s=d-l}else{if($(n)){var A=Object.keys(n)[0],y=n[A];a=g[A].getPixelForValue(y)-m+t}else a="center"===n?(h.left+h.right)/2-m+t:os(e,n,t);r=$e(i,c,o),p="left"===n?-be:be}return{titleX:a,titleY:r,maxWidth:s,rotation:p}}(this,l,n,o),d=c.titleX,u=c.titleY,h=c.maxWidth,g=c.rotation;Mt(e,i.text,0,0,a,{color:i.color,maxWidth:h,rotation:g,textAlign:gs(o,n,s),textBaseline:"middle",translation:[d,u]})}}},{key:"draw",value:function(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}},{key:"_layers",value:function(){var e=this,n=this.options,i=n.ticks&&n.ticks.z||0,s=J(n.grid&&n.grid.z,-1),a=J(n.border&&n.border.z,0);return this._isVisible()&&this.draw===t.prototype.draw?[{z:s,draw:function(t){e.drawBackground(),e.drawGrid(t),e.drawTitle()}},{z:a,draw:function(){e.drawBorder()}},{z:i,draw:function(t){e.drawLabels(t)}}]:[{z:i,draw:function(t){e.draw(t)}}]}},{key:"getMatchingVisibleMetas",value:function(e){var t,n,i=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",a=[];for(t=0,n=i.length;t<n;++t){var r=i[t];r[s]!==this.id||e&&r.type!==e||a.push(r)}return a}},{key:"_resolveTickFontOptions",value:function(e){return zt(this.options.ticks.setContext(this.getContext(e)).font)}},{key:"_maxDigits",value:function(){var e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}])}(ss),fs=function(){return(0,h.default)((function e(t,n,i){(0,u.default)(this,e),this.type=t,this.scope=n,this.override=i,this.items=Object.create(null)}),[{key:"isForType",value:function(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}},{key:"register",value:function(e){var t,n=Object.getPrototypeOf(e);(function(e){return"id"in e&&"defaults"in e})(n)&&(t=this.register(n));var i=this.items,s=e.id,a=this.scope+"."+s;if(!s)throw new Error("class does not have id: "+e);return s in i||(i[s]=e,function(e,t,n){var i=oe(Object.create(null),[n?vt.get(n):{},vt.get(t),e.defaults]);vt.set(t,i),e.defaultRoutes&&function(e,t){Object.keys(t).forEach((function(n){var i=n.split("."),s=i.pop(),a=[e].concat(i).join("."),r=t[n].split("."),o=r.pop(),l=r.join(".");vt.route(a,s,l,o)}))}(t,e.defaultRoutes);e.descriptors&&vt.describe(t,e.descriptors)}(e,a,t),this.override&&vt.override(e.id,e.overrides)),a}},{key:"get",value:function(e){return this.items[e]}},{key:"unregister",value:function(e){var t=this.items,n=e.id,i=this.scope;n in t&&delete t[n],i&&n in vt[i]&&(delete vt[i][n],this.override&&delete ht[n])}}])}();var ms=function(){return(0,h.default)((function e(){(0,u.default)(this,e),this.controllers=new fs(Jn,"datasets",!0),this.elements=new fs(ss,"elements"),this.plugins=new fs(Object,"plugins"),this.scales=new fs(ps,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}),[{key:"add",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t)}},{key:"remove",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t)}},{key:"addControllers",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.controllers)}},{key:"addElements",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.elements)}},{key:"addPlugins",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.plugins)}},{key:"addScales",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.scales)}},{key:"getController",value:function(e){return this._get(e,this.controllers,"controller")}},{key:"getElement",value:function(e){return this._get(e,this.elements,"element")}},{key:"getPlugin",value:function(e){return this._get(e,this.plugins,"plugin")}},{key:"getScale",value:function(e){return this._get(e,this.scales,"scale")}},{key:"removeControllers",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.controllers)}},{key:"removeElements",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.elements)}},{key:"removePlugins",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.plugins)}},{key:"removeScales",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.scales)}},{key:"_each",value:function(e,t,n){var i=this;(0,d.default)(t).forEach((function(t){var s=n||i._getRegistryForType(t);n||s.isForType(t)||s===i.plugins&&t.id?i._exec(e,s,t):ne(t,(function(t){var s=n||i._getRegistryForType(t);i._exec(e,s,t)}))}))}},{key:"_exec",value:function(e,t,n){var i=ge(e);te(n["before"+i],[],n),t[e](n),te(n["after"+i],[],n)}},{key:"_getRegistryForType",value:function(e){for(var t=0;t<this._typedRegistries.length;t++){var n=this._typedRegistries[t];if(n.isForType(e))return n}return this.plugins}},{key:"_get",value:function(e,t,n){var i=t.get(e);if(void 0===i)throw new Error('"'+e+'" is not a registered '+n+".");return i}}])}(),vs=new ms,xs=function(){return(0,h.default)((function e(){(0,u.default)(this,e),this._init=[]}),[{key:"notify",value:function(e,t,n,i){"beforeInit"===t&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));var s=i?this._descriptors(e).filter(i):this._descriptors(e),a=this._notify(s,e,t,n);return"afterDestroy"===t&&(this._notify(s,e,"stop"),this._notify(this._init,e,"uninstall")),a}},{key:"_notify",value:function(e,t,n,i){i=i||{};var s,a=(0,l.default)(e);try{for(a.s();!(s=a.n()).done;){var r=s.value,o=r.plugin;if(!1===te(o[n],[t,i,r.options],o)&&i.cancelable)return!1}}catch(c){a.e(c)}finally{a.f()}return!0}},{key:"invalidate",value:function(){Q(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}},{key:"_descriptors",value:function(e){if(this._cache)return this._cache;var t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}},{key:"_createDescriptors",value:function(e,t){var n=e&&e.config,i=J(n.options&&n.options.plugins,{}),s=function(e){for(var t={},n=[],i=Object.keys(vs.plugins.items),s=0;s<i.length;s++)n.push(vs.getPlugin(i[s]));for(var a=e.plugins||[],r=0;r<a.length;r++){var o=a[r];-1===n.indexOf(o)&&(n.push(o),t[o.id]=!0)}return{plugins:n,localIds:t}}(n);return!1!==i||t?function(e,t,n,i){var s,a=t.plugins,r=t.localIds,o=[],c=e.getContext(),d=(0,l.default)(a);try{for(d.s();!(s=d.n()).done;){var u=s.value,h=u.id,g=As(n[h],i);null!==g&&o.push({plugin:u,options:ys(e.config,{plugin:u,local:r[h]},g,c)})}}catch(p){d.e(p)}finally{d.f()}return o}(e,s,i,t):[]}},{key:"_notifyStateChanges",value:function(e){var t=this._oldCache||[],n=this._cache,i=function(e,t){return e.filter((function(e){return!t.some((function(t){return e.plugin.id===t.plugin.id}))}))};this._notify(i(t,n),e,"stop"),this._notify(i(n,t),e,"start")}}])}();function As(e,t){return t||!1!==e?!0===e?{}:e:null}function ys(e,t,n,i){var s=t.plugin,a=t.local,r=e.pluginScopeKeys(s),o=e.getOptionScopes(n,r);return a&&s.defaults&&o.push(s.defaults),e.createResolver(o,i,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Ps(e,t){var n=vt.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||n.indexAxis||"x"}function bs(e){if("x"===e||"y"===e||"r"===e)return e}function js(e){if(bs(e))return e;for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(var s=0,a=n;s<a.length;s++){var r=a[s],o=r.axis||("top"===(l=r.position)||"bottom"===l?"x":"left"===l||"right"===l?"y":void 0)||e.length>1&&bs(e[0].toLowerCase());if(o)return o}var l;throw new Error("Cannot determine type of '".concat(e,"' axis. Please provide 'axis' or 'position' option."))}function Ss(e,t,n){if(n[t+"AxisID"]===e)return{axis:t}}function ks(e,t){var n=ht[e.type]||{scales:{}},i=t.scales||{},s=Ps(e.type,t),a=Object.create(null);return Object.keys(i).forEach((function(t){var r=i[t];if(!$(r))return console.error("Invalid scale configuration for scale: ".concat(t));if(r._proxy)return console.warn("Ignoring resolver passed as options for scale: ".concat(t));var o=js(t,r,function(e,t){if(t.data&&t.data.datasets){var n=t.data.datasets.filter((function(t){return t.xAxisID===e||t.yAxisID===e}));if(n.length)return Ss(e,"x",n[0])||Ss(e,"y",n[0])}return{}}(t,e),vt.scales[r.type]),l=function(e,t){return e===t?"_index_":"_value_"}(o,s),c=n.scales||{};a[t]=le(Object.create(null),[{axis:o},r,c[o],c[l]])})),e.data.datasets.forEach((function(n){var s=n.type||e.type,r=n.indexAxis||Ps(s,t),o=(ht[s]||{}).scales||{};Object.keys(o).forEach((function(e){var t=function(e,t){var n=e;return"_index_"===e?n=t:"_value_"===e&&(n="x"===t?"y":"x"),n}(e,r),s=n[t+"AxisID"]||t;a[s]=a[s]||Object.create(null),le(a[s],[{axis:t},i[s],o[e]])}))})),Object.keys(a).forEach((function(e){var t=a[e];le(t,[vt.scales[t.type],vt.scale])})),a}function Ds(e){var t=e.options||(e.options={});t.plugins=J(t.plugins,{}),t.scales=ks(e,t)}function _s(e){return(e=e||{}).datasets=e.datasets||[],e.labels=e.labels||[],e}var ws=new Map,Is=new Set;function Ns(e,t){var n=ws.get(e);return n||(n=t(),ws.set(e,n),Is.add(n)),n}var Ms=function(e,t,n){var i=he(t,n);void 0!==i&&e.add(i)},Cs=function(){return(0,h.default)((function e(t){(0,u.default)(this,e),this._config=function(e){return(e=e||{}).data=_s(e.data),Ds(e),e}(t),this._scopeCache=new Map,this._resolverCache=new Map}),[{key:"platform",get:function(){return this._config.platform}},{key:"type",get:function(){return this._config.type},set:function(e){this._config.type=e}},{key:"data",get:function(){return this._config.data},set:function(e){this._config.data=_s(e)}},{key:"options",get:function(){return this._config.options},set:function(e){this._config.options=e}},{key:"plugins",get:function(){return this._config.plugins}},{key:"update",value:function(){var e=this._config;this.clearCache(),Ds(e)}},{key:"clearCache",value:function(){this._scopeCache.clear(),this._resolverCache.clear()}},{key:"datasetScopeKeys",value:function(e){return Ns(e,(function(){return[["datasets.".concat(e),""]]}))}},{key:"datasetAnimationScopeKeys",value:function(e,t){return Ns("".concat(e,".transition.").concat(t),(function(){return[["datasets.".concat(e,".transitions.").concat(t),"transitions.".concat(t)],["datasets.".concat(e),""]]}))}},{key:"datasetElementScopeKeys",value:function(e,t){return Ns("".concat(e,"-").concat(t),(function(){return[["datasets.".concat(e,".elements.").concat(t),"datasets.".concat(e),"elements.".concat(t),""]]}))}},{key:"pluginScopeKeys",value:function(e){var t=e.id,n=this.type;return Ns("".concat(n,"-plugin-").concat(t),(function(){return[["plugins.".concat(t)].concat((0,d.default)(e.additionalOptionScopes||[]))]}))}},{key:"_cachedScopes",value:function(e,t){var n=this._scopeCache,i=n.get(e);return i&&!t||(i=new Map,n.set(e,i)),i}},{key:"getOptionScopes",value:function(e,t,n){var i=this.options,s=this.type,a=this._cachedScopes(e,n),r=a.get(t);if(r)return r;var o=new Set;t.forEach((function(t){e&&(o.add(e),t.forEach((function(t){return Ms(o,e,t)}))),t.forEach((function(e){return Ms(o,i,e)})),t.forEach((function(e){return Ms(o,ht[s]||{},e)})),t.forEach((function(e){return Ms(o,vt,e)})),t.forEach((function(e){return Ms(o,gt,e)}))}));var l=Array.from(o);return 0===l.length&&l.push(Object.create(null)),Is.has(t)&&a.set(t,l),l}},{key:"chartOptionScopes",value:function(){var e=this.options,t=this.type;return[e,ht[t]||{},vt.datasets[t]||{},{type:t},vt,gt]}},{key:"resolveNamedOptions",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[""],s={$shared:!0},a=Ls(this._resolverCache,e,i),r=a.resolver,o=a.subPrefixes,c=r;(function(e,t){var n,i=Vt(e),s=i.isScriptable,a=i.isIndexable,r=(0,l.default)(t);try{for(r.s();!(n=r.n()).done;){var o=n.value,c=s(o),d=a(o),u=(d||c)&&e[o];if(c&&(fe(u)||Os(u))||d&&K(u))return!0}}catch(h){r.e(h)}finally{r.f()}return!1})(r,t)&&(s.$shared=!1,c=Yt(r,n=fe(n)?n():n,this.createResolver(e,n,o)));var d,u=(0,l.default)(t);try{for(u.s();!(d=u.n()).done;){var h=d.value;s[h]=c[h]}}catch(g){u.e(g)}finally{u.f()}return s}},{key:"createResolver",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[""],i=arguments.length>3?arguments[3]:void 0,s=Ls(this._resolverCache,e,n).resolver;return $(t)?Yt(s,t,void 0,i):s}}])}();function Ls(e,t,n){var i=e.get(t);i||(i=new Map,e.set(t,i));var s=n.join(),a=i.get(s);a||(a={resolver:qt(t,n),subPrefixes:n.filter((function(e){return!e.toLowerCase().includes("hover")}))},i.set(s,a));return a}var Os=function(e){return $(e)&&Object.getOwnPropertyNames(e).some((function(t){return fe(e[t])}))};var Ts=["top","bottom","left","right","chartArea"];function Rs(e,t){return"top"===e||"bottom"===e||-1===Ts.indexOf(e)&&"x"===t}function Us(e,t){return function(n,i){return n[e]===i[e]?n[t]-i[t]:n[e]-i[e]}}function Fs(e){var t=e.chart,n=t.options.animation;t.notifyPlugins("afterRender"),te(n&&n.onComplete,[e],t)}function Es(e){var t=e.chart,n=t.options.animation;te(n&&n.onProgress,[e],t)}function zs(e){return un()&&"string"===typeof e?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}var Bs={},Hs=function(e){var t=zs(e);return Object.values(Bs).filter((function(e){return e.canvas===t})).pop()};function qs(e,t,n){for(var i=0,s=Object.keys(e);i<s.length;i++){var a=s[i],r=+a;if(r>=t){var o=e[a];delete e[a],(n>0||r>t)&&(e[r+n]=o)}}}function Ys(e,t,n){return e.options.clip?e[n]:t[n]}var Vs=function(){return(0,h.default)((function e(t,n){var i=this;(0,u.default)(this,e);var s=this.config=new Cs(n),a=zs(t),r=Hs(a);if(r)throw new Error("Canvas is already in use. Chart with ID '"+r.id+"' must be destroyed before the canvas with ID '"+r.canvas.id+"' can be reused.");var o=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||function(e){return!un()||"undefined"!==typeof OffscreenCanvas&&e instanceof OffscreenCanvas?Hi:is}(a)),this.platform.updateConfig(s);var l=this.platform.acquireContext(a,o.aspectRatio),c=l&&l.canvas,d=c&&c.height,h=c&&c.width;this.id=W(),this.ctx=l,this.canvas=c,this.width=h,this.height=d,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new xs,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=function(e,t){var n;return function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return t?(clearTimeout(n),n=setTimeout(e,t,s)):e.apply(this,s),t}}((function(e){return i.update(e)}),o.resizeDelay||0),this._dataChanges=[],Bs[this.id]=this,l&&c?(Un.listen(this,"complete",Fs),Un.listen(this,"progress",Es),this._initialize(),this.attached&&this.update()):console.error("Failed to create chart: can't acquire context from the given item")}),[{key:"aspectRatio",get:function(){var e=this.options,t=e.aspectRatio,n=e.maintainAspectRatio,i=this.width,s=this.height,a=this._aspectRatio;return Q(t)?n&&a?a:s?i/s:null:t}},{key:"data",get:function(){return this.config.data},set:function(e){this.config.data=e}},{key:"options",get:function(){return this._options},set:function(e){this.config.options=e}},{key:"registry",get:function(){return vs}},{key:"_initialize",value:function(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():yn(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}},{key:"clear",value:function(){return Pt(this.canvas,this.ctx),this}},{key:"stop",value:function(){return Un.stop(this),this}},{key:"resize",value:function(e,t){Un.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}},{key:"_resize",value:function(e,t){var n=this.options,i=this.canvas,s=n.maintainAspectRatio&&this.aspectRatio,a=this.platform.getMaximumSize(i,e,t,s),r=n.devicePixelRatio||this.platform.getDevicePixelRatio(),o=this.width?"resize":"attach";this.width=a.width,this.height=a.height,this._aspectRatio=this.aspectRatio,yn(this,r,!0)&&(this.notifyPlugins("resize",{size:a}),te(n.onResize,[this,a],this),this.attached&&this._doResize(o)&&this.render())}},{key:"ensureScalesHaveIDs",value:function(){ne(this.options.scales||{},(function(e,t){e.id=t}))}},{key:"buildOrUpdateScales",value:function(){var e=this,t=this.options,n=t.scales,i=this.scales,s=Object.keys(i).reduce((function(e,t){return e[t]=!1,e}),{}),a=[];n&&(a=a.concat(Object.keys(n).map((function(e){var t=n[e],i=js(e,t),s="r"===i,a="x"===i;return{options:t,dposition:s?"chartArea":a?"bottom":"left",dtype:s?"radialLinear":a?"category":"linear"}})))),ne(a,(function(n){var a=n.options,r=a.id,o=js(r,a),l=J(a.type,n.dtype);void 0!==a.position&&Rs(a.position,o)===Rs(n.dposition)||(a.position=n.dposition),s[r]=!0;var c=null;r in i&&i[r].type===l?c=i[r]:(c=new(vs.getScale(l))({id:r,type:l,ctx:e.ctx,chart:e}),i[c.id]=c);c.init(a,t)})),ne(s,(function(e,t){e||delete i[t]})),ne(i,(function(t){Ei(e,t,t.options),Ui(e,t)}))}},{key:"_updateMetasets",value:function(){var e=this._metasets,t=this.data.datasets.length,n=e.length;if(e.sort((function(e,t){return e.index-t.index})),n>t){for(var i=t;i<n;++i)this._destroyDatasetMeta(i);e.splice(t,n-t)}this._sortedMetasets=e.slice(0).sort(Us("order","index"))}},{key:"_removeUnreferencedMetasets",value:function(){var e=this,t=this._metasets,n=this.data.datasets;t.length>n.length&&delete this._stacks,t.forEach((function(t,i){0===n.filter((function(e){return e===t._dataset})).length&&e._destroyDatasetMeta(i)}))}},{key:"buildOrUpdateControllers",value:function(){var e,t,n=[],i=this.data.datasets;for(this._removeUnreferencedMetasets(),e=0,t=i.length;e<t;e++){var s=i[e],a=this.getDatasetMeta(e),r=s.type||this.config.type;if(a.type&&a.type!==r&&(this._destroyDatasetMeta(e),a=this.getDatasetMeta(e)),a.type=r,a.indexAxis=s.indexAxis||Ps(r,this.options),a.order=s.order||0,a.index=e,a.label=""+s.label,a.visible=this.isDatasetVisible(e),a.controller)a.controller.updateIndex(e),a.controller.linkScales();else{var o=vs.getController(r),l=vt.datasets[r],c=l.datasetElementType,d=l.dataElementType;Object.assign(o,{dataElementType:vs.getElement(d),datasetElementType:c&&vs.getElement(c)}),a.controller=new o(this,e),n.push(a.controller)}}return this._updateMetasets(),n}},{key:"_resetElements",value:function(){var e=this;ne(this.data.datasets,(function(t,n){e.getDatasetMeta(n).controller.reset()}),this)}},{key:"reset",value:function(){this._resetElements(),this.notifyPlugins("reset")}},{key:"update",value:function(e){var t=this.config;t.update();var n=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),i=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1!==this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})){var s=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");for(var a=0,r=0,o=this.data.datasets.length;r<o;r++){var l=this.getDatasetMeta(r).controller,c=!i&&-1===s.indexOf(l);l.buildOrUpdateElements(c),a=Math.max(+l.getMaxOverflow(),a)}a=this._minPadding=n.layout.autoPadding?a:0,this._updateLayout(a),i||ne(s,(function(e){e.reset()})),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(Us("z","_idx"));var d=this._active,u=this._lastEvent;u?this._eventHandler(u,!0):d.length&&this._updateHoverStyles(d,d,!0),this.render()}}},{key:"_updateScales",value:function(){var e=this;ne(this.scales,(function(t){Fi(e,t)})),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}},{key:"_checkEventBindings",value:function(){var e=this.options,t=new Set(Object.keys(this._listeners)),n=new Set(e.events);me(t,n)&&!!this._responsiveListeners===e.responsive||(this.unbindEvents(),this.bindEvents())}},{key:"_updateHiddenIndices",value:function(){var e,t=this._hiddenIndices,n=this._getUniformDataChanges()||[],i=(0,l.default)(n);try{for(i.s();!(e=i.n()).done;){var s=e.value,a=s.method,r=s.start,o=s.count;qs(t,r,"_removeElements"===a?-o:o)}}catch(c){i.e(c)}finally{i.f()}}},{key:"_getUniformDataChanges",value:function(){var e=this._dataChanges;if(e&&e.length){this._dataChanges=[];for(var t=this.data.datasets.length,n=function(t){return new Set(e.filter((function(e){return e[0]===t})).map((function(e,t){return t+","+e.splice(1).join(",")})))},i=n(0),s=1;s<t;s++)if(!me(i,n(s)))return;return Array.from(i).map((function(e){return e.split(",")})).map((function(e){return{method:e[1],start:+e[2],count:+e[3]}}))}}},{key:"_updateLayout",value:function(e){var t=this;if(!1!==this.notifyPlugins("beforeLayout",{cancelable:!0})){zi(this,this.width,this.height,e);var n=this.chartArea,i=n.width<=0||n.height<=0;this._layers=[],ne(this.boxes,(function(e){var n;i&&"chartArea"===e.position||(e.configure&&e.configure(),(n=t._layers).push.apply(n,(0,d.default)(e._layers())))}),this),this._layers.forEach((function(e,t){e._idx=t})),this.notifyPlugins("afterLayout")}}},{key:"_updateDatasets",value:function(e){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})){for(var t=0,n=this.data.datasets.length;t<n;++t)this.getDatasetMeta(t).controller.configure();for(var i=0,s=this.data.datasets.length;i<s;++i)this._updateDataset(i,fe(e)?e({datasetIndex:i}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}},{key:"_updateDataset",value:function(e,t){var n=this.getDatasetMeta(e),i={meta:n,index:e,mode:t,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",i)&&(n.controller._update(t),i.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",i))}},{key:"render",value:function(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(Un.has(this)?this.attached&&!Un.running(this)&&Un.start(this):(this.draw(),Fs({chart:this})))}},{key:"draw",value:function(){var e;if(this._resizeBeforeDraw){var t=this._resizeBeforeDraw,n=t.width,i=t.height;this._resizeBeforeDraw=null,this._resize(n,i)}if(this.clear(),!(this.width<=0||this.height<=0)&&!1!==this.notifyPlugins("beforeDraw",{cancelable:!0})){var s=this._layers;for(e=0;e<s.length&&s[e].z<=0;++e)s[e].draw(this.chartArea);for(this._drawDatasets();e<s.length;++e)s[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}}},{key:"_getSortedDatasetMetas",value:function(e){var t,n,i=this._sortedMetasets,s=[];for(t=0,n=i.length;t<n;++t){var a=i[t];e&&!a.visible||s.push(a)}return s}},{key:"getSortedVisibleDatasetMetas",value:function(){return this._getSortedDatasetMetas(!0)}},{key:"_drawDatasets",value:function(){if(!1!==this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})){for(var e=this.getSortedVisibleDatasetMetas(),t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}}},{key:"_drawDataset",value:function(e){var t=this.ctx,n=e._clip,i=!n.disabled,s=function(e,t){var n=e.xScale,i=e.yScale;return n&&i?{left:Ys(n,t,"left"),right:Ys(n,t,"right"),top:Ys(i,t,"top"),bottom:Ys(i,t,"bottom")}:t}(e,this.chartArea),a={meta:e,index:e.index,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetDraw",a)&&(i&&kt(t,{left:!1===n.left?0:s.left-n.left,right:!1===n.right?this.width:s.right+n.right,top:!1===n.top?0:s.top-n.top,bottom:!1===n.bottom?this.height:s.bottom+n.bottom}),e.controller.draw(),i&&Dt(t),a.cancelable=!1,this.notifyPlugins("afterDatasetDraw",a))}},{key:"isPointInArea",value:function(e){return St(e,this.chartArea,this._minPadding)}},{key:"getElementsAtEventForMode",value:function(e,t,n,i){var s=Si.modes[t];return"function"===typeof s?s(this,e,n,i):[]}},{key:"getDatasetMeta",value:function(e){var t=this.data.datasets[e],n=this._metasets,i=n.filter((function(e){return e&&e._dataset===t})).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},n.push(i)),i}},{key:"getContext",value:function(){return this.$context||(this.$context=Ht(null,{chart:this,type:"chart"}))}},{key:"getVisibleDatasetCount",value:function(){return this.getSortedVisibleDatasetMetas().length}},{key:"isDatasetVisible",value:function(e){var t=this.data.datasets[e];if(!t)return!1;var n=this.getDatasetMeta(e);return"boolean"===typeof n.hidden?!n.hidden:!t.hidden}},{key:"setDatasetVisibility",value:function(e,t){this.getDatasetMeta(e).hidden=!t}},{key:"toggleDataVisibility",value:function(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}},{key:"getDataVisibility",value:function(e){return!this._hiddenIndices[e]}},{key:"_updateVisibility",value:function(e,t,n){var i=n?"show":"hide",s=this.getDatasetMeta(e),a=s.controller._resolveAnimations(void 0,i);pe(t)?(s.data[t].hidden=!n,this.update()):(this.setDatasetVisibility(e,n),a.update(s,{visible:n}),this.update((function(t){return t.datasetIndex===e?i:void 0})))}},{key:"hide",value:function(e,t){this._updateVisibility(e,t,!1)}},{key:"show",value:function(e,t){this._updateVisibility(e,t,!0)}},{key:"_destroyDatasetMeta",value:function(e){var t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}},{key:"_stop",value:function(){var e,t;for(this.stop(),Un.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}},{key:"destroy",value:function(){this.notifyPlugins("beforeDestroy");var e=this.canvas,t=this.ctx;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),Pt(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete Bs[this.id],this.notifyPlugins("afterDestroy")}},{key:"toBase64Image",value:function(){var e;return(e=this.canvas).toDataURL.apply(e,arguments)}},{key:"bindEvents",value:function(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}},{key:"bindUserEvents",value:function(){var e=this,t=this._listeners,n=this.platform,i=function(t,n,i){t.offsetX=n,t.offsetY=i,e._eventHandler(t)};ne(this.options.events,(function(s){return function(i,s){n.addEventListener(e,i,s),t[i]=s}(s,i)}))}},{key:"bindResponsiveEvents",value:function(){var e=this;this._responsiveListeners||(this._responsiveListeners={});var t,n=this._responsiveListeners,i=this.platform,s=function(t,s){i.addEventListener(e,t,s),n[t]=s},a=function(t,s){n[t]&&(i.removeEventListener(e,t,s),delete n[t])},r=function(t,n){e.canvas&&e.resize(t,n)},o=function(){a("attach",o),e.attached=!0,e.resize(),s("resize",r),s("detach",t)};t=function(){e.attached=!1,a("resize",r),e._stop(),e._resize(0,0),s("attach",o)},i.isAttached(this.canvas)?o():t()}},{key:"unbindEvents",value:function(){var e=this;ne(this._listeners,(function(t,n){e.platform.removeEventListener(e,n,t)})),this._listeners={},ne(this._responsiveListeners,(function(t,n){e.platform.removeEventListener(e,n,t)})),this._responsiveListeners=void 0}},{key:"updateHoverStyle",value:function(e,t,n){var i,s,a,r=n?"set":"remove";for("dataset"===t&&this.getDatasetMeta(e[0].datasetIndex).controller["_"+r+"DatasetHoverStyle"](),s=0,a=e.length;s<a;++s){var o=(i=e[s])&&this.getDatasetMeta(i.datasetIndex).controller;o&&o[r+"HoverStyle"](i.element,i.datasetIndex,i.index)}}},{key:"getActiveElements",value:function(){return this._active||[]}},{key:"setActiveElements",value:function(e){var t=this,n=this._active||[],i=e.map((function(e){var n=e.datasetIndex,i=e.index,s=t.getDatasetMeta(n);if(!s)throw new Error("No dataset found at index "+n);return{datasetIndex:n,element:s.data[i],index:i}}));!ie(i,n)&&(this._active=i,this._lastEvent=null,this._updateHoverStyles(i,n))}},{key:"notifyPlugins",value:function(e,t,n){return this._plugins.notify(this,e,t,n)}},{key:"isPluginEnabled",value:function(e){return 1===this._plugins._cache.filter((function(t){return t.plugin.id===e})).length}},{key:"_updateHoverStyles",value:function(e,t,n){var i=this.options.hover,s=function(e,t){return e.filter((function(e){return!t.some((function(t){return e.datasetIndex===t.datasetIndex&&e.index===t.index}))}))},a=s(t,e),r=n?e:s(e,t);a.length&&this.updateHoverStyle(a,i.mode,!1),r.length&&i.mode&&this.updateHoverStyle(r,i.mode,!0)}},{key:"_eventHandler",value:function(e,t){var n=this,i={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},s=function(t){return(t.options.events||n.options.events).includes(e.native.type)};if(!1!==this.notifyPlugins("beforeEvent",i,s)){var a=this._handleEvent(e,t,i.inChartArea);return i.cancelable=!1,this.notifyPlugins("afterEvent",i,s),(a||i.changed)&&this.render(),this}}},{key:"_handleEvent",value:function(e,t,n){var i=this._active,s=void 0===i?[]:i,a=this.options,r=t,o=this._getActiveElements(e,s,n,r),l=function(e){return"mouseup"===e.type||"click"===e.type||"contextmenu"===e.type}(e),c=function(e,t,n,i){return n&&"mouseout"!==e.type?i?t:e:null}(e,this._lastEvent,n,l);n&&(this._lastEvent=null,te(a.onHover,[e,o,this],this),l&&te(a.onClick,[e,o,this],this));var d=!ie(o,s);return(d||t)&&(this._active=o,this._updateHoverStyles(o,s,t)),this._lastEvent=c,d}},{key:"_getActiveElements",value:function(e,t,n,i){if("mouseout"===e.type)return[];if(!n)return t;var s=this.options.hover;return this.getElementsAtEventForMode(e,s.mode,s,i)}}],[{key:"register",value:function(){vs.add.apply(vs,arguments),Gs()}},{key:"unregister",value:function(){vs.remove.apply(vs,arguments),Gs()}}])}();function Gs(){return ne(Vs.instances,(function(e){return e._plugins.invalidate()}))}function Ws(e,t,n,i){var s=Rt(e.options.borderRadius,["outerStart","outerEnd","innerStart","innerEnd"]),a=(n-t)/2,r=Math.min(a,i*t/2),o=function(e){var t=(n-Math.min(a,e))*i/2;return Ee(e,0,Math.min(a,t))};return{outerStart:o(s.outerStart),outerEnd:o(s.outerEnd),innerStart:Ee(s.innerStart,0,r),innerEnd:Ee(s.innerEnd,0,r)}}function Qs(e,t,n,i){return{x:n+e*Math.cos(t),y:i+e*Math.sin(t)}}function Ks(e,t,n,i,s,a){var r=t.x,o=t.y,l=t.startAngle,c=t.pixelMargin,d=t.innerRadius,u=Math.max(t.outerRadius+i+n-c,0),h=d>0?d+i+n+c:0,g=0,p=s-l;if(i){var f=((d>0?d-i:0)+(u>0?u-i:0))/2;g=(p-(0!==f?p*f/(f+i):p))/2}var m=(p-Math.max(.001,p*u-n/ve)/u)/2,v=l+m+g,x=s-m-g,A=Ws(t,h,u,x-v),y=A.outerStart,P=A.outerEnd,b=A.innerStart,j=A.innerEnd,S=u-y,k=u-P,D=v+y/S,_=x-P/k,w=h+b,I=h+j,N=v+b/w,M=x-j/I;if(e.beginPath(),a){var C=(D+_)/2;if(e.arc(r,o,u,D,C),e.arc(r,o,u,C,_),P>0){var L=Qs(k,_,r,o);e.arc(L.x,L.y,P,_,x+be)}var O=Qs(I,x,r,o);if(e.lineTo(O.x,O.y),j>0){var T=Qs(I,M,r,o);e.arc(T.x,T.y,j,x+be,M+Math.PI)}var R=(x-j/h+(v+b/h))/2;if(e.arc(r,o,h,x-j/h,R,!0),e.arc(r,o,h,R,v+b/h,!0),b>0){var U=Qs(w,N,r,o);e.arc(U.x,U.y,b,N+Math.PI,v-be)}var F=Qs(S,v,r,o);if(e.lineTo(F.x,F.y),y>0){var E=Qs(S,D,r,o);e.arc(E.x,E.y,y,v-be,D)}}else{e.moveTo(r,o);var z=Math.cos(D)*u+r,B=Math.sin(D)*u+o;e.lineTo(z,B);var H=Math.cos(_)*u+r,q=Math.sin(_)*u+o;e.lineTo(H,q)}e.closePath()}function $s(e,t,n,i,s){var a=t.fullCircles,r=t.startAngle,o=t.circumference,l=t.options,c=l.borderWidth,d=l.borderJoinStyle,u=l.borderDash,h=l.borderDashOffset,g="inner"===l.borderAlign;if(c){e.setLineDash(u||[]),e.lineDashOffset=h,g?(e.lineWidth=2*c,e.lineJoin=d||"round"):(e.lineWidth=c,e.lineJoin=d||"bevel");var p=t.endAngle;if(a){Ks(e,t,n,i,p,s);for(var f=0;f<a;++f)e.stroke();isNaN(o)||(p=r+(o%xe||xe))}g&&function(e,t,n){var i=t.startAngle,s=t.pixelMargin,a=t.x,r=t.y,o=t.outerRadius,l=t.innerRadius,c=s/o;e.beginPath(),e.arc(a,r,o,i-c,n+c),l>s?(c=s/l,e.arc(a,r,l,n+c,i-c,!0)):e.arc(a,r,s,n+be,i-be),e.closePath(),e.clip()}(e,t,p),a||(Ks(e,t,n,i,p,s),e.stroke())}}(0,c.default)(Vs,"defaults",vt),(0,c.default)(Vs,"instances",Bs),(0,c.default)(Vs,"overrides",ht),(0,c.default)(Vs,"registry",vs),(0,c.default)(Vs,"version","4.4.7"),(0,c.default)(Vs,"getChart",Hs);var Xs=function(e){function t(e){var n;return(0,u.default)(this,t),n=(0,s.default)(this,t),(0,c.default)(n,"circumference",void 0),(0,c.default)(n,"endAngle",void 0),(0,c.default)(n,"fullCircles",void 0),(0,c.default)(n,"innerRadius",void 0),(0,c.default)(n,"outerRadius",void 0),(0,c.default)(n,"pixelMargin",void 0),(0,c.default)(n,"startAngle",void 0),n.options=void 0,n.circumference=void 0,n.startAngle=void 0,n.endAngle=void 0,n.innerRadius=void 0,n.outerRadius=void 0,n.pixelMargin=0,n.fullCircles=0,e&&Object.assign(n,e),n}return(0,r.default)(t,e),(0,h.default)(t,[{key:"inRange",value:function(e,t,n){var i=Oe(this.getProps(["x","y"],n),{x:e,y:t}),s=i.angle,a=i.distance,r=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],n),o=r.startAngle,l=r.endAngle,c=r.innerRadius,d=r.outerRadius,u=r.circumference,h=(this.options.spacing+this.options.borderWidth)/2,g=J(u,l-o),p=Fe(s,o,l)&&o!==l,f=g>=xe||p,m=ze(a,c+h,d+h);return f&&m}},{key:"getCenterPoint",value:function(e){var t=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),n=t.x,i=t.y,s=t.startAngle,a=t.endAngle,r=t.innerRadius,o=t.outerRadius,l=this.options,c=l.offset,d=(s+a)/2,u=(r+o+l.spacing+c)/2;return{x:n+Math.cos(d)*u,y:i+Math.sin(d)*u}}},{key:"tooltipPosition",value:function(e){return this.getCenterPoint(e)}},{key:"draw",value:function(e){var t=this.options,n=this.circumference,i=(t.offset||0)/4,s=(t.spacing||0)/2,a=t.circular;if(this.pixelMargin="inner"===t.borderAlign?.33:0,this.fullCircles=n>xe?Math.floor(n/xe):0,!(0===n||this.innerRadius<0||this.outerRadius<0)){e.save();var r=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(r)*i,Math.sin(r)*i);var o=i*(1-Math.sin(Math.min(ve,n||0)));e.fillStyle=t.backgroundColor,e.strokeStyle=t.borderColor,function(e,t,n,i,s){var a=t.fullCircles,r=t.startAngle,o=t.circumference,l=t.endAngle;if(a){Ks(e,t,n,i,l,s);for(var c=0;c<a;++c)e.fill();isNaN(o)||(l=r+(o%xe||xe))}Ks(e,t,n,i,l,s),e.fill()}(e,this,o,s,a),$s(e,this,o,s,a),e.restore()}}}])}(ss);function Zs(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;e.lineCap=J(n.borderCapStyle,t.borderCapStyle),e.setLineDash(J(n.borderDash,t.borderDash)),e.lineDashOffset=J(n.borderDashOffset,t.borderDashOffset),e.lineJoin=J(n.borderJoinStyle,t.borderJoinStyle),e.lineWidth=J(n.borderWidth,t.borderWidth),e.strokeStyle=J(n.borderColor,t.borderColor)}function Js(e,t,n){e.lineTo(n.x,n.y)}function ea(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=e.length,s=n.start,a=void 0===s?0:s,r=n.end,o=void 0===r?i-1:r,l=t.start,c=t.end,d=Math.max(a,l),u=Math.min(o,c),h=a<l&&o<l||a>c&&o>c;return{count:i,start:d,loop:t.loop,ilen:u<d&&!h?i+u-d:u-d}}function ta(e,t,n,i){var s,a,r,o=t.points,l=t.options,c=ea(o,n,i),d=c.count,u=c.start,h=c.loop,g=c.ilen,p=function(e){return e.stepped?_t:e.tension||"monotone"===e.cubicInterpolationMode?wt:Js}(l),f=i||{},m=f.move,v=void 0===m||m,x=f.reverse;for(s=0;s<=g;++s)(a=o[(u+(x?g-s:s))%d]).skip||(v?(e.moveTo(a.x,a.y),v=!1):p(e,r,a,x,l.stepped),r=a);return h&&p(e,r,a=o[(u+(x?g:0))%d],x,l.stepped),!!h}function na(e,t,n,i){var s,a,r,o,l,c,d=t.points,u=ea(d,n,i),h=u.count,g=u.start,p=u.ilen,f=i||{},m=f.move,v=void 0===m||m,x=f.reverse,A=0,y=0,P=function(e){return(g+(x?p-e:e))%h},b=function(){o!==l&&(e.lineTo(A,l),e.lineTo(A,o),e.lineTo(A,c))};for(v&&(a=d[P(0)],e.moveTo(a.x,a.y)),s=0;s<=p;++s)if(!(a=d[P(s)]).skip){var j=a.x,S=a.y,k=0|j;k===r?(S<o?o=S:S>l&&(l=S),A=(y*A+j)/++y):(b(),e.lineTo(j,S),r=k,y=0,o=l=S),c=S}b()}function ia(e){var t=e.options,n=t.borderDash&&t.borderDash.length;return!e._decimated&&!e._loop&&!t.tension&&"monotone"!==t.cubicInterpolationMode&&!t.stepped&&!n?na:ta}(0,c.default)(Xs,"id","arc"),(0,c.default)(Xs,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),(0,c.default)(Xs,"defaultRoutes",{backgroundColor:"backgroundColor"}),(0,c.default)(Xs,"descriptors",{_scriptable:!0,_indexable:function(e){return"borderDash"!==e}});var sa="function"===typeof Path2D;function aa(e,t,n,i){sa&&!t.options.segment?function(e,t,n,i){var s=t._path;s||(s=t._path=new Path2D,t.path(s,n,i)&&s.closePath()),Zs(e,t.options),e.stroke(s)}(e,t,n,i):function(e,t,n,i){var s,a=t.segments,r=t.options,o=ia(t),c=(0,l.default)(a);try{for(c.s();!(s=c.n()).done;){var d=s.value;Zs(e,r,d.style),e.beginPath(),o(e,t,d,{start:n,end:n+i-1})&&e.closePath(),e.stroke()}}catch(u){c.e(u)}finally{c.f()}}(e,t,n,i)}var ra=function(e){function t(e){var n;return(0,u.default)(this,t),(n=(0,s.default)(this,t)).animated=!0,n.options=void 0,n._chart=void 0,n._loop=void 0,n._fullLoop=void 0,n._path=void 0,n._points=void 0,n._segments=void 0,n._decimated=!1,n._pointsUpdated=!1,n._datasetIndex=void 0,e&&Object.assign(n,e),n}return(0,r.default)(t,e),(0,h.default)(t,[{key:"updateControlPoints",value:function(e,t){var n=this.options;if((n.tension||"monotone"===n.cubicInterpolationMode)&&!n.stepped&&!this._pointsUpdated){var i=n.spanGaps?this._loop:this._fullLoop;dn(this._points,n,e,i,t),this._pointsUpdated=!0}}},{key:"points",get:function(){return this._points},set:function(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}},{key:"segments",get:function(){return this._segments||(this._segments=function(e,t){var n=e.points,i=e.options.spanGaps,s=n.length;if(!s)return[];var a=!!e._loop,r=function(e,t,n,i){var s=0,a=t-1;if(n&&!i)for(;s<t&&!e[s].skip;)s++;for(;s<t&&e[s].skip;)s++;for(s%=t,n&&(a+=s);a>s&&e[a%t].skip;)a--;return{start:s,end:a%=t}}(n,s,a,i),o=r.start,l=r.end;return Ln(e,!0===i?[{start:o,end:l,loop:a}]:function(e,t,n,i){var s,a=e.length,r=[],o=t,l=e[t];for(s=t+1;s<=n;++s){var c=e[s%a];c.skip||c.stop?l.skip||(i=!1,r.push({start:t%a,end:(s-1)%a,loop:i}),t=o=c.stop?s:null):(o=s,l.skip&&(t=s)),l=c}return null!==o&&r.push({start:t%a,end:o%a,loop:i}),r}(n,o,l<o?l+s:l,!!e._fullLoop&&0===o&&l===s-1),n,t)}(this,this.options.segment))}},{key:"first",value:function(){var e=this.segments,t=this.points;return e.length&&t[e[0].start]}},{key:"last",value:function(){var e=this.segments,t=this.points,n=e.length;return n&&t[e[n-1].end]}},{key:"interpolate",value:function(e,t){var n=this.options,i=e[t],s=this.points,a=Cn(this,{property:t,start:i,end:i});if(a.length){var r,o,l=[],c=function(e){return e.stepped?Sn:e.tension||"monotone"===e.cubicInterpolationMode?kn:jn}(n);for(r=0,o=a.length;r<o;++r){var d=a[r],u=d.start,h=d.end,g=s[u],p=s[h];if(g!==p){var f=c(g,p,Math.abs((i-g[t])/(p[t]-g[t])),n.stepped);f[t]=e[t],l.push(f)}else l.push(g)}return 1===l.length?l[0]:l}}},{key:"pathSegment",value:function(e,t,n){return ia(this)(e,this,t,n)}},{key:"path",value:function(e,t,n){var i=this.segments,s=ia(this),a=this._loop;t=t||0,n=n||this.points.length-t;var r,o=(0,l.default)(i);try{for(o.s();!(r=o.n()).done;){a&=s(e,this,r.value,{start:t,end:t+n-1})}}catch(c){o.e(c)}finally{o.f()}return!!a}},{key:"draw",value:function(e,t,n,i){var s=this.options||{};(this.points||[]).length&&s.borderWidth&&(e.save(),aa(e,this,n,i),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}])}(ss);function oa(e,t,n,i){var s=e.options,a=e.getProps([n],i)[n];return Math.abs(t-a)<s.radius+s.hitRadius}(0,c.default)(ra,"id","line"),(0,c.default)(ra,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),(0,c.default)(ra,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),(0,c.default)(ra,"descriptors",{_scriptable:!0,_indexable:function(e){return"borderDash"!==e&&"fill"!==e}});var la=function(e){function t(e){var n;return(0,u.default)(this,t),n=(0,s.default)(this,t),(0,c.default)(n,"parsed",void 0),(0,c.default)(n,"skip",void 0),(0,c.default)(n,"stop",void 0),n.options=void 0,n.parsed=void 0,n.skip=void 0,n.stop=void 0,e&&Object.assign(n,e),n}return(0,r.default)(t,e),(0,h.default)(t,[{key:"inRange",value:function(e,t,n){var i=this.options,s=this.getProps(["x","y"],n),a=s.x,r=s.y;return Math.pow(e-a,2)+Math.pow(t-r,2)<Math.pow(i.hitRadius+i.radius,2)}},{key:"inXRange",value:function(e,t){return oa(this,e,"x",t)}},{key:"inYRange",value:function(e,t){return oa(this,e,"y",t)}},{key:"getCenterPoint",value:function(e){var t=this.getProps(["x","y"],e);return{x:t.x,y:t.y}}},{key:"size",value:function(e){var t=(e=e||this.options||{}).radius||0;return 2*((t=Math.max(t,t&&e.hoverRadius||0))+(t&&e.borderWidth||0))}},{key:"draw",value:function(e,t){var n=this.options;this.skip||n.radius<.1||!St(this,t,this.size(n)/2)||(e.strokeStyle=n.borderColor,e.lineWidth=n.borderWidth,e.fillStyle=n.backgroundColor,bt(e,n,this.x,this.y))}},{key:"getRange",value:function(){var e=this.options||{};return e.radius+e.hitRadius}}])}(ss);function ca(e,t){var n,i,s,a,r,o=e.getProps(["x","y","base","width","height"],t),l=o.x,c=o.y,d=o.base,u=o.width,h=o.height;return e.horizontal?(r=h/2,n=Math.min(l,d),i=Math.max(l,d),s=c-r,a=c+r):(n=l-(r=u/2),i=l+r,s=Math.min(c,d),a=Math.max(c,d)),{left:n,top:s,right:i,bottom:a}}function da(e,t,n,i){return e?0:Ee(t,n,i)}function ua(e){var t=ca(e),n=t.right-t.left,i=t.bottom-t.top,s=function(e,t,n){var i=e.options.borderWidth,s=e.borderSkipped,a=Ut(i);return{t:da(s.top,a.top,0,n),r:da(s.right,a.right,0,t),b:da(s.bottom,a.bottom,0,n),l:da(s.left,a.left,0,t)}}(e,n/2,i/2),a=function(e,t,n){var i=e.getProps(["enableBorderRadius"]).enableBorderRadius,s=e.options.borderRadius,a=Ft(s),r=Math.min(t,n),o=e.borderSkipped,l=i||$(s);return{topLeft:da(!l||o.top||o.left,a.topLeft,0,r),topRight:da(!l||o.top||o.right,a.topRight,0,r),bottomLeft:da(!l||o.bottom||o.left,a.bottomLeft,0,r),bottomRight:da(!l||o.bottom||o.right,a.bottomRight,0,r)}}(e,n/2,i/2);return{outer:{x:t.left,y:t.top,w:n,h:i,radius:a},inner:{x:t.left+s.l,y:t.top+s.t,w:n-s.l-s.r,h:i-s.t-s.b,radius:{topLeft:Math.max(0,a.topLeft-Math.max(s.t,s.l)),topRight:Math.max(0,a.topRight-Math.max(s.t,s.r)),bottomLeft:Math.max(0,a.bottomLeft-Math.max(s.b,s.l)),bottomRight:Math.max(0,a.bottomRight-Math.max(s.b,s.r))}}}}function ha(e,t,n,i){var s=null===t,a=null===n,r=e&&!(s&&a)&&ca(e,i);return r&&(s||ze(t,r.left,r.right))&&(a||ze(n,r.top,r.bottom))}function ga(e,t){e.rect(t.x,t.y,t.w,t.h)}function pa(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=e.x!==n.x?-t:0,s=e.y!==n.y?-t:0,a=(e.x+e.w!==n.x+n.w?t:0)-i,r=(e.y+e.h!==n.y+n.h?t:0)-s;return{x:e.x+i,y:e.y+s,w:e.w+a,h:e.h+r,radius:e.radius}}(0,c.default)(la,"id","point"),(0,c.default)(la,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),(0,c.default)(la,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var fa=function(e){function t(e){var n;return(0,u.default)(this,t),(n=(0,s.default)(this,t)).options=void 0,n.horizontal=void 0,n.base=void 0,n.width=void 0,n.height=void 0,n.inflateAmount=void 0,e&&Object.assign(n,e),n}return(0,r.default)(t,e),(0,h.default)(t,[{key:"draw",value:function(e){var t,n=this.inflateAmount,i=this.options,s=i.borderColor,a=i.backgroundColor,r=ua(this),o=r.inner,l=r.outer,c=(t=l.radius).topLeft||t.topRight||t.bottomLeft||t.bottomRight?Ct:ga;e.save(),l.w===o.w&&l.h===o.h||(e.beginPath(),c(e,pa(l,n,o)),e.clip(),c(e,pa(o,-n,l)),e.fillStyle=s,e.fill("evenodd")),e.beginPath(),c(e,pa(o,n)),e.fillStyle=a,e.fill(),e.restore()}},{key:"inRange",value:function(e,t,n){return ha(this,e,t,n)}},{key:"inXRange",value:function(e,t){return ha(this,e,null,t)}},{key:"inYRange",value:function(e,t){return ha(this,null,e,t)}},{key:"getCenterPoint",value:function(e){var t=this.getProps(["x","y","base","horizontal"],e),n=t.x,i=t.y,s=t.base,a=t.horizontal;return{x:a?(n+s)/2:n,y:a?i:(i+s)/2}}},{key:"getRange",value:function(e){return"x"===e?this.width/2:this.height/2}}])}(ss);(0,c.default)(fa,"id","bar"),(0,c.default)(fa,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),(0,c.default)(fa,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var ma=function(e,t){var n=e.boxHeight,i=void 0===n?t:n,s=e.boxWidth,a=void 0===s?t:s;return e.usePointStyle&&(i=Math.min(i,t),a=e.pointStyleWidth||Math.min(a,t)),{boxWidth:a,boxHeight:i,itemHeight:Math.max(t,i)}},va=function(e){function t(e){var n;return(0,u.default)(this,t),(n=(0,s.default)(this,t))._added=!1,n.legendHitBoxes=[],n._hoveredItem=null,n.doughnutMode=!1,n.chart=e.chart,n.options=e.options,n.ctx=e.ctx,n.legendItems=void 0,n.columnSizes=void 0,n.lineWidths=void 0,n.maxHeight=void 0,n.maxWidth=void 0,n.top=void 0,n.bottom=void 0,n.left=void 0,n.right=void 0,n.height=void 0,n.width=void 0,n._margins=void 0,n.position=void 0,n.weight=void 0,n.fullSize=void 0,n}return(0,r.default)(t,e),(0,h.default)(t,[{key:"update",value:function(e,t,n){this.maxWidth=e,this.maxHeight=t,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}},{key:"setDimensions",value:function(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}},{key:"buildLabels",value:function(){var e=this,t=this.options.labels||{},n=te(t.generateLabels,[this.chart],this)||[];t.filter&&(n=n.filter((function(n){return t.filter(n,e.chart.data)}))),t.sort&&(n=n.sort((function(n,i){return t.sort(n,i,e.chart.data)}))),this.options.reverse&&n.reverse(),this.legendItems=n}},{key:"fit",value:function(){var e=this.options,t=this.ctx;if(e.display){var n,i,s=e.labels,a=zt(s.font),r=a.size,o=this._computeTitleHeight(),l=ma(s,r),c=l.boxWidth,d=l.itemHeight;t.font=a.string,this.isHorizontal()?(n=this.maxWidth,i=this._fitRows(o,r,c,d)+10):(i=this.maxHeight,n=this._fitCols(o,a,c,d)+10),this.width=Math.min(n,e.maxWidth||this.maxWidth),this.height=Math.min(i,e.maxHeight||this.maxHeight)}else this.width=this.height=0}},{key:"_fitRows",value:function(e,t,n,i){var s=this.ctx,a=this.maxWidth,r=this.options.labels.padding,o=this.legendHitBoxes=[],l=this.lineWidths=[0],c=i+r,d=e;s.textAlign="left",s.textBaseline="middle";var u=-1,h=-c;return this.legendItems.forEach((function(e,g){var p=n+t/2+s.measureText(e.text).width;(0===g||l[l.length-1]+p+2*r>a)&&(d+=c,l[l.length-(g>0?0:1)]=0,h+=c,u++),o[g]={left:0,top:h,row:u,width:p,height:i},l[l.length-1]+=p+r})),d}},{key:"_fitCols",value:function(e,t,n,i){var s=this.ctx,a=this.maxHeight,r=this.options.labels.padding,o=this.legendHitBoxes=[],l=this.columnSizes=[],c=a-e,d=r,u=0,h=0,g=0,p=0;return this.legendItems.forEach((function(e,a){var f=function(e,t,n,i,s){var a=function(e,t,n,i){var s=e.text;s&&"string"!==typeof s&&(s=s.reduce((function(e,t){return e.length>t.length?e:t})));return t+n.size/2+i.measureText(s).width}(i,e,t,n),r=function(e,t,n){var i=e;"string"!==typeof t.text&&(i=xa(t,n));return i}(s,i,t.lineHeight);return{itemWidth:a,itemHeight:r}}(n,t,s,e,i),m=f.itemWidth,v=f.itemHeight;a>0&&h+v+2*r>c&&(d+=u+r,l.push({width:u,height:h}),g+=u+r,p++,u=h=0),o[a]={left:g,top:h,col:p,width:m,height:v},u=Math.max(u,m),h+=v+r})),d+=u,l.push({width:u,height:h}),d}},{key:"adjustHitBoxes",value:function(){if(this.options.display){var e=this._computeTitleHeight(),t=this.legendHitBoxes,n=this.options,i=n.align,s=n.labels.padding,a=Dn(n.rtl,this.left,this.width);if(this.isHorizontal()){var r,o=0,c=$e(i,this.left+s,this.right-this.lineWidths[o]),d=(0,l.default)(t);try{for(d.s();!(r=d.n()).done;){var u=r.value;o!==u.row&&(o=u.row,c=$e(i,this.left+s,this.right-this.lineWidths[o])),u.top+=this.top+e+s,u.left=a.leftForLtr(a.x(c),u.width),c+=u.width+s}}catch(v){d.e(v)}finally{d.f()}}else{var h,g=0,p=$e(i,this.top+e+s,this.bottom-this.columnSizes[g].height),f=(0,l.default)(t);try{for(f.s();!(h=f.n()).done;){var m=h.value;m.col!==g&&(g=m.col,p=$e(i,this.top+e+s,this.bottom-this.columnSizes[g].height)),m.top=p,m.left+=this.left+s,m.left=a.leftForLtr(a.x(m.left),m.width),p+=m.height+s}}catch(v){f.e(v)}finally{f.f()}}}}},{key:"isHorizontal",value:function(){return"top"===this.options.position||"bottom"===this.options.position}},{key:"draw",value:function(){if(this.options.display){var e=this.ctx;kt(e,this),this._draw(),Dt(e)}}},{key:"_draw",value:function(){var e,t=this,n=this.options,i=this.columnSizes,s=this.lineWidths,a=this.ctx,r=n.align,o=n.labels,l=vt.color,c=Dn(n.rtl,this.left,this.width),d=zt(o.font),u=o.padding,h=d.size,g=h/2;this.drawTitle(),a.textAlign=c.textAlign("left"),a.textBaseline="middle",a.lineWidth=.5,a.font=d.string;var p=ma(o,h),f=p.boxWidth,m=p.boxHeight,v=p.itemHeight,x=this.isHorizontal(),A=this._computeTitleHeight();e=x?{x:$e(r,this.left+u,this.right-s[0]),y:this.top+u+A,line:0}:{x:this.left+u,y:$e(r,this.top+A+u,this.bottom-i[0].height),line:0},_n(this.ctx,n.textDirection);var y=v+u;this.legendItems.forEach((function(p,P){a.strokeStyle=p.fontColor,a.fillStyle=p.fontColor;var b=a.measureText(p.text).width,j=c.textAlign(p.textAlign||(p.textAlign=o.textAlign)),S=f+g+b,k=e.x,D=e.y;if(c.setWidth(t.width),x?P>0&&k+S+u>t.right&&(D=e.y+=y,e.line++,k=e.x=$e(r,t.left+u,t.right-s[e.line])):P>0&&D+y>t.bottom&&(k=e.x=k+i[e.line].width+u,e.line++,D=e.y=$e(r,t.top+A+u,t.bottom-i[e.line].height)),function(e,t,n){if(!(isNaN(f)||f<=0||isNaN(m)||m<0)){a.save();var i=J(n.lineWidth,1);if(a.fillStyle=J(n.fillStyle,l),a.lineCap=J(n.lineCap,"butt"),a.lineDashOffset=J(n.lineDashOffset,0),a.lineJoin=J(n.lineJoin,"miter"),a.lineWidth=i,a.strokeStyle=J(n.strokeStyle,l),a.setLineDash(J(n.lineDash,[])),o.usePointStyle){var s={radius:m*Math.SQRT2/2,pointStyle:n.pointStyle,rotation:n.rotation,borderWidth:i},r=c.xPlus(e,f/2);jt(a,s,r,t+g,o.pointStyleWidth&&f)}else{var d=t+Math.max((h-m)/2,0),u=c.leftForLtr(e,f),p=Ft(n.borderRadius);a.beginPath(),Object.values(p).some((function(e){return 0!==e}))?Ct(a,{x:u,y:d,w:f,h:m,radius:p}):a.rect(u,d,f,m),a.fill(),0!==i&&a.stroke()}a.restore()}}(c.x(k),D,p),k=function(e,t,n,i){return e===(i?"left":"right")?n:"center"===e?(t+n)/2:t}(j,k+f+g,x?k+S:t.right,n.rtl),function(e,t,n){Mt(a,n.text,e,t+v/2,d,{strikethrough:n.hidden,textAlign:c.textAlign(n.textAlign)})}(c.x(k),D,p),x)e.x+=S+u;else if("string"!==typeof p.text){var _=d.lineHeight;e.y+=xa(p,_)+u}else e.y+=y})),wn(this.ctx,n.textDirection)}},{key:"drawTitle",value:function(){var e=this.options,t=e.title,n=zt(t.font),i=Et(t.padding);if(t.display){var s,a=Dn(e.rtl,this.left,this.width),r=this.ctx,o=t.position,l=n.size/2,c=i.top+l,u=this.left,h=this.width;if(this.isHorizontal())h=Math.max.apply(Math,(0,d.default)(this.lineWidths)),s=this.top+c,u=$e(e.align,u,this.right-h);else{var g=this.columnSizes.reduce((function(e,t){return Math.max(e,t.height)}),0);s=c+$e(e.align,this.top,this.bottom-g-e.labels.padding-this._computeTitleHeight())}var p=$e(o,u,u+h);r.textAlign=a.textAlign(Ke(o)),r.textBaseline="middle",r.strokeStyle=t.color,r.fillStyle=t.color,r.font=n.string,Mt(r,t.text,p,s,n)}}},{key:"_computeTitleHeight",value:function(){var e=this.options.title,t=zt(e.font),n=Et(e.padding);return e.display?t.lineHeight+n.height:0}},{key:"_getLegendItemAt",value:function(e,t){var n,i,s;if(ze(e,this.left,this.right)&&ze(t,this.top,this.bottom))for(s=this.legendHitBoxes,n=0;n<s.length;++n)if(ze(e,(i=s[n]).left,i.left+i.width)&&ze(t,i.top,i.top+i.height))return this.legendItems[n];return null}},{key:"handleEvent",value:function(e){var t=this.options;if(function(e,t){if(("mousemove"===e||"mouseout"===e)&&(t.onHover||t.onLeave))return!0;if(t.onClick&&("click"===e||"mouseup"===e))return!0;return!1}(e.type,t)){var n,i,s=this._getLegendItemAt(e.x,e.y);if("mousemove"===e.type||"mouseout"===e.type){var a=this._hoveredItem,r=(i=s,null!==(n=a)&&null!==i&&n.datasetIndex===i.datasetIndex&&n.index===i.index);a&&!r&&te(t.onLeave,[e,a,this],this),this._hoveredItem=s,s&&!r&&te(t.onHover,[e,s,this],this)}else s&&te(t.onClick,[e,s,this],this)}}}])}(ss);function xa(e,t){return t*(e.text?e.text.length:0)}var Aa={id:"legend",_element:va,start:function(e,t,n){var i=e.legend=new va({ctx:e.ctx,options:n,chart:e});Ei(e,i,n),Ui(e,i)},stop:function(e){Fi(e,e.legend),delete e.legend},beforeUpdate:function(e,t,n){var i=e.legend;Ei(e,i,n),i.options=n},afterUpdate:function(e){var t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent:function(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick:function(e,t,n){var i=t.datasetIndex,s=n.chart;s.isDatasetVisible(i)?(s.hide(i),t.hidden=!0):(s.show(i),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:function(e){return e.chart.options.color},boxWidth:40,padding:10,generateLabels:function(e){var t=e.data.datasets,n=e.legend.options.labels,i=n.usePointStyle,s=n.pointStyle,a=n.textAlign,r=n.color,o=n.useBorderRadius,l=n.borderRadius;return e._getSortedDatasetMetas().map((function(e){var n=e.controller.getStyle(i?0:void 0),c=Et(n.borderWidth);return{text:t[e.index].label,fillStyle:n.backgroundColor,fontColor:r,hidden:!e.visible,lineCap:n.borderCapStyle,lineDash:n.borderDash,lineDashOffset:n.borderDashOffset,lineJoin:n.borderJoinStyle,lineWidth:(c.width+c.height)/4,strokeStyle:n.borderColor,pointStyle:s||n.pointStyle,rotation:n.rotation,textAlign:a||n.textAlign,borderRadius:o&&(l||n.borderRadius),datasetIndex:e.index}}),this)}},title:{color:function(e){return e.chart.options.color},display:!1,position:"center",text:""}},descriptors:{_scriptable:function(e){return!e.startsWith("on")},labels:{_scriptable:function(e){return!["generateLabels","filter","sort"].includes(e)}}}},ya=function(e){function t(e){var n;return(0,u.default)(this,t),(n=(0,s.default)(this,t)).chart=e.chart,n.options=e.options,n.ctx=e.ctx,n._padding=void 0,n.top=void 0,n.bottom=void 0,n.left=void 0,n.right=void 0,n.width=void 0,n.height=void 0,n.position=void 0,n.weight=void 0,n.fullSize=void 0,n}return(0,r.default)(t,e),(0,h.default)(t,[{key:"update",value:function(e,t){var n=this.options;if(this.left=0,this.top=0,n.display){this.width=this.right=e,this.height=this.bottom=t;var i=K(n.text)?n.text.length:1;this._padding=Et(n.padding);var s=i*zt(n.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=s:this.width=s}else this.width=this.height=this.right=this.bottom=0}},{key:"isHorizontal",value:function(){var e=this.options.position;return"top"===e||"bottom"===e}},{key:"_drawArgs",value:function(e){var t,n,i,s=this.top,a=this.left,r=this.bottom,o=this.right,l=this.options,c=l.align,d=0;return this.isHorizontal()?(n=$e(c,a,o),i=s+e,t=o-a):("left"===l.position?(n=a+e,i=$e(c,r,s),d=-.5*ve):(n=o-e,i=$e(c,s,r),d=.5*ve),t=r-s),{titleX:n,titleY:i,maxWidth:t,rotation:d}}},{key:"draw",value:function(){var e=this.ctx,t=this.options;if(t.display){var n=zt(t.font),i=n.lineHeight/2+this._padding.top,s=this._drawArgs(i),a=s.titleX,r=s.titleY,o=s.maxWidth,l=s.rotation;Mt(e,t.text,0,0,n,{color:t.color,maxWidth:o,rotation:l,textAlign:Ke(t.align),textBaseline:"middle",translation:[a,r]})}}}])}(ss);var Pa={id:"title",_element:ya,start:function(e,t,n){!function(e,t){var n=new ya({ctx:e.ctx,options:t,chart:e});Ei(e,n,t),Ui(e,n),e.titleBlock=n}(e,n)},stop:function(e){var t=e.titleBlock;Fi(e,t),delete e.titleBlock},beforeUpdate:function(e,t,n){var i=e.titleBlock;Ei(e,i,n),i.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}},ba=(new WeakMap,{average:function(e){if(!e.length)return!1;var t,n,i=new Set,s=0,a=0;for(t=0,n=e.length;t<n;++t){var r=e[t].element;if(r&&r.hasValue()){var o=r.tooltipPosition();i.add(o.x),s+=o.y,++a}}return 0!==a&&0!==i.size&&{x:(0,d.default)(i).reduce((function(e,t){return e+t}))/i.size,y:s/a}},nearest:function(e,t){if(!e.length)return!1;var n,i,s,a=t.x,r=t.y,o=Number.POSITIVE_INFINITY;for(n=0,i=e.length;n<i;++n){var l=e[n].element;if(l&&l.hasValue()){var c=Te(t,l.getCenterPoint());c<o&&(o=c,s=l)}}if(s){var d=s.tooltipPosition();a=d.x,r=d.y}return{x:a,y:r}}});function ja(e,t){return t&&(K(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function Sa(e){return("string"===typeof e||e instanceof String)&&e.indexOf("\n")>-1?e.split("\n"):e}function ka(e,t){var n=t.element,i=t.datasetIndex,s=t.index,a=e.getDatasetMeta(i).controller,r=a.getLabelAndValue(s),o=r.label,l=r.value;return{chart:e,label:o,parsed:a.getParsed(s),raw:e.data.datasets[i].data[s],formattedValue:l,dataset:a.getDataset(),dataIndex:s,datasetIndex:i,element:n}}function Da(e,t){var n=e.chart.ctx,i=e.body,s=e.footer,a=e.title,r=t.boxWidth,o=t.boxHeight,l=zt(t.bodyFont),c=zt(t.titleFont),d=zt(t.footerFont),u=a.length,h=s.length,g=i.length,p=Et(t.padding),f=p.height,m=0,v=i.reduce((function(e,t){return e+t.before.length+t.lines.length+t.after.length}),0);(v+=e.beforeBody.length+e.afterBody.length,u&&(f+=u*c.lineHeight+(u-1)*t.titleSpacing+t.titleMarginBottom),v)&&(f+=g*(t.displayColors?Math.max(o,l.lineHeight):l.lineHeight)+(v-g)*l.lineHeight+(v-1)*t.bodySpacing);h&&(f+=t.footerMarginTop+h*d.lineHeight+(h-1)*t.footerSpacing);var x=0,A=function(e){m=Math.max(m,n.measureText(e).width+x)};return n.save(),n.font=c.string,ne(e.title,A),n.font=l.string,ne(e.beforeBody.concat(e.afterBody),A),x=t.displayColors?r+2+t.boxPadding:0,ne(i,(function(e){ne(e.before,A),ne(e.lines,A),ne(e.after,A)})),x=0,n.font=d.string,ne(e.footer,A),n.restore(),{width:m+=p.width,height:f}}function _a(e,t,n,i){var s=n.x,a=n.width,r=e.width,o=e.chartArea,l=o.left,c=o.right,d="center";return"center"===i?d=s<=(l+c)/2?"left":"right":s<=a/2?d="left":s>=r-a/2&&(d="right"),function(e,t,n,i){var s=i.x,a=i.width,r=n.caretSize+n.caretPadding;return"left"===e&&s+a+r>t.width||"right"===e&&s-a-r<0||void 0}(d,e,t,n)&&(d="center"),d}function wa(e,t,n){var i=n.yAlign||t.yAlign||function(e,t){var n=t.y,i=t.height;return n<i/2?"top":n>e.height-i/2?"bottom":"center"}(e,n);return{xAlign:n.xAlign||t.xAlign||_a(e,t,n,i),yAlign:i}}function Ia(e,t,n,i){var s=e.caretSize,a=e.caretPadding,r=e.cornerRadius,o=n.xAlign,l=n.yAlign,c=s+a,d=Ft(r),u=d.topLeft,h=d.topRight,g=d.bottomLeft,p=d.bottomRight,f=function(e,t){var n=e.x,i=e.width;return"right"===t?n-=i:"center"===t&&(n-=i/2),n}(t,o),m=function(e,t,n){var i=e.y,s=e.height;return"top"===t?i+=n:i-="bottom"===t?s+n:s/2,i}(t,l,c);return"center"===l?"left"===o?f+=c:"right"===o&&(f-=c):"left"===o?f-=Math.max(u,g)+s:"right"===o&&(f+=Math.max(h,p)+s),{x:Ee(f,0,i.width-t.width),y:Ee(m,0,i.height-t.height)}}function Na(e,t,n){var i=Et(n.padding);return"center"===t?e.x+e.width/2:"right"===t?e.x+e.width-i.right:e.x+i.left}function Ma(e){return ja([],Sa(e))}function Ca(e,t){var n=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return n?e.override(n):e}var La={beforeTitle:G,title:function(e){if(e.length>0){var t=e[0],n=t.chart.data.labels,i=n?n.length:0;if(this&&this.options&&"dataset"===this.options.mode)return t.dataset.label||"";if(t.label)return t.label;if(i>0&&t.dataIndex<i)return n[t.dataIndex]}return""},afterTitle:G,beforeBody:G,beforeLabel:G,label:function(e){if(this&&this.options&&"dataset"===this.options.mode)return e.label+": "+e.formattedValue||e.formattedValue;var t=e.dataset.label||"";t&&(t+=": ");var n=e.formattedValue;return Q(n)||(t+=n),t},labelColor:function(e){var t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor:function(){return this.options.bodyColor},labelPointStyle:function(e){var t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:G,afterBody:G,beforeFooter:G,footer:G,afterFooter:G};function Oa(e,t,n,i){var s=e[t].call(n,i);return"undefined"===typeof s?La[t].call(n,i):s}var Ta=function(e){function t(e){var n;return(0,u.default)(this,t),(n=(0,s.default)(this,t)).opacity=0,n._active=[],n._eventPosition=void 0,n._size=void 0,n._cachedAnimations=void 0,n._tooltipItems=[],n.$animations=void 0,n.$context=void 0,n.chart=e.chart,n.options=e.options,n.dataPoints=void 0,n.title=void 0,n.beforeBody=void 0,n.body=void 0,n.afterBody=void 0,n.footer=void 0,n.xAlign=void 0,n.yAlign=void 0,n.x=void 0,n.y=void 0,n.height=void 0,n.width=void 0,n.caretX=void 0,n.caretY=void 0,n.labelColors=void 0,n.labelPointStyles=void 0,n.labelTextColors=void 0,n}return(0,r.default)(t,e),(0,h.default)(t,[{key:"initialize",value:function(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}},{key:"_resolveAnimations",value:function(){var e=this._cachedAnimations;if(e)return e;var t=this.chart,n=this.options.setContext(this.getContext()),i=n.enabled&&t.options.animation&&n.animations,s=new Bn(this.chart,i);return i._cacheable&&(this._cachedAnimations=Object.freeze(s)),s}},{key:"getContext",value:function(){return this.$context||(this.$context=(e=this.chart.getContext(),t=this,n=this._tooltipItems,Ht(e,{tooltip:t,tooltipItems:n,type:"tooltip"})));var e,t,n}},{key:"getTitle",value:function(e,t){var n=t.callbacks,i=Oa(n,"beforeTitle",this,e),s=Oa(n,"title",this,e),a=Oa(n,"afterTitle",this,e),r=[];return r=ja(r,Sa(i)),r=ja(r,Sa(s)),r=ja(r,Sa(a))}},{key:"getBeforeBody",value:function(e,t){return Ma(Oa(t.callbacks,"beforeBody",this,e))}},{key:"getBody",value:function(e,t){var n=this,i=t.callbacks,s=[];return ne(e,(function(e){var t={before:[],lines:[],after:[]},a=Ca(i,e);ja(t.before,Sa(Oa(a,"beforeLabel",n,e))),ja(t.lines,Oa(a,"label",n,e)),ja(t.after,Sa(Oa(a,"afterLabel",n,e))),s.push(t)})),s}},{key:"getAfterBody",value:function(e,t){return Ma(Oa(t.callbacks,"afterBody",this,e))}},{key:"getFooter",value:function(e,t){var n=t.callbacks,i=Oa(n,"beforeFooter",this,e),s=Oa(n,"footer",this,e),a=Oa(n,"afterFooter",this,e),r=[];return r=ja(r,Sa(i)),r=ja(r,Sa(s)),r=ja(r,Sa(a))}},{key:"_createItems",value:function(e){var t,n,i=this,s=this._active,a=this.chart.data,r=[],o=[],l=[],c=[];for(t=0,n=s.length;t<n;++t)c.push(ka(this.chart,s[t]));return e.filter&&(c=c.filter((function(t,n,i){return e.filter(t,n,i,a)}))),e.itemSort&&(c=c.sort((function(t,n){return e.itemSort(t,n,a)}))),ne(c,(function(t){var n=Ca(e.callbacks,t);r.push(Oa(n,"labelColor",i,t)),o.push(Oa(n,"labelPointStyle",i,t)),l.push(Oa(n,"labelTextColor",i,t))})),this.labelColors=r,this.labelPointStyles=o,this.labelTextColors=l,this.dataPoints=c,c}},{key:"update",value:function(e,t){var n,i=this.options.setContext(this.getContext()),s=this._active,a=[];if(s.length){var r=ba[i.position].call(this,s,this._eventPosition);a=this._createItems(i),this.title=this.getTitle(a,i),this.beforeBody=this.getBeforeBody(a,i),this.body=this.getBody(a,i),this.afterBody=this.getAfterBody(a,i),this.footer=this.getFooter(a,i);var o=this._size=Da(this,i),l=Object.assign({},r,o),c=wa(this.chart,i,l),d=Ia(i,l,c,this.chart);this.xAlign=c.xAlign,this.yAlign=c.yAlign,n={opacity:1,x:d.x,y:d.y,width:o.width,height:o.height,caretX:r.x,caretY:r.y}}else 0!==this.opacity&&(n={opacity:0});this._tooltipItems=a,this.$context=void 0,n&&this._resolveAnimations().update(this,n),e&&i.external&&i.external.call(this,{chart:this.chart,tooltip:this,replay:t})}},{key:"drawCaret",value:function(e,t,n,i){var s=this.getCaretPosition(e,n,i);t.lineTo(s.x1,s.y1),t.lineTo(s.x2,s.y2),t.lineTo(s.x3,s.y3)}},{key:"getCaretPosition",value:function(e,t,n){var i,s,a,r,o,l,c=this.xAlign,d=this.yAlign,u=n.caretSize,h=Ft(n.cornerRadius),g=h.topLeft,p=h.topRight,f=h.bottomLeft,m=h.bottomRight,v=e.x,x=e.y,A=t.width,y=t.height;return"center"===d?(o=x+y/2,"left"===c?(s=(i=v)-u,r=o+u,l=o-u):(s=(i=v+A)+u,r=o-u,l=o+u),a=i):(s="left"===c?v+Math.max(g,f)+u:"right"===c?v+A-Math.max(p,m)-u:this.caretX,"top"===d?(o=(r=x)-u,i=s-u,a=s+u):(o=(r=x+y)+u,i=s+u,a=s-u),l=r),{x1:i,x2:s,x3:a,y1:r,y2:o,y3:l}}},{key:"drawTitle",value:function(e,t,n){var i,s,a,r=this.title,o=r.length;if(o){var l=Dn(n.rtl,this.x,this.width);for(e.x=Na(this,n.titleAlign,n),t.textAlign=l.textAlign(n.titleAlign),t.textBaseline="middle",i=zt(n.titleFont),s=n.titleSpacing,t.fillStyle=n.titleColor,t.font=i.string,a=0;a<o;++a)t.fillText(r[a],l.x(e.x),e.y+i.lineHeight/2),e.y+=i.lineHeight+s,a+1===o&&(e.y+=n.titleMarginBottom-s)}}},{key:"_drawColorBox",value:function(e,t,n,i,s){var a=this.labelColors[n],r=this.labelPointStyles[n],o=s.boxHeight,l=s.boxWidth,c=zt(s.bodyFont),u=Na(this,"left",s),h=i.x(u),g=o<c.lineHeight?(c.lineHeight-o)/2:0,p=t.y+g;if(s.usePointStyle){var f={radius:Math.min(l,o)/2,pointStyle:r.pointStyle,rotation:r.rotation,borderWidth:1},m=i.leftForLtr(h,l)+l/2,v=p+o/2;e.strokeStyle=s.multiKeyBackground,e.fillStyle=s.multiKeyBackground,bt(e,f,m,v),e.strokeStyle=a.borderColor,e.fillStyle=a.backgroundColor,bt(e,f,m,v)}else{e.lineWidth=$(a.borderWidth)?Math.max.apply(Math,(0,d.default)(Object.values(a.borderWidth))):a.borderWidth||1,e.strokeStyle=a.borderColor,e.setLineDash(a.borderDash||[]),e.lineDashOffset=a.borderDashOffset||0;var x=i.leftForLtr(h,l),A=i.leftForLtr(i.xPlus(h,1),l-2),y=Ft(a.borderRadius);Object.values(y).some((function(e){return 0!==e}))?(e.beginPath(),e.fillStyle=s.multiKeyBackground,Ct(e,{x:x,y:p,w:l,h:o,radius:y}),e.fill(),e.stroke(),e.fillStyle=a.backgroundColor,e.beginPath(),Ct(e,{x:A,y:p+1,w:l-2,h:o-2,radius:y}),e.fill()):(e.fillStyle=s.multiKeyBackground,e.fillRect(x,p,l,o),e.strokeRect(x,p,l,o),e.fillStyle=a.backgroundColor,e.fillRect(A,p+1,l-2,o-2))}e.fillStyle=this.labelTextColors[n]}},{key:"drawBody",value:function(e,t,n){var i,s,a,r,o,l,c,d=this.body,u=n.bodySpacing,h=n.bodyAlign,g=n.displayColors,p=n.boxHeight,f=n.boxWidth,m=n.boxPadding,v=zt(n.bodyFont),x=v.lineHeight,A=0,y=Dn(n.rtl,this.x,this.width),P=function(n){t.fillText(n,y.x(e.x+A),e.y+x/2),e.y+=x+u},b=y.textAlign(h);for(t.textAlign=h,t.textBaseline="middle",t.font=v.string,e.x=Na(this,b,n),t.fillStyle=n.bodyColor,ne(this.beforeBody,P),A=g&&"right"!==b?"center"===h?f/2+m:f+2+m:0,r=0,l=d.length;r<l;++r){for(i=d[r],s=this.labelTextColors[r],t.fillStyle=s,ne(i.before,P),a=i.lines,g&&a.length&&(this._drawColorBox(t,e,r,y,n),x=Math.max(v.lineHeight,p)),o=0,c=a.length;o<c;++o)P(a[o]),x=v.lineHeight;ne(i.after,P)}A=0,x=v.lineHeight,ne(this.afterBody,P),e.y-=u}},{key:"drawFooter",value:function(e,t,n){var i,s,a=this.footer,r=a.length;if(r){var o=Dn(n.rtl,this.x,this.width);for(e.x=Na(this,n.footerAlign,n),e.y+=n.footerMarginTop,t.textAlign=o.textAlign(n.footerAlign),t.textBaseline="middle",i=zt(n.footerFont),t.fillStyle=n.footerColor,t.font=i.string,s=0;s<r;++s)t.fillText(a[s],o.x(e.x),e.y+i.lineHeight/2),e.y+=i.lineHeight+n.footerSpacing}}},{key:"drawBackground",value:function(e,t,n,i){var s=this.xAlign,a=this.yAlign,r=e.x,o=e.y,l=n.width,c=n.height,d=Ft(i.cornerRadius),u=d.topLeft,h=d.topRight,g=d.bottomLeft,p=d.bottomRight;t.fillStyle=i.backgroundColor,t.strokeStyle=i.borderColor,t.lineWidth=i.borderWidth,t.beginPath(),t.moveTo(r+u,o),"top"===a&&this.drawCaret(e,t,n,i),t.lineTo(r+l-h,o),t.quadraticCurveTo(r+l,o,r+l,o+h),"center"===a&&"right"===s&&this.drawCaret(e,t,n,i),t.lineTo(r+l,o+c-p),t.quadraticCurveTo(r+l,o+c,r+l-p,o+c),"bottom"===a&&this.drawCaret(e,t,n,i),t.lineTo(r+g,o+c),t.quadraticCurveTo(r,o+c,r,o+c-g),"center"===a&&"left"===s&&this.drawCaret(e,t,n,i),t.lineTo(r,o+u),t.quadraticCurveTo(r,o,r+u,o),t.closePath(),t.fill(),i.borderWidth>0&&t.stroke()}},{key:"_updateAnimationTarget",value:function(e){var t=this.chart,n=this.$animations,i=n&&n.x,s=n&&n.y;if(i||s){var a=ba[e.position].call(this,this._active,this._eventPosition);if(!a)return;var r=this._size=Da(this,e),o=Object.assign({},a,this._size),l=wa(t,e,o),c=Ia(e,o,l,t);i._to===c.x&&s._to===c.y||(this.xAlign=l.xAlign,this.yAlign=l.yAlign,this.width=r.width,this.height=r.height,this.caretX=a.x,this.caretY=a.y,this._resolveAnimations().update(this,c))}}},{key:"_willRender",value:function(){return!!this.opacity}},{key:"draw",value:function(e){var t=this.options.setContext(this.getContext()),n=this.opacity;if(n){this._updateAnimationTarget(t);var i={width:this.width,height:this.height},s={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;var a=Et(t.padding),r=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&r&&(e.save(),e.globalAlpha=n,this.drawBackground(s,e,i,t),_n(e,t.textDirection),s.y+=a.top,this.drawTitle(s,e,t),this.drawBody(s,e,t),this.drawFooter(s,e,t),wn(e,t.textDirection),e.restore())}}},{key:"getActiveElements",value:function(){return this._active||[]}},{key:"setActiveElements",value:function(e,t){var n=this,i=this._active,s=e.map((function(e){var t=e.datasetIndex,i=e.index,s=n.chart.getDatasetMeta(t);if(!s)throw new Error("Cannot find a dataset at index "+t);return{datasetIndex:t,element:s.data[i],index:i}})),a=!ie(i,s),r=this._positionChanged(s,t);(a||r)&&(this._active=s,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}},{key:"handleEvent",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;var i=this.options,s=this._active||[],a=this._getActiveElements(e,s,t,n),r=this._positionChanged(a,e),o=t||!ie(a,s)||r;return o&&(this._active=a,(i.enabled||i.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),o}},{key:"_getActiveElements",value:function(e,t,n,i){var s=this,a=this.options;if("mouseout"===e.type)return[];if(!i)return t.filter((function(e){return s.chart.data.datasets[e.datasetIndex]&&void 0!==s.chart.getDatasetMeta(e.datasetIndex).controller.getParsed(e.index)}));var r=this.chart.getElementsAtEventForMode(e,a.mode,a,n);return a.reverse&&r.reverse(),r}},{key:"_positionChanged",value:function(e,t){var n=this.caretX,i=this.caretY,s=this.options,a=ba[s.position].call(this,e,t);return!1!==a&&(n!==a.x||i!==a.y)}}])}(ss);(0,c.default)(Ta,"positioners",ba);var Ra={id:"tooltip",_element:Ta,positioners:ba,afterInit:function(e,t,n){n&&(e.tooltip=new Ta({chart:e,options:n}))},beforeUpdate:function(e,t,n){e.tooltip&&e.tooltip.initialize(n)},reset:function(e,t,n){e.tooltip&&e.tooltip.initialize(n)},afterDraw:function(e){var t=e.tooltip;if(t&&t._willRender()){var n={tooltip:t};if(!1===e.notifyPlugins("beforeTooltipDraw",(0,i.default)((0,i.default)({},n),{},{cancelable:!0})))return;t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",n)}},afterEvent:function(e,t){if(e.tooltip){var n=t.replay;e.tooltip.handleEvent(t.event,n,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:function(e,t){return t.bodyFont.size},boxWidth:function(e,t){return t.bodyFont.size},multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:La},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:function(e){return"filter"!==e&&"itemSort"!==e&&"external"!==e},_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};function Ua(e,t,n,i){var s=e.indexOf(t);return-1===s?function(e,t,n,i){return"string"===typeof t?(n=e.push(t)-1,i.unshift({index:n,label:t})):isNaN(t)&&(n=null),n}(e,t,n,i):s!==e.lastIndexOf(t)?n:s}function Fa(e){var t=this.getLabels();return e>=0&&e<t.length?t[e]:e}var Ea=function(e){function t(e){var n;return(0,u.default)(this,t),(n=(0,s.default)(this,t,[e]))._startValue=void 0,n._valueRange=0,n._addedLabels=[],n}return(0,r.default)(t,e),(0,h.default)(t,[{key:"init",value:function(e){var n=this._addedLabels;if(n.length){var i,s=this.getLabels(),r=(0,l.default)(n);try{for(r.s();!(i=r.n()).done;){var o=i.value,c=o.index,d=o.label;s[c]===d&&s.splice(c,1)}}catch(u){r.e(u)}finally{r.f()}this._addedLabels=[]}(0,a.A)(t,"init",this,3)([e])}},{key:"parse",value:function(e,t){if(Q(e))return null;var n=this.getLabels();return function(e,t){return null===e?null:Ee(Math.round(e),0,t)}(t=isFinite(t)&&n[t]===e?t:Ua(n,e,J(t,e),this._addedLabels),n.length-1)}},{key:"determineDataLimits",value:function(){var e=this.getUserBounds(),t=e.minDefined,n=e.maxDefined,i=this.getMinMax(!0),s=i.min,a=i.max;"ticks"===this.options.bounds&&(t||(s=0),n||(a=this.getLabels().length-1)),this.min=s,this.max=a}},{key:"buildTicks",value:function(){var e=this.min,t=this.max,n=this.options.offset,i=[],s=this.getLabels();s=0===e&&t===s.length-1?s:s.slice(e,t+1),this._valueRange=Math.max(s.length-(n?0:1),1),this._startValue=this.min-(n?.5:0);for(var a=e;a<=t;a++)i.push({value:a});return i}},{key:"getLabelForValue",value:function(e){return Fa.call(this,e)}},{key:"configure",value:function(){(0,a.A)(t,"configure",this,3)([]),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}},{key:"getPixelForValue",value:function(e){return"number"!==typeof e&&(e=this.parse(e)),null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}},{key:"getPixelForTick",value:function(e){var t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}},{key:"getValueForPixel",value:function(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}},{key:"getBasePixel",value:function(){return this.bottom}}])}(ps);function za(e,t){var n,i,s,a,r=[],o=e.bounds,l=e.step,c=e.min,d=e.max,u=e.precision,h=e.count,g=e.maxTicks,p=e.maxDigits,f=e.includeBounds,m=l||1,v=g-1,x=t.min,A=t.max,y=!Q(c),P=!Q(d),b=!Q(h),j=(A-x)/(p+1),S=we((A-x)/v/m)*m;if(S<1e-14&&!y&&!P)return[{value:x},{value:A}];(a=Math.ceil(A/S)-Math.floor(x/S))>v&&(S=we(a*S/v/m)*m),Q(u)||(n=Math.pow(10,u),S=Math.ceil(S*n)/n),"ticks"===o?(i=Math.floor(x/S)*S,s=Math.ceil(A/S)*S):(i=x,s=A),y&&P&&l&&function(e,t){var n=Math.round(e);return n-t<=e&&n+t>=e}((d-c)/l,S/1e3)?(S=(d-c)/(a=Math.round(Math.min((d-c)/S,g))),i=c,s=d):b?S=((s=P?d:s)-(i=y?c:i))/(a=h-1):a=_e(a=(s-i)/S,Math.round(a),S/1e3)?Math.round(a):Math.ceil(a);var k=Math.max(Le(S),Le(i));n=Math.pow(10,Q(u)?k:u),i=Math.round(i*n)/n,s=Math.round(s*n)/n;var D=0;for(y&&(f&&i!==c?(r.push({value:c}),i<c&&D++,_e(Math.round((i+D*S)*n)/n,c,Ba(c,j,e))&&D++):i<c&&D++);D<a;++D){var _=Math.round((i+D*S)*n)/n;if(P&&_>d)break;r.push({value:_})}return P&&f&&s!==d?r.length&&_e(r[r.length-1].value,d,Ba(d,j,e))?r[r.length-1].value=d:r.push({value:d}):P&&s!==d||r.push({value:s}),r}function Ba(e,t,n){var i=n.horizontal,s=Me(n.minRotation),a=(i?Math.sin(s):Math.cos(s))||.001,r=.75*t*(""+e).length;return Math.min(t/a,r)}(0,c.default)(Ea,"id","category"),(0,c.default)(Ea,"defaults",{ticks:{callback:Fa}});var Ha=function(e){function t(e){var n;return(0,u.default)(this,t),(n=(0,s.default)(this,t,[e])).start=void 0,n.end=void 0,n._startValue=void 0,n._endValue=void 0,n._valueRange=0,n}return(0,r.default)(t,e),(0,h.default)(t,[{key:"parse",value:function(e,t){return Q(e)||("number"===typeof e||e instanceof Number)&&!isFinite(+e)?null:+e}},{key:"handleTickRangeOptions",value:function(){var e=this.options.beginAtZero,t=this.getUserBounds(),n=t.minDefined,i=t.maxDefined,s=this.min,a=this.max,r=function(e){return s=n?s:e},o=function(e){return a=i?a:e};if(e){var l=De(s),c=De(a);l<0&&c<0?o(0):l>0&&c>0&&r(0)}if(s===a){var d=0===a?1:Math.abs(.05*a);o(a+d),e||r(s-d)}this.min=s,this.max=a}},{key:"getTickLimit",value:function(){var e,t=this.options.ticks,n=t.maxTicksLimit,i=t.stepSize;return i?(e=Math.ceil(this.max/i)-Math.floor(this.min/i)+1)>1e3&&(console.warn("scales.".concat(this.id,".ticks.stepSize: ").concat(i," would result generating up to ").concat(e," ticks. Limiting to 1000.")),e=1e3):(e=this.computeTickLimit(),n=n||11),n&&(e=Math.min(n,e)),e}},{key:"computeTickLimit",value:function(){return Number.POSITIVE_INFINITY}},{key:"buildTicks",value:function(){var e=this.options,t=e.ticks,n=this.getTickLimit(),i=za({maxTicks:n=Math.max(2,n),bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:!1!==t.includeBounds},this._range||this);return"ticks"===e.bounds&&Ne(i,this,"value"),e.reverse?(i.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),i}},{key:"configure",value:function(){var e=this.ticks,n=this.min,i=this.max;if((0,a.A)(t,"configure",this,3)([]),this.options.offset&&e.length){var s=(i-n)/Math.max(e.length-1,1)/2;n-=s,i+=s}this._startValue=n,this._endValue=i,this._valueRange=i-n}},{key:"getLabelForValue",value:function(e){return ct(e,this.chart.options.locale,this.options.ticks.format)}}])}(ps),qa=function(e){function t(){return(0,u.default)(this,t),(0,s.default)(this,t,arguments)}return(0,r.default)(t,e),(0,h.default)(t,[{key:"determineDataLimits",value:function(){var e=this.getMinMax(!0),t=e.min,n=e.max;this.min=X(t)?t:0,this.max=X(n)?n:1,this.handleTickRangeOptions()}},{key:"computeTickLimit",value:function(){var e=this.isHorizontal(),t=e?this.width:this.height,n=Me(this.options.ticks.minRotation),i=(e?Math.sin(n):Math.cos(n))||.001,s=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,s.lineHeight/i))}},{key:"getPixelForValue",value:function(e){return null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}},{key:"getValueForPixel",value:function(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}])}(Ha);(0,c.default)(qa,"id","linear"),(0,c.default)(qa,"defaults",{ticks:{callback:ut.formatters.numeric}});var Ya=function(e){return Math.floor(ke(e))},Va=function(e,t){return Math.pow(10,Ya(e)+t)};function Ga(e){return 1===e/Math.pow(10,Ya(e))}function Wa(e,t,n){var i=Math.pow(10,n),s=Math.floor(e/i);return Math.ceil(t/i)-s}function Qa(e,t){var n=t.min,i=t.max;n=Z(e.min,n);for(var s=[],a=Ya(n),r=function(e,t){for(var n=Ya(t-e);Wa(e,t,n)>10;)n++;for(;Wa(e,t,n)<10;)n--;return Math.min(n,Ya(e))}(n,i),o=r<0?Math.pow(10,Math.abs(r)):1,l=Math.pow(10,r),c=a>r?Math.pow(10,a):0,d=Math.round((n-c)*o)/o,u=Math.floor((n-c)/l/10)*l*10,h=Math.floor((d-u)/Math.pow(10,r)),g=Z(e.min,Math.round((c+u+h*Math.pow(10,r))*o)/o);g<i;)s.push({value:g,major:Ga(g),significand:h}),h>=10?h=h<15?15:20:h++,h>=20&&(h=2,o=++r>=0?1:o),g=Math.round((c+u+h*Math.pow(10,r))*o)/o;var p=Z(e.max,g);return s.push({value:p,major:Ga(p),significand:h}),s}var Ka=function(e){function t(e){var n;return(0,u.default)(this,t),(n=(0,s.default)(this,t,[e])).start=void 0,n.end=void 0,n._startValue=void 0,n._valueRange=0,n}return(0,r.default)(t,e),(0,h.default)(t,[{key:"parse",value:function(e,t){var n=Ha.prototype.parse.apply(this,[e,t]);if(0!==n)return X(n)&&n>0?n:null;this._zero=!0}},{key:"determineDataLimits",value:function(){var e=this.getMinMax(!0),t=e.min,n=e.max;this.min=X(t)?Math.max(0,t):null,this.max=X(n)?Math.max(0,n):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!X(this._userMin)&&(this.min=t===Va(this.min,0)?Va(this.min,-1):Va(this.min,0)),this.handleTickRangeOptions()}},{key:"handleTickRangeOptions",value:function(){var e=this.getUserBounds(),t=e.minDefined,n=e.maxDefined,i=this.min,s=this.max,a=function(e){return i=t?i:e},r=function(e){return s=n?s:e};i===s&&(i<=0?(a(1),r(10)):(a(Va(i,-1)),r(Va(s,1)))),i<=0&&a(Va(s,-1)),s<=0&&r(Va(i,1)),this.min=i,this.max=s}},{key:"buildTicks",value:function(){var e=this.options,t=Qa({min:this._userMin,max:this._userMax},this);return"ticks"===e.bounds&&Ne(t,this,"value"),e.reverse?(t.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),t}},{key:"getLabelForValue",value:function(e){return void 0===e?"0":ct(e,this.chart.options.locale,this.options.ticks.format)}},{key:"configure",value:function(){var e=this.min;(0,a.A)(t,"configure",this,3)([]),this._startValue=ke(e),this._valueRange=ke(this.max)-ke(e)}},{key:"getPixelForValue",value:function(e){return void 0!==e&&0!==e||(e=this.min),null===e||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(ke(e)-this._startValue)/this._valueRange)}},{key:"getValueForPixel",value:function(e){var t=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+t*this._valueRange)}}])}(ps);function $a(e){var t=e.ticks;if(t.display&&e.display){var n=Et(t.backdropPadding);return J(t.font&&t.font.size,vt.font.size)+n.height}return 0}function Xa(e,t,n,i,s){return e===i||e===s?{start:t-n/2,end:t+n/2}:e<i||e>s?{start:t-n,end:t}:{start:t,end:t+n}}function Za(e){for(var t,n,i,s={l:e.left+e._padding.left,r:e.right-e._padding.right,t:e.top+e._padding.top,b:e.bottom-e._padding.bottom},a=Object.assign({},s),r=[],o=[],l=e._pointLabels.length,c=e.options.pointLabels,d=c.centerPointLabels?ve/l:0,u=0;u<l;u++){var h=c.setContext(e.getPointLabelContext(u));o[u]=h.padding;var g=e.getPointPosition(u,e.drawingArea+o[u],d),p=zt(h.font),f=(t=e.ctx,n=p,i=K(i=e._pointLabels[u])?i:[i],{w:At(t,n.string,i),h:i.length*n.lineHeight});r[u]=f;var m=Ue(e.getIndexAngle(u)+d),v=Math.round(Ce(m));Ja(a,s,m,Xa(v,g.x,f.w,0,180),Xa(v,g.y,f.h,90,270))}e.setCenterPoint(s.l-a.l,a.r-s.r,s.t-a.t,a.b-s.b),e._pointLabelItems=function(e,t,n){for(var i,s=[],a=e._pointLabels.length,r=e.options,o=r.pointLabels,l=o.centerPointLabels,c=o.display,d={extra:$a(r)/2,additionalAngle:l?ve/a:0},u=0;u<a;u++){d.padding=n[u],d.size=t[u];var h=er(e,u,d);s.push(h),"auto"===c&&(h.visible=tr(h,i),h.visible&&(i=h))}return s}(e,r,o)}function Ja(e,t,n,i,s){var a=Math.abs(Math.sin(n)),r=Math.abs(Math.cos(n)),o=0,l=0;i.start<t.l?(o=(t.l-i.start)/a,e.l=Math.min(e.l,t.l-o)):i.end>t.r&&(o=(i.end-t.r)/a,e.r=Math.max(e.r,t.r+o)),s.start<t.t?(l=(t.t-s.start)/r,e.t=Math.min(e.t,t.t-l)):s.end>t.b&&(l=(s.end-t.b)/r,e.b=Math.max(e.b,t.b+l))}function er(e,t,n){var i=e.drawingArea,s=n.extra,a=n.additionalAngle,r=n.padding,o=n.size,l=e.getPointPosition(t,i+s+r,a),c=Math.round(Ce(Ue(l.angle+be))),d=function(e,t,n){90===n||270===n?e-=t/2:(n>270||n<90)&&(e-=t);return e}(l.y,o.h,c),u=function(e){if(0===e||180===e)return"center";if(e<180)return"left";return"right"}(c),h=function(e,t,n){"right"===n?e-=t:"center"===n&&(e-=t/2);return e}(l.x,o.w,u);return{visible:!0,x:l.x,y:d,textAlign:u,left:h,top:d,right:h+o.w,bottom:d+o.h}}function tr(e,t){if(!t)return!0;var n=e.left,i=e.top,s=e.right,a=e.bottom;return!(St({x:n,y:i},t)||St({x:n,y:a},t)||St({x:s,y:i},t)||St({x:s,y:a},t))}function nr(e,t,n){var i=n.left,s=n.top,a=n.right,r=n.bottom,o=t.backdropColor;if(!Q(o)){var l=Ft(t.borderRadius),c=Et(t.backdropPadding);e.fillStyle=o;var d=i-c.left,u=s-c.top,h=a-i+c.width,g=r-s+c.height;Object.values(l).some((function(e){return 0!==e}))?(e.beginPath(),Ct(e,{x:d,y:u,w:h,h:g,radius:l}),e.fill()):e.fillRect(d,u,h,g)}}function ir(e,t,n,i){var s=e.ctx;if(n)s.arc(e.xCenter,e.yCenter,t,0,xe);else{var a=e.getPointPosition(0,t);s.moveTo(a.x,a.y);for(var r=1;r<i;r++)a=e.getPointPosition(r,t),s.lineTo(a.x,a.y)}}(0,c.default)(Ka,"id","logarithmic"),(0,c.default)(Ka,"defaults",{ticks:{callback:ut.formatters.logarithmic,major:{enabled:!0}}});var sr=function(e){function t(e){var n;return(0,u.default)(this,t),(n=(0,s.default)(this,t,[e])).xCenter=void 0,n.yCenter=void 0,n.drawingArea=void 0,n._pointLabels=[],n._pointLabelItems=[],n}return(0,r.default)(t,e),(0,h.default)(t,[{key:"setDimensions",value:function(){var e=this._padding=Et($a(this.options)/2),t=this.width=this.maxWidth-e.width,n=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+t/2+e.left),this.yCenter=Math.floor(this.top+n/2+e.top),this.drawingArea=Math.floor(Math.min(t,n)/2)}},{key:"determineDataLimits",value:function(){var e=this.getMinMax(!1),t=e.min,n=e.max;this.min=X(t)&&!isNaN(t)?t:0,this.max=X(n)&&!isNaN(n)?n:0,this.handleTickRangeOptions()}},{key:"computeTickLimit",value:function(){return Math.ceil(this.drawingArea/$a(this.options))}},{key:"generateTickLabels",value:function(e){var t=this;Ha.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((function(e,n){var i=te(t.options.pointLabels.callback,[e,n],t);return i||0===i?i:""})).filter((function(e,n){return t.chart.getDataVisibility(n)}))}},{key:"fit",value:function(){var e=this.options;e.display&&e.pointLabels.display?Za(this):this.setCenterPoint(0,0,0,0)}},{key:"setCenterPoint",value:function(e,t,n,i){this.xCenter+=Math.floor((e-t)/2),this.yCenter+=Math.floor((n-i)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,t,n,i))}},{key:"getIndexAngle",value:function(e){return Ue(e*(xe/(this._pointLabels.length||1))+Me(this.options.startAngle||0))}},{key:"getDistanceFromCenterForValue",value:function(e){if(Q(e))return NaN;var t=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*t:(e-this.min)*t}},{key:"getValueForDistanceFromCenter",value:function(e){if(Q(e))return NaN;var t=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-t:this.min+t}},{key:"getPointLabelContext",value:function(e){var t=this._pointLabels||[];if(e>=0&&e<t.length){var n=t[e];return function(e,t,n){return Ht(e,{label:n,index:t,type:"pointLabel"})}(this.getContext(),e,n)}}},{key:"getPointPosition",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=this.getIndexAngle(e)-be+n;return{x:Math.cos(i)*t+this.xCenter,y:Math.sin(i)*t+this.yCenter,angle:i}}},{key:"getPointPositionForValue",value:function(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))}},{key:"getBasePosition",value:function(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}},{key:"getPointLabelPosition",value:function(e){var t=this._pointLabelItems[e];return{left:t.left,top:t.top,right:t.right,bottom:t.bottom}}},{key:"drawBackground",value:function(){var e=this.options,t=e.backgroundColor,n=e.grid.circular;if(t){var i=this.ctx;i.save(),i.beginPath(),ir(this,this.getDistanceFromCenterForValue(this._endValue),n,this._pointLabels.length),i.closePath(),i.fillStyle=t,i.fill(),i.restore()}}},{key:"drawGrid",value:function(){var e,t,n,i=this,s=this.ctx,a=this.options,r=a.angleLines,o=a.grid,l=a.border,c=this._pointLabels.length;if(a.pointLabels.display&&function(e,t){for(var n=e.ctx,i=e.options.pointLabels,s=t-1;s>=0;s--){var a=e._pointLabelItems[s];if(a.visible){var r=i.setContext(e.getPointLabelContext(s));nr(n,r,a);var o=zt(r.font),l=a.x,c=a.y,d=a.textAlign;Mt(n,e._pointLabels[s],l,c+o.lineHeight/2,o,{color:r.color,textAlign:d,textBaseline:"middle"})}}}(this,c),o.display&&this.ticks.forEach((function(e,n){if(0!==n||0===n&&i.min<0){t=i.getDistanceFromCenterForValue(e.value);var s=i.getContext(n),a=o.setContext(s),r=l.setContext(s);!function(e,t,n,i,s){var a=e.ctx,r=t.circular,o=t.color,l=t.lineWidth;!r&&!i||!o||!l||n<0||(a.save(),a.strokeStyle=o,a.lineWidth=l,a.setLineDash(s.dash||[]),a.lineDashOffset=s.dashOffset,a.beginPath(),ir(e,n,r,i),a.closePath(),a.stroke(),a.restore())}(i,a,t,c,r)}})),r.display){for(s.save(),e=c-1;e>=0;e--){var d=r.setContext(this.getPointLabelContext(e)),u=d.color,h=d.lineWidth;h&&u&&(s.lineWidth=h,s.strokeStyle=u,s.setLineDash(d.borderDash),s.lineDashOffset=d.borderDashOffset,t=this.getDistanceFromCenterForValue(a.reverse?this.min:this.max),n=this.getPointPosition(e,t),s.beginPath(),s.moveTo(this.xCenter,this.yCenter),s.lineTo(n.x,n.y),s.stroke())}s.restore()}}},{key:"drawBorder",value:function(){}},{key:"drawLabels",value:function(){var e=this,t=this.ctx,n=this.options,i=n.ticks;if(i.display){var s,a,r=this.getIndexAngle(0);t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(r),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach((function(r,o){if(!(0===o&&e.min>=0)||n.reverse){var l=i.setContext(e.getContext(o)),c=zt(l.font);if(s=e.getDistanceFromCenterForValue(e.ticks[o].value),l.showLabelBackdrop){t.font=c.string,a=t.measureText(r.label).width,t.fillStyle=l.backdropColor;var d=Et(l.backdropPadding);t.fillRect(-a/2-d.left,-s-c.size/2-d.top,a+d.width,c.size+d.height)}Mt(t,r.label,0,-s,c,{color:l.color,strokeColor:l.textStrokeColor,strokeWidth:l.textStrokeWidth})}})),t.restore()}}},{key:"drawTitle",value:function(){}}])}(Ha);(0,c.default)(sr,"id","radialLinear"),(0,c.default)(sr,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:ut.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback:function(e){return e},padding:5,centerPointLabels:!1}}),(0,c.default)(sr,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),(0,c.default)(sr,"descriptors",{angleLines:{_fallback:"grid"}});var ar={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},rr=Object.keys(ar);function or(e,t){return e-t}function lr(e,t){if(Q(t))return null;var n=e._adapter,i=e._parseOpts,s=i.parser,a=i.round,r=i.isoWeekday,o=t;return"function"===typeof s&&(o=s(o)),X(o)||(o="string"===typeof s?n.parse(o,s):n.parse(o)),null===o?null:(a&&(o="week"!==a||!Ie(r)&&!0!==r?n.startOf(o,a):n.startOf(o,"isoWeek",r)),+o)}function cr(e,t,n,i){for(var s=rr.length,a=rr.indexOf(e);a<s-1;++a){var r=ar[rr[a]],o=r.steps?r.steps:Number.MAX_SAFE_INTEGER;if(r.common&&Math.ceil((n-t)/(o*r.size))<=i)return rr[a]}return rr[s-1]}function dr(e,t,n){if(n){if(n.length){var i=Be(n,t),s=i.lo,a=i.hi;e[n[s]>=t?n[s]:n[a]]=!0}}else e[t]=!0}function ur(e,t,n){var i,s,a=[],r={},o=t.length;for(i=0;i<o;++i)r[s=t[i]]=i,a.push({value:s,major:!1});return 0!==o&&n?function(e,t,n,i){var s,a,r=e._adapter,o=+r.startOf(t[0].value,i),l=t[t.length-1].value;for(s=o;s<=l;s=+r.add(s,1,i))(a=n[s])>=0&&(t[a].major=!0);return t}(e,a,r,n):a}var hr=function(e){function t(e){var n;return(0,u.default)(this,t),(n=(0,s.default)(this,t,[e]))._cache={data:[],labels:[],all:[]},n._unit="day",n._majorUnit=void 0,n._offsets={},n._normalized=!1,n._parseOpts=void 0,n}return(0,r.default)(t,e),(0,h.default)(t,[{key:"init",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.time||(e.time={}),s=this._adapter=new vi._date(e.adapters.date);s.init(n),le(i.displayFormats,s.formats()),this._parseOpts={parser:i.parser,round:i.round,isoWeekday:i.isoWeekday},(0,a.A)(t,"init",this,3)([e]),this._normalized=n.normalized}},{key:"parse",value:function(e,t){return void 0===e?null:lr(this,e)}},{key:"beforeLayout",value:function(){(0,a.A)(t,"beforeLayout",this,3)([]),this._cache={data:[],labels:[],all:[]}}},{key:"determineDataLimits",value:function(){var e=this.options,t=this._adapter,n=e.time.unit||"day",i=this.getUserBounds(),s=i.min,a=i.max,r=i.minDefined,o=i.maxDefined;function l(e){r||isNaN(e.min)||(s=Math.min(s,e.min)),o||isNaN(e.max)||(a=Math.max(a,e.max))}r&&o||(l(this._getLabelBounds()),"ticks"===e.bounds&&"labels"===e.ticks.source||l(this.getMinMax(!1))),s=X(s)&&!isNaN(s)?s:+t.startOf(Date.now(),n),a=X(a)&&!isNaN(a)?a:+t.endOf(Date.now(),n)+1,this.min=Math.min(s,a-1),this.max=Math.max(s+1,a)}},{key:"_getLabelBounds",value:function(){var e=this.getLabelTimestamps(),t=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],n=e[e.length-1]),{min:t,max:n}}},{key:"buildTicks",value:function(){var e=this.options,t=e.time,n=e.ticks,i="labels"===n.source?this.getLabelTimestamps():this._generate();"ticks"===e.bounds&&i.length&&(this.min=this._userMin||i[0],this.max=this._userMax||i[i.length-1]);var s=this.min,a=function(e,t,n){for(var i=0,s=e.length;i<s&&e[i]<t;)i++;for(;s>i&&e[s-1]>n;)s--;return i>0||s<e.length?e.slice(i,s):e}(i,s,this.max);return this._unit=t.unit||(n.autoSkip?cr(t.minUnit,this.min,this.max,this._getLabelCapacity(s)):function(e,t,n,i,s){for(var a=rr.length-1;a>=rr.indexOf(n);a--){var r=rr[a];if(ar[r].common&&e._adapter.diff(s,i,r)>=t-1)return r}return rr[n?rr.indexOf(n):0]}(this,a.length,t.minUnit,this.min,this.max)),this._majorUnit=n.major.enabled&&"year"!==this._unit?function(e){for(var t=rr.indexOf(e)+1,n=rr.length;t<n;++t)if(ar[rr[t]].common)return rr[t]}(this._unit):void 0,this.initOffsets(i),e.reverse&&a.reverse(),ur(this,a,this._majorUnit)}},{key:"afterAutoSkip",value:function(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map((function(e){return+e.value})))}},{key:"initOffsets",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=0,s=0;this.options.offset&&n.length&&(e=this.getDecimalForValue(n[0]),i=1===n.length?1-e:(this.getDecimalForValue(n[1])-e)/2,t=this.getDecimalForValue(n[n.length-1]),s=1===n.length?t:(t-this.getDecimalForValue(n[n.length-2]))/2);var a=n.length<3?.5:.25;i=Ee(i,0,a),s=Ee(s,0,a),this._offsets={start:i,end:s,factor:1/(i+1+s)}}},{key:"_generate",value:function(){var e,t,n=this._adapter,i=this.min,s=this.max,a=this.options,r=a.time,o=r.unit||cr(r.minUnit,i,s,this._getLabelCapacity(i)),l=J(a.ticks.stepSize,1),c="week"===o&&r.isoWeekday,d=Ie(c)||!0===c,u={},h=i;if(d&&(h=+n.startOf(h,"isoWeek",c)),h=+n.startOf(h,d?"day":o),n.diff(s,i,o)>1e5*l)throw new Error(i+" and "+s+" are too far apart with stepSize of "+l+" "+o);var g="data"===a.ticks.source&&this.getDataTimestamps();for(e=h,t=0;e<s;e=+n.add(e,l,o),t++)dr(u,e,g);return e!==s&&"ticks"!==a.bounds&&1!==t||dr(u,e,g),Object.keys(u).sort(or).map((function(e){return+e}))}},{key:"getLabelForValue",value:function(e){var t=this._adapter,n=this.options.time;return n.tooltipFormat?t.format(e,n.tooltipFormat):t.format(e,n.displayFormats.datetime)}},{key:"format",value:function(e,t){var n=this.options.time.displayFormats,i=this._unit,s=t||n[i];return this._adapter.format(e,s)}},{key:"_tickFormatFunction",value:function(e,t,n,i){var s=this.options,a=s.ticks.callback;if(a)return te(a,[e,t,n],this);var r=s.time.displayFormats,o=this._unit,l=this._majorUnit,c=o&&r[o],d=l&&r[l],u=n[t],h=l&&d&&u&&u.major;return this._adapter.format(e,i||(h?d:c))}},{key:"generateTickLabels",value:function(e){var t,n,i;for(t=0,n=e.length;t<n;++t)(i=e[t]).label=this._tickFormatFunction(i.value,t,e)}},{key:"getDecimalForValue",value:function(e){return null===e?NaN:(e-this.min)/(this.max-this.min)}},{key:"getPixelForValue",value:function(e){var t=this._offsets,n=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+n)*t.factor)}},{key:"getValueForPixel",value:function(e){var t=this._offsets,n=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+n*(this.max-this.min)}},{key:"_getLabelSize",value:function(e){var t=this.options.ticks,n=this.ctx.measureText(e).width,i=Me(this.isHorizontal()?t.maxRotation:t.minRotation),s=Math.cos(i),a=Math.sin(i),r=this._resolveTickFontOptions(0).size;return{w:n*s+r*a,h:n*a+r*s}}},{key:"_getLabelCapacity",value:function(e){var t=this.options.time,n=t.displayFormats,i=n[t.unit]||n.millisecond,s=this._tickFormatFunction(e,0,ur(this,[e],this._majorUnit),i),a=this._getLabelSize(s),r=Math.floor(this.isHorizontal()?this.width/a.w:this.height/a.h)-1;return r>0?r:1}},{key:"getDataTimestamps",value:function(){var e,t,n=this._cache.data||[];if(n.length)return n;var i=this.getMatchingVisibleMetas();if(this._normalized&&i.length)return this._cache.data=i[0].controller.getAllParsedValues(this);for(e=0,t=i.length;e<t;++e)n=n.concat(i[e].controller.getAllParsedValues(this));return this._cache.data=this.normalize(n)}},{key:"getLabelTimestamps",value:function(){var e,t,n=this._cache.labels||[];if(n.length)return n;var i=this.getLabels();for(e=0,t=i.length;e<t;++e)n.push(lr(this,i[e]));return this._cache.labels=this._normalized?n:this.normalize(n)}},{key:"normalize",value:function(e){return Ge(e.sort(or))}}])}(ps);function gr(e,t,n){var i,s,a,r,o=0,l=e.length-1;if(n){if(t>=e[o].pos&&t<=e[l].pos){var c=He(e,"pos",t);o=c.lo,l=c.hi}var d=e[o];i=d.pos,a=d.time;var u=e[l];s=u.pos,r=u.time}else{if(t>=e[o].time&&t<=e[l].time){var h=He(e,"time",t);o=h.lo,l=h.hi}var g=e[o];i=g.time,a=g.pos;var p=e[l];s=p.time,r=p.pos}var f=s-i;return f?a+(r-a)*(t-i)/f:a}(0,c.default)(hr,"id","time"),(0,c.default)(hr,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});var pr=function(e){function t(e){var n;return(0,u.default)(this,t),(n=(0,s.default)(this,t,[e]))._table=[],n._minPos=void 0,n._tableRange=void 0,n}return(0,r.default)(t,e),(0,h.default)(t,[{key:"initOffsets",value:function(){var e=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(e);this._minPos=gr(n,this.min),this._tableRange=gr(n,this.max)-this._minPos,(0,a.A)(t,"initOffsets",this,3)([e])}},{key:"buildLookupTable",value:function(e){var t,n,i,s,a,r=this.min,o=this.max,l=[],c=[];for(t=0,n=e.length;t<n;++t)(s=e[t])>=r&&s<=o&&l.push(s);if(l.length<2)return[{time:r,pos:0},{time:o,pos:1}];for(t=0,n=l.length;t<n;++t)a=l[t+1],i=l[t-1],s=l[t],Math.round((a+i)/2)!==s&&c.push({time:s,pos:t/(n-1)});return c}},{key:"_generate",value:function(){var e=this.min,n=this.max,i=(0,a.A)(t,"getDataTimestamps",this,3)([]);return i.includes(e)&&i.length||i.splice(0,0,e),i.includes(n)&&1!==i.length||i.push(n),i.sort((function(e,t){return e-t}))}},{key:"_getTimestampsForTable",value:function(){var e=this._cache.all||[];if(e.length)return e;var t=this.getDataTimestamps(),n=this.getLabelTimestamps();return e=t.length&&n.length?this.normalize(t.concat(n)):t.length?t:n,e=this._cache.all=e}},{key:"getDecimalForValue",value:function(e){return(gr(this._table,e)-this._minPos)/this._tableRange}},{key:"getValueForPixel",value:function(e){var t=this._offsets,n=this.getDecimalForPixel(e)/t.factor-t.end;return gr(this._table,n*this._tableRange+this._minPos,!0)}}])}(hr);(0,c.default)(pr,"id","timeseries"),(0,c.default)(pr,"defaults",hr.defaults)},66187:function(e,t,n){n.d(t,{N1:function(){return m}});var i=n(80045),s=n(89379),a=n(9950),r=n(35298),o=["height","width","redraw","datasetIdKey","type","data","options","plugins","fallbackContent","updateMode"],l="label";function c(e,t){"function"===typeof e?e(t):e&&(e.current=t)}function d(e,t){e.labels=t}function u(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l,i=[];e.datasets=t.map((function(t){var a=e.datasets.find((function(e){return e[n]===t[n]}));return a&&t.data&&!i.includes(a)?(i.push(a),Object.assign(a,t),a):(0,s.default)({},t)}))}function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l,n={labels:[],datasets:[]};return d(n,e.labels),u(n,e.datasets,t),n}function g(e,t){var n=e.height,l=void 0===n?150:n,g=e.width,p=void 0===g?300:g,f=e.redraw,m=void 0!==f&&f,v=e.datasetIdKey,x=e.type,A=e.data,y=e.options,P=e.plugins,b=void 0===P?[]:P,j=e.fallbackContent,S=e.updateMode,k=(0,i.default)(e,o),D=(0,a.useRef)(null),_=(0,a.useRef)(null),w=function(){D.current&&(_.current=new r.t1(D.current,{type:x,data:h(A,v),options:y&&(0,s.default)({},y),plugins:b}),c(t,_.current))},I=function(){c(t,null),_.current&&(_.current.destroy(),_.current=null)};return(0,a.useEffect)((function(){!m&&_.current&&y&&function(e,t){var n=e.options;n&&t&&Object.assign(n,t)}(_.current,y)}),[m,y]),(0,a.useEffect)((function(){!m&&_.current&&d(_.current.config.data,A.labels)}),[m,A.labels]),(0,a.useEffect)((function(){!m&&_.current&&A.datasets&&u(_.current.config.data,A.datasets,v)}),[m,A.datasets]),(0,a.useEffect)((function(){_.current&&(m?(I(),setTimeout(w)):_.current.update(S))}),[m,y,A.labels,A.datasets,S]),(0,a.useEffect)((function(){_.current&&(I(),setTimeout(w))}),[x]),(0,a.useEffect)((function(){return w(),function(){return I()}}),[]),a.createElement("canvas",(0,s.default)({ref:D,role:"img",height:l,width:p},k),j)}var p=(0,a.forwardRef)(g);function f(e,t){return r.t1.register(t),(0,a.forwardRef)((function(t,n){return a.createElement(p,(0,s.default)((0,s.default)({},t),{},{ref:n,type:e}))}))}var m=f("line",r.ZT)}},function(e){e.O(0,[4223],(function(){return t=54525,e(e.s=t);var t}));e.O()}]);