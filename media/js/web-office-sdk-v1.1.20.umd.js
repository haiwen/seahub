!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e=e||self).WebOfficeSDK={})}(this,function(e){"use strict";var n=function(){return(n=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e}).apply(this,arguments)};function t(e,n,t,r){return new(t||(t=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(o,s)}c((r=r.apply(e,n||[])).next())})}function r(e,n){var t,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=n.call(e,o)}catch(e){a=[6,e],r=0}finally{t=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}var i=function(){function e(){}return e.add=function(n){e.HANDLE_LIST.push(n),window.addEventListener("message",n,!1)},e.remove=function(n){var t=e.HANDLE_LIST.indexOf(n);t>=0&&e.HANDLE_LIST.splice(t,1),window.removeEventListener("message",n,!1)},e.empty=function(){for(;e.HANDLE_LIST.length;)window.removeEventListener("message",e.HANDLE_LIST.shift(),!1)},e.parse=function(e){try{if(e&&"string"==typeof e){var n=e.indexOf('"__objName":')>=0,t=JSON.parse(e);return n&&(t.hasInnerObj=!0),t}return e}catch(e){console.log("Message.parse Error:",e)}},e.HANDLE_LIST=[],e}();function a(e){if(!e)return!1;for(var n=e;null!==Object.getPrototypeOf(n);)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(e)===n}function o(e){return"[object Function]"==={}.toString.call(e)}var s,c,u,l,d={origin:""};function f(e,n){d[e]=n}function p(e){return d[e]}function v(e){var n=p("whiteList")||[],t=p("origin");return!!function(e,n,t){return!t.includes(n)&&e!==n&&(e.replace(/www\./i,"").toLowerCase()!==n.replace(/www\./i,"").toLowerCase()||(e.match("www.")?void 0:(f("origin",n),!1)))}(t,e.origin,n)&&(console.warn("postMessage 域名检查不通过",{safeOrigin:t,eventOrigin:e.origin}),!0)}!function(e){e.unknown="unknown",e.spreadsheet="s",e.writer="w",e.presentation="p",e.pdf="f"}(s||(s={})),function(e){e.wps="w",e.et="s",e.presentation="p",e.pdf="f"}(c||(c={})),function(e){e.nomal="nomal",e.simple="simple"}(u||(u={})),function(e){e[e.requestFullscreen=1]="requestFullscreen",e[e.exitFullscreen=0]="exitFullscreen"}(l||(l={}));var h,b,m,w=(h=0,function(){return h+=1}),g=function(e,n,t){void 0===t&&(t=!0);var r=n;if(!b){var i=function e(n){var t=n.clientHeight;var r=n.clientWidth;0!==t||0!==r||m?0===t&&0===r||!m||(m.disconnect(),m=null):window.ResizeObserver&&(m=new ResizeObserver(function(t){e(n)})).observe(n);b.style.cssText+="height: "+t+"px; width: "+r+"px"}.bind(null,r);(b=document.createElement("iframe")).classList.add("web-office-iframe");var a={id:"office-iframe",src:e,scrolling:"no",frameborder:"0",allowfullscreen:"allowfullscreen",webkitallowfullscreen:"true",mozallowfullscreen:"true",allow:"clipboard-read; clipboard-write"};for(var o in r?(a.style="width: "+r.clientWidth+"px; height: "+r.clientHeight+"px;",t&&window.addEventListener("resize",i)):((r=document.createElement("div")).classList.add("web-office-default-container"),function(e){var n=document.createElement("style");document.head.appendChild(n);var t=n.sheet;t.insertRule(e,t.cssRules.length)}(".web-office-default-container {position: absolute; padding: 0;  margin: 0; width: 100%; height: 100%; left: 0; top: 0;}"),document.body.appendChild(r),a.style="position: fixed; top: 0; right: 0; bottom: 0; left: 0; width: 100%; height: 100%;"),B&&window.visualViewport&&window.visualViewport.addEventListener("resize",y),a)b.setAttribute(o,a[o]);r.appendChild(b),b.destroy=function(){b.parentNode.removeChild(b),b=null,window.removeEventListener("resize",i),m&&(m.disconnect(),m=null)}}return b};function y(){var e=window.visualViewport,n=e.width,t=e.height,r=document.body.clientHeight-b.clientHeight;k({eventName:"visualViewportResize",data:{width:n,height:t-r}})}var k=function(e){g().contentWindow&&g().contentWindow.postMessage(JSON.stringify(e),p("realOrigin"))};function O(e,n,t){return new Promise(function(r){var a=w(),o=function(e){if(!v(e)){var n=i.parse(e.data);n.eventName===t&&n.msgId===a&&(r(n.data),i.remove(o))}};i.add(o),k({data:e,msgId:a,eventName:n})})}var j=function(e){return O(e,"wps.jssdk.api","wps.api.reply")},I=function(e){return O(e,"api.basic","api.basic.reply")},E={idMap:{}},x={};function _(e,n){return t(this,void 0,void 0,function(){var t,i,a,o;return r(this,function(r){switch(r.label){case 0:return"api.callback"===e.eventName&&e.callbackId&&x[e.callbackId]?(t=e.data.args,e.hasInnerObj?[4,S(t,n)]:[3,2]):[3,5];case 1:return a=r.sent(),[3,3];case 2:a=t,r.label=3;case 3:return i=a,[4,x[e.callbackId].apply(x,i)];case 4:o=r.sent(),k({result:o,eventName:"api.callback.reply",callbackId:e.callbackId}),r.label=5;case 5:return[2]}})})}function S(e,n){return t(this,void 0,void 0,function(){var t,i,o,s,c,u,l,d,f,p;return r(this,function(r){switch(r.label){case 0:if(!Array.isArray(e))return[3,5];s=[],t=0,r.label=1;case 1:return t<e.length?(o=(i=s).push,[4,S(e[t],n)]):[3,4];case 2:o.apply(i,[r.sent()]),r.label=3;case 3:return t+=1,[3,1];case 4:return[2,s];case 5:if(function(e){return"object"==typeof e&&e.__objId&&e.__objName}(e))return[2,n(e.__objId,e.__objName)||e];if(!a(e))return[3,10];for(u in s={},c=[],e)c.push(u);l=0,r.label=6;case 6:return l<c.length?(d=c[l],e.hasOwnProperty(d)?(f=s,p=d,[4,S(e[d],n)]):[3,8]):[3,9];case 7:f[p]=r.sent(),r.label=8;case 8:return l++,[3,6];case 9:return[2,s];case 10:return[2,e]}})})}function N(e){return t(this,void 0,void 0,function(){var n,t,a,o,s,c,u,l,d,f;return r(this,function(r){switch(r.label){case 0:return v(e)?[2]:(n=i.parse(e.data),t=n.eventName,a=n.callbackId,o=n.data,a&&(s=E.idMap[a])?(c=s.split(":"),u=c[0],l=c[1],"api.callback"===t&&E[u]&&E[u][l]?[4,(f=E[u][l]).callback.apply(f,o.args)]:[3,2]):[3,2]);case 1:d=r.sent(),k({result:d,callbackId:a,eventName:"api.callback.reply"}),r.label=2;case 2:return[2]}})})}var L=function(e){return t(void 0,void 0,void 0,function(){function n(){return Object.keys(E.idMap).find(function(e){return E.idMap[e]===a+":"+t})}var t,a,o,s,c,u,l,d,f;return r(this,function(r){switch(r.label){case 0:return t=e.prop,a=e.parentObjId,[4,C([o=e.value])];case 1:return s=r.sent(),c=s[0],u=s[1],e.value=c[0],l=Object.keys(u)[0],d=E[a],null===o&&d&&d[t]&&((f=n())&&delete E.idMap[f],delete d[t],Object.keys(d).length||delete E[a],Object.keys(E.idMap).length||i.remove(N)),l&&(Object.keys(E.idMap).length||i.add(N),E[a]||(E[a]={}),E[a][t]={callbackId:l,callback:u[l]},(f=n())&&delete E.idMap[f],E.idMap[l]=a+":"+t),[2]}})})},A=function(e,a,o,s){return t(void 0,void 0,void 0,function(){var c,u,l,d,f,p,h,b;return r(this,function(m){switch(m.label){case 0:return c=w(),d=new Promise(function(e,n){u=e,l=n}),f={},a.args?[4,C(a.args)]:[3,2];case 1:p=m.sent(),h=p[0],b=p[1],a.args=h,f=b,m.label=2;case 2:return"api.setter"!==e?[3,4]:[4,L(a)];case 3:m.sent(),m.label=4;case 4:return"api.caller"===e&&Object.assign(x,f),function(e){var t=e[0],r=e[1];"function"==typeof(t=n({},t)).data&&(t.data=t.data());r(),k(t)}([{eventName:e,data:a,msgId:c},function(){var n=this,a=function(d){return t(n,void 0,void 0,function(){var n,t,p;return r(this,function(r){switch(r.label){case 0:return v(d)?[2]:"api.callback"===(n=i.parse(d.data)).eventName&&n.callbackId&&f[n.callbackId]?[4,f[n.callbackId].apply(f,n.data.args)]:[3,2];case 1:t=r.sent(),k({result:t,eventName:"api.callback.reply",callbackId:n.callbackId}),r.label=2;case 2:return n.eventName===e+".reply"&&n.msgId===c&&(n.error?((p=new Error("")).stack=n.error+"\n"+o,s&&s(),l(p)):u(n),i.remove(a)),[2]}})})};return i.add(a),d}]),[2,d]}})})};function C(e){return t(this,void 0,void 0,function(){var n,t,i,o,s,c,u,l,d,f,p;return r(this,function(r){switch(r.label){case 0:n={},t=[],i=e.slice(0),r.label=1;case 1:return i.length?(o=void 0,[4,i.shift()]):[3,13];case 2:return(s=r.sent())&&s.done?[4,s.done()]:[3,4];case 3:r.sent(),r.label=4;case 4:if(!a(o))return[3,11];for(u in o={},c=[],s)c.push(u);l=0,r.label=5;case 5:return l<c.length?(d=c[l],f=s[d],/^[A-Z]/.test(d)?f&&f.done?[4,f.done()]:[3,7]:[3,8]):[3,10];case 6:r.sent(),r.label=7;case 7:f&&f.objId?f={objId:f.objId}:"function"==typeof f&&(p=w(),n[p]=f,f={callbackId:p}),r.label=8;case 8:o[d]=f,r.label=9;case 9:return l++,[3,5];case 10:return[3,12];case 11:s&&s.objId?o={objId:s.objId}:"function"==typeof s&&void 0===s.objId?(p=w(),n[p]=s,o={callbackId:p}):o=s,r.label=12;case 12:return t.push(o),[3,1];case 13:return[2,[t,n]]}})})}var T=function(e,t){void 0===t&&(t=!0);var r=n({},e),i=r.headers,a=void 0===i?{}:i,o=r.subscriptions,s=void 0===o?{}:o,c=r.mode,l=void 0===c?u.nomal:c,d=r.commonOptions,f=a.backBtn,p=void 0===f?{}:f,v=a.shareBtn,h=void 0===v?{}:v,b=a.otherMenuBtn,m=void 0===b?{}:b,w=function(e,n){e.subscribe&&"function"==typeof e.subscribe&&(e.callback=n,s[n]=e.subscribe,t&&delete e.subscribe)};if(w(p,"wpsconfig_back_btn"),w(h,"wpsconfig_share_btn"),w(m,"wpsconfig_other_menu_btn"),m.items&&Array.isArray(m.items)){var g=[];m.items.forEach(function(e,n){switch(void 0===e&&(e={}),e.type){case"export_img":e.type=1,e.callback="export_img";break;case"export_pdf":e.type=1,e.callback="export_pdf";break;case"save_version":e.type=1,e.callback="save_version";break;case"about_wps":e.type=1,e.callback="about_wps";break;case"split_line":e.type=2;break;case"custom":e.type=3,w(e,"wpsconfig_other_menu_btn_"+n),g.push(e)}}),g.length&&(R||H)&&(m.items=g)}r.url=r.url||r.wpsUrl;var y=[];if((l===u.simple||d&&!1===d.isShowTopArea)&&y.push("simple","hidecmb"),r.debug&&y.push("debugger"),r.url&&y.length&&(r.url=r.url+(r.url.indexOf("?")>=0?"&":"?")+y.join("&")),d&&(d.isParentFullscreen||d.isBrowserViewFullscreen)&&(document.addEventListener("fullscreenchange",V),document.addEventListener("webkitfullscreenchange",V),document.addEventListener("mozfullscreenchange",V)),r.wordOptions&&(r.wpsOptions=r.wordOptions),r.excelOptions&&(r.etOptions=r.excelOptions),r.pptOptions&&(r.wppOptions=r.pptOptions),"object"==typeof s.print){var k="wpsconfig_print";"function"==typeof s.print.subscribe&&(s[k]=s.print.subscribe,r.print={callback:k},void 0!==s.print.custom&&(r.print.custom=s.print.custom)),delete s.print}"function"==typeof s.exportPdf&&(s[k="wpsconfig_export_pdf"]=s.exportPdf,r.exportPdf={callback:k},delete s.exportPdf);return r.commandBars&&F(r.commandBars,!1),n(n({},r),{subscriptions:s})},P=function(e){void 0===e&&(e="");var n="";if(!n&&e){var t=e.toLowerCase();-1!==t.indexOf("/office/s/")&&(n=s.spreadsheet),-1!==t.indexOf("/office/w/")&&(n=s.writer),-1!==t.indexOf("/office/p/")&&(n=s.presentation),-1!==t.indexOf("/office/f/")&&(n=s.pdf)}if(!n){var r=e.match(/[\?&]type=([a-z]+)/)||[];n=c[r[1]]||""}return n};function F(e,n){void 0===n&&(n=!0);var t=e.map(function(e){var n=e.attributes;if(!Array.isArray(n)){var t=[];for(var r in n)if(n.hasOwnProperty(r)){var i={name:r,value:n[r]};t.push(i)}e.attributes=t}return e});return n&&k({data:t,eventName:"setCommandBars"}),t}var D=window.navigator.userAgent.toLowerCase(),R=/Android|webOS|iPhone|iPod|BlackBerry|iPad/i.test(D),B=/iPhone|iPod|iPad/i.test(D),H=function(){try{return-1!==window._parent.location.search.indexOf("from=wxminiprogram")}catch(e){return!1}}();function V(){var e={status:l.requestFullscreen},n=document,t=n.fullscreenElement||n.webkitFullscreenElement||n.mozFullScreenElement;e.status=t?l.requestFullscreen:l.exitFullscreen,k({data:e,eventName:"fullscreenchange"})}var M=function(){E.idMap={}};function z(){console.group("JSSDK 事件机制调整说明"),console.warn("jssdk.on、jssdk.off 和 jssdk.Application.Sub 将在后续版本中被弃用，建议使用改进后的 ApiEvent"),console.warn("具体请参考：https://wwo.wps.cn/docs/front-end/basic-usage/events/intro/"),console.groupEnd()}var W=0,q=new Set;function K(e){return W+=1,!e&&function(e){q.forEach(function(n){return n(e)})}(W),W}function G(){var e=new Error("");return(e.stack||e.message||"").split("\n").slice(2).join("\n")}var J={};function U(e,n){for(var t=J.otherProps,r=J.names,i=Object.keys(r),a=-1,o=0;o<i.length;o+=1){var s=i[o];if(r[s].name===n){a=parseInt(s,10);break}}if(a>=0){var c={objId:e},u=t[a];return u&&Y(c,u,t),c}}function Z(e,n){var a=this,o=n.Events,c=n.Enum,u=n.Props,l=u[0],d=u[1],f=u[2];Object.assign(J,{appProps:l,otherProps:d,names:f});var p,h={objId:W};switch(Y(h,l,d),h.Events=o,h.Enum=c,e.Enum=h.Enum,e.Events=h.Events,e.Props=u,P(e.url)){case s.writer:e.WordApplication=e.WpsApplication=function(){return h};break;case s.spreadsheet:e.ExcelApplication=e.EtApplication=function(){return h};break;case s.presentation:e.PPTApplication=e.WppApplication=function(){return h};break;case s.pdf:e.PDFApplication=function(){return h}}e.Application=h,e.Free=function(e){return A("api.free",{objId:e},"")},e.Stack=h.Stack=(p=function(n){e&&e.Free(n)},function(){var e=[],n=function(n){e.push(n)};return q.add(n),{End:function(){p(e),q.delete(n)}}});var b={};i.add(function(e){return t(a,void 0,void 0,function(){var n,t,a,o,s;return r(this,function(r){switch(r.label){case 0:return v(e)?[2]:"api.event"===(n=i.parse(e.data)).eventName&&n.data?(t=n.data,a=t.eventName,o=t.data,(s=b[a])?[4,s(o)]:[3,2]):[3,2];case 1:r.sent(),r.label=2;case 2:return[4,_(n,function(e,n){return U(e,n)})];case 3:return r.sent(),[2]}})})}),h.Sub={};var m=function(e){var n=o[e];Object.defineProperty(h.Sub,n,{set:function(e){z(),b[n]=e,k({eventName:"api.event.register",data:{eventName:n,register:!!e,objId:W+=1}})}})};for(var w in o)m(w)}var Q=window.FinalizationRegistry&&new FinalizationRegistry(function(e){A("api.free",{objId:e},"")}),X=["ExportAsFixedFormat","GetOperatorsInfo","ImportDataIntoFields","ReplaceText","ReplaceBookmark","GetBookmarkText","GetComments"];function Y(e,t,r){var i=t.slice(0),a=e.objId;i.includes("Destroy")||(e.Destroy=function(){return A("api.free",{objId:a},"")}),Q&&Q.register(e,a);for(var o=function(){var t=i.shift();!t.alias&&~X.indexOf(t.prop)&&i.push(n(n({},t),{alias:t.prop+"Async"}));var a=t.alias||t.prop;Object.defineProperty(e,a,{get:function(){var n=this,i=1===t.cache,a=i&&this["__"+t.prop+"CacheValue"];if(!a){var o=G(),s=K(i),c=function(){for(var n,i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];return void 0!==t.caller?Y(n={objId:K()},r[t.caller],r):n={},$(c,n,"api.caller",{obj:c,args:i,parentObjId:e.objId,objId:n.objId,prop:t.prop},o),n};return c.objId=-1,void 0!==t.getter&&r[t.getter].length&&(c.objId=s,Y(c,r[t.getter],r)),$(e,c,"api.getter",{parentObjId:e.objId,objId:c.objId,prop:t.prop},o,function(){delete n["__"+t.prop+"CacheValue"]}),i&&(this["__"+t.prop+"CacheValue"]=c),c}return a},set:function(n){var r=G();return $(e,{},"api.setter",{value:n,parentObjId:e.objId,objId:-1,prop:t.prop},r)}})};i.length;)o()}function $(e,n,i,a,o,s){var c,u=(e.done?e.done():Promise.resolve()).then(function(){return c||(c=A(i,a,o,s)),c});n.done=function(){return u},n.then=function(e,i){return t(this,void 0,void 0,function(){var t,o,s;return r(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),[4,u];case 1:return(t=r.sent()).hasInnerObj?(o=e,[4,S(t.result,U)]):[3,3];case 2:return o.apply(void 0,[r.sent()]),[3,4];case 3:a.objId>=0?(n.done=null,n.then=null,e(n)):e(t.result),r.label=4;case 4:return[3,6];case 5:return s=r.sent(),i(s),[3,6];case 6:return[2]}})})},n.catch=function(e){return u.catch(e)}}var ee={};var ne=null,te={fileOpen:"fileOpen",tabSwitch:"tabSwitch",fileSaved:"fileSaved",fileStatus:"fileStatus",fullscreenChange:"fullscreenChange",error:"error",stage:"stage"},re={getToken:"api.getToken",onToast:"event.toast",onHyperLinkOpen:"event.hyperLinkOpen",getClipboardData:"api.getClipboardData"};function ie(e,a,o,s,c,u,l){var d=this;void 0===o&&(o={});i.add(function(f){return t(d,void 0,void 0,function(){var t,d,p,h,b,m,w,g,y,O,j,I,E,x,_,S,N,L,A;return r(this,function(r){switch(r.label){case 0:return v(f)?[2]:(t=i.parse(f.data),d=t.eventName,p=void 0===d?"":d,h=t.data,b=void 0===h?null:h,m=t.url,w=void 0===m?null:m,-1!==["wps.jssdk.api"].indexOf(p)?[2]:"ready"!==p?[3,1]:(c.apiReadySended&&function(e){var n=[];Object.keys(ee).forEach(function(t){ee[t].forEach(function(r){var i=t;e.off(i,r),n.push({handle:r,eventName:i})}),delete ee[t]}),n.forEach(function(e){var n=e.eventName,t=e.handle;null==ne||ne.ApiEvent.AddApiEventListener(n,t)})}(a),k({eventName:"setConfig",data:n(n({},o),{version:e.version})}),e.tokenData&&e.setToken(n(n({},e.tokenData),{hasRefreshTokenConfig:!!o.refreshToken})),e.iframeReady=!0,[3,15]));case 1:return"error"!==p?[3,2]:(a.emit(te.error,b),[3,15]);case 2:return"open.result"!==p?[3,3]:(void 0!==(null===(N=null==b?void 0:b.fileInfo)||void 0===N?void 0:N.officeVersion)&&(e.mainVersion=b.fileInfo.officeVersion,console.log("WebOfficeSDK Main Version: V"+e.mainVersion)),a.emit(te.fileOpen,b),[3,15]);case 3:return"api.scroll"!==p?[3,4]:(window.scrollTo(b.x,b.y),[3,15]);case 4:if(p!==re.getToken)return[3,9];g={token:!1},r.label=5;case 5:return r.trys.push([5,7,,8]),[4,c.refreshToken()];case 6:return g=r.sent(),[3,8];case 7:return y=r.sent(),console.error("refreshToken: "+(y||"fail to get")),[3,8];case 8:return k({eventName:re.getToken+".reply",data:g}),[3,15];case 9:if(p!==re.getClipboardData)return[3,14];O={text:"",html:""},r.label=10;case 10:return r.trys.push([10,12,,13]),[4,c.getClipboardData()];case 11:return O=r.sent(),[3,13];case 12:return j=r.sent(),console.error("getClipboardData: "+(j||"fail to get")),[3,13];case 13:return k({eventName:re.getClipboardData+".reply",data:O}),[3,15];case 14:p===re.onToast?c.onToast(b):p===re.onHyperLinkOpen?c.onHyperLinkOpen(b):"stage"===p?a.emit(te.stage,b):"event.callback"===p?(I=b.eventName,E=b.data,x=I,I===te.fullscreenChange&&(x="fullscreenchange"),"file.saved"===I&&(x=te.fileStatus),((null===(L=o.commonOptions)||void 0===L?void 0:L.isBrowserViewFullscreen)||(null===(A=o.commonOptions)||void 0===A?void 0:A.isParentFullscreen))&&"fullscreenchange"===x&&(_=E.status,S=E.isDispatchEvent,o.commonOptions.isBrowserViewFullscreen?function(e,n,t,r){0===e?n.style="position: static; width: "+t.width+"; height: "+t.height:1===e&&(n.style="position: absolute; width: 100%; height: 100%"),r&&function(e){["fullscreen","fullscreenElement"].forEach(function(n){Object.defineProperty(document,n,{get:function(){return!!e.status},configurable:!0})});var n=new CustomEvent("fullscreenchange");document.dispatchEvent(n)}({status:e})}(_,u,l,S):o.commonOptions.isParentFullscreen&&function(e,n,t){var r=document.querySelector(t),i=r&&1===r.nodeType?r:n;if(0===e){var a=document,o=a.exitFullscreen||a.mozCancelFullScreen||a.msExitFullscreen||a.webkitCancelFullScreen||a.webkitExitFullscreen;o.call(document)}else if(1===e){var s=i.requestFullscreen||i.mozRequestFullScreen||i.msRequestFullscreen||i.webkitRequestFullscreen;s.call(i)}}(_,u,o.commonOptions.isParentFullscreen)),a.emit(x,E)):"api.ready"===p&&Z(e,b),r.label=15;case 15:return"function"==typeof s[p]&&s[p](e,w||b),[2]}})})})}function ae(e){return new Promise(function(n){var t=function(r){(f("realOrigin",r.origin),v(r))||i.parse(r.data).eventName===e&&(n(null),i.remove(t))};i.add(t)})}function oe(e){var n,a=this;void 0===e&&(e={}),ne&&ne.destroy();try{var s=T(e),c=s.subscriptions,u=void 0===c?{}:c,l=s.mount,d=void 0===l?null:l,p=s.url,v=s.refreshToken,h=s.onToast,b=s.onHyperLinkOpen,m=s.getClipboardData;f("whiteList",s.originWhiteList),f("origin",(p.match(/https*:\/\/[^\/]+/g)||[])[0]);var w=g(p,d),y=ae("open.result"),O=ae("api.ready"),E=d?{width:d.clientWidth+"px",height:d.clientHeight+"px"}:{width:"100vw",height:"100vh"};delete s.mount,p&&delete s.url,delete s.subscriptions;var x=(n=n||Object.create(null),{on:function(e,t){(n[e]||(n[e]=[])).push(t)},off:function(e,t){n[e]&&n[e].splice(n[e].indexOf(t)>>>0,1)},emit:function(e,t){(n[e]||[]).slice().map(function(e){e(t)}),(n["*"]||[]).slice().map(function(n){n(e,t)})}}),_={apiReadySended:!1,apiReadySendedOnce:!1},S=function(e,n,i){return t(a,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return function(e,n,t){if(ee[e]){var r=!!ee[e].find(function(e){return e===n});return r&&"off"===t?(x.off(e,n),ee[e]=ee[e].filter(function(e){return e!==n}),!!ee[e].length||(ee[e]=void 0,!1)):(r||"on"!==t||(ee[e].push(n),x.on(e,n)),!0)}return"on"===t?(ee[e]=[],ee[e].push(n),!1):"off"===t||void 0}(e,n,i)?[3,2]:[4,N];case 1:t.sent(),function(e,n){var t=e.eventName,r=e.type,i=e.handle;"on"===n?x.on(t,i):x.off(t,i),"base.event"===r&&k({eventName:"basic.event",data:{eventName:t,action:n}}),z()}(function(e,n){var t=e,r="base.event";switch(t){case te.fileSaved:console.warn("fileSaved事件监听即将弃用， 推荐使用fileStatus进行文件状态的监听"),t="fileStatus";break;case te.fullscreenChange:t="fullscreenchange";break;case"error":case"fileOpen":r="callback.event"}return{eventName:t,type:r,handle:n}}(e,n),i),t.label=2;case 2:return[2]}})})};ne={url:p,iframe:w,version:"1.1.20",iframeReady:!1,tokenData:null,commandBars:null,tabs:{getTabs:function(){return t(this,void 0,void 0,function(){return r(this,function(e){switch(e.label){case 0:return[4,N];case 1:return e.sent(),[2,I({api:"tab.getTabs"})]}})})},switchTab:function(e){return t(this,void 0,void 0,function(){return r(this,function(n){switch(n.label){case 0:return[4,N];case 1:return n.sent(),[2,I({api:"tab.switchTab",args:{tabKey:e}})]}})})}},setCooperUserColor:function(e){return t(this,void 0,void 0,function(){return r(this,function(n){switch(n.label){case 0:return[4,N];case 1:return n.sent(),[2,I({api:"setCooperUserColor",args:e})]}})})},setToken:function(e){return t(this,void 0,void 0,function(){return r(this,function(n){switch(n.label){case 0:return[4,N];case 1:return n.sent(),ne.tokenData=e,k({eventName:"setToken",data:e}),[2]}})})},ready:function(){return t(this,void 0,void 0,function(){return r(this,function(e){switch(e.label){case 0:return _.apiReadySendedOnce?[3,2]:(_.apiReadySendedOnce=!0,[4,y]);case 1:e.sent(),_.apiReadySended=!0,k({eventName:"api.ready"}),e.label=2;case 2:return[4,O];case 3:return e.sent(),[2,new Promise(function(e){return setTimeout(function(){return e(null==ne?void 0:ne.Application)},0)})]}})})},destroy:function(){ee={},w.destroy(),i.empty(),ne=null,q=new Set,W=0,document.removeEventListener("fullscreenchange",V),M()},save:function(){return t(this,void 0,void 0,function(){return r(this,function(e){switch(e.label){case 0:return[4,N];case 1:return e.sent(),[2,j({api:"save"})]}})})},setCommandBars:function(e){return t(this,void 0,void 0,function(){return r(this,function(n){switch(n.label){case 0:return[4,N];case 1:return n.sent(),F(e),[2]}})})},updateConfig:function(e){return void 0===e&&(e={}),t(this,void 0,void 0,function(){return r(this,function(n){switch(n.label){case 0:return[4,N];case 1:return n.sent(),e.commandBars?(console.warn("Deprecated: `updateConfig()` 方法即将废弃，请使用`setCommandBars()`代替`updateConfig()`更新`commandBars`配置。"),[4,F(e.commandBars)]):[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}})})},executeCommandBar:function(e){return t(this,void 0,void 0,function(){return r(this,function(n){switch(n.label){case 0:return[4,N];case 1:return n.sent(),F([{cmbId:e,attributes:[{name:"click",value:!0}]}]),[2]}})})},on:function(e,n){return t(this,void 0,void 0,function(){return r(this,function(t){return[2,this.ApiEvent.AddApiEventListener(e,n)]})})},off:function(e,n){return t(this,void 0,void 0,function(){return r(this,function(t){return[2,this.ApiEvent.RemoveApiEventListener(e,n)]})})},ApiEvent:{AddApiEventListener:function(e,n){return t(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return[4,S(e,n,"on")];case 1:return[2,t.sent()]}})})},RemoveApiEventListener:function(e,n){return t(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return[4,S(e,n,"off")];case 1:return[2,t.sent()]}})})}}},function(e,n,t,r,i,a){n&&o(n)&&(i.refreshToken=n,e.refreshToken={eventName:re.getToken});a&&o(a)&&(i.getClipboardData=a,e.getClipboardData={eventName:re.getClipboardData});t&&o(t)&&(i.onToast=t,e.onToast={eventName:re.onToast});r&&o(r)&&(i.onHyperLinkOpen=r,e.onHyperLinkOpen={eventName:re.onHyperLinkOpen})}(s,v,h,b,_,m),ie(ne,x,s,u,_,w,E);var N=ae("ready");return ne}catch(e){console.error(e)}}console.log("WebOfficeSDK JS-SDK V1.1.20");var se=Object.freeze({__proto__:null,listener:ie,config:oe});window.WPS=se;var ce=oe,ue={config:ce};e.config=ce,e.default=ue,Object.defineProperty(e,"__esModule",{value:!0})});
