webpackJsonp([28],{12:function(i,e,a){"use strict";"undefined"===typeof Promise&&(a(33).enable(),window.Promise=a(34)),a(28),Object.assign=a(20)},1262:function(i,e,a){a(12),i.exports=a(1263)},1263:function(i,e,a){"use strict";function n(i){return t.seafileAPI.getFileContent(window.app.config.rawPath).then(function(e){var a=window.mxUtils.parseXml(e.data);i.editor.setGraphXml(a.documentElement),i.editor.setModified(!1),i.editor.undoManager.clear()})}function o(i){return t.seafileAPI.getUpdateLink(window.app.config.repoID,window.app.config.parentDir).then(function(e){return t.seafileAPI.updateFile(e.data,window.app.config.path,window.app.config.filename,i)})}var t=a(3),s=a(1264),r=function(i){return i&&i.__esModule?i:{default:i}}(s);window.loadFile=n,window.saveFile=o,window.DrawViewer=r.default},1264:function(i,e,a){"use strict";function n(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function i(i,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,n.key,n)}}return function(e,a,n){return a&&i(e.prototype,a),n&&i(e,n),e}}(),t=a(3),s=window.mxRectangle,r=window.mxGraph,d=window.mxCodec,p=window.mxUtils,w=function(){function i(e){n(this,i),this.graph=e,e.setEnabled(!1)}return o(i,[{key:"loadFile",value:function(){var i=this;t.seafileAPI.getFileContent(window.app.config.rawPath).then(function(e){var a=p.parseXml(e.data);console.log(a.documentElement),i.setGraphXml(a.documentElement)})}},{key:"readGraphState",value:function(i){this.graph.gridEnabled=!1,this.graph.gridSize=parseFloat(i.getAttribute("gridSize"))||window.mxGraph.prototype.gridSize,this.graph.graphHandler.guidesEnabled="0"!=i.getAttribute("guides"),this.graph.setTooltips("0"!=i.getAttribute("tooltips")),this.graph.setConnectable("0"!=i.getAttribute("connect")),this.graph.connectionArrowsEnabled="0"!=i.getAttribute("arrows"),this.graph.foldingEnabled="0"!=i.getAttribute("fold"),this.graph.foldingEnabled&&(this.graph.foldingEnabled=!1,this.graph.cellRenderer.forceControlClickHandler=this.graph.foldingEnabled);var e=i.getAttribute("pageScale");this.graph.pageScale=null!=e?e:window.mxGraph.prototype.pageScale,this.graph.pageVisible=!1,this.graph.pageBreaksVisible=this.graph.pageVisible,this.graph.preferPageSize=this.graph.pageBreaksVisible;var a=i.getAttribute("pageWidth"),n=i.getAttribute("pageHeight");null!=a&&null!=n&&(this.graph.pageFormat=new s(0,0,parseFloat(a),parseFloat(n)));var o=i.getAttribute("background");null!=o&&o.length>0?this.graph.background=o:this.graph.background=this.graph.defaultGraphBackground}},{key:"setGraphXml",value:function(i){if(null!=i){var e=new d(i.ownerDocument);if("mxGraphModel"==i.nodeName){this.graph.model.beginUpdate();try{this.graph.model.clear(),this.graph.view.scale=1,this.readGraphState(i),this.updateGraphComponents(),e.decode(i,this.graph.getModel())}finally{this.graph.model.endUpdate()}}}else this.resetGraph(),this.graph.model.clear()}},{key:"updateGraphComponents",value:function(){var i=this.graph;null!=i.container&&(i.view.validateBackground(),i.container.style.overflow=i.scrollbars?"auto":"hidden")}},{key:"resetGraph",value:function(){this.graph.gridEnabled=!1,this.graph.graphHandler.guidesEnabled=!0,this.graph.setTooltips(!0),this.graph.setConnectable(!0),this.graph.foldingEnabled=!0,this.graph.scrollbars=this.graph.defaultScrollbars,this.graph.pageVisible=this.graph.defaultPageVisible,this.graph.pageBreaksVisible=this.graph.pageVisible,this.graph.preferPageSize=this.graph.pageBreaksVisible,this.graph.background=this.graph.defaultGraphBackground,this.graph.pageScale=r.prototype.pageScale,this.graph.pageFormat=r.prototype.pageFormat,this.graph.currentScale=1,this.graph.currentTranslate.x=0,this.graph.currentTranslate.y=0,this.updateGraphComponents(),this.graph.view.setScale(1)}}]),i}();e.default=w},2:function(i,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.dirPath="/",e.gettext=window.gettext,e.siteRoot=window.app.config.siteRoot,e.loginUrl=window.app.config.loginUrl,e.avatarInfo=window.app.config.avatarInfo,e.logoPath=window.app.config.logoPath,e.mediaUrl=window.app.config.mediaUrl,e.siteTitle=window.app.config.siteTitle,e.siteName=window.app.config.siteName,e.logoWidth=window.app.config.logoWidth,e.logoHeight=window.app.config.logoHeight,e.isPro="True"===window.app.config.isPro,e.isDocs="True"===window.app.config.isDocs,e.lang=window.app.config.lang,e.fileServerRoot=window.app.config.fileServerRoot,e.seafileVersion=window.app.config.seafileVersion,e.serviceURL=window.app.config.serviceURL,e.seafileCollabServer=window.app.pageOptions.seafileCollabServer,e.name=window.app.pageOptions.name,e.contactEmail=window.app.pageOptions.contactEmail,e.username=window.app.pageOptions.username,e.canAddRepo=window.app.pageOptions.canAddRepo,e.canGenerateShareLink=window.app.pageOptions.canGenerateShareLink,e.canGenerateUploadLink=!!window.app.pageOptions.canGenerateUploadLink,e.canViewOrg="True"===window.app.pageOptions.canViewOrg,e.fileAuditEnabled=!!window.app.pageOptions.fileAuditEnabled,e.enableFileComment=!!window.app.pageOptions.enableFileComment,e.folderPermEnabled="True"===window.app.pageOptions.folderPermEnabled,e.enableResetEncryptedRepoPassword="True"===window.app.pageOptions.enableResetEncryptedRepoPassword,e.isEmailConfigured="True"===window.app.pageOptions.isEmailConfigured,e.enableUploadFolder="True"===window.app.pageOptions.enableUploadFolder,e.enableResumableFileUpload="True"===window.app.pageOptions.enableResumableFileUpload,e.storages=window.app.pageOptions.storages,e.enableRepoSnapshotLabel=window.app.pageOptions.enableRepoSnapshotLabel,e.shareLinkExpireDaysMin=window.app.pageOptions.shareLinkExpireDaysMin,e.shareLinkExpireDaysMax=window.app.pageOptions.shareLinkExpireDaysMax,e.maxFileName=window.app.pageOptions.maxFileName,e.enableWiki=window.app.pageOptions.enableWiki,e.enableEncryptedLibrary="1"===window.app.pageOptions.enableEncryptedLibrary,e.enableRepoHistorySetting="1"===window.app.pageOptions.enableRepoHistorySetting,e.isSystemStaff=window.app.pageOptions.isSystemStaff,e.thumbnailSizeForOriginal=window.app.pageOptions.thumbnailSizeForOriginal,e.repoPasswordMinLength=window.app.pageOptions.repoPasswordMinLength,e.curNoteMsg=window.app.pageOptions.curNoteMsg,e.curNoteID=window.app.pageOptions.curNoteID,e.slug=window.wiki?window.wiki.config.slug:"",e.repoID=window.wiki?window.wiki.config.repoId:"",e.initialPath=window.wiki?window.wiki.config.initial_path:"",e.permission=window.wiki?"True"===window.wiki.config.permission:"",e.isDir=window.wiki?window.wiki.config.isDir:"",e.serviceUrl=window.wiki?window.wiki.config.serviceUrl:"",e.isPublicWiki=window.wiki?"True"===window.wiki.config.isPublicWiki:"",e.PER_PAGE=25,e.historyRepoID=window.fileHistory?window.fileHistory.pageOptions.repoID:"",e.repoName=window.fileHistory?window.fileHistory.pageOptions.repoName:"",e.filePath=window.fileHistory?window.fileHistory.pageOptions.filePath:"",e.fileName=window.fileHistory?window.fileHistory.pageOptions.fileName:"",e.draftFilePath=window.draft?window.draft.config.draftFilePath:"",e.draftOriginFilePath=window.draft?window.draft.config.draftOriginFilePath:"",e.draftFileName=window.draft?window.draft.config.draftFileName:"",e.draftID=window.draft?window.draft.config.draftID:"",e.draftRepoID=window.draft?window.draft.config.draftRepoID:"",e.author=window.draft?window.draft.config.author:"",e.authorAvatar=window.draft?window.draft.config.authorAvatar:"",e.originFileExists=window.draft?window.draft.config.originFileExists:"",e.draftFileExists=window.draft?window.draft.config.draftFileExists:"",e.draftStatus=window.draft?window.draft.config.draftStatus:"",e.draftPublishVersion=window.draft?window.draft.config.draftPublishVersion:"",e.originFileVersion=window.draft?window.draft.config.originFileVersion:"",e.orgID=window.org?window.org.pageOptions.orgID:"",e.invitationLink=window.org?window.org.pageOptions.invitationLink:"",e.orgMemberQuotaEnabled=window.org?window.org.pageOptions.orgMemberQuotaEnabled:"",e.constanceEnabled=window.sysadmin?window.sysadmin.pageOptions.constance_enabled:"",e.multiTenancy=window.sysadmin?window.sysadmin.pageOptions.multi_tenancy:"",e.multiInstitution=window.sysadmin?window.sysadmin.pageOptions.multi_institution:"",e.sysadminExtraEnabled=window.sysadmin?window.sysadmin.pageOptions.sysadmin_extra_enabled:"",e.enableGuestInvitation=window.sysadmin?window.sysadmin.pageOptions.enable_guest_invitation:"",e.enableTermsAndConditions=window.sysadmin?window.sysadmin.pageOptions.enable_terms_and_conditions:"",e.isDefaultAdmin=window.sysadmin?window.sysadmin.pageOptions.is_default_admin:"",e.enableFileScan=window.sysadmin?window.sysadmin.pageOptions.enable_file_scan:"",e.canViewSystemInfo=window.sysadmin?window.sysadmin.pageOptions.admin_permissions.can_view_system_info:"",e.canViewStatistic=window.sysadmin?window.sysadmin.pageOptions.admin_permissions.can_view_statistic:"",e.canConfigSystem=window.sysadmin?window.sysadmin.pageOptions.admin_permissions.can_config_system:"",e.canManageLibrary=window.sysadmin?window.sysadmin.pageOptions.admin_permissions.can_manage_library:"",e.canManageUser=window.sysadmin?window.sysadmin.pageOptions.admin_permissions.can_manage_user:"",e.canManageGroup=window.sysadmin?window.sysadmin.pageOptions.admin_permissions.can_manage_group:"",e.canViewUserLog=window.sysadmin?window.sysadmin.pageOptions.admin_permissions.can_view_user_log:"",e.canViewAdminLog=window.sysadmin?window.sysadmin.pageOptions.admin_permissions.can_view_admin_log:""},3:function(i,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.seafileAPI=void 0;var n=a(22),o=function(i){return i&&i.__esModule?i:{default:i}}(n),t=a(35),s=a(2),r=new t.SeafileAPI,d=o.default.load("sfcsrftoken");r.initForSeahubUsage({siteRoot:s.siteRoot,xcsrfHeaders:d}),e.seafileAPI=r}},[1262]);
//# sourceMappingURL=draw.js.map